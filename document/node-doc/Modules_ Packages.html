<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.49" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://hanekawa.top/document/node-doc/Modules_%20Packages.html"><meta property="og:site_name" content="hanekawa-shiki"><meta property="og:title" content="Modules: Packages"><meta property="og:description" content="Modules: Packages Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©ä½ å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚å…¶ä¸­ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µæ˜¯æ¨¡å—ï¼ˆModulesï¼‰ï¼Œè€ŒåŒ…ï¼ˆPackagesï¼‰åˆ™æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ¨¡å—ï¼Œé€šå¸¸åŒ…å«å¤šä¸ªæ¨¡å—ï¼Œå¹¶ä¸”ç”¨äºç‰¹å®šçš„åŠŸèƒ½æˆ–è€…é¡¹ç›®ã€‚åœ¨ Node.js ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ npmï¼ˆNode Package ..."><meta property="og:type" content="website"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-06-21T09:46:17.000Z"><meta property="article:author" content="hanekawa-shiki"><meta property="article:modified_time" content="2024-06-21T09:46:17.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"WebPage","name":"Modules: Packages","description":"Modules: Packages Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©ä½ å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚å…¶ä¸­ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µæ˜¯æ¨¡å—ï¼ˆModulesï¼‰ï¼Œè€ŒåŒ…ï¼ˆPackagesï¼‰åˆ™æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ¨¡å—ï¼Œé€šå¸¸åŒ…å«å¤šä¸ªæ¨¡å—ï¼Œå¹¶ä¸”ç”¨äºç‰¹å®šçš„åŠŸèƒ½æˆ–è€…é¡¹ç›®ã€‚åœ¨ Node.js ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ npmï¼ˆNode Package ..."}</script><meta name="keywords" content="JavaScript,HTML,CSS"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/assets/icons/chrome-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icons/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icons/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icons/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#5c92d1"><link rel="apple-touch-icon" href="/assets/icons/apple-touch-icon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="white"><meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><title>Modules: Packages | hanekawa-shiki</title><meta name="description" content="Modules: Packages Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©ä½ å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚å…¶ä¸­ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µæ˜¯æ¨¡å—ï¼ˆModulesï¼‰ï¼Œè€ŒåŒ…ï¼ˆPackagesï¼‰åˆ™æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ¨¡å—ï¼Œé€šå¸¸åŒ…å«å¤šä¸ªæ¨¡å—ï¼Œå¹¶ä¸”ç”¨äºç‰¹å®šçš„åŠŸèƒ½æˆ–è€…é¡¹ç›®ã€‚åœ¨ Node.js ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ npmï¼ˆNode Package ...">
    <link rel="stylesheet" href="/assets/css/styles.a84c0532.css">
    <link rel="preload" href="/assets/js/runtime~app.b7c0d7f2.js" as="script"><link rel="preload" href="/assets/css/styles.a84c0532.css" as="style"><link rel="preload" href="/assets/js/4485.d2710361.js" as="script"><link rel="preload" href="/assets/js/app.ed12edd2.js" as="script">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo light" src="/assets/svg/logo.svg" alt><img class="vp-nav-logo dark" src="/assets/svg/logo.svg" alt><span class="vp-site-name hide-in-pad">hanekawa-shiki</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="åšå®¢ä¸»é¡µ"><!--[--><span class="font-icon icon home" style=""></span><!--]-->åšå®¢ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="å­¦ä¹ ç¬”è®°"><!--[--><span class="font-icon icon framework" style=""></span>å­¦ä¹ ç¬”è®°<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">å‰ç«¯æ¡†æ¶</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/framework_front/vue3/" aria-label="Vue3ç¬”è®°"><!--[--><span class="font-icon icon vue" style=""></span><!--]-->Vue3ç¬”è®°<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/framework_front/react/" aria-label="Reactç¬”è®°"><!--[--><span class="font-icon icon react" style=""></span><!--]-->Reactç¬”è®°<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="æ–‡æ¡£"><!--[--><span class="font-icon icon framework" style=""></span>æ–‡æ¡£<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">æ¬è¿</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link route-link-active auto-link" href="/document/node-doc/" aria-label="Node.jsæ–‡æ¡£"><!--[--><span class="font-icon icon circle-info" style=""></span><!--]-->Node.jsæ–‡æ¡£<!----></a></li></ul></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/hanekawa-shiki/hanekawa-shiki.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/" aria-label="Node.jsæ–‡æ¡£"><!--[--><span class="font-icon icon circle-info" style=""></span><!--]-->Node.jsæ–‡æ¡£<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Assert.html" aria-label="Assert"><!---->Assert<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Async%20hooks.html" aria-label="Async hooks"><!---->Async hooks<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Asynchronous%20context%20tracking.html" aria-label="Asynchronous context tracking"><!---->Asynchronous context tracking<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Buffer.html" aria-label="Buffer"><!---->Buffer<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/C__%20addons.html" aria-label="C++ addons"><!---->C++ addons<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/C__%20embedder%20API.html" aria-label="C++ embedder API"><!---->C++ embedder API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Child%20process.html" aria-label="Child process"><!---->Child process<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Cluster.html" aria-label="Cluster"><!---->Cluster<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Command-line%20API.html" aria-label="Command-line API"><!---->Command-line API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Console.html" aria-label="Console"><!---->Console<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Corepack.html" aria-label="Corepack"><!---->Corepack<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Crypto.html" aria-label="Crypto"><!---->Crypto<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Debugger.html" aria-label="Debugger"><!---->Debugger<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Deprecated%20APIs.html" aria-label="Deprecated APIs"><!---->Deprecated APIs<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Diagnostic%20report.html" aria-label="Diagnostic report"><!---->Diagnostic report<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Diagnostics%20Channel.html" aria-label="Diagnostics Channel"><!---->Diagnostics Channel<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/DNS.html" aria-label="DNS"><!---->DNS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Domain.html" aria-label="Domain"><!---->Domain<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Errors.html" aria-label="Errors"><!---->Errors<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Events.html" aria-label="Events"><!---->Events<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/File%20system.html" aria-label="File system"><!---->File system<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Global%20objects.html" aria-label="Global objects"><!---->Global objects<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/HTTP.html" aria-label="HTTP"><!---->HTTP<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/HTTPS.html" aria-label="HTTPS"><!---->HTTPS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Inspector.html" aria-label="Inspector"><!---->Inspector<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Internationalization%20support.html" aria-label="Internationalization support"><!---->Internationalization support<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules_%20CommonJS%20modules.html" aria-label="Modules: CommonJS modules"><!---->Modules: CommonJS modules<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules_%20ECMAScript%20modules.html" aria-label="Modules: ECMAScript modules"><!---->Modules: ECMAScript modules<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules_%20node_module%20API.html" aria-label="Modules: node:module API"><!---->Modules: node:module API<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/document/node-doc/Modules_%20Packages.html" aria-label="Modules: Packages"><!---->Modules: Packages<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Net.html" aria-label="Net"><!---->Net<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Node-API.html" aria-label="Node-API"><!---->Node-API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/OS.html" aria-label="OS"><!---->OS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Path.html" aria-label="Path"><!---->Path<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Performance%20measurement%20APIs.html" aria-label="Performance measurement APIs"><!---->Performance measurement APIs<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Permissions.html" aria-label="Permissions"><!---->Permissions<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Process.html" aria-label="Process"><!---->Process<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Punycode.html" aria-label="Punycode"><!---->Punycode<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Query%20string.html" aria-label="Query string"><!---->Query string<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Readline.html" aria-label="Readline"><!---->Readline<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/REPL.html" aria-label="REPL"><!---->REPL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Stream.html" aria-label="Stream"><!---->Stream<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/String%20decoder.html" aria-label="String decoder"><!---->String decoder<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Test%20runner.html" aria-label="Test runner"><!---->Test runner<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Timers.html" aria-label="Timers"><!---->Timers<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/TLS%20(SSL).html" aria-label="TLS (SSL)"><!---->TLS (SSL)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Trace%20events.html" aria-label="Trace events"><!---->Trace events<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/TTY.html" aria-label="TTY"><!---->TTY<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/URL.html" aria-label="URL"><!---->URL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Util.html" aria-label="Util"><!---->Util<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/V8.html" aria-label="V8"><!---->V8<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/VM%20(executing%20JavaScript).html" aria-label="VM (executing JavaScript)"><!---->VM (executing JavaScript)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Web%20Crypto%20API.html" aria-label="Web Crypto API"><!---->Web Crypto API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Web%20Streams%20API.html" aria-label="Web Streams API"><!---->Web Streams API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/WebAssembly%20System%20Interface%20(WASI).html" aria-label="WebAssembly System Interface (WASI)"><!---->WebAssembly System Interface (WASI)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Worker%20threads.html" aria-label="Worker threads"><!---->Worker threads<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Zlib.html" aria-label="Zlib"><!---->Zlib<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Modules: Packages</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://hanekawa.top" target="_blank" rel="noopener noreferrer">hanekawa-shiki</a></span><span property="author" content="hanekawa-shiki"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-06-21T09:46:17.000Z"></span><!----><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 69 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT69M"></span><span class="page-word-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon" name="word"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 20822 å­—</span><meta property="wordCount" content="20822"></span><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŒ…-packages">åŒ…ï¼ˆPackagesï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#introduction">Introduction</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-çš„ç‰¹ç‚¹">Node.js çš„ç‰¹ç‚¹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#determining-module-system">Determining module system</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-commonjs-cjs">1. CommonJS ï¼ˆCJSï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-es-modules-esm">2. ES Modules (ESM)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ç¡®å®šä½¿ç”¨å“ªç§æ¨¡å—ç³»ç»Ÿ">å¦‚ä½•ç¡®å®šä½¿ç”¨å“ªç§æ¨¡å—ç³»ç»Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#introduction-1">Introduction</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-1">å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#modules-loaders">Modules loaders</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ¨¡å—åŠ è½½å™¨çš„å·¥ä½œåŸç†">æ¨¡å—åŠ è½½å™¨çš„å·¥ä½œåŸç†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#package-json-and-file-extensions">package.json and file extensions</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#package-json-and-file-extensions-1">package.json and file extensions</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#input-type-flag">--input-type flag</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-1">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#determining-package-manager">Determining package manager</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åˆ¤æ–­åŒ…ç®¡ç†å™¨">åˆ¤æ–­åŒ…ç®¡ç†å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨çš„ä¾‹å­">å®é™…åº”ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º">ç»“è®º</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#package-entry-points">Package entry points</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-package-entry-points">ä»€ä¹ˆæ˜¯ Package Entry Points?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨">å®é™…è¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#main-entry-point-export">Main entry point export</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-package-jsonå’Œä¸»å…¥å£ç‚¹çš„åŸºç¡€">1. package.jsonå’Œä¸»å…¥å£ç‚¹çš„åŸºç¡€ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-å®é™…åº”ç”¨ä¾‹å­">2. å®é™…åº”ç”¨ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-æ›´æ·±å…¥çš„ç†è§£">3. æ›´æ·±å…¥çš„ç†è§£ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#subpath-exports">Subpath exports</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#exports-sugar">Exports sugar</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-exports-sugar">ä»€ä¹ˆæ˜¯ Exports Sugarï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#subpath-imports">Subpath imports</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£-subpath-imports">ç†è§£ Subpath imports</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨">å¦‚ä½•ä½¿ç”¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ›´é«˜çº§çš„ç”¨æ³•">æ›´é«˜çº§çš„ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#subpath-patterns">Subpath patterns</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-subpath-patterns">ä½¿ç”¨ Subpath Patterns</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹">ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨-1">å®é™…è¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-1">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#conditional-exports">Conditional exports</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆéœ€è¦æ¡ä»¶æ€§å¯¼å‡º">ä¸ºä»€ä¹ˆéœ€è¦æ¡ä»¶æ€§å¯¼å‡ºï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•å·¥ä½œ">å¦‚ä½•å·¥ä½œï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-1">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-1">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#nested-conditions">Nested conditions</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€ç†è§£">åŸºç¡€ç†è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åµŒå¥—æ¡ä»¶çš„æ¦‚å¿µ">åµŒå¥—æ¡ä»¶çš„æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-3">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-2">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#resolving-user-conditions">Resolving user conditions</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€ç†è§£-1">åŸºç¡€ç†è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-resolving-user-conditions">è§£é‡Š &quot;Resolving user conditions&quot;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-1">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#é‡ç‚¹å½’çº³">é‡ç‚¹å½’çº³</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#community-conditions-definitions">Community Conditions Definitions</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-æ¡ä»¶å¯¼å‡º-conditional-exports">1. æ¡ä»¶å¯¼å‡ºï¼ˆConditional Exportsï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-è‡ªå®šä¹‰æ¡ä»¶">2. è‡ªå®šä¹‰æ¡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨">å®é™…åº”ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#self-referencing-a-package-using-its-name">Self-referencing a package using its name</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è‡ªå¼•ç”¨æ˜¯ä»€ä¹ˆ">è‡ªå¼•ç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆéœ€è¦è‡ªå¼•ç”¨">ä¸ºä»€ä¹ˆéœ€è¦è‡ªå¼•ç”¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨è‡ªå¼•ç”¨">å¦‚ä½•ä½¿ç”¨è‡ªå¼•ç”¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-4">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dual-commonjs-es-module-packages">Dual CommonJS/ES module packages</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#commonjs-å’Œ-es-module-ç®€ä»‹">CommonJS å’Œ ES Module ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŒæ¨¡å—åŒ…-dual-package">åŒæ¨¡å—åŒ…ï¼ˆDual Packageï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•åˆ›å»ºåŒæ¨¡å—åŒ…">å¦‚ä½•åˆ›å»ºåŒæ¨¡å—åŒ…</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-5">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dual-package-hazard">Dual package hazard</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-æ¨¡å—ç³»ç»Ÿ">Node.js æ¨¡å—ç³»ç»Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-dual-package-hazard">ä»€ä¹ˆæ˜¯ Dual Package Hazardï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹å’Œè§£é‡Š">ç¤ºä¾‹å’Œè§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#é¿å…åŒåŒ…å±å®³">é¿å…åŒåŒ…å±å®³</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#writing-dual-packages-while-avoiding-or-minimizing-hazards">Writing dual packages while avoiding or minimizing hazards</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#èƒŒæ™¯">èƒŒæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŒåŒ…ç¼–å†™æ—¶çš„æŒ‘æˆ˜">åŒåŒ…ç¼–å†™æ—¶çš„æŒ‘æˆ˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®è·µå»ºè®®">å®è·µå»ºè®®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-2">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…æ“ä½œæ­¥éª¤">å®é™…æ“ä½œæ­¥éª¤:</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-2">å®é™…è¿ç”¨ä¾‹å­:</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#approach-2-isolate-state-1">Approach #2: Isolate State</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#node-js-package-json-field-definitions">Node.js package.json field definitions</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-name">1. name</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-version">2. version</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-scripts">3. scripts</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-dependencies-å’Œ-devdependencies">4. dependencies å’Œ devDependencies</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-main-å’Œ-exports">5. main å’Œ exports</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-type">6. type</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-4">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#name">&quot;name&quot;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åç§°-name">åç§°ï¼ˆ&quot;name&quot;ï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#main">&quot;main&quot;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#main-å±æ€§çš„ä½œç”¨">&quot;main&quot;å±æ€§çš„ä½œç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¸¾ä¾‹">å®é™…è¿ç”¨ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#packagemanager">&quot;packageManager&quot;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#type">&quot;type&quot;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#type-module">&quot;type&quot;: &quot;module&quot;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#type-commonjs">&quot;type&quot;: &quot;commonjs&quot;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#exports">&quot;exports&quot;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-1">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-exports">ä½¿ç”¨ exports</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-3">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#imports">&quot;imports&quot;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬ç”¨é€”">åŸºæœ¬ç”¨é€”</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-1">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-5">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-4">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="modules-packages" tabindex="-1"><a class="header-anchor" href="#modules-packages"><span><a href="https://nodejs.org/docs/latest/api/packages.html#modules-packages" target="_blank" rel="noopener noreferrer">Modules: Packages</a></span></a></h1><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©ä½ å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚å…¶ä¸­ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µæ˜¯æ¨¡å—ï¼ˆModulesï¼‰ï¼Œè€ŒåŒ…ï¼ˆPackagesï¼‰åˆ™æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ¨¡å—ï¼Œé€šå¸¸åŒ…å«å¤šä¸ªæ¨¡å—ï¼Œå¹¶ä¸”ç”¨äºç‰¹å®šçš„åŠŸèƒ½æˆ–è€…é¡¹ç›®ã€‚åœ¨ Node.js ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ npmï¼ˆNode Package Managerï¼‰æ¥ç®¡ç†è¿™äº›åŒ…ã€‚</p><h3 id="åŒ…-packages" tabindex="-1"><a class="header-anchor" href="#åŒ…-packages"><span>åŒ…ï¼ˆPackagesï¼‰</span></a></h3><p>ä¸€ä¸ªåŒ…å…¶å®å°±æ˜¯ä¸€ä¸ªåŒ…å« <code>package.json</code> æ–‡ä»¶çš„ç›®å½•ã€‚<code>package.json</code> æ–‡ä»¶æè¿°äº†è¿™ä¸ªåŒ…çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ¯”å¦‚åŒ…çš„åç§°ã€ç‰ˆæœ¬ã€ä¾èµ–ç­‰ã€‚è¿™äº›åŒ…å¯ä»¥æ˜¯ä¸€äº›åº“ï¼ˆä¾‹å¦‚ï¼šReactã€Lodashï¼‰ã€æ¡†æ¶ï¼ˆä¾‹å¦‚ï¼šExpressã€NestJSï¼‰æˆ–è€…æ˜¯å…¶ä»–ä»»ä½•ä½ å¯ä»¥ä» npm ä¸Šä¸‹è½½çš„ä»£ç ã€‚</p><h4 id="ä¸ºä»€ä¹ˆéœ€è¦åŒ…" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆéœ€è¦åŒ…"><span>ä¸ºä»€ä¹ˆéœ€è¦åŒ…ï¼Ÿ</span></a></h4><ul><li><strong>å¤ç”¨æ€§</strong>ï¼šé€šè¿‡å°†åŠŸèƒ½å°è£…åœ¨åŒ…ä¸­ï¼Œå…¶ä»–é¡¹ç›®å¯ä»¥è½»æ¾å¤ç”¨è¿™äº›åŠŸèƒ½ï¼Œæ— éœ€é‡æ–°ç¼–å†™ä»£ç ã€‚</li><li><strong>ç®¡ç†ä¾¿æ·</strong>ï¼šnpm å¯ä»¥å¸®åŠ©ä½ ç®¡ç†é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ï¼Œç¡®ä¿é¡¹ç›®çš„ç¨³å®šæ€§ã€‚</li><li><strong>ç¤¾åŒºæ”¯æŒ</strong>ï¼šæˆåƒä¸Šä¸‡çš„å¼€å‘è€…è´¡çŒ®äº†ä»–ä»¬çš„ä»£ç ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°æ‰¾åˆ°è§£å†³ç‰¹å®šé—®é¢˜çš„åŒ…ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>æ„å»ºç½‘ç«™åç«¯</strong></p><p>ä½¿ç”¨ Express æ¡†æ¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªç®€æ´è€Œçµæ´»çš„ node.js Web åº”ç”¨æ¡†æ¶ï¼Œæä¾›äº†ä¸€ç³»åˆ—å¼ºå¤§ç‰¹æ€§å¸®åŠ©ä½ åˆ›å»ºå„ç§ Web å’Œç§»åŠ¨è®¾å¤‡åº”ç”¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> express</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">express</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> app</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> express</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">app</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> function</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">req</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> res</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">send</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello World!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">app</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">listen</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">3000</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> function</span><span style="color:#ECEFF4;"> ()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Example app listening on port 3000!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ“ä½œæ•°æ®åº“</strong></p><p>ä½¿ç”¨ Mongoose æ“ä½œ MongoDB æ•°æ®åº“ã€‚Mongoose æä¾›äº†ä¸€ç§ç›´æ¥åœ¨ Node.js ç¯å¢ƒä¸‹æ“ä½œ MongoDB æ•°æ®åº“çš„æ–¹å¼ï¼ŒåŒ…æ‹¬æ•°æ®æ¨¡å‹å®šä¹‰ã€æ•°æ®éªŒè¯ç­‰åŠŸèƒ½ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> mongoose</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">mongoose</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">mongoose</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">connect</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">mongodb://localhost/test</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> Cat</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> mongoose</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">model</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Cat</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> name</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9;"> String</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> kitty</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Cat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">{</span><span style="color:#88C0D0;"> name</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Zildjian</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">kitty</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">save</span><span style="color:#D8DEE9FF;">()</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">then</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#D8DEE9;"> console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">meow</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>åˆ›å»º RESTful API</strong></p><p>ç»“åˆ Express å’Œ Mongooseï¼Œä½ å¯ä»¥å¿«é€Ÿæ„å»ºå‡ºä¸€ä¸ª RESTful APIï¼Œå¯¹å¤–æä¾›æ•°æ®æœåŠ¡ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> express</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">express</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> app</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> express</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> mongoose</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">mongoose</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ•°æ®åº“è¿æ¥çœç•¥...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®šä¹‰è·¯ç”±å¤„ç†è¯·æ±‚</span></span>
<span class="line"><span style="color:#D8DEE9;">app</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/api/cats</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> async</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">req</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> res</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> cats</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> Cat</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">find</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">send</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">cats</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¯åŠ¨æœåŠ¡</span></span>
<span class="line"><span style="color:#D8DEE9;">app</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">listen</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">3000</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Server running on port 3000</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“"><span>æ€»ç»“</span></a></h3><p>Node.js çš„åŒ…å’Œæ¨¡å—ç³»ç»Ÿæ˜¯å®ƒçš„æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€ï¼Œé€šè¿‡ npm å’Œ package.json ç®¡ç†é¡¹ç›®ä¾èµ–ï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å…±äº«å’Œå¤ç”¨ä»£ç ã€‚å®è·µä¸­ï¼Œæ— è®ºæ˜¯æ„å»ºç½‘ç«™åç«¯ã€æ“ä½œæ•°æ®åº“è¿˜æ˜¯åˆ›å»º RESTful APIï¼Œéƒ½ä¼šå¤§é‡ä½¿ç”¨åˆ°ç¬¬ä¸‰æ–¹çš„åŒ…ã€‚è¿™ä¸ä»…åŠ å¿«äº†å¼€å‘é€Ÿåº¦ï¼Œè¿˜æé«˜äº†é¡¹ç›®çš„å¯ç»´æŠ¤æ€§å’Œç¨³å®šæ€§ã€‚</p><h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction"><span><a href="https://nodejs.org/docs/latest/api/packages.html#introduction" target="_blank" rel="noopener noreferrer">Introduction</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªå¼€æºå’Œè·¨å¹³å°çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚Node.js ä¸æ˜¯ä¸€ç§ç‹¬ç«‹çš„ç¼–ç¨‹è¯­è¨€ï¼Œè€Œæ˜¯ä¸€ä¸ªç¯å¢ƒï¼Œä½¿ç”¨ V8 å¼•æ“ï¼ˆåŒæ ·ç”¨äº Google Chrome æµè§ˆå™¨ï¼‰æ¥æ‰§è¡Œ JavaScript ä»£ç ã€‚</p><h3 id="node-js-çš„ç‰¹ç‚¹" tabindex="-1"><a class="header-anchor" href="#node-js-çš„ç‰¹ç‚¹"><span>Node.js çš„ç‰¹ç‚¹ï¼š</span></a></h3><ol><li><p><strong>å¼‚æ­¥éé˜»å¡ I/Oï¼ˆè¾“å…¥/è¾“å‡ºï¼‰</strong>ï¼šè¿™æ„å‘³ç€å½“ Node.js æ‰§è¡Œ I/O æ“ä½œï¼ˆå¦‚è¯»å–æ–‡ä»¶ã€ç½‘ç»œè¯·æ±‚ç­‰ï¼‰æ—¶ï¼Œå®ƒä¸ä¼šåœä¸‹æ¥ç­‰å¾…æ“ä½œå®Œæˆï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚å½“ I/O æ“ä½œå®Œæˆåï¼Œå®ƒå°†ä»¥äº‹ä»¶çš„å½¢å¼é€šçŸ¥ç›¸å…³çš„å¤„ç†ç¨‹åºã€‚è¿™ç§æ¨¡å¼æœ‰åŠ©äºæé«˜æ€§èƒ½å’Œååé‡ã€‚</p></li><li><p><strong>å•çº¿ç¨‹</strong>ï¼šå°½ç®¡ Node.js åœ¨å†…éƒ¨ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œä½†ä»å¼€å‘è€…çš„è§’åº¦æ¥çœ‹ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªå•çº¿ç¨‹æ¨¡å‹ã€‚æ‰€æœ‰çš„ç”¨æˆ·ä»£ç éƒ½åœ¨è¿™ä¸ªå•ä¸€çš„çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œè¿™ç®€åŒ–äº†åº”ç”¨ç¨‹åºçš„å¼€å‘ï¼Œå› ä¸ºä½ ä¸éœ€è¦æ‹…å¿ƒçº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</p></li><li><p><strong>äº‹ä»¶é©±åŠ¨</strong>ï¼šNode.js ä½¿ç”¨äº‹ä»¶å¾ªç¯æ¥å¤„ç†å¼‚æ­¥æ“ä½œï¼Œä½¿å¾—å¯ä»¥åœ¨å›è°ƒå‡½æ•°ä¸­å¤„ç†äº‹ä»¶ï¼ˆå¦‚ç”¨æˆ·è¿æ¥åˆ°æœåŠ¡å™¨ã€æ–‡ä»¶è¯»å–å®Œæˆç­‰ï¼‰ã€‚</p></li></ol><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><h4 id="_1-web-æœåŠ¡å™¨" tabindex="-1"><a class="header-anchor" href="#_1-web-æœåŠ¡å™¨"><span>1. Web æœåŠ¡å™¨</span></a></h4><p>Node.js æœ€å¸¸è§çš„ç”¨é€”ä¹‹ä¸€å°±æ˜¯åˆ›å»º Web æœåŠ¡å™¨ã€‚åˆ©ç”¨ Node.jsï¼Œä½ å¯ä»¥è½»æ¾åˆ›å»ºä¸€ä¸ªèƒ½å¤Ÿå¤„ç† Web è¯·æ±‚çš„æœåŠ¡å™¨ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ Express æ¡†æ¶ï¼Œä½ å¯ä»¥å¿«é€Ÿæ­å»ºä¸€ä¸ªæœåŠ¡å™¨ï¼Œæä¾›é™æ€æ–‡ä»¶æœåŠ¡æˆ–è€… API æ¥å£ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> express</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">express</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> app</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> express</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> port</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 3000</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">app</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">req</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> res</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">send</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello World!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">app</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">listen</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">port</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Example app listening at http://localhost:</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">port</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-å®æ—¶é€šä¿¡åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#_2-å®æ—¶é€šä¿¡åº”ç”¨"><span>2. å®æ—¶é€šä¿¡åº”ç”¨</span></a></h4><p>Node.js çš„éé˜»å¡ I/O å’Œäº‹ä»¶é©±åŠ¨çš„ç‰¹æ€§ä½¿å…¶éå¸¸é€‚åˆå¼€å‘å®æ—¶é€šä¿¡åº”ç”¨ï¼Œæ¯”å¦‚åœ¨çº¿èŠå¤©å®¤ã€å®æ—¶æ•°æ®æ›´æ–°çš„åº”ç”¨ç­‰ã€‚<a href="http://Socket.IO" target="_blank" rel="noopener noreferrer">Socket.IO</a> æ˜¯ä¸€ä¸ªæµè¡Œçš„ WebSocket åº“ï¼Œè®©åœ¨æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´å®æ—¶ã€åŒå‘ã€äº‹ä»¶é©±åŠ¨çš„é€šä¿¡å˜å¾—ç®€å•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> express</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">express</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> http</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">http</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> socketIo</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">socket.io</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> app</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> express</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> server</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> http</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createServer</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">app</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> io</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> socketIo</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">server</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">io</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">connection</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">socket</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">A user connected</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  socket</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">disconnect</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">User disconnected</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">server</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">listen</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">3000</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">listening on *:3000</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-è„šæœ¬å’Œè‡ªåŠ¨åŒ–å·¥å…·" tabindex="-1"><a class="header-anchor" href="#_3-è„šæœ¬å’Œè‡ªåŠ¨åŒ–å·¥å…·"><span>3. è„šæœ¬å’Œè‡ªåŠ¨åŒ–å·¥å…·</span></a></h4><p>Node.js ä¹Ÿè¢«å¹¿æ³›ç”¨äºå†™å°å‹è„šæœ¬å’Œè‡ªåŠ¨åŒ–ä»»åŠ¡ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥è‡ªåŠ¨åŒ–æ—¥å¸¸é‡å¤çš„ä»»åŠ¡ï¼Œå¦‚å‹ç¼©å›¾ç‰‡ã€è½¬æ¢æ•°æ®æ ¼å¼ã€æ‰¹é‡é‡å‘½åæ–‡ä»¶ç­‰ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./images</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> files</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  files</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forEach</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">file</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // å¯¹æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œä¾‹å¦‚å‹ç¼©å›¾ç‰‡</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">file</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ€»ç»“æ¥è¯´ï¼ŒNode.js æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ç¯å¢ƒï¼Œé€‚ç”¨äºå¼€å‘å„ç§ç±»å‹çš„åº”ç”¨ç¨‹åºï¼Œä» Web æœåŠ¡å™¨åˆ°å®æ—¶é€šä¿¡åº”ç”¨ï¼Œå†åˆ°ç®€å•çš„è„šæœ¬å’Œè‡ªåŠ¨åŒ–å·¥å…·ã€‚å®ƒçš„å¼‚æ­¥éé˜»å¡ I/Oã€å•çº¿ç¨‹ã€äº‹ä»¶é©±åŠ¨çš„ç‰¹ç‚¹ä½¿å…¶æˆä¸ºé«˜æ€§èƒ½ã€é«˜å¯æ‰©å±•æ€§åº”ç”¨çš„ç†æƒ³é€‰æ‹©ã€‚</p><h2 id="determining-module-system" tabindex="-1"><a class="header-anchor" href="#determining-module-system"><span><a href="https://nodejs.org/docs/latest/api/packages.html#determining-module-system" target="_blank" rel="noopener noreferrer">Determining module system</a></span></a></h2><p>ç†è§£ Node.js ä¸­çš„æ¨¡å—ç³»ç»Ÿæ˜¯å­¦ä¹ è¿™ä¸ªå¹³å°çš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†ã€‚åœ¨ Node.js çš„ä¸åŒç‰ˆæœ¬ä¸­ï¼Œå¦‚ v21.7.1ï¼Œå®ƒæä¾›äº†ä¸¤ç§ä¸»è¦çš„ä»£ç ç»„ç»‡æ–¹å¼æˆ–â€œæ¨¡å—ç³»ç»Ÿâ€ï¼šCommonJS å’Œ ES Modulesï¼ˆESMï¼‰ã€‚æ¯ç§æ–¹å¼æœ‰å…¶ç‰¹å®šçš„è¯­æ³•å’Œä½¿ç”¨åœºæ™¯ã€‚</p><h3 id="_1-commonjs-cjs" tabindex="-1"><a class="header-anchor" href="#_1-commonjs-cjs"><span>1. CommonJS ï¼ˆCJSï¼‰</span></a></h3><p><strong>æ¦‚å¿µ</strong>: CommonJS æ˜¯ Node.js æœ€ä¼ ç»Ÿçš„æ¨¡å—ç³»ç»Ÿã€‚åœ¨è¿™ä¸ªç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶è¢«è§†ä¸ºä¸€ä¸ªæ¨¡å—ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>require()</code> å‡½æ•°æ¥å¯¼å…¥å…¶ä»–æ¨¡å—ï¼Œå¹¶ä½¿ç”¨ <code>module.exports</code> æˆ– <code>exports</code> æ¥å¯¼å‡ºåŠŸèƒ½ã€‚</p><p><strong>å®é™…åº”ç”¨ä¸¾ä¾‹</strong>:</p><p>å‡è®¾æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªç®€å•çš„æ¨¡å—æ¥å¤„ç†æ•°å­¦è¿ç®—ï¼Œæ¯”å¦‚åŠ æ³•ã€‚</p><p><em>åˆ›å»ºæ¨¡å—æ–‡ä»¶ math.js:</em></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// math.js</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> add</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">a</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> b</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  return</span><span style="color:#D8DEE9;"> a</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;"> b</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8FBCBB;">module</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">exports</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> add</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>åœ¨å¦ä¸€ä¸ªæ–‡ä»¶ä¸­ä½¿ç”¨æ­¤æ¨¡å—:</em></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// app.js</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> math</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./math</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">math</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 3</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: 5</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-es-modules-esm" tabindex="-1"><a class="header-anchor" href="#_2-es-modules-esm"><span>2. ES Modules (ESM)</span></a></h3><p><strong>æ¦‚å¿µ</strong>: ES Modules æ˜¯è¾ƒæ–°çš„ JavaScript å®˜æ–¹æ¨¡å—ç³»ç»Ÿï¼Œç°ä»£æµè§ˆå™¨å’Œæœ€æ–°ç‰ˆæœ¬çš„ Node.js éƒ½æ”¯æŒå®ƒã€‚ESM ä½¿ç”¨ <code>import</code> å’Œ <code>export</code> å…³é”®å­—æ¥å¯¼å…¥å’Œå¯¼å‡ºæ¨¡å—ã€‚</p><p><strong>å®é™…åº”ç”¨ä¸¾ä¾‹</strong>:</p><p>æˆ‘ä»¬ç”¨ ESM æ”¹å†™ä¸Šé¢çš„åŠ æ³•æ¨¡å—ã€‚</p><p><em>åˆ›å»ºæ¨¡å—æ–‡ä»¶ math.js:</em></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// math.js</span></span>
<span class="line"><span style="color:#81A1C1;">export</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> add</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">a</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> b</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  return</span><span style="color:#D8DEE9;"> a</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;"> b</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>åœ¨å¦ä¸€ä¸ªæ–‡ä»¶ä¸­ä½¿ç”¨æ­¤æ¨¡å—:</em></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// app.js</span></span>
<span class="line"><span style="color:#81A1C1;">import</span><span style="color:#ECEFF4;"> {</span><span style="color:#8FBCBB;"> add</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./math.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#88C0D0;">add</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 3</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: 5</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å¦‚ä½•ç¡®å®šä½¿ç”¨å“ªç§æ¨¡å—ç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ç¡®å®šä½¿ç”¨å“ªç§æ¨¡å—ç³»ç»Ÿ"><span>å¦‚ä½•ç¡®å®šä½¿ç”¨å“ªç§æ¨¡å—ç³»ç»Ÿ</span></a></h3><p>Node.js ç¡®å®šä½¿ç”¨å“ªç§æ¨¡å—ç³»ç»Ÿçš„æ–¹æ³•ä¸»è¦ä¾èµ–äºæ–‡ä»¶æ‰©å±•åå’Œ <code>package.json</code> ä¸­çš„ <code>&quot;type&quot;</code> å­—æ®µã€‚</p><ul><li>å¦‚æœ <code>package.json</code> ä¸­çš„ <code>&quot;type&quot;</code> å­—æ®µè®¾ç½®ä¸º <code>&quot;module&quot;</code>ï¼Œåˆ™ Node.js å°†ä¼šé»˜è®¤ä½¿ç”¨ ESMã€‚</li><li>åä¹‹ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½® <code>&quot;type&quot;</code> å­—æ®µæˆ–è€…è®¾ç½®ä¸º <code>&quot;commonjs&quot;</code>ï¼Œåˆ™é»˜è®¤ä½¿ç”¨ CommonJSã€‚</li><li>å¯¹äº <code>.js</code> æ–‡ä»¶ï¼ŒNode.js ä¼šæ ¹æ® <code>package.json</code> ä¸­çš„ <code>&quot;type&quot;</code> å­—æ®µå†³å®šå¦‚ä½•å¤„ç†ã€‚å¦‚æœæ˜¯ <code>&quot;module&quot;</code>ï¼Œ<code>.js</code> æ–‡ä»¶å°†ä½œä¸º ES module å¤„ç†ï¼›å¦‚æœæ˜¯ <code>&quot;commonjs&quot;</code>ï¼Œåˆ™ä½œä¸º CommonJS æ¨¡å—å¤„ç†ã€‚</li><li><code>.mjs</code> æ–‡ä»¶æ€»æ˜¯ä½œä¸º ES Modules å¤„ç†ï¼Œè€Œ <code>.cjs</code> æ–‡ä»¶æ€»æ˜¯ä½œä¸º CommonJS æ¨¡å—å¤„ç†ï¼Œæ— è®º <code>package.json</code> ä¸­çš„ <code>&quot;type&quot;</code> å­—æ®µå¦‚ä½•è®¾ç½®ã€‚</li></ul><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒNode.js æä¾›äº†çµæ´»æ€§ï¼Œå…è®¸å¼€å‘äººå‘˜æ ¹æ®é¡¹ç›®éœ€æ±‚é€‰æ‹©æœ€é€‚åˆçš„æ¨¡å—ç³»ç»Ÿã€‚</p><h3 id="introduction-1" tabindex="-1"><a class="header-anchor" href="#introduction-1"><span><a href="https://nodejs.org/docs/latest/api/packages.html#introduction_1" target="_blank" rel="noopener noreferrer">Introduction</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€é€šè¿‡ Node.jsï¼ŒJavaScript å¯ä»¥ç”¨æ¥åšå¾ˆå¤šåç«¯çš„ä»»åŠ¡ï¼Œæ¯”å¦‚ä¸æ•°æ®åº“äº¤äº’ã€æ–‡ä»¶æ“ä½œã€ç½‘ç»œé€šä¿¡ç­‰ï¼Œè€Œä¸ä»…ä»…æ˜¯åœ¨æµè§ˆå™¨ä¸­è¿è¡Œä»¥åˆ¶ä½œåŠ¨æ€ç½‘é¡µã€‚</p><p>åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œæœ‰ä¸€ä¸ªéƒ¨åˆ†ä¸“é—¨ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Node.js æ¥å¤„ç†åŒ…å’Œæ¨¡å—ã€‚åœ¨ Node.js ä¸­ï¼Œâ€œåŒ…â€ï¼ˆPackageï¼‰æŒ‡çš„æ˜¯ä¸€ä¸ªåŒ…å«äº†ä¸€ç»„åŠŸèƒ½æˆ–åº“çš„æ–‡ä»¶å¤¹ï¼Œè¿™äº›åŠŸèƒ½å¯ä»¥è¢«é¡¹ç›®å¼•ç”¨æˆ–è€…ä½¿ç”¨ã€‚â€œæ¨¡å—â€ï¼ˆModuleï¼‰åˆ™æ˜¯ Node.js åº”ç”¨ç¨‹åºä¸­çš„ä¸€ä¸ªç‹¬ç«‹çš„åŠŸèƒ½å•å…ƒï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªåŒ…ï¼Œä¹Ÿå¯ä»¥æ˜¯å•ä¸ªçš„æ–‡ä»¶ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-1"><span>å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</span></a></h3><ol><li><strong>åˆ›å»º HTTP æœåŠ¡å™¨ï¼š</strong> ä½¿ç”¨ Node.js çš„ <code>http</code> æ¨¡å—ï¼Œä½ å¯ä»¥è½»æ¾åˆ›å»ºä¸€ä¸ªç®€å•çš„ HTTP æœåŠ¡å™¨ï¼Œèƒ½å¤Ÿå“åº”ç”¨æˆ·çš„ç½‘ç»œè¯·æ±‚ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç®€å•çš„æœåŠ¡å™¨ï¼Œå½“ç”¨æˆ·è®¿é—®æ—¶ï¼Œè¿”å› &quot;Hello, World!&quot;ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> http</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">http</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> server</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> http</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createServer</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">req</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> res</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  res</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">statusCode</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 200</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">setHeader</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Content-Type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">text/plain</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello, World!</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> port</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 3000</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> hostname</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">127.0.0.1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">server</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">listen</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">port</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> hostname</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Server running at http://</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">hostname</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">:</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">port</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">/</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å¯åŠ¨äº†ä¸€ä¸ªç›‘å¬åœ¨æœ¬åœ°çš„ 3000 ç«¯å£ä¸Šçš„æœåŠ¡å™¨ã€‚</p><ol start="2"><li><strong>è¯»å†™æ–‡ä»¶ï¼š</strong> ä½¿ç”¨ Node.js çš„ <code>fs</code>ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰æ¨¡å—ï¼Œä½ å¯ä»¥æ‰§è¡Œæ–‡ä»¶çš„è¯»å†™æ“ä½œã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†å¦‚ä½•è¯»å–ä¸€ä¸ªåä¸º &quot;example.txt&quot; çš„æ–‡ä»¶ï¼Œå¹¶åœ¨æ§åˆ¶å°è¾“å‡ºå…¶å†…å®¹ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶ä¸”æ²¡æœ‰é”™è¯¯ï¼Œä½ å°†çœ‹åˆ°æ–‡ä»¶å†…å®¹è¢«æ‰“å°å‡ºæ¥ã€‚</p><ol start="3"><li><strong>æ„å»º RESTful APIï¼š</strong> åœ¨ç°ä»£çš„ Web å¼€å‘ä¸­ï¼Œæ„å»º RESTful API æ˜¯ä¸€é¡¹éå¸¸å¸¸è§çš„ä»»åŠ¡ã€‚Node.js éå¸¸é€‚åˆè¿™é¡¹å·¥ä½œï¼Œå› ä¸ºå®ƒæ”¯æŒå¼‚æ­¥ I/Oï¼Œèƒ½å¤Ÿé«˜æ•ˆåœ°å¤„ç†å¤§é‡çš„å¹¶å‘è¿æ¥ã€‚ä½¿ç”¨ Express.js è¿™æ ·çš„æ¡†æ¶ï¼Œå¯ä»¥æ›´åŠ æ–¹ä¾¿åœ°åˆ›å»º RESTful APIã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> express</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">express</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> app</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> express</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> port</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 3000</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">app</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/api/greeting</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">req</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> res</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">status</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">200</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">send</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">{</span><span style="color:#88C0D0;"> message</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, World!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">app</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">listen</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">port</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Example app listening at http://localhost:</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">port</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šä»£ç åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„ APIï¼Œå½“è®¿é—® <code>/api/greeting</code> è·¯å¾„æ—¶ï¼Œè¿”å›ä¸€ä¸ªåŒ…å« &quot;Hello, World!&quot; æ¶ˆæ¯çš„ JSON å¯¹è±¡ã€‚</p><p>Node.js çš„çµæ´»æ€§å’Œå¼ºå¤§åŠŸèƒ½ä½¿å¾—å®ƒæˆä¸ºå¼€å‘å„ç§åº”ç”¨çš„ç†æƒ³é€‰æ‹©ï¼Œæ— è®ºæ˜¯å°å‹é¡¹ç›®è¿˜æ˜¯å¤§å‹ä¼ä¸šçº§åº”ç”¨ã€‚é€šè¿‡åˆ©ç”¨åŒ…å’Œæ¨¡å—ï¼ŒNode.js å¼€å‘è€…èƒ½å¤Ÿæ„å»ºå‡ºç»“æ„æ¸…æ™°ã€æ˜“äºç»´æŠ¤çš„ä»£ç ã€‚</p><h3 id="modules-loaders" tabindex="-1"><a class="header-anchor" href="#modules-loaders"><span><a href="https://nodejs.org/docs/latest/api/packages.html#modules-loaders" target="_blank" rel="noopener noreferrer">Modules loaders</a></span></a></h3><p>Node.js ä¸­çš„æ¨¡å—åŠ è½½å™¨æ˜¯ä¸€ä¸ªç³»ç»Ÿï¼Œå®ƒè´Ÿè´£åœ¨ç¨‹åºä¸­å¼•å…¥å’Œä½¿ç”¨ä¸åŒçš„æ¨¡å—ã€‚æ¨¡å—å¯ä»¥è§†ä¸ºåŒ…å«ç‰¹å®šåŠŸèƒ½çš„ JavaScript æ–‡ä»¶æˆ–ä»£ç åº“ã€‚æƒ³è±¡ä¸€ä¸‹ä½ æ­£åœ¨å»ºé€ ä¸€ä¸ªæœºå™¨äººï¼Œè€Œæ¯ä¸ªæ¨¡å—å°±åƒæ˜¯æœºå™¨äººçš„ä¸€ä¸ªé›¶ä»¶ï¼ˆæ¯”å¦‚æ‰‹è‡‚ã€è„šã€å¤´ç­‰ï¼‰ã€‚åœ¨ Node.js ä¸­ï¼Œå¦‚æœä½ éœ€è¦æŸä¸ªåŠŸèƒ½ï¼Œä½ å°±å¯ä»¥é€šè¿‡æ¨¡å—åŠ è½½å™¨å¼•å…¥ç›¸åº”çš„æ¨¡å—ï¼Œè€Œä¸å¿…è‡ªå·±ä»å¤´å¼€å§‹å†™æ‰€æœ‰çš„ä»£ç ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p><strong>1. ä½¿ç”¨å†…ç½®æ¨¡å—ï¼š</strong></p><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js ç¨‹åºï¼Œéœ€è¦è¯»å–å’Œå†™å…¥æ–‡ä»¶ã€‚Node.js æœ‰ä¸€ä¸ªå†…ç½®çš„æ¨¡å—å«åš<code>fs</code>ï¼ˆæ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼‰ï¼Œä¸“é—¨ç”¨äºå¤„ç†æ–‡ä»¶æ“ä½œã€‚ä½ å¯ä»¥è¿™æ ·ä½¿ç”¨å®ƒï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åŒæ­¥å†™å…¥æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">output.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">è¿™é‡Œæ˜¯è¦å†™å…¥çš„å†…å®¹</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œé€šè¿‡ä½¿ç”¨<code>require</code>å‡½æ•°ï¼Œæˆ‘ä»¬åŠ è½½äº†<code>fs</code>æ¨¡å—ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥è¯»å–å’Œå†™å…¥æ–‡ä»¶ã€‚</p><p><strong>2. ä½¿ç”¨ç¬¬ä¸‰æ–¹æ¨¡å—ï¼š</strong></p><p>è®¸å¤šæ—¶å€™ï¼Œç¤¾åŒºå·²ç»å¼€å‘äº†å¼ºå¤§çš„æ¨¡å—æ¥å¸®åŠ©ä½ å®Œæˆä»»åŠ¡ã€‚ä¾‹å¦‚ï¼Œ<code>express</code>æ˜¯ä¸€ä¸ªæµè¡Œçš„ Node.js æ¡†æ¶ï¼Œä¸“é—¨ç”¨äºæ„å»º web æœåŠ¡å™¨ã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦ä½¿ç”¨ npmï¼ˆNode.js çš„åŒ…ç®¡ç†å™¨ï¼‰å®‰è£… expressï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>npm install express</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç„¶åï¼Œä½ å¯ä»¥åœ¨ä½ çš„ç¨‹åºä¸­è¿™æ ·ä½¿ç”¨å®ƒï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> express</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">express</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> app</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> express</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">app</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">req</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> res</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">send</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello World!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">app</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">listen</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">3000</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Server is running on http://localhost:3000</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„ web æœåŠ¡å™¨ï¼Œå½“ä½ è®¿é—®<code>http://localhost:3000</code>æ—¶ï¼Œå®ƒä¼šè¿”å›&quot;Hello World!&quot;ã€‚</p><h3 id="æ¨¡å—åŠ è½½å™¨çš„å·¥ä½œåŸç†" tabindex="-1"><a class="header-anchor" href="#æ¨¡å—åŠ è½½å™¨çš„å·¥ä½œåŸç†"><span>æ¨¡å—åŠ è½½å™¨çš„å·¥ä½œåŸç†</span></a></h3><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼ˆä»¥åŠå…¶ä»–ç‰ˆæœ¬ï¼‰ï¼Œå½“ä½ ä½¿ç”¨<code>require</code>å‡½æ•°æ¥åŠ è½½ä¸€ä¸ªæ¨¡å—æ—¶ï¼ŒNode.js ä¼šæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li><strong>è§£æ</strong>ï¼šç¡®å®šæ¨¡å—çš„ä½ç½®ã€‚å¦‚æœæ˜¯å†…ç½®æ¨¡å—ï¼ˆå¦‚<code>fs</code>ï¼‰ï¼Œåˆ™ç›´æ¥è¿›å…¥åŠ è½½æ­¥éª¤ï¼›å¦‚æœæ˜¯ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œåˆ™ä¼šæŸ¥æ‰¾<code>node_modules</code>æ–‡ä»¶å¤¹ã€‚</li><li><strong>åŠ è½½</strong>ï¼šè¯»å–æ¨¡å—æ–‡ä»¶çš„å†…å®¹ã€‚</li><li><strong>ç¼–è¯‘</strong>ï¼šå°†æ¨¡å—ä»£ç ç¼–è¯‘æˆå¯æ‰§è¡Œçš„ JavaScript ä»£ç ã€‚</li><li><strong>æ‰§è¡Œ</strong>ï¼šè¿è¡Œæ¨¡å—ä»£ç ï¼Œæ¨¡å—å¯¼å‡ºçš„åŠŸèƒ½ä¼šè¢«æš´éœ²ç»™è¯·æ±‚å®ƒçš„ä»£ç ã€‚</li><li><strong>ç¼“å­˜</strong>ï¼šä¸ºäº†æé«˜æ€§èƒ½ï¼Œæ¨¡å—åœ¨ç¬¬ä¸€æ¬¡åŠ è½½åä¼šè¢«ç¼“å­˜ã€‚è¿™æ„å‘³ç€å¦‚æœå†æ¬¡è¯·æ±‚ç›¸åŒçš„æ¨¡å—ï¼ŒNode.js ä¼šç›´æ¥ä½¿ç”¨ç¼“å­˜ï¼Œè€Œä¸æ˜¯é‡æ–°æ‰§è¡Œä¸Šè¿°æ­¥éª¤ã€‚</li></ol><p>é€šè¿‡è¿™ä¸ªè¿‡ç¨‹ï¼ŒNode.js ä½¿å¾—é‡å¤ä½¿ç”¨ä»£ç ã€æ•´åˆç¤¾åŒºèµ„æºå˜å¾—ç®€å•é«˜æ•ˆã€‚</p><h3 id="package-json-and-file-extensions" tabindex="-1"><a class="header-anchor" href="#package-json-and-file-extensions"><span><a href="https://nodejs.org/docs/latest/api/packages.html#packagejson-and-file-extensions" target="_blank" rel="noopener noreferrer">package.json and file extensions</a></span></a></h3><p>åœ¨äº†è§£ Node.js v21.7.1 ä¸­å…³äº <code>package.json</code> å’Œæ–‡ä»¶æ‰©å±•åçš„å†…å®¹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç®€å•äº†è§£ä¸€ä¸‹ Node.js å’Œ <code>package.json</code> æ–‡ä»¶çš„åŸºæœ¬æ¦‚å¿µã€‚</p><p><strong>Node.js ç®€ä»‹</strong><br> Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒä½¿å¾—å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚å®ƒæ˜¯éé˜»å¡ä¸”äº‹ä»¶é©±åŠ¨çš„ï¼Œè¿™è®©å…¶ç‰¹åˆ«é€‚åˆæ„å»ºé«˜æ€§èƒ½çš„ç½‘ç»œåº”ç”¨ã€‚</p><p><strong>ä»€ä¹ˆæ˜¯ package.jsonï¼Ÿ</strong><br><code>package.json</code> æ˜¯ä¸€ä¸ª JSON æ ¼å¼çš„æ–‡ä»¶ï¼Œå­˜åœ¨äº Node.js é¡¹ç›®çš„æ ¹ç›®å½•ä¸­ã€‚å®ƒåŒ…å«äº†é¡¹ç›®çš„å…ƒæ•°æ®ï¼ˆå¦‚é¡¹ç›®åç§°ã€ç‰ˆæœ¬å·ç­‰ï¼‰ä»¥åŠç®¡ç†é¡¹ç›®æ‰€éœ€çš„ä¾èµ–ã€‚é€šè¿‡ <code>package.json</code>ï¼ŒNode.js å¯ä»¥çŸ¥é“å¦‚ä½•å¯åŠ¨é¡¹ç›®ä»¥åŠé¡¹ç›®éœ€è¦å“ªäº›ç¬¬ä¸‰æ–¹æ¨¡å—æˆ–åŒ…ã€‚</p><h3 id="package-json-and-file-extensions-1" tabindex="-1"><a class="header-anchor" href="#package-json-and-file-extensions-1"><span>package.json and file extensions</span></a></h3><p>åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œæåˆ°äº† <code>package.json</code> ä¸æ–‡ä»¶æ‰©å±•åçš„ä¸€äº›é‡è¦å…³ç³»å’Œè§„åˆ™ï¼Œä¸»è¦æ¶‰åŠå¦‚ä½•åœ¨ Node.js é¡¹ç›®ä¸­æ­£ç¡®å¤„ç†ä¸åŒç±»å‹çš„æ–‡ä»¶ï¼Œå¹¶ç¡®ä¿å¯¼å…¥ï¼ˆimportï¼‰å’ŒåŠ è½½ï¼ˆrequireï¼‰æ¨¡å—æ—¶çš„æ­£ç¡®æ€§ã€‚</p><h4 id="type-å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#type-å­—æ®µ"><span>&quot;type&quot; å­—æ®µ</span></a></h4><p>åœ¨ <code>package.json</code> æ–‡ä»¶ä¸­ï¼Œ<code>type</code> å­—æ®µæŒ‡ç¤ºäº†è¯¥é¡¹ç›®ä¸­ JavaScript æ–‡ä»¶çš„é»˜è®¤è§£é‡Šæ–¹å¼ã€‚å…·ä½“æ¥è¯´ï¼Œæœ‰ä¸¤ç§å¯é€‰å€¼ï¼š</p><ul><li><code>&quot;commonjs&quot;</code>ï¼šè¿™æ˜¯ Node.js çš„ä¼ ç»Ÿæ¨¡å—ç³»ç»Ÿï¼Œä½¿ç”¨ <code>require()</code> å’Œ <code>module.exports</code> æ¥å¯¼å…¥å’Œå¯¼å‡ºæ¨¡å—ã€‚</li><li><code>&quot;module&quot;</code>ï¼šè¿™è¡¨æ˜é¡¹ç›®ä½¿ç”¨ ECMAScript æ¨¡å—ï¼ˆESMï¼‰ï¼Œé€šè¿‡ <code>import</code> å’Œ <code>export</code> è¯­å¥æ¥å¤„ç†æ¨¡å—ã€‚</li></ul><h4 id="æ–‡ä»¶æ‰©å±•åçš„é‡è¦æ€§" tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶æ‰©å±•åçš„é‡è¦æ€§"><span>æ–‡ä»¶æ‰©å±•åçš„é‡è¦æ€§</span></a></h4><p>åœ¨ Node.js ä¸­ï¼Œå½“ä½ å°è¯•å¯¼å…¥æ¨¡å—æ—¶ï¼Œæ–‡ä»¶æ‰©å±•åå‘Šè¯‰ Node.js å¦‚ä½•å¤„ç†è¯¥æ–‡ä»¶ï¼š</p><ul><li><code>.js</code>ï¼šå¦‚æœ <code>type</code> å­—æ®µä¸º <code>&quot;module&quot;</code>ï¼Œåˆ™ <code>.js</code> æ–‡ä»¶è¢«è§†ä¸º ESMã€‚å¦‚æœæœªæŒ‡å®š <code>type</code> æˆ– <code>type</code> ä¸º <code>&quot;commonjs&quot;</code>ï¼Œ<code>.js</code> æ–‡ä»¶å°†è¢«è§†ä½œ CommonJS æ¨¡å—ã€‚</li><li><code>.mjs</code>ï¼šæ— è®º <code>package.json</code> çš„ <code>type</code> å­—æ®µå¦‚ä½•é…ç½®ï¼Œ<code>.mjs</code> æ–‡ä»¶æ€»æ˜¯è¢«è§†ä¸º ESMã€‚</li><li><code>.cjs</code>ï¼šæ— è®º <code>package.json</code> çš„ <code>type</code> å­—æ®µå¦‚ä½•é…ç½®ï¼Œ<code>.cjs</code> æ–‡ä»¶æ€»æ˜¯è¢«è§†ä¸º CommonJS æ¨¡å—ã€‚</li></ul><h4 id="å®é™…è¿ç”¨çš„ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-2"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h4><ol><li><p><strong>åˆ›å»º ESM é¡¹ç›®</strong><br> å‡è®¾ä½ æ­£åœ¨åˆ›å»ºä¸€ä¸ªä½¿ç”¨ ECMAScript æ¨¡å—çš„æ–°é¡¹ç›®ã€‚ä½ ä¼šåœ¨ <code>package.json</code> ä¸­è®¾ç½® <code>&quot;type&quot;: &quot;module&quot;</code>ã€‚è¿™æ„å‘³ç€ï¼Œåœ¨è¯¥é¡¹ç›®ä¸­ï¼Œæ‰€æœ‰ <code>.js</code> æ–‡ä»¶éƒ½å°†é»˜è®¤è¢«è§†ä¸º ESMï¼Œä½ å¯ä»¥åœ¨å…¶ä¸­ä½¿ç”¨ <code>import</code> å’Œ <code>export</code> è¯­å¥ã€‚å¦‚æœéœ€è¦ä½¿ç”¨ CommonJS æ ¼å¼çš„ä»£ç ï¼Œå¯ä»¥æŠŠé‚£äº›æ–‡ä»¶çš„æ‰©å±•åæ”¹ä¸º <code>.cjs</code>ã€‚</p></li><li><p><strong>åˆ›å»º CommonJS é¡¹ç›®</strong><br> å¦‚æœä½ çš„é¡¹ç›®åŸºäº Node.js çš„ä¼ ç»Ÿæ¨¡å—ç³»ç»Ÿï¼ˆCommonJSï¼‰ï¼Œä½ å¯èƒ½ä¸éœ€è¦åœ¨ <code>package.json</code> ä¸­æ˜¾å¼è®¾ç½® <code>&quot;type&quot;: &quot;commonjs&quot;</code>ï¼Œå› ä¸ºè¿™æ˜¯ Node.js çš„é»˜è®¤è¡Œä¸ºã€‚ä½†ä¸ºäº†æ¸…æ™°èµ·è§ï¼Œä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨æ·»åŠ è¿™ä¸ªå­—æ®µã€‚æ­¤æ—¶ï¼Œæ‰€æœ‰ <code>.js</code> æ–‡ä»¶é»˜è®¤ä¸º CommonJS æ¨¡å—ã€‚è‹¥ä½ æƒ³åœ¨é¡¹ç›®ä¸­ä½¿ç”¨æŸäº› ESM æ¨¡å—ï¼Œåªéœ€å°†è¿™äº›æ–‡ä»¶çš„æ‰©å±•åæ”¹ä¸º <code>.mjs</code>ã€‚</p></li></ol><p>é€šè¿‡è¿™äº›ç¤ºä¾‹ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>package.json</code> ä¸­ <code>type</code> å­—æ®µä¸æ–‡ä»¶æ‰©å±•ååœ¨ Node.js é¡¹ç›®ä¸­çš„é‡è¦æ€§ä»¥åŠå®ƒä»¬å¦‚ä½•å½±å“æ¨¡å—çš„åŠ è½½å’Œå¤„ç†ã€‚æ­£ç¡®åœ°ä½¿ç”¨å®ƒä»¬å¯ä»¥å¸®åŠ©ä½ æ›´çµæ´»ã€æ›´æœ‰æ•ˆåœ°ç®¡ç†å’Œç»´æŠ¤ä½ çš„ Node.js é¡¹ç›®ã€‚</p><h3 id="input-type-flag" tabindex="-1"><a class="header-anchor" href="#input-type-flag"><span><a href="https://nodejs.org/docs/latest/api/packages.html#--input-type-flag" target="_blank" rel="noopener noreferrer">--input-type flag</a></span></a></h3><p>å½“ä½ ä½¿ç”¨ Node.js è¿è¡Œ JavaScript æ–‡ä»¶æ—¶ï¼ŒNode.js é€šå¸¸ä¼šæ ¹æ®æ–‡ä»¶æ‰©å±•åï¼ˆå¦‚ <code>.js</code>ã€<code>.mjs</code> æˆ– <code>.cjs</code>ï¼‰æ¥åˆ¤æ–­è¯¥å¦‚ä½•å¤„ç†è¿™ä¸ªæ–‡ä»¶ã€‚è¿™ç§åšæ³•åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½å¾ˆæœ‰æ•ˆï¼Œä½†æœ‰æ—¶ä½ å¯èƒ½éœ€è¦è¿è¡Œçš„ä»£ç å¹¶ä¸æ˜¯æ¥è‡ªä¸€ä¸ªæ–‡ä»¶ï¼Œè€Œæ˜¯ç›´æ¥æ¥è‡ªå‘½ä»¤è¡Œæˆ–è€…æ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼ŒNode.js å°±æ— æ³•ä»æ–‡ä»¶æ‰©å±•åæ¨æ–­å‡ºä»£ç ç±»å‹ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒNode.js å…è®¸ä½ é€šè¿‡ <code>--input-type</code> æ ‡å¿—æ‰‹åŠ¨æŒ‡å®šè¾“å…¥ä»£ç çš„ç±»å‹ã€‚è¿™ä¸ªæ ‡å¿—éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒè®© Node.js çŸ¥é“å¦‚ä½•æ­£ç¡®åœ°è§£æå’Œæ‰§è¡Œä½ æä¾›çš„ä»£ç ï¼Œå³ä½¿è¿™äº›ä»£ç ä¸æ˜¯æ¥è‡ªäºä¼ ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯"><span>ä½¿ç”¨åœºæ™¯</span></a></h3><ol><li><p><strong>ç›´æ¥æ‰§è¡Œä»£ç ç‰‡æ®µ</strong>ï¼š<br> å‡è®¾ä½ æƒ³å¿«é€Ÿè¿è¡Œä¸€å°æ®µ ES æ¨¡å—ï¼ˆESMï¼‰ä»£ç ï¼Œè€Œä¸æ˜¯å°†å®ƒä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>--input-type=module</code> æ ‡å¿—æ¥å‘Šè¯‰ Node.jsï¼Œå…¶åé¢è·Ÿç€çš„ä»£ç åº”è¯¥ä½œä¸º ESM æ¥æ‰§è¡Œã€‚</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">node</span><span style="color:#A3BE8C;"> --input-type=module</span><span style="color:#A3BE8C;"> -e</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">import path from &#39;path&#39;; console.log(path.resolve(&#39;./&#39;))</span><span style="color:#ECEFF4;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>-e</code> å‚æ•°å…è®¸ä½ ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­æä¾›è¦æ‰§è¡Œçš„ä»£ç ã€‚<code>--input-type=module</code> ç¡®ä¿ Node.js ä»¥ ES æ¨¡å—çš„æ–¹å¼å¤„ç†è¿™æ®µä»£ç ã€‚</p></li><li><p><strong>ä»æ ‡å‡†è¾“å…¥ä¸­è¯»å–ä»£ç </strong>ï¼š<br> å½“ä½ æƒ³è¦ä»å¦ä¸€ä¸ªç¨‹åºè¾“å‡ºä¸­è·å–ä»£ç å¹¶ç”¨ Node.js æ‰§è¡Œæ—¶ï¼Œä¹Ÿå¯èƒ½ä¼šç”¨åˆ° <code>--input-type</code> æ ‡å¿—ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä»ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­è¯»å– ES æ¨¡å—ä»£ç ï¼Œå¹¶é€šè¿‡ç®¡é“ä¼ é€’ç»™ Node.js å¤„ç†ã€‚</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">cat</span><span style="color:#A3BE8C;"> myModule.mjs</span><span style="color:#81A1C1;"> |</span><span style="color:#88C0D0;"> node</span><span style="color:#A3BE8C;"> --input-type=module</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å‡è®¾ <code>myModule.mjs</code> åŒ…å«äº†æœ‰æ•ˆçš„ ES æ¨¡å—ä»£ç ã€‚ä½¿ç”¨ <code>cat</code> å‘½ä»¤è¯»å–æ–‡ä»¶å†…å®¹ï¼Œå¹¶é€šè¿‡ç®¡é“ï¼ˆ<code>|</code> ç¬¦å·ï¼‰ä¼ é€’ç»™ Node.jsã€‚è¿™é‡Œï¼Œ<code>--input-type=module</code> å‘Šè¯‰ Node.jsï¼Œå³å°†å¤„ç†çš„è¾“å…¥æ˜¯ ES æ¨¡å—ä»£ç ã€‚</p></li></ol><h3 id="æ€»ç»“-1" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-1"><span>æ€»ç»“</span></a></h3><p><code>--input-type</code> æ ‡å¿—æä¾›äº†ä¸€ç§çµæ´»çš„æ–¹æ³•æ¥å‘Šè¯‰ Node.js å¦‚ä½•å¤„ç†éæ–‡ä»¶æ¥æºçš„ JavaScript ä»£ç ã€‚æ— è®ºæ˜¯ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œä»£ç ç‰‡æ®µï¼Œè¿˜æ˜¯ä»æ ‡å‡†è¾“å…¥ä¸­è¯»å–ä»£ç ï¼Œè¿™ä¸ªæ ‡å¿—éƒ½ç¡®ä¿äº† Node.js èƒ½å¤Ÿæ­£ç¡®ç†è§£å’Œæ‰§è¡Œä½ çš„ä»£ç ã€‚è¿™ç§èƒ½åŠ›ç‰¹åˆ«æœ‰ç”¨äºå¼€å‘è„šæœ¬ã€å·¥å…·é“¾é›†æˆæˆ–ä»»ä½•éœ€è¦ä¸´æ—¶æˆ–åŠ¨æ€æ‰§è¡Œ JavaScript ä»£ç çš„åœºæ™¯ã€‚</p><h2 id="determining-package-manager" tabindex="-1"><a class="header-anchor" href="#determining-package-manager"><span><a href="https://nodejs.org/docs/latest/api/packages.html#determining-package-manager" target="_blank" rel="noopener noreferrer">Determining package manager</a></span></a></h2><p>åœ¨ Node.js çš„ä¸–ç•Œé‡Œï¼Œäº†è§£å’Œä½¿ç”¨ä¸åŒçš„åŒ…ç®¡ç†å™¨ï¼ˆpackage managersï¼‰æ˜¯ä¸€é¡¹éå¸¸é‡è¦çš„æŠ€èƒ½ã€‚å¸¸è§çš„åŒ…ç®¡ç†å™¨æœ‰ npmã€yarn å’Œ pnpm ç­‰ã€‚æ¯ä¸ªé¡¹ç›®å¯èƒ½ä¼šé€‰æ‹©ä¸åŒçš„åŒ…ç®¡ç†å™¨å‡ºäºå„ç§åŸå› ï¼Œæ¯”å¦‚æ€§èƒ½ã€å®‰å…¨æ€§æˆ–è€…ç®€å•çš„ä¸ªäººå–œå¥½ã€‚ä½†æ˜¯ï¼Œè¿™å°±å¸¦æ¥äº†ä¸€ä¸ªé—®é¢˜ï¼šå½“ä½ ä½œä¸ºå¼€å‘è€…åŠ å…¥ä¸€ä¸ªæ–°é¡¹ç›®æ—¶ï¼Œå¦‚ä½•çŸ¥é“è¯¥ä½¿ç”¨å“ªä¸ªåŒ…ç®¡ç†å™¨å»è¿è¡Œå’Œç®¡ç†é¡¹ç›®å‘¢ï¼Ÿå¹¸è¿çš„æ˜¯ï¼ŒNode.js v21.7.1 å¼•å…¥äº†ä¸€ç§åˆ¤æ–­å½“å‰é¡¹ç›®ä½¿ç”¨å“ªä¸ªåŒ…ç®¡ç†å™¨çš„æ–¹æ³•ã€‚</p><h3 id="åˆ¤æ–­åŒ…ç®¡ç†å™¨" tabindex="-1"><a class="header-anchor" href="#åˆ¤æ–­åŒ…ç®¡ç†å™¨"><span>åˆ¤æ–­åŒ…ç®¡ç†å™¨</span></a></h3><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œå¯ä»¥é€šè¿‡è¯»å–ç¯å¢ƒå˜é‡<code>process.env.npm_config_user_agent</code>æ¥åˆ¤æ–­å½“å‰ä½¿ç”¨çš„åŒ…ç®¡ç†å™¨ã€‚è¿™ä¸ªç¯å¢ƒå˜é‡æä¾›äº†å…³äºå½“å‰æ¿€æ´»çš„åŒ…ç®¡ç†å™¨çš„ä¿¡æ¯ï¼Œæ¯”å¦‚å®ƒçš„åç§°å’Œç‰ˆæœ¬ç­‰ã€‚</p><p>ä¾‹å¦‚ï¼Œå‡è®¾ä½ æ­£åœ¨ä¸€ä¸ªä½¿ç”¨ npm çš„é¡¹ç›®ä¸­å·¥ä½œã€‚å½“ä½ è¿è¡Œ npm ç›¸å…³çš„å‘½ä»¤æ—¶ï¼Œ<code>process.env.npm_config_user_agent</code>å¯èƒ½ä¼šè¿”å›ç±»ä¼¼äº<code>npm/6.14.4 node/v12.16.1 darwin x64</code>çš„å­—ç¬¦ä¸²ï¼Œè¿™è¡¨æ˜å½“å‰çš„åŒ…ç®¡ç†å™¨æ˜¯ npmï¼Œç‰ˆæœ¬ä¸º 6.14.4ã€‚</p><h3 id="å®é™…åº”ç”¨çš„ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨çš„ä¾‹å­"><span>å®é™…åº”ç”¨çš„ä¾‹å­</span></a></h3><p><strong>1. è‡ªåŠ¨åŒ–è„šæœ¬ä¸­åˆ¤æ–­åŒ…ç®¡ç†å™¨</strong></p><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬ï¼Œéœ€è¦æ ¹æ®é¡¹ç›®æ‰€ä½¿ç”¨çš„åŒ…ç®¡ç†å™¨æ¥æ‰§è¡Œç›¸åº”çš„å‘½ä»¤ã€‚ä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> packageManager</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> process</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">env</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">npm_config_user_agent</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">split</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#D8DEE9FF;">)[</span><span style="color:#B48EAD;">0</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">split</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)[</span><span style="color:#B48EAD;">0</span><span style="color:#D8DEE9FF;">]</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">packageManager</span><span style="color:#81A1C1;"> ===</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">npm</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨npmæ‰§è¡Œçš„å‘½ä»¤</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Running npm specific tasks</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> else</span><span style="color:#81A1C1;"> if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">packageManager</span><span style="color:#81A1C1;"> ===</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">yarn</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨yarnæ‰§è¡Œçš„å‘½ä»¤</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Running yarn specific tasks</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> else</span><span style="color:#81A1C1;"> if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">packageManager</span><span style="color:#81A1C1;"> ===</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">pnpm</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨pnpmæ‰§è¡Œçš„å‘½ä»¤</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Running pnpm specific tasks</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Unknown package manager</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é¦–å…ˆä»<code>process.env.npm_config_user_agent</code>è·å–åŒ…ç®¡ç†å™¨ä¿¡æ¯ï¼Œç„¶åæ ¹æ®ä¸åŒçš„åŒ…ç®¡ç†å™¨æ‰§è¡Œä¸åŒçš„ä»»åŠ¡ã€‚</p><p><strong>2. é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨ä¸åŒçš„è®¾ç½®</strong></p><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½éœ€è¦æ ¹æ®ä½¿ç”¨çš„åŒ…ç®¡ç†å™¨å¯¹é¡¹ç›®è¿›è¡Œä¸åŒçš„é…ç½®ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªæ”¯æŒå¤šç§åŒ…ç®¡ç†å™¨çš„é¡¹ç›®æ„å»ºè¿‡ç¨‹ä¸­ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> packageManager</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> process</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">env</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">npm_config_user_agent</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">split</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#D8DEE9FF;">)[</span><span style="color:#B48EAD;">0</span><span style="color:#D8DEE9FF;">]</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">split</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)[</span><span style="color:#B48EAD;">0</span><span style="color:#D8DEE9FF;">]</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">packageManager</span><span style="color:#81A1C1;"> ===</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">npm</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">  // npmç›¸å…³çš„é…ç½®</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> else</span><span style="color:#81A1C1;"> if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">packageManager</span><span style="color:#81A1C1;"> ===</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">yarn</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">  // yarnç›¸å…³çš„é…ç½®</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> else</span><span style="color:#81A1C1;"> if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">packageManager</span><span style="color:#81A1C1;"> ===</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">pnpm</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">  // pnpmç›¸å…³çš„é…ç½®</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç»“è®º" tabindex="-1"><a class="header-anchor" href="#ç»“è®º"><span>ç»“è®º</span></a></h3><p>é€šè¿‡æ£€æŸ¥<code>process.env.npm_config_user_agent</code>ç¯å¢ƒå˜é‡ï¼ŒNode.js è®©å¼€å‘è€…èƒ½å¤Ÿè¯†åˆ«å¹¶é€‚åº”é¡¹ç›®ä¸­ä½¿ç”¨çš„åŒ…ç®¡ç†å™¨ï¼Œä»è€Œæé«˜äº†é¡¹ç›®çš„å¯ç»´æŠ¤æ€§å’Œçµæ´»æ€§ã€‚è¿™ä¸ªåŠŸèƒ½ç‰¹åˆ«å¯¹äºé‚£äº›éœ€è¦è·¨å¤šä¸ªé¡¹ç›®å·¥ä½œçš„å¼€å‘è€…æ¥è¯´ï¼Œæ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œå› ä¸ºå®ƒå‡å°‘äº†å› ä¸ºåˆ‡æ¢ä¸åŒé¡¹ç›®è€Œå¯¼è‡´çš„æ··æ·†ï¼Œå¹¶ä¸”ä½¿å¾—è‡ªåŠ¨åŒ–ä»»åŠ¡èƒ½å¤Ÿæ›´åŠ æ™ºèƒ½åœ°é€‚åº”ä¸åŒçš„ç¯å¢ƒã€‚</p><h2 id="package-entry-points" tabindex="-1"><a class="header-anchor" href="#package-entry-points"><span><a href="https://nodejs.org/docs/latest/api/packages.html#package-entry-points" target="_blank" rel="noopener noreferrer">Package entry points</a></span></a></h2><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥ç®€å•æ˜äº†åœ°ç†è§£ Node.js ä¸­çš„ <strong>Package Entry Points</strong>ï¼ˆåŒ…å…¥å£ç‚¹ï¼‰ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œä¸€ä¸ªâ€œåŒ…â€é€šå¸¸æŒ‡çš„æ˜¯åŒ…å«å¤šä¸ªæ¨¡å—çš„ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œè¿™ä¸ªåŒ…å¯ä»¥é€šè¿‡ npmï¼ˆNode.js çš„åŒ…ç®¡ç†å™¨ï¼‰è¢«å®‰è£…å’Œåˆ†äº«ã€‚è€Œâ€œåŒ…å…¥å£ç‚¹â€åˆ™å®šä¹‰äº†å½“è¿™ä¸ªåŒ…è¢«å¼•ç”¨æ—¶ï¼Œé»˜è®¤å¯¼å‡ºå“ªä¸ªæ–‡ä»¶æˆ–æ¨¡å—ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-package-entry-points" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-package-entry-points"><span>ä»€ä¹ˆæ˜¯ Package Entry Points?</span></a></h3><p>åœ¨ä½ åˆ›å»ºçš„æ¯ä¸ª Node.js é¡¹ç›®çš„æ ¹ç›®å½•ä¸­ï¼Œé€šå¸¸ä¼šæœ‰ä¸€ä¸ª<code>package.json</code>æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶åŒ…å«äº†å…³äºé¡¹ç›®çš„å…ƒæ•°æ®ä»¥åŠå…¶ä»–é…ç½®é€‰é¡¹ã€‚å…¶ä¸­ï¼Œâ€œå…¥å£ç‚¹â€çš„è®¾ç½®å‘Šè¯‰ Node.jsï¼Œå½“è¯¥åŒ…è¢«å…¶ä»–ä»£ç <code>require</code>æˆ–<code>import</code>æ—¶åº”è¯¥åŠ è½½å“ªä¸ªæ–‡ä»¶ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä¸æ˜¾å¼è®¾ç½®å…¥å£ç‚¹ï¼ŒNode.js ä¼šæŸ¥æ‰¾å¹¶åŠ è½½åä¸º<code>index.js</code>çš„æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œé€šè¿‡åœ¨<code>package.json</code>ä¸­ä½¿ç”¨<code>&quot;main&quot;</code>å­—æ®µï¼Œä½ å¯ä»¥æŒ‡å®šä¸€ä¸ªä¸åŒçš„å…¥å£ç‚¹ã€‚ä¾‹å¦‚ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">my-awesome-package</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">main</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">src/app.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå½“å…¶ä»–äººåœ¨ä»–ä»¬çš„é¡¹ç›®ä¸­å¯¼å…¥<code>my-awesome-package</code>æ—¶ï¼ŒNode.js å°†ä¼šè‡ªåŠ¨åŠ è½½<code>src/app.js</code>æ–‡ä»¶ä½œä¸ºåŒ…çš„å…¥å£ç‚¹ã€‚</p><h3 id="å®é™…è¿ç”¨" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨"><span>å®é™…è¿ç”¨</span></a></h3><p>è®©æˆ‘ä»¬ç”¨ä¸€äº›å®é™…çš„ä¾‹å­æ¥è¯´æ˜å®ƒçš„åº”ç”¨ã€‚</p><h4 id="ä¾‹å­-1-åˆ›å»ºå¯é‡ç”¨çš„å·¥å…·åº“" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-åˆ›å»ºå¯é‡ç”¨çš„å·¥å…·åº“"><span>ä¾‹å­ 1ï¼šåˆ›å»ºå¯é‡ç”¨çš„å·¥å…·åº“</span></a></h4><p>å‡è®¾ä½ å·²ç»å†™äº†ä¸€äº›å®ç”¨çš„ JavaScript å‡½æ•°ï¼Œæ¯”å¦‚ç”¨äºå¤„ç†æ—¥æœŸçš„å‡½æ•°ï¼Œä½ æƒ³æŠŠå®ƒä»¬æ‰“åŒ…æˆä¸€ä¸ªåº“ï¼Œä»¥ä¾¿åœ¨å¤šä¸ªé¡¹ç›®ä¸­å¤ç”¨ã€‚ä½ å°†æ‰€æœ‰çš„å‡½æ•°æ”¾åœ¨<code>utils/dateUtils.js</code>ã€‚åœ¨ä½ çš„<code>package.json</code>é‡Œï¼Œä½ å¯ä»¥è¿™æ ·è®¾ç½®å…¥å£ç‚¹ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">date-utils-library</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">main</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utils/dateUtils.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ï¼Œå½“å…¶ä»–å¼€å‘è€…å®‰è£…å¹¶å¯¼å…¥ä½ çš„åº“æ—¶ï¼Œä»–ä»¬å®é™…ä¸Šæ˜¯ç›´æ¥å¯¼å…¥<code>dateUtils.js</code>æ–‡ä»¶ã€‚</p><h4 id="ä¾‹å­-2-æä¾›å¤šä¸ªç‰ˆæœ¬çš„åº“" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-æä¾›å¤šä¸ªç‰ˆæœ¬çš„åº“"><span>ä¾‹å­ 2ï¼šæä¾›å¤šä¸ªç‰ˆæœ¬çš„åº“</span></a></h4><p>è€ƒè™‘åˆ°å…¼å®¹æ€§é—®é¢˜ï¼Œä½ å¯èƒ½éœ€è¦ä¸ºä¸åŒç‰ˆæœ¬çš„ Node.js ç¯å¢ƒæä¾›ä¸åŒç‰ˆæœ¬çš„ä»£ç ã€‚ä½ å¯ä»¥ä½¿ç”¨<code>exports</code>å­—æ®µæ¥æŒ‡å®šä¸åŒçš„å…¥å£ç‚¹ã€‚ä¾‹å¦‚ï¼Œç»™æ—§ç‰ˆæœ¬çš„ Node.js ä½¿ç”¨ CommonJS æ ¼å¼ï¼Œç»™æ–°ç‰ˆæœ¬ä½¿ç”¨ ES Module æ ¼å¼ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">my-library</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">module</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">import</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/my-library.mjs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">require</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/my-library.cjs</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ”¯æŒ ES æ¨¡å—çš„ç¯å¢ƒä¼šåŠ è½½<code>my-library.mjs</code>ï¼Œè€Œæ—§ç¯å¢ƒåˆ™åŠ è½½<code>my-library.cjs</code>ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå…¥å£ç‚¹çš„æ¦‚å¿µå’Œé…ç½®ä½¿å¾— Node.js åŒ…æ›´åŠ çµæ´»å’Œæ˜“äºç®¡ç†ã€‚å¼€å‘è€…å¯ä»¥æ§åˆ¶åŒ…çš„ç»“æ„å’Œå¯¼å‡ºæ–¹å¼ï¼Œä»è€Œæä¾›æ›´å¥½çš„ä»£ç ç»„ç»‡å’Œæ¨¡å—åŒ–æ”¯æŒã€‚</p><h3 id="main-entry-point-export" tabindex="-1"><a class="header-anchor" href="#main-entry-point-export"><span><a href="https://nodejs.org/docs/latest/api/packages.html#main-entry-point-export" target="_blank" rel="noopener noreferrer">Main entry point export</a></span></a></h3><p>å½“æˆ‘ä»¬è°ˆè®º Node.js ä¸­çš„â€œMain entry point exportâ€æ—¶ï¼Œæˆ‘ä»¬å…¶å®åœ¨è®¨è®ºä¸€ä¸ªåŒ…ï¼ˆpackageï¼‰æˆ–è€…æ¨¡å—ï¼ˆmoduleï¼‰å¦‚ä½•æŒ‡å®šè‡ªå·±çš„ä¸»è¦å…¥å£ç‚¹ã€‚è¿™æ˜¯åŒ…æˆ–æ¨¡å—ä½œè€…å‘Šè¯‰ä½¿ç”¨è€…ï¼Œâ€œå¦‚æœä½ å¼•å…¥æˆ‘çš„åŒ…ï¼Œé‚£ä¹ˆé»˜è®¤æƒ…å†µä¸‹ä½ å°†ä¼šè·å¾—è¿™éƒ¨åˆ†ä»£ç æˆ–åŠŸèƒ½â€çš„æ–¹å¼ã€‚åœ¨ Node.js ä¸­ï¼Œè¿™é€šå¸¸æ˜¯é€šè¿‡<code>package.json</code>æ–‡ä»¶ä¸­çš„<code>main</code>å­—æ®µæ¥æŒ‡å®šçš„ã€‚</p><h3 id="_1-package-jsonå’Œä¸»å…¥å£ç‚¹çš„åŸºç¡€" tabindex="-1"><a class="header-anchor" href="#_1-package-jsonå’Œä¸»å…¥å£ç‚¹çš„åŸºç¡€"><span>1. <code>package.json</code>å’Œä¸»å…¥å£ç‚¹çš„åŸºç¡€ï¼š</span></a></h3><p>è®©æˆ‘ä»¬ä»åŸºæœ¬æ¦‚å¿µå¼€å§‹ã€‚<code>package.json</code>æ˜¯æ¯ä¸ª Node.js é¡¹ç›®æˆ–æ¨¡å—çš„å¿ƒè„ï¼Œå®ƒä¿å­˜äº†é¡¹ç›®çš„å…ƒæ•°æ®å’Œé…ç½®ã€‚å…¶ä¸­ä¸€ä¸ªé‡è¦å­—æ®µå°±æ˜¯<code>main</code>ã€‚è¿™ä¸ªå­—æ®µæŒ‡å®šäº†å½“å…¶ä»–äººé€šè¿‡<code>require()</code>æˆ–<code>import</code>å¼•ç”¨ä½ çš„åŒ…æ—¶ï¼Œé»˜è®¤å¯¼å…¥çš„æ–‡ä»¶ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœä½ åˆ›å»ºäº†ä¸€ä¸ªåä¸º<code>awesome-node-module</code>çš„ Node.js æ¨¡å—ï¼Œä½ å¯èƒ½ä¼šæœ‰ä¸€ä¸ª<code>package.json</code>æ–‡ä»¶ï¼Œçœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">awesome-node-module</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">main</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">index.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œ<code>&quot;main&quot;: &quot;index.js&quot;</code>æ„å‘³ç€å½“åˆ«äººåœ¨ä»–ä»¬çš„é¡¹ç›®ä¸­å®‰è£…å¹¶å¼•å…¥<code>awesome-node-module</code>æ—¶ï¼ŒNode.js ä¼šé»˜è®¤åŠ è½½<code>index.js</code>æ–‡ä»¶ã€‚</p><h3 id="_2-å®é™…åº”ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#_2-å®é™…åº”ç”¨ä¾‹å­"><span>2. å®é™…åº”ç”¨ä¾‹å­ï¼š</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªå°å·¥å…·åº“ï¼Œæä¾›ä¸€äº›æ•°å­¦è¿ç®—å‡½æ•°ã€‚ä½ çš„é¡¹ç›®ç»“æ„å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>/my-math-lib</span></span>
<span class="line"><span>  /src</span></span>
<span class="line"><span>    - add.js</span></span>
<span class="line"><span>    - subtract.js</span></span>
<span class="line"><span>  - package.json</span></span>
<span class="line"><span>  - index.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨<code>index.js</code>ä¸­ï¼Œä½ å¯èƒ½ä¼šæœ‰ä»¥ä¸‹å†…å®¹ï¼Œä½œä¸ºæ•´ä¸ªåº“çš„&quot;é—¨é¢&quot;ï¼Œå°†ä¸åŒçš„å‡½æ•°ç»Ÿä¸€å¯¼å‡ºï¼š</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> add</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./src/add</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> subtract</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./src/subtract</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8FBCBB;">module</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">exports</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  add</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9;">  subtract</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œåœ¨<code>package.json</code>ä¸­ï¼Œä½ å°†æŒ‡å®š<code>index.js</code>ä½œä¸ºä¸»å…¥å£ç‚¹ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">my-math-lib</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">main</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">index.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨ï¼Œå¦‚æœæœ‰äººåœ¨ä»–ä»¬çš„é¡¹ç›®ä¸­å®‰è£…äº†ä½ çš„<code>my-math-lib</code>åº“ï¼Œä»–ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°ä½¿ç”¨ä½ æä¾›çš„å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> mathLib</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">my-math-lib</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">mathLib</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 2</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: 3</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">mathLib</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">subtract</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">10</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 5</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: 5</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-æ›´æ·±å…¥çš„ç†è§£" tabindex="-1"><a class="header-anchor" href="#_3-æ›´æ·±å…¥çš„ç†è§£"><span>3. æ›´æ·±å…¥çš„ç†è§£ï¼š</span></a></h3><p>åœ¨ Node.js v21.7.1 å’Œå…¶ä»–ç‰ˆæœ¬ä¸­ï¼Œ<code>package.json</code>çš„<code>main</code>å­—æ®µçš„ä½¿ç”¨æ–¹å¼åŸºæœ¬ä¿æŒä¸€è‡´ã€‚ä½†éšç€ ECMAScript æ¨¡å—ï¼ˆESMï¼‰æ ‡å‡†çš„å‘å±•ï¼Œ<code>package.json</code>ä¹Ÿå¼•å…¥äº†æ–°å­—æ®µå¦‚<code>&quot;type&quot;: &quot;module&quot;</code>å’Œ<code>&quot;exports&quot;</code>æ¥è¿›ä¸€æ­¥æ§åˆ¶æ¨¡å—çš„å¯¼å‡ºå’Œå¼•ç”¨æ–¹å¼ã€‚</p><p>æ€»è€Œè¨€ä¹‹ï¼Œâ€œMain entry point exportâ€æ˜¯å®šä¹‰äº†å½“ä½ çš„åŒ…è¢«å¼•å…¥åˆ°å¦ä¸€ä¸ªé¡¹ç›®ä¸­æ—¶ï¼Œé»˜è®¤å¯¼å‡ºå“ªä¸ªæ–‡ä»¶çš„æœºåˆ¶ã€‚è¿™å¯¹äºæ¨¡å—çš„ä½¿ç”¨è€…æ¥è¯´ç®€åŒ–äº†ä½¿ç”¨è¿‡ç¨‹ï¼Œå› ä¸ºä»–ä»¬åªéœ€è¦çŸ¥é“æ¨¡å—çš„åç§°ï¼Œä¸éœ€è¦çŸ¥é“å…·ä½“è¦å¼•ç”¨æ¨¡å—å†…éƒ¨çš„å“ªä¸ªæ–‡ä»¶ã€‚</p><h3 id="subpath-exports" tabindex="-1"><a class="header-anchor" href="#subpath-exports"><span><a href="https://nodejs.org/docs/latest/api/packages.html#subpath-exports" target="_blank" rel="noopener noreferrer">Subpath exports</a></span></a></h3><p>Node.js ä¸­çš„ Subpath exports æ˜¯ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå…è®¸æ¨¡å—å’ŒåŒ…çš„ä½œè€…æ˜ç¡®æŒ‡å®šå“ªäº›å­è·¯å¾„å¯ä»¥è¢«å¤–ç•Œå¯¼å…¥ã€‚åœ¨ Node.js çš„ context ä¸­ï¼Œ<code>export</code> é€šå¸¸æŒ‡çš„æ˜¯å°†ç‰¹å®šçš„ä»£ç æˆ–åŠŸèƒ½ä½œä¸ºæ¨¡å—æš´éœ²å‡ºå»ï¼Œä»¥ä¾¿å…¶ä»–æ–‡ä»¶æˆ–æ¨¡å—å¯ä»¥ä½¿ç”¨ã€‚Subpath exports åˆ™æ›´ç»†ç²’åº¦åœ°æ§åˆ¶äº†æ¨¡å—å†…éƒ¨çš„å“ªäº›éƒ¨åˆ†å¯ä»¥è¢«â€œå¯¼å‡ºâ€å¹¶è¢«å…¶ä»–æ¨¡å—å¼•ç”¨ã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨ Node.js ä¸­ï¼Œä½ æœ‰ä¸€ä¸ªåä¸º <code>my-package</code> çš„åŒ…ï¼Œå…¶ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>/ my-package</span></span>
<span class="line"><span>  / src</span></span>
<span class="line"><span>    - index.js</span></span>
<span class="line"><span>    - utils.js</span></span>
<span class="line"><span>    - private-module.js</span></span>
<span class="line"><span>  package.json</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨ï¼Œä½ æƒ³è¦å…è®¸ä½¿ç”¨è€…åªèƒ½å¯¼å…¥ <code>index.js</code> å’Œ <code>utils.js</code>ï¼Œè€Œä¸æ˜¯æ•´ä¸ª <code>src</code> ç›®å½•ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥åœ¨ <code>package.json</code> æ–‡ä»¶ä¸­ä½¿ç”¨ <code>&quot;exports&quot;</code> å­—æ®µæ¥æŒ‡å®šå…è®¸å¯¼å…¥çš„å­è·¯å¾„ã€‚</p><p><code>package.json</code> ä¸­çš„ <code>&quot;exports&quot;</code> å­—æ®µå¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">my-package</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/index.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">./utils</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/utils.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„é…ç½®åšäº†ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ul><li><code>&quot;.&quot;</code>: è¡¨ç¤ºåŒ…çš„ä¸»å…¥å£ç‚¹ï¼Œè¿™é‡Œè®¾ç½®ä¸º <code>./src/index.js</code>ã€‚å½“å…¶ä»–äººé€šè¿‡ <code>require(&#39;my-package&#39;)</code> æˆ– <code>import &#39;my-package&#39;</code> å¯¼å…¥ä½ çš„åŒ…æ—¶ï¼Œå®é™…ä¸Šæ˜¯å¯¼å…¥äº† <code>src/index.js</code>ã€‚</li><li><code>&quot;./utils&quot;</code>: è¡¨ç¤ºå½“ä½¿ç”¨è€…è¯•å›¾å¯¼å…¥ utils å­è·¯å¾„æ—¶ï¼Œåº”è¯¥æ˜ å°„åˆ° <code>./src/utils.js</code>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨è€…å¯ä»¥é€šè¿‡ <code>require(&#39;my-package/utils&#39;)</code> æˆ– <code>import &#39;my-package/utils&#39;</code> æ¥ä¸“é—¨å¯¼å…¥ utils éƒ¨åˆ†ã€‚</li></ul><p>è¿™æ ·ä¸€æ¥ï¼Œä½¿ç”¨è€…å°±ä¸èƒ½ç›´æ¥å¯¼å…¥ <code>private-module.js</code>ï¼Œå› ä¸ºå®ƒæ²¡æœ‰è¢«åˆ—å…¥ <code>&quot;exports&quot;</code> å­—æ®µã€‚å¦‚æœä»–ä»¬å°è¯•è¿™æ ·åšï¼Œæ¯”å¦‚é€šè¿‡ <code>require(&#39;my-package/private-module&#39;)</code>ï¼ŒNode.js å°†ä¼šæŠ›å‡ºé”™è¯¯ï¼Œå‘Šè¯‰ä»–ä»¬è¿™ä¸ªæ¨¡å—ä¸å­˜åœ¨æˆ–æ— æ³•æ‰¾åˆ°ã€‚</p><p>è¿™ç§æ–¹å¼æä¾›äº†æ›´å¥½çš„å°è£…æ€§ï¼ŒåŒ…çš„ä½œè€…å¯ä»¥å†³å®šæš´éœ²å“ªäº›åŠŸèƒ½ç»™æœ€ç»ˆç”¨æˆ·ï¼Œå¹¶ä¸”è¿˜å¯ä»¥éšæ—¶æ›´æ”¹å†…éƒ¨æ–‡ä»¶ç»“æ„è€Œä¸å½±å“åˆ°å¤–éƒ¨ä½¿ç”¨è€…ï¼Œå› ä¸ºå¤–éƒ¨ä½¿ç”¨è€…åªä¸ â€œexportsâ€ ä¸­å®šä¹‰çš„è·¯å¾„æ‰“äº¤é“ã€‚</p><p>æ­¤å¤–ï¼ŒSubpath exports è¿˜æ”¯æŒæ¨¡å¼åŒ¹é…å’Œå…¶ä»–é«˜çº§é…ç½®ï¼Œä½¿å¾—åŒ…ä½œè€…å¯ä»¥çµæ´»å®šä¹‰å¦‚ä½•æŒ‰éœ€å…¬å¼€åŒ…å†…å®¹ã€‚</p><h4 id="extensions-in-subpaths" tabindex="-1"><a class="header-anchor" href="#extensions-in-subpaths"><span><a href="https://nodejs.org/docs/latest/api/packages.html#extensions-in-subpaths" target="_blank" rel="noopener noreferrer">Extensions in subpaths</a></span></a></h4><p>å¥½çš„ï¼Œæˆ‘ä¼šå°½é‡é€šä¿—æ˜“æ‡‚åœ°è§£é‡Š Node.js 21.7.1 ç‰ˆæœ¬ä¸­&quot;Extensions in subpaths&quot;è¿™ä¸€ç‰¹æ€§ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œä¸€ä¸ª&quot;subpath&quot;å¯ä»¥è¢«ç†è§£ä¸ºæ¨¡å—æˆ–åŒ…å†…éƒ¨çš„ä¸€ä¸ªå­ç›®å½•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªåä¸º<code>my-package</code>çš„åŒ…ï¼Œå®ƒé‡Œé¢å¯èƒ½æœ‰ä¸€ä¸ªå­ç›®å½•å«<code>lib</code>ï¼Œé‚£ä¹ˆ<code>lib</code>å°±æ˜¯ä¸€ä¸ª subpathã€‚</p><p>å½“æˆ‘ä»¬è°ˆè®ºâ€œExtensions in subpathsâ€çš„æ—¶å€™ï¼Œæˆ‘ä»¬æŒ‡çš„æ˜¯æ–‡ä»¶æ‰©å±•åï¼ˆå¦‚<code>.js</code>, <code>.json</code>, <code>.node</code>ç­‰ï¼‰åœ¨æ¨¡å—çš„ subpaths ä¸­çš„ä½¿ç”¨æ–¹å¼ã€‚åœ¨ Node.js çš„æ—©æœŸç‰ˆæœ¬ä¸­ï¼Œå¯¼å…¥æ¨¡å—æ—¶é€šå¸¸ä¸éœ€è¦å†™æ–‡ä»¶çš„æ‰©å±•åï¼Œä½†åæ¥çš„ç‰ˆæœ¬ä¸ºäº†æé«˜å®‰å…¨æ€§å’Œæ¨¡å—è§£æçš„æ˜ç¡®æ€§ï¼Œå¼•å…¥äº†å¯¹å¯¼å…¥è¯­å¥ä¸­æ‰©å±•åçš„ä¸¥æ ¼è¦æ±‚ã€‚</p><p>è¿™æ„å‘³ç€ï¼Œåœ¨å¯¼å…¥ subpath ä¸‹çš„æ–‡ä»¶æ—¶ï¼Œä½ å¿…é¡»æŒ‡å®šæ­£ç¡®çš„æ–‡ä»¶æ‰©å±•åã€‚è¿™æœ‰åŠ©äº Node.js æ›´ç²¾ç¡®åœ°çŸ¥é“ä½ æƒ³è¦åŠ è½½å“ªä¸ªæ–‡ä»¶ï¼ŒåŒæ—¶é¿å…äº†æŸäº›å®‰å…¨é—®é¢˜ï¼Œæ¯”å¦‚æ¶æ„ç”¨æˆ·åˆ©ç”¨æ— æ‰©å±•åçš„å¯¼å…¥æ¥æ¬ºéª— Node.js è¿è¡Œé”™è¯¯çš„ä»£ç ã€‚</p><p>è®©æˆ‘ä»¬é€šè¿‡å‡ ä¸ªå®é™…çš„ä¾‹å­æ¥è¯´æ˜è¿™ä¸€ç‚¹ï¼š</p><p><strong>ä¾‹å­ 1ï¼šå¯¼å…¥å…·ä½“çš„æ–‡ä»¶</strong></p><p>å‡è®¾ä½ æœ‰ä»¥ä¸‹çš„æ–‡ä»¶ç»“æ„ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>- my-package/</span></span>
<span class="line"><span>  - lib/</span></span>
<span class="line"><span>    - utils.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ Node.js v21.7.1 ä¹‹å‰ï¼Œä½ å¯èƒ½ä¼šè¿™æ ·å¯¼å…¥<code>utils.js</code>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// æ—§çš„æ–¹å¼ï¼Œæ²¡æœ‰æ‰©å±•å</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> utils</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">my-package/lib/utils</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ Node.js v21.7.1 åŠä»¥åï¼Œä½ éœ€è¦æ·»åŠ æ‰©å±•åï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// æ–°çš„æ–¹å¼ï¼Œéœ€è¦æŒ‡å®šæ‰©å±•å</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> utils</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">my-package/lib/utils.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä¾‹å­ 2ï¼šä½¿ç”¨<code>exports</code>æ˜ å°„ subpaths</strong></p><p>å¦‚æœä½ æ˜¯<code>my-package</code>åŒ…çš„ä½œè€…ï¼Œä½ å¯ä»¥åœ¨ä½ çš„<code>package.json</code>ä¸­ä½¿ç”¨<code>exports</code>å­—æ®µæ˜ å°„ subpaths åˆ°å¯¹åº”çš„æ–‡ä»¶ã€‚</p><p><code>package.json</code>å¯èƒ½çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">my-package</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">./lib/utils</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./lib/utils.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨è€…ç°åœ¨å¯ä»¥åƒè¿™æ ·å¯¼å…¥<code>utils.js</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> utils</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">my-package/lib/utils</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å³ä½¿æ¶ˆè´¹è€…ä¸éœ€è¦åœ¨å¯¼å…¥æ—¶æŒ‡å®šæ–‡ä»¶æ‰©å±•åï¼Œä½†æ˜¯ä½œä¸ºåŒ…çš„ä½œè€…ï¼Œä½ åœ¨<code>package.json</code>ä¸­å®šä¹‰æ˜ å°„æ—¶éœ€è¦æŒ‡å®šï¼Œè¿™æ · Node.js å¯ä»¥æ¸…æ¥šåœ°çŸ¥é“æ¯ä¸ª subpath æŒ‡å‘å“ªä¸ªå…·ä½“çš„æ–‡ä»¶ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯ Node.js ä¸­&quot;Extensions in subpaths&quot;ç‰¹æ€§çš„ä¸€ä¸ªç®€å•ä»‹ç»å’Œå‡ ä¸ªå®é™…åº”ç”¨çš„ä¾‹å­ã€‚å¸Œæœ›è¿™äº›ä¿¡æ¯å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼</p><h3 id="exports-sugar" tabindex="-1"><a class="header-anchor" href="#exports-sugar"><span><a href="https://nodejs.org/docs/latest/api/packages.html#exports-sugar" target="_blank" rel="noopener noreferrer">Exports sugar</a></span></a></h3><p>åœ¨è§£é‡Š Node.js ä¸­çš„ &quot;Exports sugar&quot;ï¼ˆå¯¼å‡ºè¯­æ³•ç³–ï¼‰ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆç†è§£ä¸€ä¸‹ Node.js çš„æ¨¡å—ç³»ç»Ÿã€‚åœ¨ Node.js ä¸­ï¼Œä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—éƒ½å¯ä»¥å¯¼å‡ºå¯¹è±¡ã€å‡½æ•°ã€å˜é‡ç­‰ï¼Œä»¥ä¾¿å…¶ä»–æ¨¡å—å¯ä»¥é€šè¿‡ <code>require</code> å‡½æ•°å¼•å…¥å¹¶ä½¿ç”¨å®ƒä»¬ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-exports-sugar" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-exports-sugar"><span>ä»€ä¹ˆæ˜¯ Exports Sugarï¼Ÿ</span></a></h3><p>&quot;Exports sugar&quot; æ˜¯ä¸€ç§ç®€åŒ–çš„è¯­æ³•ï¼Œç”¨äºåœ¨ Node.js æ¨¡å—ä¸­å¯¼å‡ºå¤šä¸ªåŠŸèƒ½æˆ–å€¼ã€‚åœ¨è¾ƒæ–°ç‰ˆæœ¬çš„ Node.jsï¼ˆå¦‚ä½ æåˆ°çš„ v21.7.1ï¼‰ä¸­ï¼Œè¿™ç§ç®€åŒ–çš„è¯­æ³•è®©å¼€å‘è€…å¯ä»¥æ›´æ–¹ä¾¿å¿«æ·åœ°å®šä¹‰æ¨¡å—çš„å…¬å¼€æ¥å£ã€‚</p><p>é€šå¸¸ï¼Œåœ¨ä¸€ä¸ªæ¨¡å—ä¸­å¯¼å‡ºå¤šä¸ªå€¼æ—¶ï¼Œä½ å¯èƒ½ä¼šè¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// åœ¨æ²¡æœ‰è¯­æ³•ç³–çš„æƒ…å†µä¸‹</span></span>
<span class="line"><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">func1</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> function</span><span style="color:#ECEFF4;"> ()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // åŠŸèƒ½å®ç°</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">value1</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 123</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">obj1</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">  key</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">value</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è€Œä½¿ç”¨äº† &quot;Exports sugar&quot; åï¼Œä½ å¯ä»¥é‡‡ç”¨æ›´åŠ ç®€æ´çš„æ–¹å¼æ¥å®ç°ç›¸åŒçš„ç›®çš„ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// package.json æ–‡ä»¶ä¸­</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">./func1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./path/to/func1-module.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">./value1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./path/to/value1-module.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">./obj1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./path/to/obj1-module.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œçš„å…³é”®ç‚¹åœ¨äº <code>package.json</code> æ–‡ä»¶çš„ <code>&quot;exports&quot;</code> å­—æ®µï¼Œå®ƒå…è®¸ä½ å®šä¹‰æ¨¡å—çš„å¯¼å‡ºç»“æ„ï¼Œä½¿å¾—å…¶ä»–æ–‡ä»¶å¯ä»¥é€šè¿‡ç‰¹å®šçš„è·¯å¾„å¯¼å…¥æ‰€éœ€å†…å®¹ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨æ„å»ºä¸€ä¸ªæ•°å­¦å·¥å…·åº“ï¼Œè¯¥åº“æœ‰ä¸åŒçš„åŠŸèƒ½ï¼Œå¦‚åŠ æ³•ã€å‡æ³•å’Œä¹˜æ³•ã€‚ä½¿ç”¨ &quot;Exports sugar&quot;ï¼Œä½ å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ç»„ç»‡å’Œå¯¼å‡ºè¿™äº›åŠŸèƒ½ã€‚</p><ol><li><p><strong>ç»„ç»‡æ¨¡å—</strong>ï¼šé¦–å…ˆï¼Œå°†æ¯ä¸ªåŠŸèƒ½æ”¾åœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­ï¼š</p><ul><li><code>add.js</code></li><li><code>subtract.js</code></li><li><code>multiply.js</code></li></ul></li><li><p><strong>å¯¼å‡ºæ¨¡å—</strong>ï¼šåœ¨ <code>package.json</code> ä¸­ä½¿ç”¨ &quot;Exports sugar&quot; æ¥å®šä¹‰å¯¼å‡ºï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">math-tools</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">./add</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/add.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">./subtract</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/subtract.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">./multiply</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/multiply.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>ä½¿ç”¨æ¨¡å—</strong>ï¼šç°åœ¨ï¼Œå…¶ä»–é¡¹ç›®å¯ä»¥æ ¹æ®éœ€è¦å¯¼å…¥è¿™äº›å•ç‹¬çš„åŠŸèƒ½ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> add</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">math-tools/add</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> subtract</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">math-tools/subtract</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#88C0D0;">add</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">5</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 3</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: 8</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#88C0D0;">subtract</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">10</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 7</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: 3</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>è¿™ç§æ–¹æ³•çš„ä¼˜åŠ¿åœ¨äºå®ƒä¸ºæ¨¡å—çš„æ¶ˆè´¹è€…æä¾›äº†æ¸…æ™°çš„æ¥å£ï¼Œå¹¶ä¸”ä½¿å¾—æ¨¡å—çš„ç»“æ„æ›´åŠ çµæ´»å’Œæ˜“äºç®¡ç†ã€‚</p><p>æ€»ä¹‹ï¼Œ&quot;Exports sugar&quot; æ˜¯ Node.js æä¾›çš„ä¸€ç§æ›´ä¼˜é›…çš„æ¨¡å—å¯¼å‡ºæ–¹å¼ï¼Œå®ƒä¿ƒè¿›äº†ä»£ç çš„æ¨¡å—åŒ–å’Œé‡ç”¨ï¼ŒåŒæ—¶ä¹Ÿä½¿å¾—åŒ…çš„ç»“æ„æ›´åŠ æ¸…æ™°ã€‚</p><h3 id="subpath-imports" tabindex="-1"><a class="header-anchor" href="#subpath-imports"><span><a href="https://nodejs.org/docs/latest/api/packages.html#subpath-imports" target="_blank" rel="noopener noreferrer">Subpath imports</a></span></a></h3><p>Node.js çš„&quot;Subpath imports&quot;æ˜¯å…³äºæ¨¡å—å’ŒåŒ…ç®¡ç†çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§ï¼Œå®ƒå…è®¸ä½ æ›´ç²¾ç»†åœ°æ§åˆ¶å¯ä»¥ä»ä½ çš„åŒ…ä¸­å¯¼å…¥å“ªäº›éƒ¨åˆ†ï¼ˆsubpathsï¼‰ï¼Œä»¥åŠå¦‚ä½•å¯¼å…¥å®ƒä»¬ã€‚åœ¨ Node.js v21.7.1 ä¸­ï¼Œè¿™ä¸ªç‰¹æ€§è®©ä½ èƒ½å¤ŸæŒ‡å®šã€é™åˆ¶å’Œé‡æ–°æ˜ å°„åŒ…å†…éƒ¨æ–‡ä»¶çš„å¯¼å…¥è¡Œä¸ºã€‚</p><h3 id="ç†è§£-subpath-imports" tabindex="-1"><a class="header-anchor" href="#ç†è§£-subpath-imports"><span>ç†è§£ Subpath imports</span></a></h3><p>å½“ä½ åˆ›å»ºä¸€ä¸ª Node.js é¡¹ç›®æ—¶ï¼Œé€šå¸¸ä¼šæœ‰å¾ˆå¤šä¸åŒçš„æ–‡ä»¶å’Œæ¨¡å—ã€‚æœ‰äº›æ–‡ä»¶å¯èƒ½æ˜¯ä½ æƒ³å¯¹å¤–å…¬å¼€çš„ï¼ˆä¾‹å¦‚ï¼ŒAPI æ¥å£æˆ–å·¥å…·å‡½æ•°ï¼‰ï¼Œè€Œæœ‰äº›åˆ™å¯èƒ½åªæ˜¯å†…éƒ¨ä½¿ç”¨çš„ï¼ˆä¾‹å¦‚ï¼Œé…ç½®æ–‡ä»¶æˆ–è¾…åŠ©å‡½æ•°ï¼‰ã€‚é€šè¿‡ä½¿ç”¨ Subpath importsï¼Œä½ å¯ä»¥æ›´å¥½åœ°æ§åˆ¶å¤–éƒ¨ä»£ç å¯ä»¥è®¿é—®å“ªäº›æ–‡ä»¶ï¼Œè¿™æœ‰åŠ©äºæé«˜ä»£ç çš„å®‰å…¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨"><span>å¦‚ä½•ä½¿ç”¨ï¼Ÿ</span></a></h3><p>åœ¨ä½ çš„åŒ…ä¸­ï¼Œä½ éœ€è¦åœ¨<code>package.json</code>æ–‡ä»¶ä¸­ä½¿ç”¨<code>exports</code>å­—æ®µæ¥å®šä¹‰ subpath exportsã€‚è¿™é‡Œé¢ä½ å¯ä»¥æŒ‡å®šå“ªäº› subpath æ˜¯å¯å¯¼å…¥çš„ï¼Œç”šè‡³é‡æ–°æ˜ å°„è·¯å¾„ã€‚</p><h4 id="å®é™…ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­"><span>å®é™…ä¾‹å­</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º<code>my-awesome-lib</code>çš„ Node.js åº“ï¼Œå®ƒçš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>/my-awesome-lib</span></span>
<span class="line"><span>  /src</span></span>
<span class="line"><span>    - index.js</span></span>
<span class="line"><span>    - util.js</span></span>
<span class="line"><span>  - package.json</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ å¸Œæœ›ç”¨æˆ·å¯ä»¥ç›´æ¥ä»åº“ä¸­å¯¼å…¥<code>index.js</code>ï¼Œä½†æ˜¯<code>util.js</code>ä»…ä¾›å†…éƒ¨ä½¿ç”¨ã€‚</p><p>åœ¨<code>package.json</code>ä¸­ï¼Œä½ å¯ä»¥è¿™æ ·è®¾ç½®ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">my-awesome-lib</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/index.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œ&quot;.&quot;ä»£è¡¨åŒ…çš„æ ¹å¯¼å‡ºï¼Œæˆ‘ä»¬æŒ‡å‘äº†<code>./src/index.js</code>ã€‚ç°åœ¨ï¼Œå½“ç”¨æˆ·å°è¯•ä»<code>my-awesome-lib</code>ä¸­å¯¼å…¥ä¸œè¥¿æ—¶ï¼Œåªæœ‰<code>index.js</code>æ˜¯å¯è§çš„ï¼Œå°è¯•å¯¼å…¥<code>util.js</code>å°†ä¼šå¤±è´¥ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰å°†å…¶åˆ—åœ¨<code>exports</code>ä¸­ã€‚</p><h3 id="æ›´é«˜çº§çš„ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#æ›´é«˜çº§çš„ç”¨æ³•"><span>æ›´é«˜çº§çš„ç”¨æ³•</span></a></h3><p>ä½ è¿˜å¯ä»¥å¯¹ subpath è¿›è¡Œæ˜ å°„ï¼Œæä¾›åˆ«åï¼Œä½¿å¾—å¯¼å…¥æ–¹å¼æ›´åŠ çµæ´»ã€‚</p><p>å‡è®¾<code>util.js</code>æœ‰ä¸€äº›åŠŸèƒ½ï¼Œä½ æƒ³è®©å®ƒä½œä¸ºå•ç‹¬çš„å­è·¯å¾„æä¾›ï¼Œä½†åˆä¸æƒ³æš´éœ²æ•´ä¸ªæ–‡ä»¶ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/index.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">./utils</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/util.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·è®¾ç½®åï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡<code>import something from &#39;my-awesome-lib/utils&#39;</code>æ¥å¯¼å…¥<code>util.js</code>ä¸­çš„å†…å®¹ï¼Œè€Œå…¶ä»–æ²¡æœ‰åœ¨<code>exports</code>ä¸­å®šä¹‰çš„æ–‡ä»¶æˆ–è·¯å¾„å°†æ— æ³•è¢«å¯¼å…¥ã€‚</p><h3 id="å°ç»“" tabindex="-1"><a class="header-anchor" href="#å°ç»“"><span>å°ç»“</span></a></h3><p>Subpath imports æ˜¯ Node.js ä¸­ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ç‰¹æ€§ï¼Œé€šè¿‡åˆç†åˆ©ç”¨å®ƒï¼Œä½ å¯ä»¥æ›´å¥½åœ°ç®¡ç†ä½ çš„åŒ…çš„å…¬å¼€æ¥å£ï¼Œä¿æŠ¤å†…éƒ¨ä»£ç ï¼ŒåŒæ—¶ä¹Ÿä¸ºä½¿ç”¨è€…æä¾›æ¸…æ™°ã€ç®€æ´çš„ APIã€‚è®°ä½ï¼Œæ­£ç¡®ä½¿ç”¨<code>exports</code>å­—æ®µæ˜¯å®ç°è¿™ä¸€ç‚¹çš„å…³é”®ã€‚</p><h3 id="subpath-patterns" tabindex="-1"><a class="header-anchor" href="#subpath-patterns"><span><a href="https://nodejs.org/docs/latest/api/packages.html#subpath-patterns" target="_blank" rel="noopener noreferrer">Subpath patterns</a></span></a></h3><p>Node.js v21.7.1 ä¸­çš„â€œSubpath patternsâ€æ˜¯ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå…è®¸åœ¨<code>package.json</code>æ–‡ä»¶ä¸­æ›´çµæ´»åœ°å®šä¹‰åŒ…çš„å¯¼å‡ºå†…å®¹ã€‚è¿™æ„å‘³ç€å¼€å‘è€…å¯ä»¥æ§åˆ¶å…¶ä»–äººå¦‚ä½•å¯¼å…¥å’Œä½¿ç”¨ä»–ä»¬çš„åŒ…ï¼Œä»è€Œæä¾›äº†å¯¹æ¨¡å—ç»“æ„å’Œå°è£…çš„æ›´ç»†ç²’åº¦æ§åˆ¶ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œä¸€ä¸ªåŒ…ï¼ˆpackageï¼‰é€šå¸¸æŒ‡çš„æ˜¯ä¸€ä¸ªåŒ…å«<code>package.json</code>æ–‡ä»¶çš„ç›®å½•ï¼Œå®ƒå®šä¹‰äº†åŒ…çš„å±æ€§å’Œè¡Œä¸ºã€‚åœ¨<code>package.json</code>ä¸­ï¼Œ<code>&quot;exports&quot;</code>å­—æ®µç”¨äºæŒ‡å®šå“ªäº›æ¨¡å—å¯ä»¥è¢«å¤–éƒ¨ä»£ç å¯¼å…¥ï¼Œä»¥åŠå¦‚ä½•å¯¼å…¥å®ƒä»¬ã€‚</p><h3 id="ä½¿ç”¨-subpath-patterns" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-subpath-patterns"><span>ä½¿ç”¨ Subpath Patterns</span></a></h3><p><code>Subpath patterns</code>æ‰©å±•äº†<code>&quot;exports&quot;</code>å­—æ®µçš„åŠŸèƒ½ï¼Œå…è®¸ä½ é€šè¿‡æ¨¡å¼åŒ¹é…æ¥å®šä¹‰ä¸€ç»„å­è·¯å¾„çš„å¯¼å‡ºè§„åˆ™ã€‚è¿™ä½¿å¾—åŒ…çš„ä½œè€…å¯ä»¥åˆ›å»ºæ›´å¤æ‚çš„å¯¼å‡ºæ˜ å°„ï¼Œè€Œä¸å¿…ä¸ºæ¯ä¸ªå…·ä½“æ–‡ä»¶æˆ–ç›®å½•æ‰‹åŠ¨å®šä¹‰è§„åˆ™ã€‚</p><h3 id="ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹"><span>ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåä¸º<code>my-cool-library</code>çš„ Node.js åº“ï¼Œè¯¥åº“çš„ç»“æ„å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>my-cool-library/</span></span>
<span class="line"><span>  src/</span></span>
<span class="line"><span>    components/</span></span>
<span class="line"><span>      button.js</span></span>
<span class="line"><span>      link.js</span></span>
<span class="line"><span>    utils/</span></span>
<span class="line"><span>      math.js</span></span>
<span class="line"><span>      string.js</span></span>
<span class="line"><span>  package.json</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä¸ä½¿ç”¨-subpath-patterns" tabindex="-1"><a class="header-anchor" href="#ä¸ä½¿ç”¨-subpath-patterns"><span>ä¸ä½¿ç”¨ Subpath Patterns</span></a></h4><p>å¦‚æœä¸ä½¿ç”¨ subpath patternsï¼Œä½ å¯èƒ½éœ€è¦åœ¨<code>package.json</code>æ–‡ä»¶ä¸­ä¸ºæ¯ä¸ªæƒ³è¦å…¬å¼€çš„æ¨¡å—å•ç‹¬åˆ—å‡ºè·¯å¾„ï¼Œä¾‹å¦‚ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">my-cool-library</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">./components/button</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/components/button.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">./components/link</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/components/link.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">./utils/math</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/utils/math.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">./utils/string</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/utils/string.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ç§æ–¹æ³•è™½ç„¶æ˜ç¡®ï¼Œä½†å¾ˆç¹çï¼Œç‰¹åˆ«æ˜¯å½“ä½ æœ‰å¾ˆå¤šæ–‡ä»¶éœ€è¦å¯¼å‡ºæ—¶ã€‚</p><h4 id="ä½¿ç”¨-subpath-patterns-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-subpath-patterns-1"><span>ä½¿ç”¨ Subpath Patterns</span></a></h4><p>åˆ©ç”¨ subpath patternsï¼Œä½ å¯ä»¥ç”¨ä¸€ç§æ›´ç®€æ´çš„æ–¹å¼æ¥å®ç°ç›¸åŒçš„æ•ˆæœï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">my-cool-library</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">./components/*</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/components/*.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">./utils/*</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/utils/*.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œ<code>*</code>å­—ç¬¦ç”¨ä½œé€šé…ç¬¦ï¼ŒåŒ¹é…ä»»ä½•ç›¸åº”å­è·¯å¾„çš„åç§°ã€‚è¿™æ ·ï¼Œ<code>&quot;./components/*&quot;</code>å°±èƒ½è¦†ç›–<code>components</code>ç›®å½•ä¸‹æ‰€æœ‰<code>.js</code>æ–‡ä»¶çš„å¯¼å‡ºã€‚</p><h3 id="å®é™…è¿ç”¨-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨-1"><span>å®é™…è¿ç”¨</span></a></h3><p>Subpath patterns éå¸¸é€‚åˆäºé‚£äº›å…·æœ‰è¾ƒå¤§æˆ–å¤æ‚ç›®å½•ç»“æ„çš„åŒ…ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥å¤§å¹…ç®€åŒ–<code>package.json</code>ä¸­çš„<code>&quot;exports&quot;</code>å­—æ®µã€‚æ­¤å¤–ï¼Œå®ƒä¹Ÿå¢åŠ äº†æ¨¡å—å°è£…æ€§ï¼Œå› ä¸ºåŒ…çš„ä½œè€…å¯ä»¥æ›´çµæ´»åœ°æ§åˆ¶å“ªäº›éƒ¨åˆ†æ˜¯å¯å¯¼å‡ºçš„ï¼Œå“ªäº›æ˜¯å†…éƒ¨ç§æœ‰çš„ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœä½ å¼€å‘äº†ä¸€ä¸ªå·¥å…·åº“ï¼Œå…¶ä¸­åŒ…å«å¾ˆå¤šå·¥å…·å‡½æ•°åˆ†å¸ƒåœ¨ä¸åŒçš„å­ç›®å½•ä¸­ï¼Œé€šè¿‡ subpath patternsï¼Œä½ åªéœ€å‡ æ¡è§„åˆ™å°±å¯ä»¥è½»æ¾ç®¡ç†æ‰€æœ‰è¿™äº›å¯¼å‡ºï¼Œè€Œæ— éœ€ä¸ºæ¯ä¸ªå‡½æ•°å•ç‹¬è®¾ç½®è·¯å¾„ã€‚</p><h3 id="å°ç»“-1" tabindex="-1"><a class="header-anchor" href="#å°ç»“-1"><span>å°ç»“</span></a></h3><p><code>Subpath patterns</code>æ˜¯ Node.js ä¸­ä¸€ä¸ªå¼ºå¤§çš„æ–°ç‰¹æ€§ï¼Œå®ƒä½¿å¾—åœ¨å¤§å‹é¡¹ç›®ä¸­ç®¡ç†å’Œæ§åˆ¶åŒ…çš„å¯¼å‡ºå˜å¾—æ›´åŠ é«˜æ•ˆå’Œçµæ´»ã€‚é€šè¿‡å®ƒï¼Œå¼€å‘è€…èƒ½å¤Ÿä»¥æ›´æ¸…æ™°å’Œç®€æ´çš„æ–¹å¼å±•ç¤ºä»–ä»¬çš„åŒ…ç»“æ„ï¼ŒåŒæ—¶ä¹Ÿè®©åŒ…çš„ä½¿ç”¨è€…èƒ½å¤Ÿæ›´æ–¹ä¾¿åœ°è®¿é—®æ‰€éœ€çš„æ¨¡å—ã€‚</p><h3 id="conditional-exports" tabindex="-1"><a class="header-anchor" href="#conditional-exports"><span><a href="https://nodejs.org/docs/latest/api/packages.html#conditional-exports" target="_blank" rel="noopener noreferrer">Conditional exports</a></span></a></h3><p>Conditional exports in Node.js æ˜¯ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå…è®¸åŒ…çš„ç»´æŠ¤è€…å®šä¹‰ä¸€å¥—è§„åˆ™æ¥æŒ‡å®šåœ¨ä¸åŒæ¡ä»¶ä¸‹åº”è¯¥å¯¼å‡ºå“ªäº›æ¨¡å—ã€‚è¿™ä¸ªåŠŸèƒ½åœ¨ Node.js v12 ä»¥åçš„ç‰ˆæœ¬ä¸­å¼•å…¥ï¼Œå¹¶ä¸”éšç€æ—¶é—´æ¨ç§»å¾—åˆ°äº†å¢å¼ºã€‚</p><h3 id="ä¸ºä»€ä¹ˆéœ€è¦æ¡ä»¶æ€§å¯¼å‡º" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆéœ€è¦æ¡ä»¶æ€§å¯¼å‡º"><span>ä¸ºä»€ä¹ˆéœ€è¦æ¡ä»¶æ€§å¯¼å‡ºï¼Ÿ</span></a></h3><p>é€šå¸¸ï¼Œä¸€ä¸ª Node.js åŒ…å¯èƒ½éœ€è¦æ ¹æ®ä¸åŒçš„è¿è¡Œç¯å¢ƒï¼ˆä¾‹å¦‚æµè§ˆå™¨ç¯å¢ƒ vs. Node.js ç¯å¢ƒï¼‰ã€ä¸åŒçš„æ¨¡å—ç³»ç»Ÿï¼ˆä¾‹å¦‚ CommonJS vs. ES æ¨¡å—ï¼‰æˆ–æ˜¯åŸºäºå…¶ä»–æ ‡å‡†ï¼ˆå¦‚ç”Ÿäº§ç¯å¢ƒ vs. å¼€å‘ç¯å¢ƒï¼‰æ¥æä¾›ä¸åŒçš„ä»£ç ç‰ˆæœ¬ã€‚é€šè¿‡ä½¿ç”¨æ¡ä»¶æ€§å¯¼å‡ºï¼ŒåŒ…å¯ä»¥åœ¨<code>package.json</code>æ–‡ä»¶ä¸­é…ç½®è¿™äº›è§„åˆ™ï¼Œä»è€Œä½¿å¾—å¯¼å…¥ç›¸åŒåŒ…çš„ä»£ç èƒ½å¤Ÿæ ¹æ®å½“å‰ç¯å¢ƒè‡ªåŠ¨é€‰æ‹©åˆé€‚çš„ç‰ˆæœ¬ã€‚</p><h3 id="å¦‚ä½•å·¥ä½œ" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•å·¥ä½œ"><span>å¦‚ä½•å·¥ä½œï¼Ÿ</span></a></h3><p>åœ¨<code>package.json</code>æ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨&quot;exports&quot;å­—æ®µæ¥å®šä¹‰ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„é”®æ˜¯æ¡ä»¶åç§°ï¼Œå€¼æ˜¯å¯¹åº”æ¡ä»¶ä¸‹è¦å¯¼å‡ºæ¨¡å—çš„è·¯å¾„ã€‚å½“ä¸€ä¸ªæ¨¡å—è¢«å¯¼å…¥æ—¶ï¼ŒNode.js ä¼šæ£€æŸ¥è¿™äº›æ¡ä»¶å¹¶è§£æå‡ºæ­£ç¡®çš„è·¯å¾„ã€‚</p><h3 id="å®é™…ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-1"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º<code>awesome-package</code>çš„åŒ…ï¼Œå®ƒä¸º Node.js å’Œæµè§ˆå™¨ç¯å¢ƒæä¾›äº†ä¸åŒçš„åŠŸèƒ½å®ç°ã€‚</p><p><strong>1. å®šä¹‰æ¡ä»¶æ€§å¯¼å‡º</strong></p><p>åœ¨<code>awesome-package</code>çš„<code>package.json</code>ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·è®¾ç½®æ¡ä»¶æ€§å¯¼å‡ºï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">awesome-package</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">browser</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/browser-index.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">default</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/node-index.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">    },</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">./feature</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">browser</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/feature-browser.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">default</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/feature-node.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ç»„æ¡ä»¶æ€§å¯¼å‡ºè§„åˆ™ï¼š</p><ul><li>å¯¹äºåŒ…çš„ä¸»å…¥å£ï¼ˆ&quot;.&quot;ï¼‰ï¼Œå¦‚æœæ˜¯åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ï¼Œé‚£ä¹ˆä¼šä½¿ç”¨<code>./src/browser-index.js</code>ï¼›å¦åˆ™ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šä½¿ç”¨<code>./src/node-index.js</code>ã€‚</li><li>å¯¹äºåŒ…å†…çš„ç‰¹å®šåŠŸèƒ½ï¼ˆ&quot;./feature&quot;ï¼‰ï¼Œä¹Ÿæœ‰ç±»ä¼¼çš„è§„åˆ™ï¼šæµè§ˆå™¨ç¯å¢ƒä½¿ç”¨<code>./src/feature-browser.js</code>ï¼Œè€Œ Node.js ç¯å¢ƒåˆ™ä½¿ç”¨<code>./src/feature-node.js</code>ã€‚</li></ul><p><strong>2. ä½¿ç”¨æ¡ä»¶æ€§å¯¼å‡º</strong></p><p>å½“ç”¨æˆ·åœ¨ä»–ä»¬çš„é¡¹ç›®ä¸­å¯¼å…¥<code>awesome-package</code>æˆ–å…¶ä¸­çš„ç‰¹å®šåŠŸèƒ½æ—¶ï¼ŒNode.js ä¼šæ ¹æ®å½“å‰ç¯å¢ƒè‡ªåŠ¨é€‰æ‹©åˆé€‚çš„æ¨¡å—ç‰ˆæœ¬ã€‚</p><p>åœ¨ Node.js ç¯å¢ƒä¸­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> awesome</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">awesome-package</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åŠ è½½./src/node-index.js</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> feature</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">awesome-package/feature</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åŠ è½½./src/feature-node.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>è€Œåœ¨æ”¯æŒæ¡ä»¶æ€§å¯¼å‡ºçš„æ„å»ºå·¥å…·ï¼ˆå¦‚ Webpackï¼‰ç”¨äºæµè§ˆå™¨ç¯å¢ƒçš„é¡¹ç›®ä¸­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> awesome</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">awesome-package</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åŠ è½½./src/browser-index.js</span></span>
<span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> feature</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">awesome-package/feature</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åŠ è½½./src/feature-browser.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ç§æ–¹å¼å¤§å¤§å¢åŠ äº†åŒ…çš„çµæ´»æ€§å’Œé€‚ç”¨èŒƒå›´ï¼ŒåŒæ—¶ç®€åŒ–äº†ä¸ºä¸åŒç¯å¢ƒé…ç½®ä¸åŒç‰ˆæœ¬çš„å¤æ‚åº¦ã€‚</p><h3 id="ç»“è®º-1" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-1"><span>ç»“è®º</span></a></h3><p>é€šè¿‡ä½¿ç”¨æ¡ä»¶æ€§å¯¼å‡ºï¼ŒNode.js åŒ…ä½œè€…å¯ä»¥æ›´çµæ´»åœ°ç®¡ç†ä»–ä»¬çš„åŒ…ï¼Œç¡®ä¿æ ¹æ®ä¸åŒçš„ä½¿ç”¨åœºæ™¯æä¾›æœ€åˆé€‚çš„ä»£ç ã€‚è¿™å¯¹äºå¼€å‘è·¨å¹³å°åº”ç”¨ç¨‹åºç‰¹åˆ«æœ‰å¸®åŠ©ï¼Œä½¿å¾—ä»£ç çš„å…±äº«å’Œé‡ç”¨å˜å¾—æ›´åŠ å®¹æ˜“å’Œé«˜æ•ˆã€‚</p><h3 id="nested-conditions" tabindex="-1"><a class="header-anchor" href="#nested-conditions"><span><a href="https://nodejs.org/docs/latest/api/packages.html#nested-conditions" target="_blank" rel="noopener noreferrer">Nested conditions</a></span></a></h3><p>Node.js ä¸­çš„ &quot;Nested conditions&quot;ï¼ˆåµŒå¥—æ¡ä»¶ï¼‰æ˜¯ä¸€ä¸ªå…³äºå¦‚ä½•åœ¨ <code>package.json</code> æ–‡ä»¶ä¸­å®šä¹‰å’Œä½¿ç”¨æ¡ä»¶å¯¼å…¥çš„åŠŸèƒ½ã€‚è¿™èƒ½è®©å¼€å‘è€…æ›´åŠ çµæ´»åœ°æ§åˆ¶æ¨¡å—çš„åŠ è½½è¡Œä¸ºï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†ä¸åŒç¯å¢ƒï¼ˆå¦‚ç”Ÿäº§ç¯å¢ƒå’Œå¼€å‘ç¯å¢ƒï¼‰ã€å¹³å°ï¼ˆå¦‚ Windowsã€Linuxï¼‰æˆ–æ¨¡å—æ ¼å¼ï¼ˆå¦‚ ES æ¨¡å—ä¸ CommonJSï¼‰æ—¶ã€‚ä» Node.js v12 å¼€å§‹å¼•å…¥çš„ &quot;exports&quot; å­—æ®µå°±æ”¯æŒäº†è¿™æ ·çš„æ¡ä»¶å¯¼å…¥åŠŸèƒ½ï¼Œè€Œåœ¨åç»­ç‰ˆæœ¬ä¸­ä¸æ–­å¢å¼ºï¼Œv21.7.1 ä¸­è¿›ä¸€æ­¥æä¾›äº†åµŒå¥—æ¡ä»¶çš„æ”¯æŒã€‚</p><h3 id="åŸºç¡€ç†è§£" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€ç†è§£"><span>åŸºç¡€ç†è§£</span></a></h3><p>é¦–å…ˆï¼Œæ˜ç™½ <code>package.json</code> çš„ &quot;exports&quot; å­—æ®µçš„åŸºæœ¬ç”¨é€”æ˜¯éå¸¸é‡è¦çš„ã€‚å®ƒå…è®¸åº“ï¼ˆpackageï¼‰çš„ä½œè€…æŒ‡å®šå“ªäº›æ–‡ä»¶å¯ä»¥è¢«å¤–éƒ¨ä»£ç å¯¼å…¥ã€‚è¿™ä¸ªå­—æ®µçš„å‡ºç°ï¼Œæå‡äº†æ¨¡å—å°è£…æ€§ï¼Œé˜²æ­¢äº†ç§æœ‰æˆ–å†…éƒ¨æ¨¡å—è¢«æ„å¤–ä½¿ç”¨ã€‚</p><h3 id="åµŒå¥—æ¡ä»¶çš„æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#åµŒå¥—æ¡ä»¶çš„æ¦‚å¿µ"><span>åµŒå¥—æ¡ä»¶çš„æ¦‚å¿µ</span></a></h3><p>â€œåµŒå¥—æ¡ä»¶â€å…è®¸ä½ åœ¨ &quot;exports&quot; å­—æ®µä¸­ä½¿ç”¨æ›´å¤æ‚çš„æ¡ä»¶è¯­å¥æ¥å†³å®šæœ€ç»ˆå¯¼å‡ºå“ªä¸ªæ¨¡å—ã€‚ä½ å¯ä»¥æ ¹æ®ä¸åŒçš„ç¯å¢ƒæˆ–éœ€æ±‚ï¼Œè®¾ç½®å¤šé‡æ¡ä»¶ï¼Œè¿™äº›æ¡ä»¶ä¼šæŒ‰ç…§ä¸€å®šçš„ä¼˜å…ˆçº§é¡ºåºè¿›è¡Œè¯„ä¼°ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-3"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº“ï¼Œè¿™ä¸ªåº“éœ€è¦å¯¹ä¸åŒçš„ç¯å¢ƒï¼ˆæ¯”å¦‚ Node.js ç‰ˆæœ¬ã€æ˜¯å¦æ˜¯ç”Ÿäº§ç¯å¢ƒï¼‰æä¾›ä¸åŒçš„ä»£ç å®ç°ã€‚ä½ çš„ <code>package.json</code> æ–‡ä»¶ä¸­çš„ &quot;exports&quot; å­—æ®µå¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">your-package-name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">import</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/modern.mjs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">require</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/legacy.cjs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">node</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">&gt;=16</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/latest-node.mjs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">`&lt;`16</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/older-node.cjs</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">      },</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">default</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/default.mjs</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå½“å°è¯•å¯¼å…¥è¿™ä¸ªåŒ…æ—¶ï¼ŒNode.js ä¼šæ ¹æ®å½“å‰ç¯å¢ƒä¸­æ»¡è¶³çš„æ¡ä»¶æ¥å†³å®šä½¿ç”¨å“ªä¸ªæ–‡ä»¶ï¼š</p><ul><li>å¦‚æœæ˜¯é€šè¿‡ ES æ¨¡å—çš„æ–¹å¼ (<code>import</code>) å¯¼å…¥ï¼Œåˆ™é»˜è®¤ä½¿ç”¨ <code>./src/modern.mjs</code>ã€‚</li><li>å¦‚æœæ˜¯é€šè¿‡ CommonJS çš„æ–¹å¼ (<code>require</code>) å¯¼å…¥ï¼Œåˆ™é»˜è®¤ä½¿ç”¨ <code>./src/legacy.cjs</code>ã€‚</li><li>å¯¹äº Node.js ç¯å¢ƒçš„ç‰¹å®šç‰ˆæœ¬ï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥ç»†åŒ–æ¡ä»¶ï¼š <ul><li>å¦‚æœ Node.js çš„ç‰ˆæœ¬æ˜¯ 16 æˆ–ä»¥ä¸Šï¼Œæ— è®ºæ˜¯ <code>import</code> è¿˜æ˜¯ <code>require</code> æ–¹å¼ï¼Œéƒ½ä¼šä½¿ç”¨ <code>./src/latest-node.mjs</code>ã€‚</li><li>å¦‚æœ Node.js çš„ç‰ˆæœ¬ä½äº 16ï¼Œå°†ä½¿ç”¨ <code>./src/older-node.cjs</code>ã€‚</li></ul></li><li>å¦‚æœæ²¡æœ‰ä»»ä½•æ¡ä»¶åŒ¹é…æˆåŠŸï¼Œé‚£ä¹ˆä½œä¸ºå›é€€ä½¿ç”¨ <code>./src/default.mjs</code>ã€‚</li></ul><p>è¿™ç§æœºåˆ¶éå¸¸çµæ´»ï¼Œä½¿å¾—åº“çš„ä½œè€…å¯ä»¥é’ˆå¯¹ä¸åŒçš„ä½¿ç”¨åœºæ™¯æä¾›æœ€ä¼˜åŒ–çš„ä»£ç å®ç°ï¼ŒåŒæ—¶ä¹Ÿä¿è¯äº†å‘åå…¼å®¹æ€§ã€‚</p><h3 id="æ€»ç»“-2" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-2"><span>æ€»ç»“</span></a></h3><p>&quot;Nested conditions&quot; åœ¨ Node.js ä¸­æ˜¯å…³äºæ¨¡å—å¯¼å‡ºçš„ä¸€ä¸ªå¼ºå¤§åŠŸèƒ½ã€‚å®ƒé€šè¿‡åœ¨ <code>package.json</code> çš„ &quot;exports&quot; å­—æ®µä¸­å®šä¹‰å¤æ‚çš„æ¡ä»¶é€»è¾‘ï¼Œå…è®¸å¼€å‘è€…æ ¹æ®ä¸åŒçš„è¿è¡Œç¯å¢ƒæˆ–å¯¼å…¥æ–¹å¼ï¼Œé€‰æ‹©æ€§åœ°å¯¼å‡ºä¸åŒçš„æ¨¡å—ç‰ˆæœ¬ã€‚å€ŸåŠ©è¿™ä¸€åŠŸèƒ½ï¼ŒNode.js åº”ç”¨å’Œåº“çš„å¼€å‘è€…å¯ä»¥æ›´çµæ´»ã€æ›´æœ‰æ•ˆåœ°ç®¡ç†ä»–ä»¬çš„ä»£ç ï¼Œä»¥é€‚åº”ä¸åŒçš„ä½¿ç”¨åœºæ™¯ã€‚</p><h3 id="resolving-user-conditions" tabindex="-1"><a class="header-anchor" href="#resolving-user-conditions"><span><a href="https://nodejs.org/docs/latest/api/packages.html#resolving-user-conditions" target="_blank" rel="noopener noreferrer">Resolving user conditions</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ&quot;Resolving user conditions&quot; æ˜¯ä¸€ä¸ªä¸åŒ…ï¼ˆpackageï¼‰å’Œæ¨¡å—ï¼ˆmoduleï¼‰å¯¼å…¥ç›¸å…³çš„æ¦‚å¿µï¼Œç‰¹åˆ«æ˜¯åœ¨ä½¿ç”¨ JavaScript çš„æ–°æ¨¡å—ç³»ç»Ÿï¼ˆES Modulesï¼Œç®€ç§° ESMï¼‰æ—¶ã€‚è¿™ä¸ªç‰¹æ€§ä¸»è¦æ¶‰åŠåˆ°<code>package.json</code>æ–‡ä»¶ä¸­çš„<code>&quot;exports&quot;</code>å­—æ®µä»¥åŠå¦‚ä½•æ ¹æ®ä¸åŒçš„æ¡ä»¶æ¥å†³å®šå¯¼å…¥å“ªä¸ªæ–‡ä»¶ã€‚</p><h3 id="åŸºç¡€ç†è§£-1" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€ç†è§£-1"><span>åŸºç¡€ç†è§£</span></a></h3><p>é¦–å…ˆï¼Œä½ éœ€è¦çŸ¥é“<code>package.json</code>æ–‡ä»¶æ˜¯ Node.js é¡¹ç›®ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒæ–‡ä»¶ï¼Œå®ƒæè¿°äº†é¡¹ç›®çš„å„ç§å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºé¡¹ç›®ä¾èµ–ã€è„šæœ¬å‘½ä»¤å’Œæ¨¡å—å¯¼å‡ºä¿¡æ¯ç­‰ã€‚</p><p>åœ¨<code>&quot;exports&quot;</code>å­—æ®µä¸‹ï¼Œå¼€å‘è€…å¯ä»¥è¯¦ç»†æŒ‡å®šå½“å…¶ä»–ä»£ç å°è¯•ä»è¯¥åŒ…å¯¼å…¥æ¨¡å—æ—¶åº”è¯¥æ˜ å°„åˆ°å“ªä¸ªæ–‡ä»¶ã€‚Node.js v12 å¼€å§‹å¼•å…¥äº†è¿™ä¸€åŠŸèƒ½ï¼Œå¹¶ä¸”éšç€ç‰ˆæœ¬çš„æ›´æ–°ï¼Œå®ƒå¢åŠ äº†æ›´å¤šçµæ´»æ€§å’Œæ§åˆ¶èƒ½åŠ›ï¼Œæ¯”å¦‚åŸºäºç”¨æˆ·å®šä¹‰çš„æ¡ä»¶æ¥è§£ææ¨¡å—ã€‚</p><h3 id="è§£é‡Š-resolving-user-conditions" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-resolving-user-conditions"><span>è§£é‡Š &quot;Resolving user conditions&quot;</span></a></h3><p>&quot;Resolving user conditions&quot; å…è®¸åŒ…çš„ä½œè€…å®šä¹‰ä¸€ç»„â€œæ¡ä»¶â€ï¼Œå¹¶æ ¹æ®è¿™äº›æ¡ä»¶æ¥å†³å®šå½“æŸä¸ªåŒ…è¢«å¯¼å…¥æ—¶å®é™…ä¸Šåº”è¯¥åŠ è½½å“ªä¸ªæ–‡ä»¶ã€‚è¿™äº›æ¡ä»¶å¯ä»¥åŸºäºç¯å¢ƒå˜é‡ã€å¹³å°ç‰¹æ€§æˆ–è€…ä»»ä½•å¯é€šè¿‡é€»è¾‘åˆ¤æ–­çš„æ ‡å‡†æ¥è®¾ç½®ã€‚</p><p>ä¸ºäº†ä½¿ç”¨è¿™ä¸€ç‰¹æ€§ï¼Œä½ éœ€è¦åœ¨<code>package.json</code>çš„<code>&quot;exports&quot;</code>å­—æ®µä¸­å®šä¹‰æ¡ä»¶ï¼Œå¹¶å¯¹åº”åˆ°ä¸åŒçš„æ–‡ä»¶è·¯å¾„ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-1"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åŒ…ï¼Œè¿™ä¸ªåŒ…éœ€è¦æä¾›ä¸åŒç‰ˆæœ¬çš„æ¨¡å—ï¼Œé’ˆå¯¹æœåŠ¡å™¨ç«¯å’Œæµè§ˆå™¨ç«¯ç¯å¢ƒã€‚ä½ å¯ä»¥åœ¨<code>package.json</code>ä¸­ä½¿ç”¨&quot;user conditions&quot;æ¥å®ç°è¿™ä¸€ç‚¹ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">your-package</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">browser</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/browser-index.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">node</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/node-index.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">default</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/default-index.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ&quot;.&quot; è¡¨ç¤ºåŒ…çš„ä¸»å…¥å£ã€‚è¿™é‡Œå®šä¹‰äº†ä¸‰ä¸ªæ¡ä»¶ï¼š&quot;browser&quot;ã€&quot;node&quot; å’Œ &quot;default&quot;ã€‚æ ¹æ®å¯¼å…¥ç¯å¢ƒçš„ä¸åŒï¼Œä¼šè§£æåˆ°ä¸åŒçš„æ–‡ä»¶è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ï¼ˆå…·ä½“è€Œè¨€ï¼Œæ˜¯åœ¨æ”¯æŒæ¡ä»¶å¯¼å…¥çš„æ‰“åŒ…å·¥å…·ä¸­ï¼Œå¦‚ Webpackï¼‰ï¼Œ<code>import</code>è¯­å¥ä¼šå¯¼å…¥<code>&quot;./src/browser-index.js&quot;</code>ã€‚åœ¨ Node.js ç¯å¢ƒä¸­ï¼Œä¼šå¯¼å…¥<code>&quot;./src/node-index.js&quot;</code>ã€‚å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°å‰ä¸¤ä¸ªæ¡ä»¶ï¼Œåˆ™é»˜è®¤å¯¼å…¥<code>&quot;./src/default-index.js&quot;</code>ã€‚</p><p>é€šè¿‡ä½¿ç”¨&quot;user conditions&quot;ï¼ŒåŒ…çš„ä½œè€…å¯ä»¥æä¾›æ›´ç²¾ç¡®çš„æ§åˆ¶ï¼Œæ ¹æ®ä¸åŒçš„ä½¿ç”¨åœºæ™¯å’Œç¯å¢ƒéœ€æ±‚æ¥ä¼˜åŒ–åŒ…çš„å¯¼å…¥è¡Œä¸ºã€‚</p><h3 id="é‡ç‚¹å½’çº³" tabindex="-1"><a class="header-anchor" href="#é‡ç‚¹å½’çº³"><span>é‡ç‚¹å½’çº³</span></a></h3><ul><li>&quot;Resolving user conditions&quot; æä¾›äº†ä¸€ç§æ ¹æ®ä¸åŒæ¡ä»¶åŠ¨æ€è§£ææ¨¡å—è·¯å¾„çš„æœºåˆ¶ã€‚</li><li>åœ¨<code>package.json</code>çš„<code>&quot;exports&quot;</code>å­—æ®µä¸­å¯ä»¥å®šä¹‰è¿™äº›æ¡ä»¶ã€‚</li><li>è¿™ä½¿å¾—åŒ…ä½œè€…å¯ä»¥ä¸ºä¸åŒç¯å¢ƒï¼ˆå¦‚æµè§ˆå™¨å’Œ Node.js æœåŠ¡å™¨ç¯å¢ƒï¼‰æä¾›æœ€åˆé€‚çš„æ¨¡å—ç‰ˆæœ¬ï¼Œæˆ–è€…åŸºäºå…¶ä»–ä»»ä½•é€»è¾‘æ¡ä»¶æ¥è°ƒæ•´æ¨¡å—çš„å¯¼å…¥è¡Œä¸ºã€‚</li></ul><p>é€šè¿‡ä½¿ç”¨è¿™ç§çµæ´»çš„é…ç½®æ–¹å¼ï¼ŒNode.js è¿›ä¸€æ­¥å¢å¼ºäº†å¯¹ç°ä»£ JavaScript é¡¹ç›®çš„æ”¯æŒï¼Œä½¿å¾—æ¨¡å—ç®¡ç†å’Œåˆ†å‘å˜å¾—æ›´åŠ é«˜æ•ˆå’Œçµæ´»ã€‚</p><h3 id="community-conditions-definitions" tabindex="-1"><a class="header-anchor" href="#community-conditions-definitions"><span><a href="https://nodejs.org/docs/latest/api/packages.html#community-conditions-definitions" target="_blank" rel="noopener noreferrer">Community Conditions Definitions</a></span></a></h3><p>åœ¨ Node.js çš„ä¸–ç•Œé‡Œï¼Œ&quot;Community Conditions Definitions&quot;æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ–°å¼•å…¥çš„æ¦‚å¿µï¼Œæ—¨åœ¨æ”¹å–„å’Œè§„èŒƒåŒ…ï¼ˆpackageï¼‰çš„å¯¼å…¥è¡Œä¸ºã€‚ç®€å•æ¥è¯´ï¼Œè¿™ä¸ªåŠŸèƒ½å…è®¸åŒ…çš„å¼€å‘è€…å®šä¹‰ä¸€ç³»åˆ—çš„â€œæ¡ä»¶â€ï¼Œä»¥ä¾¿åœ¨ä¸åŒæƒ…å†µä¸‹å¯¼å…¥ä¸åŒç‰ˆæœ¬çš„ä»£ç ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†æé«˜ä»£ç çš„å¤ç”¨æ€§ï¼ŒåŒæ—¶ä¹Ÿä½¿å¾—åŒ…èƒ½å¤Ÿæ›´çµæ´»åœ°é€‚åº”ä¸åŒçš„è¿è¡Œç¯å¢ƒå’Œä½¿ç”¨åœºæ™¯ã€‚</p><h3 id="_1-æ¡ä»¶å¯¼å‡º-conditional-exports" tabindex="-1"><a class="header-anchor" href="#_1-æ¡ä»¶å¯¼å‡º-conditional-exports"><span>1. æ¡ä»¶å¯¼å‡ºï¼ˆConditional Exportsï¼‰</span></a></h3><p>ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯æ¡ä»¶å¯¼å‡ºï¼ˆConditional Exportsï¼‰ã€‚é€šè¿‡å®šä¹‰ä¸åŒçš„æ¡ä»¶ï¼Œä¸€ä¸ªåŒ…å¯ä»¥æ ¹æ®ä¸åŒçš„ç¯å¢ƒï¼ˆå¦‚ Node.js ç‰ˆæœ¬ã€æ˜¯å¦ä¸ºç”Ÿäº§ç¯å¢ƒã€æ˜¯å¦æ”¯æŒ ES æ¨¡å—ç­‰ï¼‰æ¥å¯¼å‡ºä¸åŒçš„ä»£ç ç‰ˆæœ¬ã€‚</p><p>ä¾‹å¦‚ï¼Œä½ å¯èƒ½æœ‰ä¸€ä¸ªåº“<code>my-lib</code>ï¼Œå®ƒæä¾›äº†ä¸¤ç§ç‰ˆæœ¬çš„ APIï¼šä¸€ç§æ˜¯ä¸“é—¨ä¸ºæ—§ç‰ˆ Node.js è®¾è®¡çš„ CommonJS æ¨¡å—ï¼Œå¦ä¸€ç§æ˜¯ä¸ºç°ä»£ç¯å¢ƒè®¾è®¡çš„ ES æ¨¡å—ã€‚åœ¨<code>package.json</code>ä¸­ï¼Œä½ å¯ä»¥è¿™æ ·æŒ‡å®šï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">my-lib</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">main</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./dist/cjs/index.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#616E88;"> // é»˜è®¤å¯¼å‡º</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">import</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./dist/esm/index.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">require</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./dist/cjs/index.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œå¦‚æœä½ çš„ä»£ç æ˜¯é€šè¿‡<code>import</code>è¯­å¥å¯¼å…¥<code>my-lib</code>çš„ï¼ˆæ„å‘³ç€å…¼å®¹ ES æ¨¡å—ï¼‰ï¼Œå®ƒä¼šä½¿ç”¨<code>./dist/esm/index.js</code>ã€‚åä¹‹ï¼Œå¦‚æœæ˜¯é€šè¿‡<code>require</code>è¯­å¥å¯¼å…¥çš„ï¼Œåˆ™ä¼šä½¿ç”¨<code>./dist/cjs/index.js</code>ã€‚</p><h3 id="_2-è‡ªå®šä¹‰æ¡ä»¶" tabindex="-1"><a class="header-anchor" href="#_2-è‡ªå®šä¹‰æ¡ä»¶"><span>2. è‡ªå®šä¹‰æ¡ä»¶</span></a></h3><p>é™¤äº† Node.js å†…ç½®çš„æ¡ä»¶ï¼ˆå¦‚<code>import</code>ã€<code>require</code>ç­‰ï¼‰ï¼Œç¤¾åŒºå’Œåº“ä½œè€…è¿˜å¯ä»¥è‡ªå®šä¹‰é¢å¤–çš„æ¡ä»¶ã€‚è¿™äº›è‡ªå®šä¹‰æ¡ä»¶å¯ä»¥è¢«ç”¨äºç‰¹æ®Šçš„æ„å»ºè¿‡ç¨‹æˆ–æ˜¯å·¥å…·ï¼Œæ¯”å¦‚ webpack æˆ– Babelã€‚</p><p>ä»¥ä¸€ä¸ªå‡è®¾çš„åº“<code>example-lib</code>ä¸ºä¾‹ï¼Œä½ å¸Œæœ›åœ¨æµ‹è¯•ç¯å¢ƒä¸‹æä¾›ä¸€å¥—é¢å¤–çš„å·¥å…·å’Œ APIã€‚é‚£ä¹ˆï¼Œä½ å¯ä»¥åœ¨<code>package.json</code>ä¸­è¿™æ ·è®¾ç½®ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">development</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./dist/dev/index.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">default</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./dist/index.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªè®¾ç½®ä¸­ï¼Œå½“æŸä¸ªç¯å¢ƒå˜é‡æˆ–æ„å»ºå·¥å…·é…ç½®æŒ‡å®šä¸ºæ»¡è¶³&quot;development&quot;æ¡ä»¶æ—¶ï¼Œå°±ä¼šå¯¼å…¥<code>./dist/dev/index.js</code>ï¼›å¦åˆ™ï¼Œé»˜è®¤å¯¼å…¥<code>./dist/index.js</code>ã€‚</p><h3 id="å®é™…åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨"><span>å®é™…åº”ç”¨</span></a></h3><ul><li><strong>æ¡†æ¶å’Œåº“çš„ç‰ˆæœ¬æ§åˆ¶</strong>: å¼€å‘è€…å¯ä»¥ä¸ºä¸åŒç‰ˆæœ¬çš„ Node.js æˆ–ä¸åŒçš„è¿è¡Œç¯å¢ƒæä¾›æœ€ä¼˜åŒ–çš„ä»£ç å®ç°ã€‚</li><li><strong>æ’ä»¶ç³»ç»Ÿ</strong>: æ’ä»¶ä½œè€…å¯ä»¥ä¸ºæ’ä»¶æä¾›ä¸åŒçš„å®ç°ï¼Œé’ˆå¯¹ä¸åŒçš„ä¸»ç¨‹åºç‰ˆæœ¬æˆ–ç¯å¢ƒè¿›è¡Œä¼˜åŒ–ã€‚</li><li><strong>æ„å»ºå·¥å…·ä¸ç¼–è¯‘é€‰é¡¹</strong>: é’ˆå¯¹ç‰¹å®šçš„æ„å»ºå·¥å…·ï¼ˆå¦‚ Webpackï¼‰å’Œç¼–è¯‘ç›®æ ‡ï¼ˆå¦‚ ES5ã€ES6 ç­‰ï¼‰ï¼Œå¯ä»¥æä¾›ä¸åŒçš„ä»£ç è·¯å¾„ã€‚</li></ul><p>æ€»ä¹‹ï¼Œé€šè¿‡åˆ©ç”¨&quot;Community Conditions Definitions&quot;ï¼ŒNode.js çš„åŒ…å’Œæ¨¡å—ç³»ç»Ÿå˜å¾—æ›´åŠ çµæ´»å’Œå¼ºå¤§ï¼Œä»è€Œä¸ºå¼€å‘è€…æä¾›äº†æ›´å¤šçš„é€‰æ‹©å’Œæ§åˆ¶èƒ½åŠ›ï¼Œä½¿ä»–ä»¬èƒ½å¤Ÿæ›´å¥½åœ°é¢å¯¹å¤šå˜çš„å¼€å‘éœ€æ±‚å’Œç¯å¢ƒæ¡ä»¶ã€‚</p><h3 id="self-referencing-a-package-using-its-name" tabindex="-1"><a class="header-anchor" href="#self-referencing-a-package-using-its-name"><span><a href="https://nodejs.org/docs/latest/api/packages.html#self-referencing-a-package-using-its-name" target="_blank" rel="noopener noreferrer">Self-referencing a package using its name</a></span></a></h3><p>åœ¨ Node.js çš„ä¸–ç•Œé‡Œï¼Œä¸€ä¸ªâ€œåŒ…â€ï¼ˆpackageï¼‰æ˜¯ä¸€ç§å°è£…ä»£ç çš„æ–¹å¼ï¼Œä½¿å¾—ä»£ç å¯ä»¥è¢«é‡ç”¨ã€‚æ¯ä¸ªåŒ…æœ‰ä¸€ä¸ªåç§°ï¼Œé€šå¸¸å®šä¹‰åœ¨å®ƒçš„ <code>package.json</code> æ–‡ä»¶ä¸­çš„ <code>name</code> å­—æ®µã€‚åœ¨ Node.js v21.7.1 ä¸­ï¼Œå¼•å…¥äº†ä¸€ä¸ªå¾ˆé…·çš„ç‰¹æ€§ï¼Œå…è®¸ä½ åœ¨åŒ…çš„å†…éƒ¨é€šè¿‡å…¶åç§°æ¥å¼•ç”¨è‡ªå·±ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„â€œè‡ªå¼•ç”¨â€ï¼ˆself-referencingï¼‰ã€‚</p><h3 id="è‡ªå¼•ç”¨æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#è‡ªå¼•ç”¨æ˜¯ä»€ä¹ˆ"><span>è‡ªå¼•ç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h3><p>è‡ªå¼•ç”¨å…è®¸ä¸€ä¸ªåŒ…å†…çš„ä»£ç ç›´æ¥ä½¿ç”¨è¯¥åŒ…çš„åç§°æ¥å¼•ç”¨åŒ…å†…çš„å…¶ä»–æ¨¡å—æˆ–æ–‡ä»¶ï¼Œå°±å¥½åƒè¿™ä¸ªåŒ…æ˜¯ä»å¤–éƒ¨å®‰è£…æˆ–å¼•å…¥çš„ä¸€æ ·ã€‚è¿™ç§æ–¹æ³•ç®€åŒ–äº†æŸäº›å¼€å‘åœºæ™¯ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§å‹é¡¹ç›®å’Œè¿›è¡Œä»£ç é‡æ„æ—¶ã€‚</p><h3 id="ä¸ºä»€ä¹ˆéœ€è¦è‡ªå¼•ç”¨" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆéœ€è¦è‡ªå¼•ç”¨"><span>ä¸ºä»€ä¹ˆéœ€è¦è‡ªå¼•ç”¨ï¼Ÿ</span></a></h3><p>åœ¨æ²¡æœ‰è‡ªå¼•ç”¨çš„æƒ…å†µä¸‹ï¼Œå¦‚æœä½ æƒ³è¦ä»ä¸€ä¸ªåŒ…å†…çš„ä¸€ä¸ªæ¨¡å—å¼•å…¥å¦ä¸€ä¸ªæ¨¡å—ï¼Œä½ å¯èƒ½éœ€è¦ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼ˆä¾‹å¦‚ <code>../lib/some-module</code>ï¼‰ã€‚è¿™åœ¨å°å‹é¡¹ç›®ä¸­å·¥ä½œå¾—å¾ˆå¥½ï¼Œä½†åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œå®ƒä¼šå¯¼è‡´ä»¥ä¸‹é—®é¢˜ï¼š</p><ol><li><strong>ç»´æŠ¤å›°éš¾</strong>ï¼šå½“æ–‡ä»¶ç»“æ„å˜åŠ¨æ—¶ï¼ˆæ¯”å¦‚ç§»åŠ¨æ¨¡å—ä½ç½®ï¼‰ï¼Œä½ å¯èƒ½éœ€è¦æ›´æ–°å¤šä¸ªåœ°æ–¹çš„ç›¸å¯¹è·¯å¾„ã€‚</li><li><strong>å¯è¯»æ€§å·®</strong>ï¼šæ·±å±‚æ¬¡çš„ç›¸å¯¹è·¯å¾„ï¼ˆæ¯”å¦‚ <code>../../../lib/some-module</code>ï¼‰éš¾ä»¥ç†è§£ï¼Œå°¤å…¶æ˜¯å¯¹äºæ–°åŠ å…¥é¡¹ç›®çš„äººæ¥è¯´ã€‚</li></ol><p>é€šè¿‡ä½¿ç”¨è‡ªå¼•ç”¨ï¼Œä½ å¯ä»¥é¿å…ä¸Šè¿°é—®é¢˜ï¼Œå› ä¸ºä½ æ€»æ˜¯ä½¿ç”¨ä¸€è‡´çš„ã€åŸºäºåŒ…åçš„è·¯å¾„æ¥å¼•ç”¨æ¨¡å—ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨è‡ªå¼•ç”¨" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨è‡ªå¼•ç”¨"><span>å¦‚ä½•ä½¿ç”¨è‡ªå¼•ç”¨ï¼Ÿ</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªå«åš <code>awesome-project</code> çš„åŒ…ï¼Œå®ƒçš„ç»“æ„å¤§è‡´å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>awesome-project/</span></span>
<span class="line"><span>â”œâ”€â”€ package.json</span></span>
<span class="line"><span>â”œâ”€â”€ src/</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ index.js</span></span>
<span class="line"><span>â”‚   â””â”€â”€ utils/</span></span>
<span class="line"><span>â”‚       â””â”€â”€ helper.js</span></span>
<span class="line"><span>â””â”€â”€ lib/</span></span>
<span class="line"><span>    â””â”€â”€ some-module.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ <code>awesome-project</code> åŒ…çš„ <code>package.json</code> æ–‡ä»¶ä¸­ï¼Œä½ ä¼šæœ‰ä¸€ä¸ª <code>name</code> å­—æ®µå®šä¹‰ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">awesome-project</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨ï¼Œå¦‚æœä½ æƒ³è¦åœ¨ <code>index.js</code> ä¸­å¼•ç”¨ <code>lib/some-module.js</code>ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// ä½¿ç”¨è‡ªå¼•ç”¨å¼•å…¥some-module.js</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> someModule</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">awesome-project/lib/some-module</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>åŒæ ·åœ°ï¼Œå¦‚æœ <code>lib/some-module.js</code> æƒ³è¦ä½¿ç”¨ <code>src/utils/helper.js</code> ä¸­çš„åŠŸèƒ½ï¼Œå®ƒä¹Ÿå¯ä»¥ä½¿ç”¨ç±»ä¼¼çš„æ–¹å¼ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// åœ¨some-module.jså†…éƒ¨ï¼Œä½¿ç”¨è‡ªå¼•ç”¨å¼•å…¥helper.js</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> helper</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">awesome-project/src/utils/helper</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-4"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><ol><li><strong>æ’ä»¶ç³»ç»Ÿ</strong>ï¼šå¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªå…·æœ‰æ’ä»¶ç³»ç»Ÿçš„åº”ç”¨ï¼Œæ’ä»¶å¯èƒ½éœ€è¦è®¿é—®åº”ç”¨çš„æ ¸å¿ƒåŠŸèƒ½ã€‚é€šè¿‡è‡ªå¼•ç”¨ï¼Œæ’ä»¶å¯ä»¥è½»æ¾åœ°å¼•å…¥è¿™äº›æ ¸å¿ƒæ¨¡å—ï¼Œè€Œä¸å¿…æ‹…å¿ƒå®é™…çš„æ–‡ä»¶è·¯å¾„ã€‚</li><li><strong>ä»£ç é‡æ„å’Œç»„ç»‡</strong>ï¼šå½“ä½ éœ€è¦é‡æ„å’Œé‡æ–°ç»„ç»‡ä½ çš„é¡¹ç›®ç»“æ„æ—¶ï¼Œä½¿ç”¨è‡ªå¼•ç”¨å¯ä»¥è®©è¿™ä¸ªè¿‡ç¨‹æ›´åŠ å¹³æ»‘ã€‚å› ä¸ºå¼•ç”¨ä¸ä¾èµ–äºæ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ï¼Œä½ å¯ä»¥è‡ªç”±åœ°ç§»åŠ¨æ–‡ä»¶å’Œç›®å½•ï¼Œè€Œä¸éœ€è¦æ›´æ–°å¤§é‡çš„å¯¼å…¥è¯­å¥ã€‚</li></ol><p>æ€»ä¹‹ï¼ŒNode.js ä¸­çš„è‡ªå¼•ç”¨ç‰¹æ€§æä¾›äº†ä¸€ç§æ›´ç®€å•ã€æ›´æ¸…æ™°çš„æ–¹å¼æ¥ç»„ç»‡å’Œå¼•ç”¨åŒ…å†…çš„æ¨¡å—ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¤§å‹å’Œå¤æ‚çš„é¡¹ç›®ã€‚è¿™è®©ä»£ç æ›´æ˜“äºç»´æŠ¤ã€é˜…è¯»å’Œåä½œã€‚</p><h2 id="dual-commonjs-es-module-packages" tabindex="-1"><a class="header-anchor" href="#dual-commonjs-es-module-packages"><span><a href="https://nodejs.org/docs/latest/api/packages.html#dual-commonjses-module-packages" target="_blank" rel="noopener noreferrer">Dual CommonJS/ES module packages</a></span></a></h2><p>Node.js ä¸­å¼•å…¥äº†ä¸€ç§èƒ½åŒæ—¶æ”¯æŒ CommonJS å’Œ ES Moduleï¼ˆç®€ç§° ESMï¼‰è§„èŒƒçš„åŒ…ç»“æ„ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„â€œåŒæ¨¡å—åŒ…â€ï¼ˆDual Packageï¼‰ã€‚äº†è§£è¿™ä¸ªæ¦‚å¿µä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç®€å•ä»‹ç»ä¸‹ CommonJS å’Œ ES Moduleã€‚</p><h3 id="commonjs-å’Œ-es-module-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#commonjs-å’Œ-es-module-ç®€ä»‹"><span>CommonJS å’Œ ES Module ç®€ä»‹</span></a></h3><ul><li><strong>CommonJS</strong>ï¼šå®ƒæ˜¯ Node.js ä½¿ç”¨çš„ä¼ ç»Ÿæ¨¡å—è§„èŒƒã€‚åœ¨ CommonJS ä¸­ï¼Œä½ ä¼šä½¿ç”¨<code>require()</code>å‡½æ•°æ¥å¯¼å…¥æ¨¡å—ï¼Œç”¨<code>module.exports</code>æˆ–<code>exports.someName</code>æ¥å¯¼å‡ºã€‚CommonJS ä¸»è¦ç”¨äºæœåŠ¡å™¨ç«¯ç¼–ç¨‹ï¼Œå› ä¸ºå®ƒæ˜¯åŒæ­¥åŠ è½½æ¨¡å—çš„ã€‚</li></ul><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// CommonJS å¯¼å‡ºç¤ºä¾‹</span></span>
<span class="line"><span style="color:#8FBCBB;">module</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">exports</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">  add</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">a</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> b</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    return</span><span style="color:#D8DEE9;"> a</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;"> b</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// CommonJS å¯¼å…¥ç¤ºä¾‹</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> math</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./math</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">math</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 3</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>ES Module (ESM)</strong>ï¼šéšç€ JavaScript çš„å‘å±•ï¼ŒES6 å¼•å…¥äº†å®˜æ–¹çš„æ¨¡å—åŒ–æ ‡å‡†ï¼Œå³ ES Moduleã€‚ESM ä½¿ç”¨<code>import</code>å’Œ<code>export</code>å…³é”®å­—æ¥å¯¼å…¥å’Œå¯¼å‡ºæ¨¡å—ã€‚ä¸ CommonJS ä¸åŒï¼ŒESM è®¾è®¡ç”¨äºå¼‚æ­¥åŠ è½½æ¨¡å—ï¼Œé€‚åˆç”¨äºæµè§ˆå™¨ç¯å¢ƒã€‚</li></ul><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// ESM å¯¼å‡ºç¤ºä¾‹</span></span>
<span class="line"><span style="color:#81A1C1;">export</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> add</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">a</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> b</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  return</span><span style="color:#D8DEE9;"> a</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;"> b</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ESM å¯¼å…¥ç¤ºä¾‹</span></span>
<span class="line"><span style="color:#81A1C1;">import</span><span style="color:#ECEFF4;"> {</span><span style="color:#8FBCBB;"> add</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./math.mjs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#88C0D0;">add</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 3</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åŒæ¨¡å—åŒ…-dual-package" tabindex="-1"><a class="header-anchor" href="#åŒæ¨¡å—åŒ…-dual-package"><span>åŒæ¨¡å—åŒ…ï¼ˆDual Packageï¼‰</span></a></h3><p>éšç€æ—¶é—´çš„æ¨ç§»ï¼Œè®¸å¤šå¼€å‘äººå‘˜å¸Œæœ›ä»–ä»¬çš„ä»£ç åº“èƒ½åŒæ—¶å…¼å®¹ CommonJS å’Œ ESM ä¸¤ç§è§„èŒƒï¼Œä»¥ä¾¿ä»–ä»¬çš„åŒ…å¯ä»¥åœ¨ä¸åŒçš„é¡¹ç›®ç¯å¢ƒä¸­çµæ´»ä½¿ç”¨ã€‚è¿™å°±æ˜¯åŒæ¨¡å—åŒ…çš„ç”±æ¥ã€‚</p><p>åŒæ¨¡å—åŒ…èƒ½è®©ä¸€ä¸ªåŒ…åŒæ—¶æ”¯æŒ CommonJS å’Œ ES Module çš„å¯¼å…¥å’Œå¯¼å‡ºæ–¹å¼ã€‚è¿™åœ¨å®è·µä¸­æ„å‘³ç€ï¼Œæ— è®ºä½ çš„é¡¹ç›®æ˜¯åŸºäº Node.js çš„ä¼ ç»Ÿ CommonJS é¡¹ç›®è¿˜æ˜¯ç°ä»£çš„ ES Module é¡¹ç›®ï¼Œä½ éƒ½å¯ä»¥ä½¿ç”¨ç›¸åŒçš„åŒ…è€Œä¸éœ€è¦è¿›è¡Œä»»ä½•æ”¹åŠ¨ã€‚</p><h3 id="å¦‚ä½•åˆ›å»ºåŒæ¨¡å—åŒ…" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•åˆ›å»ºåŒæ¨¡å—åŒ…"><span>å¦‚ä½•åˆ›å»ºåŒæ¨¡å—åŒ…</span></a></h3><ol><li><strong>å®šä¹‰<code>package.json</code></strong>ï¼š<br> åœ¨ä½ çš„<code>package.json</code>æ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>type</code>å­—æ®µæŒ‡å®šæ¨¡å—ç±»å‹ã€‚å¦‚æœè®¾ç½®ä¸º<code>&quot;type&quot;: &quot;module&quot;</code>ï¼Œåˆ™é»˜è®¤æ‰€æœ‰<code>.js</code>æ–‡ä»¶éƒ½å°†è¢«è§†ä¸º ESMã€‚ç„¶åä½ å¯ä»¥ä½¿ç”¨<code>.cjs</code>æ‰©å±•åä¸ºç‰¹å®šçš„ CommonJS æ–‡ä»¶ï¼Œåä¹‹äº¦ç„¶ã€‚æ­¤å¤–ï¼Œé€šè¿‡<code>main</code>å­—æ®µæŒ‡å®š CommonJS å…¥å£ç‚¹ï¼Œä½¿ç”¨<code>exports</code>å­—æ®µå£°æ˜ ESM å…¥å£ç‚¹ã€‚</li></ol><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">example-package</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">module</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">main</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./entry-point.cjs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#616E88;"> // CommonJS å…¥å£</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./entry-point.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#616E88;"> // ESM å…¥å£</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>åˆ›å»ºæ¨¡å—æ–‡ä»¶</strong>ï¼š<br> æ ¹æ®ä¸Šè¿°<code>package.json</code>çš„é…ç½®ï¼Œä½ éœ€è¦æœ‰å¯¹åº”çš„<code>entry-point.cjs</code>æ–‡ä»¶ä¾› CommonJS ç¯å¢ƒä½¿ç”¨ï¼Œä»¥åŠ<code>entry-point.js</code>ï¼ˆæˆ–å…¶ä»–æŒ‡å®šçš„ ESM å…¥å£æ–‡ä»¶ï¼‰ä¾› ESM ç¯å¢ƒä½¿ç”¨ã€‚</li></ol><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-5"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªæ•°å­¦å·¥å…·åŒ…ï¼Œè¯¥åŒ…æä¾›åŠ æ³•å’Œå‡æ³•åŠŸèƒ½ã€‚ä½ å¸Œæœ›è¿™ä¸ªåŒ…èƒ½å¤ŸåŒæ—¶è¢« Node.js é¡¹ç›®ï¼ˆCommonJSï¼‰å’Œå‰ç«¯ JavaScript é¡¹ç›®ï¼ˆES Moduleï¼‰ä½¿ç”¨ã€‚</p><p>ä½ çš„æ–‡ä»¶ç»“æ„å¯èƒ½å¦‚ä¸‹ï¼š</p><ul><li><code>package.json</code>: é…ç½®æ–‡ä»¶ï¼Œå®šä¹‰äº†åŒ…çš„åŒæ¨¡å—ç»“æ„ã€‚</li><li><code>math.cjs</code>: æä¾› CommonJS ç‰ˆæœ¬çš„å®ç°ã€‚</li><li><code>math.js</code>: æä¾› ES Module ç‰ˆæœ¬çš„å®ç°ã€‚</li></ul><p>åœ¨ Node.js æˆ–è€…æ”¯æŒ ES Module çš„å‰ç«¯é¡¹ç›®ä¸­ï¼Œå½“å¼€å‘è€…å¯¼å…¥ä½ çš„æ•°å­¦å·¥å…·åŒ…æ—¶ï¼Œæ ¹æ®ä»–ä»¬çš„é¡¹ç›®ç±»å‹ï¼ˆCJS æˆ– ESMï¼‰ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„æ¨¡å—æ ¼å¼è¿›è¡Œå¯¼å…¥ã€‚è¿™æ ·ï¼Œä½ çš„åŒ…å°±èƒ½å¹¿æ³›åœ°é€‚ç”¨äºå„ç§ JavaScript é¡¹ç›®ï¼ŒåŒæ—¶ä¿æŒæºä»£ç çš„æ•´æ´å’Œç»´æŠ¤çš„ç®€ä¾¿æ€§ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒNode.js v21.7.1 ä¸­å¯¹åŒæ¨¡å—åŒ…çš„æ”¯æŒï¼Œå¤§å¤§å¢å¼ºäº† Node.js åœ¨ç°ä»£ JavaScript ç”Ÿæ€ç³»ç»Ÿä¸­çš„åº”ç”¨çµæ´»æ€§å’Œå…¼å®¹æ€§ã€‚</p><h3 id="dual-package-hazard" tabindex="-1"><a class="header-anchor" href="#dual-package-hazard"><span><a href="https://nodejs.org/docs/latest/api/packages.html#dual-package-hazard" target="_blank" rel="noopener noreferrer">Dual package hazard</a></span></a></h3><p>åœ¨è§£é‡Š Node.js ä¸­çš„ &quot;Dual Package Hazard&quot;ï¼ˆåŒåŒ…å±å®³ï¼‰ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ Node.js çš„æ¨¡å—ç³»ç»Ÿï¼Œä»¥åŠä»€ä¹ˆæ˜¯ CommonJS å’Œ ESMï¼Œå› ä¸ºç†è§£è¿™äº›å¯¹äºå¼„æ¸…æ¥šåŒåŒ…å±å®³è‡³å…³é‡è¦ã€‚</p><h3 id="node-js-æ¨¡å—ç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#node-js-æ¨¡å—ç³»ç»Ÿ"><span>Node.js æ¨¡å—ç³»ç»Ÿ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œä»£ç é€šå¸¸è¢«ç»„ç»‡æˆæ¨¡å—ã€‚ä¸€ä¸ªæ¨¡å—åŒ…å«äº†å¯å¤ç”¨çš„ä»£ç ï¼Œå¯ä»¥è¢«å…¶ä»–æ¨¡å—å¯¼å…¥ã€‚Node.js ä½¿ç”¨ä¸¤ç§ä¸»è¦çš„æ¨¡å—ç³»ç»Ÿï¼š</p><ol><li><p><strong>CommonJS (CJS)</strong>: è¿™æ˜¯ Node.js æœ€æ—©æ”¯æŒçš„æ¨¡å—ç³»ç»Ÿã€‚åœ¨æ­¤ç³»ç»Ÿä¸­ï¼Œä½ ä¼šä½¿ç”¨ <code>require()</code> å‡½æ•°æ¥å¯¼å…¥æ¨¡å—ï¼Œè€Œ <code>module.exports</code> æˆ– <code>exports.someFunction</code> æ¥å¯¼å‡ºæ¨¡å—ã€‚</p></li><li><p><strong>ES Modules (ESM)</strong>: è¿™æ˜¯ ECMAScript æ ‡å‡†çš„æ¨¡å—ç³»ç»Ÿï¼Œç°ä»£ JavaScript æ”¯æŒæ­¤æ ‡å‡†ã€‚åœ¨æ­¤ç³»ç»Ÿä¸­ï¼Œä½ å°†ä½¿ç”¨ <code>import</code> å…³é”®å­—æ¥å¯¼å…¥æ¨¡å—ï¼Œè€Œ <code>export</code> å…³é”®å­—æ¥å¯¼å‡ºæ¨¡å—ã€‚</p></li></ol><h3 id="ä»€ä¹ˆæ˜¯-dual-package-hazard" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-dual-package-hazard"><span>ä»€ä¹ˆæ˜¯ Dual Package Hazardï¼Ÿ</span></a></h3><p>éšç€ ESM åœ¨ Node.js ä¸­é€æ¸è·å¾—æ”¯æŒï¼Œåœ¨ä¸€ä¸ªé¡¹ç›®ä¸­åŒæ—¶ä½¿ç”¨ CJS å’Œ ESM æˆä¸ºå¯èƒ½ã€‚ç„¶è€Œï¼Œè¿™ä¹Ÿå¸¦æ¥äº†ä¸€äº›æ½œåœ¨çš„é—®é¢˜ï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯æ‰€è°“çš„ â€œDual Package Hazardâ€ï¼ˆåŒåŒ…å±å®³ï¼‰ã€‚</p><p>åŒåŒ…å±å®³å‘ç”Ÿåœ¨ä¸€ä¸ªåŒ…ï¼ˆPackageï¼‰è¯•å›¾åŒæ—¶æä¾› CommonJS å’Œ ESM ä¸¤ç§ç±»å‹çš„æ¨¡å—æ—¶ã€‚å¦‚æœä¸€ä¸ªåŒ…åŒæ—¶å­˜åœ¨äºä¸¤ç§æ¨¡å—æ ¼å¼ä¸­ï¼Œå¹¶ä¸”è¿™ä¸¤ç§æ ¼å¼çš„å®ä¾‹ä¸æ˜¯ç›¸åŒçš„ï¼Œå°±ä¼šå¯¼è‡´æ„æ–™ä¹‹å¤–çš„è¡Œä¸ºã€‚</p><h3 id="ç¤ºä¾‹å’Œè§£é‡Š" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹å’Œè§£é‡Š"><span>ç¤ºä¾‹å’Œè§£é‡Š</span></a></h3><p>å‡è®¾æœ‰ä¸€ä¸ªåä¸º <code>example-package</code> çš„ npm åŒ…ï¼Œå®ƒå¯¼å‡ºäº†ä¸€ä¸ªé…ç½®å¯¹è±¡ã€‚è¿™ä¸ªåŒ…æä¾›äº†ä¸¤ä¸ªç‰ˆæœ¬çš„æ¨¡å—ï¼šCommonJS ç‰ˆæœ¬å’Œ ES Modules ç‰ˆæœ¬ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// CommonJS ç‰ˆæœ¬</span></span>
<span class="line"><span style="color:#8FBCBB;">module</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">exports</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">  setting</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ES Modules ç‰ˆæœ¬</span></span>
<span class="line"><span style="color:#81A1C1;">export</span><span style="color:#81A1C1;"> const</span><span style="color:#D8DEE9;"> setting</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> true;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä¸€ä¸ªåº”ç”¨ç¨‹åºçš„æŸéƒ¨åˆ†é€šè¿‡ CommonJS å¯¼å…¥æ­¤åŒ…ï¼Œè€Œå¦ä¸€éƒ¨åˆ†é€šè¿‡ ESM å¯¼å…¥åŒä¸€ä¸ªåŒ…ï¼Œé‚£ä¹ˆè¿™ä¸¤éƒ¨åˆ†ä»£ç å°†åˆ†åˆ«å¾—åˆ°ä¸¤ä¸ªä¸åŒçš„ <code>setting</code> å¯¹è±¡å‰¯æœ¬ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä¸€éƒ¨åˆ†ä»£ç æ›´æ”¹äº†é…ç½®ï¼Œå¦ä¸€éƒ¨åˆ†ä»£ç å°†çœ‹ä¸åˆ°è¿™ä¸ªå˜åŒ–ï¼Œå› ä¸ºå®ƒä»¬æ“ä½œçš„æ˜¯ä¸åŒçš„å¯¹è±¡å®ä¾‹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// ä½¿ç”¨ CommonJS å¯¼å…¥</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> configCJS</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example-package</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">configCJS</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">setting</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> false;</span><span style="color:#616E88;"> // æ›´æ”¹è®¾ç½®</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ ESM å¯¼å…¥</span></span>
<span class="line"><span style="color:#81A1C1;">import</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> setting</span><span style="color:#81A1C1;"> as</span><span style="color:#8FBCBB;"> configESM</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">example-package</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">configESM</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // ä»ç„¶æ˜¯ trueï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªä¸åŒçš„å®ä¾‹</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="é¿å…åŒåŒ…å±å®³" tabindex="-1"><a class="header-anchor" href="#é¿å…åŒåŒ…å±å®³"><span>é¿å…åŒåŒ…å±å®³</span></a></h3><p>ä¸ºäº†é¿å…åŒåŒ…å±å®³ï¼ŒåŒ…çš„ä½œè€…åº”å½“ï¼š</p><ul><li>å°½é‡åªæä¾›ä¸€ç§æ¨¡å—æ ¼å¼çš„åŒ…ã€‚</li><li>å¦‚æœå¿…é¡»åŒæ—¶æä¾›ä¸¤ç§æ ¼å¼ï¼Œç¡®ä¿å…±äº«çŠ¶æ€æˆ–å•ä¾‹è¢«æ­£ç¡®åœ°è·¨æ¨¡å—æ ¼å¼å…±äº«ã€‚</li></ul><p>å¼€å‘è€…åœ¨ä½¿ç”¨åŒ…æ—¶ä¹Ÿéœ€è¦æ³¨æ„ï¼Œå°½é‡é¿å…åœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­æ··ç”¨ä¸¤ç§æ¨¡å—æ ¼å¼å»å¼•ç”¨åŒä¸€ä¸ªåŒ…ã€‚</p><p>æ€»ç»“æ¥è¯´ï¼ŒåŒåŒ…å±å®³æ˜¯ Node.js åœ¨æ”¯æŒæ–°çš„æ¨¡å—ç³»ç»Ÿï¼ˆESMï¼‰æ—¶å‡ºç°çš„ä¸€ä¸ªå…¸å‹é—®é¢˜ã€‚å®ƒæ­ç¤ºäº†åœ¨è®¾è®¡å’Œä½¿ç”¨ npm åŒ…æ—¶éœ€è¦æ³¨æ„çš„ä¸€äº›å…³é”®ç‚¹ï¼Œä»¥ç¡®ä¿ä»£ç çš„ä¸€è‡´æ€§å’Œé¢„æœŸè¡Œä¸ºã€‚</p><h3 id="writing-dual-packages-while-avoiding-or-minimizing-hazards" tabindex="-1"><a class="header-anchor" href="#writing-dual-packages-while-avoiding-or-minimizing-hazards"><span><a href="https://nodejs.org/docs/latest/api/packages.html#writing-dual-packages-while-avoiding-or-minimizing-hazards" target="_blank" rel="noopener noreferrer">Writing dual packages while avoiding or minimizing hazards</a></span></a></h3><p>ç†è§£ Node.js ä¸­å…³äºå†™åŒåŒ…ï¼ˆdual packagesï¼‰çš„æ¦‚å¿µä»¥é¿å…æˆ–æœ€å°åŒ–é£é™©ï¼Œé¦–å…ˆéœ€è¦äº†è§£ä¸€äº›èƒŒæ™¯çŸ¥è¯†ã€‚</p><h3 id="èƒŒæ™¯" tabindex="-1"><a class="header-anchor" href="#èƒŒæ™¯"><span>èƒŒæ™¯</span></a></h3><p>åœ¨ Node.js çš„ä¸–ç•Œé‡Œï¼Œä¸€ä¸ªåŒ…ï¼ˆpackageï¼‰å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ç§å°è£…å¥½çš„ä»£ç åº“ï¼Œå¯ä»¥é€šè¿‡ npmï¼ˆNode Package Managerï¼‰å®‰è£…å¹¶åœ¨ä½ çš„é¡¹ç›®ä¸­å¼•ç”¨ã€‚éšç€ JavaScript ç”Ÿæ€çš„å‘å±•ï¼Œå‡ºç°äº†ä¸¤ç§ä¸»è¦çš„ä»£ç æ¨¡å—ç³»ç»Ÿï¼šCommonJS å’Œ ESMï¼ˆECMAScript Modulesï¼‰ã€‚</p><ul><li><strong>CommonJS</strong>ï¼šè¿™æ˜¯ Node.js ä¼ ç»Ÿä½¿ç”¨çš„æ¨¡å—ç³»ç»Ÿï¼Œä½¿ç”¨<code>require()</code>æ¥å¯¼å…¥å…¶ä»–æ–‡ä»¶æˆ–æ¨¡å—ã€‚</li><li><strong>ESM</strong>ï¼šè¿™æ˜¯è¾ƒæ–°çš„æ ‡å‡†ï¼Œæ—¨åœ¨æˆä¸º JavaScript çš„å®˜æ–¹æ¨¡å—ç³»ç»Ÿï¼Œä½¿ç”¨<code>import</code>å’Œ<code>export</code>è¯­æ³•ã€‚</li></ul><p>æœ‰äº†è¿™ä¸¤ç§æ¨¡å—ç³»ç»Ÿï¼Œä¸€äº›åº“æˆ–æ¡†æ¶å¸Œæœ›åŒæ—¶æ”¯æŒå®ƒä»¬ï¼Œå³åˆ›å»ºèƒ½åœ¨ CommonJS å’Œ ESM ç¯å¢ƒä¸‹éƒ½èƒ½è¿è¡Œçš„â€œåŒåŒ…â€ã€‚ç„¶è€Œï¼Œè¿™ç§åšæ³•ä¼šé‡åˆ°ä¸€äº›æ½œåœ¨çš„é—®é¢˜å’ŒæŒ‘æˆ˜ã€‚</p><h3 id="åŒåŒ…ç¼–å†™æ—¶çš„æŒ‘æˆ˜" tabindex="-1"><a class="header-anchor" href="#åŒåŒ…ç¼–å†™æ—¶çš„æŒ‘æˆ˜"><span>åŒåŒ…ç¼–å†™æ—¶çš„æŒ‘æˆ˜</span></a></h3><ol><li><strong>å¯¼å…¥æ–¹å¼ä¸åŒ</strong>ï¼šCommonJS å’Œ ESM é‡‡ç”¨ä¸åŒçš„å¯¼å…¥æ–¹å¼ï¼Œéœ€è¦ç¡®ä¿ä»£ç èƒ½å¤Ÿæ ¹æ®ä¸åŒçš„ç¯å¢ƒé€‰æ‹©æ­£ç¡®çš„å¯¼å…¥æ–¹å¼ã€‚</li><li><strong>æ¨¡å—è§£æå·®å¼‚</strong>ï¼šä¸¤ç§æ¨¡å¼å¯¹æ¨¡å—çš„è§£ææ–¹å¼ï¼ˆæ¯”å¦‚è·¯å¾„è§£æï¼‰ä¹Ÿæœ‰æ‰€ä¸åŒï¼Œéœ€è¦è€ƒè™‘è¿™äº›å·®å¼‚ã€‚</li><li><strong>æ€§èƒ½è€ƒé‡</strong>ï¼šå¯èƒ½ä¼šå› ä¸ºåŒæ—¶æ”¯æŒä¸¤ç§æ¨¡å¼è€Œå¢åŠ é¢å¤–çš„å¤æ‚åº¦å’Œæ€§èƒ½è´Ÿæ‹…ã€‚</li></ol><h3 id="å®è·µå»ºè®®" tabindex="-1"><a class="header-anchor" href="#å®è·µå»ºè®®"><span>å®è·µå»ºè®®</span></a></h3><p>ä¸ºäº†åœ¨ç¼–å†™åŒåŒ…æ—¶é¿å…æˆ–æœ€å°åŒ–ä¸Šè¿°é£é™©ï¼ŒNode.js v21.7.1 æ–‡æ¡£æå‡ºäº†ä¸€äº›å»ºè®®ï¼š</p><ul><li><p><strong>æ¡ä»¶å¯¼å‡º</strong>ï¼ˆConditional Exportsï¼‰ï¼šé€šè¿‡åœ¨<code>package.json</code>ä¸­ä½¿ç”¨<code>exports</code>å­—æ®µçš„æ¡ä»¶è¯­æ³•ï¼Œå¯ä»¥å®šä¹‰ä¸åŒæƒ…å†µä¸‹åº”è¯¥åŠ è½½å“ªä¸ªç‰ˆæœ¬çš„ä»£ç ã€‚è¿™ä½¿å¾—åŒä¸€åŒ…å¯ä»¥åŒæ—¶æ”¯æŒ CommonJS å’Œ ESMã€‚</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">import</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./path/to/esm/version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">require</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./path/to/commonjs/version</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>ä½¿ç”¨åŒæ¨¡å¼åŒ…</strong>ï¼šå°½é‡è®©åŒ…åœ¨æºç çº§åˆ«å°±æ˜¯åŒæ—¶å…¼å®¹ CommonJS å’Œ ESMï¼Œè™½ç„¶è¿™åœ¨å®è·µä¸­å¯èƒ½è¾ƒå¤æ‚ã€‚</p></li></ul><h3 id="å®é™…ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-2"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåä¸º<code>awesome-library</code>çš„ JavaScript åº“ï¼Œä½ å¸Œæœ›å®ƒèƒ½å¤Ÿåœ¨ Node.js é¡¹ç›®ä¸­æ— ç¼åœ°æ”¯æŒ CommonJS å’Œ ESMã€‚ä½ çš„<code>package.json</code>é…ç½®å¯èƒ½å¦‚ä¸‹ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">awesome-library</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">main</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./cjs/index.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#616E88;"> // CommonJSå…¥å£</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">module</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./esm/index.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#616E88;"> // ESMå…¥å£ï¼ŒæŸäº›æ‰“åŒ…å·¥å…·ä¼šåˆ©ç”¨è¿™ä¸ª</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">import</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./esm/index.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">require</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./cjs/index.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">module</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šé…ç½®ç¡®ä¿äº†å½“ç”¨æˆ·é€šè¿‡<code>import</code>ï¼ˆESM ç¯å¢ƒï¼‰æˆ–è€…<code>require</code>ï¼ˆCommonJS ç¯å¢ƒï¼‰åŠ è½½ä½ çš„åº“æ—¶ï¼Œéƒ½èƒ½è·å–åˆ°æ­£ç¡®çš„ä»£ç ç‰ˆæœ¬ã€‚è¿™ç§åšæ³•æé«˜äº†ä½ çš„åº“çš„é€šç”¨æ€§ï¼Œè®©å®ƒèƒ½å¤Ÿé€‚é…æ›´å¹¿æ³›çš„é¡¹ç›®éœ€æ±‚ã€‚</p><p>æ€»ä¹‹ï¼Œç¼–å†™æ”¯æŒ CommonJS å’Œ ESM çš„åŒåŒ…éœ€è¦ç»†å¿ƒè§„åˆ’ï¼Œç¡®ä¿å…¼å®¹æ€§å’Œæ€§èƒ½å‡è¡¡ã€‚é€šè¿‡éµå¾ª Node.js ç»™å‡ºçš„æœ€ä½³å®è·µï¼Œå¯ä»¥æœ‰æ•ˆåœ°å‡å°‘æ½œåœ¨çš„é—®é¢˜ï¼Œå¹¶æä¾›æ›´åŠ çµæ´»å’Œå¼ºå¤§çš„ä»£ç åº“ã€‚</p><h4 id="approach-1-use-an-es-module-wrapper" tabindex="-1"><a class="header-anchor" href="#approach-1-use-an-es-module-wrapper"><span><a href="https://nodejs.org/docs/latest/api/packages.html#approach-1-use-an-es-module-wrapper" target="_blank" rel="noopener noreferrer">Approach #1: Use an ES module wrapper</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©ä½ å¯ä»¥ä½¿ç”¨ JavaScript æ¥å¼€å‘æœåŠ¡å™¨ç«¯çš„åº”ç”¨ã€‚JavaScript æœ€åˆæ˜¯ä½œä¸ºä¸€ç§åªèƒ½åœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„è„šæœ¬è¯­è¨€è¢«è®¾è®¡å‡ºæ¥çš„ã€‚ç„¶è€Œï¼Œéšç€ Node.js çš„å‡ºç°ï¼ŒJavaScript çš„èƒ½åŠ›å¾—åˆ°äº†æå¤§æ‰©å±•ï¼Œå¯ä»¥ç”¨äºæœåŠ¡å™¨ç«¯ç¼–ç¨‹ã€æ„å»ºå·¥å…·é“¾ã€å¼€å‘æ¡Œé¢åº”ç”¨ç­‰ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸¤ç§ä¸åŒç±»å‹çš„æ¨¡å—ç³»ç»Ÿï¼šCommonJS å’Œ ES Modulesã€‚</p><ul><li><p><strong>CommonJS</strong> æ˜¯ Node.js åŸç”Ÿæ”¯æŒçš„æ¨¡å—ç³»ç»Ÿï¼Œé€‚ç”¨äºæœåŠ¡å™¨ç«¯ JavaScriptã€‚ä½ å¯èƒ½å·²ç»è§è¿‡ä½¿ç”¨ <code>require</code> å’Œ <code>module.exports</code> è¯­å¥æ¥å¯¼å…¥å’Œå¯¼å‡ºæ¨¡å—çš„ä»£ç ã€‚</p></li><li><p><strong>ES Modules</strong>ï¼ˆç®€ç§° ESMï¼‰åˆ™æ˜¯ ECMAScript æ ‡å‡†çš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯ JavaScript è¯­è¨€å±‚é¢æ”¯æŒçš„æ¨¡å—ç³»ç»Ÿã€‚åœ¨æµè§ˆå™¨å’Œç°ä»£ Node.js ç‰ˆæœ¬ä¸­éƒ½æ”¯æŒä½¿ç”¨ <code>import</code> å’Œ <code>export</code> è¯­å¥æ¥å¤„ç†æ¨¡å—ã€‚</p></li></ul><p><strong>Approach #1: Use an ES Module Wrapper</strong> è¿™ä¸ªæ–¹æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œå¦‚æœä½ æœ‰ä¸€äº›ç°å­˜çš„ CommonJS æ¨¡å—ä»£ç ï¼Œä½†åˆæƒ³åœ¨å…¶ä¸­åˆ©ç”¨ ES Modules çš„ç‰¹æ€§ï¼Œä½ å¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ªç®€å•çš„ ES Module åŒ…è£…å±‚æ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p><h3 id="å®é™…æ“ä½œæ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#å®é™…æ“ä½œæ­¥éª¤"><span>å®é™…æ“ä½œæ­¥éª¤:</span></a></h3><ol><li><p><strong>åˆ›å»ºä¸€ä¸ªæ–°çš„ JS æ–‡ä»¶ä½œä¸º ES Module åŒ…è£…å±‚</strong>:</p><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªç°å­˜çš„ CommonJS æ¨¡å— <code>mathUtil.js</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// mathUtil.js (CommonJS æ ¼å¼)</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> add</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">x</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> y</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  return</span><span style="color:#D8DEE9;"> x</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;"> y</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8FBCBB;">module</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">exports</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> add</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ <code>mathUtilWrapper.mjs</code>ï¼ˆæˆ–è€…ä»»ä½• <code>.js</code> æ–‡ä»¶ï¼Œä½†éœ€è¦ç¡®ä¿ä½ çš„é¡¹ç›®é…ç½®æ”¯æŒ ES Moduleï¼‰ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­å¯¼å…¥ CommonJS æ¨¡å—å¹¶å¯¼å‡ºç›¸åº”åŠŸèƒ½ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// mathUtilWrapper.mjs</span></span>
<span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> mathUtil</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./mathUtil.cjs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ³¨æ„æ–‡ä»¶åç¼€æ”¹ä¸º .cjs æ˜ç¡®è¡¨ç¤ºè¿™æ˜¯ CommonJS æ¨¡å—</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>//æ–‡æ›¸ã¯æ¡œèŒ¶ã‹ã‚‰æ¥ã¦ã„ã¾ã™ã€‚å•†ç”¨ç›®çš„ã§ã¯ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚<br> // å¯¼å‡º CommonJS æ¨¡å—ä¸­çš„åŠŸèƒ½<br> export const add = mathUtil.add;</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span></span></span>
<span class="line"><span>2. **åœ¨å…¶ä»– ES Module ä¸­ä½¿ç”¨è¿™ä¸ªåŒ…è£…**:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ç°åœ¨ï¼Œä½ å¯ä»¥åœ¨ä»»ä½•æ”¯æŒ ES Module çš„ç¯å¢ƒé‡Œä½¿ç”¨ `mathUtilWrapper.mjs` äº†ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>```javascript</span></span>
<span class="line"><span>// anotherModule.mjs</span></span>
<span class="line"><span>import { add } from &quot;./mathUtilWrapper.mjs&quot;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>console.log(add(2, 3)); // è¾“å‡º: 5</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-2"><span>å®é™…è¿ç”¨ä¾‹å­:</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œä½ å¼•å…¥äº†ä¸€äº›ç¬¬ä¸‰æ–¹åº“ï¼Œè¿™äº›åº“ä»ç„¶æ˜¯ä½¿ç”¨ CommonJS æ ¼å¼ç¼–å†™çš„ã€‚ä½†ä½ çš„é¡¹ç›®é‡‡ç”¨çš„æ˜¯æœ€æ–°çš„ ES Modules è§„èŒƒã€‚ä¸ºäº†èƒ½å¤Ÿæ›´å¥½åœ°æ•´åˆè¿™äº›åº“ï¼Œå¹¶ä¸”ä¾¿äºæœªæ¥çš„ç»´æŠ¤ï¼Œä½ å†³å®šä½¿ç”¨ ES Module åŒ…è£…å±‚æŠ€æœ¯æ¥è§£å†³å…¼å®¹é—®é¢˜ã€‚</p><p>æ¯”å¦‚ï¼Œä½ åœ¨é¡¹ç›®ä¸­éœ€è¦ä½¿ç”¨ä¸€ä¸ªåä¸º <code>legacy-math-lib</code> çš„ç¬¬ä¸‰æ–¹æ•°å­¦åº“ï¼Œè¿™ä¸ªåº“æä¾›äº†ä¸€ç³»åˆ—æ•°å­¦ç›¸å…³çš„å‡½æ•°ï¼Œä½†å®ƒæ˜¯ç”¨ CommonJS æ ¼å¼ç¼–å†™çš„ã€‚æŒ‰ç…§ä¸Šè¿°æ–¹æ³•ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°åˆ›å»ºä¸€ä¸ªåŒ…è£…å±‚ï¼Œä½¿å…¶å¯ä»¥æ— ç¼åœ°èå…¥ä½ åŸºäº ES Modules çš„é¡¹ç›®ç»“æ„ä¸­ã€‚</p><p>è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯ï¼Œå®ƒæ—¢ä¿ç•™äº†å¯¹æ—§æœ‰ CommonJS æ¨¡å—çš„å…¼å®¹ï¼Œåˆè®©ä½ èƒ½å¤Ÿäº«å—åˆ° ES Modules å¸¦æ¥çš„è¯¸å¤šå¥½å¤„ï¼Œå¦‚é™æ€å¯¼å…¥å¯¼å‡ºã€æ›´å¥½çš„å¼‚æ­¥åŠ è½½æ”¯æŒç­‰ã€‚æ­¤å¤–ï¼Œè¿™æ ·åšè¿˜ä¸ºå°†æ¥å®Œå…¨è¿ç§»åˆ° ES Modules æ‰“ä¸‹äº†åŸºç¡€ã€‚</p><h4 id="approach-2-isolate-state" tabindex="-1"><a class="header-anchor" href="#approach-2-isolate-state"><span><a href="https://nodejs.org/docs/latest/api/packages.html#approach-2-isolate-state" target="_blank" rel="noopener noreferrer">Approach #2: Isolate state</a></span></a></h4><p>åœ¨è§£é‡Š Node.js v21.7.1 çš„ &quot;Approach #2: Isolate State&quot; ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£å‡ ä¸ªåŸºç¡€æ¦‚å¿µï¼šNode.jsã€æ¨¡å—ä»¥åŠçŠ¶æ€éš”ç¦»ã€‚</p><p><strong>Node.js</strong> æ˜¯ä¸€ä¸ªå¼€æºå’Œè·¨å¹³å°çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå®ƒè®© JavaScript å¯ä»¥è„±ç¦»æµè§ˆå™¨è¿è¡Œåœ¨æœåŠ¡å™¨ä¸Šã€‚åœ¨ Node.js ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨æ¨¡å—æ¥ç»„ç»‡ä»£ç ã€‚</p><p><strong>æ¨¡å—</strong> æ˜¯ Node.js ä¸­ç”¨æ¥åˆ†å‰²å’Œå°è£…ä»£ç çš„ä¸€ç§æœºåˆ¶ã€‚æ¯ä¸ªæ¨¡å—éƒ½æœ‰å…¶è‡ªå·±çš„ä½œç”¨åŸŸï¼Œå˜é‡ï¼Œå‡½æ•°ç­‰ï¼Œå¹¶ä¸”é€šå¸¸æ‰§è¡Œä¸€ä¸ªç‰¹å®šçš„ä»»åŠ¡ã€‚</p><p><strong>çŠ¶æ€</strong> æŒ‡çš„æ˜¯åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­å­˜å‚¨çš„æ•°æ®ã€‚å½“ä½ åœ¨æ¨¡å—ä¸­å­˜å‚¨æ•°æ®æ—¶ï¼Œè¿™äº›æ•°æ®å°±å½¢æˆäº†è¯¥æ¨¡å—çš„çŠ¶æ€ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ·±å…¥ &quot;Approach #2: Isolate State&quot;ã€‚</p><h3 id="approach-2-isolate-state-1" tabindex="-1"><a class="header-anchor" href="#approach-2-isolate-state-1"><span>Approach #2: Isolate State</span></a></h3><p>è¿™ä¸ªæ–¹æ³•æ˜¯å…³äºå¦‚ä½•è®¾è®¡å’Œç»„ç»‡ä½ çš„æ¨¡å—ï¼Œç‰¹åˆ«æ˜¯åœ¨æ¶‰åŠåˆ°çŠ¶æ€ç®¡ç†æ—¶ã€‚åœ¨ Node.js åº”ç”¨ä¸­ï¼Œä¿æŒæ¨¡å—çŠ¶æ€çš„éš”ç¦»å¾ˆé‡è¦ï¼Œè¿™æœ‰åŠ©äºæé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯é‡ç”¨æ€§ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯è®©æ¯ä¸ªæ¨¡å—å°½å¯èƒ½åœ°ç‹¬ç«‹ï¼Œä¿æŒä»–ä»¬çš„çŠ¶æ€ç§æœ‰åŒ–ï¼Œé¿å…ä¸åŒæ¨¡å—é—´çš„ç›´æ¥ä¾èµ–å’ŒçŠ¶æ€å…±äº«ã€‚</p><h4 id="å®é™…è¿ç”¨ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-3"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨æ„å»ºä¸€ä¸ªç”µå•†ç½‘ç«™ç³»ç»Ÿï¼Œå…¶ä¸­åŒ…æ‹¬ç”¨æˆ·æ¨¡å—ã€äº§å“æ¨¡å—å’Œè®¢å•æ¨¡å—ã€‚æ¯ä¸ªæ¨¡å—éƒ½ç®¡ç†ç€è‡ªå·±çš„æ•°æ®å’ŒçŠ¶æ€ - ç”¨æˆ·æ¨¡å—ç®¡ç†ç”¨æˆ·ä¿¡æ¯ï¼Œäº§å“æ¨¡å—ç®¡ç†å•†å“ä¿¡æ¯ï¼Œè®¢å•æ¨¡å—ç®¡ç†è®¢å•ä¿¡æ¯ã€‚</p><h5 id="ä¸éš”ç¦»çŠ¶æ€çš„é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#ä¸éš”ç¦»çŠ¶æ€çš„é—®é¢˜"><span>ä¸éš”ç¦»çŠ¶æ€çš„é—®é¢˜</span></a></h5><p>å¦‚æœä¸éš”ç¦»çŠ¶æ€ï¼Œæ¯”å¦‚ï¼Œè®¢å•æ¨¡å—ç›´æ¥æ›´æ”¹ç”¨æˆ·æ¨¡å—ä¸­çš„æ•°æ®ï¼ˆä¾‹å¦‚ï¼Œç”¨æˆ·ç§¯åˆ†ï¼‰ï¼Œè¿™å°†ä¼šå¯¼è‡´å„æ¨¡å—ä¹‹é—´çš„è€¦åˆåº¦å¢åŠ ï¼Œä½¿å¾—ä»£ç éš¾ä»¥ç»´æŠ¤å’Œæ‰©å±•ã€‚å¦‚æœä½ æƒ³æ›´æ–°æˆ–æ›¿æ¢æŸä¸ªæ¨¡å—ï¼Œå¯èƒ½ä¼šå½±å“åˆ°å…¶ä»–æ¨¡å—çš„è¿è¡Œã€‚</p><h5 id="å¦‚ä½•éš”ç¦»çŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•éš”ç¦»çŠ¶æ€"><span>å¦‚ä½•éš”ç¦»çŠ¶æ€</span></a></h5><ul><li><strong>ä½¿ç”¨äº‹ä»¶é©±åŠ¨é€šä¿¡</strong>ï¼šæ¨¡å—é—´é€šè¿‡äº‹ä»¶æ¥é€šä¿¡ï¼Œè€Œä¸æ˜¯ç›´æ¥è°ƒç”¨å¯¹æ–¹çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œè®¢å•æ¨¡å—å¯ä»¥å‘å‡ºä¸€ä¸ª &quot;è®¢å•å®Œæˆ&quot; äº‹ä»¶ï¼Œè€Œç”¨æˆ·æ¨¡å—å¯ä»¥ç›‘å¬è¿™ä¸ªäº‹ä»¶æ¥æ›´æ–°ç”¨æˆ·ç§¯åˆ†ï¼Œè¿™æ ·å°±é¿å…äº†ç›´æ¥çš„ä¾èµ–ã€‚</li><li><strong>ç§æœ‰çŠ¶æ€</strong>ï¼šç¡®ä¿æ¨¡å—å†…éƒ¨çš„çŠ¶æ€ä¸è¢«å¤–éƒ¨ç›´æ¥è®¿é—®ã€‚åœ¨ Node.js ä¸­ï¼Œä½ å¯ä»¥åˆ©ç”¨é—­åŒ…æˆ–è€… ES Modules çš„ç‰¹æ€§ï¼ˆå¦‚ <code>export</code>/<code>import</code>ï¼‰æ¥å®ç°ã€‚</li><li><strong>ä½¿ç”¨æœåŠ¡å±‚æˆ– DAO å±‚</strong>: å¯¹äºå¤æ‚çš„åº”ç”¨ï¼Œä½ å¯ä»¥å¼•å…¥æœåŠ¡å±‚(Service Layer)æˆ–æ•°æ®è®¿é—®å¯¹è±¡(Data Access Object, DAO)å±‚æ¥è¿›ä¸€æ­¥åˆ†ç¦»ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®è®¿é—®ä»£ç ï¼Œä»è€Œå®ç°æ›´å¥½çš„çŠ¶æ€éš”ç¦»å’Œä»£ç ç»„ç»‡ç»“æ„ã€‚</li></ul><p>é€šè¿‡éš”ç¦»çŠ¶æ€ï¼Œæ¯ä¸ªæ¨¡å—éƒ½å¯ä»¥ç‹¬ç«‹å˜åŒ–å’Œæ‰©å±•ï¼Œè€Œä¸ä¼šå½±å“åˆ°ç³»ç»Ÿçš„å…¶ä»–éƒ¨åˆ†ï¼Œè¿™å¯¹äºæ„å»ºå¤§å‹ã€å¯ç»´æŠ¤çš„ Node.js åº”ç”¨è‡³å…³é‡è¦ã€‚</p><h2 id="node-js-package-json-field-definitions" tabindex="-1"><a class="header-anchor" href="#node-js-package-json-field-definitions"><span><a href="https://nodejs.org/docs/latest/api/packages.html#nodejs-packagejson-field-definitions" target="_blank" rel="noopener noreferrer">Node.js package.json field definitions</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚<code>package.json</code> æ–‡ä»¶æ˜¯ Node.js é¡¹ç›®çš„å¿ƒè„ï¼Œå®ƒåŒ…å«äº†é¡¹ç›®çš„å…ƒæ•°æ®ä»¥åŠå¯¹é¡¹ç›®ä¾èµ–çš„ç®¡ç†ã€‚åœ¨ <code>package.json</code> ä¸­ï¼Œä½ å¯ä»¥å®šä¹‰ä¸€ç³»åˆ—å­—æ®µæ¥æŒ‡å®šå¦‚ä½•è¿è¡Œå’Œæ„å»ºé¡¹ç›®ã€å“ªäº›æ–‡ä»¶åº”è¯¥è¢«åŒ…æ‹¬æˆ–å¿½ç•¥ç­‰ã€‚</p><p>ä¸‹é¢ï¼Œæˆ‘å°†è§£é‡Š <code>package.json</code> æ–‡ä»¶ä¸­ä¸€äº›å¸¸è§çš„å­—æ®µï¼Œå¹¶é€šè¿‡å®ä¾‹æ¥è¯´æ˜å®ƒä»¬çš„ç”¨é€”ã€‚</p><h3 id="_1-name" tabindex="-1"><a class="header-anchor" href="#_1-name"><span>1. <code>name</code></span></a></h3><p>è¿™ä¸ªå­—æ®µå®šä¹‰äº†ä½ çš„é¡¹ç›®æˆ–åŒ…ï¼ˆpackageï¼‰çš„åç§°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æ­£åœ¨åˆ›å»ºä¸€ä¸ªåä¸º â€œmy-cool-projectâ€çš„é¡¹ç›®ï¼Œé‚£ä¹ˆä½ çš„ <code>package.json</code> æ–‡ä»¶ä¸­çš„ <code>name</code> å­—æ®µå¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">: </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">my-cool-project</span><span style="color:#ECEFF4;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-version" tabindex="-1"><a class="header-anchor" href="#_2-version"><span>2. <code>version</code></span></a></h3><p>æ­¤å­—æ®µè¡¨ç¤ºä½ çš„é¡¹ç›®å½“å‰çš„ç‰ˆæœ¬å·ï¼Œéµå¾ª<a href="https://semver.org/" target="_blank" rel="noopener noreferrer">è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶</a>ï¼ˆSemVerï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„é¡¹ç›®å¤„äºåˆæœŸå¼€å‘é˜¶æ®µï¼Œç‰ˆæœ¬å¯èƒ½æ˜¯ <code>0.1.0</code>ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">: </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">0.1.0</span><span style="color:#ECEFF4;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_3-scripts" tabindex="-1"><a class="header-anchor" href="#_3-scripts"><span>3. <code>scripts</code></span></a></h3><p>è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„å­—æ®µï¼Œå®ƒå®šä¹‰äº†å¯ä»¥è¿è¡Œçš„å‘½ä»¤åˆ«åã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªå¯åŠ¨é¡¹ç›®çš„è„šæœ¬ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">scripts</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">: </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">start</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">node index.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ„å‘³ç€å½“ä½ åœ¨ç»ˆç«¯è¿è¡Œ <code>npm start</code> å‘½ä»¤æ—¶ï¼Œå®ƒä¼šæ‰§è¡Œ <code>node index.js</code>ï¼Œä»è€Œå¯åŠ¨ä½ çš„é¡¹ç›®ã€‚</p><h3 id="_4-dependencies-å’Œ-devdependencies" tabindex="-1"><a class="header-anchor" href="#_4-dependencies-å’Œ-devdependencies"><span>4. <code>dependencies</code> å’Œ <code>devDependencies</code></span></a></h3><p><code>dependencies</code> å­—æ®µåˆ—å‡ºäº†ä½ çš„é¡¹ç›®è¿è¡Œæ‰€å¿…éœ€çš„åŒ…ï¼Œè€Œ <code>devDependencies</code> åˆ—å‡ºäº†å¼€å‘è¿‡ç¨‹ä¸­éœ€è¦ä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸å¿…è¦çš„åŒ…ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„é¡¹ç›®ä½¿ç”¨ Express æ¡†æ¶ï¼Œå¹¶ä¸”åªåœ¨å¼€å‘ä¸­ä½¿ç”¨ ESLintï¼ˆä¸€ä¸ªä»£ç è´¨é‡å·¥å…·ï¼‰ï¼Œåˆ™é…ç½®å¯èƒ½å¦‚ä¸‹ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">dependencies</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">: </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">express</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">^4.17.1</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">devDependencies</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">: </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">eslint</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">^7.11.0</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-main-å’Œ-exports" tabindex="-1"><a class="header-anchor" href="#_5-main-å’Œ-exports"><span>5. <code>main</code> å’Œ <code>exports</code></span></a></h3><p><code>main</code> å­—æ®µæŒ‡æ˜äº†å½“ä½ çš„åŒ…è¢«å¼•å…¥æ—¶ï¼Œé»˜è®¤å¯¼å‡ºæ–‡ä»¶çš„ä½ç½®ã€‚ä¾‹å¦‚ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">main</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">: </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">index.js</span><span style="color:#ECEFF4;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è€Œ <code>exports</code> å­—æ®µæä¾›äº†ä¸€ä¸ªæ›´åŠ ç²¾ç»†åŒ–çš„æ–¹æ³•æ¥æ§åˆ¶æ¨¡å—çš„å¯¼å‡ºã€‚å®ƒå¯ä»¥æŒ‡å®šä¸åŒå¯¼å…¥è·¯å¾„è¿”å›ä¸åŒçš„æ¨¡å—ã€‚</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">: </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./main.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">./features</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/features.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-type" tabindex="-1"><a class="header-anchor" href="#_6-type"><span>6. <code>type</code></span></a></h3><p>è¿™ä¸ªå­—æ®µå¯ä»¥è®¾ç½®ä¸º <code>module</code> æˆ– <code>commonjs</code>ï¼ŒæŒ‡å®šäº†ä½ çš„é¡¹ç›®æ˜¯ä½¿ç”¨ ES æ¨¡å—è¿˜æ˜¯ CommonJS æ¨¡å—ç³»ç»Ÿã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ ES æ¨¡å—ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">: </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">module</span><span style="color:#ECEFF4;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-4"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªå°å‹çš„ web åº”ç”¨ï¼Œä½¿ç”¨ Express æ¡†æ¶ã€‚ä½ çš„ <code>package.json</code> å¯èƒ½åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š</p><ul><li><strong>åç§°</strong>å’Œ<strong>ç‰ˆæœ¬</strong>æ ‡è¯†ä½ çš„é¡¹ç›®ï¼›</li><li><strong>è„šæœ¬</strong>æ¥å¯åŠ¨æœåŠ¡å™¨ï¼›</li><li><strong>ä¾èµ–</strong>åŒ…æ‹¬ <code>express</code> ä½œä¸ºè¿è¡Œæ—¶ä¾èµ–ï¼›</li><li><strong>å¼€å‘ä¾èµ–</strong>å¯èƒ½åŒ…æ‹¬ <code>nodemon</code>ï¼ˆè‡ªåŠ¨é‡å¯åº”ç”¨ï¼‰ã€<code>eslint</code>ï¼ˆä»£ç æ£€æŸ¥å·¥å…·ï¼‰ç­‰ï¼›</li><li><strong>ä¸»å…¥å£</strong>æ–‡ä»¶è®¾ç½®ä¸º <code>app.js</code>ï¼›</li><li>ä½ å¯èƒ½è¿˜æœ‰<strong>ç±»å‹</strong>è®¾ç½®ä¸º <code>module</code>ï¼Œå¦‚æœä½ å†³å®šä½¿ç”¨ ES æ¨¡å—è¯­æ³•ã€‚</li></ul><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">my-web-app</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">scripts</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">start</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">node app.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">dev</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">nodemon app.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">dependencies</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">express</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">^4.17.1</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">devDependencies</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">nodemon</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">^2.0.4</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">eslint</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">^7.11.0</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">main</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">app.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">module</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™ä¸ª <code>package.json</code>ï¼Œä½ å®šä¹‰äº†é¡¹ç›®çš„åŸºæœ¬ç»“æ„ã€å¦‚ä½•è¿è¡Œå®ƒï¼Œä»¥åŠå¼€å‘å’Œç”Ÿäº§ç¯å¢ƒæ‰€éœ€çš„ä¾èµ–ã€‚è¿™æ ·ä¸ä»…æœ‰åŠ©äºç®¡ç†é¡¹ç›®ï¼Œä¹Ÿä½¿å¾—å…¶ä»–å¼€å‘è€…èƒ½å¤Ÿæ›´å®¹æ˜“åœ°ç†è§£å’Œå‚ä¸åˆ°é¡¹ç›®ä¸­æ¥ã€‚</p><h3 id="name" tabindex="-1"><a class="header-anchor" href="#name"><span><a href="https://nodejs.org/docs/latest/api/packages.html#name" target="_blank" rel="noopener noreferrer">&quot;name&quot;</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript ç¯å¢ƒï¼Œè®©ä½ å¯ä»¥ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ä¸ªæ ¸å¿ƒçš„æ¦‚å¿µå«åšâ€œåŒ…â€ï¼ˆPackageï¼‰ï¼Œå®ƒå…è®¸ä½ å°†ä»£ç æ¨¡å—åŒ–å¹¶ä¸”å¯ä»¥å¾ˆå®¹æ˜“åœ°ä¸å…¶ä»–äººåˆ†äº«å’Œä½¿ç”¨ã€‚</p><h3 id="åç§°-name" tabindex="-1"><a class="header-anchor" href="#åç§°-name"><span>åç§°ï¼ˆ&quot;name&quot;ï¼‰</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œæ¯ä¸ªåŒ…éƒ½æœ‰ä¸€ä¸ª <code>package.json</code> æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æè¿°äº†åŒ…çš„å„ç§ä¿¡æ¯ï¼Œæ¯”å¦‚ç‰ˆæœ¬å·ã€ä¾èµ–å…³ç³»ç­‰ã€‚å…¶ä¸­ <code>&quot;name&quot;</code> å­—æ®µæ˜¯éå¸¸é‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå®šä¹‰äº†åŒ…çš„åç§°ã€‚</p><h4 id="æ ¼å¼å’Œè§„åˆ™" tabindex="-1"><a class="header-anchor" href="#æ ¼å¼å’Œè§„åˆ™"><span>æ ¼å¼å’Œè§„åˆ™ï¼š</span></a></h4><ul><li><strong>ç®€æ´æ˜äº†</strong>ï¼šåç§°åº”è¯¥ç®€å•è€Œå¯Œæœ‰æ„ä¹‰ï¼Œèƒ½å¤Ÿç›´è§‚åœ°åæ˜ å‡ºè¿™ä¸ªåŒ…çš„åŠŸèƒ½æˆ–ç‰¹æ€§ã€‚</li><li><strong>å°å†™</strong>ï¼šæ‰€æœ‰çš„å­—æ¯éƒ½åº”è¯¥æ˜¯å°å†™çš„ï¼Œä»¥é¿å…åœ¨ä¸åŒæ“ä½œç³»ç»Ÿä¹‹é—´çš„å¤§å°å†™æ•æ„Ÿé—®é¢˜ã€‚</li><li><strong>é¿å…ç©ºæ ¼</strong>ï¼šåç§°ä¸­ä¸èƒ½åŒ…å«ç©ºæ ¼ï¼Œå¯ä»¥ä½¿ç”¨çŸ­åˆ’çº¿ï¼ˆ-ï¼‰æˆ–ä¸‹åˆ’çº¿ï¼ˆ_ï¼‰æ¥åˆ†éš”å•è¯ã€‚</li><li><strong>å”¯ä¸€æ€§</strong>ï¼šåç§°åœ¨ npm æ³¨å†Œè¡¨ï¼ˆnpm Registryï¼‰ä¸­å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œæ‰€ä»¥åœ¨å–åæ—¶éœ€è¦ç¡®ä¿æ²¡æœ‰ä¸ä¹‹å†²çªçš„åŒ…ã€‚</li></ul><h4 id="å®é™…è¿ç”¨çš„ä¾‹å­-6" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-6"><span>å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</span></a></h4><ol><li><p><strong>express</strong>: è¿™æ˜¯ä¸€ä¸ªéå¸¸è‘—åçš„ Node.js æ¡†æ¶ï¼Œæä¾›äº†ä¸€å¥—ç®€æ´çš„ API æ¥åˆ›å»º web åº”ç”¨ã€‚åç§°â€œexpressâ€ç®€å•ä¸”å¯Œæœ‰æ„ä¹‰ï¼Œè¡¨æ˜äº†å®ƒèƒ½å¤Ÿå¿«é€Ÿæ­å»ºåº”ç”¨çš„èƒ½åŠ›ã€‚</p></li><li><p><strong>lodash</strong>: è¿™æ˜¯ä¸€ä¸ªæä¾›äº†ä¸€æ•´å¥—å®ç”¨å·¥å…·å‡½æ•°çš„ JavaScript åº“ï¼Œæ—¨åœ¨æé«˜å¼€å‘è€…çš„ç¼–ç æ•ˆç‡ã€‚åç§°â€œlodashâ€åˆä¹å‘½åè§„åˆ™ï¼Œè€Œä¸”é€šè¿‡ç»„åˆâ€œlowâ€å’Œâ€œdashâ€ä¸¤ä¸ªè¯å…ƒç´ ä½“ç°äº†åº“çš„æ€§è´¨ã€‚</p></li><li><p><strong>body-parser</strong>: è¿™æ˜¯ä¸€ä¸ªä¸­é—´ä»¶ï¼Œç”¨äºå¤„ç† Node.js ä¸­ HTTP è¯·æ±‚çš„ body éƒ¨åˆ†ï¼Œèƒ½è§£æ JSONã€Rawã€æ–‡æœ¬åŠ URL ç¼–ç çš„æ•°æ®ã€‚åç§°â€œbody-parserâ€ç›´æ¥ä½“ç°äº†å…¶åŠŸèƒ½ï¼Œå³è§£æè¯·æ±‚ä½“ã€‚</p></li></ol><p>é€šè¿‡ä¸ºä½ çš„åŒ…é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„åç§°ï¼Œå¯ä»¥å¢åŠ å®ƒçš„å¯è¯†åˆ«æ€§å’Œå¯è®°å¿†æ€§ï¼Œä»è€Œä½¿ä½ çš„åŒ…æ›´å®¹æ˜“è¢«å…¶ä»–å¼€å‘è€…æ‰¾åˆ°å’Œä½¿ç”¨ã€‚åœ¨é€‰æ‹©åç§°æ—¶è¦è€ƒè™‘åˆ°æ¸…æ™°åº¦ã€ç®€æ´æ€§ä»¥åŠåœ¨å¹¿æ³›çš„ npm ç”Ÿæ€ç³»ç»Ÿä¸­çš„å”¯ä¸€æ€§ã€‚</p><h3 id="main" tabindex="-1"><a class="header-anchor" href="#main"><span><a href="https://nodejs.org/docs/latest/api/packages.html#main" target="_blank" rel="noopener noreferrer">&quot;main&quot;</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªè®© JavaScript èƒ½å¤Ÿåœ¨æœåŠ¡å™¨ç«¯è¿è¡Œçš„å¹³å°ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>package.json</code> æ–‡ä»¶æ‰®æ¼”ç€éå¸¸é‡è¦çš„è§’è‰²ï¼Œå®ƒæ˜¯ä¸€ä¸ªé¡¹ç›®çš„å¿ƒè„ï¼Œå®šä¹‰äº†é¡¹ç›®çš„å„ç§ä¿¡æ¯å’Œé…ç½®ã€‚å…¶ä¸­ <code>&quot;main&quot;</code> å±æ€§æ˜¯è¿™ä¸ªæ–‡ä»¶ä¸­éå¸¸å…³é”®çš„ä¸€éƒ¨åˆ†ã€‚</p><h3 id="main-å±æ€§çš„ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#main-å±æ€§çš„ä½œç”¨"><span>&quot;main&quot;å±æ€§çš„ä½œç”¨</span></a></h3><p><code>&quot;main&quot;</code> å±æ€§æŒ‡å®šäº†å½“åŒ…ï¼ˆpackageï¼‰è¢«å¼•å…¥æ—¶åº”å½“åŠ è½½çš„æ¨¡å—æ–‡ä»¶ã€‚æ¢å¥è¯è¯´ï¼Œå½“å…¶ä»–æ–‡ä»¶æˆ–æ¨¡å—ä½¿ç”¨ <code>require()</code> æ–¹æ³•æ¥å¯¼å…¥è¿™ä¸ªåŒ…æ—¶ï¼ŒNode.js ä¼šé»˜è®¤åŠ è½½ <code>&quot;main&quot;</code> å±æ€§æŒ‡å‘çš„æ–‡ä»¶ã€‚</p><h3 id="å®é™…è¿ç”¨ä¸¾ä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¸¾ä¾‹"><span>å®é™…è¿ç”¨ä¸¾ä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-é»˜è®¤å…¥å£æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-é»˜è®¤å…¥å£æ–‡ä»¶"><span>ç¤ºä¾‹ 1: é»˜è®¤å…¥å£æ–‡ä»¶</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º <code>my-module</code> çš„ Node.js é¡¹ç›®ï¼Œå¹¶ä¸”é¡¹ç›®çš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>my-module/</span></span>
<span class="line"><span>|- index.js</span></span>
<span class="line"><span>|- lib/</span></span>
<span class="line"><span>   |- another-file.js</span></span>
<span class="line"><span>|- package.json</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœåœ¨ <code>package.json</code> ä¸­è®¾ç½®äº† <code>&quot;main&quot;: &quot;index.js&quot;</code>ï¼Œé‚£ä¹ˆå½“å…¶ä»–äººé€šè¿‡ <code>require(&#39;my-module&#39;)</code> å¯¼å…¥ä½ çš„æ¨¡å—æ—¶ï¼ŒNode.js ä¼šè‡ªåŠ¨åŠ è½½ <code>index.js</code> æ–‡ä»¶ã€‚</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// package.json</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">my-module</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">main</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">index.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-æŒ‡å®šå…¶ä»–å…¥å£æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æŒ‡å®šå…¶ä»–å…¥å£æ–‡ä»¶"><span>ç¤ºä¾‹ 2: æŒ‡å®šå…¶ä»–å…¥å£æ–‡ä»¶</span></a></h4><p>ä½†æ˜¯ï¼Œå¦‚æœä½ å¸Œæœ›ä½¿ç”¨è€…åœ¨å¯¼å…¥ä½ çš„æ¨¡å—æ—¶ä¸åŠ è½½ <code>index.js</code> è€Œæ˜¯åŠ è½½ <code>lib/another-file.js</code>ï¼Œåªéœ€åœ¨ <code>package.json</code> ä¸­ä¿®æ”¹ <code>&quot;main&quot;</code> å±æ€§ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// package.json ä¿®æ”¹å</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">my-module</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">main</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">lib/another-file.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨ï¼Œå½“å…¶ä»–äººé€šè¿‡ <code>require(&#39;my-module&#39;)</code> å¯¼å…¥ä½ çš„æ¨¡å—æ—¶ï¼ŒNode.js å°†ä¼šåŠ è½½ <code>lib/another-file.js</code> è€Œä¸æ˜¯åŸå…ˆçš„ <code>index.js</code>ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>å¦‚æœæ²¡æœ‰æŒ‡å®š <code>&quot;main&quot;</code> å±æ€§ï¼ŒNode.js é»˜è®¤ä¼šå¯»æ‰¾å¹¶åŠ è½½åŒ…ç›®å½•ä¸‹çš„ <code>index.js</code> æ–‡ä»¶ã€‚</li><li><code>&quot;main&quot;</code> å±æ€§çš„è·¯å¾„æ˜¯ç›¸å¯¹äºåŒ…å« <code>package.json</code> æ–‡ä»¶çš„ç›®å½•çš„ã€‚ç¡®ä¿æ­£ç¡®è®¾ç½®è·¯å¾„ï¼Œå¦åˆ™å¼•å…¥åŒ…æ—¶ä¼šå‘ç”Ÿé”™è¯¯ã€‚</li></ul><p>é€šè¿‡åˆç†åœ°è®¾ç½® <code>&quot;main&quot;</code> å±æ€§ï¼Œä½ å¯ä»¥æ§åˆ¶å…¶ä»–äººåœ¨ä½¿ç”¨ä½ çš„åŒ…æ—¶é¦–å…ˆåŠ è½½å“ªä¸ªæ–‡ä»¶ï¼Œä»è€Œæä¾›çµæ´»æ€§å’Œæ–¹ä¾¿æ€§ã€‚</p><h3 id="packagemanager" tabindex="-1"><a class="header-anchor" href="#packagemanager"><span><a href="https://nodejs.org/docs/latest/api/packages.html#packagemanager" target="_blank" rel="noopener noreferrer">&quot;packageManager&quot;</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>&quot;packageManager&quot;</code>æ˜¯ä¸€ä¸ª package.json æ–‡ä»¶é‡Œçš„å­—æ®µï¼Œå®ƒå…è®¸ä½ ä¸ºé¡¹ç›®æŒ‡å®šä½¿ç”¨ç‰¹å®šçš„åŒ…ç®¡ç†å™¨åŠå…¶ç‰ˆæœ¬ã€‚åŒ…ç®¡ç†å™¨æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œç”¨äºè‡ªåŠ¨åŒ–å®‰è£…ã€é…ç½®ã€æ›´æ–°å’Œå¸è½½ä»£ç åŒ…ï¼ˆæˆ–â€œæ¨¡å—â€ï¼‰ã€‚</p><p>å½“ä½ åˆ›å»ºä¸€ä¸ª Node.js é¡¹ç›®æ—¶ï¼Œä½ é€šå¸¸ä¼šæœ‰ä¸€ä¸ªå«åš<code>package.json</code>çš„æ–‡ä»¶ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶é‡Œé¢å®šä¹‰äº†å¾ˆå¤šå…³äºä½ é¡¹ç›®çš„ä¿¡æ¯ï¼Œæ¯”å¦‚é¡¹ç›®åç§°ã€ç‰ˆæœ¬ã€ä¾èµ–çš„åº“ç­‰ã€‚æ–°ç‰ˆæœ¬çš„ Node.js è®©ä½ å¯ä»¥åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æ˜ç¡®æŒ‡å®šå“ªä¸ªåŒ…ç®¡ç†å™¨é€‚åˆä½ çš„é¡¹ç›®ï¼Œä»¥åŠæœŸæœ›ä½¿ç”¨çš„ç‰ˆæœ¬ã€‚</p><p>ä½¿ç”¨<code>&quot;packageManager&quot;</code>å­—æ®µçš„å¥½å¤„æ˜¯èƒ½å¤Ÿä¿è¯æ‰€æœ‰å¼€å‘è€…å’Œç¯å¢ƒä¸­éƒ½ä½¿ç”¨ç›¸åŒçš„åŒ…ç®¡ç†å™¨å’Œç‰ˆæœ¬ï¼Œé¿å…å› ä¸ºä¸åŒäººä½¿ç”¨ä¸åŒåŒ…ç®¡ç†å™¨æˆ–è€…ç‰ˆæœ¬å¯¼è‡´çš„é—®é¢˜ã€‚</p><p>å®é™…è¿ç”¨ä¸¾ä¾‹ï¼š</p><ol><li><p><strong>å›ºå®š npm ç‰ˆæœ¬</strong>ï¼š<br> å¦‚æœä½ çš„é¡¹ç›®ä¾èµ–äºç‰¹å®šç‰ˆæœ¬çš„ npm æ¥å·¥ä½œï¼Œä½ å¯ä»¥åœ¨<code>package.json</code>ä¸­è¿™æ ·æŒ‡å®šï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">example-project</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">packageManager</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">npm@7.5.4</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™å‘Šè¯‰æ‰€æœ‰ä½¿ç”¨è¿™ä¸ªé¡¹ç›®çš„å¼€å‘è€…ï¼Œåº”è¯¥ä½¿ç”¨ npm ç‰ˆæœ¬ 7.5.4 æ¥å¤„ç†ä¾èµ–ã€‚</p></li><li><p><strong>æŒ‡å®šä½¿ç”¨ Yarn</strong>ï¼š<br> å‡è®¾ä½ æ›´å–œæ¬¢ä½¿ç”¨ Yarn è€Œä¸æ˜¯ npmï¼Œå¹¶ä¸”ä½ å¸Œæœ›æ‰€æœ‰å‚ä¸é¡¹ç›®çš„äººä¹Ÿä½¿ç”¨ Yarnï¼Œä½ å¯ä»¥è¿™æ ·è®¾ç½®ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">example-project</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">packageManager</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">yarn@1.22.0</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“å…¶ä»–äººçœ‹åˆ°è¿™ä¸€ç‚¹åï¼Œä»–ä»¬å°±çŸ¥é“åº”è¯¥ä½¿ç”¨ Yarn ç‰ˆæœ¬ 1.22.0 æ¥å®‰è£…å’Œç®¡ç†ä¾èµ–ã€‚</p></li><li><p><strong>ä¼ä¸šçº§é¡¹ç›®ä¸­å¼ºåˆ¶ç‰ˆæœ¬ç»Ÿä¸€</strong>ï¼š<br> åœ¨å¤§å‹æˆ–ä¼ä¸šçº§é¡¹ç›®ä¸­ï¼Œå¯èƒ½è¦æ±‚å¼€å‘å›¢é˜Ÿå¿…é¡»ä½¿ç”¨ç‰¹å®šå·¥å…·é“¾è¿›è¡Œæ„å»ºå’Œéƒ¨ç½²ã€‚é€šè¿‡åœ¨<code>package.json</code>ä¸­å£°æ˜<code>&quot;packageManager&quot;</code>ï¼Œå¯ä»¥ç¡®ä¿é¡¹ç›®ä¸­çš„æ¯ä¸ªäººéƒ½åœ¨ä½¿ç”¨ç¡®åˆ‡çš„ç‰ˆæœ¬ï¼Œä»è€Œå‡å°‘å› ç‰ˆæœ¬ä¸åŒå¸¦æ¥çš„ä¸ç¡®å®šæ€§å’Œæ½œåœ¨çš„é”™è¯¯ã€‚</p></li></ol><p>æ€»ç»“ï¼šé€šè¿‡åœ¨<code>package.json</code>æ–‡ä»¶ä¸­ä½¿ç”¨<code>&quot;packageManager&quot;</code>å­—æ®µï¼Œä½ å¯ä»¥ä¸ºä½ çš„ Node.js é¡¹ç›®æŒ‡å®šä¸€ä¸ªæ˜ç¡®çš„åŒ…ç®¡ç†å™¨ï¼Œè¿™æœ‰åŠ©äºæ ‡å‡†åŒ–å¼€å‘ç¯å¢ƒå¹¶å‡å°‘ç”±äºåŒ…ç®¡ç†å™¨å·®å¼‚å¯¼è‡´çš„é—®é¢˜ã€‚è¿™å¯¹äºç»´æŠ¤é¡¹ç›®ç¨³å®šæ€§å’Œå›¢é˜Ÿé—´çš„ä¸€è‡´æ€§éå¸¸æœ‰å¸®åŠ©ã€‚</p><h3 id="type" tabindex="-1"><a class="header-anchor" href="#type"><span><a href="https://nodejs.org/docs/latest/api/packages.html#type" target="_blank" rel="noopener noreferrer">&quot;type&quot;</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>&quot;type&quot;</code>å­—æ®µæ˜¯ç”¨æ¥æŒ‡å®šä¸€ä¸ªåŒ…ï¼ˆpackageï¼‰æˆ–æ¨¡å—ç³»ç»Ÿåº”è¯¥å¦‚ä½•è§£é‡Šæ–‡ä»¶çš„ã€‚è¿™ä¸ªå­—æ®µå¯ä»¥åœ¨ä½ çš„<code>package.json</code>æ–‡ä»¶ä¸­è®¾ç½®ã€‚å®ƒä¸»è¦æœ‰ä¸¤ä¸ªå¯é€‰å€¼ï¼š&quot;module&quot;å’Œ&quot;commonjs&quot;ã€‚</p><h3 id="type-module" tabindex="-1"><a class="header-anchor" href="#type-module"><span><code>&quot;type&quot;: &quot;module&quot;</code></span></a></h3><p>å½“ä½ åœ¨<code>package.json</code>æ–‡ä»¶ä¸­è®¾ç½®<code>&quot;type&quot;: &quot;module&quot;</code>æ—¶ï¼ŒNode.js ä¼šå°†è¯¥åŒ…å†…æ‰€æœ‰çš„<code>.js</code>æ–‡ä»¶è§†ä¸º ECMAScript æ¨¡å—ï¼ˆESMï¼‰ã€‚ESM æ˜¯ JavaScript å®˜æ–¹çš„æ ‡å‡†æ¨¡å—ç³»ç»Ÿï¼Œå®ƒå…è®¸ä½ ä½¿ç”¨<code>import</code>å’Œ<code>export</code>è¯­å¥æ¥å¯¼å…¥å’Œå¯¼å‡ºæ¨¡å—ã€‚</p><p><strong>å®é™…åº”ç”¨ç¤ºä¾‹ï¼š</strong><br> å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç°ä»£çš„ web åº”ç”¨ï¼Œå¹¶ä¸”æƒ³è¦åˆ©ç”¨ ESM çš„ä¸€äº›ç‰¹æ€§ï¼Œæ¯”å¦‚æ¨¡å—çš„é™æ€ç»“æ„ï¼Œä»¥åŠæ›´å¥½çš„æ”¯æŒå·¥å…·é“¾ï¼ˆæ¯”å¦‚ Webpack æˆ– Rollupï¼‰ã€‚ä½ å¯ä»¥åœ¨é¡¹ç›®çš„<code>package.json</code>ä¸­è®¾ç½®<code>&quot;type&quot;: &quot;module&quot;</code>ï¼Œç„¶åå¼€å§‹ä½¿ç”¨ ESM è¯­æ³•ç¼–å†™ä½ çš„ JavaScript ä»£ç ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">my-modern-web-app</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">module</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æ­¤é…ç½®ä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼å¯¼å…¥å…¶ä»–æ¨¡å—æˆ–åº“ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> express</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">express</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="type-commonjs" tabindex="-1"><a class="header-anchor" href="#type-commonjs"><span><code>&quot;type&quot;: &quot;commonjs&quot;</code></span></a></h3><p>ç›¸åï¼Œå¦‚æœä½ è®¾ç½®äº†<code>&quot;type&quot;: &quot;commonjs&quot;</code>ï¼ŒNode.js åˆ™ä¼šå°†åŒ…å†…çš„<code>.js</code>æ–‡ä»¶è§†ä¸º CommonJSï¼ˆCJSï¼‰æ¨¡å—ã€‚CommonJS æ˜¯ Node.js åŸç”Ÿçš„æ¨¡å—ç³»ç»Ÿï¼Œå®ƒä½¿ç”¨<code>require()</code>å‡½æ•°æ¥å¯¼å…¥æ¨¡å—ï¼Œä½¿ç”¨<code>module.exports</code>æˆ–<code>exports</code>æ¥å¯¼å‡ºã€‚</p><p><strong>å®é™…åº”ç”¨ç¤ºä¾‹ï¼š</strong><br> å‡è®¾ä½ åœ¨ç»´æŠ¤ä¸€ä¸ªè¾ƒæ—©æœŸçš„ Node.js é¡¹ç›®ï¼Œè¯¥é¡¹ç›®å¹¿æ³›ä½¿ç”¨äº† CommonJS æ¨¡å¼ã€‚ä½ å¯èƒ½ä¸æƒ³ï¼ˆæˆ–æ²¡æœ‰å¿…è¦ï¼‰å°†æ•´ä¸ªé¡¹ç›®è¿ç§»åˆ° ESM ä¸Šã€‚è¿™æ—¶ï¼Œä½ å¯ä»¥åœ¨<code>package.json</code>é‡ŒæŒ‡å®šä½¿ç”¨ CommonJSï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">my-legacy-node-app</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">2.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">commonjs</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ç§é…ç½®ä¸‹ï¼Œä½ å¯ä»¥åƒå¾€å¸¸ä¸€æ ·ä½¿ç”¨<code>require</code>å’Œ<code>module.exports</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> express</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">express</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ€»ä¹‹ï¼Œ<code>&quot;type&quot;</code>å­—æ®µç»™ä½ æä¾›äº†ä¸€ä¸ªéå¸¸ç®€ä¾¿çš„æ–¹å¼æ¥å…¨å±€è®¾å®šä½ çš„ Node.js é¡¹ç›®æ˜¯é‡‡ç”¨ ESM è¿˜æ˜¯ CommonJS æ¨¡å—ç³»ç»Ÿã€‚é€šè¿‡æ˜ç¡®æŒ‡å®šæ¨¡å—ç±»å‹ï¼Œä½ å¯ä»¥æ›´å¥½åœ°æ§åˆ¶ä½ çš„é¡¹ç›®ç»“æ„ï¼Œç¡®ä¿ä»£ç çš„ä¸€è‡´æ€§å’Œå…¼å®¹æ€§ã€‚</p><h3 id="exports" tabindex="-1"><a class="header-anchor" href="#exports"><span><a href="https://nodejs.org/docs/latest/api/packages.html#exports" target="_blank" rel="noopener noreferrer">&quot;exports&quot;</a></span></a></h3><p>ç†è§£ Node.js ä¸­çš„ &quot;exports&quot; æ¦‚å¿µæ˜¯ç†è§£å¦‚ä½•æ„å»ºå’Œç®¡ç†æ¨¡å—åŒ– JavaScript åº”ç”¨ç¨‹åºçš„å…³é”®ä¸€æ­¥ã€‚åœ¨ç‰ˆæœ¬ 21.7.1 ä¸­ï¼Œ<code>exports</code> å­—æ®µåœ¨ <code>package.json</code> æ–‡ä»¶ä¸­æ‰®æ¼”ç€è‡³å…³é‡è¦çš„è§’è‰²ã€‚å®ƒä¸ºæ¨¡å—ä½œè€…æä¾›äº†å®šä¹‰å¦‚ä½•ä»åŒ…ä¸­å¯¼å‡ºæ¨¡å—çš„æ–¹å¼ï¼Œè¿›è€Œæ§åˆ¶åŒ…çš„å…¬å¼€æ¥å£ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-1" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-1"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—éƒ½å¯ä»¥å¯¼å‡ºå¯¹è±¡ã€å‡½æ•°ã€å˜é‡ç­‰ç»™å…¶ä»–æ¨¡å—ä½¿ç”¨ã€‚å½“ä½ å®‰è£…å¹¶å¼•å…¥ä¸€ä¸ª npm åŒ…æ—¶ï¼Œå®é™…ä¸Šä½ æ˜¯åœ¨å¼•å…¥é‚£ä¸ªåŒ…å¯¼å‡ºçš„å†…å®¹ã€‚<code>exports</code> å­—æ®µä½¿å¾—åŒ…çš„ä½œè€…å¯ä»¥æ›´ç»†è‡´åœ°æ§åˆ¶å“ªäº›å†…å®¹å¯ä»¥è¢«å¤–éƒ¨è®¿é—®ï¼Œä»¥åŠå¦‚ä½•è¢«è®¿é—®ã€‚</p><h3 id="ä½¿ç”¨-exports" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-exports"><span>ä½¿ç”¨ <code>exports</code></span></a></h3><p>åœ¨ <code>package.json</code> æ–‡ä»¶ä¸­ä½¿ç”¨ <code>exports</code> å­—æ®µå¯ä»¥æŒ‡å®šä¸€ä¸ªåŒ…çš„å…¥å£ç‚¹ï¼Œæˆ–è€…å®šä¹‰å¤šä¸ªå…¥å£ç‚¹ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å®é™…åº”ç”¨ç¤ºä¾‹ï¼š</p><h4 id="ç¤ºä¾‹-1-å®šä¹‰ä¸€ä¸ªç®€å•çš„å…¥å£ç‚¹" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-å®šä¹‰ä¸€ä¸ªç®€å•çš„å…¥å£ç‚¹"><span>ç¤ºä¾‹ 1: å®šä¹‰ä¸€ä¸ªç®€å•çš„å…¥å£ç‚¹</span></a></h4><p>å¦‚æœä½ çš„åŒ…å¾ˆç®€å•ï¼Œåªéœ€è¦æš´éœ²ä¸€ä¸ªä¸»æ¨¡å—ï¼Œä½ å¯ä»¥è¿™æ ·è®¾ç½®ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">your-package-name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./main-module.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå½“å…¶ä»–äººä»ä½ çš„åŒ…ä¸­å¯¼å…¥æ—¶ï¼Œä»–ä»¬å®é™…ä¸Šæ˜¯åœ¨å¯¼å…¥ <code>./main-module.js</code> æ–‡ä»¶ã€‚</p><h4 id="ç¤ºä¾‹-2-å®šä¹‰æ¡ä»¶æ€§å¯¼å‡º" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å®šä¹‰æ¡ä»¶æ€§å¯¼å‡º"><span>ç¤ºä¾‹ 2: å®šä¹‰æ¡ä»¶æ€§å¯¼å‡º</span></a></h4><p>ä½ å¯ä»¥é€šè¿‡ <code>exports</code> å­—æ®µå®šä¹‰åŸºäºä¸åŒæ¡ä»¶é€‰æ‹©æ€§åœ°å¯¼å‡ºæ¨¡å—ã€‚è¿™å¯¹äºæä¾›ç‰¹å®šäºç¯å¢ƒï¼ˆä¾‹å¦‚æµè§ˆå™¨ä¸ Node.js ç¯å¢ƒï¼‰çš„ä»£ç éå¸¸æœ‰ç”¨ã€‚</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">browser</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/browser-index.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">default</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/index.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ ¹æ®è¿™ä¸ªé…ç½®ï¼Œå¦‚æœåŒ…æ¶ˆè´¹è€…åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ï¼Œå°†ä¼šè‡ªåŠ¨å¯¼å…¥ <code>./src/browser-index.js</code>ï¼›åœ¨å…¶ä»–ç¯å¢ƒï¼ˆå¦‚ Node.jsï¼‰ä¸­ï¼Œåˆ™é»˜è®¤å¯¼å…¥ <code>./src/index.js</code>ã€‚</p><h4 id="ç¤ºä¾‹-3-æä¾›å¤šä¸ªæ¨¡å—å…¥å£ç‚¹" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-æä¾›å¤šä¸ªæ¨¡å—å…¥å£ç‚¹"><span>ç¤ºä¾‹ 3: æä¾›å¤šä¸ªæ¨¡å—å…¥å£ç‚¹</span></a></h4><p>æœ‰æ—¶å€™ï¼Œä½ çš„åŒ…å¯èƒ½éœ€è¦æä¾›å¤šä¸ªæ¨¡å—å…¥å£ç‚¹ï¼Œä»¥æ”¯æŒä¸åŒçš„åŠŸèƒ½ã€‚ä½¿ç”¨ <code>exports</code> å­—æ®µï¼Œä½ å¯ä»¥è½»æ¾å®ç°è¿™ä¸€ç‚¹ã€‚</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">exports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/main-module.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">./utils</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/utils-module.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå½“å…¶ä»–å¼€å‘äººå‘˜å¯¼å…¥ä½ çš„åŒ…æ—¶ï¼Œä»–ä»¬å¯ä»¥é€šè¿‡æŒ‡å®šè·¯å¾„æ¥è®¿é—®ä¸åŒçš„æ¨¡å—ã€‚æ¯”å¦‚ï¼Œå¯¼å…¥ <code>your-package-name/utils</code> å°†ä¼šè·å–åˆ° <code>./src/utils-module.js</code>ã€‚</p><h3 id="æ€»ç»“-3" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-3"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡ä¸Šè¿°ç¤ºä¾‹ï¼Œå¯ä»¥çœ‹åˆ° <code>exports</code> å­—æ®µåœ¨ç®¡ç†å’Œæ§åˆ¶ Node.js åŒ…çš„å¯¼å‡ºæ–¹é¢çš„çµæ´»æ€§å’Œå¼ºå¤§åŠŸèƒ½ã€‚å®ƒä¸ä»…å…è®¸åŒ…ä½œè€…ç²¾ç¡®æ§åˆ¶å“ªäº›æ–‡ä»¶æˆ–æ¨¡å—å¯è¢«å¤–éƒ¨è®¿é—®ï¼Œè¿˜æ”¯æŒåŸºäºä¸åŒä½¿ç”¨åœºæ™¯ï¼ˆå¦‚ç¯å¢ƒå·®å¼‚ï¼‰çš„æ¡ä»¶æ€§å¯¼å‡ºã€‚éšç€ JavaScript ç”Ÿæ€çš„ä¸æ–­å‘å±•ï¼Œç†è§£å¹¶åˆç†åˆ©ç”¨è¿™äº›ç‰¹æ€§ï¼Œå¯¹äºæ„å»ºé«˜æ•ˆã€å¯ç»´æŠ¤çš„æ¨¡å—åŒ–ä»£ç è‡³å…³é‡è¦ã€‚</p><h3 id="imports" tabindex="-1"><a class="header-anchor" href="#imports"><span><a href="https://nodejs.org/docs/latest/api/packages.html#imports" target="_blank" rel="noopener noreferrer">&quot;imports&quot;</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>&quot;imports&quot;</code>å­—æ®µæ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°çš„æ·»åŠ åˆ°<code>package.json</code>æ–‡ä»¶ä¸­çš„åŠŸèƒ½ã€‚è¿™ä¸ªåŠŸèƒ½è®©æ¨¡å—ä½œè€…å¯ä»¥å®šä¹‰ä¸€ç»„å¯¼å…¥åˆ«åï¼Œè¿™äº›åˆ«åå¯ä»¥åœ¨åŒ…å†…éƒ¨ä½¿ç”¨æ¥å¼•å…¥æ¨¡å—æˆ–è€…å…¶ä»–èµ„æºã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†æä¾›ä¸€ç§æ›´ç®€æ´ã€æ›´å¯ç»´æŠ¤çš„æ–¹æ³•æ¥ç®¡ç†é¡¹ç›®å†…éƒ¨çš„ä¾èµ–è·¯å¾„ã€‚</p><h3 id="åŸºæœ¬ç”¨é€”" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç”¨é€”"><span>åŸºæœ¬ç”¨é€”</span></a></h3><p>å½“ä½ åœ¨å¼€å‘ä¸€ä¸ªå¤§å‹çš„ Node.js é¡¹ç›®æ—¶ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°éœ€è¦ä»å¾ˆæ·±çš„ç›®å½•ç»“æ„ä¸­å¼•å…¥æ¨¡å—æˆ–æ–‡ä»¶çš„æƒ…å†µã€‚é€šå¸¸ï¼Œè¿™æ„å‘³ç€ä½ éœ€è¦ä½¿ç”¨å¾ˆé•¿çš„ç›¸å¯¹è·¯å¾„ï¼Œä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> myModule</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">../../../../some/deeply/nested/module.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™æ ·çš„è·¯å¾„ä¸ä»…éš¾ä»¥é˜…è¯»å’Œç»´æŠ¤ï¼Œè€Œä¸”å¦‚æœä½ å†³å®šé‡æ–°ç»„ç»‡ä½ çš„ç›®å½•ç»“æ„ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä½ éœ€è¦æ›´æ–°é¡¹ç›®ä¸­å¤šå¤„çš„è·¯å¾„å¼•ç”¨ã€‚ä½¿ç”¨<code>&quot;imports&quot;</code>å­—æ®µå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-1" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-1"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>åœ¨ä½ çš„<code>package.json</code>æ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥è¿™æ ·å®šä¹‰<code>&quot;imports&quot;</code>å­—æ®µï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">your-package-name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">imports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">#myModule</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/some/deeply/nested/module.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œåœ¨ä½ çš„ä»£ç ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨å®šä¹‰å¥½çš„åˆ«åæ¥å¼•å…¥æ¨¡å—ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> myModule</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">#myModule</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// æˆ–è€…å¦‚æœä½ ä½¿ç”¨require</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> myModule</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">#myModule</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ï¼Œæ— è®ºä½ çš„æ¨¡å—å®é™…åœ¨å“ªé‡Œï¼Œä½ éƒ½å¯ä»¥ä½¿ç”¨ç®€çŸ­æ˜äº†çš„è·¯å¾„å¼•å…¥å®ƒï¼Œè¿™ä½¿å¾—ä»£ç æ›´å®¹æ˜“ç†è§£å’Œç»´æŠ¤ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-5"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="_1-ç®€åŒ–é¡¹ç›®å†…éƒ¨æ¨¡å—çš„å¼•å…¥" tabindex="-1"><a class="header-anchor" href="#_1-ç®€åŒ–é¡¹ç›®å†…éƒ¨æ¨¡å—çš„å¼•å…¥"><span>1. ç®€åŒ–é¡¹ç›®å†…éƒ¨æ¨¡å—çš„å¼•å…¥</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œä½ æœ‰ä¸€ä¸ªå·¥å…·åº“åœ¨<code>./src/utils/</code>ç›®å½•ä¸‹ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">imports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">#utils/*</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./src/utils/*.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨ï¼Œä½ å¯ä»¥è½»æ¾åœ°ä»ä»»ä½•åœ°æ–¹å¼•å…¥è¿™ä¸ªç›®å½•ä¸‹çš„æ¨¡å—ï¼Œæ¯”å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#ECEFF4;"> {</span><span style="color:#8FBCBB;"> fetchData</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">#utils/fetchData</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_2-å®šä¹‰ç¯å¢ƒç‰¹å®šçš„å…¥å£" tabindex="-1"><a class="header-anchor" href="#_2-å®šä¹‰ç¯å¢ƒç‰¹å®šçš„å…¥å£"><span>2. å®šä¹‰ç¯å¢ƒç‰¹å®šçš„å…¥å£</span></a></h4><p>å¦‚æœä½ çš„é¡¹ç›®éœ€è¦æ ¹æ®ä¸åŒçš„ç¯å¢ƒåŠ è½½ä¸åŒçš„é…ç½®æ–‡ä»¶ï¼Œä½ å¯ä»¥ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">imports</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">#config</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./configs/default-config.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">#config?production</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./configs/production-config.js</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œåœ¨ä»£ç ä¸­è¿™æ ·ä½¿ç”¨ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> config</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">#config</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>åŸºäºä½ çš„ç¯å¢ƒé…ç½®ï¼ˆé€šè¿‡è®¾ç½®<code>NODE_ENV=production</code>ï¼‰ï¼Œæ­£ç¡®çš„é…ç½®æ–‡ä»¶å°†è¢«åŠ è½½ã€‚</p><h4 id="_3-é‡æ„å’Œç›®å½•ç»“æ„å˜åŠ¨" tabindex="-1"><a class="header-anchor" href="#_3-é‡æ„å’Œç›®å½•ç»“æ„å˜åŠ¨"><span>3. é‡æ„å’Œç›®å½•ç»“æ„å˜åŠ¨</span></a></h4><p>å½“ä½ çš„é¡¹ç›®å¢é•¿ï¼Œä½ å¯èƒ½ä¼šé‡æ„å’Œæ”¹å˜ç›®å½•ç»“æ„ã€‚ä½¿ç”¨<code>&quot;imports&quot;</code>ä½¿å¾—è¿™ä¸ªè¿‡ç¨‹æ›´åŠ å¹³æ»‘ï¼Œå› ä¸ºä½ åªéœ€è¦åœ¨<code>package.json</code>ä¸­æ›´æ–°è·¯å¾„æ˜ å°„ï¼Œè€Œä¸éœ€è¦æœç´¢å¹¶æ›¿æ¢é¡¹ç›®ä¸­æ‰€æœ‰çš„å¼•ç”¨ç‚¹ã€‚</p><h3 id="æ€»ç»“-4" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-4"><span>æ€»ç»“</span></a></h3><p>ä½¿ç”¨<code>&quot;imports&quot;</code>å­—æ®µï¼Œå¯ä»¥è®©ä½ çš„é¡¹ç›®æ›´åŠ æ¨¡å—åŒ–ï¼Œæé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚å®ƒæ˜¯ Node.js ä¸­å¤„ç†å†…éƒ¨ä¾èµ–çš„å¼ºå¤§å·¥å…·ï¼Œèƒ½å¤Ÿå¸®åŠ©ä½ ç»´æŠ¤æ¸…æ™°å’Œçµæ´»çš„é¡¹ç›®ç»“æ„ã€‚</p></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: kamiacgxu@gmail.com">kamishima-kaede</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/document/node-doc/Modules_%20node_module%20API.html" aria-label="Modules: node:module API"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Modules: node:module API</div></a><a class="route-link auto-link next" href="/document/node-doc/Net.html" aria-label="Net"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">Net<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><!----><div class="vp-copyright">Copyright Â© 2018-present hanekawa-shiki</div></footer></div><!--]--><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.b7c0d7f2.js" defer></script><script src="/assets/js/4485.d2710361.js" defer></script><script src="/assets/js/app.ed12edd2.js" defer></script>
  </body>
</html>
