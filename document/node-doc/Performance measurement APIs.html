<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.50" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://hanekawa.top/document/node-doc/Performance%20measurement%20APIs.html"><meta property="og:site_name" content="hanekawa-shiki"><meta property="og:title" content="Performance measurement APIs"><meta property="og:description" content="Performance measurement APIs Node.js v21.7.1 ä¸­çš„æ€§èƒ½æµ‹é‡ API ä¸»è¦æ˜¯æŒ‡perf_hooksæ¨¡å—ï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—çš„å·¥å…·ï¼Œä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿæµ‹é‡åœ¨ Node.js åº”ç”¨ç¨‹åºä¸­è¿è¡Œçš„ä»£ç çš„æ€§èƒ½ã€‚è¿™ä¸ªæ¨¡å—å¯ä»¥å¸®åŠ©ä½ ç†è§£ä»£ç çš„æ‰§è¡Œæ—¶é—´ï¼Œä»è€Œå¯¹ä»£ç è¿›è¡Œä¼˜åŒ–ã€‚ä¸‹é¢ï¼Œæˆ‘å°†ç®€å•ä»‹ç»å‡ ä¸ªä¸»è¦çš„åŠŸèƒ½ï¼Œå¹¶ä¸”é€šè¿‡å®ä¾‹æ¥è¯´æ˜å®ƒä»¬çš„åº”ç”¨..."><meta property="og:type" content="website"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-06-21T09:46:17.000Z"><meta property="article:author" content="hanekawa-shiki"><meta property="article:modified_time" content="2024-06-21T09:46:17.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"WebPage","name":"Performance measurement APIs","description":"Performance measurement APIs Node.js v21.7.1 ä¸­çš„æ€§èƒ½æµ‹é‡ API ä¸»è¦æ˜¯æŒ‡perf_hooksæ¨¡å—ï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—çš„å·¥å…·ï¼Œä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿæµ‹é‡åœ¨ Node.js åº”ç”¨ç¨‹åºä¸­è¿è¡Œçš„ä»£ç çš„æ€§èƒ½ã€‚è¿™ä¸ªæ¨¡å—å¯ä»¥å¸®åŠ©ä½ ç†è§£ä»£ç çš„æ‰§è¡Œæ—¶é—´ï¼Œä»è€Œå¯¹ä»£ç è¿›è¡Œä¼˜åŒ–ã€‚ä¸‹é¢ï¼Œæˆ‘å°†ç®€å•ä»‹ç»å‡ ä¸ªä¸»è¦çš„åŠŸèƒ½ï¼Œå¹¶ä¸”é€šè¿‡å®ä¾‹æ¥è¯´æ˜å®ƒä»¬çš„åº”ç”¨..."}</script><meta name="keywords" content="JavaScript,HTML,CSS"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/assets/icons/chrome-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icons/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icons/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icons/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#5c92d1"><link rel="apple-touch-icon" href="/assets/icons/apple-touch-icon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="white"><meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><title>Performance measurement APIs | hanekawa-shiki</title><meta name="description" content="Performance measurement APIs Node.js v21.7.1 ä¸­çš„æ€§èƒ½æµ‹é‡ API ä¸»è¦æ˜¯æŒ‡perf_hooksæ¨¡å—ï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—çš„å·¥å…·ï¼Œä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿæµ‹é‡åœ¨ Node.js åº”ç”¨ç¨‹åºä¸­è¿è¡Œçš„ä»£ç çš„æ€§èƒ½ã€‚è¿™ä¸ªæ¨¡å—å¯ä»¥å¸®åŠ©ä½ ç†è§£ä»£ç çš„æ‰§è¡Œæ—¶é—´ï¼Œä»è€Œå¯¹ä»£ç è¿›è¡Œä¼˜åŒ–ã€‚ä¸‹é¢ï¼Œæˆ‘å°†ç®€å•ä»‹ç»å‡ ä¸ªä¸»è¦çš„åŠŸèƒ½ï¼Œå¹¶ä¸”é€šè¿‡å®ä¾‹æ¥è¯´æ˜å®ƒä»¬çš„åº”ç”¨...">
    <link rel="stylesheet" href="/assets/css/styles.b040cee0.css">
    <link rel="preload" href="/assets/js/runtime~app.28bb228f.js" as="script"><link rel="preload" href="/assets/css/styles.b040cee0.css" as="style"><link rel="preload" href="/assets/js/6679.86a2b270.js" as="script"><link rel="preload" href="/assets/js/app.de91e5da.js" as="script">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo light" src="/assets/svg/logo.svg" alt><img class="vp-nav-logo dark" src="/assets/svg/logo.svg" alt><span class="vp-site-name hide-in-pad">hanekawa-shiki</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="åšå®¢ä¸»é¡µ"><!--[--><span class="font-icon icon home" style=""></span><!--]-->åšå®¢ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="å­¦ä¹ ç¬”è®°"><!--[--><span class="font-icon icon framework" style=""></span>å­¦ä¹ ç¬”è®°<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">å‰ç«¯æ¡†æ¶</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/framework_front/vue3/" aria-label="Vue3ç¬”è®°"><!--[--><span class="font-icon icon vue" style=""></span><!--]-->Vue3ç¬”è®°<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/framework_front/react/" aria-label="Reactç¬”è®°"><!--[--><span class="font-icon icon react" style=""></span><!--]-->Reactç¬”è®°<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="æ–‡æ¡£"><!--[--><span class="font-icon icon framework" style=""></span>æ–‡æ¡£<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">æ¬è¿</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link route-link-active auto-link" href="/document/node-doc/" aria-label="Node.jsæ–‡æ¡£"><!--[--><span class="font-icon icon circle-info" style=""></span><!--]-->Node.jsæ–‡æ¡£<!----></a></li></ul></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/hanekawa-shiki/hanekawa-shiki.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/" aria-label="Node.jsæ–‡æ¡£"><!--[--><span class="font-icon icon circle-info" style=""></span><!--]-->Node.jsæ–‡æ¡£<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Assert.html" aria-label="Assert"><!---->Assert<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Async%20hooks.html" aria-label="Async hooks"><!---->Async hooks<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Asynchronous%20context%20tracking.html" aria-label="Asynchronous context tracking"><!---->Asynchronous context tracking<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Buffer.html" aria-label="Buffer"><!---->Buffer<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/C__%20addons.html" aria-label="C++ addons"><!---->C++ addons<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/C__%20embedder%20API.html" aria-label="C++ embedder API"><!---->C++ embedder API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Child%20process.html" aria-label="Child process"><!---->Child process<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Cluster.html" aria-label="Cluster"><!---->Cluster<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Command-line%20API.html" aria-label="Command-line API"><!---->Command-line API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Console.html" aria-label="Console"><!---->Console<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Corepack.html" aria-label="Corepack"><!---->Corepack<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Crypto.html" aria-label="Crypto"><!---->Crypto<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Debugger.html" aria-label="Debugger"><!---->Debugger<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Deprecated%20APIs.html" aria-label="Deprecated APIs"><!---->Deprecated APIs<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Diagnostic%20report.html" aria-label="Diagnostic report"><!---->Diagnostic report<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Diagnostics%20Channel.html" aria-label="Diagnostics Channel"><!---->Diagnostics Channel<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/DNS.html" aria-label="DNS"><!---->DNS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Domain.html" aria-label="Domain"><!---->Domain<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Errors.html" aria-label="Errors"><!---->Errors<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Events.html" aria-label="Events"><!---->Events<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/File%20system.html" aria-label="File system"><!---->File system<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Global%20objects.html" aria-label="Global objects"><!---->Global objects<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/HTTP.html" aria-label="HTTP"><!---->HTTP<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/HTTPS.html" aria-label="HTTPS"><!---->HTTPS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Inspector.html" aria-label="Inspector"><!---->Inspector<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Internationalization%20support.html" aria-label="Internationalization support"><!---->Internationalization support<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-CommonJS%20modules.html" aria-label="Modules: CommonJS modules"><!---->Modules: CommonJS modules<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-ECMAScript%20modules.html" aria-label="Modules: ECMAScript modules"><!---->Modules: ECMAScript modules<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-node_module%20API.html" aria-label="Modules: node:module API"><!---->Modules: node:module API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-Packages.html" aria-label="Modules: Packages"><!---->Modules: Packages<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Net.html" aria-label="Net"><!---->Net<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Node-API.html" aria-label="Node-API"><!---->Node-API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/OS.html" aria-label="OS"><!---->OS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Path.html" aria-label="Path"><!---->Path<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/document/node-doc/Performance%20measurement%20APIs.html" aria-label="Performance measurement APIs"><!---->Performance measurement APIs<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Permissions.html" aria-label="Permissions"><!---->Permissions<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Process.html" aria-label="Process"><!---->Process<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Punycode.html" aria-label="Punycode"><!---->Punycode<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Query%20string.html" aria-label="Query string"><!---->Query string<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Readline.html" aria-label="Readline"><!---->Readline<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/REPL.html" aria-label="REPL"><!---->REPL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Stream.html" aria-label="Stream"><!---->Stream<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/String%20decoder.html" aria-label="String decoder"><!---->String decoder<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Test%20runner.html" aria-label="Test runner"><!---->Test runner<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Timers.html" aria-label="Timers"><!---->Timers<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/TLS%20(SSL).html" aria-label="TLS (SSL)"><!---->TLS (SSL)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Trace%20events.html" aria-label="Trace events"><!---->Trace events<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/TTY.html" aria-label="TTY"><!---->TTY<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/URL.html" aria-label="URL"><!---->URL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Util.html" aria-label="Util"><!---->Util<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/V8.html" aria-label="V8"><!---->V8<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/VM%20(executing%20JavaScript).html" aria-label="VM (executing JavaScript)"><!---->VM (executing JavaScript)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Web%20Crypto%20API.html" aria-label="Web Crypto API"><!---->Web Crypto API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Web%20Streams%20API.html" aria-label="Web Streams API"><!---->Web Streams API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/WebAssembly%20System%20Interface%20(WASI).html" aria-label="WebAssembly System Interface (WASI)"><!---->WebAssembly System Interface (WASI)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Worker%20threads.html" aria-label="Worker threads"><!---->Worker threads<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Zlib.html" aria-label="Zlib"><!---->Zlib<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Performance measurement APIs</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://hanekawa.top" target="_blank" rel="noopener noreferrer">hanekawa-shiki</a></span><span property="author" content="hanekawa-shiki"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-06-21T09:46:17.000Z"></span><!----><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 230 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT230M"></span><span class="page-word-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon" name="word"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 69069 å­—</span><meta property="wordCount" content="69069"></span><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-performance-mark-å’Œ-performance-measure">1. performance.mark() å’Œ performance.measure()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-performanceobserver">2. PerformanceObserver</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#perf-hooks-performance">perf_hooks.performance</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬ä½¿ç”¨">åŸºæœ¬ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-clearmarks-name">performance.clearMarks([name])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-clearmeasures-name">performance.clearMeasures([name])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-clearresourcetimings-name">performance.clearResourceTimings([name])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹">ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-eventlooputilization-utilization1-utilization2">performance.eventLoopUtilization([utilization1[, utilization2]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#äº‹ä»¶å¾ªç¯ç®€ä»‹">äº‹ä»¶å¾ªç¯ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-eventlooputilization-å‡½æ•°">performance.eventLoopUtilization() å‡½æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹">ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-getentries">performance.getEntries()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¸¾ä¾‹">å®é™…åº”ç”¨ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-getentriesbyname-name-type">performance.getEntriesByName(name[, type])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-getentriesbytype-type">performance.getEntriesByType(type)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-getentriesbytype-type-1">performance.getEntriesByType(type)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-1">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-mark-name-options">performance.mark(name[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-mark-name-options-çš„åŸºæœ¬ç”¨æ³•">performance.mark(name[, options]) çš„åŸºæœ¬ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-markresourcetiming-timinginfo-requestedurl-initiatortype-global-cachemode">performance.markResourceTiming(timingInfo, requestedUrl, initiatorType, global, cacheMode)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ–¹æ³•çš„å‚æ•°">æ–¹æ³•çš„å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯å’Œä¾‹å­">ä½¿ç”¨åœºæ™¯å’Œä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-measure-name-startmarkoroptions-endmark">performance.measure(name[, startMarkOrOptions[, endMark]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-1">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-1">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-nodetiming">performance.nodeTiming</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-now">performance.now()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-1">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-setresourcetimingbuffersize-maxsize">performance.setResourceTimingBufferSize(maxSize)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-setresourcetimingbuffersize-maxsize-1">performance.setResourceTimingBufferSize(maxSize)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-1">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-timeorigin">performance.timeOrigin</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´">ä¾‹å­ 1ï¼šæµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-æ€§èƒ½ç›‘æ§">ä¾‹å­ 2ï¼šæ€§èƒ½ç›‘æ§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-3-äº‹ä»¶æ—¥å¿—è®°å½•">ä¾‹å­ 3ï¼šäº‹ä»¶æ—¥å¿—è®°å½•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-timerify-fn-options">performance.timerify(fn[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬ç”¨æ³•">åŸºæœ¬ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­">ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨">å®é™…è¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performance-tojson">performance.toJSON()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨performance-tojson">ä½¿ç”¨performance.toJSON()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-2">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-1">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-2">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-performanceentry">Class: PerformanceEntry</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-2">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-2">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceentry-duration">performanceEntry.duration</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬ç†è§£">åŸºæœ¬ç†è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-1">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceentry-entrytype">performanceEntry.entryType</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯performanceentry-entrytype">ä»€ä¹ˆæ˜¯performanceEntry.entryType?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®è·µä¸­çš„åº”ç”¨ç¤ºä¾‹">å®è·µä¸­çš„åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-3">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceentry-name">performanceEntry.name</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-3">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceentry-starttime">performanceEntry.startTime</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-performanceentry">ä»€ä¹ˆæ˜¯ PerformanceEntryï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ç†è§£-starttime">å¦‚ä½•ç†è§£ startTimeï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-3">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-performancemark">Class: PerformanceMark</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-performancemark">ä»€ä¹ˆæ˜¯ PerformanceMark?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€ä¹ˆä½¿ç”¨">æ€ä¹ˆä½¿ç”¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-1">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performancemark-detail">performanceMark.detail</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-performance-mark">ä»€ä¹ˆæ˜¯ performance.mark()?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-performancemark-detail">ä½¿ç”¨ performanceMark.detail</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-4">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-performancemeasure">Class: PerformanceMeasure</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬ä½¿ç”¨æ–¹æ³•">åŸºæœ¬ä½¿ç”¨æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-1">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performancemeasure-detail">performanceMeasure.detail</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-performancenodeentry">Class: PerformanceNodeEntry</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-4">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performancenodeentry-detail">performanceNodeEntry.detail</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-æµ‹é‡å¼‚æ­¥æ“ä½œçš„è€—æ—¶">ç¤ºä¾‹ 1ï¼šæµ‹é‡å¼‚æ­¥æ“ä½œçš„è€—æ—¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-ç›‘å¬-node-js-ç‰¹å®šäº‹ä»¶çš„æ€§èƒ½">ç¤ºä¾‹ 2ï¼šç›‘å¬ Node.js ç‰¹å®šäº‹ä»¶çš„æ€§èƒ½</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performancenodeentry-flags">performanceNodeEntry.flags</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performancenodeentry-kind">performanceNodeEntry.kind</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performancenodeentry-kind-1">performanceNodeEntry.kind</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-3">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#garbage-collection-gc-details">Garbage Collection (&#39;gc&#39;) Details</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åƒåœ¾å›æ”¶å·¥ä½œåŸç†">åƒåœ¾å›æ”¶å·¥ä½œåŸç†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•åœ¨-node-js-ä¸­è·å–-gc-è¯¦æƒ…">å¦‚ä½•åœ¨ Node.js ä¸­è·å– GC è¯¦æƒ…</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-5">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#http-http-details">HTTP (&#39;http&#39;) Details</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€§èƒ½ç›‘æµ‹å’Œ-http">æ€§èƒ½ç›‘æµ‹å’Œ HTTP</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨-1">å®é™…è¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-2">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#http-2-http2-details">HTTP/2 (&#39;http2&#39;) Details</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åˆ›å»º-http-2-æœåŠ¡å™¨">åˆ›å»º HTTP/2 æœåŠ¡å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®¢æˆ·ç«¯è¿æ¥åˆ°-http-2-æœåŠ¡å™¨">å®¢æˆ·ç«¯è¿æ¥åˆ° HTTP/2 æœåŠ¡å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timerify-function-details">Timerify (&#39;function&#39;) Details</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#net-net-details">Net (&#39;net&#39;) Details</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç®€ä»‹">ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1">ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dns-dns-details">DNS (&#39;dns&#39;) Details</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dns-æ¨¡å—çš„åŸºæœ¬ç”¨é€”">DNS æ¨¡å—çš„åŸºæœ¬ç”¨é€”</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2">ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-2">å°ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-performancenodetiming">Class: PerformanceNodeTiming</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performancenodetimingç±»">PerformanceNodeTimingç±»</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-5">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-2">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performancenodetiming-bootstrapcomplete">performanceNodeTiming.bootstrapComplete</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-6">å®é™…è¿ç”¨ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performancenodetiming-environment">performanceNodeTiming.environment</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦">ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨å®ƒ">å¦‚ä½•ä½¿ç”¨å®ƒï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨æ¡ˆä¾‹">å®é™…åº”ç”¨æ¡ˆä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performancenodetiming-idletime">performanceNodeTiming.idleTime</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-performancenodetiming-idletime">è§£é‡Š performanceNodeTiming.idleTime</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-3">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performancenodetiming-loopexit">performanceNodeTiming.loopExit</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performancenodetiming-loopstart">performanceNodeTiming.loopStart</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performancenodetiming-nodestart">performanceNodeTiming.nodeStart</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performancenodetiming-nodestart-è¯¦è§£">performanceNodeTiming.nodeStart è¯¦è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨-2">å®é™…è¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-4">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performancenodetiming-v8start">performanceNodeTiming.v8Start</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-4">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-5">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-performanceresourcetiming">Class: PerformanceResourceTiming</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å…³é”®å±æ€§">å…³é”®å±æ€§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-1">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-5">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming-workerstart">performanceResourceTiming.workerStart</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-7">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming-redirectstart">performanceResourceTiming.redirectStart</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-1">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-8">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»£ç ç¤ºä¾‹">ä»£ç ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming-redirectend">performanceResourceTiming.redirectEnd</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-redirectend">ä»€ä¹ˆæ˜¯ redirectEndï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨åœºæ™¯">å®é™…åº”ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-3">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming-fetchstart">performanceResourceTiming.fetchStart</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯performanceresourcetiming-fetchstart">ä»€ä¹ˆæ˜¯performanceResourceTiming.fetchStartï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-9">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨performanceresourcetiming-fetchstart">å¦‚ä½•ä½¿ç”¨performanceResourceTiming.fetchStartï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming-domainlookupstart">performanceResourceTiming.domainLookupStart</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-performanceresourcetiming">ä»€ä¹ˆæ˜¯ performanceResourceTiming</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å…³äº-domainlookupstart">å…³äº domainLookupStart</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨-3">å®é™…è¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-6">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming-domainlookupend">performanceResourceTiming.domainLookupEnd</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-node-js">ä»€ä¹ˆæ˜¯ Node.js?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-performanceresourcetiming-1">ä»€ä¹ˆæ˜¯ PerformanceResourceTiming?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming-connectstart">performanceResourceTiming.connectStart</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-2">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming-connectend">performanceResourceTiming.connectEnd</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€çŸ¥è¯†">åŸºç¡€çŸ¥è¯†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming-connectend-è§£é‡Š">performanceResourceTiming.connectEnd è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-5">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-4">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming-secureconnectionstart">performanceResourceTiming.secureConnectionStart</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming-secureconnectionstart-1">performanceResourceTiming.secureConnectionStart</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming-requeststart">performanceResourceTiming.requestStart</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming-requeststart-1">performanceResourceTiming.requestStart</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming-responseend">performanceResourceTiming.responseEnd</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-performanceresourcetiming-responseend">ä»€ä¹ˆæ˜¯ performanceResourceTiming.responseEnd?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ç†è§£å®ƒ">å¦‚ä½•ç†è§£å®ƒï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨">å®é™…åº”ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ç¤ºä¾‹">ä½¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming-transfersize">performanceResourceTiming.transferSize</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#èƒŒæ™¯">èƒŒæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming">PerformanceResourceTiming</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming-transfersize-1">performanceResourceTiming.transferSize</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-6">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-7">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming-encodedbodysize">performanceResourceTiming.encodedBodySize</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-1">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-ä¸­çš„åº”ç”¨">Node.js ä¸­çš„åº”ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-8">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming-decodedbodysize">performanceResourceTiming.decodedBodySize</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-7">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-6">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceresourcetiming-tojson">performanceResourceTiming.toJSON()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-3">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-performanceobserver">Class: PerformanceObserver</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-performanceobserver">å¦‚ä½•ä½¿ç”¨ PerformanceObserver</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-4">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceobserver-supportedentrytypes">PerformanceObserver.supportedEntryTypes</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceobserver-ç®€ä»‹">PerformanceObserver ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#supportedentrytypes-å±æ€§">supportedEntryTypes å±æ€§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-3">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#new-performanceobserver-callback">new PerformanceObserver(callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-2">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨æ–¹å¼">ä½¿ç”¨æ–¹å¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-12">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceobserver-disconnect">performanceObserver.disconnect()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-å’Œæ€§èƒ½ç›‘æµ‹">Node.js å’Œæ€§èƒ½ç›‘æµ‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceobserver">PerformanceObserver</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-performanceobserver-disconnect">ä½¿ç”¨ performanceObserver.disconnect()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceobserver-observe-options">performanceObserver.observe(options)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-3">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ç¤ºä¾‹-1">ä½¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-9">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-performanceobserverentrylist">Class: PerformanceObserverEntryList</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceobserverentrylist-ç®€ä»‹">PerformanceObserverEntryList ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸»è¦æ–¹æ³•">ä¸»è¦æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-13">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceobserverentrylist-getentries">performanceObserverEntryList.getEntries()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-4">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-14">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-7">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceobserverentrylist-getentriesbyname-name-type">performanceObserverEntryList.getEntriesByName(name[, type])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-2">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-4">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#performanceobserverentrylist-getentriesbytype-type">performanceObserverEntryList.getEntriesByType(type)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-8">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#perf-hooks-createhistogram-options">perf_hooks.createHistogram([options])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-perf-hooks-createhistogram-options">ä½¿ç”¨ perf_hooks.createHistogram([options])</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#perf-hooks-monitoreventloopdelay-options">perf_hooks.monitorEventLoopDelay([options])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#äº‹ä»¶å¾ªç¯-event-loop">äº‹ä»¶å¾ªç¯(Event Loop)ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç›‘æ§äº‹ä»¶å¾ªç¯å»¶è¿Ÿ">ç›‘æ§äº‹ä»¶å¾ªç¯å»¶è¿Ÿï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°-1">å‚æ•°ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼">è¿”å›å€¼ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-15">å®é™…è¿ç”¨ä¾‹å­ï¼š</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-histogram">Class: Histogram</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-5">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨å®ä¾‹">å®é™…è¿ç”¨å®ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-10">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-count">histogram.count</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-count-1">histogram.count</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-16">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-countbigint">histogram.countBigInt</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-å’Œæ€§èƒ½ç›‘è§†">Node.js å’Œæ€§èƒ½ç›‘è§†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histograms">Histograms</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-countbigint-åŠŸèƒ½">histogram.countBigInt åŠŸèƒ½</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¸¾ä¾‹-1">å®é™…åº”ç”¨ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-exceeds">histogram.exceeds</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-exceeds-1">histogram.exceeds</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-exceedsbigint">histogram.exceedsBigInt</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-6">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-exceedsbigint-1">histogram.exceedsBigInt</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-max">histogram.max</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç›´æ–¹å›¾-histogram-ç®€ä»‹">ç›´æ–¹å›¾ï¼ˆHistogramï¼‰ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-ä¸­çš„-histogram-å¯¹è±¡">Node.js ä¸­çš„ Histogram å¯¹è±¡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-max-1">Histogram.max</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-histogram-max">å¦‚ä½•ä½¿ç”¨ Histogram.max</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-maxbigint">histogram.maxBigInt</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¸¾ä¾‹-2">å®é™…åº”ç”¨ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-mean">histogram.mean</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç›´æ–¹å›¾-histogram">ç›´æ–¹å›¾ï¼ˆHistogramï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-mean-1">Histogram.mean</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-6">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-min">histogram.min</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-histogram">ä»€ä¹ˆæ˜¯ Histogramï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-min-å±æ€§">histogram.min å±æ€§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-7">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-minbigint">histogram.minBigInt</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç›´è§‚ç†è§£-histogram-ç›´æ–¹å›¾">ç›´è§‚ç†è§£ Histogramï¼ˆç›´æ–¹å›¾ï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-bigint">ä»€ä¹ˆæ˜¯ BigInt</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-minbigint-çš„ä½œç”¨">histogram.minBigInt çš„ä½œç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-17">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-percentile-percentile">histogram.percentile(percentile)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-percentilebigint-percentile">histogram.percentileBigInt(percentile)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£ç›´æ–¹å›¾å’Œç™¾åˆ†ä½">ç†è§£ç›´æ–¹å›¾å’Œç™¾åˆ†ä½</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-percentilebigint-percentile">ä½¿ç”¨ percentileBigInt(percentile)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-percentiles">histogram.percentiles</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#èƒŒæ™¯-1">èƒŒæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histograms-å’Œ-percentiles">Histograms å’Œ Percentiles</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-histogram-percentiles">å¦‚ä½•ä½¿ç”¨ histogram.percentiles()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-18">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-percentilesbigint">histogram.percentilesBigInt</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-performance-hooks-æ¨¡å—">1. Performance Hooks æ¨¡å—ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-ç›´æ–¹å›¾-histogram">2. ç›´æ–¹å›¾ï¼ˆHistogramï¼‰ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-percentilesbigint-1">histogram.percentilesBigIntï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨å®ä¾‹">å®é™…åº”ç”¨å®ä¾‹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-reset">histogram.reset()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£-histogram">ç†è§£ Histogram</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨histogram-reset">ä½¿ç”¨histogram.reset()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-10">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-5">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-stddev">histogram.stddev</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç›´æ–¹å›¾-histogram-æ˜¯ä»€ä¹ˆ">ç›´æ–¹å›¾ï¼ˆHistogramï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ ‡å‡†å·®-standard-deviation-æ˜¯ä»€ä¹ˆ">æ ‡å‡†å·®ï¼ˆStandard Deviationï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-stddev-çš„ä½œç”¨">histogram.stddev çš„ä½œç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-2">å®é™…ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-intervalhistogram-extends-histogram">Class: IntervalHistogram extends Histogram</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-ç›´æ–¹å›¾">Histogramï¼ˆç›´æ–¹å›¾ï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-ä¸­çš„-histogram">Node.js ä¸­çš„ Histogram</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#intervalhistogram">IntervalHistogram</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-11">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-11">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-disable">histogram.disable()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-disable-æ–¹æ³•ç®€ä»‹">histogram.disable() æ–¹æ³•ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-12">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-12">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-enable">histogram.enable()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-19">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cloning-an-intervalhistogram">Cloning an IntervalHistogram</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-intervalhistogram">ä»€ä¹ˆæ˜¯ IntervalHistogramï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å…‹éš†-intervalhistogram-çš„æ„ä¹‰">å…‹éš† IntervalHistogram çš„æ„ä¹‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•å…‹éš†">å¦‚ä½•å…‹éš†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-13">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-recordablehistogram-extends-histogram">Class: RecordableHistogram extends Histogram</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-ç®€ä»‹">Node.js ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç›´æ–¹å›¾-histogram-1">ç›´æ–¹å›¾ï¼ˆHistogramï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#recordablehistogram-çš„ç†è§£">RecordableHistogram çš„ç†è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-13">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-add-other">histogram.add(other)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-20">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-record-val">histogram.record(val)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-histogram-ç›´æ–¹å›¾">1. Histogram (ç›´æ–¹å›¾)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-node-js-çš„-perf-hooks-æ¨¡å—">2. Node.js çš„ perf_hooks æ¨¡å—</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-record-val-è§£é‡Š">Histogram.record(val) è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-14">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-recorddelta">histogram.recordDelta()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#histogram-recorddelta-1">histogram.recordDelta()</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#examples">Examples</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´-2">1. æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-ä½¿ç”¨-performanceobserver-ç›‘å¬æ€§èƒ½æŒ‡æ ‡">2. ä½¿ç”¨ PerformanceObserver ç›‘å¬æ€§èƒ½æŒ‡æ ‡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è¯­">ç»“è¯­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#measuring-the-duration-of-async-operations">Measuring the duration of async operations</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¼‚æ­¥æ“ä½œæ˜¯ä»€ä¹ˆ">å¼‚æ­¥æ“ä½œæ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-ä¸­æµ‹é‡å¼‚æ­¥æ“ä½œæŒç»­æ—¶é—´çš„é‡è¦æ€§">Node.js ä¸­æµ‹é‡å¼‚æ­¥æ“ä½œæŒç»­æ—¶é—´çš„é‡è¦æ€§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•åœ¨-node-js-v21-7-1-ä¸­æµ‹é‡">å¦‚ä½•åœ¨ Node.js v21.7.1 ä¸­æµ‹é‡ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åº”ç”¨å®ä¾‹">åº”ç”¨å®ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#measuring-how-long-it-takes-to-load-dependencies">Measuring how long it takes to load dependencies</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£perf-hooks">ç†è§£perf_hooks</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ­¥éª¤ä¸ä¾‹å­">æ­¥éª¤ä¸ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨åœºæ™¯">å®é™…è¿ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#measuring-how-long-one-http-round-trip-takes">Measuring how long one HTTP round-trip takes</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€æ¦‚å¿µ">åŸºç¡€æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®è·µç¤ºä¾‹">å®è·µç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-14">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ‰©å±•åº”ç”¨">æ‰©å±•åº”ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#measuring-how-long-the-net-connect-only-for-tcp-takes-when-the-connection-is-successful">Measuring how long the net.connect (only for TCP) takes when the connection is successful</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-tcp-å’Œ-net-connect">ä»€ä¹ˆæ˜¯ TCP å’Œ net.connectï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æµ‹é‡è¿æ¥æ—¶é—´">æµ‹é‡è¿æ¥æ—¶é—´</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•è¿›è¡Œæµ‹é‡">å¦‚ä½•è¿›è¡Œæµ‹é‡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-8">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#measuring-how-long-the-dns-takes-when-the-request-is-successful">Measuring how long the DNS takes when the request is successful</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-8">å¦‚ä½•ä½¿ç”¨ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-21">å®é™…è¿ç”¨ä¾‹å­ï¼š</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="performance-measurement-apis" tabindex="-1"><a class="header-anchor" href="#performance-measurement-apis"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performance-measurement-apis" target="_blank" rel="noopener noreferrer">Performance measurement APIs</a></span></a></h1><p>Node.js v21.7.1 ä¸­çš„æ€§èƒ½æµ‹é‡ API ä¸»è¦æ˜¯æŒ‡<code>perf_hooks</code>æ¨¡å—ï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—çš„å·¥å…·ï¼Œä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿæµ‹é‡åœ¨ Node.js åº”ç”¨ç¨‹åºä¸­è¿è¡Œçš„ä»£ç çš„æ€§èƒ½ã€‚è¿™ä¸ªæ¨¡å—å¯ä»¥å¸®åŠ©ä½ ç†è§£ä»£ç çš„æ‰§è¡Œæ—¶é—´ï¼Œä»è€Œå¯¹ä»£ç è¿›è¡Œä¼˜åŒ–ã€‚ä¸‹é¢ï¼Œæˆ‘å°†ç®€å•ä»‹ç»å‡ ä¸ªä¸»è¦çš„åŠŸèƒ½ï¼Œå¹¶ä¸”é€šè¿‡å®ä¾‹æ¥è¯´æ˜å®ƒä»¬çš„åº”ç”¨ã€‚</p><h3 id="_1-performance-mark-å’Œ-performance-measure" tabindex="-1"><a class="header-anchor" href="#_1-performance-mark-å’Œ-performance-measure"><span>1. <code>performance.mark()</code> å’Œ <code>performance.measure()</code></span></a></h3><p>è¿™ä¸¤ä¸ª API ç”¨äºæ ‡è®°æ—¶é—´ç‚¹å’Œæµ‹é‡ä¸¤ä¸ªæ—¶é—´ç‚¹ä¹‹é—´çš„é—´éš”ã€‚</p><ul><li><strong><code>performance.mark()</code></strong> ç”¨æ¥æ ‡è®°ä¸€ä¸ªæ—¶é—´ç‚¹ã€‚ä½ å¯ä»¥ç»™è¿™ä¸ªæ ‡è®°ä¸€ä¸ªåå­—ï¼Œä»¥ä¾¿ä¹‹åå¼•ç”¨ã€‚</li><li><strong><code>performance.measure()</code></strong> ç”¨æ¥æµ‹é‡ä¸¤ä¸ªæ ‡è®°ä¹‹é—´çš„æ—¶é—´å·®ã€‚</li></ul><p><strong>å®ä¾‹åº”ç”¨</strong>ï¼š<br> å‡è®¾ä½ æƒ³è¦æµ‹é‡ä¸€ä¸ªæ•°æ®å¤„ç†å‡½æ•°çš„æ‰§è¡Œæ—¶é—´ï¼Œä½ å¯ä»¥åœ¨å‡½æ•°æ‰§è¡Œå‰ååˆ†åˆ«ä½¿ç”¨<code>performance.mark()</code>æ¥æ ‡è®°å¼€å§‹å’Œç»“æŸï¼Œç„¶åç”¨<code>performance.measure()</code>æ¥è®¡ç®—è¿™ä¸¤ä¸ªç‚¹ä¹‹é—´çš„æ—¶é—´å·®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start-process&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">//Le document provient de Ying Chao Tea. Ne pas utiliser Ã  des fins commerciales.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™é‡Œæ˜¯ä¸€äº›æ•°æ®å¤„ç†é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end-process&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Processing time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start-process&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end-process&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> measure</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntriesByName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Processing time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ•°æ®å¤„ç†ç”¨æ—¶ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">measure</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-performanceobserver" tabindex="-1"><a class="header-anchor" href="#_2-performanceobserver"><span>2. <code>PerformanceObserver</code></span></a></h3><p><code>PerformanceObserver</code>ç±»ç”¨äºå¼‚æ­¥åœ°æ”¶é›†æ€§èƒ½ç›¸å…³çš„äº‹ä»¶ã€‚å½“é€šè¿‡<code>performance.mark()</code>æˆ–<code>performance.measure()</code>è®°å½•æ€§èƒ½æ•°æ®æ—¶ï¼Œ<code>PerformanceObserver</code>å¯ä»¥è¢«ç”¨æ¥æ•è·è¿™äº›æ•°æ®ã€‚</p><p><strong>å®ä¾‹åº”ç”¨</strong>ï¼š<br> ä½ å¯ä»¥ä½¿ç”¨<code>PerformanceObserver</code>æ¥ç›‘å¬ç‰¹å®šç±»å‹çš„æ€§èƒ½æ¡ç›®ï¼Œæ¯”å¦‚æµ‹é‡ç»“æœï¼Œç„¶åå¯¹è¿™äº›ç»“æœåšä¸€äº›å¤„ç†æˆ–è€…è¾“å‡ºã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> observer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffered</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><strong>æ€§èƒ½è°ƒä¼˜</strong>ï¼šé€šè¿‡ä½¿ç”¨<code>perf_hooks</code>æ¨¡å—ï¼Œä½ å¯ä»¥è¯¦ç»†äº†è§£åˆ°å“ªäº›éƒ¨åˆ†çš„ä»£ç æ‰§è¡Œæ—¶é—´è¾ƒé•¿ï¼Œæ®æ­¤è¿›è¡Œä¼˜åŒ–ï¼Œæ¯”å¦‚å‡å°‘ä¸å¿…è¦çš„è®¡ç®—ï¼Œæˆ–è€…æ”¹è¿›ç®—æ³•ã€‚</li><li><strong>ç›‘æ§</strong>ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œé€šè¿‡å®šæœŸæµ‹é‡å’Œè®°å½•å…³é”®æ“ä½œçš„æ€§èƒ½ï¼Œå¯ä»¥åŠæ—¶å‘ç°æ€§èƒ½ä¸‹é™çš„é—®é¢˜ï¼Œä»è€Œå¿«é€Ÿå“åº”å’Œè§£å†³ã€‚</li><li><strong>åŸºå‡†æµ‹è¯•</strong>ï¼šåœ¨å¼•å…¥æ–°çš„åº“æˆ–è€…æ”¹åŠ¨ä»£ç ä¹‹å‰ï¼Œé€šè¿‡åŸºå‡†æµ‹è¯•æ¯”è¾ƒæ€§èƒ½å·®å¼‚ï¼Œç¡®ä¿æ”¹åŠ¨ä¸ä¼šå¯¹æ€§èƒ½äº§ç”Ÿè´Ÿé¢å½±å“ã€‚</li></ol><p>é€šè¿‡è¿™äº›åŠŸèƒ½å’Œå®ä¾‹åº”ç”¨ï¼Œä½ å¯ä»¥æ›´å¥½åœ°ç†è§£ Node.js ä¸­çš„æ€§èƒ½æµ‹é‡ APIs å¦‚ä½•å¸®åŠ©ä½ ç›‘æ§å’Œæå‡ä½ çš„åº”ç”¨æ€§èƒ½ã€‚</p><h2 id="perf-hooks-performance" tabindex="-1"><a class="header-anchor" href="#perf-hooks-performance"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#perf_hooksperformance" target="_blank" rel="noopener noreferrer">perf_hooks.performance</a></span></a></h2><p>åœ¨ Node.js ä¸­ï¼Œ<code>perf_hooks.performance</code> æ˜¯ä¸€ä¸ªæä¾›æ€§èƒ½ç›‘æµ‹å·¥å…·çš„æ¨¡å—ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿæµ‹é‡å’Œåˆ†æä»£ç çš„æ‰§è¡Œæ—¶é—´ã€‚è¿™ä¸ªæ¨¡å—æ˜¯å—æµè§ˆå™¨çš„ Performance API å¯å‘ï¼Œå¹¶è¯•å›¾æä¾›ä¸€ä¸ªç›¸ä¼¼çš„æ¥å£ã€‚åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>perf_hooks.performance</code> çš„ä½¿ç”¨å’Œç‰¹æ€§ä¿æŒäº†ä¸ä¹‹å‰ç‰ˆæœ¬çš„ä¸€è‡´æ€§ï¼Œä½†å¯èƒ½åŒ…å«äº†ä¸€äº›æ€§èƒ½æ”¹è¿›å’Œ bug ä¿®å¤ã€‚</p><h3 id="åŸºæœ¬ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ä½¿ç”¨"><span>åŸºæœ¬ä½¿ç”¨</span></a></h3><p><code>perf_hooks.performance</code> åŒ…å«å‡ ä¸ªå…³é”®åŠŸèƒ½ï¼Œæœ€å¸¸ç”¨çš„å¯èƒ½æ˜¯ <code>performance.now()</code> æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªä»£è¡¨å½“å‰æ—¶é—´çš„é«˜ç²¾åº¦æ—¶é—´æˆ³ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ï¼Œå¹¶ä¸”è¿™ä¸ªæ—¶é—´æˆ³çš„ç²¾åº¦å¯ä»¥è¾¾åˆ°å¾®ç§’çº§ã€‚è¿™å¯¹äºæµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´æ¥è¯´éå¸¸æœ‰ç”¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰§è¡Œä¸€äº›æ“ä½œ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ“ä½œè€—æ—¶ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­"><span>å®é™…ä¾‹å­</span></a></h3><ol><li><strong>æµ‹é‡å¼‚æ­¥æ“ä½œçš„è€—æ—¶</strong>ï¼šå‡è®¾ä½ æƒ³è¦æµ‹é‡ä¸€ä¸ªä»ç½‘ç»œ API è·å–æ•°æ®çš„å¼‚æ­¥æ“ä½œéœ€è¦å¤šä¹…æ—¶é—´å®Œæˆã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fetch</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node-fetch&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ ä½¿ç”¨ node-fetch æ¥è¿›è¡Œç½‘ç»œè¯·æ±‚</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https://api.example.com/data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">response</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> response</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">json</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è·å–æ•°æ®è€—æ—¶ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>æ¯”è¾ƒä¸¤ç§ç®—æ³•çš„æ€§èƒ½</strong>ï¼šå¦‚æœä½ æœ‰ä¸¤ç§ä¸åŒçš„ç®—æ³•æˆ–å‡½æ•°æ¥è§£å†³åŒä¸€ä¸ªé—®é¢˜ï¼Œä½ å¯èƒ½æƒ³æ¯”è¾ƒå®ƒä»¬çš„æ€§èƒ½ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> algorithm1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å®ç°ç®—æ³•1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> algorithm2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å®ç°ç®—æ³•2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">algorithm1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> end1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">algorithm2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> end2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`ç®—æ³•1è€—æ—¶ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">end1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start1</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`ç®—æ³•2è€—æ—¶ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">end2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start2</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>ç›‘æ§äº‹ä»¶å¾ªç¯çš„å»¶è¿Ÿ</strong>ï¼šNode.js è¿˜æä¾›äº†ä¸€ä¸ª <code>performance.eventLoopUtilization()</code> æ–¹æ³•ï¼Œå®ƒå¯ä»¥ç”¨æ¥ç›‘æ§äº‹ä»¶å¾ªç¯çš„å»¶è¿Ÿå’Œåˆ©ç”¨ç‡ï¼Œè¿™å¯¹äºç†è§£åº”ç”¨çš„æ€§èƒ½çŠ¶å†µéå¸¸æœ‰å¸®åŠ©ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> elu1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">eventLoopUtilization</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// äº‹ä»¶å¾ªç¯æ‰§è¡Œä¸€äº›ä»»åŠ¡...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> elu2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">eventLoopUtilization</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">elu1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`äº‹ä»¶å¾ªç¯åˆ©ç”¨ç‡ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">elu2</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">utilization</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">%`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™äº›å·¥å…·å’Œæ–¹æ³•ä½¿å¾—åœ¨ Node.js åº”ç”¨ä¸­è¿›è¡Œç²¾ç¡®çš„æ€§èƒ½ç›‘æµ‹å’Œåˆ†ææˆä¸ºå¯èƒ½ï¼Œå¸®åŠ©å¼€å‘è€…ä¼˜åŒ–ä»£ç å’Œæ”¹è¿›åº”ç”¨æ€§èƒ½ã€‚</p><h3 id="performance-clearmarks-name" tabindex="-1"><a class="header-anchor" href="#performance-clearmarks-name"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceclearmarksname" target="_blank" rel="noopener noreferrer">performance.clearMarks([name])</a></span></a></h3><p>ç†è§£ <code>performance.clearMarks([name])</code> åŠŸèƒ½ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç®€å•äº†è§£ä¸‹ Node.js ä¸­çš„ Performance API å’Œå®ƒå¦‚ä½•å¸®åŠ©æˆ‘ä»¬ç›‘æµ‹ä»£ç æ€§èƒ½ã€‚</p><p>åœ¨ Node.jsï¼ˆä¹Ÿé€‚ç”¨äºç°ä»£æµè§ˆå™¨ï¼‰ä¸­ï¼ŒPerformance API æä¾›äº†ä¸€ä¸ªç®€å•è€Œåˆå¼ºå¤§çš„æ–¹å¼æ¥æµ‹é‡å’Œç›‘æ§ä½ çš„åº”ç”¨ç¨‹åºçš„è¿è¡Œæ—¶é—´æ€§èƒ½ã€‚è¿™ä¸ª API ä¹‹ä¸­ï¼Œâ€œmarksâ€æ˜¯ä¸€ç§ç‰¹æ®Šçš„å·¥å…·ï¼Œä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¹¦ç­¾æˆ–è€…é‡Œç¨‹ç¢‘ï¼Œå®ƒä»¬æ ‡è®°äº†ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­çš„ç‰¹å®šç‚¹ã€‚</p><p>å½“ä½ è°ƒç”¨ <code>performance.mark(&#39;someMarkName&#39;)</code>æ—¶ï¼Œå®é™…ä¸Šæ˜¯åœ¨è¯´ï¼šâ€œå˜¿ï¼Œè®°å½•ä¸€ä¸‹æ­¤åˆ»çš„æ—¶é—´æˆ³ï¼Œæˆ‘å¯èƒ½ç¨åä¼šéœ€è¦å®ƒã€‚â€ è¿™æ ·åšå¯ä»¥å¸®åŠ©ä½ æµ‹é‡ä»£ç å—ã€å‡½æ•°æˆ–ä»»ä½•å…¶ä»–æ“ä½œçš„æ‰§è¡Œæ—¶é—´ã€‚</p><p>ç°åœ¨ï¼Œæ¥åˆ°ä½ çš„é—®é¢˜ â€”â€” <code>performance.clearMarks([name])</code> æ˜¯åšä»€ä¹ˆçš„å‘¢ï¼Ÿ</p><p>ç®€å•æ¥è¯´ï¼Œ<code>performance.clearMarks([name])</code> è®©ä½ æœ‰æœºä¼šâ€œæ¸…é™¤â€ä¹‹å‰è®¾ç½®çš„ä¸€ä¸ªæˆ–æ‰€æœ‰ marksã€‚å¦‚æœä½ æä¾›äº†ä¸€ä¸ªç‰¹å®šçš„ mark åç§°ï¼ˆå³ <code>[name]</code> å‚æ•°ï¼‰ï¼Œé‚£ä¹ˆåªæœ‰è¿™ä¸ªç‰¹å®šçš„ mark ä¼šè¢«æ¸…é™¤ã€‚å¦‚æœä½ æ²¡æœ‰æä¾›ä»»ä½•å‚æ•°ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„ marks éƒ½å°†è¢«æ¸…é™¤ã€‚</p><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>è®©æˆ‘ä»¬é€šè¿‡å‡ ä¸ªæ­¥éª¤çœ‹çœ‹å¦‚ä½•å®é™…ä½¿ç”¨è¿™äº›åŠŸèƒ½ï¼š</p><h4 id="_1-æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´" tabindex="-1"><a class="header-anchor" href="#_1-æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´"><span>1. æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œå¹¶æƒ³è¦æµ‹é‡ä¸€ä¸ªæ•°æ®å¤„ç†å‡½æ•°çš„æ‰§è¡Œæ—¶é—´ã€‚ä½ å¯èƒ½ä¼šè¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;perf_hooks&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ‡è®°å¼€å§‹ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;startProcess&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä½ çš„æ•°æ®å¤„ç†å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> processData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ¨¡æ‹Ÿæ•°æ®å¤„ç†è€—æ—¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">processData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ‡è®°ç»“æŸç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;endProcess&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¡ç®—å¹¶è¾“å‡ºä¸¤ä¸ªæ ‡è®°ä¹‹é—´çš„æ—¶é—´å·®ï¼Œä¹Ÿå°±æ˜¯å¤„ç†å‡½æ•°çš„æ‰§è¡Œæ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> measure</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;processTime&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;startProcess&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;endProcess&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-æ¸…é™¤-marks" tabindex="-1"><a class="header-anchor" href="#_2-æ¸…é™¤-marks"><span>2. æ¸…é™¤ Marks</span></a></h4><p>ç°åœ¨ï¼Œå‡è®¾ä½ åœ¨å¼€å‘è¿‡ç¨‹ä¸­å®Œæˆäº†å¯¹è¿™ä¸ªå‡½æ•°çš„æµ‹è¯•ï¼Œå¹¶ä¸”ä¸å†éœ€è¦è¿™äº› mark äº†ã€‚æˆ–è€…ï¼Œå‡ºäºæŸç§åŸå› ï¼Œä½ æƒ³è¦é‡å¤æµ‹è¯•ä½†éœ€è¦æ¸…é™¤æ—§çš„ marksã€‚è¿™æ—¶å€™ï¼Œ<code>performance.clearMarks()</code> å°±æ´¾ä¸Šç”¨åœºäº†ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¸…é™¤ç‰¹å®šçš„ mark</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clearMarks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;startProcess&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clearMarks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;endProcess&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ–è€…ï¼Œæ¸…é™¤æ‰€æœ‰ marks</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clearMarks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ï¼Œä½ å°±å¯ä»¥åœ¨ä¸å¹²æ‰°ä¹‹å‰çš„æ€§èƒ½æ ‡è®°æƒ…å†µä¸‹è¿›è¡Œæ–°çš„æµ‹è¯•æˆ–æµ‹é‡ã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œ<code>performance.clearMarks([name])</code> åœ¨æ€§èƒ½æµ‹é‡ä¸ç›‘æ§æ–¹é¢æä¾›äº†çµæ´»æ€§ï¼Œä½¿å¾—ä½ èƒ½å¤Ÿåœ¨ä¸åŒé˜¶æ®µæ ¹æ®éœ€è¦æ¸…ç†æ€§èƒ½æ ‡è®°ï¼Œä»è€Œä¿æŒä½ çš„æµ‹è¯•ç¯å¢ƒæ•´æ´ä¸”å¯ç®¡ç†ã€‚</p><h3 id="performance-clearmeasures-name" tabindex="-1"><a class="header-anchor" href="#performance-clearmeasures-name"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceclearmeasuresname" target="_blank" rel="noopener noreferrer">performance.clearMeasures([name])</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘ä¼šç›´æ¥è¿›å…¥ä¸»é¢˜ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>performance.clearMeasures([name])</code> æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå±äºæ€§èƒ½ç›‘æµ‹ï¼ˆPerformanceï¼‰API çš„ä¸€éƒ¨åˆ†ã€‚è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯æ¸…é™¤å­˜å‚¨åœ¨æ€§èƒ½æ¡ç›®ç¼“å†²åŒºä¸­çš„â€œmeasureâ€ç±»å‹çš„æ€§èƒ½è®°å½•ã€‚åœ¨è§£é‡Šè¿™ä¸ªå‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç†è§£å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p><ol><li><p><strong>Performance API</strong>ï¼šè¿™æ˜¯ Web å’Œ Node.js æä¾›çš„ä¸€ä¸ª APIï¼Œå®ƒå…è®¸ä½ è·å–åˆ°é«˜ç²¾åº¦çš„æ—¶é—´åº¦é‡ï¼Œä»¥ä¾¿äºè¡¡é‡ä»£ç è¿è¡Œæ•ˆç‡å’Œæ€§èƒ½ã€‚åœ¨ Node.js ä¸­ï¼Œè¿™ä¸ª API é€šè¿‡ <code>perf_hooks</code> æ¨¡å—æ¥ä½¿ç”¨ã€‚</p></li><li><p><strong>performance.mark()</strong>ï¼šè¿™æ˜¯ Performance API çš„ä¸€éƒ¨åˆ†ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥æ ‡è®°ä¸€ä¸ªæ—¶é—´ç‚¹ï¼ˆç§°ä¸ºä¸€ä¸ª&quot;mark&quot;ï¼‰ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½æƒ³è¦è®°å½•ä¸€ä¸ªæ“ä½œå¼€å§‹çš„æ—¶é—´ç‚¹ã€‚</p></li><li><p><strong>performance.measure()</strong>ï¼šè¿™ä¹Ÿæ˜¯ Performance API çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªåä¸º â€œmeasureâ€ çš„æ—¶é—´é—´éš”ã€‚è¿™ä¸ªæ–¹æ³•é€šå¸¸éœ€è¦ä¸¤ä¸ª markï¼ˆèµ·å§‹ç‚¹å’Œç»“æŸç‚¹ï¼‰ï¼Œå®ƒä¼šè®¡ç®—å¹¶è®°å½•ä¸¤ä¸ª mark ä¹‹é—´çš„æ—¶é—´å·®ã€‚</p></li><li><p><strong>performance.getEntriesByType(&#39;measure&#39;)</strong>ï¼šæ­¤æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«æ‰€æœ‰ç±»å‹ä¸º &quot;measure&quot; çš„æ€§èƒ½è®°å½•ã€‚</p></li></ol><p>ç°åœ¨æ¥çœ‹ <code>performance.clearMeasures([name])</code> å‡½æ•°ã€‚å¦‚æœä½ å·²ç»åˆ›å»ºäº†å¤šä¸ª measure æ¡ç›®å¹¶æƒ³è¦æ¸…é™¤å®ƒä»¬ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°ã€‚å®ƒå¯ä»¥æœ‰é€‰æ‹©åœ°æ¸…é™¤ç‰¹å®šåç§°çš„ measure æˆ–è€…å…¨éƒ¨æ¸…é™¤ã€‚</p><p><strong>ä½¿ç”¨ä¾‹å­ï¼š</strong></p><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œä½ æƒ³è¦æµ‹é‡ä¸€ä¸ªå‡½æ•°æ‰§è¡Œæ‰€éœ€çš„æ—¶é—´ã€‚ä½ å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ‡è®°å¼€å§‹æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;startFunction&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰§è¡Œä½ çš„å‡½æ•°æˆ–ä»»ä½•è¦æµ‹é‡çš„ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬è¿™é‡Œæœ‰ä¸€ä¸ª setTimeout æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ ‡è®°ç»“æŸæ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;endFunction&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹é‡å¼€å§‹å’Œç»“æŸä¹‹é—´çš„æ—¶é—´å·®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Function Duration&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;startFunction&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;endFunction&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è·å–æµ‹é‡ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> measures</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntriesByType</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">measures</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ¸…é™¤æµ‹é‡ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clearMeasures</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Function Duration&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ç¡®è®¤å·²ç»æ¸…é™¤</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> measuresAfterClear</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntriesByType</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">measuresAfterClear</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åº”è¯¥æ˜¾ç¤ºä¸ºç©ºæ•°ç»„ï¼Œå› ä¸ºå·²ç»è¢«æ¸…é™¤äº†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå®šä¹‰äº†ä¸¤ä¸ª markï¼ˆstartFunction å’Œ endFunctionï¼‰ï¼Œç„¶åä½¿ç”¨ <code>performance.measure()</code> æ–¹æ³•æ¥è®¡ç®—å®ƒä»¬ä¹‹é—´çš„æ—¶é—´å·®ï¼Œå¹¶å°†è¿™ä¸ªæ—¶é—´å·®ä½œä¸ºä¸€ä¸ªåä¸º &#39;Function Duration&#39; çš„ measure æ¡ç›®ä¿å­˜ä¸‹æ¥ã€‚æ¥ç€æˆ‘ä»¬æ‰“å°å‡ºäº†æ‰€æœ‰ç±»å‹ä¸º &quot;measure&quot; çš„æ€§èƒ½è®°å½•ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>performance.clearMeasures(&#39;Function Duration&#39;)</code> æ¥æ¸…é™¤åç§°ä¸º &#39;Function Duration&#39; çš„ measure æ¡ç›®ï¼Œå¹¶ç¡®è®¤é€šè¿‡ <code>getEntriesByType(&#39;measure&#39;)</code> è¿”å›çš„æ•°ç»„ä¸ºç©ºï¼Œè¡¨ç¤ºæ¸…é™¤æˆåŠŸã€‚</p><h3 id="performance-clearresourcetimings-name" tabindex="-1"><a class="header-anchor" href="#performance-clearresourcetimings-name"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceclearresourcetimingsname" target="_blank" rel="noopener noreferrer">performance.clearResourceTimings([name])</a></span></a></h3><p>Node.js ä¸­çš„ <code>performance.clearResourceTimings([name])</code> æ–¹æ³•æ˜¯ä¸€ä¸ªç”¨æ¥ç®¡ç†å’Œç›‘æ§ Node.js åº”ç”¨æ€§èƒ½çš„å·¥å…·ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒå±äº <code>perf_hooks</code> æ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—æä¾›äº†ä¸€ç³»åˆ—çš„é’©å­ï¼ˆhooksï¼‰å’Œå·¥å…·ï¼Œç”¨äºæµ‹é‡å’Œç›‘æ§åº”ç”¨çš„è¿è¡Œæ€§èƒ½ã€‚<code>performance.clearResourceTimings([name])</code> æ–¹æ³•çš„ä½œç”¨æ˜¯æ¸…é™¤å·²ç»è®°å½•çš„èµ„æºåŠ è½½æ—¶é—´æ•°æ®ã€‚è¿™å¯¹äºæ§åˆ¶æ€§èƒ½æ•°æ®çš„å¤§å°å’Œç®¡ç†æ€§èƒ½ç›‘æ§æ•°æ®çš„ç”Ÿå‘½å‘¨æœŸéå¸¸æœ‰ç”¨ã€‚</p><h3 id="å‚æ•°è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><strong><code>name</code></strong>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ã€‚å¦‚æœæŒ‡å®šäº† <code>name</code>ï¼Œé‚£ä¹ˆåªæœ‰ä¸è¯¥ <code>name</code> ç›¸åŒ¹é…çš„èµ„æºæ—¶é—´æ•°æ®ä¼šè¢«æ¸…é™¤ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®š <code>name</code>ï¼Œé‚£ä¹ˆæ‰€æœ‰èµ„æºæ—¶é—´æ•°æ®éƒ½ä¼šè¢«æ¸…é™¤ã€‚</li></ul><h3 id="ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹"><span>ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹</span></a></h3><h4 id="_1-ç½‘ç»œè¯·æ±‚ç›‘æ§" tabindex="-1"><a class="header-anchor" href="#_1-ç½‘ç»œè¯·æ±‚ç›‘æ§"><span>1. ç½‘ç»œè¯·æ±‚ç›‘æ§</span></a></h4><p>å‡è®¾ä½ çš„ Node.js åº”ç”¨éœ€è¦é¢‘ç¹åœ°å‘ç¬¬ä¸‰æ–¹æœåŠ¡å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶ä¸”ä½ æƒ³è¦ç›‘æ§è¿™äº›è¯·æ±‚çš„æ€§èƒ½ï¼Œæ¯”å¦‚è¯·æ±‚çš„å‘é€åˆ°æ”¶åˆ°å“åº”æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚ä½ å¯ä»¥åœ¨å‘é€è¯·æ±‚å‰åä½¿ç”¨ <code>perf_hooks</code> æ¨¡å—æ¥è®°å½•å’Œæµ‹é‡è¿™æ®µæ—¶é—´ã€‚ç„¶åï¼Œåœ¨æŸä¸ªæ—¶é—´ç‚¹ï¼Œä½ å¯èƒ½æƒ³è¦æ¸…é™¤è¿™äº›è®°å½•çš„æ•°æ®ï¼Œä»¥é¿å…å†…å­˜çš„æ— é™å¢é•¿ã€‚è¿™æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>performance.clearResourceTimings()</code> æ¥æ¸…é™¤è¿™äº›æ•°æ®ã€‚</p><h4 id="_2-åº”ç”¨æ€§èƒ½åŸºå‡†æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_2-åº”ç”¨æ€§èƒ½åŸºå‡†æµ‹è¯•"><span>2. åº”ç”¨æ€§èƒ½åŸºå‡†æµ‹è¯•</span></a></h4><p>åœ¨è¿›è¡Œåº”ç”¨æ€§èƒ½åŸºå‡†æµ‹è¯•æ—¶ï¼Œä½ å¯èƒ½ä¼šåœ¨æµ‹è¯•çš„ä¸åŒé˜¶æ®µæ”¶é›†æ€§èƒ½æ•°æ®ï¼Œæ¯”å¦‚åº”ç”¨å¯åŠ¨æ—¶é—´ã€æ•°æ®åº“æŸ¥è¯¢å“åº”æ—¶é—´ç­‰ã€‚ä¸ºäº†ä¿è¯æ¯æ¬¡æµ‹è¯•çš„ç‹¬ç«‹æ€§ï¼Œä½ éœ€è¦åœ¨æ¯è½®æµ‹è¯•å¼€å§‹å‰æ¸…é™¤ä¹‹å‰çš„æ€§èƒ½æ•°æ®ã€‚<code>performance.clearResourceTimings([name])</code> æ­£å¥½å¯ä»¥ç”¨æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œç¡®ä¿æ¯æ¬¡æµ‹è¯•éƒ½æ˜¯åœ¨å¹²å‡€çš„ç¯å¢ƒä¸‹è¿›è¡Œï¼Œä»è€Œä½¿æµ‹è¯•ç»“æœæ›´åŠ å‡†ç¡®ã€‚</p><h4 id="_3-åŠ¨æ€å†…å®¹åŠ è½½æ€§èƒ½ç›‘æ§" tabindex="-1"><a class="header-anchor" href="#_3-åŠ¨æ€å†…å®¹åŠ è½½æ€§èƒ½ç›‘æ§"><span>3. åŠ¨æ€å†…å®¹åŠ è½½æ€§èƒ½ç›‘æ§</span></a></h4><p>å¦‚æœä½ çš„ Node.js åº”ç”¨åŒ…å«äº†åŠ¨æ€å†…å®¹åŠ è½½çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æ ¹æ®ç”¨æˆ·çš„æ“ä½œåŠ¨æ€åŠ è½½æ–°çš„æ•°æ®æˆ–æ¨¡å—ï¼Œé‚£ä¹ˆç›‘æ§è¿™éƒ¨åˆ†å†…å®¹åŠ è½½çš„æ€§èƒ½å°±å˜å¾—éå¸¸é‡è¦ã€‚é€šè¿‡åœ¨åŠ è½½ä¹‹å‰å’ŒåŠ è½½ä¹‹åè®°å½•æ—¶é—´ï¼Œä½ å¯ä»¥è·å¾—æ¯æ¬¡åŠ¨æ€åŠ è½½æ“ä½œçš„æ€§èƒ½æ•°æ®ã€‚éšç€åº”ç”¨çš„è¿è¡Œï¼Œè¿™äº›æ•°æ®å¯èƒ½ä¼šé€æ¸ç§¯ç´¯èµ·æ¥ã€‚ä½¿ç”¨ <code>performance.clearResourceTimings()</code> å¯ä»¥åœ¨é€‚å½“çš„æ—¶å€™æ¸…é™¤æ—§çš„æ€§èƒ½æ•°æ®ï¼Œå¸®åŠ©ä½ æ›´æœ‰æ•ˆåœ°ç®¡ç†æ€§èƒ½ç›‘æ§æ•°æ®ã€‚</p><h3 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“"><span>æ€»ç»“</span></a></h3><p><code>performance.clearResourceTimings([name])</code> æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„æ–¹æ³•ï¼Œå®ƒèƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…åœ¨éœ€è¦çš„æ—¶å€™æ¸…é™¤ç‰¹å®šçš„æˆ–æ‰€æœ‰çš„èµ„æºåŠ è½½æ—¶é—´æ•°æ®ã€‚è¿™åœ¨è¿›è¡Œæ€§èƒ½ç›‘æ§ã€åŸºå‡†æµ‹è¯•æˆ–è€…ç®¡ç†åŠ¨æ€å†…å®¹åŠ è½½æ€§èƒ½æ•°æ®æ—¶å°¤å…¶æœ‰ç”¨ã€‚é€šè¿‡æœ‰æ•ˆåœ°ç®¡ç†è¿™äº›æ•°æ®ï¼Œå¯ä»¥é¿å…å†…å­˜çš„æ— é™å¢é•¿ï¼ŒåŒæ—¶ç¡®ä¿æ€§èƒ½æ•°æ®çš„å‡†ç¡®æ€§å’Œå¯ç®¡ç†æ€§ã€‚</p><h3 id="performance-eventlooputilization-utilization1-utilization2" tabindex="-1"><a class="header-anchor" href="#performance-eventlooputilization-utilization1-utilization2"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceeventlooputilizationutilization1-utilization2" target="_blank" rel="noopener noreferrer">performance.eventLoopUtilization([utilization1[, utilization2]])</a></span></a></h3><p>Node.js çš„ <code>performance.eventLoopUtilization()</code> å‡½æ•°æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ äº†è§£äº‹ä»¶å¾ªç¯çš„æ€§èƒ½å’ŒçŠ¶å†µã€‚åœ¨è§£é‡Šè¿™ä¸ªå‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç®€å•å›é¡¾ä¸‹ Node.js çš„äº‹ä»¶å¾ªç¯æ˜¯ä»€ä¹ˆã€‚</p><h3 id="äº‹ä»¶å¾ªç¯ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#äº‹ä»¶å¾ªç¯ç®€ä»‹"><span>äº‹ä»¶å¾ªç¯ç®€ä»‹</span></a></h3><p>Node.js æ˜¯åŸºäºäº‹ä»¶é©±åŠ¨çš„éé˜»å¡ I/O æ¨¡å‹ã€‚åœ¨è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œäº‹ä»¶å¾ªç¯æ˜¯ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒå…è®¸ Node.js æ‰§è¡Œéé˜»å¡æ“ä½œï¼ˆæ¯”å¦‚è¯»å–æ–‡ä»¶ã€ç½‘ç»œè¯·æ±‚ç­‰ï¼‰ï¼Œå³ä½¿ JavaScript æ˜¯å•çº¿ç¨‹çš„ã€‚äº‹ä»¶å¾ªç¯è´Ÿè´£åè°ƒäº‹ä»¶ã€å›è°ƒå‡½æ•°å’Œ I/O æ“ä½œã€‚</p><h3 id="performance-eventlooputilization-å‡½æ•°" tabindex="-1"><a class="header-anchor" href="#performance-eventlooputilization-å‡½æ•°"><span><code>performance.eventLoopUtilization()</code> å‡½æ•°</span></a></h3><p>è¿™ä¸ªå‡½æ•°æä¾›äº†ä¸€ç§æ–¹å¼æ¥ç›‘æ§äº‹ä»¶å¾ªç¯çš„åˆ©ç”¨ç‡ï¼Œå³äº‹ä»¶å¾ªç¯åœ¨æŸæ®µæ—¶é—´å†…çš„å¿™ç¢Œç¨‹åº¦ã€‚å®ƒå¯ä»¥æ¥å—æœ€å¤šä¸¤ä¸ªå‚æ•°ï¼Œéƒ½æ˜¯ä¹‹å‰ä»åŒä¸€ä¸ªå‡½æ•°è°ƒç”¨ä¸­å¾—åˆ°çš„ç»“æœï¼ˆè¿™äº›å‚æ•°æ˜¯å¯é€‰çš„ï¼‰ã€‚</p><p>å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä¸‰ä¸ªå±æ€§ï¼š</p><ul><li><code>idle</code>ï¼šé—²ç½®æ—¶é—´çš„ç™¾åˆ†æ¯”ã€‚</li><li><code>active</code>ï¼šæ´»è·ƒæ—¶é—´çš„ç™¾åˆ†æ¯”ã€‚</li><li><code>utilization</code>ï¼šäº‹ä»¶å¾ªç¯çš„æ€»åˆ©ç”¨ç‡ï¼Œæ˜¯<code>active</code>æ—¶é—´å æ€»æ—¶é—´çš„æ¯”ä¾‹ã€‚</li></ul><h3 id="ä½¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯"><span>ä½¿ç”¨åœºæ™¯</span></a></h3><ol><li><p><strong>æ€§èƒ½ç›‘æ§</strong>ï¼šé€šè¿‡å®šæœŸè°ƒç”¨ <code>performance.eventLoopUtilization()</code>ï¼Œå¯ä»¥ç›‘æ§äº‹ä»¶å¾ªç¯çš„å¥åº·çŠ¶å†µå’Œæ€§èƒ½ã€‚å¦‚æœå‘ç°äº‹ä»¶å¾ªç¯çš„åˆ©ç”¨ç‡å¼‚å¸¸é«˜ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªæ€§èƒ½ç“¶é¢ˆçš„ä¿¡å·ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†æåŸå› ã€‚</p></li><li><p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šåœ¨è¿›è¡Œæ€§èƒ½ä¼˜åŒ–æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥è¯„ä¼°ä¼˜åŒ–å‰åäº‹ä»¶å¾ªç¯çš„åˆ©ç”¨ç‡çš„å˜åŒ–ã€‚è¿™å¯ä»¥å¸®åŠ©ä½ é‡åŒ–ä¼˜åŒ–çš„æ•ˆæœã€‚</p></li><li><p><strong>è°ƒè¯•</strong>ï¼šå½“ä½ é‡åˆ°åº”ç”¨å“åº”æ…¢æˆ–è€…è¡¨ç°å‡ºä¸ç¨³å®šçš„è¡Œä¸ºæ—¶ï¼Œåˆ©ç”¨è¿™ä¸ªå‡½æ•°å¯ä»¥å¸®åŠ©ä½ è¯Šæ–­æ˜¯å¦æ˜¯äº‹ä»¶å¾ªç¯è¿‡è½½é€ æˆçš„é—®é¢˜ã€‚</p></li></ol><h3 id="ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹"><span>ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æƒ³ç›‘æ§ä½ çš„ Node.js åº”ç”¨çš„äº‹ä»¶å¾ªç¯åˆ©ç”¨ç‡ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> lastUtilization</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">eventLoopUtilization</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> currentUtilization</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">eventLoopUtilization</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">lastUtilization</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  lastUtilization</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">eventLoopUtilization</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    `Event Loop Utilization: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">currentUtilization</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">utilization</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toFixed</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç æ¯éš”ä¸€ç§’é’Ÿä¼šè®¡ç®—å¹¶æ‰“å°å‡ºäº‹ä»¶å¾ªç¯çš„åˆ©ç”¨ç‡ã€‚é€šè¿‡æ¯”è¾ƒè¿ç»­ä¸¤æ¬¡æµ‹é‡çš„å·®å¼‚ï¼Œä½ å¯ä»¥å¾—åˆ°è¿‡å»ä¸€ç§’å†…äº‹ä»¶å¾ªç¯çš„åˆ©ç”¨æƒ…å†µã€‚</p><p>è¿™ç§æ–¹å¼éå¸¸ç›´æ¥åœ°åæ˜ äº† Node.js åº”ç”¨çš„è¿è¡ŒçŠ¶å†µï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§é‡å¹¶å‘è¯·æ±‚æ—¶ï¼Œå¯¹äºç¡®ä¿åº”ç”¨çš„é«˜æ€§èƒ½å’Œå“åº”æ€§è‡³å…³é‡è¦ã€‚</p><h3 id="performance-getentries" tabindex="-1"><a class="header-anchor" href="#performance-getentries"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancegetentries" target="_blank" rel="noopener noreferrer">performance.getEntries()</a></span></a></h3><p>Node.js ä¸­çš„ <code>performance.getEntries()</code> å‡½æ•°æ˜¯ä¸€ä¸ªæ€§èƒ½ç›‘æµ‹å·¥å…·ï¼Œå®ƒä½äº <code>perf_hooks</code> æ¨¡å—ä¸­ã€‚è¿™ä¸ªå‡½æ•°å…è®¸ä½ è·å–ä¸€ä¸ªåˆ—è¡¨ï¼Œé‡Œé¢åŒ…å«äº†ä¸€ç³»åˆ—ä¸æ€§èƒ½ç›¸å…³çš„æ—¶é—´ç‚¹å’Œåº¦é‡æŒ‡æ ‡ã€‚è¿™äº›ä¿¡æ¯é€šå¸¸ç”¨äºç›‘æ§å’Œåˆ†æåº”ç”¨ç¨‹åºçš„æ€§èƒ½è¡¨ç°ã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>performance.getEntries()</code> æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ª <code>PerformanceEntry</code> å¯¹è±¡ã€‚è¿™äº›å¯¹è±¡ä»£è¡¨äº†å·²ç»è®°å½•ä¸‹æ¥çš„æ€§èƒ½äº‹ä»¶ï¼Œæ¯”å¦‚ HTTP è¯·æ±‚çš„å“åº”æ—¶é—´ã€è¯»å†™æ–‡ä»¶æ“ä½œçš„è€—æ—¶ç­‰ã€‚</p><h3 id="å®é™…åº”ç”¨ä¸¾ä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¸¾ä¾‹"><span>å®é™…åº”ç”¨ä¸¾ä¾‹</span></a></h3><p><strong>ä¾‹ 1ï¼šç›‘æ§ HTTP è¯·æ±‚çš„è€—æ—¶</strong></p><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª web æœåŠ¡ï¼Œå¹¶ä¸”æƒ³è¦ç›‘æ§å¤„ç†æ¯ä¸ª HTTP è¯·æ±‚æ‰€éœ€è¦çš„æ—¶é—´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ€§èƒ½è§‚å¯Ÿè€…æ¥æ‰“å°å‡ºæ€§èƒ½åº¦é‡ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clearMarks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">http</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ ‡è®°è¯·æ±‚å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // ... è¿™é‡Œè¿›è¡Œè¯·æ±‚å¤„ç†é€»è¾‘ ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å“åº”ç»“æŸå‰ï¼Œæ ‡è®°è¯·æ±‚ç»“æŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æµ‹é‡&#39;A&#39;åˆ°&#39;B&#39;ä¹‹é—´çš„æŒç»­æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Request Handle Time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8080</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Server running at http://127.0.0.1:8080/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>performance.mark()</code> æ¥æ ‡è®°è¯·æ±‚å¼€å§‹ï¼ˆ&#39;A&#39;ï¼‰å’Œç»“æŸï¼ˆ&#39;B&#39;ï¼‰çš„æ—¶åˆ»ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨ <code>performance.measure()</code> æ¥åˆ›å»ºä¸€ä¸ªåä¸º &#39;Request Handle Time&#39; çš„åº¦é‡ï¼Œç”¨äºè®¡ç®—ä¸¤ä¸ªæ ‡è®°ä¹‹é—´çš„æ—¶é—´å·®ã€‚è¿™æ ·ï¼Œæ¯å½“æœ‰è¯·æ±‚è¢«å¤„ç†æ—¶ï¼Œæ€§èƒ½è§‚å¯Ÿè€…éƒ½ä¼šæ‰“å°å‡ºå¤„ç†è¯¥è¯·æ±‚èŠ±è´¹çš„æ—¶é—´ã€‚</p><p><strong>ä¾‹ 2ï¼šç›‘æ§æ–‡ä»¶è¯»å†™æ“ä½œçš„è€—æ—¶</strong></p><p>å¦‚æœä½ çš„ Node.js åº”ç”¨éœ€è¦è¯»å–æˆ–å†™å…¥å¤§é‡æ•°æ®åˆ°ç£ç›˜ï¼Œå¯èƒ½ä¼šå¸Œæœ›çŸ¥é“è¿™äº›æ“ä½œçš„æ€§èƒ½è¡¨ç°å¦‚ä½•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> readFileAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">file</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;readFileStart&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">reject</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">file</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;readFileEnd&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Read File&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;readFileStart&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;readFileEnd&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">reject</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      else</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./example.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">readMeasure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntriesByName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Read File&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`File read took </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">readMeasure</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> milliseconds.`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª <code>readFileAsync</code> å‡½æ•°ï¼Œå®ƒè¿”å›ä¸€ä¸ª Promiseï¼Œç”¨äºå¼‚æ­¥åœ°è¯»å–æ–‡ä»¶å†…å®¹ã€‚è¯¥å‡½æ•°å†…éƒ¨è®°å½•äº†è¯»å–æ“ä½œå¼€å§‹å’Œç»“æŸçš„æ—¶é—´ã€‚è¯»å–å®Œæˆåï¼Œæˆ‘ä»¬é€šè¿‡ <code>performance.getEntriesByName()</code> è·å–ç‰¹å®šåç§°çš„æ€§èƒ½æ¡ç›®ï¼Œå¹¶æ‰“å°å‡ºæ–‡ä»¶è¯»å–æ“ä½œæ‰€è€—è´¹çš„æ—¶é—´ã€‚</p><p>ä½¿ç”¨ <code>performance.getEntries()</code> å’Œå…¶ä»–ç›¸å…³å‡½æ•°å¯ä»¥è®©æˆ‘ä»¬å‡†ç¡®åœ°è¡¡é‡å’Œç†è§£ Node.js åº”ç”¨ç¨‹åºä¸­ä¸åŒæ“ä½œçš„æ€§èƒ½ç‰¹å¾ï¼Œè¿›è€Œå¸®åŠ©æˆ‘ä»¬ä¼˜åŒ–ç¨‹åºä»¥è¾¾åˆ°æ›´å¥½çš„æ€§èƒ½ã€‚</p><h3 id="performance-getentriesbyname-name-type" tabindex="-1"><a class="header-anchor" href="#performance-getentriesbyname-name-type"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancegetentriesbynamename-type" target="_blank" rel="noopener noreferrer">performance.getEntriesByName(name[, type])</a></span></a></h3><p>å½“ä½ å¬åˆ° Node.js, ä½ å¯ä»¥æƒ³è±¡å®ƒæ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œç”¨äºæ„å»ºå„ç§åº”ç”¨ç¨‹åºï¼Œä»ç½‘ç«™åˆ°åå°æœåŠ¡ã€‚è€Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ€§èƒ½ç›‘æ§å’Œè°ƒä¼˜æˆä¸ºäº†ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚è¿™å°±æ˜¯<code>performance.getEntriesByName(name[, type])</code>å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>perf_hooks</code>æ¨¡å—æä¾›äº†ä¸€ç»„æ€§èƒ½ç›‘æµ‹çš„å·¥å…·ï¼Œå…è®¸ä½ æ”¶é›†å…³äºä½ çš„ç¨‹åºè¿è¡Œæ—¶æ€§èƒ½çš„æ•°æ®ã€‚<code>performance.getEntriesByName(name[, type])</code>æ˜¯è¿™äº›å·¥å…·ä¸­çš„ä¸€ä¸ªï¼Œå®ƒä½¿ä½ èƒ½å¤ŸæŒ‰åç§°è·å–ç‰¹å®šç±»å‹çš„æ€§èƒ½æ¡ç›®çš„åˆ—è¡¨ã€‚</p><p><strong>å‚æ•°è§£é‡Š</strong>:</p><ul><li><code>name</code>: è¿™æ˜¯ä½ æƒ³è¦æŸ¥è¯¢çš„æ€§èƒ½æ¡ç›®çš„åå­—ã€‚</li><li><code>type</code>(å¯é€‰): è¿™æ˜¯æ¡ç›®çš„ç±»å‹ã€‚å®ƒå¯ä»¥æ˜¯å¦‚&quot;mark&quot;ã€&quot;measure&quot;ç­‰ï¼Œç”¨æ¥æŒ‡å®šä½ æ„Ÿå…´è¶£çš„ç‰¹å®šç±»å‹çš„æ¡ç›®ã€‚å¦‚æœä½ ä¸æä¾›è¿™ä¸ªå‚æ•°ï¼Œå‡½æ•°å°†è¿”å›æ‰€æœ‰ç±»å‹çš„æ¡ç›®ã€‚</li></ul><p><strong>è¿”å›å€¼</strong>: è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†æ‰€æœ‰åŒ¹é…ç»™å®š<code>name</code>ï¼ˆä»¥åŠ<code>type</code>ï¼Œå¦‚æœæŒ‡å®šçš„è¯ï¼‰çš„æ€§èƒ½æ¡ç›®ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°ä»»ä½•åŒ¹é…çš„æ¡ç›®ï¼Œå®ƒå°†è¿”å›ä¸€ä¸ªç©ºæ•°ç»„ã€‚</p><p><strong>å®é™…è¿ç”¨ä¾‹å­</strong>:</p><ol><li><p><strong>ç›‘æµ‹ API å“åº”æ—¶é—´</strong>: å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web æœåŠ¡ï¼Œä½ æƒ³è¦ç›‘æµ‹ä¸€ä¸ªç‰¹å®š API è°ƒç”¨çš„å“åº”æ—¶é—´ã€‚ä½ å¯ä»¥åœ¨å¤„ç†è¯¥ API è¯·æ±‚çš„å¼€å§‹å’Œç»“æŸä½ç½®åˆ†åˆ«ä½¿ç”¨<code>performance.mark()</code>æ–¹æ³•æ¥æ ‡è®°èµ·å§‹ç‚¹å’Œç»“æŸç‚¹ã€‚ç„¶åï¼Œä½ å¯ä»¥ä½¿ç”¨<code>performance.measure()</code>æ¥è®¡ç®—è¿™ä¸¤ç‚¹ä¹‹é—´çš„å·®å¼‚ï¼ˆå³å“åº”æ—¶é—´ï¼‰ã€‚æœ€åï¼Œé€šè¿‡<code>performance.getEntriesByName(&#39;APIResponseTime&#39;, &#39;measure&#39;)</code>æ¥è·å–è¿™ä¸ªæµ‹é‡ç»“æœã€‚</p></li><li><p><strong>æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½åˆ†æ</strong>: åœ¨æ‰§è¡Œä¸€ä¸ªæ•°æ®åº“æŸ¥è¯¢å‰åï¼ŒåŒæ ·å¯ä»¥æ ‡è®°å¼€å§‹å’Œç»“æŸæ—¶é—´ç‚¹ï¼Œå¹¶å‘½åè¿™äº›æ ‡è®°ã€‚ä¹‹åï¼Œåˆ©ç”¨<code>performance.measure()</code>æ¥æµ‹é‡æŸ¥è¯¢æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚è¿™å¯¹äºå‘ç°å¹¶ä¼˜åŒ–æ…¢æŸ¥è¯¢ç‰¹åˆ«æœ‰ç”¨ã€‚ä½ å¯ä»¥ä¸ºæ¯ä¸ªæŸ¥è¯¢è®¾å®šä¸åŒçš„åç§°ï¼Œå¹¶ä½¿ç”¨<code>performance.getEntriesByName()</code>æ¥è·å–ç‰¹å®šæŸ¥è¯¢çš„æ€§èƒ½æ•°æ®ã€‚</p></li><li><p><strong>è‡ªå®šä¹‰æ€§èƒ½æŒ‡æ ‡è·Ÿè¸ª</strong>: å¦‚æœä½ æ­£åœ¨æ„å»ºä¸€ä¸ªå¤æ‚çš„ Node.js åº”ç”¨ï¼Œå¯èƒ½ä¼šæœ‰è®¸å¤šå†…éƒ¨è¿‡ç¨‹æˆ–å‡½æ•°éœ€è¦ç›‘æ§ã€‚åœ¨è¿™äº›è¿‡ç¨‹æˆ–å‡½æ•°çš„å¼€å§‹å’Œç»“æŸå¤„è®¾ç½®æ ‡è®°ï¼Œä½ å°±èƒ½æµ‹é‡å¹¶åˆ†æå®ƒä»¬çš„æ‰§è¡Œæ—¶é—´ã€‚è¿™å¯¹äºè¯†åˆ«ç“¶é¢ˆå’Œä¼˜åŒ–æ€§èƒ½è‡³å…³é‡è¦ã€‚</p></li></ol><p>é€šè¿‡ä½¿ç”¨<code>performance.getEntriesByName()</code>ï¼Œä½ å¯ä»¥éå¸¸ç²¾ç¡®åœ°è·å–å’Œåˆ†æä½ æ„Ÿå…´è¶£çš„æ€§èƒ½æŒ‡æ ‡ï¼Œè¿™åœ¨ä¼˜åŒ–å’Œæå‡åº”ç”¨æ€§èƒ½æ–¹é¢æ˜¯æå…¶æœ‰ç”¨çš„ã€‚</p><h3 id="performance-getentriesbytype-type" tabindex="-1"><a class="header-anchor" href="#performance-getentriesbytype-type"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancegetentriesbytypetype" target="_blank" rel="noopener noreferrer">performance.getEntriesByType(type)</a></span></a></h3><p>Node.js ä¸­çš„<code>performance.getEntriesByType(type)</code>æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ–¹æ³•ï¼Œå®ƒå±äºæ€§èƒ½ï¼ˆPerformanceï¼‰API çš„ä¸€éƒ¨åˆ†ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ è·å–ç‰¹å®šç±»å‹çš„æ€§èƒ½æŒ‡æ ‡(entries)ï¼Œä»è€Œå¸®åŠ©ä½ äº†è§£ç¨‹åºçš„æ€§èƒ½è¡¨ç°ã€‚ç†è§£è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç®€å•äº†è§£å‡ ä¸ªæ¦‚å¿µï¼š</p><ol><li><p><strong>æ€§èƒ½æŒ‡æ ‡(Performance Entries)</strong>ï¼šå½“ä½ çš„åº”ç”¨è¿è¡Œæ—¶ï¼ŒNode.js ä¼šè®°å½•å„ç§æ€§èƒ½ç›¸å…³çš„æ•°æ®ï¼Œæ¯”å¦‚ HTTP è¯·æ±‚çš„è€—æ—¶ã€è¯»å†™æ–‡ä»¶çš„æ—¶é—´ç­‰ã€‚è¿™äº›æ•°æ®è¢«ç§°ä¸ºâ€œæ€§èƒ½æŒ‡æ ‡â€æˆ–â€œæ€§èƒ½æ¡ç›®â€ã€‚</p></li><li><p><strong>ç±»å‹(Type)</strong>ï¼šæ¯ä¸ªæ€§èƒ½æŒ‡æ ‡éƒ½æœ‰ä¸€ä¸ªâ€œç±»å‹â€ï¼Œå®ƒå‘Šè¯‰ä½ è¿™ä¸ªæŒ‡æ ‡æ˜¯å…³äºä»€ä¹ˆçš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ å‘é€äº†ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œé‚£ä¹ˆç›¸å…³çš„æ€§èƒ½æŒ‡æ ‡ç±»å‹å¯èƒ½å°±æ˜¯<code>&#39;http&#39;</code>ã€‚</p></li></ol><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ·±å…¥äº†è§£<code>performance.getEntriesByType(type)</code>è¿™ä¸ªæ–¹æ³•ã€‚</p><h3 id="performance-getentriesbytype-type-1" tabindex="-1"><a class="header-anchor" href="#performance-getentriesbytype-type-1"><span><code>performance.getEntriesByType(type)</code></span></a></h3><p>è¿™ä¸ªæ–¹æ³•æ¥å—ä¸€ä¸ªå‚æ•°â€”â€”<code>type</code>ï¼Œä¹Ÿå°±æ˜¯ä½ æƒ³è¦è·å–æ€§èƒ½æŒ‡æ ‡çš„ç±»å‹ã€‚å®ƒè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†æ‰€æœ‰æŒ‡å®šç±»å‹çš„æ€§èƒ½æŒ‡æ ‡ã€‚</p><p>ä¸¾å‡ ä¸ªå®é™…çš„ä¾‹å­æ¥è¯´æ˜è¿™ä¸ªæ–¹æ³•çš„ç”¨é€”ï¼š</p><h4 id="ä¾‹å­-1-æµ‹é‡-http-è¯·æ±‚çš„æ€§èƒ½" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-æµ‹é‡-http-è¯·æ±‚çš„æ€§èƒ½"><span>ä¾‹å­ 1ï¼šæµ‹é‡ HTTP è¯·æ±‚çš„æ€§èƒ½</span></a></h4><p>å‡è®¾ä½ çš„ Node.js åº”ç”¨éœ€è¦å‘å¤–éƒ¨æœåŠ¡å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶ä¸”ä½ æƒ³è¦ç›‘æ§è¿™äº›è¯·æ±‚çš„æ€§èƒ½ã€‚ä½ å¯ä»¥ä½¿ç”¨<code>performance.getEntriesByType(&#39;http&#39;)</code>æ¥è·å–æ‰€æœ‰ HTTP è¯·æ±‚çš„æ€§èƒ½æŒ‡æ ‡ï¼Œç„¶ååˆ†æè¿™äº›æ•°æ®ï¼Œæ¯”å¦‚è®¡ç®—å¹³å‡å“åº”æ—¶é—´ç­‰ã€‚</p><h4 id="ä¾‹å­-2-ç›‘æ§æ–‡ä»¶æ“ä½œçš„æ€§èƒ½" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ç›‘æ§æ–‡ä»¶æ“ä½œçš„æ€§èƒ½"><span>ä¾‹å­ 2ï¼šç›‘æ§æ–‡ä»¶æ“ä½œçš„æ€§èƒ½</span></a></h4><p>å¦‚æœä½ çš„åº”ç”¨æ¶‰åŠåˆ°å¤§é‡çš„æ–‡ä»¶è¯»å†™æ“ä½œï¼Œä½ å¯èƒ½æƒ³è¦æ£€æŸ¥è¿™äº›æ“ä½œçš„æ•ˆç‡ã€‚é€šè¿‡ä½¿ç”¨<code>performance.getEntriesByType(&#39;io&#39;)</code>ï¼ˆå‡è®¾ IO æ“ä½œçš„ç±»å‹æ˜¯<code>&#39;io&#39;</code>ï¼‰ï¼Œä½ å¯ä»¥è·å–æ‰€æœ‰æ–‡ä»¶è¯»å†™æ“ä½œçš„æ€§èƒ½æŒ‡æ ‡ï¼Œç„¶ååˆ†æå®ƒä»¬ï¼Œæ¯”å¦‚æ‰¾å‡ºå“ªäº›æ“ä½œæœ€è€—æ—¶ã€‚</p><h4 id="ä¾‹å­-3-è‡ªå®šä¹‰æ€§èƒ½æŒ‡æ ‡" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-3-è‡ªå®šä¹‰æ€§èƒ½æŒ‡æ ‡"><span>ä¾‹å­ 3ï¼šè‡ªå®šä¹‰æ€§èƒ½æŒ‡æ ‡</span></a></h4><p>Node.js è¿˜å…è®¸ä½ åˆ›å»ºè‡ªå®šä¹‰çš„æ€§èƒ½æŒ‡æ ‡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªå¤æ‚çš„æ•°æ®å¤„ç†åº”ç”¨ï¼Œä½ å¯èƒ½æƒ³è¦æµ‹é‡æŸä¸ªç‰¹å®šå¤„ç†é˜¶æ®µçš„æ‰§è¡Œæ—¶é—´ã€‚é¦–å…ˆï¼Œä½ å¯ä»¥ä½¿ç”¨ Node.js çš„æ€§èƒ½ API æ¥åˆ›å»ºå¹¶è®°å½•è¿™ä¸ªé˜¶æ®µçš„æ€§èƒ½æŒ‡æ ‡ï¼Œå¹¶ä¸ºå…¶æŒ‡å®šä¸€ä¸ªè‡ªå®šä¹‰ç±»å‹ï¼Œæ¯”å¦‚<code>&#39;data-processing&#39;</code>ã€‚ç„¶åï¼Œä½ å¯ä»¥ä½¿ç”¨<code>performance.getEntriesByType(&#39;data-processing&#39;)</code>æ¥è·å–è¿™äº›è‡ªå®šä¹‰æ€§èƒ½æŒ‡æ ‡çš„æ•°æ®ã€‚</p><h3 id="æ€»ç»“-1" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-1"><span>æ€»ç»“</span></a></h3><p><code>performance.getEntriesByType(type)</code>æ˜¯ä¸€ä¸ªå¼ºå¤§å·¥å…·ï¼Œå®ƒèƒ½å¸®åŠ©ä½ æ·±å…¥äº†è§£å¹¶ä¼˜åŒ–ä½ çš„ Node.js åº”ç”¨çš„æ€§èƒ½ã€‚é€šè¿‡æ”¶é›†å’Œåˆ†æä¸åŒç±»å‹çš„æ€§èƒ½æŒ‡æ ‡ï¼Œä½ å¯ä»¥è¯†åˆ«å‡ºåº”ç”¨ä¸­çš„ç“¶é¢ˆï¼Œè¿›è€Œé‡‡å–ç›¸åº”æªæ–½æ¥æé«˜æ€§èƒ½ã€‚æ— è®ºæ˜¯å†…ç½®çš„æŒ‡æ ‡ç±»å‹ï¼Œæ¯”å¦‚ HTTP è¯·æ±‚æˆ–æ–‡ä»¶æ“ä½œï¼Œè¿˜æ˜¯è‡ªå®šä¹‰çš„æ€§èƒ½æŒ‡æ ‡ï¼Œè¿™ä¸ªæ–¹æ³•éƒ½æ˜¯åˆ†æå’Œä¼˜åŒ–ç¨‹åºæ€§èƒ½çš„å®è´µèµ„æºã€‚</p><h3 id="performance-mark-name-options" tabindex="-1"><a class="header-anchor" href="#performance-mark-name-options"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancemarkname-options" target="_blank" rel="noopener noreferrer">performance.mark(name[, options])</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>performance.mark(name[, options])</code> æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œå®ƒå±äºæ€§èƒ½ç›‘æµ‹å·¥å…·ï¼ˆperformance hooksï¼‰ï¼Œç”¨äºåœ¨ä»£ç çš„ç‰¹å®šä½ç½®è®¾ç½®â€œæ ‡è®°ç‚¹â€ï¼Œä»¥å¸®åŠ©æµ‹é‡å’Œç›‘æµ‹ä»£ç æ‰§è¡Œçš„æ€§èƒ½ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æ¥è¯¦ç»†äº†è§£ä¸€ä¸‹è¿™ä¸ªåŠŸèƒ½ï¼Œä»¥åŠå¦‚ä½•åœ¨å®é™…ä¸­åº”ç”¨å®ƒã€‚</p><h3 id="performance-mark-name-options-çš„åŸºæœ¬ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#performance-mark-name-options-çš„åŸºæœ¬ç”¨æ³•"><span>performance.mark(name[, options]) çš„åŸºæœ¬ç”¨æ³•</span></a></h3><ul><li><strong>name</strong>: è¿™æ˜¯ä½ è®¾ç½®æ ‡è®°ç‚¹æ—¶åˆ†é…çš„å”¯ä¸€åç§°ï¼Œä¹‹åå¯ä»¥ç”¨è¿™ä¸ªåç§°æ¥å¼•ç”¨è¯¥æ ‡è®°ç‚¹ã€‚</li><li><strong>options</strong> (å¯é€‰): ä¸€ä¸ªå¯¹è±¡ï¼Œå…è®¸ä½ è®¾ç½®ä¸€äº›é¢å¤–çš„é€‰é¡¹ã€‚åœ¨ v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œå¯ä»¥åŒ…æ‹¬å¦‚ <code>detail</code> å±æ€§ï¼Œè¿™è®©ä½ èƒ½å¤Ÿå­˜å‚¨ä¸€äº›é¢å¤–çš„ä¿¡æ¯æˆ–æ•°æ®ä¸æ ‡è®°ç›¸å…³è”ã€‚</li></ul><h3 id="å¦‚ä½•ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><ol><li><p><strong>è®¾ç½®æ ‡è®°ç‚¹</strong>: åœ¨ä½ æƒ³è¦æµ‹é‡æ€§èƒ½çš„ä»£ç åŒºåŸŸçš„å¼€å§‹å’Œç»“æŸä½ç½®ï¼Œè°ƒç”¨ <code>performance.mark()</code> å¹¶åˆ†åˆ«ç»™å®ƒä»¬ä¸€ä¸ªç‹¬ç‰¹çš„åç§°ã€‚</p></li><li><p><strong>æµ‹é‡æ—¶é—´</strong>: ä½¿ç”¨ <code>performance.measure()</code> æ–¹æ³•ï¼Œå®ƒå¯ä»¥æ¥å—ä¸¤ä¸ªæ ‡è®°ç‚¹çš„åç§°ä½œä¸ºå‚æ•°ï¼ŒNode.js ä¼šè®¡ç®—å¹¶æŠ¥å‘Šè¿™ä¸¤ä¸ªæ ‡è®°ç‚¹ä¹‹é—´çš„æ—¶é—´å·®ã€‚</p></li></ol><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-æµ‹é‡ä»£ç ç‰‡æ®µçš„æ‰§è¡Œæ—¶é—´" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æµ‹é‡ä»£ç ç‰‡æ®µçš„æ‰§è¡Œæ—¶é—´"><span>ç¤ºä¾‹ 1: æµ‹é‡ä»£ç ç‰‡æ®µçš„æ‰§è¡Œæ—¶é—´</span></a></h4><p>å‡è®¾æˆ‘ä»¬æƒ³è¦æµ‹é‡ä¸€ä¸ªå‡½æ•° <code>doSomeHeavyLifting()</code> çš„æ‰§è¡Œæ—¶é—´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ‡è®°å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start-heavy-lifting&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰§è¡Œä¸€äº›æ€§èƒ½å¯†é›†å‹çš„ä»»åŠ¡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">doSomeHeavyLifting</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ‡è®°ç»“æŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end-heavy-lifting&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹é‡å¹¶è¾“å‡ºæ‰§è¡Œæ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;heavy-lifting-measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;start-heavy-lifting&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;end-heavy-lifting&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> measure</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntriesByName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;heavy-lifting-measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`doSomeHeavyLifting æ‰§è¡Œæ—¶é—´: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">measure</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡åœ¨ <code>doSomeHeavyLifting()</code> å‡½æ•°çš„å¼€å§‹å’Œç»“æŸä½ç½®è®¾ç½®æ ‡è®°ï¼Œç„¶åä½¿ç”¨ <code>performance.measure()</code> æ¥è®¡ç®—è¿™ä¸¤ä¸ªæ ‡è®°ç‚¹ä¹‹é—´çš„æ—¶é—´å·®ï¼Œæœ€ç»ˆé€šè¿‡ <code>console.log</code> è¾“å‡ºè¿™ä¸ªæ—¶é—´å·®ï¼Œä»¥æ­¤æ¥æµ‹é‡å‡½æ•°çš„æ‰§è¡Œæ—¶é—´ã€‚</p><h4 id="ç¤ºä¾‹-2-ä½¿ç”¨-options-å‚æ•°è®°å½•é¢å¤–ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨-options-å‚æ•°è®°å½•é¢å¤–ä¿¡æ¯"><span>ç¤ºä¾‹ 2: ä½¿ç”¨ options å‚æ•°è®°å½•é¢å¤–ä¿¡æ¯</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®æ ‡è®°ç‚¹å¹¶è®°å½•é¢å¤–ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start-task&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">detail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å¼€å§‹æ‰§è¡Œä»»åŠ¡&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰§è¡Œä»»åŠ¡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">doTask</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®ç»“æŸæ ‡è®°ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end-task&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">detail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä»»åŠ¡æ‰§è¡Œç»“æŸ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯ä»¥ä½¿ç”¨ performance.getEntriesByName() æ¥è·å–æ ‡è®°ç‚¹ï¼Œå¹¶è¯»å– detail ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> startMark</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntriesByName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start-task&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">startMark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">detail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: å¼€å§‹æ‰§è¡Œä»»åŠ¡</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>options</code> å‚æ•°çš„ <code>detail</code> å±æ€§æ¥è®°å½•é¢å¤–çš„ä¿¡æ¯ã€‚è¿™åœ¨ä½ æƒ³è¦é™„åŠ ä¸€äº›æè¿°æˆ–è€…å…¶ä»–æ•°æ®åˆ°æ ‡è®°ç‚¹ä¸Šæ—¶éå¸¸æœ‰ç”¨ï¼Œä¾‹å¦‚ï¼Œè®°å½•ä¸€ä¸ªæ“ä½œå¼€å§‹å’Œç»“æŸæ—¶çš„çŠ¶æ€ä¿¡æ¯ã€‚</p><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>performance.mark()</code> æ˜¯å¦‚ä½•åœ¨ Node.js ä¸­ç”¨äºæ€§èƒ½ç›‘æµ‹å’Œåˆ†æçš„ã€‚å®ƒä¸ä»…èƒ½å¸®åŠ©ä½ äº†è§£ä»£ç çš„æ‰§è¡Œæ—¶é—´ï¼Œè¿˜å¯ä»¥é€šè¿‡ <code>options</code> å‚æ•°è®°å½•æ›´å¤šç›¸å…³ä¿¡æ¯ï¼Œå¯¹äºä¼˜åŒ–åº”ç”¨æ€§èƒ½æ¥è¯´éå¸¸æœ‰ç”¨ã€‚</p><h3 id="performance-markresourcetiming-timinginfo-requestedurl-initiatortype-global-cachemode" tabindex="-1"><a class="header-anchor" href="#performance-markresourcetiming-timinginfo-requestedurl-initiatortype-global-cachemode"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancemarkresourcetimingtiminginfo-requestedurl-initiatortype-global-cachemode" target="_blank" rel="noopener noreferrer">performance.markResourceTiming(timingInfo, requestedUrl, initiatorType, global, cacheMode)</a></span></a></h3><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>performance.markResourceTiming</code>æ˜¯ä¸€ä¸ªç”¨äºæ‰‹åŠ¨è®°å½•èµ„æºåŠ è½½æ—¶é—´çš„åŠŸèƒ½ï¼Œå®ƒå±äº<code>perf_hooks</code>æ¨¡å—ã€‚è¿™ä¸ªåŠŸèƒ½å…è®¸å¼€å‘è€…åœ¨ Node.js ç¯å¢ƒä¸­æ¨¡æ‹Ÿå‡ºç±»ä¼¼æµè§ˆå™¨ä¸­èµ„æºåŠ è½½çš„æ—¶é—´æ ‡è®°ã€‚ä¸‹é¢ï¼Œæˆ‘ä¼šè¯¦ç»†è§£é‡Šè¿™ä¸ªæ–¹æ³•çš„ç”¨æ³•ï¼Œå¹¶ç»™å‡ºå‡ ä¸ªå®é™…åº”ç”¨çš„ä¾‹å­ã€‚</p><h3 id="æ–¹æ³•çš„å‚æ•°" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•çš„å‚æ•°"><span>æ–¹æ³•çš„å‚æ•°</span></a></h3><p><code>performance.markResourceTiming</code>æ¥æ”¶ä»¥ä¸‹å‚æ•°ï¼š</p><ul><li><code>timingInfo</code>ï¼šä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†èµ„æºåŠ è½½çš„å„ç§æ—¶é—´ç‚¹ï¼ˆå¦‚å¼€å§‹æ—¶é—´ã€ç»“æŸæ—¶é—´ï¼‰ã€‚è¿™äº›æ—¶é—´ç‚¹åæ˜ äº†èµ„æºä»è¯·æ±‚åˆ°åŠ è½½å®Œæˆçš„è¿‡ç¨‹ã€‚</li><li><code>requestedUrl</code>ï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¢«è¯·æ±‚èµ„æºçš„ URLã€‚</li><li><code>initiatorType</code>ï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå‘èµ·è¯·æ±‚çš„ç±»å‹ï¼Œæ¯”å¦‚æ˜¯é€šè¿‡<code>&lt;`link&gt;`ã€</code> &lt;<code>script</code>&gt; ``ã€<code>XMLHttpRequest</code>ç­‰æ–¹å¼å‘èµ·çš„ã€‚</li><li><code>global</code>ï¼šå¸ƒå°”å€¼ï¼Œæ ‡è¯†è¿™ä¸ªèµ„æºåŠ è½½æ—¶é—´æ˜¯å¦åº”è¯¥è¢«è®°å½•åœ¨å…¨å±€çš„æ€§èƒ½æ—¶é—´çº¿ä¸Šã€‚</li><li><code>cacheMode</code>ï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºèµ„æºåŠ è½½ä½¿ç”¨çš„ç¼“å­˜æ¨¡å¼ï¼Œæ¯”å¦‚<code>&quot;default&quot;</code>ã€<code>&quot;reload&quot;</code>ã€<code>&quot;no-cache&quot;</code>ç­‰ã€‚</li></ul><h3 id="ä½¿ç”¨åœºæ™¯å’Œä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯å’Œä¾‹å­"><span>ä½¿ç”¨åœºæ™¯å’Œä¾‹å­</span></a></h3><h4 id="åœºæ™¯ä¸€-æµ‹è¯•ç‰¹å®šèµ„æºåŠ è½½æ—¶é—´" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯ä¸€-æµ‹è¯•ç‰¹å®šèµ„æºåŠ è½½æ—¶é—´"><span>åœºæ™¯ä¸€ï¼šæµ‹è¯•ç‰¹å®šèµ„æºåŠ è½½æ—¶é—´</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œéœ€è¦åŠ è½½ä¸€ä¸ªå¤–éƒ¨è„šæœ¬ï¼Œå¹¶æƒ³è¦æµ‹è¯•è¿™ä¸ªè„šæœ¬åŠ è½½çš„æ€§èƒ½ã€‚ä½ å¯ä»¥ä½¿ç”¨<code>performance.markResourceTiming</code>æ¥æ¨¡æ‹Ÿè®°å½•è¿™ä¸ªè¿‡ç¨‹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾çš„æ—¶é—´ç‚¹æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> timingInfo</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  startTime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼€å§‹æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  responseEnd</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">150</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç»“æŸæ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è°ƒç”¨æ–¹æ³•è®°å½•æ€§èƒ½</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">markResourceTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  timingInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;https://example.com/script.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;script&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;default&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿäº†ä» 100ms åˆ° 150ms çš„è„šæœ¬åŠ è½½æ—¶é—´ï¼Œå¹¶å°†å…¶è®°å½•ä¸‹æ¥ã€‚</p><h4 id="åœºæ™¯äºŒ-åˆ†æå’Œä¼˜åŒ–èµ„æºåŠ è½½" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯äºŒ-åˆ†æå’Œä¼˜åŒ–èµ„æºåŠ è½½"><span>åœºæ™¯äºŒï¼šåˆ†æå’Œä¼˜åŒ–èµ„æºåŠ è½½</span></a></h4><p>é€šè¿‡ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œå¼€å‘è€…å¯ä»¥å¯¹åº”ç”¨ä¸­çš„èµ„æºåŠ è½½è¿›è¡Œè¯¦ç»†åˆ†æã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥åŠ è½½å¤šä¸ªä¸åŒçš„èµ„æºï¼Œä½¿ç”¨ä¸åŒçš„<code>initiatorType</code>æ¥åŒºåˆ†å®ƒä»¬ï¼Œç„¶åé€šè¿‡åˆ†æè¿™äº›èµ„æºçš„åŠ è½½æ—¶é—´æ¥è¯†åˆ«æ€§èƒ½ç“¶é¢ˆæˆ–è¿›è¡Œä¼˜åŒ–ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿä¸åŒç±»å‹èµ„æºçš„åŠ è½½æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">markResourceTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">startTime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">responseEnd</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">120</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;https://example.com/style.css&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;link&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;default&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">markResourceTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">startTime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">150</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">responseEnd</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;https://example.com/app.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;script&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;default&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡æ¯”è¾ƒä¸åŒèµ„æºç±»å‹çš„åŠ è½½æ—¶é—´ï¼Œå¼€å‘è€…å¯ä»¥è¯†åˆ«å‡ºå“ªäº›èµ„æºåŠ è½½è¾ƒæ…¢ï¼Œå¹¶æ¢ç´¢ä¼˜åŒ–è¿™äº›èµ„æºåŠ è½½æ—¶é—´çš„æ–¹æ³•ï¼Œå¦‚ä½¿ç”¨æ›´å¿«çš„æœåŠ¡å™¨ã€ä¼˜åŒ–æ–‡ä»¶å¤§å°æˆ–åº”ç”¨ç¼“å­˜ç­–ç•¥ã€‚</p><h3 id="ç»“è®º" tabindex="-1"><a class="header-anchor" href="#ç»“è®º"><span>ç»“è®º</span></a></h3><p><code>performance.markResourceTiming</code>æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå…è®¸å¼€å‘è€…åœ¨ Node.js ç¯å¢ƒä¸­æ¨¡æ‹Ÿå’Œè®°å½•èµ„æºåŠ è½½çš„æ€§èƒ½æ•°æ®ã€‚è¿™å¯¹äºæ€§èƒ½åˆ†æå’Œä¼˜åŒ–ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦è¯¦ç»†äº†è§£èµ„æºåŠ è½½æ—¶é—´çš„åº”ç”¨ä¸­ï¼Œæ˜¯éå¸¸æœ‰ç”¨çš„ã€‚é€šè¿‡æ¨¡æ‹Ÿä¸åŒçš„èµ„æºåŠ è½½åœºæ™¯ï¼Œå¼€å‘è€…å¯ä»¥æ›´å¥½åœ°ç†è§£å’Œä¼˜åŒ–ä»–ä»¬çš„åº”ç”¨æ€§èƒ½ã€‚</p><h3 id="performance-measure-name-startmarkoroptions-endmark" tabindex="-1"><a class="header-anchor" href="#performance-measure-name-startmarkoroptions-endmark"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancemeasurename-startmarkoroptions-endmark" target="_blank" rel="noopener noreferrer">performance.measure(name[, startMarkOrOptions[, endMark]])</a></span></a></h3><p>Node.js ä¸­çš„ <code>performance.measure</code> å‡½æ•°æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå®ƒå…è®¸ä½ æµ‹é‡ä»£ç ä¸­ä¸¤ç‚¹ä¹‹é—´çš„æ‰§è¡Œæ—¶é—´ã€‚è¿™å¯¹äºä¼˜åŒ–ä»£ç æ€§èƒ½ã€è¯†åˆ«ç“¶é¢ˆæˆ–ä»…ä»…ä¸ºäº†æ»¡è¶³å¥½å¥‡å¿ƒéƒ½æ˜¯éå¸¸å®ç”¨çš„ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ææ¸…æ¥šå‡ ä¸ªå…³é”®æ¦‚å¿µï¼š</p><ul><li><strong>Performance Mark</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªæ—¶é—´ç‚¹çš„æ ‡è®°ï¼Œä½ å¯ä»¥åœ¨ä»£ç ä¸­ä»»æ„ä½ç½®åˆ›å»ºè¿™æ ·çš„æ ‡è®°æ¥ä»£è¡¨ä¸€ä¸ªç‰¹å®šçš„æ—¶åˆ»ã€‚</li><li><strong>Performance Measure</strong>ï¼šè¿™æ˜¯ä¸¤ä¸ªæ ‡è®°ï¼ˆæˆ–ä¸€ä¸ªæ ‡è®°å’Œå½“å‰æ—¶é—´ï¼‰ä¹‹é—´ç»è¿‡çš„æ—¶é—´ï¼Œå¯ä»¥å¸®åŠ©ä½ æµ‹é‡ä»£ç ä¸­æŸä¸ªæ“ä½œæ‰€éœ€çš„æ—¶é—´ã€‚</li></ul><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ä½¿ç”¨ <code>performance.measure(name[, startMarkOrOptions[, endMark]])</code> çš„åŸºç¡€ç»“æ„å¦‚ä¸‹ï¼š</p><ul><li><strong>name</strong>: è¿™æ˜¯ä½ æµ‹é‡çš„åç§°ï¼Œé€šè¿‡è¿™ä¸ªåç§°ä½ å¯ä»¥æ‰¾åˆ°å’Œè·å–æµ‹é‡ç»“æœã€‚</li><li><strong>startMarkOrOptions</strong>: è¿™ä¸ªå‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå¼€å§‹æ ‡è®°çš„åç§°ï¼›ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåŒ…å« <code>start</code> å’Œ <code>end</code> å±æ€§çš„å¯¹è±¡ï¼Œç›´æ¥æŒ‡å®šå¼€å§‹å’Œç»“æŸçš„æ ‡è®°åç§°ï¼Œè¿˜å¯ä»¥åŒ…å«å…¶ä»–é…ç½®é€‰é¡¹ã€‚</li><li><strong>endMark</strong>: è¿™æ˜¯ç»“æŸæ ‡è®°çš„åç§°ï¼Œå¦‚æœä½ åœ¨ç¬¬äºŒä¸ªå‚æ•°ä¸­å·²ç»æŒ‡å®šäº†ç»“æŸæ ‡è®°ï¼Œåˆ™ä¸éœ€è¦æ­¤å‚æ•°ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-1"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-åŸºç¡€ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åŸºç¡€ä½¿ç”¨"><span>ç¤ºä¾‹ 1: åŸºç¡€ä½¿ç”¨</span></a></h4><p>å‡è®¾ä½ æƒ³è¦æµ‹é‡ä¸€ä¸ªç®€å•å‡½æ•°æ‰§è¡Œæ‰€éœ€çš„æ—¶é—´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;perf_hooks&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºæ€§èƒ½è§‚å¯Ÿè€…ç›‘å¬æµ‹é‡äº‹ä»¶å¹¶æ‰“å°ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clearMarks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;measure&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®èµ·å§‹æ ‡è®°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;start&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰§è¡Œä¸€ä¸ªå‡½æ•°æˆ–ä¸€æ®µä»£ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 100000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {} </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æ“ä½œ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®ç»“æŸæ ‡è®°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;end&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹é‡ä» &#39;start&#39; åˆ° &#39;end&#39; çš„æ‰§è¡Œæ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;My Special Measure&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;start&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;end&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ ä¼šçœ‹åˆ°ä» <code>&#39;start&#39;</code> åˆ° <code>&#39;end&#39;</code> æ ‡è®°ä¹‹é—´ä»£ç æ‰§è¡Œæ‰€èŠ±è´¹çš„æ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚</p><h4 id="ç¤ºä¾‹-2-ä½¿ç”¨-options-å‚æ•°" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨-options-å‚æ•°"><span>ç¤ºä¾‹ 2: ä½¿ç”¨ Options å‚æ•°</span></a></h4><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ›´è¿›ä¸€æ­¥ï¼Œå‡è®¾é™¤äº†æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´å¤–ï¼Œæˆ‘ä»¬è¿˜æƒ³çŸ¥é“æ‰§è¡ŒæœŸé—´å‘ç”Ÿçš„å…¶ä»–ç»†èŠ‚ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç›´æ¥ä½¿ç”¨ options å¯¹è±¡è¿›è¡Œæµ‹é‡ï¼ŒåŒæ—¶æŒ‡å®šå¼€å§‹å’Œç»“æŸæ ‡è®°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;My Measure With Options&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  start</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  detail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Some additional details about this measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–æ‰€æœ‰æµ‹é‡ç»“æœï¼Œå¹¶æ‰¾å‡ºæˆ‘ä»¬æ„Ÿå…´è¶£çš„é‚£ä¸ª</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntriesByName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;My Measure With Options&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°æŒç»­æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">detail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°é¢å¤–çš„ç»†èŠ‚ä¿¡æ¯</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨äº†ä¸€ä¸ªé€‰é¡¹å¯¹è±¡æ¥åŒæ—¶æŒ‡å®šå¼€å§‹å’Œç»“æŸæ ‡è®°ï¼Œå¹¶æ·»åŠ äº†ä¸€äº›é™„åŠ çš„è¯¦æƒ…ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨æµ‹é‡å®Œæˆåè·å–æ›´å¤šçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p><h3 id="ç»“è®º-1" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-1"><span>ç»“è®º</span></a></h3><p>Node.js ä¸­çš„ <code>performance.measure</code> åŠŸèƒ½æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œæ— è®ºæ˜¯åœ¨å¼€å‘é˜¶æ®µä¼˜åŒ–ä»£ç æ€§èƒ½ï¼Œè¿˜æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒç›‘æ§å…³é”®æ“ä½œçš„æ‰§è¡Œæ—¶é—´ï¼Œå®ƒéƒ½èƒ½æä¾›å·¨å¤§çš„å¸®åŠ©ã€‚é€šè¿‡ç®€å•çš„ API è°ƒç”¨å’Œçµæ´»çš„é…ç½®ï¼Œå®ƒèƒ½å¤Ÿæ»¡è¶³å„ç§ç²¾ç¡®åº¦é‡å’Œæ€§èƒ½åˆ†æçš„éœ€æ±‚ã€‚</p><h3 id="performance-nodetiming" tabindex="-1"><a class="header-anchor" href="#performance-nodetiming"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancenodetiming" target="_blank" rel="noopener noreferrer">performance.nodeTiming</a></span></a></h3><p>å¥½çš„ï¼ŒNode.js ä¸­çš„ <code>performance.nodeTiming</code> æ˜¯ä¸€ä¸ªæ€§èƒ½ç›‘æ§å·¥å…·ï¼Œå®ƒå±äº Node.js å†…ç½®çš„ <code>perf_hooks</code> æ¨¡å—ã€‚è¿™ä¸ªå·¥å…·å¯ä»¥è®©æˆ‘ä»¬äº†è§£åˆ° Node.js ç¨‹åºä»å¯åŠ¨åˆ°è¿è¡Œè¿‡ç¨‹ä¸­å„ä¸ªé˜¶æ®µçš„æ—¶é—´ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯å¯¹äºå¼€å‘è€…æ¥è¯´éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ†æç¨‹åºçš„æ€§èƒ½ç“¶é¢ˆã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>performance.nodeTiming</code> æä¾›äº†ä¸€ä¸ªè¯¦ç»†çš„æ—¶é—´çº¿ï¼Œå…¶ä¸­åŒ…æ‹¬äº†ä»¥ä¸‹å‡ ä¸ªé˜¶æ®µçš„æ—¶é—´ç‚¹ï¼š</p><ul><li><code>nodeStart</code>: å½“ Node.js å¼€å§‹æ‰§è¡Œæ—¶çš„æ—¶é—´æˆ³ã€‚</li><li><code>v8Start</code>: V8 JavaScript å¼•æ“åˆå§‹åŒ–å¼€å§‹çš„æ—¶é—´æˆ³ã€‚</li><li><code>bootstrapComplete</code>: Node.js çš„å¼•å¯¼è¿‡ç¨‹å®Œæˆçš„æ—¶é—´æˆ³ã€‚</li><li><code>environment</code>: Node.js ç¯å¢ƒè®¾ç½®å®Œæˆçš„æ—¶é—´æˆ³ã€‚</li><li><code>loopStart</code>: äº‹ä»¶å¾ªç¯å¼€å§‹çš„æ—¶é—´æˆ³ã€‚</li><li><code>loopExit</code>: äº‹ä»¶å¾ªç¯é€€å‡ºçš„æ—¶é—´æˆ³ã€‚</li><li><code>nodeStop</code>: Node.js åœæ­¢æ‰§è¡Œçš„æ—¶é—´æˆ³ã€‚</li></ul><p>ç°åœ¨ï¼Œæˆ‘å°†é€šè¿‡ä¸€äº›ç®€å•çš„ä¾‹å­æ¥å±•ç¤ºå¦‚ä½•ä½¿ç”¨ <code>performance.nodeTiming</code>ã€‚</p><p><strong>ä¾‹å­ 1ï¼šæ£€æŸ¥ç¨‹åºå¯åŠ¨æ—¶é—´</strong></p><p>å‡è®¾æˆ‘ä»¬æƒ³è¦çŸ¥é“ Node.js ç¨‹åºå¯åŠ¨å¹¶ä¸”å‡†å¤‡å¥½æ‰§è¡Œä»£ç éœ€è¦å¤šé•¿æ—¶é—´ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¨‹åºå…¶ä»–éƒ¨åˆ† ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨åˆé€‚çš„ä½ç½®æŸ¥çœ‹å¯åŠ¨æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;Node.js å¯åŠ¨è€—æ—¶:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">nodeTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bootstrapComplete</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">nodeTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">nodeStart</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;æ¯«ç§’&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šè¾“å‡º Node.js ä»å¯åŠ¨åˆ°å‡†å¤‡å®Œå…¨ç»“æŸæ‰€è€—è´¹çš„æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’ã€‚</p><p><strong>ä¾‹å­ 2ï¼šåˆ†æç¨‹åºçš„æ•´ä½“ç”Ÿå‘½å‘¨æœŸ</strong></p><p>å¦‚æœä½ å¯¹æ•´ä¸ªç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸæ„Ÿå…´è¶£ï¼Œæ¯”å¦‚ä»å¯åŠ¨åˆ°åœæ­¢çš„å…¨éƒ¨è¿‡ç¨‹ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªè§‚å¯Ÿè€…å®ä¾‹æ¥ç›‘è§†ç‰¹å®šçš„æ€§èƒ½æ¡ç›®ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> nodeTiming</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">nodeTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;å¯åŠ¨åˆ°è„šæœ¬è¯„ä¼°å®Œæˆ:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    nodeTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bootstrapComplete</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> nodeTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">nodeStart</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;æ¯«ç§’&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;äº‹ä»¶å¾ªç¯å¯åŠ¨:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">nodeTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">loopStart</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> ?</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;å·²å‘ç”Ÿ&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;æœªå‘ç”Ÿ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;äº‹ä»¶å¾ªç¯é€€å‡º:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    nodeTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">loopExit</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> nodeTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">loopStart</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;æ¯«ç§’&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;ç¨‹åºæ€»è¿è¡Œæ—¶é—´:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    nodeTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">nodeStop</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> nodeTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">nodeStart</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;æ¯«ç§’&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ–­å¼€è§‚å¯Ÿè€…ä»¥é¿å…å†…å­˜æ³„éœ²</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">disconnect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¢é˜… nodeTiming æ€§èƒ½æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¨‹åºå…¶ä»–éƒ¨åˆ†...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>PerformanceObserver</code> æ¥ç›‘å¬æ€§èƒ½æ¡ç›®ï¼Œå¹¶ä¸”å½“è¿™äº›æ¡ç›®è¢«è®°å½•æ—¶ï¼Œæˆ‘ä»¬è¾“å‡ºäº†å®ƒä»¬ã€‚åœ¨è¿™ä¸ªä¾‹å­çš„è¾“å‡ºä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°ç¨‹åºä»å¯åŠ¨åˆ°è„šæœ¬è¯„ä¼°å®Œæˆã€äº‹ä»¶å¾ªç¯çš„å¯åŠ¨å’Œé€€å‡ºã€ä»¥åŠç¨‹åºçš„æ€»è¿è¡Œæ—¶é—´ã€‚</p><p>åˆ©ç”¨è¿™æ ·çš„æ•°æ®ï¼Œä½ å¯ä»¥å¯¹ä»£ç è¿›è¡Œä¼˜åŒ–ï¼Œæ¯”å¦‚å‡å°‘å¯åŠ¨æ—¶é—´ï¼Œæˆ–è€…ä¼˜åŒ–äº‹ä»¶å¾ªç¯çš„å¤„ç†é€Ÿåº¦ã€‚è¿™å¯¹äºå¼€å‘é«˜æ€§èƒ½çš„ Node.js åº”ç”¨éå¸¸é‡è¦ã€‚</p><h3 id="performance-now" tabindex="-1"><a class="header-anchor" href="#performance-now"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancenow" target="_blank" rel="noopener noreferrer">performance.now()</a></span></a></h3><p>Node.js çš„ <code>performance.now()</code> æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œå®ƒæä¾›äº†ä¸€ç§é«˜ç²¾åº¦çš„æ—¶é—´æµ‹é‡æ–¹å¼ã€‚è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªä»£è¡¨å½“å‰æ—¶é—´çš„é«˜ç²¾åº¦æ—¶é—´æˆ³ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ï¼Œè¯¥æ—¶é—´æˆ³å¯ä»¥ç”¨äºç²¾ç¡®æµ‹é‡ä»£ç æ‰§è¡Œçš„æ—¶é—´ã€‚ä¸åŒäº JavaScript ä¸­çš„ <code>Date.now()</code>ï¼Œ<code>performance.now()</code> æä¾›çš„æ—¶é—´æˆ³å…·æœ‰æ›´é«˜çš„ç²¾åº¦å’Œæ›´å°‘çš„æ—¶é—´æ¼‚ç§»ï¼Œè¿™ä½¿å¾—å®ƒéå¸¸é€‚åˆäºæ€§èƒ½æµ‹è¯•å’Œæ—¶é—´æ•æ„Ÿçš„åº”ç”¨ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-1"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="_1-æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´-1" tabindex="-1"><a class="header-anchor" href="#_1-æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´-1"><span>1. æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨è¯•å›¾ä¼˜åŒ–ä¸€ä¸ªå‡½æ•°ï¼Œéœ€è¦å‡†ç¡®åœ°çŸ¥é“å®ƒæ‰§è¡Œäº†å¤šé•¿æ—¶é—´ã€‚è¿™æ—¶ä½ å¯ä»¥ä½¿ç”¨ <code>performance.now()</code> æ¥æµ‹é‡æ‰§è¡Œæ—¶é—´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;perf_hooks&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®°å½•å¼€å§‹æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> startTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰§è¡Œä½ æƒ³è¦æµ‹é‡çš„ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // ä¸€äº›è€—æ—¶çš„æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®°å½•ç»“æŸæ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> endTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¡ç®—å¹¶æ‰“å°æ‰§è¡Œæ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ‰§è¡Œè€—æ—¶ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">endTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> startTime</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡ <code>require(&#39;perf_hooks&#39;)</code> å¼•å…¥ Node.js çš„æ€§èƒ½é’©å­æ¨¡å—ï¼Œç„¶åä½¿ç”¨ <code>performance.now()</code> åˆ†åˆ«åœ¨ä»£ç æ‰§è¡Œä¹‹å‰å’Œä¹‹åè·å–æ—¶é—´æˆ³ï¼Œæœ€åè®¡ç®—ä¸¤ä¸ªæ—¶é—´æˆ³ä¹‹é—´çš„å·®å€¼ï¼Œè¿™ä¸ªå·®å€¼å°±æ˜¯ä»£ç æ‰§è¡Œæ‰€éœ€çš„æ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚</p><h4 id="_2-æ€§èƒ½ç›‘æ§" tabindex="-1"><a class="header-anchor" href="#_2-æ€§èƒ½ç›‘æ§"><span>2. æ€§èƒ½ç›‘æ§</span></a></h4><p>å¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦å¿«é€Ÿå“åº”ç”¨æˆ·è¯·æ±‚çš„ç½‘ç»œæœåŠ¡æˆ–åº”ç”¨ï¼Œå¯èƒ½éœ€è¦ç›‘æ§æŸäº›å…³é”®éƒ¨åˆ†çš„æ‰§è¡Œæ—¶é—´ä»¥ç¡®ä¿æ€§èƒ½ã€‚ä½¿ç”¨ <code>performance.now()</code> å¯ä»¥å¸®åŠ©ä½ å®ç°è¿™ä¸€ç‚¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> express</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;express&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> app</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> express</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/some-endpoint&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ¨¡æ‹Ÿä¸€äº›å¤„ç†é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¤„ç†å®Œæˆï¼Œå‘é€å“åº”</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è¯·æ±‚å¤„ç†æ—¶é—´ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å¤„ç†å®Œæˆ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:3000/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„ Web æœåŠ¡å™¨ï¼Œå¯¹ç‰¹å®šç«¯ç‚¹çš„è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œå¹¶æµ‹é‡å¤„ç†è¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚å½“è¯·æ±‚åˆ°è¾¾ <code>/some-endpoint</code> æ—¶ï¼Œæˆ‘ä»¬è®°å½•å¼€å§‹æ—¶é—´ï¼Œåœ¨è¯·æ±‚å¤„ç†å®Œæ¯•åè®°å½•ç»“æŸæ—¶é—´ï¼Œç„¶åè®¡ç®—è¿™ä¸¤ä¸ªæ—¶é—´ç‚¹ä¹‹é—´çš„å·®ï¼Œå³ä¸ºå¤„ç†è¯¥è¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚</p><p>å¦‚ä¸Šæ‰€ç¤ºï¼Œ<code>performance.now()</code> ç”±äºå…¶é«˜ç²¾åº¦å’Œç¨³å®šæ€§ï¼Œåœ¨éœ€è¦æµ‹é‡ä»£ç æ®µæ‰§è¡Œæ—¶é—´æˆ–è¿›è¡Œæ€§èƒ½ç›‘æ§æ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="performance-setresourcetimingbuffersize-maxsize" tabindex="-1"><a class="header-anchor" href="#performance-setresourcetimingbuffersize-maxsize"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancesetresourcetimingbuffersizemaxsize" target="_blank" rel="noopener noreferrer">performance.setResourceTimingBufferSize(maxSize)</a></span></a></h3><p>å½“æˆ‘ä»¬è®¨è®º Node.js ä¸­çš„<code>performance.setResourceTimingBufferSize(maxSize)</code>æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ä¸€äº›åŸºæœ¬æ¦‚å¿µã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><ol><li><strong>Node.js</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªèƒ½å¤Ÿåœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç çš„ç¯å¢ƒï¼Œéå¸¸é€‚åˆå¤„ç†é«˜å¹¶å‘ã€I/O å¯†é›†å‹ä»»åŠ¡ã€‚</li><li><strong>æ€§èƒ½ç›‘æ§ï¼ˆPerformance Monitoringï¼‰</strong>ï¼šæŒ‡çš„æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶ç›‘è§†å’Œç®¡ç†å…¶æ€§èƒ½çš„è¿‡ç¨‹ã€‚åœ¨ Web å¼€å‘ä¸­ï¼Œè¿™é€šå¸¸æ¶‰åŠåˆ°æµ‹é‡é¡µé¢åŠ è½½æ—¶é—´ã€è„šæœ¬æ‰§è¡Œæ—¶é—´ç­‰ã€‚</li><li><strong>Resource Timing API</strong>ï¼šè¿™æ˜¯ä¸€ç§ Web æ€§èƒ½ APIï¼Œå…è®¸å¼€å‘è€…æ”¶é›†å’Œåˆ†æå…³äºé¡µé¢å’Œåº”ç”¨ä¸­èµ„æºåŠ è½½æ—¶é—´çš„ä¿¡æ¯ã€‚è™½ç„¶å®ƒæœ€åˆæ˜¯ä¸ºæµè§ˆå™¨ç¯å¢ƒè®¾è®¡çš„ï¼Œä½† Node.js ä¹Ÿæä¾›äº†ç±»ä¼¼çš„åŠŸèƒ½ï¼Œè®©å¼€å‘è€…å¯ä»¥ç›‘æ§åç«¯æ“ä½œçš„æ€§èƒ½ã€‚</li></ol><h3 id="performance-setresourcetimingbuffersize-maxsize-1" tabindex="-1"><a class="header-anchor" href="#performance-setresourcetimingbuffersize-maxsize-1"><span>performance.setResourceTimingBufferSize(maxSize)</span></a></h3><p><code>performance.setResourceTimingBufferSize(maxSize)</code>æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºè®¾ç½® Resource Timing ç¼“å†²åŒºçš„å¤§å°ã€‚ç¼“å†²åŒºæ˜¯å†…å­˜ä¸­çš„ä¸€å—åŒºåŸŸï¼Œç”¨äºæš‚æ—¶å­˜å‚¨ Resource Timing æ¡ç›®ï¼Œå³å…³äºèµ„æºåŠ è½½æ—¶é—´çš„æ•°æ®ä¿¡æ¯ã€‚</p><ul><li><strong>å‚æ•°</strong>ï¼š<code>maxSize</code>è¡¨ç¤ºç¼“å†²åŒºå¯ä»¥ä¿å­˜çš„ Resource Timing æ¡ç›®çš„æœ€å¤§æ•°é‡ã€‚</li><li><strong>ä½œç”¨</strong>ï¼šå½“ä½ åœ¨ Node.js åº”ç”¨ä¸­åŠ è½½æˆ–å¤„ç†å¤šä¸ªèµ„æºï¼ˆå¦‚ API è°ƒç”¨ã€æ•°æ®åº“æŸ¥è¯¢ç­‰ï¼‰æ—¶ï¼Œæ¯ä¸ªæ“ä½œçš„æ€§èƒ½æ•°æ®éƒ½å¯ä»¥è¢«è®°å½•ä¸‹æ¥ã€‚<code>setMaxSize</code>æ–¹æ³•ç¡®ä¿äº†åªæœ‰æœ€è¿‘çš„<code>maxSize</code>ä¸ªæ¡ç›®è¢«ä¿ç•™ï¼Œæ—§çš„æ¡ç›®ä¼šè¢«æ–°çš„æ›¿æ¢ï¼Œä»è€Œé¿å…äº†æ— é™å¢é•¿çš„æ•°æ®å ç”¨è¿‡å¤šå†…å­˜ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-1"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œè¯¥åº”ç”¨éœ€è¦é¢‘ç¹åœ°ä»ä¸åŒçš„ API æ‹‰å–æ•°æ®ã€‚ä¸ºäº†ä¼˜åŒ–æ€§èƒ½ï¼Œä½ æƒ³è¦ç›‘æ§è¿™äº› API è¯·æ±‚çš„å“åº”æ—¶é—´ã€‚</p><ol><li><p><strong>è®¾å®šç¼“å†²åŒºå¤§å°</strong>ï¼šé¦–å…ˆï¼Œä½ å†³å®šåªä¿ç•™æœ€æ–°çš„ 100 ä¸ª API è¯·æ±‚çš„æ€§èƒ½æ•°æ®ã€‚å› æ­¤ï¼Œä½ å¯ä»¥è¿™æ ·è®¾ç½®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setResourceTimingBufferSize</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>ç›‘æ§å’Œåˆ†æ</strong>ï¼šä¹‹åï¼Œæ¯æ¬¡è¿›è¡Œ API è¯·æ±‚æ—¶ï¼ŒNode.js ä¼šè‡ªåŠ¨å°†è¿™äº›è¯·æ±‚çš„æ€§èƒ½æ•°æ®å­˜å‚¨åˆ°ç¼“å†²åŒºã€‚å½“ç¼“å†²åŒºæ»¡äº†ï¼ˆå³è¾¾åˆ° 100 æ¡è®°å½•ï¼‰ï¼Œæœ€æ—©çš„è®°å½•ä¼šè¢«æ–°çš„è®°å½•æ›¿æ¢æ‰ã€‚</p></li><li><p><strong>åˆ©ç”¨æ•°æ®</strong>ï¼šä½ å¯ä»¥å®šæœŸæ£€æŸ¥è¿™äº›æ€§èƒ½æ•°æ®ï¼Œæ‰¾å‡ºå“åº”æ—¶é—´è¿‡é•¿çš„ API è¯·æ±‚ï¼Œè¿›è€Œå¯¹å…¶è¿›è¡Œä¼˜åŒ–ã€‚è¿™å¯èƒ½åŒ…æ‹¬æ›´æ¢æ›´å¿«çš„ API æœåŠ¡ã€ä¼˜åŒ–æŸ¥è¯¢å‚æ•°ç­‰ç­–ç•¥ã€‚</p></li></ol><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œ<code>performance.setResourceTimingBufferSize(maxSize)</code>å¸®åŠ©ä½ ç®¡ç†æ€§èƒ½æ•°æ®çš„è®°å½•ï¼Œé¿å…äº†å†…å­˜æº¢å‡ºçš„é£é™©ï¼ŒåŒæ—¶ä½¿å¾—æ€§èƒ½ä¼˜åŒ–å·¥ä½œå˜å¾—æ›´åŠ é«˜æ•ˆå’Œæœ‰é’ˆå¯¹æ€§ã€‚</p><h3 id="performance-timeorigin" tabindex="-1"><a class="header-anchor" href="#performance-timeorigin"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancetimeorigin" target="_blank" rel="noopener noreferrer">performance.timeOrigin</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>performance.timeOrigin</code> æ˜¯ä¸€ä¸ªä¸æ€§èƒ½ç›¸å…³çš„å±æ€§ï¼Œå®ƒä»£è¡¨äº†å½“å‰ Node.js è¿›ç¨‹å¯åŠ¨çš„æ—¶é—´ç‚¹ã€‚è¿™ä¸ªæ—¶é—´ç‚¹ä»¥ Unix Epoch æ—¶é—´ï¼ˆå³è‡ª 1970 å¹´ 1 æœˆ 1 æ—¥ä»¥æ¥çš„æ¯«ç§’æ•°ï¼‰çš„å½¢å¼ç»™å‡ºã€‚äº†è§£ <code>performance.timeOrigin</code> å¯¹äºæ€§èƒ½ç›‘æ§å’Œè°ƒä¼˜ç‰¹åˆ«æœ‰å¸®åŠ©ï¼Œå› ä¸ºå®ƒå¯ä»¥ä½œä¸ºä¸€ä¸ªåŸºå‡†ç‚¹ï¼Œå¸®åŠ©ä½ æµ‹é‡å’Œå¯¹æ¯”ä»£ç æ‰§è¡Œçš„æ—¶é—´ã€‚</p><p>è®©æˆ‘ä»¬é€šè¿‡ä¸€äº›å®é™…çš„ä¾‹å­æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ <code>performance.timeOrigin</code>ï¼š</p><h3 id="ä¾‹å­-1-æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´"><span>ä¾‹å­ 1ï¼šæµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´</span></a></h3><p>å‡è®¾ä½ æƒ³è¦æµ‹é‡ä¸€æ®µä»£ç æ‰§è¡Œæ‰€éœ€è¦çš„æ—¶é—´ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>performance.timeOrigin</code> æ¥è·å–ä¸€ä¸ªåŸºå‡†æ—¶é—´ï¼Œç„¶ååœ¨ä»£ç æ‰§è¡Œå®Œæˆåå†æ¬¡æ£€æµ‹å½“å‰æ—¶é—´ï¼Œä¸¤è€…çš„å·®å€¼å°±æ˜¯ä»£ç æ‰§è¡Œæ‰€éœ€çš„æ—¶é—´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> startTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timeOrigin</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–ä»£ç å¼€å§‹æ‰§è¡Œçš„æ—¶é—´ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œæ˜¯ä½ æƒ³è¦æµ‹é‡æ‰§è¡Œæ—¶é—´çš„ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> endTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timeOrigin</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–ä»£ç æ‰§è¡Œå®Œæˆçš„æ—¶é—´ç‚¹</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`ä»£ç æ‰§è¡Œè€—æ—¶ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">endTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> startTime</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä¾‹å­-2-æ€§èƒ½ç›‘æ§" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-æ€§èƒ½ç›‘æ§"><span>ä¾‹å­ 2ï¼šæ€§èƒ½ç›‘æ§</span></a></h3><p>å¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦é•¿æ—¶é—´è¿è¡Œçš„ Node.js åº”ç”¨ï¼Œå¯èƒ½ä¼šæƒ³è¦ç›‘æ§åº”ç”¨çš„æ€§èƒ½è¡¨ç°ã€‚ä½¿ç”¨ <code>performance.timeOrigin</code> å¯ä»¥å¸®åŠ©ä½ äº†è§£ä»ç¨‹åºå¯åŠ¨åˆ°å½“å‰æ—¶é—´ç‚¹çš„æ€»è¿è¡Œæ—¶é—´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> upTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timeOrigin</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¡ç®—ä»ç¨‹åºå¯åŠ¨åˆ°ç°åœ¨çš„æ€»æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`ç¨‹åºå·²è¿è¡Œï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">upTime</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">60000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¯åˆ†é’Ÿè®°å½•ä¸€æ¬¡</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä¾‹å­-3-äº‹ä»¶æ—¥å¿—è®°å½•" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-3-äº‹ä»¶æ—¥å¿—è®°å½•"><span>ä¾‹å­ 3ï¼šäº‹ä»¶æ—¥å¿—è®°å½•</span></a></h3><p>åœ¨ä¸€äº›éœ€è¦ç²¾ç¡®äº‹ä»¶æ—¥å¿—çš„åº”ç”¨ä¸­ï¼Œäº†è§£äº‹ä»¶å‘ç”Ÿçš„ç¡®åˆ‡æ—¶é—´æ˜¯å¾ˆé‡è¦çš„ã€‚<code>performance.timeOrigin</code> å¯ä»¥ä¸ºä½ æä¾›ä¸€ä¸ªç²¾ç¡®çš„æ—¶é—´åŸºå‡†ï¼Œå¸®åŠ©ä½ è®°å½•äº‹ä»¶å‘ç”Ÿçš„æ—¶é—´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> logEvent</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">event</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> eventTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timeOrigin</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¡ç®—äº‹ä»¶å‘ç”Ÿçš„æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`[</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">eventTime</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">]: äº‹ä»¶ &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">event</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot; å‘ç”Ÿ`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">logEvent</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ•°æ®åº“è¿æ¥æˆåŠŸ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">logEvent</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ•°æ®æ¥æ”¶å®Œæˆ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>performance.timeOrigin</code> åœ¨ä¸åŒåœºæ™¯ä¸‹çš„åº”ç”¨ï¼Œæ— è®ºæ˜¯æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´ã€æ€§èƒ½ç›‘æ§è¿˜æ˜¯äº‹ä»¶æ—¥å¿—è®°å½•ï¼Œå®ƒéƒ½æä¾›äº†ä¸€ä¸ªæ–¹ä¾¿è€Œæœ‰æ•ˆçš„æ–¹å¼æ¥è·å–æ—¶é—´ä¿¡æ¯ã€‚</p><h3 id="performance-timerify-fn-options" tabindex="-1"><a class="header-anchor" href="#performance-timerify-fn-options"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancetimerifyfn-options" target="_blank" rel="noopener noreferrer">performance.timerify(fn[, options])</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>performance.timerify(fn[, options])</code>æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å·¥å…·ï¼Œç”¨äºæµ‹é‡æŸä¸ªå‡½æ•°<code>fn</code>æ‰§è¡Œçš„æ€§èƒ½ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ äº†è§£å‡½æ•°æ‰§è¡Œéœ€è¦å¤šå°‘æ—¶é—´ã€‚è¿™ä¸ªåŠŸèƒ½å¯¹äºæ€§èƒ½è°ƒä¼˜å’Œå‘ç°ä»£ç ä¸­å¯èƒ½çš„ç“¶é¢ˆéå¸¸æœ‰ç”¨ã€‚ä¸‹é¢æˆ‘å°†è¯¦ç»†è§£é‡Šè¿™ä¸ªæ–¹æ³•ï¼Œå¹¶ç»™å‡ºå‡ ä¸ªå®ç”¨çš„ä¾‹å­ã€‚</p><h3 id="åŸºæœ¬ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç”¨æ³•"><span>åŸºæœ¬ç”¨æ³•</span></a></h3><p><code>performance.timerify()</code>æ–¹æ³•æ¥å—ä¸€ä¸ªå‡½æ•°<code>fn</code>ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚å½“ä½ è°ƒç”¨è¿™ä¸ªæ–°çš„å‡½æ•°æ—¶ï¼Œå®ƒä¼šæ‰§è¡ŒåŸå§‹çš„<code>fn</code>å‡½æ•°ï¼Œå¹¶ä¸”æµ‹é‡æ‰§è¡Œæ‰€éœ€çš„æ—¶é—´ã€‚è¿™ä¸ªæµ‹é‡çš„æ—¶é—´åŒ…æ‹¬<code>fn</code>å‡½æ•°æ‰§è¡Œçš„å¼€å§‹åˆ°ç»“æŸçš„æ•´ä¸ªå‘¨æœŸã€‚</p><p>å¯é€‰çš„<code>options</code>å‚æ•°å…è®¸ä½ å®šåˆ¶ä¸€äº›è¡Œä¸ºï¼Œä¾‹å¦‚è®¾ç½®ä¸€ä¸ªæœ€å¤§çš„è§‚æµ‹æ—¶é—´çª—å£ã€‚</p><h3 id="ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­"><span>ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªè®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—çš„å‡½æ•°ï¼Œä½ æƒ³è¦æµ‹é‡è¿™ä¸ªå‡½æ•°æ‰§è¡Œçš„æ—¶é—´ã€‚</p><p><strong>åŸå§‹å‡½æ•°:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fibonacci</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">n</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> n</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fibonacci</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">n</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fibonacci</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">n</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä½¿ç”¨<code>performance.timerify()</code>æµ‹é‡æ€§èƒ½:</strong></p><p>é¦–å…ˆï¼Œä½ éœ€è¦å¼•å…¥<code>perf_hooks</code>æ¨¡å—ä¸­çš„<code>performance</code>å¯¹è±¡ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç„¶åï¼Œä½ å¯ä»¥ä½¿ç”¨<code>performance.timerify()</code>æ¥â€œåŒ…è£…â€ä½ çš„æ–æ³¢é‚£å¥‘å‡½æ•°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> timedFibonacci</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">timerify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fibonacci</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ä¸ºäº†æ”¶é›†å’Œè¾“å‡ºæ€§èƒ½æ•°æ®ï¼Œä½ éœ€è¦è®¾ç½®ä¸€ä¸ª<code>PerformanceObserver</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clearMarks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">disconnect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;function&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ€åï¼Œä½ å¯ä»¥è°ƒç”¨<code>timedFibonacci</code>å¹¶ä¼ é€’ä½ æƒ³è¦è®¡ç®—çš„æ–æ³¢é‚£å¥‘æ•°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">timedFibonacci</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ–è€…ä»»ä½•ä½ æƒ³è¦æµ‹è¯•çš„æ•°å€¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šè¾“å‡ºç±»ä¼¼äºä»¥ä¸‹æ ¼å¼çš„æ€§èƒ½æ•°æ®ï¼ŒåŒ…æ‹¬å‡½æ•°æ‰§è¡Œæ‰€èŠ±è´¹çš„æ—¶é—´ï¼š</p><div class="language-plaintext line-numbers-mode" data-highlighter="shiki" data-ext="plaintext" data-title="plaintext" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>{</span></span>
<span class="line"><span>  name: &#39;fibonacci&#39;,</span></span>
<span class="line"><span>  entryType: &#39;function&#39;,</span></span>
<span class="line"><span>  startTime: 123456.789,</span></span>
<span class="line"><span>  duration: 10.12, // è¿™è¡¨ç¤ºå‡½æ•°æ‰§è¡ŒèŠ±è´¹äº†10.12æ¯«ç§’</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨"><span>å®é™…è¿ç”¨</span></a></h3><p>è¿™ä¸ªæ–¹æ³•ç‰¹åˆ«é€‚ç”¨äºä»¥ä¸‹å‡ ç§åœºæ™¯ï¼š</p><ul><li><strong>æ€§èƒ½è°ƒä¼˜</strong>ï¼šå½“ä½ éœ€è¦ä¼˜åŒ–ä»£ç ï¼Œç‰¹åˆ«æ˜¯å¯¹äºæ‰§è¡Œæ—¶é—´æ•æ„Ÿçš„åº”ç”¨ç¨‹åºæ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ¥æ‰¾å‡ºå“ªäº›å‡½æ•°æ˜¯ç“¶é¢ˆã€‚</li><li><strong>å›å½’æµ‹è¯•</strong>ï¼šåœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œå½“ä½ ä¿®æ”¹ä»£ç åï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ¥ç¡®ä¿ä¿®æ”¹æ²¡æœ‰å¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚</li><li><strong>æ¯”è¾ƒç®—æ³•æ€§èƒ½</strong>ï¼šå½“ä½ æœ‰å¤šç§å®ç°åŒä¸€åŠŸèƒ½çš„ç®—æ³•æ—¶ï¼Œå¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•æ¥æ¯”è¾ƒå®ƒä»¬å„è‡ªçš„æ‰§è¡Œæ—¶é—´ï¼Œå¸®åŠ©ä½ é€‰æ‹©æœ€ä¼˜çš„ç®—æ³•ã€‚</li></ul><p>é€šè¿‡ä½¿ç”¨<code>performance.timerify()</code>ï¼Œä½ å¯ä»¥è·å¾—å…³äºå‡½æ•°æ‰§è¡Œæ€§èƒ½çš„è¯¦ç»†æ•°æ®ï¼Œè¿™å¯¹äºä¼˜åŒ–ä½ çš„åº”ç”¨ç¨‹åºå’Œæé«˜å…¶è¿è¡Œæ•ˆç‡è‡³å…³é‡è¦ã€‚</p><h3 id="performance-tojson" tabindex="-1"><a class="header-anchor" href="#performance-tojson"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancetojson" target="_blank" rel="noopener noreferrer">performance.toJSON()</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>performance.toJSON()</code>æ–¹æ³•æ˜¯ç”¨æ¥å°†å½“å‰çš„æ€§èƒ½è®¡æ—¶æ•°æ®è½¬æ¢ä¸º JSON æ ¼å¼çš„ã€‚è¿™ä¸ªæ–¹æ³•å±äºæ€§èƒ½é’©å­ï¼ˆ<code>perf_hooks</code>æ¨¡å—ï¼‰çš„ä¸€éƒ¨åˆ†ï¼Œæ€§èƒ½é’©å­å…è®¸ä½ ç›‘æµ‹å’Œæµ‹é‡ä½ çš„ Node.js åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚</p><h3 id="ä½¿ç”¨performance-tojson" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨performance-tojson"><span>ä½¿ç”¨<code>performance.toJSON()</code></span></a></h3><p>è¦ä½¿ç”¨<code>performance.toJSON()</code>ï¼Œä½ é¦–å…ˆéœ€è¦å¼•å…¥ Node.js çš„<code>perf_hooks</code>æ¨¡å—ã€‚è¿™ä¸ªæ¨¡å—æä¾›äº†ä¸€å¥—æ€§èƒ½ç›‘æµ‹å·¥å…·ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºç›‘æµ‹äº‹ä»¶å¾ªç¯å»¶è¿Ÿã€æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´ç­‰ã€‚</p><p>ä»¥ä¸‹æ˜¯å¦‚ä½•å¼•å…¥<code>perf_hooks</code>æ¨¡å—å¹¶ä½¿ç”¨<code>performance.toJSON()</code>çš„åŸºæœ¬æ­¥éª¤ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰§è¡Œä¸€äº›ä»£ç æ“ä½œï¼Œç„¶å...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨performance.toJSON()è·å–å½“å‰çš„æ€§èƒ½æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> performanceData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toJSON</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">performanceData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-2"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´"><span>ç¤ºä¾‹ 1ï¼šæµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´</span></a></h4><p>å‡è®¾ä½ æƒ³è¦æµ‹é‡ä¸€ä¸ªå‡½æ•°æ‰§è¡Œæ‰€éœ€è¦çš„æ—¶é—´ã€‚ä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;perf_hooks&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œæ˜¯ä½ æƒ³è¦æµ‹é‡çš„å‡½æ•°æˆ–ä»£ç å—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å‡è®¾çš„é‡å¤æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ‰§è¡Œæ—¶é—´ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>performance.now()</code>æ¥è·å–é«˜ç²¾åº¦æ—¶é—´æˆ³ï¼Œä»è€Œè®¡ç®—å‡ºä»£ç å—çš„æ‰§è¡Œæ—¶é—´ã€‚ç„¶åï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨<code>performance.toJSON()</code>æ¥è·å–æ•´ä¸ªæ€§èƒ½è®°å½•çš„æ¦‚è§ˆã€‚</p><h4 id="ç¤ºä¾‹-2-ç›‘æµ‹äº‹ä»¶å¾ªç¯å»¶è¿Ÿ" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ç›‘æµ‹äº‹ä»¶å¾ªç¯å»¶è¿Ÿ"><span>ç¤ºä¾‹ 2ï¼šç›‘æµ‹äº‹ä»¶å¾ªç¯å»¶è¿Ÿ</span></a></h4><p>Node.js çš„äº‹ä»¶å¾ªç¯æ˜¯å…¶éé˜»å¡ I/O æ“ä½œçš„æ ¸å¿ƒã€‚ç›‘æµ‹äº‹ä»¶å¾ªç¯å»¶è¿Ÿå¯ä»¥å¸®åŠ©ä½ ç†è§£ä½ çš„åº”ç”¨ç¨‹åºåœ¨å¤„ç†å¼‚æ­¥æ“ä½œæ—¶çš„æ€§èƒ½ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ€§èƒ½è§‚å¯Ÿè€…æ¥ç›‘æµ‹äº‹ä»¶å¾ªç¯å»¶è¿Ÿ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`äº‹ä»¶å¾ªç¯å»¶è¿Ÿ: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;function&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰§è¡Œä¸€äº›å¼‚æ­¥æ“ä½œ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>PerformanceObserver</code>ç”¨äºç›‘æµ‹æŒ‡å®šçš„æ€§èƒ½æŒ‡æ ‡ï¼Œå½“æŒ‡æ ‡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå°±ä¼šè°ƒç”¨å›è°ƒå‡½æ•°ã€‚è¿™å¯ä»¥å¸®åŠ©ä½ å®æ—¶åœ°ç›‘æ§åº”ç”¨ç¨‹åºçš„æ€§èƒ½æƒ…å†µã€‚</p><h3 id="å°ç»“" tabindex="-1"><a class="header-anchor" href="#å°ç»“"><span>å°ç»“</span></a></h3><p><code>performance.toJSON()</code>æ˜¯ Node.js æ€§èƒ½é’©å­ä¸­çš„ä¸€ä¸ªå·¥å…·ï¼Œå®ƒèƒ½å¸®åŠ©ä½ ä»¥ JSON æ ¼å¼è·å–å½“å‰çš„æ€§èƒ½è®¡æ—¶æ•°æ®ã€‚é€šè¿‡ç»“åˆ<code>performance.now()</code>ã€<code>PerformanceObserver</code>ç­‰å·¥å…·ï¼Œä½ å¯ä»¥æœ‰æ•ˆåœ°ç›‘æµ‹å’Œåˆ†æä½ çš„ Node.js åº”ç”¨ç¨‹åºçš„æ€§èƒ½è¡¨ç°ã€‚</p><h4 id="event-resourcetimingbufferfull" tabindex="-1"><a class="header-anchor" href="#event-resourcetimingbufferfull"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#event-resourcetimingbufferfull" target="_blank" rel="noopener noreferrer">Event: &#39;resourcetimingbufferfull&#39;</a></span></a></h4><p>Node.js ä¸­çš„<code>&#39;resourcetimingbufferfull&#39;</code>äº‹ä»¶æ˜¯ä¸æ€§èƒ½ç›‘æ§ç›¸å…³çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå®ƒå±äº<code>perf_hooks</code>æ¨¡å—ã€‚è¿™ä¸ªæ¨¡å—å…è®¸ä½ ç›‘æ§å’Œæ”¶é›†æ€§èƒ½æ•°æ®ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£å’Œä¼˜åŒ–ä½ çš„åº”ç”¨ã€‚å…·ä½“æ¥è¯´ï¼Œ<code>&#39;resourcetimingbufferfull&#39;</code>äº‹ä»¶æ˜¯åœ¨æ€§èƒ½æ•°æ®çš„ç¼“å†²åŒºè¢«å¡«æ»¡æ—¶è§¦å‘çš„ã€‚</p><p>è¦ç†è§£è¿™ä¸ªäº‹ä»¶ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ˜ç™½ä»€ä¹ˆæ˜¯èµ„æºè®¡æ—¶ï¼ˆResource Timingï¼‰ã€‚èµ„æºè®¡æ—¶æ˜¯ä¸€ä¸ªæµè§ˆå™¨æä¾›çš„ APIï¼Œç”¨äºæ”¶é›†é¡µé¢å’Œå…¶ç›¸å…³èµ„æºï¼ˆå¦‚è„šæœ¬ã€æ ·å¼è¡¨ã€å›¾ç‰‡ç­‰ï¼‰åŠ è½½è¿‡ç¨‹ä¸­çš„è¯¦ç»†æ—¶é—´ä¿¡æ¯ã€‚è€Œåœ¨ Node.js ç¯å¢ƒä¸­ï¼Œè™½ç„¶æ²¡æœ‰æµè§ˆå™¨çš„é¡µé¢æ¦‚å¿µï¼Œä½†é€šè¿‡<code>perf_hooks</code>æ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—ç±»ä¼¼çš„æ€§èƒ½æŒ‡æ ‡æ¥ç›‘æ§ Node.js ç¨‹åºä¸­å¼‚æ­¥æ“ä½œçš„æ€§èƒ½ï¼Œæ¯”å¦‚ HTTP è¯·æ±‚ã€æ–‡ä»¶è¯»å†™ç­‰ã€‚</p><p>å½“æˆ‘ä»¬ä½¿ç”¨<code>perf_hooks</code>æ¨¡å—ç›‘æ§èµ„æºåŠ è½½æˆ–å…¶ä»–å¼‚æ­¥æ“ä½œæ—¶ï¼Œæ‰€æœ‰çš„æ€§èƒ½æŒ‡æ ‡æ•°æ®ä¼šè¢«å­˜å‚¨åœ¨ä¸€ä¸ªå†…éƒ¨çš„ç¼“å†²åŒºä¸­ã€‚<code>&#39;resourcetimingbufferfull&#39;</code>äº‹ä»¶å°±æ˜¯åœ¨è¿™ä¸ªç¼“å†²åŒºå·²æ»¡ï¼Œæ— æ³•å†æ¥å—æ–°çš„æ€§èƒ½æ¡ç›®æ—¶è§¦å‘çš„ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-1" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-1"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>é¦–å…ˆï¼Œä½ éœ€è¦å¼•å…¥<code>perf_hooks</code>æ¨¡å—ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç„¶åï¼Œä½ å¯ä»¥è®¾ç½®ä¸€ä¸ª<code>PerformanceObserver</code>æ¥ç›‘å¬<code>&#39;resourcetimingbufferfull&#39;</code>äº‹ä»¶ã€‚å½“äº‹ä»¶è§¦å‘æ—¶ï¼Œå¯ä»¥é‡‡å–ä¸€äº›è¡ŒåŠ¨ï¼Œæ¯”å¦‚å¢åŠ ç¼“å†²åŒºçš„å¤§å°ï¼Œä»¥ä¾¿èƒ½å¤Ÿè®°å½•æ›´å¤šçš„æ€§èƒ½æ¡ç›®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> observer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Resource Timing Buffer is Full&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¯ä»¥åœ¨è¿™é‡Œå¢åŠ ç¼“å†²åŒºå¤§å°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;resource&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffered</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è§¦å‘èµ„æºè®¡æ—¶</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-2"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><ol><li><p><strong>ç›‘æ§ API è¯·æ±‚æ€§èƒ½</strong>ï¼šå¦‚æœä½ çš„ Node.js åº”ç”¨ä¾èµ–äºå¤šä¸ªå¤–éƒ¨ APIï¼Œä½ å¯èƒ½æƒ³è¦ç›‘æ§è¿™äº› API è¯·æ±‚çš„æ€§èƒ½ã€‚ä½¿ç”¨<code>perf_hooks</code>ï¼Œä½ å¯ä»¥æ”¶é›†æ¯ä¸ªè¯·æ±‚çš„è€—æ—¶ï¼Œå½“ç¼“å†²åŒºæ»¡äº†ï¼Œä½ å¯èƒ½éœ€è¦è°ƒæ•´ç¼“å†²åŒºå¤§å°æˆ–è€…å¯¼å‡ºæ•°æ®åˆ°ä¸€ä¸ªå¤–éƒ¨å­˜å‚¨ä»¥ä¾¿åˆ†æã€‚</p></li><li><p><strong>æ–‡ä»¶å¤„ç†æ€§èƒ½ç›‘æ§</strong>ï¼šå¯¹äºæ¶‰åŠå¤§é‡æ–‡ä»¶è¯»å†™æ“ä½œçš„åº”ç”¨ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>perf_hooks</code>æ¥ç›‘æ§è¿™äº›æ“ä½œçš„æ€§èƒ½ã€‚è¿™æœ‰åŠ©äºè¯†åˆ«ç“¶é¢ˆæˆ–æ½œåœ¨çš„æ€§èƒ½é—®é¢˜ã€‚</p></li><li><p><strong>è‡ªå®šä¹‰æ€§èƒ½æ ‡è®°</strong>ï¼šé™¤äº†è‡ªåŠ¨è®°å½•çš„æ€§èƒ½æŒ‡æ ‡å¤–ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨<code>performance.mark()</code>æ–¹æ³•æ¥åˆ›å»ºè‡ªå®šä¹‰çš„æ€§èƒ½æ ‡è®°ã€‚è¿™å¯¹äºè·Ÿè¸ªç‰¹å®šæ“ä½œæˆ–ä»£ç æ®µçš„æ€§èƒ½éå¸¸æœ‰ç”¨ã€‚</p></li></ol><p>é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œ<code>&#39;resourcetimingbufferfull&#39;</code>äº‹ä»¶åŠ<code>perf_hooks</code>æ¨¡å—çš„å…¶ä»–åŠŸèƒ½ï¼Œä¸º Node.js åº”ç”¨çš„æ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–æä¾›äº†å¼ºå¤§çš„å·¥å…·ã€‚</p><h2 id="class-performanceentry" tabindex="-1"><a class="header-anchor" href="#class-performanceentry"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#class-performanceentry" target="_blank" rel="noopener noreferrer">Class: PerformanceEntry</a></span></a></h2><p>Node.js ä¸­çš„ <code>PerformanceEntry</code> ç±»æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ äº†è§£ä½ çš„åº”ç”¨ç¨‹åºæˆ–ä»£ç åœ¨è¿è¡Œæ—¶çš„æ€§èƒ½ã€‚è¿™ä¸ªç±»æ¥è‡ªäº Node.js çš„æ€§èƒ½é’©å­ï¼ˆ<code>perf_hooks</code>ï¼‰æ¨¡å—ã€‚è¦ç†è§£ <code>PerformanceEntry</code>ï¼Œé¦–å…ˆéœ€è¦äº†è§£å®ƒæ˜¯ç”¨äºä»€ä¹ˆçš„ã€‚</p><p>ç®€å•åœ°è¯´ï¼Œ<code>PerformanceEntry</code> å¯¹è±¡æä¾›äº†ç‰¹å®šæ“ä½œæˆ–äº‹ä»¶çš„æ—¶é—´ç›¸å…³ä¿¡æ¯ï¼Œæ¯”å¦‚æŒç»­æ—¶é—´ã€å¼€å§‹æ—¶é—´ç­‰ã€‚è¿™å¯¹äºæ€§èƒ½ç›‘æµ‹å’Œè°ƒä¼˜éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒå¯ä»¥å¸®åŠ©ä½ å‘ç°ä»£ç ä¸­çš„ç“¶é¢ˆã€‚</p><p>åœ¨ Node.js v21.7.1 æ–‡æ¡£ä¸­ï¼Œ<code>PerformanceEntry</code> ç±»æä¾›äº†ä»¥ä¸‹ä¸»è¦å±æ€§ï¼š</p><ul><li><code>name</code>: è¡¨ç¤ºæ€§èƒ½æ¡ç›®çš„åç§°ã€‚</li><li><code>entryType</code>: è¡¨ç¤ºæ€§èƒ½æ¡ç›®ç±»å‹çš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ &quot;mark&quot; æˆ– &quot;measure&quot;ã€‚</li><li><code>startTime</code>: è¡¨ç¤ºæ€§èƒ½æ¡ç›®å¼€å§‹çš„æ—¶é—´ã€‚</li><li><code>duration</code>: è¡¨ç¤ºæ‰§è¡Œæ“ä½œæ‰€èŠ±è´¹çš„æ—¶é—´ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-2"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="ä¾‹å­-1-æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´-1" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´-1"><span>ä¾‹å­ 1ï¼šæµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´</span></a></h4><p>å‡è®¾ä½ æƒ³çŸ¥é“ä¸€ä¸ªå‡½æ•°æ‰§è¡Œäº†å¤šé•¿æ—¶é—´ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>performance.mark()</code> æ–¹æ³•æ ‡è®°å¼€å§‹å’Œç»“æŸï¼Œç„¶åä½¿ç”¨ <code>performance.measure()</code> æ–¹æ³•æµ‹é‡ä¸¤ä¸ªæ ‡è®°ä¹‹é—´çš„æ—¶é—´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;perf_hooks&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ‡è®°å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;startFunction&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä½ æƒ³è¦æµ‹é‡æ‰§è¡Œæ—¶é—´çš„å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> myFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡½æ•°æ‰§è¡Œçš„å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">myFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ‡è®°ç»“æŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;endFunction&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹é‡å¼€å§‹åˆ°ç»“æŸä¹‹é—´çš„æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;My Function Execution Time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;startFunction&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;endFunction&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ PerformanceObserver æ¥è·å–æµ‹é‡ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;measure&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šæµ‹é‡ <code>myFunction</code> å‡½æ•°æ‰§è¡Œæ‰€éœ€çš„æ—¶é—´ï¼Œå¹¶é€šè¿‡ <code>console.log</code> æ‰“å°å‡ºæ¥ã€‚</p><h4 id="ä¾‹å­-2-ç›‘æ§å¼‚æ­¥æ“ä½œçš„æ€§èƒ½" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ç›‘æ§å¼‚æ­¥æ“ä½œçš„æ€§èƒ½"><span>ä¾‹å­ 2ï¼šç›‘æ§å¼‚æ­¥æ“ä½œçš„æ€§èƒ½</span></a></h4><p>Node.js çš„å¼‚æ­¥ç‰¹æ€§éå¸¸å¼ºå¤§ï¼Œä½†æœ‰æ—¶å€™ä¹Ÿéœ€è¦ç›‘æ§å¼‚æ­¥æ“ä½œçš„æ‰§è¡Œæ—¶é—´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> asyncOperation</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œï¼Œæ¯”å¦‚ä»æ•°æ®åº“è·å–æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–å½“å‰æ—¶é—´ä½œä¸ºå¼€å§‹æ—¶é—´</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asyncOperation</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼‚æ­¥æ“ä½œå®Œæˆæ—¶è·å–å½“å‰æ—¶é—´ä½œä¸ºç»“æŸæ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`å¼‚æ­¥æ“ä½œè€—æ—¶ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ç›´æ¥ä½¿ç”¨ <code>PerformanceEntry</code> å¯¹è±¡ï¼Œä½†é€šè¿‡ <code>performance.now()</code> æ–¹æ³•æ¥æ‰‹åŠ¨æµ‹é‡å¼‚æ­¥æ“ä½œçš„å¼€å§‹å’Œç»“æŸæ—¶é—´ï¼Œè¿™åŒæ ·æ˜¯åŸºäºæ€§èƒ½ç›‘æµ‹çš„æ€æƒ³ã€‚</p><h3 id="æ€»ç»“-2" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-2"><span>æ€»ç»“</span></a></h3><p><code>PerformanceEntry</code> å’Œ Node.js ä¸­çš„ <code>perf_hooks</code> æ¨¡å—è®©å¼€å‘è€…èƒ½å¤Ÿç²¾ç¡®åœ°æµ‹é‡å’Œç›‘æ§ä»£ç çš„æ€§èƒ½ã€‚æ— è®ºæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥æ“ä½œï¼Œéƒ½å¯ä»¥é€šè¿‡è¿™äº›å·¥å…·æ‰¾åˆ°æ€§èƒ½ç“¶é¢ˆï¼Œä»è€Œä¼˜åŒ–åº”ç”¨ç¨‹åºã€‚</p><h3 id="performanceentry-duration" tabindex="-1"><a class="header-anchor" href="#performanceentry-duration"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceentryduration" target="_blank" rel="noopener noreferrer">performanceEntry.duration</a></span></a></h3><p>Node.js ä¸­çš„ <code>performanceEntry.duration</code> å±äº Performance API çš„ä¸€éƒ¨åˆ†ï¼Œç‰¹åˆ«æ˜¯åœ¨æ€§èƒ½æµ‹é‡æ–¹é¢èµ·ç€å…³é”®ä½œç”¨ã€‚è¿™ä¸ªå±æ€§æä¾›äº†ä¸€ä¸ªç®€å•ä½†éå¸¸é‡è¦çš„åº¦é‡ï¼šå®ƒæµ‹é‡å¹¶è¿”å›ä¸€ä¸ªæŒ‡å®šæ€§èƒ½æ¡ç›®ï¼ˆperformance entryï¼‰çš„æŒç»­æ—¶é—´ã€‚</p><h3 id="åŸºæœ¬ç†è§£" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç†è§£"><span>åŸºæœ¬ç†è§£</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>performanceEntry</code> å¯¹è±¡ä»£è¡¨äº†ä¸€ä¸ªæ€§èƒ½äº‹ä»¶ï¼Œè€Œ <code>duration</code> å±æ€§åˆ™è¡¨ç¤ºè¯¥äº‹ä»¶çš„æŒç»­æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’ï¼ˆmsï¼‰ã€‚è¿™ä¸ªæœºåˆ¶å…è®¸å¼€å‘è€…æµ‹é‡ä»£ç å—ã€å¼‚æ­¥æ“ä½œæˆ–ä»»ä½•ç‰¹å®šä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´ï¼Œä»è€Œè¯„ä¼°å’Œä¼˜åŒ–åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p><strong>ä¾‹ 1: æµ‹é‡åŒæ­¥ä»£ç æ‰§è¡Œæ—¶é—´</strong></p><p>å‡è®¾ä½ æƒ³çŸ¥é“ä¸€ä¸ªå‡½æ•°å¤„ç†æ•°æ®æ‰€éœ€çš„æ—¶é—´ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>performance.mark()</code> æ–¹æ³•æ ‡è®°å¼€å§‹å’Œç»“æŸæ—¶åˆ»ï¼Œç„¶åä½¿ç”¨ <code>performance.measure()</code> ç”Ÿæˆä¸€ä¸ª <code>performanceEntry</code>ï¼Œå…¶ <code>duration</code> å±æ€§å°†å‘Šè¯‰ä½ å…·ä½“è€—æ—¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;perf_hooks&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ‡è®°å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;start-process&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰§è¡ŒæŸäº›æ“ä½œ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ¨¡æ‹Ÿä¸€é¡¹è€—æ—¶çš„æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ‡è®°ç»“æŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;end-process&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹é‡å¼€å§‹åˆ°ç»“æŸçš„æŒç»­æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;Processing time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;start-process&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;end-process&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ PerformanceObserver ç›‘å¬å¹¶æ‰“å°æµ‹é‡ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> observer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;measure&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä¾‹ 2: æµ‹é‡å¼‚æ­¥æ“ä½œçš„æ‰§è¡Œæ—¶é—´</strong></p><p>å¦‚æœä½ æƒ³æµ‹é‡ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼ˆä¾‹å¦‚æ–‡ä»¶è¯»å–ï¼‰çš„æ‰§è¡Œæ—¶é—´ï¼Œæµç¨‹ä¼šç¨æœ‰ä¸åŒï¼Œå› ä¸ºä½ éœ€è¦åœ¨æ“ä½œå®Œæˆåæ‰èƒ½æ ‡è®°ç»“æŸæ—¶é—´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start-async-operation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/path/to/file&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¼‚æ­¥æ“ä½œå®Œæˆï¼Œæ ‡è®°ç»“æŸæ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end-async-operation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹é‡æ“ä½œæŒç»­æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;Async operation time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;start-async-operation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;end-async-operation&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ­¤å¤„ä»ç„¶éœ€è¦ PerformanceObserver æ¥è·å–å’Œæ‰“å°æµ‹é‡ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ä¸å‰ä¾‹ç›¸åŒçš„ PerformanceObserver é€»è¾‘</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å°ç»“-1" tabindex="-1"><a class="header-anchor" href="#å°ç»“-1"><span>å°ç»“</span></a></h3><p>é€šè¿‡ä½¿ç”¨ <code>performanceEntry.duration</code> å±æ€§ï¼Œä½ å¯ä»¥ç²¾ç¡®åœ°æµ‹é‡ä»£ç æ‰§è¡Œã€å¼‚æ­¥æ“ä½œç­‰çš„æ—¶é—´å¼€é”€ï¼Œè¿™å¯¹äºè¯†åˆ«ç“¶é¢ˆã€è¿›è¡Œæ€§èƒ½è°ƒä¼˜åŠä¿è¯åº”ç”¨å“åº”é€Ÿåº¦è‡³å…³é‡è¦ã€‚å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½ä¼šç»“åˆå¤šç§æ€§èƒ½æµ‹é‡æ‰‹æ®µï¼Œä»¥å…¨é¢è¯„ä¼°å’Œæå‡åº”ç”¨æ€§èƒ½ã€‚</p><h3 id="performanceentry-entrytype" tabindex="-1"><a class="header-anchor" href="#performanceentry-entrytype"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceentryentrytype" target="_blank" rel="noopener noreferrer">performanceEntry.entryType</a></span></a></h3><p>å½“ä½ å¼€å§‹ä½¿ç”¨ Node.js è¿›è¡Œç¼–ç¨‹ï¼Œä¼šå‘ç°å®ƒä¸ä»…ä»…æ˜¯ç”¨æ¥å†™æœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºçš„ã€‚å€ŸåŠ©äº Node.js çš„æ€§èƒ½é’©å­ï¼ˆperf_hooksï¼‰æ¨¡å—ï¼Œä½ å¯ä»¥ç²¾ç¡®åœ°æµ‹é‡å’Œç›‘æ§ä»£ç çš„æ€§èƒ½ã€‚åœ¨è¿™ä¸ªé¢†åŸŸä¸­ï¼Œ<code>performanceEntry.entryType</code>å±æ€§æ‰®æ¼”äº†ä¸€ä¸ªå…³é”®è§’è‰²ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯performanceentry-entrytype" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯performanceentry-entrytype"><span>ä»€ä¹ˆæ˜¯<code>performanceEntry.entryType</code>?</span></a></h3><p>åœ¨ Node.js çš„æ€§èƒ½é’©å­ï¼ˆ<code>perf_hooks</code>ï¼‰æ¨¡å—ä¸­ï¼Œ<code>performanceEntry</code>å¯¹è±¡ä»£è¡¨äº†ä¸€ä¸ªå•ç‹¬çš„æ€§èƒ½æŒ‡æ ‡æˆ–è€…äº‹ä»¶ã€‚è¿™äº›æŒ‡æ ‡æˆ–äº‹ä»¶å¯ä»¥å¸®åŠ©ä½ ç†è§£ä½ çš„åº”ç”¨åœ¨è¿è¡Œæ—¶çš„æ€§èƒ½ç‰¹ç‚¹ã€‚è€Œ<code>performanceEntry.entryType</code>å±æ€§åˆ™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒæè¿°äº†è¯¥æ€§èƒ½æ¡ç›®çš„ç±»å‹ã€‚</p><p>ç®€å•åœ°è¯´ï¼Œ<code>entryType</code>å‘Šè¯‰ä½ è¿™ä¸ªæ€§èƒ½æ¡ç›®æ˜¯ä»€ä¹ˆç±»å‹çš„æ•°æ®ï¼Œä¾‹å¦‚å®ƒå¯èƒ½æ˜¯ä¸€ä¸ªæ ‡è®°ï¼ˆmarkï¼‰ï¼Œåº¦é‡ï¼ˆmeasureï¼‰ï¼Œèµ„æºè´Ÿè½½ï¼ˆresourceï¼‰ï¼Œç­‰ç­‰ã€‚è¿™å¯¹äºè¿‡æ»¤å’Œåˆ†æç‰¹å®šç±»å‹çš„æ€§èƒ½æ¡ç›®éå¸¸æœ‰ç”¨ã€‚</p><h3 id="å®è·µä¸­çš„åº”ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®è·µä¸­çš„åº”ç”¨ç¤ºä¾‹"><span>å®è·µä¸­çš„åº”ç”¨ç¤ºä¾‹</span></a></h3><ol><li><p><strong>è®°å½•å’Œæµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´</strong></p><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js åº”ç”¨ï¼Œå¹¶ä¸”æƒ³è¦çŸ¥é“æŸæ®µç‰¹å®šä»£ç æ‰§è¡Œäº†å¤šé•¿æ—¶é—´ã€‚ä½ å¯ä»¥ä½¿ç”¨æ€§èƒ½é’©å­æ¥æ ‡è®°å¼€å§‹å’Œç»“æŸçš„æ—¶é—´ç‚¹ï¼Œå¹¶è®¡ç®—å®ƒä»¬ä¹‹é—´çš„å·®å¼‚ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;perf_hooks&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ‡è®°å¼€å§‹æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;start&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰§è¡Œä¸€äº›æ“ä½œ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ‡è®°ç»“æŸæ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;end&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¡ç®—å¹¶è®°å½•å¼€å§‹åˆ°ç»“æŸä¹‹é—´çš„æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;My Special Operation&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;start&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;end&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨PerformanceObserverç›‘å¬å’Œæ‰“å°æµ‹é‡ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> observer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryType</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;measure&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">            console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æµ‹é‡å: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, èŠ±è´¹æ—¶é—´: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;measure&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡<code>performance.mark</code>æ–¹æ³•æ ‡è®°äº†&quot;start&quot;å’Œ&quot;end&quot;ä¸¤ä¸ªæ—¶é—´ç‚¹ã€‚éšåï¼Œé€šè¿‡<code>performance.measure</code>æ–¹æ³•è®¡ç®—äº†ä»&quot;start&quot;åˆ°&quot;end&quot;çš„æ—¶é—´å·®ï¼Œå¹¶å°†å…¶ä½œä¸ºä¸€ä¸ªæµ‹é‡ç»“æœè®°å½•ä¸‹æ¥ã€‚æœ€åï¼Œæˆ‘ä»¬è®¾ç½®äº†ä¸€ä¸ª<code>PerformanceObserver</code>æ¥ç›‘å¬æµ‹é‡ç±»å‹ï¼ˆ<code>measure</code>ï¼‰çš„æ€§èƒ½æ¡ç›®ï¼Œå¹¶è¾“å‡ºå®ƒä»¬çš„è¯¦æƒ…ã€‚</p></li><li><p><strong>ç›‘æ§èµ„æºåŠ è½½æ—¶é—´</strong></p><p>å¦ä¸€ä¸ªå®é™…åœºæ™¯å¯èƒ½æ¶‰åŠåˆ°ç›‘æ§æ–‡ä»¶æˆ–æ¨¡å—åŠ è½½æ—¶é—´ã€‚è™½ç„¶åœ¨ Node.js ç¯å¢ƒä¸­ï¼Œé€šå¸¸ä¸åƒåœ¨æµè§ˆå™¨ç¯å¢ƒä¸­é‚£æ ·å¤„ç†å¤§é‡èµ„æºåŠ è½½ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚åŠ¨æ€å¯¼å…¥æ¨¡å—æ—¶ï¼Œäº†è§£åŠ è½½æ—¶é—´å¯èƒ½æ˜¯æœ‰ç›Šçš„ã€‚</p></li><li><p><strong>æ€§èƒ½è°ƒä¼˜</strong></p><p>å¼€å‘è€…å¯ä»¥åˆ©ç”¨è¿™äº›æ€§èƒ½æŒ‡æ ‡è¿›è¡Œæ€§èƒ½è°ƒä¼˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæŸä¸ªæ“ä½œçš„æ‰§è¡Œæ—¶é—´è¿œè¿œè¶…è¿‡é¢„æœŸï¼Œå¼€å‘è€…å¯ä»¥è¿›ä¸€æ­¥æ£€æŸ¥ä»£ç ï¼Œçœ‹çœ‹æ˜¯å¦å­˜åœ¨æ•ˆç‡ä½ä¸‹çš„ç®—æ³•æˆ–ä¸å¿…è¦çš„èµ„æºè¯·æ±‚ç­‰é—®é¢˜ã€‚</p></li></ol><h3 id="æ€»ç»“-3" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-3"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡è¿™äº›ç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>performanceEntry.entryType</code>åœ¨ Node.js åº”ç”¨æ€§èƒ½ç›‘æ§å’Œåˆ†æä¸­çš„é‡è¦æ€§ã€‚æ­£ç¡®åœ°åˆ©ç”¨è¿™ä¸€å±æ€§ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£å’Œä¼˜åŒ–æˆ‘ä»¬çš„åº”ç”¨ã€‚</p><h3 id="performanceentry-name" tabindex="-1"><a class="header-anchor" href="#performanceentry-name"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceentryname" target="_blank" rel="noopener noreferrer">performanceEntry.name</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>performanceEntry.name</code>æ˜¯<code>PerformanceEntry</code>å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒæä¾›äº†å½“å‰æ€§èƒ½æ¡ç›®çš„åç§°ã€‚è¿™ä¸ªå±æ€§æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œå› ä¸ºå®ƒèƒ½å¸®åŠ©ä½ è¯†åˆ«å’ŒåŒºåˆ†åº”ç”¨ç¨‹åºä¸­ä¸åŒçš„æ€§èƒ½åº¦é‡ç‚¹ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-3"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œå¹¶ä¸”ä½ æƒ³ç›‘æ§å’Œæ”¹è¿›é¡µé¢åŠ è½½æˆ–è€…æŸä¸ªç‰¹å®šåŠŸèƒ½çš„æ€§èƒ½ã€‚ä½¿ç”¨ Node.js çš„æ€§èƒ½é’©å­ï¼ˆperformance hooksï¼‰ï¼Œä½ å¯ä»¥åˆ›å»ºæ€§èƒ½æ¡ç›®ï¼Œå¹¶ä¸”<code>performanceEntry.name</code>å°±èƒ½å¸®åŠ©ä½ è¯†åˆ«è¿™äº›æ¡ç›®ã€‚</p><ol><li><p><strong>ç›‘æ§ HTTP è¯·æ±‚å¤„ç†æ—¶é—´</strong></p><p>å‡è®¾ä½ çš„åº”ç”¨éœ€è¦å¤„ç† HTTP è¯·æ±‚ï¼Œå¹¶ä¸”ä½ æƒ³æµ‹é‡å¤„ç†æ¯ä¸ªè¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚ä½ å¯ä»¥åœ¨è¯·æ±‚å¼€å§‹æ—¶åˆ›å»ºä¸€ä¸ªæ€§èƒ½æ¡ç›®ï¼Œåœ¨è¯·æ±‚ç»“æŸæ—¶å†åˆ›å»ºä¸€ä¸ªæ€§èƒ½æ¡ç›®ï¼Œç„¶åä½¿ç”¨<code>performanceEntry.name</code>æ¥è¯†åˆ«è¿™äº›æ¡ç›®ï¼Œå¹¶è®¡ç®—å®ƒä»¬ä¹‹é—´çš„æ—¶é—´å·®ï¼Œè¿™æ ·å°±èƒ½å¾—åˆ°å¤„ç†æ—¶é—´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> handleRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¯·æ±‚å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;requestStart&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾è¿™é‡Œæ˜¯å¤„ç†è¯·æ±‚çš„ä»£ç </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¯·æ±‚ç»“æŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;requestEnd&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹é‡å¼€å§‹åˆ°ç»“æŸçš„æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;handleRequest&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;requestStart&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;requestEnd&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> observer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntriesByName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;handleRequest&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`å¤„ç†è¯·æ±‚è€—æ—¶ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">disconnect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>performance.mark()</code>æ¥æ ‡è®°æ—¶é—´ç‚¹ï¼Œå¹¶é€šè¿‡<code>performance.measure()</code>åˆ›å»ºäº†ä¸€ä¸ªåä¸º<code>handleRequest</code>çš„æ€§èƒ½æ¡ç›®ï¼Œå®ƒæµ‹é‡äº†<code>requestStart</code>å’Œ<code>requestEnd</code>ä¹‹é—´çš„æ—¶é—´å·®ã€‚<code>PerformanceObserver</code>ç”¨æ¥ç›‘å¬æ€§èƒ½æ¡ç›®ï¼Œå¹¶ä¸”å½“<code>handleRequest</code>æ¡ç›®è¢«åˆ›å»ºæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>list.getEntriesByName(&#39;handleRequest&#39;)</code>è·å–åˆ°è¿™ä¸ªæ¡ç›®ï¼Œå¹¶æ‰“å°å‡ºå¤„ç†è¯·æ±‚æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚</p></li><li><p><strong>ç›‘æ§å¼‚æ­¥æ“ä½œçš„æ€§èƒ½</strong></p><p>å¦‚æœä½ çš„åº”ç”¨ä¸­æœ‰å¼‚æ­¥æ“ä½œï¼Œæ¯”å¦‚è®¿é—®æ•°æ®åº“æˆ–æ–‡ä»¶ç³»ç»Ÿï¼Œä½ åŒæ ·å¯ä»¥ä½¿ç”¨æ€§èƒ½é’©å­æ¥ç›‘æ§è¿™äº›æ“ä½œçš„æ€§èƒ½ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> accessDatabase</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dbStart&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾è¿™é‡Œæ˜¯è®¿é—®æ•°æ®åº“çš„å¼‚æ­¥æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> someDatabaseOperation</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dbEnd&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;accessDatabase&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dbStart&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dbEnd&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> observer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntriesByName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;accessDatabase&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è®¿é—®æ•°æ®åº“è€—æ—¶ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">disconnect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">accessDatabase</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­å’Œä¸Šä¸€ä¸ªç±»ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºè¿™é‡Œæˆ‘ä»¬ç›‘æ§çš„æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„æ€§èƒ½ã€‚æˆ‘ä»¬åœ¨æ“ä½œå¼€å§‹å’Œç»“æŸæ—¶åˆ†åˆ«æ ‡è®°æ—¶é—´ç‚¹ï¼Œç„¶åæµ‹é‡è¿™ä¸¤ä¸ªç‚¹ä¹‹é—´çš„æ—¶é—´å·®æ¥å¾—åˆ°æ•´ä¸ªæ“ä½œçš„è€—æ—¶ã€‚</p></li></ol><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ°<code>performanceEntry.name</code>å¦‚ä½•å¸®åŠ©æˆ‘ä»¬åœ¨åº”ç”¨ä¸­æ ‡è¯†å’Œæµ‹é‡ä¸åŒçš„æ€§èƒ½åº¦é‡ç‚¹ã€‚è¿™å¯¹äºæ€§èƒ½ä¼˜åŒ–å’Œç›‘æ§æ˜¯éå¸¸æœ‰ç”¨çš„å·¥å…·ã€‚</p><h3 id="performanceentry-starttime" tabindex="-1"><a class="header-anchor" href="#performanceentry-starttime"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceentrystarttime" target="_blank" rel="noopener noreferrer">performanceEntry.startTime</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>performanceEntry.startTime</code> æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å±æ€§ï¼Œå®ƒæ˜¯ part of the Performance Timing APIã€‚è¿™ä¸ªå±æ€§å¸®åŠ©å¼€å‘è€…è·å–åˆ°æŸä¸ªç‰¹å®šæ“ä½œæˆ–ä»»åŠ¡å¼€å§‹æ‰§è¡Œçš„æ—¶é—´ç‚¹ã€‚åœ¨ v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œè¿™ä¸ªå±æ€§å±äº <code>PerformanceEntry</code> å¯¹è±¡ï¼Œç”¨æ¥è¡¨ç¤ºæ€§èƒ½åº¦é‡äº‹ä»¶çš„å¼€å§‹æ—¶é—´ï¼Œå…¶å€¼æ˜¯ä¸€ä¸ªé«˜ç²¾åº¦æ—¶é—´æˆ³ï¼Œå•ä½æ˜¯æ¯«ç§’ï¼ˆmsï¼‰ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-performanceentry" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-performanceentry"><span>ä»€ä¹ˆæ˜¯ <code>PerformanceEntry</code>ï¼Ÿ</span></a></h3><p>ç®€å•æ¥è¯´ï¼Œ<code>PerformanceEntry</code> å¯¹è±¡æä¾›äº†ç‰¹å®šæ“ä½œçš„æ€§èƒ½ä¿¡æ¯ï¼Œæ¯”å¦‚ä¸€ä¸ª HTTP è¯·æ±‚ã€æ–‡ä»¶è¯»å†™æ“ä½œæˆ–æ˜¯ä¸€æ®µä»£ç çš„æ‰§è¡Œã€‚æ¯ä¸ª <code>PerformanceEntry</code> å®ä¾‹éƒ½ä¼šåŒ…å«ä¸€äº›åŸºæœ¬å±æ€§ï¼Œå…¶ä¸­ <code>startTime</code> å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œè¡¨ç¤ºè¯¥æ€§èƒ½æ¡ç›®å¼€å§‹çš„æ—¶é—´ã€‚</p><h3 id="å¦‚ä½•ç†è§£-starttime" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ç†è§£-starttime"><span>å¦‚ä½•ç†è§£ <code>startTime</code>ï¼Ÿ</span></a></h3><ul><li><strong><code>startTime</code></strong> æ˜¯ä¸€ä¸ªè¡¨ç¤ºæ—¶é—´çš„æ•°å€¼ï¼Œå…·ä½“æ˜¯ä»æŸä¸ªèµ·å§‹ç‚¹åˆ°æ“ä½œå¼€å§‹çš„æ—¶é—´é—´éš”ã€‚åœ¨ Node.js ä¸­ï¼Œè¿™é€šå¸¸æŒ‡çš„æ˜¯ä» Node.js è¿›ç¨‹å¯åŠ¨åˆ°å½“å‰æ“ä½œå¼€å§‹çš„æ—¶é—´ã€‚</li><li>å®ƒçš„å•ä½æ˜¯æ¯«ç§’ï¼Œå› æ­¤æä¾›äº†éå¸¸ç²¾ç¡®çš„æ—¶é—´åº¦é‡ã€‚</li><li>å®ƒå¯ä»¥å¸®åŠ©ä½ è¯„ä¼°ç¨‹åºä¸­ç‰¹å®šéƒ¨åˆ†çš„æ€§èƒ½è¡¨ç°ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-3" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-3"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ä½ æ­£åœ¨æ„å»ºä¸€ä¸ª web åº”ç”¨ï¼Œå¹¶ä¸”ä½ æƒ³è¦ç›‘æµ‹ä¸€ä¸ªç‰¹å®šè¯·æ±‚å¤„ç†çš„æ€§èƒ½ï¼š</p><h4 id="ç¤ºä¾‹-1-æµ‹é‡-http-è¯·æ±‚å¤„ç†æ—¶é—´" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æµ‹é‡-http-è¯·æ±‚å¤„ç†æ—¶é—´"><span>ç¤ºä¾‹ 1: æµ‹é‡ HTTP è¯·æ±‚å¤„ç†æ—¶é—´</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ€§èƒ½è§‚å¯Ÿå™¨ï¼Œå®ƒä¼šè¢«è°ƒç”¨æ¯å½“æœ‰æ–°çš„æ€§èƒ½æ¡ç›®è¢«åŠ å…¥åˆ°æ€§èƒ½æ—¶é—´çº¿ä¸Š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`HTTP è¯·æ±‚å¤„ç†æ—¶é—´: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä¸€ä¸ªå¤„ç† HTTP è¯·æ±‚çš„å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> handleRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;startRequest&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åœ¨è¿™é‡Œè¿›è¡Œè¯·æ±‚å¤„ç†çš„é€»è¾‘...</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä¾‹å¦‚ï¼šæ•°æ®åº“æŸ¥è¯¢ï¼Œè¯»å–æ–‡ä»¶ç­‰æ“ä½œ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;endRequest&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä½¿ç”¨ measure æ–¹æ³•æ¥ç”Ÿæˆä¸€ä¸ªå¸¦æœ‰æŒç»­æ—¶é—´çš„æ€§èƒ½æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;HTTP Request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;startRequest&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;endRequest&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨å‡è®¾ `handleRequest` è¢«è°ƒç”¨äº†</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">handleRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† Node.js çš„ <code>perf_hooks</code> æ¨¡å—æ¥ç›‘æµ‹ HTTP è¯·æ±‚å¤„ç†çš„æ€§èƒ½ã€‚æˆ‘ä»¬é€šè¿‡æ ‡è®°å¼€å§‹å’Œç»“æŸæ—¶é—´ï¼Œç„¶ååˆ©ç”¨ <code>performance.measure()</code> æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ€§èƒ½æ¡ç›®ï¼Œè¿™ä¸ªæ¡ç›®å°±åŒ…å«äº† <code>startTime</code> å’Œç»“æŸæ—¶é—´ï¼Œä»¥åŠä¸¤è€…ä¹‹é—´çš„å·®å€¼ï¼ˆdurationï¼‰ã€‚é€šè¿‡ <code>PerformanceObserver</code> æˆ‘ä»¬å¯ä»¥è·å–åˆ°è¿™ä¸ªæ€§èƒ½æ¡ç›®ï¼Œå¹¶æ‰“å°å‡ºè¯·æ±‚å¤„ç†çš„æ—¶é—´ã€‚</p><h4 id="æ€»ç»“-4" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-4"><span>æ€»ç»“</span></a></h4><p>é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œ<code>startTime</code> å±æ€§ä¸ºå¼€å‘è€…æä¾›äº†ä¸€ç§å¼ºå¤§çš„å·¥å…·æ¥ç›‘æ§å’Œåˆ†æç¨‹åºä¸­å„ä¸ªéƒ¨åˆ†çš„æ€§èƒ½ã€‚æ— è®ºæ˜¯æ•°æ®åº“æ“ä½œã€æ–‡ä»¶ I/O è¿˜æ˜¯ä»»ä½•è€—æ—¶çš„ä»»åŠ¡ï¼Œä½¿ç”¨è¿™ç±»æ€§èƒ½æ ‡è®°å’Œæµ‹é‡æŠ€æœ¯ï¼Œå¼€å‘è€…å¯ä»¥è·å¾—å®æ—¶ã€å‡†ç¡®çš„æ€§èƒ½æ•°æ®ï¼Œè¿›è€Œä¼˜åŒ–å’Œæ”¹è¿›åº”ç”¨çš„æ€§èƒ½ã€‚</p><h2 id="class-performancemark" tabindex="-1"><a class="header-anchor" href="#class-performancemark"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#class-performancemark" target="_blank" rel="noopener noreferrer">Class: PerformanceMark</a></span></a></h2><p>å¥½çš„ï¼Œè®©æˆ‘æ¥ä¸ºä½ è¯¦ç»†è§£é‡Šä¸€ä¸‹ Node.js ä¸­çš„ <code>PerformanceMark</code> ç±»ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-performancemark" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-performancemark"><span>ä»€ä¹ˆæ˜¯ PerformanceMark?</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>PerformanceMark</code> æ˜¯æ€§èƒ½æµ‹é‡å·¥å…·çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå±äº performance API ä¸­çš„ä¸€ä¸ªç±»ã€‚è¿™ä¸ªç±»ç”¨æ¥åˆ›å»ºæ ‡è®°ï¼ˆmarksï¼‰ï¼Œè¿™äº›æ ‡è®°ä»£è¡¨äº†ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­çš„ç‰¹å®šæ—¶é—´ç‚¹ã€‚é€šè¿‡åˆ›å»ºè¿™æ ·çš„æ ‡è®°ï¼Œå¼€å‘è€…å¯ä»¥éå¸¸ç²¾ç¡®åœ°æµ‹é‡ä»£ç è¿è¡Œçš„æ—¶é—´ï¼Œä»è€Œå¸®åŠ©è¯Šæ–­æ€§èƒ½é—®é¢˜æˆ–ä¼˜åŒ–ç¨‹åºæ€§èƒ½ã€‚</p><h3 id="æ€ä¹ˆä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#æ€ä¹ˆä½¿ç”¨"><span>æ€ä¹ˆä½¿ç”¨ï¼Ÿ</span></a></h3><p>è¦ä½¿ç”¨ <code>PerformanceMark</code>ï¼Œé¦–å…ˆéœ€è¦å¼•å…¥ Node.js çš„ <code>perf_hooks</code> æ¨¡å—ä¸­çš„ <code>performance</code> å¯¹è±¡ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç„¶åï¼Œå¯ä»¥ä½¿ç”¨ <code>performance.mark()</code> å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„æ€§èƒ½æ ‡è®°ã€‚è¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•°ï¼šæ ‡è®°çš„åç§°ã€‚</p><p>ä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåä¸º &#39;start&#39; çš„æ€§èƒ½æ ‡è®°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™é‡Œæœ‰ä¸€äº›è¦æµ‹é‡çš„ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåä¸º &#39;end&#39; çš„æ€§èƒ½æ ‡è®°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ›å»ºäº†æ ‡è®°ä¹‹åï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>performance.measure()</code> æ–¹æ³•æ¥æµ‹é‡ä¸¤ä¸ªæ ‡è®°ä¹‹é—´çš„æ—¶é—´å·®ï¼Œä»è€Œå¾—åˆ°ä»£ç è¿è¡Œçš„æ—¶é—´ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-1"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æƒ³æµ‹é‡ä¸€ä¸ªæ•°æ®æ’åºç®—æ³•çš„è¿è¡Œæ—¶é—´ã€‚ä½ å¯ä»¥åœ¨ç®—æ³•å¼€å§‹æ‰§è¡Œå‰å’Œæ‰§è¡Œå®Œæˆååˆ†åˆ«è®¾ç½®æ ‡è®°ï¼Œç„¶åæµ‹é‡è¿™ä¸¤ä¸ªæ ‡è®°ä¹‹é—´çš„æ—¶é—´å·®ï¼Œä»¥æ­¤æ¥è¯„ä¼°ç®—æ³•çš„æ€§èƒ½ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåˆå§‹æ ‡è®°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;startSorting&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿä¸€ä¸ªéœ€è¦æµ‹é‡çš„æ’åºæ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> array</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sort</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªç»“æŸæ ‡è®°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;endSorting&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹é‡ &#39;startSorting&#39; å’Œ &#39;endSorting&#39; ä¹‹é—´çš„æ—¶é—´å·®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Sorting Time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;startSorting&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;endSorting&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–æµ‹é‡ç»“æœå¹¶è¾“å‡º</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> measure</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntriesByName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Sorting Time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ’åºæ“ä½œè€—æ—¶ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">measure</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ <code>performance.mark()</code> æ–¹æ³•åœ¨æ’åºæ“ä½œçš„å¼€å§‹å’Œç»“æŸå¤„åˆ›å»ºäº†æ€§èƒ½æ ‡è®°ï¼Œå¹¶ä¸”ä½¿ç”¨ <code>performance.measure()</code> æ–¹æ³•æ¥æµ‹é‡è¿™ä¸¤ä¸ªæ ‡è®°ä¹‹é—´çš„æ—¶é—´å·®ã€‚æœ€åé€šè¿‡ <code>performance.getEntriesByName()</code> æ–¹æ³•è·å–æµ‹é‡ç»“æœï¼Œå¹¶æ‰“å°å‡ºæ’åºæ“ä½œçš„è€—æ—¶ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒNode.js å…è®¸ä½ éå¸¸æ–¹ä¾¿åœ°è¿›è¡Œæ€§èƒ½æµ‹é‡å’Œåˆ†æï¼Œå¯¹äºæ€§èƒ½è°ƒä¼˜å’Œé—®é¢˜æ’æŸ¥è€Œè¨€æ˜¯ä¸€ä¸ªæå…¶æœ‰ç”¨çš„å·¥å…·ã€‚</p><h3 id="performancemark-detail" tabindex="-1"><a class="header-anchor" href="#performancemark-detail"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancemarkdetail" target="_blank" rel="noopener noreferrer">performanceMark.detail</a></span></a></h3><p>Node.js ä¸­çš„ <code>performanceMark.detail</code> å±äº Performance APIï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºç›‘æ§å’Œæµ‹é‡åº”ç”¨ç¨‹åºæ€§èƒ½çš„å·¥å…·ã€‚åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>performanceMark.detail</code> å…è®¸ä½ å‘ <code>performance.mark()</code> æ–¹æ³•æ·»åŠ é¢å¤–çš„ä¸Šä¸‹æ–‡ä¿¡æ¯æˆ–è€…ç»†èŠ‚ï¼Œè¿™äº›ä¿¡æ¯å¯ä»¥åœ¨ç¨åè¿›è¡Œæ€§èƒ½åˆ†ææ—¶ä½¿ç”¨ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-performance-mark" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-performance-mark"><span>ä»€ä¹ˆæ˜¯ <code>performance.mark()</code>?</span></a></h3><p>é¦–å…ˆï¼Œäº†è§£ä¸€ä¸‹ <code>performance.mark()</code> æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚è¿™æ˜¯ä¸€ä¸ªåˆ›å»ºæ€§èƒ½æ ‡è®°ç‚¹çš„æ–¹æ³•ï¼Œå®ƒè®°å½•äº†æŸä¸€ç‰¹å®šæ—¶é—´ç‚¹ï¼Œä»¥ä¾¿å¯¹åº”ç”¨ç¨‹åºçš„è¿è¡Œæ€§èƒ½è¿›è¡Œæµ‹é‡å’Œåˆ†æã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥åœ¨æ•°æ®å¼€å§‹åŠ è½½æ—¶å’Œæ•°æ®åŠ è½½ç»“æŸæ—¶å„è®¾ç½®ä¸€ä¸ªæ ‡è®°ç‚¹ï¼Œä¹‹åå°±å¯ä»¥æµ‹é‡åŠ è½½æ•°æ®æ‰€éœ€çš„æ€»æ—¶é—´ã€‚</p><h3 id="ä½¿ç”¨-performancemark-detail" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-performancemark-detail"><span>ä½¿ç”¨ <code>performanceMark.detail</code></span></a></h3><p><code>performanceMark.detail</code> çš„å¼•å…¥ï¼Œæä¾›äº†ä¸€ç§æ–¹å¼æ¥é™„åŠ æ›´å¤šå…³äºæ ‡è®°ç‚¹çš„ä¿¡æ¯ã€‚ä¸ä»…ä»…æ˜¯çŸ¥é“ä½•æ—¶å‘ç”Ÿäº†æŸä»¶äº‹ï¼Œç°åœ¨è¿˜å¯ä»¥çŸ¥é“ä¸ºä»€ä¹ˆä»¥åŠå¦‚ä½•å‘ç”Ÿçš„è¿™äº›é¢å¤–ä¿¡æ¯ã€‚</p><p>æ¯”æ–¹è¯´ï¼Œå¦‚æœä½ æ­£åœ¨è¿½è¸ªä¸€ä¸ª Web æœåŠ¡çš„å“åº”æ—¶é—´ï¼Œå¯èƒ½ä»…ä»…çŸ¥é“æœåŠ¡å“åº”æ‰€èŠ±è´¹çš„æ—¶é—´å¹¶ä¸å¤Ÿï¼Œä½ å¯èƒ½è¿˜æƒ³çŸ¥é“è¿”å›çš„æ•°æ®é‡å¤§å°ï¼Œæˆ–è€…æ˜¯å“åº”çŠ¶æ€ï¼ˆæˆåŠŸã€é”™è¯¯ç­‰ï¼‰ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-4"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£å¼€å‘ä¸€ä¸ªç½‘ç»œåº”ç”¨ï¼Œéœ€è¦ä»æœåŠ¡å™¨åŠ è½½ç”¨æˆ·æ•°æ®ã€‚ä½ å¯èƒ½æƒ³è¦æµ‹é‡è¿™ä¸ªè¿‡ç¨‹éœ€è¦å¤šé•¿æ—¶é—´ï¼ŒåŒæ—¶ä¹Ÿæƒ³è®°å½•ä¸‹è¯·æ±‚çš„çŠ¶æ€ï¼ˆæˆåŠŸæˆ–å¤±è´¥ï¼‰ï¼Œä»¥åŠè¿”å›çš„æ•°æ®é‡å¤§å°ã€‚è¿™æ—¶å€™ï¼Œ<code>performanceMark.detail</code> å°±èƒ½æ´¾ä¸Šç”¨åœºäº†ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> startMark</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `fetchStart-</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> endMark</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `fetchEnd-</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">startMark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼€å§‹æ ‡è®°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">response</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å‡è®¾æˆ‘ä»¬å…³å¿ƒçš„ç»†èŠ‚æ˜¯å“åº”çš„å­—èŠ‚å¤§å°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> detail</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">response</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">headers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;content-length&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">endMark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">detail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç»“æŸæ ‡è®°ï¼Œé™„åŠ è¯¦æƒ…</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`fetchMeasure-</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">startMark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">endMark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> response</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">json</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®æ€§èƒ½è§‚å¯Ÿå‘˜æ¥ç›‘å¬æŒ‡å®šçš„æµ‹é‡æ ‡è®°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entry</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> of</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      `</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> took </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ms, detail:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">detail</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œç”¨å®é™…çš„URLæ›¿æ¢ &#39;http://example.com&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>performance.mark()</code> æ¥æ ‡è®°ã€Œå¼€å§‹è¯·æ±‚ã€å’Œã€Œè¯·æ±‚ç»“æŸã€çš„æ—¶é—´ç‚¹ï¼Œå¹¶é€šè¿‡ <code>performance.measure()</code> è®¡ç®—å‡ºæ€»å…±è€—æ—¶ã€‚å½“æˆ‘ä»¬åœ¨ç»“æŸæ ‡è®°æ—¶ä¼ é€’ <code>{ detail }</code> å¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é™„åŠ ä»»ä½•æˆ‘ä»¬è®¤ä¸ºä¸æ­¤æ¬¡æ€§èƒ½æµ‹é‡ç›¸å…³çš„é¢å¤–ä¿¡æ¯ï¼Œå¦‚ç¤ºä¾‹ä¸­çš„å“åº”å¤§å°ï¼ˆ<code>size</code>ï¼‰ã€‚ç„¶åï¼Œé€šè¿‡ <code>PerformanceObserver</code> æˆ‘ä»¬å¯ä»¥ç›‘å¬è¿™äº›æµ‹é‡äº‹ä»¶ï¼Œå¹¶è·å–åˆ°æ¯æ¬¡æµ‹é‡çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æˆ‘ä»¬é™„åŠ çš„ç»†èŠ‚ã€‚</p><p>è¿™æ ·ï¼Œä½¿ç”¨ <code>performanceMark.detail</code> ä¸ä»…å¯ä»¥å¸®åŠ©æˆ‘ä»¬æµ‹é‡æ—¶é—´é—´éš”ï¼Œè¿˜èƒ½ä¸ºæˆ‘ä»¬æä¾›æ›´ä¸°å¯Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä»¥æ›´å…¨é¢åœ°ç†è§£åº”ç”¨ç¨‹åºçš„æ€§èƒ½è¡¨ç°ã€‚</p><h2 id="class-performancemeasure" tabindex="-1"><a class="header-anchor" href="#class-performancemeasure"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#class-performancemeasure" target="_blank" rel="noopener noreferrer">Class: PerformanceMeasure</a></span></a></h2><p>Node.js çš„ <code>PerformanceMeasure</code> æ˜¯ <code>perf_hooks</code> æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªé«˜ç²¾åº¦çš„æ—¶é—´æµ‹é‡å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä½ ç›‘æµ‹å’Œæ”¹è¿›ä½ çš„åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚</p><p>ç®€å•æ¥è¯´ï¼Œ<code>PerformanceMeasure</code> æ˜¯ä¸€ä¸ªè¡¨ç¤ºæ€§èƒ½æµ‹é‡ç»“æœçš„å¯¹è±¡ï¼Œå®ƒå¯ä»¥è®°å½•ä¸¤ä¸ªç‚¹ä¹‹é—´çš„æ—¶é—´é—´éš”ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥æµ‹é‡ä»£ç æ‰§è¡Œçš„æ—¶é—´ã€æ•°æ®åº“æŸ¥è¯¢çš„å“åº”æ—¶é—´æˆ–è€…ä»»ä½•å…¶ä»–éœ€è¦ç²¾ç¡®è®¡æ—¶çš„æ“ä½œã€‚</p><h3 id="åŸºæœ¬ä½¿ç”¨æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ä½¿ç”¨æ–¹æ³•"><span>åŸºæœ¬ä½¿ç”¨æ–¹æ³•</span></a></h3><ol><li><p><strong>åˆ›å»ºæµ‹é‡æ ‡è®°ç‚¹</strong>ï¼šé¦–å…ˆï¼Œä½ éœ€è¦å®šä¹‰ä½ æƒ³è¦æµ‹é‡çš„ä»£ç æ®µçš„å¼€å§‹å’Œç»“æŸã€‚è¿™æ˜¯é€šè¿‡åˆ›å»ºåä¸ºâ€œæ ‡è®°â€çš„ç‰¹æ®Šæ—¶é—´ç‚¹æ¥å®ç°çš„ã€‚</p></li><li><p><strong>è®¡ç®—æ—¶é—´é—´éš”</strong>ï¼šç„¶åï¼Œä½¿ç”¨è¿™äº›æ ‡è®°æ¥åˆ›å»ºä¸€ä¸ª<code>PerformanceMeasure</code>å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¼šè®¡ç®—å¹¶å­˜å‚¨å¼€å§‹æ ‡è®°å’Œç»“æŸæ ‡è®°ä¹‹é—´çš„æ—¶é—´å·®ã€‚</p></li></ol><h3 id="å®é™…ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-1"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æƒ³è¦æµ‹é‡ä¸€ä¸ªå‡½æ•°çš„æ‰§è¡Œæ—¶é—´ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®šä¹‰ä¸€ä¸ªè§‚å¯Ÿè€…æ¥ç›‘å¬æ€§èƒ½æµ‹é‡äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ‡è®°å¼€å§‹ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä½ æƒ³è¦æµ‹é‡çš„ä»£ç æ®µ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ ‡è®°ç»“æŸç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹é‡ä»Aåˆ°Bçš„æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A to B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>setTimeout</code> æ¥æ¨¡æ‹Ÿä¸€ä¸ªè€—æ—¶çš„æ“ä½œï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚æˆ–æ–‡ä»¶è¯»å–ã€‚æˆ‘ä»¬åœ¨æ“ä½œå¼€å§‹å‰ååˆ†åˆ«è®¾ç½®äº†æ ‡è®°ç‚¹ <code>&#39;A&#39;</code> å’Œ <code>&#39;B&#39;</code>ï¼Œç„¶åé€šè¿‡è°ƒç”¨ <code>performance.measure</code> æ–¹æ³•æ¥è®¡ç®—è¿™ä¸¤ç‚¹ä¹‹é—´çš„æ—¶é—´å·®ã€‚è¿™ä¸ªæ—¶é—´å·®å°±æ˜¯ä½ çš„æ“ä½œæ‰€è€—è´¹çš„æ—¶é—´ã€‚</p><p><code>PerformanceObserver</code> æ˜¯ç”¨æ¥å¼‚æ­¥æ¥æ”¶æ€§èƒ½æµ‹é‡ç»“æœçš„ã€‚å½“æˆ‘ä»¬è°ƒç”¨ <code>performance.measure</code> æ–¹æ³•æ—¶ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªæ€§èƒ½æ¡ç›®ï¼Œè¿™ä¸ªæ¡ç›®ä¼šè¢«ä¼ é€’ç»™æ‰€æœ‰è§‚å¯Ÿè€…ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œè§‚å¯Ÿè€…ç®€å•åœ°å°†æ¯ä¸ªæ€§èƒ½æ¡ç›®çš„åç§°å’ŒæŒç»­æ—¶é—´æ‰“å°åˆ°æ§åˆ¶å°ã€‚</p><p>è¿™ä¸ªå·¥å…·åœ¨ä¼˜åŒ–ä»£ç æ€§èƒ½ã€åˆ†æå’Œå‡å°‘å»¶è¿Ÿã€ä»¥åŠæé«˜å“åº”é€Ÿåº¦æ–¹é¢éå¸¸æœ‰ç”¨ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥æµ‹é‡å‡ ä¹ä»»ä½•äº‹æƒ…ï¼Œä»ç®€å•çš„å‡½æ•°è°ƒç”¨åˆ°å¤æ‚çš„å¼‚æ­¥æ“ä½œã€‚é€šè¿‡æ¯”è¾ƒä¸åŒä»£ç å®ç°çš„æ€§èƒ½ï¼Œä½ å¯ä»¥æ‰¾åˆ°æœ€ä¼˜çš„è§£å†³æ–¹æ¡ˆã€‚</p><h3 id="performancemeasure-detail" tabindex="-1"><a class="header-anchor" href="#performancemeasure-detail"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancemeasuredetail" target="_blank" rel="noopener noreferrer">performanceMeasure.detail</a></span></a></h3><p>å¥½çš„ï¼Œé¦–å…ˆæ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­çš„ <code>performanceMeasure.detail</code>ã€‚åœ¨ Node.js çš„æ€§èƒ½ç›‘æµ‹æ¨¡å—ï¼ˆ<code>perf_hooks</code>ï¼‰ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸åŒçš„å·¥å…·æ¥æµ‹é‡å’Œç›‘æ§ä»£ç çš„æ‰§è¡Œæ€§èƒ½ã€‚å…¶ä¸­ï¼Œ<code>performance.measure()</code> å‡½æ•°æ˜¯ä¸€ä¸ªé‡è¦çš„æ–¹æ³•ï¼Œå®ƒç”¨äºåˆ›å»ºä¸€ä¸ªåä¸ºâ€œmeasureâ€çš„æ—¶é—´æˆ³ï¼Œè¿™ä¸ªæ—¶é—´æˆ³è®°å½•äº†ä¸¤ä¸ªç‰¹å®šäº‹ä»¶ï¼ˆç§°ä½œæ ‡è®°ï¼Œmarkï¼‰ä¹‹é—´çš„æ—¶é—´é—´éš”ã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œå½“ä½ è°ƒç”¨ <code>performance.measure()</code> æ–¹æ³•æ—¶ï¼Œé™¤äº†å¯ä»¥å¾—åˆ°æµ‹é‡çš„æŒç»­æ—¶é—´ï¼ˆdurationï¼‰ï¼Œè¿˜å¯ä»¥å¾—åˆ°ä¸€ä¸ªé¢å¤–çš„ <code>detail</code> å±æ€§ã€‚<code>detail</code> å±æ€§åŒ…å«äº†åˆ›å»ºæµ‹é‡æ—¶æä¾›çš„è¯¦ç»†ä¿¡æ¯ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨åˆ›å»ºæµ‹é‡æ—¶ä¿å­˜é™„åŠ çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p><p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜è¿™ä¸ªæ¦‚å¿µï¼š</p><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç½‘ç»œæœåŠ¡ï¼Œä½ æƒ³è¦æµ‹é‡å¤„ç† HTTP è¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚ä½ å¯èƒ½ä¼šåœ¨è¯·æ±‚å¼€å§‹æ—¶è®¾ç½®ä¸€ä¸ªæ ‡è®°ï¼Œåœ¨è¯·æ±‚ç»“æŸæ—¶è®¾ç½®å¦ä¸€ä¸ªæ ‡è®°ï¼Œç„¶åæµ‹é‡ä¸¤ä¸ªæ ‡è®°ä¹‹é—´çš„æ—¶é—´å·®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ³¨å†Œä¸€ä¸ªè§‚å¯Ÿè€…æ¥ç›‘å¬ measure äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> measure</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`It took </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">measure</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ms to process the request.`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Additional details:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">detail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clearMarks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¸…é™¤æ‰€æœ‰è®¾ç½®çš„ marks</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿä¸€ä¸ªè¯·æ±‚å¤„ç†æµç¨‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> handleRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼€å§‹æ ‡è®°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾è¿™é‡Œæœ‰ä¸€äº›å¼‚æ­¥æ“ä½œï¼Œæ¯”å¦‚è®¿é—®æ•°æ®åº“æˆ–è°ƒç”¨å¤–éƒ¨API</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç»“æŸæ ‡è®°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // åˆ›å»ºæµ‹é‡å€¼ï¼Œå¹¶æä¾›é¢å¤–çš„ detail ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Handle Request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      detail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;This was a user login request.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å»¶è¿Ÿ1ç§’æ¨¡æ‹Ÿå¤„ç†æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">handleRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿäº†ä¸€ä¸ªå¤„ç†è¯·æ±‚çš„å‡½æ•° <code>handleRequest</code>ã€‚å‡½æ•°å†…éƒ¨è®¾å®šäº†ä¸¤ä¸ªæ ‡è®°ï¼Œä¸€ä¸ªåœ¨å¼€å§‹æ—¶ï¼ˆ&#39;start&#39;ï¼‰ï¼Œå¦ä¸€ä¸ªåœ¨æ¨¡æ‹Ÿçš„å¼‚æ­¥æ“ä½œå®Œæˆåï¼ˆ&#39;end&#39;ï¼‰ã€‚ç„¶åæˆ‘ä»¬è°ƒç”¨ <code>performance.measure()</code> æ¥åˆ›å»ºä¸€ä¸ªæµ‹é‡ï¼Œè®¡ç®—ä»&#39;start&#39;åˆ°&#39;end&#39;çš„æŒç»­æ—¶é—´ï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ªè¯¦æƒ…å¯¹è±¡ <code>{ detail: &#39;This was a user login request.&#39; }</code>ã€‚</p><p><code>PerformanceObserver</code> æ˜¯ç”¨æ¥ç›‘å¬æ€§èƒ½æµ‹é‡äº‹ä»¶å¹¶è¾“å‡ºç»“æœçš„ã€‚å½“ <code>performance.measure()</code> è¢«è°ƒç”¨æ—¶ï¼Œå®ƒä¼šæ•è·æµ‹é‡å¹¶è¾“å‡ºæŒç»­æ—¶é—´ä»¥åŠæˆ‘ä»¬æä¾›çš„è¯¦ç»†ä¿¡æ¯ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°åœ¨æ§åˆ¶å°ä¸Šæ‰“å°å‡ºè¯·æ±‚å¤„ç†æ—¶é—´å’Œé™„åŠ çš„ detail ä¿¡æ¯ï¼Œè¯´æ˜è¿™ä¸ªæµ‹é‡å…³è”çš„æ˜¯ç”¨æˆ·ç™»å½•è¯·æ±‚ã€‚</p><p>é€šè¿‡ <code>detail</code> å±æ€§ï¼Œä½ å¯ä»¥ä¸ºæ¯æ¬¡æµ‹é‡é™„åŠ ç‰¹å®šçš„å…ƒæ•°æ®ï¼Œä¾‹å¦‚è¯·æ±‚ç±»å‹ã€ç”¨æˆ· IDã€æˆ–æ˜¯å…¶ä»–ä»»ä½•å¯¹ä½ çš„æ€§èƒ½åˆ†ææœ‰å¸®åŠ©çš„ä¿¡æ¯ã€‚è¿™æ ·åœ¨åæœŸåˆ†ææ€§èƒ½æ•°æ®æ—¶ï¼Œä½ å°±èƒ½æ›´å®¹æ˜“åœ°ç†è§£æ¯ä¸ªæµ‹é‡å€¼çš„ä¸Šä¸‹æ–‡ã€‚</p><h2 id="class-performancenodeentry" tabindex="-1"><a class="header-anchor" href="#class-performancenodeentry"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#class-performancenodeentry" target="_blank" rel="noopener noreferrer">Class: PerformanceNodeEntry</a></span></a></h2><p>Node.js ä¸­çš„ <code>PerformanceNodeEntry</code> ç±»æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºæ€§èƒ½ç›‘æµ‹çš„å·¥å…·ï¼Œå®ƒå±äº <code>perf_hooks</code> æ¨¡å—ã€‚è¿™ä¸ªç±»è®©ä½ èƒ½å¤Ÿè·å–å’Œç†è§£ä½ çš„ Node.js åº”ç”¨çš„å„ç§æ€§èƒ½æŒ‡æ ‡ã€‚ç†è§£ <code>PerformanceNodeEntry</code> å¯¹äºä¼˜åŒ–åº”ç”¨æ€§èƒ½ã€è¯Šæ–­æ€§èƒ½ç“¶é¢ˆéå¸¸æœ‰å¸®åŠ©ã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>PerformanceNodeEntry</code> ç±»æä¾›äº†å…³äºç‰¹å®šæ€§èƒ½äº‹ä»¶çš„è¯¦ç»†ä¿¡æ¯ã€‚æ¯ä¸€ä¸ª <code>PerformanceNodeEntry</code> å®ä¾‹éƒ½ä»£è¡¨äº†ä¸€ä¸ªæ€§èƒ½äº‹ä»¶ï¼ŒåŒ…å«äº†äº‹ä»¶çš„åç§°ã€ç±»å‹ã€å¼€å§‹æ—¶é—´ã€æŒç»­æ—¶é—´ç­‰ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯å¯ä»¥å¸®åŠ©å¼€å‘è€…è¯¦ç»†äº†è§£åº”ç”¨ç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­çš„æ€§èƒ½è¡¨ç°ã€‚</p><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-4" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-4"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><ol><li><p><strong>ç›‘æµ‹å¼‚æ­¥æ“ä½œçš„æ€§èƒ½</strong>ï¼šå‡è®¾ä½ çš„ Node.js åº”ç”¨åŒ…å«äº†å¤§é‡çš„å¼‚æ­¥æ“ä½œï¼Œä½ æƒ³è¦ç›‘æ§è¿™äº›æ“ä½œçš„æ€§èƒ½è¡¨ç°ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>perf_hooks</code> æ¨¡å—æ¥è§‚æµ‹è¿™äº›æ“ä½œï¼Œæ¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œå®Œæˆæ—¶ï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ª <code>PerformanceNodeEntry</code> å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº†è¯¥æ“ä½œçš„è€—æ—¶ä¿¡æ¯ã€‚é€šè¿‡åˆ†æè¿™äº›æ•°æ®ï¼Œä½ å¯ä»¥äº†è§£å“ªäº›å¼‚æ­¥æ“ä½œå½±å“äº†åº”ç”¨çš„æ€§èƒ½ã€‚</p></li><li><p><strong>è¯Šæ–­æ€§èƒ½ç“¶é¢ˆ</strong>ï¼šå¦‚æœä½ çš„åº”ç”¨å‡ºç°æ€§èƒ½ä¸‹é™çš„é—®é¢˜ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>PerformanceNodeEntry</code> æ¥è¯†åˆ«æ€§èƒ½ç“¶é¢ˆã€‚é€šè¿‡è®°å½•ä¸åŒä»£ç æ®µçš„æ‰§è¡Œæ—¶é—´ï¼Œä½ å¯ä»¥ç²¾ç¡®åœ°å®šä½åˆ°é—®é¢˜æ‰€åœ¨ï¼Œè¿›è€Œå¯¹ç—‡ä¸‹è¯ï¼Œä¼˜åŒ–é‚£äº›è€—æ—¶è¾ƒé•¿çš„éƒ¨åˆ†ã€‚</p></li><li><p><strong>æ€§èƒ½åŸºå‡†æµ‹è¯•</strong>ï¼šåœ¨å¼•å…¥æ–°çš„åŠŸèƒ½æˆ–è€…ä¼˜åŒ–æ—§æœ‰ä»£ç ä¹‹åï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>PerformanceNodeEntry</code> æ¥è¿›è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•ã€‚é€šè¿‡æ¯”è¾ƒä»£ç æ›´æ”¹å‰åçš„æ€§èƒ½æŒ‡æ ‡ï¼Œä½ å¯ä»¥é‡åŒ–ä¼˜åŒ–çš„æ•ˆæœï¼Œç¡®ä¿ä»£ç çš„æ›´æ”¹æå‡äº†åº”ç”¨çš„æ€§èƒ½è€Œéé™ä½ã€‚</p></li></ol><p>ç®€è€Œè¨€ä¹‹ï¼Œ<code>PerformanceNodeEntry</code> æ˜¯ Node.js ä¸­ä¸€ä¸ªå¼ºå¤§çš„æ€§èƒ½åˆ†æå·¥å…·ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ è¯¦ç»†äº†è§£åº”ç”¨çš„æ€§èƒ½è¡¨ç°ï¼Œå¹¶æŒ‡å¯¼ä½ è¿›è¡Œæœ‰æ•ˆçš„æ€§èƒ½ä¼˜åŒ–ã€‚é€šè¿‡å¯¹æ€§èƒ½æ•°æ®çš„ä»”ç»†åˆ†æï¼Œä½ å¯ä»¥æå‡åº”ç”¨çš„å“åº”é€Ÿåº¦å’Œå¤„ç†èƒ½åŠ›ï¼Œæä¾›æ›´åŠ æµç•…çš„ç”¨æˆ·ä½“éªŒã€‚</p><h3 id="performancenodeentry-detail" tabindex="-1"><a class="header-anchor" href="#performancenodeentry-detail"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancenodeentrydetail" target="_blank" rel="noopener noreferrer">performanceNodeEntry.detail</a></span></a></h3><p><code>performanceNodeEntry.detail</code> æ˜¯ Node.js ä¸­ <code>perf_hooks</code> æ¨¡å—çš„ä¸€ä¸ªå±æ€§ï¼Œç”¨äºè·å–ä¸€äº›ç‰¹å®šçš„æ€§èƒ½æŒ‡æ ‡è¯¦æƒ…ã€‚åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œè¿™ä¸ªå±æ€§å±äº <code>PerformanceNodeTiming</code> ç±»ï¼Œå®ƒæ˜¯ <code>PerformanceEntry</code> å¯¹è±¡çš„ä¸€ä¸ªå­ç±»ï¼Œä¸“é—¨ç”¨äºè®°å½•å’Œæä¾› Node.js è¿›ç¨‹ç›¸å…³çš„æ€§èƒ½ä¿¡æ¯ã€‚</p><p>é¦–å…ˆï¼Œäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ <code>perf_hooks</code> æ¨¡å—ã€‚è¿™æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªæ¨¡å—ï¼Œå…è®¸ä½ ç›‘æ§ç¨‹åºçš„æ€§èƒ½ï¼ŒåŒ…æ‹¬ä½†ä¸é™äº HTTP è¯·æ±‚çš„å»¶æ—¶ã€æ–‡ä»¶è¯»å†™çš„é€Ÿåº¦ç­‰ã€‚å®ƒå¯ä»¥å¸®åŠ©ä½ ç†è§£ç¨‹åºåœ¨è¿è¡Œæ—¶çš„è¡¨ç°ï¼Œå¹¶å¯¹å…¶è¿›è¡Œä¼˜åŒ–ã€‚</p><p>å½“ä½ åˆ›å»ºä¸€ä¸ª <code>PerformanceObserver</code> æ¥è§‚å¯Ÿæ€§èƒ½æŒ‡æ ‡æ—¶ï¼Œæ¯å½“æœ‰æ–°çš„æ€§èƒ½æ¡ç›®è¢«è®°å½•ï¼Œ<code>PerformanceObserver</code> éƒ½ä¼šè¢«é€šçŸ¥ï¼Œå¹¶ä¸”ä½ å¯ä»¥è·å–åˆ°è¿™äº›æ¡ç›®çš„è¯¦ç»†ä¿¡æ¯ã€‚<code>performanceNodeEntry.detail</code> å°±æ˜¯å…¶ä¸­çš„ç»†èŠ‚æ•°æ®ï¼Œä½ å¯ä»¥åˆ©ç”¨å®ƒæ¥æ·±å…¥äº†è§£å…·ä½“çš„æ€§èƒ½äº‹ä»¶ã€‚</p><p>è¿™é‡Œç»™å‡ºå‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><h3 id="ç¤ºä¾‹-1-æµ‹é‡å¼‚æ­¥æ“ä½œçš„è€—æ—¶" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æµ‹é‡å¼‚æ­¥æ“ä½œçš„è€—æ—¶"><span>ç¤ºä¾‹ 1ï¼šæµ‹é‡å¼‚æ­¥æ“ä½œçš„è€—æ—¶</span></a></h3><p>å‡è®¾ä½ æƒ³çŸ¥é“ä¸€ä¸ªæ•°æ®åº“æŸ¥è¯¢æ“ä½œéœ€è¦å¤šé•¿æ—¶é—´ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>perf_hooks</code> æ¥æµ‹é‡è¿™ä¸ªæ“ä½œï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ€§èƒ½è§‚å¯Ÿè€…æ¥è§‚å¯Ÿâ€œmeasureâ€ç±»å‹çš„æ€§èƒ½æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;: &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;ms&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼€å§‹å’Œç»“æŸæ€§èƒ½æµ‹é‡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">someAsyncDatabaseQueryFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Database Query&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æµ‹é‡äº† <code>someAsyncDatabaseQueryFunction</code> å‡½æ•°çš„æ‰§è¡Œæ—¶é—´ã€‚<code>performance.mark</code> è¢«ç”¨æ¥è®¾ç½®æ—¶é—´æˆ³ï¼Œè€Œ <code>performance.measure</code> è¢«ç”¨æ¥è®¡ç®—ä¸¤ä¸ªæ—¶é—´æˆ³ä¹‹é—´çš„å·®å€¼ï¼ˆå³è€—æ—¶ï¼‰ã€‚</p><h3 id="ç¤ºä¾‹-2-ç›‘å¬-node-js-ç‰¹å®šäº‹ä»¶çš„æ€§èƒ½" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ç›‘å¬-node-js-ç‰¹å®šäº‹ä»¶çš„æ€§èƒ½"><span>ç¤ºä¾‹ 2ï¼šç›‘å¬ Node.js ç‰¹å®šäº‹ä»¶çš„æ€§èƒ½</span></a></h3><p>Node.js åœ¨å†…éƒ¨ä¹Ÿä¼šäº§ç”Ÿä¸€äº›æ€§èƒ½æ¡ç›®ï¼Œæ¯”å¦‚å¯åŠ¨æ—¶é—´ã€è„šæœ¬è¯„ä¼°æ—¶é—´ç­‰ã€‚ä½ å¯ä»¥é€šè¿‡ <code>PerformanceObserver</code> æ¥è·å¾—è¿™äº›å†…éƒ¨äº‹ä»¶çš„æ€§èƒ½æ•°æ®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entry</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> of</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">detail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Additional details: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">JSON</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">stringify</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">detail</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è§¦å‘ä¸€äº›æ“ä½œï¼Œä¾‹å¦‚ HTTP è¯·æ±‚æˆ–æ–‡ä»¶ I/O</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç›‘å¬äº†ç±»å‹ä¸º <code>node</code> çš„æ€§èƒ½æ¡ç›®ï¼Œè¿™å°†æ•è· Node.js å†…éƒ¨çš„æ€§èƒ½äº‹ä»¶ã€‚å¦‚æœè¿™äº›äº‹ä»¶åŒ…å«é¢å¤–çš„ç»†èŠ‚ï¼Œé‚£ä¹ˆè¿™äº›ç»†èŠ‚ä¼šè¢«åŒ…å«åœ¨ <code>entry.detail</code> ä¸­ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>performanceNodeEntry.detail</code> æä¾›äº†å¯¹ Node.js æ€§èƒ½äº‹ä»¶æ›´æ·±å±‚æ¬¡çš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¯ä»¥å¸®åŠ©å¼€å‘è€…è¯Šæ–­å’Œä¼˜åŒ–ä»–ä»¬çš„åº”ç”¨ç¨‹åºã€‚ç„¶è€Œï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¸éœ€è¦ç›´æ¥è®¿é—® <code>detail</code> å±æ€§ï¼Œå› ä¸ºå¸¸è§„çš„æ€§èƒ½æ¡ç›®å·²ç»è¶³å¤Ÿæä¾›åŸºç¡€çš„æ€§èƒ½æŒ‡æ ‡äº†ã€‚åªæœ‰å½“ä½ éœ€è¦å…³äºç‰¹å®š Node.js å†…éƒ¨äº‹ä»¶çš„é™„åŠ ä¿¡æ¯æ—¶ï¼Œæ‰éœ€è¦æŸ¥çœ‹ <code>detail</code>ã€‚</p><h3 id="performancenodeentry-flags" tabindex="-1"><a class="header-anchor" href="#performancenodeentry-flags"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancenodeentryflags" target="_blank" rel="noopener noreferrer">performanceNodeEntry.flags</a></span></a></h3><p>Node.js çš„ <code>performanceNodeEntry.flags</code> å±äºæ€§èƒ½ï¼ˆ<code>perf_hooks</code>ï¼‰æ¨¡å—ä¸­çš„ä¸€ä¸ªç‰¹æ€§ï¼Œç”¨äºæä¾›æ€§èƒ½æµ‹é‡æ¡ç›®çš„é™„åŠ ä¿¡æ¯ã€‚åœ¨ Node.js v21.7.1 åŠå…¶ä»–ç‰ˆæœ¬ä¸­ï¼Œ<code>performanceNodeEntry</code> å¯¹è±¡è¡¨ç¤ºä¸€ä¸ªç‰¹å®šçš„æ€§èƒ½æ¡ç›®ï¼Œå¦‚ HTTP è¯·æ±‚ã€æ–‡ä»¶è¯»å†™ç­‰æ“ä½œçš„æ€§èƒ½æ•°æ®ã€‚è€Œ <code>flags</code> å±æ€§åˆ™ç”¨æ¥æ ‡è®°è¯¥æ€§èƒ½æ¡ç›®çš„ç‰¹å®šçŠ¶æ€æˆ–ç‰¹å¾ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œ<code>flags</code> æ˜¯ä¸€ä¸ªæ•´å‹ï¼ˆIntegerï¼‰ï¼Œé€šè¿‡ä½è¿ç®—çš„æ–¹å¼æ¥è¡¨ç¤ºä¸åŒçš„çŠ¶æ€ã€‚æ¯ä¸€ä¸ªä½ï¼ˆæˆ–è€…è¯´æ¯ä¸€ç»„ä½ï¼‰å¯ä»¥ä»£è¡¨ä¸€ä¸ªç‰¹å®šçš„æ ‡è®°æˆ–å±æ€§ã€‚è¿™ç§è®¾è®¡ä½¿å¾— <code>flags</code> å¯ä»¥åŒæ—¶è¡¨ç¤ºå¤šç§çŠ¶æ€ã€‚</p><p>è¿™é‡Œæœ‰å‡ ä¸ªå®é™…çš„è¿ç”¨ä¾‹å­æ¥å¸®åŠ©ä½ ç†è§£ï¼š</p><ol><li><p><strong>è¯Šæ–­æ€§èƒ½é—®é¢˜</strong>ï¼šå¼€å‘è€…å¯ä»¥é€šè¿‡æ£€æŸ¥ <code>performanceNodeEntry</code> å¯¹è±¡ä¸­çš„ <code>flags</code> å€¼æ¥ç¡®å®šæ€§èƒ½æ¡ç›®æ˜¯å¦æœ‰ç‰¹å®šçš„çŠ¶æ€ï¼Œæ¯”å¦‚æ˜¯å¦è¢«æ ‡è®°ä¸ºå¼‚æ­¥æ“ä½œæˆ–æ˜¯å¦æ˜¯åœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹è¢«åˆ›å»ºçš„ã€‚è¿™å¯¹äºè¯Šæ–­æ€§èƒ½é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤æ‚çš„åº”ç”¨ä¸­ï¼Œéå¸¸æœ‰ç”¨ã€‚</p></li><li><p><strong>æ€§èƒ½ç›‘æ§å’Œåˆ†æ</strong>ï¼šåœ¨æ„å»ºå¤§å‹åº”ç”¨æ—¶ï¼Œæ€§èƒ½ç›‘æ§å˜å¾—éå¸¸é‡è¦ã€‚<code>performanceNodeEntry.flags</code> å¯ä»¥ç”¨æ¥ç­›é€‰ç‰¹å®šç±»å‹çš„æ€§èƒ½æ¡ç›®ï¼Œä»è€Œå¸®åŠ©å¼€å‘è€…èšç„¦äºæ„Ÿå…´è¶£çš„æ€§èƒ½æ•°æ®ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½åªå¯¹æ ‡è®°ä¸ºå¼‚æ­¥çš„æ“ä½œæ„Ÿå…´è¶£ã€‚</p></li><li><p><strong>æ€§èƒ½æ•°æ®çš„ç»†ç²’åº¦æ§åˆ¶</strong>ï¼š<code>flags</code> æä¾›äº†ä¸€ç§ç»†ç²’åº¦æ§åˆ¶çš„æ–¹å¼ï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥åŸºäºæ¡ç›®çš„çŠ¶æ€å®šåˆ¶æ€§èƒ½æ•°æ®çš„æ”¶é›†ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´æ€§èƒ½æ•°æ®çš„æ”¶é›†ç­–ç•¥ï¼Œè€Œä¸æ˜¯ç›²ç›®åœ°æ”¶é›†æ‰€æœ‰æ€§èƒ½æ¡ç›®ã€‚</p></li></ol><p>å°½ç®¡ Node.js æ–‡æ¡£æä¾›äº†å…³äº <code>performanceNodeEntry</code> å’Œ <code>flags</code> çš„åŸºæœ¬ä¿¡æ¯ï¼Œä½†å…·ä½“çš„ <code>flags</code> å€¼å’Œå®ƒä»¬ä»£è¡¨çš„å«ä¹‰å¯èƒ½ä¼šéš Node.js çš„ç‰ˆæœ¬ä¸åŒè€Œæœ‰æ‰€å˜åŒ–ã€‚å› æ­¤ï¼Œç†è§£è¿™äº›æ ‡è®°å¦‚ä½•åœ¨ä½ çš„ç‰¹å®šç‰ˆæœ¬å’Œåœºæ™¯ä¸‹å·¥ä½œæ˜¯å¾ˆé‡è¦çš„ã€‚å¦‚æœä½ éœ€è¦å¤„ç†ç‰¹å®šçš„æ€§èƒ½é—®é¢˜æˆ–è€…æƒ³è¦æ›´æ·±å…¥åœ°äº†è§£æ€§èƒ½æ•°æ®çš„æ”¶é›†ä¸åˆ†æï¼ŒæŸ¥çœ‹æœ€æ–°çš„ Node.js æ–‡æ¡£å’Œç¤¾åŒºæä¾›çš„èµ„æºä¼šå¾ˆæœ‰å¸®åŠ©ã€‚</p><h3 id="performancenodeentry-kind" tabindex="-1"><a class="header-anchor" href="#performancenodeentry-kind"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancenodeentrykind" target="_blank" rel="noopener noreferrer">performanceNodeEntry.kind</a></span></a></h3><p>ç†è§£ <code>performanceNodeEntry.kind</code> çš„æ¦‚å¿µä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€ä¸‹ Node.js ä¸­çš„ <code>perf_hooks</code> æ¨¡å—ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>perf_hooks</code> æ¨¡å—æä¾›äº†ç›‘æ§æ€§èƒ½çš„å·¥å…·ã€‚è¿™ä¸ªæ¨¡å—å¯ä»¥ç”¨æ¥æµ‹é‡ä»£ç è¿è¡Œæ—¶é—´ã€ç›‘æ§æ€§èƒ½æŒ‡æ ‡ç­‰ã€‚</p><p>å…¶ä¸­ï¼Œ<code>PerformanceNodeTiming</code> ç±»æ˜¯ <code>perf_hooks</code> æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒç”¨äºæ”¶é›†å…³äºç‰¹å®š Node.js è¿›ç¨‹ç”Ÿå‘½å‘¨æœŸå†…å„ä¸ªé˜¶æ®µçš„æ€§èƒ½æŒ‡æ ‡ã€‚æ¯ä¸ª <code>PerformanceNodeTiming</code> å®ä¾‹éƒ½ä»£è¡¨äº†è¿›ç¨‹è¿è¡Œçš„ä¸€ä¸ªç‰¹å®šæ—¶åˆ»æˆ–é˜¶æ®µï¼Œä¾‹å¦‚ç¨‹åºå¯åŠ¨ã€å¼€å§‹æ‰§è¡Œ JavaScript ä»£ç ã€äº‹ä»¶å¾ªç¯å¯åŠ¨ç­‰ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ·±å…¥åˆ°ä½ çš„é—®é¢˜ä¸­â€”â€”<code>performanceNodeEntry.kind</code>ã€‚</p><h3 id="performancenodeentry-kind-1" tabindex="-1"><a class="header-anchor" href="#performancenodeentry-kind-1"><span><code>performanceNodeEntry.kind</code></span></a></h3><p><code>performanceNodeEntry.kind</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå­˜åœ¨äº Node.js v21.7.1 ä¸­çš„ <code>PerformanceNodeTiming</code> å®ä¾‹ä¸Šã€‚è¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ªæ•´æ•°å€¼ï¼Œç”¨äºè¡¨ç¤ºæ€§èƒ½æ¡ç›®çš„ç±»å‹ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªæ€§èƒ½æ¡ç›®æ˜¯å› ä¸ºä»€ä¹ˆæ ·çš„äº‹ä»¶æˆ–æ“ä½œè€Œäº§ç”Ÿçš„ã€‚é€šè¿‡æ£€æŸ¥ <code>kind</code> å±æ€§çš„å€¼ï¼Œå¼€å‘è€…å¯ä»¥åŒºåˆ†ä¸åŒç§ç±»çš„æ€§èƒ½æ¡ç›®ï¼Œä»è€Œæ›´æ¸…æ™°åœ°äº†è§£æ€§èƒ½æ•°æ®ã€‚</p><p>ä¸è¿‡ï¼Œæˆªè‡³æˆ‘æœ€åæ›´æ–°çš„çŸ¥è¯†ï¼ˆ2023 å¹´ï¼‰ï¼Œ<code>performanceNodeEntry.kind</code> ç›´æ¥å¹¶æœªåœ¨ Node.js å®˜æ–¹æ–‡æ¡£ä¸­è¯¦ç»†åˆ—å‡ºå¯èƒ½çš„å€¼åŠå…¶å«ä¹‰ã€‚é€šå¸¸ï¼Œè¿™äº›å€¼ä¼šå¯¹åº”äºä¸åŒçš„æ€§èƒ½æ¡ç›®ç±»å‹ï¼Œä¾‹å¦‚ï¼šæ˜¯å¦æ˜¯ä¸€ä¸ª HTTP è¯·æ±‚å¤„ç†çš„å¼€å§‹ã€ç»“æŸï¼Œæˆ–è€…æ˜¯æŸä¸ªç‰¹å®šå¼‚æ­¥æ“ä½œçš„å¼€å§‹å’Œç»“æŸç­‰ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-3"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>è™½ç„¶æ²¡æœ‰ç›´æ¥ä½¿ç”¨ <code>performanceNodeEntry.kind</code> çš„å…·ä½“å®ä¾‹ï¼Œä½†æˆ‘å¯ä»¥ç»™ä½ ä¸¾ä¸€ä¸ªå¦‚ä½•ä½¿ç”¨ <code>perf_hooks</code> æ¨¡å—æ¥ç›‘æ§æ€§èƒ½çš„ä¾‹å­ï¼Œè¿™å°†å¸®åŠ©ä½ ç†è§£ <code>performanceNodeEntry.kind</code> å¯èƒ½è¢«ç”¨åœ¨å“ªé‡Œã€‚</p><p>å‡è®¾æˆ‘ä»¬æƒ³è¦æµ‹é‡ä¸€ä¸ª HTTP æœåŠ¡å™¨å¤„ç†è¯·æ±‚çš„æ—¶é—´ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ€§èƒ½è§‚å¯Ÿè€…æ¥è§‚å¯Ÿå’Œæ‰“å°æ€§èƒ½æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> server</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åœ¨å¤„ç†å¼€å§‹æ—¶æ ‡è®°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ¨¡æ‹Ÿä¸€äº›æœåŠ¡å™¨é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¤„ç†ç»“æŸæ—¶æ ‡è®°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æµ‹é‡ä»Aåˆ°Bçš„æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;HTTP Request Handling&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Server running on port 3000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ç›´æ¥ä½¿ç”¨ <code>performanceNodeEntry.kind</code>ï¼Œä½†æˆ‘ä»¬ä½¿ç”¨äº† <code>perf_hooks</code> æ¨¡å—æ¥æµ‹é‡å’Œç›‘æ§ä»£ç çš„æ€§èƒ½ã€‚ç†è§£äº†è¿™ä¸ªæ¦‚å¿µï¼Œä½ å°†èƒ½å¤Ÿæ›´å¥½åœ°æŠŠæ¡ <code>performanceNodeEntry.kind</code> å¦‚ä½•ä½œä¸ºæ€§èƒ½æ¡ç›®åˆ†ç±»çš„ä¸€ä¸ªæ‰‹æ®µã€‚</p><h3 id="garbage-collection-gc-details" tabindex="-1"><a class="header-anchor" href="#garbage-collection-gc-details"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#garbage-collection-gc-details" target="_blank" rel="noopener noreferrer">Garbage Collection (&#39;gc&#39;) Details</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œåƒåœ¾å›æ”¶ï¼ˆGarbage Collectionï¼Œç®€ç§° GCï¼‰æ˜¯ä¸€ä¸ªè‡ªåŠ¨çš„å†…å­˜ç®¡ç†æœºåˆ¶ï¼Œå®ƒå¸®åŠ©å¼€å‘è€…æ— éœ€æ‰‹åŠ¨ç®¡ç†å†…å­˜åˆ†é…å’Œé‡Šæ”¾ã€‚Node.js åº•å±‚ä½¿ç”¨çš„ V8 å¼•æ“ä¼šè‡ªåŠ¨è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œç¡®ä¿ä¸å†è¢«ä½¿ç”¨çš„å†…å­˜å¯ä»¥è¢«é‡Šæ”¾ï¼Œé¿å…å†…å­˜æ³„éœ²ã€‚ä» Node.js v21.7.1 ç‰ˆæœ¬å¼€å§‹ï¼Œé€šè¿‡æ€§èƒ½é’©å­ï¼ˆ<code>perf_hooks</code>æ¨¡å—ï¼‰å¯ä»¥è·å–æ›´è¯¦ç»†çš„åƒåœ¾å›æ”¶ä¿¡æ¯ã€‚</p><h3 id="åƒåœ¾å›æ”¶å·¥ä½œåŸç†" tabindex="-1"><a class="header-anchor" href="#åƒåœ¾å›æ”¶å·¥ä½œåŸç†"><span>åƒåœ¾å›æ”¶å·¥ä½œåŸç†</span></a></h3><p>åƒåœ¾å›æ”¶ä¸»è¦åˆ†ä¸ºä¸¤æ­¥ï¼šæ ‡è®°ï¼ˆMarkingï¼‰å’Œæ¸…é™¤ï¼ˆSweepingï¼‰ã€‚é¦–å…ˆï¼Œåƒåœ¾å›æ”¶å™¨ä¼šéå†æ‰€æœ‰å¯¹è±¡ï¼Œæ ‡è®°é‚£äº›è¿˜åœ¨ä½¿ç”¨ä¸­çš„å¯¹è±¡ï¼›ç„¶åï¼Œå®ƒä¼šæ¸…é™¤é‚£äº›æœªè¢«æ ‡è®°çš„å¯¹è±¡ï¼Œå› ä¸ºè¿™äº›æœªè¢«æ ‡è®°çš„å¯¹è±¡ä¸å†è¢«åº”ç”¨ç¨‹åºä½¿ç”¨ï¼Œå¯ä»¥å®‰å…¨åœ°å›æ”¶å…¶å ç”¨çš„å†…å­˜ã€‚</p><h3 id="å¦‚ä½•åœ¨-node-js-ä¸­è·å–-gc-è¯¦æƒ…" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•åœ¨-node-js-ä¸­è·å–-gc-è¯¦æƒ…"><span>å¦‚ä½•åœ¨ Node.js ä¸­è·å– GC è¯¦æƒ…</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡ <code>perf_hooks</code> æ¨¡å—æ¥ç›‘æ§åƒåœ¾å›æ”¶äº‹ä»¶å’Œæ€§èƒ½ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>performance</code> API å’Œ <code>PerformanceObserver</code> æ¥è§‚å¯Ÿå’Œå“åº”åƒåœ¾å›æ”¶äº‹ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ€§èƒ½è§‚å¯Ÿè€…æ¥ç›‘æ§ GC äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entry</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> of</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`GC Type: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, Duration: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¢é˜… GC äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;gc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffered</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-5" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-5"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><ol><li><p><strong>ç›‘æ§å†…å­˜ä½¿ç”¨</strong>ï¼šé€šè¿‡ç›‘æ§ GC äº‹ä»¶ï¼Œä½ å¯ä»¥äº†è§£åº”ç”¨åœ¨è¿è¡Œæ—¶çš„å†…å­˜ä½¿ç”¨æƒ…å†µå’Œåƒåœ¾å›æ”¶é¢‘ç‡ï¼Œè¿™å¯¹äºä¼˜åŒ–åº”ç”¨æ€§èƒ½å’Œèµ„æºä½¿ç”¨éå¸¸é‡è¦ã€‚</p></li><li><p><strong>æ€§èƒ½è°ƒä¼˜</strong>ï¼šå¦‚æœä½ å‘ç°åƒåœ¾å›æ”¶äº‹ä»¶å‘ç”Ÿå¾—å¤ªé¢‘ç¹æˆ–è€—æ—¶å¤ªé•¿ï¼Œè¿™å¯èƒ½æ˜¯å› ä¸ºåº”ç”¨ç¨‹åºåˆ›å»ºäº†è¿‡å¤šçš„çŸ­ç”Ÿå‘½å‘¨æœŸå¯¹è±¡ã€‚é€šè¿‡åˆ†æè¿™äº›äº‹ä»¶ï¼Œä½ å¯ä»¥æ‰¾åˆ°å¹¶ä¿®å¤å¯¼è‡´è¿‡åº¦åƒåœ¾å›æ”¶çš„ä»£ç ï¼Œä»è€Œæé«˜åº”ç”¨æ€§èƒ½ã€‚</p></li><li><p><strong>å†…å­˜æ³„éœ²å®šä½</strong>ï¼šå¦‚æœä½ è§‚å¯Ÿåˆ°åº”ç”¨ç¨‹åºçš„å†…å­˜ä½¿ç”¨æŒç»­å¢é•¿ï¼Œè€Œåƒåœ¾å›æ”¶å¹¶æ²¡æœ‰æœ‰æ•ˆåœ°é‡Šæ”¾å†…å­˜ï¼Œè¿™å¯èƒ½æ˜¯å†…å­˜æ³„éœ²çš„è¿¹è±¡ã€‚é€šè¿‡ç›‘æ§å’Œåˆ†æåƒåœ¾å›æ”¶äº‹ä»¶ï¼Œä½ å¯ä»¥å¸®åŠ©å®šä½å†…å­˜æ³„éœ²çš„æ¥æºã€‚</p></li></ol><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒNode.js v21.7.1 ç‰ˆæœ¬æä¾›çš„æ›´ç»†è‡´çš„åƒåœ¾å›æ”¶è¯¦æƒ…èƒ½å¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°ç†è§£å’Œä¼˜åŒ–ä»–ä»¬çš„åº”ç”¨ç¨‹åºæ€§èƒ½ã€‚</p><h3 id="http-http-details" tabindex="-1"><a class="header-anchor" href="#http-http-details"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#http-http-details" target="_blank" rel="noopener noreferrer">HTTP (&#39;http&#39;) Details</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™åç«¯é€»è¾‘ï¼Œè¿™å¯¹äºå‰ç«¯å¼€å‘è€…æ¥è¯´æ˜¯éå¸¸æ–¹ä¾¿çš„ï¼Œå› ä¸ºä»–ä»¬å¯ä»¥ä½¿ç”¨åŒä¸€ç§è¯­è¨€è¿›è¡Œå…¨æ ˆå¼€å‘ã€‚</p><p>åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼ŒHTTP (&#39;http&#39;) Details æ¶‰åŠçš„æ˜¯æ€§èƒ½ç›‘æµ‹ï¼ˆPerformance Hooksï¼‰æ¨¡å—ä¸‹çš„ HTTP ç›¸å…³æ€§èƒ½æŒ‡æ ‡çš„ç»†èŠ‚ã€‚Performance Hooks æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œç”¨äºç›‘è§†ä»£ç çš„æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯å¼‚æ­¥æ“ä½œçš„æ€§èƒ½ã€‚è¿™åœ¨å¤„ç†åƒ HTTP è¯·æ±‚è¿™æ ·çš„ç½‘ç»œæ“ä½œæ—¶å°¤å…¶æœ‰ç”¨ã€‚</p><h3 id="æ€§èƒ½ç›‘æµ‹å’Œ-http" tabindex="-1"><a class="header-anchor" href="#æ€§èƒ½ç›‘æµ‹å’Œ-http"><span>æ€§èƒ½ç›‘æµ‹å’Œ HTTP</span></a></h3><p>ç°ä»£çš„ web åº”ç”¨ç¨‹åºå’Œ API éƒ½ä¾èµ–äºç½‘ç»œè¯·æ±‚ï¼Œäº†è§£è¿™äº›è¯·æ±‚å¦‚ä½•æ‰§è¡Œï¼Œä»¥åŠå®ƒä»¬å¯èƒ½çš„æ€§èƒ½ç“¶é¢ˆåœ¨å“ªé‡Œï¼Œå¯¹äºä¼˜åŒ–åº”ç”¨ç¨‹åºè‡³å…³é‡è¦ã€‚Node.js ä¸­çš„ <code>perf_hooks</code> æ¨¡å—ä½¿å¾—ç›‘æ§è¿™äº›æ“ä½œå˜å¾—ç®€å•ã€‚</p><p>ä½¿ç”¨ <code>perf_hooks</code> ç›‘æ§ HTTP è¯·æ±‚ä¸»è¦æ¶‰åŠä»¥ä¸‹å‡ ä¸ªæ¦‚å¿µï¼š</p><ul><li><strong>æ€§èƒ½æ—¶é—´çº¿</strong>: åŒ…æ‹¬å„ç§äº‹ä»¶çš„æ—¶é—´ç‚¹ï¼Œä¾‹å¦‚è¯·æ±‚å¼€å§‹ã€ç»“æŸç­‰ã€‚</li><li><strong>æ€§èƒ½æ¡ç›®</strong>: æ¯æ¬¡æ“ä½œæˆ–äº‹ä»¶éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ€§èƒ½æ¡ç›®ï¼ŒåŒ…å«äº†è¯¥äº‹ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚æŒç»­æ—¶é—´ã€ç±»å‹ç­‰ã€‚</li></ul><h3 id="å®é™…è¿ç”¨-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨-1"><span>å®é™…è¿ç”¨</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨æ„å»ºä¸€ä¸ªåŸºäº Node.js çš„ web åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”ä½ æƒ³ç›‘è§†å‘å‡ºçš„ HTTP è¯·æ±‚çš„æ€§èƒ½ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>perf_hooks</code> æ¨¡å—æ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p><h4 id="æ­¥éª¤-1-å¼•å…¥æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-1-å¼•å…¥æ¨¡å—"><span>æ­¥éª¤ 1: å¼•å…¥æ¨¡å—</span></a></h4><p>é¦–å…ˆï¼Œä½ éœ€è¦å¼•å…¥ <code>perf_hooks</code> æ¨¡å—ï¼Œå…·ä½“æ¥è¯´ï¼Œæ˜¯å…¶ä¸­çš„ <code>performance</code> å¯¹è±¡å’Œ <code>PerformanceObserver</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="æ­¥éª¤-2-è®¾ç½®è§‚å¯Ÿå™¨" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-2-è®¾ç½®è§‚å¯Ÿå™¨"><span>æ­¥éª¤ 2: è®¾ç½®è§‚å¯Ÿå™¨</span></a></h4><p>ç„¶åï¼Œè®¾ç½®ä¸€ä¸ª <code>PerformanceObserver</code> æ¥ç›‘å¬ç‰¹å®šç±»å‹çš„æ€§èƒ½æ¡ç›®ï¼Œä¾‹å¦‚ <code>http</code> ç±»å‹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ­¥éª¤-3-å‘é€-http-è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-3-å‘é€-http-è¯·æ±‚"><span>æ­¥éª¤ 3: å‘é€ HTTP è¯·æ±‚</span></a></h4><p>å½“ä½ å‘å‡º HTTP è¯·æ±‚æ—¶ï¼ˆæ— è®ºæ˜¯é€šè¿‡åŸç”Ÿçš„ <code>http</code> æ¨¡å—è¿˜æ˜¯åƒ <code>axios</code> è¿™æ ·çš„ç¬¬ä¸‰æ–¹åº“ï¼‰ï¼Œ<code>PerformanceObserver</code> å°†ä¼šæ•è·ä¸æ­¤è¯·æ±‚ç›¸å…³çš„æ€§èƒ½æ¡ç›®ã€‚</p><h4 id="ç¤ºä¾‹-ä½¿ç”¨-axios-å‘é€è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-ä½¿ç”¨-axios-å‘é€è¯·æ±‚"><span>ç¤ºä¾‹ï¼šä½¿ç”¨ axios å‘é€è¯·æ±‚</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> axios</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;axios&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> makeRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> axios</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ­¤æ—¶ï¼Œæˆ‘ä»¬çš„æ€§èƒ½è§‚å¯Ÿå™¨ä¼šè®°å½•è¿™ä¸ªè¯·æ±‚ï¼Œå¹¶è¾“å‡ºç›¸å…³æ€§èƒ½æ•°æ®ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">makeRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç»“è®º-2" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-2"><span>ç»“è®º</span></a></h3><p>é€šè¿‡ä½¿ç”¨ Node.js çš„ <code>perf_hooks</code> æ¨¡å—ï¼Œä½ å¯ä»¥è½»æ¾åœ°ç›‘æ§å’Œåˆ†æä½ çš„ HTTP è¯·æ±‚çš„æ€§èƒ½ã€‚è¿™å¯¹äºè¯Šæ–­æ€§èƒ½é—®é¢˜ã€ä¼˜åŒ–åº”ç”¨ç¨‹åºå“åº”æ—¶é—´ç­‰æ–¹é¢è‡³å…³é‡è¦ã€‚æ— è®ºæ˜¯åœ¨å¼€å‘é˜¶æ®µè¿˜æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸­åˆ†æå®æ—¶æ•°æ®ï¼Œäº†è§£å¦‚ä½•åˆ©ç”¨è¿™äº›å·¥å…·éƒ½æ˜¯æä¸ºå®è´µçš„ã€‚</p><h3 id="http-2-http2-details" tabindex="-1"><a class="header-anchor" href="#http-2-http2-details"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#http2-http2-details" target="_blank" rel="noopener noreferrer">HTTP/2 (&#39;http2&#39;) Details</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘ä¼šè¯¦ç»†è§£é‡Š Node.js ä¸­çš„ HTTP/2 æ¨¡å—ï¼Œç‰¹åˆ«æ˜¯ v21.7.1 ç‰ˆæœ¬çš„ç›¸å…³å†…å®¹ã€‚HTTP/2 æ˜¯ä¸€ä¸ªç½‘ç»œä¼ è¾“åè®®ï¼Œå®ƒæ˜¯ HTTP åè®®çš„ç¬¬äºŒä¸ªä¸»è¦ç‰ˆæœ¬ï¼Œç”¨äºæ”¹å–„ç½‘é¡µåŠ è½½é€Ÿåº¦å’Œç”¨æˆ·ä½“éªŒã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ HTTP/2 çš„å‡ ä¸ªä¸»è¦ç‰¹æ€§ï¼š</p><ol><li><p><strong>äºŒè¿›åˆ¶å¸§ä¼ è¾“</strong>ï¼šåœ¨ HTTP/1.x ä¸­ï¼Œæ•°æ®ä»¥æ–‡æœ¬æ ¼å¼ï¼ˆå¦‚ HTMLã€CSSã€JSï¼‰ä¼ è¾“ï¼Œè€Œåœ¨ HTTP/2 ä¸­ï¼Œæ•°æ®è¢«åˆ†å‰²æˆæ›´å°çš„æ¶ˆæ¯å’Œå¸§ï¼Œå¹¶ä»¥äºŒè¿›åˆ¶æ ¼å¼ä¼ è¾“ã€‚è¿™ç§å˜åŒ–ä½¿å¾—ä¼ è¾“æ›´é«˜æ•ˆã€æ›´å®‰å…¨ã€‚</p></li><li><p><strong>å¤šè·¯å¤ç”¨</strong>ï¼šHTTP/2 å…è®¸åœ¨ä¸€ä¸ªè¿æ¥ä¸­åŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚å’Œå“åº”ï¼Œè€Œä¸éœ€è¦ç­‰å¾…å‰ä¸€ä¸ªå®Œæˆã€‚è¿™å‡å°‘äº†é¡µé¢åŠ è½½æ—¶é—´ï¼Œå› ä¸ºä¸éœ€è¦ä¸ºæ¯ä¸ªè¯·æ±‚å»ºç«‹æ–°çš„è¿æ¥ã€‚</p></li><li><p><strong>å¤´éƒ¨å‹ç¼©</strong>ï¼šHTTP/2 ä½¿ç”¨ HPACK å‹ç¼©ç®—æ³•å‹ç¼©è¯·æ±‚å’Œå“åº”çš„å¤´éƒ¨ä¿¡æ¯ï¼Œå‡å°‘äº†ä¼ è¾“æ•°æ®çš„å¤§å°ã€‚</p></li><li><p><strong>æœåŠ¡å™¨æ¨é€</strong>ï¼šæœåŠ¡å™¨å¯ä»¥å‘å®¢æˆ·ç«¯æ¨é€èµ„æºï¼Œå³ä½¿å®¢æˆ·ç«¯æ²¡æœ‰æ˜ç¡®è¯·æ±‚è¿™äº›èµ„æºã€‚è¿™å¯ä»¥è¿›ä¸€æ­¥åŠ å¿«é¡µé¢åŠ è½½é€Ÿåº¦ã€‚</p></li></ol><p>åœ¨ Node.js ä¸­ï¼Œ<code>http2</code> æ¨¡å—æä¾›äº† HTTP/2 çš„å®ç°ã€‚ä¸‹é¢æ˜¯ä¸€äº›åœ¨ Node.js v21.7.1 ä¸­ä½¿ç”¨ HTTP/2 çš„ä¾‹å­ï¼š</p><h3 id="åˆ›å»º-http-2-æœåŠ¡å™¨" tabindex="-1"><a class="header-anchor" href="#åˆ›å»º-http-2-æœåŠ¡å™¨"><span>åˆ›å»º HTTP/2 æœåŠ¡å™¨</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> server</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> http2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createSecureServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;server-key.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;server-cert.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;stream&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">stream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">headers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  stream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">respond</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;content-type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;text/html&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;:status&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  stream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;`&lt;`h1&gt;Hello World`&lt;`/h1&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8443</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„ HTTP/2 æœåŠ¡å™¨ã€‚æ³¨æ„åˆ°æˆ‘ä»¬ä½¿ç”¨äº† <code>createSecureServer</code> æ–¹æ³•ï¼Œå› ä¸º HTTP/2 æ ‡å‡†è¦æ±‚ä½¿ç”¨ TLS (ä¼ è¾“å±‚å®‰å…¨åè®®) åŠ å¯†ã€‚æˆ‘ä»¬è¿˜è®¾ç½®äº†å½“æ¥æ”¶åˆ°å®¢æˆ·ç«¯æ•°æ®æµæ—¶çš„å¤„ç†æ–¹å¼ã€‚</p><h3 id="å®¢æˆ·ç«¯è¿æ¥åˆ°-http-2-æœåŠ¡å™¨" tabindex="-1"><a class="header-anchor" href="#å®¢æˆ·ç«¯è¿æ¥åˆ°-http-2-æœåŠ¡å™¨"><span>å®¢æˆ·ç«¯è¿æ¥åˆ° HTTP/2 æœåŠ¡å™¨</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> client</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> http2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">connect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https://localhost:8443&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> req</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> client</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">request</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;:path&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;response&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">headers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">flags</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> headers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">headers</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setEncoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  client</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">close</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªå®¢æˆ·ç«¯ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¿æ¥åˆ°åˆšæ‰åˆ›å»ºçš„ HTTP/2 æœåŠ¡å™¨ï¼Œå¹¶å‘é€äº†ä¸€ä¸ªè¯·æ±‚ã€‚æœåŠ¡å™¨çš„å“åº”ä¼šè¢«è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚</p><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ å¯ä»¥å¼€å§‹ç†è§£ Node.js ä¸­å¦‚ä½•ä½¿ç”¨ HTTP/2 æ¥åˆ›å»ºæ›´é«˜æ•ˆã€æ›´å¿«é€Ÿçš„ç½‘ç»œåº”ç”¨ã€‚è®°ä½ï¼Œå°½ç®¡ HTTP/2 æä¾›äº†è®¸å¤šæ”¹è¿›ï¼Œä½†å®ƒçš„æ ¸å¿ƒç›®æ ‡æ˜¯ä½¿ç½‘ç»œé€šä¿¡æ›´åŠ é«˜æ•ˆå’Œå¿«é€Ÿã€‚</p><h3 id="timerify-function-details" tabindex="-1"><a class="header-anchor" href="#timerify-function-details"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#timerify-function-details" target="_blank" rel="noopener noreferrer">Timerify (&#39;function&#39;) Details</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>perf_hooks</code>æ¨¡å—æä¾›äº†æ€§èƒ½ç›‘æµ‹çš„å·¥å…·ï¼Œè®©å¼€å‘è€…å¯ä»¥æ£€æµ‹ä»£ç æ‰§è¡Œçš„æ€§èƒ½ã€‚åœ¨è¿™äº›å·¥å…·ä¸­ï¼Œ<code>timerify()</code>å‡½æ•°æ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„åŠŸèƒ½ï¼Œå®ƒå…è®¸ä½ æŠŠä¸€ä¸ªæ™®é€šçš„ JavaScript å‡½æ•°â€œè½¬åŒ–â€æˆä¸€ä¸ªå¯ä»¥è¢«æ€§èƒ½ç›‘æ§ç³»ç»Ÿè¿½è¸ªçš„å‡½æ•°ã€‚</p><p>å½“ä½ ä½¿ç”¨<code>timerify()</code>åŒ…è£…ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œè¿™ä¸ªå‡½æ•°çš„è°ƒç”¨ä¼šç”Ÿæˆç‰¹å®šçš„æ€§èƒ½è®¡æ—¶æ•°æ®ï¼Œè¿™æ ·ä½ å°±å¯ä»¥é€šè¿‡ PerformanceObserver API æ¥æ”¶é›†å’Œåˆ†æè¿™äº›æ•°æ®äº†ã€‚</p><p>ä»¥ä¸‹æ˜¯ä½¿ç”¨<code>timerify()</code>çš„æ­¥éª¤å’Œä¾‹å­ï¼š</p><ol><li>å¼•å…¥<code>perf_hooks</code>æ¨¡å—ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">timerify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li>åˆ›å»ºä¸€ä¸ªéœ€è¦è¢«ç›‘æµ‹çš„å‡½æ•°ï¼Œæ¯”å¦‚ä¸€ä¸ªè®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—çš„å‡½æ•°ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fibonacci</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">n</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> n</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fibonacci</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">n</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fibonacci</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">n</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>ä½¿ç”¨<code>timerify()</code>æ¥åŒ…è£…è¿™ä¸ªå‡½æ•°ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> timerifiedFibonacci</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> timerify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fibonacci</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="4"><li>è®¾ç½®ä¸€ä¸ª<code>PerformanceObserver</code>æ¥ç›‘å¬æ€§èƒ½æµ‹é‡äº‹ä»¶ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå›è°ƒå‡½æ•°æ¥å¤„ç†è¿™äº›äº‹ä»¶ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Function took </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entries</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> milliseconds to complete.`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;function&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffered</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li>è°ƒç”¨è¢«<code>timerify()</code>åŒ…è£…è¿‡çš„å‡½æ•°ï¼Œå¹¶ä¼ å…¥ç›¸åº”çš„å‚æ•°ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">timerifiedFibonacci</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è°ƒç”¨æ­¤å‡½æ•°å°†è§¦å‘æ€§èƒ½æ•°æ®çš„ç”Ÿæˆ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="6"><li>å½“è¿™ä¸ªå‡½æ•°è¢«è°ƒç”¨åï¼Œæ€§èƒ½ç›‘æµ‹ç³»ç»Ÿä¼šè®°å½•è¿™æ¬¡è°ƒç”¨æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œå¹¶é€šè¿‡<code>PerformanceObserver</code>å®šä¹‰çš„å›è°ƒå‡½æ•°è¾“å‡ºã€‚</li></ol><p>è¯·æ³¨æ„ï¼Œä¸Šè¿°çš„<code>fibonacci</code>å‡½æ•°ä»…ä»…æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå®é™…ä¸Šåœ¨ç”Ÿäº§ä¸­å¯èƒ½ä¸ä¼šå¯¹è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—çš„å‡½æ•°è¿›è¡Œæ€§èƒ½ç›‘æµ‹ã€‚ä½†è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>timerify()</code>è¿½è¸ªå‡½æ•°æ‰§è¡Œæ—¶é—´çš„åŸºæœ¬æ–¹æ³•ã€‚</p><p>æ›´å¸¸è§çš„åº”ç”¨åœºæ™¯å¯èƒ½æ˜¯è¿½è¸ªç½‘ç»œè¯·æ±‚å¤„ç†çš„æ—¶é—´ã€æ•°æ®åº“æ“ä½œçš„å»¶è¿Ÿã€æ–‡ä»¶è¯»å†™çš„æ€§èƒ½ç­‰ç­‰ã€‚è¿™äº›æ€§èƒ½æ•°æ®å¸®åŠ©å¼€å‘è€…äº†è§£ç¨‹åºå„éƒ¨åˆ†çš„æ•ˆç‡ï¼Œä»è€Œä¼˜åŒ–ç¨‹åºæ€§èƒ½ï¼Œå°¤å…¶åœ¨å¤„ç†é«˜è´Ÿè½½æˆ–æ˜¯å¯¹å“åº”æ—¶é—´æœ‰ä¸¥æ ¼è¦æ±‚çš„åº”ç”¨ä¸­æä¸ºé‡è¦ã€‚</p><h3 id="net-net-details" tabindex="-1"><a class="header-anchor" href="#net-net-details"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#net-net-details" target="_blank" rel="noopener noreferrer">Net (&#39;net&#39;) Details</a></span></a></h3><p>Node.js çš„ <code>net</code> æ¨¡å—æ˜¯ç”¨äºç½‘ç»œç›¸å…³æ“ä½œçš„ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—ã€‚å®ƒæä¾›äº†åˆ›å»ºåŸºäºæµçš„ TCP æˆ– IPC æœåŠ¡å™¨ (<code>net.createServer()</code>) å’Œå®¢æˆ·ç«¯ (<code>net.createConnection()</code>) çš„å¼‚æ­¥ç½‘ç»œ APIã€‚</p><p>åœ¨ Node.js çš„æ–‡æ¡£ä¸­ï¼Œå¯èƒ½ä¼šçœ‹åˆ°æ ‡é¢˜å¦‚ &quot;Net (&#39;net&#39;) Details&quot;ï¼Œè¿™é€šå¸¸æ„å‘³ç€è¯¥éƒ¨åˆ†å°†æ›´è¯¦ç»†åœ°è§£é‡Š <code>net</code> æ¨¡å—çš„ç‰¹å®šæ–¹é¢æˆ–é«˜çº§åŠŸèƒ½ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ¾„æ¸…ä¸€ç‚¹ï¼šä½ æåˆ°çš„ &quot;Net (&#39;net&#39;) Details&quot; å‡ºç°åœ¨å…³äº <code>perf_hooks</code> æ¨¡å—çš„æ–‡æ¡£é¡µé¢ä¸­ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªè¯¯å¯¼ã€‚<code>perf_hooks</code> æ¨¡å—ç”¨äºæ€§èƒ½ç›‘æµ‹ï¼Œå¹¶ä¸ç›´æ¥ä¸ <code>net</code> æ¨¡å—ç›¸å…³ã€‚ç„¶è€Œï¼Œå¦‚æœä½ æƒ³è¦äº†è§£ <code>net</code> æ¨¡å—ï¼Œä¸‹é¢æˆ‘ä¼šç»™å‡ºä¸€ä¸ªç®€å•çš„ä»‹ç»å’Œä¾‹å­ã€‚</p><h3 id="ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#ç®€ä»‹"><span>ç®€ä»‹</span></a></h3><p><code>net</code> æ¨¡å—å¯ä»¥è®©ä½ å®ç°ä»¥ä¸‹å‡ ç§ç±»å‹çš„ç½‘ç»œé€šä¿¡ï¼š</p><ul><li><strong>TCP å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨</strong>ï¼šè¿™å…è®¸è®¡ç®—æœºä¹‹é—´é€šè¿‡ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTCPï¼‰è¿›è¡Œé€šä¿¡ã€‚</li><li><strong>UNIX å¥—æ¥å­—/Windows å‘½åç®¡é“</strong>ï¼šåœ¨åŒä¸€å°æœºå™¨ä¸Šçš„ä¸åŒè¿›ç¨‹ä¹‹é—´è¿›è¡Œä½å»¶è¿Ÿé€šä¿¡ã€‚</li></ul><h3 id="ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1"><span>ç¤ºä¾‹</span></a></h3><h4 id="åˆ›å»ºä¸€ä¸ª-tcp-æœåŠ¡å™¨" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºä¸€ä¸ª-tcp-æœåŠ¡å™¨"><span>åˆ›å»ºä¸€ä¸ª TCP æœåŠ¡å™¨</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> net</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;net&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª TCP æœåŠ¡å™¨å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> server</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> net</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">socket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å®¢æˆ·ç«¯è¿æ¥æˆåŠŸã€‚&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å½“æ¥æ”¶åˆ°æ•°æ®æ—¶ï¼Œæ‰“å°æ•°æ®å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  socket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä»å®¢æˆ·ç«¯æ¥æ”¶åˆ°æ•°æ®:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å½“å®¢æˆ·ç«¯å…³é—­è¿æ¥æ—¶è§¦å‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  socket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å®¢æˆ·ç«¯æ–­å¼€è¿æ¥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‘å®¢æˆ·ç«¯å‘é€ä¸€æ¡æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  socket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello from TCP Server!</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\r\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å…³é—­è¿æ¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  socket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æœåŠ¡å™¨å¼€å§‹ç›‘å¬ 12345 ç«¯å£ä¸Šçš„è¿æ¥è¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">12345</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æœåŠ¡å™¨æ­£åœ¨ç›‘å¬ç«¯å£ 12345&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="åˆ›å»ºä¸€ä¸ª-tcp-å®¢æˆ·ç«¯" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºä¸€ä¸ª-tcp-å®¢æˆ·ç«¯"><span>åˆ›å»ºä¸€ä¸ª TCP å®¢æˆ·ç«¯</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> net</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;net&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª TCP å®¢æˆ·ç«¯å®ä¾‹å¹¶è¿æ¥åˆ°æœåŠ¡å™¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> client</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> net</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createConnection</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">port</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">12345</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å·²è¿æ¥åˆ°æœåŠ¡å™¨ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‘æœåŠ¡å™¨å‘é€ä¸€æ¡æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  client</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello from TCP Client!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¥æ”¶æ¥è‡ªæœåŠ¡å™¨çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">client</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å®Œæˆäº¤äº’åå…³é—­è¿æ¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  client</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç›‘å¬è¿æ¥ç»“æŸäº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">client</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å·²ä»æœåŠ¡å™¨æ–­å¼€&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªç®€å•çš„ TCP æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ã€‚æœåŠ¡å™¨ç›‘å¬ç«¯å£ 12345 ä¸Šçš„è¿æ¥è¯·æ±‚ï¼Œå¹¶åœ¨å®¢æˆ·ç«¯è¿æ¥æ—¶å‘å…¶å‘é€é—®å€™è¯­ã€‚å®¢æˆ·ç«¯è¿æ¥åˆ°æœåŠ¡å™¨å¹¶å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œæ¥å—æ¥è‡ªæœåŠ¡å™¨çš„å“åº”ï¼Œç„¶åå…³é—­è¿æ¥ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯å¯¹ Node.js <code>net</code> æ¨¡å—çš„ä¸€ä¸ªåŸºæœ¬ä»‹ç»å’Œç¤ºä¾‹ã€‚é€šè¿‡è¿™ä¸ªæ¨¡å—ï¼Œä½ å¯ä»¥æ„å»ºå¤æ‚çš„ç½‘ç»œåº”ç”¨ç¨‹åºï¼Œå¦‚èŠå¤©æœåŠ¡å™¨ã€æ–‡ä»¶ä¼ è¾“å·¥å…·ç­‰ã€‚</p><h3 id="dns-dns-details" tabindex="-1"><a class="header-anchor" href="#dns-dns-details"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#dns-dns-details" target="_blank" rel="noopener noreferrer">DNS (&#39;dns&#39;) Details</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œè®©ä½ å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™åç«¯ä»£ç ï¼Œå¤„ç†ç½‘ç»œè¯·æ±‚ã€è®¿é—®æ•°æ®åº“ç­‰ã€‚è€Œ DNS (&#39;dns&#39;) æ¨¡å—æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªç”¨äºè§£æåŸŸåçš„æ¨¡å—ã€‚</p><h3 id="dns-æ¨¡å—çš„åŸºæœ¬ç”¨é€”" tabindex="-1"><a class="header-anchor" href="#dns-æ¨¡å—çš„åŸºæœ¬ç”¨é€”"><span>DNS æ¨¡å—çš„åŸºæœ¬ç”¨é€”</span></a></h3><p>DNSï¼Œå…¨ç§°ä¸º Domain Name Systemï¼ˆåŸŸåç³»ç»Ÿï¼‰ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†æ˜“äºè®°å¿†çš„åŸŸåï¼ˆå¦‚ <code>google.com</code>ï¼‰è½¬æ¢ä¸ºå®é™…çš„ IP åœ°å€ï¼ˆå¦‚ <code>142.250.196.174</code>ï¼‰ï¼Œè¿™æ ·è®¡ç®—æœºå°±å¯ä»¥é€šè¿‡ IP åœ°å€æ¥è®¿é—®ç½‘ç«™äº†ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>dns</code> æ¨¡å—æä¾›äº†ä¸€ç³»åˆ—å‡½æ•°ï¼Œä½¿å¾—åœ¨ä»£ç ä¸­è¿›è¡ŒåŸŸåè§£æå˜å¾—å¯èƒ½ã€‚</p><h3 id="ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2"><span>ç¤ºä¾‹</span></a></h3><h4 id="_1-ä½¿ç”¨-dns-lookup" tabindex="-1"><a class="header-anchor" href="#_1-ä½¿ç”¨-dns-lookup"><span>1. ä½¿ç”¨ <code>dns.lookup()</code></span></a></h4><p><code>dns.lookup()</code> å‡½æ•°æ˜¯æœ€å¸¸ç”¨çš„è§£æå‡½æ•°ä¹‹ä¸€ï¼Œå®ƒç”¨äºè§£æåŸŸåçš„ç¬¬ä¸€ä¸ªè®°å½•ï¼ˆå¦‚ A è®°å½•ï¼Œå³ IPv4 åœ°å€ï¼‰ï¼Œå¹¶è¿”å› IP åœ°å€ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;google.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">family</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`åœ°å€: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">address</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, åœ°å€æ—: IPv</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">family</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>dns.lookup(&#39;google.com&#39;, callback)</code> æ¥è§£æ <code>google.com</code> çš„ IP åœ°å€ã€‚å›è°ƒå‡½æ•°å°†è¿”å› IP åœ°å€å’Œåœ°å€æ—ï¼ˆIPv4 æˆ– IPv6ï¼‰ã€‚</p><h4 id="_2-ä½¿ç”¨-dns-resolve4" tabindex="-1"><a class="header-anchor" href="#_2-ä½¿ç”¨-dns-resolve4"><span>2. ä½¿ç”¨ <code>dns.resolve4()</code></span></a></h4><p><code>dns.resolve4()</code> å‡½æ•°ä¸“é—¨ç”¨äºè§£æåŸŸåçš„ IPv4 åœ°å€ã€‚ä¸ <code>lookup()</code> ä¸åŒçš„æ˜¯ï¼Œ<code>resolve4()</code> ç›´æ¥ä½¿ç”¨ç½‘ç»œè¿›è¡Œ DNS è§£æï¼Œä¸èµ°æ“ä½œç³»ç»Ÿçš„ç¼“å­˜ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;google.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`IP åœ°å€: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šè¾“å‡º <code>google.com</code> çš„ä¸€ä¸ªæˆ–å¤šä¸ª IPv4 åœ°å€ã€‚</p><h4 id="_3-ä½¿ç”¨-dns-reverse" tabindex="-1"><a class="header-anchor" href="#_3-ä½¿ç”¨-dns-reverse"><span>3. ä½¿ç”¨ <code>dns.reverse()</code></span></a></h4><p><code>dns.reverse()</code> å‡½æ•°ç”¨äºåå‘è§£æ IP åœ°å€åˆ°åŸŸåï¼Œå³ç»™å®šä¸€ä¸ª IP åœ°å€ï¼Œæ‰¾å‡ºæ˜ å°„åˆ°è¿™ä¸ª IP åœ°å€çš„æ‰€æœ‰åŸŸåã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">reverse</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;142.250.196.174&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">hostnames</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">stack</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`åå‘è§£æåˆ°çš„åŸŸå: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostnames</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¯•å›¾æ‰¾å‡º IP åœ°å€ <code>142.250.196.174</code> å¯¹åº”çš„åŸŸåã€‚</p><h3 id="å°ç»“-2" tabindex="-1"><a class="header-anchor" href="#å°ç»“-2"><span>å°ç»“</span></a></h3><p>Node.js çš„ <code>dns</code> æ¨¡å—ä¸ºå¤„ç†å’Œè§£æ DNS æä¾›äº†ä¸°å¯Œçš„ APIã€‚æ— è®ºæ˜¯å°†åŸŸåè§£æä¸º IP åœ°å€ï¼Œè¿˜æ˜¯è¿›è¡Œåå‘è§£æï¼Œéƒ½èƒ½é€šè¿‡è¿™ä¸ªæ¨¡å—æ–¹ä¾¿åœ°å®Œæˆã€‚è¿™äº›åŠŸèƒ½åœ¨å¼€å‘ç½‘ç»œåº”ç”¨æ—¶ç‰¹åˆ«æœ‰ç”¨ï¼Œæ¯”å¦‚å½“ä½ éœ€è¦æ ¹æ®ç”¨æˆ·æä¾›çš„åŸŸåè·å–æœåŠ¡å™¨çš„ IP åœ°å€æ—¶ã€‚é€šè¿‡ä»¥ä¸Šçš„ä¾‹å­ï¼Œä½ åº”è¯¥å¯¹ Node.js ä¸­çš„ DNS æ¨¡å—æœ‰äº†åŸºæœ¬çš„äº†è§£å’Œåº”ç”¨æ–¹å¼ã€‚</p><h2 id="class-performancenodetiming" tabindex="-1"><a class="header-anchor" href="#class-performancenodetiming"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#class-performancenodetiming" target="_blank" rel="noopener noreferrer">Class: PerformanceNodeTiming</a></span></a></h2><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥èŠä¸€ä¸‹ Node.js ä¸­çš„<code>PerformanceNodeTiming</code>ç±»ã€‚</p><p>é¦–å…ˆï¼ŒNode.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™åç«¯ä»£ç ï¼Œå°±åƒä½ é€šå¸¸åœ¨ç½‘é¡µä¸Šåšçš„é‚£æ ·ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œæ€§èƒ½ç›‘æ§æ˜¯ä¸€ä¸ªé‡è¦çš„æ–¹é¢ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¼€å‘é«˜æ•ˆã€å“åº”è¿…é€Ÿçš„åº”ç”¨ç¨‹åºã€‚è¿™å°±æ˜¯<code>perf_hooks</code>æ¨¡å—å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—ç”¨äºç›‘æµ‹æ€§èƒ½çš„å·¥å…·å’Œ APIsã€‚</p><h3 id="performancenodetimingç±»" tabindex="-1"><a class="header-anchor" href="#performancenodetimingç±»"><span><code>PerformanceNodeTiming</code>ç±»</span></a></h3><p><code>PerformanceNodeTiming</code>ç±»æ˜¯<code>perf_hooks</code>æ¨¡å—ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæä¾›äº† Node.js åº”ç”¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­å„ä¸ªé˜¶æ®µçš„æ—¶é—´åº¦é‡ã€‚è¿™äº›åº¦é‡åŒ…æ‹¬äº†ä» Node.js è¿›ç¨‹å¯åŠ¨åˆ°ç»“æŸçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…çš„å…³é”®æ—¶é—´ç‚¹ï¼Œä¾‹å¦‚è„šæœ¬å¼€å§‹æ‰§è¡Œçš„æ—¶åˆ»ã€ç¬¬ä¸€ä¸ªäº‹ä»¶å¾ªç¯å‘¨æœŸçš„å¼€å§‹å’Œç»“æŸç­‰ã€‚</p><p>ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœä½ æƒ³çŸ¥é“ä½ çš„ Node.js åº”ç”¨ç¨‹åºå¯åŠ¨éœ€è¦å¤šé•¿æ—¶é—´ï¼Œæˆ–è€…ä½ çš„åº”ç”¨åœ¨å¤„ç† HTTP è¯·æ±‚æ—¶éœ€è¦æ¶ˆè€—å¤šå°‘æ—¶é—´ï¼Œ<code>PerformanceNodeTiming</code>ç±»å°±èƒ½å¤Ÿå¸®åŠ©ä½ è·å–è¿™äº›ä¿¡æ¯ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-5"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>ç›‘æµ‹å¯åŠ¨æ—¶é—´ï¼š</strong> å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web æœåŠ¡ï¼Œä½ å¯èƒ½å¸Œæœ›çŸ¥é“æœåŠ¡ä»å¯åŠ¨åˆ°å¯ä»¥æ¥æ”¶ HTTP è¯·æ±‚éœ€è¦å¤šé•¿æ—¶é—´ã€‚é€šè¿‡<code>PerformanceNodeTiming</code>ï¼Œä½ å¯ä»¥è·å¾—ä»å¯åŠ¨åˆ°å„ä¸ªåˆå§‹åŒ–é˜¶æ®µå®Œæˆæ‰€éœ€çš„ç²¾ç¡®æ—¶é—´ã€‚</p></li><li><p><strong>ä¼˜åŒ–æ€§èƒ½ï¼š</strong> å¦‚æœä½ å‘ç°ä½ çš„ Node.js åº”ç”¨å“åº”ç¼“æ…¢ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>PerformanceNodeTiming</code>æ¥è¯†åˆ«é—®é¢˜æ‰€åœ¨ã€‚æ¯”å¦‚ï¼Œå¦‚æœ<code>bootstrapComplete</code>ï¼ˆå¼•å¯¼å®Œæˆï¼‰åˆ°<code>loopStart</code>ï¼ˆäº‹ä»¶å¾ªç¯å¼€å§‹ï¼‰ä¹‹é—´çš„æ—¶é—´å¼‚å¸¸é•¿ï¼Œè¿™å¯èƒ½æ„å‘³ç€ä½ çš„åº”ç”¨åœ¨å¯åŠ¨æ—¶åŠ è½½äº†è¿‡å¤šçš„æ¨¡å—æˆ–æ‰§è¡Œäº†è¿‡å¤šçš„åˆå§‹åŒ–æ“ä½œã€‚</p></li><li><p><strong>æ¯”è¾ƒä¸åŒç‰ˆæœ¬çš„ Node.jsï¼š</strong> å½“ä½ å‡çº§ Node.js ç‰ˆæœ¬æ—¶ï¼Œä½¿ç”¨<code>PerformanceNodeTiming</code>å¯ä»¥å¸®åŠ©ä½ ç†è§£æ–°ç‰ˆæœ¬å¯¹ä½ çš„åº”ç”¨æ€§èƒ½æœ‰ä½•å½±å“ã€‚ä½ å¯ä»¥æ¯”è¾ƒä¸åŒç‰ˆæœ¬åœ¨ç›¸åŒæ¡ä»¶ä¸‹çš„æ€§èƒ½è¡¨ç°ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰æ˜¾è‘—å·®å¼‚ã€‚</p></li></ol><h3 id="å¦‚ä½•ä½¿ç”¨-2" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-2"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>ä½¿ç”¨<code>PerformanceNodeTiming</code>éå¸¸ç®€å•ã€‚é¦–å…ˆï¼Œä½ éœ€è¦å¼•å…¥<code>perf_hooks</code>æ¨¡å—ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç„¶åï¼Œä½ å¯ä»¥é€šè¿‡<code>performance.nodeTiming</code>è®¿é—®åˆ°<code>PerformanceNodeTiming</code>çš„å®ä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">nodeTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™å°†è¾“å‡ºä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº†ä¸€ç³»åˆ—çš„æ€§èƒ½æŒ‡æ ‡ï¼Œä¾‹å¦‚<code>startTime</code>ï¼ˆNode.js å¯åŠ¨æ—¶é—´ï¼‰ã€<code>bootstrapComplete</code>ï¼ˆå¼•å¯¼å®Œæˆæ—¶é—´ï¼‰ç­‰ç­‰ã€‚</p><p>é€šè¿‡å¯¹è¿™äº›æ—¶é—´ç‚¹çš„åˆ†æï¼Œä½ å¯ä»¥æ·±å…¥äº†è§£ä½ çš„ Node.js åº”ç”¨çš„æ€§èƒ½ç‰¹å¾ï¼Œä»è€Œè¿›è¡Œç›¸åº”çš„ä¼˜åŒ–ã€‚</p><p>æ€»ä¹‹ï¼Œ<code>PerformanceNodeTiming</code>æ˜¯ Node.js ä¸­ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œèƒ½å¤Ÿå¸®åŠ©ä½ ç›‘æ§å’Œä¼˜åŒ–åº”ç”¨çš„æ€§èƒ½ã€‚æ— è®ºä½ æ˜¯åœ¨å¼€å‘æ–°åº”ç”¨è¿˜æ˜¯ç»´æŠ¤æ—§æœ‰ç³»ç»Ÿï¼Œéƒ½å¯ä»¥ä»ä¸­å—ç›Šã€‚</p><h3 id="performancenodetiming-bootstrapcomplete" tabindex="-1"><a class="header-anchor" href="#performancenodetiming-bootstrapcomplete"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancenodetimingbootstrapcomplete" target="_blank" rel="noopener noreferrer">performanceNodeTiming.bootstrapComplete</a></span></a></h3><p>Node.js v21.7.1 ä¸­çš„ <code>performanceNodeTiming.bootstrapComplete</code> å±æ€§æ˜¯æ€§èƒ½ç›‘æµ‹ï¼ˆPerformance Monitoringï¼Œç®€ç§° perf_hooksï¼‰API çš„ä¸€éƒ¨åˆ†ã€‚è¿™ä¸ªå±æ€§ç”¨æ¥è®°å½•ä» Node.js è¿›ç¨‹å¯åŠ¨åˆ° Node.js çš„å¼•å¯¼è¿‡ç¨‹ï¼ˆå³ï¼Œå†…éƒ¨çš„åˆå§‹åŒ–å’Œå‡†å¤‡å·¥ä½œï¼‰å®Œå…¨å®Œæˆçš„æ—¶é—´ç‚¹ã€‚äº†è§£è¿™ä¸ªæ—¶é—´å¯ä»¥å¸®åŠ©ä½ åˆ†æä½ çš„åº”ç”¨å¯åŠ¨æ€§èƒ½ï¼Œä»è€Œè¿›è¡Œä¼˜åŒ–ã€‚</p><p>ç®€å•æ¥è¯´ï¼Œ<code>performanceNodeTiming.bootstrapComplete</code> æä¾›äº†ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œè¿™ä¸ªæ—¶é—´æˆ³è¡¨ç¤º Node.js å®Œæˆå¼•å¯¼çš„ç²¾ç¡®æ—¶é—´ç‚¹ã€‚è¿™å¯¹äºæ€§èƒ½åˆ†æå°¤ä¸ºé‡è¦ï¼Œç‰¹åˆ«æ˜¯åœ¨ä½ éœ€è¦ç¡®ä¿ä½ çš„åº”ç”¨å°½å¿«å“åº”ç”¨æˆ·è¯·æ±‚çš„åœºæ™¯ä¸‹ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-6" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-6"><span>å®é™…è¿ç”¨ä¾‹å­ï¼š</span></a></h3><ol><li><p><strong>æ€§èƒ½åˆ†æ</strong>ï¼šå‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œå¹¶ä¸”ä½ æ³¨æ„åˆ°å®ƒå¯åŠ¨ç‰¹åˆ«æ…¢ã€‚é€šè¿‡ä½¿ç”¨ <code>performanceNodeTiming.bootstrapComplete</code>ï¼Œä½ å¯ä»¥ç²¾ç¡®çŸ¥é“å¼•å¯¼è¿‡ç¨‹å®Œæˆçš„æ—¶é—´ç‚¹ã€‚ç„¶åï¼Œä½ å¯ä»¥å°†è¿™ä¸ªæ—¶é—´ç‚¹ä¸å…¶ä»–ç›¸å…³æ€§èƒ½æŒ‡æ ‡ï¼ˆæ¯”å¦‚é¦–æ¬¡æ¥æ”¶åˆ°ç”¨æˆ·è¯·æ±‚çš„æ—¶é—´ï¼‰è¿›è¡Œæ¯”è¾ƒï¼Œä»è€Œç¡®å®šæ˜¯å¼•å¯¼è¿‡ç¨‹æ…¢ï¼Œè¿˜æ˜¯åº”ç”¨çš„å…¶ä»–éƒ¨åˆ†å¯¼è‡´äº†æ•´ä½“å¯åŠ¨ç¼“æ…¢ã€‚</p></li><li><p><strong>ä¼˜åŒ–åé¦ˆ</strong>ï¼šåœ¨è¿›è¡Œäº†ä¸€äº›ä¼˜åŒ–æªæ–½ï¼Œæ¯”å¦‚å»¶è¿ŸåŠ è½½æŸäº›æ¨¡å—æˆ–ä¼˜åŒ–é…ç½®æ–‡ä»¶ä¹‹åï¼Œä½ å¯ä»¥å†æ¬¡æ£€æŸ¥ <code>performanceNodeTiming.bootstrapComplete</code> çš„å€¼ã€‚é€šè¿‡æ¯”è¾ƒä¼˜åŒ–å‰åçš„å€¼ï¼Œä½ å¯ä»¥é‡åŒ–ä¼˜åŒ–æªæ–½å¸¦æ¥çš„æ€§èƒ½æ”¹è¿›ï¼Œè¿™æœ‰åŠ©äºåˆ¤æ–­å“ªäº›ä¼˜åŒ–æªæ–½æ˜¯æœ‰æ•ˆçš„ã€‚</p></li><li><p><strong>ç›‘æ§å’Œå‘Šè­¦</strong>ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä½ å¯ä»¥å®šæœŸæ£€æŸ¥ <code>performanceNodeTiming.bootstrapComplete</code> çš„å€¼ï¼Œå¹¶å°†å…¶ä¸å†å²æ•°æ®è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœå‘ç°å¼•å¯¼å®Œæˆæ—¶é—´çªç„¶å¢åŠ ï¼Œè¿™å¯èƒ½æ˜¯åº”ç”¨æ€§èƒ½ä¸‹é™çš„æ—©æœŸä¿¡å·ã€‚ä½ å¯ä»¥è®¾ç½®å‘Šè­¦ï¼Œåœ¨å¼•å¯¼æ—¶é—´è¶…è¿‡é¢„å®šé˜ˆå€¼æ—¶æ”¶åˆ°é€šçŸ¥ï¼Œè¿™æ ·å¯ä»¥åŠæ—¶å‘ç°å¹¶è§£å†³æ½œåœ¨çš„æ€§èƒ½é—®é¢˜ã€‚</p></li></ol><p>è¦ä½¿ç”¨è¿™ä¸ªå±æ€§ï¼Œä½ éœ€è¦å…ˆå¼•å…¥ Node.js çš„ <code>perf_hooks</code> æ¨¡å—ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åº”ç”¨å…¶ä»–åˆå§‹åŒ–é€»è¾‘...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  `Bootstrap complete time: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">nodeTiming</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bootstrapComplete</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šåœ¨æ§åˆ¶å°è¾“å‡º Node.js å¼•å¯¼å®Œæˆçš„æ—¶é—´ï¼Œä»è€Œå¸®åŠ©ä½ åˆ†æå’Œä¼˜åŒ–åº”ç”¨çš„å¯åŠ¨æ€§èƒ½ã€‚</p><h3 id="performancenodetiming-environment" tabindex="-1"><a class="header-anchor" href="#performancenodetiming-environment"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancenodetimingenvironment" target="_blank" rel="noopener noreferrer">performanceNodeTiming.environment</a></span></a></h3><p>å½“ä½ å¼€å§‹ä½¿ç”¨ Node.js è¿›è¡Œå¼€å‘æ—¶ï¼Œäº†è§£å…¶æ€§èƒ½å’Œå¦‚ä½•æµ‹é‡å®ƒéå¸¸é‡è¦ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ä¸ªåä¸º<code>perf_hooks</code>çš„æ¨¡å—ï¼Œå®ƒè®©æˆ‘ä»¬å¯ä»¥ç›‘æ§åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚è‡ª Node.js çš„æŸä¸ªç‰ˆæœ¬ä»¥æ¥ï¼Œ<code>perf_hooks</code>æ¨¡å—å¼•å…¥äº†ä¸€ç§ç‰¹åˆ«çš„è®¡æ—¶æœºåˆ¶ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†å°±æ˜¯<code>performanceNodeTiming</code>å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡æä¾›äº†å…³äº Node.js ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„å„ä¸ªé˜¶æ®µçš„æ—¶é—´ä¿¡æ¯ã€‚åœ¨ v21.7.1 ä¸­ï¼Œ<code>performanceNodeTiming.environment</code>æ˜¯è¿™ä¸ªå¯¹è±¡çš„ä¸€ä¸ªå±æ€§ã€‚</p><h3 id="è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š"><span>è§£é‡Š</span></a></h3><ul><li><strong><code>performanceNodeTiming.environment</code></strong> æä¾›çš„æ˜¯ Node.js åˆå§‹åŒ–ç¯å¢ƒè®¾ç½®æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚å®ƒæŒ‡çš„æ˜¯ä» Node.js è¿›ç¨‹å¯åŠ¨åˆ° Node.js ç¯å¢ƒï¼ˆåŒ…æ‹¬ V8 å¼•æ“ã€å†…ç½®åº“åŠ è½½ç­‰ï¼‰å®Œå…¨å‡†å¤‡å¥½ï¼Œå¯ä»¥å¼€å§‹æ‰§è¡Œç”¨æˆ·ä»£ç ä¹‹é—´çš„æ—¶é—´ã€‚è¿™ä¸ªæ—¶é—´åŒ…æ‹¬äº†è¯»å–å’Œè§£ææ‚¨çš„åº”ç”¨ä¾èµ–ï¼ˆnode_modules ç­‰ï¼‰æ‰€éœ€çš„æ—¶é—´ã€‚</li></ul><h3 id="ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦"><span>ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦ï¼Ÿ</span></a></h3><p>çŸ¥é“æ‚¨çš„åº”ç”¨ç¨‹åºåœ¨å¯åŠ¨æ—¶åŠ è½½ç¯å¢ƒæ‰€éœ€çš„æ—¶é—´å¯¹äºä¼˜åŒ–å¯åŠ¨æ€§èƒ½éå¸¸é‡è¦ã€‚å¦‚æœè¿™ä¸ªæ—¶é—´å¤ªé•¿ï¼Œå¯èƒ½æ„å‘³ç€æ‚¨çš„åº”ç”¨æœ‰å¤§é‡çš„ä¾èµ–éœ€è¦åŠ è½½ï¼Œæˆ–è€…æŸäº›ä¾èµ–åŠ è½½æ•ˆç‡ä½ä¸‹ã€‚é€šè¿‡ä¼˜åŒ–è¿™éƒ¨åˆ†æ—¶é—´ï¼Œæ‚¨å¯ä»¥æ˜¾è‘—å‡å°‘åº”ç”¨ç¨‹åºçš„å¯åŠ¨æ—¶é—´ï¼Œæ”¹å–„ç”¨æˆ·ä½“éªŒã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨å®ƒ" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨å®ƒ"><span>å¦‚ä½•ä½¿ç”¨å®ƒï¼Ÿ</span></a></h3><p>é¦–å…ˆï¼Œä½ éœ€è¦åœ¨ä½ çš„ Node.js åº”ç”¨ç¨‹åºä¸­å¯¼å…¥<code>perf_hooks</code>æ¨¡å—ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç„¶åï¼Œä½ å¯ä»¥ç›´æ¥è®¿é—®<code>performanceNodeTiming.environment</code>æ¥è·å–ç¯å¢ƒåŠ è½½æ—¶é—´ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Environment load time: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">nodeTiming</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">environment</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ms`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™ä¼šè¾“å‡ºç¯å¢ƒåŠ è½½è€—è´¹çš„æ¯«ç§’æ•°ã€‚</p><h3 id="å®é™…åº”ç”¨æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨æ¡ˆä¾‹"><span>å®é™…åº”ç”¨æ¡ˆä¾‹</span></a></h3><ul><li><p><strong>æ€§èƒ½åŸºå‡†æµ‹è¯•</strong>ï¼šæ¯”å¦‚ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œä½ æƒ³ç¡®ä¿æœåŠ¡å™¨å°½å¯èƒ½å¿«åœ°å“åº”è¯·æ±‚ã€‚é‚£ä¹ˆä½ å°±éœ€è¦ç¡®ä¿æœåŠ¡å™¨å¯åŠ¨å’Œå‡†å¤‡æ¥å—è¯·æ±‚çš„æ—¶é—´å°½å¯èƒ½çŸ­ã€‚åˆ©ç”¨<code>performanceNodeTiming.environment</code>ï¼Œä½ å¯ä»¥å…·ä½“æµ‹é‡å‡ºç¯å¢ƒåŠ è½½è¿™ä¸€æ­¥éª¤å ç”¨çš„æ—¶é—´ã€‚å¦‚æœå‘ç°è¿™ä¸ªæ—¶é—´å¼‚å¸¸é•¿ï¼Œä½ å¯èƒ½éœ€è¦æ£€æŸ¥ä½ çš„ä¾èµ–ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰å¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ï¼Œæˆ–è€…æ˜¯å¦æœ‰ä¸å¿…è¦çš„ä¾èµ–å¯ä»¥ç§»é™¤ã€‚</p></li><li><p><strong>è°ƒè¯•å’Œä¼˜åŒ–</strong>ï¼šå¦‚æœä½ æ­£åœ¨ç»´æŠ¤ä¸€ä¸ªå¤§å‹é¡¹ç›®ï¼Œå¹¶ä¸”æ³¨æ„åˆ°éšç€æ—¶é—´çš„æ¨ç§»ï¼Œé¡¹ç›®çš„å¯åŠ¨æ—¶é—´å˜å¾—è¶Šæ¥è¶Šæ…¢ã€‚ä½ å¯ä»¥ä½¿ç”¨<code>performanceNodeTiming.environment</code>ä½œä¸ºè¯Šæ–­å·¥å…·ä¹‹ä¸€æ¥å¸®åŠ©å®šä½é—®é¢˜ã€‚æ¯”å¦‚ï¼Œé€šè¿‡æ¯”è¾ƒä¸åŒç‰ˆæœ¬çš„ç¯å¢ƒåŠ è½½æ—¶é—´ï¼Œä½ å¯ä»¥è¾¨åˆ«å‡ºæ€§èƒ½ä¸‹é™çš„åŸå› å¯èƒ½æ˜¯æ–°å¢çš„ä¾èµ–æˆ–è€…æ˜¯ä¾èµ–æ›´æ–°å¯¼è‡´çš„ã€‚</p></li></ul><p>é€šè¿‡ä½¿ç”¨<code>performanceNodeTiming.environment</code>ï¼Œä½ å¯ä»¥è·å¾—å…³é”®çš„æ€§èƒ½æŒ‡æ ‡ï¼Œå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œä¼˜åŒ–ä½ çš„ Node.js åº”ç”¨ç¨‹åºçš„å¯åŠ¨æ€§èƒ½ã€‚</p><h3 id="performancenodetiming-idletime" tabindex="-1"><a class="header-anchor" href="#performancenodetiming-idletime"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancenodetimingidletime" target="_blank" rel="noopener noreferrer">performanceNodeTiming.idleTime</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œè®©å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚å®ƒçš„è®¾è®¡å“²å­¦æ˜¯è½»é‡çº§å’Œé«˜æ•ˆï¼Œéå¸¸é€‚åˆå¤„ç†æ•°æ®å¯†é›†å‹çš„å®æ—¶åº”ç”¨ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>performanceNodeTiming.idleTime</code> æ˜¯æ€§èƒ½ç›‘è§†ï¼ˆPerformance Monitoringï¼‰API çš„ä¸€éƒ¨åˆ†ï¼Œç‰¹åˆ«æ˜¯å±äº Node.js ç‰¹æœ‰çš„æ€§èƒ½é’©å­ï¼ˆperformance hooksï¼‰ã€‚è¿™ä¸ª API æä¾›äº†æµ‹é‡ Node.js è¿›ç¨‹æ‰§è¡Œå„ä¸ªé˜¶æ®µè€—æ—¶çš„èƒ½åŠ›ã€‚å…·ä½“æ¥è¯´ï¼Œ<code>performanceNodeTiming.idleTime</code> å…³æ³¨çš„æ˜¯è¿›ç¨‹çš„ç©ºé—²æ—¶é—´ã€‚</p><h3 id="è§£é‡Š-performancenodetiming-idletime" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-performancenodetiming-idletime"><span>è§£é‡Š <code>performanceNodeTiming.idleTime</code></span></a></h3><p><code>performanceNodeTiming.idleTime</code> è¡¨ç¤ºä» Node.js è¿›ç¨‹å¯åŠ¨åˆ°å½“å‰è°ƒç”¨æ—¶åˆ»ï¼Œç³»ç»Ÿå¤„äºç©ºé—²çŠ¶æ€çš„ç´¯ç§¯æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’ï¼ˆmsï¼‰ã€‚ç©ºé—²æ—¶é—´æŒ‡çš„æ˜¯ CPU å¹¶æœªè¿›è¡Œè®¡ç®—æˆ–æ‰§è¡Œç¨‹åºä»£ç çš„æ—¶é—´æ®µï¼Œè€Œæ˜¯ç­‰å¾…æŸäº›å¤–éƒ¨æ“ä½œå®Œæˆï¼Œæ¯”å¦‚ I/O æ“ä½œï¼ˆè¾“å…¥/è¾“å‡ºæ“ä½œï¼Œä¾‹å¦‚è¯»å–ç¡¬ç›˜æ–‡ä»¶ã€ç½‘ç»œè¯·æ±‚ç­‰ï¼‰ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><h4 id="_1-æ€§èƒ½åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_1-æ€§èƒ½åˆ†æ"><span>1. æ€§èƒ½åˆ†æ</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œæƒ³è¦è¯„ä¼°åº”ç”¨çš„æ€§èƒ½è¡¨ç°ã€‚é€šè¿‡æµ‹é‡<code>performanceNodeTiming.idileTime</code>ï¼Œä½ å¯ä»¥äº†è§£åˆ°ç¨‹åºåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æœ‰å¤šå°‘æ—¶é—´æ˜¯å¤„äºé—²ç½®çŠ¶æ€çš„ã€‚å¦‚æœä½ è§‚å¯Ÿåˆ°å¼‚å¸¸é«˜çš„ç©ºé—²æ—¶é—´ï¼Œè¿™å¯èƒ½æ„å‘³ç€ç¨‹åºé¢‘ç¹ç­‰å¾…å¤–éƒ¨èµ„æºï¼Œå¦‚æ•°æ®åº“æŸ¥è¯¢æˆ–æ–‡ä»¶è¯»å–ã€‚è¿™å¯ä»¥ä½œä¸ºä¼˜åŒ–çš„ä¸€ä¸ªä¿¡å·ï¼Œæç¤ºä½ å¯èƒ½éœ€è¦å¯¹æ•°æ®åº“æŸ¥è¯¢è¿›è¡Œä¼˜åŒ–ï¼Œæˆ–è€…æ”¹è¿›æ–‡ä»¶è¯»å–ç­–ç•¥ï¼Œä»¥å‡å°‘ç­‰å¾…æ—¶é—´ï¼Œæå‡ç¨‹åºæ•´ä½“æ€§èƒ½ã€‚</p><h4 id="_2-ç›‘æ§å’ŒæŠ¥è­¦" tabindex="-1"><a class="header-anchor" href="#_2-ç›‘æ§å’ŒæŠ¥è­¦"><span>2. ç›‘æ§å’ŒæŠ¥è­¦</span></a></h4><p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä½ å¯ä»¥å®šæœŸè®°å½•<code>performanceNodeTiming.idleTime</code>çš„å€¼ï¼Œå¹¶è®¾ç½®é˜ˆå€¼ï¼Œå½“ç©ºé—²æ—¶é—´è¶…è¿‡è¿™ä¸ªé¢„è®¾çš„é˜ˆå€¼æ—¶ï¼Œè‡ªåŠ¨è§¦å‘æŠ¥è­¦é€šçŸ¥ã€‚è¿™æ ·å¯ä»¥åŠæ—¶å‘ç°ç³»ç»Ÿä¸­å¯èƒ½å­˜åœ¨çš„æ€§èƒ½ç“¶é¢ˆæˆ–å¼‚å¸¸ç­‰å¾…äº‹ä»¶ã€‚</p><h4 id="_3-æ€§èƒ½åŸºçº¿å»ºç«‹" tabindex="-1"><a class="header-anchor" href="#_3-æ€§èƒ½åŸºçº¿å»ºç«‹"><span>3. æ€§èƒ½åŸºçº¿å»ºç«‹</span></a></h4><p>åœ¨å¯¹ç³»ç»Ÿè¿›è¡Œå¤§è§„æ¨¡æ›´æ–°æˆ–ä¼˜åŒ–å‰ï¼Œå…ˆæµ‹é‡å¹¶è®°å½•<code>performanceNodeTiming.idleTime</code>ï¼Œä½œä¸ºæ€§èƒ½åŸºçº¿ã€‚ä¹‹åæ”¹åŠ¨åå†æ¬¡æµ‹é‡ï¼Œå¯¹æ¯”ä¸¤æ¬¡çš„ç©ºé—²æ—¶é—´ï¼Œå¯ä»¥ç›´è§‚åœ°çœ‹å‡ºä¼˜åŒ–æ˜¯å¦æœ‰æ•ˆï¼Œç³»ç»Ÿæ€§èƒ½æ˜¯å¦æœ‰æ‰€æå‡ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-3" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-3"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>åœ¨ Node.js ç¨‹åºä¸­ï¼Œä½ å¯ä»¥è¿™æ ·è·å–<code>performanceNodeTiming.idleTime</code>çš„å€¼ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å– Node.js æ€§èƒ½è®¡æ—¶ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> nodeTiming</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">nodeTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç©ºé—²æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Idle Time: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">nodeTiming</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">idleTime</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ms`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•å¯¼å…¥ Node.js çš„æ€§èƒ½é’©å­ APIï¼Œè·å–æ€§èƒ½è®¡æ—¶å¯¹è±¡ï¼Œå¹¶æ‰“å°å‡ºç¨‹åºçš„ç©ºé—²æ—¶é—´ã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œ<code>performanceNodeTiming.idleTime</code>æ˜¯ Node.js ä¸­ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„æ€§èƒ½æŒ‡æ ‡ï¼Œå®ƒå¸®åŠ©å¼€å‘è€…ç†è§£å’Œä¼˜åŒ–åº”ç”¨ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ã€‚é€šè¿‡ç›‘æ§å’Œåˆ†æç©ºé—²æ—¶é—´ï¼Œå¯ä»¥æœ‰æ•ˆåœ°è¯†åˆ«å’Œè§£å†³æ€§èƒ½ç“¶é¢ˆï¼Œæé«˜åº”ç”¨çš„å“åº”é€Ÿåº¦å’Œå¤„ç†èƒ½åŠ›ã€‚</p><h3 id="performancenodetiming-loopexit" tabindex="-1"><a class="header-anchor" href="#performancenodetiming-loopexit"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancenodetimingloopexit" target="_blank" rel="noopener noreferrer">performanceNodeTiming.loopExit</a></span></a></h3><p>Node.js ä¸­çš„<code>performanceNodeTiming.loopExit</code>æ˜¯æ€§èƒ½ç›‘æ§å·¥å…·(<code>perf_hooks</code>)æ¨¡å—æ‰€æä¾›çš„ä¸€ä¸ªå±æ€§ï¼Œç”¨äºäº†è§£äº‹ä»¶å¾ªç¯ç»“æŸçš„æ—¶é—´ã€‚åœ¨ Node.js ä¸­ï¼Œäº‹ä»¶å¾ªç¯(event loop)æ˜¯ä¸€ä¸ªéå¸¸æ ¸å¿ƒçš„æ¦‚å¿µï¼Œå®ƒè´Ÿè´£ç®¡ç†æ‰€æœ‰å¼‚æ­¥æ“ä½œï¼Œæ¯”å¦‚æ–‡ä»¶è¯»å†™ã€ç½‘ç»œè¯·æ±‚ç­‰ã€‚</p><p>äº†è§£<code>performanceNodeTiming.loopExit</code>ä¹‹å‰ï¼Œå…ˆæ¥ç®€å•ç†è§£ä¸€ä¸‹äº‹ä»¶å¾ªç¯ï¼š</p><p>å½“ä½ è¿è¡Œä¸€ä¸ª Node.js ç¨‹åºæ—¶ï¼Œä½ çš„ä»£ç ä¼šè¢«åŠ è½½åˆ°ä¸€ä¸ªå«åšè°ƒç”¨æ ˆ(call stack)çš„åœ°æ–¹ã€‚å¦‚æœä»£ç é‡Œæœ‰å¼‚æ­¥æ“ä½œï¼Œæ¯”å¦‚ setTimeout æˆ–è€…æ–‡ä»¶è¯»å–ï¼Œè¿™äº›æ“ä½œå°±ä¼šè¢«æ”¾åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œè€Œä¸æ˜¯ç«‹å³æ‰§è¡Œã€‚åªæœ‰å½“è°ƒç”¨æ ˆä¸ºç©ºæ—¶ï¼ˆä¹Ÿå°±æ˜¯åŒæ­¥ä»£ç æ‰§è¡Œå®Œæ¯•ï¼‰ï¼Œäº‹ä»¶å¾ªç¯æ‰ä¼šå¼€å§‹ä»é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡æ¥æ‰§è¡Œã€‚è¿™ä¸ªé˜Ÿåˆ—å°±ç§°ä¸ºä»»åŠ¡é˜Ÿåˆ—(task queue)ã€‚</p><p>ç°åœ¨è°ˆè°ˆ<code>performanceNodeTiming.loopExit</code>ï¼š</p><p>è¿™ä¸ªå±æ€§è¡¨ç¤ºçš„æ˜¯äº‹ä»¶å¾ªç¯æœ€åä¸€æ¬¡åœæ­¢å¤„ç†ä»»åŠ¡çš„æ—¶é—´ç‚¹ã€‚è¿™ä¸ªæ—¶é—´ç‚¹æ˜¯è‡ª Node.js è¿›ç¨‹å¯åŠ¨ä»¥æ¥çš„æ¯«ç§’æ•°ã€‚æ¯æ¬¡ Node.js å®Œæˆä¸€è½®äº‹ä»¶å¾ªç¯å¹¶ä¸”æš‚æ—¶æ²¡æœ‰æ›´å¤šä»»åŠ¡è¦å¤„ç†æ—¶ï¼Œ<code>loopExit</code>çš„å€¼å°±ä¼šæ›´æ–°ã€‚</p><p>è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®šä¹‰ä¸€ä¸ªæ€§èƒ½è§‚å¯Ÿè€…æ¥è§‚å¯Ÿæ€§èƒ½æŒ‡æ ‡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼€å§‹æ‰§è¡Œä¸€äº›å¼‚æ­¥ä»»åŠ¡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å½“è¿™ä¸ªsetTimeoutå›è°ƒæ‰§è¡Œæ—¶ï¼Œäº‹ä»¶å¾ªç¯å·²ç»è‡³å°‘è·‘äº†ä¸€æ¬¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`äº‹ä»¶å¾ªç¯é€€å‡ºæ—¶é—´: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">nodeTiming</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">loopExit</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯èƒ½è¿˜æœ‰å…¶ä»–çš„å¼‚æ­¥ä»»åŠ¡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setImmediate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è¿™é‡Œæ˜¯å¦ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†<code>perf_hooks</code>æ¨¡å—æ¥ç›‘è§†æ€§èƒ½æŒ‡æ ‡ï¼Œé€šè¿‡<code>PerformanceObserver</code>æ¥æ‰“å°æ€§èƒ½å…¥å£çš„ç›¸å…³ä¿¡æ¯ã€‚è®¾ç½®äº†ä¸€ä¸ª 1 ç§’åæ‰§è¡Œçš„<code>setTimeout</code>ï¼Œå®ƒå°†ä¼šåœ¨äº‹ä»¶å¾ªç¯çš„æŸä¸ªæ—¶åˆ»æ‰§è¡Œã€‚åœ¨<code>setTimeout</code>çš„å›è°ƒå‡½æ•°å†…éƒ¨ï¼Œæˆ‘ä»¬æ‰“å°å‡ºäº†<code>performance.nodeTiming.loopExit</code>çš„å€¼ï¼Œè¿™ä¸ªå€¼ä»£è¡¨äº†äº‹ä»¶å¾ªç¯ä¸Šä¸€æ¬¡é€€å‡ºå¤„ç†ä»»åŠ¡çš„æ—¶é—´ç‚¹ã€‚</p><p>å®é™…åº”ç”¨ä¸­ï¼Œ<code>performanceNodeTiming.loopExit</code>å¯ä»¥å¸®åŠ©å¼€å‘è€…äº†è§£å’Œç›‘æ§äº‹ä»¶å¾ªç¯çš„æ€§èƒ½ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ª Node.js æœåŠ¡é€šå¸¸åœ¨ç›¸å¯¹å›ºå®šçš„æ—¶é—´ç‚¹é€€å‡ºäº‹ä»¶å¾ªç¯ï¼Œä½†æŸæ¬¡çªç„¶å»¶è¿Ÿäº†å¾ˆé•¿æ—¶é—´å†é€€å‡ºï¼Œè¿™å¯èƒ½æ„å‘³ç€æœåŠ¡æ­£åœ¨é‡åˆ°æ€§èƒ½é—®é¢˜ï¼Œå¦‚æŸäº›å¼‚æ­¥æ“ä½œè€—æ—¶è¿‡é•¿ï¼Œæˆ–è€…ç³»ç»Ÿèµ„æºç´§å¼ ç­‰ã€‚é€šè¿‡è¿™æ ·çš„ç›‘æ§ï¼Œå¼€å‘è€…å¯ä»¥åŠæ—¶åœ°å‘ç°æ€§èƒ½ç“¶é¢ˆï¼Œå¹¶é‡‡å–ç›¸åº”æªæ–½ä¼˜åŒ–ã€‚</p><h3 id="performancenodetiming-loopstart" tabindex="-1"><a class="header-anchor" href="#performancenodetiming-loopstart"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancenodetimingloopstart" target="_blank" rel="noopener noreferrer">performanceNodeTiming.loopStart</a></span></a></h3><p>Node.js ä¸­çš„ <code>performanceNodeTiming.loopStart</code> å±äºæ€§èƒ½é’©å­ï¼ˆPerformance Hooksï¼‰API çš„ä¸€éƒ¨åˆ†ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºè·å–æ€§èƒ½æŒ‡æ ‡çš„æ¨¡å—ã€‚åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>performanceNodeTiming.loopStart</code> å±æ€§æä¾›äº†ä¸€ä¸ªéå¸¸ç‰¹å®šä½†é‡è¦çš„æµ‹é‡ç‚¹ï¼šå®ƒè¡¨ç¤ºå½“ Node.js äº‹ä»¶å¾ªç¯å¼€å§‹è¿ä½œçš„æ—¶é—´ã€‚</p><p>ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸€ç‚¹ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦æ˜ç¡®å‡ ä¸ªæ¦‚å¿µï¼š</p><ol><li><p><strong>Node.js çš„äº‹ä»¶å¾ªç¯</strong>ï¼šç®€è€Œè¨€ä¹‹ï¼Œäº‹ä»¶å¾ªç¯æ˜¯ Node.js è¿è¡Œæ—¶çš„æ ¸å¿ƒï¼Œè´Ÿè´£è°ƒåº¦å¼‚æ­¥æ“ä½œã€è¾“å…¥/è¾“å‡ºå¤„ç†ç­‰ã€‚æ‰€æœ‰çš„éé˜»å¡æ“ä½œéƒ½é€šè¿‡è¿™ä¸ªå¾ªç¯æ¥è°ƒåº¦æ‰§è¡Œã€‚</p></li><li><p><strong>æ€§èƒ½é’©å­ï¼ˆPerformance Hooksï¼‰</strong>ï¼šè¿™æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªæ¨¡å—ï¼Œå…è®¸ä½ è§‚æµ‹å’Œæµ‹é‡ä»£ç è¿è¡Œæ—¶çš„æ€§èƒ½æ•°æ®ã€‚å®ƒå¯ä»¥ç”¨æ¥ç›‘æ§ä¸åŒé˜¶æ®µçš„è€—æ—¶ï¼Œå¸®åŠ©å¼€å‘è€…ä¼˜åŒ–åº”ç”¨æ€§èƒ½ã€‚</p></li></ol><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¯¦ç»†è§£é‡Š <code>performanceNodeTiming.loopStart</code>ï¼š</p><ul><li><p><strong>ä½•æ—¶ä½¿ç”¨</strong>ï¼šå½“ä½ æƒ³è¦ç²¾ç¡®äº†è§£ä½ çš„ Node.js åº”ç”¨çš„å¯åŠ¨æ€§èƒ½æ—¶ï¼Œå³ä»è¿›ç¨‹å¯åŠ¨åˆ°äº‹ä»¶å¾ªç¯å¼€å§‹å¤„ç†ä»»åŠ¡æ‰€éœ€çš„æ—¶é—´ã€‚</p></li><li><p><strong>å®é™…è¿ç”¨ä¾‹å­</strong>ï¼š</p><ul><li><strong>æ€§èƒ½ç›‘æµ‹</strong>ï¼šå¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªå¤§å‹åº”ç”¨ï¼Œå¹¶ä¸”è¯¥åº”ç”¨å¯åŠ¨é€Ÿåº¦å¯¹ç”¨æˆ·ä½“éªŒéå¸¸å…³é”®ï¼Œä½ å¯èƒ½æƒ³è¦çŸ¥é“å¯åŠ¨è¿‡ç¨‹ä¸­å„ä¸ªé˜¶æ®µçš„è€—æ—¶ã€‚å…¶ä¸­ï¼Œäº†è§£ä»è¿›ç¨‹å¯åŠ¨åˆ°äº‹ä»¶å¾ªç¯å¯åŠ¨è¿™ä¸€é˜¶æ®µçš„è€—æ—¶æ˜¯ä¸ªå…³é”®ç‚¹ã€‚</li><li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šé€šè¿‡æµ‹é‡è¿™ä¸€æ—¶é—´ç‚¹ï¼Œä½ å¯ä»¥è¯†åˆ«å¹¶ä¼˜åŒ–å½±å“å¯åŠ¨é€Ÿåº¦çš„å› ç´ â€”â€”æ¯”å¦‚å‡å°‘åˆå§‹åŒ–æ—¶çš„åŒæ­¥æ“ä½œï¼Œæˆ–è€…æ¨è¿Ÿä¸€äº›ä¸é‚£ä¹ˆç´§æ€¥ä»»åŠ¡çš„æ‰§è¡Œã€‚</li><li><strong>é—®é¢˜è¯Šæ–­</strong>ï¼šå¦‚æœä½ çš„åº”ç”¨çªç„¶å˜å¾—å¯åŠ¨ç¼“æ…¢ï¼Œä½¿ç”¨ <code>performanceNodeTiming.loopStart</code> å¯ä»¥å¸®åŠ©ä½ ç¡®å®šé—®é¢˜æ˜¯å¦å‡ºåœ¨å¯åŠ¨æ—©æœŸçš„æŸä¸ªç¯èŠ‚ã€‚</li></ul></li></ul><p>å…·ä½“å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºèŒƒä»£ç ç‰‡æ®µï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ€§èƒ½è§‚å¯Ÿè€…æ¥å¼‚æ­¥åœ°æ”¶é›†å’ŒæŠ¥å‘Šæ€§èƒ½æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clearMarks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åšä¸€äº›æ“ä½œ......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Event Loop Start: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">nodeTiming</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">loopStart</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é¦–å…ˆå¯¼å…¥äº†æ‰€éœ€çš„æ¨¡å—ï¼Œå¹¶è®¾ç½®ä¸€ä¸ªæ€§èƒ½è§‚å¯Ÿè€…æ¥ç›‘å¬å’Œæ‰“å°æ€§èƒ½æ¡ç›®ä¿¡æ¯ã€‚æœ€åï¼Œå®ƒæ‰“å°äº†äº‹ä»¶å¾ªç¯å¼€å§‹çš„æ—¶é—´ï¼Œè¿™ä¸ªæ—¶é—´ç‚¹é€šè¿‡ <code>performance.nodeTiming.loopStart</code> è·å–ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥å¼€å§‹æ¢ç´¢å’Œä¼˜åŒ–ä½ çš„ Node.js åº”ç”¨æ€§èƒ½ï¼Œä½¿å…¶æ›´åŠ é«˜æ•ˆå’Œå“åº”å¿«é€Ÿã€‚</p><h3 id="performancenodetiming-nodestart" tabindex="-1"><a class="header-anchor" href="#performancenodetiming-nodestart"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancenodetimingnodestart" target="_blank" rel="noopener noreferrer">performanceNodeTiming.nodeStart</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ä¸ªæ¨¡å—å«åš <code>perf_hooks</code>ï¼ˆæ€§èƒ½é’©å­ï¼‰ï¼Œå®ƒå…è®¸æˆ‘ä»¬æµ‹é‡å’Œç›‘æ§ä»£ç çš„æ€§èƒ½ã€‚åœ¨è¿™ä¸ªæ¨¡å—é‡Œï¼Œæœ‰ä¸€ä¸ªç‰¹å®šçš„å±æ€§å«åš <code>performanceNodeTiming.nodeStart</code>ï¼Œè¿™ä¸ªå±æ€§æä¾›äº†ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ€§èƒ½æŒ‡æ ‡ã€‚</p><h3 id="performancenodetiming-nodestart-è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#performancenodetiming-nodestart-è¯¦è§£"><span><code>performanceNodeTiming.nodeStart</code> è¯¦è§£</span></a></h3><p><code>performanceNodeTiming.nodeStart</code> æ˜¯ <code>perf_hooks</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒè¡¨ç¤º Node.js è¿›ç¨‹å¯åŠ¨çš„æ—¶é—´ç‚¹ã€‚æ›´å…·ä½“åœ°è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œè¡¨æ˜äº† Node.js è¿›ç¨‹å¼€å§‹æ‰§è¡Œçš„ç²¾ç¡®æ—¶é—´ã€‚è¿™ä¸ªæ—¶é—´æˆ³æ˜¯ä»¥æ¯«ç§’ä¸ºå•ä½çš„ï¼Œä»ä¸€ä¸ªå›ºå®šçš„æ—¶é—´ç‚¹ï¼ˆæ¯”å¦‚ UNIX çºªå…ƒæ—¶é—´ï¼‰å¼€å§‹è®¡ç®—ã€‚</p><h3 id="å®é™…è¿ç”¨-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨-2"><span>å®é™…è¿ç”¨</span></a></h3><p>äº†è§£ <code>performanceNodeTiming.nodeStart</code> çš„å€¼å¯¹äºæ€§èƒ½åˆ†æéå¸¸é‡è¦ï¼Œç‰¹åˆ«æ˜¯å½“ä½ æƒ³è¦æµ‹é‡åº”ç”¨ç¨‹åºå¯åŠ¨é€Ÿåº¦æˆ–è€…ä¼˜åŒ–å¯åŠ¨è¿‡ç¨‹æ—¶ã€‚ä¸‹é¢æ˜¯å‡ ä¸ªå®é™…çš„è¿ç”¨åœºæ™¯ï¼š</p><ol><li><p><strong>å¯åŠ¨æ—¶é—´åˆ†æ</strong>ï¼šä½ å¯ä»¥ä½¿ç”¨ <code>performanceNodeTiming.nodeStart</code> æ¥æµ‹é‡ä½ çš„ Node.js åº”ç”¨ç¨‹åºä»å¯åŠ¨åˆ°å‡†å¤‡å°±ç»ªæ‰€éœ€çš„æ—¶é—´ã€‚è¿™å¯¹äºä¼˜åŒ–åº”ç”¨å¯åŠ¨é€Ÿåº¦éå¸¸æœ‰å¸®åŠ©ã€‚</p></li><li><p><strong>æ€§èƒ½åŸºå‡†æµ‹è¯•</strong>ï¼šåœ¨è¿›è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•æ—¶ï¼Œäº†è§£è¿›ç¨‹å¯åŠ¨æ—¶é—´å¯¹äºå»ºç«‹æ€§èƒ½åŸºçº¿éå¸¸é‡è¦ã€‚ä½ å¯ä»¥é€šè¿‡æ¯”è¾ƒä¸åŒé…ç½®æˆ–ç‰ˆæœ¬ä¸‹çš„ <code>nodeStart</code> æ—¶é—´ï¼Œæ¥è¯„ä¼°æ€§èƒ½æ”¹è¿›æˆ–é€€åŒ–ã€‚</p></li><li><p><strong>ç›‘æ§å’Œå‘Šè­¦</strong>ï¼šå¦‚æœä½ åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç›‘æ§ä½ çš„ Node.js åº”ç”¨ï¼Œ<code>performanceNodeTiming.nodeStart</code> å¯ä»¥ä½œä¸ºä¸€ä¸ªæŒ‡æ ‡æ¥å¸®åŠ©ä½ å‘ç°é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåº”ç”¨ç¨‹åºå¯åŠ¨æ—¶é—´çªç„¶å¢åŠ ï¼Œå¯èƒ½è¡¨æ˜æœ‰æ€§èƒ½é—®é¢˜æˆ–è€…å…¶ä»–åº•å±‚é—®é¢˜ã€‚</p></li></ol><h3 id="å¦‚ä½•ä½¿ç”¨-4" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-4"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>åœ¨ Node.js ä»£ç ä¸­ä½¿ç”¨ <code>performanceNodeTiming.nodeStart</code> éå¸¸ç›´æ¥ã€‚é¦–å…ˆï¼Œä½ éœ€è¦å¼•å…¥ <code>perf_hooks</code> æ¨¡å—ï¼Œç„¶åå°±å¯ä»¥è®¿é—® <code>performanceNodeTiming</code> å¯¹è±¡äº†ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å– Node.js è¿›ç¨‹å¯åŠ¨çš„æ—¶é—´ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> nodeStart</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">nodeTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">nodeStart</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Node.js process started at: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">nodeStart</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> milliseconds`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™è¡Œä»£ç ä¼šè¾“å‡º Node.js è¿›ç¨‹å¯åŠ¨çš„æ—¶é—´ï¼Œè®©ä½ å¯ä»¥å¯¹å…¶è¿›è¡Œåˆ†æå’Œç›‘æ§ã€‚</p><p>æ€»ä¹‹ï¼Œ<code>performanceNodeTiming.nodeStart</code> æ˜¯ Node.js æ€§èƒ½é’©å­ä¸­çš„ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å±æ€§ï¼Œå®ƒèƒ½å¸®åŠ©ä½ ç†è§£å’Œä¼˜åŒ–ä½ çš„åº”ç”¨ç¨‹åºçš„å¯åŠ¨æ€§èƒ½ã€‚é€šè¿‡æµ‹é‡å’Œåˆ†æå¯åŠ¨æ—¶é—´ï¼Œä½ å¯ä»¥åšå‡ºç›¸åº”çš„ä¼˜åŒ–ï¼Œä»è€Œæé«˜ç”¨æˆ·ä½“éªŒå’Œåº”ç”¨æ•ˆç‡ã€‚</p><h3 id="performancenodetiming-v8start" tabindex="-1"><a class="header-anchor" href="#performancenodetiming-v8start"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performancenodetimingv8start" target="_blank" rel="noopener noreferrer">performanceNodeTiming.v8Start</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript ç¯å¢ƒï¼Œå®ƒè®©å¼€å‘è€…å¯ä»¥ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰å¾ˆå¤šå†…ç½®æ¨¡å—å’Œ APIs æ¥å¸®åŠ©å¼€å‘è€…æ„å»ºé«˜æ€§èƒ½çš„åº”ç”¨ç¨‹åºã€‚å…¶ä¸­ä¹‹ä¸€å°±æ˜¯<code>perf_hooks</code>æ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—æä¾›äº†è·å–æ€§èƒ½æŒ‡æ ‡æ•°æ®çš„æ–¹æ³•ï¼Œè¿™äº›æ•°æ®å¯¹äºç›‘æ§å’Œæ”¹è¿›åº”ç”¨æ€§èƒ½éå¸¸æœ‰ç”¨ã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>performanceNodeTiming.v8Start</code>æ˜¯<code>perf_hooks</code>æ¨¡å—çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒè¡¨ç¤º V8 JavaScript å¼•æ“å¼€å§‹åˆå§‹åŒ–çš„ç²¾ç¡®æ—¶é—´ï¼ˆä»¥é«˜ç²¾åº¦çš„æ—¶é—´æˆ³å½¢å¼ï¼‰ã€‚ç®€è€Œè¨€ä¹‹ï¼Œè¿™ä¸ªæ—¶é—´æˆ³å‘Šè¯‰æˆ‘ä»¬ Node.js å¯åŠ¨æ—¶ï¼ŒV8 å¼•æ“åˆå§‹åŒ–å·¥ä½œå¼€å§‹çš„å…·ä½“æ—¶é—´ç‚¹ã€‚</p><p>ä¸ºä»€ä¹ˆè¿™ä¸ªä¿¡æ¯æœ‰ç”¨å‘¢ï¼Ÿæœ‰å‡ ä¸ªåŸå› ï¼š</p><ul><li><strong>æ€§èƒ½ç›‘æ§ä¸ä¼˜åŒ–</strong>ï¼šäº†è§£ V8 å¼•æ“å¯åŠ¨æ‰€éœ€çš„æ—¶é—´å¯ä»¥å¸®åŠ©ä½ ç›‘æ§åº”ç”¨çš„å¯åŠ¨æ€§èƒ½ã€‚å¦‚æœä½ å‘ç° V8 çš„å¯åŠ¨æ—¶é—´çªç„¶å˜é•¿ï¼Œè¿™å¯èƒ½æ˜¯æŸäº›æ›´æ”¹å½±å“äº†å¯åŠ¨æ€§èƒ½çš„ä¿¡å·ã€‚</li><li><strong>æ¯”è¾ƒä¸åŒç‰ˆæœ¬çš„ Node.js</strong>ï¼šéšç€ Node.js æ–°ç‰ˆæœ¬çš„å‘å¸ƒï¼ŒV8 å¼•æ“ä¹Ÿä¼šæ›´æ–°ã€‚é€šè¿‡æ¯”è¾ƒä¸åŒç‰ˆæœ¬çš„ Node.js ä¸­ V8 å¯åŠ¨æ—¶é—´ï¼Œå¯ä»¥è¯„ä¼°å¼•æ“å‡çº§å¯¹å¯åŠ¨æ€§èƒ½çš„å½±å“ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-4"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œå¹¶æƒ³è¦æµ‹é‡ä»ç¨‹åºå¯åŠ¨åˆ°ç¬¬ä¸€ä¸ª HTTP è¯·æ±‚è¢«å¤„ç†æ‰€èŠ±è´¹çš„æ€»æ—¶é—´ã€‚<code>performanceNodeTiming.v8Start</code>å¯ä»¥ä½œä¸ºè®¡ç®—è¿™ä¸ªæ€»æ—¶é•¿çš„èµ·å§‹ç‚¹ä¹‹ä¸€ã€‚</p><ol><li><strong>ç›‘æ§ V8 å¼•æ“å¯åŠ¨æ—¶é—´</strong></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ€§èƒ½è§‚å¯Ÿè€…æ¥å¼‚æ­¥åœ°æ”¶é›†æ€§èƒ½æŒ‡æ ‡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clearMarks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–V8å¯åŠ¨æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">nodeTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">v8Start</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>æ€§èƒ½åˆ†æçš„ä¸€éƒ¨åˆ†</strong><br> å½“ä½ åœ¨è¿›è¡Œæ›´å…¨é¢çš„æ€§èƒ½åˆ†ææ—¶ï¼ŒçŸ¥é“ V8 å¯åŠ¨æ—¶é—´å¯ä»¥å¸®åŠ©ä½ ç†è§£ Node.js å¯åŠ¨è¿‡ç¨‹ä¸­å„ä¸ªé˜¶æ®µæ‰€éœ€çš„æ—¶é—´ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½æƒ³è¦æ¯”è¾ƒ V8 å¯åŠ¨ã€è„šæœ¬åŠ è½½ã€ä»¥åŠåº”ç”¨ç¨‹åºé€»è¾‘å¼€å§‹æ‰§è¡Œä¹‹é—´çš„æ—¶é—´å·®ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  `V8å¼•æ“å¯åŠ¨è€—æ—¶: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    performance</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">nodeTiming</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">v8Start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timeOrigin</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">  }</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">æ¯«ç§’`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  `åº”ç”¨ç¨‹åºå¯åŠ¨è€—æ—¶: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Date</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">nodeTiming</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">v8Start</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">æ¯«ç§’`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œ<code>performance.timeOrigin</code>æä¾›äº†ä¸€ä¸ªå‚è€ƒç‚¹ï¼Œä»£è¡¨äº†å½“å‰ Node.js è¿›ç¨‹çš„èµ·å§‹æ—¶é—´ã€‚é€šè¿‡ä¸<code>v8Start</code>çš„æ¯”è¾ƒï¼Œä½ å¯ä»¥å¾—å‡º V8 å¼•æ“åˆå§‹åŒ–æ‰€éœ€çš„æ—¶é—´ã€‚éšåï¼Œä½¿ç”¨<code>Date.now()</code>å’Œ<code>v8Start</code>çš„å·®å€¼ï¼Œåˆ™èƒ½ä¼°ç®—å‡ºä» V8 å¼•æ“åˆå§‹åŒ–å®Œæˆåˆ°å½“å‰æ—¶åˆ»ï¼ˆé€šå¸¸æ˜¯ä»£ç ä¸­è¯¥è¡Œæ‰§è¡Œæ—¶åˆ»ï¼‰æ‰€ç»è¿‡çš„æ—¶é—´ï¼Œä»è€Œé—´æ¥åæ˜ äº†ä½ çš„åº”ç”¨ç¨‹åºåˆå§‹åŒ–å’Œå¯åŠ¨æ‰€éœ€è¦çš„æ—¶é—´ã€‚</p><h3 id="æ€»ç»“-5" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-5"><span>æ€»ç»“</span></a></h3><p><code>performanceNodeTiming.v8Start</code>æ˜¯ Node.js ä¸­ç”¨äºç›‘æ§å’Œä¼˜åŒ– V8 å¼•æ“å¯åŠ¨æ€§èƒ½çš„ä¸€ä¸ªé‡è¦æŒ‡æ ‡ã€‚é€šè¿‡å®ƒï¼Œå¼€å‘è€…å¯ä»¥æ›´å¥½åœ°ç†è§£å’Œä¼˜åŒ–åº”ç”¨çš„å¯åŠ¨æµç¨‹ï¼Œå°¤å…¶æ˜¯å¯¹äºå¤§å‹æˆ–å¤æ‚åº”ç”¨çš„æ€§èƒ½è°ƒä¼˜éå¸¸å…³é”®ã€‚</p><h2 id="class-performanceresourcetiming" tabindex="-1"><a class="header-anchor" href="#class-performanceresourcetiming"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#class-performanceresourcetiming" target="_blank" rel="noopener noreferrer">Class: PerformanceResourceTiming</a></span></a></h2><p>Node.js ä¸­çš„ <code>PerformanceResourceTiming</code> ç±»æ˜¯ä» Performance Timing API æ´¾ç”Ÿçš„ï¼Œè¿™æ˜¯ä¸€ç§ç”¨äºæ”¶é›†å’Œåˆ†æä½ çš„åº”ç”¨ç¨‹åºæ€§èƒ½æ•°æ®çš„å·¥å…·ã€‚åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œè¿™ä¸ªç±»æä¾›äº†å…³äºç‰¹å®šèµ„æºåŠ è½½æ—¶é—´çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¸®åŠ©å¼€å‘è€…è¯Šæ–­æ€§èƒ½ç“¶é¢ˆã€‚</p><p>è®©æˆ‘ä»¬é€šè¿‡å‡ ä¸ªå…³é”®å±æ€§å’Œå®é™…è¿ç”¨çš„ä¾‹å­æ¥é€šä¿—æ˜“æ‡‚åœ°äº†è§£å®ƒï¼š</p><h3 id="å…³é”®å±æ€§" tabindex="-1"><a class="header-anchor" href="#å…³é”®å±æ€§"><span>å…³é”®å±æ€§</span></a></h3><ol><li><strong>startTime</strong> - è·å–æˆ–è®¾ç½®èµ„æºè·å–æ“ä½œç›¸å¯¹äº PerformanceTiming.fetchStart å±æ€§çš„å¼€å§‹æ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚è¿™åŸºæœ¬ä¸Šæ ‡è®°äº†æµ‹é‡çš„èµ·ç‚¹ã€‚</li><li><strong>duration</strong> - è¡¨ç¤ºè·å–èµ„æºæ‰€èŠ±è´¹çš„æ€»æ—¶é—´ï¼Œä»è¯·æ±‚å¼€å§‹åˆ°ä¼ è¾“ç»“æŸã€‚</li><li><strong>domainLookupStart</strong> å’Œ <strong>domainLookupEnd</strong> - è¿™ä¸¤ä¸ªå±æ€§æä¾›äº†åŸŸåæŸ¥è¯¢çš„å¼€å§‹å’Œç»“æŸæ—¶é—´ã€‚å¦‚æœä½ çš„èµ„æºè¯·æ±‚éœ€è¦ DNS æŸ¥æ‰¾ï¼Œè¿™å°†å¸®åŠ©ä½ äº†è§£ DNS æŸ¥æ‰¾è€—æ—¶å¤šä¹…ã€‚</li><li><strong>connectStart</strong> å’Œ <strong>connectEnd</strong> - è¿æ¥åˆ°æœåŠ¡å™¨çš„å¼€å§‹å’Œç»“æŸæ—¶é—´ã€‚è¿™å¯¹äºäº†è§£å»ºç«‹è¿æ¥æ‰€éœ€çš„æ—¶é—´å¾ˆæœ‰ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨ä¼˜åŒ– SSL æ¡æ‰‹æˆ–å¯»æ‰¾ç½‘ç»œå»¶è¿Ÿé—®é¢˜æ—¶ã€‚</li><li><strong>requestStart</strong> å’Œ <strong>responseEnd</strong> - èµ„æºè¯·æ±‚å¼€å§‹çš„æ—¶é—´å’Œèµ„æºä¼ è¾“å®Œæˆçš„æ—¶é—´ã€‚è¿™äº›å¯ä»¥å¸®åŠ©ä½ ç†è§£æœåŠ¡ç«¯å¤„ç†è¯·æ±‚æ‰€éœ€çš„æ—¶é—´ä»¥åŠä¸‹è½½èµ„æºæ‰€éœ€çš„æ—¶é—´ã€‚</li></ol><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-1"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨æ„å»ºä¸€ä¸ª Web åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”æ³¨æ„åˆ°æŸäº›é¡µé¢åŠ è½½éå¸¸æ…¢ã€‚ä½¿ç”¨ <code>PerformanceResourceTiming</code> æ•°æ®ï¼Œä½ å¯ä»¥å¦‚ä¸‹è¿›è¡Œåˆ†æï¼š</p><ol><li><p><strong>è¯Šæ–­ç½‘ç»œå»¶è¿Ÿ</strong> - å¦‚æœä½ æ³¨æ„åˆ° <code>connectStart</code> åˆ° <code>connectEnd</code> çš„æ—¶é—´è¿‡é•¿ï¼Œå¯èƒ½è¯´æ˜å»ºç«‹ç½‘ç»œè¿æ¥å­˜åœ¨é—®é¢˜ã€‚è¿™å¯èƒ½æ˜¯ç”±äºç”¨æˆ·çš„ç½‘ç»œè¿æ¥è´¨é‡ä¸ä½³ï¼Œæˆ–è€…æ˜¯æœåŠ¡å™¨å“åº”æ—¶é—´è¿‡é•¿ã€‚</p></li><li><p><strong>DNS è§£æé—®é¢˜</strong> - é€šè¿‡è§‚å¯Ÿ <code>domainLookupStart</code> å’Œ <code>domainLookupEnd</code>ï¼Œå¦‚æœ DNS æŸ¥æ‰¾æ—¶é—´å¼‚å¸¸é•¿ï¼Œè¿™å¯èƒ½è¡¨æ˜ DNS æœåŠ¡å™¨å“åº”æ…¢ï¼Œæˆ–è€…å¯èƒ½éœ€è¦ä¼˜åŒ– DNS ç¼“å­˜ç­–ç•¥ã€‚</p></li><li><p><strong>ä¼˜åŒ–èµ„æºåŠ è½½</strong> - å¦‚æœ <code>requestStart</code> åˆ° <code>responseEnd</code> æ—¶é—´è¾ƒé•¿ï¼Œè¿™å¯èƒ½æ„å‘³ç€æœåŠ¡å™¨å¤„ç†è¯·æ±‚éœ€è¦å¤ªå¤šæ—¶é—´ï¼Œæˆ–è€…èµ„æºæ–‡ä»¶è¿‡å¤§ã€‚é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œä½ å¯ä»¥è€ƒè™‘ä¼˜åŒ–åç«¯é€»è¾‘ï¼Œæˆ–è€…å‡å°èµ„æºæ–‡ä»¶çš„å¤§å°ï¼Œä½¿ç”¨ CDN åŠ é€Ÿèµ„æºåŠ è½½ç­‰ã€‚</p></li></ol><h3 id="å¦‚ä½•ä½¿ç”¨-5" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-5"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>åœ¨ Node.js ä¸­è·å– <code>PerformanceResourceTiming</code> æ•°æ®çš„ä¸€ä¸ªç®€å•ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;perf_hooks&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿä¸€ä¸ªèµ„æºåŠ è½½æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // è·å–æ‰€æœ‰ &quot;measure&quot; ç±»å‹çš„æ€§èƒ½æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntriesByType</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Name: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entries</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, Duration: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entries</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ‡è®°èµ·ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;start-load&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æ­¤æ—¶è¿›è¡Œèµ„æºåŠ è½½...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æŸæ®µæ—¶é—´åï¼Œæ ‡è®°ç»ˆç‚¹å¹¶æµ‹é‡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;end-load&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;page-load&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;start-load&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;end-load&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šä»£ç æ¼”ç¤ºäº†å¦‚ä½•æ ‡è®°èµ„æºåŠ è½½çš„èµ·å§‹å’Œç»“æŸæ—¶é—´ï¼Œç„¶åä½¿ç”¨ <code>performance.measure</code> æ–¹æ³•æ¥è®¡ç®—æ€»ä½“æŒç»­æ—¶é—´ã€‚é€šè¿‡åˆ†æè¿™äº›æ•°æ®ï¼Œä½ å¯ä»¥æ›´å¥½åœ°äº†è§£åº”ç”¨ç¨‹åºçš„æ€§èƒ½çŠ¶å†µï¼Œå¹¶æ‰¾å‡ºå¯èƒ½çš„æ€§èƒ½ç“¶é¢ˆã€‚</p><p>æ€»ä¹‹ï¼Œ<code>PerformanceResourceTiming</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä½ æ·±å…¥äº†è§£åº”ç”¨ç¨‹åºçš„åŠ è½½å’Œæ‰§è¡Œæ€§èƒ½ã€‚é€šè¿‡åˆç†åˆ©ç”¨è¿™äº›æ•°æ®ï¼Œå¯ä»¥æ˜¾è‘—æé«˜åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚</p><h3 id="performanceresourcetiming-workerstart" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-workerstart"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceresourcetimingworkerstart" target="_blank" rel="noopener noreferrer">performanceResourceTiming.workerStart</a></span></a></h3><p>å½“æˆ‘ä»¬è°ˆè®º Node.js ä¸­çš„ <code>performanceResourceTiming.workerStart</code> å±æ€§æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šåœ¨è®¨è®ºçš„æ˜¯ Node.js æ€§èƒ½é’©å­ï¼ˆperformance hooksï¼‰API çš„ä¸€éƒ¨åˆ†ï¼Œè¿™äº› API ç”¨äºç›‘è§†å’Œæµ‹é‡ä»£ç çš„æ€§èƒ½ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ç®€è¦è§£é‡Šä¸€ä¸‹ <code>PerformanceResourceTiming</code> å¯¹è±¡ã€‚å®ƒæ˜¯ Web æ€§èƒ½ API çš„ä¸€éƒ¨åˆ†ï¼Œæä¾›äº†ç½‘ç»œè¯·æ±‚ï¼ˆä¾‹å¦‚ä»æœåŠ¡å™¨åŠ è½½èµ„æºï¼‰çš„æ—¶é—´ä¿¡æ¯ã€‚æ¯ä¸ªèµ„æºåŠ è½½éƒ½ä¼šæœ‰ä¸€ä¸ªç›¸å…³çš„ <code>PerformanceResourceTiming</code> å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†å¦‚ä½•è¿æ¥åˆ°æœåŠ¡å™¨ã€å‘é€è¯·æ±‚ã€ä¸‹è½½èµ„æºç­‰ç›¸å…³çš„æ—¶é—´èŠ‚ç‚¹ã€‚è™½ç„¶æœ€åˆè¿™æ˜¯ä¸ºæµè§ˆå™¨ç¯å¢ƒè®¾è®¡çš„ï¼ŒNode.js ä¹Ÿå¼•å…¥äº†ç±»ä¼¼çš„æ¦‚å¿µæ¥å¸®åŠ©å¼€å‘è€…ç†è§£å’Œä¼˜åŒ–åç«¯æ€§èƒ½ã€‚</p><p>åœ¨ Node.js ç¯å¢ƒä¸­ï¼Œ<code>workerStart</code> å±æ€§æ˜¯ <code>PerformanceResourceTiming</code> å¯¹è±¡çš„ä¸€éƒ¨åˆ†ã€‚å®ƒè®°å½•äº†ä¸€ä¸ª Worker ï¼ˆæ¯”å¦‚ä¸€ä¸ªå­è¿›ç¨‹æˆ–è€…å·¥ä½œçº¿ç¨‹ï¼‰å¼€å§‹æ‰§è¡Œçš„æ—¶é—´ç‚¹ã€‚è¿™åœ¨åˆ†æå’Œæ”¹è¿›ä½¿ç”¨ Workers æ¥å¤„ç†ä»»åŠ¡çš„å¹¶è¡Œç¨‹åºçš„æ€§èƒ½æ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-7" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-7"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œè¯¥åº”ç”¨éœ€è¦å¤„ç†å¤§é‡çš„æ•°æ®æ“ä½œï¼Œè¿™å¯èƒ½ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œå¹¶å¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œä½ å†³å®šä½¿ç”¨ Workers æ¥å¹¶è¡ŒåŒ–è¿™äº›æ“ä½œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œäº†è§£æ¯ä¸ª Worker å¯åŠ¨çš„æ—¶é—´å¯¹äºè¯†åˆ«æ€§èƒ½ç“¶é¢ˆå’Œä¼˜åŒ–æ•´ä½“å¤„ç†æ—¶é—´è‡³å…³é‡è¦ã€‚</p><p><strong>ç¤ºä¾‹ï¼š</strong></p><ol><li><p><strong>åˆ›å»ºå¹¶ç›‘æ§ Workerï¼š</strong></p><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªå¤æ‚çš„æ•°æ®å¤„ç†ä»»åŠ¡ï¼Œä½ å†³å®šå°†å…¶åˆ†é…ç»™ä¸€ä¸ª Workerã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Worker</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;worker_threads&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆå§‹åŒ–æ€§èƒ½è§‚å¯Ÿè€…æ¥ç›‘å¬&quot;measure&quot;ç±»å‹çš„æ€§èƒ½æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®°å½•Workerå¯åŠ¨å‰çš„æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;startWorker&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªWorker</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> worker</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Worker</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./worker.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">worker</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;online&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å½“Workerå¼€å§‹è¿è¡Œæ—¶ï¼Œè®°å½•æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;workerOnline&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹é‡ä»å¯åŠ¨Workeråˆ°Workerå¼€å§‹è¿è¡Œçš„æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Worker startup time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;startWorker&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;workerOnline&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>ä¼˜åŒ– Worker å¯åŠ¨è¿‡ç¨‹ï¼š</strong></p><p>é€šè¿‡è§‚å¯Ÿä¸åŒ Workers çš„å¯åŠ¨æ—¶é—´ï¼Œä½ å¯èƒ½ä¼šæ³¨æ„åˆ°æŸäº› Workers å¯åŠ¨å¼‚å¸¸ç¼“æ…¢ã€‚è¿™å¯èƒ½æ˜¯ç”±äºå¤šç§å› ç´ é€ æˆçš„ï¼Œå¦‚å¯åŠ¨æ—¶æ‰€éœ€åŠ è½½çš„èµ„æºé‡ã€ç³»ç»Ÿè´Ÿè½½æˆ–ä»£ç æ•ˆç‡é—®é¢˜ã€‚åŸºäº <code>workerStart</code> æ—¶é—´çš„åˆ†æï¼Œä½ å¯ä»¥å°è¯•å‡å°‘ Worker å¯åŠ¨æ—¶åŠ è½½çš„èµ„æºã€è°ƒæ•´ä»£ç é€»è¾‘æˆ–æ›´æ”¹ç³»ç»Ÿé…ç½®æ¥ä¼˜åŒ–æ€§èƒ½ã€‚</p></li></ol><p>æ€»ç»“æ¥è¯´ï¼Œ<code>performanceResourceTiming.workerStart</code> åœ¨ Node.js ä¸­æ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„å±æ€§ï¼Œå°¤å…¶æ˜¯åœ¨æ„å»ºéœ€è¦é«˜æ€§èƒ½å¹¶è¡Œå¤„ç†çš„åº”ç”¨æ—¶ã€‚é€šè¿‡ç›‘è§†å’Œåˆ†æ Workers çš„å¯åŠ¨æ—¶é—´ï¼Œå¼€å‘è€…å¯ä»¥è¯†åˆ«æ€§èƒ½ç“¶é¢ˆå¹¶é‡‡å–ç›¸åº”æªæ–½è¿›è¡Œä¼˜åŒ–ã€‚</p><h3 id="performanceresourcetiming-redirectstart" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-redirectstart"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceresourcetimingredirectstart" target="_blank" rel="noopener noreferrer">performanceResourceTiming.redirectStart</a></span></a></h3><p>Node.js ä¸­çš„ <code>performanceResourceTiming.redirectStart</code> å±äºæ€§èƒ½æµ‹é‡ï¼ˆPerformance Timingï¼‰API çš„ä¸€éƒ¨åˆ†ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºç²¾å‡†æµ‹é‡ç½‘é¡µæ€§èƒ½çš„å·¥å…·é›†ã€‚åœ¨ Node.js ç¯å¢ƒä¸­ï¼Œè™½ç„¶æˆ‘ä»¬ä¸å¤„ç†æµè§ˆå™¨ç«¯çš„æ¸²æŸ“ï¼Œä½†æˆ‘ä»¬ä¾æ—§å¯ä»¥åˆ©ç”¨ç±»ä¼¼çš„æœºåˆ¶æ¥ç›‘æ§å’Œæµ‹é‡ HTTP è¯·æ±‚ç­‰èµ„æºåŠ è½½çš„æ€§èƒ½ã€‚</p><h3 id="è§£é‡Š-1" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-1"><span>è§£é‡Š</span></a></h3><p><code>performanceResourceTiming.redirectStart</code> å±æ€§è¿”å›ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œä»£è¡¨ç¬¬ä¸€ä¸ª HTTP é‡å®šå‘å¼€å§‹çš„æ—¶é—´ã€‚å¦‚æœæ²¡æœ‰é‡å®šå‘å‘ç”Ÿï¼Œæˆ–è€…ä¿¡æ¯æ— æ³•ç”±äºå®‰å…¨åŸå› ï¼ˆå¦‚è·¨åŸŸé™åˆ¶ï¼‰è¢«è·å–ï¼Œåˆ™è¯¥å±æ€§ä¼šè¿”å› <code>0</code>ã€‚</p><p>é‡å®šå‘æŒ‡çš„æ˜¯å½“è®¿é—®ä¸€ä¸ªç½‘å€æ—¶ï¼ŒæœåŠ¡å™¨åŸºäºæŸç§é€»è¾‘ï¼ˆæ¯”å¦‚é¡µé¢å·²ç»ç§»åŠ¨äº†ï¼‰ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯å»è®¿é—®å¦ä¸€ä¸ªç½‘å€çš„è¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼Œå½“ä½ å°è¯•è®¿é—®ä¸€ä¸ªç½‘ç«™çš„éåŠ å¯†ç‰ˆæœ¬ï¼ˆ<a href="http://example.com" target="_blank" rel="noopener noreferrer">http://example.com</a>ï¼‰ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šè®©ä½ é‡å®šå‘åˆ°å…¶åŠ å¯†ç‰ˆæœ¬ï¼ˆ<a href="https://example.com" target="_blank" rel="noopener noreferrer">https://example.com</a>ï¼‰ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-8" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-8"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œè¯¥ç¨‹åºéœ€è¦è¯·æ±‚å¤–éƒ¨èµ„æºï¼Œæ¯”å¦‚ä»ç¬¬ä¸‰æ–¹ API è·å–æ•°æ®ã€‚æœ‰æ—¶å€™ï¼Œè¿™äº›å¤–éƒ¨æœåŠ¡å¯èƒ½ä¼šå› ä¸ºç»´æŠ¤æˆ–è€…å…¶ä»–åŸå› è€Œæ”¹å˜è¯·æ±‚çš„ URLï¼Œè¿™æ—¶å°±ä¼šå‘ç”Ÿé‡å®šå‘ã€‚</p><ol><li><p><strong>ç›‘æ§å¤–éƒ¨æœåŠ¡é‡å®šå‘æ—¶é—´</strong>ï¼šä½ å¯ä»¥ä½¿ç”¨ <code>performanceResourceTiming.redirectStart</code> å’Œç›¸å…³çš„æ€§èƒ½æŒ‡æ ‡æ¥ç›‘æµ‹è¯·æ±‚è¿‡ç¨‹ä¸­çš„é‡å®šå‘å»¶è¿Ÿã€‚è¿™å¯¹äºç¡®ä¿ä½ çš„åº”ç”¨å“åº”å¿«é€Ÿï¼Œç”¨æˆ·ä½“éªŒè‰¯å¥½å¾ˆé‡è¦ã€‚</p></li><li><p><strong>æ—¥å¿—ä¸æ€§èƒ½åˆ†æ</strong>ï¼šé€šè¿‡è®°å½•è¿™äº›æ—¶é—´æˆ³ï¼Œä½ å¯ä»¥åˆ†æç³»ç»Ÿåœ¨ä¸åŒæ—¶é—´æ®µå†…å¯¹å¤–éƒ¨æœåŠ¡è¯·æ±‚çš„æ€§èƒ½ã€‚å¦‚æœå‘ç°é‡å®šå‘æ—¶é—´çªå¢ï¼Œè¿™å¯èƒ½æ˜¯å¤–éƒ¨æœåŠ¡è°ƒæ•´äº†ä»–ä»¬çš„ URL ç»“æ„æˆ–è€…æœ‰å…¶ä»–é—®é¢˜ï¼Œè¿™æ—¶ä½ å¯ä»¥åŠæ—¶è°ƒæŸ¥å¹¶é‡‡å–æªæ–½ã€‚</p></li><li><p><strong>ä¼˜åŒ–åº”ç”¨çš„ HTTP è¯·æ±‚</strong>ï¼šè‹¥æ£€æµ‹åˆ°é¢‘ç¹çš„é‡å®šå‘ï¼Œä½ å¯èƒ½éœ€è¦æ›´æ–°åº”ç”¨ä¸­çš„ URLï¼Œç›´æ¥æŒ‡å‘æœ€ç»ˆåœ°å€ï¼Œä»¥å‡å°‘ä¸å¿…è¦çš„é‡å®šå‘ï¼Œä»è€Œå‡å°‘æ€»çš„å“åº”æ—¶é—´ã€‚</p></li></ol><h3 id="ä»£ç ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä»£ç ç¤ºä¾‹"><span>ä»£ç ç¤ºä¾‹</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œä½ å¯èƒ½ä¸ä¼šç›´æ¥ä½¿ç”¨ <code>performanceResourceTiming</code> æ¥è·å–é‡å®šå‘æ—¶é—´ï¼Œå› ä¸º Node.js ä¸»è¦ç”¨äºåç«¯å¼€å‘ï¼Œè€Œè¿™å¥— API æ›´å¤šæ˜¯ä¸ºå‰ç«¯è®¾è®¡ã€‚ä½†æ˜¯ï¼Œç†è§£å®ƒçš„æ¦‚å¿µå¯¹äºåˆ†æå’Œä¼˜åŒ– HTTP è¯·æ±‚å¾ˆæœ‰å¸®åŠ©ã€‚åœ¨ Node.js ç¯å¢ƒä¸‹ï¼Œä½ æ›´å¯èƒ½ä½¿ç”¨å¦‚<code>http</code>æ¨¡å—é…åˆäº‹ä»¶ç›‘å¬å’Œæ—¶é—´æˆ³è®°å½•æ¥ç›‘æµ‹æ€§èƒ½ï¼Œç±»ä¼¼ä¸‹é¢çš„é€»è¾‘ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç›®æ ‡åœ°å€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> requestOptions</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  port</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  path</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  method</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;GET&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‘èµ·è¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> requestStart</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> req</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">request</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">requestOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">d</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¤„ç†å“åº”æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> requestEnd</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è¯·æ±‚è€—æ—¶ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">requestEnd</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> requestStart</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è¯·æ±‚é‡åˆ°é—®é¢˜: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">e</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç»“æŸè¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è™½ç„¶è¿™ä¸ªä¾‹å­æ²¡æœ‰ç›´æ¥å±•ç¤ºé‡å®šå‘æ—¶é—´æµ‹é‡ï¼Œä½†å®ƒæ¼”ç¤ºäº†å¦‚ä½•ç”¨ Node.js è®°å½•å’Œåˆ†æè¯·æ±‚è€—æ—¶ï¼Œè¿™å¯¹äºä¼˜åŒ–åº”ç”¨æ€§èƒ½è‡³å…³é‡è¦ã€‚é’ˆå¯¹é‡å®šå‘çš„æµ‹é‡å’Œä¼˜åŒ–ï¼Œå®é™…æ“ä½œæ—¶æ›´å¤šçš„æ˜¯åŸºäºè¿™ç§æ–¹æ³•è¿›è¡Œæ‰©å±•å’Œæ·±å…¥åˆ†æã€‚</p><h3 id="performanceresourcetiming-redirectend" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-redirectend"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceresourcetimingredirectend" target="_blank" rel="noopener noreferrer">performanceResourceTiming.redirectEnd</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘æ¥è§£é‡Š Node.js ä¸­çš„ <code>performanceResourceTiming.redirectEnd</code> å±æ€§ï¼Œå¹¶å°½é‡ç”¨ç®€å•æ˜äº†çš„æ–¹å¼è¯´æ˜ã€‚</p><p>é¦–å…ˆï¼Œ<code>performanceResourceTiming</code> æ˜¯ Web æ€§èƒ½ API ä¸­çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå®ƒæä¾›äº†ç½‘é¡µèµ„æºåŠ è½½è¿‡ç¨‹ä¸­çš„å„ç§æ—¶é—´ç‚¹ä¿¡æ¯ã€‚è™½ç„¶è¿™æ˜¯ Web é¢†åŸŸçš„æ¦‚å¿µï¼Œä½†åœ¨ Node.js ä¸­ï¼Œç‰¹åˆ«æ˜¯åœ¨æ¨¡ä»¿æˆ–å¤„ç† HTTP è¯·æ±‚æ—¶ï¼Œè¿™ä¸€ç³»åˆ—æ€§èƒ½æŒ‡æ ‡ä¹Ÿè¢«å¼•å…¥å’Œä½¿ç”¨ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-redirectend" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-redirectend"><span>ä»€ä¹ˆæ˜¯ <code>redirectEnd</code>ï¼Ÿ</span></a></h3><p><code>redirectEnd</code> å±æ€§è®°å½•äº†æœ€åä¸€ä¸ª HTTP é‡å®šå‘å®Œæˆæ—¶çš„ UNIX æ—¶é—´æˆ³ã€‚å¦‚æœæ²¡æœ‰å‘ç”Ÿé‡å®šå‘ï¼Œæˆ–è€…ä¿¡æ¯ä¸å¯ç”¨ï¼Œåˆ™æ­¤å±æ€§çš„å€¼ä¼šæ˜¯ 0ã€‚ä»ç›´è§‚ä¸Šç†è§£ï¼Œä½ å¯ä»¥æŠŠå®ƒè§†ä¸ºï¼šâ€œå½“æµè§ˆå™¨å®Œæˆæ‰€æœ‰é‡å®šå‘å¹¶ä¸”å‡†å¤‡å¥½ä»æœ€ç»ˆ URL åŠ è½½èµ„æºæ—¶çš„é‚£ä¸ªç¬é—´â€ã€‚</p><h3 id="å®é™…åº”ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨åœºæ™¯"><span>å®é™…åº”ç”¨åœºæ™¯</span></a></h3><p>ä¸ºäº†æ›´å…·ä½“åœ°è¯´æ˜ï¼Œè®©æˆ‘ä»¬é€šè¿‡å‡ ä¸ªå®é™…çš„ä¾‹å­æ¥çœ‹çœ‹å¦‚ä½•åœ¨ Node.js ä¸­åº”ç”¨è¿™ä¸ªæ¦‚å¿µï¼š</p><h4 id="ç¤ºä¾‹-1-ç›‘æ§-api-è¯·æ±‚çš„æ€§èƒ½" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ç›‘æ§-api-è¯·æ±‚çš„æ€§èƒ½"><span>ç¤ºä¾‹ 1ï¼šç›‘æ§ API è¯·æ±‚çš„æ€§èƒ½</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œè¯¥åº”ç”¨éœ€è¦è°ƒç”¨å¤–éƒ¨ APIã€‚è¿™ä¸ª API æœ‰æ—¶ä¼šè¿›è¡Œå¤šæ¬¡é‡å®šå‘æ‰èƒ½è·å–æœ€ç»ˆæ•°æ®ã€‚é€šè¿‡ç›‘æ§<code>redirectEnd</code>ï¼Œä½ å¯ä»¥é‡åŒ–é‡å®šå‘å¯¹å“åº”æ—¶é—´çš„å½±å“ï¼Œä»è€Œå¸®åŠ©ä½ å†³å®šæ˜¯å¦éœ€è¦å¯»æ‰¾æ€§èƒ½æ›´ä¼˜çš„ API æˆ–ä¼˜åŒ–å½“å‰è¯·æ±‚é“¾è·¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> https</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">https</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https://api.example.com/data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> timings</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntriesByType</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;navigation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timings</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Redirect end: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">timings</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">redirectEnd</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // è¿™é‡Œæ ¹æ® redirectEnd çš„å€¼åšè¿›ä¸€æ­¥å¤„ç†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼šè¿™ä¸ªä¾‹å­æ˜¯ä¸ºäº†è¯´æ˜è€Œç®€åŒ–çš„ï¼Œåœ¨ Node.js ä¸­ç›´æ¥ä½¿ç”¨<code>getEntriesByType(&#39;navigation&#39;)</code>å¯èƒ½ä¸èƒ½ç›´æ¥å·¥ä½œï¼Œå› ä¸ºå®ƒæ›´é€‚åˆäºæµè§ˆå™¨ç¯å¢ƒã€‚ä½†æ˜¯ï¼Œæ€è·¯æ˜¯ç›¸é€šçš„â€”â€”ä½ å¯ä»¥é€šè¿‡ç±»ä¼¼æœºåˆ¶ç›‘æ§ HTTP è¯·æ±‚çš„æ€§èƒ½ã€‚</p><h4 id="ç¤ºä¾‹-2-æ€§èƒ½åŸºå‡†æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æ€§èƒ½åŸºå‡†æµ‹è¯•"><span>ç¤ºä¾‹ 2ï¼šæ€§èƒ½åŸºå‡†æµ‹è¯•</span></a></h4><p>å¦‚æœä½ åœ¨åˆ›å»ºä¸€ä¸ªæ¶‰åŠåˆ°ç½‘ç»œè¯·æ±‚çš„åº“æˆ–æ¡†æ¶ï¼Œäº†è§£ä¸åŒç¯èŠ‚ï¼ˆæ¯”å¦‚ DNS æŸ¥è¯¢ã€TCP æ¡æ‰‹ã€é‡å®šå‘ç­‰ï¼‰çš„è€—æ—¶è‡³å…³é‡è¦ã€‚<code>redirectEnd</code> å°±æ˜¯è¿™ä¸ªé“¾æ¡ä¸­çš„ä¸€ç¯ï¼Œå¯ä»¥å¸®åŠ©ä½ è¯†åˆ«å’Œä¼˜åŒ–é‡å®šå‘è¿‡ç¨‹çš„æ€§èƒ½ã€‚</p><p>é€šè¿‡æ¨¡æ‹Ÿæˆ–è®°å½•çœŸå®çš„è¯·æ±‚ï¼Œå¹¶åˆ†æ<code>redirectEnd</code>ä¸å…¶ä»–æ—¶é—´ç‚¹ï¼ˆå¦‚<code>fetchStart</code>, <code>responseEnd</code>ç­‰ï¼‰çš„å·®å¼‚ï¼Œä½ èƒ½å¤Ÿæ›´ç²¾ç¡®åœ°å®šä½å»¶è¿Ÿçš„æ¥æºï¼Œè¿›è€Œé‡‡å–æªæ–½ã€‚</p><h3 id="ç»“è®º-3" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-3"><span>ç»“è®º</span></a></h3><p>è™½ç„¶<code>redirectEnd</code>åªæ˜¯ä¼—å¤šæ€§èƒ½æŒ‡æ ‡ä¸­çš„ä¸€ä¸ªï¼Œä½†æ­£ç¡®åœ°ç†è§£å’Œä½¿ç”¨å®ƒï¼Œå¯ä»¥å¸®åŠ©ä½ æ·±å…¥åˆ†æå’Œä¼˜åŒ– Node.js åº”ç”¨ä¸­çš„ç½‘ç»œæ€§èƒ½ã€‚å¸Œæœ›è¿™äº›ä¾‹å­èƒ½å¤Ÿå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£<code>redirectEnd</code>çš„æ¦‚å¿µå’Œåº”ç”¨ä»·å€¼ã€‚</p><h3 id="performanceresourcetiming-fetchstart" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-fetchstart"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceresourcetimingfetchstart" target="_blank" rel="noopener noreferrer">performanceResourceTiming.fetchStart</a></span></a></h3><p>å½“æˆ‘ä»¬æµè§ˆç½‘é¡µæˆ–è€…æ˜¯åœ¨åº”ç”¨ç¨‹åºä¸­è¯·æ±‚ç½‘ç»œèµ„æºæ—¶ï¼ŒèƒŒåéƒ½æœ‰å¾ˆå¤šå¤æ‚çš„æ­¥éª¤ã€‚ä¸ºäº†ç†è§£è¿™äº›æ­¥éª¤å¹¶ä¼˜åŒ–å®ƒä»¬ï¼Œå¼€å‘äººå‘˜éœ€è¦ä¸€ç§æ–¹æ³•æ¥æµ‹é‡è¿™äº›æ­¥éª¤æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚è¿™å°±æ˜¯<code>performanceResourceTiming.fetchStart</code>å±æ€§åœ¨ Node.js ä¸­ä½œç”¨çš„åœ°æ–¹ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯performanceresourcetiming-fetchstart" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯performanceresourcetiming-fetchstart"><span>ä»€ä¹ˆæ˜¯<code>performanceResourceTiming.fetchStart</code>ï¼Ÿ</span></a></h3><p>ç®€å•æ¥è¯´ï¼Œ<code>performanceResourceTiming.fetchStart</code>æ˜¯ Node.js ä¸­ä¸€ä¸ªæ€§èƒ½åº¦é‡æŒ‡æ ‡ï¼Œå®ƒä»£è¡¨äº†ä»å¼€å§‹è¯·æ±‚æŸä¸ªç½‘ç»œèµ„æºï¼ˆä¾‹å¦‚ï¼šä¸€ä¸ªç½‘é¡µã€å›¾ç‰‡ã€æ ·å¼è¡¨ç­‰ï¼‰åˆ°å®é™…å¼€å§‹è·å–èµ„æºçš„æ—¶é—´ç‚¹ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒæ ‡å¿—äº†å‘èµ·ç½‘ç»œè¯·æ±‚çš„ç¡®åˆ‡æ—¶é—´ç‚¹ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-9" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-9"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>è®©æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªå…·ä½“çš„ä¾‹å­ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£è¿™ä¸ªæ¦‚å¿µï¼š</p><ol><li><p><strong>ç½‘ç«™åŠ è½½é€Ÿåº¦åˆ†æ</strong></p><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™ï¼Œå¹¶ä¸”æƒ³è¦åˆ†æå’Œä¼˜åŒ–å…¶åŠ è½½é€Ÿåº¦ã€‚ä½ å¯ä»¥ä½¿ç”¨<code>fetchStart</code>æ¥æµ‹é‡æ¯ä¸ªèµ„æºï¼ˆå¦‚ CSS æ–‡ä»¶ã€JavaScript è„šæœ¬ã€å›¾ç‰‡ç­‰ï¼‰çš„åŠ è½½å¼€å§‹æ—¶é—´ã€‚é€šè¿‡æ¯”è¾ƒä¸åŒèµ„æºçš„<code>fetchStart</code>å€¼ï¼Œä½ å¯ä»¥è¯†åˆ«å‡ºå“ªäº›èµ„æºçš„åŠ è½½é¡ºåºå¯èƒ½ä¼šå¯¼è‡´å»¶è¿Ÿï¼Œç„¶åç›¸åº”åœ°è°ƒæ•´å®ƒä»¬çš„åŠ è½½ç­–ç•¥ã€‚</p></li><li><p><strong>æ€§èƒ½ç›‘æ§å·¥å…·å¼€å‘</strong></p><p>å¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™æ€§èƒ½ç›‘æ§å·¥å…·ï¼Œ<code>fetchStart</code>å¯ä»¥ä½œä¸ºæ”¶é›†æ•°æ®çš„ä¸€éƒ¨åˆ†ã€‚é€šè¿‡æŒç»­è·Ÿè¸ªå’Œè®°å½•<code>fetchStart</code>å€¼ï¼Œä½ çš„å·¥å…·å¯ä»¥å¸®åŠ©ç”¨æˆ·å‘ç°æ€§èƒ½ç“¶é¢ˆã€åˆ†æè¶‹åŠ¿ã€ç”šè‡³é¢„æµ‹æœªæ¥çš„æ€§èƒ½é—®é¢˜ã€‚</p></li><li><p><strong>API è¯·æ±‚åˆ†æ</strong></p><p>åœ¨æ„å»ºåŸºäº Node.js çš„åç«¯æœåŠ¡æ—¶ï¼Œä½ å¯èƒ½éœ€è¦è°ƒç”¨å¤–éƒ¨ API æ¥è·å–æ•°æ®ã€‚ä½¿ç”¨<code>fetchStart</code>ï¼Œä½ å¯ä»¥ç²¾ç¡®åœ°æµ‹é‡æ¯ä¸ª API è¯·æ±‚çš„å¼€å§‹æ—¶é—´ã€‚è¿™å¯¹äºåˆ†æå“åº”æ—¶é—´ã€è¯†åˆ«æ½œåœ¨çš„ç½‘ç»œå»¶è¿Ÿé—®é¢˜ã€æˆ–è€…æ¯”è¾ƒä¸åŒ API æä¾›å•†ä¹‹é—´çš„æ€§èƒ½æ¥è¯´ï¼Œéƒ½æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚</p></li></ol><h3 id="å¦‚ä½•ä½¿ç”¨performanceresourcetiming-fetchstart" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨performanceresourcetiming-fetchstart"><span>å¦‚ä½•ä½¿ç”¨<code>performanceResourceTiming.fetchStart</code>ï¼Ÿ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œè¦ä½¿ç”¨<code>performanceResourceTiming.fetchStart</code>ï¼Œé€šå¸¸éœ€è¦ä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li>å¼•å…¥<code>perf_hooks</code>æ¨¡å—ã€‚</li><li>ä½¿ç”¨<code>perf_hooks</code>æ¨¡å—æä¾›çš„å·¥å…·æ¥åˆ›å»ºæˆ–è·å–<code>PerformanceEntry</code>å¯¹è±¡ã€‚</li><li>ä»<code>PerformanceEntry</code>å¯¹è±¡ä¸­è¯»å–<code>fetchStart</code>å±æ€§ã€‚</li></ol><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä»£ç ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚çš„å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> simulateFetchRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿™é‡Œæ˜¯æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚çš„ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®°å½•è¯·æ±‚å¼€å§‹å‰çš„æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">simulateFetchRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æ­¤æ—¶ç½‘ç»œè¯·æ±‚å·²ç»å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fetchStart</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  `Fetch start time: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fetchStart</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> milliseconds after initial timing`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼Œä¸Šè¿°ä»£ç æ˜¯ä¸€ä¸ªç®€åŒ–ç¤ºä¾‹ï¼Œä¸»è¦ç›®çš„æ˜¯ä¸ºäº†å±•ç¤º<code>fetchStart</code>çš„æ¦‚å¿µã€‚åœ¨å®è·µä¸­ï¼Œ<code>fetchStart</code>çš„å€¼é€šå¸¸æ˜¯é€šè¿‡æµè§ˆå™¨æˆ– Node.js ç¯å¢ƒè‡ªåŠ¨è®°å½•å’Œæä¾›çš„ï¼Œç‰¹åˆ«æ˜¯å½“å¤„ç† HTTP è¯·æ±‚æˆ–ç±»ä¼¼çš„ç½‘ç»œæ´»åŠ¨æ—¶ã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œ<code>performanceResourceTiming.fetchStart</code>æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ€§èƒ½åº¦é‡æŒ‡æ ‡ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…ç†è§£å’Œä¼˜åŒ–ç½‘ç»œè¯·æ±‚ç›¸å…³çš„æ€§èƒ½é—®é¢˜ã€‚é€šè¿‡å®é™…æ¡ˆä¾‹å’Œä»£ç ç¤ºä¾‹çš„è§£é‡Šï¼Œæˆ‘å¸Œæœ›ä½ ç°åœ¨å¯¹å®ƒæœ‰äº†æ›´æ¸…æ™°çš„ç†è§£ã€‚</p><h3 id="performanceresourcetiming-domainlookupstart" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-domainlookupstart"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceresourcetimingdomainlookupstart" target="_blank" rel="noopener noreferrer">performanceResourceTiming.domainLookupStart</a></span></a></h3><p>è®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥è§£æè¿™ä¸ªæ¦‚å¿µï¼šâ€œ<code>performanceResourceTiming.domainLookupStart</code>â€ åœ¨ Node.jsï¼ˆç‰¹åˆ«æ˜¯åœ¨ç‰ˆæœ¬ 21.7.1 ä¸­æåˆ°çš„å†…å®¹ï¼‰ä¸­çš„ä½œç”¨å’Œåº”ç”¨åœºæ™¯ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-performanceresourcetiming" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-performanceresourcetiming"><span>ä»€ä¹ˆæ˜¯ <code>performanceResourceTiming</code></span></a></h3><p>é¦–å…ˆï¼Œ<code>PerformanceResourceTiming</code> æ˜¯ Web æ€§èƒ½ API çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæä¾›äº†ç½‘ç»œè¯·æ±‚çš„è¯¦ç»†å®šæ—¶ä¿¡æ¯ã€‚å°½ç®¡æœ€åˆæ˜¯ä¸ºæµè§ˆå™¨ç¯å¢ƒè®¾è®¡çš„ï¼Œä½†åœ¨ Node.js ä¸­ä¹Ÿå¼•å…¥äº†ç›¸ä¼¼çš„æ€§èƒ½ç›‘æµ‹å·¥å…·ï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥æµ‹é‡å’Œåˆ†ææœåŠ¡å™¨ç«¯æ“ä½œçš„æ€§èƒ½ã€‚</p><h3 id="å…³äº-domainlookupstart" tabindex="-1"><a class="header-anchor" href="#å…³äº-domainlookupstart"><span>å…³äº <code>domainLookupStart</code></span></a></h3><p><code>domainLookupStart</code> å±æ€§ä»£è¡¨äº†è¿›è¡ŒåŸŸåæŸ¥æ‰¾ï¼ˆDNS è§£æï¼‰çš„å¼€å§‹æ—¶é—´ç‚¹ã€‚ç®€å•æ¥è¯´ï¼Œå½“ä½ çš„åº”ç”¨å°è¯•è¿æ¥åˆ°ä¸€ä¸ªæœåŠ¡å™¨æ—¶ï¼ˆæ¯”å¦‚é€šè¿‡ HTTP è¯·æ±‚ï¼‰ï¼Œå®ƒé¦–å…ˆéœ€è¦å°†æœåŠ¡å™¨çš„åŸŸåï¼ˆä¾‹å¦‚ <code>www.example.com</code>ï¼‰è½¬æ¢ä¸º IP åœ°å€ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«åš DNS è§£æã€‚<code>domainLookupStart</code> å°±æ˜¯è¿™ä¸ªè§£æå¼€å§‹çš„ç²¾ç¡®æ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚</p><h3 id="å®é™…è¿ç”¨-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨-3"><span>å®é™…è¿ç”¨</span></a></h3><p>æƒ³è±¡ä½ åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œè¿™ä¸ªåº”ç”¨éœ€è¦ä»å¤šä¸ªä¸åŒçš„æœåŠ¡è·å–æ•°æ®ã€‚æ¯æ¬¡å‘æœåŠ¡å‘é€è¯·æ±‚æ—¶ï¼Œéƒ½æ¶‰åŠåˆ° DNS è§£æçš„æ­¥éª¤ã€‚å¦‚æœä½ çš„åº”ç”¨å“åº”å¾ˆæ…¢ï¼Œè€Œä½ æƒ³è¯Šæ–­é—®é¢˜æ‰€åœ¨ï¼Œè¿™æ—¶ <code>performanceResourceTiming.domainLookupStart</code> å¯ä»¥å¸®åŠ©ä½ ç¡®å®š DNS è§£ææ˜¯å¦æ˜¯ç“¶é¢ˆã€‚</p><h4 id="ç¤ºä¾‹-3" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3"><span>ç¤ºä¾‹ï¼š</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªå‡½æ•° <code>fetchData</code>ï¼Œå®ƒç”¨äºä»å¤–éƒ¨ API è·å–æ•°æ®ã€‚ä½ æƒ³è¦æµ‹é‡ DNS è§£æçš„æ—¶é—´ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€åŒ–çš„ç¤ºä¾‹ä»£ç ç‰‡æ®µï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> https</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®°å½•å½“å‰æ—¶é—´</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  https</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> domainLookupEnd</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">socket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timingStart</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™é‡Œæˆ‘ä»¬ç›´æ¥è·å– timingStart ä½œä¸º DNS æŸ¥è¯¢ç»“æŸçš„è¿‘ä¼¼å€¼ï¼Œå®é™…ä½¿ç”¨ä¸­å¯èƒ½æœ‰æ›´å‡†ç¡®çš„å±æ€§</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`DNS Lookup Time: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">domainLookupEnd</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ms`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¤„ç†å“åº”æ•°æ®...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https://www.example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨ <code>performance.now()</code> æ¥è·å–æ“ä½œå¼€å§‹çš„æ—¶é—´ï¼Œå¹¶ä¸”åœ¨æ”¶åˆ°å“åº”æ—¶è¾“å‡º DNS æŸ¥æ‰¾è€—æ—¶ã€‚è¿™åªæ˜¯ä¸€ä¸ªéå¸¸åŸºæœ¬çš„ä¾‹å­ï¼Œå®é™…ä¸Š <code>performanceResourceTiming</code> æä¾›çš„æ•°æ®è¦æ›´ç»†è‡´ã€å…¨é¢ï¼Œå¯ä»¥è®©ä½ æ·±å…¥äº†è§£å„ä¸ªé˜¶æ®µçš„è€—æ—¶æƒ…å†µã€‚</p><h3 id="æ€»ç»“-6" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-6"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡ä½¿ç”¨ <code>performanceResourceTiming.domainLookupStart</code>ï¼ˆä»¥åŠç›¸å…³çš„æ€§èƒ½æµ‹é‡ APIï¼‰ï¼ŒNode.js å¼€å‘è€…å¯ä»¥ç²¾ç¡®åœ°æµ‹é‡å‡º DNS è§£æç­‰ç½‘ç»œè¯·æ±‚è¿‡ç¨‹ä¸­å„ä¸ªé˜¶æ®µçš„æ—¶é—´ï¼Œè¿™å¯¹äºä¼˜åŒ–åº”ç”¨æ€§èƒ½ã€æå‡ç”¨æˆ·ä½“éªŒæ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚äº†è§£è¿™äº›æŒ‡æ ‡ï¼Œèƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…è¯Šæ–­å»¶è¿Ÿé—®é¢˜ï¼Œè¿›è€Œé‡‡å–æªæ–½ï¼ˆå¦‚ä½¿ç”¨ DNS é¢„è§£ææŠ€æœ¯ï¼‰æ¥ç¼©çŸ­åŠ è½½æ—¶é—´ã€‚</p><h3 id="performanceresourcetiming-domainlookupend" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-domainlookupend"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceresourcetimingdomainlookupend" target="_blank" rel="noopener noreferrer">performanceResourceTiming.domainLookupEnd</a></span></a></h3><p>åœ¨è¯¦ç»†è§£é‡Š<code>performanceResourceTiming.domainLookupEnd</code>ä¹‹å‰ï¼Œè®©æˆ‘ä»¬é¦–å…ˆç†è§£ä¸€äº›åŸºæœ¬æ¦‚å¿µã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-node-js" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-node-js"><span>ä»€ä¹ˆæ˜¯ Node.js?</span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªå¼€æºã€è·¨å¹³å°çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚Node.js ç‰¹åˆ«é€‚åˆæ„å»ºé«˜æ€§èƒ½çš„ç½‘ç»œåº”ç”¨ç¨‹åºã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-performanceresourcetiming-1" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-performanceresourcetiming-1"><span>ä»€ä¹ˆæ˜¯ PerformanceResourceTiming?</span></a></h3><p>åœ¨ Node.js ç¯å¢ƒä¸­ï¼Œ<code>PerformanceResourceTiming</code> æ˜¯ä¸€ä¸ªæä¾›äº†ç½‘ç»œè¯·æ±‚ç›¸å…³æ€§èƒ½ä¿¡æ¯çš„å¯¹è±¡ã€‚å®ƒä¸»è¦ç”¨äºæ”¶é›†å’Œåˆ†æç½‘ç»œè¯·æ±‚å¦‚ä½•å½±å“åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚</p><h4 id="performanceresourcetiming-domainlookupend-1" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-domainlookupend-1"><span>performanceResourceTiming.domainLookupEnd</span></a></h4><p><code>domainLookupEnd</code> å±æ€§è¡¨ç¤ºå®Œæˆå¯¹è¯·æ±‚èµ„æºåŸŸåï¼ˆDNSï¼‰æŸ¥è¯¢çš„æ—¶é—´ç‚¹ã€‚è¿™ä¸ªæ—¶é—´ç‚¹æ˜¯ä»¥é«˜ç²¾åº¦æ—¶é—´æˆ³çš„å½¢å¼ç»™å‡ºçš„ï¼Œå…¶å‚è€ƒç‚¹ä¸º <code>PerformanceTiming.navigationStart</code>ã€‚</p><p>ç®€å•æ¥è¯´ï¼Œå½“ä½ çš„ Node.js åº”ç”¨ç¨‹åºå‘èµ·ä¸€ä¸ªç½‘ç»œè¯·æ±‚æ—¶ï¼ˆæ¯”å¦‚é€šè¿‡ HTTP æˆ– HTTPSï¼‰ï¼Œå®ƒé¦–å…ˆéœ€è¦æ‰¾åˆ°è¯¥è¯·æ±‚å¯¹åº”çš„æœåŠ¡å™¨çš„ IP åœ°å€ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«åš DNS æŸ¥è¯¢ã€‚<code>domainLookupEnd</code> å°±æ˜¯è®°å½•è¿™ä¸ª DNS æŸ¥è¯¢ç»“æŸçš„æ—¶é—´ã€‚</p><h4 id="å®é™…è¿ç”¨ä¸¾ä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¸¾ä¾‹"><span>å®é™…è¿ç”¨ä¸¾ä¾‹</span></a></h4><ol><li><p><strong>æ€§èƒ½ç›‘æ§</strong> - è®¾æƒ³ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œå®ƒä¾èµ–äºå¤šä¸ªå¤–éƒ¨æœåŠ¡ï¼Œå¦‚æ•°æ®åº“æœåŠ¡ã€API ç­‰ã€‚ä½¿ç”¨<code>performanceResourceTiming</code>å¯¹è±¡ä¸­çš„<code>domainLookupEnd</code>å±æ€§ï¼Œä½ å¯ä»¥ç›‘æ§æ¯ä¸ªæœåŠ¡çš„ DNS æŸ¥è¯¢æ—¶é—´ã€‚å¦‚æœæŸä¸ªæœåŠ¡çš„ DNS æŸ¥è¯¢æ—¶é—´çªç„¶å¢é•¿ï¼Œè¿™å¯èƒ½æ˜¯ç½‘ç»œç“¶é¢ˆæˆ–é…ç½®é—®é¢˜çš„ä¿¡å·ï¼Œä»è€Œå¯ä»¥åŠæ—¶é‡‡å–æªæ–½ã€‚</p></li><li><p><strong>ä¼˜åŒ–ç½‘ç«™åŠ è½½æ—¶é—´</strong> - å‡è®¾ä½ è´Ÿè´£ä¸€ä¸ªå¤§å‹ç”µå•†å¹³å°çš„åç«¯å¼€å‘ï¼Œè¯¥å¹³å°ä¸å¤šä¸ªä¾›åº”å•†ç³»ç»Ÿè¿›è¡Œäº’åŠ¨ã€‚é€šè¿‡æµ‹é‡ä¸åŒä¾›åº”å•†ç³»ç»Ÿçš„<code>domainLookupEnd</code>æ—¶é—´ï¼Œä½ å¯ä»¥è¯†åˆ«å¹¶ä¼˜åŒ–é‚£äº›å…·æœ‰è¾ƒé•¿ DNS æŸ¥è¯¢æ—¶é—´çš„è¿æ¥ï¼Œä¾‹å¦‚é€šè¿‡æ›´æ¢ DNS æä¾›å•†æˆ–ä½¿ç”¨ DNS é¢„è§£ææŠ€æœ¯æ¥é™ä½è¿™äº›æ—¶é—´ï¼Œæœ€ç»ˆæå‡ç”¨æˆ·ä½“éªŒã€‚</p></li><li><p><strong>æ•…éšœæ’æŸ¥</strong> - åœ¨ç»´æŠ¤æœŸé—´ï¼Œå¦‚æœå®¢æˆ·æŠ¥å‘Šä»–ä»¬é‡åˆ°äº†è®¿é—®å»¶è¿Ÿï¼Œé€šè¿‡æ£€æŸ¥<code>domainLookupEnd</code>æ—¶é—´ï¼Œå¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿç¡®å®šæ˜¯å¦ DNS æŸ¥è¯¢å»¶è¿Ÿæ˜¯é€ æˆé—®é¢˜çš„åŸå› ä¹‹ä¸€ï¼Œä»è€Œç¼©å°æ•…éšœæ’æŸ¥çš„èŒƒå›´ã€‚</p></li></ol><p>æ€»ä¹‹ï¼Œ<code>performanceResourceTiming.domainLookupEnd</code>æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„å·¥å…·ï¼Œå®ƒå¯ä»¥å¸®åŠ©å¼€å‘è€…å’Œç³»ç»Ÿç®¡ç†å‘˜ç›‘æ§ã€ä¼˜åŒ–ä»¥åŠæ’æŸ¥ç½‘ç»œè¯·æ±‚ç›¸å…³çš„æ€§èƒ½é—®é¢˜ã€‚</p><h3 id="performanceresourcetiming-connectstart" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-connectstart"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceresourcetimingconnectstart" target="_blank" rel="noopener noreferrer">performanceResourceTiming.connectStart</a></span></a></h3><p>Node.js ä¸­çš„ <code>performanceResourceTiming.connectStart</code> å±äºæ€§èƒ½ç›‘æ§ï¼ˆPerformance Timingï¼‰API çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒç”¨äºæä¾›ç½‘ç»œè¯·æ±‚ç­‰æ“ä½œçš„æ€§èƒ½æ—¶é—´ç‚¹ä¿¡æ¯ã€‚è¿™ä¸ªå±æ€§è¡¨ç¤ºåœ¨è¿›è¡Œ HTTPï¼ˆæˆ– HTTPS ç­‰ï¼‰è¯·æ±‚æ—¶ï¼Œæµè§ˆå™¨å¼€å§‹å»ºç«‹ç½‘ç»œè¿æ¥çš„æ—¶é—´ç‚¹ã€‚è™½ç„¶è¿™ä¸ªæ¦‚å¿µæºè‡ªæµè§ˆå™¨ç¯å¢ƒï¼Œä½†åœ¨ Node.js ä¸­ï¼Œå®ƒåŒæ ·é€‚ç”¨äºè®°å½•å’Œåˆ†æåç«¯æœåŠ¡çš„æ€§èƒ½è¡¨ç°ã€‚</p><p>ä¸ºäº†é€šä¿—æ˜“æ‡‚åœ°è§£é‡Šè¿™ä¸ªæ¦‚å¿µï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›ç”Ÿæ´»ä¸­çš„ç±»æ¯”æ¥ç†è§£å®ƒï¼š</p><p>æƒ³è±¡ä½ æ‰“ç”µè¯ç»™æœ‹å‹ï¼Œä»ä½ æ‹¿èµ·ç”µè¯ã€æ‹¨å·åˆ°æœ‹å‹çš„ç”µè¯å“èµ·ï¼Œè¿™ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ°å»ºç«‹ä¸€ä¸ªè¿æ¥ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œâ€œæ‹¨å·â€ç›¸å½“äº<code>connectStart</code>ï¼Œå³å¼€å§‹å»ºç«‹è¿æ¥çš„åŠ¨ä½œã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œå½“ä½ çš„åº”ç”¨å°è¯•ä¸å¦ä¸€ä¸ªæœåŠ¡å™¨ï¼ˆä¾‹å¦‚ï¼Œè¯·æ±‚æ•°æ®ã€å‘é€ API è¯·æ±‚ç­‰ï¼‰å»ºç«‹è¿æ¥æ—¶ï¼Œ<code>connectStart</code>å°±æ˜¯è¿™ä¸ªè¿‡ç¨‹å¼€å§‹çš„æ—¶é—´ç‚¹ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-2"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œè¯¥åº”ç”¨éœ€è¦ä»ä¸€ä¸ªè¿œç¨‹ API è·å–å¤©æ°”ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯è¿™ä¸ªè¿‡ç¨‹çš„ç®€åŒ–ä»£ç ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> https</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ€§èƒ½è§‚å¯Ÿè€…ï¼Œç›‘å¬&#39;http&#39;ç±»å‹çš„æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entry</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> of</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`connectStart: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">connectStart</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‘èµ·è¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">https</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;https://api.weatherapi.com/v1/current.json?key=YOUR_API_KEY&amp;query=London&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // å“åº”å¤„ç†é€»è¾‘...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">d</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stdout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">d</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ol><li>æˆ‘ä»¬ä½¿ç”¨<code>https</code>æ¨¡å—å‘ä¸€ä¸ªå¤©æ°” API å‘é€ GET è¯·æ±‚ã€‚</li><li>ä½¿ç”¨<code>perf_hooks</code>æ¨¡å—æ¥ç›‘æ§æ€§èƒ½æŒ‡æ ‡ï¼ŒåŒ…æ‹¬æˆ‘ä»¬æ„Ÿå…´è¶£çš„<code>connectStart</code>ã€‚</li><li>å½“è¯·æ±‚å¼€å§‹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—å¹¶æ‰“å°å‡º<code>connectStart</code>çš„å€¼ï¼Œè¿™ä¸ªå€¼å‘Šè¯‰æˆ‘ä»¬ Node.js å¼€å§‹å°è¯•ä¸è¿œç¨‹æœåŠ¡å™¨å»ºç«‹è¿æ¥çš„ç¡®åˆ‡æ—¶é—´ã€‚</li></ol><p>é€šè¿‡ç›‘æ§<code>connectStart</code>ï¼Œå¼€å‘è€…å¯ä»¥åˆ†æç½‘ç»œè¯·æ±‚çš„æ€§èƒ½ï¼Œæ¯”å¦‚ç¡®å®šå»ºç«‹è¿æ¥æ‰€èŠ±è´¹çš„æ—¶é—´æ˜¯å¦è¿‡é•¿ï¼Œä»è€Œä¼˜åŒ–åº”ç”¨çš„å“åº”æ—¶é—´å’Œæ€§èƒ½ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå‘ç°<code>connectStart</code>åˆ°<code>connectEnd</code>ä¹‹é—´çš„æ—¶é—´è¿‡é•¿ï¼ˆå³è¿æ¥å»ºç«‹æ—¶é—´è¿‡é•¿ï¼‰ï¼Œå¯èƒ½éœ€è¦æ£€æŸ¥ DNS è§£æã€ç½‘ç»œå»¶è¿Ÿæˆ–æœåŠ¡å™¨é…ç½®ç­‰é—®é¢˜ã€‚</p><h3 id="performanceresourcetiming-connectend" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-connectend"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceresourcetimingconnectend" target="_blank" rel="noopener noreferrer">performanceResourceTiming.connectEnd</a></span></a></h3><p>Node.js ä¸­çš„<code>performanceResourceTiming.connectEnd</code>å±æ€§æ˜¯ä¸æ€§èƒ½ç›‘æµ‹ç›¸å…³çš„ä¸€ä¸ªç‰¹æ€§ã€‚ä¸ºäº†ç†è§£è¿™ä¸ªæ¦‚å¿µï¼Œè®©æˆ‘ä»¬å…ˆç®€å•äº†è§£ä¸€ä¸‹å‡ ä¸ªç›¸å…³çš„èƒŒæ™¯çŸ¥è¯†ã€‚</p><h3 id="åŸºç¡€çŸ¥è¯†" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€çŸ¥è¯†"><span>åŸºç¡€çŸ¥è¯†</span></a></h3><ol><li><strong>Node.js</strong>: ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œè®©å¼€å‘è€…å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚</li><li><strong>æ€§èƒ½ç›‘æµ‹ï¼ˆPerformance Monitoringï¼‰</strong>: åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œæ€§èƒ½ç›‘æµ‹æŒ‡çš„æ˜¯è·Ÿè¸ªä¸åŒæ“ä½œçš„æ‰§è¡Œæ—¶é—´å’Œèµ„æºæ¶ˆè€—çš„è¿‡ç¨‹ï¼Œç›®çš„æ˜¯æ‰¾å‡ºå¹¶ä¼˜åŒ–å¯èƒ½çš„æ€§èƒ½ç“¶é¢ˆã€‚</li><li><strong>PerformanceResourceTiming</strong>: è¿™æ˜¯ Web æ€§èƒ½ API çš„ä¸€éƒ¨åˆ†ï¼Œæä¾›äº†ç½‘ç»œè¯·æ±‚çš„è¯¦ç»†å®šæ—¶ä¿¡æ¯ï¼Œå¦‚è¯·æ±‚å¼€å§‹æ—¶é—´ã€ç»“æŸæ—¶é—´ç­‰ã€‚</li></ol><h3 id="performanceresourcetiming-connectend-è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-connectend-è§£é‡Š"><span><code>performanceResourceTiming.connectEnd</code> è§£é‡Š</span></a></h3><p><code>connectEnd</code>å±æ€§å±äº<code>PerformanceResourceTiming</code>æ¥å£ï¼Œåœ¨ Node.js ä¸­é€šè¿‡<code>perf_hooks</code>æ¨¡å—å¯è®¿é—®ã€‚æ­¤å±æ€§è®°å½•äº†ä» HTTP(S)è¯·æ±‚å¼€å§‹åˆ°è¿æ¥è¿‡ç¨‹ï¼ˆä¾‹å¦‚ï¼Œä¸æœåŠ¡å™¨å»ºç«‹ TCP è¿æ¥ï¼‰å®Œå…¨ç»“æŸçš„æ—¶é—´ç‚¹ã€‚è¿™åŒ…æ‹¬ TLS æ¡æ‰‹ï¼ˆå¦‚æœé€‚ç”¨ï¼‰çš„æ—¶é—´ã€‚å®ƒçš„å€¼æ˜¯ä¸€ä¸ªä»£è¡¨æ—¶é—´çš„æ•°å­—ï¼Œå•ä½æ˜¯æ¯«ç§’ã€‚</p><p>æ¢å¥è¯è¯´ï¼Œ<code>connectEnd</code>å‘Šè¯‰ä½ ç›´åˆ°æµè§ˆå™¨å®Œæˆä¸æœåŠ¡å™¨çš„è¿æ¥æ‰€èŠ±è´¹çš„æ€»æ—¶é—´ï¼ŒåŒ…æ‹¬åˆ›å»º TCP è¿æ¥ä»¥åŠè¿›è¡Œ TLS åå•†ï¼ˆå¦‚æœä½¿ç”¨ HTTPSï¼‰ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-5" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-5"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>æƒ³è±¡ä½ æ­£åœ¨æ„å»ºä¸€ä¸ª Node.js åº”ç”¨ï¼Œè¯¥åº”ç”¨éœ€è¦ä»å¦ä¸€ä¸ªæœåŠ¡è·å–æ•°æ®ï¼Œå¯èƒ½æ˜¯é€šè¿‡ REST APIã€‚ä½ æ³¨æ„åˆ°ï¼Œæœ‰æ—¶è·å–æ•°æ®ä¼¼ä¹å¾ˆæ…¢ï¼Œè€Œä½ æƒ³ç›‘æ§è¿™äº›è¯·æ±‚ï¼Œçœ‹çœ‹æ˜¯å¦è¿æ¥å»ºç«‹é˜¶æ®µå°±å·²ç»å¾ˆæ…¢äº†ã€‚</p><p>è¿™é‡Œå°±å¯ä»¥ä½¿ç”¨<code>performanceResourceTiming.connectEnd</code>å±æ€§æ¥å¸®åŠ©ä½ :</p><ol><li><p><strong>ç›‘æ§ API è¯·æ±‚çš„è¿æ¥æ—¶é—´</strong>: ä½¿ç”¨<code>perf_hooks</code>æ¨¡å—æ¥è·å–è¯·æ±‚çš„æ€§èƒ½æ¡ç›®ï¼Œç„¶åæ£€æŸ¥<code>connectEnd</code>å±æ€§æ¥è¯„ä¼°è¿æ¥æœåŠ¡å™¨éœ€è¦å¤šé•¿æ—¶é—´ã€‚</p></li><li><p><strong>æ€§èƒ½ä¼˜åŒ–</strong>: å¦‚æœä½ å‘ç°è¿æ¥æ—¶é—´å¼‚å¸¸é•¿ï¼Œå¯èƒ½ä¼šè€ƒè™‘å‡ ä¸ªæ–¹å‘è¿›è¡Œä¼˜åŒ–ï¼Œæ¯”å¦‚æ”¹å˜æœåŠ¡å™¨çš„åœ°ç†ä½ç½®ï¼Œä½¿ç”¨æ›´å¿«çš„ DNS æä¾›å•†ï¼Œæˆ–è€…ä¼˜åŒ–æœåŠ¡å™¨é…ç½®ä»¥æ›´å¿«åœ°å“åº”è¿æ¥è¯·æ±‚ã€‚</p></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç›‘å¬æ€§èƒ½æ¡ç›®äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è¿æ¥ç»“æŸæ—¶é—´: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">connectEnd</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;resource&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿå‘èµ·HTTP(S)è¯·æ±‚çš„åŠ¨ä½œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;exampleRequestStart&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™å°†æ˜¯ä¸€ä¸ªå‘èµ·ç½‘ç»œè¯·æ±‚çš„å‡½æ•°è°ƒç”¨</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;exampleRequestEnd&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;exampleRequestStart&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;exampleRequestEnd&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¯·æ±‚è€—æ—¶1ç§’</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Performance API æ¥ç›‘è§†å’Œè®°å½•è¿æ¥ç»“æŸæ—¶é—´ã€‚è¯·æ³¨æ„ï¼Œå®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½éœ€è¦ç»“åˆä½¿ç”¨å…¶ä»–å·¥å…·æˆ–åº“æ¥å‘èµ·çœŸæ­£çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ•è·æ›´å¤šç›¸å…³æ€§èƒ½æ•°æ®ã€‚</p><h3 id="ç»“è®º-4" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-4"><span>ç»“è®º</span></a></h3><p><code>connectEnd</code>æ˜¯æ€§èƒ½ç›‘æµ‹ä¸­ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æŒ‡æ ‡ï¼Œå°¤å…¶æ˜¯å½“ä½ éœ€è¦åˆ†æå’Œä¼˜åŒ–åº”ç”¨è¿æ¥åˆ°æœåŠ¡å™¨æ‰€éœ€æ—¶é—´çš„åœºæ™¯ã€‚é€šè¿‡ç›‘æ§è¿™ä¸€æŒ‡æ ‡ï¼Œå¼€å‘è€…å¯ä»¥è¯†åˆ«å’Œè§£å†³ç½‘ç»œå»¶è¿Ÿé—®é¢˜ï¼Œè¿›è€Œæå‡åº”ç”¨çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚</p><h3 id="performanceresourcetiming-secureconnectionstart" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-secureconnectionstart"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceresourcetimingsecureconnectionstart" target="_blank" rel="noopener noreferrer">performanceResourceTiming.secureConnectionStart</a></span></a></h3><p>åœ¨è®²è§£<code>performanceResourceTiming.secureConnectionStart</code>ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç†è§£å‡ ä¸ªåŸºç¡€æ¦‚å¿µï¼šNode.jsã€æ€§èƒ½ç›‘æµ‹ï¼ˆPerformance Timingï¼‰ã€ä»¥åŠå®‰å…¨è¿æ¥ã€‚</p><p><strong>Node.js</strong> æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 JavaScript å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€å¯ä»¥ç”¨ JavaScript ç¼–å†™åç«¯é€»è¾‘ï¼Œå¤„ç†æ•°æ®åº“æ“ä½œã€æ–‡ä»¶ç³»ç»Ÿæ“ä½œç­‰ã€‚</p><p><strong>æ€§èƒ½ç›‘æµ‹(Performance Timing)</strong> æ˜¯æŒ‡åœ¨ Web å¼€å‘ä¸­æµ‹é‡å„ç§ç½‘é¡µåŠ è½½é˜¶æ®µè€—æ—¶çš„æŠ€æœ¯ã€‚è¿™æœ‰åŠ©äºå¼€å‘è€…ä¼˜åŒ–ç½‘é¡µåŠ è½½æ—¶é—´ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚</p><p>åœ¨ HTTPS æˆ–å…¶ä»–å®‰å…¨è¿æ¥ä¸­ï¼Œ<strong>å®‰å…¨è¿æ¥çš„å»ºç«‹</strong>æ˜¯å…³é”®æ­¥éª¤ä¹‹ä¸€ï¼Œé€šå¸¸åŒ…æ‹¬å¦‚è¯ä¹¦éªŒè¯ã€å¯†é’¥äº¤æ¢ç­‰è¿‡ç¨‹ï¼Œè¿™äº›éƒ½æ˜¯åœ¨å‘é€çœŸæ­£çš„æ•°æ®ä¹‹å‰å¿…é¡»å®Œæˆçš„ã€‚</p><h3 id="performanceresourcetiming-secureconnectionstart-1" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-secureconnectionstart-1"><span><code>performanceResourceTiming.secureConnectionStart</code></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>performanceResourceTiming.secureConnectionStart</code> å±æ€§æ˜¯ Performance Resource Timing API çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªé«˜ç²¾åº¦çš„æ—¶é—´æˆ³ï¼Œè¡¨ç¤ºä½•æ—¶å¼€å§‹ä¸æœåŠ¡å™¨å»ºç«‹å®‰å…¨è¿æ¥çš„è¿‡ç¨‹ã€‚å¦‚æœè¯·æ±‚ä¸æ˜¯é€šè¿‡ TLS/SSL è¿›è¡ŒåŠ å¯†çš„ï¼Œåˆ™è¯¥å±æ€§çš„å€¼ä¸º 0ã€‚</p><h4 id="å®é™…åº”ç”¨ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-2"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨è¿è¡Œä¸€ä¸ª Node.js æœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨é€šè¿‡ HTTPS æœåŠ¡å®¢æˆ·ç«¯è¯·æ±‚ã€‚ä½ å¯èƒ½æƒ³è¦ç›‘æ§å’Œä¼˜åŒ–æœåŠ¡å™¨å“åº”æ—¶é—´ã€‚å…¶ä¸­ä¸€ä¸ªé‡è¦çš„æ–¹é¢å°±æ˜¯å»ºç«‹å®‰å…¨è¿æ¥æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œå› ä¸ºè¿™ç›´æ¥å½±å“åˆ°ç”¨æˆ·æ„ŸçŸ¥åˆ°çš„å»¶è¿Ÿã€‚</p><p>ä½¿ç”¨<code>performanceResourceTiming.secureConnectionStart</code>ï¼Œä½ å¯ä»¥ç²¾ç¡®åœ°çŸ¥é“æ¯æ¬¡è¯·æ±‚å¼€å§‹å°è¯•å®‰å…¨è¿æ¥çš„æ—¶é—´ç‚¹ã€‚ç»“åˆå…¶ä»–æ€§èƒ½ç›¸å…³çš„æ—¶é—´ç‚¹ï¼Œæ¯”å¦‚<code>connectStart</code>ï¼ˆå¼€å§‹è¿æ¥æœåŠ¡å™¨çš„æ—¶é—´ç‚¹ï¼‰å’Œ<code>responseStart</code>ï¼ˆæ¥æ”¶åˆ°æœåŠ¡å™¨å“åº”çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„æ—¶é—´ç‚¹ï¼‰ï¼Œä½ å¯ä»¥è®¡ç®—å‡ºå»ºç«‹å®‰å…¨è¿æ¥æ‰€éœ€çš„æ—¶é—´ï¼Œå¹¶åˆ†ææ•´ä½“æ€§èƒ½è¡¨ç°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> monitorSecureConnectionTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entry</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntriesByName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–ç‰¹å®šURLçš„æ€§èƒ½æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entry</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secureConnectionStart</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secureConnectionTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">connectEnd</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secureConnectionStart</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`å®‰å…¨è¿æ¥å»ºç«‹è€—æ—¶: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secureConnectionTime</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¯¥è¯·æ±‚æœªä½¿ç”¨å®‰å…¨è¿æ¥æˆ–æ•°æ®ä¸å¯ç”¨&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æ­¤å‡½æ•°åœ¨æŸå¤„è¢«è°ƒç”¨ï¼Œå¹¶ä¼ å…¥äº†ç›¸åº”çš„URL</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä»<code>performance</code>æ¨¡å—è·å–äº†ç‰¹å®š URL çš„æ€§èƒ½æ¡ç›®ã€‚ç„¶åæ£€æŸ¥äº†<code>secureConnectionStart</code>å±æ€§ï¼Œä»¥ç¡®è®¤æ˜¯å¦é€šè¿‡ TLS/SSL è¿›è¡Œäº†åŠ å¯†è¿æ¥ã€‚å¦‚æœæ˜¯çš„è¯ï¼Œæˆ‘ä»¬é€šè¿‡è®¡ç®—<code>connectEnd</code>å’Œ<code>secureConnectionStart</code>ä¹‹é—´çš„å·®å€¼æ¥å¾—åˆ°å»ºç«‹å®‰å…¨è¿æ¥æ‰€éœ€è¦çš„æ—¶é—´ï¼Œå¹¶å°†å…¶è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚è¿™å¯¹äºè¯†åˆ«å’Œä¼˜åŒ–æ€§èƒ½ç“¶é¢ˆéå¸¸æœ‰å¸®åŠ©ã€‚</p><p>æ€»è€Œè¨€ä¹‹ï¼Œé€šè¿‡ç›‘æ§å’Œåˆ†æ<code>performanceResourceTiming.secureConnectionStart</code>æä¾›çš„æ•°æ®ï¼Œå¼€å‘è€…å¯ä»¥æ›´æ·±å…¥åœ°äº†è§£å’Œä¼˜åŒ–åº”ç”¨ç¨‹åºä¸­å®‰å…¨è¿æ¥çš„å»ºç«‹è¿‡ç¨‹ï¼Œè¿›è€Œæå‡æ•´ä½“æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚</p><h3 id="performanceresourcetiming-requeststart" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-requeststart"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceresourcetimingrequeststart" target="_blank" rel="noopener noreferrer">performanceResourceTiming.requestStart</a></span></a></h3><p>å½“ä½ æµè§ˆç½‘é¡µæˆ–è€…ä½¿ç”¨åœ¨çº¿æœåŠ¡æ—¶ï¼Œä½ çš„ç”µè„‘ï¼ˆå®¢æˆ·ç«¯ï¼‰ä¼šå‘å¦ä¸€å°ç”µè„‘ï¼ˆæœåŠ¡å™¨ï¼‰å‘é€è¯·æ±‚æ¥è·å–æ•°æ®æˆ–é¡µé¢ã€‚è¿™ä¸ªè¿‡ç¨‹å°±åƒæ˜¯ä½ åœ¨é¤å…ç‚¹é¤ï¼ŒæœåŠ¡å‘˜æ¥æ”¶ä½ çš„è®¢å•åå»å¨æˆ¿å‡†å¤‡é£Ÿç‰©ï¼Œç„¶åå°†é£Ÿç‰©é€åˆ°ä½ çš„æ¡Œä¸Šã€‚åœ¨ç¼–ç¨‹ä¸–ç•Œä¸­ï¼Œæµ‹é‡è¿™ä¸ªè¿‡ç¨‹çš„æ—¶é—´éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒå¸®åŠ©å¼€å‘è€…äº†è§£åº”ç”¨çš„æ€§èƒ½ï¼Œå°¤å…¶æ˜¯å“åº”é€Ÿåº¦ã€‚</p><p>åœ¨<code>Node.js</code>ä¸­ï¼Œæœ‰ä¸€ä¸ªæ¨¡å—å«åš<code>perf_hooks</code>ï¼ˆæ€§èƒ½é’©å­ï¼‰ï¼Œå®ƒå…è®¸æˆ‘ä»¬ç›‘æ§ç¨‹åºçš„æ€§èƒ½ã€‚ç‰¹åˆ«åœ°ï¼Œ<code>PerformanceResourceTiming</code>å¯¹è±¡æä¾›äº†ç½‘ç»œè¯·æ±‚ï¼ˆæ¯”å¦‚ä»æœåŠ¡å™¨è·å–èµ„æºï¼‰çš„å„é¡¹æ—¶é—´æ€§èƒ½æŒ‡æ ‡ã€‚</p><h3 id="performanceresourcetiming-requeststart-1" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-requeststart-1"><span><code>performanceResourceTiming.requestStart</code></span></a></h3><p><code>performanceResourceTiming.requestStart</code>æ˜¯<code>PerformanceResourceTiming</code>å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒè¿”å›ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œè¡¨ç¤ºä½•æ—¶å¼€å§‹å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚ç®€å•æ¥è¯´ï¼Œè¿™ä¸ªæ—¶é—´æˆ³å‘Šè¯‰æˆ‘ä»¬â€œé¤å…æœåŠ¡å‘˜â€ä½•æ—¶å¼€å§‹æ ¹æ®ç”¨æˆ·çš„è®¢å•å‘â€œå¨æˆ¿â€å‘èµ·è¯·æ±‚ã€‚</p><h4 id="å®é™…è¿ç”¨ä¾‹å­-10" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-10"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h4><ol><li><p><strong>ç½‘ç«™åŠ è½½æ—¶é—´åˆ†æï¼š</strong><br> å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªæ–°é—»ç½‘ç«™ï¼Œåœ¨ç”¨æˆ·ç‚¹å‡»ä¸€ç¯‡æ–‡ç« æ—¶ï¼Œä½ çš„ç½‘ç«™éœ€è¦ä»æœåŠ¡å™¨è·å–æ–‡ç« å†…å®¹ã€‚ä½¿ç”¨<code>performanceResourceTiming.requestStart</code>å¯ä»¥å¸®åŠ©ä½ æµ‹é‡ä»ç”¨æˆ·ç‚¹å‡»åˆ°å®é™…å¼€å§‹ä»æœåŠ¡å™¨è·å–æ•°æ®æ‰€éœ€çš„æ—¶é—´ã€‚å¦‚æœè¿™ä¸ªæ—¶é—´è¿‡é•¿ï¼Œå¯èƒ½æ„å‘³ç€ä½ çš„ç½‘ç«™åœ¨å‘é€è¯·æ±‚å‰åšäº†å¤ªå¤šä¸å¿…è¦çš„å¤„ç†ã€‚</p></li><li><p><strong>æ€§èƒ½ç›‘æµ‹ç³»ç»Ÿï¼š</strong><br> å¦‚æœä½ åœ¨ä¸€ä¸ªå¤§å‹çš„åœ¨çº¿ç”µå•†å¹³å°å·¥ä½œï¼Œè¯¥å¹³å°æ¯å¤©å¤„ç†æˆåƒä¸Šä¸‡çš„äº¤æ˜“ã€‚é€šè¿‡è®°å½•æ¯ç¬”äº¤æ˜“è¯·æ±‚å¼€å§‹çš„æ—¶é—´ï¼Œä½ å¯ä»¥æ„å»ºä¸€ä¸ªæ€§èƒ½ç›‘æµ‹ç³»ç»Ÿï¼Œæ­¤ç³»ç»Ÿå¯ä»¥å®æ—¶ç›‘æ§å’Œè­¦æŠ¥ä»»ä½•ä¸æ­£å¸¸çš„å»¶è¿Ÿï¼Œç¡®ä¿ç”¨æˆ·ä½“éªŒä¸å—å½±å“ã€‚</p></li><li><p><strong>API è°ƒç”¨ä¼˜åŒ–ï¼š</strong><br> å½“å¼€å‘ä¸€ä¸ªä¾èµ–äºå¤šä¸ªç¬¬ä¸‰æ–¹ API çš„åº”ç”¨æ—¶ï¼Œç†è§£æ¯ä¸ª API è°ƒç”¨å¼€å§‹çš„æ—¶é—´è‡³å…³é‡è¦ã€‚ä¾‹å¦‚ï¼Œä½ çš„åº”ç”¨åŒæ—¶è°ƒç”¨å¤©æ°” API å’Œæ–°é—» API æ¥æä¾›å†…å®¹ã€‚åˆ©ç”¨<code>performanceResourceTiming.requestStart</code>ï¼Œä½ å¯ä»¥æµ‹é‡å“ªä¸ª API çš„å“åº”æ—¶é—´è¾ƒé•¿ï¼Œè¿›è€Œå†³å®šæ˜¯å¦éœ€è¦å¯»æ‰¾æ›´å¿«çš„æ›¿ä»£ APIï¼Œæˆ–è€…æ”¹å˜è°ƒç”¨é¡ºåºï¼Œä»¥ä¼˜åŒ–æ•´ä½“çš„åŠ è½½æ—¶é—´ã€‚</p></li></ol><p>è¿™ä¸ªå±æ€§çš„ä»·å€¼åœ¨äºï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ˜ç¡®çš„æ—¶é—´ç‚¹ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿç»†ç²’åº¦åœ°åˆ†æå’Œä¼˜åŒ–æ•°æ®è¯·æ±‚è¿‡ç¨‹ä¸­çš„æ¯ä¸€æ­¥ï¼Œä»è€Œæé«˜åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œç”¨æˆ·æ»¡æ„åº¦ã€‚</p><h3 id="performanceresourcetiming-responseend" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-responseend"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceresourcetimingresponseend" target="_blank" rel="noopener noreferrer">performanceResourceTiming.responseEnd</a></span></a></h3><p>Node.js ä¸­çš„ <code>performanceResourceTiming.responseEnd</code> å±äº Performance API çš„ä¸€éƒ¨åˆ†ï¼Œè¿™æ˜¯ä¸€ä¸ªæä¾›ç½‘ç»œè¯·æ±‚æ€§èƒ½æµ‹é‡åŠŸèƒ½çš„æ¥å£ã€‚åœ¨ Web å¼€å‘å’Œ Node.js ç¯å¢ƒä¸‹ï¼Œäº†è§£å’Œä¼˜åŒ–èµ„æºåŠ è½½æ—¶é—´è‡³å…³é‡è¦ï¼Œä»¥ç¡®ä¿åº”ç”¨ç¨‹åºçš„å¿«é€Ÿå“åº”å’Œè‰¯å¥½ç”¨æˆ·ä½“éªŒã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-performanceresourcetiming-responseend" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-performanceresourcetiming-responseend"><span>ä»€ä¹ˆæ˜¯ performanceResourceTiming.responseEnd?</span></a></h3><p><code>performanceResourceTiming.responseEnd</code> æ˜¯ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œè¡¨ç¤ºä»åŒä¸€ä¸ªèµ„æºï¼ˆæ¯”å¦‚ HTTP è¯·æ±‚ï¼‰çš„è¯·æ±‚å¼€å§‹åˆ°æµè§ˆå™¨æ¥æ”¶åˆ°æœ€åä¸€ä¸ªå­—èŠ‚çš„æ—¶åˆ»ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒè®°å½•äº†ä»è§¦å‘è¯·æ±‚åˆ°æ¥æ”¶å“åº”æ•°æ®çš„å…¨éƒ¨è¿‡ç¨‹ç»“æŸçš„æ—¶é—´ç‚¹ã€‚</p><h3 id="å¦‚ä½•ç†è§£å®ƒ" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ç†è§£å®ƒ"><span>å¦‚ä½•ç†è§£å®ƒï¼Ÿ</span></a></h3><p>ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸ªæ¦‚å¿µï¼Œå¯ä»¥å°†ä¸€ä¸ªèµ„æºçš„è·å–è¿‡ç¨‹æƒ³è±¡æˆå»ä¹¦åº—ä¹°ä¹¦çš„è¿‡ç¨‹ï¼š</p><ul><li><strong>è¯·æ±‚å¼€å§‹</strong>ï¼šä½ ç¦»å¼€å®¶å‰å¾€ä¹¦åº—ï¼ˆèµ„æºè¯·æ±‚å‘èµ·ï¼‰ã€‚</li><li><strong>æµè§ˆå’Œé€‰æ‹©</strong>ï¼šä½ åœ¨ä¹¦åº—é‡ŒæŒ‘é€‰ä¹¦ç±ï¼ˆæœåŠ¡å™¨å¤„ç†è¯·æ±‚å¹¶å‡†å¤‡å“åº”ï¼‰ã€‚</li><li><strong>ä»˜æ¬¾</strong>ï¼šä½ é€‰å¥½ä¹¦ï¼Œåˆ°æ”¶é“¶å°æ”¯ä»˜ï¼ˆæœåŠ¡å™¨å¼€å§‹å‘é€æ•°æ®ï¼‰ã€‚</li><li><strong>æ‹¿åˆ°ä¹¦ç¦»å¼€</strong>ï¼šä½ æ”¶åˆ°ä¹¦ï¼Œç¦»å¼€ä¹¦åº—å›å®¶ï¼ˆå“åº”æ•°æ®å®Œå…¨æ¥æ”¶ï¼‰ã€‚</li></ul><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œâ€œæ‹¿åˆ°ä¹¦ç¦»å¼€â€çš„æ—¶é—´ç‚¹å¯¹åº”äº <code>performanceResourceTiming.responseEnd</code>ã€‚å®ƒæ ‡å¿—ç€æ•´ä¸ªâ€œè´­ä¹¦â€è¿‡ç¨‹çš„ç»“æŸã€‚</p><h3 id="å®é™…åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨"><span>å®é™…åº”ç”¨</span></a></h3><p>åœ¨ Node.js åº”ç”¨ä¸­ï¼Œå°¤å…¶æ˜¯æ¶‰åŠåˆ°ç½‘ç»œè¯·æ±‚çš„åœºæ™¯ï¼ˆä¾‹å¦‚ï¼Œè®¿é—®å¤–éƒ¨ APIã€åŠ è½½æ•°æ®åº“å†…å®¹ç­‰ï¼‰ï¼Œç›‘æ§å’Œåˆ†æèµ„æºåŠ è½½æ—¶é—´éå¸¸é‡è¦ã€‚ä¾‹å¦‚ï¼š</p><ol><li><p><strong>API æ€§èƒ½ç›‘æ§</strong>ï¼šå¦‚æœä½ çš„æœåŠ¡å™¨æ­£åœ¨è°ƒç”¨å¤–éƒ¨ APIï¼Œä½¿ç”¨ <code>responseEnd</code> å¯ä»¥å¸®åŠ©ä½ è¡¡é‡æ¯ä¸ªè¯·æ±‚çš„æ€»è€—æ—¶ã€‚é€šè¿‡è¿™äº›æ•°æ®ï¼Œä½ å¯ä»¥è¯†åˆ«å‡ºå»¶è¿Ÿè¾ƒé«˜çš„ API è°ƒç”¨ï¼Œå¹¶è€ƒè™‘ä¼˜åŒ–æˆ–å¯»æ‰¾æ›¿ä»£æ–¹æ¡ˆã€‚</p></li><li><p><strong>æœåŠ¡å¥åº·æ£€æŸ¥</strong>ï¼šå®šæœŸæ£€æµ‹å…³é”®èµ„æºçš„åŠ è½½æ—¶é—´å¯ä»¥ä½œä¸ºæœåŠ¡å¥åº·çŠ¶å†µçš„æŒ‡æ ‡ä¹‹ä¸€ã€‚å¼‚å¸¸å¢é•¿çš„åŠ è½½æ—¶é—´å¯èƒ½é¢„ç¤ºç€ç³»ç»Ÿç“¶é¢ˆæˆ–æ€§èƒ½ä¸‹é™ã€‚</p></li><li><p><strong>ç”¨æˆ·ä½“éªŒä¼˜åŒ–</strong>ï¼šå¯¹äºæä¾›ç»™å®¢æˆ·ç«¯ä½¿ç”¨çš„ APIï¼Œäº†è§£ä¸åŒè¯·æ±‚çš„ <code>responseEnd</code> æ—¶é—´æœ‰åŠ©äºä¼˜åŒ–å‰ç«¯åŠ è½½ç­–ç•¥ï¼Œä¾‹å¦‚è°ƒæ•´èµ„æºåŠ è½½é¡ºåºï¼Œæˆ–è€…å®æ–½æ‡’åŠ è½½ç­‰æŠ€æœ¯æ”¹å–„ç”¨æˆ·ä½“éªŒã€‚</p></li></ol><h3 id="ä½¿ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹"><span>ä½¿ç”¨ç¤ºä¾‹</span></a></h3><p>åœ¨ Node.js ç¯å¢ƒä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨å†…ç½®çš„ <code>perf_hooks</code> æ¨¡å—æ¥è·å– <code>performanceResourceTiming</code> å¯¹è±¡ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼š</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œå¦‚æ•°æ®åº“æŸ¥è¯¢æˆ–HTTPè¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    callback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ•°æ®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™ä¸ªæ“ä½œè€—æ—¶100æ¯«ç§’</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ“ä½œè€—æ—¶ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼Œè™½ç„¶ä¸Šè¿°ç¤ºä¾‹æ²¡æœ‰ç›´æ¥ä½¿ç”¨ <code>performanceResourceTiming</code> æ¥å£ï¼ˆå› ä¸ºå®ƒæ›´å¤šåœ°è¢«ç”¨åœ¨ Web ç¯å¢ƒä¸­ï¼‰ï¼Œä½†å®ƒå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Node.js çš„ <code>performance</code> API æ¥ç›‘æµ‹å’Œåˆ†ææ“ä½œçš„æ€§èƒ½ï¼Œç±»ä¼¼äº <code>responseEnd</code> åœ¨æ€§èƒ½åˆ†æä¸­çš„åº”ç”¨ã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼Œäº†è§£å’Œåˆ©ç”¨ <code>performanceResourceTiming.responseEnd</code> å¯ä»¥å¸®åŠ©å¼€å‘è€…ç›‘æ§ç½‘ç»œè¯·æ±‚çš„æ€§èƒ½ï¼Œè¿›è€Œä¼˜åŒ–åº”ç”¨ç¨‹åºï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚</p><h3 id="performanceresourcetiming-transfersize" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-transfersize"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceresourcetimingtransfersize" target="_blank" rel="noopener noreferrer">performanceResourceTiming.transferSize</a></span></a></h3><p>ç†è§£ <code>performanceResourceTiming.transferSize</code> å±æ€§ï¼Œé¦–å…ˆéœ€è¦ç®€å•äº†è§£ä¸€ä¸‹å®ƒæ‰€å¤„çš„ä¸Šä¸‹æ–‡â€”â€”Node.js ä¸­çš„æ€§èƒ½ç›‘æµ‹ï¼ˆPerformance Timing APIï¼‰ï¼Œä»¥åŠæ›´å…·ä½“åœ°ï¼Œ<code>PerformanceResourceTiming</code> å¯¹è±¡ã€‚</p><h3 id="èƒŒæ™¯" tabindex="-1"><a class="header-anchor" href="#èƒŒæ™¯"><span>èƒŒæ™¯</span></a></h3><p>åœ¨ Web å¼€å‘ä¸­ï¼Œäº†è§£é¡µé¢æˆ–åº”ç”¨åŠ è½½è¿‡ç¨‹ä¸­èµ„æºï¼ˆå¦‚è„šæœ¬ã€å›¾ç‰‡ã€æ ·å¼è¡¨ç­‰ï¼‰çš„åŠ è½½æ—¶é—´å¯¹äºä¼˜åŒ–ç”¨æˆ·ä½“éªŒè‡³å…³é‡è¦ã€‚åŒæ ·åœ°ï¼Œåœ¨ Node.js ç¯å¢ƒä¸‹ï¼Œè™½ç„¶æˆ‘ä»¬ä¸å¤„ç†åƒæµè§ˆå™¨é‚£æ ·çš„æ–‡æ¡£å’Œèµ„æºåŠ è½½ï¼Œä½†æˆ‘ä»¬ä¾æ—§å…³æ³¨äºåº”ç”¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­å„ç§æ“ä½œï¼ˆæ¯”å¦‚æ–‡ä»¶è¯»å†™ã€ç½‘ç»œè¯·æ±‚ç­‰ï¼‰çš„æ€§èƒ½æŒ‡æ ‡ã€‚Node.js é€šè¿‡æä¾›ä¸€ä¸ªå†…ç½®æ¨¡å— <code>perf_hooks</code> ï¼ˆæ€§èƒ½é’©å­ï¼‰ï¼Œä½¿å¾—æ€§èƒ½ç›‘æµ‹æˆä¸ºå¯èƒ½ã€‚</p><h3 id="performanceresourcetiming" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming"><span><code>PerformanceResourceTiming</code></span></a></h3><p><code>PerformanceResourceTiming</code> å¯¹è±¡æ˜¯ <code>perf_hooks</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†ã€‚å®ƒæä¾›äº†æœ‰å…³å•ä¸ªèµ„æºï¼ˆåœ¨ Node.js ä¸­ï¼Œè¿™é€šå¸¸æŒ‡çš„æ˜¯ç½‘ç»œè¯·æ±‚æˆ–å…¶ä»–ç±»å‹çš„ I/O æ“ä½œï¼‰ä»å¼€å§‹è¯·æ±‚åˆ°å®Œæˆä¼ è¾“çš„å„ä¸ªé˜¶æ®µçš„æ€§èƒ½ä¿¡æ¯ã€‚è¯¥å¯¹è±¡åŒ…å«äº†å¤šä¸ªå±æ€§ï¼Œå…¶ä¸­ <code>transferSize</code> æ˜¯æˆ‘ä»¬æ­¤å¤„å…³æ³¨çš„é‡ç‚¹ã€‚</p><h3 id="performanceresourcetiming-transfersize-1" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-transfersize-1"><span><code>performanceResourceTiming.transferSize</code></span></a></h3><ul><li><p><strong>å®šä¹‰ï¼š</strong> <code>transferSize</code> å±æ€§è¿”å›è¡¨ç¤ºèµ„æºä¼ è¾“å¤§å°çš„æ•´æ•°å€¼ï¼ˆå•ä½æ˜¯å­—èŠ‚ï¼‰ã€‚è¿™ä¸ªå°ºå¯¸åŒ…æ‹¬äº†èµ„æºæœ¬èº«çš„å¤§å°åŠ ä¸Šæ‰€æœ‰ç›¸å…³çš„åè®®å¼€é”€ï¼ˆä¾‹å¦‚ HTTP å¤´ä¿¡æ¯ï¼‰ã€‚</p></li><li><p><strong>åº”ç”¨åœºæ™¯ï¼š</strong> äº†è§£ <code>transferSize</code> å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¯„ä¼°ç½‘ç»œè¯·æ±‚æˆ–æ–‡ä»¶æ“ä½œçš„æ•ˆç‡å’Œæˆæœ¬ã€‚ä¾‹å¦‚ï¼Œåœ¨è¿›è¡Œå¤§é‡æ•°æ®å¤„ç†æ—¶ï¼Œäº†è§£æ¯ä¸ªè¯·æ±‚çš„ <code>transferSize</code> å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¯†åˆ«å“ªäº›è¯·æ±‚å¯èƒ½ä¸å¿…è¦åœ°æ¶ˆè€—äº†è¿‡å¤šçš„å¸¦å®½æˆ–å¯¼è‡´å»¶è¿Ÿå¢åŠ ã€‚</p></li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-6" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-6"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œè¯¥ç¨‹åºå®šæœŸä»å¤šä¸ªæºä¸‹è½½æ•°æ®è¿›è¡Œåˆ†æå’Œå­˜å‚¨ã€‚ä½¿ç”¨ <code>performanceResourceTiming</code> ç›¸å…³ APIï¼Œä½ å¯ä»¥è½»æ¾åœ°è·Ÿè¸ªæ¯æ¬¡ä¸‹è½½æ“ä½œçš„æ€§èƒ½æŒ‡æ ‡ã€‚</p><ol><li><p><strong>ç›‘æµ‹æ–‡ä»¶ä¸‹è½½æ€§èƒ½ï¼š</strong><br> å‡è®¾ä½ çš„åº”ç”¨éœ€è¦ä¸‹è½½ä¸€ä¸ªå¤§æ–‡ä»¶è¿›è¡Œå¤„ç†ã€‚é€šè¿‡ç›‘æµ‹ <code>transferSize</code>ï¼Œä½ å¯ä»¥äº†è§£åˆ°å®é™…ä¼ è¾“çš„æ•°æ®é‡ï¼Œè¿›è€Œåˆ†ææ€§èƒ½ç“¶é¢ˆæˆ–ä¼˜åŒ–ä¸‹è½½é€»è¾‘ã€‚å¦‚æœ <code>transferSize</code> æ˜¾è‘—å¤§äºé¢„æœŸï¼Œå¯èƒ½æ„å‘³ç€å­˜åœ¨é¢å¤–çš„å¼€é”€æˆ–é”™è¯¯é…ç½®ã€‚</p></li><li><p><strong>API è°ƒç”¨ä¼˜åŒ–ï¼š</strong><br> å¦‚æœä½ çš„åº”ç”¨ä¾èµ–äºç¬¬ä¸‰æ–¹ APIï¼Œé€šè¿‡åˆ†ææ¯æ¬¡ API è°ƒç”¨çš„ <code>transferSize</code>ï¼Œå¯ä»¥å¸®åŠ©ä½ è¯„ä¼° API çš„æ•ˆç‡ã€‚å¯¹äºè¿”å›å¤§é‡ä¸å¿…è¦æ•°æ®çš„ APIï¼Œä½ å¯èƒ½ä¼šè€ƒè™‘è¯·æ±‚æ›´å°‘çš„æ•°æ®å­—æ®µï¼Œæˆ–ä¸æœåŠ¡æä¾›å•†è®¨è®ºä¼˜åŒ–æ–¹æ¡ˆã€‚</p></li><li><p><strong>æ€§èƒ½åŸºå‡†æµ‹è¯•ï¼š</strong><br> åœ¨è¿›è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•æ—¶ï¼Œ<code>transferSize</code> å¯ä»¥ä½œä¸ºè¡¡é‡ç½‘ç»œ I/O æ€§èƒ½çš„æŒ‡æ ‡ä¹‹ä¸€ã€‚é€šè¿‡æ¯”è¾ƒä¸åŒç½‘ç»œæ¡ä»¶æˆ–é…ç½®ä¸‹çš„ <code>transferSize</code> æ•°æ®ï¼Œå¯ä»¥å®¢è§‚è¯„ä¼°æ”¹åŠ¨å‰åçš„æ€§èƒ½å·®å¼‚ã€‚</p></li></ol><h3 id="æ€»ç»“-7" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-7"><span>æ€»ç»“</span></a></h3><p><code>performanceResourceTiming.transferSize</code> æ˜¯ Node.js ä¸­ä¸€ä¸ªéå¸¸å®ç”¨çš„æ€§èƒ½æŒ‡æ ‡ï¼Œå°¤å…¶é€‚ç”¨äºéœ€è¦ç›‘æ§å’Œä¼˜åŒ–ç½‘ç»œè¯·æ±‚æˆ–æ–‡ä»¶ä¼ è¾“æ•ˆç‡çš„åº”ç”¨åœºæ™¯ã€‚é€šè¿‡åˆç†åˆ©ç”¨è¿™ä¸€æŒ‡æ ‡ï¼Œå¯ä»¥æ˜¾è‘—æå‡åº”ç”¨çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚</p><h3 id="performanceresourcetiming-encodedbodysize" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-encodedbodysize"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceresourcetimingencodedbodysize" target="_blank" rel="noopener noreferrer">performanceResourceTiming.encodedBodySize</a></span></a></h3><p>å½“æˆ‘ä»¬è°ˆè®º<code>performanceResourceTiming.encodedBodySize</code>å±æ€§æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šåœ¨è®¨è®ºçš„æ˜¯ç½‘ç»œæ€§èƒ½ç›‘æ§çš„ä¸€ä¸ªæ–¹é¢ã€‚è¿™ä¸ªæ¦‚å¿µæºè‡ª Web æ€§èƒ½ APIï¼Œä½†åœ¨ Node.js ä¸­ä¹Ÿæœ‰ç›¸åº”çš„å®ç°ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç† HTTP è¯·æ±‚æ—¶ã€‚è¦ç†è§£<code>encodedBodySize</code>ï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆäº†è§£ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-1" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-1"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p><strong>1. Performance Resource Timing:</strong><br> è¿™æ˜¯ä¸€ä¸ªæä¾›äº†ç½‘é¡µï¼ˆæˆ–è€…åœ¨ Node.js ä¸­æ˜¯æœåŠ¡å™¨èµ„æºï¼‰åŠ è½½è¿‡ç¨‹ä¸­å„ä¸ªé˜¶æ®µè¯¦ç»†æ—¶é—´ä¿¡æ¯çš„æ¥å£ã€‚å®ƒå¯ä»¥å¸®åŠ©å¼€å‘è€…åˆ†æå’Œä¼˜åŒ–åº”ç”¨æ€§èƒ½ã€‚</p><p><strong>2. Encoded Body Size:</strong><br> æŒ‡çš„æ˜¯è·å–èµ„æºæ—¶ï¼Œç»è¿‡ç¼–ç ï¼ˆå¦‚ gzip å‹ç¼©ï¼‰åçš„ä½“ç§¯ã€‚è¿™ä¸åŒ…æ‹¬å“åº”å¤´éƒ¨çš„å¤§å°ï¼Œåªå…³æ³¨å“åº”ä½“çš„å¤§å°ã€‚æ¯”å¦‚ï¼Œä»æœåŠ¡å™¨ä¸‹è½½ä¸€ä¸ªå›¾ç‰‡æˆ–æ–‡æ¡£ï¼Œ<code>encodedBodySize</code>å°±æ˜¯ä¸‹è½½å†…å®¹ç»è¿‡ç½‘ç»œä¼ è¾“å‹ç¼©åçš„å¤§å°ã€‚</p><h3 id="node-js-ä¸­çš„åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#node-js-ä¸­çš„åº”ç”¨"><span>Node.js ä¸­çš„åº”ç”¨</span></a></h3><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>performanceResourceTiming.encodedBodySize</code>å±æ€§è¢«ç”¨æ¥åº¦é‡é€šè¿‡ç½‘ç»œæ¥æ”¶åˆ°çš„æ•°æ®çš„å¤§å°ï¼Œç‰¹åˆ«æ˜¯åœ¨è¿›è¡Œ HTTP/HTTPS è¯·æ±‚æ—¶ã€‚è¿™å¯¹äºæ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–éå¸¸æœ‰ç”¨ã€‚</p><h4 id="å®é™…è¿ç”¨ä¾‹å­-11" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-11"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h4><h5 id="ä¾‹å­-1-ç›‘æµ‹ä¸‹è½½æ–‡ä»¶çš„å¤§å°" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-ç›‘æµ‹ä¸‹è½½æ–‡ä»¶çš„å¤§å°"><span>ä¾‹å­ 1: ç›‘æµ‹ä¸‹è½½æ–‡ä»¶çš„å¤§å°</span></a></h5><p>æƒ³è±¡ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œè¯¥åº”ç”¨éœ€è¦ä»è¿œç«¯æœåŠ¡å™¨ä¸‹è½½å¤šä¸ªæ–‡ä»¶ã€‚ä¸ºäº†ä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼Œä½ å†³å®šç›‘æµ‹å¹¶è®°å½•æ¯ä¸ªæ–‡ä»¶ä¸‹è½½çš„æ—¶é—´å’Œå¤§å°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> https</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ€§èƒ½è§‚å¯Ÿè€…æ¥ç›‘è§†å¹¶æ‰“å°encodedBodySize</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      `æ–‡ä»¶: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, ç¼–ç åä½“ç§¯: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encodedBodySize</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> å­—èŠ‚`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;resource&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿæ–‡ä»¶ä¸‹è½½</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> downloadFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> startTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  https</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // æ•°æ®å—è¢«æ¥å—</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`end_</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">startTime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`end_</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">downloadFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https://example.com/path/to/file1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾URLæ˜¯æœ‰æ•ˆçš„</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">downloadFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https://example.com/path/to/file2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä»¥ä¸Šä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>PerformanceObserver</code>æ¥ç›‘æ§å’Œè¾“å‡ºæ¯æ¬¡ HTTP è¯·æ±‚çš„<code>encodedBodySize</code>ï¼Œå³æ–‡ä»¶çš„ç¼–ç åå¤§å°ã€‚</p><h5 id="ä¾‹å­-2-æ€§èƒ½ä¼˜åŒ–åˆ†æ" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-æ€§èƒ½ä¼˜åŒ–åˆ†æ"><span>ä¾‹å­ 2: æ€§èƒ½ä¼˜åŒ–åˆ†æ</span></a></h5><p>å¦‚æœä½ æ­£åœ¨å¯¹ä¸€ä¸ª Node.js æœåŠ¡è¿›è¡Œæ€§èƒ½è°ƒä¼˜ï¼Œå¯èƒ½ä¼šç”¨åˆ°<code>encodedBodySize</code>æ¥åˆ¤æ–­æ˜¯å¦æ‰€æœ‰å‘é€ç»™å®¢æˆ·ç«¯çš„æ•°æ®éƒ½å·²ç»è¢«æœ‰æ•ˆå‹ç¼©ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥æ£€æŸ¥å“åº”ä½“çš„å®é™…å¤§å°ä¸ç¼–ç åçš„å¤§å°ä¹‹é—´çš„å·®å¼‚ï¼Œå¦‚æœå·®å¼‚è¾ƒå¤§ï¼Œè¯´æ˜å‹ç¼©æ•ˆç‡é«˜ï¼Œåä¹‹åˆ™å¯èƒ½éœ€è¦æ”¹è¿›å‹ç¼©æ–¹æ³•ã€‚</p><h3 id="æ€»ç»“-8" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-8"><span>æ€»ç»“</span></a></h3><p><code>performanceResourceTiming.encodedBodySize</code>åœ¨ Node.js ä¸­æ˜¯ä¸€ä¸ªéå¸¸æœ‰ä»·å€¼çš„æŒ‡æ ‡ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…ä»æ•°æ®ä¼ è¾“çš„è§’åº¦æ¥ä¼˜åŒ–åº”ç”¨æ€§èƒ½ã€‚é€šè¿‡ç›‘æµ‹å’Œåˆ†æè¿™ä¸€æŒ‡æ ‡ï¼Œå¼€å‘è€…å¯ä»¥æ›´å¥½åœ°ç†è§£å’Œä¼˜åŒ–ç½‘ç»œé€šä¿¡çš„æˆæœ¬å’Œæ•ˆç‡ã€‚</p><h3 id="performanceresourcetiming-decodedbodysize" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-decodedbodysize"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceresourcetimingdecodedbodysize" target="_blank" rel="noopener noreferrer">performanceResourceTiming.decodedBodySize</a></span></a></h3><p>å½“ä½ æµè§ˆç½‘é¡µæˆ–ä¸ç½‘ç»œæœåŠ¡è¿›è¡Œäº¤äº’æ—¶ï¼Œä½ çš„è®¾å¤‡ä¼šä¸‹è½½å„ç§èµ„æºï¼Œæ¯”å¦‚ HTML æ–‡ä»¶ã€å›¾ç‰‡ã€è§†é¢‘ç­‰ã€‚è¿™äº›èµ„æºåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†å‡å°‘æ•°æ®é‡å’Œæé«˜ä¼ è¾“æ•ˆç‡ï¼Œé€šå¸¸ä¼šè¿›è¡Œå‹ç¼©ã€‚ä¸€æ—¦è¿™äº›èµ„æºåˆ°è¾¾ä½ çš„è®¾å¤‡ï¼Œå®ƒä»¬ä¼šè¢«è§£å‹ç¼©ï¼Œä»¥ä¾¿ä½ çš„æµè§ˆå™¨æˆ–åº”ç”¨ç¨‹åºå¯ä»¥æ­£å¸¸ä½¿ç”¨å®ƒä»¬ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œäº†è§£èµ„æºåœ¨è¢«è§£å‹ç¼©ä¹‹åçš„çœŸå®å¤§å°å˜å¾—å¾ˆé‡è¦ï¼Œç‰¹åˆ«æ˜¯å¯¹äºæ€§èƒ½åˆ†æå’Œä¼˜åŒ–è€Œè¨€ã€‚</p><p><code>performanceResourceTiming.decodedBodySize</code>å±æ€§å°±æ˜¯ç”¨æ¥æä¾›è¿™ä¸ªä¿¡æ¯çš„ã€‚å®ƒå±äº Node.js ä¸­<code>perf_hooks</code>æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œè¿™ä¸ªæ¨¡å—å…è®¸ä½ ç›‘æ§å’Œæ”¶é›†ç¨‹åºæ‰§è¡Œçš„æ€§èƒ½æŒ‡æ ‡ã€‚å…·ä½“åˆ°<code>decodedBodySize</code>ï¼Œå®ƒä»£è¡¨äº†æ¥æ”¶åˆ°çš„èµ„æºä½“ï¼ˆbodyï¼‰åœ¨ç»è¿‡è§£ç ï¼ˆä¹Ÿå°±æ˜¯è§£å‹ç¼©ï¼‰ä¹‹åçš„å¤§å°ï¼Œå•ä½æ˜¯å­—èŠ‚ï¼ˆbytesï¼‰ã€‚è¿™ä¸ªæ•°å€¼å¯¹äºç†è§£å’Œä¼˜åŒ–åº”ç”¨ç¨‹åºçš„æ•°æ®ä¼ è¾“æ•ˆç‡å°¤å…¶å…³é”®ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-7" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-7"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ç¨‹åºï¼Œè¯¥ç¨‹åºéœ€è¦ä»æœåŠ¡å™¨åŠ è½½å¤§é‡çš„å›¾ç‰‡èµ„æºã€‚ä¸ºäº†ç¡®ä¿ç”¨æˆ·ä½“éªŒï¼Œä½ éœ€è¦ç›‘æ§å’Œä¼˜åŒ–è¿™äº›å›¾ç‰‡çš„åŠ è½½æ—¶é—´ã€‚ä½¿ç”¨<code>performanceResourceTiming.decodedBodySize</code>å¯ä»¥å¸®åŠ©ä½ äº†è§£æ¯å¼ å›¾ç‰‡è§£ç åçš„å®é™…å¤§å°ï¼Œè¿™æ˜¯å› ä¸ºå›¾ç‰‡åœ¨ä¼ è¾“å‰å¯èƒ½å·²ç»è¿›è¡Œäº†å‹ç¼©ã€‚é€šè¿‡è¿™ä¸ªæŒ‡æ ‡ï¼Œä½ å¯ä»¥ï¼š</p><ol><li><p><strong>æ€§èƒ½ç›‘æ§</strong>ï¼šå®šæœŸæ£€æŸ¥å›¾ç‰‡æˆ–å…¶ä»–èµ„æºçš„è§£å‹åå¤§å°ï¼Œå¦‚æœçªç„¶å¢å¤§ï¼Œå¯èƒ½æ„å‘³ç€æœåŠ¡å™¨ç«¯å‹ç¼©è®¾ç½®æœ‰é—®é¢˜æˆ–è€…é”™è¯¯åœ°ä¸Šä¼ äº†æœªå‹ç¼©çš„èµ„æºã€‚</p></li><li><p><strong>ä¼˜åŒ–ç­–ç•¥</strong>ï¼šæ ¹æ®è§£ç åçš„å¤§å°ï¼Œå†³å®šæ˜¯å¦éœ€è¦æ›´æ¢å›¾ç‰‡æ ¼å¼æˆ–è°ƒæ•´å‹ç¼©ç®—æ³•ï¼Œä»¥å‡å°‘ä¼ è¾“æ—¶é—´å¹¶åŠ å¿«é¡µé¢åŠ è½½é€Ÿåº¦ã€‚</p></li><li><p><strong>æˆæœ¬æ•ˆç›Šåˆ†æ</strong>ï¼šå¯¹äºæœ‰æµé‡è®¡è´¹çš„åº”ç”¨åœºæ™¯ï¼ˆä¾‹å¦‚ç§»åŠ¨ç½‘ç»œï¼‰ï¼Œäº†è§£æ•°æ®ä¼ è¾“çš„å®é™…å¤§å°å¯ä»¥å¸®åŠ©è¿›è¡Œæˆæœ¬æ§åˆ¶å’Œä¼˜åŒ–ã€‚</p></li></ol><h3 id="å¦‚ä½•ä½¿ç”¨-6" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-6"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>é¦–å…ˆï¼Œä½ éœ€è¦å¼•å…¥<code>perf_hooks</code>æ¨¡å—ï¼Œç„¶åä½¿ç”¨å®ƒæ¥è·å–ç‰¹å®šèµ„æºçš„æ€§èƒ½æ¡ç›®ä¿¡æ¯ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ç‰‡æ®µï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä»æŸç§å½¢å¼çš„è¯·æ±‚ä¸­è·å–çš„æ€§èƒ½æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> resourceEntry</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntriesByType</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;resource&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–ç¬¬ä¸€ä¸ªèµ„æºæ¡ç›®ä½œä¸ºç¤ºä¾‹</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">resourceEntry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decodedBodySize</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°è§£ç åçš„ä½“ç§¯å¤§å°</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼ŒNode.js ç¯å¢ƒä¸»è¦ç”¨äºæœåŠ¡å™¨ç«¯åº”ç”¨ï¼Œè€Œ<code>performanceResourceTiming</code>å¯¹è±¡æ›´å¤šæ˜¯åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹ä½¿ç”¨çš„ã€‚ä¸è¿‡ï¼Œç†è§£å®ƒçš„æ¦‚å¿µå¯ä»¥å¸®åŠ©ä½ åœ¨å¤„ç† HTTP è¯·æ±‚ã€å“åº”å’Œä¼˜åŒ– Web åº”ç”¨æ€§èƒ½æ—¶ï¼Œæ‹¥æœ‰æ›´å…¨é¢çš„è§†è§’ã€‚åœ¨ Node.js ä¸­ï¼Œç±»ä¼¼çš„æ€§èƒ½åˆ†æå’Œä¼˜åŒ–å¯ä»¥é€šè¿‡åˆ†æ HTTP å“åº”å¤´ä¸­çš„å†…å®¹é•¿åº¦(<code>Content-Length</code>)æˆ–ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“æ¥å®ç°ã€‚</p><h3 id="performanceresourcetiming-tojson" tabindex="-1"><a class="header-anchor" href="#performanceresourcetiming-tojson"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceresourcetimingtojson" target="_blank" rel="noopener noreferrer">performanceResourceTiming.toJSON()</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥æ·±å…¥äº†è§£ Node.js ä¸­çš„ <code>performanceResourceTiming.toJSON()</code> æ–¹æ³•å’Œå®ƒçš„åº”ç”¨ã€‚</p><p>é¦–å…ˆï¼Œä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦ææ¸…æ¥šå‡ ä¸ªèƒŒæ™¯æ¦‚å¿µï¼š</p><ol><li><p><strong>Node.js</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨æœåŠ¡å™¨ä¸Šçš„ JavaScript ç¯å¢ƒï¼Œå…è®¸ä½ ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚å®ƒéå¸¸é€‚åˆå¤„ç†é«˜å¹¶å‘ã€IO å¯†é›†å‹çš„æ“ä½œã€‚</p></li><li><p><strong>Performance Timing API</strong>ï¼šè¿™æ˜¯ Web æ€§èƒ½ API çš„ä¸€éƒ¨åˆ†ï¼Œé€šå¸¸ç”¨äºæµ‹é‡ç½‘é¡µä¸åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚è™½ç„¶æœ€åˆè®¾è®¡ç”¨äºæµè§ˆå™¨ç¯å¢ƒï¼Œä½† Node.js ä¹Ÿå®ç°äº†ç±»ä¼¼çš„ APIï¼ˆé€šè¿‡ <code>perf_hooks</code> æ¨¡å—ï¼‰ï¼Œä»¥ä¾¿äºå¼€å‘è€…å¯ä»¥è¯„ä¼°åº”ç”¨ç¨‹åºä¸­å„ä¸ªéƒ¨åˆ†çš„æ€§èƒ½ã€‚</p></li><li><p><strong><code>performanceResourceTiming</code> å¯¹è±¡</strong>ï¼šåœ¨ Node.js ä¸­ï¼Œè¿™ä¸ªå¯¹è±¡æä¾›äº†æœ‰å…³ç‰¹å®š IO æˆ–å…¶ä»–ç±»å‹æ“ä½œçš„è¯¦ç»†æ—¶é—´ä¿¡æ¯ï¼ˆä¾‹å¦‚è¯·æ±‚èµ„æºæ‰€éœ€çš„æ—¶é—´ï¼‰ã€‚å®ƒæœ‰å¾ˆå¤šå±æ€§æ¯”å¦‚ <code>startTime</code>, <code>responseEnd</code> ç­‰ï¼Œå¸®åŠ©ä½ ç†è§£æ“ä½œçš„è€—æ—¶æƒ…å†µã€‚</p></li><li><p><strong><code>.toJSON()</code> æ–¹æ³•</strong>ï¼šæ­¤æ–¹æ³•å°† <code>performanceResourceTiming</code> å¯¹è±¡çš„æ€§èƒ½ä¿¡æ¯è½¬æ¢æˆä¸€ä¸ªç®€å•çš„ JSON å¯¹è±¡ã€‚è¿™ä½¿å¾—æ•°æ®æ›´æ˜“äºå­˜å‚¨æˆ–ä¼ è¾“ï¼Œå¹¶ä¸”å¯ä»¥è½»æ¾åœ°é€šè¿‡å­—ç¬¦ä¸²æ ¼å¼ä¸å…¶ä»–ç³»ç»Ÿå…±äº«è¿™äº›æ€§èƒ½ç›¸å…³çš„ä¿¡æ¯ã€‚</p></li></ol><h3 id="å®é™…åº”ç”¨ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-3"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåŸºäº Node.js çš„ Web åº”ç”¨ç¨‹åºï¼Œå¹¶æƒ³ç›‘æ§ä»å¼€å§‹å¤„ç†è¯·æ±‚åˆ°å‘é€å“åº”æ€»å…±èŠ±è´¹äº†å¤šå°‘æ—¶é—´ï¼Œä»¥åŠå…¶ä¸­æ¯ä¸ªé˜¶æ®µå…·ä½“çš„è€—æ—¶æƒ…å†µã€‚</p><p>ä»¥ä¸‹æ˜¯ä½¿ç”¨ <code>performanceResourceTiming.toJSON()</code> æ–¹æ³•çš„æ­¥éª¤ï¼š</p><ol><li><p><strong>å¼•å…¥å¿…è¦çš„æ¨¡å—</strong>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><strong>ç›‘è§†æ€§èƒ½æŒ‡æ ‡</strong>:<br> ä½ å¯ä»¥è®¾ç½®ä¸€ä¸ªæ€§èƒ½è§‚å¯Ÿè€…æ¥ç›‘å¬ç‰¹å®šç±»å‹çš„æ€§èƒ½æ¡ç›®ï¼ˆä¾‹å¦‚ï¼š&quot;resource&quot;ï¼‰ï¼Œå¹¶åœ¨æ¡ç›®è¢«è®°å½•æ—¶æ‰§è¡Œå›è°ƒå‡½æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toJSON</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;resource&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ‰§è¡Œä¸€äº›æ“ä½œ</strong>:<br> åœ¨è¿™é‡Œï¼Œä½ å¯èƒ½ä¼šæ‰§è¡Œä¸€äº›å¼‚æ­¥æ“ä½œï¼Œæ¯”å¦‚ä»å¤–éƒ¨ API è·å–æ•°æ®ï¼Œç„¶ååˆ©ç”¨è§‚å¯Ÿè€…æ¨¡å¼æŸ¥çœ‹è¿™ä¸ªæ“ä½œçš„æ€§èƒ½æŒ‡æ ‡ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä½ çš„å¼‚æ­¥æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fetchSomeData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ•°æ®è·å–å®Œæ¯•ï¼Œæ­¤æ—¶æ€§èƒ½æ¡ç›®å·²è¢«è®°å½•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>åœ¨ä»¥ä¸Šä¾‹å­ä¸­ï¼Œå½“ä½ çš„å¼‚æ­¥æ“ä½œå®Œæˆæ—¶ï¼Œ<code>PerformanceObserver</code> ä¼šæ•è·ä¸€ä¸ªç±»å‹ä¸º &quot;resource&quot; çš„æ€§èƒ½æ¡ç›®ï¼Œéšå³é€šè¿‡ <code>.toJSON()</code> æ–¹æ³•æŠŠè¿™ä¸ªæ¡ç›®è½¬æ¢æˆ JSON æ ¼å¼å¹¶æ‰“å°å‡ºæ¥ã€‚è¿™ä¸ª JSON å¯¹è±¡åŒ…å«äº†åƒ <code>startTime</code>, <code>duration</code>, <code>responseEnd</code> ç­‰æ€§èƒ½æŒ‡æ ‡ï¼Œå¸®åŠ©ä½ äº†è§£æ“ä½œçš„å…·ä½“è€—æ—¶æƒ…å†µã€‚</p><p>é€šè¿‡ä¸Šè¿°æ­¥éª¤ï¼Œä½ ä¸ä»…å¯ä»¥å®æ—¶ç›‘æ§åº”ç”¨ç¨‹åºä¸­ç‰¹å®šæ“ä½œçš„æ€§èƒ½çŠ¶å†µï¼Œè¿˜å¯ä»¥æ”¶é›†è¿™äº›æ•°æ®ç”¨äºé•¿æœŸæ€§èƒ½åˆ†æï¼Œè¿›è€Œä¸æ–­ä¼˜åŒ–ä½ çš„åº”ç”¨ç¨‹åºã€‚</p><h2 id="class-performanceobserver" tabindex="-1"><a class="header-anchor" href="#class-performanceobserver"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#class-performanceobserver" target="_blank" rel="noopener noreferrer">Class: PerformanceObserver</a></span></a></h2><p>å½“ç„¶ï¼Œæˆ‘å¾ˆä¹æ„å¸®åŠ©ä½ ç†è§£ Node.js ä¸­çš„ <code>PerformanceObserver</code> ç±»ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦äº†è§£ä»€ä¹ˆæ˜¯æ€§èƒ½ç›‘æµ‹ï¼ˆPerfomance Monitoringï¼‰ã€‚åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œç‰¹åˆ«æ˜¯æœåŠ¡ç«¯ä»£ç ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦çŸ¥é“æŸæ®µä»£ç è¿è¡Œçš„å¿«ä¸å¿«ï¼Œæ¶ˆè€—èµ„æºå¤šä¸å¤šã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼ŒNode.js æä¾›äº†ä¸€ä¸ªå«åš <code>perf_hooks</code> çš„æ¨¡å—ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç›‘æ§ä»£ç çš„æ€§èƒ½ã€‚</p><p>åœ¨è¿™ä¸ªæ¨¡å—ä¸­ï¼Œä¸€ä¸ªéå¸¸é‡è¦çš„ç±»å°±æ˜¯ <code>PerformanceObserver</code>ã€‚ç®€å•æ¥è¯´ï¼Œ<code>PerformanceObserver</code> ç±»ç”¨äºè§‚å¯Ÿå’Œæ¥æ”¶æ€§èƒ½åº¦é‡äº‹ä»¶ã€‚è¿™äº›äº‹ä»¶å¯èƒ½æ˜¯å„ç§ç±»å‹ï¼Œæ¯”å¦‚ HTTP è¯·æ±‚çš„è€—æ—¶ã€æ–‡ä»¶æ“ä½œçš„è€—æ—¶ç­‰ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-performanceobserver" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-performanceobserver"><span>å¦‚ä½•ä½¿ç”¨ <code>PerformanceObserver</code></span></a></h3><p>è¦ä½¿ç”¨ <code>PerformanceObserver</code>ï¼Œä½ é¦–å…ˆéœ€è¦å¼•å…¥ <code>perf_hooks</code> æ¨¡å—ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç„¶åï¼Œä½ åˆ›å»º <code>PerformanceObserver</code> çš„ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶å®šä¹‰ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚æ¯å½“æœ‰æ–°çš„æ€§èƒ½æ¡ç›®ï¼ˆperformance entryï¼‰è¢«è®°å½•æ—¶ï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°å°±ä¼šè¢«è°ƒç”¨ã€‚åœ¨å›è°ƒå‡½æ•°é‡Œï¼Œä½ å¯ä»¥å¤„ç†æˆ–è¾“å‡ºè¿™äº›æ€§èƒ½æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> observer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">disconnect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœæ­¢è§‚å¯Ÿ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼€å§‹è§‚å¯Ÿç‰¹å®šç±»å‹çš„æ€§èƒ½æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;mark&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”±ä¸Šé¢çš„ä»£ç å¯è§ï¼Œæˆ‘ä»¬é¦–å…ˆå®šä¹‰äº†ä¸€ä¸ªè§‚å¯Ÿè€…å®ä¾‹ <code>observer</code>ã€‚åœ¨å®ƒçš„å›è°ƒå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ <code>list.getEntries()</code> è·å–æ‰€æœ‰çš„æ€§èƒ½æ¡ç›®å¹¶æ‰“å°å‡ºæ¥ã€‚ç„¶åé€šè¿‡è°ƒç”¨ <code>observer.disconnect()</code> æ¥åœæ­¢è§‚å¯Ÿã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-4"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´</strong>ï¼š</p><p>å‡è®¾ä½ æƒ³çŸ¥é“æŸä¸ªå‡½æ•° <code>doSomething()</code> æ‰§è¡Œäº†å¤šä¹…ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start-doSomething&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">doSomething</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è°ƒç”¨ä½ æƒ³è¦æµ‹é‡çš„å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end-doSomething&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;doSomething&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start-doSomething&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end-doSomething&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ <code>performance.mark()</code> åˆ›å»ºäº†å¼€å§‹å’Œç»“æŸçš„æ ‡è®°ï¼Œç„¶åä½¿ç”¨ <code>performance.measure()</code> æ¥æµ‹é‡ä¸¤ä¸ªæ ‡è®°ä¹‹é—´çš„æ—¶é—´å·®ã€‚</p></li><li><p><strong>ç›‘æ§ HTTP è¯·æ±‚çš„è€—æ—¶</strong>ï¼š</p><p>å¦‚æœä½ åœ¨ Node.js åº”ç”¨ä¸­å‘é€äº† HTTP è¯·æ±‚ï¼Œå¯èƒ½æƒ³è¦ç›‘æ§è¯·æ±‚çš„è€—æ—¶ã€‚è™½ç„¶ <code>PerformanceObserver</code> ç›´æ¥ä¸èƒ½æ•è· HTTP è¯·æ±‚çš„æ€§èƒ½æ¡ç›®ï¼Œä½†ä½ å¯ä»¥åˆ©ç”¨ç±»ä¼¼çš„æœºåˆ¶æ‰‹åŠ¨æ ‡è®°å’Œæµ‹é‡ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start-request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">httpRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾è¿™æ˜¯å‘èµ· HTTP è¯·æ±‚çš„å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end-request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http-request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start-request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end-request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¤„ç†è¯·æ±‚å®Œæˆåçš„é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>åˆ†æå¼‚æ­¥æ“ä½œçš„æ€§èƒ½</strong>ï¼š</p><p>åœ¨å¤„ç†å¼‚æ­¥æ“ä½œï¼Œå¦‚æ•°æ®åº“æŸ¥è¯¢æˆ–æ–‡ä»¶è¯»å†™æ—¶ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>PerformanceObserver</code> æ¥ç›‘æ§è¿™äº›æ“ä½œçš„æ€§èƒ½ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start-dbQuery&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">db</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">query</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;SELECT * FROM table&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">results</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end-dbQuery&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dbQuery&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start-dbQuery&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end-dbQuery&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä½¿ç”¨æŸ¥è¯¢ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>é€šè¿‡è¿™äº›åŸºæœ¬çš„ä¾‹å­ï¼Œä½ åº”è¯¥èƒ½å¤Ÿå¼€å§‹ä½¿ç”¨ <code>PerformanceObserver</code> æ¥ç›‘æ§ä½ çš„ Node.js åº”ç”¨çš„æ€§èƒ½äº†ã€‚éšç€ä½ å¯¹ Node.js çš„è¿›ä¸€æ­¥å­¦ä¹ ï¼Œä½ ä¼šå‘ç°è¿˜æœ‰æ›´å¤šé«˜çº§çš„æ€§èƒ½åˆ†ææŠ€æœ¯ç­‰å¾…ä½ å»æ¢ç´¢ã€‚</p><h3 id="performanceobserver-supportedentrytypes" tabindex="-1"><a class="header-anchor" href="#performanceobserver-supportedentrytypes"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceobserversupportedentrytypes" target="_blank" rel="noopener noreferrer">PerformanceObserver.supportedEntryTypes</a></span></a></h3><p>é¦–å…ˆï¼Œäº†è§£ Node.js ä¸­çš„<code>PerformanceObserver</code>å’Œ<code>supportedEntryTypes</code>å±æ€§å¯¹äºåˆå­¦è€…æ¥è¯´å¯èƒ½ç¨æ˜¾å¤æ‚ï¼Œä½†æˆ‘ä¼šå°½é‡ç®€åŒ–è§£é‡Šã€‚</p><h3 id="performanceobserver-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#performanceobserver-ç®€ä»‹"><span>PerformanceObserver ç®€ä»‹</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œæ€§èƒ½ç›‘æµ‹æ˜¯ä¸€ä¸ªå…³é”®åŠŸèƒ½ï¼Œå°¤å…¶æ˜¯å¯¹äºæƒ³è¦ä¼˜åŒ–ä»–ä»¬åº”ç”¨ç¨‹åºæ€§èƒ½çš„å¼€å‘äººå‘˜è€Œè¨€ã€‚<code>PerformanceObserver</code>æ˜¯ä¸€ä¸ªå…è®¸ä½ æ¥æ”¶åˆ°æ€§èƒ½ç›¸å…³äº‹ä»¶çš„ APIã€‚ç®€å•æ¥è¯´ï¼Œå°±åƒä¸€ä¸ªç›‘å¬å™¨ï¼Œå½“æŒ‡å®šç±»å‹çš„æ€§èƒ½äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå®ƒå¯ä»¥æ•è·è¿™äº›äº‹ä»¶ï¼Œå¹¶æ‰§è¡Œä¸€äº›æ“ä½œï¼ˆæ¯”å¦‚è®°å½•æ—¥å¿—æˆ–è¿›ä¸€æ­¥åˆ†æï¼‰ã€‚</p><h3 id="supportedentrytypes-å±æ€§" tabindex="-1"><a class="header-anchor" href="#supportedentrytypes-å±æ€§"><span>supportedEntryTypes å±æ€§</span></a></h3><p><code>supportedEntryTypes</code>æ˜¯ä¸€ä¸ªå±æ€§ï¼Œä¸æ˜¯æ–¹æ³•ã€‚å®ƒä¼šè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„åŒ…å«äº†å½“å‰ç¯å¢ƒä¸‹<code>PerformanceObserver</code>èƒ½å¤Ÿè§‚å¯Ÿåˆ°çš„æ€§èƒ½æ¡ç›®ç±»å‹ã€‚æ¯ç§ç±»å‹ä»£è¡¨äº†ä¸åŒç§ç±»çš„æ€§èƒ½æ•°æ®ï¼Œä¾‹å¦‚ HTTP è¯·æ±‚çš„è€—æ—¶ã€ä»£ç æ‰§è¡Œæ—¶é—´ç­‰ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-3"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><h4 id="_1-æ£€æŸ¥å¯ç”¨æ€§èƒ½æ¡ç›®ç±»å‹" tabindex="-1"><a class="header-anchor" href="#_1-æ£€æŸ¥å¯ç”¨æ€§èƒ½æ¡ç›®ç±»å‹"><span>1. æ£€æŸ¥å¯ç”¨æ€§èƒ½æ¡ç›®ç±»å‹</span></a></h4><p>åœ¨å¼€å§‹ç¼–å†™æ€§èƒ½ç›‘æ§ä»£ç ä¹‹å‰ï¼Œä½ å¯èƒ½æƒ³çŸ¥é“å“ªäº›æ€§èƒ½æ¡ç›®ç±»å‹æ˜¯å¯ç”¨çš„ã€‚è¿™å¾ˆé‡è¦ï¼Œå› ä¸ºä¸åŒçš„ Node.js ç‰ˆæœ¬æˆ–è¿è¡Œç¯å¢ƒå¯èƒ½æ”¯æŒä¸åŒçš„æ€§èƒ½æ¡ç›®ç±»å‹ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨<code>supportedEntryTypes</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">supportedEntryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œè¿™æ®µä»£ç ä¼šæ‰“å°å‡ºä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­åˆ—å‡ºäº†æ‰€æœ‰å¯ç”¨çš„æ€§èƒ½æ¡ç›®ç±»å‹ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½çœ‹åˆ°<code>&#39;mark&#39;</code>, <code>&#39;measure&#39;</code>, <code>&#39;http&#39;</code>ç­‰ï¼Œè¿™å–å†³äºä½ çš„å…·ä½“ç¯å¢ƒã€‚</p><h4 id="_2-ç›‘æ§ç‰¹å®šç±»å‹çš„æ€§èƒ½æ¡ç›®" tabindex="-1"><a class="header-anchor" href="#_2-ç›‘æ§ç‰¹å®šç±»å‹çš„æ€§èƒ½æ¡ç›®"><span>2. ç›‘æ§ç‰¹å®šç±»å‹çš„æ€§èƒ½æ¡ç›®</span></a></h4><p>äº†è§£å¯ç”¨çš„æ€§èƒ½æ¡ç›®ç±»å‹åï¼Œä½ å¯ä»¥è®¾ç½®<code>PerformanceObserver</code>æ¥ç›‘è§†æ„Ÿå…´è¶£çš„ç±»å‹ã€‚å‡è®¾æˆ‘ä»¬åªå¯¹æ ‡è®°ï¼ˆ<code>mark</code>ï¼‰å’Œæµ‹é‡ï¼ˆ<code>measure</code>ï¼‰ç±»å‹çš„æ€§èƒ½æ¡ç›®æ„Ÿå…´è¶£ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> observer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;mark&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start-task&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™é‡Œæœ‰ä¸€äº›ä»£ç ä»»åŠ¡...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end-task&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;task-duration&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start-task&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end-task&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šè¿°ä»£ç åˆ›å»ºäº†ä¸€ä¸ª<code>PerformanceObserver</code>å®ä¾‹ï¼Œå¹¶æŒ‡ç¤ºå®ƒè§‚å¯Ÿæ ‡è®°å’Œæµ‹é‡ç±»å‹çš„æ€§èƒ½æ¡ç›®ã€‚å½“è¿™äº›ç±»å‹çš„æ¡ç›®è¢«è®°å½•æ—¶ï¼Œå®ƒä»¬ä¼šè¢«ä¼ é€’ç»™<code>PerformanceObserver</code>çš„å›è°ƒå‡½æ•°ï¼Œå¹¶è¢«æ‰“å°å‡ºæ¥ã€‚</p><p>å¸Œæœ›ä»¥ä¸Šè§£é‡Šå’Œç¤ºä¾‹èƒ½å¤Ÿå¸®åŠ©ä½ ç†è§£<code>PerformanceObserver</code>å’Œ<code>supportedEntryTypes</code>å±æ€§åœ¨ Node.js ä¸­çš„ä½œç”¨ä¸åº”ç”¨ã€‚</p><h3 id="new-performanceobserver-callback" tabindex="-1"><a class="header-anchor" href="#new-performanceobserver-callback"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#new-performanceobservercallback" target="_blank" rel="noopener noreferrer">new PerformanceObserver(callback)</a></span></a></h3><p>ç†è§£ Node.js ä¸­çš„<code>PerformanceObserver</code>é¦–å…ˆè¦äº†è§£ä¸€äº›èƒŒæ™¯ã€‚</p><p>åœ¨ç¼–ç¨‹ä¸­ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠåˆ° Web å’ŒæœåŠ¡å™¨ç«¯å¼€å‘æ—¶ï¼Œæ€§èƒ½ç›‘æµ‹ï¼ˆPerformance Monitoringï¼‰æ˜¯ä¸€ä¸ªé‡è¦çš„æ–¹é¢ã€‚å®ƒå¸®åŠ©æˆ‘ä»¬äº†è§£ä»£ç çš„è¿è¡Œæ•ˆç‡ï¼Œæ¯”å¦‚æœ‰äº›ä»£ç å—éœ€è¦å¤šé•¿æ—¶é—´æ‰èƒ½å®Œæˆï¼Œæˆ–è€…æŸä¸ªåŠŸèƒ½çš„å“åº”æ—¶é—´æœ‰å¤šå¿«ã€‚äº†è§£è¿™äº›ä¿¡æ¯åï¼Œæˆ‘ä»¬å¯ä»¥ä¼˜åŒ–ä»£ç ï¼Œæå‡ç”¨æˆ·ä½“éªŒæˆ–æœåŠ¡å™¨å¤„ç†èƒ½åŠ›ã€‚</p><p>Node.js é€šè¿‡å¼•å…¥<code>PerformanceObserver</code>ç±»ï¼Œæä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„ API æ¥è§‚å¯Ÿå’Œè·å–ç¨‹åºæ€§èƒ½ç›¸å…³çš„æ•°æ®ï¼Œä»è€Œå¸®åŠ©æˆ‘ä»¬è¿›è¡Œæ€§èƒ½åˆ†æå’Œè°ƒè¯•ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-2" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-2"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p><code>PerformanceObserver</code>æ˜¯ Node.js ä¸­ç”¨äºæ€§èƒ½ç›‘è§†çš„æ¥å£ä¹‹ä¸€ï¼Œä½äº<code>perf_hooks</code>æ¨¡å—ä¸‹ã€‚ä½ å¯ä»¥é€šè¿‡è¿™ä¸ªæ¥å£è®¢é˜…å„ç§æ€§èƒ½äº‹ä»¶ï¼Œæ¯”å¦‚ HTTP è¯·æ±‚çš„è€—æ—¶ã€å‡½æ•°æ‰§è¡Œæ—¶é—´ç­‰ï¼Œå¹¶ä¸”åœ¨è¿™äº›äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œè·å¾—è¯¦ç»†çš„æ€§èƒ½æŒ‡æ ‡æ•°æ®ã€‚</p><h3 id="ä½¿ç”¨æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æ–¹å¼"><span>ä½¿ç”¨æ–¹å¼</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªè§‚å¯Ÿå™¨å®ä¾‹ï¼Œä¸“æ³¨äºç›‘æ§ç‰¹å®šç±»å‹çš„æ€§èƒ½æ¡ç›®ï¼Œä¾‹å¦‚ï¼š&#39;measure&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> observer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å½“æœ‰æ–°çš„æ€§èƒ½æ¡ç›®è¢«è§‚å¯Ÿåˆ°æ—¶ï¼Œæ‰§è¡Œæ­¤å›è°ƒå‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Name: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, Duration: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®©è§‚å¯Ÿå™¨å¼€å§‹å·¥ä½œï¼Œå‚æ•°å¯ä»¥æŒ‡å®šè¦è§‚å¯Ÿçš„æ€§èƒ½æ¡ç›®ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨performance.mark()å’Œperformance.measure()æ¥åˆ›å»ºæ€§èƒ½æ ‡è®°å’Œæµ‹é‡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™é‡Œæœ‰ä¸€æ®µè€—æ—¶çš„æ“ä½œ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹é‡ä»&#39;start&#39;åˆ°&#39;end&#39;çš„æŒç»­æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;My Special Measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨ä¾‹å­-12" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-12"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>ç›‘æ§ HTTP è¯·æ±‚å“åº”æ—¶é—´</strong>ï¼šå¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåŸºäº Node.js çš„ Web æœåŠ¡å™¨ï¼Œä½ å¯èƒ½æƒ³è¦ç›‘æ§å¤„ç†æ¯ä¸ª HTTP è¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚é€šè¿‡åœ¨æ”¶åˆ°è¯·æ±‚æ—¶å’Œè¯·æ±‚å¤„ç†å®Œæ¯•æ—¶åˆ†åˆ«æ ‡è®°ï¼Œå¹¶åˆ©ç”¨<code>PerformanceObserver</code>æ¥è¯»å–è¿™ä¹‹é—´çš„æ—¶é—´å·®ï¼Œä¾¿å¯è®¡ç®—å‡ºå¤„ç†æ—¶é—´ã€‚</p></li><li><p><strong>æ€§èƒ½ç“¶é¢ˆè¯Šæ–­</strong>ï¼šå½“ä½ çš„ Node.js åº”ç”¨å‡ºç°æ€§èƒ½é—®é¢˜æ—¶ï¼Œæ¯”å¦‚å“åº”å˜æ…¢æˆ–å¤„ç†æ•ˆç‡ä½ä¸‹ï¼Œä½ å¯ä»¥åˆ©ç”¨<code>PerformanceObserver</code>æ¥ç›‘æ§å…³é”®ä»£ç æ®µçš„æ‰§è¡Œæ—¶é—´ï¼Œä»è€Œè¯†åˆ«å‡ºæ€§èƒ½ç“¶é¢ˆæ‰€åœ¨ã€‚</p></li><li><p><strong>API è°ƒç”¨ç›‘æ§</strong>ï¼šå¯¹äºä¾èµ–å¤–éƒ¨ API è°ƒç”¨çš„åº”ç”¨ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>PerformanceObserver</code>æ¥ç›‘æ§æ¯æ¬¡ API è°ƒç”¨çš„è€—æ—¶ï¼Œè¿›è€Œåˆ†æä¾èµ–æœåŠ¡çš„æ€§èƒ½è¡¨ç°ã€‚</p></li></ol><p>æ€»ç»“èµ·æ¥ï¼Œ<code>PerformanceObserver</code>ä¸º Node.js åº”ç”¨çš„æ€§èƒ½ä¼˜åŒ–æä¾›äº†ä¸€ä¸ªå¼ºæœ‰åŠ›çš„å·¥å…·ï¼Œé€šè¿‡ç²¾ç¡®ç›‘æ§å’Œåˆ†æä¸åŒæ“ä½œçš„æ€§èƒ½æ•°æ®ï¼Œå¼€å‘è€…å¯ä»¥æ›´å¥½åœ°ç†è§£è‡ªå·±çš„åº”ç”¨ï¼Œå¹¶é‡‡å–ç›¸åº”æªæ–½æå‡æ€§èƒ½ã€‚</p><h3 id="performanceobserver-disconnect" tabindex="-1"><a class="header-anchor" href="#performanceobserver-disconnect"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceobserverdisconnect" target="_blank" rel="noopener noreferrer">performanceObserver.disconnect()</a></span></a></h3><p>Node.js ä¸­çš„ <code>performanceObserver.disconnect()</code> æ–¹æ³•æ˜¯ä¸æ€§èƒ½ç›‘æµ‹ç›¸å…³çš„ä¸€ä¸ªåŠŸèƒ½ã€‚åœ¨è§£é‡Šè¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆäº†è§£ä¸€äº›èƒŒæ™¯ä¿¡æ¯ã€‚</p><h3 id="node-js-å’Œæ€§èƒ½ç›‘æµ‹" tabindex="-1"><a class="header-anchor" href="#node-js-å’Œæ€§èƒ½ç›‘æµ‹"><span>Node.js å’Œæ€§èƒ½ç›‘æµ‹</span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 JavaScript å¼•æ“çš„è¿è¡Œæ—¶ï¼Œä½¿å¾—åœ¨æœåŠ¡å™¨ç«¯å¯ä»¥è¿è¡Œ JavaScriptã€‚åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œç›‘æ§åº”ç”¨ç¨‹åºçš„æ€§èƒ½éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒå¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜å‘ç°ä»£ç ä¸­å¯èƒ½çš„ç“¶é¢ˆæˆ–è€…æ€§èƒ½é—®é¢˜ã€‚Node.js æä¾›äº†ä¸€ä¸ªæ¨¡å—å«åš <code>perf_hooks</code>ï¼ˆæ€§èƒ½é’©å­ï¼‰ï¼Œå…è®¸ä½ ç›‘æ§ä¸åŒç±»å‹çš„æ€§èƒ½æŒ‡æ ‡ã€‚</p><h3 id="performanceobserver" tabindex="-1"><a class="header-anchor" href="#performanceobserver"><span>PerformanceObserver</span></a></h3><p><code>PerformanceObserver</code> æ˜¯ <code>perf_hooks</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªç±»ï¼Œå…è®¸ä½ æ³¨å†Œä¸€ä¸ªè§‚å¯Ÿè€…æ¥å¼‚æ­¥åœ°æ¥æ”¶å…³äºç‰¹å®šæ€§èƒ½æŒ‡æ ‡çš„é€šçŸ¥ã€‚å½“è¢«ç›‘è§†çš„äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œè¿™ä¸ªè§‚å¯Ÿè€…ä¼šè¢«è°ƒç”¨ã€‚</p><h3 id="ä½¿ç”¨-performanceobserver-disconnect" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-performanceobserver-disconnect"><span>ä½¿ç”¨ performanceObserver.disconnect()</span></a></h3><p>å½“ä½ ä¸å†éœ€è¦æ¥æ”¶æ€§èƒ½æ¡ç›®çš„é€šçŸ¥æ—¶ï¼Œå¯ä»¥è°ƒç”¨ <code>performanceObserver.disconnect()</code> æ¥åœæ­¢è§‚å¯Ÿã€‚è¿™æ„å‘³ç€ï¼Œä¹‹åçš„æ€§èƒ½äº‹ä»¶å°†ä¸ä¼šå¼•èµ·è§‚å¯Ÿè€…çš„å›è°ƒè¢«è§¦å‘ã€‚</p><h4 id="ä¸¾ä¾‹è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#ä¸¾ä¾‹è¯´æ˜"><span>ä¸¾ä¾‹è¯´æ˜</span></a></h4><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨ç›‘æ§ä¸€ä¸ª HTTP æœåŠ¡å™¨çš„å“åº”æ—¶é—´ï¼Œä»¥ç¡®ä¿å®ƒè¿…é€Ÿå“åº”è¯·æ±‚ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>PerformanceObserver</code> æ¥æ”¶é›†æœ‰å…³ HTTP è¯·æ±‚å¤„ç†æ—¶é—´çš„æ€§èƒ½æ¡ç›®ï¼Œå¹¶åœ¨å®Œæˆè¶³å¤Ÿçš„æ ·æœ¬åˆ†æååœæ­¢æ”¶é›†æ–°çš„æ€§èƒ½æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ€§èƒ½è§‚å¯Ÿè€…æ¥ç›‘æµ‹æ‰€æœ‰çš„æ€§èƒ½æ¡ç›®äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> observer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºæ€§èƒ½æ¡ç›®ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] }); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è§‚å¯Ÿâ€œmeasureâ€ç±»å‹çš„æ€§èƒ½æ¡ç›®</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®°å½•æ€§èƒ½çš„å¼€å§‹æ ‡è®°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªç®€å•çš„HTTPæœåŠ¡å™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">http</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å‡è®¾æ­¤å¤„è¿›è¡Œä¸€äº›è¯·æ±‚å¤„ç†</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // è®°å½•æ€§èƒ½çš„ç»“æŸæ ‡è®°å¹¶è®¡ç®—ä¸¤ä¸ªæ ‡è®°ä¹‹é—´çš„æ—¶é—´å·®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Request Handling Time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Server running at http://127.0.0.1:3000/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬åªæƒ³æ”¶é›†å‰100æ¬¡è¯·æ±‚çš„æ€§èƒ½æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> count</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">callback</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">count</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">disconnect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ–­å¼€è¿æ¥ï¼Œä¸å†æ”¶é›†æ€§èƒ½æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Stopped observing performance entries.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ¯å½“ HTTP æœåŠ¡å™¨å¤„ç†å®Œä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œæˆ‘ä»¬éƒ½ä¼šè®°å½•ä¸€æ¬¡æ€§èƒ½æµ‹é‡ï¼ˆä»æ ‡è®°â€œAâ€åˆ°æ ‡è®°â€œBâ€çš„æ—¶é—´ï¼‰ã€‚<code>PerformanceObserver</code> è¢«è®¾ç½®ä¸ºç›‘å¬è¿™äº›æµ‹é‡ç»“æœï¼Œå¹¶å°†å®ƒä»¬è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚é€šè¿‡è®¾ç½®ä¸€ä¸ªè®¡æ•°å™¨ï¼Œå½“è¾¾åˆ° 100 æ¬¡è¯·æ±‚åï¼Œæˆ‘ä»¬è°ƒç”¨ <code>observer.disconnect()</code> æ–¹æ³•æ¥åœæ­¢è¿›ä¸€æ­¥æ”¶é›†æ€§èƒ½æ•°æ®ã€‚</p><p>è¿™åªæ˜¯ä½¿ç”¨ <code>performanceObserver.disconnect()</code> çš„ä¸€ä¸ªå®é™…ç¤ºä¾‹ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µå¯¹ç›‘æ§é€»è¾‘å’Œåœæ­¢æ¡ä»¶è¿›è¡Œè°ƒæ•´ã€‚</p><h3 id="performanceobserver-observe-options" tabindex="-1"><a class="header-anchor" href="#performanceobserver-observe-options"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceobserverobserveoptions" target="_blank" rel="noopener noreferrer">performanceObserver.observe(options)</a></span></a></h3><p>Node.js ä¸­çš„ <code>performanceObserver.observe(options)</code> æ˜¯ <code>perf_hooks</code> æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºç›‘è§†å’Œæ”¶é›†æ€§èƒ½ç›¸å…³çš„æ•°æ®ã€‚ä¸ºäº†æ›´å¥½åœ°è§£é‡Šå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè®©æˆ‘ä»¬é¦–å…ˆäº†è§£ä¸€äº›åŸºç¡€æ¦‚å¿µï¼Œç„¶åé€šè¿‡å®ä¾‹æ¥åŠ æ·±ç†è§£ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-3" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-3"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><ol><li><p><strong>Performance Observer</strong>: Performance Observer API å…è®¸ä½ æ¥æ”¶åˆ°æŸç§ç±»å‹çš„æ€§èƒ½æ¡ç›®çš„é€šçŸ¥ã€‚è¿™äº›æ€§èƒ½æ¡ç›®å¯ä»¥æ˜¯æµ‹é‡çš„æŒ‡æ ‡ï¼Œæ¯”å¦‚ HTTP è¯·æ±‚çš„è€—æ—¶ï¼Œæ–‡ä»¶æ“ä½œçš„è€—æ—¶ç­‰ã€‚</p></li><li><p><strong>Options</strong>: è¿™æ˜¯ä¼ é€’ç»™ <code>observe</code> æ–¹æ³•çš„å‚æ•°ï¼Œç”¨äºæŒ‡å®šä½ æƒ³è¦ç›‘æ§å“ªäº›ç±»å‹çš„æ€§èƒ½æ¡ç›®ã€‚</p></li><li><p><strong>perf_hooks</strong>: Node.js ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œæä¾›äº†å·¥å…·æ¥è§‚å¯Ÿå¯¹ç³»ç»Ÿæ€§èƒ½æœ‰å½±å“çš„äº‹ä»¶ã€‚</p></li></ol><h3 id="ä½¿ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹-1"><span>ä½¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œå¹¶ä¸”æƒ³è¦ç›‘æ§æ‰€æœ‰çš„ HTTP è¯·æ±‚å¤„ç†æ—¶é—´ï¼Œä»¥ç¡®ä¿ä½ çš„æœåŠ¡å“åº”é€Ÿåº¦å¿«é€Ÿã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>performanceObserver.observe</code> æ¥å®ç°è¿™ä¸€ç›®æ ‡ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><h4 id="æ­¥éª¤-1-å¼•å…¥å¿…éœ€çš„æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-1-å¼•å…¥å¿…éœ€çš„æ¨¡å—"><span>æ­¥éª¤ 1ï¼šå¼•å…¥å¿…éœ€çš„æ¨¡å—</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ­¥éª¤-2-è®¾ç½®-performance-observer" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-2-è®¾ç½®-performance-observer"><span>æ­¥éª¤ 2ï¼šè®¾ç½® Performance Observer</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> observer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>PerformanceObserver</code> ç›‘å¬äº†ç±»å‹ä¸º <code>&#39;measure&#39;</code> çš„æ€§èƒ½æ¡ç›®ã€‚æ¯å½“è°ƒç”¨ <code>performance.measure()</code> æ–¹æ³•æ—¶ï¼Œéƒ½ä¼šè§¦å‘å›è°ƒå‡½æ•°ï¼Œæ‰“å°å‡ºæ€§èƒ½æµ‹é‡ç»“æœã€‚</p><h4 id="æ­¥éª¤-3-åˆ›å»ºæœåŠ¡å™¨å¹¶ä½¿ç”¨-performance-mark-å’Œ-performance-measure" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-3-åˆ›å»ºæœåŠ¡å™¨å¹¶ä½¿ç”¨-performance-mark-å’Œ-performance-measure"><span>æ­¥éª¤ 3ï¼šåˆ›å»ºæœåŠ¡å™¨å¹¶ä½¿ç”¨ <code>performance.mark()</code> å’Œ <code>performance.measure()</code></span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">http</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å‡è®¾è¿™é‡Œæœ‰ä¸€äº›å¼‚æ­¥æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;My Special Request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8080</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°æœåŠ¡å™¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>performance.mark(&#39;A&#39;)</code> å’Œ <code>performance.mark(&#39;B&#39;)</code> åœ¨è¯·æ±‚å¤„ç†å¼€å§‹å’Œç»“æŸæ—¶åˆ†åˆ«è®¾ç½®äº†æ ‡è®°ã€‚ä¹‹åï¼Œä½¿ç”¨ <code>performance.measure(&#39;My Special Request&#39;, &#39;A&#39;, &#39;B&#39;)</code> æ¥è®¡ç®—ä»æ ‡è®° <code>&#39;A&#39;</code> åˆ°æ ‡è®° <code>&#39;B&#39;</code> ä¹‹é—´çš„æ—¶é—´å·®ï¼Œä¹Ÿå°±æ˜¯å¤„ç†è¯·æ±‚æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚<code>PerformanceObserver</code> å°±æ˜¯ç”¨æ¥æ•è·è¿™æ¬¡æµ‹é‡ï¼Œå¹¶åœ¨æ§åˆ¶å°è¾“å‡ºç»“æœçš„ã€‚</p><h3 id="æ€»ç»“-9" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-9"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡ <code>performanceObserver.observe(options)</code>ï¼Œä½ å¯ä»¥è½»æ¾åœ°ç›‘æ§åº”ç”¨ä¸­ç‰¹å®šæ“ä½œçš„æ€§èƒ½ã€‚æ— è®ºæ˜¯ HTTP è¯·æ±‚ã€æ•°æ®åº“æŸ¥è¯¢è¿˜æ˜¯ä»»ä½•è€—æ—¶çš„æ“ä½œï¼Œä½ éƒ½å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼æ¥è·å–æ€§èƒ½æ•°æ®ï¼Œä»è€Œè¿›ä¸€æ­¥ä¼˜åŒ–ä½ çš„åº”ç”¨æ€§èƒ½ã€‚</p><h2 id="class-performanceobserverentrylist" tabindex="-1"><a class="header-anchor" href="#class-performanceobserverentrylist"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#class-performanceobserverentrylist" target="_blank" rel="noopener noreferrer">Class: PerformanceObserverEntryList</a></span></a></h2><p>å½“ç„¶ï¼Œè®©æˆ‘ä»¬æ·±å…¥äº†è§£ Node.js ä¸­çš„ <code>PerformanceObserverEntryList</code> ç±»åŠå…¶åœ¨å®é™…å¼€å‘ä¸­çš„åº”ç”¨ã€‚</p><h3 id="performanceobserverentrylist-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#performanceobserverentrylist-ç®€ä»‹"><span>PerformanceObserverEntryList ç®€ä»‹</span></a></h3><p>Node.js çš„æ€§èƒ½é’©å­ï¼ˆperf_hooksï¼‰æ¨¡å—æä¾›äº†ä¸€å¥—æœºåˆ¶ï¼Œå…è®¸ä½ ç›‘è§†å’Œæµ‹é‡ä»£ç çš„æ€§èƒ½ã€‚å…¶ä¸­ï¼Œ<code>PerformanceObserverEntryList</code> ç±»æ˜¯è¿™ä¸ªæ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒè¢«è®¾è®¡ä¸ºä¸ <code>PerformanceObserver</code> å¯¹è±¡ä¸€èµ·ä½¿ç”¨ï¼Œä»¥æ”¶é›†å’Œå¤„ç†ç‰¹å®šç±»å‹çš„æ€§èƒ½æ¡ç›®æ•°æ®ã€‚</p><p>ç®€å•æ¥è¯´ï¼Œ<code>PerformanceObserverEntryList</code> å¯¹è±¡åŒ…å«äº†ç”± <code>PerformanceObserver</code> æ”¶é›†çš„æ€§èƒ½æ¡ç›®ï¼ˆperformance entriesï¼‰ã€‚å½“ä½ æƒ³è¦è§‚å¯Ÿå’Œåˆ†æåº”ç”¨ç¨‹åºåœ¨æ‰§è¡ŒæŸäº›æ“ä½œæ—¶çš„æ€§èƒ½ï¼ˆå¦‚ HTTP è¯·æ±‚ã€æ–‡ä»¶ç³»ç»Ÿæ“ä½œç­‰ï¼‰ï¼Œè¿™äº›åŠŸèƒ½å°±å˜å¾—éå¸¸æœ‰ç”¨ã€‚</p><h3 id="ä¸»è¦æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#ä¸»è¦æ–¹æ³•"><span>ä¸»è¦æ–¹æ³•</span></a></h3><p><code>PerformanceObserverEntryList</code> æä¾›äº†å‡ ä¸ªä¸»è¦æ–¹æ³•æ¥æ“ä½œå’Œè®¿é—®æ€§èƒ½æ¡ç›®ï¼š</p><ul><li><strong>getEntries()</strong>: è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«æ‰€æœ‰å·²ç»è¢« observer æ”¶é›†çš„æ€§èƒ½æ¡ç›®ã€‚</li><li><strong>getEntriesByType(type)</strong>: è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«æ‰€æœ‰æŒ‡å®šç±»å‹çš„æ€§èƒ½æ¡ç›®ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ åªå¯¹æµ‹é‡ HTTP è¯·æ±‚çš„æ€§èƒ½æ„Ÿå…´è¶£ï¼Œå¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³•ä»…è·å–é‚£äº›ç±»å‹çš„æ¡ç›®ã€‚</li><li><strong>getEntriesByName(name, type)</strong>: è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«æ‰€æœ‰æŒ‡å®šåç§°ï¼ˆå’Œå¯é€‰çš„ç±»å‹ï¼‰çš„æ€§èƒ½æ¡ç›®ã€‚è¿™å…è®¸ä½ æ›´ç²¾ç¡®åœ°é€‰æ‹©ç‰¹å®šçš„æ€§èƒ½æ¡ç›®è¿›è¡Œåˆ†æã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-13" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-13"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª web åº”ç”¨ï¼Œå¹¶ä¸”ä½ æƒ³ç›‘è§†æœåŠ¡å™¨å¤„ç†è¯·æ±‚çš„æ€§èƒ½ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨ <code>PerformanceObserver</code> å’Œ <code>PerformanceObserverEntryList</code> æ¥å®ç°è¿™ä¸€ç‚¹çš„æ­¥éª¤ï¼š</p><ol><li><p><strong>å¼•å…¥ perf_hooks æ¨¡å—</strong>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><strong>è®¾ç½® PerformanceObserver ç›‘å¬ HTTP è¯·æ±‚çš„æ€§èƒ½æ¡ç›®</strong>:</p><p>è¿™é‡Œå‡è®¾ä½ å…³å¿ƒçš„æ€§èƒ½æ¡ç›®ç±»å‹ä¸º &quot;http&quot;ï¼ˆæ³¨æ„ï¼šå®é™…ä¸Š &quot;http&quot; ç±»å‹å–å†³äºä½ å¦‚ä½•å®šä¹‰æ€§èƒ½æ ‡è®°ï¼‰ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Time taken for </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ ‡è®°æ€§èƒ½æµ‹é‡ç‚¹</strong>:</p><p>åœ¨å¤„ç† HTTP è¯·æ±‚çš„é€»è¾‘ä¸­ï¼Œä½ å¯èƒ½æƒ³è¦æµ‹é‡ä»æ”¶åˆ°è¯·æ±‚åˆ°å‘é€å“åº”çš„æ€»æ—¶é—´ã€‚ä½ å¯ä»¥åœ¨è¯·æ±‚å¤„ç†æµç¨‹çš„å¼€å§‹å’Œç»“æŸåˆ†åˆ«ä½¿ç”¨ <code>performance.mark()</code> æ¥åˆ›å»ºæ€§èƒ½æ ‡è®°ï¼Œå¹¶ä½¿ç”¨ <code>performance.measure()</code> æ¥è®°å½•ä¸¤ä¸ªæ ‡è®°ä¹‹é—´çš„æŒç»­æ—¶é—´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> handleRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¤„ç†è¯·æ±‚...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Request Handle&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Done&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æŸ¥çœ‹æ€§èƒ½æ•°æ®</strong>:</p><p>å½“è¯·æ±‚è¢«å¤„ç†æ—¶ï¼Œä½ è®¾ç½®çš„ <code>PerformanceObserver</code> ä¼šè‡ªåŠ¨æ•è·åä¸º &quot;Request Handle&quot; çš„æ€§èƒ½æµ‹é‡ï¼Œå¹¶é€šè¿‡æ§åˆ¶å°è¾“å‡ºå…¶æŒç»­æ—¶é—´ã€‚</p></li></ol><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥è½»æ¾ç›‘è§†å¹¶åˆ†æä½ çš„åº”ç”¨ç¨‹åºåœ¨å¤„ç†å„ç§ä»»åŠ¡æ—¶çš„æ€§èƒ½ã€‚è¿™ä¸ä»…é™äº HTTP è¯·æ±‚å¤„ç†ï¼ŒåŒæ ·çš„æ–¹æ³•ä¹Ÿå¯ä»¥åº”ç”¨äºæ•°æ®åº“æŸ¥è¯¢ã€æ–‡ä»¶è¯»å†™æ“ä½œæˆ–ä»»ä½•ä½ å¸Œæœ›ç›‘æ§çš„ä»»åŠ¡ã€‚</p><h3 id="performanceobserverentrylist-getentries" tabindex="-1"><a class="header-anchor" href="#performanceobserverentrylist-getentries"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceobserverentrylistgetentries" target="_blank" rel="noopener noreferrer">performanceObserverEntryList.getEntries()</a></span></a></h3><p>Node.js ä¸­çš„ <code>performanceObserverEntryList.getEntries()</code> æ˜¯ä¸€ç§å·¥å…·ï¼Œå®ƒå±äº Node.js çš„æ€§èƒ½é’©å­ï¼ˆPerformance Hooksï¼‰API çš„ä¸€éƒ¨åˆ†ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸æ‚¨è·å–å’Œåˆ†æç¨‹åºè¿è¡Œæ—¶çš„æ€§èƒ½æ•°æ®ã€‚ç†è§£è¿™ä¸ªæ¦‚å¿µå¯¹äºä¼˜åŒ–åº”ç”¨å’Œè¯Šæ–­æ€§èƒ½é—®é¢˜éå¸¸æœ‰å¸®åŠ©ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-4" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-4"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>é¦–å…ˆï¼Œ<code>PerformanceObserverEntryList</code> æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒåŒ…å«äº†ä¸€ç³»åˆ—çš„æ€§èƒ½æ¡ç›®ï¼ˆperformance entriesï¼‰ã€‚è¿™äº›æ€§èƒ½æ¡ç›®æ˜¯å…³äºæ‚¨çš„ Node.js åº”ç”¨è¿è¡ŒæœŸé—´å‘ç”Ÿçš„ç‰¹å®šäº‹ä»¶çš„æ•°æ®ï¼Œæ¯”å¦‚ HTTP è¯·æ±‚ã€æ–‡ä»¶è¯»å†™æ“ä½œæˆ–è€…æ˜¯æ›´ä½çº§çš„ç³»ç»Ÿè°ƒç”¨ç­‰ã€‚é€šè¿‡åˆ†æè¿™äº›æ•°æ®ï¼Œå¼€å‘è€…å¯ä»¥å¯¹åº”ç”¨çš„æ€§èƒ½ç“¶é¢ˆæœ‰æ‰€äº†è§£ï¼Œå¹¶è¿›è€Œè¿›è¡Œä¼˜åŒ–ã€‚</p><p><code>getEntries()</code> æ–¹æ³•å°±æ˜¯ç”¨æ¥è·å–è¿™äº›æ€§èƒ½æ¡ç›®çš„åˆ—è¡¨ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-14" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-14"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>ç›‘æ§ HTTP è¯·æ±‚çš„å¤„ç†æ—¶é—´</strong>ï¼šå‡è®¾ä½ æ­£åœ¨è¿è¡Œä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œä½ æƒ³è¦ç›‘æ§å¤„ç†æ¯ä¸ª HTTP è¯·æ±‚éœ€è¦å¤šé•¿æ—¶é—´ã€‚ä½ å¯ä»¥åˆ©ç”¨<code>performanceObserverEntryList.getEntries()</code>æ¥è·å–è¿™æ–¹é¢çš„æ€§èƒ½æ¡ç›®ï¼Œå¹¶åˆ†æå¹³å‡å¤„ç†æ—¶é—´ï¼Œä»è€Œæ‰¾å‡ºæ˜¯å¦å­˜åœ¨æ€§èƒ½ç“¶é¢ˆã€‚</p></li><li><p><strong>æ–‡ä»¶æ“ä½œçš„æ€§èƒ½åˆ†æ</strong>ï¼šå¦‚æœä½ çš„åº”ç”¨æ¶‰åŠåˆ°é¢‘ç¹çš„æ–‡ä»¶è¯»å†™æ“ä½œï¼Œä½ å¯èƒ½æƒ³çŸ¥é“è¿™äº›æ“ä½œå ç”¨äº†å¤šå°‘æ—¶é—´ï¼Œä»¥åŠå“ªä¸€éƒ¨åˆ†æ“ä½œæœ€è€—æ—¶ã€‚é€šè¿‡æ”¶é›†å’Œåˆ†ææ–‡ä»¶æ“ä½œç›¸å…³çš„æ€§èƒ½æ¡ç›®ï¼Œä½ å¯ä»¥ä¼˜åŒ–é‚£äº›å½±å“æ€§èƒ½çš„æ“ä½œã€‚</p></li><li><p><strong>å¾®æœåŠ¡ä¹‹é—´è°ƒç”¨çš„æ€§èƒ½ç›‘æ§</strong>ï¼šåœ¨ä¸€ä¸ªç”±å¤šä¸ªå¾®æœåŠ¡ç»„æˆçš„å¤§å‹åº”ç”¨ä¸­ï¼Œä¸åŒå¾®æœåŠ¡ä¹‹é—´çš„è°ƒç”¨å¯èƒ½ä¼šæˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚ä½¿ç”¨<code>performanceObserverEntryList.getEntries()</code>æ”¶é›†å…³äºè¿™äº›è°ƒç”¨çš„æ€§èƒ½æ•°æ®ï¼Œå¯ä»¥å¸®åŠ©ä½ è¯†åˆ«å¹¶ä¼˜åŒ–æ…¢æŸ¥è¯¢ã€‚</p></li></ol><h3 id="å¦‚ä½•ä½¿ç”¨-7" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-7"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨ Node.js åº”ç”¨ä¸­ä½¿ç”¨<code>performanceObserverEntryList.getEntries()</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ€§èƒ½è§‚å¯Ÿè€…ï¼Œç”¨æ¥æ”¶é›†æ€§èƒ½æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è·å–æ‰€æœ‰æ€§èƒ½æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œå°†æ‰“å°å‡ºæ‰€æœ‰æ•è·åˆ°çš„æ€§èƒ½æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è§‚å¯Ÿæ‰€æœ‰ç±»å‹çš„æ€§èƒ½æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;mark&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ‡è®°èµ·ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿä¸€äº›è¦è¢«æµ‹é‡çš„æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ ‡è®°ç»ˆç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹é‡ä¸¤ä¸ªæ ‡è®°ä¹‹é—´çš„æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;My Special Measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å› ä¸ºä¸Šé¢å®šä¹‰çš„æ€§èƒ½è§‚å¯Ÿè€…ä¼šè‡ªåŠ¨æ”¶é›†è¿™äº›æ ‡è®°å’Œæµ‹é‡ç»“æœï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨ getEntries()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿäº†ä¸€ä¸ªç®€å•çš„æ“ä½œï¼ˆé€šè¿‡<code>setTimeout</code>ï¼‰ï¼Œå¹¶ä½¿ç”¨<code>performance.mark</code>æ¥æ ‡è®°èµ·å§‹ç‚¹å’Œç»“æŸç‚¹ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨<code>performance.measure</code>æ¥æµ‹é‡è¿™ä¸¤ç‚¹ä¹‹é—´çš„æ—¶é—´ã€‚æˆ‘ä»¬åˆ›å»ºçš„æ€§èƒ½è§‚å¯Ÿè€…ï¼ˆ<code>PerformanceObserver</code>ï¼‰ä¼šè‡ªåŠ¨æ•è·è¿™äº›æµ‹é‡ç»“æœï¼Œå¹¶ä½¿æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>list.getEntries()</code>è·å–åˆ°å®ƒä»¬ã€‚</p><p>æ€»ä¹‹ï¼Œ<code>performanceObserverEntryList.getEntries()</code>æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå®ƒèƒ½å¸®åŠ©ä½ ç†è§£å’Œä¼˜åŒ–ä½ çš„ Node.js åº”ç”¨çš„æ€§èƒ½ã€‚é€šè¿‡å®é™…ä¾‹å­çš„åº”ç”¨ï¼Œä½ å¯ä»¥æ›´å®¹æ˜“åœ°è¯†åˆ«å‡ºæ€§èƒ½ç“¶é¢ˆå¹¶é‡‡å–æªæ–½è¿›è¡Œä¼˜åŒ–ã€‚</p><h3 id="performanceobserverentrylist-getentriesbyname-name-type" tabindex="-1"><a class="header-anchor" href="#performanceobserverentrylist-getentriesbyname-name-type"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceobserverentrylistgetentriesbynamename-type" target="_blank" rel="noopener noreferrer">performanceObserverEntryList.getEntriesByName(name[, type])</a></span></a></h3><p>Node.js ä¸­çš„<code>performanceObserverEntryList.getEntriesByName(name[, type])</code>æ˜¯ä¸€ä¸ªç”¨äºè·å–æ€§èƒ½æ¡ç›®åˆ—è¡¨çš„æ–¹æ³•ï¼Œå®ƒå±äºæ€§èƒ½é’©å­ï¼ˆPerformance Hooksï¼‰APIã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ æ ¹æ®æŒ‡å®šçš„åç§°å’Œç±»å‹ï¼ˆå¯é€‰ï¼‰æ£€ç´¢ä¸€ä¸ªæˆ–å¤šä¸ªæ€§èƒ½æ¡ç›®ã€‚å…ˆæ¥åˆ†è§£ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•çš„ç»„æˆéƒ¨åˆ†ï¼Œå†é€šè¿‡ä¾‹å­åŠ æ·±ç†è§£ã€‚</p><h3 id="è§£é‡Š-2" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-2"><span>è§£é‡Š</span></a></h3><ul><li><p><strong>performanceObserverEntryList</strong>: è¿™æ˜¯ä¸€ç§åˆ—è¡¨ï¼ŒåŒ…å«äº†ä»<code>PerformanceObserver</code>å¯¹è±¡æ”¶é›†åˆ°çš„æ€§èƒ½æ¡ç›®ï¼ˆentriesï¼‰ã€‚å½“ä½ åˆ›å»ºä¸€ä¸ª<code>PerformanceObserver</code>å¹¶å¼€å§‹è§‚å¯Ÿç‰¹å®šç±»å‹çš„æ€§èƒ½åº¦é‡æ—¶ï¼Œç¬¦åˆæ¡ä»¶çš„æ€§èƒ½æ¡ç›®ä¼šè¢«æ·»åŠ åˆ°è¿™ä¸ªåˆ—è¡¨ä¸­ã€‚</p></li><li><p><strong>.getEntriesByName(name[, type])</strong>: è¿™æ˜¯<code>performanceObserverEntryList</code>ä¸Šçš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºæŒ‰ç…§æ¡ç›®çš„åç§°ï¼ˆ<code>name</code>ï¼‰å’Œå¯é€‰çš„ç±»å‹ï¼ˆ<code>type</code>ï¼‰æ£€ç´¢æ€§èƒ½æ¡ç›®ã€‚å¦‚æœä¸æŒ‡å®šç±»å‹ï¼Œåˆ™è¿”å›æ‰€æœ‰åŒ¹é…åç§°çš„æ€§èƒ½æ¡ç›®ã€‚</p></li></ul><h4 id="å‚æ•°" tabindex="-1"><a class="header-anchor" href="#å‚æ•°"><span>å‚æ•°</span></a></h4><ul><li><strong>name</strong>: ä½ æƒ³è¦æŸ¥æ‰¾çš„æ€§èƒ½æ¡ç›®çš„åç§°ã€‚</li><li><strong>type</strong> (å¯é€‰): æ€§èƒ½æ¡ç›®çš„ç±»å‹ï¼Œä¾‹å¦‚<code>&quot;mark&quot;</code>æˆ–<code>&quot;measure&quot;</code>ç­‰ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-4"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œå¹¶ä¸”æˆ‘ä»¬æƒ³è¦ç›‘æ§é¡µé¢åŠ è½½å’Œä»£ç æ‰§è¡Œçš„æ€§èƒ½ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ€§èƒ½é’©å­ï¼ˆPerformance Hooksï¼‰API æ¥æ ‡è®°å…³é”®äº‹ä»¶çš„å¼€å§‹å’Œç»“æŸï¼Œç„¶åæµ‹é‡è¿™äº›äº‹ä»¶ä¹‹é—´çš„æ—¶é—´å·®ã€‚</p><ol><li><p><strong>æ ‡è®°å’Œæµ‹é‡ä»£ç å—çš„æ‰§è¡Œæ—¶é—´</strong></p><p>å‡è®¾æœ‰ä¸€ä¸ªå‡½æ•°<code>processData()</code>ï¼Œæˆ‘ä»¬æƒ³è¦æµ‹é‡å®ƒæ‰§è¡Œæ‰€éœ€çš„æ—¶é—´ã€‚æˆ‘ä»¬å¯ä»¥åœ¨å‡½æ•°æ‰§è¡Œå‰åè®¾ç½®æ€§èƒ½æ ‡è®°ï¼Œå¹¶æœ€ç»ˆæµ‹é‡è¿™ä¸¤ä¸ªæ ‡è®°ä¹‹é—´çš„æ—¶é—´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®PerformanceObserveræ¥ç›‘å¬â€œmeasureâ€ç±»å‹çš„æ€§èƒ½æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntriesByName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;processDataMeasure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ‡è®°å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;processDataStart&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™é‡Œæ˜¯ä¸€äº›æ•°æ®å¤„ç†å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">processData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ‡è®°ç»“æŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;processDataEnd&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹é‡å¼€å§‹å’Œç»“æŸä¹‹é—´çš„æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;processDataMeasure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;processDataStart&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;processDataEnd&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>è¿‡æ»¤ç‰¹å®šåç§°çš„æ€§èƒ½æ¡ç›®</strong></p><p>å¦‚æœæˆ‘ä»¬è®°å½•äº†å¾ˆå¤šä¸åŒç±»å‹å’Œåç§°çš„æ€§èƒ½æ¡ç›®ï¼Œä½†åªå¯¹ç‰¹å®šåç§°æ„Ÿå…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>getEntriesByName()</code>æ–¹æ³•æ¥è¿‡æ»¤ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬å·²ç»è®°å½•äº†å¾ˆå¤šæ€§èƒ½æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨æˆ‘ä»¬åªæƒ³è·å–åç§°ä¸º&quot;processDataMeasure&quot;çš„æ€§èƒ½æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> processDataEntries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntriesByName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;processDataMeasure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">processDataEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†åªæ˜¾ç¤ºæˆ‘ä»¬æ„Ÿå…´è¶£çš„æ¡ç›®</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>é€šè¿‡ä¸Šè¿°ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ°å¦‚ä½•ä½¿ç”¨<code>getEntriesByName()</code>æ–¹æ³•æ¥æ£€ç´¢å’Œè¿‡æ»¤ç‰¹å®šçš„æ€§èƒ½æ¡ç›®ã€‚è¿™åœ¨è¿›è¡Œæ€§èƒ½åˆ†æå’Œè°ƒè¯•æ—¶éå¸¸æœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯å½“ä½ éœ€è¦è¯¦ç»†äº†è§£åº”ç”¨ç¨‹åºåœ¨ç‰¹å®šæ“ä½œä¸ŠèŠ±è´¹äº†å¤šå°‘æ—¶é—´ã€‚</p><h3 id="performanceobserverentrylist-getentriesbytype-type" tabindex="-1"><a class="header-anchor" href="#performanceobserverentrylist-getentriesbytype-type"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#performanceobserverentrylistgetentriesbytypetype" target="_blank" rel="noopener noreferrer">performanceObserverEntryList.getEntriesByType(type)</a></span></a></h3><p>å½“ä½ æƒ³è¦ç›‘æ§å’Œæ”¹å–„ä½ çš„ Node.js åº”ç”¨ç¨‹åºçš„æ€§èƒ½æ—¶ï¼Œäº†è§£å¦‚ä½•ä½¿ç”¨<code>performanceObserverEntryList.getEntriesByType(type)</code>ä¼šéå¸¸æœ‰ç”¨ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯ Node.js ä¸­æ€§èƒ½ï¼ˆ<code>perf_hooks</code>ï¼‰æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå…è®¸ä½ è·å–ç‰¹å®šç±»å‹çš„æ€§èƒ½æ¡ç›®ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç†è§£å‡ ä¸ªå…³é”®æ¦‚å¿µï¼š</p><ul><li><strong>PerformanceEntry</strong>: è¿™æ˜¯ä¸€ä¸ªé€šç”¨çš„æ€§èƒ½åº¦é‡æ ‡å‡†çš„æ¥å£ï¼ŒåŒ…å«äº†åƒåç§°ã€å¼€å§‹æ—¶é—´ã€æŒç»­æ—¶é—´ç­‰ä¿¡æ¯ã€‚</li><li><strong>PerformanceObserver</strong>: ç”¨äºè§‚å¯Ÿå’Œæ”¶é›†æ€§èƒ½ç›¸å…³æ•°æ®ã€‚ä½ å¯ä»¥æŒ‡å®šä½ æ„Ÿå…´è¶£çš„æ€§èƒ½æ¡ç›®ç±»å‹ï¼Œä¾‹å¦‚ HTTP è¯·æ±‚çš„æ—¶é—´æˆ–è€…å‡½æ•°æ‰§è¡Œçš„æ—¶é—´ã€‚</li><li><strong>PerformanceObserverEntryList</strong>: å½“ä½ ä½¿ç”¨<code>PerformanceObserver</code>æ—¶ï¼Œæ”¶é›†åˆ°çš„æ€§èƒ½æ¡ç›®è¢«å­˜å‚¨åœ¨è¿™æ ·ä¸€ä¸ªåˆ—è¡¨ä¸­ã€‚ä½ å¯ä»¥é€šè¿‡è¿™ä¸ªåˆ—è¡¨æ£€ç´¢ç‰¹å®šç±»å‹æˆ–åç§°çš„æ€§èƒ½æ¡ç›®ã€‚</li></ul><p>ç°åœ¨ï¼Œæ¥çœ‹<code>performanceObserverEntryList.getEntriesByType(type)</code>è¿™ä¸ªæ–¹æ³•å¦‚ä½•å·¥ä½œã€‚è¯¥æ–¹æ³•å…è®¸ä½ ä»åˆ—è¡¨ä¸­æ£€ç´¢ä¸€ä¸ªç‰¹å®šâ€œç±»å‹â€çš„æ€§èƒ½æ¡ç›®æ•°ç»„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³æŸ¥çœ‹æ‰€æœ‰çš„â€œhttpâ€ç±»å‹æ¡ç›®ï¼ˆä¾‹å¦‚ï¼Œå‘é€ HTTP è¯·æ±‚æ‰€ç”¨çš„æ—¶é—´ï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-8" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-8"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨è¿è¡Œä¸€ä¸ª Node.js åº”ç”¨ï¼Œè¯¥åº”ç”¨é¢‘ç¹åœ°ä»å¤–éƒ¨ API è·å–æ•°æ®ã€‚ä¸ºäº†ç¡®ä¿ä½ çš„åº”ç”¨å“åº”è¿…é€Ÿï¼Œä½ æƒ³è¦ç›‘æµ‹è¿™äº› HTTP è¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚è¿™é‡Œæ˜¯å¦‚ä½•ä½¿ç”¨<code>performanceObserverEntryList.getEntriesByType(&#39;http&#39;)</code>æ¥å®ç°çš„æ­¥éª¤ï¼š</p><ol><li><p><strong>å¯¼å…¥æ€§èƒ½é’©å­</strong>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><strong>è®¾ç½® PerformanceObserver æ¥ç›‘å¬ HTTP è¯·æ±‚</strong>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> observer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntriesByType</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`HTTPè¯·æ±‚è€—æ—¶ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ‰§è¡Œ HTTP è¯·æ±‚</strong>:<br> è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¸ç›´æ¥å±•ç¤ºå¦‚ä½•å‘èµ· HTTP è¯·æ±‚ï¼Œå› ä¸º<code>getEntriesByType(&#39;http&#39;)</code>ä¸»è¦æ˜¯ç”¨æ¥æ¼”ç¤ºå¦‚ä½•è·å–æ€§èƒ½æ¡ç›®ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½ä¼šä½¿ç”¨<code>http</code>æˆ–<code>axios</code>ç­‰åº“æ¥å‘èµ·è¯·æ±‚ï¼Œå¹¶ä¸”åœ¨è¯·æ±‚ä¹‹å‰å’Œä¹‹ååˆ†åˆ«è°ƒç”¨<code>performance.mark()</code>æ¥æ ‡è®°æ—¶é—´ç‚¹ï¼Œç„¶åä½¿ç”¨<code>performance.measure()</code>æ¥è®¡ç®—è€—æ—¶å¹¶ç”Ÿæˆæ€§èƒ½æ¡ç›®ã€‚</p></li></ol><p>è¿™ä¸ªç®€å•çš„ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>performanceObserverEntryList.getEntriesByType(type)</code>æ¥ç›‘æ§ç‰¹å®šç±»å‹çš„æ€§èƒ½æ¡ç›®ï¼Œåœ¨è¿™ä¸ªæƒ…å†µä¸‹æ˜¯ HTTP è¯·æ±‚çš„æ—¶é—´ã€‚é€šè¿‡åˆ†æè¿™äº›æ•°æ®ï¼Œä½ å¯ä»¥è¯†åˆ«å‡ºæ€§èƒ½ç“¶é¢ˆå¹¶é‡‡å–ç›¸åº”çš„ä¼˜åŒ–æªæ–½ï¼Œä»è€Œæé«˜åº”ç”¨çš„æ•´ä½“æ€§èƒ½ã€‚</p><h2 id="perf-hooks-createhistogram-options" tabindex="-1"><a class="header-anchor" href="#perf-hooks-createhistogram-options"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#perf_hookscreatehistogramoptions" target="_blank" rel="noopener noreferrer">perf_hooks.createHistogram([options])</a></span></a></h2><p>äº†è§£ <code>perf_hooks.createHistogram([options])</code> ä¹‹å‰ï¼Œé¦–å…ˆè¦ç®€å•æ˜äº†åœ°çŸ¥é“å®ƒå±äº Node.js ä¸­çš„æ€§èƒ½é’©å­ï¼ˆPerformance Hooksï¼‰æ¨¡å—ã€‚è¿™ä¸ªæ¨¡å—å…è®¸æˆ‘ä»¬æµ‹é‡ä»£ç çš„æ€§èƒ½ï¼Œæ¯”å¦‚è®¡ç®—æŸäº›æ“ä½œéœ€è¦å¤šé•¿æ—¶é—´ã€‚è€Œç›´æ¥è·³åˆ° <code>createHistogram</code> å‡½æ•°ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨æ¥åˆ›å»ºç›´æ–¹å›¾ï¼ˆHistogramï¼‰çš„å·¥å…·ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç»Ÿè®¡å’Œåˆ†ææ€§èƒ½æ•°æ®ã€‚</p><p>ç›´æ–¹å›¾æ˜¯ä¸€ç§ç»Ÿè®¡æŠ¥å‘Šå›¾ï¼Œé€‚ç”¨äºå±•ç¤ºåˆ†å¸ƒæƒ…å†µï¼Œä¾‹å¦‚æ˜¾ç¤ºä¸€ç»„æ•°æ®ä¸­å„ä¸ªå€¼å‡ºç°çš„é¢‘ç‡ã€‚åœ¨æ€§èƒ½ç›‘æ§çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œç›´æ–¹å›¾å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç†è§£æŸé¡¹æ“ä½œçš„æ‰§è¡Œæ—¶é—´åˆ†å¸ƒï¼Œä»è€Œæ›´å¥½åœ°æŠŠæ¡æ€§èƒ½ç‰¹æ€§ã€‚</p><h3 id="ä½¿ç”¨-perf-hooks-createhistogram-options" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-perf-hooks-createhistogram-options"><span>ä½¿ç”¨ <code>perf_hooks.createHistogram([options])</code></span></a></h3><p><code>createHistogram</code> å‡½æ•°å…è®¸ä½ åˆ›å»ºä¸€ä¸ªç›´æ–¹å›¾å®ä¾‹ï¼Œè¿™ä¸ªå®ä¾‹å¯ä»¥è¢«ç”¨æ¥è®°å½•å’Œç´¯ç§¯æ—¶é—´æ•°æ®ï¼ˆé€šå¸¸ä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚ä½ å¯ä»¥æŒ‡å®šä¸€äº›é€‰é¡¹æ¥è‡ªå®šä¹‰ç›´æ–¹å›¾çš„è¡Œä¸ºï¼Œæ¯”å¦‚æœ€å°å€¼ã€æœ€å¤§å€¼å’Œç²¾ç¡®åº¦ç­‰ã€‚</p><h4 id="å®é™…åº”ç”¨ç¤ºä¾‹-6" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-6"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h4><p>å‡è®¾æˆ‘ä»¬æƒ³æµ‹è¯•ä¸€ä¸ªå‡½æ•°çš„æ‰§è¡Œæ—¶é—´åˆ†å¸ƒï¼Œçœ‹çœ‹è¿™ä¸ªå‡½æ•°é€šå¸¸è¿è¡Œå¾—æœ‰å¤šå¿«ï¼Œä»¥åŠæ˜¯å¦æœ‰ä»»ä½•å¼‚å¸¸æ…¢çš„æƒ…å†µå‘ç”Ÿã€‚ä»¥ä¸‹æ˜¯ä¸€æ®µç¤ºèŒƒä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">createHistogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;perf_hooks&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªç›´æ–¹å›¾å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> histogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> createHistogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿä¸€äº›å‡½æ•°è°ƒç”¨ï¼Œå¹¶è®°å½•æ¯æ¬¡è°ƒç”¨çš„æŒç»­æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hrtime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">bigint</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼€å§‹æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å‡è®¾è¿™é‡Œæ˜¯æˆ‘ä»¬è¦æµ‹é‡çš„å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬ä½¿ç”¨ setTimeout æ¥æ¨¡æ‹Ÿä¸åŒçš„æ‰§è¡Œæ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hrtime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">bigint</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç»“æŸæ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> duration</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¡ç®—æŒç»­æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†æŒç»­æ—¶é—´è®°å½•åˆ°ç›´æ–¹å›¾ä¸­</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        // å½“æ‰€æœ‰æ¨¡æ‹Ÿå‡½æ•°è°ƒç”¨éƒ½å®Œæˆæ—¶ï¼Œæ‰“å°ç›´æ–¹å›¾ç»Ÿè®¡ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 99</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">            console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">min</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°æœ€çŸ­æŒç»­æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">            console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">max</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°æœ€é•¿æŒç»­æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">            console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mean</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å¹³å‡æŒç»­æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">            console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">stddev</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°æ ‡å‡†å·®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">            console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">percentiles</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">99</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">])); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°ç¬¬50ã€90ã€99ç™¾åˆ†ä½çš„æŒç»­æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Math</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">random</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç›´æ–¹å›¾æ¥è®°å½•ä¸€ç³»åˆ—æ“ä½œï¼ˆé€šè¿‡ <code>setTimeout</code> æ¨¡æ‹Ÿçš„å¼‚æ­¥å‡½æ•°è°ƒç”¨ï¼‰çš„æ‰§è¡Œæ—¶é—´ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ç›´æ–¹å›¾æä¾›çš„æ–¹æ³•æ¥è¾“å‡ºå…³äºè¿™äº›æ‰§è¡Œæ—¶é—´çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œæ¯”å¦‚æœ€çŸ­æ—¶é—´ã€æœ€é•¿æ—¶é—´ã€å¹³å‡æ—¶é—´ã€æ ‡å‡†å·®å’Œç‰¹å®šç™¾åˆ†ä½çš„æ—¶é—´ã€‚</p><p>è¿™æ ·çš„åˆ†æå¯¹äºæ€§èƒ½ä¼˜åŒ–è‡³å…³é‡è¦ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ å‘ç°å¤§éƒ¨åˆ†çš„æ‰§è¡Œæ—¶é—´éƒ½å¾ˆå¿«ï¼Œä½†æœ‰æå°‘æ•°æƒ…å†µéå¸¸æ…¢ï¼Œé‚£ä¹ˆå¯èƒ½éœ€è¦ä¸“é—¨é’ˆå¯¹è¿™äº›æç«¯æƒ…å†µè¿›è¡Œä¼˜åŒ–ã€‚</p><p>æ€»ç»“èµ·æ¥ï¼Œ<code>perf_hooks.createHistogram</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œèƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…æ·±å…¥äº†è§£å’Œä¼˜åŒ–ä»£ç çš„æ€§èƒ½è¡¨ç°ã€‚é€šè¿‡ä½¿ç”¨ç›´æ–¹å›¾æ”¶é›†å’Œåˆ†ææ€§èƒ½æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ¸…æ™°åœ°äº†è§£ä»£ç çš„è¿è¡Œè¡¨ç°ï¼Œä»è€Œåšå‡ºæ›´æœ‰æ•ˆçš„ä¼˜åŒ–å†³ç­–ã€‚</p><h2 id="perf-hooks-monitoreventloopdelay-options" tabindex="-1"><a class="header-anchor" href="#perf-hooks-monitoreventloopdelay-options"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#perf_hooksmonitoreventloopdelayoptions" target="_blank" rel="noopener noreferrer">perf_hooks.monitorEventLoopDelay([options])</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨ JavaScript æ¥ç¼–å†™åç«¯ä»£ç ï¼Œå®ç°ç½‘ç«™çš„é€»è¾‘ã€æ•°æ®åº“æ“ä½œç­‰åŠŸèƒ½ã€‚</p><p><code>perf_hooks.monitorEventLoopDelay([options])</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå±äºæ€§èƒ½é’©å­ï¼ˆPerformance Hooksï¼‰æ¨¡å—çš„ä¸€éƒ¨åˆ†ã€‚è¿™ä¸ª API çš„ä¸»è¦ä½œç”¨æ˜¯ç›‘è§†å’Œæµ‹é‡äº‹ä»¶å¾ªç¯å»¶è¿Ÿã€‚</p><h3 id="äº‹ä»¶å¾ªç¯-event-loop" tabindex="-1"><a class="header-anchor" href="#äº‹ä»¶å¾ªç¯-event-loop"><span>äº‹ä»¶å¾ªç¯(Event Loop)ï¼š</span></a></h3><p>åœ¨æ·±å…¥ç†è§£ <code>monitorEventLoopDelay</code> æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç®€å•äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯äº‹ä»¶å¾ªç¯ã€‚Node.js ä½¿ç”¨äº‹ä»¶é©±åŠ¨æ¨¡å‹æ¥å¤„ç†å¼‚æ­¥æ“ä½œã€‚å½“ Node.js å¯åŠ¨ä¸€ä¸ªæœåŠ¡å™¨ï¼Œä¾‹å¦‚ï¼Œå®ƒä¸ä¼šé˜»å¡ï¼ˆåœæ­¢æ‰§è¡Œå…¶ä»–ä»£ç ï¼‰ç­‰å¾…è¯·æ±‚ï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚å½“è¯·æ±‚åˆ°è¾¾æ—¶ï¼Œäº‹ä»¶å¾ªç¯ç¡®ä¿è¿™äº›è¯·æ±‚è¢«é€‚æ—¶å¤„ç†ï¼Œè€Œä¸éœ€è¦ä¸ºæ¯ä¸ªè¯·æ±‚å•ç‹¬å¯åŠ¨çº¿ç¨‹ã€‚è¿™æ ·åšæé«˜äº†æ•ˆç‡å¹¶å‡å°‘èµ„æºæ¶ˆè€—ã€‚</p><h3 id="ç›‘æ§äº‹ä»¶å¾ªç¯å»¶è¿Ÿ" tabindex="-1"><a class="header-anchor" href="#ç›‘æ§äº‹ä»¶å¾ªç¯å»¶è¿Ÿ"><span>ç›‘æ§äº‹ä»¶å¾ªç¯å»¶è¿Ÿï¼š</span></a></h3><p>äº‹ä»¶å¾ªç¯å»¶è¿ŸæŒ‡çš„æ˜¯äº‹ä»¶å¾ªç¯åœ¨å¤„ç†å®Œæ‰€æœ‰å¾…å¤„ç†ä»»åŠ¡åˆ°æ¥æ”¶æ–°çš„ä»»åŠ¡ä¹‹é—´çš„æ—¶é—´å·®ã€‚åœ¨ä¸€ä¸ªç†æƒ³çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå»¶è¿Ÿåº”è¯¥å°½å¯èƒ½ä½ï¼Œä»¥ç¡®ä¿ç¨‹åºå¯ä»¥å¿«é€Ÿå“åº”æ–°çš„äº‹ä»¶ã€‚</p><p>ä½¿ç”¨ <code>perf_hooks.monitorEventLoopDelay([options])</code> å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç›‘è§†è¿™ä¸ªå»¶è¿Ÿã€‚è¿™å¯¹äºæ€§èƒ½è°ƒä¼˜å’Œå‘ç°æ½œåœ¨çš„æ€§èƒ½ç“¶é¢ˆè‡³å…³é‡è¦ã€‚</p><h3 id="å‚æ•°-1" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-1"><span>å‚æ•°ï¼š</span></a></h3><ul><li><code>options</code> å¯¹è±¡æ˜¯å¯é€‰çš„ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹å±æ€§ï¼š <ul><li><code>resolution</code>ï¼šæŒ‡å®šé‡‡æ ·é¢‘ç‡ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚é»˜è®¤å€¼æ˜¯ 10 æ¯«ç§’ã€‚</li></ul></li></ul><h3 id="è¿”å›å€¼" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼"><span>è¿”å›å€¼ï¼š</span></a></h3><p>è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª <code>EventLoopDelayMonitor</code> å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯ä»¥ç”¨æ¥å¼€å§‹å’Œåœæ­¢ç›‘è§†ï¼Œä»¥åŠè·å–å…³äºäº‹ä»¶å¾ªç¯å»¶è¿Ÿçš„ç»Ÿè®¡ä¿¡æ¯ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-15" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-15"><span>å®é™…è¿ç”¨ä¾‹å­ï¼š</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œå¹¶ä¸”ä½ æ³¨æ„åˆ°åœ¨é«˜è´Ÿè½½æƒ…å†µä¸‹ï¼Œåº”ç”¨çš„å“åº”é€Ÿåº¦å˜æ…¢äº†ã€‚ä½ æ€€ç–‘è¿™å¯èƒ½æ˜¯å› ä¸ºäº‹ä»¶å¾ªç¯å»¶è¿Ÿå¢åŠ å¯¼è‡´çš„ã€‚ä¸ºäº†ç¡®è®¤ä½ çš„çŒœæƒ³ï¼Œä½ å†³å®šä½¿ç”¨ <code>perf_hooks.monitorEventLoopDelay()</code> æ¥ç›‘æ§äº‹ä»¶å¾ªç¯å»¶è¿Ÿã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">monitorEventLoopDelay</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»º EventLoopDelayMonitor å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> eldMonitor</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> monitorEventLoopDelay</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">resolution</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼€å§‹ç›‘è§†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">eldMonitor</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">enable</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åœ¨ä¸€æ®µæ—¶é—´ååœæ­¢ç›‘è§†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  eldMonitor</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">disable</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¾“å‡ºç›‘æµ‹åˆ°çš„äº‹ä»¶å¾ªç¯å»¶è¿Ÿç»Ÿè®¡ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Min: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">eldMonitor</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">min</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Max: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">eldMonitor</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">max</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Mean: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">eldMonitor</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">mean</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`StdDev: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">eldMonitor</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">stddev</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Percentiles: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">JSON</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">stringify</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">eldMonitor</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">percentiles</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ­¤ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†åœ¨ 10 ç§’ååœæ­¢ç›‘è§†å¹¶è¾“å‡ºç»Ÿè®¡æ•°æ®</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª <code>EventLoopDelayMonitor</code> å®ä¾‹ï¼Œå¹¶è®¾ç½®äº†é‡‡æ ·åˆ†è¾¨ç‡ä¸º 20 æ¯«ç§’ã€‚ç„¶åæˆ‘ä»¬å¯ç”¨äº†ç›‘è§†å™¨ï¼Œç­‰å¾… 10 ç§’ååœæ­¢ç›‘è§†ï¼Œå¹¶è¾“å‡ºäº†æœ€å°å»¶è¿Ÿã€æœ€å¤§å»¶è¿Ÿã€å¹³å‡å»¶è¿Ÿã€æ ‡å‡†å·®å’Œç™¾åˆ†ä½æ•°ç­‰ç»Ÿè®¡ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°äº†è§£ç³»ç»Ÿåœ¨é«˜è´Ÿè½½æœŸé—´çš„è¡¨ç°ï¼Œå¹¶é‡‡å–ç›¸åº”çš„ä¼˜åŒ–æªæ–½ã€‚</p><h2 id="class-histogram" tabindex="-1"><a class="header-anchor" href="#class-histogram"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#class-histogram" target="_blank" rel="noopener noreferrer">Class: Histogram</a></span></a></h2><p>å½“ç„¶ï¼Œè®©æˆ‘å¸®ä½ æ›´å¥½åœ°ç†è§£ Node.js ä¸­çš„ <code>Histogram</code> ç±»åŠå…¶ç”¨é€”ã€‚</p><p>é¦–å…ˆï¼ŒNode.js ä¸­çš„ <code>Histogram</code> æ˜¯ä¸€ä¸ªæ€§èƒ½é’©å­ï¼ˆ<code>perf_hooks</code>ï¼‰æ¨¡å—çš„ä¸€éƒ¨åˆ†ã€‚å®ƒè¢«è®¾è®¡æ¥å¸®åŠ©ä½ æ”¶é›†å’Œç»Ÿè®¡æ—¶é—´æ•°æ®ï¼ˆå¦‚æ“ä½œæŒç»­æ—¶é—´æˆ–äº‹ä»¶é¢‘ç‡ï¼‰ã€‚ç®€å•æ¥è¯´ï¼Œ<code>Histogram</code> ç»™ä½ æä¾›äº†ä¸€ç§æ–¹å¼ï¼Œå¯ä»¥æµ‹é‡å’Œè·Ÿè¸ªåº”ç”¨ç¨‹åºä¸­æŸäº›æ´»åŠ¨æˆ–æ“ä½œçš„æ€§èƒ½ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-5" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-5"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>åœ¨æ·±å…¥ç ”ç©¶ä¹‹å‰ï¼Œéœ€è¦ç†è§£å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p><ul><li><strong>ç›´æ–¹å›¾ï¼ˆHistogramï¼‰</strong>ï¼šåœ¨ç»Ÿè®¡å­¦ä¸­ï¼Œç›´æ–¹å›¾æ˜¯ä¸€ç§å›¾è¡¨ï¼Œå±•ç¤ºäº†æ•°æ®çš„åˆ†å¸ƒæƒ…å†µã€‚åœ¨ Node.js ä¸­ï¼Œ<code>Histogram</code> å¯¹è±¡ä¹Ÿç±»ä¼¼ï¼Œå®ƒè®°å½•äº†ä¸€ç³»åˆ—å€¼ï¼Œå¹¶èƒ½è®©ä½ çœ‹åˆ°è¿™äº›å€¼çš„åˆ†å¸ƒçŠ¶å†µï¼Œæ¯”å¦‚æœ€å°å€¼ã€æœ€å¤§å€¼ã€å¹³å‡å€¼ã€æ ‡å‡†åå·®ç­‰ã€‚</li><li><strong>æ€§èƒ½ç›‘æ§ï¼ˆPerformance Monitoringï¼‰</strong>ï¼šæŒ‡çš„æ˜¯ç›‘æ§å’Œè¯„ä¼°åº”ç”¨ç¨‹åºçš„å„ä¸ªæ–¹é¢ï¼Œæ¯”å¦‚å“åº”æ—¶é—´å’Œèµ„æºåˆ©ç”¨ç‡ï¼Œä»¥ç¡®ä¿è½¯ä»¶è¿è¡Œå¾—æ—¢é«˜æ•ˆåˆç¨³å®šã€‚</li></ul><h3 id="å®é™…è¿ç”¨å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨å®ä¾‹"><span>å®é™…è¿ç”¨å®ä¾‹</span></a></h3><p>è®©æˆ‘ä»¬é€šè¿‡ä¸€äº›å®é™…çš„ä¾‹å­æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ <code>Histogram</code>ï¼š</p><h4 id="ç¤ºä¾‹-1-æµ‹é‡å¼‚æ­¥æ“ä½œçš„æ‰§è¡Œæ—¶é—´" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æµ‹é‡å¼‚æ­¥æ“ä½œçš„æ‰§è¡Œæ—¶é—´"><span>ç¤ºä¾‹ 1: æµ‹é‡å¼‚æ­¥æ“ä½œçš„æ‰§è¡Œæ—¶é—´</span></a></h4><p>å‡è®¾ä½ æƒ³æµ‹é‡æ•°æ®åº“æŸ¥è¯¢çš„æ‰§è¡Œæ—¶é—´ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>Histogram</code> æ¥æ”¶é›†è¿™äº›æ—¶é—´æ•°æ®ï¼Œå¹¶è®¡ç®—å‡ºå¹³å‡æ‰§è¡Œæ—¶é—´ã€æœ€çŸ­å’Œæœ€é•¿æ‰§è¡Œæ—¶é—´ç­‰ã€‚</p><ol><li>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ª <code>Histogram</code> å®ä¾‹ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»º histogram</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> histogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>ç„¶åï¼Œæ¯æ¬¡æ•°æ®åº“æŸ¥è¯¢å¼€å§‹å’Œç»“æŸæ—¶ï¼Œä½¿ç”¨ <code>histogram.record()</code> æ–¹æ³•è®°å½•æ—¶é—´å·®ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> queryDatabase</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾è¿™é‡Œæ˜¯æ•°æ®åº“æŸ¥è¯¢</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> someDatabaseQuery</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> duration</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è®°å½•æŸ¥è¯¢è€—æ—¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>æœ€åï¼Œä½ å¯ä»¥æŸ¥çœ‹æŸ¥è¯¢è€—æ—¶çš„ç»Ÿè®¡ä¿¡æ¯:</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æœ€å°è€—æ—¶: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">min</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æœ€å¤§è€—æ—¶: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">max</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`å¹³å‡è€—æ—¶: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">mean</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ›´å¤šå±æ€§å’Œæ–¹æ³•å¯ç”¨äºæ·±å…¥åˆ†æ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-è·Ÿè¸ªäº‹ä»¶é¢‘ç‡" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-è·Ÿè¸ªäº‹ä»¶é¢‘ç‡"><span>ç¤ºä¾‹ 2: è·Ÿè¸ªäº‹ä»¶é¢‘ç‡</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªç½‘ç«™ï¼Œæƒ³è·Ÿè¸ªæ¯åˆ†é’Ÿç”¨æˆ·çš„ç‚¹å‡»æ¬¡æ•°ã€‚ä½ å¯ä»¥åˆ©ç”¨ <code>Histogram</code> æ¥å®Œæˆè¿™é¡¹ä»»åŠ¡ã€‚</p><ol><li><p>æ¯æ¬¡ç”¨æˆ·å‘ç”Ÿç‚¹å‡»æ—¶ï¼Œä½ è®°å½•äº‹ä»¶å‘ç”Ÿçš„æ—¶é—´ç‚¹ã€‚</p></li><li><p>åˆ©ç”¨ <code>Histogram</code> çš„åŠŸèƒ½ï¼Œå¯¹ç‚¹å‡»äº‹ä»¶è¿›è¡Œæ—¶é—´ä¸Šçš„åˆ†ç»„å’Œè®¡æ•°ã€‚</p></li><li><p>åˆ†æç»“æœï¼Œæ¯”å¦‚è®¡ç®—ä¸€åˆ†é’Ÿå†…å¹³å‡çš„ç‚¹å‡»æ¬¡æ•°ï¼Œæˆ–è€…æ‰¾å‡ºç‚¹å‡»æ¬¡æ•°æœ€é«˜çš„æ—¶é—´æ®µã€‚</p></li></ol><h3 id="æ€»ç»“-10" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-10"><span>æ€»ç»“</span></a></h3><p><code>Histogram</code> æä¾›äº†ä¸€ç§å¼ºå¤§çš„æ–¹å¼æ¥ç›‘è§†å’Œåˆ†æä½ çš„ Node.js åº”ç”¨ç¨‹åºä¸­çš„æ—¶é—´æ•æ„Ÿæ“ä½œã€‚é€šè¿‡æµ‹é‡å’Œç»Ÿè®¡è¿è¡Œæ—¶é—´æˆ–äº‹ä»¶é¢‘ç‡ï¼Œä½ å¯ä»¥è·å¾—å…³é”®æ€§èƒ½æŒ‡æ ‡ï¼Œå¸®åŠ©ä½ ä¼˜åŒ–åº”ç”¨ç¨‹åºã€‚ä¸Šé¢çš„ä¾‹å­åªæ˜¯å…¥é—¨çº§çš„åº”ç”¨ï¼Œä½† <code>Histogram</code> çš„çœŸæ­£å¨åŠ›åœ¨äºå®ƒèƒ½å¤Ÿè®©ä½ æ·±å…¥ç†è§£å’Œä¼˜åŒ–åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚</p><h3 id="histogram-count" tabindex="-1"><a class="header-anchor" href="#histogram-count"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogramcount" target="_blank" rel="noopener noreferrer">histogram.count</a></span></a></h3><p>ç†è§£ <code>histogram.count</code> ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆèŠä¸€ä¸‹ Node.js ä¸­çš„æ€§èƒ½ç›‘æ§ï¼ˆPerformance Monitoringï¼‰ä»¥åŠç›´æ–¹å›¾ï¼ˆHistogramsï¼‰çš„æ¦‚å¿µã€‚</p><p>åœ¨ç¼–ç¨‹ä¸­ï¼Œå°¤å…¶æ˜¯å¤„ç†æœåŠ¡å™¨ç«¯çš„åº”ç”¨ç¨‹åºæ—¶ï¼Œäº†è§£å’Œç›‘æµ‹ä½ çš„åº”ç”¨æ€§èƒ½è‡³å…³é‡è¦ã€‚Node.js æä¾›äº†ä¸€ä¸ªåä¸º <code>perf_hooks</code> çš„æ¨¡å—ï¼Œå®ƒå…è®¸å¼€å‘è€…æ”¶é›†æ€§èƒ½æŒ‡æ ‡ã€‚</p><p>ç›´æ–¹å›¾ï¼ˆHistogramï¼‰æ˜¯ <code>perf_hooks</code> æ¨¡å—æä¾›çš„å·¥å…·ä¹‹ä¸€ï¼Œç”¨äºæ”¶é›†å¹¶ç»Ÿè®¡æ—¶é—´è·¨åº¦æˆ–è€…äº‹ä»¶å‘ç”Ÿçš„é¢‘ç‡åˆ†å¸ƒã€‚ç®€å•æ¥è¯´ï¼Œç›´æ–¹å›¾å¸®åŠ©æˆ‘ä»¬çœ‹åˆ°æŸä¸ªæ“ä½œæˆ–ä»»åŠ¡å®Œæˆæ‰€éœ€æ—¶é—´çš„åˆ†å¸ƒæƒ…å†µâ€”â€”æœ‰å¤šå°‘æ“ä½œåœ¨ç‰¹å®šæ—¶é—´å†…å®Œæˆï¼Œè¿™å¯¹ä¼˜åŒ–å’Œè°ƒè¯•éƒ½éå¸¸æœ‰ç”¨ã€‚</p><h3 id="histogram-count-1" tabindex="-1"><a class="header-anchor" href="#histogram-count-1"><span><code>histogram.count</code></span></a></h3><p>åœ¨ Node.js çš„ç›´æ–¹å›¾ä¸­ï¼Œ<code>.count</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œè¡¨ç¤ºè¢«è®°å½•çš„äº‹ä»¶æ€»æ•°ã€‚æ¢å¥è¯è¯´ï¼Œæ¯å½“ä½ è®°å½•ä¸€ä¸ªäº‹ä»¶ï¼ˆæ¯”å¦‚è¯´ä¸€ä¸ªè¯·æ±‚çš„å“åº”æ—¶é—´ï¼‰ï¼Œç›´æ–¹å›¾å°±ä¼šæ›´æ–°ï¼Œè€Œ <code>.count</code> å±æ€§åˆ™åæ˜ äº†è®°å½•äº†å¤šå°‘æ¬¡è¿™æ ·çš„äº‹ä»¶ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-16" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-16"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>è€ƒè™‘ä¸€ä¸ªç½‘ç«™æœåŠ¡å™¨çš„åœºæ™¯ï¼Œæˆ‘ä»¬æƒ³ç›‘æµ‹å¤„ç†ç”¨æˆ·è¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚</p><ol><li><strong>åˆ›å»ºç›´æ–¹å›¾</strong>: é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>perf_hooks</code> åˆ›å»ºä¸€ä¸ªç›´æ–¹å›¾å®ä¾‹ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºç›´æ–¹å›¾</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> histogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>è®°å½•äº‹ä»¶</strong>: å¯¹äºæ¯ä¸ªç”¨æˆ·è¯·æ±‚ï¼Œæˆ‘ä»¬åœ¨å¼€å§‹æ—¶å’Œç»“æŸæ—¶è·å–å½“å‰çš„æ—¶é—´æˆ³ï¼Œå¹¶è®¡ç®—å‡ºå¤„ç†è¯¥è¯·æ±‚æ‰€éœ€çš„æ—¶é—´ï¼Œç„¶åå°†è¿™ä¸ªæ—¶é—´æ·»åŠ åˆ°ç›´æ–¹å›¾ä¸­ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> handleRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">request</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">response</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯·æ±‚å¼€å§‹æ—¶çš„æ—¶é—´</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾è¿™é‡Œæœ‰ä¸€äº›å¼‚æ­¥æ“ä½œå¤„ç†è¯·æ±‚...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯·æ±‚ç»“æŸæ—¶çš„æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> duration</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¡ç®—å¤„ç†è¯·æ±‚æ‰€éœ€çš„æ—¶é—´</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†è¿™ä¸ªæ—¶é—´è®°å½•åˆ°ç›´æ–¹å›¾ä¸­</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>åˆ©ç”¨<code>.count</code></strong>: å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œå¦‚æœæˆ‘ä»¬æƒ³çŸ¥é“æ€»å…±å¤„ç†äº†å¤šå°‘ä¸ªè¯·æ±‚ï¼Œå¯ä»¥é€šè¿‡ç›´æ–¹å›¾çš„ <code>.count</code> å±æ€§å¾—çŸ¥ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ€»å…±å¤„ç†äº† </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">count</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ä¸ªè¯·æ±‚ã€‚`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ç›´æ–¹å›¾æ¥ç›‘æµ‹å’Œç»Ÿè®¡å¤„ç†ç”¨æˆ·è¯·æ±‚æ‰€éœ€æ—¶é—´çš„æƒ…å†µï¼Œä»è€Œå¯ä»¥å¸®åŠ©å¼€å‘è€…åˆ†æç³»ç»Ÿæ€§èƒ½ï¼Œæ‰¾å‡ºç“¶é¢ˆï¼Œå¹¶è¿›è¡Œç›¸åº”çš„ä¼˜åŒ–ã€‚</p><h3 id="histogram-countbigint" tabindex="-1"><a class="header-anchor" href="#histogram-countbigint"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogramcountbigint" target="_blank" rel="noopener noreferrer">histogram.countBigInt</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹åŸºæœ¬æ¦‚å¿µï¼Œç„¶åå…·ä½“æ¢è®¨ <code>histogram.countBigInt</code> è¿™ä¸ªåŠŸèƒ½ã€‚</p><h3 id="node-js-å’Œæ€§èƒ½ç›‘è§†" tabindex="-1"><a class="header-anchor" href="#node-js-å’Œæ€§èƒ½ç›‘è§†"><span>Node.js å’Œæ€§èƒ½ç›‘è§†</span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå®ƒè®©ä½ å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œ JavaScript ä»£ç ã€‚ç”±äºå…¶éé˜»å¡ I/O ç‰¹æ€§ï¼ŒNode.js ç‰¹åˆ«é€‚åˆæ„å»ºé«˜æ€§èƒ½çš„ç½‘ç»œåº”ç”¨ã€‚</p><p>ä¸ºäº†å¸®åŠ©å¼€å‘è€…ç›‘è§†å’Œæ”¹è¿›åº”ç”¨çš„æ€§èƒ½ï¼ŒNode.js æä¾›äº†ä¸€å¥—æ€§èƒ½é’©å­ï¼ˆPerformance Hooksï¼‰APIã€‚è¿™äº› API å…è®¸ä½ æ”¶é›†åˆ°è¿è¡Œæ—¶çš„æ€§èƒ½æŒ‡æ ‡æ•°æ®ï¼Œæ¯”å¦‚æ“ä½œçš„è€—æ—¶ç­‰ã€‚</p><h3 id="histograms" tabindex="-1"><a class="header-anchor" href="#histograms"><span>Histograms</span></a></h3><p>åœ¨æ€§èƒ½ç›‘è§†çš„ä¸Šä¸‹æ–‡ä¸­ï¼ŒHistogramï¼ˆç›´æ–¹å›¾ï¼‰æ˜¯ä¸€ç§å¾ˆé‡è¦çš„å·¥å…·ï¼Œç”¨äºç»Ÿè®¡å’Œå±•ç¤ºæ•°æ®åˆ†å¸ƒæƒ…å†µã€‚ä¾‹å¦‚ï¼Œå®ƒå¯ä»¥å‘Šè¯‰ä½ æŸä¸ªå‡½æ•°çš„è°ƒç”¨æ¬¡æ•°åˆ†å¸ƒåœ¨ä¸åŒè€—æ—¶åŒºé—´çš„æ¯”ä¾‹ã€‚</p><h3 id="histogram-countbigint-åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#histogram-countbigint-åŠŸèƒ½"><span><code>histogram.countBigInt</code> åŠŸèƒ½</span></a></h3><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œæåˆ°çš„ <code>histogram.countBigInt</code> å®é™…ä¸Šæ˜¯æ€§èƒ½é’©å­æ¨¡å—ä¸­ Histogram å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª <code>BigInt</code> ç±»å‹çš„å€¼ï¼Œä»£è¡¨è¢«è®°å½•çš„æ€§èƒ½äº‹ä»¶çš„æ€»æ•°ã€‚ç®€å•æ¥è¯´ï¼Œ<code>countBigInt</code> æ–¹æ³•ä¼šå‘Šè¯‰ä½ è§‚æµ‹åˆ°çš„äº‹ä»¶ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªç‰¹å®šè¯·æ±‚çš„å¤„ç†æ—¶é—´ï¼‰çš„æ€»è®¡æ¬¡æ•°ã€‚</p><h3 id="å®é™…åº”ç”¨ä¸¾ä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¸¾ä¾‹-1"><span>å®é™…åº”ç”¨ä¸¾ä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web æœåŠ¡ï¼Œå¹¶æƒ³ç›‘æ§æ¯ä¸ªè¯·æ±‚å¤„ç†æ‰€éœ€çš„æ—¶é—´ã€‚ä½ å¯ä»¥ä½¿ç”¨æ€§èƒ½é’©å­ï¼ˆPerf Hooksï¼‰æ¥åˆ›å»ºä¸€ä¸ªç›´æ–¹å›¾ï¼Œè®°å½•æ‰€æœ‰è¯·æ±‚çš„å¤„ç†æ—¶é—´ã€‚</p><ol><li><strong>è®¾ç½®æ€§èƒ½é’©å­</strong>ï¼šé¦–å…ˆï¼Œä½ éœ€è¦å¼•å…¥ Node.js çš„ <code>perf_hooks</code> æ¨¡å—ï¼Œå¹¶åˆ›å»ºä¸€ä¸ª Histogram å®ä¾‹ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ–°çš„ Histogram å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> histogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>è®°å½•æ€§èƒ½æ•°æ®</strong>ï¼šä¹‹åï¼Œæ¯å½“æœ‰è¯·æ±‚å¤„ç†å®Œæˆï¼Œä½ å°±å‘ Histogram å®ä¾‹ä¸­æ·»åŠ ç›¸åº”çš„è€—æ—¶æ•°æ®ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™ä¸ªå‡½æ•°ä¼šåœ¨æ¯ä¸ªè¯·æ±‚ç»“æŸæ—¶è¢«è°ƒç”¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> onRequestEnd</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä½¿ç”¨ record() æ–¹æ³•è®°å½•è¯·æ±‚è€—æ—¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>ä½¿ç”¨ <code>countBigInt</code> è·å–äº‹ä»¶æ€»æ•°</strong>ï¼šä½ å¯èƒ½æƒ³çŸ¥é“è‡ªä»æœåŠ¡å¯åŠ¨ä»¥æ¥ä¸€å…±å¤„ç†äº†å¤šå°‘ä¸ªè¯·æ±‚ã€‚è¿™æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>countBigInt</code> æ–¹æ³•ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–å¹¶æ‰“å°å¤„ç†çš„è¯·æ±‚æ€»æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ€»è¯·æ±‚æ¬¡æ•°: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">countBigInt</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œ<code>countBigInt</code> æ–¹æ³•å¸®åŠ©ä½ ä»æ•´ä½“ä¸Šäº†è§£æœåŠ¡çš„è´Ÿè½½æƒ…å†µï¼Œè¿™å¯¹äºæ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–æ˜¯éå¸¸æœ‰ç”¨çš„ä¿¡æ¯ã€‚</p><p>å¸Œæœ›è¿™ä¸ªè§£é‡Šå’Œä¾‹å­èƒ½å¸®åŠ©ä½ ç†è§£ <code>histogram.countBigInt</code> åœ¨ Node.js ä¸­çš„ä½œç”¨å’Œç”¨æ³•ã€‚</p><h3 id="histogram-exceeds" tabindex="-1"><a class="header-anchor" href="#histogram-exceeds"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogramexceeds" target="_blank" rel="noopener noreferrer">histogram.exceeds</a></span></a></h3><p>Node.js v21.7.1 ä¸­çš„<code>histogram.exceeds</code>æ˜¯æ€§èƒ½ç›‘æµ‹å·¥å…·(perf_hooks)ä¸­çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå®ƒæ¶‰åŠåˆ°ä½¿ç”¨ç›´æ–¹å›¾ï¼ˆHistogramsï¼‰æ¥è¿½è¸ªå’Œåº¦é‡ç‰¹å®šç±»å‹çš„æ•°æ®ã€‚åœ¨è¿™ä¸ªä¸Šä¸‹æ–‡ä¸­ï¼Œä¸€ä¸ª&quot;ç›´æ–¹å›¾&quot;æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œç”¨äºç´¯ç§¯æ•°æ®ç‚¹å¹¶å°†å®ƒä»¬åˆ†ç»„åˆ°ä¸åŒçš„&quot;æ¡¶&quot;æˆ–èŒƒå›´å†…ï¼Œä»¥ä¾¿äºå¿«é€Ÿç†è§£æ•°æ®åˆ†å¸ƒæƒ…å†µã€‚</p><h3 id="histogram-exceeds-1" tabindex="-1"><a class="header-anchor" href="#histogram-exceeds-1"><span>histogram.exceeds</span></a></h3><p>åœ¨ Node.js çš„æ€§èƒ½é’©å­ï¼ˆperf_hooksï¼‰æ¨¡å—ä¸­ï¼Œ<code>histogram.exceeds</code>æ˜¯ä¸€ä¸ªå±æ€§ï¼Œç”¨äºæŠ¥å‘Šè¢«è®°å½•çš„è§‚å¯Ÿå€¼è¶…è¿‡é¢„è®¾é˜ˆå€¼çš„æ¬¡æ•°ã€‚è¿™ä¸ªåŠŸèƒ½ç‰¹åˆ«é€‚ç”¨äºè·Ÿè¸ªé‚£äº›å¶å°”å‡ºç°å¼‚å¸¸é«˜å€¼çš„åœºæ™¯ï¼Œå¹¶å¸®åŠ©å¼€å‘è€…è¯†åˆ«å’Œä¼˜åŒ–è¿™äº›æç«¯æ¡ˆä¾‹ã€‚</p><h4 id="å®é™…åº”ç”¨ç¤ºä¾‹-7" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-7"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h4><p>è€ƒè™‘ä½ æ­£åœ¨æ„å»ºä¸€ä¸ªåŸºäº Node.js çš„ç½‘ç»œæœåŠ¡ï¼Œæ¯”å¦‚ä¸€æ¬¾ç¤¾äº¤åª’ä½“åº”ç”¨ã€‚åœ¨è¿™æ ·çš„åº”ç”¨ä¸­ï¼Œå“åº”æ—¶é—´æ˜¯å½±å“ç”¨æˆ·ä½“éªŒçš„å…³é”®å› ç´ ä¹‹ä¸€ã€‚é€šè¿‡ç›‘æµ‹è¯·æ±‚å¤„ç†æ—¶é—´ï¼Œä½ å¯ä»¥ç¡®ä¿ç³»ç»Ÿè¿è¡Œæµç•…ï¼Œæä¾›è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼šè¿½è¸ª API å“åº”æ—¶é—´</strong></p><p>å‡è®¾ä½ æƒ³è¦ç›‘æ§æ¯ä¸ª API è¯·æ±‚çš„å¤„ç†æ—¶é—´ï¼Œä»¥ç¡®ä¿å¤§éƒ¨åˆ†è¯·æ±‚éƒ½èƒ½åœ¨é¢„æœŸçš„æ—¶é—´å†…å®Œæˆã€‚è¿™é‡Œå°±å¯ä»¥åˆ©ç”¨<code>histogram</code>å¯¹è±¡æ¥å®ç°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªç›´æ–¹å›¾ï¼Œæ­¤å¤„ä»¥æ¯«ç§’ä¸ºå•ä½</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> histogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç›‘è§†performanceäº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entry</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> of</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ¯å½“æœ‰æ–°çš„æ€§èƒ½æ¡ç›®æ—¶ï¼Œæ›´æ–°ç›´æ–¹å›¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Recorded: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ms`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffered</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹ŸAPIè¯·æ±‚å¤„ç†</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;API request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥è¶…è¿‡é¢„è®¾é˜ˆå€¼çš„æƒ…å†µ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Exceed Count: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exceeds</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªç›´æ–¹å›¾å¯¹è±¡æ¥æ”¶é›†å’Œè·Ÿè¸ª API è¯·æ±‚çš„å¤„ç†æ—¶é—´ã€‚ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡<code>PerformanceObserver</code>æ¥ç›‘å¬æ€§èƒ½æ¡ç›®ï¼ˆè¿™é‡ŒæŒ‡çš„æ˜¯ API è¯·æ±‚å¤„ç†çš„æ—¶é—´ï¼‰ã€‚æ¯å½“ä¸€ä¸ªæ–°çš„æ€§èƒ½æ¡ç›®è¢«è®°å½•æ—¶ï¼Œæˆ‘ä»¬å°±æŠŠå®ƒçš„æŒç»­æ—¶é—´è®°å½•åˆ°ç›´æ–¹å›¾ä¸­ã€‚æœ€åï¼Œæˆ‘ä»¬æ£€æŸ¥<code>histogram.exceeds</code>æ¥å¾—çŸ¥æœ‰å¤šå°‘è¯·æ±‚çš„å¤„ç†æ—¶é—´è¶…è¿‡äº†æˆ‘ä»¬çš„é¢„æœŸé˜ˆå€¼ã€‚</p><p><strong>ç¤ºä¾‹ 2ï¼šä¼˜åŒ–èµ„æºåŠ è½½æ—¶é—´</strong></p><p>å¦ä¸€ä¸ªå¸¸è§çš„ç”¨ä¾‹æ˜¯ä¼˜åŒ–ç½‘ç«™çš„èµ„æºåŠ è½½æ—¶é—´ã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½æƒ³è¦è¿½è¸ªå’Œæ”¹å–„å›¾ç‰‡æˆ–è§†é¢‘å†…å®¹çš„åŠ è½½æ—¶é—´ã€‚é€šè¿‡ç›‘æµ‹åŠ è½½æ—¶é—´ï¼Œä½ å¯ä»¥ç¡®å®šå“ªäº›èµ„æºåŠ è½½è¾ƒæ…¢ï¼Œå¹¶å¯¹å®ƒä»¬è¿›è¡Œä¼˜åŒ–ï¼Œæ¯”å¦‚é€šè¿‡æ›´æ¢æ ¼å¼ã€å‹ç¼©æ–‡ä»¶å¤§å°æˆ–æ”¹è¿›æœåŠ¡å™¨å“åº”é€Ÿåº¦ç­‰æ–¹å¼ã€‚</p><p>è¿™äº›ä¾‹å­å±•ç¤ºäº†<code>histogram.exceeds</code>åœ¨å®é™…åº”ç”¨ä¸­çš„ç”¨é€”â€”â€”å¸®åŠ©å¼€å‘è€…é€šè¿‡è·Ÿè¸ªå’Œä¼˜åŒ–å»¶è¿Ÿæ•æ„Ÿå‹æ“ä½œæ¥æå‡åº”ç”¨æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚</p><h3 id="histogram-exceedsbigint" tabindex="-1"><a class="header-anchor" href="#histogram-exceedsbigint"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogramexceedsbigint" target="_blank" rel="noopener noreferrer">histogram.exceedsBigInt</a></span></a></h3><p>Node.js ä½œä¸ºä¸€ä¸ªåœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç çš„ç¯å¢ƒï¼Œæä¾›äº†å¤§é‡çš„ API æ¥å¸®åŠ©å¼€å‘è€…æ„å»ºé«˜æ€§èƒ½çš„ç½‘ç»œåº”ç”¨ã€‚<code>histogram.exceedsBigInt</code> æ˜¯è¿™äº› API ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå±äº Node.js ä¸­çš„ <code>perf_hooks</code> æ¨¡å—ã€‚ä¸ºäº†æ›´å¥½åœ°ç†è§£å®ƒï¼Œè®©æˆ‘ä»¬å…ˆé€æ­¥äº†è§£å‡ ä¸ªç›¸å…³æ¦‚å¿µã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-6" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-6"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><h4 id="_1-performance-hooks-perf-hooks" tabindex="-1"><a class="header-anchor" href="#_1-performance-hooks-perf-hooks"><span>1. Performance Hooks (<code>perf_hooks</code>)</span></a></h4><p>Performance Hooksï¼ˆæ€§èƒ½é’©å­ï¼‰æä¾›äº†ç›‘è§† Node.js åº”ç”¨ç¨‹åºæ€§èƒ½çš„èƒ½åŠ›ã€‚è¿™ä¸ªæ¨¡å—å¯ä»¥ç”¨æ¥æ”¶é›†æ€§èƒ½æŒ‡æ ‡ï¼Œæ¯”å¦‚æ“ä½œçš„è€—æ—¶ç­‰ã€‚è¿™å¯¹äºæ€§èƒ½è°ƒä¼˜éå¸¸æœ‰å¸®åŠ©ã€‚</p><h4 id="_2-histogram" tabindex="-1"><a class="header-anchor" href="#_2-histogram"><span>2. Histogram</span></a></h4><p>Histogramï¼ˆç›´æ–¹å›¾ï¼‰æ˜¯<code>perf_hooks</code>ä¸­çš„ä¸€ä¸ªå·¥å…·ï¼Œç”¨äºç»Ÿè®¡å’Œåˆ†ææ•°æ®ç‚¹ï¼ˆæ¯”å¦‚æ—¶é—´é—´éš”æˆ–è€…æ“ä½œè€—æ—¶ï¼‰ã€‚é€šè¿‡ç›´æ–¹å›¾ï¼Œä½ å¯ä»¥è·å¾—æœ€å°å€¼ã€æœ€å¤§å€¼ã€å¹³å‡å€¼ã€æ ‡å‡†å·®ç­‰ç»Ÿè®¡ä¿¡æ¯ã€‚åœ¨ Node.js ä¸­ï¼ŒHistogram æ˜¯ä»¥æ€§èƒ½åº¦é‡ç‰¹å®šäº‹ä»¶çš„å»¶è¿Ÿæˆ–æŒç»­æ—¶é—´çš„æ–¹å¼å®ç°çš„ã€‚</p><h4 id="_3-bigint" tabindex="-1"><a class="header-anchor" href="#_3-bigint"><span>3. BigInt</span></a></h4><p>BigInt æ˜¯ä¸€ç§å†…ç½®å¯¹è±¡ï¼Œå®ƒæä¾›äº†ä¸€ç§æ–¹å¼æ¥è¡¨ç¤ºå¤§äº 2^53 - 1 çš„æ•´æ•°ã€‚è¿™åœ¨å¤„ç†éå¸¸å¤§çš„æ•°å€¼æ—¶éå¸¸æœ‰ç”¨ï¼Œå› ä¸º JavaScript ä¸­çš„ Number ç±»å‹ä¸èƒ½ç²¾ç¡®è¡¨ç¤ºè¿™ä¹ˆå¤§çš„æ•°å€¼ã€‚</p><h3 id="histogram-exceedsbigint-1" tabindex="-1"><a class="header-anchor" href="#histogram-exceedsbigint-1"><span>histogram.exceedsBigInt</span></a></h3><p><code>histogram.exceedsBigInt</code> å±æ€§æ˜¯ Histogram å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒè¿”å›ä¸€ä¸ª BigInt ç±»å‹çš„å€¼ï¼Œè¡¨ç¤ºå·²è§‚å¯Ÿåˆ°çš„æ‰€æœ‰è®°å½•å€¼ä¸­è¶…è¿‡ç›´æ–¹å›¾è·Ÿè¸ªçš„æœ€å¤§é˜ˆå€¼ï¼ˆthresholdï¼‰çš„æ¬¡æ•°ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå®ƒç”¨æ¥ç»Ÿè®¡åœ¨ä¸€ç³»åˆ—æ€§èƒ½åº¦é‡ä¸­ï¼Œæœ‰å¤šå°‘æ¬¡æ˜¯è¶…å‡ºäº†æˆ‘ä»¬è®¾ç½®çš„æœ€å¤§æœŸæœ›å€¼çš„ã€‚</p><h4 id="åº”ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#åº”ç”¨ç¤ºä¾‹"><span>åº”ç”¨ç¤ºä¾‹</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web æœåŠ¡ï¼Œè¯¥æœåŠ¡éœ€è¦å¤„ç†ç”¨æˆ·çš„è¯·æ±‚å¹¶è¿”å›å“åº”ã€‚æ˜¾ç„¶ï¼Œå¿«é€Ÿå“åº”æ˜¯æå‡ç”¨æˆ·ä½“éªŒçš„å…³é”®ã€‚äºæ˜¯ï¼Œä½ å¯èƒ½ä¼šæƒ³ç›‘æ§å¤„ç†è¯·æ±‚çš„æ—¶é—´ï¼Œç¡®ä¿å¤§å¤šæ•°è¯·æ±‚èƒ½åœ¨æŸä¸ªå¯æ¥å—çš„æ—¶é—´èŒƒå›´å†…å®Œæˆã€‚è¿™é‡Œå°±å¯ä»¥ä½¿ç”¨<code>perf_hooks</code>æ¨¡å—æ¥å®ç°ç›‘æ§ã€‚</p><ol><li><strong>åˆ›å»º Histogram</strong>: é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª Histogram å®ä¾‹ï¼Œç”¨äºæ”¶é›†å¤„ç†è¯·æ±‚æ‰€éœ€çš„æ—¶é—´æ•°æ®ç‚¹ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªHistogramå®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> histogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>æ”¶é›†æ•°æ®</strong>: æ¯å½“å¤„ç†ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œæˆ‘ä»¬è®°å½•ä¸‹å¼€å§‹å’Œç»“æŸçš„æ—¶é—´ï¼Œç„¶åå°†æ—¶é—´å·®ï¼ˆä¹Ÿå°±æ˜¯å¤„ç†æ—¶é—´ï¼‰æ·»åŠ åˆ°æˆ‘ä»¬çš„ Histogram ä¸­ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> handleRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯·æ±‚å¼€å§‹å‰çš„æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ...å¤„ç†è¯·æ±‚...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯·æ±‚ç»“æŸåçš„æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®°å½•å¤„ç†è¯·æ±‚æ‰€éœ€çš„æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>åˆ†æç»“æœ</strong>: å‡è®¾æˆ‘ä»¬å¸Œæœ›ç»å¤§å¤šæ•°è¯·æ±‚éƒ½èƒ½åœ¨ 100 æ¯«ç§’å†…å®Œæˆã€‚æˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªé˜ˆå€¼ï¼Œå¹¶æ£€æŸ¥è¶…å‡ºè¿™ä¸ªé˜ˆå€¼çš„è¯·æ±‚æ•°é‡ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®ç›´æ–¹å›¾çš„æœ€å¤§é˜ˆå€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">max</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–è¶…å‡ºé˜ˆå€¼çš„æ¬¡æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> exceedsCount</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exceedsBigInt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è¶…å‡º100æ¯«ç§’çš„è¯·æ±‚æ•°: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exceedsCount</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡æŒç»­ç›‘æµ‹å’Œåˆ†æè¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è¯„ä¼° Web æœåŠ¡çš„æ€§èƒ½ï¼Œå¹¶åœ¨å¿…è¦æ—¶è¿›è¡Œä¼˜åŒ–ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå‘ç°è¶…å‡ºé˜ˆå€¼çš„è¯·æ±‚å¤ªå¤šï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æŸ¥æ‰¾æ€§èƒ½ç“¶é¢ˆå¹¶è§£å†³é—®é¢˜ï¼Œæˆ–è€…å¢åŠ èµ„æºæ¥å¤„ç†æ›´å¤šçš„è¯·æ±‚ã€‚</p><p>æ€»ä¹‹ï¼Œ<code>histogram.exceedsBigInt</code> åœ¨ Node.js æ€§èƒ½åˆ†æå’Œä¼˜åŒ–ä¸­æ‰®æ¼”ç€é‡è¦è§’è‰²ï¼Œå®ƒå¸®åŠ©å¼€å‘è€…ç†è§£æ€§èƒ½æŒ‡æ ‡ï¼Œä»è€Œä½¿åº”ç”¨è¿è¡Œå¾—æ›´å¿«ã€æ›´ç¨³å®šã€‚</p><h3 id="histogram-max" tabindex="-1"><a class="header-anchor" href="#histogram-max"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogrammax" target="_blank" rel="noopener noreferrer">histogram.max</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>histogram.max</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå®ƒå±äºæ€§èƒ½é’©å­ï¼ˆPerformance Hooksï¼‰API çš„ä¸€éƒ¨åˆ†ã€‚è¿™ä¸ª API å…è®¸ä½ ç›‘æµ‹å’Œæµ‹é‡ä»£ç çš„æ€§èƒ½ã€‚åœ¨æˆ‘ä»¬æ·±å…¥æ¢è®¨ <code>histogram.max</code> ä¹‹å‰ï¼Œå…ˆç®€å•äº†è§£ä¸€ä¸‹ç›´æ–¹å›¾ï¼ˆHistogramï¼‰æ˜¯ä»€ä¹ˆã€‚</p><h3 id="ç›´æ–¹å›¾-histogram-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#ç›´æ–¹å›¾-histogram-ç®€ä»‹"><span>ç›´æ–¹å›¾ï¼ˆHistogramï¼‰ç®€ä»‹</span></a></h3><p>åœ¨æ€§èƒ½ç›‘æµ‹é¢†åŸŸï¼Œç›´æ–¹å›¾æ˜¯ä¸€ä¸ªé‡è¦å·¥å…·ï¼Œç”¨æ¥è®°å½•å¹¶å±•ç¤ºæŸä¸ªç‰¹å®šäº‹ä»¶æˆ–æ“ä½œçš„æŒç»­æ—¶é—´æˆ–å‘ç”Ÿæ¬¡æ•°ç­‰ç»Ÿè®¡ä¿¡æ¯çš„åˆ†å¸ƒæƒ…å†µã€‚æ¯”å¦‚è¯´ï¼Œä½ å¯ä»¥ä½¿ç”¨ç›´æ–¹å›¾æ¥è®°å½•ä¸€ä¸ªç½‘ç»œè¯·æ±‚å“åº”çš„æ—¶é—´åˆ†å¸ƒï¼Œä»è€Œäº†è§£å¤§å¤šæ•°è¯·æ±‚æ˜¯å¿«é€Ÿå“åº”è¿˜æ˜¯æ…¢æ…¢å“åº”ã€‚</p><h3 id="node-js-ä¸­çš„-histogram-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#node-js-ä¸­çš„-histogram-å¯¹è±¡"><span>Node.js ä¸­çš„ Histogram å¯¹è±¡</span></a></h3><p>åœ¨ Node.js é‡Œï¼Œ<code>Histogram</code> å¯¹è±¡æä¾›äº†ä¸€ä¸ªé«˜æ€§èƒ½çš„ç›´æ–¹å›¾å®ç°ã€‚è¿™ä¸ªå¯¹è±¡å…è®¸ä½ æ”¶é›†å’Œåˆ†ææ•°æ®ç‚¹ï¼ˆæ¯”å¦‚æ—¶é—´ã€é¢‘ç‡ç­‰ï¼‰ã€‚<code>Histogram</code> å¯¹è±¡æœ‰å‡ ä¸ªå…³é”®çš„å±æ€§å’Œæ–¹æ³•ï¼Œå…¶ä¸­ <code>max</code> å°±æ˜¯ä¸€ä¸ªå±æ€§ã€‚</p><h3 id="histogram-max-1" tabindex="-1"><a class="header-anchor" href="#histogram-max-1"><span>Histogram.max</span></a></h3><p><code>histogram.max</code> è¿™ä¸ªå±æ€§è¿”å›ç›´æ–¹å›¾ä¸­è®°å½•çš„æœ€å¤§å€¼ã€‚ç®€å•æ¥è¯´ï¼Œå¦‚æœä½ æ­£åœ¨è®°å½•ä¸€ç³»åˆ—äº‹ä»¶çš„æŒç»­æ—¶é—´ï¼Œ<code>histogram.max</code> å°†ä¼šå‘Šè¯‰ä½ è¿™äº›äº‹ä»¶ä¸­æŒç»­æ—¶é—´æœ€é•¿çš„æ˜¯å¤šä¹…ã€‚</p><h4 id="å®é™…åº”ç”¨ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-5"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h4><ol><li><p><strong>ç½‘ç«™å“åº”æ—¶é—´ç›‘æµ‹</strong><br> å‡è®¾ä½ æ­£åœ¨è¿è¡Œä¸€ä¸ªç½‘ç«™ï¼Œå¹¶å¸Œæœ›ç›‘æµ‹æœåŠ¡å™¨å¤„ç†è¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ª <code>Histogram</code> æ¥è®°å½•æ¯ä¸ªè¯·æ±‚çš„å¤„ç†æ—¶é—´ã€‚é€šè¿‡æŸ¥çœ‹ <code>histogram.max</code> çš„å€¼ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°çŸ¥é“æœ€æ…¢çš„è¯·æ±‚è€—æ—¶ï¼Œè¿™å¯¹äºè¯†åˆ«å’Œä¼˜åŒ–æ…¢æŸ¥è¯¢éå¸¸æœ‰å¸®åŠ©ã€‚</p></li><li><p><strong>API è°ƒç”¨æ€§èƒ½åˆ†æ</strong><br> å¦‚æœä½ çš„åº”ç”¨ä¾èµ–äºå¤šä¸ªå¤–éƒ¨ APIï¼Œä½¿ç”¨ <code>Histogram</code> æ¥è·Ÿè¸ªæ¯ä¸ª API è°ƒç”¨æ‰€éœ€çš„æ—¶é—´å˜å¾—éå¸¸æœ‰æ„ä¹‰ã€‚è¿™æ ·ä¸ä»…å¯ä»¥å¸®åŠ©ä½ äº†è§£æ•´ä½“çš„ API æ€§èƒ½ï¼Œè¿˜èƒ½é€šè¿‡ <code>histogram.max</code> æŸ¥çœ‹åˆ°æœ€é•¿çš„ API è°ƒç”¨å»¶è¿Ÿï¼Œä»è€Œå¯¹ç‰¹å®šçš„æ€§èƒ½ç“¶é¢ˆè¿›è¡Œä¼˜åŒ–ã€‚</p></li><li><p><strong>ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ</strong><br> å¦ä¸€ä¸ªå¯èƒ½çš„åº”ç”¨åœºæ™¯æ˜¯ç›‘æµ‹ç³»ç»Ÿèµ„æºï¼ˆå¦‚ CPUã€å†…å­˜ä½¿ç”¨ç‡ï¼‰çš„ä½¿ç”¨æƒ…å†µã€‚é€šè¿‡è®°å½•ä¸€æ®µæ—¶é—´å†…çš„æœ€å¤§å€¼ï¼Œå¯ä»¥å¸®åŠ©ä½ ç†è§£ç³»ç»Ÿåœ¨é«˜è´Ÿè½½ä¸‹çš„è¡¨ç°ã€‚</p></li></ol><h3 id="å¦‚ä½•ä½¿ç”¨-histogram-max" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-histogram-max"><span>å¦‚ä½•ä½¿ç”¨ Histogram.max</span></a></h3><p>é¦–å…ˆï¼Œä½ éœ€è¦å¯¼å…¥å¹¶ä½¿ç”¨ Node.js çš„æ€§èƒ½é’©å­æ¨¡å—ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ–°çš„Histogramå®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> histogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// çœ‹å‡å¦‚æœ‰ä¸€äº›æ•°æ®å·²ç»è¢«æ·»åŠ åˆ°ç›´æ–¹å›¾</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¾‹å¦‚: for (let i = 0; i `&lt;` 100; i++) { histogram.record(i); }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">max</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç›´æ–¹å›¾ä¸­è®°å½•çš„æœ€å¤§å€¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç ç‰‡æ®µå±•ç¤ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ª <code>Histogram</code> å®ä¾‹ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ <code>max</code> å±æ€§æ¥è·å–ç›´æ–¹å›¾ä¸­çš„æœ€å¤§å€¼ã€‚è®°ä½ï¼Œå®é™…ä½¿ç”¨ä¸­ä½ ä¼šæ ¹æ®è‡ªå·±ç›‘æµ‹çš„éœ€æ±‚æ¥è®°å½•ç›¸åº”çš„æ•°æ®ç‚¹ã€‚</p><p>æ€»ç»“èµ·æ¥ï¼Œ<code>histogram.max</code> æ˜¯ Node.js ä¸­æ€§èƒ½é’©å­ API çš„ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å±æ€§ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ ç†è§£ä½ çš„åº”ç”¨æˆ–ç³»ç»Ÿåœ¨å„ç§æ€§èƒ½æ–¹é¢çš„æé™è¡¨ç°ï¼Œå¯¹äºæ€§èƒ½è°ƒä¼˜å’Œç¡®ä¿è‰¯å¥½ç”¨æˆ·ä½“éªŒè‡³å…³é‡è¦ã€‚</p><h3 id="histogram-maxbigint" tabindex="-1"><a class="header-anchor" href="#histogram-maxbigint"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogrammaxbigint" target="_blank" rel="noopener noreferrer">histogram.maxBigInt</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©ä½ èƒ½å¤Ÿåœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ä¸ªåä¸º <code>perf_hooks</code> çš„æ¨¡å—ï¼Œå®ƒæä¾›äº†ç”¨äºæ€§èƒ½ç›‘æµ‹çš„é’©å­ï¼ˆhooksï¼‰ã€‚è¿™ä¸ªæ¨¡å—ä¸­çš„ä¸€é¡¹åŠŸèƒ½æ˜¯ Histogramï¼ˆç›´æ–¹å›¾ï¼‰ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ æ”¶é›†å’Œåˆ†ææ€§èƒ½æ•°æ®ã€‚</p><p><code>histogram.maxBigInt</code> æ˜¯ <code>perf_hooks</code> æ¨¡å—ä¸­ Histogram å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒè¿”å›ç›´æ–¹å›¾æ‰€è®°å½•çš„æœ€å¤§å€¼ï¼Œä½†ä¸ <code>histogram.max</code> ä¸åŒçš„æ˜¯ï¼Œ<code>histogram.maxBigInt</code> è¿”å›çš„æ˜¯ä¸€ä¸ª BigInt ç±»å‹çš„å€¼ï¼Œè€Œä¸æ˜¯æ™®é€šçš„æ•°å­—ï¼ˆNumberï¼‰ç±»å‹ã€‚BigInt æ˜¯ä¸€ç§åœ¨ JavaScript ä¸­è¡¨ç¤ºå¤§æ•´æ•°çš„ç±»å‹ã€‚</p><h3 id="å®é™…åº”ç”¨ä¸¾ä¾‹-2" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¸¾ä¾‹-2"><span>å®é™…åº”ç”¨ä¸¾ä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œéœ€è¦ç›‘æ§æŸäº›æ“ä½œçš„æ‰§è¡Œæ—¶é—´ï¼Œç¡®ä¿å®ƒä»¬æ‰§è¡Œå¾—è¶³å¤Ÿå¿«ï¼Œå¹¶ä¸”æƒ³äº†è§£åœ¨å¤§é‡æ ·æœ¬ä¸­æœ€é•¿çš„æ‰§è¡Œæ—¶é—´ã€‚åœ¨è¿™é‡Œï¼ŒHistogram å’Œ <code>histogram.maxBigInt</code> å°±æ´¾ä¸Šäº†ç”¨åœºã€‚</p><h4 id="æ­¥éª¤-1-å¼•å…¥æ¨¡å—å¹¶åˆ›å»º-histogram" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-1-å¼•å…¥æ¨¡å—å¹¶åˆ›å»º-histogram"><span>æ­¥éª¤ 1ï¼šå¼•å…¥æ¨¡å—å¹¶åˆ›å»º Histogram</span></a></h4><p>é¦–å…ˆï¼Œä½ éœ€è¦å¼•å…¥ <code>perf_hooks</code> æ¨¡å—ï¼Œå¹¶ä½¿ç”¨å…¶ä¸­çš„ <code>performance</code> åˆ›å»ºä¸€ä¸ª Histogram å®ä¾‹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª Histogram å®ä¾‹æ¥ç›‘æ§æŸä¸ªæŒ‡æ ‡ï¼Œä¾‹å¦‚ HTTP è¯·æ±‚æ—¶å»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> httpReqDurationHistogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ­¥éª¤-2-æ”¶é›†æ•°æ®" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-2-æ”¶é›†æ•°æ®"><span>æ­¥éª¤ 2ï¼šæ”¶é›†æ•°æ®</span></a></h4><p>éšåï¼Œåœ¨ä½ çš„åº”ç”¨ä¸­ï¼Œæ¯æ¬¡ HTTP è¯·æ±‚å®Œæˆæ—¶ï¼Œä½ å¯ä»¥å°†è¯¥è¯·æ±‚çš„è€—æ—¶ï¼ˆæ¯”å¦‚ä»¥æ¯«ç§’è®¡ï¼‰è®°å½•åˆ°ä½ ä¹‹å‰åˆ›å»ºçš„ Histogram å®ä¾‹ä¸­ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> recordHttpRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾ duration æ˜¯ä»¥æ¯«ç§’è®¡çš„è¯·æ±‚æ—¶å»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  httpReqDurationHistogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ­¥éª¤-3-åˆ†ææœ€å¤§å€¼" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-3-åˆ†ææœ€å¤§å€¼"><span>æ­¥éª¤ 3ï¼šåˆ†ææœ€å¤§å€¼</span></a></h4><p>åœ¨ä¸€æ®µæ—¶é—´åï¼Œä½ å¯èƒ½æƒ³è¦äº†è§£ä½ ç›‘æ§çš„è¿™ä¸ªæ€§èƒ½æŒ‡æ ‡çš„æœ€å¤§å€¼ï¼Œä»¥ä¾¿ç†è§£æ€§èƒ½ç“¶é¢ˆæˆ–å¼‚å¸¸æƒ…å†µã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> analyzeMaxHttpRequestDuration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä½¿ç”¨ histogram.maxBigInt è·å–æœ€å¤§è¯·æ±‚æ—¶å»¶çš„ BigInt å€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> maxDuration</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> httpReqDurationHistogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">maxBigInt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æœ€å¤§ HTTP è¯·æ±‚æ—¶å»¶: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">maxDuration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å°±å¯ä»¥ç›‘æ§å¹¶åˆ†æä½ çš„ Node.js åº”ç”¨ä¸­æŸäº›å…³é”®æ“ä½œçš„æ€§èƒ½æŒ‡æ ‡ï¼Œæ¯”å¦‚ HTTP è¯·æ±‚çš„å¤„ç†æ—¶é—´ã€‚ä½¿ç”¨ <code>histogram.maxBigInt</code> å¯ä»¥ç¡®ä¿å³ä½¿åœ¨æç«¯æƒ…å†µä¸‹ï¼Œä¹Ÿèƒ½å‡†ç¡®æ— è¯¯åœ°è¡¨ç¤ºéå¸¸å¤§çš„æ•°å€¼ã€‚</p><p>è¿™ç§æ€§èƒ½ç›‘æ§æŠ€æœ¯å¯¹äºä¼˜åŒ–åº”ç”¨æ€§èƒ½ã€åŠæ—¶å‘ç°å’Œè§£å†³ç“¶é¢ˆé—®é¢˜éå¸¸é‡è¦ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤§é‡æ•°æ®æˆ–éœ€è¦é«˜æ€§èƒ½çš„å®æ—¶åº”ç”¨ä¸­ã€‚</p><h3 id="histogram-mean" tabindex="-1"><a class="header-anchor" href="#histogram-mean"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogrammean" target="_blank" rel="noopener noreferrer">histogram.mean</a></span></a></h3><p>Node.js ä¸­çš„ <code>histogram.mean</code> æ˜¯æ€§èƒ½ç›‘æ§å·¥å…·ä¸­ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œå®ƒå±äº Node.js çš„ <code>perf_hooks</code> æ¨¡å—ã€‚åœ¨è§£é‡Š <code>histogram.mean</code> ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ç›´æ–¹å›¾ï¼ˆHistogramï¼‰å’Œå®ƒåœ¨æ€§èƒ½ç›‘æ§ä¸­çš„ä½œç”¨ã€‚</p><h3 id="ç›´æ–¹å›¾-histogram" tabindex="-1"><a class="header-anchor" href="#ç›´æ–¹å›¾-histogram"><span>ç›´æ–¹å›¾ï¼ˆHistogramï¼‰</span></a></h3><p>ç›´æ–¹å›¾æ˜¯ä¸€ç§ç»Ÿè®¡æŠ¥å‘Šå›¾ï¼Œç”¨äºå±•ç¤ºä¸€ç³»åˆ—æ•°æ®ç‚¹åˆ†å¸ƒæƒ…å†µçš„å›¾è¡¨ã€‚åœ¨æ€§èƒ½ç›‘æ§ä¸­ï¼Œè¿™äº›æ•°æ®ç‚¹é€šå¸¸ä»£è¡¨ç¨‹åºä¸­æŸä¸ªæ“ä½œçš„å®Œæˆæ—¶é—´æˆ–è€…å…¶ä»–åº¦é‡æŒ‡æ ‡çš„é›†åˆã€‚</p><h3 id="histogram-mean-1" tabindex="-1"><a class="header-anchor" href="#histogram-mean-1"><span>Histogram.mean</span></a></h3><p>åœ¨ Node.js çš„æ€§èƒ½é’©å­ (<code>perf_hooks</code>) æ¨¡å—ä¸­ï¼Œ<code>histogram</code> å¯¹è±¡æä¾›äº†å¯¹äºæ€§èƒ½åº¦é‡æ•°æ®çš„ç›´æ–¹å›¾è¡¨ç¤ºã€‚è¿™å…¶ä¸­çš„ <code>.mean</code> å±æ€§ç»™å‡ºäº†æ‰€æœ‰è®°å½•å€¼çš„å¹³å‡å€¼ã€‚ç®€å•æ¥è¯´ï¼Œå¦‚æœä½ è®°å½•äº†ä¸€ç³»åˆ—æ“ä½œçš„å®Œæˆæ—¶é—´ï¼Œ<code>histogram.mean</code> å°±ä¼šè®¡ç®—è¿™äº›å®Œæˆæ—¶é—´çš„å¹³å‡å€¼ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-6" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-6"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>ä¸¾ä¸€ä¸ªå®é™…çš„ä¾‹å­æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨ <code>histogram.mean</code>ï¼š</p><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œå¹¶æƒ³ç›‘æµ‹å¤„ç† HTTP è¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚ä¸ºäº†è·å–è¿™ä¸ªä¿¡æ¯ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>perf_hooks</code> æ¨¡å—ä¸­çš„åŠŸèƒ½æ¥æ”¶é›†å¤„ç†è¯·æ±‚æ‰€éœ€æ—¶é—´çš„æ•°æ®ï¼Œå¹¶è®¡ç®—å¹³å‡å¤„ç†æ—¶é—´ã€‚</p><p>æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p><strong>å¯¼å…¥ perf_hooks æ¨¡å—</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><strong>è®¾ç½®ä¸€ä¸ª observer æ¥è§‚å¯Ÿå’Œæ”¶é›†æ€§èƒ½æ¡ç›®</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    `Average HTTP request processing time: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      items</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">()[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">    }</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ms`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clearMarks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>åœ¨å¤„ç† HTTP è¯·æ±‚çš„é€»è¾‘ä¸­æ·»åŠ æ€§èƒ½æ ‡è®°</strong></p><p>å‡è®¾ä½ ä½¿ç”¨ Express.js æ¡†æ¶åˆ›å»ºæœåŠ¡å™¨ï¼Œä½ å¯èƒ½ä¼šå†™å‡ºå¦‚ä¸‹ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> express</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;express&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> app</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> express</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼€å§‹æ ‡è®°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œï¼Œæ¯”å¦‚æ•°æ®åº“æŸ¥è¯¢</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç»“æŸæ ‡è®°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;HTTP Request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹é‡ä» A åˆ° B çš„æ—¶é—´</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Math</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">random</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// éšæœºå»¶è¿Ÿå“åº”æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Server running on port 3000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ¯å½“æœ‰ HTTP è¯·æ±‚æ—¶ï¼Œæˆ‘ä»¬éƒ½ä¼šæµ‹é‡å¤„ç†è¿™ä¸ªè¯·æ±‚çš„æ—¶é—´ï¼Œå¹¶é€šè¿‡ <code>PerformanceObserver</code> æ‰“å°å‡ºå¹³å‡å¤„ç†æ—¶é—´ã€‚</p></li></ol><p>æ³¨æ„ï¼šä¸Šè¿°ç¤ºä¾‹ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤º <code>perf_hooks</code> çš„ä½¿ç”¨ï¼Œå®é™…çš„åº”ç”¨åœºæ™¯ä¸­è¿˜éœ€è¦è€ƒè™‘æ›´å¤šç»†èŠ‚ï¼Œæ¯”å¦‚å¦‚ä½•æ›´å‡†ç¡®åœ°æ”¶é›†å’Œåˆ†æå¤§é‡æ•°æ®ç‚¹ã€‚</p><p>æ€»ä¹‹ï¼Œ<code>histogram.mean</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä½ ç†è§£åº”ç”¨çš„æ€§èƒ½ç‰¹å¾ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦ç›‘æ§å’Œæ”¹è¿›å¤„ç†æ—¶é—´ç­‰æŒ‡æ ‡æ—¶ã€‚</p><h3 id="histogram-min" tabindex="-1"><a class="header-anchor" href="#histogram-min"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogrammin" target="_blank" rel="noopener noreferrer">histogram.min</a></span></a></h3><p>å½“ä½ å¼€å§‹æ¢ç´¢ Node.js, ç‰¹åˆ«æ˜¯å®ƒçš„æ€§èƒ½ç›‘æµ‹å·¥å…·æ—¶ï¼Œäº†è§£<code>histogram.min</code>ä¼šéå¸¸æœ‰å¸®åŠ©ã€‚åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>histogram.min</code>æ˜¯ä¸€ä¸ªä¸æ€§èƒ½é’©å­(perf_hooks)æ¨¡å—ç›¸å…³çš„å±æ€§ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†é€æ­¥äº†è§£å®ƒçš„ä½œç”¨åŠåº”ç”¨åœºæ™¯ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-histogram" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-histogram"><span>ä»€ä¹ˆæ˜¯ Histogramï¼Ÿ</span></a></h3><p>åœ¨æ·±å…¥äº†è§£<code>histogram.min</code>ä¹‹å‰ï¼Œé¦–å…ˆè®©æˆ‘ä»¬å¼„æ¸…æ¥š Histogram çš„æ¦‚å¿µã€‚Histogramï¼ˆç›´æ–¹å›¾ï¼‰æ˜¯ä¸€ç§ç»Ÿè®¡å›¾è¡¨ï¼Œç”¨äºå±•ç¤ºä¸€ç³»åˆ—æ•°æ®ç‚¹åˆ†å¸ƒæƒ…å†µã€‚åœ¨ Node.js çš„æ€§èƒ½ç›‘æµ‹(context)ä¸­ï¼ŒHistogram ç”¨æ¥è®°å½•å’Œæµ‹é‡å¦‚äº‹ä»¶æŒç»­æ—¶é—´æˆ–é—´éš”ç­‰æŒ‡æ ‡çš„åˆ†å¸ƒæƒ…å†µã€‚</p><h3 id="histogram-min-å±æ€§" tabindex="-1"><a class="header-anchor" href="#histogram-min-å±æ€§"><span>histogram.min å±æ€§</span></a></h3><p>åœ¨ Node.js ä¸­<code>histogram.min</code>å±æ€§ä»£è¡¨çš„æ˜¯ç›´æ–¹å›¾ä¸­è®°å½•çš„æœ€å°å€¼ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœä½ åœ¨æµ‹é‡ä¾‹å¦‚ HTTP è¯·æ±‚å“åº”æ—¶é—´ã€æ–‡ä»¶è¯»å†™æ“ä½œè€—æ—¶ç­‰ï¼Œ<code>histogram.min</code>ä¼šå‘Šè¯‰ä½ è¿™äº›æ“ä½œä¸­æœ€å¿«çš„è€—æ—¶æ˜¯å¤šå°‘ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-7" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-7"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œå¹¶æƒ³ç›‘æµ‹å¯¹æ•°æ®åº“çš„æŸ¥è¯¢é€Ÿåº¦ã€‚é€šè¿‡ä½¿ç”¨ Node.js çš„æ€§èƒ½é’©å­(perf_hooks)ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ª Histogram æ¥è®°å½•æ¯æ¬¡æŸ¥è¯¢æ“ä½œçš„è€—æ—¶ã€‚</p><ol><li><strong>ç›‘æµ‹æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½</strong>ï¼šä½ å¯ä»¥ä½¿ç”¨<code>perf_hooks</code>æ¨¡å—æ¥åˆ›å»ºä¸€ä¸ª Histogramï¼Œæ¯æ¬¡æ•°æ®åº“æŸ¥è¯¢å®Œæˆæ—¶ï¼Œä½ è®°å½•ä¸‹æŸ¥è¯¢æ‰€éœ€çš„æ—¶é—´ã€‚ä¹‹åï¼Œä½ å¯ä»¥é€šè¿‡æ£€æŸ¥<code>histogram.min</code>æ¥å¾—çŸ¥æ‰€æœ‰æŸ¥è¯¢ä¸­æœ€å¿«çš„ä¸€æ¬¡è€—æ—¶å¤šä¹…ã€‚</li></ol><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ€§èƒ½è§‚å¯Ÿè€…æ¥ç›‘æµ‹æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æœ€çŸ­æŸ¥è¯¢æ—¶é—´: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">items</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">()[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clearMarks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä¸€ä¸ªæ•°æ®åº“æŸ¥è¯¢çš„å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> queryDatabase</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start-query&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Math</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">random</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end-query&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;database-query&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start-query&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end-query&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">queryDatabase</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼šä¸Šè¿°ä»£ç ç¤ºä¾‹æ›´å¤šåœ°æ˜¯ä¸ºäº†è¯´æ˜å¦‚ä½•ä½¿ç”¨æ€§èƒ½é’©å­è¿›è¡Œç›‘æµ‹ï¼Œå¹¶ä¸ç›´æ¥ä½¿ç”¨<code>histogram.min</code>ã€‚è¦åœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨ Histogram å¯¹è±¡ä¸­çš„<code>min</code>å±æ€§ï¼Œä½ éœ€è¦ä½¿ç”¨<code>perf_hooks</code>æ¨¡å—ä¸­æ›´ä¸“é—¨çš„ APIï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><ol start="2"><li><strong>ä½¿ç”¨ Histogram è®°å½•å’Œè·å–æœ€å°å€¼</strong>:</li></ol><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">createHistogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªç›´æ–¹å›¾</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> histogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> createHistogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿè®°å½•ä¸€äº›æ“ä½œçš„è€—æ—¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æŸæ“ä½œè€—æ—¶100ms</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">150</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦ä¸€æ“ä½œè€—æ—¶150ms</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–å¹¶æ‰“å°æœ€å°è€—æ—¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">min</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 100</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ï¼Œ<code>histogram.min</code>å°±æä¾›äº†ä¸€ä¸ªéå¸¸ç›´è§‚çš„æ–¹å¼æ¥äº†è§£å„ç§æ“ä½œçš„æ€§èƒ½åº•çº¿ï¼Œå°¤å…¶åœ¨è¿›è¡Œæ€§èƒ½ä¼˜åŒ–æ—¶ï¼Œäº†è§£æœ€ä½³æ€§èƒ½è¡¨ç°è‡³å…³é‡è¦ã€‚</p><p>æ€»ä¹‹ï¼Œ<code>histogram.min</code>ä¸º Node.js ä¸­æ€§èƒ½ç›‘æµ‹æä¾›äº†ä¸€ä¸ªé‡è¦çš„æŒ‡æ ‡ï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥ç›´è§‚äº†è§£åˆ°ç¨‹åºä¸­æŸäº›æ“ä½œçš„æœ€ä½³æ€§èƒ½æ°´å¹³ï¼Œè¿™å¯¹äºæ€§èƒ½è°ƒä¼˜å’Œé—®é¢˜è¯Šæ–­éƒ½æ˜¯éå¸¸æœ‰ç”¨çš„ä¿¡æ¯ã€‚</p><h3 id="histogram-minbigint" tabindex="-1"><a class="header-anchor" href="#histogram-minbigint"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogramminbigint" target="_blank" rel="noopener noreferrer">histogram.minBigInt</a></span></a></h3><p>Node.js ä¸­çš„<code>histogram.minBigInt</code>æ˜¯æ€§èƒ½ç›‘æ§å·¥å…·ï¼ˆPerformance Hooksï¼‰ä¸­çš„ä¸€ä¸ªåŠŸèƒ½ç‚¹ï¼Œå®ƒå±äºæ€§èƒ½æŒ‡æ ‡ï¼ˆperformance metricsï¼‰çš„ä¸€ä¸ªæ–¹é¢ã€‚è¦ç†è§£<code>histogram.minBigInt</code>ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ä¸€äº›èƒŒæ™¯ä¿¡æ¯ã€‚</p><h3 id="ç›´è§‚ç†è§£-histogram-ç›´æ–¹å›¾" tabindex="-1"><a class="header-anchor" href="#ç›´è§‚ç†è§£-histogram-ç›´æ–¹å›¾"><span>ç›´è§‚ç†è§£ Histogramï¼ˆç›´æ–¹å›¾ï¼‰</span></a></h3><p>åœ¨ Node.js ä¸­ï¼ŒHistogram ä¸»è¦ç”¨æ¥æ”¶é›†å¹¶è®°å½•æ—¶é—´æ•°æ®ï¼ˆä¾‹å¦‚æ“ä½œçš„æŒç»­æ—¶é—´ï¼‰ï¼Œä»¥ä¾¿è¿›è¡Œæ€§èƒ½åˆ†æã€‚ä½ å¯ä»¥å°†å®ƒæƒ³è±¡æˆä¸€ä¸ªå®¹å™¨ï¼Œè¿™ä¸ªå®¹å™¨å¯ä»¥è®°å½•å¾ˆå¤šæ¬¡æ“ä½œçš„è€—æ—¶ï¼Œç„¶åå¸®åŠ©ä½ åˆ†æè¿™äº›æ•°æ®ï¼Œæ¯”å¦‚è®¡ç®—æœ€å°å€¼ã€æœ€å¤§å€¼ã€å¹³å‡å€¼ç­‰ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-bigint" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-bigint"><span>ä»€ä¹ˆæ˜¯ BigInt</span></a></h3><p>åœ¨ JavaScript ä¸­ï¼Œ<code>BigInt</code>æ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œå®ƒå¯ä»¥è¡¨ç¤ºéå¸¸å¤§çš„æ•´æ•°ã€‚å¯¹äº Node.js çš„æ€§èƒ½ç›‘æ§æ¥è¯´ï¼Œä¸ºä»€ä¹ˆéœ€è¦<code>BigInt</code>å‘¢ï¼Ÿå› ä¸ºå½“ä½ ç›‘æ§é«˜æ€§èƒ½åº”ç”¨æ—¶ï¼Œæ“ä½œçš„çº³ç§’çº§åˆ«çš„æ—¶é—´æµ‹é‡å¯èƒ½ä¼šè¶…è¶Šæ™®é€šæ•´æ•°ï¼ˆNumber ç±»å‹ï¼‰çš„æé™ï¼Œæ­¤æ—¶å°±éœ€è¦ä½¿ç”¨<code>BigInt</code>ã€‚</p><h3 id="histogram-minbigint-çš„ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#histogram-minbigint-çš„ä½œç”¨"><span>histogram.minBigInt çš„ä½œç”¨</span></a></h3><p>ç°åœ¨ï¼Œæ¥åˆ°é‡ç‚¹ï¼Œ<code>histogram.minBigInt</code>æ˜¯ç”¨æ¥è·å–è®°å½•åœ¨ Histogram ä¸­çš„æœ€å°æ—¶é—´å€¼ï¼Œè€Œä¸”è¿™ä¸ªæ—¶é—´å€¼æ˜¯ä»¥<code>BigInt</code>å½¢å¼è¡¨ç¤ºçš„ã€‚ç®€å•è¯´ï¼Œå®ƒèƒ½å‘Šè¯‰ä½ ï¼Œæ‰€æœ‰è¢«è¯¥ Histogram è®°å½•çš„æ“ä½œä¸­ï¼Œè€—æ—¶æœ€å°‘çš„é‚£ä¸ªæ“ä½œæ˜¯å¤šä¹…ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-17" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-17"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™ï¼Œå…¶ä¸­æ¶‰åŠåˆ°æ•°æ®åº“æŸ¥è¯¢ã€‚æ¯æ¬¡ç”¨æˆ·æ‰“å¼€ä¸€ä¸ªé¡µé¢æ—¶ï¼Œä½ çš„ä»£ç éƒ½éœ€è¦æŸ¥è¯¢æ•°æ®åº“æ¥è·å–æ•°æ®ã€‚ä¸ºäº†ç¡®ä¿ç”¨æˆ·ä½“éªŒï¼Œä½ æƒ³ç›‘æ§è¿™ä¸ªæ•°æ®åº“æŸ¥è¯¢æ“ä½œçš„æ€§èƒ½ã€‚</p><ol><li><p><strong>è®¾ç½® Histogram æ¥è®°å½•æ•°æ®åº“æŸ¥è¯¢æ—¶é—´</strong>ï¼š<br> é¦–å…ˆï¼Œä½ ä¼šç”¨ Node.js çš„æ€§èƒ½é’©å­ï¼ˆPerformance Hooksï¼‰åˆ›å»ºä¸€ä¸ª Histogram å®ä¾‹æ¥ä¸“é—¨è®°å½•æ•°æ®åº“æŸ¥è¯¢çš„è€—æ—¶ã€‚</p></li><li><p><strong>è®°å½•æ¯æ¬¡æŸ¥è¯¢çš„è€—æ—¶</strong>ï¼š<br> æ¯æ¬¡æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢æ—¶ï¼Œä½ ä¼šæŠŠè¿™æ¬¡æŸ¥è¯¢çš„è€—æ—¶è®°å½•åˆ° Histogram ä¸­ã€‚</p></li><li><p><strong>åˆ†ææ€§èƒ½</strong>ï¼š<br> åœ¨ä¸€æ®µæ—¶é—´åï¼Œæˆ–è€…åœ¨ç¨‹åºçš„æŸä¸ªç‰¹å®šæ—¶åˆ»ï¼Œä½ æƒ³åˆ†ææ•°æ®åº“æŸ¥è¯¢çš„æ€§èƒ½ã€‚è¿™æ—¶å€™ï¼Œ<code>histogram.minBigInt</code>å°±æ´¾ä¸Šç”¨åœºäº†ã€‚é€šè¿‡å®ƒï¼Œä½ å¯ä»¥å¾—çŸ¥æ‰€æœ‰æŸ¥è¯¢ä¸­ï¼Œå“ªä¸ªæ˜¯æœ€å¿«çš„ï¼Œå³è€—æ—¶æœ€å°‘ã€‚è¿™å¯¹äºè¯„ä¼°ç”¨æˆ·ä½“éªŒè‡³å…³é‡è¦ã€‚</p></li><li><p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼š<br> æœ‰äº†è¿™äº›æ•°æ®ï¼Œä½ å¯èƒ½ä¼šè¿›ä¸€æ­¥åˆ†æä¸ºä»€ä¹ˆæŸäº›æŸ¥è¯¢æ¯”å…¶ä»–çš„å¿«ï¼Œæ˜¯ä¸æ˜¯å› ä¸ºæ•°æ®ç¼“å­˜çš„åŸå› ï¼Œè¿˜æ˜¯æŸ¥è¯¢æœ¬èº«çš„æ•ˆç‡é—®é¢˜ã€‚æ ¹æ®è¿™äº›åˆ†æç»“æœï¼Œä½ å¯ä»¥é‡‡å–ç›¸åº”çš„ä¼˜åŒ–æªæ–½ã€‚</p></li></ol><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>histogram.minBigInt</code>åœ¨ Node.js ä¸­æä¾›äº†ä¸€ç§ç²¾ç¡®çš„æ–¹æ³•æ¥åˆ†æå’Œä¼˜åŒ–è½¯ä»¶æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†éœ€è¦é«˜ç²¾åº¦æ—¶é—´æµ‹é‡çš„é¢†åŸŸã€‚é€šè¿‡ä½¿ç”¨è¿™ä¸ªå·¥å…·ï¼Œå¼€å‘è€…å¯ä»¥è·å¾—å…³é”®çš„æ€§èƒ½æŒ‡æ ‡ï¼Œè¿›è€Œæ”¹å–„ç”¨æˆ·ä½“éªŒæˆ–ç³»ç»Ÿæ•ˆç‡ã€‚</p><h3 id="histogram-percentile-percentile" tabindex="-1"><a class="header-anchor" href="#histogram-percentile-percentile"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogrampercentilepercentile" target="_blank" rel="noopener noreferrer">histogram.percentile(percentile)</a></span></a></h3><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬äº†è§£ä¸€ä¸‹ Node.js ä¸­çš„<code>histogram.percentile(percentile)</code>æ˜¯ä»€ä¹ˆä»¥åŠå®ƒçš„ç”¨é€”ã€‚</p><p><strong>ä»€ä¹ˆæ˜¯ Histogramï¼Ÿ</strong></p><p>åœ¨ Node.js ä¸­ï¼ŒHistogramï¼ˆç›´æ–¹å›¾ï¼‰ä¸»è¦ç”¨äºç»Ÿè®¡å’Œåº¦é‡æ•°æ®åˆ†å¸ƒã€‚æ¯”å¦‚ï¼Œä½ æƒ³çŸ¥é“åœ¨ HTTP è¯·æ±‚å¤„ç†ä¸­ï¼Œå“åº”æ—¶é—´æ˜¯å¦‚ä½•åˆ†å¸ƒçš„ï¼Œæˆ–è€…åœ¨å¤§é‡æ“ä½œä¸­ï¼Œå„ä¸ªæ“ä½œçš„è€—æ—¶åˆ†å¸ƒæƒ…å†µã€‚</p><p><strong>Histogram ä¸ Percentileï¼ˆç™¾åˆ†ä½æ•°ï¼‰</strong></p><p>åœ¨è°ˆåˆ°<code>histogram.percentile(percentile)</code>ä¹‹å‰ï¼Œé‡è¦çš„æ˜¯è¦ç†è§£ä»€ä¹ˆæ˜¯ç™¾åˆ†ä½æ•°ã€‚ç®€å•æ¥è¯´ï¼Œç™¾åˆ†ä½æ•°æ˜¯ä¸€ç§è¡¡é‡æ•°æ®åˆ†å¸ƒä½ç½®çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæŸé¡¹æ•°æ®çš„ 90thï¼ˆç¬¬ 90ï¼‰ç™¾åˆ†ä½æ•°æ˜¯ 100msï¼ˆæ¯«ç§’ï¼‰ï¼Œè¿™æ„å‘³ç€ 90%çš„æ•°æ®ç‚¹éƒ½å°‘äºæˆ–ç­‰äº 100msã€‚</p><p>ç°åœ¨ï¼Œå½“ä½ çœ‹åˆ°<code>histogram.percentile(percentile)</code>ï¼Œè¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºä»ç›´æ–¹å›¾ä¸­æå–ç‰¹å®šç™¾åˆ†ä½æ•°çš„å€¼ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><p>å‡è®¾ä½ æ­£åœ¨è¿è¡Œä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œå¹¶å¯¹å“åº”æ—¶é—´è¿›è¡Œç›‘æ§ã€‚ä½ å¸Œæœ›çŸ¥é“ç»å¤§å¤šæ•°ï¼ˆæ¯”å¦‚ 95%ï¼‰ç”¨æˆ·çš„è¯·æ±‚å“åº”æ—¶é—´æ˜¯å¤šå°‘ï¼Œä»¥ç¡®ä¿ä½ çš„æœåŠ¡è´¨é‡ã€‚è¿™é‡Œï¼Œç›´æ–¹å›¾å°±æ´¾ä¸Šäº†ç”¨åœºï¼Œå®ƒæ”¶é›†äº†æ‰€æœ‰è¯·æ±‚çš„å“åº”æ—¶é—´ã€‚ä½¿ç”¨<code>histogram.percentile(95)</code>å¯ä»¥å‘Šè¯‰ä½  95%è¯·æ±‚çš„å“åº”æ—¶é—´éƒ½åœ¨è¯¥æ–¹æ³•è¿”å›çš„å€¼ä»¥ä¸‹ã€‚</p><p><strong>å®é™…åº”ç”¨ç¤ºä¾‹</strong></p><ol><li><p><strong>ç›‘æ§ HTTP è¯·æ±‚çš„å“åº”æ—¶é—´ï¼š</strong></p><ul><li>æ”¶é›† HTTP è¯·æ±‚å“åº”æ—¶é—´ã€‚</li><li>ä½¿ç”¨ Histogram è®°å½•æ‰€æœ‰è¯·æ±‚çš„å“åº”æ—¶é—´ã€‚</li><li>ä½¿ç”¨<code>histogram.percentile(95)</code>è·å– 95%çš„è¯·æ±‚å“åº”æ—¶é—´ã€‚</li></ul></li><li><p><strong>æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½åˆ†æï¼š</strong></p><ul><li>å¯¹æ•°æ®åº“æŸ¥è¯¢æ“ä½œçš„æ‰§è¡Œæ—¶é—´è¿›è¡Œç›‘æ§ã€‚</li><li>åˆ©ç”¨ Histogram è®°å½•ä¸åŒæŸ¥è¯¢çš„æ‰§è¡Œæ—¶é—´ã€‚</li><li>é€šè¿‡<code>histogram.percentile(50)</code>æ¥æŸ¥çœ‹ä¸­ä½æ•°æŸ¥è¯¢æ—¶é—´ï¼Œäº†è§£å¤§å¤šæ•°æŸ¥è¯¢çš„æ€§èƒ½å¦‚ä½•ã€‚</li></ul></li><li><p><strong>ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µåˆ†æï¼š</strong></p><ul><li>ç›‘æ§å¦‚ CPU ä½¿ç”¨ç‡ã€å†…å­˜ä½¿ç”¨ç­‰ã€‚</li><li>ä½¿ç”¨ Histogram æ¥ç§¯ç´¯æ•°æ®ç‚¹ã€‚</li><li>åˆ©ç”¨<code>histogram.percentile(99)</code>æ¥è§‚å¯Ÿæç«¯æƒ…å†µï¼Œæ¯”å¦‚å‡ ä¹æœ€é«˜çš„èµ„æºä½¿ç”¨ç‡ï¼Œç¡®ä¿ç³»ç»Ÿåœ¨å‹åŠ›è¾ƒå¤§æ—¶ä»ç„¶ç¨³å®šã€‚</li></ul></li></ol><p>æ€»ä¹‹ï¼Œ<code>histogram.percentile(percentile)</code>æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œç”¨äºä»å¤§é‡æ•°æ®ä¸­æå–æœ‰æ„ä¹‰çš„æŒ‡æ ‡ï¼Œå¸®åŠ©å¼€å‘è€…äº†è§£ç³»ç»Ÿè¡¨ç°å’Œç”¨æˆ·ä½“éªŒã€‚é€šè¿‡è¿™äº›ç™¾åˆ†ä½æ•°çš„ä¿¡æ¯ï¼Œå¼€å‘è€…å¯ä»¥æ‰¾å‡ºç“¶é¢ˆã€è¯„ä¼°ç³»ç»Ÿè¡¨ç°ï¼Œå¹¶ä½œå‡ºç›¸åº”ä¼˜åŒ–ã€‚</p><h3 id="histogram-percentilebigint-percentile" tabindex="-1"><a class="header-anchor" href="#histogram-percentilebigint-percentile"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogrampercentilebigintpercentile" target="_blank" rel="noopener noreferrer">histogram.percentileBigInt(percentile)</a></span></a></h3><p>Node.js çš„ <code>histogram.percentileBigInt(percentile)</code> æ–¹æ³•æ˜¯ä¸€ä¸ªæ€§èƒ½ç›‘æµ‹å·¥å…·ä¸­çš„ç‰¹æ€§ï¼Œå®ƒå±äº Node.js å†…ç½®çš„ <code>perf_hooks</code> æ¨¡å—ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ è·å–ç›´æ–¹å›¾ï¼ˆhistogramï¼‰ä¸­æŸä¸ªç™¾åˆ†ä½çš„å€¼ï¼Œä½†ä¸é€šå¸¸è¿”å›çš„æ•°å­—ç±»å‹ä¸åŒï¼Œæ­¤æ–¹æ³•è¿”å›ä¸€ä¸ªå¤§æ•´æ•°ï¼ˆBigIntï¼‰ï¼Œä»¥ä¾¿ç²¾ç¡®è¡¨ç¤ºéå¸¸å¤§çš„å€¼ã€‚</p><h3 id="ç†è§£ç›´æ–¹å›¾å’Œç™¾åˆ†ä½" tabindex="-1"><a class="header-anchor" href="#ç†è§£ç›´æ–¹å›¾å’Œç™¾åˆ†ä½"><span>ç†è§£ç›´æ–¹å›¾å’Œç™¾åˆ†ä½</span></a></h3><p>åœ¨æ·±å…¥äº†è§£ <code>percentileBigInt</code> ä¹‹å‰ï¼Œå…ˆç®€å•äº†è§£ä»€ä¹ˆæ˜¯ç›´æ–¹å›¾å’Œç™¾åˆ†ä½ï¼š</p><ul><li><strong>ç›´æ–¹å›¾</strong>ï¼šç›´æ–¹å›¾æ˜¯ä¸€ç§å›¾è¡¨ï¼Œç”¨äºå±•ç¤ºæ•°æ®çš„åˆ†å¸ƒæƒ…å†µã€‚åœ¨æ€§èƒ½ç›‘æµ‹åœºæ™¯ä¸­ï¼Œç›´æ–¹å›¾å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç†è§£å„ç§äº‹ä»¶ï¼ˆå¦‚è¯·æ±‚å“åº”æ—¶é—´ï¼‰çš„é¢‘ç‡åˆ†å¸ƒã€‚</li><li><strong>ç™¾åˆ†ä½</strong>ï¼šç™¾åˆ†ä½æ˜¯ä¸€ç§åº¦é‡ï¼Œè¡¨ç¤ºåœ¨ä¸€ç»„æ•°æ®ä¸­æœ‰å¤šå°‘æ¯”ä¾‹çš„æ•°æ®å°äºæˆ–ç­‰äºè¯¥å€¼ã€‚ä¾‹å¦‚ï¼Œ90th ç™¾åˆ†ä½æ„å‘³ç€ 90% çš„æ•°æ®éƒ½å°äºæˆ–ç­‰äºè¿™ä¸ªå€¼ã€‚</li></ul><h3 id="ä½¿ç”¨-percentilebigint-percentile" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-percentilebigint-percentile"><span>ä½¿ç”¨ <code>percentileBigInt(percentile)</code></span></a></h3><p>å½“ä½ ä½¿ç”¨ Node.js è¿›è¡Œæ€§èƒ½ç›‘æµ‹æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°éœ€è¦ç²¾ç¡®è·å–å¤§é‡æ•°æ®æŸä¸ªç‰¹å®šç™¾åˆ†ä½æ•°å€¼çš„åœºæ™¯ã€‚è¿™æ—¶å€™ <code>histogram.percentileBigInt(percentile)</code> å°±æ˜¾å¾—éå¸¸æœ‰ç”¨ã€‚</p><h4 id="å®é™…è¿ç”¨ç¤ºä¾‹-9" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-9"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ç›‘æ§ä¸€ä¸ªç½‘ç»œæœåŠ¡çš„å“åº”æ—¶é—´ï¼Œå¹¶æƒ³è¦ç²¾ç¡®è·çŸ¥ 99th ç™¾åˆ†ä½çš„å“åº”æ—¶é—´ï¼Œä»¥ç¡®ä¿ç»å¤§å¤šæ•°ç”¨æˆ·çš„ä½“éªŒã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>perf_hooks</code> æ¨¡å—æ¥è®°å½•å“åº”æ—¶é—´å¹¶æ„å»ºç›´æ–¹å›¾ï¼Œç„¶åé€šè¿‡ <code>percentileBigInt</code> æ–¹æ³•è·å–æ‰€éœ€çš„ç™¾åˆ†ä½æ•°å€¼ã€‚</p><ol><li><strong>è®°å½•æ•°æ®</strong></li></ol><p>é¦–å…ˆï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ªç›´æ–¹å›¾å®ä¾‹ï¼Œå¹¶åœ¨æ¯æ¬¡è¯·æ±‚ç»“æŸæ—¶è®°å½•ç›¸åº”çš„å“åº”æ—¶é—´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºç›´æ–¹å›¾</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> histogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`99thç™¾åˆ†ä½å“åº”æ—¶é—´ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">percentileBigInt</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">99</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">çº³ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffered</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯å¤„ç†è¯·æ±‚çš„å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> handleRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¯·æ±‚å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¯·æ±‚å¤„ç†é€»è¾‘â€¦â€¦</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¯·æ±‚ç»“æŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¯·æ±‚å¤„ç†æ—¶é—´&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿè¯·æ±‚å¤„ç†</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">handleRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨ <code>PerformanceObserver</code> å’Œ <code>performance</code> API æ¥æµ‹é‡å¤„ç†è¯·æ±‚çš„æ—¶é—´ï¼Œå¹¶å°†å…¶è®°å½•åˆ°ç›´æ–¹å›¾ä¸­ã€‚åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œå‡è®¾æ‰€æœ‰çš„æµ‹é‡æ•°æ®éƒ½èšé›†åœ¨ <code>handleRequest</code> å‡½æ•°ä¸­ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>percentileBigInt</code> æ–¹æ³•æ¥è®¡ç®— 99th ç™¾åˆ†ä½çš„å“åº”æ—¶é—´ã€‚</p><ol start="2"><li><strong>è§£è¯»ç»“æœ</strong></li></ol><p>å‡è®¾ <code>percentileBigInt(99)</code> è¿”å›äº† <code>3000000000</code>ï¼Œè¿™æ„å‘³ç€ 99%çš„è¯·æ±‚å“åº”æ—¶é—´éƒ½å°äºæˆ–ç­‰äº 3 ç§’ï¼ˆå› ä¸ºè¿”å›çš„å•ä½æ˜¯çº³ç§’ï¼‰ã€‚è¿™æ ·çš„ä¿¡æ¯å¯¹äºè¯„ä¼°ç”¨æˆ·ä½“éªŒå’Œç³»ç»Ÿæ€§èƒ½è‡³å…³é‡è¦ã€‚</p><p>é€šè¿‡ä½¿ç”¨ <code>percentileBigInt</code> æ–¹æ³•ï¼Œä½ å¯ä»¥å‡†ç¡®åœ°ç›‘æµ‹å¹¶åˆ†æåº”ç”¨ç¨‹åºçš„æ€§èƒ½æŒ‡æ ‡ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§æ•°æ®é›†æ—¶ï¼Œè¿™ä¸€ç‚¹å°¤å…¶é‡è¦ã€‚</p><h3 id="histogram-percentiles" tabindex="-1"><a class="header-anchor" href="#histogram-percentiles"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogrampercentiles" target="_blank" rel="noopener noreferrer">histogram.percentiles</a></span></a></h3><p>å½“æˆ‘ä»¬è®¨è®º Node.js ä¸­çš„<code>histogram.percentiles()</code>åŠŸèƒ½æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨è®¨è®ºå¦‚ä½•åˆ©ç”¨æ€§èƒ½é’©å­ï¼ˆperf_hooksï¼‰æ¨¡å—ä¸­çš„ä¸€ä¸ªå·¥å…·æ¥æµ‹é‡å’Œç†è§£ä¸åŒæ“ä½œçš„æ€§èƒ½ç‰¹å¾ã€‚é¦–å…ˆï¼Œè®©æˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹èƒŒæ™¯çŸ¥è¯†ï¼Œç„¶åæˆ‘ä¼šé€šè¿‡ä¾‹å­è¯¦ç»†è§£é‡Šè¿™ä¸ªåŠŸèƒ½ã€‚</p><h3 id="èƒŒæ™¯-1" tabindex="-1"><a class="header-anchor" href="#èƒŒæ™¯-1"><span>èƒŒæ™¯</span></a></h3><p>Node.js çš„<code>perf_hooks</code>æ¨¡å—æä¾›äº†ç›‘è§† Node.js åº”ç”¨ç¨‹åºæ€§èƒ½çš„å·¥å…·ã€‚å…¶ä¸­ï¼Œç›´æ–¹å›¾ï¼ˆHistogramï¼‰æ˜¯è¿™ä¸ªæ¨¡å—ä¸­ä¸€ä¸ªé‡è¦çš„éƒ¨åˆ†ï¼Œå®ƒèƒ½å¤Ÿè®°å½•å’Œç»Ÿè®¡æ—¶é—´æŒç»­æ€§æ•°æ®ï¼ˆæ¯”å¦‚æ“ä½œè€—æ—¶ï¼‰ï¼Œä»è€Œå¸®åŠ©å¼€å‘è€…äº†è§£åº”ç”¨ç¨‹åºçš„æ€§èƒ½ç‰¹å¾ã€‚</p><h3 id="histograms-å’Œ-percentiles" tabindex="-1"><a class="header-anchor" href="#histograms-å’Œ-percentiles"><span>Histograms å’Œ Percentiles</span></a></h3><ul><li><strong>ç›´æ–¹å›¾ï¼ˆHistogramï¼‰</strong>ï¼šåœ¨æ€§èƒ½ç›‘æ§ä¸­ï¼Œç›´æ–¹å›¾æ˜¯ä¸€ç§ç”¨äºè¡¨ç¤ºæ•°æ®åˆ†å¸ƒçš„å›¾è¡¨ã€‚åœ¨ Node.js ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥æ”¶é›†æŸæ®µä»£ç æ‰§è¡Œæ—¶é—´çš„ç»Ÿè®¡ä¿¡æ¯ã€‚</li><li><strong>ç™¾åˆ†ä½æ•°ï¼ˆPercentilesï¼‰</strong>ï¼šç™¾åˆ†ä½æ•°æ˜¯ä¸€ç§è¡¡é‡æ•°æ®åˆ†å¸ƒçš„æ–¹å¼ï¼Œè¡¨ç¤ºåœ¨æ‰€æœ‰è§‚æµ‹å€¼ä¸­æœ‰å¤šå°‘æ¯”ä¾‹çš„æ•°æ®å°äºæˆ–ç­‰äºè¯¥å€¼ã€‚ä¾‹å¦‚ï¼Œ90 ç™¾åˆ†ä½æ•°æ„å‘³ç€ 90%çš„è§‚æµ‹å€¼éƒ½å°äºæˆ–ç­‰äºè¿™ä¸ªé˜ˆå€¼ã€‚</li></ul><h3 id="å¦‚ä½•ä½¿ç”¨-histogram-percentiles" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-histogram-percentiles"><span>å¦‚ä½•ä½¿ç”¨ <code>histogram.percentiles()</code></span></a></h3><p><code>histogram.percentiles()</code>å‡½æ•°æ˜¯ç›´æ–¹å›¾å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒå…è®¸ä½ è·å–ç›´æ–¹å›¾ä¸­ä¸€ç³»åˆ—ç™¾åˆ†ä½æ•°çš„å€¼ã€‚è¿™éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå¯ä»¥è®©ä½ å¿«é€Ÿäº†è§£åˆ°å¤§éƒ¨åˆ†æ“ä½œçš„æ‰§è¡Œæ—¶é—´èŒƒå›´ï¼Œä»è€Œè¯„ä¼°æ€§èƒ½ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-18" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-18"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨è¿è¡Œä¸€ä¸ª Node.js æœåŠ¡ï¼Œè¿™ä¸ªæœåŠ¡å¯¹å¤–æä¾› API æ¥å£ï¼Œä½ æƒ³è¦ç›‘æ§è¿™äº› API è¯·æ±‚çš„å“åº”æ—¶é—´ï¼Œä»¥ç¡®ä¿ç”¨æˆ·ä½“éªŒã€‚ä½ å¯ä»¥ä½¿ç”¨<code>perf_hooks</code>æ¨¡å—ä¸­çš„ç›´æ–¹å›¾æ¥ç»Ÿè®¡å“åº”æ—¶é—´ï¼Œç„¶åç”¨<code>percentiles()</code>æ–¹æ³•æ¥è·å–å…³é”®çš„æ€§èƒ½æŒ‡æ ‡ã€‚</p><h4 id="æ­¥éª¤-1-åˆ›å»ºå’Œè®°å½•ç›´æ–¹å›¾æ•°æ®" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-1-åˆ›å»ºå’Œè®°å½•ç›´æ–¹å›¾æ•°æ®"><span>æ­¥éª¤ 1ï¼šåˆ›å»ºå’Œè®°å½•ç›´æ–¹å›¾æ•°æ®</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ€§èƒ½æ¡ç›®çš„è§‚å¯Ÿè€…</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clearMarks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ‡è®°å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹ŸAPIå¤„ç†é€»è¾‘ï¼Œè¿™é‡Œæˆ‘ä»¬ä»…ä½¿ç”¨setTimeoutæ¥æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ ‡è®°ç»“æŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹é‡ä»Aåˆ°Bçš„æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;API Response Time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ­¥éª¤-2-ä½¿ç”¨histogram-percentiles-è·å–ç™¾åˆ†ä½æ•°" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-2-ä½¿ç”¨histogram-percentiles-è·å–ç™¾åˆ†ä½æ•°"><span>æ­¥éª¤ 2ï¼šä½¿ç”¨<code>histogram.percentiles()</code>è·å–ç™¾åˆ†ä½æ•°</span></a></h4><p>ä¸€æ—¦ä½ æ”¶é›†äº†è¶³å¤Ÿçš„æ€§èƒ½æ•°æ®ï¼ˆæ¯”å¦‚ API å“åº”æ—¶é—´ï¼‰ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨<code>histogram.percentiles()</code>æ¥è·å–æ•°æ®çš„ç™¾åˆ†ä½æ•°åˆ†å¸ƒäº†ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾histogramæ˜¯ä½ ä»æ­¥éª¤1ä¸­æ”¶é›†æ•°æ®çš„ç›´æ–¹å›¾å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> histogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">nodeTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œåªæ˜¯ä¸¾ä¸ªä¾‹å­ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µæ›¿æ¢</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–ç›´æ–¹å›¾çš„50ç™¾åˆ†ä½æ•°å’Œ90ç™¾åˆ†ä½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> percentiles</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">percentiles</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;50th Percentile:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">percentiles</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;90th Percentile:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">percentiles</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•è·å– API å“åº”æ—¶é—´çš„ 50 ç™¾åˆ†ä½æ•°å’Œ 90 ç™¾åˆ†ä½æ•°ã€‚è¿™ä¸¤ä¸ªæŒ‡æ ‡éå¸¸æœ‰ç”¨ï¼š</p><ul><li><strong>50 ç™¾åˆ†ä½æ•°</strong>å‘Šè¯‰æˆ‘ä»¬ä¸€åŠçš„è¯·æ±‚è¢«å¤„ç†çš„é€Ÿåº¦æ˜¯å¤šå¿«ã€‚</li><li><strong>90 ç™¾åˆ†ä½æ•°</strong>åˆ™æ˜¾ç¤ºäº†å¤§å¤šæ•°ï¼ˆ90%ï¼‰è¯·æ±‚çš„å¤„ç†é€Ÿåº¦ï¼Œæœ‰åŠ©äºæˆ‘ä»¬äº†è§£åœ¨è¾ƒé«˜è´Ÿè·ä¸‹çš„æ€§èƒ½ã€‚</li></ul><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥é’ˆå¯¹å®é™…è¿è¡Œçš„ Node.js åº”ç”¨è¿›è¡Œæ€§èƒ½ç›‘æ§å’Œåˆ†æï¼Œä»è€Œæ‰¾å‡ºç“¶é¢ˆã€ä¼˜åŒ–æ€§èƒ½ã€‚</p><h3 id="histogram-percentilesbigint" tabindex="-1"><a class="header-anchor" href="#histogram-percentilesbigint"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogrampercentilesbigint" target="_blank" rel="noopener noreferrer">histogram.percentilesBigInt</a></span></a></h3><p>è®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥è§£é‡Š Node.js ä¸­çš„ <code>histogram.percentilesBigInt</code> è¿™ä¸ªåŠŸèƒ½ã€‚</p><p>é¦–å…ˆï¼Œè¦äº†è§£è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦ä»ä¸¤ä¸ªæ¦‚å¿µå…¥æ‰‹ï¼šNode.js çš„æ€§èƒ½é’©å­ï¼ˆPerformance Hooksï¼‰æ¨¡å—å’Œç›´æ–¹å›¾ï¼ˆHistogramï¼‰ã€‚</p><h3 id="_1-performance-hooks-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_1-performance-hooks-æ¨¡å—"><span>1. Performance Hooks æ¨¡å—ï¼š</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œæ€§èƒ½é’©å­æ¨¡å—æä¾›äº†ä¸€ç§æ–¹å¼æ¥è§‚å¯ŸæŸäº›ç³»ç»Ÿæ€§èƒ½åº¦é‡å€¼ã€‚å®ƒéå¸¸é€‚åˆäºäº†è§£åº”ç”¨ç¨‹åºè¿è¡Œæ—¶çš„æ€§èƒ½æƒ…å†µã€‚å…¶ä¸­ä¸€ä¸ªé‡è¦ç»„ä»¶å°±æ˜¯ç›´æ–¹å›¾ï¼ˆHistogramï¼‰ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ”¶é›†å’Œåˆ†ææ—¶é—´æ•°æ®ï¼Œä¾‹å¦‚æ“ä½œèŠ±è´¹çš„æ—¶é—´ã€‚</p><h3 id="_2-ç›´æ–¹å›¾-histogram" tabindex="-1"><a class="header-anchor" href="#_2-ç›´æ–¹å›¾-histogram"><span>2. ç›´æ–¹å›¾ï¼ˆHistogramï¼‰ï¼š</span></a></h3><p>ç›´æ–¹å›¾æ˜¯ä¸€ç§ç»Ÿè®¡å›¾è¡¨ï¼Œç”¨äºå±•ç¤ºæ•°å€¼æ•°æ®çš„åˆ†å¸ƒã€‚åœ¨ Node.js çš„æ€§èƒ½é’©å­æ¨¡å—ä¸­ï¼Œå®ƒè¢«ç”¨æ¥è®°å½•äº‹ä»¶ï¼ˆå¦‚å‡½æ•°æ‰§è¡Œï¼‰å‘ç”Ÿæ‰€éœ€çš„æ—¶é—´åˆ†å¸ƒã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ <code>histogram.percentilesBigInt</code> è¿™ä¸ªå…·ä½“åŠŸèƒ½ã€‚</p><h3 id="histogram-percentilesbigint-1" tabindex="-1"><a class="header-anchor" href="#histogram-percentilesbigint-1"><span>histogram.percentilesBigIntï¼š</span></a></h3><p><code>histogram.percentilesBigInt</code> æ˜¯ Node.js ä¸­ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå±äºç›´æ–¹å›¾å¯¹è±¡çš„ä¸€éƒ¨åˆ†ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ è·å–ç›´æ–¹å›¾ä¸­ç‰¹å®šç™¾åˆ†ä½æ•°çš„å€¼ï¼Œå¹¶ä¸”ä»¥å¤§æ•´æ•°ï¼ˆBigIntï¼‰æ ¼å¼è¿”å›ç»“æœã€‚ä½¿ç”¨ BigInt æ˜¯å› ä¸ºå®ƒå¯ä»¥è¡¨ç¤ºéå¸¸å¤§çš„æ•´æ•°ï¼Œè¿™å¯¹äºé«˜ç²¾åº¦çš„æ—¶é—´æµ‹é‡éå¸¸æœ‰ç”¨ã€‚</p><p>å‡è®¾ä½ åœ¨æµ‹é‡ä¸€ä¸ªç½‘ç»œè¯·æ±‚çš„å“åº”æ—¶é—´ï¼Œä½ å¯èƒ½ä¼šæœ‰æˆåƒä¸Šä¸‡æ¬¡æµ‹é‡ç»“æœï¼Œé€šè¿‡ <code>percentilesBigInt</code> æ–¹æ³•ï¼Œä½ å¯ä»¥å¾—åˆ°è¿™äº›æµ‹é‡ç»“æœçš„ç¬¬ 50 ç™¾åˆ†ä½ï¼ˆä¸­ä½æ•°ï¼‰ã€ç¬¬ 90 ç™¾åˆ†ä½ç­‰å…³é”®ç™¾åˆ†ä½çš„ç²¾ç¡®æ—¶é—´ã€‚</p><h3 id="å®é™…åº”ç”¨å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨å®ä¾‹"><span>å®é™…åº”ç”¨å®ä¾‹ï¼š</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª web åº”ç”¨ï¼Œä½ æƒ³ç›‘æ§å¹¶åˆ†ææœåŠ¡å™¨å¤„ç†è¯·æ±‚çš„æ€§èƒ½ã€‚</p><ol><li><strong>ç›‘æ§è¯·æ±‚å“åº”æ—¶é—´</strong>ï¼šä½ å¯ä»¥ä½¿ç”¨ç›´æ–¹å›¾æ¥è®°å½•æ¯ä¸ªè¯·æ±‚å¤„ç†çš„è€—æ—¶ã€‚</li><li><strong>åˆ†ææ€§èƒ½</strong>ï¼šåœ¨æ”¶é›†è¶³å¤Ÿçš„æ•°æ®åï¼Œåˆ©ç”¨ <code>histogram.percentilesBigInt</code> æ–¹æ³•ï¼Œä½ å¯ä»¥æŸ¥è¯¢ï¼š <ul><li>ç¬¬ 50 ç™¾åˆ†ä½ï¼ˆä¸­ä½æ•°ï¼‰çš„å“åº”æ—¶é—´ï¼Œäº†è§£å¤§å¤šæ•°è¯·æ±‚çš„è¡¨ç°ã€‚</li><li>ç¬¬ 95 ç™¾åˆ†ä½çš„å“åº”æ—¶é—´ï¼Œç†è§£æ€§èƒ½ç“¶é¢ˆå‡ºç°çš„æƒ…å†µã€‚</li></ul></li></ol><p>ä»£ç ç¤ºä¾‹ï¼ˆç®€åŒ–ï¼‰:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;perf_hooks&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ€§èƒ½è§‚å¯Ÿè€…æ¥æ”¶é›†æ€§èƒ½æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;measure&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼€å§‹å’Œç»“æŸæ€§èƒ½æµ‹é‡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;A&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™é‡Œæœ‰ä¸€äº›ä»£ç è¿è¡Œï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;B&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;A to B&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;A&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;B&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾è¿™æ˜¯ä½ çš„ç›´æ–¹å›¾æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> histogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntriesByName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;A to B&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">percentilesBigInt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">75</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">99</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>setTimeout</code> æ¥æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œï¼ˆæ¯”å¦‚ç½‘ç»œè¯·æ±‚ï¼‰ã€‚æˆ‘ä»¬ä½¿ç”¨ <code>PerformanceObserver</code> å’Œ <code>performance.mark</code> æ¥æµ‹é‡ä»ç‚¹ A åˆ°ç‚¹ B çš„è€—æ—¶ã€‚æœ€åï¼Œæˆ‘ä»¬æ‰“å°å‡ºç›´æ–¹å›¾ä¸­çš„ç‰¹å®šç™¾åˆ†ä½æ•°ï¼Œäº†è§£æ€§èƒ½æŒ‡æ ‡ã€‚</p><p>é€šè¿‡ä½¿ç”¨ <code>histogram.percentilesBigInt</code>ï¼Œå¼€å‘è€…å¯ä»¥è·å¾—é«˜ç²¾åº¦çš„æ€§èƒ½æ•°æ®ï¼Œä»è€Œæ›´å¥½åœ°ä¼˜åŒ–åº”ç”¨æ€§èƒ½ã€‚</p><h3 id="histogram-reset" tabindex="-1"><a class="header-anchor" href="#histogram-reset"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogramreset" target="_blank" rel="noopener noreferrer">histogram.reset()</a></span></a></h3><p>å½“ä½ å¼€å§‹å­¦ä¹  Node.jsï¼Œäº†è§£å…¶æ€§èƒ½ç›‘æ§å·¥å…·ä¼šæ˜¯ä¸€ä¸ªå¾ˆæœ‰ä»·å€¼çš„æŠ€èƒ½ã€‚<code>histogram.reset()</code>æ˜¯ Node.js æ€§èƒ½é’©å­ï¼ˆperf_hooksï¼‰æ¨¡å—ä¸­çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œç‰¹åˆ«ç”¨äºå¤„ç†å’Œåˆ†ææ€§èƒ½æ•°æ®ã€‚é€šè¿‡è¿™ä¸ªåŠŸèƒ½ï¼Œä½ å¯ä»¥é‡ç½®æŸäº›æ€§èƒ½æŒ‡æ ‡ï¼Œä»¥ä¾¿é‡æ–°æ”¶é›†æ•°æ®ï¼Œè€Œä¸å—ä¹‹å‰æ”¶é›†æ•°æ®çš„å½±å“ã€‚è®©æˆ‘ä»¬é€æ­¥æ·±å…¥äº†è§£å®ƒã€‚</p><h3 id="ç†è§£-histogram" tabindex="-1"><a class="header-anchor" href="#ç†è§£-histogram"><span>ç†è§£ Histogram</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œç›´æ–¹å›¾ï¼ˆHistogramï¼‰é€šå¸¸ç”¨äºæ”¶é›†å¹¶è®°å½•æŸç§äº‹ä»¶æˆ–æ“ä½œçš„æŒç»­æ—¶é—´æˆ–é¢‘ç‡ç­‰ç»Ÿè®¡ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œè¿™å¯ä»¥æ˜¯ HTTP è¯·æ±‚çš„å“åº”æ—¶é—´ã€æ–‡ä»¶è¯»å†™æ“ä½œçš„è€—æ—¶ç­‰ã€‚</p><h3 id="ä½¿ç”¨histogram-reset" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨histogram-reset"><span>ä½¿ç”¨<code>histogram.reset()</code></span></a></h3><p><code>histogram.reset()</code>æ–¹æ³•å…è®¸ä½ å°†ç›´æ–¹å›¾ä¸­çš„æ‰€æœ‰ç»Ÿè®¡ä¿¡æ¯é‡ç½®ä¸ºåˆå§‹çŠ¶æ€ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä½ ä¹‹å‰å·²ç»æ”¶é›†äº†ä¸€äº›æ•°æ®ï¼ˆæ¯”å¦‚æ‰§è¡Œäº†å‡ æ¬¡æ“ä½œï¼Œå¹¶è®°å½•äº†å®ƒä»¬çš„è€—æ—¶ï¼‰ï¼Œä½¿ç”¨<code>reset()</code>åï¼Œè¿™äº›æ•°æ®ä¼šè¢«æ¸…ç©ºï¼Œç›´æ–¹å›¾æ¢å¤åˆ°æ²¡æœ‰ä»»ä½•æ•°æ®çš„çŠ¶æ€ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-10" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-10"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>æƒ³è±¡ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web æœåŠ¡ï¼Œä½ æƒ³ç›‘æµ‹å¤„ç†ç”¨æˆ·è¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚ä½ å†³å®šä½¿ç”¨ Node.js çš„æ€§èƒ½é’©å­æ¥å¸®åŠ©ä½ æ”¶é›†è¿™äº›æ•°æ®ï¼š</p><ol><li><strong>åˆå§‹åŒ–æ€§èƒ½ç›‘æµ‹</strong>ï¼šé¦–å…ˆï¼Œä½ éœ€è¦ä»<code>perf_hooks</code>æ¨¡å—å¯¼å…¥<code>PerformanceObserver</code>å’Œ<code>performance</code>å¯¹è±¡ä»¥åŠåˆ›å»ºä¸€ä¸ªç›´æ–¹å›¾æ¥è®°å½•æ—¶é—´ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceNodeTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> histogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¤„ç†æ€§èƒ½æ¡ç›®...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;mark&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffered</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>è®°å½•å’Œåˆ†ææ•°æ®</strong>ï¼šæ¯å½“æœåŠ¡æ¥æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œä½ æ ‡è®°å¼€å§‹æ—¶é—´ï¼Œå¹¶åœ¨è¯·æ±‚å¤„ç†å®Œæˆæ—¶å†æ¬¡æ ‡è®°ï¼Œç„¶åå°†è¿™æ®µæ—¶é—´è®°å½•åˆ°ç›´æ–¹å›¾ä¸­ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å½“è¯·æ±‚å¼€å§‹æ—¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start-request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯·æ±‚å¤„ç†é€»è¾‘...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯·æ±‚ç»“æŸæ—¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end-request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;request-duration&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start-request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end-request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œâ€œrequest-durationâ€æ˜¯æµ‹é‡è¯·æ±‚æŒç»­æ—¶é—´çš„æ ‡è¯†ç¬¦</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>ç›´æ–¹å›¾é‡ç½®</strong>ï¼šå‡è®¾ä½ æƒ³åœ¨æŸä¸ªæ—¶é—´ç‚¹ï¼ˆæ¯”å¦‚åŠå¤œï¼‰é‡ç½®ä½ çš„ç›‘æµ‹æ•°æ®ã€‚è¿™æ—¶å€™ï¼Œ<code>histogram.reset()</code>æ´¾ä¸Šç”¨åœºã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é‡ç½®ç›´æ–¹å›¾æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">reset</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡é‡ç½®ç›´æ–¹å›¾ï¼Œä½ å¯ä»¥ç¡®ä¿ä»é‚£ä¸€åˆ»èµ·æ”¶é›†çš„æ€§èƒ½æ•°æ®æ˜¯å…¨æ–°çš„ï¼Œä¸ä¼šè¢«ä¹‹å‰çš„æ—§æ•°æ®å½±å“ã€‚è¿™åœ¨è¿›è¡Œé•¿æœŸç›‘æµ‹æˆ–è€…åœ¨ç‰¹å®šäº‹ä»¶ï¼ˆæ¯”å¦‚éƒ¨ç½²æ–°ç‰ˆæœ¬åï¼‰é‡æ–°å¼€å§‹æ”¶é›†æ€§èƒ½æ•°æ®æ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="ç»“è®º-5" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-5"><span>ç»“è®º</span></a></h3><p>ä½¿ç”¨<code>histogram.reset()</code>ä½¿å¾—åœ¨ Node.js ä¸­åŸºäºæ€§èƒ½é’©å­è¿›è¡Œæ•°æ®ç›‘æµ‹å˜å¾—æ›´åŠ çµæ´»ã€‚é€šè¿‡å®šæœŸé‡ç½®æ•°æ®ï¼Œä½ å¯ä»¥ç¡®ä¿æ€§èƒ½ç»Ÿè®¡çš„ç›¸å…³æ€§å’Œå‡†ç¡®æ€§ï¼Œè¿™å¯¹äºç»´æŠ¤é«˜æ€§èƒ½çš„åº”ç”¨æ¥è¯´éå¸¸å…³é”®ã€‚è®°å¾—ç»“åˆå®é™…æƒ…å†µæ¥å†³å®šä½•æ—¶ä½¿ç”¨è¿™ä¸€åŠŸèƒ½ï¼Œä»¥æœ€å¤§åŒ–å…¶æ•ˆç”¨ã€‚</p><h3 id="histogram-stddev" tabindex="-1"><a class="header-anchor" href="#histogram-stddev"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogramstddev" target="_blank" rel="noopener noreferrer">histogram.stddev</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>histogram.stddev</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œç”¨äºä»æ€§èƒ½æŒ‡æ ‡ï¼ˆperformance metricï¼‰çš„ç›´æ–¹å›¾ï¼ˆhistogramï¼‰ä¸­è·å–æ ‡å‡†å·®ã€‚ç®€å•æ¥è¯´ï¼Œè¿™ä¸ªæ ‡å‡†å·®å€¼ç»™æˆ‘ä»¬æä¾›äº†ä¸€ç§è¡¡é‡æ•°æ®å˜åŒ–ç¨‹åº¦çš„æ–¹å¼ã€‚åœ¨ç»Ÿè®¡å­¦ä¸­ï¼Œæ ‡å‡†å·®è¶Šå¤§ï¼Œè¡¨ç¤ºæ•°æ®åˆ†å¸ƒçš„èŒƒå›´è¶Šå¹¿ï¼›æ ‡å‡†å·®è¶Šå°ï¼Œè¡¨ç¤ºæ•°æ®æ›´åŠ é›†ä¸­ã€‚</p><h3 id="ç›´æ–¹å›¾-histogram-æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#ç›´æ–¹å›¾-histogram-æ˜¯ä»€ä¹ˆ"><span>ç›´æ–¹å›¾ï¼ˆHistogramï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h3><p>åœ¨ Node.js çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œç›´æ–¹å›¾é€šå¸¸ç”¨äºæ”¶é›†å’Œè®°å½•æŸç§ç±»å‹çš„æ€§èƒ½æ•°æ®ï¼ˆæ¯”å¦‚ HTTP è¯·æ±‚çš„è€—æ—¶ï¼‰ï¼Œç„¶åå°†è¿™äº›æ•°æ®åˆ†å¸ƒåœ¨ä¸åŒçš„â€œæ¡¶â€æˆ–â€œåŒºé—´â€é‡Œã€‚æ¯ä¸ªæ¡¶åŒ…å«äº†è½åœ¨ç‰¹å®šå€¼èŒƒå›´å†…çš„äº‹ä»¶æ•°é‡ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç½‘ç»œè¯·æ±‚è€—æ—¶çš„ç›´æ–¹å›¾å¯èƒ½ä¼šæœ‰è¿™æ ·çš„æ¡¶ï¼š0-50msã€51-100msã€101-150ms ç­‰ç­‰ã€‚</p><h3 id="æ ‡å‡†å·®-standard-deviation-æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#æ ‡å‡†å·®-standard-deviation-æ˜¯ä»€ä¹ˆ"><span>æ ‡å‡†å·®ï¼ˆStandard Deviationï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h3><p>æ ‡å‡†å·®æ˜¯è¡¡é‡æ•°æ®é›†ä¸­å„ä¸ªæ•°å€¼ä¸å¹³å‡å€¼ï¼ˆmeanï¼‰è·ç¦»çš„ä¸€ç§åº¦é‡ã€‚åœ¨ç›´æ–¹å›¾çš„èƒŒæ™¯ä¸‹ï¼Œå¦‚æœè¯´å¹³å‡å€¼å‘Šè¯‰æˆ‘ä»¬æ€§èƒ½æ•°æ®â€œé€šå¸¸â€ä½äºå“ªä¸ªåŒºé—´ï¼Œé‚£ä¹ˆæ ‡å‡†å·®åˆ™å‘Šè¯‰æˆ‘ä»¬è¿™äº›æ•°æ®åˆ†æ•£åˆ°å¹³å‡å€¼å‘¨å›´çš„ç¨‹åº¦ã€‚</p><h3 id="histogram-stddev-çš„ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#histogram-stddev-çš„ä½œç”¨"><span><code>histogram.stddev</code> çš„ä½œç”¨</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨æ€§èƒ½é’©å­ï¼ˆPerformance Hooksï¼‰æ¨¡å—è¿›è¡Œæ€§èƒ½ç›‘æµ‹æ—¶ï¼Œ<code>histogram.stddev</code> è®©æˆ‘ä»¬èƒ½å¤Ÿç›´æ¥è·å–åˆ°æ‰€ç›‘æµ‹äº‹ä»¶ï¼ˆä¾‹å¦‚ API å“åº”æ—¶é—´ï¼‰çš„æ ‡å‡†å·®ï¼Œä»è€Œå¯¹è¿™äº›äº‹ä»¶çš„ç¨³å®šæ€§å’Œé¢„æœŸæ³¢åŠ¨èŒƒå›´æœ‰ä¸ªç›´è§‚çš„ç†è§£ã€‚</p><h3 id="å®é™…ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-2"><span>å®é™…ä¾‹å­</span></a></h3><h4 id="ä¾‹å­-1-æµ‹é‡-http-è¯·æ±‚å»¶è¿Ÿçš„ç¨³å®šæ€§" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-æµ‹é‡-http-è¯·æ±‚å»¶è¿Ÿçš„ç¨³å®šæ€§"><span>ä¾‹å­ 1: æµ‹é‡ HTTP è¯·æ±‚å»¶è¿Ÿçš„ç¨³å®šæ€§</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨è¿è¡Œä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œä½ æƒ³è¦ç›‘æ§å¤„ç† HTTP è¯·æ±‚æ‰€éœ€æ—¶é—´çš„ç¨³å®šæ€§ã€‚é€šè¿‡è®°å½•æ¯ä¸ªè¯·æ±‚çš„å¤„ç†æ—¶é—´ï¼Œå¹¶åˆ©ç”¨ç›´æ–¹å›¾å’Œ<code>histogram.stddev</code>ï¼Œä½ å¯ä»¥å¾—åˆ°è¯·æ±‚å¤„ç†æ—¶é—´çš„æ ‡å‡†å·®ã€‚å¦‚æœè¿™ä¸ªæ•°å€¼éå¸¸å¤§ï¼Œè¯´æ˜å“åº”æ—¶é—´çš„æ³¢åŠ¨å¾ˆå¤§ï¼Œå¯èƒ½æ„å‘³ç€æœåŠ¡å™¨åœ¨æŸäº›æƒ…å†µä¸‹è¡¨ç°ä¸ç¨³å®šã€‚</p><h4 id="ä¾‹å­-2-åº”ç”¨æ€§èƒ½ç›‘æµ‹" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-åº”ç”¨æ€§èƒ½ç›‘æµ‹"><span>ä¾‹å­ 2: åº”ç”¨æ€§èƒ½ç›‘æµ‹</span></a></h4><p>åœ¨ä¸€ä¸ªå¤æ‚çš„ Node.js åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½æƒ³è¦ç›‘æ§å¤šä¸ªå…³é”®æ“ä½œçš„æ‰§è¡Œæ—¶é—´ï¼Œæ¯”å¦‚æ•°æ®åº“æŸ¥è¯¢ã€å¤–éƒ¨æœåŠ¡è°ƒç”¨ç­‰ã€‚é€šè¿‡ä¸ºæ¯ç§æ“ä½œç»´æŠ¤ä¸€ä¸ªç›´æ–¹å›¾å¹¶è®¡ç®—æ ‡å‡†å·®ï¼Œä½ å¯ä»¥è¯†åˆ«å‡ºå“ªäº›æ“ä½œçš„æ‰§è¡Œæ—¶é—´æ³¢åŠ¨è¾ƒå¤§ï¼Œè¿›è€Œå¯»æ‰¾ä¼˜åŒ–çš„æœºä¼šã€‚</p><p>æ€»ä¹‹ï¼Œäº†è§£ä½ çš„ Node.js åº”ç”¨æˆ–æœåŠ¡çš„æ€§èƒ½æ ‡å‡†å·®å¯ä»¥å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œæ”¹å–„å…¶ç¨³å®šæ€§å’Œç”¨æˆ·ä½“éªŒã€‚</p><h2 id="class-intervalhistogram-extends-histogram" tabindex="-1"><a class="header-anchor" href="#class-intervalhistogram-extends-histogram"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#class-intervalhistogram-extends-histogram" target="_blank" rel="noopener noreferrer">Class: IntervalHistogram extends Histogram</a></span></a></h2><p>è¦ç†è§£<code>IntervalHistogram</code>è¿™ä¸ªç±»åœ¨ Node.js ä¸­çš„ç”¨é€”ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ Histogramï¼ˆç›´æ–¹å›¾ï¼‰å’Œå®ƒåœ¨æ€§èƒ½ç›‘æµ‹é¢†åŸŸçš„åº”ç”¨ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘å°†é€æ­¥å¼•å¯¼ä½ æ·±å…¥äº†è§£<code>IntervalHistogram</code>ä»¥åŠå®ƒå¦‚ä½•æ‰©å±•äº†åŸºç¡€ Histogram åŠŸèƒ½ï¼Œå¹¶ä¸¾ä¾‹è¯´æ˜å…¶å®é™…åº”ç”¨ã€‚</p><h3 id="histogram-ç›´æ–¹å›¾" tabindex="-1"><a class="header-anchor" href="#histogram-ç›´æ–¹å›¾"><span>Histogramï¼ˆç›´æ–¹å›¾ï¼‰</span></a></h3><p>åœ¨æ€§èƒ½ç›‘æµ‹å’Œç»Ÿè®¡åˆ†æä¸­ï¼ŒHistogramï¼ˆç›´æ–¹å›¾ï¼‰æ˜¯ä¸€ç§å±•ç¤ºæ•°æ®åˆ†å¸ƒæƒ…å†µçš„å›¾è¡¨æ–¹å¼ã€‚å®ƒé€šè¿‡å°†æ•°æ®é›†åˆåˆ†æˆå¤šä¸ªè¿ç»­çš„åŒºé—´ï¼ˆæˆ–ç§°â€œæ¡¶â€ï¼‰ï¼Œè®¡ç®—æ¯ä¸ªåŒºé—´å†…å…ƒç´ çš„æ•°é‡ï¼Œç„¶åç”¨ä¸åŒé«˜åº¦çš„æŸ±çŠ¶å›¾å±•ç¤ºå‡ºæ¥ï¼Œä»¥æ­¤æ¥æç»˜æ•°æ®çš„åˆ†å¸ƒç‰¹å¾ã€‚</p><h3 id="node-js-ä¸­çš„-histogram" tabindex="-1"><a class="header-anchor" href="#node-js-ä¸­çš„-histogram"><span>Node.js ä¸­çš„ Histogram</span></a></h3><p>Node.js æä¾›äº†<code>Histogram</code>ç±»ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºæ”¶é›†å’Œè®°å½•æ—¶é—´èŒƒå›´å†…å€¼çš„åˆ†å¸ƒæƒ…å†µçš„å·¥å…·ã€‚ä¾‹å¦‚ï¼Œåœ¨ç›‘æ§ç½‘ç»œè¯·æ±‚çš„å“åº”æ—¶é—´æ—¶ï¼Œå¯ä»¥ä½¿ç”¨<code>Histogram</code>æ¥è®°å½•å¹¶å±•ç¤ºä¸åŒå“åº”æ—¶é—´å‘ç”Ÿçš„é¢‘ç‡ã€‚</p><h3 id="intervalhistogram" tabindex="-1"><a class="header-anchor" href="#intervalhistogram"><span>IntervalHistogram</span></a></h3><p><code>IntervalHistogram</code>ç»§æ‰¿è‡ª<code>Histogram</code>ç±»ï¼Œæä¾›äº†æ›´ä¸“æ³¨äºç‰¹å®šæ—¶é—´é—´éš”å†…æ•°æ®åˆ†å¸ƒæƒ…å†µçš„åˆ†æèƒ½åŠ›ã€‚ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š</p><ul><li><strong>å‘¨æœŸæ€§å½’é›¶</strong>ï¼š<code>IntervalHistogram</code>ä¸<code>Histogram</code>æœ€å¤§çš„ä¸åŒåœ¨äºå…¶èƒ½å¤Ÿåœ¨å›ºå®šçš„æ—¶é—´é—´éš”åè‡ªåŠ¨é‡ç½®è‡ªèº«ï¼Œè¿™ä½¿å…¶éå¸¸é€‚åˆäºåˆ†æå‘¨æœŸæ€§çš„æ€§èƒ½æ•°æ®å˜åŒ–ã€‚</li><li><strong>å®æ—¶åˆ†æ</strong>ï¼šç”±äºå®ƒä¼šå®šæœŸé‡ç½®æ•°æ®ï¼Œå› æ­¤å¯ä»¥ç”¨æ¥å®ç°å¯¹ç³»ç»Ÿæ€§èƒ½çš„å®æ—¶ç›‘æ§ï¼Œè€Œä¸ä»…ä»…æ˜¯è¿‡å»è¡Œä¸ºçš„é™æ€åˆ†æã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-11" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-11"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œå¹¶å¸Œæœ›ç›‘æ§å¤„ç†æ¯ä¸ª HTTP è¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚è¿™é‡Œæœ‰å‡ æ­¥ä½ å¯èƒ½ä¼šé‡‡å–æ¥ä½¿ç”¨<code>IntervalHistogram</code>ï¼š</p><ol><li><strong>åˆ›å»ºä¸€ä¸ª IntervalHistogram å¯¹è±¡</strong>ï¼šé¦–å…ˆï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ª<code>IntervalHistogram</code>å®ä¾‹æ¥æ”¶é›†å“åº”æ—¶é—´æ•°æ®ã€‚</li><li><strong>è®°å½•å“åº”æ—¶é—´</strong>ï¼šæ¯å½“æœåŠ¡å™¨å®Œæˆä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œä½ å°±è®°å½•ä¸‹å¤„ç†è¯¥è¯·æ±‚æ‰€éœ€çš„æ—¶é—´åˆ°ä½ çš„<code>IntervalHistogram</code>å®ä¾‹ä¸­ã€‚</li><li><strong>å®šæœŸæ£€æŸ¥æ•°æ®</strong>ï¼šä½ å¯ä»¥è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œæ¯éš”ä¸€å®šæ—¶é—´ï¼ˆæ¯”å¦‚æ¯åˆ†é’Ÿï¼‰æ£€æŸ¥ä¸€æ¬¡<code>IntervalHistogram</code>ä¸­çš„æ•°æ®ï¼Œè¿™å°†ç»™ä½ æä¾›å…³äºè¿™æ®µæ—¶é—´å†…æœåŠ¡å™¨å“åº”æ—¶é—´åˆ†å¸ƒçš„å¿«ç…§ã€‚</li><li><strong>åˆ†æå’Œè°ƒæ•´</strong>ï¼šé€šè¿‡åˆ†æè¿™äº›å‘¨æœŸæ€§ç”Ÿæˆçš„æ•°æ®ï¼Œä½ å¯ä»¥å‘ç°æ€§èƒ½ç“¶é¢ˆã€é¢„æµ‹è´Ÿè½½èƒ½åŠ›ï¼Œå¹¶æ®æ­¤ä¼˜åŒ–ä½ çš„æœåŠ¡å™¨é…ç½®æˆ–ä»£ç ã€‚</li></ol><p>ä¾‹å¦‚ï¼Œå¦‚æœä½ è§‚å¯Ÿåˆ°æ¯ä¸ªå°æ—¶å¼€å§‹æ—¶å“åº”æ—¶é—´çªå¢ï¼Œè¿™å¯èƒ½æš—ç¤ºç€å®šæ—¶ä»»åŠ¡ï¼ˆå¦‚æ—¥å¿—è®°å½•ã€æ•°æ®å¤‡ä»½ç­‰ï¼‰å¯¹æ€§èƒ½çš„å½±å“ã€‚æ ¹æ®è¿™äº›ä¿¡æ¯ï¼Œä½ å¯ä»¥è°ƒæ•´ä»»åŠ¡å®‰æ’ï¼Œä»¥é¿å…é«˜æµé‡æ—¶æ®µä¸èµ„æºå¯†é›†å‹æ“ä½œçš„å†²çªã€‚</p><h3 id="æ€»ç»“-11" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-11"><span>æ€»ç»“</span></a></h3><p><code>IntervalHistogram</code>ä¸º Node.js åº”ç”¨æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œç”¨äºç›‘æ§å’Œåˆ†æç‰¹å®šæ—¶é—´é—´éš”å†…æ€§èƒ½æŒ‡æ ‡çš„å˜åŒ–ã€‚é€šè¿‡å‘¨æœŸæ€§åœ°æ”¶é›†å’Œé‡ç½®æ•°æ®ï¼Œå®ƒè®©å®æ—¶æ€§èƒ½ç›‘æ§æˆä¸ºå¯èƒ½ï¼Œå¸®åŠ©å¼€å‘è€…è¯†åˆ«å¹¶è§£å†³æ€§èƒ½ç“¶é¢ˆã€‚æ— è®ºæ˜¯åœ¨å¼€å‘é˜¶æ®µè¿˜æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œåˆ©ç”¨<code>IntervalHistogram</code>å¯ä»¥æœ‰æ•ˆæé«˜åº”ç”¨çš„ç¨³å®šæ€§å’Œå“åº”é€Ÿåº¦ã€‚</p><h3 id="histogram-disable" tabindex="-1"><a class="header-anchor" href="#histogram-disable"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogramdisable" target="_blank" rel="noopener noreferrer">histogram.disable()</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ JavaScript ç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>perf_hooks</code>æ¨¡å—æä¾›äº†æ€§èƒ½ç›‘æµ‹çš„å·¥å…·ï¼Œè¿™äº›å·¥å…·å¯ä»¥å¸®åŠ©å¼€å‘è€…ç›‘æ§å’Œæ”¹è¿›åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚å…¶ä¸­çš„ä¸€ä¸ªåŠŸèƒ½å°±æ˜¯â€œç›´æ–¹å›¾â€(Histogram)ã€‚ç›´æ–¹å›¾åœ¨æ€§èƒ½ç›‘æµ‹ä¸­ä¸»è¦ç”¨äºæ”¶é›†å’Œç»Ÿè®¡æ•°æ®ï¼ˆå¦‚äº‹ä»¶æŒç»­æ—¶é—´æˆ–é—´éš”ï¼‰çš„é¢‘ç‡åˆ†å¸ƒã€‚</p><h3 id="histogram-disable-æ–¹æ³•ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#histogram-disable-æ–¹æ³•ç®€ä»‹"><span><code>histogram.disable()</code> æ–¹æ³•ç®€ä»‹</span></a></h3><p><code>histogram.disable()</code> æ˜¯<code>perf_hooks</code>æ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒçš„ä½œç”¨æ˜¯åœç”¨æˆ–ç¦ç”¨å·²ç»å¯ç”¨çš„ç›´æ–¹å›¾å¯¹è±¡ã€‚ä¸€æ—¦è°ƒç”¨æ­¤æ–¹æ³•ï¼Œç›´æ–¹å›¾å¯¹è±¡å°†ä¸å†è®°å½•ä»»ä½•æ–°çš„æ•°æ®ç‚¹ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-12" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-12"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™ï¼Œå¹¶ä¸”æƒ³è¦ç¡®ä¿å®ƒçš„åŠ è½½é€Ÿåº¦è¶³å¤Ÿå¿«ï¼Œä»¥æä¾›è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®æ ‡ï¼Œä½ å†³å®šç›‘æ§ä¸€äº›å…³é”®æ“ä½œçš„æ‰§è¡Œæ—¶é—´ï¼Œæ¯”å¦‚ä»æ•°æ®åº“è·å–æ•°æ®çš„æ—¶é—´ã€‚è¿™æ—¶å€™ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>perf_hooks</code>æ¨¡å—ä¸­çš„ç›´æ–¹å›¾æ¥å¸®åŠ©ä½ ã€‚</p><h4 id="æ­¥éª¤-1-åˆ›å»ºå’Œå¯ç”¨ç›´æ–¹å›¾" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-1-åˆ›å»ºå’Œå¯ç”¨ç›´æ–¹å›¾"><span>æ­¥éª¤ 1: åˆ›å»ºå’Œå¯ç”¨ç›´æ–¹å›¾</span></a></h4><p>é¦–å…ˆï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ªç›´æ–¹å›¾å¯¹è±¡ï¼Œå¹¶å¼€å§‹æ”¶é›†æ•°æ®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºç›´æ–¹å›¾</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> histogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯ç”¨ç›´æ–¹å›¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">enable</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ­¥éª¤-2-æ”¶é›†æ•°æ®-1" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-2-æ”¶é›†æ•°æ®-1"><span>æ­¥éª¤ 2: æ”¶é›†æ•°æ®</span></a></h4><p>ç„¶åï¼Œæ¯å½“ä½ è¿›è¡Œæ•°æ®åº“æŸ¥è¯¢æ—¶ï¼Œä½ å¯ä»¥é€šè¿‡ç›´æ–¹å›¾è®°å½•æŸ¥è¯¢æ‰€éœ€çš„æ—¶é—´ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™ä¸ªå‡½æ•°æ¨¡æ‹Ÿä»æ•°æ®åº“è·å–æ•°æ®æ‰€éœ€çš„æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ•°æ®åº“æ“ä½œ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> duration</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å°†æŒç»­æ—¶é—´æ·»åŠ åˆ°ç›´æ–¹å›¾ä¸­</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ­¥éª¤-3-ç¦ç”¨ç›´æ–¹å›¾" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-3-ç¦ç”¨ç›´æ–¹å›¾"><span>æ­¥éª¤ 3: ç¦ç”¨ç›´æ–¹å›¾</span></a></h4><p>åœ¨æŸä¸ªæ—¶åˆ»ï¼Œå½“ä½ è®¤ä¸ºå·²ç»æ”¶é›†äº†è¶³å¤Ÿçš„æ•°æ®ï¼Œæˆ–è€…æƒ³è¦æš‚åœæ•°æ®æ”¶é›†ï¼Œä½ å¯ä»¥è°ƒç”¨<code>histogram.disable()</code>æ¥åœæ­¢ç›´æ–¹å›¾æ”¶é›†æ–°æ•°æ®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœç”¨ç›´æ–¹å›¾ï¼Œå®ƒå°†ä¸å†è®°å½•ä»»ä½•æ–°çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">disable</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="åˆ†ææ•°æ®" tabindex="-1"><a class="header-anchor" href="#åˆ†ææ•°æ®"><span>åˆ†ææ•°æ®</span></a></h4><p>æœ€åï¼Œä½ å¯ä»¥ä½¿ç”¨ç›´æ–¹å›¾æä¾›çš„æ–¹æ³•ï¼Œæ¯”å¦‚<code>histogram.mean</code>ï¼ˆå¹³å‡å€¼ï¼‰ã€<code>histogram.min</code>ï¼ˆæœ€å°å€¼ï¼‰ã€<code>histogram.max</code>ï¼ˆæœ€å¤§å€¼ï¼‰ï¼Œç­‰ç­‰ï¼Œæ¥åˆ†æä½ æ”¶é›†çš„æ•°æ®ï¼Œè¿›è€Œä¼˜åŒ–ä½ çš„åº”ç”¨ç¨‹åºæ€§èƒ½ã€‚</p><h3 id="æ€»ç»“-12" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-12"><span>æ€»ç»“</span></a></h3><p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼ŒåŠæ—¶åœ°ç›‘æ§å’Œåˆ†æåº”ç”¨ç¨‹åºçš„æ€§èƒ½æ˜¯éå¸¸é‡è¦çš„ã€‚Node.js çš„<code>perf_hooks</code>æ¨¡å—æä¾›çš„ç›´æ–¹å›¾åŠŸèƒ½ï¼Œä½¿å¾—æ€§èƒ½æ•°æ®çš„æ”¶é›†å’Œåˆ†æå˜å¾—ç®€å•é«˜æ•ˆã€‚é€šè¿‡<code>histogram.disable()</code>æ–¹æ³•ï¼Œä½ å¯ä»¥çµæ´»åœ°æ§åˆ¶æ•°æ®æ”¶é›†çš„èµ·æ­¢ï¼Œä¿è¯æ•°æ®çš„å‡†ç¡®æ€§å’Œç›¸å…³æ€§ã€‚è¿™åªæ˜¯<code>perf_hooks</code>æ¨¡å—ä¼—å¤šæœ‰ç”¨åŠŸèƒ½ä¸­çš„ä¸€ä¸ªï¼Œæ·±å…¥ç†è§£å’Œåº”ç”¨è¿™äº›å·¥å…·ï¼Œå°†å¯¹ä¼˜åŒ–ä½ çš„ Node.js åº”ç”¨ç¨‹åºå¤§æœ‰è£¨ç›Šã€‚</p><h3 id="histogram-enable" tabindex="-1"><a class="header-anchor" href="#histogram-enable"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogramenable" target="_blank" rel="noopener noreferrer">histogram.enable()</a></span></a></h3><p>ç†è§£ Node.js çš„<code>histogram.enable()</code>æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç®€å•äº†è§£å‡ ä¸ªæ¦‚å¿µï¼šNode.jsã€æ€§èƒ½é’©å­ï¼ˆPerformance Hooksï¼‰å’Œç›´æ–¹å›¾ï¼ˆHistogramï¼‰ã€‚</p><p><strong>Node.js</strong> æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œè®©ä½ å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚å®ƒéå¸¸é€‚åˆæ„å»ºå¿«é€Ÿã€å¯æ‰©å±•çš„ç½‘ç»œåº”ç”¨ç¨‹åºã€‚</p><p><strong>æ€§èƒ½é’©å­ï¼ˆPerformance Hooksï¼‰</strong> æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªæ¨¡å—ï¼Œå…è®¸ä½ ç›‘æµ‹å¹¶åº¦é‡ä½ çš„åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚ä½¿ç”¨è¿™ä¸ªæ¨¡å—ï¼Œå¼€å‘è€…å¯ä»¥è·å–åˆ°å¦‚å¤„ç†è¯·æ±‚çš„æ—¶é—´ã€å¼‚æ­¥æ“ä½œçš„è€—æ—¶ç­‰å¤šç§æ€§èƒ½æŒ‡æ ‡ã€‚</p><p>è€Œ**ç›´æ–¹å›¾ï¼ˆHistogramï¼‰**æ˜¯ä¸€ç§ç»Ÿè®¡å›¾è¡¨ï¼Œç”¨äºæ€»ç»“ä¸€ç³»åˆ—æ•°æ®ç‚¹çš„åˆ†å¸ƒæƒ…å†µã€‚åœ¨ Node.js çš„æ€§èƒ½é’©å­ä¸­ï¼Œç›´æ–¹å›¾ç»å¸¸è¢«ç”¨æ¥è¿½è¸ªæŸé¡¹æ“ä½œçš„è€—æ—¶åˆ†å¸ƒã€‚</p><p>é‚£ä¹ˆï¼Œ<code>histogram.enable()</code>æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>ç®€å•æ¥è¯´ï¼Œ<code>histogram.enable()</code>æ˜¯ Performance Hooks API ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºå¯ç”¨ä¸€ä¸ªä¹‹å‰å¯èƒ½å·²ç»ç¦ç”¨çš„ç›´æ–¹å›¾å¯¹è±¡ã€‚è¿™æ„å‘³ç€ï¼Œé€šè¿‡è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä½ å¯ä»¥å¼€å§‹æ”¶é›†å’Œç´¯ç§¯ç‰¹å®šæ€§èƒ½æŒ‡æ ‡çš„æ•°æ®ï¼Œæ¯”å¦‚äº‹ä»¶å¾ªç¯å»¶è¿Ÿã€HTTP è¯·æ±‚çš„å¤„ç†æ—¶é—´ç­‰ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-19" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-19"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>è€ƒè™‘ä»¥ä¸‹åœºæ™¯ï¼š</p><ol><li><strong>ç›‘æ§ HTTP è¯·æ±‚å¤„ç†æ—¶é—´ï¼š</strong> å‡è®¾ä½ æ­£åœ¨è¿è¡Œä¸€ä¸ª Node.js æœåŠ¡å™¨ï¼Œå¸Œæœ›äº†è§£æ¯ä¸ª HTTP è¯·æ±‚å¤„ç†çš„æ—¶é—´åˆ†å¸ƒæƒ…å†µã€‚é€šè¿‡ä½¿ç”¨æ€§èƒ½é’©å­ä¸­çš„ç›´æ–¹å›¾åŠŸèƒ½ï¼Œä½ å¯ä»¥å¯ç”¨ä¸€ä¸ªç›´æ–¹å›¾æ¥æ”¶é›†è¿™äº›æ•°æ®ï¼Œç„¶ååˆ©ç”¨<code>histogram.enable()</code>æ–¹æ³•ç¡®ä¿æ•°æ®çš„æ”¶é›†æ˜¯æ´»è·ƒçš„ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ–°çš„ç›´æ–¹å›¾å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> histogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯ç”¨ç›´æ–¹å›¾æ”¶é›†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">enable</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯å¤„ç†HTTPè¯·æ±‚çš„å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> handleRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¼€å§‹æµ‹é‡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¤„ç†è¯·æ±‚...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹é‡ç»“æŸ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å°†è€—æ—¶è®°å½•åˆ°ç›´æ–¹å›¾ä¸­</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Request processed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨æ€§èƒ½è§‚å¯Ÿè€…æŸ¥çœ‹ç›´æ–¹å›¾æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> observer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">mean</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å¹³å‡è€—æ—¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffered</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>åˆ†æä»£ç æ‰§è¡Œæ—¶é—´ï¼š</strong> å¦‚æœä½ åœ¨å¼€å‘è¿‡ç¨‹ä¸­æƒ³è¦åˆ†æç‰¹å®šä»£ç å—çš„æ‰§è¡Œæ—¶é—´ï¼Œä½¿ç”¨ç›´æ–¹å›¾ä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°æ”¶é›†è¿™äº›ä¿¡æ¯ï¼Œå¹¶ä¸”é€šè¿‡<code>histogram.enable()</code>ç¡®ä¿ç›´æ–¹å›¾å¤„äºæ´»è·ƒçŠ¶æ€ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ–°çš„ç›´æ–¹å›¾å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> histogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯ç”¨ç›´æ–¹å›¾æ”¶é›†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">enable</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™é‡Œæœ‰ä¸€æ®µéœ€è¦åˆ†æçš„ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰§è¡Œä¸€äº›æ“ä½œ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†æ‰§è¡Œæ—¶é—´è®°å½•åˆ°ç›´æ–¹å›¾ä¸­</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¨åå¯ä»¥æŸ¥çœ‹æˆ–åˆ†æè¿™äº›æ‰§è¡Œæ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`å¹³å‡æ‰§è¡Œæ—¶é—´ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">histogram</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">mean</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œ<code>histogram.enable()</code>åœ¨ Node.js çš„ Performance Hooks ä¸­å‘æŒ¥ç€é‡è¦ä½œç”¨ï¼Œå¸®åŠ©å¼€å‘è€…ä»¥ç›´æ–¹å›¾å½¢å¼æœ‰æ•ˆåœ°ç›‘æ§å’Œåˆ†æåº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚</p><h3 id="cloning-an-intervalhistogram" tabindex="-1"><a class="header-anchor" href="#cloning-an-intervalhistogram"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#cloning-an-intervalhistogram" target="_blank" rel="noopener noreferrer">Cloning an IntervalHistogram</a></span></a></h3><p>å¥½çš„ï¼Œä¸ºäº†è®©ä½ æ›´å®¹æ˜“ç†è§£ Node.js ä¸­çš„ â€œCloning an IntervalHistogramâ€ çš„æ¦‚å¿µï¼Œæˆ‘ä¼šå…ˆè§£é‡Šä¸€äº›èƒŒæ™¯ä¿¡æ¯ï¼Œç„¶åè¯¦ç»†è®²è¿°å¦‚ä½•è¿›è¡Œå…‹éš†æ“ä½œï¼Œå¹¶ç»™å‡ºå®é™…è¿ç”¨çš„ä¾‹å­ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-intervalhistogram" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-intervalhistogram"><span>ä»€ä¹ˆæ˜¯ IntervalHistogramï¼Ÿ</span></a></h3><p>åœ¨ Node.js çš„æ€§èƒ½é’©å­ï¼ˆ<code>perf_hooks</code>ï¼‰æ¨¡å—ä¸­ï¼Œ<code>IntervalHistogram</code> æ˜¯ä¸€ä¸ªç”¨äºæ”¶é›†å’Œç»Ÿè®¡æ—¶é—´é—´éš”ï¼ˆä¾‹å¦‚äº‹ä»¶æŒç»­æ—¶é—´ï¼‰çš„æ•°æ®ç»“æ„ã€‚å®ƒå¯ä»¥å¸®åŠ©ä½ æµ‹é‡ä»£ç æ®µè¿è¡Œçš„æ—¶é—´åˆ†å¸ƒæƒ…å†µï¼Œæ¯”å¦‚äº†è§£æŸä¸ªå‡½æ•°è°ƒç”¨çš„æœ€çŸ­ã€æœ€é•¿æ—¶é—´ä»¥åŠå¹³å‡æ—¶é—´ç­‰ã€‚</p><h3 id="å…‹éš†-intervalhistogram-çš„æ„ä¹‰" tabindex="-1"><a class="header-anchor" href="#å…‹éš†-intervalhistogram-çš„æ„ä¹‰"><span>å…‹éš† IntervalHistogram çš„æ„ä¹‰</span></a></h3><p>å…‹éš†ä¸€ä¸ª <code>IntervalHistogram</code> å®ä¾‹çš„ä¸»è¦ç›®çš„æ˜¯åˆ›å»ºå…¶å½“å‰çŠ¶æ€çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œè¿™æ ·ä½ å°±å¯ä»¥åœ¨ä¸å½±å“åŸå§‹å®ä¾‹çš„æƒ…å†µä¸‹å¯¹å‰¯æœ¬è¿›è¡Œè¿›ä¸€æ­¥çš„æ“ä½œæˆ–è€…åˆ†æã€‚è¿™åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­å°¤å…¶æœ‰ç”¨ï¼Œå› ä¸ºä½ å¯èƒ½éœ€è¦åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ”¶é›†æ•°æ®ï¼Œè€Œåœ¨å¦ä¸€ä¸ªçº¿ç¨‹ä¸­åˆ†æè¿™äº›æ•°æ®ï¼Œæ­¤æ—¶å…‹éš†å°±æ˜¾å¾—éå¸¸é‡è¦äº†ã€‚</p><h3 id="å¦‚ä½•å…‹éš†" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•å…‹éš†"><span>å¦‚ä½•å…‹éš†</span></a></h3><p>Node.js v21.7.1 æ–‡æ¡£ä¸­æåˆ°çš„å…‹éš† <code>IntervalHistogram</code> çš„æ–¹æ³•æ˜¯é€šè¿‡è°ƒç”¨ <code>histogram.clone()</code> æ¥å®Œæˆçš„ã€‚è¿™é‡Œçš„ <code>histogram</code> æ˜¯ä½ å·²ç»åˆ›å»ºå¹¶ä¸”æƒ³è¦å…‹éš†çš„ <code>IntervalHistogram</code> å®ä¾‹ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-13" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-13"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç»œåº”ç”¨ï¼Œä½ æƒ³ç›‘æ§å¤„ç† HTTP è¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚ä¸ºæ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>perf_hooks</code> æ¨¡å—æ¥åˆ›å»ºä¸€ä¸ª <code>IntervalHistogram</code>ï¼Œè®°å½•æ¯æ¬¡è¯·æ±‚çš„å¤„ç†æ—¶é—´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ€§èƒ½è§‚å¯Ÿå™¨ï¼Œå…³æ³¨ &#39;http&#39; ç±»å‹çš„æ€§èƒ½æ¡ç›®ã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`HTTP è¯·æ±‚å¤„ç†æ—¶é—´ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹ŸHTTPè¯·æ±‚å¤„ç†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;HTTP è¯·æ±‚å¤„ç†æ—¶é—´&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ­¤æ—¶æˆ‘ä»¬æœ‰äº†åŸå§‹çš„ histogram å®ä¾‹ï¼Œå‡è®¾è¿™æ˜¯æˆ‘ä»¬ç›‘æ§åˆ°çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> histogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">nodeTiming</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å…‹éš† histogram ä»¥è¿›è¡Œç‹¬ç«‹åˆ†æ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> clonedHistogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clone</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ç°åœ¨ clonedHistogram æ˜¯ histogram çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä½ å¯ä»¥å¯¹å…¶è¿›è¡Œåˆ†æï¼Œè€Œä¸ä¼šå½±å“åŸå§‹çš„ histogram æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">clonedHistogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">percentiles</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°ç™¾åˆ†æ¯”æ•°æ®ç­‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªæ€§èƒ½è§‚å¯Ÿå™¨ï¼Œç”¨æ¥ç›‘å¬ HTTP è¯·æ±‚çš„å¤„ç†æ—¶é—´ã€‚ç„¶åï¼Œæ¨¡æ‹Ÿäº†ä¸€ä¸ªè¯·æ±‚å¤„ç†æµç¨‹ï¼šè®¾ç½®äº†èµ·å§‹æ ‡è®° <code>A</code> å’Œç»“æŸæ ‡è®° <code>B</code>ï¼Œå¹¶åœ¨ä¸¤ä¸ªæ ‡è®°ä¹‹é—´æµ‹é‡äº†å¤„ç†æ—¶é—´ï¼ˆå®é™…å¼€å‘ä¸­ï¼Œè¿™äº›æ ‡è®°ä¼šæ”¾ç½®åœ¨çœŸå®çš„è¯·æ±‚å¤„ç†é€»è¾‘å¼€å§‹å’Œç»“æŸçš„ä½ç½®ï¼‰ã€‚æœ€åï¼Œæˆ‘ä»¬ä» <code>performance.nodeTiming</code> è·å–äº†ä¸€ä¸ª <code>IntervalHistogram</code> å®ä¾‹ï¼Œä»£è¡¨äº†è¿™ä¸ªæ—¶é—´æ®µå†…çš„æ€§èƒ½åº¦é‡ï¼Œç„¶åé€šè¿‡ <code>.clone()</code> æ–¹æ³•å…‹éš†äº†å®ƒï¼Œä»è€Œå¯ä»¥å®‰å…¨åœ°å¯¹å‰¯æœ¬è¿›è¡Œåˆ†æï¼Œè€Œä¸ä¼šå½±å“åŸå§‹æ•°æ®ã€‚</p><p>å¸Œæœ›è¿™ä¸ªä¾‹å­èƒ½å¸®åŠ©ä½ ç†è§£åœ¨ Node.js ä¸­å…‹éš† <code>IntervalHistogram</code> çš„æ¦‚å¿µå’Œç”¨æ³•ï¼</p><h2 id="class-recordablehistogram-extends-histogram" tabindex="-1"><a class="header-anchor" href="#class-recordablehistogram-extends-histogram"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#class-recordablehistogram-extends-histogram" target="_blank" rel="noopener noreferrer">Class: RecordableHistogram extends Histogram</a></span></a></h2><p>äº†è§£ Node.js ä¸­çš„<code>RecordableHistogram</code>ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå¾—ç®€è¦æ˜äº†ä¸¤ä¸ªæ¦‚å¿µï¼šNode.js å’Œç›´æ–¹å›¾ï¼ˆHistogramï¼‰ã€‚</p><h3 id="node-js-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#node-js-ç®€ä»‹"><span>Node.js ç®€ä»‹</span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡ç«¯ä»£ç ï¼Œå®ƒéå¸¸é€‚åˆæ„å»ºé«˜æ€§èƒ½çš„ç½‘ç»œåº”ç”¨ç¨‹åºã€‚</p><h3 id="ç›´æ–¹å›¾-histogram-1" tabindex="-1"><a class="header-anchor" href="#ç›´æ–¹å›¾-histogram-1"><span>ç›´æ–¹å›¾ï¼ˆHistogramï¼‰</span></a></h3><p>ç›´æ–¹å›¾æ˜¯ä¸€ç§ç»Ÿè®¡æŠ¥å‘Šå›¾ï¼Œä¸»è¦ç”¨äºå±•ç¤ºæŸä¸ªæ•°æ®åˆ†å¸ƒçš„æƒ…å†µã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³çœ‹ä¸€ä¸ªç­çº§ä¸­å­¦ç”Ÿçš„åˆ†æ•°åˆ†å¸ƒï¼Œä½ å°±å¯ä»¥ç”¨ç›´æ–¹å›¾è¡¨ç¤ºå‡ºå¤šå°‘å­¦ç”Ÿåœ¨å„ä¸ªåˆ†æ•°æ®µå†…ã€‚</p><h3 id="recordablehistogram-çš„ç†è§£" tabindex="-1"><a class="header-anchor" href="#recordablehistogram-çš„ç†è§£"><span>RecordableHistogram çš„ç†è§£</span></a></h3><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­æåˆ°çš„<code>RecordableHistogram</code>æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç±»ï¼Œå®ƒç»§æ‰¿è‡ª<code>Histogram</code>ç±»ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>Histogram</code>ç”¨äºæ”¶é›†å¹¶è®°å½•æ—¶é—´è·¨åº¦æˆ–æ“ä½œçš„é¢‘ç‡ï¼Œä»¥ä¾¿äºæ€§èƒ½ç›‘æ§å’Œç»Ÿè®¡ã€‚é‚£ä¹ˆï¼Œ<code>RecordableHistogram</code>åˆ™è¿›ä¸€æ­¥æ‰©å±•äº†è¿™ä¸€åŠŸèƒ½ï¼Œå…è®¸è¿™äº›æ•°æ®è¢«è®°å½•å¹¶ä¸”åœ¨ä¹‹åç”¨äºåˆ†æå’Œç›‘æ§ã€‚</p><h4 id="å®é™…åº”ç”¨ä¾‹å­-8" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-8"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h4><ol><li><p><strong>æ€§èƒ½ç›‘æ§</strong>ï¼šå‡è®¾ä½ æ­£åœ¨è¿è¡Œä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œä½ å¯èƒ½æƒ³çŸ¥é“å¤„ç†æ¯ä¸ªè¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚é€šè¿‡å°†æ¯ä¸ªè¯·æ±‚å¤„ç†çš„æ—¶é—´è®°å½•åˆ°ä¸€ä¸ª<code>RecordableHistogram</code>ä¸­ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°çœ‹åˆ°å¤§éƒ¨åˆ†è¯·æ±‚æ˜¯åœ¨å¤šå°‘æ¯«ç§’å†…å®Œæˆçš„ï¼Œæ˜¯å¦æœ‰ä»»ä½•å¼‚å¸¸é•¿çš„è¯·æ±‚æ—¶é—´ï¼Œä»è€Œå¸®åŠ©ä½ ä¼˜åŒ–æœåŠ¡å™¨æ€§èƒ½ã€‚</p></li><li><p><strong>ç”¨æˆ·ä½“éªŒåˆ†æ</strong>ï¼šå¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªè§†é¢‘æ’­æ”¾å™¨ï¼Œå¹¶æƒ³ç›‘æ§ç¼“å†²å»¶è¿Ÿå¯¹ç”¨æˆ·ä½“éªŒçš„å½±å“ã€‚ä½¿ç”¨<code>RecordableHistogram</code>è®°å½•ç”¨æˆ·é­é‡çš„æ¯æ¬¡ç¼“å†²å»¶è¿Ÿæ—¶é—´ï¼Œä½ å¯ä»¥åˆ†æå»¶è¿Ÿåˆ†å¸ƒï¼Œè¿›è€Œè°ƒæ•´ç®—æ³•æˆ–èµ„æºåˆ†é…ä»¥å‡å°‘å»¶è¿Ÿï¼Œæå‡ç”¨æˆ·æ»¡æ„åº¦ã€‚</p></li><li><p><strong>ç³»ç»Ÿèµ„æºç›‘æ§</strong>ï¼šæ¯”å¦‚ä½ æƒ³ç›‘æ§æ•°æ®åº“æ“ä½œçš„æ€§èƒ½ã€‚é€šè¿‡ä¸ºä¸åŒç±»å‹çš„æ•°æ®åº“æ“ä½œï¼ˆå¦‚è¯»å–ã€å†™å…¥ã€æ›´æ–°ç­‰ï¼‰åˆ›å»ºä¸åŒçš„<code>RecordableHistogram</code>å®ä¾‹ï¼Œå¯ä»¥è¯¦ç»†äº†è§£æ¯ç§æ“ä½œçš„æ€§èƒ½ç‰¹æ€§ï¼Œè¯†åˆ«å‡ºæ€§èƒ½ç“¶é¢ˆï¼Œä»è€Œé’ˆå¯¹æ€§åœ°è¿›è¡Œä¼˜åŒ–ã€‚</p></li></ol><h3 id="æ€»ç»“-13" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-13"><span>æ€»ç»“</span></a></h3><p><code>RecordableHistogram</code>æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªå¼ºå¤§å·¥å…·ï¼Œå®ƒé€šè¿‡ç»§æ‰¿<code>Histogram</code>ç±»ï¼Œä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿæ›´æ–¹ä¾¿åœ°è®°å½•å’Œåˆ†ææ•°æ®ï¼Œä»è€Œåœ¨æ€§èƒ½ç›‘æ§ã€ç”¨æˆ·ä½“éªŒæ”¹å–„ä»¥åŠç³»ç»Ÿèµ„æºç®¡ç†ç­‰æ–¹é¢å‘æŒ¥é‡è¦ä½œç”¨ã€‚é€šè¿‡ä¸Šè¿°ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ°å®ƒåœ¨å®é™…åº”ç”¨ä¸­çš„å¤šæ ·åŒ–ç”¨é€”ï¼Œå¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°ç†è§£å’Œä¼˜åŒ–ä»–ä»¬çš„åº”ç”¨æˆ–ç³»ç»Ÿã€‚</p><h3 id="histogram-add-other" tabindex="-1"><a class="header-anchor" href="#histogram-add-other"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogramaddother" target="_blank" rel="noopener noreferrer">histogram.add(other)</a></span></a></h3><p>ç†è§£ <code>histogram.add(other)</code> å‡½æ•°ä¹‹å‰ï¼Œé¦–å…ˆéœ€è¦äº†è§£ä¸€ä¸‹ Node.js ä¸­çš„ <code>Histogram</code> å¯¹è±¡æ˜¯å¹²ä»€ä¹ˆçš„ã€‚åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œ<code>Histogram</code> æ˜¯æ€§èƒ½é’©å­ï¼ˆ<code>perf_hooks</code>ï¼‰æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒç”¨äºæ”¶é›†å’Œç»Ÿè®¡æ—¶é—´è·¨åº¦æˆ–å…¶å®ƒæ•°æ®çš„åˆ†å¸ƒæƒ…å†µã€‚ç®€å•æ¥è¯´ï¼Œä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªé«˜çº§è®¡æ—¶å™¨ï¼Œä¸ä»…å¯ä»¥å‘Šè¯‰ä½ æŸä¸ªæ“ä½œç”¨äº†å¤šä¹…ï¼Œè¿˜å¯ä»¥æä¾›æ›´ä¸°å¯Œçš„ç»Ÿè®¡ä¿¡æ¯ï¼Œæ¯”å¦‚æœ€å°å€¼ã€æœ€å¤§å€¼ã€å¹³å‡å€¼ç­‰ã€‚</p><p><code>histogram.add(other)</code> è¿™ä¸ªå‡½æ•°å…è®¸ä½ å°†ä¸¤ä¸ª <code>Histogram</code> å¯¹è±¡çš„æ•°æ®åˆå¹¶ã€‚è¿™é‡Œçš„ <code>other</code> å°±æ˜¯å¦ä¸€ä¸ª <code>Histogram</code> å®ä¾‹ã€‚é€šè¿‡ä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼Œä½ å¯ä»¥ä»ä¸åŒçš„æ¥æºæˆ–ä¸åŒçš„æ—¶é—´æ®µæ”¶é›†åˆ°çš„æ•°æ®è¿›è¡Œæ±‡æ€»ï¼Œå¹¶ä½œä¸ºä¸€ä¸ªæ•´ä½“è¿›è¡Œåˆ†æã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-20" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-20"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="ä¾‹å­-1-ç½‘ç«™å“åº”æ—¶é—´ç›‘æ§" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-ç½‘ç«™å“åº”æ—¶é—´ç›‘æ§"><span>ä¾‹å­ 1ï¼šç½‘ç«™å“åº”æ—¶é—´ç›‘æ§</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ç®¡ç†ä¸€ä¸ªç½‘ç«™ï¼Œæƒ³è¦ç›‘æ§ç½‘ç«™çš„å“åº”æ—¶é—´ã€‚ä½ å¯ä»¥ä¸ºæ¯ä¸ªå°æ—¶åˆ›å»ºä¸€ä¸ª <code>Histogram</code> å¯¹è±¡æ¥è®°å½•é‚£ä¸ªå°æ—¶å†…æ‰€æœ‰è¯·æ±‚çš„å“åº”æ—¶é—´ã€‚åˆ°äº†æœˆæœ«ï¼Œå¦‚æœä½ æƒ³è¦åˆ†ææ•´ä¸ªæœˆçš„è¡¨ç°ï¼Œå¯ä»¥ç”¨ <code>histogram.add(other)</code> æ¥å°†è¿™ 30 ä¸ªæˆ–è€… 31 ä¸ªå°æ—¶çš„ <code>Histogram</code> å¯¹è±¡åˆå¹¶èµ·æ¥ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªåŒ…å«æ•´ä¸ªæœˆæ•°æ®çš„ <code>Histogram</code>ï¼Œä»è€Œèƒ½å¤Ÿåˆ†æå‡ºè¿™ä¸ªæœˆå“åº”æ—¶é—´çš„å¹³å‡å€¼ã€æœ€å°å€¼ã€æœ€å¤§å€¼ç­‰å…³é”®æŒ‡æ ‡ã€‚</p><h4 id="ä¾‹å­-2-ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ"><span>ä¾‹å­ 2ï¼šç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ</span></a></h4><p>è€ƒè™‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œè¯¥åº”ç”¨åˆ†å¸ƒå¼éƒ¨ç½²åœ¨å¤šå°æœºå™¨ä¸Šã€‚ä½ å¯èƒ½ä¼šåœ¨æ¯å°æœºå™¨ä¸Šéƒ¨ç½²ç›¸åŒçš„ä»£ç æ¥æ”¶é›†å…³äºç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µï¼ˆå¦‚ CPU ä½¿ç”¨ç‡ï¼‰çš„ä¿¡æ¯ã€‚æ¯å°æœºå™¨éƒ½ä¼šç”Ÿæˆè‡ªå·±çš„ <code>Histogram</code> æ•°æ®ã€‚ä¸ºäº†å¾—åˆ°æ•´ä¸ªç³»ç»Ÿçš„èµ„æºä½¿ç”¨æƒ…å†µçš„å…¨è²Œï¼Œä½ å¯ä»¥å°†æ¥è‡ªå„ä¸ªæœºå™¨çš„ <code>Histogram</code> æ•°æ®é€šè¿‡ <code>histogram.add(other)</code> åˆå¹¶èµ·æ¥ã€‚è¿™æ ·ï¼Œå°±å¯ä»¥åˆ†ææ•´ä¸ªç³»ç»Ÿçš„èµ„æºä½¿ç”¨æ•ˆç‡ï¼Œå¸®åŠ©ä½ æ‰¾åˆ°å¯èƒ½çš„æ€§èƒ½ç“¶é¢ˆã€‚</p><h4 id="ä¾‹å­-3-æ¸¸æˆç©å®¶å¾—åˆ†åˆ†å¸ƒ" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-3-æ¸¸æˆç©å®¶å¾—åˆ†åˆ†å¸ƒ"><span>ä¾‹å­ 3ï¼šæ¸¸æˆç©å®¶å¾—åˆ†åˆ†å¸ƒ</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªæ¸¸æˆï¼Œä½ æƒ³åˆ†æç©å®¶çš„å¾—åˆ†åˆ†å¸ƒæƒ…å†µã€‚æ¯å½“ç©å®¶å®Œæˆä¸€å±€æ¸¸æˆï¼Œä½ å°±è®°å½•ä¸‹ä»–ä»¬çš„å¾—åˆ†ã€‚è¿™äº›å¾—åˆ†å¯ä»¥è¢«å­˜å‚¨åœ¨ä¸€ä¸ª <code>Histogram</code> å¯¹è±¡ä¸­ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œä½ å¯ä»¥ä¸ºä¸åŒçš„æ—¶é—´æ®µï¼ˆæ¯”å¦‚æ¯å¤©ï¼‰åˆ›å»ºä¸åŒçš„ <code>Histogram</code> å¯¹è±¡ã€‚å¦‚æœä½ æƒ³åˆ†æè¿‡å»ä¸€å‘¨å†…ç©å®¶çš„å¾—åˆ†åˆ†å¸ƒæƒ…å†µï¼Œå¯ä»¥å°†è¿™ 7 å¤©çš„ <code>Histogram</code> å¯¹è±¡ä½¿ç”¨ <code>histogram.add(other)</code> æ–¹æ³•åˆå¹¶ã€‚è¿™æ ·ï¼Œå°±èƒ½é€šè¿‡å¾—åˆ°çš„æ•°æ®æ¥åˆ†æå’Œè°ƒæ•´æ¸¸æˆéš¾åº¦ï¼Œç¡®ä¿æ¸¸æˆçš„è¶£å‘³æ€§å’ŒæŒ‘æˆ˜æ€§ã€‚</p><p>é€šè¿‡ä»¥ä¸Šä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>histogram.add(other)</code> åœ¨å®é™…åº”ç”¨ä¸­å¦‚ä½•å¸®åŠ©æˆ‘ä»¬ä»å¤šä¸ªæ•°æ®æºä¸­æ±‡æ€»æ•°æ®ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨è¿™äº›æ•°æ®æ¥åšå‡ºæ›´åŠ æ˜æ™ºçš„å†³ç­–ã€‚</p><h3 id="histogram-record-val" tabindex="-1"><a class="header-anchor" href="#histogram-record-val"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogramrecordval" target="_blank" rel="noopener noreferrer">histogram.record(val)</a></span></a></h3><p>ç†è§£<code>histogram.record(val)</code>ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦çŸ¥é“ä¸¤ä¸ªæ¦‚å¿µï¼šHistogramï¼ˆç›´æ–¹å›¾ï¼‰å’Œ Node.js ä¸­çš„ <code>perf_hooks</code> æ¨¡å—ã€‚</p><h3 id="_1-histogram-ç›´æ–¹å›¾" tabindex="-1"><a class="header-anchor" href="#_1-histogram-ç›´æ–¹å›¾"><span>1. Histogram (ç›´æ–¹å›¾)</span></a></h3><p>ç›´æ–¹å›¾æ˜¯ä¸€ä¸ªç»Ÿè®¡å·¥å…·ï¼Œç”¨äºè¡¨ç¤ºæ•°æ®åˆ†å¸ƒã€‚æ¯”å¦‚ï¼Œä½ æœ‰ä¸€ç»„å­¦ç”Ÿçš„è€ƒè¯•æˆç»©ï¼Œä½ æƒ³çŸ¥é“å¤šå°‘å­¦ç”Ÿåˆ†æ•°åœ¨ 90-100ã€80-89ã€70-79 ç­‰åŒºé—´å†…ã€‚ç›´æ–¹å›¾å°±èƒ½å¸®ä½ ä»¥å›¾å½¢çš„æ–¹å¼å±•ç¤ºè¿™äº›åŒºé—´çš„äººæ•°åˆ†å¸ƒã€‚</p><h3 id="_2-node-js-çš„-perf-hooks-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_2-node-js-çš„-perf-hooks-æ¨¡å—"><span>2. Node.js çš„ <code>perf_hooks</code> æ¨¡å—</span></a></h3><p>Node.js çš„ <code>perf_hooks</code>ï¼ˆæ€§èƒ½é’©å­ï¼‰æ¨¡å—æä¾›äº†ç›‘æ§ Node.js ç¨‹åºæ€§èƒ½çš„èƒ½åŠ›ã€‚å®ƒå¯ä»¥ç”¨æ¥æ”¶é›†é«˜ç²¾åº¦çš„æ—¶é—´æµ‹é‡ï¼Œä¾‹å¦‚æ“ä½œçš„è€—æ—¶ç­‰ã€‚é€šè¿‡è¿™äº›æ•°æ®ï¼Œå¼€å‘è€…å¯ä»¥ä¼˜åŒ–åº”ç”¨æ€§èƒ½ã€‚</p><h3 id="histogram-record-val-è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#histogram-record-val-è§£é‡Š"><span>Histogram.record(val) è§£é‡Š</span></a></h3><p>åœ¨ Node.js çš„ <code>perf_hooks</code> æ¨¡å—ä¸­ï¼Œ<code>Histogram</code> æ˜¯ä¸€ä¸ªç”¨äºæ”¶é›†å’Œè®°å½•æ—¶é—´æ•°æ®çš„å¯¹è±¡ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥åˆ›å»ºç›´æ–¹å›¾ï¼Œä»è€Œç†è§£æŸä¸ªç‰¹å®šæ“ä½œæˆ–äº‹ä»¶çš„æ—¶é—´åˆ†å¸ƒæƒ…å†µã€‚<code>histogram.record(val)</code> æ–¹æ³•å…è®¸ä½ å°†ä¸€ä¸ªæ–°çš„å€¼ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªè¡¨ç¤ºæ—¶é—´çš„å€¼ï¼Œå¦‚æ“ä½œè€—æ—¶ï¼‰è®°å½•åˆ°ç›´æ–¹å›¾ä¸­ã€‚è¿™é‡Œçš„ <code>val</code> å°±æ˜¯ä½ è¦è®°å½•çš„å€¼ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-14" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-14"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-æµ‹é‡-api-è¯·æ±‚çš„å“åº”æ—¶é—´" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æµ‹é‡-api-è¯·æ±‚çš„å“åº”æ—¶é—´"><span>ç¤ºä¾‹ 1: æµ‹é‡ API è¯·æ±‚çš„å“åº”æ—¶é—´</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨æ„å»ºä¸€ä¸ª Web åº”ç”¨ï¼Œå¹¶ä¸”æƒ³è¦ç›‘æ§ä½ çš„ API è¯·æ±‚å“åº”æ—¶é—´ï¼Œç¡®ä¿å®ƒä»¬éƒ½è¶³å¤Ÿå¿«ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>perf_hooks</code> çš„ Histogram æ¥è®°å½•æ¯ä¸ªè¯·æ±‚çš„å“åº”æ—¶é—´ã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;perf_hooks&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª histogram æ¥è®°å½• API è¯·æ±‚çš„è€—æ—¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> histogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å‡è®¾æˆ‘ä»¬å…³å¿ƒçš„å“åº”æ—¶é—´ä¸è¶…è¿‡3000æ¯«ç§’</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`APIè¯·æ±‚ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> çš„å“åº”æ—¶é—´ä¸º </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ms.`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">warn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`APIè¯·æ±‚ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> çš„å“åº”æ—¶é—´è¾ƒæ…¢ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ms.`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;measure&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffered</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹ŸAPIè¯·æ±‚å¹¶æµ‹é‡å“åº”æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> simulateApiRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">requestName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ¨¡æ‹Ÿå¼‚æ­¥APIè¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // è¯·æ±‚ç»“æŸåçš„æ—¶é—´ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> duration</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // è®°å½•åˆ° histogram</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // ä½¿ç”¨PerformanceObserveræ¥è®°å½•å’ŒæŠ¥å‘Š</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">requestName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">start</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Math</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">random</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// éšæœºå»¶è¿Ÿ0-2ç§’ä»¥æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿå‡ ä¸ªAPIè¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">simulateApiRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;GET /api/user&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">simulateApiRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;POST /api/order&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">simulateApiRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;GET /api/products&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª <code>PerformanceObserver</code> æ¥ç›‘å¬å’Œæ‰“å°å‡ºæ¯æ¬¡ API è¯·æ±‚çš„å“åº”æ—¶é—´ã€‚é€šè¿‡å¯¹<code>duration</code>çš„åˆ¤æ–­ï¼Œæˆ‘ä»¬å¯ä»¥è¯†åˆ«å‡ºå“ªäº›è¯·æ±‚å“åº”æ—¶é—´è¾ƒæ…¢ã€‚è¿™ç§æ–¹å¼å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£ API æ€§èƒ½å¹¶è¿›è¡Œç›¸åº”çš„ä¼˜åŒ–ã€‚</p><h4 id="æ³¨æ„" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„"><span>æ³¨æ„</span></a></h4><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å®é™…ä»£ç ä¸­<code>histogram.record()</code>çš„å…·ä½“ç”¨æ³•å¯èƒ½ä¼šä¸ä¸Šè¿°ç¤ºä¾‹æœ‰æ‰€ä¸åŒï¼Œå› ä¸ºè¿™é‡Œçš„é‡ç‚¹æ˜¯è§£é‡Šæ¦‚å¿µå’Œä½¿ç”¨åœºæ™¯ã€‚æ ¹æ® Node.js ç‰ˆæœ¬çš„ä¸åŒï¼ŒAPI çš„ç»†èŠ‚å¯èƒ½æœ‰å˜åŒ–ï¼Œè¯·å‚è€ƒæœ€æ–°çš„å®˜æ–¹æ–‡æ¡£ã€‚</p><h3 id="histogram-recorddelta" tabindex="-1"><a class="header-anchor" href="#histogram-recorddelta"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#histogramrecorddelta" target="_blank" rel="noopener noreferrer">histogram.recordDelta()</a></span></a></h3><p>å½“ä½ å¼€å§‹ä½¿ç”¨ Node.jsï¼Œä¸€ä¸ªé‡è¦çš„æ¦‚å¿µæ˜¯äº†è§£å¦‚ä½•ç›‘æ§å’Œä¼˜åŒ–ä½ çš„åº”ç”¨æ€§èƒ½ã€‚åœ¨ Node.js v21.7.1 ä¸­å¼•å…¥äº†ä¸€é¡¹åŠŸèƒ½ï¼Œ<code>histogram.recordDelta()</code>ï¼Œå®ƒä¸ºå¼€å‘è€…æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·æ¥ç²¾ç¡®è·Ÿè¸ªå’Œè¡¡é‡æ€§èƒ½æŒ‡æ ‡ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç†è§£ä»€ä¹ˆæ˜¯ Histogramï¼ˆç›´æ–¹å›¾ï¼‰ã€‚åœ¨æ€§èƒ½ç›‘æµ‹ä¸Šä¸‹æ–‡ä¸­ï¼ŒHistogram æ˜¯ä¸€ç§ç”¨äºæµ‹é‡å¹¶è®°å½•æ•°æ®åˆ†å¸ƒçš„å·¥å…·ã€‚ä¾‹å¦‚ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ äº†è§£æŸä¸ªæ“ä½œçš„æ‰§è¡Œæ—¶é—´åˆ†å¸ƒæƒ…å†µâ€”â€”æ˜¯å¦å¤§å¤šæ•°è¯·æ±‚éƒ½å¾ˆå¿«è¢«å¤„ç†ï¼Œè¿˜æ˜¯æœ‰ä¸€å°éƒ¨åˆ†è¯·æ±‚çš„å¤„ç†æ—¶é—´è¿œé•¿äºå…¶ä»–ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>perf_hooks</code>æ¨¡å—å…è®¸ä½ æ¥å…¥ä¸åŒç±»å‹çš„æ€§èƒ½ç›‘æµ‹æŒ‡æ ‡ï¼Œè€Œ<code>histogram</code>æ˜¯å…¶ä¸­ä¸€ä¸ªç‰¹åˆ«æœ‰ç”¨çš„å®ç”¨å·¥å…·ã€‚é€šè¿‡è¿™ä¸ªå·¥å…·ï¼Œä½ å¯ä»¥æ”¶é›†å…³äºç‰¹å®šäº‹ä»¶ï¼ˆå¦‚ HTTP è¯·æ±‚çš„å“åº”æ—¶é—´ï¼‰çš„ç»Ÿè®¡æ•°æ®ã€‚</p><h3 id="histogram-recorddelta-1" tabindex="-1"><a class="header-anchor" href="#histogram-recorddelta-1"><span><code>histogram.recordDelta()</code></span></a></h3><p><code>histogram.recordDelta()</code>æ–¹æ³•æ˜¯<code>perf_hooks</code>æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå…è®¸ä½ åœ¨ç›´æ–¹å›¾ä¸­è®°å½•ä¸¤æ¬¡æµ‹é‡ä¹‹é—´çš„å·®å€¼ã€‚è¿™å¯¹äºç›‘æµ‹é‚£äº›éšæ—¶é—´åŠ¨æ€å˜åŒ–çš„æ€§èƒ½æŒ‡æ ‡ç‰¹åˆ«æœ‰ç”¨ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ æƒ³ç›‘æ§ä½ çš„ Web æœåŠ¡å™¨å¤„ç†è¯·æ±‚æ‰€éœ€æ—¶é—´çš„å˜åŒ–ã€‚ä½ å¯ä»¥åœ¨è¯·æ±‚å¼€å§‹æ—¶è®°å½•ä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œåœ¨è¯·æ±‚ç»“æŸæ—¶å†è®°å½•ä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œç„¶åä½¿ç”¨<code>recordDelta()</code>æ¥å°†è¿™ä¸¤ä¸ªæ—¶é—´ç‚¹ä¹‹é—´çš„å·®å€¼ï¼ˆå³å¤„ç†è¯·æ±‚æ‰€éœ€çš„æ—¶é—´ï¼‰è®°å½•åˆ°ç›´æ–¹å›¾ä¸­ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ–°çš„ç›´æ–¹å›¾å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> histogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯è¯·æ±‚å¼€å§‹æ—¶çš„æ—¶é—´æˆ³</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> startTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿè¯·æ±‚å¤„ç†è¿‡ç¨‹...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¯·æ±‚å¤„ç†å®Œæˆï¼Œè®°å½•ç»“æŸæ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> endTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä½¿ç”¨recordDelta()è®°å½•å¼€å§‹å’Œç»“æŸæ—¶é—´ä¹‹é—´çš„å·®å€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">recordDelta</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">endTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> startTime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è¯·æ±‚å¤„ç†æ—¶é—´: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">endTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> startTime</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`ç›´æ–¹å›¾å†…å®¹:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">histogram</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>performance.now()</code>æ¥è·å–é«˜ç²¾åº¦çš„æ—¶é—´æˆ³ï¼Œç”¨äºè¡¨ç¤ºè¯·æ±‚å¤„ç†çš„å¼€å§‹å’Œç»“æŸæ—¶é—´ã€‚ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡<code>recordDelta()</code>å°†å¤„ç†æ—¶é—´è®°å½•åˆ°<code>histogram</code>ä¸­ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ç›´æ–¹å›¾æä¾›çš„å„ç§ç»Ÿè®¡ä¿¡æ¯ï¼ˆå¦‚æœ€å°å€¼ã€æœ€å¤§å€¼ã€å¹³å‘å€¼ç­‰ï¼‰æ¥åˆ†æå’Œä¼˜åŒ–æˆ‘ä»¬çš„åº”ç”¨ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒNode.js è®©æ€§èƒ½ç›‘æ§å˜å¾—æ›´åŠ ç®€å•å’Œæœ‰æ•ˆã€‚ä½ å¯ä»¥æ”¶é›†å…³äºåº”ç”¨æ€§èƒ½çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¹¶æ®æ­¤åšå‡ºç›¸åº”çš„è°ƒæ•´ä»¥æ”¹å–„ç”¨æˆ·ä½“éªŒã€‚</p><h2 id="examples" tabindex="-1"><a class="header-anchor" href="#examples"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#examples" target="_blank" rel="noopener noreferrer">Examples</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå…è®¸åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚<code>perf_hooks</code> æ¨¡å—æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªæ€§èƒ½é’©å­ï¼ˆPerformance Hooksï¼‰APIï¼Œç”¨äºæµ‹é‡å’Œç›‘æ§ä»£ç çš„æ€§èƒ½ã€‚å®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç†è§£ä»£ç åœ¨è¿è¡Œæ—¶çš„è¡¨ç°ï¼Œå¹¶å¯¹å…¶è¿›è¡Œä¼˜åŒ–ã€‚</p><p>åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œå…³äº <code>perf_hooks</code> çš„ä¾‹å­ä¸»è¦æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨è¿™ä¸ªæ¨¡å—æ¥æ”¶é›†æ€§èƒ½ç›¸å…³çš„æ•°æ®ã€‚è¿™äº›æ•°æ®å¯ä»¥å¸®åŠ©ä½ ç†è§£åº”ç”¨ç¨‹åºçš„è¿è¡Œæƒ…å†µï¼Œä¾‹å¦‚å“åº”æ—¶é—´ã€æ‰§è¡Œæ—¶é—´ç­‰ã€‚ä¸‹é¢ï¼Œæˆ‘å°†é€šè¿‡å‡ ä¸ªå®é™…çš„ä¾‹å­æ¥è§£é‡Šè¿™ä¸ªæ¦‚å¿µã€‚</p><h3 id="_1-æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´-2" tabindex="-1"><a class="header-anchor" href="#_1-æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´-2"><span>1. æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´</span></a></h3><p>å‡è®¾ä½ æƒ³çŸ¥é“æŸä¸ªå‡½æ•°æ‰§è¡Œéœ€è¦å¤šé•¿æ—¶é—´ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>perf_hooks</code> æ¥æµ‹é‡è¿™ä¸ªæ—¶é—´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;perf_hooks&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿä¸€æ®µè€—æ—¶æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è€—æ—¶æ“ä½œæ‰§è¡Œäº† </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toFixed</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é¦–å…ˆä» <code>perf_hooks</code> æ¨¡å—å¯¼å…¥ <code>performance</code> å¯¹è±¡ã€‚<code>performance.now()</code> æ–¹æ³•è¿”å›å½“å‰æ—¶é—´çš„é«˜ç²¾åº¦æ—¶é—´æˆ³ï¼Œå•ä½æ˜¯æ¯«ç§’ã€‚æˆ‘ä»¬åœ¨è€—æ—¶æ“ä½œå‰ååˆ†åˆ«è°ƒç”¨ <code>performance.now()</code> å¹¶è®¡ç®—å·®å€¼ï¼Œå¾—åˆ°è€—æ—¶æ“ä½œçš„æ‰§è¡Œæ—¶é—´ã€‚</p><h3 id="_2-ä½¿ç”¨-performanceobserver-ç›‘å¬æ€§èƒ½æŒ‡æ ‡" tabindex="-1"><a class="header-anchor" href="#_2-ä½¿ç”¨-performanceobserver-ç›‘å¬æ€§èƒ½æŒ‡æ ‡"><span>2. ä½¿ç”¨ PerformanceObserver ç›‘å¬æ€§èƒ½æŒ‡æ ‡</span></a></h3><p>å¦‚æœä½ æƒ³åœ¨ä»£ç çš„ä¸åŒé˜¶æ®µè‡ªåŠ¨æ”¶é›†æ€§èƒ½æŒ‡æ ‡ï¼Œå¯ä»¥ä½¿ç”¨ <code>PerformanceObserver</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;perf_hooks&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª observer å®ä¾‹æ¥è§‚å¯Ÿæ€§èƒ½æ¡ç›®ç±»å‹ä¸º &#39;measure&#39; çš„äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clearMarks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;measure&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;A&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿä¸€äº›æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5000000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;B&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹é‡ä»æ ‡è®°Aåˆ°æ ‡è®°Bä¹‹é—´çš„æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;A to B&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;A&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;B&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>PerformanceObserver</code> ç±»æ¥åˆ›å»ºä¸€ä¸ªè§‚å¯Ÿè€…å®ä¾‹ï¼Œè¿™ä¸ªå®ä¾‹å°†ä¼šç›‘å¬æ‰€æœ‰ç±»å‹ä¸º <code>&#39;measure&#39;</code> çš„æ€§èƒ½æ¡ç›®ã€‚å½“è¿™æ ·çš„æ€§èƒ½æ¡ç›®è¢«è®°å½•æ—¶ï¼Œå›è°ƒå‡½æ•°ä¼šè¢«æ‰§è¡Œï¼Œè¿™é‡Œæˆ‘ä»¬æ‰“å°å‡ºäº†æµ‹é‡çš„æŒç»­æ—¶é—´ã€‚<code>performance.mark()</code> æ–¹æ³•ç”¨äºæ ‡è®°æ—¶é—´ç‚¹ï¼Œ<code>performance.measure()</code> æ–¹æ³•ç”¨äºæµ‹é‡ä¸¤ä¸ªæ ‡è®°ä¹‹é—´çš„æ—¶é—´ã€‚è¿™ä½¿å¾—æ€§èƒ½åˆ†ææ›´åŠ çµæ´»å’Œè‡ªåŠ¨åŒ–ã€‚</p><h3 id="ç»“è¯­" tabindex="-1"><a class="header-anchor" href="#ç»“è¯­"><span>ç»“è¯­</span></a></h3><p>é€šè¿‡ä¸Šè¿°ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>perf_hooks</code> æ¨¡å—æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦æ·±å…¥äº†è§£ Node.js åº”ç”¨æ€§èƒ½çš„åœºæ™¯ä¸­ã€‚åˆ©ç”¨è¿™ä¸ªæ¨¡å—ï¼Œå¼€å‘è€…å¯ä»¥æ›´å¥½åœ°ç›‘æ§å’Œä¼˜åŒ–åº”ç”¨æ€§èƒ½ï¼Œæé«˜åº”ç”¨çš„å“åº”é€Ÿåº¦å’Œå¤„ç†èƒ½åŠ›ã€‚</p><h3 id="measuring-the-duration-of-async-operations" tabindex="-1"><a class="header-anchor" href="#measuring-the-duration-of-async-operations"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#measuring-the-duration-of-async-operations" target="_blank" rel="noopener noreferrer">Measuring the duration of async operations</a></span></a></h3><p>ç†è§£ Node.js ä¸­å¦‚ä½•æµ‹é‡å¼‚æ­¥æ“ä½œçš„æŒç»­æ—¶é—´ï¼Œå…ˆå¾—æ˜ç™½ä»€ä¹ˆæ˜¯å¼‚æ­¥æ“ä½œå’Œ Node.js æä¾›çš„å·¥å…·ã€‚æˆ‘ä¼šç”¨é€šä¿—æ˜“æ‡‚çš„æ–¹å¼è§£é‡Šè¿™ä¸€åˆ‡ï¼Œå¹¶ç»™å‡ºä¸€äº›å®é™…åº”ç”¨çš„ä¾‹å­ã€‚</p><h3 id="å¼‚æ­¥æ“ä½œæ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#å¼‚æ­¥æ“ä½œæ˜¯ä»€ä¹ˆ"><span>å¼‚æ­¥æ“ä½œæ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œè®¸å¤šæ“ä½œæ˜¯å¼‚æ­¥çš„ï¼Œè¿™æ„å‘³ç€å®ƒä»¬ä¸ä¼šç«‹å³å®Œæˆã€‚æ¯”å¦‚ï¼Œå½“ä½ è¯»å–ä¸€ä¸ªæ–‡ä»¶æˆ–ä»ç½‘ç»œä¸Šè¯·æ±‚æ•°æ®æ—¶ï¼Œç¨‹åºä¸ä¼šåœä¸‹æ¥ç­‰å¾…è¿™ä¸ªæ“ä½œå®Œæˆï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œä¸‹å»ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯å¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡ï¼Œæé«˜æ•ˆç‡ã€‚</p><h3 id="node-js-ä¸­æµ‹é‡å¼‚æ­¥æ“ä½œæŒç»­æ—¶é—´çš„é‡è¦æ€§" tabindex="-1"><a class="header-anchor" href="#node-js-ä¸­æµ‹é‡å¼‚æ­¥æ“ä½œæŒç»­æ—¶é—´çš„é‡è¦æ€§"><span>Node.js ä¸­æµ‹é‡å¼‚æ­¥æ“ä½œæŒç»­æ—¶é—´çš„é‡è¦æ€§</span></a></h3><p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œäº†è§£æŸä¸ªå¼‚æ­¥æ“ä½œéœ€è¦å¤šé•¿æ—¶é—´è‡³å…³é‡è¦ã€‚è¿™æœ‰åŠ©äºè¯Šæ–­æ€§èƒ½é—®é¢˜ã€ä¼˜åŒ–ä»£ç ï¼Œç”šè‡³æ˜¯ä¸ºç”¨æˆ·æä¾›æ›´å¥½çš„ä½“éªŒï¼ˆä¾‹å¦‚ï¼Œä¼°ç®—å‰©ä½™æ—¶é—´ï¼‰ã€‚</p><h3 id="å¦‚ä½•åœ¨-node-js-v21-7-1-ä¸­æµ‹é‡" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•åœ¨-node-js-v21-7-1-ä¸­æµ‹é‡"><span>å¦‚ä½•åœ¨ Node.js v21.7.1 ä¸­æµ‹é‡ï¼Ÿ</span></a></h3><p>Node.js æä¾›äº†ä¸€ä¸ªæ¨¡å—å«<code>perf_hooks</code>ï¼Œä¸“é—¨ç”¨äºæ€§èƒ½æµ‹é‡ã€‚å…¶ä¸­ï¼Œ<code>performance.now()</code>æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ–¹æ³•ï¼Œå®ƒè¿”å›å½“å‰æ—¶é—´çš„é«˜ç²¾åº¦æ—¶é—´æˆ³ï¼Œå•ä½æ˜¯æ¯«ç§’ã€‚ä½†å¯¹äºå¼‚æ­¥æ“ä½œï¼Œæˆ‘ä»¬ä¸»è¦åˆ©ç”¨<code>perf_hooks</code>æ¨¡å—ä¸­çš„<code>PerformanceObserver</code>å’Œ<code>async_hooks</code>æ¨¡å—è¿›è¡Œé›†æˆï¼Œä»¥ä¾¿è·Ÿè¸ªå’Œæµ‹é‡ã€‚</p><h4 id="å®ä¾‹è§£æ" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹è§£æ"><span>å®ä¾‹è§£æ</span></a></h4><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä½¿ç”¨<code>perf_hooks</code>æµ‹é‡å¼‚æ­¥æ“ä½œï¼ˆå¦‚ï¼šä¸€ä¸ªç®€å•çš„å®šæ—¶å™¨ï¼‰æŒç»­æ—¶é—´çš„ä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªè§‚å¯Ÿè€…å®ä¾‹æ¥è§‚å¯Ÿå’ŒæŠ¥å‘Šæ€§èƒ½åº¦é‡ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¢é˜…æ‰€æœ‰ç±»å‹çš„æ€§èƒ½æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼€å§‹æµ‹é‡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ç»“æŸæµ‹é‡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹é‡&#39;A&#39;åˆ°&#39;B&#39;ä¹‹é—´çš„æŒç»­æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A to B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥<code>perf_hooks</code>æ¨¡å—ä¸­çš„<code>PerformanceObserver</code>å’Œ<code>performance</code>ã€‚ç„¶åï¼Œåˆ›å»ºä¸€ä¸ª<code>PerformanceObserver</code>å®ä¾‹æ¥è§‚å¯Ÿæ€§èƒ½åº¦é‡ä¿¡æ¯ã€‚æˆ‘ä»¬é€šè¿‡<code>observe</code>æ–¹æ³•æŒ‡å®šæˆ‘ä»¬æ„Ÿå…´è¶£çš„æ€§èƒ½æ¡ç›®ç±»å‹ï¼Œåœ¨è¿™é‡Œæ˜¯<code>measure</code>ã€‚</p><p>æ¥ç€ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>performance.mark()</code>æ–¹æ³•æ ‡è®°å¼€å§‹(<code>&#39;A&#39;</code>)å’Œç»“æŸ(<code>&#39;B&#39;</code>)ç‚¹ã€‚ä¸€æ—¦æˆ‘ä»¬çš„å¼‚æ­¥æ“ä½œ(è¿™é‡Œç”¨<code>setTimeout()</code>æ¨¡æ‹Ÿ)å®Œæˆï¼Œæˆ‘ä»¬æ ‡è®°ç»“æŸç‚¹ï¼Œå¹¶è°ƒç”¨<code>performance.measure()</code>æ–¹æ³•æ¥è®¡ç®—ä»<code>&#39;A&#39;</code>åˆ°<code>&#39;B&#39;</code>çš„æŒç»­æ—¶é—´ã€‚<code>PerformanceObserver</code>å®ä¾‹ä¼šæ•è·è¿™ä¸ªåº¦é‡å¹¶é€šè¿‡å›è°ƒå‡½æ•°æ‰“å°å‡ºæ¥ã€‚</p><h3 id="åº”ç”¨å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#åº”ç”¨å®ä¾‹"><span>åº”ç”¨å®ä¾‹</span></a></h3><ul><li><strong>æ–‡ä»¶ IO æ“ä½œ</strong>ï¼šæµ‹é‡ä»æ–‡ä»¶ç³»ç»Ÿè¯»å–å¤§æ–‡ä»¶æ‰€éœ€çš„æ—¶é—´ã€‚</li><li><strong>æ•°æ®åº“æŸ¥è¯¢</strong>ï¼šæµ‹é‡æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢å¹¶è·å–ç»“æœæ‰€éœ€çš„æ—¶é—´ã€‚</li><li><strong>HTTP è¯·æ±‚</strong>ï¼šå‘èµ· HTTP è¯·æ±‚å¹¶æ¥æ”¶å“åº”æ‰€éœ€æ—¶é—´çš„æµ‹é‡ï¼Œç‰¹åˆ«æ˜¯åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œç†è§£ä¸åŒæœåŠ¡é—´é€šä¿¡çš„å»¶è¿Ÿè‡³å…³é‡è¦ã€‚</li></ul><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¼€å‘è€…å¯ä»¥æ›´å¥½åœ°ç†è§£å’Œä¼˜åŒ–ä»–ä»¬çš„å¼‚æ­¥æ“ä½œï¼Œä»è€Œæå‡åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚</p><h3 id="measuring-how-long-it-takes-to-load-dependencies" tabindex="-1"><a class="header-anchor" href="#measuring-how-long-it-takes-to-load-dependencies"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#measuring-how-long-it-takes-to-load-dependencies" target="_blank" rel="noopener noreferrer">Measuring how long it takes to load dependencies</a></span></a></h3><p>äº†è§£ Node.js ä¸­å¦‚ä½•æµ‹é‡åŠ è½½ä¾èµ–é¡¹æ‰€éœ€çš„æ—¶é—´å¯¹äºæ€§èƒ½è°ƒä¼˜å’Œä¼˜åŒ–æ˜¯éå¸¸é‡è¦çš„ã€‚åœ¨ Node.js v21.7.1 ä¸­ï¼Œå¯ä»¥ä½¿ç”¨<code>perf_hooks</code>æ¨¡å—æ¥å®ç°è¿™ä¸€ç‚¹ã€‚ä¸‹é¢æˆ‘å°†é€šè¿‡ä¸€ä¸ªç®€å•ä¾‹å­æ¥è®²è§£å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><h3 id="ç†è§£perf-hooks" tabindex="-1"><a class="header-anchor" href="#ç†è§£perf-hooks"><span>ç†è§£<code>perf_hooks</code></span></a></h3><p>é¦–å…ˆï¼Œ<code>perf_hooks</code>æ¨¡å—æä¾›äº†æ€§èƒ½ç›‘æ§çš„é’©å­ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥æµ‹é‡åœ¨ Node.js åº”ç”¨ç¨‹åºæ‰§è¡ŒæœŸé—´å‘ç”Ÿçš„ç‰¹å®šäº‹ä»¶çš„æ€§èƒ½ã€‚å¯¹äºä¾èµ–é¡¹åŠ è½½æµ‹é‡è€Œè¨€ï¼Œä¸»è¦æ˜¯å…³æ³¨åº”ç”¨å¯åŠ¨æ—¶ç¬¬ä¸‰æ–¹æ¨¡å—åŠ è½½çš„æ€§èƒ½ã€‚</p><h3 id="æ­¥éª¤ä¸ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤ä¸ä¾‹å­"><span>æ­¥éª¤ä¸ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ª Node.js é¡¹ç›®ï¼Œä½ æƒ³è¦æµ‹é‡é¡¹ç›®å¯åŠ¨æ—¶åŠ è½½æŸä¸ªæˆ–æŸäº›ä¾èµ–ï¼ˆå¦‚ Express æ¡†æ¶ï¼‰æ‰€éœ€çš„æ—¶é—´ã€‚</p><ol><li><p><strong>å¼•å…¥<code>perf_hooks</code></strong></p><p>åœ¨ä½ çš„ä»£ç æœ€å¼€å§‹å¤„å¼•å…¥<code>perf_hooks</code>ï¼Œç¡®ä¿è¿™æ˜¯ç¬¬ä¸€è¡Œä»£ç ï¼Œä»¥è·å–å°½å¯èƒ½å‡†ç¡®çš„æµ‹é‡ç»“æœï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><strong>è®¾ç½® Performance Observer</strong></p><p>æ¥ä¸‹æ¥ï¼Œè®¾ç½®ä¸€ä¸ª<code>PerformanceObserver</code>æ¥ç›‘å¬å’Œå“åº”æ€§èƒ½æ¡ç›®äº‹ä»¶ã€‚è¿™é‡Œæˆ‘ä»¬æ„Ÿå…´è¶£çš„æ˜¯&quot;require&quot;äº‹ä»¶ï¼Œå³åŠ è½½æ¨¡å—çš„äº‹ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ¨¡å— </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> åŠ è½½è€—æ—¶ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;require&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffered</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>åŠ è½½ä¾èµ–å¹¶æµ‹é‡</strong></p><p>ç°åœ¨ï¼Œæ­£å¸¸ç¼–å†™ä½ çš„ä»£ç ï¼ŒåŠ è½½éœ€è¦çš„æ¨¡å—ã€‚å‡è®¾æˆ‘ä»¬åŠ è½½ Expressï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> express</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;express&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> app</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> express</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å…¶ä»–Expressç›¸å…³ä»£ç </span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ ¹æ®ä¹‹å‰è®¾ç½®çš„ Performance Observerï¼Œå½“ Express æ¨¡å—è¢«åŠ è½½æ—¶ï¼Œä¼šè‡ªåŠ¨è®°å½•ä¸‹åŠ è½½æ—¶é—´ï¼Œå¹¶é€šè¿‡<code>console.log</code>è¾“å‡ºã€‚</p></li><li><p><strong>æŸ¥çœ‹ç»“æœ</strong></p><p>å½“ä½ è¿è¡Œä½ çš„åº”ç”¨æ—¶ï¼Œä½ ä¼šåœ¨æ§åˆ¶å°çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„è¾“å‡ºï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>æ¨¡å— express åŠ è½½è€—æ—¶ï¼š142.34567</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™è¡¨ç¤ºä»å¼€å§‹åŠ è½½<code>express</code>æ¨¡å—åˆ°åŠ è½½å®Œæˆæ€»å…±è€—æ—¶çº¦ 142 æ¯«ç§’ã€‚</p></li></ol><h3 id="å®é™…è¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨åœºæ™¯"><span>å®é™…è¿ç”¨åœºæ™¯</span></a></h3><p>æµ‹é‡åŠ è½½ä¾èµ–é¡¹æ‰€éœ€æ—¶é—´åœ¨å¤šç§æƒ…å†µä¸‹éå¸¸æœ‰ç”¨ï¼Œä¾‹å¦‚ï¼š</p><ul><li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šè¯†åˆ«å’Œä¼˜åŒ–åŠ è½½æ—¶é—´é•¿çš„æ¨¡å—ã€‚</li><li><strong>æ¯”è¾ƒä¾èµ–</strong>ï¼šåœ¨é€‰æ‹©åº“æˆ–æ¡†æ¶æ—¶ï¼Œæ¯”è¾ƒå®ƒä»¬åŠ è½½çš„é€Ÿåº¦ã€‚</li><li><strong>ç›‘æ§éƒ¨ç½²</strong>ï¼šç¡®ä¿éƒ¨ç½²åçš„åº”ç”¨åŠ è½½æ€§èƒ½æ²¡æœ‰æ˜æ˜¾ä¸‹é™ã€‚</li></ul><p>ä½¿ç”¨<code>perf_hooks</code>æ¨¡å—æµ‹é‡ä¾èµ–é¡¹åŠ è½½æ—¶é—´æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…è¯Šæ–­å’Œä¼˜åŒ– Node.js åº”ç”¨çš„æ€§èƒ½ã€‚</p><h3 id="measuring-how-long-one-http-round-trip-takes" tabindex="-1"><a class="header-anchor" href="#measuring-how-long-one-http-round-trip-takes"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#measuring-how-long-one-http-round-trip-takes" target="_blank" rel="noopener noreferrer">Measuring how long one HTTP round-trip takes</a></span></a></h3><p>äº†è§£å¦‚ä½•æµ‹é‡ä¸€ä¸ª HTTP å¾€è¿”ï¼ˆround-tripï¼‰æ‰€éœ€çš„æ—¶é—´æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œç‰¹åˆ«æ˜¯å½“ä½ åœ¨è¿›è¡Œæ€§èƒ½ä¼˜åŒ–æ—¶ã€‚åœ¨ Node.js ä¸­ï¼Œè¿™å¯ä»¥é€šè¿‡<code>perf_hooks</code>æ¨¡å—æ¥å®ç°ã€‚æˆ‘å°†é¦–å…ˆè§£é‡Šä¸€äº›åŸºç¡€æ¦‚å¿µï¼Œç„¶åé€šè¿‡ä¸€ä¸ªå®é™…ä¾‹å­æ¥å±•ç¤ºå¦‚ä½•æµ‹é‡ä¸€ä¸ª HTTP å¾€è¿”æ‰€éœ€çš„æ—¶é—´ã€‚</p><h3 id="åŸºç¡€æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æ¦‚å¿µ"><span>åŸºç¡€æ¦‚å¿µ</span></a></h3><p><strong>HTTP å¾€è¿”ï¼ˆRound-Tripï¼‰</strong>: æŒ‡çš„æ˜¯ä»å®¢æˆ·ç«¯å‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼Œå†åˆ°æœåŠ¡å™¨å¤„ç†å¹¶è¿”å›å“åº”ç»™å®¢æˆ·ç«¯çš„æ•´ä¸ªè¿‡ç¨‹ã€‚æˆ‘ä»¬é€šå¸¸å…³å¿ƒè¿™ä¸ªè¿‡ç¨‹éœ€è¦å¤šé•¿æ—¶é—´ï¼Œå› ä¸ºå®ƒç›´æ¥å½±å“ç”¨æˆ·ä½“éªŒã€‚</p><p><strong>Node.js <code>perf_hooks</code>æ¨¡å—</strong>: Node.js æä¾›äº†ä¸€ä¸ªå†…ç½®æ¨¡å—<code>perf_hooks</code>ï¼Œå®ƒå…è®¸æˆ‘ä»¬ç²¾ç¡®åœ°æµ‹é‡ä»£ç æ‰§è¡Œçš„æ—¶é—´ã€‚è¿™å¯¹äºæ€§èƒ½åˆ†æå’Œä¼˜åŒ–è‡³å…³é‡è¦ã€‚</p><h3 id="å®è·µç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®è·µç¤ºä¾‹"><span>å®è·µç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æƒ³è¦æµ‹é‡å‘ä¸€ä¸ªå¤–éƒ¨ API å‘èµ· GET è¯·æ±‚ï¼Œå¹¶ä¸”æ¥æ”¶åˆ°å“åº”æ‰€éœ€çš„æ—¶é—´ã€‚ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨ Node.js çš„<code>perf_hooks</code>æ¨¡å—æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡çš„æ­¥éª¤ï¼š</p><ol><li><p><strong>å¼•å…¥å¿…è¦çš„æ¨¡å—</strong></p><p>æˆ‘ä»¬éœ€è¦å¯¼å…¥<code>http</code>æ¨¡å—æ¥å‘èµ· HTTP è¯·æ±‚ï¼ŒåŒæ—¶å¯¼å…¥<code>perf_hooks</code>ä¸­çš„<code>performance</code>å¯¹è±¡æ¥æµ‹é‡æ—¶é—´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>å¼€å§‹è®¡æ—¶</strong></p><p>åœ¨å‘èµ· HTTP è¯·æ±‚ä¹‹å‰ï¼Œæˆ‘ä»¬è°ƒç”¨<code>performance.now()</code>æ¥è·å–å½“å‰æ—¶é—´ï¼Œä½œä¸ºèµ·å§‹ç‚¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> startTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><strong>å‘èµ· HTTP è¯·æ±‚</strong></p><p>ä½¿ç”¨<code>http</code>æ¨¡å—å‘èµ·è¯·æ±‚ï¼Œå¹¶åœ¨æ”¶åˆ°å“åº”æ—¶åœæ­¢è®¡æ—¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">http</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¤„ç†å“åº”æ•°æ®ï¼ˆå¦‚æœéœ€è¦ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // è¯·æ±‚ç»“æŸï¼Œåœæ­¢è®¡æ—¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> endTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // è®¡ç®—æ€»å…±è€—æ—¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`HTTPè¯·æ±‚å¾€è¿”è€—æ—¶: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">endTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> startTime</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="æ€»ç»“-14" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-14"><span>æ€»ç»“</span></a></h3><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè®°å½•äº†è¯·æ±‚å‘èµ·å‰çš„æ—¶é—´ï¼Œç„¶ååœ¨è·å¾—å“åº”åè®°å½•äº†ç¬¬äºŒä¸ªæ—¶é—´ç‚¹ã€‚é€šè¿‡è®¡ç®—è¿™ä¸¤ä¸ªæ—¶é—´ç‚¹çš„å·®å€¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—çŸ¥è¯¥ HTTP å¾€è¿”æ‰€éœ€çš„æ—¶é—´ã€‚è¿™ç§æ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¯„ä¼°æœåŠ¡çš„æ€§èƒ½ï¼Œå¹¶æ‰¾å‡ºå¯èƒ½çš„ç“¶é¢ˆæ‰€åœ¨ã€‚</p><h3 id="æ‰©å±•åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#æ‰©å±•åº”ç”¨"><span>æ‰©å±•åº”ç”¨</span></a></h3><p>é€šè¿‡ç±»ä¼¼çš„æ–¹å¼ï¼Œä½ ä¹Ÿå¯ä»¥æµ‹é‡æ•°æ®åº“æŸ¥è¯¢ã€æ–‡ä»¶è¯»å†™æ“ä½œç­‰å…¶ä»–å¼‚æ­¥æ“ä½œçš„æ€§èƒ½ã€‚<code>perf_hooks</code>æ¨¡å—æ˜¯ Node.js æä¾›çš„å¼ºå¤§å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œä¼˜åŒ–ä½ çš„åº”ç”¨ç¨‹åºæ€§èƒ½ã€‚</p><h3 id="measuring-how-long-the-net-connect-only-for-tcp-takes-when-the-connection-is-successful" tabindex="-1"><a class="header-anchor" href="#measuring-how-long-the-net-connect-only-for-tcp-takes-when-the-connection-is-successful"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#measuring-how-long-the-netconnect-only-for-tcp-takes-when-the-connection-is-successful" target="_blank" rel="noopener noreferrer">Measuring how long the net.connect (only for TCP) takes when the connection is successful</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ·±å…¥äº†è§£ Node.js ä¸­å…³äºæµ‹é‡ <code>net.connect</code>ï¼ˆä»…é™äº TCP è¿æ¥ï¼‰æˆåŠŸè¿æ¥æ‰€éœ€æ—¶é—´çš„æ¦‚å¿µã€‚æˆ‘ä¼šå°½é‡ç”¨ç®€å•çš„è¯­è¨€å’Œä¸€äº›å®é™…ä¾‹å­æ¥è¯´æ˜è¿™ä¸ªè¿‡ç¨‹ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-tcp-å’Œ-net-connect" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-tcp-å’Œ-net-connect"><span>ä»€ä¹ˆæ˜¯ TCP å’Œ <code>net.connect</code>ï¼Ÿ</span></a></h3><p>é¦–å…ˆï¼Œäº†è§£ä¸€ä¸‹ TCPï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼‰ã€‚TCP æ˜¯äº’è”ç½‘ä¸Šå¸¸ç”¨çš„ä¸€ç§åè®®ï¼Œå®ƒå¸®åŠ©ç½‘ç»œä¸­çš„è®¡ç®—æœºäº’ç›¸å‘é€æ•°æ®ã€‚æƒ³è±¡æˆä½ åœ¨ç»™ä¸€ä¸ªæœ‹å‹æ‰“ç”µè¯ï¼ŒTCP å°±åƒæ˜¯ç¡®ä¿ä½ ä»¬ä¸¤ä¸ªå¯ä»¥é€šè¿‡ç”µè¯çº¿è·¯æ¸…æ™°äº¤è°ˆçš„è§„åˆ™ã€‚</p><p><code>net.connect</code> æ˜¯ Node.js ä¸­ç”¨æ¥åˆ›å»ºåˆ°å¦ä¸€å°è®¡ç®—æœºçš„ TCP è¿æ¥çš„æ–¹æ³•ã€‚æ¯”å¦‚è¯´ï¼Œå½“ä½ çš„åº”ç”¨ç¨‹åºéœ€è¦ä»å¦ä¸€å°æœåŠ¡å™¨è·å–ä¸€äº›æ•°æ®æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>net.connect</code> æ¥å»ºç«‹è¿™æ ·çš„è¿æ¥ã€‚</p><h3 id="æµ‹é‡è¿æ¥æ—¶é—´" tabindex="-1"><a class="header-anchor" href="#æµ‹é‡è¿æ¥æ—¶é—´"><span>æµ‹é‡è¿æ¥æ—¶é—´</span></a></h3><p>Node.js v21.7.1 å¼•å…¥äº†ä¸€ç§æµ‹é‡ <code>net.connect</code> æˆåŠŸè¿æ¥æ‰€èŠ±è´¹æ—¶é—´çš„åŠŸèƒ½ã€‚ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦ï¼Ÿæƒ³è±¡ä½ æ­£åœ¨è¯•å›¾æ‰“å¼€ä¸€ä¸ªç½‘é¡µï¼Œä½†å®ƒåŠ è½½å¾—å¾ˆæ…¢ã€‚äº†è§£æ‰“å¼€ç½‘é¡µæ‰€éœ€çš„æ—¶é—´å¯ä»¥å¸®åŠ©å¼€å‘è€…æ‰¾å‡ºé—®é¢˜æ‰€åœ¨ï¼Œå¹¶æ”¹è¿›ç”¨æˆ·ä½“éªŒã€‚</p><h3 id="å¦‚ä½•è¿›è¡Œæµ‹é‡" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•è¿›è¡Œæµ‹é‡"><span>å¦‚ä½•è¿›è¡Œæµ‹é‡</span></a></h3><p>Node.js ä½¿ç”¨ä¸€ä¸ªåä¸º <code>perf_hooks</code> çš„æ¨¡å—æ¥æµ‹é‡æ€§èƒ½ç›¸å…³çš„äº‹é¡¹ã€‚å…·ä½“åˆ°æµ‹é‡ <code>net.connect</code> çš„è¿æ¥æ—¶é—´ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š</p><ol><li><p><strong>å¼•å…¥å¿…è¦çš„æ¨¡å—</strong>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> net</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;net&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>è®¾ç½®æ€§èƒ½è§‚å¯Ÿå™¨</strong>ï¼šè¿™ä¸ªè§‚å¯Ÿå™¨ä¼šç›‘å¬ç‰¹å®šç±»å‹çš„æ€§èƒ½æ¡ç›®ï¼Œæœ¬ä¾‹ä¸­å³ TCP è¿æ¥çš„æ€§èƒ½æ¡ç›®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è¿æ¥åˆ° </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> è€—æ—¶ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">obs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;measure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>åˆ›å»ºè¿æ¥å¹¶æµ‹é‡æ—¶é—´</strong>ï¼šé¦–å…ˆæ ‡è®°å¼€å§‹æ—¶é—´ï¼Œç„¶åå°è¯•å»ºç«‹ TCP è¿æ¥ï¼Œå¹¶åœ¨è¿æ¥æˆåŠŸæ—¶æ ‡è®°ç»“æŸæ—¶é—´ã€‚æœ€åï¼Œä½¿ç”¨ <code>performance.measure</code> æ–¹æ³•æ¥æµ‹é‡å¹¶è®°å½•è¿™æ®µæ—¶é—´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> startMark</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;start-connect&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> endMark</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;end-connect&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> measureName</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;TCP-Connect-Time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">startMark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> socket</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> net</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">connect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">port</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">host</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">endMark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">measureName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">startMark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">endMark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  socket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å…³é—­è¿æ¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-8" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-8"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>è¿™ç§æµ‹é‡æŠ€æœ¯éå¸¸é€‚åˆäºéœ€è¦è¯„ä¼°å…¶ç½‘ç»œè¿æ¥æ€§èƒ½çš„åº”ç”¨ç¨‹åºã€‚ä¾‹å¦‚ï¼š</p><ul><li><strong>API æ¶ˆè´¹è€…</strong>ï¼šå¦‚æœä½ çš„æœåŠ¡ä¾èµ–äºå¤šä¸ªå¤–éƒ¨ APIï¼Œæµ‹é‡è¿æ¥å„ä¸ª API æ‰€éœ€çš„æ—¶é—´å¯ä»¥å¸®åŠ©ä½ è¯†åˆ«å“ªäº›æœåŠ¡å¯èƒ½ä¼šæ‹–æ…¢ä½ çš„åº”ç”¨ç¨‹åºã€‚</li><li><strong>å¾®æœåŠ¡æ¶æ„</strong>ï¼šåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼ŒæœåŠ¡ä¹‹é—´é¢‘ç¹åœ°è¿›è¡Œç½‘ç»œé€šä¿¡ã€‚ç›‘æ§è¿™äº›å†…éƒ¨è¿æ¥çš„æ—¶é—´å¯ä»¥å¸®åŠ©ä¼˜åŒ–æ•´ä½“æ¶æ„æ€§èƒ½ã€‚</li><li><strong>æ€§èƒ½åŸºå‡†æµ‹è¯•</strong>ï¼šåœ¨å¯¹ç½‘ç»œåº”ç”¨æˆ–æœåŠ¡è¿›è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•æ—¶ï¼Œäº†è§£ä¸åŒæ“ä½œçš„è¿æ¥æ—¶é—´å¯ä»¥æä¾›é‡è¦çš„æ€§èƒ½æŒ‡æ ‡ã€‚</li></ul><p>é€šè¿‡ä½¿ç”¨ Node.js çš„ <code>perf_hooks</code> æ¨¡å—ï¼Œå¼€å‘äººå‘˜å¯ä»¥è·å¾—å…³äºä»–ä»¬çš„ç½‘ç»œè¿æ¥æ€§èƒ½çš„é‡è¦æ´è§ï¼Œè¿›è€Œä¼˜åŒ–åº”ç”¨ç¨‹åºï¼Œæä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚</p><h3 id="measuring-how-long-the-dns-takes-when-the-request-is-successful" tabindex="-1"><a class="header-anchor" href="#measuring-how-long-the-dns-takes-when-the-request-is-successful"><span><a href="https://nodejs.org/docs/latest/api/perf_hooks.html#measuring-how-long-the-dns-takes-when-the-request-is-successful" target="_blank" rel="noopener noreferrer">Measuring how long the DNS takes when the request is successful</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript ç¯å¢ƒï¼Œå®ƒè®©æˆ‘ä»¬å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ€§èƒ½ç›‘æµ‹æ˜¯ä¸€ä¸ªé‡è¦çš„æ–¹é¢ã€‚æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æµ‹é‡æŸäº›æ“ä½œçš„æ‰§è¡Œæ—¶é—´ï¼Œä¾‹å¦‚ DNS æŸ¥è¯¢ã€‚DNSï¼ˆDomain Name Systemï¼‰æ˜¯äº’è”ç½‘ä¸Šç”¨äºå°†åŸŸåè½¬æ¢ä¸º IP åœ°å€çš„ç³»ç»Ÿã€‚å½“ä½ å°è¯•è®¿é—®ä¸€ä¸ªç½‘ç«™æ¯”å¦‚ <code>www.example.com</code> æ—¶ï¼Œä½ çš„ç”µè„‘é¦–å…ˆä¼šæŸ¥è¯¢ DNS æ¥æ‰¾åˆ°ç›¸åº”çš„ IP åœ°å€ã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>perf_hooks</code> æ¨¡å—æä¾›äº†ä¸€ç§æµ‹é‡ DNS æŸ¥è¯¢æ—¶é—´çš„æ–¹æ³•ï¼Œè¿™å¯¹äºç†è§£å’Œä¼˜åŒ–ç½‘ç»œè¯·æ±‚çš„æ€§èƒ½ååˆ†é‡è¦ã€‚æ¥ä¸‹æ¥æˆ‘ä¼šé€æ­¥è§£é‡Šå¦‚ä½•ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œå¹¶ç»™å‡ºå®é™…çš„ä¾‹å­ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-8" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-8"><span>å¦‚ä½•ä½¿ç”¨ï¼š</span></a></h3><p>Node.js çš„ <code>perf_hooks</code> æ¨¡å—å…è®¸ä½ ç›‘æ§ä¸åŒç±»å‹çš„æ€§èƒ½æŒ‡æ ‡ã€‚è¦æµ‹é‡ DNS æŸ¥è¯¢æ‰€éœ€çš„æ—¶é—´ï¼Œä½ é¦–å…ˆéœ€è¦å¯¼å…¥è¿™ä¸ªæ¨¡å—ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç„¶åï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>dns.lookup()</code> æ–¹æ³•æ¥è§¦å‘ DNS æŸ¥è¯¢å¹¶ä¸”å¼€å§‹è®¡æ—¶ã€‚<code>dns</code> æ¨¡å—å¿…é¡»è¢«å•ç‹¬å¯¼å…¥ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ä¸ºäº†æµ‹é‡æ‰§è¡Œæ—¶é—´ï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ª <code>PerformanceObserver</code>ï¼Œè¿™ä¸ªå¯¹è±¡ä¼šç›‘å¬æ€§èƒ½æ¡ç›®äº‹ä»¶ã€‚å½“ DNS æŸ¥è¯¢å®Œæˆæ—¶ï¼Œè¿™ä¸ªå¯¹è±¡å°†æ”¶åˆ°é€šçŸ¥ã€‚</p><p>ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯¼å…¥å¿…è¦çš„æ¨¡å—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;perf_hooks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ€§èƒ½è§‚å¯Ÿè€…æ¥è§‚æµ‹ &#39;dns&#39; ç±»å‹çš„æ€§èƒ½æ¡ç›®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> observer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> PerformanceObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getEntries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`DNS æŸ¥è¯¢è€—æ—¶ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">observer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">entryTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è§¦å‘ä¸€ä¸ª DNS æŸ¥è¯¢</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns-lookup-start&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">family</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mark</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns-lookup-end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹é‡ä» &#39;dns-lookup-start&#39; åˆ° &#39;dns-lookup-end&#39; çš„æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  performance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns-lookup&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns-lookup-start&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns-lookup-end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`åœ°å€: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">address</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, IPç‰ˆæœ¬: IPv</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">family</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨ä¾‹å­-21" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-21"><span>å®é™…è¿ç”¨ä¾‹å­ï¼š</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦é¢‘ç¹è¿›è¡Œç½‘ç»œè¯·æ±‚çš„åº”ç”¨ç¨‹åºã€‚å¯èƒ½æ˜¯ä¸€ä¸ªå¤©æ°”é¢„æŠ¥åº”ç”¨ï¼Œæ¯æ¬¡ç”¨æˆ·è¯·æ±‚æ—¶éƒ½éœ€è¦æŸ¥è¯¢ç‰¹å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯ã€‚ä¸ºäº†ç¡®ä¿ä½ çš„åº”ç”¨å“åº”è¿…é€Ÿï¼Œä½ éœ€è¦ç›‘æµ‹ DNS æŸ¥è¯¢çš„æ—¶é—´ã€‚åˆ©ç”¨ä¸Šè¿°ä»£ç ç‰‡æ®µï¼Œä½ å¯ä»¥è½»æ¾åœ°æµ‹é‡å‡º DNS æŸ¥è¯¢çš„è€—æ—¶ï¼Œè¿›è€Œå¯¹æ¯”ä¸åŒ DNS æœåŠ¡å™¨çš„å“åº”æ—¶é—´æˆ–è€…æ£€æµ‹å½“å‰ç½‘ç»œçŠ¶å†µæ˜¯å¦å½±å“äº†æŸ¥è¯¢æ•ˆç‡ã€‚</p><p>é€šè¿‡ä¸æ–­åœ°ç›‘æµ‹å’Œä¼˜åŒ–è¿™ä¸€ç¯èŠ‚ï¼Œä½ å¯ä»¥æ˜¾è‘—æé«˜åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚</p></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: kamiacgxu@gmail.com">kamishima-kaede</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/document/node-doc/Path.html" aria-label="Path"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Path</div></a><a class="route-link auto-link next" href="/document/node-doc/Permissions.html" aria-label="Permissions"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">Permissions<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><!----><div class="vp-copyright">Copyright Â© 2018-present hanekawa-shiki</div></footer></div><!--]--><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.28bb228f.js" defer></script><script src="/assets/js/6679.86a2b270.js" defer></script><script src="/assets/js/app.de91e5da.js" defer></script>
  </body>
</html>
