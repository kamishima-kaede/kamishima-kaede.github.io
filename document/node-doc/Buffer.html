<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.50" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://hanekawa.top/document/node-doc/Buffer.html"><meta property="og:site_name" content="hanekawa-shiki"><meta property="og:title" content="Buffer"><meta property="og:description" content="Buffer Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼ŒBuffer ç±»æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨äºç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµã€‚ åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œ"buffer" é€šå¸¸æŒ‡çš„æ˜¯å†…å­˜ä¸­çš„ä¸€æ®µä¸´æ—¶å­˜å‚¨åŒºåŸŸï¼Œç”¨äºå­˜æ”¾è¾“å…¥æˆ–è¾“å‡ºæ•°æ®ã€‚è¿™åœ¨å¤„ç† I..."><meta property="og:type" content="website"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-06-21T09:46:17.000Z"><meta property="article:author" content="hanekawa-shiki"><meta property="article:modified_time" content="2024-06-21T09:46:17.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"WebPage","name":"Buffer","description":"Buffer Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼ŒBuffer ç±»æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨äºç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµã€‚ åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œ\"buffer\" é€šå¸¸æŒ‡çš„æ˜¯å†…å­˜ä¸­çš„ä¸€æ®µä¸´æ—¶å­˜å‚¨åŒºåŸŸï¼Œç”¨äºå­˜æ”¾è¾“å…¥æˆ–è¾“å‡ºæ•°æ®ã€‚è¿™åœ¨å¤„ç† I..."}</script><meta name="keywords" content="JavaScript,HTML,CSS"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/assets/icons/chrome-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icons/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icons/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icons/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#5c92d1"><link rel="apple-touch-icon" href="/assets/icons/apple-touch-icon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="white"><meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><title>Buffer | hanekawa-shiki</title><meta name="description" content="Buffer Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼ŒBuffer ç±»æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨äºç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµã€‚ åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œ"buffer" é€šå¸¸æŒ‡çš„æ˜¯å†…å­˜ä¸­çš„ä¸€æ®µä¸´æ—¶å­˜å‚¨åŒºåŸŸï¼Œç”¨äºå­˜æ”¾è¾“å…¥æˆ–è¾“å‡ºæ•°æ®ã€‚è¿™åœ¨å¤„ç† I...">
    <link rel="stylesheet" href="/assets/css/styles.6fad2577.css">
    <link rel="preload" href="/assets/js/runtime~app.c5220139.js" as="script"><link rel="preload" href="/assets/css/styles.6fad2577.css" as="style"><link rel="preload" href="/assets/js/7531.f2f134c8.js" as="script"><link rel="preload" href="/assets/js/app.af931348.js" as="script">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo light" src="/assets/svg/logo.svg" alt><img class="vp-nav-logo dark" src="/assets/svg/logo.svg" alt><span class="vp-site-name hide-in-pad">hanekawa-shiki</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="åšå®¢ä¸»é¡µ"><!--[--><span class="font-icon icon home" style=""></span><!--]-->åšå®¢ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="å­¦ä¹ ç¬”è®°"><!--[--><span class="font-icon icon framework" style=""></span>å­¦ä¹ ç¬”è®°<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">å‰ç«¯æ¡†æ¶</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/framework_front/vue3/" aria-label="Vue3ç¬”è®°"><!--[--><span class="font-icon icon vue" style=""></span><!--]-->Vue3ç¬”è®°<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/framework_front/react/" aria-label="Reactç¬”è®°"><!--[--><span class="font-icon icon react" style=""></span><!--]-->Reactç¬”è®°<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="æ–‡æ¡£"><!--[--><span class="font-icon icon framework" style=""></span>æ–‡æ¡£<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">æ¬è¿</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link route-link-active auto-link" href="/document/node-doc/" aria-label="Node.jsæ–‡æ¡£"><!--[--><span class="font-icon icon circle-info" style=""></span><!--]-->Node.jsæ–‡æ¡£<!----></a></li></ul></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/hanekawa-shiki/hanekawa-shiki.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/" aria-label="Node.jsæ–‡æ¡£"><!--[--><span class="font-icon icon circle-info" style=""></span><!--]-->Node.jsæ–‡æ¡£<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Assert.html" aria-label="Assert"><!---->Assert<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Async%20hooks.html" aria-label="Async hooks"><!---->Async hooks<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Asynchronous%20context%20tracking.html" aria-label="Asynchronous context tracking"><!---->Asynchronous context tracking<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/document/node-doc/Buffer.html" aria-label="Buffer"><!---->Buffer<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/C__%20addons.html" aria-label="C++ addons"><!---->C++ addons<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/C__%20embedder%20API.html" aria-label="C++ embedder API"><!---->C++ embedder API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Child%20process.html" aria-label="Child process"><!---->Child process<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Cluster.html" aria-label="Cluster"><!---->Cluster<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Command-line%20API.html" aria-label="Command-line API"><!---->Command-line API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Console.html" aria-label="Console"><!---->Console<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Corepack.html" aria-label="Corepack"><!---->Corepack<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Crypto.html" aria-label="Crypto"><!---->Crypto<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Debugger.html" aria-label="Debugger"><!---->Debugger<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Deprecated%20APIs.html" aria-label="Deprecated APIs"><!---->Deprecated APIs<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Diagnostic%20report.html" aria-label="Diagnostic report"><!---->Diagnostic report<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Diagnostics%20Channel.html" aria-label="Diagnostics Channel"><!---->Diagnostics Channel<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/DNS.html" aria-label="DNS"><!---->DNS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Domain.html" aria-label="Domain"><!---->Domain<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Errors.html" aria-label="Errors"><!---->Errors<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Events.html" aria-label="Events"><!---->Events<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/File%20system.html" aria-label="File system"><!---->File system<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Global%20objects.html" aria-label="Global objects"><!---->Global objects<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/HTTP.html" aria-label="HTTP"><!---->HTTP<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/HTTPS.html" aria-label="HTTPS"><!---->HTTPS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Inspector.html" aria-label="Inspector"><!---->Inspector<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Internationalization%20support.html" aria-label="Internationalization support"><!---->Internationalization support<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-CommonJS%20modules.html" aria-label="Modules: CommonJS modules"><!---->Modules: CommonJS modules<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-ECMAScript%20modules.html" aria-label="Modules: ECMAScript modules"><!---->Modules: ECMAScript modules<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-node%20module%20API.html" aria-label="Modules: node:module API"><!---->Modules: node:module API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-Packages.html" aria-label="Modules: Packages"><!---->Modules: Packages<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Net.html" aria-label="Net"><!---->Net<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Node-API.html" aria-label="Node-API"><!---->Node-API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/OS.html" aria-label="OS"><!---->OS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Path.html" aria-label="Path"><!---->Path<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Performance%20measurement%20APIs.html" aria-label="Performance measurement APIs"><!---->Performance measurement APIs<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Permissions.html" aria-label="Permissions"><!---->Permissions<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Process.html" aria-label="Process"><!---->Process<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Punycode.html" aria-label="Punycode"><!---->Punycode<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Query%20string.html" aria-label="Query string"><!---->Query string<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Readline.html" aria-label="Readline"><!---->Readline<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/REPL.html" aria-label="REPL"><!---->REPL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Stream.html" aria-label="Stream"><!---->Stream<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/String%20decoder.html" aria-label="String decoder"><!---->String decoder<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Test%20runner.html" aria-label="Test runner"><!---->Test runner<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Timers.html" aria-label="Timers"><!---->Timers<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/TLS%20(SSL).html" aria-label="TLS (SSL)"><!---->TLS (SSL)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Trace%20events.html" aria-label="Trace events"><!---->Trace events<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/TTY.html" aria-label="TTY"><!---->TTY<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/URL.html" aria-label="URL"><!---->URL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Util.html" aria-label="Util"><!---->Util<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/V8.html" aria-label="V8"><!---->V8<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/VM%20(executing%20JavaScript).html" aria-label="VM (executing JavaScript)"><!---->VM (executing JavaScript)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Web%20Crypto%20API.html" aria-label="Web Crypto API"><!---->Web Crypto API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Web%20Streams%20API.html" aria-label="Web Streams API"><!---->Web Streams API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/WebAssembly%20System%20Interface%20(WASI).html" aria-label="WebAssembly System Interface (WASI)"><!---->WebAssembly System Interface (WASI)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Worker%20threads.html" aria-label="Worker threads"><!---->Worker threads<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Zlib.html" aria-label="Zlib"><!---->Zlib<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Buffer</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://hanekawa.top" target="_blank" rel="noopener noreferrer">hanekawa-shiki</a></span><span property="author" content="hanekawa-shiki"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-06-21T09:46:17.000Z"></span><!----><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 267 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT267M"></span><span class="page-word-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon" name="word"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 80167 å­—</span><meta property="wordCount" content="80167"></span><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å…³é”®ç‚¹æ€»ç»“">å…³é”®ç‚¹æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#buffers-and-character-encodings">Buffers and character encodings</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-buffer">ä»€ä¹ˆæ˜¯ Bufferï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å­—ç¬¦ç¼–ç ">å­—ç¬¦ç¼–ç </a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-ä¸­çš„-buffer-å’Œå­—ç¬¦ç¼–ç ">Node.js ä¸­çš„ Buffer å’Œå­—ç¬¦ç¼–ç </a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-1">å®é™…ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#buffers-and-typedarrays">Buffers and TypedArrays</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-1">Buffer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#typedarray">TypedArray</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-ä¸­çš„ç»“åˆ">Node.js ä¸­çš„ç»“åˆ</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#buffers-and-iteration">Buffers and iteration</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-blob">Class: Blob</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åˆ›å»ºä¸€ä¸ª-blob">åˆ›å»ºä¸€ä¸ª Blob</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#blob-å±æ€§å’Œæ–¹æ³•">Blob å±æ€§å’Œæ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¯»å–-blob-å†…å®¹">è¯»å– Blob å†…å®¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-blob-å­˜å‚¨äºŒè¿›åˆ¶æ•°æ®">ä½¿ç”¨ Blob å­˜å‚¨äºŒè¿›åˆ¶æ•°æ®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#new-buffer-blob-sources-options">new buffer.Blob([sources[, options]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ„é€ å‡½æ•°">æ„é€ å‡½æ•°ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ç¤ºä¾‹">ä½¿ç”¨ç¤ºä¾‹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#blob-arraybuffer">blob.arrayBuffer()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#blob-size">blob.size</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#blob-slice-start-end-type">blob.slice([start[, end[, type]]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-æå–-buffer-çš„ä¸€éƒ¨åˆ†">ä¾‹å­ 1: æå– Buffer çš„ä¸€éƒ¨åˆ†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-å¤åˆ¶æ•´ä¸ª-buffer">ä¾‹å­ 2: å¤åˆ¶æ•´ä¸ª Buffer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-3-ä»-blob-å¯¹è±¡ä¸­æå–æ•°æ®">ä¾‹å­ 3: ä» Blob å¯¹è±¡ä¸­æå–æ•°æ®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#blob-stream">blob.stream()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#blob-stream-1">blob.stream()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#blob-text">blob.text()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#blob-æ˜¯ä»€ä¹ˆ">Blob æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#blob-text-æ–¹æ³•">blob.text() æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­">ä½¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#blob-type">blob.type</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#blob-objects-and-messagechannel">Blob objects and MessageChannel</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#blob-å¯¹è±¡">Blob å¯¹è±¡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#messagechannel">MessageChannel</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-buffer">Class: Buffer</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#static-method-buffer-alloc-size-fill-encoding">Static method: Buffer.alloc(size[, fill[, encoding]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º-10-å­—èŠ‚çš„ç¼“å†²åŒº-å¹¶ä½¿ç”¨é»˜è®¤å€¼-0-å¡«å……ã€‚">ä¾‹å­ 1: åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 10 å­—èŠ‚çš„ç¼“å†²åŒºï¼Œå¹¶ä½¿ç”¨é»˜è®¤å€¼ 0 å¡«å……ã€‚</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º-10-å­—èŠ‚çš„ç¼“å†²åŒº-å¹¶ç”¨-a-å¡«å……ã€‚">ä¾‹å­ 2: åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 10 å­—èŠ‚çš„ç¼“å†²åŒºï¼Œå¹¶ç”¨ &#39;a&#39; å¡«å……ã€‚</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-3-åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º-10-å­—èŠ‚çš„ç¼“å†²åŒº-å¹¶ç”¨-16-è¿›åˆ¶æ•°-0x1b-å¡«å……ã€‚">ä¾‹å­ 3: åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 10 å­—èŠ‚çš„ç¼“å†²åŒºï¼Œå¹¶ç”¨ 16 è¿›åˆ¶æ•° 0x1b å¡«å……ã€‚</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#static-method-buffer-allocunsafe-size">Static method: Buffer.allocUnsafe(size)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ç¤ºä¾‹-1">ä½¿ç”¨ç¤ºä¾‹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨">å®é™…è¿ç”¨ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#static-method-buffer-allocunsafeslow-size">Static method: Buffer.allocUnsafeSlow(size)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-ç®€å•åˆ›å»ºä¸€ä¸ª-buffer">ç¤ºä¾‹ 1ï¼šç®€å•åˆ›å»ºä¸€ä¸ª Buffer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-å¡«å……æ•°æ®åå†ä½¿ç”¨">ç¤ºä¾‹ 2ï¼šå¡«å……æ•°æ®åå†ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-3-å¤„ç†å›¾åƒæ•°æ®">ç¤ºä¾‹ 3ï¼šå¤„ç†å›¾åƒæ•°æ®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#static-method-buffer-bytelength-string-encoding">Static method: Buffer.byteLength(string[, encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#static-method-buffer-compare-buf1-buf2">Static method: Buffer.compare(buf1, buf2)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#static-method-buffer-concat-list-totallength">Static method: Buffer.concat(list[, totalLength])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼">è¿”å›å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­-1">ä½¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#static-method-buffer-copybytesfrom-view-offset-length">Static method: Buffer.copyBytesFrom(view[, offset[, length]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°-1">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼-1">è¿”å›å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­-2">ä½¿ç”¨ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#static-method-buffer-from-array">Static method: Buffer.from(array)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¯­æ³•">è¯­æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­">ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#static-method-buffer-from-arraybuffer-byteoffset-length">Static method: Buffer.from(arrayBuffer[, byteOffset[, length]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#static-method-buffer-from-buffer">Static method: Buffer.from(buffer)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-buffer-from-buffer">å¦‚ä½•ä½¿ç”¨ Buffer.from(buffer)?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨åœºæ™¯">å®é™…åº”ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#static-method-buffer-from-object-offsetorencoding-length">Static method: Buffer.from(object[, offsetOrEncoding[, length]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-æ˜¯ä»€ä¹ˆ">Buffer æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-from-é™æ€æ–¹æ³•">Buffer.from() é™æ€æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ç¤ºä¾‹-2">ä½¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#static-method-buffer-from-string-encoding">Static method: Buffer.from(string[, encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-from-string-encoding">Buffer.from(string[, encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-2">å®é™…ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#static-method-buffer-isbuffer-obj">Static method: Buffer.isBuffer(obj)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-æ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸º-buffer">ç¤ºä¾‹ 1ï¼šæ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸º Buffer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-æ£€æŸ¥å˜é‡ç±»å‹">ç¤ºä¾‹ 2ï¼šæ£€æŸ¥å˜é‡ç±»å‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-3-å‡½æ•°å‚æ•°éªŒè¯">ç¤ºä¾‹ 3ï¼šå‡½æ•°å‚æ•°éªŒè¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#static-method-buffer-isencoding-encoding">Static method: Buffer.isEncoding(encoding)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°-2">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼-3">è¿”å›å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆè¦ç”¨åˆ°è¿™ä¸ªæ–¹æ³•">ä¸ºä»€ä¹ˆè¦ç”¨åˆ°è¿™ä¸ªæ–¹æ³•ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#class-property-buffer-poolsize">Class property: Buffer.poolSize</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-poolsize-çš„å·¥ä½œåŸç†">Buffer.poolSize çš„å·¥ä½œåŸç†ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-buffer-poolsize">å¦‚ä½•ä½¿ç”¨ Buffer.poolSizeï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¸¾ä¾‹">å®é™…è¿ç”¨ä¸¾ä¾‹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-index">buf[index]</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-buffer">buf.buffer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-buffer-çš„å®šä¹‰">buf.buffer çš„å®šä¹‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-buf-buffer">å¦‚ä½•ä½¿ç”¨ buf.buffer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸¾ä¾‹è¯´æ˜">ä¸¾ä¾‹è¯´æ˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-byteoffset">buf.byteOffset</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-3">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-compare-target-targetstart-targetend-sourcestart-sourceend">buf.compare(target[, targetStart[, targetEnd[, sourceStart[, sourceEnd]]]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-copy-target-targetstart-sourcestart-sourceend">buf.copy(target[, targetStart[, sourceStart[, sourceEnd]]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-4">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ›´å¤æ‚çš„ä¾‹å­">æ›´å¤æ‚çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-entries">buf.entries()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-equals-otherbuffer">buf.equals(otherBuffer)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¯¦ç»†é€šä¿—è§£é‡Š">è¯¦ç»†é€šä¿—è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­-3">ä½¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-fill-value-offset-end-encoding">buf.fill(value[, offset[, end]][, encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-includes-value-byteoffset-encoding">buf.includes(value[, byteOffset][, encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-indexof-value-byteoffset-encoding">buf.indexOf(value[, byteOffset][, encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-5">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-keys">buf.keys()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-keys-æ–¹æ³•">buf.keys() æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­-4">ä½¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-lastindexof-value-byteoffset-encoding">buf.lastIndexOf(value[, byteOffset][, encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-lastindexof-value-byteoffset-encoding-1">buf.lastIndexOf(value[, byteOffset][, encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-length">buf.length</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-parent">buf.parent</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readbigint64be-offset">buf.readBigInt64BE([offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-big-endian-å¤§ç«¯åº">ä»€ä¹ˆæ˜¯ Big-Endianï¼ˆå¤§ç«¯åºï¼‰ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°-3">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼-4">è¿”å›å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-6">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readbigint64le-offset">buf.readBigInt64LE([offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-7">å®é™…ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readbiguint64be-offset">buf.readBigUInt64BE([offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readbiguint64le-offset">buf.readBigUInt64LE([offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç®€ä»‹">ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-8">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readdoublebe-offset">buf.readDoubleBE([offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readdoublele-offset">buf.readDoubleLE([offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readfloatbe-offset">buf.readFloatBE([offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-1-è¯»å–-buffer-ä¸­çš„ç¬¬ä¸€ä¸ªæµ®ç‚¹æ•°">å®ä¾‹ 1ï¼šè¯»å– Buffer ä¸­çš„ç¬¬ä¸€ä¸ªæµ®ç‚¹æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-2-è¯»å–-buffer-ä¸­çš„ç¬¬äºŒä¸ªæµ®ç‚¹æ•°">å®ä¾‹ 2ï¼šè¯»å– Buffer ä¸­çš„ç¬¬äºŒä¸ªæµ®ç‚¹æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readfloatle-offset">buf.readFloatLE([offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯å°ç«¯åº-little-endian">ä»€ä¹ˆæ˜¯å°ç«¯åºï¼ˆLittle-Endianï¼‰ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°-4">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨-1">å®é™…è¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readint8-offset">buf.readInt8([offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-è¯»å–-buffer-ä¸­çš„ç¬¬ä¸€ä¸ªå­—èŠ‚">ç¤ºä¾‹ 1ï¼šè¯»å– Buffer ä¸­çš„ç¬¬ä¸€ä¸ªå­—èŠ‚</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-ä½¿ç”¨-offset-å‚æ•°è¯»å–ç‰¹å®šä½ç½®çš„å­—èŠ‚">ç¤ºä¾‹ 2ï¼šä½¿ç”¨ offset å‚æ•°è¯»å–ç‰¹å®šä½ç½®çš„å­—èŠ‚</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-3-å½“å­—èŠ‚è¡¨ç¤ºè´Ÿæ•°æ—¶">ç¤ºä¾‹ 3ï¼šå½“å­—èŠ‚è¡¨ç¤ºè´Ÿæ•°æ—¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readint16be-offset">buf.readInt16BE([offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-2">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹è§£æ">å®ä¾‹è§£æ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readint16le-offset">buf.readInt16LE([offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readint32be-offset">buf.readInt32BE([offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readint32le-offset">buf.readInt32LE([offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-readint32le-æ˜¯ä»€ä¹ˆ">1. readInt32LE æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-offset-å‚æ•°æ˜¯ä»€ä¹ˆ">2. [offset] å‚æ•°æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readintbe-offset-bytelength">buf.readIntBE(offset, byteLength)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-1-è¯»å–ä¸€ä¸ª-16-ä½çš„æ•´æ•°">å®ä¾‹ 1ï¼šè¯»å–ä¸€ä¸ª 16 ä½çš„æ•´æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-2-è¯»å–ä¸€ä¸ª-32-ä½çš„æ•´æ•°">å®ä¾‹ 2ï¼šè¯»å–ä¸€ä¸ª 32 ä½çš„æ•´æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-3-ä»-buffer-ä¸­é—´è¯»å–æ•´æ•°">å®ä¾‹ 3ï¼šä» Buffer ä¸­é—´è¯»å–æ•´æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readintle-offset-bytelength">buf.readIntLE(offset, byteLength)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readuint8-offset">buf.readUInt8([offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readuint16be-offset">buf.readUInt16BE([offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-1-è¯»å–ç½‘ç»œæ•°æ®">å®ä¾‹ 1ï¼šè¯»å–ç½‘ç»œæ•°æ®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-2-è§£æäºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼">å®ä¾‹ 2ï¼šè§£æäºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-3-æ“ä½œç¡¬ä»¶è®¾å¤‡è¿”å›çš„æ•°æ®">å®ä¾‹ 3ï¼šæ“ä½œç¡¬ä»¶è®¾å¤‡è¿”å›çš„æ•°æ®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readuint16le-offset">buf.readUInt16LE([offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readuint32be-offset">buf.readUInt32BE([offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-1-è¯»å–ç½‘ç»œæ•°æ®-1">å®ä¾‹ 1ï¼šè¯»å–ç½‘ç»œæ•°æ®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-2-å¤„ç†æ–‡ä»¶å¤´ä¿¡æ¯">å®ä¾‹ 2ï¼šå¤„ç†æ–‡ä»¶å¤´ä¿¡æ¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readuint32le-offset">buf.readUInt32LE([offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readuintbe-offset-bytelength">buf.readUIntBE(offset, byteLength)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-readuintle-offset-bytelength">buf.readUIntLE(offset, byteLength)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-2">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼-5">è¿”å›å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-subarray-start-end">buf.subarray([start[, end]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-è·å–-buffer-çš„ä¸€éƒ¨åˆ†">ä¾‹å­ 1ï¼šè·å– Buffer çš„ä¸€éƒ¨åˆ†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-ä¸æä¾›ç»“æŸä½ç½®">ä¾‹å­ 2ï¼šä¸æä¾›ç»“æŸä½ç½®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-3-ä¿®æ”¹å­æ•°ç»„å½±å“åŸå§‹-buffer">ä¾‹å­ 3ï¼šä¿®æ”¹å­æ•°ç»„å½±å“åŸå§‹ Buffer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-slice-start-end">buf.slice([start[, end]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-swap16">buf.swap16()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-swap32">buf.swap32()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-swap64">buf.swap64()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-tojson">buf.toJSON()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-tostring-encoding-start-end">buf.toString([encoding[, start[, end]]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-tostring-encoding-start-end-çš„å‚æ•°è§£é‡Š">buf.toString([encoding[, start[, end]]]) çš„å‚æ•°è§£é‡Šï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­">å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-values">buf.values()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-write-string-offset-length-encoding">buf.write(string[, offset[, length]][, encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯´æ˜">å‚æ•°è¯´æ˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­-5">ä½¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è¯­">ç»“è¯­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writebigint64be-value-offset">buf.writeBigInt64BE(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-å†™å…¥ä¸€ä¸ª-bigint-åˆ°-buffer-å¹¶ä¸”ä¸æŒ‡å®šåç§»é‡">ç¤ºä¾‹ 1: å†™å…¥ä¸€ä¸ª BigInt åˆ° Buffer å¹¶ä¸”ä¸æŒ‡å®šåç§»é‡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-æŒ‡å®šåç§»é‡å†™å…¥-1">ç¤ºä¾‹ 2: æŒ‡å®šåç§»é‡å†™å…¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writebigint64le-value-offset">buf.writeBigInt64LE(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹ä¸€-åŸºæœ¬ç”¨æ³•">ç¤ºä¾‹ä¸€ï¼šåŸºæœ¬ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹äºŒ-å¸¦åç§»é‡çš„å†™å…¥">ç¤ºä¾‹äºŒï¼šå¸¦åç§»é‡çš„å†™å…¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writebiguint64be-value-offset">buf.writeBigUInt64BE(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-åŸºæœ¬çš„å†™å…¥">ä¾‹å­ 1: åŸºæœ¬çš„å†™å…¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-ä½¿ç”¨-offset-å‚æ•°">ä¾‹å­ 2: ä½¿ç”¨ offset å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writebiguint64le-value-offset">buf.writeBigUInt64LE(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨æ–¹æ³•">ä½¿ç”¨æ–¹æ³•:</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-å†™å…¥å¤§æ•´æ•°åˆ°-buffer">ä¾‹å­ 1ï¼šå†™å…¥å¤§æ•´æ•°åˆ° Buffer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-æŒ‡å®š-offset-å†™å…¥å¤§æ•´æ•°">ä¾‹å­ 2ï¼šæŒ‡å®š Offset å†™å…¥å¤§æ•´æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writedoublebe-value-offset">buf.writeDoubleBE(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¤§ç«¯-big-endian-å­—èŠ‚åºæ˜¯ä»€ä¹ˆ">å¤§ç«¯ï¼ˆBig-Endianï¼‰å­—èŠ‚åºæ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-3">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-åˆ›å»ºä¸€ä¸ª-buffer-å¹¶å†™å…¥ä¸€ä¸ªæ•°å­—">ç¤ºä¾‹ 1ï¼šåˆ›å»ºä¸€ä¸ª Buffer å¹¶å†™å…¥ä¸€ä¸ªæ•°å­—</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-æŒ‡å®šåç§»é‡å†™å…¥-2">ç¤ºä¾‹ 2ï¼šæŒ‡å®šåç§»é‡å†™å…¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writedoublele-value-offset">buf.writeDoubleLE(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-åŸºæœ¬ä½¿ç”¨">ç¤ºä¾‹ 1ï¼šåŸºæœ¬ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-å¸¦åç§»é‡çš„ä½¿ç”¨">ç¤ºä¾‹ 2ï¼šå¸¦åç§»é‡çš„ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writefloatbe-value-offset">buf.writeFloatBE(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writefloatle-value-offset">buf.writeFloatLE(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writefloatle-value-offset-1">buf.writeFloatLE(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writeint8-value-offset">buf.writeInt8(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writeint16be-value-offset">buf.writeInt16BE(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writeint16le-value-offset">buf.writeInt16LE(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-buffer-1">ä»€ä¹ˆæ˜¯ Bufferï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£-writeint16le">ç†è§£ writeInt16LE</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‡½æ•°å‚æ•°">å‡½æ•°å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-1">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writeint32be-value-offset">buf.writeInt32BE(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writeint32le-value-offset">buf.writeInt32LE(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writeintbe-value-offset-bytelength">buf.writeIntBE(value, offset, byteLength)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-æ˜¯ä»€ä¹ˆ-1">Buffer æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆéœ€è¦-buffer">ä¸ºä»€ä¹ˆéœ€è¦ Bufferï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#big-endian-be-æ˜¯ä»€ä¹ˆ">Big Endian (BE) æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#writeintbe-å‡½æ•°åšä»€ä¹ˆ">writeIntBE å‡½æ•°åšä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-2">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writeintle-value-offset-bytelength">buf.writeIntLE(value, offset, byteLength)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-å†™å…¥ä¸€ä¸ª-16-ä½æ•´æ•°">ç¤ºä¾‹ 1ï¼šå†™å…¥ä¸€ä¸ª 16 ä½æ•´æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-å†™å…¥ä¸€ä¸ª-32-ä½æ•´æ•°">ç¤ºä¾‹ 2ï¼šå†™å…¥ä¸€ä¸ª 32 ä½æ•´æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-3-å°è¯•å†™å…¥è¶…å‡ºèŒƒå›´çš„æ•´æ•°">ç¤ºä¾‹ 3ï¼šå°è¯•å†™å…¥è¶…å‡ºèŒƒå›´çš„æ•´æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writeuint8-value-offset">buf.writeUInt8(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-åŸºæœ¬ä½¿ç”¨-1">ç¤ºä¾‹ 1ï¼šåŸºæœ¬ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-å¸¦åç§»é‡çš„å†™å…¥">ç¤ºä¾‹ 2ï¼šå¸¦åç§»é‡çš„å†™å…¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writeuint16be-value-offset">buf.writeUInt16BE(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writeuint16le-value-offset">buf.writeUInt16LE(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-1-åˆ›å»ºä¸€ä¸ª-buffer-å¹¶å†™å…¥ä¸€ä¸ª-16-ä½æ— ç¬¦å·æ•´æ•°">å®ä¾‹ 1ï¼šåˆ›å»ºä¸€ä¸ª Buffer å¹¶å†™å…¥ä¸€ä¸ª 16 ä½æ— ç¬¦å·æ•´æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-2-å‘-buffer-ä¸­å†™å…¥ä¸¤ä¸ª-16-ä½æ— ç¬¦å·æ•´æ•°">å®ä¾‹ 2ï¼šå‘ Buffer ä¸­å†™å…¥ä¸¤ä¸ª 16 ä½æ— ç¬¦å·æ•´æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writeuint32be-value-offset">buf.writeUInt32BE(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-åŸºæœ¬ä½¿ç”¨-2">ç¤ºä¾‹ 1ï¼šåŸºæœ¬ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-æŒ‡å®šåç§»é‡">ç¤ºä¾‹ 2ï¼šæŒ‡å®šåç§»é‡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-3-æ²¡æœ‰è¶³å¤Ÿç©ºé—´">ç¤ºä¾‹ 3ï¼šæ²¡æœ‰è¶³å¤Ÿç©ºé—´</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writeuint32le-value-offset">buf.writeUInt32LE(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writeuint32le-value-offset-1">buf.writeUInt32LE(value[, offset])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writeuintbe-value-offset-bytelength">buf.writeUIntBE(value, offset, byteLength)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buf-writeuintle-value-offset-bytelength">buf.writeUIntLE(value, offset, byteLength)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨å®ä¾‹">ä½¿ç”¨å®ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#new-buffer-array">new Buffer(array)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#new-buffer-arraybuffer-byteoffset-length">new Buffer(arrayBuffer[, byteOffset[, length]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#new-buffer-buffer">new Buffer(buffer)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#new-buffer-size">new Buffer(size)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ—§çš„new-buffer-size-æ–¹æ³•">æ—§çš„new Buffer(size)æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ¨èæ–¹æ³•">æ¨èæ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#new-buffer-string-encoding">new Buffer(string[, encoding])</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ä»€ä¹ˆæ˜¯-buffer-2">ä»€ä¹ˆæ˜¯ Buffer?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å·²åºŸå¼ƒçš„-new-buffer-string-encoding">å·²åºŸå¼ƒçš„ new Buffer(string[, encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#æ­£ç¡®åˆ›å»º-buffer-çš„æ–¹å¼">æ­£ç¡®åˆ›å»º Buffer çš„æ–¹å¼</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-from">Buffer.from()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-alloc">Buffer.alloc()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-allocunsafe">Buffer.allocUnsafe()</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å®é™…è¿ç”¨ä¾‹å­">å®é™…è¿ç”¨ä¾‹å­</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ–‡ä»¶è¯»å–">æ–‡ä»¶è¯»å–</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç½‘ç»œè¯·æ±‚">ç½‘ç»œè¯·æ±‚</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-file">Class: File</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#open">open()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#read">read()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#write">write()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#close">close()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#new-buffer-file-sources-filename-options">new buffer.File(sources, fileName[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#file-name">file.name</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#file-lastmodified">file.lastModified</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#node-buffer-module-apis">node:buffer module APIs</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åˆ›å»º-buffer">åˆ›å»º Buffer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å†™å…¥å’Œè¯»å–-buffer">å†™å…¥å’Œè¯»å– Buffer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-å’Œ-i-o-æ“ä½œ">Buffer å’Œ I/O æ“ä½œ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-çš„å…¶ä»–æ“ä½œ">Buffer çš„å…¶ä»–æ“ä½œ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-atob-data">buffer.atob(data)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-ä¸­çš„-buffer-atob-data">Node.js ä¸­çš„ buffer.atob(data)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-btoa-data">buffer.btoa(data)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-ç¼–ç ä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²">ä¾‹å­ 1: ç¼–ç ä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-åœ¨-http-è¯·æ±‚ä¸­ç¼–ç ç”¨æˆ·å‡­è¯">ä¾‹å­ 2: åœ¨ HTTP è¯·æ±‚ä¸­ç¼–ç ç”¨æˆ·å‡­è¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-1">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-isascii-input">buffer.isAscii(input)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-isutf8-input">buffer.isUtf8(input)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-1-æ£€æŸ¥ä¸€ä¸ªåˆæ³•çš„-utf-8-ç¼–ç çš„-buffer">å®ä¾‹ 1ï¼šæ£€æŸ¥ä¸€ä¸ªåˆæ³•çš„ UTF-8 ç¼–ç çš„ Buffer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-2-æ£€æŸ¥ä¸€ä¸ªéæ³•çš„-utf-8-ç¼–ç çš„-buffer">å®ä¾‹ 2ï¼šæ£€æŸ¥ä¸€ä¸ªéæ³•çš„ UTF-8 ç¼–ç çš„ Buffer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨åœºæ™¯">å®é™…è¿ç”¨åœºæ™¯ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-inspect-max-bytes">buffer.INSPECT_MAX_BYTES</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-kmaxlength">buffer.kMaxLength</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸¾ä¾‹è¯´æ˜-1">ä¸¾ä¾‹è¯´æ˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-kstringmaxlength">buffer.kStringMaxLength</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-resolveobjecturl-id">buffer.resolveObjectURL(id)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-transcode-source-fromenc-toenc">buffer.transcode(source, fromEnc, toEnc)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#class-slowbuffer">Class: SlowBuffer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-constants">Buffer constants</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1">ç¤ºä¾‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#buffer-from-buffer-alloc-and-buffer-allocunsafe">Buffer.from(), Buffer.alloc(), and Buffer.allocUnsafe()</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-from-1">Buffer.from()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-alloc-1">Buffer.alloc()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-allocunsafe-1">Buffer.allocUnsafe()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#the-zero-fill-buffers-command-line-option">The --zero-fill-buffers command-line option</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#what-makes-buffer-allocunsafe-and-buffer-allocunsafeslow-unsafe">What makes Buffer.allocUnsafe() and Buffer.allocUnsafeSlow() &quot;unsafe&quot;?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆæ˜¯-ä¸å®‰å…¨-çš„">ä¸ºä»€ä¹ˆæ˜¯â€œä¸å®‰å…¨â€çš„ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®‰å…¨æ›¿ä»£æ–¹æ¡ˆ">å®‰å…¨æ›¿ä»£æ–¹æ¡ˆ</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="buffer" tabindex="-1"><a class="header-anchor" href="#buffer"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#buffer" target="_blank" rel="noopener noreferrer">Buffer</a></span></a></h1><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code> ç±»æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨äºç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµã€‚</p><p>åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œ&quot;buffer&quot; é€šå¸¸æŒ‡çš„æ˜¯å†…å­˜ä¸­çš„ä¸€æ®µä¸´æ—¶å­˜å‚¨åŒºåŸŸï¼Œç”¨äºå­˜æ”¾è¾“å…¥æˆ–è¾“å‡ºæ•°æ®ã€‚è¿™åœ¨å¤„ç† I/O æ“ä½œï¼ˆè¾“å…¥/è¾“å‡ºæ“ä½œï¼Œå¦‚è¯»å–æ–‡ä»¶æˆ–ç½‘ç»œé€šä¿¡ï¼‰æ—¶éå¸¸æœ‰ç”¨ã€‚</p><p>åœ¨ Node.js çš„æ—©æœŸç‰ˆæœ¬ä¸­ï¼ŒJavaScript æœ¬èº«å¹¶æ²¡æœ‰å¯¹äºŒè¿›åˆ¶æ•°æ®çš„ç›´æ¥æ”¯æŒã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒNode.js æä¾›äº† <code>Buffer</code> ç±»æ¥åˆ›å»ºä¸€ä¸ªä¸“é—¨å­˜å‚¨åŸå§‹äºŒè¿›åˆ¶æ•°æ®çš„ç¼“å†²åŒºï¼ˆå°±åƒæ•°ç»„ä¸€æ ·ï¼Œä½†å®ƒå­˜å‚¨çš„æ˜¯å­—èŠ‚è€Œä¸æ˜¯å­—ç¬¦ï¼‰ã€‚åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>Buffer</code> ç±»ä»ç„¶æ˜¯è¿™æ ·ä¸€ä¸ªé‡è¦çš„å·¥å…·ï¼Œå°½ç®¡ç°åœ¨ JavaScript å·²ç»æœ‰äº† <code>ArrayBuffer</code> å’Œ <code>TypedArray</code> è¿™æ ·çš„åŸç”Ÿæ„é€ å‡½æ•°æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚</p><h3 id="å®é™…ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­"><span>å®é™…ä¾‹å­</span></a></h3><h4 id="_1-ä»æ–‡ä»¶è¯»å–æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_1-ä»æ–‡ä»¶è¯»å–æ•°æ®"><span>1. ä»æ–‡ä»¶è¯»å–æ•°æ®</span></a></h4><p>å‡è®¾æ‚¨æœ‰ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶ï¼Œæ‚¨æƒ³å°†å…¶å†…å®¹è¯»å…¥ Node.js ç¨‹åºä¸­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŒæ­¥æ–¹å¼è¯»å–æ–‡ä»¶å†…å®¹åˆ° Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;image.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬ç°åœ¨å¯ä»¥ä½¿ç”¨ buffer å¯¹è±¡æ¥å¤„ç†å›¾ç‰‡çš„äºŒè¿›åˆ¶æ•°æ®ã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>readFileSync</code> æ–¹æ³•è¿”å›ä¸€ä¸ª <code>Buffer</code>ï¼Œå…¶ä¸­åŒ…å«äº†å›¾ç‰‡æ–‡ä»¶çš„äºŒè¿›åˆ¶æ•°æ®ã€‚</p><h4 id="_2-ç½‘ç»œè¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_2-ç½‘ç»œè¯·æ±‚"><span>2. ç½‘ç»œè¯·æ±‚</span></a></h4><p>å¦‚æœæ‚¨æƒ³è¦å‘é€ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶å¤„ç†è¿”å›çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¯”å¦‚ä¸‹è½½ä¸€ä¸ªå›¾ç‰‡ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> https</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> request</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> https</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https://example.com/image.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">response</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // response æ˜¯ä¸€ä¸ª Stream å®ä¾‹ï¼Œå®ƒä¼šå‘å‡º &#39;data&#39; äº‹ä»¶æ¥ä¼ è¾“æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªç©ºçš„ Buffer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  response</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å½“æ”¶åˆ°æ•°æ®æ—¶ï¼Œå°†å…¶è¿½åŠ åˆ° Buffer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">concat</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  response</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ•°æ®ä¼ è¾“å®Œæ¯•ï¼Œdata Buffer ç°åœ¨åŒ…å«äº†æ•´ä¸ªå›¾åƒæ–‡ä»¶çš„å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;downloaded_image.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>http.get()</code> æ¥è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼Œå¹¶åœ¨æ¥æ”¶æ•°æ®çš„æ—¶å€™ï¼Œå°†å…¶è¿½åŠ åˆ°ä¸€ä¸ª Buffer å®ä¾‹ä¸­ã€‚</p><h4 id="_3-æ•°æ®è½¬æ¢" tabindex="-1"><a class="header-anchor" href="#_3-æ•°æ®è½¬æ¢"><span>3. æ•°æ®è½¬æ¢</span></a></h4><p>è®¸å¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å°†å­—ç¬¦ä¸²æ•°æ®è½¬æ¢ä¸º Buffer å¯¹è±¡ï¼Œä»¥ä¾¿è¿›è¡Œåº•å±‚æ“ä½œï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å« UTF-8 ç¼–ç å­—ç¬¦ä¸² &quot;Hello World&quot; çš„ Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf-8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯ä»¥å°† Buffer è½¬æ¢å›å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: Hello World</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>Buffer.from()</code> æ–¹æ³•ç”¨æ¥æŠŠä¸€ä¸ªå­—ç¬¦ä¸²è½¬æ¢æˆäº†ä¸€ä¸ª Buffer å®ä¾‹ï¼Œéšåä½¿ç”¨ <code>.toString()</code> æ–¹æ³•åˆæŠŠ Buffer çš„å†…å®¹è½¬æ¢å›äº†å­—ç¬¦ä¸²ã€‚</p><h3 id="å…³é”®ç‚¹æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#å…³é”®ç‚¹æ€»ç»“"><span>å…³é”®ç‚¹æ€»ç»“</span></a></h3><ul><li><code>Buffer</code> åœ¨ Node.js ä¸­ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚</li><li>å®ƒå¯ä»¥ç”¨æ¥å¤„ç†æ–‡ä»¶ã€ç½‘ç»œè¯·æ±‚ç­‰æ¶‰åŠäºŒè¿›åˆ¶æ•°æ®çš„æƒ…å¢ƒã€‚</li><li><code>Buffer</code> å¯ä»¥ä¸å­—ç¬¦ä¸²ç›¸äº’è½¬æ¢ï¼Œä¹Ÿå¯ä»¥å’Œå…¶ä»– Buffer åˆå¹¶ã€‚</li></ul><p>å¸Œæœ›è¿™äº›è§£é‡Šå’Œä¾‹å­èƒ½å¤Ÿå¸®åŠ©ä½ ç†è§£ Node.js ä¸­çš„ <code>Buffer</code> ä»¥åŠå®ƒçš„ä½œç”¨å’Œåº”ç”¨æ–¹å¼ã€‚</p><h2 id="buffers-and-character-encodings" tabindex="-1"><a class="header-anchor" href="#buffers-and-character-encodings"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#buffers-and-character-encodings" target="_blank" rel="noopener noreferrer">Buffers and character encodings</a></span></a></h2><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥è§£é‡Š Node.js ä¸­çš„ Buffers å’Œå­—ç¬¦ç¼–ç ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-buffer" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-buffer"><span>ä»€ä¹ˆæ˜¯ Bufferï¼Ÿ</span></a></h3><p>é¦–å…ˆï¼ŒBuffer æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„å¯¹è±¡ã€‚åœ¨æ—©æœŸçš„ JavaScript ä¸­å¹¶æ²¡æœ‰å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„èƒ½åŠ›ï¼Œå› ä¸ºå®ƒä¸»è¦è®¾è®¡ç”¨äºå¤„ç†æ–‡æœ¬æ•°æ®ã€‚ä½†æ˜¯ï¼Œåœ¨æœåŠ¡å™¨ç«¯ç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¤„ç†è¯¸å¦‚æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡ç­‰çš„äºŒè¿›åˆ¶æ•°æ®ã€‚è¿™æ—¶å€™ Buffer å°±æ´¾ä¸Šäº†ç”¨åœºã€‚</p><p>Buffer å¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸€ä¸ªä¸´æ—¶çš„å­˜å‚¨åŒºï¼Œå®ƒä¿å­˜ç€ä»æŸä¸ªæ¥æºï¼ˆæ¯”å¦‚æ–‡ä»¶ç³»ç»Ÿæˆ–ç½‘ç»œï¼‰æ¥æ”¶åˆ°çš„åŸå§‹äºŒè¿›åˆ¶æ•°æ®ã€‚é€šè¿‡ Bufferï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ JavaScript ä¸­æ“ä½œè¿™äº›äºŒè¿›åˆ¶æ•°æ®ã€‚</p><h3 id="å­—ç¬¦ç¼–ç " tabindex="-1"><a class="header-anchor" href="#å­—ç¬¦ç¼–ç "><span>å­—ç¬¦ç¼–ç </span></a></h3><p>å­—ç¬¦ç¼–ç æ˜¯ä¸€å¥—è§„åˆ™ï¼Œç”¨äºå°†å­—ç¬¦è½¬æ¢æˆæ•°å­—ï¼ˆäºŒè¿›åˆ¶å½¢å¼ï¼‰ï¼Œä½¿å¾—è®¡ç®—æœºå¯ä»¥å­˜å‚¨å’Œä¼ è¾“ã€‚ä¾‹å¦‚ï¼ŒASCII ç¼–ç æ˜¯ä¸€ç§å­—ç¬¦ç¼–ç ï¼Œå®ƒå°†è‹±æ–‡å­—æ¯å’Œå…¶ä»–ç¬¦å·æ˜ å°„æˆæ•°å­—ã€‚UTF-8 æ˜¯å¦ä¸€ç§æ›´ä¸ºå¹¿æ³›ä½¿ç”¨çš„ç¼–ç æ–¹å¼ï¼Œå®ƒæ”¯æŒå¤šç§è¯­è¨€çš„å­—ç¬¦ï¼Œå¹¶ä¸”æ˜¯äº’è”ç½‘ä¸Šçš„æ ‡å‡†ç¼–ç ã€‚</p><h3 id="node-js-ä¸­çš„-buffer-å’Œå­—ç¬¦ç¼–ç " tabindex="-1"><a class="header-anchor" href="#node-js-ä¸­çš„-buffer-å’Œå­—ç¬¦ç¼–ç "><span>Node.js ä¸­çš„ Buffer å’Œå­—ç¬¦ç¼–ç </span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œå½“ä½ åˆ›å»ºä¸€ä¸ª Buffer å¯¹è±¡æ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹å®ƒä¼šä½¿ç”¨äºŒè¿›åˆ¶æ•°æ®ï¼ˆå³å…«ä½å­—èŠ‚ï¼‰ã€‚ä½†æ˜¯ï¼Œä½ å¯ä»¥æŒ‡å®šä¸åŒçš„å­—ç¬¦ç¼–ç æ¥è§£ç æˆ–ç¼–ç è¿™ä¸ªäºŒè¿›åˆ¶æ•°æ®ï¼Œè½¬æ¢ä¸ºäººç±»å¯è¯»çš„æ ¼å¼ã€‚</p><p>Node.js æ”¯æŒå¤šç§å­—ç¬¦ç¼–ç ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›æœ€å¸¸è§çš„ï¼š</p><ul><li><code>utf8</code>: å¤šå­—èŠ‚ç¼–ç çš„ Unicode å­—ç¬¦ã€‚è¿™æ˜¯ Node.js Buffer é»˜è®¤çš„ç¼–ç ï¼Œé€‚ç”¨äºå¤§å¤šæ•°æ–‡æœ¬æ•°æ®ã€‚</li><li><code>ascii</code>: ç”¨äº 7 ä½ ASCII æ•°æ®ã€‚</li><li><code>base64</code>: å½“éœ€è¦ä»¥ ASCII å­—ç¬¦ä¸²çš„å½¢å¼è¡¨ç¤ºäºŒè¿›åˆ¶æ•°æ®æ—¶ä½¿ç”¨ã€‚</li><li><code>hex</code>: å°†æ¯ä¸ªå­—èŠ‚ç¼–ç ä¸ºä¸¤ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ã€‚</li></ul><h3 id="å®é™…ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-1"><span>å®é™…ä¾‹å­</span></a></h3><ol><li><strong>åˆ›å»º Buffer</strong>ï¼šä½¿ç”¨ <code>Buffer.from()</code> æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ Buffer å®ä¾‹ï¼Œå¹¶ä¸”å¯ä»¥æŒ‡å®šç¼–ç ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å« &#39;hello world&#39; æ–‡æœ¬çš„ Buffer å¯¹è±¡ï¼Œé»˜è®¤ä½¿ç”¨ utf8 ç¼–ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hello world&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>å°† Buffer è½¬æ¢ä¸ºå­—ç¬¦ä¸²</strong>ï¼šä½¿ç”¨ <code>.toString()</code> æ–¹æ³•å°† Buffer å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šç¼–ç ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°† buffer è½¬æ¢å› utf8 ç¼–ç çš„å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°: hello world</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>Base64 ç¼–ç å®ä¾‹</strong>ï¼šå‡è®¾æˆ‘ä»¬éœ€è¦å°†ä¸€ä¸ªå­—ç¬¦ä¸²è½¬æ¢ä¸º base64 ç¼–ç ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufferForBase64</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Node.js is cool!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†è¿™ä¸ª Buffer è½¬æ¢ä¸º base64 ç¼–ç çš„å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> base64String</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bufferForBase64</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">base64String</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°: Tm9kZS5qcyBpcyBjb29sIQ==</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li><strong>Hex ç¼–ç å®ä¾‹</strong>ï¼šå¦‚æœä½ æƒ³æŸ¥çœ‹ä¸€ä¸ªå­—ç¬¦ä¸²åœ¨ Buffer ä¸­çš„åå…­è¿›åˆ¶è¡¨ç¤ºã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufferForHex</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è½¬æ¢ä¸º hex ç¼–ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hexString</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bufferForHex</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hexString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°: 48656c6c6f2c20576f726c6421</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° Buffer åœ¨ Node.js ä¸­å¦‚ä½•ä¸ä¸åŒçš„å­—ç¬¦ç¼–ç è¿›è¡Œäº’åŠ¨ã€‚ä¸ä»…ä»…å±€é™äºæ–‡æœ¬ï¼Œä»»ä½•å½¢å¼çš„æ•°æ®ï¼Œå¦‚å›¾ç‰‡ã€è§†é¢‘ç­‰éƒ½å¯ä»¥ä½¿ç”¨ Buffer è¿›è¡Œå¤„ç†ï¼Œåªæ˜¯åœ¨å‰©ä½™çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹åº”çš„ç¼–ç å’Œè§£ç æ–¹æ³•å¯èƒ½æœ‰æ‰€ä¸åŒã€‚</p><h2 id="buffers-and-typedarrays" tabindex="-1"><a class="header-anchor" href="#buffers-and-typedarrays"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#buffers-and-typedarrays" target="_blank" rel="noopener noreferrer">Buffers and TypedArrays</a></span></a></h2><p>å¥½çš„ï¼Œåœ¨ Node.js ä¸­ï¼ŒBuffer å’Œ TypedArray æ˜¯ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ã€‚ä¸ºäº†è®©ä½ æ›´å¥½åœ°ç†è§£ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦çŸ¥é“ä»€ä¹ˆæ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œä»¥åŠä¸ºä»€ä¹ˆè¦å¤„ç†å®ƒã€‚</p><p><strong>äºŒè¿›åˆ¶æ•°æ®</strong> å°±æ˜¯ç”± 0 å’Œ 1 ç»„æˆçš„æ•°æ®â€”â€”ä¹Ÿå°±æ˜¯ç”µè„‘åº•å±‚è¯­è¨€ã€‚å½“ä½ å¤„ç†æ–‡ä»¶ï¼ˆå¦‚å›¾ç‰‡æˆ–éŸ³ä¹ï¼‰ã€ç½‘ç»œé€šä¿¡ç­‰ï¼Œè¿™äº›æ•°æ®åœ¨å†…å­˜ä¸­éƒ½æ˜¯ä»¥äºŒè¿›åˆ¶å½¢å¼å­˜åœ¨çš„ã€‚</p><h3 id="buffer-1" tabindex="-1"><a class="header-anchor" href="#buffer-1"><span>Buffer</span></a></h3><p>åœ¨æ—©æœŸçš„ Node.js ç‰ˆæœ¬ä¸­ï¼Œ<code>Buffer</code>ç±»æ˜¯ä¸“é—¨ä¸ºäº†å¤„ç†äºŒè¿›åˆ¶æ•°æ®è€Œåˆ›å»ºçš„ã€‚ä¸€ä¸ª Buffer å¯¹è±¡ç±»ä¼¼äºä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œä½†å®ƒä¸»è¦ç”¨æ¥è¡¨ç¤ºå›ºå®šé•¿åº¦çš„å­—èŠ‚åºåˆ—ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®ï¼Œæˆ–è€…æ¥æ”¶ç½‘ç»œè¯·æ±‚çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®å°±ä¼šè¢«å­˜å‚¨åœ¨<code>Buffer</code>å®ä¾‹ä¸­ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º10å­—èŠ‚çš„Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªBufferï¼Œå¹¶åˆå§‹åŒ–ä¸ºä¸€äº›å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufWithContent</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Buffer.alloc(size)</code> ä¼šåˆ›å»ºä¸€ä¸ªæŒ‡å®šå¤§å°çš„ Bufferï¼Œå¹¶ä¸”åˆå§‹åŒ–æ‰€æœ‰ä½ä¸ºé›¶ã€‚<code>Buffer.from(string, encoding)</code> åˆ™æ ¹æ®ç»™å®šçš„å­—ç¬¦ä¸²å’Œç¼–ç åˆ›å»ºä¸€ä¸ªæ–°çš„ Bufferã€‚</p><h3 id="typedarray" tabindex="-1"><a class="header-anchor" href="#typedarray"><span>TypedArray</span></a></h3><p><code>TypedArray</code>æ˜¯ ECMAScript 6 å¼•å…¥çš„ï¼Œç”¨æ¥æä¾›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„è§†å›¾æ¥æ“ä½œäºŒè¿›åˆ¶æ•°æ®ç¼“å†²åŒºã€‚ä¸åŒç±»å‹çš„ TypedArray å…è®¸ä½ åœ¨ç¼“å†²åŒºä¸ŠæŒ‰ç‰¹å®šçš„æ•°æ®ç±»å‹è¯»å†™â€”â€”ä¾‹å¦‚ï¼Œåªæœ‰æ•´æ•°ã€æµ®ç‚¹æ•°ç­‰ã€‚å¸¸è§çš„ TypedArray ç±»å‹åŒ…æ‹¬ï¼š</p><ul><li><code>Int8Array</code>: 8 ä½æœ‰ç¬¦å·æ•´æ•°æ•°ç»„</li><li><code>Uint8Array</code>: 8 ä½æ— ç¬¦å·æ•´æ•°æ•°ç»„</li><li><code>Uint8ClampedArray</code>: 8 ä½æ— ç¬¦å·æ•´æ•°æ•°ç»„ï¼Œè¶…å‡ºèŒƒå›´æ—¶è‡ªåŠ¨ä¿®æ­£å€¼</li><li><code>Int16Array</code>, <code>Uint16Array</code>: 16 ä½æ•´æ•°æ•°ç»„</li><li><code>Int32Array</code>, <code>Uint32Array</code>: 32 ä½æ•´æ•°æ•°ç»„</li><li><code>Float32Array</code>, <code>Float64Array</code>: 32 ä½å’Œ 64 ä½æµ®ç‚¹æ•°æ•°ç»„</li></ul><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨<code>TypedArray</code>çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªArrayBufferï¼Œå®ƒæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ•°æ®å®¹å™¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> ArrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ†é…16ä¸ªå­—èŠ‚</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªè§†å›¾ï¼Œè¡¨ç°ä¸º16ä½çš„æ•´æ•°æ•°ç»„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> int16View</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Int16Array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯ä»¥é€šè¿‡ç´¢å¼•æ“ä½œæ•°ç»„å…ƒç´ </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> int16View</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  int16View</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>int16View</code> æ˜¯ä¸€ä¸ªè§†å›¾ï¼Œå¯¹åº”<code>buffer</code>çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ“ä½œ<code>int16View</code>æ¥è¯»å†™<code>buffer</code>é‡Œçš„äºŒè¿›åˆ¶æ•°æ®ã€‚</p><h3 id="node-js-ä¸­çš„ç»“åˆ" tabindex="-1"><a class="header-anchor" href="#node-js-ä¸­çš„ç»“åˆ"><span>Node.js ä¸­çš„ç»“åˆ</span></a></h3><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>Buffer</code>å®ä¾‹å®é™…ä¸Šæ˜¯<code>Uint8Array</code>çš„å­ç±»ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨<code>Buffer</code>å®ä¾‹ä¸Šä½¿ç”¨æ‰€æœ‰<code>Uint8Array</code>çš„æ–¹æ³•ï¼ŒåŒæ—¶è¿˜èƒ½ä½¿ç”¨<code>Buffer</code>ç‰¹æœ‰çš„ä¾¿åˆ©æ–¹æ³•ã€‚</p><p>è¿™ç§è®¾è®¡ä½¿å¾—å¤„ç†äºŒè¿›åˆ¶æ•°æ®æ›´åŠ çµæ´»é«˜æ•ˆã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°å°†<code>Buffer</code>ä¸å…¶ä»– JavaScript çš„ APIs ç»“åˆèµ·æ¥ä½¿ç”¨ï¼Œæ¯”å¦‚å¯ä»¥ç›´æ¥ä½¿ç”¨<code>Buffer</code>æ¥ä¸ Web APIs ä¸­çš„<code>FileReader</code>æˆ–<code>Blob</code>å¯¹è±¡äº¤äº’ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªBufferå®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨Bufferçš„sliceæ–¹æ³•ï¼Œç±»ä¼¼äºæ•°ç»„çš„sliceï¼Œä½†ä¸å¤åˆ¶æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> slice</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">slice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// sliceç°åœ¨æ˜¯`&lt;`Buffer 01 02&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">slice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ“ä½œ<code>Buffer</code>å°±åƒæ“ä½œä¸€ä¸ªæ™®é€šçš„æ•°ç»„ä¸€æ ·ï¼Œä½†å®é™…ä¸Šå®ƒä»¬ä»£è¡¨çš„æ˜¯åº•å±‚çš„äºŒè¿›åˆ¶æ•°æ®ã€‚è¿™åœ¨å¤„ç†ä¾‹å¦‚ TCP æµã€æ–‡ä»¶ I/O æ—¶éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºé‚£äº›æ“ä½œé€šå¸¸æ¶‰åŠåˆ°å¤§é‡çš„äºŒè¿›åˆ¶æ•°æ®äº¤æ¢ã€‚</p><p>æ€»ä¹‹ï¼Œ<code>Buffer</code>å’Œ<code>TypedArray</code>è®© Node.js çš„å¼€å‘è€…èƒ½å¤Ÿé«˜æ•ˆåœ°å¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼Œè€Œä¸ç”¨æ·±å…¥åˆ°å¤æ‚çš„ä½æ“ä½œå±‚æ¬¡ï¼Œå¯ä»¥ä¸“æ³¨äºå®ç°ä¸šåŠ¡é€»è¾‘å’ŒåŠŸèƒ½å¼€å‘ã€‚</p><h2 id="buffers-and-iteration" tabindex="-1"><a class="header-anchor" href="#buffers-and-iteration"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#buffers-and-iteration" target="_blank" rel="noopener noreferrer">Buffers and iteration</a></span></a></h2><p>Node.js ä¸­çš„ Buffer æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ç±»ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå…è®¸ä½ å­˜å‚¨åŸå§‹æ•°æ®ï¼ˆæ¯”å¦‚å›¾ç‰‡ã€æ–‡ä»¶ç­‰ä¸ä»…ä»…æ˜¯æ–‡æœ¬ï¼‰çš„æ•°ç»„ã€‚åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œâ€œBuffers and iterationâ€éƒ¨åˆ†æ¶‰åŠåˆ°äº†å¦‚ä½•å¤„ç†è¿™äº› Buffer å¯¹è±¡çš„è¿­ä»£ã€‚</p><p>åœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸é€šè¿‡å¾ªç¯æ¥éå†æ•°ç»„æˆ–å…¶ä»–å¯è¿­ä»£çš„å¯¹è±¡ã€‚åŒæ ·çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹ Buffer è¿›è¡Œè¿­ä»£æ“ä½œã€‚Node.js çš„ Buffer å®ç°äº† Iterable æ¥å£ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨ <code>for...of</code> å¾ªç¯æ¥éå† Buffer å¯¹è±¡ä¸­çš„æ¯ä¸€ä¸ªå­—èŠ‚ã€‚</p><p>è¿™é‡Œç»™ä½ ä¸¾ä¸ªä¾‹å­ï¼š</p><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œéœ€è¦è¯»å–ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡ï¼Œå¹¶åˆ†æå®ƒçš„å†…å®¹ï¼ˆä¾‹å¦‚æŸ¥æ‰¾æŸç§æ¨¡å¼æˆ–è€…è®¡ç®—å›¾ç‰‡ä¸­ç‰¹å®šé¢œè‰²çš„æ•°é‡ï¼‰ã€‚ä¸ºäº†å®Œæˆè¿™é¡¹ä»»åŠ¡ï¼Œä½ éœ€è¦å°†å›¾ç‰‡è¯»å–åˆ°å†…å­˜ä¸­å¹¶ä»¥äºŒè¿›åˆ¶å½¢å¼è¿›è¡Œå¤„ç†ã€‚è¿™å°±æ˜¯ Buffer æ´¾ä¸Šç”¨åœºçš„æ—¶å€™ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥ fs æ¨¡å—ï¼Œç”¨äºæ–‡ä»¶ç³»ç»Ÿæ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŒæ­¥åœ°è¯»å–ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶åˆ° Buffer ä¸­</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> imageBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path/to/image.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ for...of éå†è¿™ä¸ª Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> byte</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> of</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> imageBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ­¤å¤„ï¼Œbyte æ˜¯ Buffer ä¸­çš„å½“å‰å­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">byte</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºè¯¥å­—èŠ‚çš„å€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœä½ æƒ³è¦æŒ‰ç…§16ä½ï¼ˆ2ä¸ªå­—èŠ‚ï¼‰æˆ–è€…32ä½ï¼ˆ4ä¸ªå­—èŠ‚ï¼‰æ¥å¤„ç†æ•°æ®ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯ä»¥ä½¿ç”¨ TypedArray æˆ–è€… DataViewã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦å¤–ï¼Œå¦‚æœä½ æƒ³é’ˆå¯¹ Buffer ä¸­çš„ä¸€éƒ¨åˆ†æ•°æ®è¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯å•ä¸ªå­—èŠ‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>.slice()</code> æ–¹æ³•æ¥è·å–å­ç¼“å†²åŒºï¼Œç„¶åå¯¹å…¶è¿›è¡Œè¿­ä»£ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å– Buffer çš„ä¸€éƒ¨åˆ†ï¼Œä»ç¬¬10ä¸ªå­—èŠ‚åˆ°ç¬¬20ä¸ªå­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> slice</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> imageBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">slice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// éå†è¿™ä¸ªåˆ‡ç‰‡çš„å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> byte</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> of</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> slice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¤„ç†æ¯ä¸ªå­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ€»ä¹‹ï¼ŒBuffer ç±»å’Œè¿­ä»£å™¨åœ¨ Node.js ä¸­éå¸¸æœ‰ç”¨ï¼Œå°¤å…¶æ˜¯å½“ä½ éœ€è¦å¤„ç†åƒæ–‡ä»¶ I/O è¿™æ ·çš„ä½çº§äºŒè¿›åˆ¶æ•°æ®æ—¶ã€‚ä½ å¯ä»¥è¿­ä»£æ•´ä¸ª Bufferï¼Œä¹Ÿå¯ä»¥åªå¤„ç†å…¶ä¸­çš„ä¸€å°éƒ¨åˆ†ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ JavaScript å¾ªç¯å’Œæ§åˆ¶ç»“æ„æ¥æ“ä½œè¿™äº›æ•°æ®ã€‚</p><h2 id="class-blob" tabindex="-1"><a class="header-anchor" href="#class-blob"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#class-blob" target="_blank" rel="noopener noreferrer">Class: Blob</a></span></a></h2><p>å¥½çš„ï¼Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­çš„ <code>Blob</code> ç±»ï¼Œå¹¶ç»™ä½ ä¸€äº›å®é™…è¿ç”¨çš„ä¾‹å­ã€‚</p><p>åœ¨ Web å¼€å‘ä¸­ï¼Œ<code>Blob</code>ï¼ˆBinary Large Objectï¼‰å¯¹è±¡è¡¨ç¤ºä¸€ä¸ªä¸å¯å˜çš„ã€åŸå§‹æ•°æ®çš„ç±»æ–‡ä»¶å¯¹è±¡ã€‚å®ƒå¸¸å¸¸ç”¨æ¥å¤„ç†æ¯”å¦‚å›¾ç‰‡ã€å£°éŸ³æ–‡ä»¶ç­‰äºŒè¿›åˆ¶å¤§å‹æ•°æ®ã€‚Node.js v21.7.1 å¼•å…¥çš„ <code>Blob</code> ç±»æ˜¯å¯¹è¿™ä¸ªæ¦‚å¿µçš„æœåŠ¡å™¨ç«¯å®ç°ï¼Œæ„å‘³ç€ä½ ç°åœ¨å¯ä»¥åœ¨ Node.js ç¯å¢ƒä¸‹ä¹Ÿä½¿ç”¨ <code>Blob</code> å¯¹è±¡ï¼Œå°±åƒåœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹ä¸€æ ·ã€‚</p><h3 id="åˆ›å»ºä¸€ä¸ª-blob" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºä¸€ä¸ª-blob"><span>åˆ›å»ºä¸€ä¸ª Blob</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Hello, World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> blob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;text/plain&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«æ–‡æœ¬ <code>&quot;Hello, World!&quot;</code> çš„ <code>Blob</code> å¯¹è±¡ï¼Œå¹¶æŒ‡å®šäº† MIME ç±»å‹ä¸º <code>&#39;text/plain&#39;</code>ï¼Œè¿™å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ª <code>Blob</code> åŒ…å«æ™®é€šæ–‡æœ¬å†…å®¹ã€‚</p><h3 id="blob-å±æ€§å’Œæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#blob-å±æ€§å’Œæ–¹æ³•"><span>Blob å±æ€§å’Œæ–¹æ³•</span></a></h3><ul><li><code>size</code>: è¿”å› <code>Blob</code> å¯¹è±¡ä¸­å­˜å‚¨æ•°æ®çš„å¤§å°ï¼ˆå­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚</li><li><code>type</code>: è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨æ˜ <code>Blob</code> å¯¹è±¡æ‰€åŒ…å«æ•°æ®çš„ MIME ç±»å‹ã€‚</li><li><code>text()</code>: è¿”å›ä¸€ä¸ª <code>Promise</code>ï¼Œè¯¥ <code>Promise</code> å°†è§£æä¸ºä¸€ä¸ªåŒ…å« <code>Blob</code> æ•°æ®çš„ UTF-8 æ ¼å¼çš„å­—ç¬¦ä¸²ã€‚</li><li><code>arrayBuffer()</code>: è¿”å›ä¸€ä¸ª <code>Promise</code>ï¼Œè¯¥ <code>Promise</code> å°†è§£æä¸ºä¸€ä¸ª <code>ArrayBuffer</code>ï¼Œè¡¨ç¤º <code>Blob</code> çš„æ•°æ®ã€‚</li></ul><h3 id="è¯»å–-blob-å†…å®¹" tabindex="-1"><a class="header-anchor" href="#è¯»å–-blob-å†…å®¹"><span>è¯»å– Blob å†…å®¹</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: Hello, World!</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬è°ƒç”¨äº† <code>blob.text()</code> æ–¹æ³•æ¥å¼‚æ­¥è·å– <code>Blob</code> ä¸­çš„æ–‡æœ¬å†…å®¹ã€‚å› ä¸ºå®ƒè¿”å›çš„æ˜¯ä¸€ä¸ª <code>Promise</code> å¯¹è±¡ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>.then()</code> æ¥å¤„ç†è¿™ä¸ªå¼‚æ­¥æ“ä½œçš„ç»“æœã€‚</p><h3 id="ä½¿ç”¨-blob-å­˜å‚¨äºŒè¿›åˆ¶æ•°æ®" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-blob-å­˜å‚¨äºŒè¿›åˆ¶æ•°æ®"><span>ä½¿ç”¨ Blob å­˜å‚¨äºŒè¿›åˆ¶æ•°æ®</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€å¼ å›¾ç‰‡çš„äºŒè¿›åˆ¶æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> imageBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path/to/image.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> imageBlob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">imageBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;image/png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å– Blob å¯¹è±¡çš„ ArrayBuffer å¹¶å†™å…¥æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">imageBlob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">arrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path/to/output.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆç”¨ <code>fs.readFile()</code> è¯»å–äº†ä¸€å¼ å›¾ç‰‡åˆ°å†…å­˜ï¼ˆä¸€ä¸ª <code>Buffer</code> å¯¹è±¡ï¼‰ï¼Œç„¶åæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«è¿™æ®µå›¾ç‰‡æ•°æ®çš„ <code>Blob</code> å¯¹è±¡ï¼Œå¹¶ä¸”æŒ‡å®šäº†å®ƒçš„ MIME ç±»å‹ä¸º <code>&#39;image/png&#39;</code>ã€‚æ¥ç€æˆ‘ä»¬é€šè¿‡ <code>imageBlob.arrayBuffer()</code> è·å¾—äº†ä¸€ä¸ª <code>ArrayBuffer</code> è¡¨ç¤ºçš„äºŒè¿›åˆ¶æ•°æ®ï¼Œå¹¶å°†è¿™ä¸ªæ•°æ®å†™å…¥åˆ°ä¸€ä¸ªæ–°æ–‡ä»¶ä¸­ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>Blob</code> ç±»åœ¨ Node.js ä¸­æä¾›äº†ä¸€ç§æ“ä½œå¤§å‹äºŒè¿›åˆ¶æ•°æ®çš„æ‰‹æ®µï¼Œä½¿å¾—ä½ å¯ä»¥åƒåœ¨æµè§ˆå™¨ç«¯é‚£æ ·å¤„ç†æ–‡ä»¶å’ŒäºŒè¿›åˆ¶æ•°æ®ã€‚æ— è®ºæ˜¯æ–‡æœ¬ã€å›¾ç‰‡è¿˜æ˜¯å…¶ä»–ç±»å‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½¿ç”¨ <code>Blob</code> éƒ½èƒ½å¤Ÿæ–¹ä¾¿åœ°è¿›è¡Œè¯»å†™å’Œä¼ è¾“ã€‚</p><h3 id="new-buffer-blob-sources-options" tabindex="-1"><a class="header-anchor" href="#new-buffer-blob-sources-options"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#new-bufferblobsources-options" target="_blank" rel="noopener noreferrer">new buffer.Blob([sources[, options]])</a></span></a></h3><p>Node.js ä¸­çš„ <code>buffer.Blob</code> æ˜¯ä¸€ä¸ªå…¨å±€çš„æ„é€ å‡½æ•°ï¼Œç”¨äºåˆ›å»ºè¡¨ç¤ºä¸€ä¸ªä¸å¯å˜çš„æ•°æ®å—çš„ Blob å¯¹è±¡ã€‚Blob å¯¹è±¡é€šå¸¸ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¯”å¦‚ä½ å¯ä»¥åœ¨æ–‡ä»¶ I/O æ“ä½œä¸­ä½¿ç”¨ Blob æ¥è¯»å–æˆ–å†™å…¥æ–‡ä»¶å†…å®¹ã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>buffer.Blob</code> çš„æ„é€ å‡½æ•°å…è®¸ä½ é€šè¿‡ä¼ å…¥ä¸€ä¸ªæ•°ç»„ï¼ˆè¿™ä¸ªæ•°ç»„å«åš <code>sources</code>ï¼‰æ¥åˆ›å»ºä¸€ä¸ª Blob å®ä¾‹ã€‚ä½ å¯ä»¥æŠŠä»»ä½•ç±»å‹çš„æ•°æ®æ”¾åˆ°è¿™ä¸ªæ•°ç»„é‡Œï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ã€Buffer å¯¹è±¡ã€æˆ–è€…å…¶ä»– Blob å¯¹è±¡ç­‰ã€‚</p><p>è¿™é‡Œæ˜¯å…·ä½“çš„ä½¿ç”¨æ–¹æ³•ï¼š</p><h3 id="æ„é€ å‡½æ•°" tabindex="-1"><a class="header-anchor" href="#æ„é€ å‡½æ•°"><span>æ„é€ å‡½æ•°ï¼š</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">sources</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>sources</code>: è¿™æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†å°†è¦å­˜å‚¨åœ¨ Blob ä¸­çš„æ•°æ®ã€‚æ•°ç»„é‡Œçš„å…ƒç´ å¯ä»¥æ˜¯ ArrayBufferã€TypedArrayã€DataViewã€Bufferã€Blob æˆ–è€…å­—ç¬¦ä¸²ç­‰ã€‚</li><li><code>options</code>: ä¸€ä¸ªå¯é€‰çš„å¯¹è±¡ï¼ŒåŒ…å«äº†é¢å¤–çš„é…ç½®é€‰é¡¹ã€‚ç›®å‰å”¯ä¸€æ”¯æŒçš„å±æ€§æ˜¯ <code>type</code>ï¼Œå®ƒä»£è¡¨ Blob æ•°æ®çš„ MIME ç±»å‹ï¼Œé»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²ã€‚</li></ul><h3 id="ä½¿ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹"><span>ä½¿ç”¨ç¤ºä¾‹ï¼š</span></a></h3><p>å‡è®¾ä½ æƒ³è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ–‡æœ¬æ•°æ®çš„ Blobã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«çº¯æ–‡æœ¬ &quot;Hello World&quot; çš„ Blob</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> blob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;text/plain&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Blob { [Symbol(type)]: &#39;text/plain&#39;, [Symbol(size)]: 11 }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªå®ä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«æ–‡æœ¬ <code>&quot;Hello World&quot;</code> çš„ Blobï¼Œå¹¶æŒ‡å®šäº† MIME ç±»å‹ä¸º <code>text/plain</code>ã€‚Blob å¯¹è±¡åˆ›å»ºåï¼Œä½ å¯ä»¥ç”¨å®ƒè¿›è¡Œè¿›ä¸€æ­¥çš„æ“ä½œï¼Œæ¯”å¦‚å°†å…¶å†™å…¥æ–‡ä»¶ã€‚</p><p>ç°åœ¨ï¼Œå‡è®¾ä½ éœ€è¦å¤„ç†å›¾ç‰‡æ•°æ®ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶çš„ Buffer æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> imageBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path/to/image.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨æˆ‘ä»¬ç”¨è¿™ä¸ª Buffer æ•°æ®åˆ›å»ºä¸€ä¸ª Blob</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> imageBlob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">imageBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;image/png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Blob å¯¹è±¡åˆ›å»ºå¥½åï¼Œå¯ä»¥ç”¨äºå„ç§éœ€è¦äºŒè¿›åˆ¶æ•°æ®çš„åœºæ™¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">imageBlob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Blob { [Symbol(type)]: &#39;image/png&#39;, [Symbol(size)]: å›¾ç‰‡å¤§å° }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä»æ–‡ä»¶ç³»ç»Ÿè¯»å–äº†ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶ï¼Œå¾—åˆ°äº†ä¸€ä¸ª Buffer å¯¹è±¡ï¼Œç„¶åæˆ‘ä»¬ç”¨è¿™ä¸ª Buffer å¯¹è±¡åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ Blobï¼ŒæŒ‡å®šäº† MIME ç±»å‹ä¸º <code>image/png</code>ã€‚</p><p>æ€»ç»“èµ·æ¥ï¼Œ<code>buffer.Blob</code> åœ¨ Node.js ä¸­çš„ä¸»è¦ä½œç”¨æ˜¯æä¾›ä¸€ç§æ–¹å¼æ¥å¤„ç†å’Œå°è£…äºŒè¿›åˆ¶æ•°æ®ã€‚ä½ å¯ä»¥åˆ©ç”¨ Blob å¯¹è±¡æ¥è¿›è¡Œæ–‡ä»¶æ“ä½œã€ç½‘ç»œä¼ è¾“ã€æˆ–è€…æ˜¯ä»»ä½•éœ€è¦å¤„ç†åŸå§‹æ•°æ®çš„åœ°æ–¹ã€‚</p><h3 id="blob-arraybuffer" tabindex="-1"><a class="header-anchor" href="#blob-arraybuffer"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#blobarraybuffer" target="_blank" rel="noopener noreferrer">blob.arrayBuffer()</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>blob.arrayBuffer()</code>æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨æ¥å°†ä¸€ä¸ª<code>Blob</code>å¯¹è±¡çš„æ•°æ®è½¬æ¢æˆ<code>ArrayBuffer</code>ã€‚<code>Blob</code>ï¼ˆBinary Large Objectï¼‰å¯¹è±¡é€šå¸¸ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼Œè€Œ<code>ArrayBuffer</code>æ˜¯ä¸€ç§è¡¨ç¤ºé€šç”¨çš„ã€å›ºå®šé•¿åº¦çš„åŸå§‹äºŒè¿›åˆ¶æ•°æ®ç¼“å†²åŒºçš„å¯¹è±¡ã€‚ä½ å¯ä»¥æŠŠ<code>ArrayBuffer</code>æƒ³è±¡æˆä¸€ä¸ªåŸå§‹çš„å†…å­˜åŒºåŸŸï¼ŒJavaScript å¯ä»¥é€šè¿‡è§†å›¾ï¼ˆå¦‚<code>Uint8Array</code>æˆ–<code>Float32Array</code>ï¼‰æ¥æ“ä½œè¿™å—å†…å­˜ä¸­çš„æ•°æ®ã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ä½¿ç”¨<code>blob.arrayBuffer()</code>çš„åŸºæœ¬æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>é¦–å…ˆåˆ›å»ºä¸€ä¸ª Blob å®ä¾‹ï¼ŒåŒ…å«äº†ä¸€äº›äºŒè¿›åˆ¶æ•°æ®ã€‚</li><li>ç„¶åè°ƒç”¨è¯¥ Blob å®ä¾‹çš„<code>.arrayBuffer()</code>æ–¹æ³•ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ª Promiseã€‚</li><li>é€šè¿‡è¿™ä¸ª Promiseï¼Œä½ å¯ä»¥å¾—åˆ°ä¸€ä¸ª<code>ArrayBuffer</code>å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åŒ…å«äº† Blob ä¸­çš„äºŒè¿›åˆ¶æ•°æ®ã€‚</li></ol><p>è¿™é‡Œæœ‰ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€äº›äºŒè¿›åˆ¶æ•°æ®ï¼Œè¿™é‡Œä½¿ç”¨æ–‡æœ¬å­—ç¬¦ä¸²æ¥åˆ›å»ºä¸€ä¸ªç¤ºä¾‹Blobå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> blob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hello world&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;text/plain&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨.blob.arrayBuffer()æ–¹æ³•å°†Blobå¯¹è±¡è½¬æ¢ä¸ºArrayBuffer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">arrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">arrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ­¤æ—¶æˆ‘ä»¬è·å¾—äº†è¿™ä¸ªæ–‡æœ¬æ•°æ®çš„ArrayBufferè¡¨ç¤ºå½¢å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">arrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¦‚æœéœ€è¦ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªTypedArrayæ¥è¯»å–æˆ–è€…ä¿®æ”¹è¿™äº›æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> uint8Array</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Uint8Array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">arrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">uint8Array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†æ˜¾ç¤ºæ–‡æœ¬çš„UTF-8å­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œé¦–å…ˆä½¿ç”¨ä¸€æ®µæ–‡æœ¬æ•°æ®åˆ›å»ºäº†ä¸€ä¸ª<code>Blob</code>å¯¹è±¡ï¼Œç„¶åè°ƒç”¨<code>.arrayBuffer()</code>æ–¹æ³•æ¥è·å–è¿™æ®µæ–‡æœ¬çš„äºŒè¿›åˆ¶è¡¨ç¤ºã€‚<code>.arrayBuffer()</code>æ–¹æ³•è¿”å›ä¸€ä¸ª Promiseï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨<code>.then()</code>æ¥å¤„ç†å¼‚æ­¥ç»“æœã€‚å½“ Promise è§£å†³å®Œæˆåï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¿é—®è¿™æ®µæ–‡æœ¬çš„<code>ArrayBuffer</code>è¡¨ç¤ºã€‚</p><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½ä¼šåœ¨å¤„ç†æ–‡ä»¶ä¸Šä¼ ã€ç½‘ç»œé€šä¿¡æˆ–æ˜¯ä»»ä½•æ¶‰åŠåˆ°å¤§é‡äºŒè¿›åˆ¶æ•°æ®å¤„ç†çš„åœºæ™¯ä¸­ä½¿ç”¨<code>blob.arrayBuffer()</code>ã€‚ä¾‹å¦‚ï¼Œåœ¨ä»ç½‘ç»œä¸Šä¸‹è½½å›¾ç‰‡æˆ–éŸ³è§†é¢‘æ–‡ä»¶æ—¶ï¼Œä½ å¯èƒ½ä¼šé¦–å…ˆæ”¶åˆ°ä¸€ä¸ª<code>Blob</code>ï¼Œç„¶åéœ€è¦å°†å…¶è½¬æ¢ä¸º<code>ArrayBuffer</code>ä»¥ä¾¿è¿›ä¸€æ­¥å¤„ç†ï¼Œæ¯”å¦‚ä¿å­˜åˆ°ç£ç›˜ã€è¿›è¡ŒäºŒè¿›åˆ¶åˆ†ææˆ–è€…ä½œä¸º WebGL çº¹ç†ç­‰ã€‚</p><h3 id="blob-size" tabindex="-1"><a class="header-anchor" href="#blob-size"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#blobsize" target="_blank" rel="noopener noreferrer">blob.size</a></span></a></h3><p>Node.js çš„ <code>blob.size</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå®ƒå±äº <code>Blob</code> å¯¹è±¡ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>Blob</code> å¯¹è±¡ç”¨äºè¡¨ç¤ºä¸å¯å˜çš„æ•°æ®å—ï¼Œå®ƒä»¬é€šå¸¸ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚<code>Blob</code> å¯¹è±¡ç”±åŸå§‹æ•°æ®å’Œæœ‰å…³è¯¥æ•°æ®ç±»å‹ï¼ˆMIME ç±»å‹ï¼‰çš„ä¿¡æ¯ç»„æˆã€‚</p><p><code>blob.size</code> å±æ€§è¿”å› <code>Blob</code> å¯¹è±¡ä¸­åŒ…å«çš„æ•°æ®çš„å¤§å°ï¼Œå•ä½æ˜¯å­—èŠ‚ï¼ˆbytesï¼‰ã€‚è¿™ä¸ªå±æ€§å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸ä½ äº†è§£æ­£åœ¨å¤„ç†çš„æ•°æ®å—æœ‰å¤šå¤§ï¼Œè¿™å¯¹äºèµ„æºç®¡ç†å’Œæ€§èƒ½ä¼˜åŒ–éå¸¸é‡è¦ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ä½¿ç”¨ <code>blob.size</code> çš„ä¾‹å­ï¼š</p><p>å‡è®¾æˆ‘ä»¬æƒ³è¦å¤„ç†ä¸€äº›ä»æ–‡ä»¶æˆ–ç½‘ç»œæ”¶åˆ°çš„å›¾åƒæ•°æ®ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>Blob</code> å¯¹è±¡æ¥è¡¨ç¤ºè¿™äº›å›¾åƒæ•°æ®ï¼Œå¹¶ä½¿ç”¨ <code>blob.size</code> æ¥è·å–è¿™äº›å›¾åƒæ•°æ®çš„å¤§å°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬å·²ç»ä»¥æŸç§æ–¹å¼è·å¾—äº†å›¾åƒæ•°æ®ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥åˆ›å»ºä¸€ä¸ªç¤ºä¾‹æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> imageData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x89</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x50</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x4e</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x47</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x0d</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x0a</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x1a</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x0a</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™æ˜¯ä¸€ä¸ªæå°çš„PNGå›¾åƒæ•°æ®çš„å¼€å§‹</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨è¿™äº›æ•°æ®åˆ›å»ºä¸€ä¸ª Blob å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> imageBlob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">imageData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;image/png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ blob.size æ¥è·å–è¿™ä¸ªå›¾åƒ Blob çš„å¤§å°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">imageBlob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†è¾“å‡º imageData çš„å­—èŠ‚å¤§å°</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥ Node.js çš„ <code>buffer</code> æ¨¡å—ä¸­çš„ <code>Blob</code> ç±»ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«å›¾åƒæ•°æ®çš„ <code>Buffer</code> å®ä¾‹ï¼Œå¹¶ç”¨å®ƒæ¥åˆ›å»ºä¸€ä¸ª <code>Blob</code> å®ä¾‹ã€‚è®¾ç½® MIME ç±»å‹ä¸º <code>&#39;image/png&#39;</code> è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª PNG å›¾åƒã€‚æœ€åï¼Œæˆ‘ä»¬é€šè¿‡æ‰“å° <code>imageBlob.size</code> è·å–å¹¶æ˜¾ç¤ºäº†è¿™ä¸ª <code>Blob</code> å¯¹è±¡çš„å¤§å°ã€‚</p><p>å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½ä¼šä»æ–‡ä»¶ç³»ç»Ÿä¸­è¯»å–æ–‡ä»¶æˆ–è€…ä»ç½‘ç»œè¯·æ±‚ä¸­æ¥æ”¶æ•°æ®ï¼Œç„¶åå°†æ”¶åˆ°çš„æ•°æ®è½¬æ¢ä¸º <code>Blob</code> å¯¹è±¡ã€‚äº†è§£ <code>Blob</code> çš„å¤§å°æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œæ¯”å¦‚ï¼Œä½ å¯èƒ½éœ€è¦ç¡®ä¿æ–‡ä»¶ä¸è¶…è¿‡ç‰¹å®šå¤§å°é™åˆ¶ï¼Œæˆ–è€…éœ€è¦æ ¹æ®æ–‡ä»¶å¤§å°è°ƒæ•´ç¨‹åºé€»è¾‘ï¼ˆä¾‹å¦‚ï¼Œé€‰æ‹©ä¸åŒçš„ä¸Šä¼ ç­–ç•¥ï¼‰ã€‚</p><h3 id="blob-slice-start-end-type" tabindex="-1"><a class="header-anchor" href="#blob-slice-start-end-type"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#blobslicestart-end-type" target="_blank" rel="noopener noreferrer">blob.slice([start[, end[, type]]])</a></span></a></h3><p>å½“ä½ çœ‹åˆ°è¿™ä¸ª<code>blob.slice([start[, end[, type]]])</code>ï¼Œä½ å¯èƒ½ä¼šæ„Ÿåˆ°æœ‰ç‚¹å›°æƒ‘ï¼Œä½†åˆ«æ‹…å¿ƒï¼Œè®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥è§£é‡Šè¿™ä¸ªæ–¹æ³•ï¼Œä»¥åŠå®ƒåœ¨ Node.js ä¸­çš„åº”ç”¨ã€‚</p><p>é¦–å…ˆï¼Œä¸€ä¸ª<code>Blob</code>ï¼ˆBinary Large OBjectï¼‰æ˜¯ä»£è¡¨ä¸€å¤§å—äºŒè¿›åˆ¶æ•°æ®çš„å¯¹è±¡ã€‚åœ¨ Node.js ä¸­ï¼ŒBlob é€šå¸¸ç”¨äºå¤„ç†å¤§é‡çš„æ•°æ®ï¼Œæ¯”å¦‚å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰ã€‚ä½†æ˜¯ï¼Œåœ¨ Web æµè§ˆå™¨ç¯å¢ƒä¸­ï¼ŒBlob æ›´ä¸ºå¸¸è§ï¼Œè€Œåœ¨ Node.js ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ Buffer å¯¹è±¡æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚ä¸è¿‡åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒBlob ä¹Ÿå¯ä»¥åœ¨ Node.js ä¸­ä½¿ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨ç›¸å®¹æ€§å’Œäº¤äº’æ€§éœ€è¦æ—¶ã€‚</p><p>ç°åœ¨ï¼Œæ¥è®²è®²ä»€ä¹ˆæ˜¯<code>slice</code>æ–¹æ³•ã€‚<code>slice</code>æ–¹æ³•èƒ½å¤Ÿä»ä¸€ä¸ª Blob æˆ– Buffer å¯¹è±¡ä¸­æå–å‡ºç‰¹å®šéƒ¨åˆ†çš„æ•°æ®ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªæ–°çš„ Blob æˆ– Buffer å¯¹è±¡ã€‚è¿™ä¸ªæ–¹æ³•éå¸¸é€‚åˆäºä½ åªéœ€è¦æ“ä½œæˆ–è€…ä½¿ç”¨åŸå§‹æ•°æ®çš„ä¸€å°éƒ¨åˆ†æƒ…æ™¯ã€‚</p><p>è¿™é‡Œé¢çš„å‚æ•°æ„ä¹‰å¦‚ä¸‹ï¼š</p><ul><li><code>start</code>ï¼šå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºè¦æå–æ•°æ®å¼€å§‹çš„ä½ç½®ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œé»˜è®¤ä» 0 å¼€å§‹ã€‚</li><li><code>end</code>ï¼šå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºè¦æå–æ•°æ®ç»“æŸçš„ä½ç½®ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œé»˜è®¤åˆ° Blob æˆ– Buffer çš„æœ«å°¾ã€‚</li><li><code>type</code>ï¼šå¯é€‰å‚æ•°ï¼Œä¸»è¦ç”¨åœ¨ Blob å¯¹è±¡ä¸Šï¼Œè¡¨ç¤ºæ–° Blob çš„ MIME ç±»å‹ã€‚åœ¨ Buffer ä¸Šè¿™ä¸ªå‚æ•°æ— æ•ˆã€‚</li></ul><p>è®©æˆ‘ä»¬é€šè¿‡å‡ ä¸ªä¾‹å­æ¥ç†è§£è¿™ä¸ªæ–¹æ³•çš„å®é™…åº”ç”¨ï¼š</p><h3 id="ä¾‹å­-1-æå–-buffer-çš„ä¸€éƒ¨åˆ†" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-æå–-buffer-çš„ä¸€éƒ¨åˆ†"><span>ä¾‹å­ 1: æå– Buffer çš„ä¸€éƒ¨åˆ†</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªè¡¨ç¤ºå›¾ç‰‡çš„ Buffer å¯¹è±¡ï¼Œä½ æƒ³è¦è·å–å‰ 100 ä¸ªå­—èŠ‚çš„æ•°æ®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ æœ‰ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶image.png</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> imageBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;image.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨æˆ‘ä»¬æƒ³è¦è·å–è¿™ä¸ªå›¾ç‰‡çš„å‰100ä¸ªå­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> slicedBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> imageBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">slice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// slicedBufferç°åœ¨å°±æ˜¯ä¸€ä¸ªåŒ…å«å‰100ä¸ªå­—èŠ‚çš„æ–°Bufferå¯¹è±¡ï¼Œä½ å¯ä»¥å¯¹å®ƒè¿›è¡Œæ“ä½œ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä¾‹å­-2-å¤åˆ¶æ•´ä¸ª-buffer" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-å¤åˆ¶æ•´ä¸ª-buffer"><span>ä¾‹å­ 2: å¤åˆ¶æ•´ä¸ª Buffer</span></a></h3><p>å¦‚æœä½ æƒ³å¤åˆ¶æ•´ä¸ª Buffer å¯¹è±¡ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆä¸€æ¬¡è¯»å–åŒä¸€å¼ å›¾ç‰‡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> imageBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;image.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨sliceæ–¹æ³•è€Œä¸ä¼ ä»»ä½•å‚æ•°é»˜è®¤å¤åˆ¶æ•´ä¸ªBuffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> copiedBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> imageBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">slice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// copiedBufferæ˜¯ä¸€ä¸ªæ–°çš„Bufferï¼Œå®ƒå’ŒimageBufferæœ‰ç›¸åŒçš„å†…å®¹</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä¾‹å­-3-ä»-blob-å¯¹è±¡ä¸­æå–æ•°æ®" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-3-ä»-blob-å¯¹è±¡ä¸­æå–æ•°æ®"><span>ä¾‹å­ 3: ä» Blob å¯¹è±¡ä¸­æå–æ•°æ®</span></a></h3><p>è™½ç„¶åœ¨ Node.js ä¸­ä¸å¸¸è§ï¼Œä½†å¦‚æœä½ æ­£åœ¨å¤„ç† Blob å¯¹è±¡å¹¶å¸Œæœ›æå–éƒ¨åˆ†æ•°æ®ï¼Œå®ƒä¹Ÿå¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ å¾—åˆ°äº†ä¸€ä¸ªBlobå¯¹è±¡ï¼Œå¯èƒ½æ˜¯ä»æŸä¸ªAPIæˆ–å…¶ä»–æ¥æº</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> someBlob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getSomeBlobFromSomewhere</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™ä¸ªå‡½æ•°æ˜¯å‡è®¾çš„</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ æƒ³è·å–è¿™ä¸ªBlobçš„ç¬¬100åˆ°200å­—èŠ‚ä¹‹é—´çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> slicedBlob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> someBlob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">slice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// slicedBlobç°åœ¨æ˜¯ä¸€ä¸ªæ–°çš„Blobå¯¹è±¡ï¼ŒåªåŒ…å«æŒ‡å®šèŒƒå›´çš„æ•°æ®</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼šåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>getSomeBlobFromSomewhere()</code>å‡½æ•°æ˜¯å‡è®¾çš„ï¼Œå› ä¸ºåœ¨ Node.js ä¸­è·å– Blob å¯¹è±¡å¯èƒ½æ¥è‡ªäºä¸åŒçš„æ¥æºï¼Œä¾‹å¦‚ HTTP å“åº”ã€æ–‡ä»¶ç³»ç»Ÿæ“ä½œæˆ–è€…æ˜¯è½¬æ¢è‡ªå…¶ä»–æ ¼å¼çš„ Buffer å¯¹è±¡ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>slice</code>æ–¹æ³•æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§ä¸”çµæ´»çš„å·¥å…·ï¼Œå®ƒå…è®¸ä½ åœ¨å¤„ç†å¤§å‹äºŒè¿›åˆ¶æ•°æ®æ—¶åªå…³æ³¨å’Œä½¿ç”¨ä½ æ‰€éœ€çš„éƒ¨åˆ†ï¼Œè¿™å¯ä»¥å¸®åŠ©èŠ‚çœå†…å­˜å’Œæé«˜ç¨‹åºçš„æ•ˆç‡ã€‚</p><h3 id="blob-stream" tabindex="-1"><a class="header-anchor" href="#blob-stream"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#blobstream" target="_blank" rel="noopener noreferrer">blob.stream()</a></span></a></h3><p>Node.js ä¸­çš„ <code>Blob</code> å¯¹è±¡è¡¨ç¤ºä¸å¯å˜çš„åŸå§‹æ•°æ®ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ªå¤§æ–‡ä»¶ï¼Œä¾‹å¦‚ä¸€æ®µè§†é¢‘æˆ–è€…ä¸€ä¸ªå¤§å‹çš„å›¾åƒæ–‡ä»¶ï¼Œè€Œä½ æƒ³åœ¨å¤„ç†è¿™ä¸ªæ–‡ä»¶æ—¶ä¸éœ€è¦ä¸€æ¬¡æ€§åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œä»¥é¿å…å ç”¨è¿‡å¤šèµ„æºã€‚è¿™å°±æ˜¯ <code>Blob</code> å¯ä»¥å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚</p><h3 id="blob-stream-1" tabindex="-1"><a class="header-anchor" href="#blob-stream-1"><span><code>blob.stream()</code></span></a></h3><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>Blob</code> å¯¹è±¡çš„ <code>stream()</code> æ–¹æ³•å¯ä»¥åˆ›å»ºä¸€ä¸ª <code>ReadableStream</code>ï¼Œå®ƒå…è®¸ä½ æŒ‰éœ€è¯»å– <code>Blob</code> æ•°æ®çš„å†…å®¹ï¼Œå°±åƒä»ç®¡é“ä¸­ä¸€ç‚¹ä¸€ç‚¹å–æ°´ä¸€æ ·ã€‚å½“ä½ è°ƒç”¨ <code>blob.stream()</code> æ—¶ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªæµï¼Œè¿™ä¸ªæµä¼šè¾“å‡º <code>Blob</code> ä¸­çš„æ•°æ®ç‰‡æ®µï¼ˆç§°ä¸ºâ€œchunksâ€ï¼‰ã€‚</p><h4 id="å®é™…åº”ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h4><p><strong>ä¾‹å­ 1: é€å—å¤„ç†å¤§æ–‡æœ¬æ–‡ä»¶</strong></p><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªéå¸¸å¤§çš„æ–‡æœ¬æ–‡ä»¶ï¼Œä½ æƒ³é€è¡Œå¤„ç†å®ƒã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> processLargeText</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åˆ›å»ºä¸€ä¸ªå¯è¯»æµ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> stream</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">stream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä½¿ç”¨æµå¼å¤„ç†é€å—å¤„ç†æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  for</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> chunk</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> of</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> stream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å‡è®¾æ¯ä¸ªchunkéƒ½æ˜¯å®Œæ•´çš„æ–‡æœ¬è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å¤„ç†æ–‡æœ¬è¡Œ:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ å·²ç»æœ‰äº†ä¸€ä¸ªä»£è¡¨å¤§æ–‡ä»¶çš„Blobå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bigTextBlob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hello</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">world</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">this</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">is</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">a</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">test</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">processLargeText</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bigTextBlob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä¾‹å­ 2: å°†è§†é¢‘æ–‡ä»¶å‘é€åˆ°å®¢æˆ·ç«¯</strong></p><p>å¦‚æœä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª web æœåŠ¡ï¼Œå¹¶å¸Œæœ›æŒ‰éœ€å°†è§†é¢‘æ•°æ®å‘é€åˆ°å®¢æˆ·ç«¯ï¼ˆæ¯”å¦‚æµè§ˆå™¨ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ <code>blob.stream()</code> æ¥å®ç°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;buffer&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;http&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">http</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾ä½ å·²ç»ä»æŸå¤„è·å–äº†è§†é¢‘å†…å®¹çš„Blob</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> videoBlob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œçš„...åº”è¯¥æ˜¯è§†é¢‘æ–‡ä»¶çš„äºŒè¿›åˆ¶æ•°æ®</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è®¾ç½®å“åº”å¤´éƒ¨ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯å†…å®¹ç±»å‹æ˜¯è§†é¢‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeHead</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &#39;Content-Type&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;video/mp4&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è·å–è§†é¢‘æ•°æ®çš„æµ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> stream</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> videoBlob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">stream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ç›´æ¥å°†æµå†™å…¥HTTPå“åº”å¯¹è±¡ä¸­</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // Node.jsä¼šè‡ªåŠ¨ç®¡ç†æµçš„ç”Ÿå‘½å‘¨æœŸå’Œé”™è¯¯å¤„ç†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  stream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">pipe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒæœåŠ¡å™¨é€šè¿‡ä¸€ä¸ª HTTP è¯·æ±‚å°†è§†é¢‘æ–‡ä»¶ä»¥æµçš„å½¢å¼å‘é€ç»™è¯·æ±‚çš„å®¢æˆ·ç«¯ã€‚è¿™æ„å‘³ç€å®¢æˆ·ç«¯å¯ä»¥å¼€å§‹æ¥æ”¶å’Œæ’­æ”¾è§†é¢‘æ•°æ®ï¼Œå³ä½¿æœåŠ¡å™¨è¿˜æ²¡æœ‰å‘é€å®Œæ•´ä¸ªè§†é¢‘æ–‡ä»¶ã€‚</p><p>è¿™äº›ä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>Blob</code> å¯¹è±¡çš„ <code>stream()</code> æ–¹æ³•æ¥æœ‰æ•ˆåœ°å¤„ç†å¤§æ•°æ®å—ï¼Œæ— è®ºæ˜¯åœ¨åç«¯å¤„ç†å¤§æ–‡ä»¶ï¼Œè¿˜æ˜¯åœ¨ç½‘ç»œä¸ŠæŒ‰éœ€ä¼ è¾“æ•°æ®ã€‚</p><h3 id="blob-text" tabindex="-1"><a class="header-anchor" href="#blob-text"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#blobtext" target="_blank" rel="noopener noreferrer">blob.text()</a></span></a></h3><p>Node.js ä¸­çš„ <code>blob.text()</code> æ–¹æ³•æ˜¯ç”¨æ¥ä» <code>Blob</code> å¯¹è±¡ä¸­è¯»å–æ–‡æœ¬å†…å®¹çš„ä¸€ç§æ–¹æ³•ã€‚åœ¨ Node.js é‡Œï¼Œä¸€ä¸ª <code>Blob</code> å¯¹è±¡é€šå¸¸æ˜¯ç”¨æ¥è¡¨ç¤ºäºŒè¿›åˆ¶æ•°æ®çš„ï¼Œå¯èƒ½æ˜¯æ–‡ä»¶æ•°æ®ã€å›¾ç‰‡æˆ–è€…å…¶ä»–å½¢å¼çš„åª’ä½“å†…å®¹ã€‚å½“è¿™ä¸ªäºŒè¿›åˆ¶æ•°æ®å®é™…ä¸Šæ˜¯æ–‡æœ¬æ—¶ï¼Œä½ å¯èƒ½æƒ³è¦å°†å®ƒè½¬æ¢æˆå­—ç¬¦ä¸²å½¢å¼ä»¥ä¾¿å¤„ç†ã€‚</p><h3 id="blob-æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#blob-æ˜¯ä»€ä¹ˆ"><span>Blob æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h3><p>é¦–å…ˆï¼Œ<code>Blob</code>ï¼ˆBinary Large Objectï¼‰å¯¹è±¡ä»£è¡¨äº†ä¸€å¤§å—å¯ä»¥æŒ‰éœ€è¯»å–çš„äºŒè¿›åˆ¶æ•°æ®ã€‚åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ï¼Œ<code>Blob</code> é€šå¸¸è¢«ç”¨æ¥å¤„ç†æ–‡ä»¶ä¸Šä¼ æˆ–ä¸‹è½½æ“ä½œï¼Œå¯ä»¥è¡¨ç¤ºå›¾ç‰‡ã€è§†é¢‘ç­‰å¤šåª’ä½“å†…å®¹ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>Blob</code> åŒæ ·å¯ç”¨äºå¤„ç†å¤§é‡çš„äºŒè¿›åˆ¶æ•°æ®ã€‚</p><h3 id="blob-text-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#blob-text-æ–¹æ³•"><span>blob.text() æ–¹æ³•</span></a></h3><p><code>blob.text()</code> æ–¹æ³•æ˜¯ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ï¼Œå®ƒè¿”å›ä¸€ä¸ª Promiseï¼ŒPromise è§£å†³åæä¾›ä¸€ä¸ªåŒ…å« <code>Blob</code> æ•°æ®çš„å­—ç¬¦ä¸²å½¢å¼ã€‚æ­¤æ–¹æ³•éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸ä½ æ–¹ä¾¿åœ°å°†äºŒè¿›åˆ¶æ•°æ®è½¬æ¢ä¸ºæ–‡æœ¬ï¼Œå¹¶ä»¥å­—ç¬¦ä¸²çš„å½¢å¼åœ¨ä½ çš„ç¨‹åºä¸­ä½¿ç”¨ã€‚</p><h3 id="ä½¿ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­"><span>ä½¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ª <code>Blob</code> å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†ä¸€äº›æ–‡æœ¬æ•°æ®ï¼Œä¾‹å¦‚ä»ç”¨æˆ·ä¸Šä¼ çš„æ–‡æœ¬æ–‡ä»¶ä¸­è¯»å–å‡ºæ¥çš„å†…å®¹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä»æŸå¤„è·å–åˆ°çš„ Blob å¯¹è±¡ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥åˆ›å»ºä¸€ä¸ªåŒ…å«æ–‡æœ¬çš„ Blob</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> blob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, world!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;text/plain&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ blob.text() æ–¹æ³•è¯»å–æ–‡æœ¬å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">blob</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: Hello, world!</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Error reading the blob content:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ol><li>æˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† <code>buffer</code> æ¨¡å—ä¸­çš„ <code>Blob</code> ç±»ã€‚</li><li>ç„¶ååˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„ <code>Blob</code> å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº† <code>&#39;Hello, world!&#39;</code> è¿™æ®µæ–‡æœ¬å†…å®¹ã€‚</li><li>æ¥ä¸‹æ¥è°ƒç”¨äº† <code>blob.text()</code> æ–¹æ³•æ¥å¼‚æ­¥è·å– <code>Blob</code> ä¸­çš„æ–‡æœ¬ã€‚</li><li><code>blob.text()</code> è¿”å›ä¸€ä¸ª Promiseï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ <code>.then()</code> æ¥å¤„ç†æˆåŠŸçš„æƒ…å†µï¼Œåœ¨è¿™é‡Œæ‰“å°å‡º <code>Blob</code> åŒ…å«çš„æ–‡æœ¬ã€‚</li><li>å¦‚æœæœ‰ä»»ä½•é”™è¯¯å‘ç”Ÿï¼Œ<code>.catch()</code> å°†æ•è·è¿™äº›å¼‚å¸¸ï¼Œå¹¶å…è®¸æˆ‘ä»¬å¤„ç†å®ƒä»¬ã€‚</li></ol><p>è¿™å°±æ˜¯å¦‚ä½•ä½¿ç”¨ <code>blob.text()</code> æ–¹æ³•æ¥å°† <code>Blob</code> å¯¹è±¡ä¸­çš„äºŒè¿›åˆ¶æ•°æ®è½¬åŒ–ä¸ºæ–‡æœ¬å†…å®¹å¹¶è¿›è¡Œå¤„ç†çš„è¿‡ç¨‹ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°éœ€è¦å¤„ç†æ¥è‡ªç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å†™ç­‰æ¥æºçš„ <code>Blob</code> æ•°æ®ï¼Œè€Œ <code>blob.text()</code> å°±æ˜¯ä¸€ä¸ªç”¨äºè·å–å…¶æ–‡æœ¬å½¢å¼çš„å®ç”¨å·¥å…·ã€‚</p><h3 id="blob-type" tabindex="-1"><a class="header-anchor" href="#blob-type"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#blobtype" target="_blank" rel="noopener noreferrer">blob.type</a></span></a></h3><p><code>blob.type</code> æ˜¯ Node.js ä¸­ Blob å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒè¿”å›äº†è¯¥ Blob å¯¹è±¡è¡¨ç¤ºçš„æ•°æ®çš„ MIME ç±»å‹ã€‚MIME ç±»å‹æ˜¯ä¸€ç§æ ‡å‡†ï¼Œç”¨æ¥è¡¨ç¤ºæ–‡æ¡£ã€æ–‡ä»¶æˆ–å­—èŠ‚æµçš„æ€§è´¨å’Œæ ¼å¼ã€‚ä¾‹å¦‚ï¼ŒHTML æ–‡æ¡£å¯ä»¥æ˜¯ <code>text/html</code>ï¼ŒJPEG å›¾ç‰‡å¯ä»¥æ˜¯ <code>image/jpeg</code>ï¼Œè€Œçº¯æ–‡æœ¬æ–‡ä»¶åˆ™å¯ä»¥æ˜¯ <code>text/plain</code>ã€‚</p><p>åœ¨ Node.js ä¸­ï¼ŒBlob å¯¹è±¡é€šå¸¸ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¯”å¦‚ä½ å¯èƒ½ä¼šä»ç½‘ç»œä¸Šä¸‹è½½å›¾ç‰‡æˆ–è€…å…¶ä»–ç±»å‹çš„æ–‡ä»¶ï¼Œç„¶åå°†å…¶ä½œä¸º Blob å¯¹è±¡è¿›è¡Œå¤„ç†ã€‚</p><p>ä»¥ä¸‹æ˜¯ä½¿ç”¨ Node.js å®ç° Blob å¹¶è·å–å…¶ MIME ç±»å‹çš„ç®€å•ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€äº›äºŒè¿›åˆ¶æ•°æ®ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥ç”¨å­—ç¬¦ä¸²ä»£æ›¿</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> binaryData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Hello, world!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ–°çš„ Blob å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> blob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">binaryData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;text/plain&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–å¹¶æ‰“å°å‡º Blob å¯¹è±¡çš„ MIME ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼štext/plain</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† Node.js çš„ <code>buffer</code> æ¨¡å—ä¸­çš„ <code>Blob</code> ç±»ã€‚ç„¶ååˆ›å»ºäº†ä¸€ä¸ªåŒ…å«å­—ç¬¦ä¸² <code>&#39;Hello, world!&#39;</code> çš„ Blob å¯¹è±¡ï¼Œå¹¶æŒ‡å®šäº†å…¶ MIME ç±»å‹ä¸º <code>text/plain</code>ã€‚æœ€åï¼Œæˆ‘ä»¬æ‰“å°äº†è¿™ä¸ª Blob å¯¹è±¡çš„ <code>type</code> å±æ€§ï¼Œå®ƒå°†æ˜¾ç¤ºæˆ‘ä»¬è®¾ç½®çš„ MIME ç±»å‹ã€‚</p><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½ä¼šè¯»å–æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶å¹¶å°†å…¶å†…å®¹å­˜å‚¨åˆ° Blob å¯¹è±¡ä¸­ï¼Œæˆ–è€…å¤„ç†æ¥è‡ª HTTP è¯·æ±‚çš„äºŒè¿›åˆ¶æ•°æ®ã€‚çŸ¥é“ Blob çš„ MIME ç±»å‹å¯¹äºä½ å¦‚ä½•å¤„ç†è¿™äº›æ•°æ®å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒå‘Šè¯‰ä½ æ•°æ®çš„æ ¼å¼ï¼Œä½ å¯ä»¥æ®æ­¤å†³å®šå¦‚ä½•è§£ææˆ–å±•ç¤ºè¿™äº›æ•°æ®ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœä½ åœ¨å¼€å‘ä¸€ä¸ª web åº”ç”¨ï¼Œå¹¶ä¸”éœ€è¦å¤„ç†ç”¨æˆ·ä¸Šä¼ çš„å›¾åƒæ–‡ä»¶ï¼Œä½ å¯ä»¥æ£€æŸ¥è¿™äº›æ–‡ä»¶ Blob çš„ MIME ç±»å‹ï¼Œä»¥ç¡®ä¿å®ƒä»¬çœŸçš„æ˜¯å›¾åƒæ–‡ä»¶ç±»å‹ï¼Œç„¶åå†ç»§ç»­è¿›è¡Œå›¾åƒå¤„ç†æˆ–å­˜å‚¨æ“ä½œã€‚</p><h3 id="blob-objects-and-messagechannel" tabindex="-1"><a class="header-anchor" href="#blob-objects-and-messagechannel"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#blob-objects-and-messagechannel" target="_blank" rel="noopener noreferrer">Blob objects and MessageChannel</a></span></a></h3><p>Node.js ä¸­çš„ <code>Blob</code> å¯¹è±¡å’Œ <code>MessageChannel</code> æ˜¯ä» Web æµè§ˆå™¨ç¯å¢ƒå€Ÿé‰´è€Œæ¥çš„ APIï¼Œå®ƒä»¬åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ä¹Ÿå¾—åˆ°äº†æ”¯æŒã€‚ä¸‹é¢æˆ‘ä¼šåˆ†åˆ«è§£é‡Šå®ƒä»¬æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå¦‚ä½•åœ¨å®é™…ä¸­ä½¿ç”¨å®ƒä»¬ã€‚</p><h3 id="blob-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#blob-å¯¹è±¡"><span>Blob å¯¹è±¡</span></a></h3><p><code>Blob</code>ï¼ˆBinary Large Objectï¼‰å¯¹è±¡ä»£è¡¨äº†ä¸€ä¸ªä¸å¯å˜çš„ã€åŸå§‹æ•°æ®çš„ç±»æ–‡ä»¶å¯¹è±¡ã€‚åœ¨æµè§ˆå™¨ä¸­ï¼Œ<code>Blob</code> é€šå¸¸ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¯”å¦‚å¯ä»¥ç”¨æ¥è¯»å–å’Œæ“ä½œå›¾ç‰‡æˆ–è€…å…¶ä»–åª’ä½“æ–‡ä»¶çš„å†…å®¹ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>Blob</code> å¯¹è±¡åŒæ ·å¯ä»¥ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµã€‚</p><h4 id="ç¤ºä¾‹-1-åˆ›å»ºå’Œè¯»å–-blob" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åˆ›å»ºå’Œè¯»å–-blob"><span>ç¤ºä¾‹ 1ï¼šåˆ›å»ºå’Œè¯»å– Blob</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> createAndReadBlob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> blob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;text/plain&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å°† Blob è½¬æ¢ä¸ºæ–‡æœ¬</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> text</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> blob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º &quot;Hello World&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createAndReadBlob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªåŒ…å«æ–‡æœ¬ &quot;Hello World&quot; çš„ <code>Blob</code> å¯¹è±¡ï¼Œå¹¶æŒ‡å®šäº†å…¶å†…å®¹ç±»å‹ä¸ºçº¯æ–‡æœ¬ (<code>type: &#39;text/plain&#39;</code>)ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>blob.text()</code> æ–¹æ³•å¼‚æ­¥åœ°å°† <code>Blob</code> å¯¹è±¡çš„å†…å®¹è¯»å–ä¸ºæ–‡æœ¬å¹¶è¾“å‡ºã€‚</p><h3 id="messagechannel" tabindex="-1"><a class="header-anchor" href="#messagechannel"><span>MessageChannel</span></a></h3><p><code>MessageChannel</code> æ˜¯ä¸€ç§å¯ä»¥è®©æˆ‘ä»¬åœ¨ä¸åŒæ‰§è¡Œä¸Šä¸‹æ–‡é—´ä¼ é€’æ¶ˆæ¯çš„æœºåˆ¶ã€‚åœ¨æµè§ˆå™¨ä¸­ï¼Œè¿™é€šå¸¸ç”¨äº Worker çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œè€Œåœ¨ Node.js ä¸­ï¼Œå®ƒèƒ½å¤Ÿç”¨äºä¸åŒçº¿ç¨‹ã€å·¥ä½œè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚</p><p><code>MessageChannel</code> åŒ…å«ä¸¤ä¸ª <code>MessagePort</code> å±æ€§ï¼Œåˆ†åˆ«ç§°ä¸º <code>port1</code> å’Œ <code>port2</code>ã€‚é€šè¿‡è¿™ä¸¤ä¸ªç«¯å£ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸¤ä¸ªä¸åŒçš„ä¸Šä¸‹æ–‡ä¹‹é—´å‘é€å’Œæ¥æ”¶æ¶ˆæ¯ã€‚</p><h4 id="ç¤ºä¾‹-2-ä½¿ç”¨-messagechannel-åœ¨çˆ¶å­è¿›ç¨‹é—´é€šä¿¡" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨-messagechannel-åœ¨çˆ¶å­è¿›ç¨‹é—´é€šä¿¡"><span>ç¤ºä¾‹ 2ï¼šä½¿ç”¨ MessageChannel åœ¨çˆ¶å­è¿›ç¨‹é—´é€šä¿¡</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªä¸»è¿›ç¨‹å’Œä¸€ä¸ªå­è¿›ç¨‹ï¼Œä½ æƒ³åœ¨å®ƒä»¬ä¹‹é—´äº’ç›¸å‘é€æ¶ˆæ¯ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>MessageChannel</code> æ¥å®ç°ï¼š</p><p>ä¸»è¿›ç¨‹ä»£ç ï¼ˆmain.jsï¼‰:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">fork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;child_process&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">MessageChannel</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;worker_threads&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ–°çš„ MessageChannel å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">port1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">port2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> MessageChannel</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯åŠ¨å­è¿›ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> child</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;child.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æŠŠ port2 å‘é€ç»™å­è¿›ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">port</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">port2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }, [</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">port2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é€šè¿‡ port1 æ¥æ”¶æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">port1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä»å­è¿›ç¨‹æ”¶åˆ°:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ç»™å­è¿›ç¨‹å‘é€æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  port1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">postMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä½ å¥½ï¼Œå­è¿›ç¨‹ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å­è¿›ç¨‹ä»£ç ï¼ˆchild.jsï¼‰:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">parentPort</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;worker_threads&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»ä¸»è¿›ç¨‹æ¥æ”¶ MessagePort</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, ({ </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">port</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  port</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä»ä¸»è¿›ç¨‹æ”¶åˆ°:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å›å¤ä¸»è¿›ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    port</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">postMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä½ å¥½ï¼Œä¸»è¿›ç¨‹ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™é‡Œï¼Œä¸»è¿›ç¨‹é€šè¿‡ <code>MessageChannel</code> åˆ›å»ºäº†ä¸¤ä¸ªç«¯å£ <code>port1</code> å’Œ <code>port2</code>ï¼Œç„¶åå°† <code>port2</code> å‘é€ç»™å­è¿›ç¨‹ï¼Œå¹¶é€šè¿‡ <code>port1</code> ç›‘å¬å’Œå‘é€æ¶ˆæ¯ã€‚å­è¿›ç¨‹åœ¨æ¥æ”¶åˆ° <code>port2</code> åï¼Œä¹Ÿå¯ä»¥ç›‘å¬å’Œå‘é€æ¶ˆæ¯ã€‚è¿™æ ·å°±å»ºç«‹äº†ä¸€æ¡åŒå‘çš„é€šä¿¡æ¸ é“ã€‚</p><p>æ€»ç»“èµ·æ¥ï¼Œ<code>Blob</code> å¯¹è±¡ä½¿å¾—å¤„ç†äºŒè¿›åˆ¶æ•°æ®å˜å¾—æ–¹ä¾¿ï¼Œè€Œ <code>MessageChannel</code> æä¾›äº†ä¸€ç§åœ¨ä¸åŒä¸Šä¸‹æ–‡é—´è¿›è¡Œé€šä¿¡çš„æœºåˆ¶ã€‚è¿™äº›ç‰¹æ€§åœ¨ Node.js ä¸­çš„åº”ç”¨ï¼Œå¤§å¤§æ‰©å±•äº† JavaScript åœ¨æœåŠ¡å™¨ç«¯çš„èƒ½åŠ›ï¼Œå°¤å…¶åœ¨å¤„ç†å¤šçº¿ç¨‹ä»»åŠ¡å’Œæµå¼æ•°æ®æ—¶éå¸¸æœ‰ç”¨ã€‚</p><h2 id="class-buffer" tabindex="-1"><a class="header-anchor" href="#class-buffer"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#class-buffer" target="_blank" rel="noopener noreferrer">Class: Buffer</a></span></a></h2><p>Node.js ä¸­çš„ Buffer ç±»æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨æ¥ç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚åœ¨è®¡ç®—æœºç§‘å­¦é‡Œï¼Œâ€œç¼“å†²åŒºâ€æŒ‡çš„æ˜¯ä¸€å—å¯ä»¥å­˜å‚¨æ•°æ®çš„å†…å­˜åŒºåŸŸï¼Œè€Œ Node.js çš„ Buffer ç±»å°±æä¾›äº†ä¸è¿™å—å†…å­˜äº¤äº’çš„æ–¹æ³•ã€‚</p><p>åœ¨è¾ƒæ—©ç‰ˆæœ¬çš„ JavaScript é‡Œï¼Œå¹¶æ²¡æœ‰å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„æœºåˆ¶ã€‚Buffer ç±»æ˜¯åœ¨ Node.js ä¸­å¼•å…¥çš„ï¼Œä»¥ä¾¿å¼€å‘è€…èƒ½å¤Ÿå¤„ç†åƒ TCP æµæˆ–æ–‡ä»¶ç³»ç»Ÿæ“ä½œè¿™æ ·çš„äºŒè¿›åˆ¶æ•°æ®æµã€‚</p><p>ä¸‹é¢é€šè¿‡ä¸€äº›ä¾‹å­æ¥è¯´æ˜ Buffer ç±»çš„ä½¿ç”¨ï¼š</p><ol><li><p><strong>åˆ›å»º Bufferï¼š</strong><br> æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šç§æ–¹å¼åˆ›å»º Buffer å®ä¾‹ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„åˆ›å»ºæ–¹å¼ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 10 çš„ Bufferï¼Œä¸”ç”¨ 0 å¡«å……</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 10 çš„ Bufferï¼Œä¸”ç”¨ 1 å¡«å……</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»ä¸€ä¸ªæ•°ç»„åˆ›å»º Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf3</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»ä¸€ä¸ªå­—ç¬¦ä¸²åˆ›å»º Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf4</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>å†™å…¥ Bufferï¼š</strong><br> å†™å…¥ Buffer çš„è¿‡ç¨‹ç±»ä¼¼äºå‘æ•°ç»„ä¸­å¡«å……æ•°æ®ã€‚å¯ä»¥æŒ‡å®šæ•°æ®è¦å†™å…¥çš„ä½ç½®ã€é•¿åº¦ç­‰ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 256 çš„ Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ write æ–¹æ³•å†™å…¥å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hello world&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>ä» Buffer è¯»å–æ•°æ®ï¼š</strong><br> å¯ä»¥ä» Buffer ä¸­è¯»å–æ•°æ®ï¼Œè½¬æ¢æˆå¯è¯»çš„æ ¼å¼ï¼Œå¦‚å­—ç¬¦ä¸²ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å« &#39;Hello World&#39; çš„ Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯»å– Buffer ä¸­çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: Hello World</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ“ä½œ Buffer ä¸­çš„æ•°æ®ï¼š</strong><br> ä½ å¯ä»¥åƒæ“ä½œæ•°ç»„ä¸€æ ·è®¿é—®å’Œä¿®æ”¹ Buffer ä¸­çš„æ•°æ®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¿®æ”¹ Buffer ä¸­çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ˆå­—ç¬¦ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 72</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 72 æ˜¯å­—ç¬¦ &#39;H&#39; çš„ ASCII ç </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°ä¿®æ”¹åçš„ Buffer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: Hello World ï¼ˆå¹¶æœªæ”¹å˜ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªå­—ç¬¦æœ¬æ¥å°±æ˜¯ &#39;H&#39;ï¼‰</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>Buffer ä¸ JSONï¼š</strong><br> Buffer å®ä¾‹å¯ä»¥è¢«è½¬æ¢æˆ JSON å¯¹è±¡ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> json</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º &#39;{&quot;type&quot;:&quot;Buffer&quot;,&quot;data&quot;:[1,2,3,4,5]}&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">json</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°† JSON è½¬æ¢å› Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> copy</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">parse</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">json</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Buffer&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> ?</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">copy</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º `&lt;`Buffer 01 02 03 04 05&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>åˆ° Node.js v21.7.1 ç‰ˆæœ¬æ—¶ï¼ŒBuffer ç±»å·²ç»å¾—åˆ°äº†æ›´å¤šçš„æ”¹è¿›å’Œä¼˜åŒ–ï¼Œå¦‚æœæœ‰æ–°åŠ å…¥çš„æ–¹æ³•ï¼Œåœ¨å®˜æ–¹æ–‡æ¡£ä¸­ä¼šæœ‰è¯¦ç»†æè¿°ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼ŒBuffer ç±»åœ¨ Node.js ä¸­éå¸¸é‡è¦ï¼Œå®ƒå…è®¸æˆ‘ä»¬å¤„ç†åƒå›¾ç‰‡ã€éŸ³é¢‘æ–‡ä»¶ç­‰äºŒè¿›åˆ¶æ•°æ®ï¼Œè€Œæ— éœ€å°†å…¶è½¬æ¢ä¸ºå…¶ä»–æ ¼å¼ã€‚åœ¨æ–‡ä»¶ä¸Šä¼ ã€ç½‘ç»œé€šä¿¡ç­‰åœºæ™¯ä¸­ï¼ŒBuffer çš„ä½œç”¨å°¤ä¸ºæ˜¾è‘—ã€‚éšç€æ–°ç‰ˆæœ¬çš„å‘å¸ƒï¼ŒBuffer ç±»çš„æ€§èƒ½å’Œå®‰å…¨æ€§ä¹Ÿåœ¨ä¸æ–­æé«˜ã€‚</p><h3 id="static-method-buffer-alloc-size-fill-encoding" tabindex="-1"><a class="header-anchor" href="#static-method-buffer-alloc-size-fill-encoding"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#static-method-bufferallocsize-fill-encoding" target="_blank" rel="noopener noreferrer">Static method: Buffer.alloc(size[, fill[, encoding]])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥ç®€å•ç†è§£ä¸€ä¸‹ Node.js ä¸­çš„ <code>Buffer.alloc()</code> è¿™ä¸ªé™æ€æ–¹æ³•ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code> å¯¹è±¡ç”¨äºç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµã€‚åœ¨æ“ä½œæ–‡ä»¶ã€ç½‘ç»œé€šä¿¡æˆ–è€…å…¶ä»– I/Oï¼ˆè¾“å…¥/è¾“å‡ºï¼‰æ“ä½œæ—¶ï¼Œä½ ä¼šé¢‘ç¹åœ°ä½¿ç”¨åˆ°å®ƒä»¬ã€‚</p><p><code>Buffer.alloc()</code> æ˜¯ä¸€ä¸ªç”¨æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ Bufferï¼ˆç¼“å†²åŒºï¼‰çš„æ–¹æ³•ï¼Œè€Œè¿™ä¸ªç¼“å†²åŒºæ˜¯é¢„å¡«å……çš„ï¼Œä»¥ä¾¿èƒ½å®‰å…¨åœ°ä½¿ç”¨ã€‚</p><ul><li><code>size</code>: è¿™ä¸ªå‚æ•°æŒ‡å®šäº†è¦åˆ›å»ºçš„ <code>Buffer</code> çš„å¤§å°ï¼Œå•ä½æ˜¯å­—èŠ‚ã€‚</li><li><code>fill</code>: ï¼ˆå¯é€‰çš„ï¼‰å½“ä½ åˆ›å»º <code>Buffer</code> åï¼Œå¯ä»¥é€‰æ‹©ç«‹å³ç”¨ä¸€ä¸ªå€¼æ¥å¡«å……å®ƒã€‚è¿™ä¸ªå€¼å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€ä¸€ä¸ª <code>Buffer</code>ã€ä¸€ä¸ªæ•´æ•°æˆ–è€…æ•°ç»„ã€‚å¦‚æœä½ ä¸æŒ‡å®š <code>fill</code>ï¼Œé‚£ä¹ˆ <code>Buffer</code> é»˜è®¤ä¼šè¢«åˆå§‹åŒ–ä¸ºé›¶ã€‚</li><li><code>encoding</code>: ï¼ˆå¯é€‰çš„ï¼‰å¦‚æœ <code>fill</code> å‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆ <code>encoding</code> æŒ‡å®šäº†å­—ç¬¦ä¸²çš„ç¼–ç ç±»å‹ï¼Œæ¯”å¦‚ &#39;utf8&#39;, &#39;ascii&#39; ç­‰ç­‰ã€‚</li></ul><h3 id="ä¾‹å­-1-åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º-10-å­—èŠ‚çš„ç¼“å†²åŒº-å¹¶ä½¿ç”¨é»˜è®¤å€¼-0-å¡«å……ã€‚" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º-10-å­—èŠ‚çš„ç¼“å†²åŒº-å¹¶ä½¿ç”¨é»˜è®¤å€¼-0-å¡«å……ã€‚"><span>ä¾‹å­ 1: åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 10 å­—èŠ‚çš„ç¼“å†²åŒºï¼Œå¹¶ä½¿ç”¨é»˜è®¤å€¼ 0 å¡«å……ã€‚</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: `&lt;`Buffer 00 00 00 00 00 00 00 00 00 00&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º 10 ä¸ªå­—èŠ‚çš„ <code>Buffer</code>ï¼Œå¹¶ä¸”æ²¡æœ‰æä¾›å¡«å……å€¼ï¼Œå› æ­¤å®ƒè¢«åˆå§‹åŒ–ä¸ºå…¨ 0ã€‚</p><h3 id="ä¾‹å­-2-åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º-10-å­—èŠ‚çš„ç¼“å†²åŒº-å¹¶ç”¨-a-å¡«å……ã€‚" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º-10-å­—èŠ‚çš„ç¼“å†²åŒº-å¹¶ç”¨-a-å¡«å……ã€‚"><span>ä¾‹å­ 2: åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 10 å­—èŠ‚çš„ç¼“å†²åŒºï¼Œå¹¶ç”¨ &#39;a&#39; å¡«å……ã€‚</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;a&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: `&lt;`Buffer 61 61 61 61 61 61 61 61 61 61&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦åŒæ ·ä¸º 10 ä¸ªå­—èŠ‚çš„ <code>Buffer</code>ï¼Œä½†è¿™æ¬¡æˆ‘ä»¬ç”¨å­—ç¬¦ &#39;a&#39; å¡«å……äº†å®ƒã€‚åœ¨ ASCII ç¼–ç ä¸­ï¼Œ&#39;a&#39; å¯¹åº”çš„åå…­è¿›åˆ¶å€¼æ˜¯ 61ï¼Œæ‰€ä»¥ <code>Buffer</code> æ˜¾ç¤ºçš„å°±æ˜¯ 61 çš„åºåˆ—ã€‚</p><h3 id="ä¾‹å­-3-åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º-10-å­—èŠ‚çš„ç¼“å†²åŒº-å¹¶ç”¨-16-è¿›åˆ¶æ•°-0x1b-å¡«å……ã€‚" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-3-åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º-10-å­—èŠ‚çš„ç¼“å†²åŒº-å¹¶ç”¨-16-è¿›åˆ¶æ•°-0x1b-å¡«å……ã€‚"><span>ä¾‹å­ 3: åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 10 å­—èŠ‚çš„ç¼“å†²åŒºï¼Œå¹¶ç”¨ 16 è¿›åˆ¶æ•° 0x1b å¡«å……ã€‚</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x1b</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: `&lt;`Buffer 1b 1b 1b 1b 1b 1b 1b 1b 1b 1b&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç”¨ 16 è¿›åˆ¶çš„æ•° <code>0x1b</code>ï¼ˆåœ¨åè¿›åˆ¶ä¸­æ˜¯ 27ï¼‰æ¥å¡«å…… <code>Buffer</code>ã€‚æ³¨æ„ï¼Œå½“æˆ‘ä»¬ç”¨æ•°å­—ä½œä¸º <code>fill</code> å€¼æ—¶ï¼Œéœ€è¦ç¡®ä¿å®ƒæ˜¯åœ¨åˆæ³•çš„å­—èŠ‚èŒƒå›´å†…ï¼ˆ0-255ï¼‰ã€‚</p><p>è¿™äº› <code>Buffer</code> å¯ä»¥ç”¨äºå¤šç§æƒ…å†µï¼Œæ¯”å¦‚ï¼š</p><ul><li>ä»æ–‡ä»¶ç³»ç»Ÿä¸­è¯»å–æ•°æ®æ—¶ï¼Œæ•°æ®é€šå¸¸ä»¥ <code>Buffer</code> å½¢å¼è¿”å›ã€‚</li><li>åœ¨ HTTP è¯·æ±‚ä¸­å‘é€å’Œæ¥æ”¶æ•°æ®æ—¶ï¼Œæ•°æ®å¯èƒ½ä¼šé€šè¿‡ <code>Buffer</code> å¯¹è±¡ä¼ è¾“ã€‚</li><li>å¤„ç†å›¾åƒã€éŸ³é¢‘æˆ–è§†é¢‘æ•°æ®æµæ—¶ï¼Œä¹Ÿç»å¸¸ä¼šç”¨åˆ° <code>Buffer</code>ã€‚</li></ul><p>æ€»ä¹‹ï¼Œ<code>Buffer.alloc()</code> æä¾›äº†ä¸€ç§å¿«é€Ÿä¸”å®‰å…¨çš„æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªé¢„å…ˆè®¾å®šå¤§å°ã€å¯æŒ‰éœ€å¡«å……çš„ <code>Buffer</code> å®ä¾‹ã€‚è¿™å¯¹äºå¤„ç†å¤§é‡äºŒè¿›åˆ¶æ•°æ®æ—¶å°¤å…¶æœ‰ç”¨ã€‚</p><h3 id="static-method-buffer-allocunsafe-size" tabindex="-1"><a class="header-anchor" href="#static-method-buffer-allocunsafe-size"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#static-method-bufferallocunsafesize" target="_blank" rel="noopener noreferrer">Static method: Buffer.allocUnsafe(size)</a></span></a></h3><p><code>Buffer.allocUnsafe(size)</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Buffer</code> å¯¹è±¡ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code> å¯¹è±¡é€šå¸¸ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¯”å¦‚æ“ä½œæ–‡ä»¶ã€ç½‘ç»œé€šä¿¡ç­‰ã€‚</p><p>ä½†æ˜¯ï¼Œä¸ <code>Buffer.alloc(size)</code> æ–¹æ³•ä¸åŒçš„æ˜¯ï¼Œ<code>Buffer.allocUnsafe(size)</code> åˆ›å»ºçš„ <code>Buffer</code> å¯¹è±¡å¹¶ä¸ä¼šè‡ªåŠ¨æ¸…ç†æˆ–åˆå§‹åŒ–é‡Œé¢çš„æ•°æ®ã€‚è¿™å°±æ„å‘³ç€ï¼Œæ–°åˆ›å»ºçš„ <code>Buffer</code> å¯èƒ½åŒ…å«æ—§æ•°æ®ï¼Œå› æ­¤å«åšâ€œunsafeâ€ï¼ˆä¸å®‰å…¨ï¼‰ã€‚ä½¿ç”¨ä¸å®‰å…¨çš„åˆ†é…æ–¹æ³•å¯ä»¥æå‡æ€§èƒ½ï¼Œå› ä¸ºé¿å…äº†åˆå§‹åŒ–å†…å­˜çš„å¼€é”€ï¼Œä½†å‰ææ˜¯ä½ å¿…é¡»æ‰‹åŠ¨è¦†ç›–æ‰€æœ‰æœªåˆå§‹åŒ–çš„éƒ¨åˆ†ï¼Œå¦åˆ™å¯èƒ½ä¼šæœ‰å®‰å…¨éšæ‚£ã€‚</p><h3 id="ä½¿ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹-1"><span>ä½¿ç”¨ç¤ºä¾‹ï¼š</span></a></h3><p>å‡è®¾æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º 1024 å­—èŠ‚ï¼ˆ1KBï¼‰çš„ <code>Buffer</code> æ¥å­˜å‚¨ä¸€äº›æ•°æ®ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šç«‹å³å¡«æ»¡è¿™ä¸ª <code>Buffer</code>ï¼Œæ‰€ä»¥ä¸æ‹…å¿ƒé‡Œé¢å¯èƒ½å­˜åœ¨çš„æ—§æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ <code>Buffer.allocUnsafe()</code> æ¥å¿«é€Ÿåˆ›å»ºå®ƒï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥ Buffer ç±»</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;buffer&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º 1024 å­—èŠ‚çš„ä¸å®‰å…¨ç¼“å†²åŒº</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">allocUnsafe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1024</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨ buf ä¸­çš„å†…å®¹æ˜¯ä¸ç¡®å®šçš„ï¼Œå¯èƒ½ä¼šæœ‰ä»»ä½•çš„æ—§æ•°æ®</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰‹åŠ¨åˆå§‹åŒ– Bufferï¼ˆè¦†ç›–å…¶ä¸­çš„æ—§æ•°æ®ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å‡è®¾æˆ‘ä»¬æƒ³è¦å°†æ¯ä¸ªå­—èŠ‚éƒ½è®¾ç½®ä¸º 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨ buf å·²ç»è¢«å®Œå…¨åˆå§‹åŒ–ï¼Œå¯ä»¥å®‰å…¨ä½¿ç”¨äº†</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨"><span>å®é™…è¿ç”¨ï¼š</span></a></h3><h4 id="_1-æ–‡ä»¶è¯»å†™" tabindex="-1"><a class="header-anchor" href="#_1-æ–‡ä»¶è¯»å†™"><span>1. æ–‡ä»¶è¯»å†™</span></a></h4><p>åœ¨å¤„ç†æ–‡ä»¶æ—¶ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è¯»å–ä¸€ä¸ªå¤§æ–‡ä»¶ï¼Œå¹¶ä¸”å¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œæ›¿æ¢æˆ–å¤„ç†ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šä½¿ç”¨ <code>Buffer.allocUnsafe()</code> æ¥åˆ›å»ºä¸€ä¸ªè¶³å¤Ÿå¤§çš„ç¼“å†²åŒºï¼Œç„¶åå†ç”¨æ–‡ä»¶çš„å†…å®¹å¡«å……å®ƒï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªä¸å®‰å…¨çš„ç¼“å†²åŒºï¼Œå‡è®¾æˆ‘ä»¬çŸ¥é“æ–‡ä»¶ä¸ä¼šè¶…è¿‡ 2KB</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">allocUnsafe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯»å–æ–‡ä»¶å†…å®¹åˆ°ç¼“å†²åŒºä¸­</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å°†è¯»å–çš„æ•°æ®å¤åˆ¶åˆ° buf ä¸­</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">copy</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¤„ç† buf...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-ç½‘ç»œä¼ è¾“" tabindex="-1"><a class="header-anchor" href="#_2-ç½‘ç»œä¼ è¾“"><span>2. ç½‘ç»œä¼ è¾“</span></a></h4><p>å½“ä»ç½‘ç»œä¸Šæ¥æ”¶æ•°æ®æ—¶ï¼Œä½ å¯èƒ½ä¼šä½¿ç”¨ <code>Buffer.allocUnsafe()</code> æ¥åˆ›å»ºä¸€ä¸ªç¼“å†²åŒºï¼Œç”¨æ¥æš‚å­˜æ¥æ”¶åˆ°çš„æ•°æ®ï¼Œç‰¹åˆ«æ˜¯åœ¨æµå¼ä¼ è¾“ä¸­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> net</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;net&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª TCP æœåŠ¡å™¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> server</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> net</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">socket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å½“æ¥æ”¶åˆ°æ•°æ®æ—¶åˆ›å»ºä¸€ä¸ªä¸å®‰å…¨çš„ç¼“å†²åŒº</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  socket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">allocUnsafe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">copy</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¤„ç† buf...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8080</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™äº›ä¾‹å­ä¸­ï¼Œå°¤å…¶æ˜¯ä¸å®‰å…¨çš„åˆ†é…ç”¨äºä¸´æ—¶å­˜å‚¨å’Œå¤„ç†æ•°æ®ï¼Œè€Œä¸”åœ¨å®é™…ä½¿ç”¨ä¹‹å‰ï¼Œä½ é€šå¸¸ä¼šè¦†ç›–æ‰ç¼“å†²åŒºä¸­æ‰€æœ‰çš„æ—§æ•°æ®ã€‚ä½¿ç”¨ <code>Buffer.allocUnsafe()</code> èƒ½å¤Ÿæé«˜æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶ï¼Œä½†ä¸€å®šè¦ç¡®ä¿æ­£ç¡®åœ°ç®¡ç†å’Œè¦†ç›–è¿™äº›ç¼“å†²åŒºçš„æ•°æ®ï¼Œä»¥é¿å…æ½œåœ¨çš„å®‰å…¨é—®é¢˜ã€‚</p><h3 id="static-method-buffer-allocunsafeslow-size" tabindex="-1"><a class="header-anchor" href="#static-method-buffer-allocunsafeslow-size"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#static-method-bufferallocunsafeslowsize" target="_blank" rel="noopener noreferrer">Static method: Buffer.allocUnsafeSlow(size)</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ç»™ä½ è§£é‡Šä¸€ä¸‹ Node.js ä¸­ <code>Buffer.allocUnsafeSlow(size)</code> è¿™ä¸ªé™æ€æ–¹æ³•ã€‚</p><p>é¦–å…ˆï¼Œ<code>Buffer</code> æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªå…¨å±€ç±»ï¼Œç”¨äºç›´æ¥æ“ä½œå†…å­˜ä¸­çš„äºŒè¿›åˆ¶æ•°æ®ã€‚è¿™åœ¨å¤„ç†å¦‚æ–‡ä»¶è¯»å†™ã€ç½‘ç»œé€šä¿¡ç­‰éœ€è¦å¤„ç†å¤§é‡äºŒè¿›åˆ¶æ•°æ®çš„åœºæ™¯æ—¶éå¸¸æœ‰ç”¨ã€‚</p><p><code>Buffer.allocUnsafeSlow(size)</code> æ˜¯ Node.js ä¸­ç”¨æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„æœªåˆå§‹åŒ–çš„ç¼“å†²åŒºï¼ˆBufferï¼‰çš„æ–¹æ³•ï¼Œå…¶å‚æ•° <code>size</code> æŒ‡å®šäº†è¦åˆ›å»ºçš„ç¼“å†²åŒºçš„å¤§å°ï¼Œå•ä½æ˜¯å­—èŠ‚ã€‚&quot;æœªåˆå§‹åŒ–&quot;æ„å‘³ç€ç¼“å†²åŒºä¸­çš„å†…å­˜æ˜¯æ–°åˆ†é…å‡ºæ¥çš„ï¼Œå¹¶æ²¡æœ‰è¢«æ¸…é™¤æˆ–è®¾ç½®æˆä»»ä½•é»˜è®¤å€¼ã€‚å› æ­¤ï¼Œå®ƒå¯èƒ½åŒ…å«æ•æ„Ÿæ•°æ®æˆ–ä¹‹å‰ç¨‹åºçš„æ®‹ç•™æ•°æ®ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¯¥æ–¹æ³•åå­—ä¸­æœ‰ &quot;unsafe&quot; å’Œ &quot;slow&quot; çš„åŸå› ï¼š</p><ul><li>&quot;unsafe&quot; è¡¨ç¤ºä½¿ç”¨è¿™ç§æ–¹å¼åˆ›å»ºçš„ Buffer å¯èƒ½åŒ…å«ä¸å®‰å…¨çš„æ—§æ•°æ®ã€‚</li><li>&quot;slow&quot; æ˜¯ç›¸å¯¹äº <code>Buffer.allocUnsafe()</code> æ¥è¯´çš„ï¼Œå› ä¸º <code>allocUnsafeSlow</code> ä¼šå°è¯•é¿å…ä½¿ç”¨ Node.js çš„ç¼“å†²æ± ï¼Œä»¥é™ä½æŸäº›ç±»å‹çš„å®‰å…¨é£é™©ã€‚</li></ul><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä¸¾å‡ ä¸ªå®é™…çš„ä¾‹å­æ¥è¯´æ˜å®ƒçš„ä½¿ç”¨åœºæ™¯ï¼š</p><h3 id="ç¤ºä¾‹-1-ç®€å•åˆ›å»ºä¸€ä¸ª-buffer" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ç®€å•åˆ›å»ºä¸€ä¸ª-buffer"><span>ç¤ºä¾‹ 1ï¼šç®€å•åˆ›å»ºä¸€ä¸ª Buffer</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> size</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬å¸Œæœ›åˆ›å»ºä¸€ä¸ª10å­—èŠ‚çš„Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">allocUnsafeSlow</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºçš„Bufferå†…å®¹æ˜¯ä¸ç¡®å®šçš„ï¼Œå› ä¸ºå®ƒæ²¡æœ‰è¢«åˆå§‹åŒ–</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª 10 å­—èŠ‚çš„ Bufferï¼Œä½†æ˜¯ç”±äºå®ƒæ˜¯æœªåˆå§‹åŒ–çš„ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬ç›´æ¥æŸ¥çœ‹ buffer çš„å†…å®¹ï¼Œå¯èƒ½ä¼šçœ‹åˆ°ä¸€äº›éšæœºçš„æ•°æ®ã€‚</p><h3 id="ç¤ºä¾‹-2-å¡«å……æ•°æ®åå†ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å¡«å……æ•°æ®åå†ä½¿ç”¨"><span>ç¤ºä¾‹ 2ï¼šå¡«å……æ•°æ®åå†ä½¿ç”¨</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> size</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">allocUnsafeSlow</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fill</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¡«å……ç¼“å†²åŒºï¼Œå°†æ‰€æœ‰ä½ç½®çš„å­—èŠ‚éƒ½è®¾ç½®ä¸º0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨è¾“å‡ºçš„Bufferå†…å®¹åº”è¯¥æ˜¯ `&lt;`Buffer 00 00 00 00 00&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ç¬¬äºŒä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åœ¨åˆ›å»ºäº†æœªåˆå§‹åŒ–çš„ Buffer ä¹‹åç«‹åˆ»å¯¹å…¶è¿›è¡Œäº†å¡«å……ï¼ˆä½¿ç”¨ <code>.fill(0)</code>ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥å®‰å…¨åœ°ä½¿ç”¨å®ƒäº†ï¼Œå› ä¸ºæˆ‘ä»¬ç¡®ä¿äº†é‡Œé¢ä¸ä¼šåŒ…å«ä»»ä½•æœªçŸ¥çš„æ•°æ®ã€‚</p><h3 id="ç¤ºä¾‹-3-å¤„ç†å›¾åƒæ•°æ®" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-å¤„ç†å›¾åƒæ•°æ®"><span>ç¤ºä¾‹ 3ï¼šå¤„ç†å›¾åƒæ•°æ®</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æ­£åœ¨ä»æŸä¸ªæºè·å–å›¾åƒæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getImageData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å›¾åƒæ•°æ®çš„è·å–è¿‡ç¨‹...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> someImageData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œè¿”å›å‡è®¾çš„å›¾åƒæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> imageData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getImageData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> imageSize</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> imageData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªä¸å›¾åƒå¤§å°ç›¸åŒçš„Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> imageBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">allocUnsafeSlow</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">imageSize</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†å›¾åƒæ•°æ®å¤åˆ¶åˆ°Bufferä¸­</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">imageData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">copy</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">imageBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨ imageBuffer åŒ…å«äº†å›¾åƒæ•°æ®ï¼Œå¯ä»¥è¿›è¡Œè¿›ä¸€æ­¥çš„å¤„ç†</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æœ€åä¸€ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿäº†ä»æŸä¸ªæºè·å–å›¾åƒæ•°æ®çš„æƒ…å†µã€‚é¦–å…ˆç¡®è®¤å›¾åƒæ•°æ®çš„å¤§å°ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªç›¸åŒå¤§å°çš„æœªåˆå§‹åŒ– Bufferã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å›¾åƒæ•°æ®å¤åˆ¶åˆ°è¿™ä¸ª Buffer ä¸­ï¼Œä»¥ä¾¿äºåç»­å¤„ç†ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼ŒåŠ¡å¿…åœ¨ä½¿ç”¨æœªåˆå§‹åŒ– Buffer ä¹‹å‰å¯¹å…¶è¿›è¡Œæ­£ç¡®çš„å¡«å……æˆ–å¤åˆ¶æ“ä½œï¼Œä»¥é˜²æ­¢æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚</p><p>æ€»ç»“èµ·æ¥ï¼Œ<code>Buffer.allocUnsafeSlow(size)</code> æ˜¯ä¸€ä¸ªåˆ›å»ºæœªåˆå§‹åŒ– Buffer çš„æ–¹æ³•ï¼Œå®ƒå¯ä»¥ç”¨äºæ€§èƒ½æ•æ„Ÿçš„åº”ç”¨ç¨‹åºä¸­ï¼Œä½†ä½¿ç”¨æ—¶éœ€è¦ç‰¹åˆ«æ³¨æ„å®‰å…¨å’Œæ•°æ®çš„æ­£ç¡®åˆå§‹åŒ–ã€‚</p><h3 id="static-method-buffer-bytelength-string-encoding" tabindex="-1"><a class="header-anchor" href="#static-method-buffer-bytelength-string-encoding"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#static-method-bufferbytelengthstring-encoding" target="_blank" rel="noopener noreferrer">Static method: Buffer.byteLength(string[, encoding])</a></span></a></h3><p><code>Buffer.byteLength(string[, encoding])</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå®ƒç”¨äºè®¡ç®—ç»™å®šå­—ç¬¦ä¸²åœ¨ç‰¹å®šç¼–ç ä¸‹çš„å­—èŠ‚é•¿åº¦ã€‚åœ¨ Node.js ä¸­ï¼ŒBuffer æ˜¯ä¸€ä¸ªç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ç±»ï¼Œç»å¸¸ç”¨äºè¯»å†™æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡ç­‰åœºåˆã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä»€ä¹ˆæ˜¯â€œå­—èŠ‚é•¿åº¦â€ã€‚åœ¨è®¡ç®—æœºä¸­ï¼Œå­—ç¬¦ä¸²æ˜¯ç”±å­—ç¬¦ç»„æˆçš„ï¼Œè€Œæ¯ä¸ªå­—ç¬¦éƒ½å¯ä»¥è½¬æ¢æˆä¸€å®šæ•°é‡çš„å­—èŠ‚ã€‚å­—èŠ‚ï¼ˆByteï¼‰æ˜¯è®¡ç®—æœºå­˜å‚¨çš„åŸºæœ¬å•ä½ï¼Œ1 å­—èŠ‚=8 ä½ï¼ˆbitï¼‰ã€‚ä¸åŒçš„å­—ç¬¦ç¼–ç ï¼ˆå¦‚ UTF-8, UTF-16 ç­‰ï¼‰ä¼šä½¿ç”¨ä¸åŒæ•°é‡çš„å­—èŠ‚æ¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ã€‚</p><p>è¿™é‡Œçš„â€œencodingâ€å‚æ•°æŒ‡çš„æ˜¯å­—ç¬¦ç¼–ç çš„ç±»å‹ã€‚å¦‚æœä½ ä¸æŒ‡å®šç¼–ç ï¼Œé»˜è®¤æƒ…å†µä¸‹ Node.js ä¼šä½¿ç”¨&#39;utf8&#39;ç¼–ç ã€‚å…¶ä»–å¯ç”¨çš„ç¼–ç æœ‰&#39;ascii&#39;, &#39;utf16le&#39;, &#39;ucs2&#39;, &#39;base64&#39;, &#39;latin1&#39;, &#39;binary&#39;, &#39;hex&#39;ç­‰ã€‚</p><p>ç°åœ¨è®©æˆ‘ä»¬ä¸¾å‡ ä¸ªå…·ä½“çš„å®ä¾‹æ¥è¯´æ˜<code>Buffer.byteLength(string[, encoding])</code>çš„ç”¨æ³•ï¼š</p><p><strong>å®ä¾‹ 1ï¼šä½¿ç”¨é»˜è®¤ç¼–ç  (UTF-8) è®¡ç®—å­—ç¬¦ä¸²çš„å­—èŠ‚é•¿åº¦</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> str</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">byteLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º 11ï¼Œå› ä¸ºåœ¨UTF-8ç¼–ç ä¸‹è‹±æ–‡å­—ç¬¦éƒ½å ç”¨1ä¸ªå­—èŠ‚ã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å®ä¾‹ 2ï¼šè®¡ç®—éè‹±æ–‡å­—ç¬¦çš„å­—èŠ‚é•¿åº¦</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> str</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;ä½ å¥½ä¸–ç•Œ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¸­æ–‡å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">byteLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º 12ï¼Œå› ä¸ºåœ¨UTF-8ç¼–ç ä¸‹ä¸€èˆ¬ä¸­æ–‡å­—ç¬¦å ç”¨3ä¸ªå­—èŠ‚ã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å®ä¾‹ 3ï¼šä½¿ç”¨ä¸åŒçš„ç¼–ç è®¡ç®—å­—èŠ‚é•¿åº¦</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> euroSymbol</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;â‚¬&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¬§å…ƒç¬¦å·</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">byteLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">euroSymbol</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º 3ï¼Œå› ä¸ºåœ¨UTF-8ç¼–ç ä¸‹æ¬§å…ƒç¬¦å·å ç”¨3ä¸ªå­—èŠ‚ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">byteLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">euroSymbol</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf16le&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º 2ï¼Œå› ä¸ºåœ¨UTF-16ç¼–ç ä¸‹å¤§å¤šæ•°å­—ç¬¦å ç”¨2ä¸ªå­—èŠ‚ã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®é™…åº”ç”¨åœºæ™¯ä¸­ï¼Œè¿™ä¸ªæ–¹æ³•å°¤å…¶æœ‰ç”¨ï¼Œåœ¨è¿›è¡Œç½‘ç»œä¼ è¾“æˆ–è€…å†™å…¥æ–‡ä»¶ä¹‹å‰ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦çŸ¥é“æ•°æ®çš„å¤§å°ã€‚ä¾‹å¦‚ï¼Œåœ¨ HTTP åè®®ä¸­å‘é€å“åº”æ—¶ï¼Œé€šå¸¸è¦åœ¨ Headers ä¸­åŒ…å«<code>Content-Length</code>å­—æ®µï¼Œä»¥å‘Šè¯‰å®¢æˆ·ç«¯æ¶ˆæ¯ä½“çš„å¤§å°ï¼›åœ¨å¤„ç†å¤§å‹æ–‡æœ¬æ—¶ï¼Œäº†è§£æ–‡æœ¬çš„å­—èŠ‚å¤§å°ä¹Ÿæœ‰åŠ©äºä¼˜åŒ–å†…å­˜ä½¿ç”¨å’Œæ€§èƒ½ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œ<code>Buffer.byteLength(string[, encoding])</code>æ–¹æ³•æ˜¯ä¸€ä¸ªå¸®åŠ©ä½ ç†è§£å’Œè®¡ç®—å­—ç¬¦ä¸²åœ¨å†…å­˜ä¸­å ç”¨ç©ºé—´å¤§å°çš„å·¥å…·ï¼Œå¯¹äºä»»ä½•æ¶‰åŠäºŒè¿›åˆ¶æ•°æ®å¤„ç†çš„ Node.js ç¨‹åºéƒ½å¯èƒ½éå¸¸æœ‰ç”¨ã€‚</p><h3 id="static-method-buffer-compare-buf1-buf2" tabindex="-1"><a class="header-anchor" href="#static-method-buffer-compare-buf1-buf2"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#static-method-buffercomparebuf1-buf2" target="_blank" rel="noopener noreferrer">Static method: Buffer.compare(buf1, buf2)</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥è¯¦ç»†äº†è§£ä¸€ä¸‹ Node.js ä¸­çš„ <code>Buffer.compare</code> é™æ€æ–¹æ³•ã€‚</p><p>é¦–å…ˆï¼ŒBuffer åœ¨ Node.js ä¸­æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ç±»ã€‚å½“ä½ åœ¨å¤„ç†åƒæ–‡ä»¶è¯»å†™ã€ç½‘ç»œé€šä¿¡ç­‰éœ€è¦å¤„ç†å¤§é‡äºŒè¿›åˆ¶æ•°æ®çš„åœºæ™¯æ—¶ï¼Œå°±ä¼šç”¨åˆ° Bufferã€‚</p><p>ç°åœ¨ï¼Œå‡è®¾ä½ æœ‰ä¸¤ä¸ª Buffer å¯¹è±¡ï¼Œä½ æƒ³æ¯”è¾ƒå®ƒä»¬æ˜¯å¦ç›¸åŒï¼Œæˆ–è€…å“ªä¸€ä¸ªæ›´å¤§ï¼ˆæŒ‰å­—èŠ‚é¡ºåºï¼‰ã€‚è¿™å°±æ˜¯ <code>Buffer.compare()</code> æ–¹æ³•æ´¾ä¸Šç”¨åœºçš„æ—¶å€™ã€‚</p><p><code>Buffer.compare(buf1, buf2)</code> æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œä½ å¯ä»¥ç›´æ¥è°ƒç”¨å®ƒè€Œä¸éœ€è¦åˆ›å»º Buffer å®ä¾‹ã€‚å®ƒæ¥æ”¶ä¸¤ä¸ª Buffer å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ•°å­—è¡¨ç¤ºæ¯”è¾ƒç»“æœï¼š</p><ul><li>å¦‚æœ <code>buf1</code> å’Œ <code>buf2</code> ç›¸åŒï¼Œåˆ™è¿”å› <code>0</code>ã€‚</li><li>å¦‚æœ <code>buf1</code> åœ¨æ’åºä¸­åº”è¯¥æ’åœ¨ <code>buf2</code> ä¹‹å‰ï¼Œè¿”å› <code>-1</code>ã€‚</li><li>å¦‚æœ <code>buf1</code> åœ¨æ’åºä¸­åº”è¯¥æ’åœ¨ <code>buf2</code> ä¹‹åï¼Œè¿”å› <code>1</code>ã€‚</li></ul><p>è¿™ä¸ªæ’åºåŸºäºäºŒè¿›åˆ¶æ•°æ®çš„å­—å…¸é¡ºåºï¼Œå°±åƒå­—ç¬¦ä¸²æ¯”è¾ƒé‚£æ ·ï¼Œä½†æ˜¯æ¯”è¾ƒçš„æ˜¯äºŒè¿›åˆ¶æ•°æ®ã€‚</p><p>ä¸¾å‡ ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;1234&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;0123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf3</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;1234&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¯”è¾ƒ buf1 å’Œ buf2ã€‚å› ä¸º buf1 çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ &quot;1&quot; æ¯” buf2 çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ &quot;0&quot; å¤§ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰€ä»¥ buf1 åº”è¯¥æ’åœ¨ buf2 ä¹‹åï¼Œæ‰€ä»¥è¿”å›å€¼æ˜¯ 1ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">compare</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¯”è¾ƒ buf1 å’Œ buf3ã€‚å®ƒä»¬åŒ…å«å®Œå…¨ç›¸åŒçš„æ•°æ®ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰€ä»¥æ¯”è¾ƒç»“æœæ˜¯ 0ï¼Œè¡¨ç¤ºå®ƒä»¬æ˜¯ç›¸ç­‰çš„ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">compare</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¯”è¾ƒ buf3 å’Œ buf1ã€‚åŒæ ·åœ°ï¼Œå› ä¸ºè¿™ä¸¤ä¸ª buffer ç›¸ç­‰ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰€ä»¥è¿”å›å€¼ä¹Ÿæ˜¯ 0ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">compare</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¯”è¾ƒ buf2 å’Œ buf1ã€‚è¿™æ¬¡ buf2 åº”è¯¥æ’åœ¨ buf1 ä¹‹å‰ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å› æ­¤è¿”å›å€¼æ˜¯ -1ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">compare</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: -1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½éœ€è¦å¯¹ä¸€ç³»åˆ—çš„ Buffer è¿›è¡Œæ’åºï¼Œæ¯”å¦‚ä½ å¯èƒ½ä»ä¸åŒæ¥æºæ¥æ”¶åˆ°å¤šä¸ªæ¶ˆæ¯ç‰‡æ®µï¼Œéœ€è¦æŒ‰ç…§æ­£ç¡®çš„é¡ºåºç»„è£…å®ƒä»¬ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>.compare()</code> æ–¹æ³•æ¥å¸®åŠ©ä½ ç¡®å®šæ­£ç¡®çš„é¡ºåºã€‚ä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> arr</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;789&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;456&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)];</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ .compare() æ–¹æ³•å°† Buffer å¯¹è±¡æ•°ç»„æ’åº</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">arr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sort</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">compare</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> of</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> arr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†æ¯ä¸ª Buffer å¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²å¹¶æ‰“å°å‡ºæ¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 123</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 456</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 789</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>sort</code> å‡½æ•°å’Œ <code>Buffer.compare</code> æ–¹æ³•æ¥å¯¹ Buffer æ•°ç»„è¿›è¡Œæ’åºï¼Œç¡®ä¿å®ƒä»¬çš„é¡ºåºæ˜¯æŒ‰ç…§äºŒè¿›åˆ¶å†…å®¹çš„å­—å…¸é¡ºåºæ’åˆ—çš„ã€‚</p><h3 id="static-method-buffer-concat-list-totallength" tabindex="-1"><a class="header-anchor" href="#static-method-buffer-concat-list-totallength"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#static-method-bufferconcatlist-totallength" target="_blank" rel="noopener noreferrer">Static method: Buffer.concat(list[, totalLength])</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­çš„ <code>Buffer.concat()</code> é™æ€æ–¹æ³•ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code> ç±»æ˜¯ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ã€‚æ¯”å¦‚ï¼Œå½“ä½ éœ€è¦å¤„ç†æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡ç­‰æ¶‰åŠåˆ°å­—èŠ‚çš„æ“ä½œæ—¶ï¼Œä½ å°±å¯èƒ½ä¼šç”¨åˆ° <code>Buffer</code>ã€‚</p><p>é‚£ä¹ˆ <code>Buffer.concat()</code> è¿™ä¸ªæ–¹æ³•ä¸»è¦æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„å‘¢ï¼Ÿç®€å•æ¥è¯´ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†å¤šä¸ª <code>Buffer</code> å¯¹è±¡åˆå¹¶æˆä¸€ä¸ªæ–°çš„ <code>Buffer</code> å¯¹è±¡ã€‚</p><p>ç°åœ¨è®©æˆ‘ä»¬è¯¦ç»†äº†è§£è¿™ä¸ªæ–¹æ³•ï¼š</p><h3 id="å‚æ•°" tabindex="-1"><a class="header-anchor" href="#å‚æ•°"><span>å‚æ•°</span></a></h3><ul><li><code>list</code>: è¿™æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­åŒ…å«ç€è¦åˆå¹¶çš„ <code>Buffer</code> å¯¹è±¡ã€‚</li><li><code>totalLength</code> (å¯é€‰): è¿™ä¸ªå‚æ•°æŒ‡å®šäº†åˆå¹¶åçš„ <code>Buffer</code> çš„æ€»é•¿åº¦ã€‚å¦‚æœä½ ä¸æä¾›è¿™ä¸ªå‚æ•°ï¼Œ<code>Buffer.concat()</code> ä¼šè‡ªåŠ¨è®¡ç®—æ‰€æœ‰ <code>Buffer</code> å¯¹è±¡åŠ èµ·æ¥çš„é•¿åº¦ã€‚</li></ul><h3 id="è¿”å›å€¼" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼"><span>è¿”å›å€¼</span></a></h3><p>è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„ <code>Buffer</code> å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†ä» <code>list</code> ä¸­ä¼ å…¥çš„æ‰€æœ‰ <code>Buffer</code> å¯¹è±¡æ‹¼æ¥åœ¨ä¸€èµ·çš„æ•°æ®ã€‚</p><h3 id="ä½¿ç”¨ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­-1"><span>ä½¿ç”¨ä¾‹å­</span></a></h3><p>è®©æˆ‘ä»¬ä¸¾å‡ ä¸ªå®é™…çš„ä¾‹å­æ¥çœ‹çœ‹ <code>Buffer.concat()</code> æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><h4 id="ä¾‹å­-1-åˆå¹¶ä¸¤ä¸ª-buffer-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-åˆå¹¶ä¸¤ä¸ª-buffer-å¯¹è±¡"><span>ä¾‹å­ 1ï¼šåˆå¹¶ä¸¤ä¸ª Buffer å¯¹è±¡</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸¤ä¸ª Buffer å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ concat æ–¹æ³•åˆå¹¶è¿™ä¸¤ä¸ª Buffer å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> combinedBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">concat</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºåˆå¹¶åçš„ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">combinedBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: Hello World!</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ªæ–‡æœ¬å†…å®¹ä¸º &quot;Hello &quot; å’Œ &quot;World!&quot; çš„ <code>Buffer</code> å¯¹è±¡ã€‚ç„¶åé€šè¿‡ <code>Buffer.concat()</code> å°†å®ƒä»¬åˆå¹¶æˆä¸€ä¸ªæ–°çš„ <code>Buffer</code> å¯¹è±¡ï¼Œå¹¶æ‰“å°è¾“å‡ºï¼Œå¾—åˆ° &quot;Hello World!&quot;ã€‚</p><h4 id="ä¾‹å­-2-æŒ‡å®šåˆå¹¶åçš„-buffer-æ€»é•¿åº¦" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-æŒ‡å®šåˆå¹¶åçš„-buffer-æ€»é•¿åº¦"><span>ä¾‹å­ 2ï¼šæŒ‡å®šåˆå¹¶åçš„ Buffer æ€»é•¿åº¦</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸‰ä¸ª Buffer å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Node.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot; is&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer3</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot; awesome&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆå¹¶ Buffer å¹¶è®¾ç½® totalLength</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> totalLength</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ•…æ„å°äºå®é™…éœ€è¦é•¿åº¦</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> combinedBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">concat</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">totalLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºåˆå¹¶åçš„ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">combinedBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºæœ‰å¯èƒ½æ˜¯ä¸å®Œæ•´çš„ï¼Œä¾‹å¦‚: Node.js is</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ•…æ„è®¾ç½® <code>totalLength</code> å°äºå®é™…ä¸‰ä¸ª <code>Buffer</code> å¯¹è±¡æ€»é•¿åº¦çš„å’Œï¼Œæ‰€ä»¥åˆå¹¶åçš„ <code>Buffer</code> å¯èƒ½ä¼šä¸¢å¤±éƒ¨åˆ†æ•°æ®ã€‚</p><p>è¿™äº›ä¾‹å­å±•ç¤ºäº† <code>Buffer.concat()</code> æ–¹æ³•çš„åŸºæœ¬ä½¿ç”¨æ–¹å¼ï¼Œå®ƒåœ¨å¤„ç†å¤šä¸ªäºŒè¿›åˆ¶æ•°æ®å—éœ€è¦æ‹¼æ¥æˆä¸€ä¸ªå®Œæ•´æ•°æ®å—çš„åœºæ™¯ä¸‹éå¸¸æœ‰ç”¨ï¼Œå¦‚å¤„ç†æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ ã€ç½‘ç»œæ•°æ®åŒ…ç»„è£…ç­‰æƒ…å†µã€‚</p><h3 id="static-method-buffer-copybytesfrom-view-offset-length" tabindex="-1"><a class="header-anchor" href="#static-method-buffer-copybytesfrom-view-offset-length"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#static-method-buffercopybytesfromview-offset-length" target="_blank" rel="noopener noreferrer">Static method: Buffer.copyBytesFrom(view[, offset[, length]])</a></span></a></h3><p>Node.js ä¸­ <code>Buffer</code> ç±»æ˜¯ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—æ–¹æ³•æ¥æ“ä½œå†…å­˜ä¸­çš„ä¸€å—åŸå§‹æ•°æ®ã€‚åœ¨ Node.js çš„ v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œå¼•å…¥äº†ä¸€ä¸ªæ–°çš„é™æ€æ–¹æ³• <code>Buffer.copyBytesFrom(view[, offset[, length]])</code>ï¼Œè¿™ä¸ªæ–¹æ³•å…è®¸ä½ ä»ä¸€ä¸ª <code>TypedArray</code> æˆ–è€… <code>DataView</code> å¯¹è±¡ä¸­å¤åˆ¶å­—èŠ‚åˆ° Buffer å¯¹è±¡ä¸­ã€‚</p><p>ä¸‹é¢æˆ‘è¯¦ç»†è§£é‡Šä¸€ä¸‹è¿™ä¸ªæ–¹æ³•çš„å‚æ•°å’Œä½¿ç”¨æ–¹å¼ï¼Œå¹¶ä¸”ç»™å‡ºä¸€äº›å®é™…çš„ä¾‹å­ï¼š</p><h3 id="å‚æ•°-1" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-1"><span>å‚æ•°</span></a></h3><ul><li><code>view</code>: ä¸€ä¸ª <code>TypedArray</code> æˆ– <code>DataView</code> å¯¹è±¡ï¼Œæ˜¯è¦å¤åˆ¶å…¶å†…å®¹çš„æºå¤´ã€‚</li><li><code>offset</code> (å¯é€‰): ä¸€ä¸ªæ•´æ•°ï¼Œå®ƒæŒ‡å®šä»ç›®æ ‡ <code>Buffer</code> çš„å“ªä¸ªä½ç½®å¼€å§‹å¤åˆ¶å­—èŠ‚ã€‚å¦‚æœæ²¡æœ‰æä¾›ï¼Œå°†é»˜è®¤ä¸º <code>0</code>ã€‚</li><li><code>length</code> (å¯é€‰): ä¸€ä¸ªæ•´æ•°ï¼Œå®ƒæŒ‡å®šä» <code>view</code> ä¸­å¤åˆ¶å¤šå°‘å­—èŠ‚ã€‚å¦‚æœæ²¡æœ‰æä¾›ï¼Œä¼šå¤åˆ¶ <code>view</code> ä¸­ä» <code>offset</code> åˆ°æœ«å°¾çš„æ‰€æœ‰å­—èŠ‚ã€‚</li></ul><h3 id="è¿”å›å€¼-1" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-1"><span>è¿”å›å€¼</span></a></h3><p>è¯¥æ–¹æ³•è¿”å›å¤åˆ¶çš„å­—èŠ‚æ•°ã€‚</p><h3 id="ä½¿ç”¨ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­-2"><span>ä½¿ç”¨ä¾‹å­ï¼š</span></a></h3><h4 id="ä¾‹å­-1-å¤åˆ¶æ•´ä¸ª-typedarray-åˆ°-buffer" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-å¤åˆ¶æ•´ä¸ª-typedarray-åˆ°-buffer"><span>ä¾‹å­ 1ï¼šå¤åˆ¶æ•´ä¸ª TypedArray åˆ° Buffer</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª <code>Uint8Array</code> ç±»å‹çš„æ•°ç»„å¹¶ä¸”æƒ³è¦æŠŠå®ƒçš„å†…å®¹å¤åˆ¶åˆ°ä¸€ä¸ª Buffer ä¸­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªç”±ä¸€äº›å­—èŠ‚ç»„æˆçš„ TypedArray</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> typedArray</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Uint8Array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªè¶³å¤Ÿå¤§çš„ Buffer æ¥ä¿å­˜ typedArray çš„å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">typedArray</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ copyBytesFrom æ–¹æ³•å¤åˆ¶å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bytesCopied</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">copyBytesFrom</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">typedArray</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Copied </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bytesCopied</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bytes.`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>buffer</code> å°†åŒ…å«ä¸ <code>typedArray</code> ç›¸åŒçš„å­—èŠ‚ <code>[1, 2, 3, 4]</code>ï¼Œ<code>bytesCopied</code> å°†è¾“å‡ºå¤åˆ¶çš„å­—èŠ‚æ•°ï¼Œè¿™é‡Œåº”è¯¥æ˜¯ <code>4</code>ã€‚</p><h4 id="ä¾‹å­-2-å¤åˆ¶éƒ¨åˆ†-typedarray-åˆ°-buffer" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-å¤åˆ¶éƒ¨åˆ†-typedarray-åˆ°-buffer"><span>ä¾‹å­ 2ï¼šå¤åˆ¶éƒ¨åˆ† TypedArray åˆ° Buffer</span></a></h4><p>å¦‚æœæˆ‘ä»¬åªæƒ³å¤åˆ¶ä¸€éƒ¨åˆ†æ•°æ®ï¼Œåˆ™å¯ä»¥æŒ‡å®š <code>offset</code> å’Œ <code>length</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªç”±ä¸€äº›å­—èŠ‚ç»„æˆçš„ TypedArray</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> typedArray</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Uint8Array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª Bufferï¼Œå¤§å°åªæœ‰ 3 å­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä» typedArray çš„ç¬¬ 2 ä¸ªå­—èŠ‚å¼€å§‹å¤åˆ¶ï¼Œå¤åˆ¶ 3 ä¸ªå­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bytesCopied</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">copyBytesFrom</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">typedArray</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// `&lt;`Buffer 02 03 04&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Copied </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bytesCopied</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bytes.`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: Copied 3 bytes.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤ä¾‹ä¸­ï¼Œ<code>buffer</code> å°†åªåŒ…å« <code>typedArray</code> çš„ä¸€éƒ¨åˆ†å­—èŠ‚ <code>[2, 3, 4]</code>ï¼Œå› ä¸ºæˆ‘ä»¬æŒ‡å®šäº†ä» <code>offset</code> ä¸º <code>1</code> çš„ä½ç½®å¼€å§‹å¤åˆ¶ï¼Œå¹¶ä¸”åªå¤åˆ¶ <code>3</code> ä¸ªå­—èŠ‚ã€‚</p><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>Buffer.copyBytesFrom()</code> æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚å®ƒéå¸¸é€‚åˆåœ¨éœ€è¦é«˜æ•ˆç‡åœ°åœ¨ TypedArray/DataView å’Œ Buffer ä¹‹é—´è½¬ç§»æ•°æ®æ—¶ä½¿ç”¨ã€‚è€Œåœ¨ Node.js åº”ç”¨ä¸­å¤„ç†æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡æˆ–è€…å…¶ä»–éœ€è¦äºŒè¿›åˆ¶ä¼ è¾“çš„åœºæ™¯ï¼Œè¿™ç§æ“ä½œæ˜¯å¾ˆå¸¸è§çš„ã€‚</p><h3 id="static-method-buffer-from-array" tabindex="-1"><a class="header-anchor" href="#static-method-buffer-from-array"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#static-method-bufferfromarray" target="_blank" rel="noopener noreferrer">Static method: Buffer.from(array)</a></span></a></h3><p>Node.js ä¸­çš„ <code>Buffer</code> æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ç±»ã€‚åœ¨ Node.js ä¸­ï¼Œå½“ä½ éœ€è¦å¤„ç†åƒæ–‡ä»¶ç³»ç»Ÿæˆ–ç½‘ç»œé€šä¿¡è¿™äº›åº•å±‚æ“ä½œæ—¶ï¼Œç»å¸¸ä¼šç”¨åˆ°äºŒè¿›åˆ¶æ•°æ®æµã€‚<code>Buffer.from(array)</code> æ˜¯ <code>Buffer</code> ç±»çš„ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå®ƒå…è®¸ä½ ä»ä¸€ä¸ªå…ƒç´ ä¸ºæ•°å­—çš„æ•°ç»„ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Buffer</code> å®ä¾‹ã€‚</p><p>è¿™ä¸ªæ–¹æ³•æ˜¯é™æ€çš„ï¼Œæ„å‘³ç€ä½ ä¸éœ€è¦åˆ›å»º <code>Buffer</code> çš„ä¸€ä¸ªå®ä¾‹æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼›ç›¸åï¼Œä½ ç›´æ¥ä½¿ç”¨ <code>Buffer</code> ç±»æœ¬èº«æ¥è°ƒç”¨å®ƒã€‚</p><p>ä¸‹é¢æ˜¯ä¸€äº›è¯¦ç»†ä¸”é€šä¿—æ˜“æ‡‚çš„è§£é‡Šå’Œå®ä¾‹ï¼š</p><h3 id="è¯­æ³•" tabindex="-1"><a class="header-anchor" href="#è¯­æ³•"><span>è¯­æ³•</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å…¶ä¸­ <code>array</code> æ˜¯ä¸€ä¸ªåŒ…å«æ•°å­—çš„æ•°ç»„ï¼Œæ¯ä¸ªæ•°å­—ä»£è¡¨ä¸€ä¸ªå­—èŠ‚çš„æ•°æ®ã€‚</p><h3 id="ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­"><span>ä¾‹å­</span></a></h3><h4 id="åˆ›å»ºä¸€ä¸ªåŒ…å«-ascii-å­—ç¬¦çš„-buffer" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºä¸€ä¸ªåŒ…å«-ascii-å­—ç¬¦çš„-buffer"><span>åˆ›å»ºä¸€ä¸ªåŒ…å« ASCII å­—ç¬¦çš„ Buffer</span></a></h4><p>ASCII è¡¨çš„å­—ç¬¦å¯¹åº”ç€ 0-127 çš„æ•°å­—å€¼ã€‚ä¾‹å¦‚ï¼Œ&#39;A&#39; å¯¹åº”çš„ ASCII å€¼æ˜¯ 65ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> array</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">65</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">66</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">67</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ABC çš„ ASCII ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: `&lt;`Buffer 41 42 43&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: ABC</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å…ˆå®šä¹‰äº†ä¸€ä¸ªåŒ…å«ä¸‰ä¸ªæ•°å­—ï¼ˆ65ã€66 å’Œ 67ï¼‰çš„æ•°ç»„ï¼Œå®ƒä»¬åˆ†åˆ«å¯¹åº” &#39;A&#39;ã€&#39;B&#39; å’Œ &#39;C&#39; çš„ ASCII ç ã€‚æˆ‘ä»¬ä½¿ç”¨ <code>Buffer.from(array)</code> æ¥ä»è¿™ä¸ªæ•°ç»„åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Buffer</code> å®ä¾‹ã€‚ç„¶åï¼Œæ‰“å°å‡º <code>buffer</code> æœ¬èº«å¯ä»¥çœ‹åˆ° <code>Buffer</code> å¯¹è±¡ä¸­å­—èŠ‚çš„åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œä½¿ç”¨ <code>toString()</code> æ–¹æ³•åˆ™æŠŠ <code>Buffer</code> è½¬æ¢æˆäº†ä¸€ä¸ªå¯è¯»çš„å­—ç¬¦ä¸² &quot;ABC&quot;ã€‚</p><h4 id="åˆ›å»ºä¸€ä¸ªåŒ…å«ç‰¹å®šå­—èŠ‚çš„-buffer" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºä¸€ä¸ªåŒ…å«ç‰¹å®šå­—èŠ‚çš„-buffer"><span>åˆ›å»ºä¸€ä¸ªåŒ…å«ç‰¹å®šå­—èŠ‚çš„ Buffer</span></a></h4><p>å‡è®¾æˆ‘ä»¬éœ€è¦å¤„ç†å›¾åƒã€éŸ³é¢‘æ–‡ä»¶æˆ–å…¶ä»–äºŒè¿›åˆ¶æ•°æ®æ—¶ï¼Œå¯èƒ½ä¼šç›´æ¥ä¸å­—èŠ‚å€¼æ‰“äº¤é“ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> imageBytes</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">255</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">216</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">255</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">224</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™åªæ˜¯ä¸€ä¸ªå‡æƒ³çš„ JPEG æ–‡ä»¶å¤´éƒ¨ç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">imageBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: `&lt;`Buffer ff d8 ff e0&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>imageBytes</code> æ•°ç»„åŒ…å«äº†ä¸€äº›äºŒè¿›åˆ¶æ•°æ®ï¼Œè¿™äº›æ•°æ®å¯ä»¥æ˜¯å›¾åƒæ–‡ä»¶å¼€å¤´çš„å‡ ä¸ªå­—èŠ‚ã€‚é€šè¿‡ <code>Buffer.from(imageBytes)</code> åˆ›å»ºäº†ä¸€ä¸ª <code>Buffer</code> å®ä¾‹æ¥è¡¨ç¤ºè¿™äº›å­—èŠ‚æ•°æ®ã€‚è¯·æ³¨æ„ï¼Œåœ¨å¤„ç†çœŸæ­£çš„æ–‡ä»¶æ•°æ®æ—¶ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨æ›´å¤æ‚çš„æ–¹æ³•æ¥è¯»å–æ•´ä¸ªæ–‡ä»¶åˆ° Buffer ä¸­ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>å½“ä½ ä½¿ç”¨ <code>Buffer.from(array)</code> æ—¶ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ åº”è¯¥æ˜¯ä¸€ä¸ªä»‹äº 0 å’Œ 255ï¼ˆåŒ…æ‹¬ 0 å’Œ 255ï¼‰ä¹‹é—´çš„æ•´æ•°ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªå­—èŠ‚èƒ½å¤Ÿè¡¨ç¤ºçš„å€¼çš„èŒƒå›´ã€‚</li><li>å¦‚æœæ•°ç»„ä¸­çš„ä»»ä½•å…ƒç´ ä¸åœ¨è¿™ä¸ªèŒƒå›´å†…ï¼Œå®ƒä»¬å°†è¢«æˆªæ–­åˆ° 8 ä½ã€‚ä¾‹å¦‚ï¼Œ259 å¯¹åº”çš„äºŒè¿›åˆ¶æ˜¯ <code>0000000100000011</code>ï¼Œä½†å®ƒä¼šè¢«æˆªæ–­æˆ <code>00000011</code>ï¼Œå³ 3ã€‚</li><li>ä½¿ç”¨ <code>Buffer</code> æ—¶è¦å°å¿ƒå¤„ç†æ•æ„Ÿä¿¡æ¯ï¼Œå› ä¸º <code>Buffer</code> å¯ä»¥åŒ…å«ä»»ä½•å½¢å¼çš„æ•°æ®ã€‚å½“ä½ ç”¨å®Œä¸€ä¸ª <code>Buffer</code> åï¼Œå¦‚æœé‡Œé¢å­˜å‚¨çš„æ˜¯æ•æ„Ÿä¿¡æ¯ï¼Œåº”è¯¥æ‰‹åŠ¨æ¸…é™¤æˆ–é‡ç½®è¯¥ <code>Buffer</code>ã€‚</li></ul><p>ç®€è€Œè¨€ä¹‹ï¼Œ<code>Buffer.from(array)</code> æä¾›äº†ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ–¹å¼ï¼Œè®©ä½ èƒ½å¤ŸæŠŠä¸€ä¸ªæ™®é€šçš„æ•°å­—æ•°ç»„è½¬æ¢æˆ Node.js ä¸­ç”¨äºè¡¨ç¤ºäºŒè¿›åˆ¶æ•°æ®çš„ <code>Buffer</code>ã€‚è¿™åœ¨éœ€è¦ä»¥ç¼–ç¨‹æ–¹å¼å¤„ç†äºŒè¿›åˆ¶æ•°æ®æ—¶å°¤å…¶æœ‰ç”¨ã€‚</p><h3 id="static-method-buffer-from-arraybuffer-byteoffset-length" tabindex="-1"><a class="header-anchor" href="#static-method-buffer-from-arraybuffer-byteoffset-length"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#static-method-bufferfromarraybuffer-byteoffset-length" target="_blank" rel="noopener noreferrer">Static method: Buffer.from(arrayBuffer[, byteOffset[, length]])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥äº†è§£è¿™ä¸ªæ–¹æ³•ã€‚</p><p>é¦–å…ˆéœ€è¦çŸ¥é“çš„æ˜¯ Buffer å¯¹è±¡åœ¨ Node.js ä¸­æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µã€‚Buffer ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµã€‚ä¾‹å¦‚ï¼Œå½“ä½ ä»æ–‡ä»¶ç³»ç»Ÿè¯»å–æ–‡ä»¶æˆ–è€…ä»ç½‘ç»œæ¥æ”¶æ•°æ®æ—¶ï¼Œè¿™äº›æ•°æ®é€šå¸¸ä¼šä»¥ Buffer çš„å½¢å¼å‡ºç°ã€‚</p><p><code>Buffer.from(arrayBuffer[, byteOffset[, length]])</code>æ˜¯ Buffer ç±»çš„ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå®ƒç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„ Buffer å®ä¾‹ï¼Œå…¶å†…å®¹æ˜¯ä¸ç»™å®šçš„ ArrayBuffer å…±äº«çš„å†…å­˜ã€‚ArrayBuffer æ˜¯ä¸€ä¸ªé€šç”¨çš„å›ºå®šé•¿åº¦çš„å®¹å™¨ï¼Œç”¨äºè¡¨ç¤ºä¸€ä¸ªäºŒè¿›åˆ¶æ•°æ®ç¼“å†²åŒºã€‚</p><p>ä¸‹é¢æ˜¯è¯¥æ–¹æ³•å„ä¸ªå‚æ•°çš„å«ä¹‰ï¼š</p><ul><li><code>arrayBuffer</code>: ä¸€ä¸ª ArrayBuffer å¯¹è±¡ï¼Œæˆ–è€… SharedArrayBuffer å¯¹è±¡ï¼Œè¡¨ç¤ºè¦è½¬æ¢æˆ Buffer çš„åº•å±‚äºŒè¿›åˆ¶æ•°æ®ã€‚</li><li><code>byteOffset</code> (å¯é€‰): ä¸€ä¸ªæ•°å€¼ï¼ŒæŒ‡å®šä»<code>arrayBuffer</code>çš„å“ªä¸ªä½ç½®å¼€å§‹åˆ›å»º Bufferã€‚å¦‚æœä¸æä¾›ï¼Œé»˜è®¤ä¸º 0ã€‚</li><li><code>length</code> (å¯é€‰): ä¸€ä¸ªæ•°å€¼ï¼ŒæŒ‡å®šæ–° Buffer çš„é•¿åº¦ã€‚å¦‚æœä¸æä¾›ï¼Œé»˜è®¤ä¸º<code>arrayBuffer</code>çš„é•¿åº¦å‡å»<code>byteOffset</code>ã€‚</li></ul><p>ä¸¾å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><p><strong>ä¾‹å­ 1ï¼šä¸å¸¦å¯é€‰å‚æ•°çš„ä½¿ç”¨</strong></p><p>å‡è®¾ä½ æœ‰ä¸€ä¸ª ArrayBuffer å¯¹è±¡ï¼Œé‡Œé¢åŒ…å«äº†ä¸€äº›äºŒè¿›åˆ¶æ•°æ®ï¼Œä½ æƒ³å°†è¿™äº›æ•°æ®ä½œä¸ºä¸€ä¸ª Buffer å¯¹è±¡æ¥æ“ä½œï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªArrayBufferå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> arrayBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> ArrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ†é…16å­—èŠ‚çš„å†…å­˜ç©ºé—´</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨Buffer.fromåˆ›å»ºBufferå®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">arrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 16</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰æŒ‡å®š<code>byteOffset</code>å’Œ<code>length</code>ï¼Œæ‰€ä»¥æ–°åˆ›å»ºçš„ Buffer è¦†ç›–äº†æ•´ä¸ª ArrayBufferã€‚</p><p><strong>ä¾‹å­ 2ï¼šæŒ‡å®š byteOffset</strong></p><p>å¦‚æœä½ æƒ³ä» ArrayBuffer çš„ä¸­é—´æŸä¸ªä½ç½®å¼€å§‹åˆ›å»º Bufferï¼Œä½ å¯ä»¥æŒ‡å®š<code>byteOffset</code>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªArrayBufferå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> arrayBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> ArrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬åªæƒ³ä»ç¬¬8å­—èŠ‚å¼€å§‹åˆ›å»ºBuffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">arrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 8</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ—¶ï¼Œbuffer çš„é•¿åº¦æ˜¯ 8ï¼Œå› ä¸ºæˆ‘ä»¬ä»ç¬¬ 8 ä¸ªå­—èŠ‚å¼€å§‹åˆ›å»ºï¼Œåˆ° ArrayBuffer çš„æœ«å°¾ç»“æŸã€‚</p><p><strong>ä¾‹å­ 3ï¼šåŒæ—¶æŒ‡å®š byteOffset å’Œ length</strong></p><p>å¦‚æœä½ è¿˜æƒ³é™åˆ¶æ–° Buffer çš„é•¿åº¦ï¼Œå¯ä»¥åŒæ—¶æŒ‡å®š<code>byteOffset</code>å’Œ<code>length</code>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªArrayBufferå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> arrayBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> ArrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»ç¬¬8å­—èŠ‚å¼€å§‹åˆ›å»ºBufferï¼Œå¹¶åªåŒ…å«4ä¸ªå­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">arrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 4</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ–°çš„ Buffer ä» ArrayBuffer çš„ç¬¬ 8 ä¸ªå­—èŠ‚å¼€å§‹ï¼Œé•¿åº¦ä¸º 4 ä¸ªå­—èŠ‚ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>Buffer.from(arrayBuffer[, byteOffset[, length]])</code>æ–¹æ³•å…è®¸ä½ ä»ä¸€ä¸ªå·²å­˜åœ¨çš„ ArrayBuffer åˆ›å»ºä¸€ä¸ª Buffer å®ä¾‹ï¼Œè¿™åœ¨ä½ éœ€è¦å¤„ç†äºŒè¿›åˆ¶æ•°æ®æ—¶éå¸¸æœ‰ç”¨ã€‚ä½¿ç”¨ byteOffset å’Œ length å‚æ•°å¯ä»¥æ›´ç»†è‡´åœ°æ§åˆ¶ Buffer çš„èµ·å§‹ä½ç½®å’Œå¤§å°ã€‚</p><h3 id="static-method-buffer-from-buffer" tabindex="-1"><a class="header-anchor" href="#static-method-buffer-from-buffer"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#static-method-bufferfrombuffer" target="_blank" rel="noopener noreferrer">Static method: Buffer.from(buffer)</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code>æ˜¯ä¸€ä¸ªç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ç±»ã€‚å®ƒæ˜¯å…¨å±€å¯ç”¨çš„ï¼Œä¸éœ€è¦é€šè¿‡ require å¼•å…¥æ¨¡å—å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p><p>å½“æˆ‘ä»¬è°ˆåˆ°<code>Buffer.from(buffer)</code>è¿™ä¸ªé™æ€æ–¹æ³•æ—¶ï¼Œå…¶å®æˆ‘ä»¬åœ¨è®¨è®ºçš„æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„<code>Buffer</code>å®ä¾‹ï¼Œè¿™ä¸ªæ–°å®ä¾‹åŒ…å«äº†ä½œä¸ºå‚æ•°ä¼ å…¥çš„<code>buffer</code>å¯¹è±¡çš„æ•°æ®çš„å‰¯æœ¬ã€‚æ³¨æ„è¿™é‡Œçš„&quot;å‰¯æœ¬&quot;æ„å‘³ç€æ–°åˆ›å»ºçš„<code>Buffer</code>ä¸åŸå§‹çš„<code>buffer</code>ç›¸äº’ç‹¬ç«‹ï¼›å¯¹å…¶ä¸­ä¸€ä¸ªæ‰€åšçš„æ›´æ”¹ä¸ä¼šå½±å“å¦ä¸€ä¸ªã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-buffer-from-buffer" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-buffer-from-buffer"><span>å¦‚ä½•ä½¿ç”¨ <code>Buffer.from(buffer)</code>?</span></a></h3><p>è¦ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä½ åªéœ€ä¼ é€’ä¸€ä¸ªå·²ç»å­˜åœ¨çš„<code>Buffer</code>å®ä¾‹ä½œä¸ºå‚æ•°ï¼Œä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«asciiç è¡¨ç¤ºçš„&#39;hello&#39;å­—ç¬¦ä¸²çš„Bufferå®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ascii&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨Buffer.fromåˆ›å»ºbuf1çš„å‰¯æœ¬</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨buf2æ˜¯buf1çš„å‰¯æœ¬ï¼Œä½†æ˜¯æ˜¯ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„Bufferå®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ascii&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: hello</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªåŒ…å«å­—ç¬¦ä¸²&#39;hello&#39;çš„<code>Buffer</code>å®ä¾‹ï¼ˆ<code>buf1</code>ï¼‰ã€‚ç„¶åï¼Œæˆ‘ä»¬è°ƒç”¨äº†<code>Buffer.from</code>æ–¹æ³•ï¼Œå¹¶å°†<code>buf1</code>ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œä»¥æ­¤æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„<code>Buffer</code>å®ä¾‹ï¼ˆ<code>buf2</code>ï¼‰ã€‚</p><h3 id="å®é™…åº”ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨åœºæ™¯"><span>å®é™…åº”ç”¨åœºæ™¯</span></a></h3><ol><li><strong>å¤åˆ¶æ•°æ®</strong> - å½“ä½ æƒ³è¦å¤åˆ¶ä¸€ä»½<code>Buffer</code>ä¸­çš„æ•°æ®æ—¶ï¼Œä¿ç•™ä¸€ä¸ªåŸå§‹çŠ¶æ€çš„å‰¯æœ¬å¯ä»¥å¾ˆæœ‰ç”¨ã€‚æ¯”å¦‚ï¼Œåœ¨ç½‘ç»œç¼–ç¨‹ä¸­ï¼Œä½ å¯èƒ½ä¼šä»ä¸€ä¸ª socket æ¥æ”¶æ•°æ®ï¼Œå¹¶ä¸”å¸Œæœ›åœ¨å¤„ç†æ•°æ®ä¹‹å‰ä¿å­˜åŸå§‹æ•°æ®çš„ä¸€ä¸ªå‰¯æœ¬ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> net</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;net&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> server</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> net</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">socket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  socket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">originalBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // åˆ›å»ºåŸå§‹æ•°æ®çš„å‰¯æœ¬</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufferCopy</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">originalBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¯ä»¥å®‰å…¨åœ°ä¿®æ”¹bufferCopyè€Œä¸å½±å“originalBuffer</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    processBufferData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bufferCopy</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>é¿å…å…±äº«çŠ¶æ€</strong> - åœ¨å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œä½ å¯èƒ½éœ€è¦ç¡®ä¿ä¸åŒçš„æ“ä½œæˆ–è€…è¯·æ±‚å¤„ç†çº¿ç¨‹ä¹‹é—´ä¸å…±äº«çŠ¶æ€ã€‚æ‹·è´<code>Buffer</code>å¯¹è±¡å°±å¯ä»¥é¿å…ç”±äºæ“ä½œåŸå§‹ç¼“å†²åŒºé€ æˆçš„æ½œåœ¨å†²çªã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬è¯»å–äº†ä¸€ä¸ªæ–‡ä»¶åˆ°Bufferä¸­</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> originalBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡½æ•°Aå¤„ç†æ•°æ®çš„å‰¯æœ¬ï¼Œä¸å½±å“åŸå§‹Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> processInFunctionA</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> copyForA</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">originalBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ...å¯¹copyForAè¿›è¡Œå¤„ç†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡½æ•°Bä¹Ÿå¤„ç†æ•°æ®çš„å‰¯æœ¬</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> processInFunctionB</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> copyForB</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">originalBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ...å¯¹copyForBè¿›è¡Œå¤„ç†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">processInFunctionA</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">processInFunctionB</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>æ•°æ®éš”ç¦»</strong> - å¦‚æœä½ æœ‰ä¸€ä¸ª<code>Buffer</code>ï¼Œå¹¶ä¸”ä½ è¦å°†å®ƒä¼ é€’ç»™ç¬¬ä¸‰æ–¹åº“æˆ–è€…æ’ä»¶ï¼Œä½†æ˜¯ä½ ä¸ä¿¡ä»»è¿™äº›å¤–éƒ¨ä»£ç ä¸ä¼šæ”¹å˜ä½ çš„æ•°æ®ï¼Œé‚£ä¹ˆç»™ä»–ä»¬ä¸€ä¸ªæ•°æ®çš„æ·±æ‹·è´ä¼šæ›´åŠ å®‰å…¨ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> sensitiveDataBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Sensitive Information&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¬¬ä¸‰æ–¹å‡½æ•°å¯èƒ½ä¼šä¿®æ”¹ä¼ é€’è¿›å»çš„Buffer</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">thirdPartyFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">sensitiveDataBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å› ä¸ºæˆ‘ä»¬ä¼ é€’äº†å‰¯æœ¬ï¼Œæ‰€ä»¥sensitiveDataBufferä»ç„¶å®‰å…¨æœªè¢«ä¿®æ”¹</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç®€è€Œè¨€ä¹‹ï¼Œ<code>Buffer.from(buffer)</code>æ–¹æ³•æ˜¯åˆ›å»º Buffer å‰¯æœ¬çš„ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„æ–¹å¼ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨éœ€è¦æ—¶ä¿æŠ¤æ•°æ®çš„å®Œæ•´æ€§ã€éš”ç¦»å’Œå®‰å…¨ã€‚</p><h3 id="static-method-buffer-from-object-offsetorencoding-length" tabindex="-1"><a class="header-anchor" href="#static-method-buffer-from-object-offsetorencoding-length"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#static-method-bufferfromobject-offsetorencoding-length" target="_blank" rel="noopener noreferrer">Static method: Buffer.from(object[, offsetOrEncoding[, length]])</a></span></a></h3><p>å½“ç„¶ï¼Œè®©æˆ‘æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹ <code>Buffer.from()</code> è¿™ä¸ªåœ¨ Node.js ä¸­çš„é™æ€æ–¹æ³•ã€‚</p><h3 id="buffer-æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#buffer-æ˜¯ä»€ä¹ˆ"><span>Buffer æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h3><p>é¦–å…ˆï¼Œè¦äº†è§£ <code>Buffer</code> æ˜¯ Node.js ä¸­ç”¨äºç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ä¸€ä¸ªç±»ã€‚åœ¨æµè§ˆå™¨ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ <code>ArrayBuffer</code> å’Œ <code>TypedArray</code> æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼Œè€Œåœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code> ç±»æ˜¯ä¸“é—¨ä¸ºäº†å¤„ç†åƒæ–‡ä»¶ç³»ç»Ÿå’Œç½‘ç»œæµè¿™æ ·çš„ I/O æ“ä½œè€Œè®¾è®¡çš„ã€‚</p><h3 id="buffer-from-é™æ€æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#buffer-from-é™æ€æ–¹æ³•"><span>Buffer.from() é™æ€æ–¹æ³•</span></a></h3><p><code>Buffer.from()</code> æ–¹æ³•æ˜¯ç”¨æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Buffer</code> å®ä¾‹çš„ï¼Œå®ƒä¸éœ€è¦ä½ æ‰‹åŠ¨è°ƒç”¨ <code>new Buffer()</code>ï¼ˆå®é™…ä¸Šï¼Œç›´æ¥ä½¿ç”¨ <code>new Buffer()</code> å·²ç»è¢«åºŸå¼ƒäº†ï¼Œå› ä¸ºå®ƒæœ‰å®‰å…¨é—®é¢˜ï¼‰ã€‚è¿™ä¸ªæ–¹æ³•å¾ˆæ–¹ä¾¿ï¼Œå› ä¸ºå®ƒå¯ä»¥ä»ä¸åŒç±»å‹çš„æ•°æ®æºåˆ›å»ºç¼“å†²åŒºã€‚</p><h3 id="å‚æ•°è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>object</code>ï¼šè¿™ä¸ªå‚æ•°æŒ‡çš„æ˜¯ä½ æƒ³è¦è½¬æ¢æˆ <code>Buffer</code> çš„æ•°æ®ã€‚å®ƒå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€æ•°ç»„ã€æˆ–è€…å¦ä¸€ä¸ª <code>Buffer</code> å®ä¾‹ã€‚</li><li><code>offsetOrEncoding</code>ï¼šè¿™ä¸ªå‚æ•°çš„ä½œç”¨ä¾èµ–äºç¬¬ä¸€ä¸ªå‚æ•°çš„ç±»å‹ã€‚å¦‚æœ <code>object</code> æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ<code>offsetOrEncoding</code> å°±è¡¨ç¤ºå­—ç¬¦ç¼–ç ï¼ˆå¦‚ &#39;utf8&#39;, &#39;base64&#39; ç­‰ï¼‰ã€‚å¦‚æœ <code>object</code> æ˜¯ <code>Buffer</code> æˆ–æ•°ç»„ï¼Œé‚£ä¹ˆå®ƒè¡¨ç¤ºè¦è¯»å–æ•°æ®çš„èµ·å§‹ä½ç½®ã€‚</li><li><code>length</code>ï¼šè¡¨ç¤ºè¦è¯»å–çš„æ•°æ®é•¿åº¦ã€‚</li></ul><h3 id="ä½¿ç”¨ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹-2"><span>ä½¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ä»å­—ç¬¦ä¸²åˆ›å»º-buffer" tabindex="-1"><a class="header-anchor" href="#ä»å­—ç¬¦ä¸²åˆ›å»º-buffer"><span>ä»å­—ç¬¦ä¸²åˆ›å»º Buffer</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å« UTF-8 ç¼–ç å­—ç¬¦ä¸² &quot;Hello&quot; çš„ Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufFromString</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bufFromString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š`&lt;`Buffer 48 65 6c 6c 6f&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬ä¼ å…¥äº†å­—ç¬¦ä¸² <code>&#39;Hello&#39;</code> å’Œç¼–ç  <code>&#39;utf8&#39;</code>ï¼Œè¿™å‘Šè¯‰ Node.js æˆ‘ä»¬æƒ³è¦ä¸€ä¸ªåŒ…å«è¿™ä¸ªå­—ç¬¦ä¸²ç¼–ç åæ•°æ®çš„ <code>Buffer</code>ã€‚</p><h4 id="ä»æ•°ç»„åˆ›å»º-buffer" tabindex="-1"><a class="header-anchor" href="#ä»æ•°ç»„åˆ›å»º-buffer"><span>ä»æ•°ç»„åˆ›å»º Buffer</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«å­—èŠ‚ [0x48, 0x65, 0x6c, 0x6c, 0x6f] çš„ Buffer</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™äº›å­—èŠ‚å¯¹åº” ASCII ä¸­çš„ H e l l o</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufFromArray</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x48</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x65</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x6c</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x6c</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x6f</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bufFromArray</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š`&lt;`Buffer 48 65 6c 6c 6f&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¼ é€’äº†ä¸€ä¸ªæ•°å­—æ•°ç»„ç»™ <code>Buffer.from()</code>ã€‚æ¯ä¸ªæ•°å­—ä»£è¡¨ä¸€ä¸ªå­—èŠ‚ã€‚è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªåŒ…å«ç›¸åº”å­—èŠ‚çš„ <code>Buffer</code>ã€‚</p><h4 id="ä»ç°æœ‰çš„-buffer-å¤åˆ¶" tabindex="-1"><a class="header-anchor" href="#ä»ç°æœ‰çš„-buffer-å¤åˆ¶"><span>ä»ç°æœ‰çš„ Buffer å¤åˆ¶</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å…ˆåˆ›å»ºä¸€ä¸ª Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»ç°æœ‰çš„ Buffer åˆ›å»ºä¸€ä¸ªæ–° Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufFromBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bufFromBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š`&lt;`Buffer 48 65 6c 6c 6f&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä½ å·²ç»æœ‰ä¸€ä¸ª <code>Buffer</code> å¯¹è±¡ï¼Œ<code>Buffer.from()</code> æ–¹æ³•è¿˜å¯ä»¥å¤åˆ¶è¯¥å¯¹è±¡ä¸­çš„æ•°æ®åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Buffer</code>ã€‚</p><p>è¿™äº›å°±æ˜¯ <code>Buffer.from()</code> æ–¹æ³•çš„åŸºæœ¬ç”¨æ³•å’Œä¸€äº›ä¾‹å­ã€‚é€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼Œä½ å¯ä»¥è½»æ¾åœ°åœ¨ Node.js åº”ç”¨ç¨‹åºä¸­å¤„ç†æ–‡æœ¬æ•°æ®ä¸äºŒè¿›åˆ¶æ•°æ®çš„è½¬æ¢ã€‚</p><h3 id="static-method-buffer-from-string-encoding" tabindex="-1"><a class="header-anchor" href="#static-method-buffer-from-string-encoding"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#static-method-bufferfromstring-encoding" target="_blank" rel="noopener noreferrer">Static method: Buffer.from(string[, encoding])</a></span></a></h3><p>å¥½çš„ï¼ŒNode.js ä¸­çš„ <code>Buffer</code> ç±»æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨äºç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚åœ¨ç½‘ç»œæ“ä½œå’Œæ–‡ä»¶å¤„ç†ä¸­ï¼Œä½ ä¼šç»å¸¸æ¥è§¦åˆ° <code>Buffer</code>ã€‚</p><h3 id="buffer-from-string-encoding" tabindex="-1"><a class="header-anchor" href="#buffer-from-string-encoding"><span>Buffer.from(string[, encoding])</span></a></h3><p>è¿™æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œæ„å‘³ç€å®ƒç›´æ¥è¢« <code>Buffer</code> ç±»è°ƒç”¨ï¼Œè€Œä¸éœ€è¦åˆ›å»º <code>Buffer</code> ç±»çš„å®ä¾‹ã€‚è¿™ä¸ªæ–¹æ³•ç”¨æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Buffer</code> å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«äº†æä¾›çš„å­—ç¬¦ä¸²çš„æ‹·è´ã€‚</p><h4 id="å‚æ•°è§£é‡Š-1" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-1"><span>å‚æ•°è§£é‡Šï¼š</span></a></h4><ul><li><code>string</code>: è¿™æ˜¯ä½ æƒ³è¦è½¬æ¢æˆ <code>Buffer</code> çš„å­—ç¬¦ä¸²ã€‚</li><li><code>encoding</code>: ï¼ˆå¯é€‰ï¼‰è¿™æ˜¯å­—ç¬¦ä¸²çš„ç¼–ç æ–¹å¼ï¼Œé»˜è®¤æ˜¯ <code>&#39;utf8&#39;</code>ã€‚å¯¹äºå¤§å¤šæ•°æ–‡æœ¬æ•°æ®ï¼ŒUTF-8 ç¼–ç è¶³å¤Ÿäº†ã€‚ä½†å¦‚æœä½ å¤„ç†ç‰¹å®šçš„æ–‡æœ¬ï¼ˆæ¯”å¦‚ä¸­æ–‡ï¼‰ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨å…¶ä»–ç¼–ç ï¼ˆå¦‚ <code>&#39;utf16le&#39;</code>, <code>&#39;latin1&#39;</code>, <code>&#39;base64&#39;</code>, <code>&#39;hex&#39;</code> ç­‰ï¼‰ã€‚</li></ul><h4 id="è¿”å›å€¼-2" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-2"><span>è¿”å›å€¼ï¼š</span></a></h4><p>è¿”å›ä¸€ä¸ªæ–°å»ºçš„ <code>Buffer</code> å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†æŒ‰ç…§æŒ‡å®šç¼–ç æ–¹å¼è½¬æ¢åçš„å­—ç¬¦ä¸²æ•°æ®ã€‚</p><h3 id="å®é™…ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-2"><span>å®é™…ä¾‹å­ï¼š</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªå­—ç¬¦ä¸² &quot;Hello World&quot;ï¼Œä½ å¸Œæœ›å°†å…¶è½¬æ¢ä¸ºäºŒè¿›åˆ¶å½¢å¼ä»¥ä¾¿å¯ä»¥é€šè¿‡ç½‘ç»œå‘é€æˆ–è€…å†™å…¥æ–‡ä»¶ç³»ç»Ÿã€‚ä½ å¯ä»¥è¿™æ ·ä½¿ç”¨ <code>Buffer.from</code> æ–¹æ³•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> string</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: `&lt;`Buffer 48 65 6c 6c 6f 20 57 6f 72 6c 64&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>Buffer.from</code> æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªåŒ…å« &quot;Hello World&quot; æ–‡æœ¬çš„ <code>Buffer</code> å¯¹è±¡ã€‚å› ä¸ºæ²¡æœ‰æŒ‡å®šç¼–ç æ–¹å¼ï¼Œæ‰€ä»¥é»˜è®¤ä½¿ç”¨äº† UTF-8 ç¼–ç ã€‚</p><p>å†æ¥ä¸ªç¨å¾®å¤æ‚ç‚¹çš„ä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªéå¸¸ç‰¹æ®Šçš„å­—ç¬¦ä¸²ï¼Œå®ƒæ˜¯ä»¥ Base64 ç¼–ç çš„ï¼Œæˆ‘ä»¬æƒ³è¦å°†å…¶è½¬æ¢ä¸ºä¸€ä¸ª <code>Buffer</code> å¯¹è±¡ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> base64String</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;SGVsbG8gV29ybGQ=&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufferFromBase64</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">base64String</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">bufferFromBase64</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: Hello World</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é¦–å…ˆç”¨ Base64 ç¼–ç çš„å­—ç¬¦ä¸²åˆ›å»ºäº† <code>Buffer</code> å¯¹è±¡ï¼Œç„¶åæˆ‘ä»¬åˆè°ƒç”¨äº† <code>toString</code> æ–¹æ³•ï¼Œå¹¶ä¸”ä¼ å…¥äº† <code>&#39;utf8&#39;</code> å‚æ•°ï¼Œå°† <code>Buffer</code> å¯¹è±¡è½¬æ¢å›äº†åŸå§‹çš„å­—ç¬¦ä¸²æ ¼å¼ã€‚</p><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ åº”è¯¥èƒ½å¤Ÿç†è§£ <code>Buffer.from(string[, encoding])</code> æ–¹æ³•çš„åŸºæœ¬ç”¨æ³•å’Œç›®çš„ï¼šå°†å­—ç¬¦ä¸²ä»¥ä¸åŒçš„ç¼–ç è½¬æ¢æˆ <code>Buffer</code> å¯¹è±¡ï¼Œä»¥ä¾¿è¿›è¡ŒäºŒè¿›åˆ¶æ•°æ®çš„å¤„ç†ã€‚</p><h3 id="static-method-buffer-isbuffer-obj" tabindex="-1"><a class="header-anchor" href="#static-method-buffer-isbuffer-obj"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#static-method-bufferisbufferobj" target="_blank" rel="noopener noreferrer">Static method: Buffer.isBuffer(obj)</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹ Node.js ä¸­çš„<code>Buffer.isBuffer(obj)</code>è¿™ä¸ªæ–¹æ³•ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code>ç±»æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„å·¥å…·ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªå¯ä»¥å­˜æ”¾å­—èŠ‚çš„æ•°ç»„ã€‚è€Œåœ¨å¤„ç† I/Oï¼ˆè¾“å…¥/è¾“å‡ºï¼‰æ“ä½œï¼Œæ¯”å¦‚è¯»å†™æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡æ—¶ï¼Œç»å¸¸éœ€è¦ç”¨åˆ°è¿™ç§ç±»å‹çš„æ•°æ®ç»“æ„ã€‚</p><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæ”¶åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æˆ‘ä»¬å¹¶ä¸ç¡®å®šè¿™ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯<code>Buffer</code>å¯¹è±¡ã€‚ä¸ºäº†éªŒè¯è¿™ä¸ªå¯¹è±¡æ˜¯å¦ç¡®å®æ˜¯<code>Buffer</code>å¯¹è±¡ï¼ŒNode.js æä¾›äº†ä¸€ä¸ªé™æ€æ–¹æ³•<code>Buffer.isBuffer(obj)</code>ã€‚è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ˆ<code>true</code>æˆ–<code>false</code>ï¼‰ï¼Œå‘Šè¯‰æˆ‘ä»¬ä¼ å…¥çš„å¯¹è±¡<code>obj</code>æ˜¯å¦æ˜¯ä¸€ä¸ª<code>Buffer</code>å¯¹è±¡ã€‚</p><p>ä¸‹é¢æ˜¯å‡ ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><h3 id="ç¤ºä¾‹-1-æ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸º-buffer" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸º-buffer"><span>ç¤ºä¾‹ 1ï¼šæ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸º Buffer</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯»å–æ–‡ä»¶å†…å®¹åˆ°Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥è¯»å–çš„dataæ˜¯å¦æ˜¯Bufferç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">isBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dataæ˜¯ä¸€ä¸ªBufferå¯¹è±¡&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dataä¸æ˜¯Bufferå¯¹è±¡&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å…ˆé€šè¿‡ Node.js çš„æ–‡ä»¶ç³»ç»Ÿæ¨¡å—<code>fs</code>è¯»å–äº†ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚<code>readFileSync</code>å‡½æ•°è¿”å›ä¸€ä¸ª<code>Buffer</code>å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº†æ–‡ä»¶çš„äºŒè¿›åˆ¶å†…å®¹ã€‚éšåï¼Œæˆ‘ä»¬ä½¿ç”¨<code>Buffer.isBuffer(data)</code>æ¥éªŒè¯è¯»å–åˆ°çš„<code>data</code>ç¡®å®æ˜¯ä¸€ä¸ª<code>Buffer</code>å¯¹è±¡ã€‚</p><h3 id="ç¤ºä¾‹-2-æ£€æŸ¥å˜é‡ç±»å‹" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æ£€æŸ¥å˜é‡ç±»å‹"><span>ç¤ºä¾‹ 2ï¼šæ£€æŸ¥å˜é‡ç±»å‹</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªBufferå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¿™æ˜¯ä¸€ä¸²æ–‡å­—&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ™®é€šå­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> str</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;æˆ‘æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨isBufferæ£€æŸ¥ä¸¤è€…</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">isBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">isBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: false</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ç¬¬äºŒä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª<code>Buffer</code>å¯¹è±¡å’Œä¸€ä¸ªæ™®é€šçš„å­—ç¬¦ä¸²ã€‚ç„¶ååˆ†åˆ«ä½¿ç”¨<code>Buffer.isBuffer()</code>æ–¹æ³•æ£€æŸ¥äº†è¿™ä¸¤ä¸ªå˜é‡ã€‚å¯¹äº<code>Buffer</code>å¯¹è±¡<code>buf</code>ï¼Œ<code>Buffer.isBuffer(buf)</code>è¿”å›<code>true</code>ã€‚å¯¹äºæ™®é€šå­—ç¬¦ä¸²<code>str</code>ï¼Œ<code>Buffer.isBuffer(str)</code>åˆ™è¿”å›<code>false</code>ã€‚</p><h3 id="ç¤ºä¾‹-3-å‡½æ•°å‚æ•°éªŒè¯" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-å‡½æ•°å‚æ•°éªŒè¯"><span>ç¤ºä¾‹ 3ï¼šå‡½æ•°å‚æ•°éªŒè¯</span></a></h3><p>å‡è®¾ä½ ç¼–å†™äº†ä¸€ä¸ªå‡½æ•°ï¼Œæ­¤å‡½æ•°åªèƒ½å¤„ç†<code>Buffer</code>å¯¹è±¡ã€‚ä¸ºäº†ç¡®ä¿ä¼ é€’ç»™è¯¥å‡½æ•°çš„å‚æ•°æ˜¯æ­£ç¡®çš„ç±»å‹ï¼Œä½ å¯ä»¥åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨<code>Buffer.isBuffer()</code>è¿›è¡Œæ£€æŸ¥ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> processBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">isBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å‚æ•°å¿…é¡»æ˜¯Bufferå¯¹è±¡&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿›è¡ŒBufferå¤„ç†é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ...ä½ çš„ä»£ç ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å°è¯•ä¼ å…¥æ­£ç¡®çš„Bufferå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> correctBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ­£ç¡®çš„Bufferæ•°æ®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  processBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">correctBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ­£å¸¸è¿›è¡Œ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å°è¯•ä¼ å…¥é”™è¯¯çš„ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> incorrectType</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;è¿™ä¸æ˜¯Buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  processBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">incorrectType</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æŠ›å‡ºé”™è¯¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œä»»ä½•é<code>Buffer</code>ç±»å‹çš„å‚æ•°ä¼ é€’ç»™<code>processBuffer</code>å‡½æ•°éƒ½ä¼šå¼•å‘é”™è¯¯ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨äº†<code>Buffer.isBuffer()</code>æ¥éªŒè¯å‚æ•°ç±»å‹ã€‚</p><p>æ‰€ä»¥ï¼Œ<code>Buffer.isBuffer(obj)</code>æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ–¹æ³•ï¼Œå®ƒå¸®åŠ©å¼€å‘äººå‘˜ç¡®è®¤ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸º<code>Buffer</code>ç±»å‹ï¼Œä»è€Œåœ¨éœ€è¦å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„åœºæ™¯ä¸‹å®‰å…¨åœ°æ‰§è¡Œç›¸å…³çš„æ“ä½œã€‚</p><h3 id="static-method-buffer-isencoding-encoding" tabindex="-1"><a class="header-anchor" href="#static-method-buffer-isencoding-encoding"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#static-method-bufferisencodingencoding" target="_blank" rel="noopener noreferrer">Static method: Buffer.isEncoding(encoding)</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘æ¥è§£é‡Š <code>Buffer.isEncoding(encoding)</code> è¿™ä¸ªé™æ€æ–¹æ³•æ˜¯åšä»€ä¹ˆçš„ï¼Œå¹¶ä¸”ç»™ä½ ä¸€äº›å®é™…çš„ä¾‹å­ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code> å¯¹è±¡æ˜¯ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœä½ è¦è¯»å–ä¸€ä¸ªæ–‡ä»¶ã€æ¥æ”¶ç½‘ç»œè¯·æ±‚æˆ–è€…å¤„ç†å›¾ç‰‡æ•°æ®ï¼Œè¿™äº›æ“ä½œé€šå¸¸æ˜¯ä»¥äºŒè¿›åˆ¶å½¢å¼è¿›è¡Œçš„ã€‚<code>Buffer</code> å°±æ˜¯ç”¨äºå¤„ç†è¿™ç§ç±»å‹æ•°æ®çš„å·¥å…·ã€‚</p><p>ç°åœ¨ï¼Œå…³äº <code>Buffer.isEncoding(encoding)</code> æ–¹æ³•ï¼Œç®€å•æ¥è¯´ï¼Œå®ƒçš„ä½œç”¨æ˜¯æ£€æŸ¥ç»™å®šçš„ç¼–ç ï¼ˆencodingï¼‰æ˜¯å¦æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ã€Node.js æ‰€æ”¯æŒçš„å­—ç¬¦ç¼–ç æ–¹å¼ã€‚å­—ç¬¦ç¼–ç æ˜¯è®¡ç®—æœºä¸­ç”¨äºè¡¨ç¤ºå­—ç¬¦ï¼ˆæ¯”å¦‚å­—æ¯ã€æ•°å­—å’Œå…¶ä»–ç¬¦å·ï¼‰çš„ä¸€ç§æ–¹å¼ï¼Œæœ€å¸¸è§çš„ä¾‹å¦‚ UTF-8ã€ASCII ç­‰ã€‚</p><h3 id="å‚æ•°-2" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-2"><span>å‚æ•°</span></a></h3><ul><li><code>encoding</code>: ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¦æ£€æŸ¥çš„å­—ç¬¦ç¼–ç åç§°ã€‚</li></ul><h3 id="è¿”å›å€¼-3" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-3"><span>è¿”å›å€¼</span></a></h3><ul><li>è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ˆ<code>true</code> æˆ– <code>false</code>ï¼‰ï¼Œå‘Šè¯‰ä½ ä¼ å…¥çš„ç¼–ç åç§°æ˜¯å¦ä¸º Node.js æ”¯æŒçš„æœ‰æ•ˆç¼–ç ã€‚</li></ul><h3 id="ä¸ºä»€ä¹ˆè¦ç”¨åˆ°è¿™ä¸ªæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆè¦ç”¨åˆ°è¿™ä¸ªæ–¹æ³•"><span>ä¸ºä»€ä¹ˆè¦ç”¨åˆ°è¿™ä¸ªæ–¹æ³•ï¼Ÿ</span></a></h3><p>å½“ä½ åœ¨å¤„ç†æ–‡æœ¬æ•°æ®æ—¶ï¼Œæ¯”å¦‚ä»æ–‡ä»¶ä¸­è¯»å–æ–‡æœ¬æˆ–è€…å‘é€æ–‡æœ¬åˆ°å®¢æˆ·ç«¯ï¼Œä½ éœ€è¦çŸ¥é“è¿™äº›æ–‡æœ¬ä½¿ç”¨çš„ç¼–ç æ–¹å¼ï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°ä¹±ç ã€‚ä½¿ç”¨ <code>Buffer.isEncoding(encoding)</code> å¯ä»¥å¸®åŠ©ä½ ç¡®è®¤ç¼–ç æ–¹å¼æ˜¯å¦æ­£ç¡®ï¼Œç¡®ä¿åç»­çš„è¯»å†™æ“ä½œå¯ä»¥æ­£å¸¸è¿›è¡Œã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><h4 id="æ£€æŸ¥-utf-8-ç¼–ç " tabindex="-1"><a class="header-anchor" href="#æ£€æŸ¥-utf-8-ç¼–ç "><span>æ£€æŸ¥ UTF-8 ç¼–ç </span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">isEncoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;UTF-8 is a valid encoding!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;UTF-8 is NOT a valid encoding!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šæ£€æŸ¥ UTF-8 æ˜¯å¦æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ç¼–ç ã€‚å› ä¸º UTF-8 æ˜¯éå¸¸å¸¸è§ä¸”è¢«å¹¿æ³›æ”¯æŒçš„ç¼–ç ï¼Œæ‰€ä»¥è¿™é‡Œä¼šæ‰“å° <code>&quot;UTF-8 is a valid encoding!&quot;</code>ã€‚</p><h4 id="æ£€æŸ¥ä¸€ä¸ªä¸æ”¯æŒçš„ç¼–ç " tabindex="-1"><a class="header-anchor" href="#æ£€æŸ¥ä¸€ä¸ªä¸æ”¯æŒçš„ç¼–ç "><span>æ£€æŸ¥ä¸€ä¸ªä¸æ”¯æŒçš„ç¼–ç </span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">isEncoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;super-fancy-encoding&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;This encoding is valid!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;This encoding is NOT valid in Node.js.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°è¯•æ£€æŸ¥ä¸€ä¸ªåä¸º <code>super-fancy-encoding</code> çš„ç¼–ç ï¼Œè¿™ä¸æ˜¯ Node.js æ‰€æ”¯æŒçš„ï¼Œæ‰€ä»¥ä¼šè¾“å‡º <code>&quot;This encoding is NOT valid in Node.js.&quot;</code>ã€‚</p><p>æ€»ç»“èµ·æ¥ï¼Œ<code>Buffer.isEncoding(encoding)</code> æ–¹æ³•æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œç”¨äºéªŒè¯å­—ç¬¦ç¼–ç çš„æœ‰æ•ˆæ€§ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†æ¥è‡ªä¸åŒæ¥æºçš„æ–‡æœ¬æ•°æ®æ—¶ï¼Œä¿è¯ç¨‹åºèƒ½å¤Ÿå‡†ç¡®æ— è¯¯åœ°ç†è§£å’Œè½¬æ¢è¿™äº›æ•°æ®ã€‚</p><h3 id="class-property-buffer-poolsize" tabindex="-1"><a class="header-anchor" href="#class-property-buffer-poolsize"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#class-property-bufferpoolsize" target="_blank" rel="noopener noreferrer">Class property: Buffer.poolSize</a></span></a></h3><p>Node.js ä¸­çš„ <code>Buffer</code> å¯¹è±¡æ˜¯ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ã€‚å½“ä½ åœ¨ Node.js ä¸­å¤„ç†æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡æˆ–å…¶ä»– I/Oï¼ˆè¾“å…¥/è¾“å‡ºï¼‰æ“ä½œæ—¶ï¼Œç»å¸¸ä¼šç”¨åˆ°å®ƒä»¬ã€‚è¿™äº›æ“ä½œä¸­çš„æ•°æ®é€šå¸¸ä¸æ˜¯å­—ç¬¦ä¸²å½¢å¼çš„ï¼Œè€Œæ˜¯ä»¥äºŒè¿›åˆ¶çš„å½¢å¼å­˜åœ¨ï¼Œè¿™å°±æ˜¯ <code>Buffer</code> ç±»å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer.poolSize</code> æ˜¯ä¸€ä¸ªé™æ€å±æ€§ï¼Œå®ƒç”¨äºæ§åˆ¶æ‰€è°“çš„ &quot;Buffer pool&quot; çš„å¤§å°ã€‚Buffer pool æ˜¯ä¸€å—é¢„åˆ†é…çš„å†…å­˜åŒºåŸŸï¼Œç”¨æ¥åˆ›å»ºå’Œç®¡ç†å° Buffer å¯¹è±¡ï¼Œè¿™å¯ä»¥ä½¿å¾—å†…å­˜çš„ä½¿ç”¨æ›´åŠ é«˜æ•ˆã€‚</p><h3 id="buffer-poolsize-çš„å·¥ä½œåŸç†" tabindex="-1"><a class="header-anchor" href="#buffer-poolsize-çš„å·¥ä½œåŸç†"><span>Buffer.poolSize çš„å·¥ä½œåŸç†ï¼š</span></a></h3><p>å½“ä½ åˆ›å»ºäº†ä¸€ä¸ªå°äºæˆ–ç­‰äº <code>Buffer.poolSize</code> å¤§å°çš„æ–° Buffer å¯¹è±¡æ—¶ï¼ŒNode.js å®é™…ä¸Šä¼šä»è¿™ä¸ª pool ä¸­åˆ†é…å†…å­˜ç»™è¿™ä¸ªæ–°çš„ Buffer å¯¹è±¡ã€‚å¦‚æœä½ åˆ›å»ºäº†ä¸€ä¸ªå¤§äº <code>Buffer.poolSize</code> çš„ Buffer å¯¹è±¡ï¼Œåˆ™ Node.js ä¼šå•ç‹¬ä¸ºå…¶åˆ†é…å†…å­˜ï¼Œå¹¶ä¸ä¼šä½¿ç”¨ buffer poolã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>Buffer.poolSize</code> çš„å€¼æ˜¯ 8192 å­—èŠ‚ï¼ˆ8KBï¼‰ã€‚ä½†æ˜¯ï¼Œä½ å¯ä»¥æ ¹æ®ä½ çš„åº”ç”¨éœ€æ±‚è°ƒæ•´è¿™ä¸ªå€¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çŸ¥é“ä½ çš„åº”ç”¨å°†è¦é¢‘ç¹åœ°åˆ›å»ºå¾ˆå¤šå°çš„ Buffer å¯¹è±¡ï¼Œä½ å¯ä»¥å¢åŠ  <code>Buffer.poolSize</code> çš„å€¼æ¥æé«˜æ•ˆç‡ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-buffer-poolsize" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-buffer-poolsize"><span>å¦‚ä½•ä½¿ç”¨ Buffer.poolSizeï¼š</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½® Buffer.poolSize ä¸º 16KB</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">poolSize</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 16384</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå°äº 16KB çš„ Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> smallBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">allocUnsafe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1024</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ†é… 1KB ç©ºé—´</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¤§äº 16KB çš„ Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> largeBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">allocUnsafe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">32768</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ†é… 32KB ç©ºé—´</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä»¥ä¸Šçš„ä¾‹å­ä¸­ï¼Œ<code>smallBuffer</code> ä¼šä½¿ç”¨ buffer pool ä¸­çš„å†…å­˜ï¼Œå› ä¸ºå®ƒå°äºæˆ‘ä»¬è®¾ç½®çš„ <code>Buffer.poolSize</code>ã€‚è€Œ <code>largeBuffer</code> åˆ™ä¼šè·å¾—ä¸€å—æ–°çš„ã€æœªä½¿ç”¨è¿‡çš„å†…å­˜åŒºåŸŸã€‚</p><h3 id="å®é™…è¿ç”¨ä¸¾ä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¸¾ä¾‹"><span>å®é™…è¿ç”¨ä¸¾ä¾‹ï¼š</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨æ„å»ºä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œå®ƒéœ€è¦å¤„ç†å¤§é‡çš„å°å›¾ç‰‡ä¸Šä¼ ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¢åŠ  Buffer.poolSize å¯ä»¥æå‡å¤„ç†å¤§é‡å°å‹æ–‡ä»¶çš„æ€§èƒ½</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">poolSize</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 16</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1024</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 16KB</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">http</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å½“æœ‰æ–‡ä»¶æ•°æ®ä¸Šä¼ æ—¶ï¼Œä¼šè§¦å‘ &#39;data&#39; äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // è¿™é‡Œçš„ chunk é»˜è®¤ä¼šå°è¯•ä½¿ç”¨ buffer pool</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">concat</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // æ–‡ä»¶æ•°æ®æ¥æ”¶å®Œæ¯•ï¼Œä¿å­˜åˆ°æœåŠ¡å™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;uploaded_image.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeHead</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Image uploaded!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Server is running on port 3000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å¢åŠ  <code>Buffer.poolSize</code> æ¥æé«˜æœåŠ¡å™¨å¤„ç†å¤§é‡å°æ–‡ä»¶çš„èƒ½åŠ›ã€‚æ¯æ¬¡æ¥æ”¶åˆ° <code>data</code> äº‹ä»¶æ—¶ï¼Œä¼ è¾“çš„æ•°æ®å— <code>chunk</code> å¯èƒ½ä¼šåˆ©ç”¨é¢„å…ˆåˆ†é…çš„ buffer poolï¼Œå‡å°‘å†…å­˜åˆ†é…çš„å¼€é”€ã€‚</p><p>è¯·è®°ä½ï¼Œé€‚å½“åœ°é…ç½® <code>Buffer.poolSize</code> å¯ä»¥æé«˜æ€§èƒ½ï¼Œä½†ä¸æ°å½“çš„é…ç½®ä¹Ÿå¯èƒ½å¯¼è‡´å†…å­˜æµªè´¹ï¼Œæ‰€ä»¥éœ€è¦æ ¹æ®å…·ä½“çš„åº”ç”¨åœºæ™¯æ¥è°ƒæ•´ã€‚</p><h3 id="buf-index" tabindex="-1"><a class="header-anchor" href="#buf-index"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufindex" target="_blank" rel="noopener noreferrer">buf[index]</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼ŒBuffer æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ç±»ã€‚å½“ä½ åœ¨å¤„ç†æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡æˆ–è€…ä»»ä½•å…¶ä»–ç±»å‹çš„åŸå§‹æ•°æ®æµæ—¶ï¼Œå¾ˆå¯èƒ½ä¼šç”¨åˆ° Bufferã€‚</p><p><code>buf[index]</code>è¿™ä¸ªè¡¨è¾¾å¼çš„å«ä¹‰æ˜¯è®¿é—® Buffer å¯¹è±¡<code>buf</code>ä¸­ä½ç½®ä¸º<code>index</code>çš„å­—èŠ‚ã€‚åœ¨ Node.js é‡Œï¼ŒBuffer çš„å†…å®¹æ˜¯ä»¥ä¸€ç³»åˆ—å­—èŠ‚çš„å½¢å¼å­˜å‚¨çš„ï¼Œè¿™äº›å­—èŠ‚éƒ½æ˜¯ 0 åˆ° 255 ä¹‹é—´çš„æ•´æ•°ï¼ˆå³ 8 ä½æ— ç¬¦å·æ•´æ•°ï¼‰ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ª Buffer å¯¹è±¡ï¼Œå¹¶ä¸”æƒ³è¦è·å–ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œä½ å¯ä»¥åƒè¿™æ ·æ“ä½œï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«æ•°å­—1, 2, 3, 4, 5çš„Buffer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>buf[0]</code>ä¼šè¿”å› Buffer ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå…¶å€¼ä¸º 1ã€‚</p><p>å†ä¸¾ä¸€ä¸ªä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hello world&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«&quot;hello world&quot;æ–‡æœ¬çš„Buffer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 104 (å› ä¸º&#39;h&#39;å­—ç¬¦åœ¨UTF-8ç¼–ç ä¸­å¯¹åº”104)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fromCharCode</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">])); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: h ï¼ˆå°†æ•°å­—è½¬æ¢å›å­—ç¬¦ï¼‰</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ç¬¬äºŒä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºäº†ä¸€ä¸ªåŒ…å«å­—ç¬¦ä¸²&quot;hello world&quot;çš„ Bufferã€‚ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡<code>buf[0]</code>è®¿é—®äº† Buffer çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œå®ƒè¿”å›äº† 104ï¼Œå› ä¸ºåœ¨ UTF-8 ç¼–ç ä¸­ï¼Œå­—ç¬¦&#39;h&#39;çš„ç¼–ç å€¼å°±æ˜¯ 104ã€‚æœ€åæˆ‘ä»¬ä½¿ç”¨<code>String.fromCharCode</code>æ–¹æ³•å°†è¿™ä¸ªæ•°å€¼è½¬æ¢æˆäº†å¯¹åº”çš„å­—ç¬¦&#39;h&#39;ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç›´æ¥é€šè¿‡ç´¢å¼•è®¿é—® Buffer ä¸­çš„æ•°æ®æ—¶ï¼Œä½ å¾—åˆ°çš„æ˜¯åŸå§‹çš„å­—èŠ‚å€¼ï¼Œè€Œéå­—ç¬¦ã€‚å¦‚æœ Buffer åŒ…å«æ–‡æœ¬æ•°æ®ï¼Œä½ å¯èƒ½æ›´å¤šçš„æ˜¯å¸Œæœ›é€šè¿‡å­—ç¬¦ä¸²çš„å½¢å¼æ¥å¤„ç†å®ƒï¼Œè¿™æ—¶å€™ä½ å¯ä»¥ä½¿ç”¨<code>buffer.toString()</code>æ–¹æ³•ã€‚</p><p>ä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hello world&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: hello world</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•å°†æ•´ä¸ª Buffer å¯¹è±¡è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™æ ·å°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æŸ¥çœ‹å’Œå¤„ç†é‡Œé¢çš„æ–‡æœ¬å†…å®¹äº†ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>buf[index]</code>å°±æ˜¯è®¿é—® Buffer å¯¹è±¡ä¸­æŒ‡å®šç´¢å¼•å¤„çš„å­—èŠ‚ï¼Œè¿™å…è®¸ä½ è¯»å–å’Œä¿®æ”¹ Buffer ä¸­å­˜å‚¨çš„äºŒè¿›åˆ¶æ•°æ®ã€‚è¿™åœ¨å¤„ç† I/O æ“ä½œæ—¶ç‰¹åˆ«é‡è¦ï¼Œæ¯”å¦‚ä»æ–‡ä»¶ä¸­è¯»å–å†…å®¹æˆ–å‘ç½‘é¡µå‘é€æ•°æ®ç­‰ã€‚</p><h3 id="buf-buffer" tabindex="-1"><a class="header-anchor" href="#buf-buffer"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufbuffer" target="_blank" rel="noopener noreferrer">buf.buffer</a></span></a></h3><p><code>buf.buffer</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒå±äº <code>Buffer</code> ç±»ã€‚<code>Buffer</code> ç±»æ˜¯ Node.js ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ä¸€ç§æ–¹å¼ã€‚åœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å¤„ç†çš„æ˜¯å­—ç¬¦ä¸²æˆ–è€…å¯¹è±¡ç­‰ç±»å‹çš„æ•°æ®ï¼Œä½†å½“æˆ‘ä»¬éœ€è¦å¤„ç†åƒæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶æ•°æ®ã€ç½‘ç»œé€šä¿¡ä¸­ä¼ è¾“çš„æ•°æ®æ—¶ï¼Œè¿™äº›æ•°æ®å¾€å¾€æ˜¯ä»¥äºŒè¿›åˆ¶æµçš„å½¢å¼å­˜åœ¨çš„ã€‚å› æ­¤ï¼ŒNode.js æä¾›äº† <code>Buffer</code> ç±»æ¥å¸®åŠ©å¼€å‘è€…æ›´åŠ æ–¹ä¾¿åœ°æ“ä½œè¿™ç±»äºŒè¿›åˆ¶æ•°æ®ã€‚</p><h3 id="buf-buffer-çš„å®šä¹‰" tabindex="-1"><a class="header-anchor" href="#buf-buffer-çš„å®šä¹‰"><span>buf.buffer çš„å®šä¹‰</span></a></h3><p><code>buf.buffer</code> å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªæŒ‡å‘è¿™ä¸ª <code>Buffer</code> å¯¹è±¡æ‰€å¯¹åº”çš„åº•å±‚ ArrayBuffer å¯¹è±¡çš„å¼•ç”¨ã€‚ArrayBuffer æ˜¯ä¸€ä¸ªè¡¨ç¤ºå›ºå®šé•¿åº¦åŸå§‹äºŒè¿›åˆ¶æ•°æ®ç¼“å†²åŒºçš„ JavaScript å¯¹è±¡ï¼Œè€Œ Buffer ç±»æ˜¯åœ¨ ArrayBuffer çš„åŸºç¡€ä¸Šè¿›è¡Œäº†å°è£…ï¼Œæä¾›äº†æ›´å¤šçš„æ–¹æ³•æ¥æ“ä½œäºŒè¿›åˆ¶æ•°æ®ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-buf-buffer" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-buf-buffer"><span>å¦‚ä½•ä½¿ç”¨ buf.buffer</span></a></h3><p>å½“ä½ åˆ›å»ºäº†ä¸€ä¸ª <code>Buffer</code> å®ä¾‹ä¹‹åï¼Œå¯ä»¥é€šè¿‡ <code>buf.buffer</code> å±æ€§æ¥è®¿é—®åº•å±‚çš„ ArrayBuffer å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>Buffer</code> çš„æ•°æ®å¯èƒ½åªæ˜¯è¿™ä¸ª ArrayBuffer çš„ä¸€éƒ¨åˆ†ã€‚è¿˜æœ‰ <code>byteOffset</code> å’Œ <code>length</code> å±æ€§å¯ä»¥ç»™å‡º <code>Buffer</code> åœ¨åº•å±‚ ArrayBuffer ä¸­å¼€å§‹å’Œç»“æŸçš„ä½ç½®ã€‚</p><h3 id="ä¸¾ä¾‹è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#ä¸¾ä¾‹è¯´æ˜"><span>ä¸¾ä¾‹è¯´æ˜</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®å¹¶è¿›è¡Œå¤„ç†ï¼Œæˆ–è€…ä½ è¦å¤„ç†ä»ç½‘ç»œè¯·æ±‚æ”¶åˆ°çš„æ•°æ®åŒ…ã€‚ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨ <code>Buffer</code> å’Œ <code>buf.buffer</code> çš„ä¸€ä¸ªç®€å•ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬ä»æ–‡ä»¶ç³»ç»Ÿä¸­è¯»å–ä¸€ä¸ªæ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿™é‡Œçš„ buf å°±æ˜¯æ–‡ä»¶å†…å®¹çš„ Buffer è¡¨ç¤º</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä½¿ç”¨ buf.buffer è·å– ArrayBuffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> arrayBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">arrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è·å– Buffer çš„ byteOffsetï¼ˆå­—èŠ‚åç§»é‡ï¼‰å’Œ lengthï¼ˆé•¿åº¦ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">byteOffset</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åšå…¶ä»–éœ€è¦ç›´æ¥æ“ä½œ ArrayBuffer çš„æ“ä½œ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† Node.js çš„ <code>fs</code> æ¨¡å—æ¥å¼‚æ­¥åœ°è¯»å–ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡ä»¶ã€‚è¯»å–æ“ä½œå®Œæˆåï¼Œå›è°ƒå‡½æ•°ä¼šè¢«æ‰§è¡Œï¼Œå›è°ƒå‡½æ•°æ¥æ”¶äº†ä¸¤ä¸ªå‚æ•°ï¼š<code>err</code> å’Œ <code>buf</code>ã€‚å¦‚æœè¯»å–æˆåŠŸï¼Œ<code>err</code> å°†ä¸º <code>null</code>ï¼Œè€Œ <code>buf</code> å°†åŒ…å«æ–‡ä»¶çš„å†…å®¹ï¼Œä»¥ <code>Buffer</code> å½¢å¼è¡¨ç¤ºã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>buf.buffer</code> æ¥è®¿é—®ä¸ <code>buf</code> ç›¸å…³è”çš„ ArrayBufferã€‚ä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ª ArrayBuffer æ¥è¿›è¡Œæ›´åº•å±‚çš„äºŒè¿›åˆ¶æ•°æ®æ“ä½œï¼Œä¾‹å¦‚ï¼Œä¼ é€’ç»™ Web APIs æˆ–è€…å…¶ä»–å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„åº“ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç›´æ¥æ“ä½œ ArrayBuffer å¯èƒ½ä¼šæ›´å¤æ‚ï¼Œå¹¶ä¸”éœ€è¦å¯¹äºŒè¿›åˆ¶æ•°æ®çš„æ“ä½œæœ‰æ›´æ·±å…¥çš„ç†è§£ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç›´æ¥ä½¿ç”¨ <code>Buffer</code> æä¾›çš„æ–¹æ³•ä¼šæ›´å®‰å…¨ã€æ›´æ–¹ä¾¿ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>buf.buffer</code> æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å±æ€§ï¼Œå®ƒå…è®¸ä½ åœ¨éœ€è¦æ—¶è®¿é—® Buffer çš„åº•å±‚äºŒè¿›åˆ¶æ•°æ®ã€‚ç„¶è€Œï¼Œåœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œç›´æ¥ä½¿ç”¨ Buffer çš„æ–¹æ³•æ¥å¤„ç†æ•°æ®é€šå¸¸å·²ç»è¶³å¤Ÿäº†ã€‚</p><h3 id="buf-byteoffset" tabindex="-1"><a class="header-anchor" href="#buf-byteoffset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufbyteoffset" target="_blank" rel="noopener noreferrer">buf.byteOffset</a></span></a></h3><p><code>buf.byteOffset</code> æ˜¯ Node.js ä¸­ Buffer å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ã€‚åœ¨è§£é‡Šè¿™ä¸ªå±æ€§ä¹‹å‰ï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹ Buffer æ˜¯ä»€ä¹ˆã€‚</p><p>Buffer æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ç±»ã€‚åœ¨è¿›è¡Œæ–‡ä»¶æ“ä½œã€ç½‘ç»œé€šä¿¡ç­‰éœ€è¦å¤„ç†å¤§é‡äºŒè¿›åˆ¶æ•°æ®çš„åœºæ™¯æ—¶ï¼Œä½ ä¼šç»å¸¸ç”¨åˆ° Bufferã€‚å› ä¸º JavaScript æœ€åˆæ˜¯è®¾è®¡æ¥å¤„ç†æ–‡æœ¬çš„ï¼Œæ‰€ä»¥å¯¹äºäºŒè¿›åˆ¶æ•°æ®çš„æ”¯æŒå¹¶ä¸æ˜¯å¾ˆå¥½ï¼ŒBuffer ç±»å°±æ˜¯ä¸ºäº†å¼¥è¡¥è¿™ä¸€ä¸è¶³è€Œå¼•å…¥çš„ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥è°ˆè°ˆ<code>buf.byteOffset</code>ã€‚</p><p>å½“ä½ åˆ›å»ºä¸€ä¸ª Buffer å¯¹è±¡ï¼Œå®ƒå®è´¨ä¸Šæ˜¯åˆ†é…äº†ä¸€æ®µå†…å­˜ç©ºé—´ç”¨äºå­˜å‚¨æ•°æ®ã€‚ç„¶è€Œï¼Œè¿™æ®µå†…å­˜å¯èƒ½åªæ˜¯ä¸€ä¸ªæ›´å¤§çš„ ArrayBuffer å¯¹è±¡çš„ä¸€éƒ¨åˆ†ã€‚å¦‚æœä½ ä¸ç†Ÿæ‚‰ ArrayBufferï¼Œå¯ä»¥å°†å®ƒæƒ³è±¡æˆä¸€ä¸ªä½çº§çš„ã€å›ºå®šå¤§å°çš„å†…å­˜å—ï¼ŒJavaScript çš„ TypedArray æˆ– Buffer å¯ä»¥ç”¨æ¥è¯»å†™è¿™å—å†…å­˜ã€‚</p><p>å±æ€§<code>buf.byteOffset</code>è¡¨ç¤ºçš„æ˜¯å½“å‰ Buffer å¯¹è±¡åœ¨å…¶åº•å±‚ ArrayBuffer ä¸­çš„èµ·å§‹ä½ç½®ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒå‘Šè¯‰ä½ ä» Buffer çš„å“ªä¸ªä½ç½®å¼€å§‹å¯¹åº”äºåŸå§‹ ArrayBuffer çš„å†…å­˜ã€‚è¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå•ä½æ˜¯å­—èŠ‚ã€‚</p><h3 id="å®é™…ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-3"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾æœ‰ä¸€ä¸ª ArrayBuffer å¯¹è±¡ï¼Œå®ƒåŒ…å«äº† 16 ä¸ªå­—èŠ‚ï¼ˆbytesï¼‰çš„æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> arrayBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> ArrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç°åœ¨ï¼Œæˆ‘ä»¬åŸºäºè¿™ä¸ª ArrayBuffer åˆ›å»ºä¸€ä¸ª Buffer å¯¹è±¡ï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³ä»ç¬¬ 8 ä¸ªå­—èŠ‚å¼€å§‹åˆ°æœ«å°¾åˆ›å»ºè¿™ä¸ª Bufferã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">arrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>åœ¨è¿™é‡Œï¼Œ<code>buffer</code>å°†ä¼šæ˜¯ä¸€ä¸ªæ–°çš„ Bufferï¼Œå®ƒçš„å†…å®¹æ˜ å°„äº†åŸå§‹ ArrayBuffer çš„ååŠæ®µï¼ˆå³ä»ç¬¬ 8 ä¸ªå­—èŠ‚å¼€å§‹ï¼‰ã€‚è¿™æ—¶å€™ï¼Œ<code>buffer.byteOffset</code>çš„å€¼å°†ä¼šæ˜¯ 8ï¼Œå› ä¸º Buffer å¼€å§‹çš„ä½ç½®æ˜¯åŸå§‹ ArrayBuffer çš„ç¬¬ 8 ä¸ªå­—èŠ‚ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">byteOffset</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š8</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>é€šè¿‡<code>byteOffset</code>ï¼Œä½ å¯ä»¥çŸ¥é“ä»»ä½•ç»™å®š Buffer å¯¹è±¡ç›¸å¯¹äºå®ƒçš„ ArrayBuffer çš„èµ·å§‹ä½ç½®ï¼Œè¿™åœ¨å¤„ç†å¤æ‚çš„äºŒè¿›åˆ¶æ•°æ®ç»“æ„æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æ­£åœ¨è§£æä¸€ä¸ªç”±è®¸å¤šå°éƒ¨åˆ†ç»„æˆçš„å¤§å‹äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸”ä½ å¸Œæœ›èƒ½å¤Ÿæ ¹æ®æ¯ä¸€éƒ¨åˆ†çš„ç›¸å¯¹ä½ç½®æ¥ç®¡ç†å®ƒä»¬ã€‚</p><p>è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ Buffer API ä¸­ç›´æ¥ä½¿ç”¨<code>Buffer.from()</code>åˆ›å»º Buffer æ—¶ï¼Œé€šå¸¸<code>byteOffset</code>å°†ä¼šæ˜¯ 0ï¼Œå› ä¸ºé»˜è®¤æƒ…å†µä¸‹ Buffer ä¼šæ‹¥æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´ï¼Œè€Œä¸æ˜¯ä½œä¸ºæŸä¸ªæ›´å¤§ ArrayBuffer çš„ä¸€éƒ¨åˆ†ã€‚<code>byteOffset</code>ä¸»è¦åœ¨ä½ é€šè¿‡æ„é€ å‡½æ•°æ˜¾å¼åœ°ä»ä¸€ä¸ª ArrayBuffer åˆ›å»º Buffer çš„ä¸€éƒ¨åˆ†æ—¶æ‰ä¼šå˜å¾—é‡è¦ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>buf.byteOffset</code>æ˜¯ä¸€ä¸ªéå¸¸æŠ€æœ¯æ€§çš„å±æ€§ï¼Œå®ƒç”¨äºç²¾ç¡®æ§åˆ¶å’Œç†è§£ Buffer å¯¹è±¡åœ¨åº•å±‚ ArrayBuffer ä¸­çš„ä½ç½®ã€‚å¯¹äºæ™®é€šç”¨æˆ·æ¥è¯´ï¼Œè¿™ä¸ªå±æ€§åœ¨æ—¥å¸¸ç¼–ç¨‹ä¸­å¯èƒ½ä¸ä¼šç»å¸¸ç”¨åˆ°ï¼Œä½†åœ¨éœ€è¦è¿›è¡Œè¾ƒä¸ºåº•å±‚çš„äºŒè¿›åˆ¶æ•°æ®æ“ä½œæ—¶ï¼Œäº†è§£å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ä¼šéå¸¸æœ‰ç”¨ã€‚</p><h3 id="buf-compare-target-targetstart-targetend-sourcestart-sourceend" tabindex="-1"><a class="header-anchor" href="#buf-compare-target-targetstart-targetend-sourcestart-sourceend"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufcomparetarget-targetstart-targetend-sourcestart-sourceend" target="_blank" rel="noopener noreferrer">buf.compare(target[, targetStart[, targetEnd[, sourceStart[, sourceEnd]]]])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘æ¥å¸®ä½ ç†è§£ Node.js ä¸­çš„ <code>buf.compare()</code> æ–¹æ³•ã€‚</p><p>é¦–å…ˆï¼Œ<code>Buffer</code> åœ¨ Node.js ä¸­æ˜¯ä¸€ç§ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„å¯¹è±¡ã€‚æˆ‘ä»¬å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯ä¸€ä¸ªå¯ä»¥å­˜å‚¨å¤šä¸ªå­—èŠ‚çš„æ•°ç»„ï¼ˆè™½ç„¶å®é™…ä¸Šå®ƒæ˜¯æ›´åº•å±‚çš„æ•°æ®ç»“æ„ï¼‰ã€‚</p><p>å½“æˆ‘ä»¬ä½¿ç”¨ <code>buf.compare()</code> æ–¹æ³•æ—¶ï¼Œå…¶ç›®çš„æ˜¯ä¸ºäº†æ¯”è¾ƒä¸¤ä¸ª Buffer å¯¹è±¡ä¸­çš„æ•°æ®ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªæ•°å­—æ¥è¡¨ç¤ºæ¯”è¾ƒçš„ç»“æœã€‚</p><p>ä¸‹é¢æ˜¯å‚æ•°çš„æ„ä¹‰ï¼š</p><ul><li><code>target</code>: ä½ æƒ³è¦æ¯”è¾ƒçš„ç›®æ ‡ Bufferã€‚</li><li><code>targetStart</code>: ç›®æ ‡ Buffer çš„å¼€å§‹ä½ç½®ï¼ˆå¯é€‰å‚æ•°ï¼Œé»˜è®¤å€¼æ˜¯ 0ï¼‰ã€‚</li><li><code>targetEnd</code>: ç›®æ ‡ Buffer çš„ç»“æŸä½ç½®ï¼ˆå¯é€‰å‚æ•°ï¼Œé»˜è®¤å€¼æ˜¯ target.lengthï¼‰ã€‚</li><li><code>sourceStart</code>: æº Bufferï¼ˆå³è°ƒç”¨ compare æ–¹æ³•çš„ Bufferï¼‰å¼€å§‹ä½ç½®ï¼ˆå¯é€‰å‚æ•°ï¼Œé»˜è®¤å€¼æ˜¯ 0ï¼‰ã€‚</li><li><code>sourceEnd</code>: æº Buffer çš„ç»“æŸä½ç½®ï¼ˆå¯é€‰å‚æ•°ï¼Œé»˜è®¤å€¼æ˜¯ buf.lengthï¼‰ã€‚</li></ul><p><code>compare</code> æ–¹æ³•çš„è¿”å›å€¼ï¼š</p><ul><li>è¿”å› <code>0</code> è¡¨ç¤ºä¸¤ä¸ª Buffer æ˜¯ç›¸ç­‰çš„ã€‚</li><li>è¿”å› <code>1</code> è¡¨ç¤ºæº Buffer åœ¨æ’åºååº”è¯¥æ’åœ¨ç›®æ ‡ Buffer åé¢ã€‚</li><li>è¿”å› <code>-1</code> è¡¨ç¤ºæº Buffer åœ¨æ’åºååº”è¯¥æ’åœ¨ç›®æ ‡ Buffer å‰é¢ã€‚</li></ul><p>ç°åœ¨è®©æˆ‘ä»¬é€šè¿‡å‡ ä¸ªä¾‹å­æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨å®ƒï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;1234&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;0123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf3</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;1234&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¯”è¾ƒ buf1 å’Œ buf2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">compare</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå¤§äº 0 (ä¾‹å¦‚ 1)ï¼Œå› ä¸º &#39;1234&#39; &gt; &#39;0123&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¯”è¾ƒ buf1 å’Œ buf3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">compare</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º 0ï¼Œå› ä¸ºä¸¤è€…ç›¸åŒ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¯”è¾ƒ buf2 å’Œ buf1ï¼Œæ³¨æ„é¡ºåºå˜äº†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">compare</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå°äº 0 (ä¾‹å¦‚ -1)ï¼Œå› ä¸º &#39;0123&#39; `&lt;` &#39;1234&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åªæ¯”è¾ƒæŸä¸€éƒ¨åˆ†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf4</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;5678&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">compare</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå°äº 0 (ä¾‹å¦‚ -1)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è§£é‡Šï¼šè¿™é‡Œæˆ‘ä»¬æ¯”è¾ƒçš„æ˜¯ buf1 çš„ç¬¬ 2 åˆ°ç¬¬ 3 ä½çš„å­é›†ï¼ˆ234ï¼‰ä¸ buf4ï¼ˆ5678ï¼‰æ•´ä½“ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å› ä¸º &#39;234&#39; `&lt;` &#39;5678&#39;ï¼Œæ‰€ä»¥è¾“å‡ºä¸º -1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†å‡ ä¸ª Buffer å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨äº† <code>.compare()</code> æ–¹æ³•æ¥æ¯”è¾ƒå®ƒä»¬çš„å†…å®¹ã€‚æ³¨æ„åˆ°æ¯”è¾ƒä¸ä»…å¯ä»¥é’ˆå¯¹æ•´ä¸ª Bufferï¼Œè¿˜å¯ä»¥æŒ‡å®šå„è‡ª Buffer çš„æŸä¸ªå­èŒƒå›´è¿›è¡Œæ¯”è¾ƒã€‚é€šè¿‡æ¯”è¾ƒç»“æœï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å“ªä¸ª Buffer åº”è¯¥æ’åœ¨å‰é¢ï¼Œå°±åƒå­—ç¬¦ä¸²ä¹‹é—´çš„æ¯”è¾ƒä¸€æ ·ã€‚</p><p>å¸Œæœ›è¿™äº›ä¾‹å­å¸®åŠ©ä½ ç†è§£äº† <code>buf.compare()</code> æ–¹æ³•çš„ç”¨é€”å’Œå·¥ä½œæ–¹å¼ï¼</p><h3 id="buf-copy-target-targetstart-sourcestart-sourceend" tabindex="-1"><a class="header-anchor" href="#buf-copy-target-targetstart-sourcestart-sourceend"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufcopytarget-targetstart-sourcestart-sourceend" target="_blank" rel="noopener noreferrer">buf.copy(target[, targetStart[, sourceStart[, sourceEnd]]])</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘ä»¬æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹è¿™ä¸ª <code>buf.copy</code> æ–¹æ³•ã€‚</p><p>åœ¨ Node.js ä¸­ï¼ŒBuffer æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ç±»ã€‚æƒ³è±¡ä¸€ä¸‹æœ‰æ—¶ä½ éœ€è¦å°†ä¸€æ®µå­˜å‚¨åœ¨ Buffer ä¸­çš„æ•°æ®å¤åˆ¶åˆ°å¦ä¸€ä¸ª Buffer ä¸­å»ï¼Œè¿™æ­£æ˜¯ <code>buf.copy</code> æ–¹æ³•çš„ä½œç”¨ã€‚</p><p><code>buf.copy</code> æ–¹æ³•å…è®¸ä½ å°†æ•°æ®ä»ä¸€ä¸ª Buffer (<code>buf</code>) å¤åˆ¶åˆ°å¦ä¸€ä¸ª Buffer (<code>target</code>) ä¸­ã€‚è¯¥æ–¹æ³•æ¥æ”¶å‡ ä¸ªå‚æ•°ï¼Œå®ƒä»¬åˆ†åˆ«æ§åˆ¶ç€å¤åˆ¶è¡Œä¸ºçš„ä¸åŒæ–¹é¢ï¼š</p><ol><li><code>target</code>: è¿™æ˜¯è¦å°†æ•°æ®å¤åˆ¶è¿›å»çš„ç›®æ ‡ Bufferã€‚</li><li><code>targetStart</code>(å¯é€‰): è¿™æ˜¯ç›®æ ‡ Buffer ä¸­å¼€å§‹å¤åˆ¶è¿›æ•°æ®çš„ä½ç½®ï¼Œé»˜è®¤å€¼ä¸º 0ã€‚</li><li><code>sourceStart</code>(å¯é€‰): è¿™æ˜¯æº Buffer (<code>buf</code>) ä¸­å¼€å§‹å¤åˆ¶æ•°æ®çš„ä½ç½®ï¼Œé»˜è®¤å€¼ä¸º 0ã€‚</li><li><code>sourceEnd</code>(å¯é€‰): è¿™æ˜¯æº Buffer (<code>buf</code>) ä¸­ç»“æŸå¤åˆ¶æ•°æ®çš„ä½ç½®ï¼ˆä¸åŒ…æ‹¬è¿™ä¸ªä½ç½®æœ¬èº«ï¼‰ï¼Œé»˜è®¤å€¼ä¸º <code>buf.length</code>ã€‚</li></ol><h3 id="å®é™…ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-4"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ª Buffer å¯¹è±¡ï¼Œä¸€ä¸ªåŒ…å«äº†ä¸€äº›æ•°æ®ï¼Œå¦ä¸€ä¸ªæ˜¯æˆ‘ä»¬å¸Œæœ›å¤åˆ¶æ•°æ®åˆ°å…¶ä¸­çš„ç›®æ ‡ Bufferã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å« ASCII å­—ç¬¦ &#39;abcd&#39; çš„ Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;abcd&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªç›®æ ‡ Bufferï¼Œé•¿åº¦ä¸º 6 ä¸ªå­—èŠ‚ã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> target</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨æˆ‘ä»¬è°ƒç”¨ buf.copy æ–¹æ³•å¤åˆ¶æ•°æ®ã€‚</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬æƒ³æŠŠ &#39;ab&#39; å¤åˆ¶åˆ°ç›®æ ‡ Buffer ä¸­ï¼Œå› æ­¤è®¾ç½® sourceStart ä¸º 0ï¼ŒsourceEnd ä¸º 2ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">copy</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">target</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">target</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// `&lt;`Buffer 61 62 00 00 00 00&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">target</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// &#39;ab&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŠŠæº Buffer (<code>buf</code>) ä¸­ä»ä½ç½® 0 åˆ°ä½ç½® 2ï¼ˆä¸åŒ…æ‹¬ä½ç½® 2ï¼‰çš„æ•°æ®å¤åˆ¶åˆ°äº†ç›®æ ‡ Buffer (<code>target</code>) ä¸­ã€‚ç»“æœï¼Œç›®æ ‡ Buffer å‰ä¸¤ä¸ªå­—èŠ‚å˜æˆäº† <code>61 62</code>ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯å­—ç¬¦ &#39;a&#39; å’Œ &#39;b&#39; çš„ ASCII ç ã€‚åé¢çš„å››ä¸ªå­—èŠ‚ä»ç„¶æ˜¯ 0ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰å¤åˆ¶ä»»ä½•å†…å®¹åˆ°é‚£äº›ä½ç½®ã€‚</p><h3 id="æ›´å¤æ‚çš„ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#æ›´å¤æ‚çš„ä¾‹å­"><span>æ›´å¤æ‚çš„ä¾‹å­</span></a></h3><p>ç°åœ¨å‡è®¾æˆ‘ä»¬æƒ³åœ¨ç›®æ ‡ Buffer çš„ä¸­é—´å¼€å§‹å¤åˆ¶æ•°æ®ï¼Œè€Œä¸”åªå¤åˆ¶æº Buffer çš„ä¸€éƒ¨åˆ†æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç»§ç»­ä½¿ç”¨ä¸Šé¢çš„ buf (&#39;abcd&#39;) å’Œ target (ä¹‹å‰ä¿®æ”¹è¿‡çš„ï¼Œç°åœ¨åŒ…å«å­—ç¬¦ä¸² &#39;ab&#39;)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æƒ³ä»æº Buffer çš„ç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹å¤åˆ¶ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¹¶ä¸”å°†å…¶å¤åˆ¶åˆ°ç›®æ ‡ Buffer çš„ç¬¬ä¸‰ä¸ªä½ç½®ï¼ˆç´¢å¼•ä¸º 2 çš„åœ°æ–¹ï¼‰ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">copy</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">target</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">target</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// `&lt;`Buffer 61 62 62 63 00 00&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">target</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// &#39;abb&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™æ¬¡æ“ä½œä¸­ï¼Œæˆ‘ä»¬ä»æº Buffer (<code>buf</code>) çš„ä½ç½® 1 å¤åˆ¶åˆ°ä½ç½® 3ï¼ˆä¸åŒ…æ‹¬ä½ç½® 3ï¼‰ï¼Œå³åªå¤åˆ¶äº†å­—ç¬¦ &#39;b&#39; (ASCII <code>62</code>) å’Œ &#39;c&#39; (ASCII <code>63</code>)ã€‚ç„¶åæˆ‘ä»¬å°†è¿™æ®µæ•°æ®ç²˜è´´åˆ°ç›®æ ‡ Buffer çš„ä½ç½® 2 å¼€å§‹çš„åœ°æ–¹ï¼Œæ‰€ä»¥æœ€ç»ˆç›®æ ‡ Buffer å˜æˆäº† <code>61 62 62 63 00 00</code>ï¼Œå½“è½¬æ¢æˆå­—ç¬¦ä¸²æ—¶å°±æ˜¯ &quot;abb&quot; åŠ ä¸Šä¸‰ä¸ªç©ºå­—ç¬¦ã€‚</p><p>å¸Œæœ›ä»¥ä¸Šè§£é‡Šå’Œä¾‹å­èƒ½å¸®åŠ©ä½ ç†è§£å¦‚ä½•ä½¿ç”¨ Node.js ä¸­çš„ <code>buf.copy</code> æ–¹æ³•ï¼</p><h3 id="buf-entries" tabindex="-1"><a class="header-anchor" href="#buf-entries"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufentries" target="_blank" rel="noopener noreferrer">buf.entries()</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code>å¯¹è±¡æ˜¯ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€å †åŸå§‹çš„æ•°å­—æˆ–è€…å­—æ¯ï¼Œå®ƒä»¬ä»¥ä¸€ç§ç‰¹æ®Šæ ¼å¼å­˜å‚¨ï¼ˆä¾‹å¦‚ï¼šå›¾ç‰‡ã€éŸ³é¢‘æ–‡ä»¶ç­‰ï¼‰ï¼Œè¿™äº›æ•°æ®å°±å¯ä»¥ç”¨ Buffer æ¥è¡¨ç¤ºå’Œæ“ä½œã€‚</p><p><code>buf.entries()</code>æ–¹æ³•æ˜¯ Buffer å¯¹è±¡æä¾›çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå…è®¸ä½ éå† Buffer ä¸­çš„å†…å®¹ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªè¿­ä»£å™¨(iterator)ï¼Œè¿™ä¸ªè¿­ä»£å™¨ä¼šäº§ç”Ÿé”®å€¼å¯¹ï¼ˆindex-value pairsï¼‰ã€‚æ¯ä¸ªé”®å€¼å¯¹åŒ…å«äº†å…ƒç´ çš„ç´¢å¼•ï¼ˆä» 0 å¼€å§‹çš„ä½ç½®ï¼‰å’Œè¯¥ä½ç½®ä¸Šçš„å­—èŠ‚å€¼ï¼ˆ0 åˆ° 255 ä¹‹é—´çš„æ•´æ•°ï¼‰ã€‚</p><p>å®é™…ä¾‹å­ï¼š</p><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨å†™ä¸€ä¸ªç¨‹åºï¼Œéœ€è¦å¤„ç†ä¸€å¼ å›¾ç‰‡çš„åŸå§‹æ•°æ®ã€‚ä¸ºäº†ç®€åŒ–ï¼Œæˆ‘ä»¬å‡è®¾æœ‰ä¸€ä¸ªéå¸¸å°çš„â€œå›¾ç‰‡â€ï¼Œå®ƒåªåŒ…å«äº† 3 ä¸ªåƒç´ ï¼Œåˆ†åˆ«ç”¨çº¢è‰²ã€ç»¿è‰²å’Œè“è‰²è¡¨ç¤ºã€‚åœ¨äºŒè¿›åˆ¶æ•°æ®ä¸­ï¼Œå¯èƒ½ä¼šç”¨ä¸‰ä¸ªæ•´æ•°æ¥è¡¨ç¤ºè¿™ä¸‰ä¸ªé¢œè‰²ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸‰ä¸ªå…ƒç´ çš„Bufferã€‚</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¾‹å¦‚: 255ä»£è¡¨çº¢è‰², 128ä»£è¡¨ç»¿è‰², 64ä»£è¡¨è“è‰²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">255</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ `entries()` æ–¹æ³•åˆ›å»ºè¿­ä»£å™¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iterator</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// éå†iterator</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">index</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">of</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> iterator</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Pixel at index </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> has value </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">value</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ä½ è¿è¡Œè¿™æ®µä»£ç æ—¶ï¼Œå®ƒå°†è¾“å‡ºï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>Pixel at index 0 has value 255</span></span>
<span class="line"><span>Pixel at index 1 has value 128</span></span>
<span class="line"><span>Pixel at index 2 has value 64</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„ä½¿ç”¨åœºæ™¯ï¼Œå…¶ä¸­æˆ‘ä»¬é€šè¿‡<code>buf.entries()</code>è·å–äº†æ¯ä¸ªåƒç´ çš„ç´¢å¼•å’Œå¯¹åº”çš„é¢œè‰²å€¼ã€‚è¿™æ ·çš„æ–¹æ³•åœ¨å¤„ç†å›¾åƒæ•°æ®ã€è§£ææ–‡ä»¶æ ¼å¼æˆ–è€…ä»»ä½•æ¶‰åŠåˆ°æŒ‰ç´¢å¼•æ“ä½œäºŒè¿›åˆ¶æ•°æ®çš„åœ°æ–¹éƒ½éå¸¸æœ‰ç”¨ã€‚</p><h3 id="buf-equals-otherbuffer" tabindex="-1"><a class="header-anchor" href="#buf-equals-otherbuffer"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufequalsotherbuffer" target="_blank" rel="noopener noreferrer">buf.equals(otherBuffer)</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼ŒBuffer å¯¹è±¡æ˜¯ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ã€‚<code>buf.equals(otherBuffer)</code>æ˜¯ Buffer å¯¹è±¡æä¾›çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨äºæ¯”è¾ƒä¸¤ä¸ª Buffer å¯¹è±¡æ˜¯å¦å®Œå…¨ç›¸ç­‰ã€‚</p><h3 id="è¯¦ç»†é€šä¿—è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#è¯¦ç»†é€šä¿—è§£é‡Š"><span>è¯¦ç»†é€šä¿—è§£é‡Š</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸¤ä»½æ–‡ä»¶æˆ–è€…ä¸¤ä¸²æ•°æ®ï¼Œä½ æƒ³çŸ¥é“ä»–ä»¬æ˜¯å¦æ˜¯å­—èŠ‚å¯¹å­—èŠ‚å®Œå…¨ç›¸åŒçš„ã€‚åœ¨ Node.js ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ Buffer å¯¹è±¡æ¥è¯»å–è¿™äº›æ•°æ®ï¼Œå¹¶ç”¨<code>equals</code>æ–¹æ³•æ¥æ¯”è¾ƒå®ƒä»¬ã€‚</p><p>è¿™å°±åƒä½ æœ‰ä¸¤ç›’ä¸é€æ˜çš„ç å­ï¼Œè€Œä½ æƒ³ç¡®è®¤æ¯ç›’é‡Œçš„ç å­æ’åˆ—å’Œé¢œè‰²æ˜¯å¦å®Œå…¨ä¸€æ ·ã€‚ä½ æ‰“å¼€ç¬¬ä¸€ç›’ï¼Œç”¨ Buffer å¯¹è±¡æŠŠç å­æ’åˆ—æˆä¸€ä¸²ï¼›ç„¶åæ‰“å¼€ç¬¬äºŒç›’ï¼Œä¹ŸåšåŒæ ·çš„æ“ä½œã€‚æœ€åï¼Œä½ ä½¿ç”¨<code>equals</code>æ–¹æ³•æ¥æ¯”è¾ƒè¿™ä¸¤ä¸²ç å­ã€‚å¦‚æœæ¯ä¸ªç å­çš„ä½ç½®å’Œé¢œè‰²éƒ½å¯¹å¾—ä¸Šï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•è¿”å›<code>true</code>ï¼›å³ä½¿åªæœ‰ä¸€ä¸ªç å­ä¸åŒï¼Œå®ƒä¹Ÿä¼šè¿”å›<code>false</code>ã€‚</p><h3 id="ä½¿ç”¨ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­-3"><span>ä½¿ç”¨ä¾‹å­</span></a></h3><p><strong>ä¾‹å­ 1: æ¯”è¾ƒä¸¤ä¸ª Buffer å†…å®¹æ˜¯å¦ç›¸åŒ</strong></p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå†…å®¹åˆ†åˆ«ä¿å­˜ä¸º Buffer å¯¹è±¡<code>buf1</code>å’Œ<code>buf2</code>ã€‚æˆ‘ä»¬æƒ³è¦æ£€æŸ¥è¿™ä¸¤ä¸ª Buffer å¯¹è±¡æ˜¯å¦å®Œå…¨ä¸€è‡´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf3</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello Node.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equals</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼štrueï¼Œå› ä¸ºbuf1å’Œbuf2å†…å®¹ç›¸åŒ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equals</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼šfalseï¼Œå› ä¸ºbuf1å’Œbuf3å†…å®¹ä¸åŒ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä¾‹å­ 2: åœ¨ç½‘ç»œåº”ç”¨ä¸­éªŒè¯æ•°æ®</strong></p><p>å½“ä½ çš„ Node.js æœåŠ¡å™¨é€šè¿‡ç½‘ç»œæ¥æ”¶åˆ°ä¸¤æ®µæ•°æ®ï¼Œä½ å¯èƒ½éœ€è¦éªŒè¯å®ƒä»¬æ˜¯å¦ç›¸ç­‰ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾receivedData1å’ŒreceivedData2æ˜¯ä»ç½‘ç»œè¯·æ±‚ä¸­æ¥æ”¶åˆ°çš„Bufferå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> receivedData1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">someReceivedData1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> receivedData2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">someReceivedData2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">receivedData1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equals</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">receivedData2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ•°æ®åŒ¹é…ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ•°æ®ä¸åŒ¹é…ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœä¸¤ä¸ª Buffer å¯¹è±¡ä»£è¡¨çš„äºŒè¿›åˆ¶æ•°æ®ç›¸åŒï¼Œé‚£ä¹ˆè¾“å‡ºå°†æ˜¯&quot;æ•°æ®åŒ¹é…ï¼&quot;ï¼›å¦åˆ™ï¼Œè¾“å‡ºå°†æ˜¯&quot;æ•°æ®ä¸åŒ¹é…ï¼&quot;ã€‚</p><p>ç®€è¨€ä¹‹ï¼ŒNode.js ä¸­çš„<code>buf.equals(otherBuffer)</code>æ–¹æ³•å…è®¸ä½ å¿«é€Ÿåœ°æ£€æŸ¥ä¸¤ä¸ª Buffer å¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚è¿™åœ¨å¤„ç†æ–‡ä»¶æ¯”è¾ƒã€ç½‘ç»œæ•°æ®æ ¡éªŒæˆ–è€…ä»»ä½•å…¶ä»–éœ€è¦è¿›è¡ŒäºŒè¿›åˆ¶æ¯”è¾ƒçš„åœºæ™¯ä¸­éå¸¸æœ‰ç”¨ã€‚</p><h3 id="buf-fill-value-offset-end-encoding" tabindex="-1"><a class="header-anchor" href="#buf-fill-value-offset-end-encoding"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#buffillvalue-offset-end-encoding" target="_blank" rel="noopener noreferrer">buf.fill(value[, offset[, end]][, encoding])</a></span></a></h3><p><code>buf.fill(value[, offset[, end]][, encoding])</code> æ˜¯ Node.js ä¸­ Buffer å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç”¨äºå¡«å……ï¼ˆæˆ–è€…è¯´è¦†ç›–ï¼‰Buffer é‡Œé¢çš„æ•°æ®ã€‚Buffer æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªç±»ä¼¼äºæ•°ç»„çš„å¯¹è±¡ï¼Œä¸»è¦ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚</p><p>åœ¨è¿™é‡Œè§£é‡Šä¸‹å„ä¸ªå‚æ•°ï¼š</p><ul><li><code>value</code>ï¼šè¿™æ˜¯ä½ æƒ³ç”¨æ¥å¡«å…… Buffer çš„å€¼ã€‚å®ƒå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€ä¸€ä¸ª Buffer å¯¹è±¡ã€æˆ–è€…ä¸€ä¸ªæ•´æ•°ã€‚</li><li><code>offset</code>ï¼ˆå¯é€‰ï¼‰ï¼šè¿™æ˜¯å¼€å§‹å¡«å……çš„èµ·å§‹ä½ç½®ï¼Œé»˜è®¤å€¼æ˜¯ 0ã€‚å¦‚æœä½ ä¸æƒ³ä» Buffer çš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¼€å§‹å¡«å……ï¼Œå°±å¯ä»¥é€šè¿‡è¿™ä¸ªå‚æ•°æŒ‡å®šã€‚</li><li><code>end</code>ï¼ˆå¯é€‰ï¼‰ï¼šè¿™æ˜¯åœæ­¢å¡«å……çš„ä½ç½®ï¼Œé»˜è®¤å€¼æ˜¯ Buffer çš„æœ«å°¾ã€‚åªæœ‰åœ¨<code>offset</code>ä¹‹åå’Œ<code>end</code>ä¹‹å‰çš„éƒ¨åˆ†ä¼šè¢«å¡«å……ã€‚</li><li><code>encoding</code>ï¼ˆå¯é€‰ï¼‰ï¼šå½“ä½ å¡«å……çš„å€¼æ˜¯å­—ç¬¦ä¸²æ—¶ï¼Œä½ å¯ä»¥ç”¨è¿™ä¸ªå‚æ•°æŒ‡å®šå­—ç¬¦ç¼–ç ï¼Œé»˜è®¤æ˜¯<code>utf8</code>ã€‚</li></ul><p>ç°åœ¨æˆ‘ä»¬æ¥ä¸¾å‡ ä¸ªå…·ä½“çš„ä¾‹å­ï¼š</p><p><strong>ä¾‹å­ 1ï¼šç®€å•å¡«å……</strong></p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª 10 å­—èŠ‚é•¿åº¦çš„ Bufferï¼Œå¹¶ä¸”æˆ‘ä»¬å¸Œæœ›å°†æ•´ä¸ª Buffer éƒ½å¡«å……ä¸º ASCII ç çš„&#39;A&#39;ï¼ˆä¹Ÿå°±æ˜¯åè¿›åˆ¶çš„ 65ï¼‰ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º10çš„Bufferï¼Œå¹¶åˆå§‹åŒ–æ‰€æœ‰å­—èŠ‚ä¸º0x00</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fill</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†æ•´ä¸ªBufferå¡«å……ä¸º&#39;A&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š`&lt;`Buffer 41 41 41 41 41 41 41 41 41 41&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä¾‹å­ 2ï¼šä½¿ç”¨åç§»é‡å’Œç»“æŸä½ç½®å¡«å……</strong></p><p>å¦‚æœæˆ‘ä»¬åªæƒ³å¡«å…… Buffer çš„ä¸€éƒ¨åˆ†æ€ä¹ˆåŠï¼Ÿæ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬åªå¡«å……ç¬¬ 3 åˆ°ç¬¬ 6 ä¸ªå­—èŠ‚ä¸º&#39;B&#39;ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fill</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»ç´¢å¼•2å¼€å§‹ï¼Œåˆ°ç´¢å¼•6åœæ­¢ï¼ˆä¸åŒ…æ‹¬ç´¢å¼•6ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š`&lt;`Buffer 00 00 42 42 42 42 00 00 00 00&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä¾‹å­ 3ï¼šå¡«å…… Buffer å¯¹è±¡</strong></p><p>é™¤äº†å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨å¦ä¸€ä¸ª Buffer æ¥è¿›è¡Œå¡«å……ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fill</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨buf2ä¸­çš„å†…å®¹æ¥å¡«å……buf1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š`&lt;`Buffer 01 02 03 01 02 03 01 02 03 01&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>buf2</code> çš„å†…å®¹ä¼šé‡å¤åœ°å¡«å……åˆ° <code>buf1</code> ä¸­ï¼Œç›´åˆ°å¡«æ»¡ <code>buf1</code>ã€‚</p><p><strong>æ€»ç»“</strong></p><p><code>fill</code> æ–¹æ³•åœ¨å¾ˆå¤šæƒ…å†µä¸‹éƒ½å¾ˆæœ‰ç”¨ï¼Œæ¯”å¦‚ï¼š</p><ul><li>å½“ä½ éœ€è¦æ¸…é™¤ Buffer ä¸­çš„æ•æ„Ÿæ•°æ®æ—¶ï¼›</li><li>å½“ä½ æƒ³è¦åˆå§‹åŒ– Buffer ä¸ºæŸä¸ªå›ºå®šçš„å€¼æ—¶ï¼›</li><li>æˆ–è€…å½“ä½ éœ€è¦åˆ›å»ºä¸€ä¸ªç‰¹å®šæ¨¡å¼çš„äºŒè¿›åˆ¶æ•°æ®æ—¶ã€‚</li></ul><p>ç†è§£ Buffer å’Œå®ƒçš„ <code>fill</code> æ–¹æ³•å¯¹äºå¤„ç†ç½‘ç»œé€šä¿¡ã€æ–‡ä»¶ IO ç­‰æ¶‰åŠåˆ°äºŒè¿›åˆ¶æ•°æ®çš„æ“ä½œæ˜¯å¾ˆé‡è¦çš„ã€‚</p><h3 id="buf-includes-value-byteoffset-encoding" tabindex="-1"><a class="header-anchor" href="#buf-includes-value-byteoffset-encoding"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufincludesvalue-byteoffset-encoding" target="_blank" rel="noopener noreferrer">buf.includes(value[, byteOffset][, encoding])</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹ <code>buf.includes(value[, byteOffset][, encoding])</code> è¿™ä¸ªæ–¹æ³•åœ¨ Node.js ä¸­çš„ä½œç”¨ã€‚</p><p>é¦–å…ˆï¼Œ<code>Buffer</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œå®ƒå…è®¸ä½ ç›´æ¥æ“ä½œå†…å­˜ä¸­çš„æ•°æ®ã€‚è¿™é€šå¸¸æ˜¯ç”¨äºå¤„ç†åƒ TCP æµæˆ–æ–‡ä»¶ç³»ç»Ÿæ“ä½œç­‰ I/O ä»»åŠ¡æ—¶çš„äºŒè¿›åˆ¶æ•°æ®æµã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>Buffer</code> å¯¹è±¡æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€ä¸ªå›ºå®šé•¿åº¦çš„å­—èŠ‚åºåˆ—ã€‚</p><p>ç°åœ¨è¯´åˆ° <code>buf.includes()</code> æ–¹æ³•ï¼Œå®ƒæ˜¯ <code>Buffer</code> ç±»ä¸Šçš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºåˆ¤æ–­ Buffer æ˜¯å¦åŒ…å«ç»™å®šçš„å€¼ï¼ˆç±»ä¼¼äº JavaScript æ•°ç»„çš„ <code>includes</code> æ–¹æ³•ï¼‰ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå¦‚æœ Buffer åŒ…å«æŒ‡å®šçš„å€¼ï¼Œå°±è¿”å› <code>true</code>ï¼›å¦‚æœä¸åŒ…å«ï¼Œå°±è¿”å› <code>false</code>ã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>value</code>ï¼šéœ€è¦æœç´¢çš„æ•°æ®ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€ä¸€ä¸ª Buffer æˆ–ä¸€ä¸ªæ•°å­—ã€‚</li><li><code>byteOffset</code>ï¼ˆå¯é€‰ï¼‰ï¼šå¼€å§‹æœç´¢çš„ä½ç½®ï¼Œé»˜è®¤ä¸º 0ï¼Œè¡¨ç¤ºä» Buffer çš„å¼€å¤´å¼€å§‹æœç´¢ã€‚</li><li><code>encoding</code>ï¼ˆå¯é€‰ï¼‰ï¼šå¦‚æœæœç´¢çš„å€¼æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™ä½¿ç”¨è¯¥ç¼–ç æ–¹å¼ã€‚é»˜è®¤æ˜¯ &#39;utf8&#39;ã€‚</li></ul><p>ä¸¾å‡ ä¸ªä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;this is a buffer example&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ includes æ–¹æ³•æ£€æŸ¥ Buffer ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² &quot;example&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">includes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥ Buffer ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² &quot;buffer&quot;ï¼Œä»ç¬¬16ä¸ªå­—èŠ‚å¼€å§‹æœç´¢</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">includes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: false</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥ Buffer ä¸­æ˜¯å¦åŒ…å« ASCII å€¼ä¸º 97 (&#39;a&#39; çš„ ASCII ç¼–ç ) çš„å­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">includes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">97</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ä¸åŒçš„ç¼–ç æ£€æŸ¥ Buffer ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² &quot;example&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">includes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™äº›ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªåŒ…å«æ–‡æœ¬ &#39;this is a buffer example&#39; çš„ Bufferã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>includes</code> æ–¹æ³•æ£€æŸ¥è¿™ä¸ª Buffer æ˜¯å¦åŒ…å«ç‰¹å®šçš„å­—ç¬¦ä¸²æˆ–æ•°å­—ã€‚æˆ‘ä»¬è¿˜æ¼”ç¤ºäº†å¦‚ä½•ä» Buffer çš„ç‰¹å®šä½ç½®å¼€å§‹æœç´¢ï¼Œä»¥åŠå¦‚ä½•æŒ‡å®šå­—ç¬¦ç¼–ç è¿›è¡Œæœç´¢ã€‚</p><p>é€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼Œä½ å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ£€æŸ¥åœ¨å¤„ç†äºŒè¿›åˆ¶æ•°æ®æ—¶ï¼ŒæŸéƒ¨åˆ†æ•°æ®æ˜¯å¦å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œåœ¨ç½‘ç»œåè®®ä¸­ï¼Œå¯èƒ½éœ€è¦æ£€æŸ¥ä¼ å…¥æ•°æ®æ˜¯å¦åŒ…å«ç‰¹å®šçš„æ ‡è®°æˆ–è€…åœ¨å¤„ç†æ–‡æœ¬æ–‡ä»¶æ—¶ï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨æŸä¸ªå…³é”®è¯ã€‚</p><h3 id="buf-indexof-value-byteoffset-encoding" tabindex="-1"><a class="header-anchor" href="#buf-indexof-value-byteoffset-encoding"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufindexofvalue-byteoffset-encoding" target="_blank" rel="noopener noreferrer">buf.indexOf(value[, byteOffset][, encoding])</a></span></a></h3><p>Node.js ä¸­çš„ Buffer å¯¹è±¡æ˜¯ç”¨æ¥ç›´æ¥æ“ä½œå†…å­˜ä¸­çš„äºŒè¿›åˆ¶æ•°æ®çš„ã€‚<code>buf.indexOf(value[, byteOffset][, encoding])</code> æ˜¯ Buffer å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºæŸ¥æ‰¾ Buffer ä¸­æŸä¸ªå€¼ï¼ˆvalueï¼‰çš„é¦–æ¬¡å‡ºç°çš„ä½ç½®ã€‚</p><p>è¿™ä¸ªæ–¹æ³•çš„å‚æ•°å¦‚ä¸‹ï¼š</p><ul><li><code>value</code>ï¼šè¦æœç´¢çš„å€¼ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€Buffer å¯¹è±¡æˆ–è€…æ•°å­—ã€‚</li><li><code>byteOffset</code>ï¼šå¼€å§‹æœç´¢çš„ä½ç½®ï¼Œé»˜è®¤ä¸º 0ï¼Œè¡¨ç¤ºä» Buffer çš„èµ·å§‹å¤„å¼€å§‹ã€‚</li><li><code>encoding</code>ï¼šå½“æœç´¢å€¼ä¸ºå­—ç¬¦ä¸²æ—¶ä½¿ç”¨çš„ç¼–ç ï¼Œé»˜è®¤ä¸º&#39;utf8&#39;ã€‚</li></ul><p>è¿”å›å€¼æ˜¯<code>value</code>åœ¨ Buffer ä¸­é¦–æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°åˆ™è¿”å› -1ã€‚</p><h3 id="å®é™…ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-5"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸²äºŒè¿›åˆ¶æ•°æ®ï¼Œä½ æƒ³çŸ¥é“å…¶ä¸­æŸä¸ªç‰¹å®šå€¼é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼š</p><h4 id="ä¾‹å­-1-æŸ¥æ‰¾æ•°å­—" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-æŸ¥æ‰¾æ•°å­—"><span>ä¾‹å­ 1: æŸ¥æ‰¾æ•°å­—</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸€äº›æ•°å­—çš„Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬è¦æ‰¾æ•°å­— &#39;5&#39; çš„ä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> valueToFind</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨indexOfå¯»æ‰¾</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> index</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">indexOf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">valueToFind</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 4</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>buf</code> æ˜¯ä¸€ä¸ªä» 1 åˆ° 9 çš„æ•°å­—åºåˆ—ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>indexOf</code> æ¥æŸ¥æ‰¾æ•°å­— 5ã€‚æ–¹æ³•è¿”å›çš„æ˜¯æ•°å­— 5 é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå³æ•°ç»„çš„ç¬¬å››ä½ï¼ˆç´¢å¼•ä» 0 å¼€å§‹è®¡ç®—ï¼‰ã€‚</p><h4 id="ä¾‹å­-2-æŸ¥æ‰¾å­—ç¬¦ä¸²" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-æŸ¥æ‰¾å­—ç¬¦ä¸²"><span>ä¾‹å­ 2: æŸ¥æ‰¾å­—ç¬¦ä¸²</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«æ–‡å­—çš„Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;This is a buffer example.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬è¦æ‰¾å­—ç¬¦ä¸² &#39;buffer&#39; çš„ä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> stringToFind</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨indexOfå¯»æ‰¾ï¼Œå¹¶æŒ‡å®šç¼–ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> index</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">indexOf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">stringToFind</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 10</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>buf</code> åŒ…å«äº†ä¸€æ®µæ–‡æœ¬ã€‚æˆ‘ä»¬ä½¿ç”¨ <code>indexOf</code> æ¥æŸ¥æ‰¾å­å­—ç¬¦ä¸² &quot;buffer&quot; çš„èµ·å§‹ä½ç½®ã€‚å› ä¸ºé»˜è®¤ç¼–ç å°±æ˜¯ &#39;utf8&#39;ï¼Œè¿™é‡Œå®é™…ä¸Šä¸éœ€è¦æ˜¾å¼æŒ‡å®šç¼–ç ã€‚</p><h4 id="ä¾‹å­-3-æŒ‡å®šèµ·å§‹ä½ç½®æœç´¢" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-3-æŒ‡å®šèµ·å§‹ä½ç½®æœç´¢"><span>ä¾‹å­ 3: æŒ‡å®šèµ·å§‹ä½ç½®æœç´¢</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«é‡å¤æ•°å­—çš„Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬æƒ³æŸ¥æ‰¾ç¬¬äºŒä¸ª &#39;2&#39; çš„ä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> valueToFind</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> byteOffset</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼€å§‹æœç´¢çš„ä½ç½®è®¾ç½®ä¸º3ï¼Œè·³è¿‡ç¬¬ä¸€ä¸ª &#39;2&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨indexOfå¯»æ‰¾</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> index</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">indexOf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">valueToFind</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">byteOffset</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 6</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è®¾å®šäº†ä¸€ä¸ªå¼€å§‹æœç´¢çš„ä½ç½® <code>byteOffset</code>ã€‚è¿™æ„å‘³ç€ <code>indexOf</code> ä¼šä» Buffer çš„ç¬¬ä¸‰ä¸ªå­—èŠ‚ï¼ˆä¹Ÿå°±æ˜¯æ•°å€¼ 3 åé¢ï¼Œç´¢å¼•æ˜¯ä» 0 å¼€å§‹çš„ï¼‰å¼€å§‹æœç´¢æ•°å­— 2ã€‚æ‰€ä»¥å®ƒä¼šå¿½ç•¥å‰ä¸¤ä¸ªæ•°å­— 2ï¼Œè€Œè¿”å›æœ€åä¸€ä¸ªæ•°å­— 2 çš„ä½ç½®ç´¢å¼•ï¼Œå³ 6ã€‚</p><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ åº”è¯¥å¯ä»¥ç†è§£ <code>buf.indexOf()</code> æ–¹æ³•çš„åŸºæœ¬ç”¨æ³•ä»¥åŠå¦‚ä½•åœ¨å®é™…åœºæ™¯ä¸­åº”ç”¨äº†ã€‚è®°ä½ï¼ŒBuffer å¤„ç†çš„æ˜¯åº•å±‚çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œåœ¨æ¶‰åŠæ–‡ä»¶è¯»å†™ã€ç½‘ç»œé€šä¿¡ç­‰éœ€è¦å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„åœºæ™¯ä¸­éå¸¸æœ‰ç”¨ã€‚</p><h3 id="buf-keys" tabindex="-1"><a class="header-anchor" href="#buf-keys"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufkeys" target="_blank" rel="noopener noreferrer">buf.keys()</a></span></a></h3><p><code>buf.keys()</code> æ–¹æ³•æ˜¯ Buffer å¯¹è±¡çš„ä¸€ä¸ªå®ç”¨åŠŸèƒ½ï¼Œå®ƒå…è®¸ä½ éå† Buffer å¯¹è±¡ä¸­æ¯ä¸ªå­—èŠ‚çš„ç´¢å¼•ã€‚åœ¨ Node.js ä¸­ï¼ŒBuffer ç±»æ˜¯ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ï¼Œä¾‹å¦‚æ–‡ä»¶è¯»å†™ã€ç½‘ç»œé€šä¿¡ç­‰åœºæ™¯ä¸­ç»å¸¸ä¼šä½¿ç”¨åˆ°äºŒè¿›åˆ¶æ•°æ®æµã€‚</p><p>é¦–å…ˆéœ€è¦äº†è§£çš„æ˜¯ï¼Œåœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨å­—ç¬¦ä¸²æ¥å¤„ç†æ–‡æœ¬æ•°æ®ï¼Œä½†æ˜¯å½“æ¶‰åŠåˆ°äºŒè¿›åˆ¶æ•°æ®æ—¶ï¼ˆæ¯”å¦‚å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘æ–‡ä»¶ï¼‰ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªä¸“é—¨çš„å¯¹è±¡æ¥è¡¨ç¤ºè¿™äº›æ•°æ®ï¼Œè¿™å°±æ˜¯ Buffer å¯¹è±¡ã€‚</p><p>ç°åœ¨è®©æˆ‘ç»™ä½ è§£é‡Šä¸€ä¸‹<code>buf.keys()</code>æ–¹æ³•æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå¹¶ä¸”ç»™å‡ºä¸€äº›å®é™…åº”ç”¨çš„ä¾‹å­ã€‚</p><h3 id="buf-keys-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#buf-keys-æ–¹æ³•"><span>buf.keys() æ–¹æ³•</span></a></h3><p>å½“ä½ è°ƒç”¨<code>buf.keys()</code>æ–¹æ³•æ—¶ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼ˆIteratorï¼‰ï¼Œè¿™ä¸ªè¿­ä»£å™¨å¯ä»¥ç”¨æ¥éå† Buffer å¯¹è±¡ä¸­æ¯ä¸ªå­—èŠ‚çš„ç´¢å¼•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä¼šä¸€ä¸ªæ¥ä¸€ä¸ªåœ°ç»™å‡º 0, 1, 2, ..., n è¿™æ ·çš„åºåˆ—ï¼Œå…¶ä¸­ n æ˜¯ Buffer çš„é•¿åº¦å‡å» 1ã€‚</p><h3 id="ä½¿ç”¨ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­-4"><span>ä½¿ç”¨ä¾‹å­</span></a></h3><h4 id="ç¤ºä¾‹-1-éå†-buffer-çš„ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-éå†-buffer-çš„ç´¢å¼•"><span>ç¤ºä¾‹ 1: éå† Buffer çš„ç´¢å¼•</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ª Buffer å¯¹è±¡ï¼Œé‡Œé¢åŒ…å«äº†ä¸€äº›æ•°æ®ï¼Œä½ æƒ³è¦éå†è¿™äº›æ•°æ®çš„ç´¢å¼•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«&quot;Hello World&quot;æ–‡æœ¬çš„Bufferå¯¹è±¡</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> index</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> of</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">keys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡ºå°†ä¼šæ˜¯ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>0</span></span>
<span class="line"><span>1</span></span>
<span class="line"><span>2</span></span>
<span class="line"><span>3</span></span>
<span class="line"><span>4</span></span>
<span class="line"><span>5</span></span>
<span class="line"><span>6</span></span>
<span class="line"><span>7</span></span>
<span class="line"><span>8</span></span>
<span class="line"><span>9</span></span>
<span class="line"><span>10</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™äº›æ•°å­—åˆ†åˆ«ä»£è¡¨&quot;Hello World&quot;ä¸­æ¯ä¸ªå­—ç¬¦å¯¹åº”çš„åœ¨ Buffer ä¸­çš„ä½ç½®ã€‚</p><h4 id="ç¤ºä¾‹-2-ç»“åˆå€¼å’Œç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ç»“åˆå€¼å’Œç´¢å¼•"><span>ç¤ºä¾‹ 2: ç»“åˆå€¼å’Œç´¢å¼•</span></a></h4><p>å¦‚æœä½ ä¸ä»…ä»…éœ€è¦ç´¢å¼•ï¼Œè¿˜æƒ³è·å–å¯¹åº”çš„å€¼ï¼Œä½ å¯ä»¥è¿™æ ·æ“ä½œï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> index</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> of</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">keys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Index: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, Value: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡ºå°†ä¼šæ˜¯ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>Index: 0, Value: 72</span></span>
<span class="line"><span>Index: 1, Value: 101</span></span>
<span class="line"><span>...</span></span>
<span class="line"><span>Index: 10, Value: 100</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œçš„ Value æ˜¯å­—ç¬¦å¯¹åº”çš„ ASCII ç å€¼ï¼Œä¾‹å¦‚&#39;H&#39;çš„ ASCII ç æ˜¯ 72ã€‚</p><p>è¿™ä¸ªæ–¹æ³•éå¸¸æœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼Œæˆ–è€…å½“ä½ éœ€è¦å¯¹ Buffer ä¸­çš„æ¯ä¸ªå­—èŠ‚è¿›è¡ŒæŸç§æ“ä½œæ—¶ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½éœ€è¦éå†ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶çš„æ‰€æœ‰å­—èŠ‚ä»¥ä¿®æ”¹å…¶é¢œè‰²å€¼ï¼Œæˆ–è€…æ£€æŸ¥ä¸€ä¸ªä¸‹è½½çš„æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªç‰¹å®šçš„å­—èŠ‚åºåˆ—ç­‰ã€‚é€šè¿‡<code>buf.keys()</code>ï¼Œä½ å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®ç°è¿™äº›æ“ä½œã€‚</p><h3 id="buf-lastindexof-value-byteoffset-encoding" tabindex="-1"><a class="header-anchor" href="#buf-lastindexof-value-byteoffset-encoding"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#buflastindexofvalue-byteoffset-encoding" target="_blank" rel="noopener noreferrer">buf.lastIndexOf(value[, byteOffset][, encoding])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­çš„ <code>buf.lastIndexOf(value[, byteOffset][, encoding])</code> æ–¹æ³•ã€‚</p><p>åœ¨ Node.js çš„ä¸Šä¸‹æ–‡ä¸­ï¼ŒBuffer æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ç±»ã€‚ç®€å•æ¥è¯´ï¼Œä½ å¯ä»¥æŠŠ Buffer æƒ³è±¡æˆä¸€ä¸ªå­˜æ”¾å­—èŠ‚çš„æ•°ç»„ï¼ˆè™½ç„¶å®ƒåœ¨æŠ€æœ¯ä¸Šä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ•°ç»„ï¼‰ã€‚é€šè¿‡ Bufferï¼Œä½ å¯ä»¥è¯»å–æˆ–å†™å…¥äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¯”å¦‚æ–‡ä»¶è¯»å†™ã€ç½‘ç»œé€šä¿¡ç­‰åœºæ™¯ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥è¯¦ç»†äº†è§£ä¸€ä¸‹ <code>lastIndexOf</code> æ–¹æ³•ï¼š</p><h3 id="buf-lastindexof-value-byteoffset-encoding-1" tabindex="-1"><a class="header-anchor" href="#buf-lastindexof-value-byteoffset-encoding-1"><span>buf.lastIndexOf(value[, byteOffset][, encoding])</span></a></h3><p>è¿™ä¸ªæ–¹æ³•ç”¨äºæœç´¢ Buffer ä¸­æœ€åä¸€æ¬¡å‡ºç°æŸä¸ªå€¼çš„ç´¢å¼•ã€‚å®ƒå’Œ JavaScript å­—ç¬¦ä¸²çš„ <code>lastIndexOf</code> æ–¹æ³•éå¸¸ç›¸ä¼¼ï¼Œä½†å®ƒæ˜¯ä¸“é—¨ä¸º Buffer è®¾è®¡çš„ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²ã€ä¸€ä¸ª Bufferï¼Œç”šè‡³æ˜¯ä¸€ä¸ªå•ä¸ªçš„æ•°å­—ï¼ˆä»£è¡¨ä¸€ä¸ªå­—èŠ‚ï¼‰åœ¨ Buffer ä¸­æœ€åå‡ºç°çš„ä½ç½®ã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>value</code>ï¼šè¦æœç´¢çš„å€¼ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€Buffer æˆ–æ•°å­—ã€‚</li><li><code>byteOffset</code>ï¼šå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºå¼€å§‹æœç´¢çš„ä½ç½®ã€‚å¦‚æœæŒ‡å®šäº†è¿™ä¸ªå‚æ•°ï¼Œæœç´¢ä¼šä» Buffer çš„è¿™ä¸ªä½ç½®å¼€å§‹å‘å‰æœç´¢ã€‚</li><li><code>encoding</code>ï¼šå½“ <code>value</code> æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ—¶ï¼Œè¿™ä¸ªå‚æ•°è¡¨ç¤ºå­—ç¬¦ç¼–ç ï¼Œé»˜è®¤ä¸º &#39;utf8&#39;ã€‚</li></ul><p>è¿”å›å€¼ï¼š</p><ul><li>è¿”å›æ‰¾åˆ°çš„ç´¢å¼•ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°åˆ™è¿”å› -1ã€‚</li></ul><p>ä¸‹é¢æˆ‘ä»¬ä¸¾å‡ ä¸ªä¾‹å­æ¥è¯´æ˜å®ƒçš„ç”¨æ³•ï¼š</p><h4 id="ä¾‹å­-1-æœç´¢å­—ç¬¦ä¸²" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-æœç´¢å­—ç¬¦ä¸²"><span>ä¾‹å­ 1ï¼šæœç´¢å­—ç¬¦ä¸²</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World! Hello Node.js!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> searchString</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> index</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lastIndexOf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">searchString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç»“æœå°†æ˜¯22ï¼Œå› ä¸º &#39;Node&#39; è¿™ä¸ªå­—ç¬¦ä¸²æœ€åä¸€æ¬¡å‡ºç°çš„èµ·å§‹ä½ç½®æ˜¯ç´¢å¼•22</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä¾‹å­-2-æœç´¢-buffer" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-æœç´¢-buffer"><span>ä¾‹å­ 2ï¼šæœç´¢ Buffer</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;1234&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> searchBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;23&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> index</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lastIndexOf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">searchBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç»“æœå°†æ˜¯1ï¼Œ&#39;23&#39; åœ¨ &#39;1234&#39; ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„èµ·å§‹ä½ç½®æ˜¯ç´¢å¼•1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä¾‹å­-3-æœç´¢æ•°å­—" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-3-æœç´¢æ•°å­—"><span>ä¾‹å­ 3ï¼šæœç´¢æ•°å­—</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> searchNumber</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 20</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> index</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lastIndexOf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">searchNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç»“æœå°†æ˜¯3ï¼Œå› ä¸ºæ•°å­—20ï¼ˆä»£è¡¨ä¸€ä¸ªå­—èŠ‚ï¼‰æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®æ˜¯ç´¢å¼•3</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼Œä»¥ä¸Šæ‰€æœ‰ç¤ºä¾‹ä¸­ï¼Œç´¢å¼•éƒ½æ˜¯ä» 0 å¼€å§‹çš„ã€‚</p><p>ä½¿ç”¨ <code>lastIndexOf</code> æ–¹æ³•å¯ä»¥å¸®åŠ©ä½ ç¡®å®šä¸€äº›ç‰¹å®šæ•°æ®åœ¨å¤§å‹äºŒè¿›åˆ¶æµä¸­æœ€åå‡ºç°çš„ä½ç½®ã€‚è¿™åœ¨å¤„ç†ç½‘ç»œåè®®æˆ–è€…æ–‡ä»¶æ ¼å¼è§£ææ—¶ç‰¹åˆ«æœ‰ç”¨ï¼Œæ¯”å¦‚ä½ å¯èƒ½æƒ³çŸ¥é“æŸä¸ªç‰¹å®šçš„ç»“æŸç¬¦å·æˆ–è€…æ ‡è®°åœ¨æ¥æ”¶åˆ°çš„æ•°æ®ä¸­æœ€åå‡ºç°åœ¨å“ªé‡Œï¼Œä»¥ä¾¿è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚</p><h3 id="buf-length" tabindex="-1"><a class="header-anchor" href="#buf-length"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#buflength" target="_blank" rel="noopener noreferrer">buf.length</a></span></a></h3><p>å¥½çš„ï¼ŒNode.js ä¸­çš„ Buffer ç±»æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œå®ƒç”¨äºç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµã€‚åœ¨ Node.js ä¸­æ“ä½œæ–‡ä»¶ã€ç½‘ç»œé€šä¿¡ç­‰åœºæ™¯æ—¶ï¼Œç»å¸¸ä¼šä½¿ç”¨åˆ° Buffer æ¥å¤„ç†å­—èŠ‚ã€‚</p><p>å½“ä½ åˆ›å»ºäº†ä¸€ä¸ª Buffer å®ä¾‹åï¼Œæ¯”å¦‚ <code>const buf = Buffer.from(&#39;Hello, World!&#39;);</code>ï¼Œè¿™ä¸ªå®ä¾‹å°±å…·æœ‰å¤šç§å±æ€§å’Œæ–¹æ³•æ¥æ“ä½œå…¶ä¸­çš„æ•°æ®ã€‚å…¶ä¸­ï¼Œ<code>buf.length</code> æ˜¯ä¸€ä¸ªéå¸¸ç›´è§‚çš„å±æ€§ï¼Œå®ƒè¿”å›çš„æ˜¯è¿™ä¸ª Buffer å®ä¾‹æ‰€å ç”¨çš„å†…å­˜é•¿åº¦ï¼Œå•ä½æ˜¯å­—èŠ‚ã€‚</p><p>ä¸‹é¢é€šè¿‡å‡ ä¸ªä¾‹å­è§£é‡Šä¸€ä¸‹ <code>buf.length</code> çš„ç”¨æ³•ï¼š</p><p><strong>ä¾‹å­ 1: åˆ›å»ºä¸€ä¸ª Buffer å¹¶è·å–å…¶é•¿åº¦</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªBufferå®ä¾‹ï¼ŒåŒ…å«å­—ç¬¦ä¸²&quot;Hello&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š5</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå«æœ‰å­—ç¬¦ä¸² &quot;Hello&quot; çš„ Buffer å®ä¾‹ï¼Œç”±äº &quot;Hello&quot; è¿™ä¸ªå­—ç¬¦ä¸²ç”± 5 ä¸ª ASCII å­—ç¬¦ç»„æˆï¼Œæ‰€ä»¥ <code>buf1.length</code> å°†è¾“å‡º 5ï¼Œä»£è¡¨å ç”¨äº† 5 ä¸ªå­—èŠ‚ã€‚</p><p><strong>ä¾‹å­ 2: å¤„ç†ä¸­æ–‡å­—ç¬¦</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªBufferå®ä¾‹ï¼ŒåŒ…å«ä¸­æ–‡å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä½ å¥½&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå¯èƒ½æ˜¯6æˆ–æ›´å¤šï¼Œå–å†³äºç¼–ç </span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå«æœ‰ä¸­æ–‡ &quot;ä½ å¥½&quot; çš„ Buffer å®ä¾‹ã€‚ç”±äºä¸­æ–‡å­—ç¬¦åœ¨ Buffer ä¸­é€šå¸¸ä½¿ç”¨ UTF-8 ç¼–ç ï¼Œæ¯ä¸ªä¸­æ–‡å­—ç¬¦å¯èƒ½å ç”¨ 3 ä¸ªæˆ–æ›´å¤šçš„å­—èŠ‚ï¼Œæ‰€ä»¥ <code>buf2.length</code> çš„è¾“å‡ºå¯èƒ½å¤§äº 2ã€‚</p><p><strong>ä¾‹å­ 3: ä¿®æ”¹ Buffer å¹¶è§‚å¯Ÿé•¿åº¦å˜åŒ–</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º10ä¸ªå­—èŠ‚çš„Bufferå®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf3</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š10</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¿®æ”¹è¿™ä¸ªBufferçš„å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hi&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºä»ç„¶æ˜¯10</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªå¤§å°ä¸º 10 ä¸ªå­—èŠ‚çš„ Buffer å®ä¾‹ <code>buf3</code>ã€‚æ— è®ºæˆ‘ä»¬å¦‚ä½•ä¿®æ”¹ <code>buf3</code> ä¸­çš„å†…å®¹ï¼Œå®ƒçš„ <code>length</code> å±æ€§å§‹ç»ˆè¡¨ç¤ºåˆ†é…ç»™è¯¥ Buffer çš„å†…å­˜ç©ºé—´å¤§å°ï¼Œä¸ä¼šå› å†™å…¥çš„å†…å®¹è€Œæ”¹å˜ã€‚</p><p>ç®€è€Œè¨€ä¹‹ï¼Œ<code>buf.length</code> ç»™å‡ºçš„æ˜¯ Buffer å ç”¨çš„å†…å­˜å¤§å°ï¼Œä¸é‡Œé¢å­˜å‚¨çš„æ•°æ®å…·ä½“å†…å®¹æ— å…³ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œå³ä½¿ä½ åˆ›å»ºäº†ä¸€ä¸ªå¾ˆå¤§çš„ Buffer ä½†æ˜¯åªå­˜äº†å¾ˆå°‘çš„æ•°æ®ï¼Œ<code>buf.length</code> ä¹Ÿä¼šè¿”å›æ•´ä¸ª Buffer åˆ†é…çš„å†…å­˜å¤§å°ã€‚</p><h3 id="buf-parent" tabindex="-1"><a class="header-anchor" href="#buf-parent"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufparent" target="_blank" rel="noopener noreferrer">buf.parent</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥è°ˆè°ˆ Node.js ä¸­çš„ <code>buf.parent</code>ã€‚</p><p>åœ¨ Node.js é‡Œï¼ŒBuffer æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ç±»ï¼Œç±»ä¼¼äºåœ¨å…¶ä»–è¯­è¨€ä¸­çš„æ•°ç»„æˆ–è€…åˆ—è¡¨ã€‚</p><p>åœ¨æ—©æœŸç‰ˆæœ¬çš„ Node.js ä¸­ï¼Œæœ‰æ—¶ä¸ºäº†æ•ˆç‡ï¼Œå°çš„ Buffer å¯¹è±¡ä¼šè¢«åˆ†é…åˆ°ä¸€ä¸ªç§°ä¸º Buffer pool çš„æ›´å¤§çš„å†…å­˜åŒºåŸŸã€‚è¿™æ ·åšå¯ä»¥å‡å°‘æ€»ä½“ä¸Šçš„å†…å­˜åˆ†é…æ•°ç›®ï¼Œå¹¶ä¸”å¯ä»¥æ›´å¿«åœ°è¿›è¡Œå°å—å†…å­˜çš„åˆ†é…ã€‚å½“ä½ åˆ›å»ºä¸€ä¸ªå°çš„ Buffer å¯¹è±¡ï¼ˆä¾‹å¦‚ä¸€ä¸ªå¤§å°å°äº 8KB çš„ Bufferï¼‰ï¼Œå®ƒå®é™…ä¸Šåªæ˜¯è¿™ä¸ªå¤§å†…å­˜å—çš„ä¸€ä¸ªè§†å›¾æˆ–è€…â€œçª—å£â€ï¼Œè€Œä¸æ˜¯å®Œå…¨ç‹¬ç«‹çš„å†…å­˜åŒºåŸŸã€‚</p><p><code>buf.parent</code> å±æ€§å°±æ˜¯å¼•ç”¨è¿™ç§æƒ…å†µä¸‹ Buffer å¯¹è±¡æ‰€å±çš„é‚£ä¸ªæ›´å¤§çš„ Bufferï¼ˆå³ poolï¼‰ã€‚ä½†æ˜¯ï¼Œéšç€ Node.js çš„å‘å±•ï¼Œ<code>buf.parent</code> è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªè¿‡æ—¶çš„å±æ€§ï¼Œå› ä¸ºç°åœ¨ Buffer å®ä¾‹é€šå¸¸ç›´æ¥åˆ†é…ï¼Œè€Œä¸æ˜¯ä»å…±äº«çš„ pool åˆ†é…ã€‚</p><p>æ ¹æ®ä½ æä¾›çš„ç‰ˆæœ¬å· v21.7.1ï¼ŒæŸ¥é˜… Node.js æ–‡æ¡£ï¼Œ<code>buf.parent</code> å·²ç»ä¸å­˜åœ¨äº†ã€‚æ‰€ä»¥åœ¨è¿™ä¸ªç‰ˆæœ¬ä½ ä½¿ç”¨ Buffer å¯¹è±¡æ—¶ï¼Œé€šå¸¸ä¸éœ€è¦å…³å¿ƒ <code>buf.parent</code>ï¼Œå› ä¸ºæ¯ä¸ª Buffer éƒ½æ˜¯å®Œå…¨ç‹¬ç«‹çš„ï¼Œæ²¡æœ‰å…±äº«çš„ parent Bufferã€‚</p><p>å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ä¸€ä¸ªéå¸¸å¤è€çš„ç‰ˆæœ¬çš„ Node.jsï¼Œå…¶ä¸­è¿˜æœ‰ <code>buf.parent</code> è¿™ä¸€æ¦‚å¿µï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°ä»¥ä¸‹çš„ä»£ç ç‰‡æ®µï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æœ‰æ—§ç‰ˆæœ¬çš„ Node.js ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ–°çš„ Buffer å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">parent</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºçˆ¶ Bufferï¼Œåªæœ‰åœ¨ Buffer æ˜¯ pool çš„ä¸€éƒ¨åˆ†æ—¶æ‰ä¼šæ˜¾ç¤º</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½†åœ¨ç°ä»£çš„ Node.js ä¸­ï¼Œä½ ç®€å•åœ°ä½¿ç”¨ Buffer ç±»åˆ›å»ºå’Œæ“ä½œäºŒè¿›åˆ¶æ•°æ®ï¼Œä¸éœ€è¦æ‹…å¿ƒèƒŒåæ˜¯å¦æœ‰ parent Bufferã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°ä»£ Node.js çš„æ ‡å‡†ç”¨æ³•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, world!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å« &quot;Hello, world!&quot; æ–‡æœ¬çš„ Buffer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: Hello, world!</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å½“å‰ç‰ˆæœ¬çš„ Node.jsï¼Œä½ åº”è¯¥å…³æ³¨çš„æ˜¯å¦‚ä½•åˆ›å»º Buffer (<code>Buffer.from()</code>, <code>Buffer.alloc()</code>, <code>Buffer.allocUnsafe()</code> ç­‰), å¦‚ä½•å°† Buffer è½¬æ¢æˆå­—ç¬¦ä¸² (<code>buffer.toString()</code>)ï¼Œä»¥åŠå¦‚ä½•è¯»å–å’Œå†™å…¥ Buffer ä¸­çš„æ•°æ®ã€‚</p><p>å¸Œæœ›è¿™ä¸ªè§£é‡Šæœ‰åŠ©äºä½ ç†è§£ Node.js ä¸­çš„ Buffer å’Œ <code>buf.parent</code> çš„å†å²å’Œç°çŠ¶ã€‚</p><h3 id="buf-readbigint64be-offset" tabindex="-1"><a class="header-anchor" href="#buf-readbigint64be-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreadbigint64beoffset" target="_blank" rel="noopener noreferrer">buf.readBigInt64BE([offset])</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘å¾ˆä¹æ„ä¸ºä½ è§£é‡Š <code>buf.readBigInt64BE([offset])</code> è¿™ä¸ªæ–¹æ³•ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code> å¯¹è±¡æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„å…¨å±€å¯¹è±¡ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥å­˜å‚¨æˆ–è¯»å–äºŒè¿›åˆ¶æ•°æ®æµï¼Œå¦‚æ–‡ä»¶è¯»å†™æˆ–ç½‘ç»œé€šä¿¡ç­‰äºŒè¿›åˆ¶æ•°æ®ã€‚</p><p><code>buf.readBigInt64BE([offset])</code> æ˜¯ä¸€ä¸ªåœ¨ Buffer å¯¹è±¡ä¸Šå¯è°ƒç”¨çš„æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ ä»ç¼“å†²åŒºï¼ˆå³ Buffer å¯¹è±¡ï¼‰ä¸­è¯»å–ä¸€ä¸ª 64 ä½çš„å¤§æ•´æ•°ï¼ˆBigIntï¼‰ï¼Œå¹¶ä¸”æ˜¯ä»¥â€œBig-Endianâ€ï¼ˆå¤§ç«¯åºï¼‰çš„æ–¹å¼è¯»å–ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-big-endian-å¤§ç«¯åº" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-big-endian-å¤§ç«¯åº"><span>ä»€ä¹ˆæ˜¯ Big-Endianï¼ˆå¤§ç«¯åºï¼‰ï¼Ÿ</span></a></h3><p>åœ¨è®¡ç®—æœºå†…å­˜ä¸­ï¼Œå¤šå­—èŠ‚çš„æ•°æ®å¯ä»¥æŒ‰ä¸åŒçš„é¡ºåºæ¥å­˜å‚¨ã€‚æœ‰ä¸¤ç§å¸¸è§çš„åºåˆ—ï¼šå¤§ç«¯åºï¼ˆBig-Endianï¼‰å’Œå°ç«¯åºï¼ˆLittle-Endianï¼‰ã€‚</p><ul><li><strong>å¤§ç«¯åº</strong>ï¼šæœ€é«˜æœ‰æ•ˆå­—èŠ‚ï¼ˆMSBï¼‰æ”¾åœ¨å†…å­˜çš„ä½åœ°å€ç«¯ï¼Œå…¶ä»–å­—èŠ‚ä¾æ¬¡é™åºæ’åˆ—ã€‚</li><li><strong>å°ç«¯åº</strong>ï¼šæœ€ä½æœ‰æ•ˆå­—èŠ‚ï¼ˆLSBï¼‰æ”¾åœ¨å†…å­˜çš„ä½åœ°å€ç«¯ï¼Œå…¶ä»–å­—èŠ‚ä¾æ¬¡å‡åºæ’åˆ—ã€‚</li></ul><h3 id="å‚æ•°-3" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-3"><span>å‚æ•°</span></a></h3><ul><li><code>offset</code> ï¼ˆå¯é€‰ï¼‰ - å®ƒæ˜¯ä¸€ä¸ªæ•°å€¼ï¼ŒæŒ‡æ˜äº†ä» Buffer å¯¹è±¡çš„å“ªä¸ªä½ç½®å¼€å§‹è¯»å–æ•°æ®ã€‚å¦‚æœæ²¡æœ‰æä¾› offsetï¼Œé‚£ä¹ˆé»˜è®¤ä» 0 å¼€å§‹ã€‚</li></ul><h3 id="è¿”å›å€¼-4" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-4"><span>è¿”å›å€¼</span></a></h3><p>è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª BigInt ç±»å‹çš„æ•°å€¼ï¼Œè¡¨ç¤ºè¯»å–çš„ 64 ä½æ•´æ•°ã€‚</p><h3 id="å®é™…ä¾‹å­-6" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-6"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œéœ€è¦ä»ä¸€ä¸ªç½‘ç»œèµ„æºè¯»å–ä¸€ä¸ªåŒ…å«æ—¶é—´æˆ³çš„äºŒè¿›åˆ¶æ•°æ®æµã€‚è€Œè¿™ä¸ªæ—¶é—´æˆ³æ˜¯ä¸€ä¸ª 64 ä½çš„æ•´æ•°ï¼Œå¹¶ä¸”å®ƒæ˜¯ä»¥å¤§ç«¯åºå­˜å‚¨çš„ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>buf.readBigInt64BE(offset)</code> æ¥è·å–è¿™ä¸ªæ—¶é—´æˆ³ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æ”¶åˆ°äº†ä¸€ä¸ªåŒ…å«å¤§ç«¯åºæ—¶é—´æˆ³çš„Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x1b</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x2b</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x3c</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x4d</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬æƒ³ä»ç¼“å†²åŒºçš„ç¬¬0ä¸ªå­—èŠ‚ä½ç½®å¼€å§‹è¯»å–64ä½æ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> timestamp</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readBigInt64BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timestamp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºæ¥çš„å°†ä¼šæ˜¯ä¸€ä¸ªBigIntç±»å‹çš„æ•°å€¼ï¼Œæ¯”å¦‚ 6917529027641081853n</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªå«æœ‰ 8 ä¸ªå­—èŠ‚çš„ <code>Buffer</code> å¯¹è±¡ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨ <code>readBigInt64BE()</code> æ–¹æ³•ï¼Œä» 0 ç´¢å¼•å¤„å¼€å§‹è¯»å–è¿™ 8 ä¸ªå­—èŠ‚ä½œä¸ºä¸€ä¸ªå¤§ç«¯åºçš„ 64 ä½æ•´æ•°ã€‚</p><p>é‡è¦çš„æ˜¯è¦çŸ¥é“ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ç¡®ä¿ <code>buffer</code> è‡³å°‘åŒ…å«ä» <code>offset</code> å¼€å§‹çš„ 8 ä¸ªå­—èŠ‚ï¼Œå› ä¸ºä¸€ä¸ª 64 ä½æ•´æ•°æ­£å¥½æ˜¯ 8 å­—èŠ‚ã€‚å¦‚æœç¼“å†²åŒºæ²¡æœ‰è¶³å¤Ÿçš„å­—èŠ‚ï¼ŒNode.js å°†ä¼šæŠ›å‡ºä¸€ä¸ª <code>RangeError</code> å¼‚å¸¸ã€‚</p><h3 id="buf-readbigint64le-offset" tabindex="-1"><a class="header-anchor" href="#buf-readbigint64le-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreadbigint64leoffset" target="_blank" rel="noopener noreferrer">buf.readBigInt64LE([offset])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥è¯¦ç»†äº†è§£ä¸€ä¸‹ Node.js ä¸­çš„ <code>buf.readBigInt64LE([offset])</code> å‡½æ•°ã€‚</p><p>é¦–å…ˆï¼ŒNode.js æ˜¯ä¸€ä¸ªåŸºäº Chrome çš„ V8 å¼•æ“çš„ JavaScript è¿è¡Œæ—¶ï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼ŒBuffer ç±»æ˜¯ä¸€ä¸ªå…¨å±€å¯ç”¨çš„ç±»ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä¸éœ€è¦å¯¼å…¥ã€‚å®ƒä¸»è¦ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬èšç„¦äº <code>readBigInt64LE</code> æ–¹æ³•ï¼š</p><ul><li><p><strong>å‡½æ•°ä½œç”¨</strong>ï¼š<code>buf.readBigInt64LE([offset])</code> æ˜¯ Buffer ç±»ä¸Šçš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºä» bufferï¼ˆç¼“å†²åŒºï¼‰ä¸­è¯»å–ä¸€ä¸ªæœ‰ç¬¦å·çš„ã€64 ä½çš„æ•´æ•°ï¼Œå¹¶ä¸”ä»¥å°ç«¯åº (Little-Endian) çš„æ ¼å¼ã€‚</p></li><li><p><strong>å‚æ•°è¯´æ˜</strong>ï¼š</p><ul><li><code>offset</code> å‚æ•°æ˜¯å¯é€‰çš„ï¼Œå®ƒæŒ‡å®šä»å“ªä¸ªä½ç½®å¼€å§‹è¯»å– buffer ä¸­çš„æ•°æ®ã€‚å¦‚æœä¸æä¾›ï¼Œé»˜è®¤æ˜¯ä» 0 å¼€å§‹ã€‚</li></ul></li><li><p><strong>è¿”å›å€¼</strong>ï¼šè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª BigInt ç±»å‹çš„æ•´æ•°ã€‚</p></li><li><p><strong>å°ç«¯åºï¼ˆLittle-Endianï¼‰</strong>ï¼šè¿™æ˜¯ä¸€ç§å­—èŠ‚åºï¼Œå†³å®šäº†å¦‚ä½•åœ¨å†…å­˜ä¸­æ’åˆ—å¤åˆå­—èŠ‚çš„æ•°æ®ç±»å‹ã€‚ä½¿ç”¨å°ç«¯åºæ—¶ï¼Œæœ€ä½æœ‰æ•ˆå­—èŠ‚åœ¨å‰é¢ï¼ˆå³å†…å­˜åœ°å€æœ€å°çš„éƒ¨åˆ†ï¼‰ï¼Œæœ€é«˜æœ‰æ•ˆå­—èŠ‚åœ¨åé¢ã€‚</p></li></ul><h3 id="å®é™…ä¾‹å­-7" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-7"><span>å®é™…ä¾‹å­ï¼š</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œä½ éœ€è¦ä»ä¸€ä¸ªæ–‡ä»¶æˆ–ç½‘ç»œèµ„æºä¸­è¯»å–äºŒè¿›åˆ¶æ•°æ®ã€‚å¯èƒ½ä½ æ­£åœ¨å¤„ç†ä¸€äº›ä¿å­˜åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„æ•°æ®è®°å½•ï¼Œæˆ–è€…æ˜¯æ¥æ”¶ä»æŸä¸ªç¡¬ä»¶ä¼ æ„Ÿå™¨å‘é€çš„æ•°æ®åŒ…ã€‚</p><p>è¿™é‡Œæ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ <code>readBigInt64LE</code> æ–¹æ³•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç”±äºŒè¿›åˆ¶æ•°æ®ç»„æˆçš„ Buffer å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x01</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x02</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨æˆ‘ä»¬æƒ³è¦è¯»å–è¿™ä¸ª Buffer ä¸­çš„ 64 ä½æœ‰ç¬¦å·æ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬ä½¿ç”¨ readBigInt64LE æ–¹æ³•ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“æ•°æ®æ˜¯ä»¥å°ç«¯åºå­˜å‚¨çš„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> number</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readBigInt64LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">number</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºåº”è¯¥æ˜¯ 2n ï¼ˆæ³¨æ„ &#39;n&#39; è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª BigInt ç±»å‹ï¼‰</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ³¨æ„ï¼šè¿™ä¸ªä¾‹å­ä¸­çš„å…·ä½“æ•°å­—å–å†³äºä½ çš„ Buffer ä¸­çš„å­—èŠ‚ã€‚</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œçš„ Buffer ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ 0x01ï¼ˆæœ€å°çš„å†…å­˜åœ°å€ï¼‰ï¼Œç„¶åè·Ÿç€7ä¸ªé›¶å­—èŠ‚ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æœ€åæ˜¯ 0x02ï¼ˆæœ€å¤§çš„å†…å­˜åœ°å€ï¼‰ï¼Œæ‰€ä»¥æŒ‰å°ç«¯åºè¯»å–ç»“æœä¸º 2ã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå«æœ‰ç‰¹å®šå­—èŠ‚çš„ Bufferã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨ <code>readBigInt64LE</code> æ–¹æ³•ä»è¿™ä¸ª Buffer å¯¹è±¡ä¸­è¯»å–ä¸€ä¸ª 64 ä½çš„æ•´æ•°ï¼Œä»¥å°ç«¯åºçš„æ–¹å¼ã€‚</p><p>è¿™æ ·çš„æ“ä½œåœ¨å¤„ç†æ–‡ä»¶ I/O æˆ–ç½‘ç»œé€šä¿¡æ—¶éå¸¸å¸¸è§ï¼Œå°¤å…¶æ˜¯å½“ä½ å¤„ç†çš„ç³»ç»Ÿæœ‰å›ºå®šçš„å­—èŠ‚åºæ ¼å¼æ—¶ï¼ˆä¾‹å¦‚ï¼Œä»æŸäº›ç‰¹å®šçš„ç¡¬ä»¶è®¾å¤‡æ¥æ”¶æ•°æ®ï¼‰ã€‚é€šè¿‡ä½¿ç”¨ Buffer ç±»å’Œå®ƒæä¾›çš„æ–¹æ³•ï¼ŒNode.js å…è®¸ä½ è½»æ¾åœ°åœ¨ JavaScript ä¸­è¯»å†™å’Œå¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚</p><h3 id="buf-readbiguint64be-offset" tabindex="-1"><a class="header-anchor" href="#buf-readbiguint64be-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreadbiguint64beoffset" target="_blank" rel="noopener noreferrer">buf.readBigUInt64BE([offset])</a></span></a></h3><p>å½“ç„¶ï¼æˆ‘æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹ <code>buf.readBigUInt64BE([offset])</code> è¿™ä¸ªæ–¹æ³•åœ¨ Node.js ä¸­çš„ç”¨é€”ã€‚</p><p>Node.js çš„ Buffer ç±»ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµã€‚è¿™äº›æ•°æ®æµå¯ä»¥æ¥æºäºæ–‡ä»¶ã€ç½‘ç»œé€šä¿¡ç­‰å¤šç§åœºæ™¯ã€‚JavaScript åŸç”Ÿæ”¯æŒå­—ç¬¦ä¸²å’Œè¾ƒå°çš„æ•°å­—ç±»å‹ï¼Œä½†å¯¹äºå¤§æ•´æ•°ï¼ˆæ¯”å¦‚ 64 ä½æ— ç¬¦å·æ•´æ•°ï¼‰çš„æ”¯æŒå¹¶ä¸å®Œå–„ã€‚åœ¨å¾ˆå¤šåº•å±‚ç¼–ç¨‹åœºæ™¯ä¸­ï¼Œå°¤å…¶æ˜¯æ¶‰åŠåˆ°ç½‘ç»œåè®®æˆ–è€…æ–‡ä»¶æ ¼å¼è§£ææ—¶ï¼Œç»å¸¸éœ€è¦å¤„ç†å¤§æ•´æ•°ã€‚</p><p><code>buf.readBigUInt64BE([offset])</code> æ˜¯ Buffer ç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒå…è®¸ä½ ä» bufferï¼ˆå³å­˜æ”¾å­—èŠ‚åºåˆ—çš„å®¹å™¨ï¼‰ä¸­è¯»å–ä¸€ä¸ª 64 ä½çš„æ— ç¬¦å·æ•´æ•°ï¼Œå¹¶ä¸”è¿™ä¸ªæ•´æ•°æ˜¯ä»¥å¤§ç«¯åºï¼ˆBE, Big-Endianï¼‰çš„æ ¼å¼å­˜å‚¨çš„ã€‚</p><p>è¿™é‡Œæœ‰å‡ ä¸ªå…³é”®çš„æ¦‚å¿µéœ€è¦è§£é‡Šä¸€ä¸‹ï¼š</p><ol><li><strong>Big-Endian (å¤§ç«¯åº)</strong>ï¼šæŒ‡çš„æ˜¯é«˜ä½å­—èŠ‚æ’æ”¾åœ¨å†…å­˜çš„ä½åœ°å€ç«¯ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ•°å­—çš„â€œæœ€é‡è¦çš„â€éƒ¨åˆ†å…ˆè¢«å­˜å‚¨ã€‚</li><li><strong>64 ä½</strong>: è¡¨ç¤ºæ•°å€¼å ç”¨äº† 64 ä¸ªä½(bit)ã€‚åœ¨è®¡ç®—æœºä¸­ï¼Œ1 ä¸ªå­—èŠ‚ç”± 8 ä½ç»„æˆï¼Œå› æ­¤ 64 ä½ç›¸å½“äº 8 ä¸ªå­—èŠ‚ã€‚</li><li><strong>æ— ç¬¦å·</strong>: è¡¨ç¤ºè¯¥æ•´æ•°åªèƒ½æ˜¯æ­£æ•°ï¼Œæ²¡æœ‰è´Ÿæ•°ã€‚</li></ol><p>å‚æ•° <code>offset</code> æ˜¯å¯é€‰çš„ï¼Œè¡¨ç¤ºä» buffer çš„å“ªä¸€ä¸ªä½ç½®å¼€å§‹è¯»å–æ•°æ®ã€‚å¦‚æœæ²¡æœ‰æä¾› <code>offset</code>ï¼Œé»˜è®¤ä» buffer çš„èµ·å§‹ä½ç½®è¯»å–ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€äº›å®é™…ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«éšæœºå­—èŠ‚çš„Bufferå®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x01</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x02</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x03</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x04</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»bufä¸­è¯»å–ä¸€ä¸ª64ä½æ— ç¬¦å·æ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> number</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readBigUInt64BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">number</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š66051n</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ…å« 8 ä¸ªå­—èŠ‚çš„ bufferã€‚è¿™ 8 ä¸ªå­—èŠ‚ä»£è¡¨äº†ä¸€ä¸ª 64 ä½çš„æ•°å­—ã€‚æˆ‘ä»¬è°ƒç”¨ <code>readBigUInt64BE(0)</code> æ–¹æ³•ä» buffer çš„ç¬¬ 0 ä½å³é¦–ä½å¼€å§‹è¯»å–ä¸€ä¸ª 64 ä½çš„æ— ç¬¦å·å¤§æ•´æ•°ã€‚</p><p>è¾“å‡ºç»“æœä¸º <code>66051n</code>ï¼Œ<code>n</code> åœ¨è¿™é‡Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª BigInt ç±»å‹çš„æ•°å€¼ï¼Œè¿™æ˜¯å› ä¸ºæ™®é€šçš„ JavaScript æ•°å­—ç±»å‹æ— æ³•å‡†ç¡®è¡¨ç¤ºè¿™ä¹ˆå¤§çš„æ•´æ•°ã€‚</p><p>å†çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªBufferå®ä¾‹ï¼ŒåŒ…å«ä¸¤ä¸ª64ä½çš„æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x01</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x02</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ†åˆ«è¯»å–è¿™ä¸¤ä¸ªæ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> firstNumber</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readBigUInt64BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secondNumber</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readBigUInt64BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">firstNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š1n</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secondNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š2n</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ›´é•¿çš„ bufferï¼Œå®ƒåŒ…å«äº†ä¸¤ä¸ªè¿ç»­çš„ 64 ä½æ— ç¬¦å·æ•´æ•°ã€‚æˆ‘ä»¬é€šè¿‡æ”¹å˜ <code>readBigUInt64BE</code> æ–¹æ³•çš„ <code>offset</code> å‚æ•°ï¼Œåˆ†åˆ«è¯»å–äº†ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªæ•°ã€‚</p><p>è¿™æ ·çš„è¯»å–æ“ä½œåœ¨å¤„ç†äºŒè¿›åˆ¶é€šä¿¡åè®®æˆ–è€…è§£æå¤§å‹æ–‡ä»¶ï¼ˆä¾‹å¦‚æ•°æ®åº“æ–‡ä»¶ã€äºŒè¿›åˆ¶æ—¥å¿—ç­‰ï¼‰æ—¶éå¸¸æœ‰ç”¨ã€‚å› ä¸ºåœ¨è¿™äº›åœºåˆï¼Œæ•°æ®å¾€å¾€æ˜¯ä»¥ç‰¹å®šçš„æ ¼å¼è¿›è¡Œç¼–ç ï¼Œè€Œè¿™äº›æ ¼å¼ä¸­çš„æ•°å€¼å¯èƒ½å°±ä¼šä»¥ 64 ä½æ— ç¬¦å·å¤§ç«¯åºçš„å½¢å¼å‡ºç°ã€‚</p><h3 id="buf-readbiguint64le-offset" tabindex="-1"><a class="header-anchor" href="#buf-readbiguint64le-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreadbiguint64leoffset" target="_blank" rel="noopener noreferrer">buf.readBigUInt64LE([offset])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹ Node.js ä¸­çš„ <code>buf.readBigUInt64LE([offset])</code> å‡½æ•°ã€‚</p><h3 id="ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#ç®€ä»‹"><span>ç®€ä»‹</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code> æ˜¯ç”¨æ¥å¤„ç†åŸå§‹äºŒè¿›åˆ¶æ•°æ®çš„ã€‚å½“ä½ åœ¨ç½‘ç»œä¸Šå‘é€æ•°æ®æˆ–è€…ä»æ–‡ä»¶ç³»ç»Ÿè¯»å–æ•°æ®æ—¶ï¼Œè¿™äº›æ•°æ®é€šå¸¸ä»¥äºŒè¿›åˆ¶å½¢å¼å­˜åœ¨ã€‚<code>Buffer</code> è®©ä½ å¯ä»¥æ“ä½œè¿™äº›äºŒè¿›åˆ¶æ•°æ®ï¼Œä¾‹å¦‚è¯»å–ã€å†™å…¥ã€è½¬æ¢ç­‰ã€‚</p><p><code>buf.readBigUInt64LE([offset])</code> æ˜¯ Buffer ç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒå…è®¸ä½ ä»å­˜å‚¨åœ¨ Buffer å¯¹è±¡ä¸­çš„äºŒè¿›åˆ¶æ•°æ®ä¸­è¯»å–ä¸€ä¸ª 64 ä½æ— ç¬¦å·æ•´æ•°ï¼Œå¹¶ä¸”è¿™ä¸ªæ•´æ•°æ˜¯ä»¥â€œå°ç«¯åºâ€ï¼ˆLittle-Endianï¼‰çš„æ ¼å¼å­˜å‚¨çš„ã€‚</p><h3 id="è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š"><span>è§£é‡Š</span></a></h3><ul><li><p><strong>64 ä½æ— ç¬¦å·æ•´æ•°</strong>ï¼šè¿™æ„å‘³ç€è¿™ä¸ªæ•°å­—æ˜¯ä¸€ä¸ªæ²¡æœ‰æ­£è´Ÿå·çš„å¤§æ•°å­—ï¼Œå³å®ƒæ€»æ˜¯éè´Ÿçš„ï¼Œå¹¶ä¸”å¯ä»¥è¡¨ç¤ºèŒƒå›´å¾ˆå¹¿çš„æ•°å€¼ï¼ˆä» 0 åˆ° 18,446,744,073,709,551,615ï¼‰ã€‚</p></li><li><p><strong>å°ç«¯åºï¼ˆLittle-Endianï¼‰</strong>ï¼šè®¡ç®—æœºå­˜å‚¨æ•°æ®æœ‰ä¸¤ç§æ–¹å¼â€”â€”å°ç«¯åºå’Œå¤§ç«¯åºï¼ˆBig-Endianï¼‰ã€‚åœ¨å°ç«¯åºæ ¼å¼ä¸­ï¼Œæœ€ä½æœ‰æ•ˆå­—èŠ‚ï¼ˆLSBï¼‰å­˜å‚¨åœ¨æœ€ä½çš„åœ°å€ä¸Šï¼Œè€Œæœ€é«˜æœ‰æ•ˆå­—èŠ‚ï¼ˆMSBï¼‰å­˜å‚¨åœ¨æœ€é«˜çš„åœ°å€ä¸Šã€‚ç®€å•åœ°è¯´ï¼Œå°±æ˜¯æ•°å€¼çš„æœ€å°éƒ¨åˆ†å…ˆè¢«å†™å…¥å†…å­˜ã€‚</p></li><li><p><strong>offset</strong>ï¼šè¿™ä¸ªå¯é€‰å‚æ•°ä»£è¡¨ä»ç¼“å†²åŒºçš„å“ªä¸ªä½ç½®å¼€å§‹è¯»å–æ•°æ®ã€‚å¦‚æœä½ ä¸æä¾› <code>offset</code>ï¼Œé»˜è®¤ä¸º 0ï¼Œå®ƒå°†ä» Buffer çš„èµ·å§‹å¤„å¼€å§‹è¯»å–ã€‚</p></li></ul><h3 id="å®é™…ä¾‹å­-8" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-8"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåŒ…å«äºŒè¿›åˆ¶æ•°æ®çš„ Bufferï¼Œå¹¶ä¸”å…¶ä¸­æœ‰ä¸€éƒ¨åˆ†ä»£è¡¨äº†ä¸€ä¸ªå¤§çš„æ•°å€¼ï¼Œè€Œä¸”è¿™ä¸ªæ•°å€¼æ˜¯æŒ‰ç…§å°ç«¯åºå­˜å‚¨çš„ã€‚ä½ æƒ³è¦è¯»å–è¿™ä¸ªæ•°å€¼ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®é™…çš„ä»£ç ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥ Node.js çš„ &#39;buffer&#39; æ¨¡å—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª Buffer å®ä¾‹ï¼Œé‡Œé¢å¡«å…¥ä¸€äº›äºŒè¿›åˆ¶æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œæ˜¯16ä¸ªå­—èŠ‚ï¼Œè¶³å¤Ÿå­˜å‚¨ä¸¤ä¸ª64ä½çš„æ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ readBigUInt64LE è¯»å–ç¬¬ä¸€ä¸ª64ä½çš„æ— ç¬¦å·æ•´æ•°ï¼ˆå°ç«¯åºï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬ä¸ä¼ é€’ offsetï¼Œæ‰€ä»¥å®ƒå°†ä»ç´¢å¼• 0 å¼€å§‹è¯»å–</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> num1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readBigUInt64LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">num1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 1n ï¼ˆè¿™é‡Œçš„ n è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª BigInt ç±»å‹çš„å€¼ï¼‰</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¯»å–ç¬¬äºŒä¸ª64ä½çš„æ— ç¬¦å·æ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™æ¬¡æˆ‘ä»¬ä¼ é€’ offset ä¸º 8ï¼Œå› ä¸ºæ¯ä¸ª64ä½æ•´æ•°å ç”¨8ä¸ªå­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> num2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readBigUInt64LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">num2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 2n</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«ä¸¤ä¸ª 64 ä½æ•´æ•°ï¼ˆ1 å’Œ 2ï¼‰çš„ Bufferã€‚é€šè¿‡è°ƒç”¨ <code>readBigUInt64LE</code> æ–¹æ³•ï¼Œæˆ‘ä»¬é¦–å…ˆè¯»å–äº†ç¬¬ä¸€ä¸ªæ•´æ•°ï¼ˆä»ç´¢å¼• 0 å¼€å§‹ï¼‰ï¼Œç„¶åè¯»å–äº†ç¬¬äºŒä¸ªæ•´æ•°ï¼ˆä»ç´¢å¼• 8 å¼€å§‹ï¼Œå› ä¸ºå‰ä¸€ä¸ªæ•´æ•°å·²ç»å ç”¨äº†å‰ 8 ä¸ªå­—èŠ‚ï¼‰ã€‚æ‰“å°ç»“æœæ˜¾ç¤ºï¼Œæˆ‘ä»¬æˆåŠŸåœ°è¯»å–äº†è¿™ä¸¤ä¸ªå¤§æ•´æ•°ã€‚</p><p>è®°ä½ï¼Œ<code>BigInt</code> æ˜¯ JavaScript ä¸­çš„ä¸€ä¸ªç‰¹æ®Šç±»å‹ï¼Œå®ƒèƒ½å¤Ÿè¡¨ç¤ºæ¯”æ ‡å‡†çš„ <code>Number</code> ç±»å‹æ›´å¤§çš„æ•´æ•°ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆç»“æœåé¢æœ‰ <code>n</code> çš„åŸå› â€”â€”å®ƒè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª <code>BigInt</code> å€¼ã€‚</p><p>å¸Œæœ›è¿™ä¸ªè§£é‡Šå’Œä¾‹å­å¸®åŠ©ä½ ç†è§£äº† <code>buf.readBigUInt64LE([offset])</code> çš„æ¦‚å¿µå’Œç”¨æ³•ï¼</p><h3 id="buf-readdoublebe-offset" tabindex="-1"><a class="header-anchor" href="#buf-readdoublebe-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreaddoublebeoffset" target="_blank" rel="noopener noreferrer">buf.readDoubleBE([offset])</a></span></a></h3><p><code>buf.readDoubleBE([offset])</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºä» Buffer å¯¹è±¡ä¸­è¯»å–ä¸€ä¸ª IEEE 754 åŒç²¾åº¦æµ®ç‚¹æ•°ï¼ˆå³é€šå¸¸æ‰€è¯´çš„â€œdoubleâ€ç±»å‹ï¼‰ï¼Œå¹¶ä¸”è¿™ä¸ªæ•°æ˜¯æŒ‰ç…§å¤§ç«¯åºï¼ˆBig-Endianï¼‰çš„æ–¹å¼å­˜å‚¨çš„ã€‚</p><p>é¦–å…ˆè®©æˆ‘ä»¬ç†è§£å‡ ä¸ªå…³é”®æ¦‚å¿µï¼š</p><ol><li><p><strong>Buffer</strong>: åœ¨ Node.js ä¸­ï¼ŒBuffer ç±»æ˜¯ä¸€ä¸ªå…¨å±€å¯ç”¨çš„ç±»ï¼Œç”¨æ¥ç›´æ¥æ“ä½œå†…å­˜ä¸­çš„æ•°æ®ã€‚Buffer å®ä¾‹ç±»ä¼¼äºæ•´æ•°æ•°ç»„ï¼Œä½†å®ƒä»¬ä¸»è¦ç”¨äºæ“ä½œåŸå§‹äºŒè¿›åˆ¶æ•°æ®ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªå¯ä»¥å­˜æ”¾å­—èŠ‚çš„æ•°ç»„ã€‚</p></li><li><p><strong>IEEE 754 åŒç²¾åº¦æµ®ç‚¹æ•°</strong>: è¿™æ˜¯ä¸€ç§æ•°æ®è¡¨ç¤ºæ ‡å‡†ï¼Œç”¨äºåœ¨è®¡ç®—æœºå†…å­˜ä¸­å­˜å‚¨å°æ•°ç‚¹æ•°ï¼ˆå³æµ®ç‚¹æ•°ï¼‰ã€‚åŒç²¾åº¦æ„å‘³ç€è¿™ç§æ•°æ®ç±»å‹ä½¿ç”¨ 64 ä½ï¼ˆ8 å­—èŠ‚ï¼‰æ¥å­˜å‚¨ä¸€ä¸ªæµ®ç‚¹æ•°å€¼ï¼Œæä¾›äº†è¾ƒé«˜çš„æ•°å€¼ç²¾åº¦ã€‚</p></li><li><p><strong>å¤§ç«¯åº (Big-Endian)</strong>: å¤§ç«¯åºå’Œå°ç«¯åºæ˜¯æŒ‡å¤šå­—èŠ‚æ•°æ®åœ¨å†…å­˜ä¸­çš„å­˜å‚¨é¡ºåºã€‚å¤§ç«¯åºè¡¨ç¤ºæœ€é«˜æœ‰æ•ˆå­—èŠ‚ï¼ˆMSBï¼‰å­˜å‚¨åœ¨æœ€ä½çš„å†…å­˜åœ°å€ï¼Œå…¶åæ˜¯æ¬¡é«˜å­—èŠ‚ï¼Œä¾æ­¤ç±»æ¨ï¼Œç›´åˆ°æœ€ä½æœ‰æ•ˆå­—èŠ‚ï¼ˆLSBï¼‰è¢«å­˜å‚¨åœ¨æœ€é«˜çš„å†…å­˜åœ°å€ã€‚</p></li></ol><p>ç°åœ¨ï¼Œå½“ä½ è°ƒç”¨ <code>buf.readDoubleBE(offset)</code> æ–¹æ³•æ—¶ï¼Œå®ƒå°†æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ul><li>ä» Buffer å¯¹è±¡ <code>buf</code> çš„ <code>offset</code> æŒ‡å®šä½ç½®å¼€å§‹ï¼Œè¯»å–æ¥ä¸‹æ¥çš„ 8 ä¸ªå­—èŠ‚ã€‚</li><li>å°†è¿™ 8 ä¸ªå­—èŠ‚è§£é‡Šä¸ºä¸€ä¸ªå¤§ç«¯åºå­˜å‚¨çš„åŒç²¾åº¦æµ®ç‚¹æ•°ã€‚</li><li>è¿”å›è¿™ä¸ªè§£é‡Šå‡ºæ¥çš„åŒç²¾åº¦æµ®ç‚¹æ•°å€¼ã€‚</li></ul><p>å¦‚æœæ²¡æœ‰æä¾› <code>offset</code> å‚æ•°ï¼Œé»˜è®¤å€¼æ˜¯ <code>0</code>ï¼Œå³ä» Buffer å¯¹è±¡çš„å¼€å§‹ä½ç½®è¯»å–ã€‚</p><p>è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥ Node.js çš„ buffer æ¨¡å—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«ç‰¹å®šå­—èŠ‚çš„ Buffer å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¾‹å¦‚ï¼šè¿™æ˜¯ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•° 42 çš„å¤§ç«¯åºè¡¨ç¤º</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x40</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x45</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ readDoubleBE æ–¹æ³•ï¼Œä»ç¬¬0ä¸ªå­—èŠ‚å¼€å§‹è¯»å–ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> num</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readDoubleBE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">num</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºåº”è¯¥æ˜¯ 42</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª Buffer å¯¹è±¡ <code>buf</code>ï¼Œé‡Œé¢åŒ…å«äº†ä»£è¡¨æ•°å­— 42 çš„ 8 ä¸ªå­—èŠ‚ï¼ˆä»¥å¤§ç«¯åºæ ¼å¼å­˜å‚¨ï¼‰ã€‚ç„¶åæˆ‘ä»¬è°ƒç”¨ <code>readDoubleBE(0)</code> æ–¹æ³•ä»è¿™ä¸ª Buffer ä¸­è¯»å–ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°ï¼Œç»“æœæ˜¾ç¤ºæ˜¯ 42ã€‚</p><p>è¯·æ³¨æ„ï¼Œè¯»å–æ—¶å¿…é¡»ç¡®ä¿ Buffer å¤§å°è‡³å°‘æœ‰è¶³å¤Ÿçš„ç©ºé—´æ¥å­˜å‚¨ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°ï¼ˆ8 å­—èŠ‚ï¼‰ï¼Œå¦åˆ™å¦‚æœ <code>offset</code> åŠ ä¸Šéœ€è¦è¯»å–çš„å­—èŠ‚æ•°è¶…è¿‡äº† Buffer å®é™…çš„é•¿åº¦ï¼ŒNode.js å°†ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p><h3 id="buf-readdoublele-offset" tabindex="-1"><a class="header-anchor" href="#buf-readdoublele-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreaddoubleleoffset" target="_blank" rel="noopener noreferrer">buf.readDoubleLE([offset])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹ Node.js ä¸­ <code>buf.readDoubleLE([offset])</code> æ–¹æ³•çš„ä½œç”¨ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ Buffer æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ç±»ã€‚åœ¨ Node.js ä¸­ï¼ŒBuffer å¯¹è±¡ç”¨æ¥è¡¨ç¤ºå›ºå®šé•¿åº¦çš„å­—èŠ‚åºåˆ—ã€‚è¿™æ˜¯å› ä¸ºåœ¨ç½‘ç»œé€šä¿¡æˆ–æ–‡ä»¶æ“ä½œä¸­ï¼Œæ•°æ®é€šå¸¸ä»¥äºŒè¿›åˆ¶å½¢å¼ä¼ è¾“ã€‚</p><p>è€Œ <code>buf.readDoubleLE([offset])</code> æ˜¯ Buffer ç±»ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨äºä»ç¼“å†²åŒºï¼ˆBufferï¼‰ä¸­è¯»å–ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°ã€‚è¿™é‡Œçš„ &quot;LE&quot; ä»£è¡¨ &quot;Little-Endian&quot;ï¼Œå³å°ç«¯åºã€‚å°ç«¯åºæ˜¯æŒ‡ä½ä½å­—èŠ‚æ’æ”¾åœ¨å†…å­˜çš„å‰é¢ï¼Œé«˜ä½å­—èŠ‚æ’åœ¨åé¢ã€‚</p><p>è®©æˆ‘ä»¬æ¥åˆ†è§£ä¸€ä¸‹ <code>buf.readDoubleLE([offset])</code> è¿™ä¸ªæ–¹æ³•ï¼š</p><ul><li><code>buf</code>ï¼šè¿™å°±æ˜¯ä½ è¦æ“ä½œçš„ Buffer å¯¹è±¡ã€‚</li><li><code>.readDoubleLE</code>ï¼šè¿™æ˜¯ Buffer ç±»ä¸­çš„æ–¹æ³•ï¼Œç”¨äºè¯»å–åŒç²¾åº¦æµ®ç‚¹æ•°ã€‚</li><li><code>[offset]</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºå¼€å§‹è¯»å–æ•°æ®çš„ä½ç½®(åç§»é‡)ã€‚å¦‚æœä¸æä¾› offsetï¼Œé»˜è®¤ä» 0 å¼€å§‹ã€‚</li></ul><p>ç°åœ¨ä¸¾å‡ ä¸ªå®é™…ä¾‹å­æ¥è¯´æ˜å®ƒçš„ç”¨æ³•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥ Node.js çš„ buffer æ¨¡å—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«åŒç²¾åº¦æµ®ç‚¹æ•°çš„ Buffer å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ•°å­— 123.456 çš„ Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">allocUnsafe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ†é… 8 ä¸ªå­—èŠ‚çš„å†…å­˜ç©ºé—´</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ writeDoubleLE æ–¹æ³•å†™å…¥ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°åˆ° Buffer ä¸­</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬æŠŠ 123.456 å†™å…¥åˆ° Buffer çš„èµ·å§‹ä½ç½®ï¼Œå³ offset ä¸º 0 çš„åœ°æ–¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeDoubleLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">123.456</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨æˆ‘ä»¬ä½¿ç”¨ readDoubleLE æ–¹æ³•ä» Buffer ä¸­è¯»å–è¿™ä¸ªæ•°å­—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> num</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readDoubleLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">num</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š123.456</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœæœ‰ä¸€ä¸ª Buffer åŒ…å«äº†å¤šä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°ï¼Œæ¯”å¦‚ï¼š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">allocUnsafe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ†é… 16 ä¸ªå­—èŠ‚çš„å†…å­˜ç©ºé—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeDoubleLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">123.456</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¬¬ä¸€ä¸ªæ•°å†™åœ¨èµ·å§‹ä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeDoubleLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">789.1011</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¬¬äºŒä¸ªæ•°å†™åœ¨ç¬¬ 8 ä¸ªå­—èŠ‚çš„ä½ç½®</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ†åˆ«è¯»å–è¿™ä¸¤ä¸ªæ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> num1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readDoubleLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»èµ·å§‹ä½ç½®è¯»å–ç¬¬ä¸€ä¸ªæ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> num2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readDoubleLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»ç¬¬ 8 ä¸ªå­—èŠ‚çš„ä½ç½®è¯»å–ç¬¬äºŒä¸ªæ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">num1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š123.456</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">num2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š789.1011</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ¯”å¦‚å½“ä½ ä¸æŸäº›ç¡¬ä»¶è®¾å¤‡è¿›è¡Œé€šä¿¡æˆ–è€…è§£æäºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼æ—¶ï¼Œå¯èƒ½ä¼šéœ€è¦ä»äºŒè¿›åˆ¶æµä¸­è¯»å–åŒç²¾åº¦æµ®ç‚¹æ•°ï¼Œè¿™æ—¶ <code>readDoubleLE</code> æ–¹æ³•å°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼Œ<code>buf.readDoubleLE([offset])</code> æ–¹æ³•åœ¨ Node.js ç¼–ç¨‹ä¸­ä¸»è¦ç”¨äºä» Buffer ä¸­æŒ‰ç…§å°ç«¯åºè¯»å–ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°ã€‚é€šè¿‡æŒ‡å®šåç§»é‡ï¼Œå¯ä»¥çµæ´»åœ°ä» Buffer çš„ä»»æ„ä½ç½®å¼€å§‹è¯»å–æ•°æ®ã€‚</p><h3 id="buf-readfloatbe-offset" tabindex="-1"><a class="header-anchor" href="#buf-readfloatbe-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreadfloatbeoffset" target="_blank" rel="noopener noreferrer">buf.readFloatBE([offset])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥ç†è§£ <code>buf.readFloatBE([offset])</code> è¿™ä¸ªæ–¹æ³•ã€‚</p><p>åœ¨ Node.js ä¸­ï¼ŒBuffer æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ç±»ã€‚å®ƒå¯ä»¥å­˜å‚¨ä»»æ„ç±»å‹çš„æ•°æ®ï¼Œæ¯”å¦‚æ–‡æœ¬ã€å›¾ç‰‡ã€æˆ–æ˜¯éŸ³é¢‘è§†é¢‘ç­‰ã€‚æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åœ¨è¿™äº›äºŒè¿›åˆ¶æ•°æ®ä¸­è¯»å–ç‰¹å®šç±»å‹çš„æ•°æ®ï¼Œä¾‹å¦‚æµ®ç‚¹æ•°ã€‚</p><p><code>buf.readFloatBE([offset])</code> æ˜¯ Buffer ç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºä»ç¼“å†²åŒºï¼ˆBufferï¼‰ä¸­è¯»å–ä¸€ä¸ª Big Endian æ ¼å¼çš„ 32 ä½æµ®ç‚¹æ•°ï¼ˆå³å››å­—èŠ‚ï¼‰ã€‚Big Endian æ˜¯ä¸€ç§å­—èŠ‚åºï¼Œå³æœ€é‡è¦çš„å­—èŠ‚ï¼ˆé«˜ä½å­—èŠ‚ï¼‰æ’åœ¨å­—èŠ‚åºåˆ—çš„å‰é¢ã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>offset</code>ï¼ˆå¯é€‰ï¼‰ï¼šè¡¨ç¤ºå¼€å§‹è¯»å–æ•°æ®çš„èµ·å§‹ä½ç½®ï¼Œå…¶å•ä½æ˜¯å­—èŠ‚ã€‚å¦‚æœä¸æä¾›è¿™ä¸ªå‚æ•°ï¼Œåˆ™é»˜è®¤ä» 0 å¼€å§‹ã€‚</li></ul><p>ç°åœ¨ï¼Œä¸¾å‡ ä¸ªå®ä¾‹æ¥å…·ä½“è¯´æ˜è¿™ä¸ªæ–¹æ³•æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><p>å‡è®¾æˆ‘ä»¬æ”¶åˆ°äº†ä¸€æ®µåŒ…å«æµ®ç‚¹æ•°çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œå¹¶ä¸”æˆ‘ä»¬çŸ¥é“è¿™äº›æµ®ç‚¹æ•°æ˜¯ä½¿ç”¨ Big Endian æ ¼å¼ç¼–ç çš„ã€‚æˆ‘ä»¬æƒ³è¦ä»è¿™æ®µæ•°æ®ä¸­è¯»å–ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªæµ®ç‚¹æ•°ã€‚</p><h3 id="å®ä¾‹-1-è¯»å–-buffer-ä¸­çš„ç¬¬ä¸€ä¸ªæµ®ç‚¹æ•°" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-1-è¯»å–-buffer-ä¸­çš„ç¬¬ä¸€ä¸ªæµ®ç‚¹æ•°"><span>å®ä¾‹ 1ï¼šè¯»å– Buffer ä¸­çš„ç¬¬ä¸€ä¸ªæµ®ç‚¹æ•°</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªå«æœ‰ä¸¤ä¸ªæµ®ç‚¹æ•°çš„ Bufferã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ†é… 8 å­—èŠ‚å†…å­˜ï¼Œå› ä¸ºæ¯ä¸ªæµ®ç‚¹æ•°å  4 å­—èŠ‚ï¼Œæ€»å…±éœ€è¦ 8 å­—èŠ‚ã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªæµ®ç‚¹æ•° 12.34 å’Œ 56.78ï¼Œå¹¶å°†å®ƒä»¬æŒ‰ç…§ Big Endian æ ¼å¼ç¼–å†™å…¥ Bufferã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeFloatBE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">12.34</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¬¬ä¸€ä¸ªæµ®ç‚¹æ•°ï¼Œä»ç´¢å¼• 0 å¼€å§‹å†™ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeFloatBE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">56.78</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¬¬äºŒä¸ªæµ®ç‚¹æ•°ï¼Œä»ç´¢å¼• 4 å¼€å§‹å†™ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªå äº† 4 å­—èŠ‚ã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ readFloatBE æ–¹æ³•è¯»å–ç¬¬ä¸€ä¸ªæµ®ç‚¹æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> firstNumber</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFloatBE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»ç´¢å¼• 0 å¼€å§‹è¯»å–ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">firstNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºåº”è¯¥æ˜¯ 12.34</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ä¾‹-2-è¯»å–-buffer-ä¸­çš„ç¬¬äºŒä¸ªæµ®ç‚¹æ•°" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-2-è¯»å–-buffer-ä¸­çš„ç¬¬äºŒä¸ªæµ®ç‚¹æ•°"><span>å®ä¾‹ 2ï¼šè¯»å– Buffer ä¸­çš„ç¬¬äºŒä¸ªæµ®ç‚¹æ•°</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç»§ç»­ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥è¯»å–ç¬¬äºŒä¸ªæµ®ç‚¹æ•°ã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ readFloatBE æ–¹æ³•è¯»å–ç¬¬äºŒä¸ªæµ®ç‚¹æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secondNumber</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFloatBE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»ç´¢å¼• 4 å¼€å§‹è¯»å–ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªæµ®ç‚¹æ•°å·²ç»å æ®äº†å‰ 4 ä¸ªå­—èŠ‚ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secondNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºåº”è¯¥æ˜¯ 56.78</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å¿…é¡»ç¡®ä¿ Buffer é‡Œé¢çš„æ•°æ®ç¡®å®æ˜¯æŒ‰ç…§æˆ‘ä»¬é¢„æœŸçš„æ ¼å¼ç¼–å†™çš„ï¼Œå¦åˆ™è¯»å–å‡ºæ¥çš„ç»“æœå¯èƒ½æ˜¯é”™è¯¯çš„ã€‚è€Œ <code>readFloatBE</code> å°±æ˜¯æŒ‰ç…§ Big Endian çš„æ–¹å¼æ¥è¯»å–æ•°æ®çš„ã€‚å¦‚æœæ•°æ®ä¸æ˜¯ Big Endianï¼Œè€Œæ˜¯ Little Endianï¼ˆå°ç«¯æ¨¡å¼ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åº”è¯¥ä½¿ç”¨ <code>readFloatLE</code> æ–¹æ³•æ¥è¯»å–ã€‚</p><p>å¸Œæœ›è¿™äº›ä¾‹å­èƒ½å¸®åŠ©ä½ ç†è§£ <code>buf.readFloatBE([offset])</code> æ–¹æ³•çš„å·¥ä½œåŸç†ï¼</p><h3 id="buf-readfloatle-offset" tabindex="-1"><a class="header-anchor" href="#buf-readfloatle-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreadfloatleoffset" target="_blank" rel="noopener noreferrer">buf.readFloatLE([offset])</a></span></a></h3><p>Node.js ä¸­çš„ <code>Buffer</code> å¯¹è±¡æ˜¯ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ã€‚å½“ä½ åœ¨å¤„ç†æ–‡ä»¶ã€ç½‘ç»œæ“ä½œæˆ–è€…å…¶ä»– I/O æ“ä½œæ—¶ï¼Œç»å¸¸ä¼šç”¨åˆ°å®ƒã€‚</p><p><code>buf.readFloatLE([offset])</code> æ˜¯ <code>Buffer</code> å¯¹è±¡ä¸Šçš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨æ¥ä»ç¼“å†²åŒºï¼ˆbufferï¼‰ä¸­è¯»å–ä¸€ä¸ªå°ç«¯åºï¼ˆLittle-Endianï¼‰æ ¼å¼çš„ 32 ä½æµ®ç‚¹æ•°ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯å°ç«¯åº-little-endian" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯å°ç«¯åº-little-endian"><span>ä»€ä¹ˆæ˜¯å°ç«¯åºï¼ˆLittle-Endianï¼‰ï¼Ÿ</span></a></h3><p>å°ç«¯åºæ˜¯ä¸€ç§å­—èŠ‚é¡ºåºï¼Œå½“å¤šå­—èŠ‚ç»„æˆçš„å€¼è¢«å­˜å‚¨åœ¨å†…å­˜ä¸­æ—¶ï¼Œæœ€ä½æœ‰æ•ˆå­—èŠ‚ï¼ˆLSBï¼‰å­˜å‚¨åœ¨æœ€ä½çš„åœ°å€ä¸Šï¼Œè€Œæœ€é«˜æœ‰æ•ˆå­—èŠ‚ï¼ˆMSBï¼‰å­˜å‚¨åœ¨æœ€é«˜çš„åœ°å€ä¸Šã€‚</p><h3 id="å‚æ•°-4" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-4"><span>å‚æ•°</span></a></h3><ul><li><code>offset</code> ï¼ˆå¯é€‰ï¼‰: æ•°å­—ï¼Œè¡¨ç¤ºä» <code>Buffer</code> å¯¹è±¡çš„å“ªä¸ªä½ç½®å¼€å§‹è¯»å–æ•°æ®ã€‚å¦‚æœä¸æä¾›è¿™ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆé»˜è®¤ä» <code>Buffer</code> çš„å¼€å§‹ä½ç½®è¯»å–ã€‚</li></ul><h3 id="å®é™…è¿ç”¨-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨-1"><span>å®é™…è¿ç”¨</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåŒ…å«äºŒè¿›åˆ¶æ•°æ®çš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸­åŒ…å«äº†ä¸€ç³»åˆ—çš„æµ®ç‚¹æ•°ï¼Œè¿™äº›æµ®ç‚¹æ•°éƒ½æ˜¯ä»¥å°ç«¯åºæ ¼å¼å­˜å‚¨çš„ã€‚ä½ æƒ³è¦åœ¨ Node.js ç¨‹åºä¸­è¯»å–è¿™äº›æ•°å€¼ã€‚</p><p>ä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥ fs æ¨¡å—ï¼Œç”¨äºæ–‡ä»¶ç³»ç»Ÿæ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;fs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼‚æ­¥åœ°è¯»å–æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;path/to/your/file&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;è¯»å–æ–‡ä»¶å‘ç”Ÿé”™è¯¯&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å‡è®¾æ¯ä¸ªæµ®ç‚¹æ•°åé¢ç´§è·Ÿç€ä¸‹ä¸€ä¸ªæµ®ç‚¹æ•°</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // åˆ™å¯ä»¥è¿™æ ·å¾ªç¯è¯»å–å®ƒä»¬ï¼š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> offset</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">offset</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">offset</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFloatLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">offset</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`åœ¨åç§»é‡ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">offset</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> å¤„çš„æµ®ç‚¹æ•°æ˜¯ï¼š`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="è§£é‡Š-1" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-1"><span>è§£é‡Šï¼š</span></a></h4><ol><li>ä½¿ç”¨ <code>fs.readFile</code> æ–¹æ³•å¼‚æ­¥åœ°è¯»å–æ–‡ä»¶å†…å®¹ï¼Œè¯¥æ–¹æ³•å°†æ–‡ä»¶å†…å®¹ä½œä¸º <code>Buffer</code> å¯¹è±¡è¿”å›ã€‚</li><li>åœ¨å›è°ƒå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯å‘ç”Ÿã€‚å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œåˆ™ç»§ç»­å¤„ç†ã€‚</li><li>ç”±äº 32 ä½æµ®ç‚¹æ•°å ç”¨ 4 ä¸ªå­—èŠ‚ï¼Œæˆ‘ä»¬è®¾ç½®å¾ªç¯æ¯æ¬¡é€’å¢ 4ã€‚</li><li>ä½¿ç”¨ <code>buffer.readFloatLE(offset)</code> æ–¹æ³•ä»å½“å‰åç§»é‡ <code>offset</code> è¯»å–ä¸€ä¸ªå°ç«¯åºçš„ 32 ä½æµ®ç‚¹æ•°ã€‚</li><li>æ‰“å°å‡ºæ¯ä¸ªæµ®ç‚¹æ•°åŠå…¶åœ¨æ–‡ä»¶ä¸­çš„ä½ç½®ï¼ˆåç§»é‡ï¼‰ã€‚</li></ol><p>æ³¨æ„ï¼šå®é™…åº”ç”¨ä¸­å¯èƒ½éœ€è¦æ ¹æ®æ–‡ä»¶çš„å…·ä½“æ ¼å¼å’Œé¢„æœŸçš„æ•°æ®ç»“æ„è¿›è¡Œç›¸åº”çš„è°ƒæ•´ã€‚</p><h3 id="buf-readint8-offset" tabindex="-1"><a class="header-anchor" href="#buf-readint8-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreadint8offset" target="_blank" rel="noopener noreferrer">buf.readInt8([offset])</a></span></a></h3><p><code>buf.readInt8([offset])</code> æ˜¯ä¸€ä¸ª Buffer ç±»åœ¨ Node.js ä¸­çš„æ–¹æ³•ï¼Œå®ƒç”¨äºä»ç¼“å†²åŒºï¼ˆbufferï¼‰ä¸­è¯»å–ä¸€ä¸ªæœ‰ç¬¦å·çš„ 8 ä½æ•´æ•°ï¼ˆå³ä¸€ä¸ªå­—èŠ‚ï¼‰ã€‚è¿™é‡Œæœ‰å‡ ä¸ªæ¦‚å¿µæˆ‘ä¼šé€ä¸€è§£é‡Šï¼š</p><ol><li><p><strong>Buffer</strong>: åœ¨ Node.js ä¸­ï¼ŒBuffer æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ç±»ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒå°±åƒä¸€ä¸ªå¯ä»¥å­˜å‚¨å­—èŠ‚çš„æ•°ç»„ã€‚</p></li><li><p><strong>æœ‰ç¬¦å·çš„ 8 ä½æ•´æ•°</strong>ï¼šåœ¨è®¡ç®—æœºä¸­ï¼Œä¸€ä¸ª 8 ä½æ•´æ•°å¯ä»¥è¡¨ç¤º 256 ä¸ªä¸åŒçš„å€¼ã€‚æœ‰ç¬¦å·çš„æ„æ€æ˜¯ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†ä»£è¡¨æ­£æ•°ï¼Œå¦ä¸€éƒ¨åˆ†ä»£è¡¨è´Ÿæ•°ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™ç§è¡¨ç¤ºæ–¹å¼å…è®¸ä½ è¡¨ç¤ºä»-128 åˆ° 127 çš„æ•´æ•°ã€‚</p></li><li><p><strong>offset</strong>ï¼šåç§»é‡ï¼ŒæŒ‡çš„æ˜¯åœ¨ Buffer ä¸­å¼€å§‹è¯»å–æ•°æ®çš„ä½ç½®ã€‚å®ƒæ˜¯å¯é€‰çš„ï¼Œé»˜è®¤ä¸º 0ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ ä¸æä¾› offsetï¼Œå®ƒå°±ä¼šä» Buffer çš„å¼€å¤´è¯»å–æ•°æ®ã€‚</p></li></ol><p>ç°åœ¨ï¼Œä¸¾å‡ ä¸ªå®é™…çš„ä¾‹å­æ¥è¯´æ˜ <code>readInt8</code> æ–¹æ³•å¦‚ä½•å·¥ä½œï¼š</p><h3 id="ç¤ºä¾‹-1-è¯»å–-buffer-ä¸­çš„ç¬¬ä¸€ä¸ªå­—èŠ‚" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-è¯»å–-buffer-ä¸­çš„ç¬¬ä¸€ä¸ªå­—èŠ‚"><span>ç¤ºä¾‹ 1ï¼šè¯»å– Buffer ä¸­çš„ç¬¬ä¸€ä¸ªå­—èŠ‚</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x02</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x03</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xff</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> num</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readInt8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¸ä¼ å…¥offsetï¼Œé»˜è®¤ä»ä½ç½®0å¼€å§‹è¯»å–</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">num</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†è¾“å‡º 2ï¼Œå› ä¸º0x02å°±æ˜¯åè¿›åˆ¶çš„2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«ä¸‰ä¸ªå­—èŠ‚çš„ Bufferã€‚å½“æˆ‘ä»¬è°ƒç”¨ <code>readInt8()</code> æ–¹æ³•æ—¶ï¼Œå®ƒè¯»å–äº†ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ˆ0x02ï¼‰ï¼Œå¹¶å°†å…¶è½¬æ¢æˆäº†åè¿›åˆ¶çš„ 2ã€‚</p><h3 id="ç¤ºä¾‹-2-ä½¿ç”¨-offset-å‚æ•°è¯»å–ç‰¹å®šä½ç½®çš„å­—èŠ‚" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨-offset-å‚æ•°è¯»å–ç‰¹å®šä½ç½®çš„å­—èŠ‚"><span>ç¤ºä¾‹ 2ï¼šä½¿ç”¨ offset å‚æ•°è¯»å–ç‰¹å®šä½ç½®çš„å­—èŠ‚</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x02</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x03</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xff</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> num</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readInt8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¼ å…¥offsetä¸º2ï¼Œè¡¨ç¤ºä»Bufferçš„ç¬¬ä¸‰ä¸ªå­—èŠ‚è¯»å–</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">num</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†è¾“å‡º -1ï¼Œå› ä¸º0xffåœ¨æœ‰ç¬¦å·çš„8ä½æ•´æ•°ä¸­ä»£è¡¨-1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æŒ‡å®šäº† offset å‚æ•°ä¸º 2ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æƒ³ä» Buffer çš„ç¬¬ä¸‰ä¸ªå­—èŠ‚ï¼ˆç´¢å¼•ä¸º 2 çš„ä½ç½®ï¼‰è¯»å–ä¸€ä¸ªæ•´æ•°ã€‚0xff åœ¨æœ‰ç¬¦å·çš„ 8 ä½æ•´æ•°è¡¨ç¤ºæ³•ä¸­æ˜¯-1ã€‚</p><h3 id="ç¤ºä¾‹-3-å½“å­—èŠ‚è¡¨ç¤ºè´Ÿæ•°æ—¶" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-å½“å­—èŠ‚è¡¨ç¤ºè´Ÿæ•°æ—¶"><span>ç¤ºä¾‹ 3ï¼šå½“å­—èŠ‚è¡¨ç¤ºè´Ÿæ•°æ—¶</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xfe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xfd</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xfc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> num</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readInt8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¼ å…¥offsetä¸º1ï¼Œè¡¨ç¤ºä»Bufferçš„ç¬¬äºŒä¸ªå­—èŠ‚è¯»å–</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">num</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†è¾“å‡º -3ï¼Œå› ä¸º0xfdåœ¨æœ‰ç¬¦å·çš„8ä½æ•´æ•°ä¸­ä»£è¡¨-3</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä» Buffer ä¸­ç¬¬äºŒä¸ªä½ç½®ï¼ˆç´¢å¼•ä¸º 1ï¼‰è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼Œ0xfd å¯¹åº”çš„æœ‰ç¬¦å· 8 ä½æ•´æ•°æ˜¯-3ï¼Œæ‰€ä»¥è¾“å‡ºç»“æœä¸º-3ã€‚</p><p>ä»¥ä¸Šä¾¿æ˜¯ <code>buf.readInt8([offset])</code> æ–¹æ³•çš„å·¥ä½œåŸç†å’Œä½¿ç”¨æ–¹å¼ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™ä¸ªæ–¹æ³•ç»å¸¸ç”¨äºå¤„ç†ç½‘ç»œæ•°æ®åŒ…æˆ–è€…æ–‡ä»¶è¯»å–ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦ä»å­—èŠ‚æµä¸­æ¢å¤å‡ºåŸå§‹çš„æ•°å­—ä¿¡æ¯æ—¶ã€‚</p><h3 id="buf-readint16be-offset" tabindex="-1"><a class="header-anchor" href="#buf-readint16be-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreadint16beoffset" target="_blank" rel="noopener noreferrer">buf.readInt16BE([offset])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥èŠä¸€èŠ Node.js ä¸­çš„ <code>buf.readInt16BE([offset])</code> æ–¹æ³•ã€‚</p><p>å½“ä½ åœ¨ä½¿ç”¨ Node.js æ—¶ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°éœ€è¦å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„æƒ…å†µã€‚Node.js æä¾›äº†ä¸€ä¸ªå…¨å±€çš„ <code>Buffer</code> ç±»ï¼Œå®ƒå¯ä»¥ç”¨æ¥ç›´æ¥æ“ä½œå†…å­˜ä¸­çš„æ•°æ®ã€‚<code>Buffer</code> æ˜¯ä¸€ä¸ªè¡¨ç¤ºå›ºå®šå¤§å°çš„å­—èŠ‚åºåˆ—çš„å¯¹è±¡ï¼Œå¾ˆåƒæ•°ç»„ï¼Œä½†æ˜¯æ˜¯é’ˆå¯¹äºŒè¿›åˆ¶æ•°æ®çš„ã€‚</p><p>ç°åœ¨ï¼Œå‡è®¾ä½ æ­£åœ¨å¤„ç†ä¸€äº›æ¥è‡ªæ–‡ä»¶ã€ç½‘ç»œæˆ–å…¶ä»–æºçš„äºŒè¿›åˆ¶æ•°æ®æµã€‚è¿™äº›æ•°æ®é€šå¸¸æ˜¯æŒ‰ç…§ç‰¹å®šçš„æ ¼å¼æ’åˆ—çš„ï¼Œæ¯”å¦‚ï¼šæ•´æ•°ã€æµ®ç‚¹æ•°ç­‰ã€‚ä¸ºäº†ä»ä¸€ä¸ª <code>Buffer</code> å¯¹è±¡ä¸­è¯»å–è¿™æ ·çš„æ•°æ®ï¼Œä½ éœ€è¦ä½¿ç”¨ç‰¹å®šçš„æ–¹æ³•ã€‚å…¶ä¸­ï¼Œ<code>readInt16BE()</code> å°±æ˜¯è¿™æ ·ä¸€ä¸ªæ–¹æ³•ã€‚</p><h3 id="è§£é‡Š-2" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-2"><span>è§£é‡Š</span></a></h3><ul><li><code>readInt16BE()</code> æ–¹æ³•ç”¨äºä»ç¼“å†²åŒºï¼ˆbufferï¼‰ä¸­è¯»å–ä¸€ä¸ª 16 ä½çš„æœ‰ç¬¦å·æ•´æ•°ã€‚</li><li>è¿™ä¸ªæ–¹æ³•çš„ &quot;BE&quot; è¡¨ç¤º Big Endianï¼Œæ„æ€æ˜¯æ•°æ®çš„é«˜ä½ï¼ˆæœ€é‡è¦çš„ä½ï¼‰ä¿å­˜åœ¨åœ°å€æœ€ä½çš„å­˜å‚¨å•å…ƒã€‚</li><li><code>offset</code> å‚æ•°æ˜¯å¯é€‰çš„ï¼Œå®ƒæŒ‡å®šä»å“ªé‡Œå¼€å§‹è¯»å–ç¼“å†²åŒºä¸­çš„æ•°æ®ã€‚å¦‚æœæ²¡æœ‰æä¾› <code>offset</code>ï¼Œåˆ™é»˜è®¤ä¸º <code>0</code>ã€‚</li></ul><h3 id="å®ä¾‹è§£æ" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹è§£æ"><span>å®ä¾‹è§£æ</span></a></h3><p>æ¯ä¸ªæ•´æ•°éƒ½ç”±ä¸€å®šæ•°é‡çš„å­—èŠ‚ç»„æˆã€‚å¯¹äº 16 ä½æ•´æ•°è€Œè¨€ï¼Œå®ƒå ç”¨ 2 ä¸ªå­—èŠ‚ã€‚åœ¨ Big Endian æ ¼å¼ä¸­ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ˆæ›´ä½çš„å†…å­˜åœ°å€ï¼‰åŒ…å«äº†è¿™ä¸ªæ•°å­—çš„æœ€é«˜æœ‰æ•ˆéƒ¨åˆ†ï¼Œè€Œç¬¬äºŒä¸ªå­—èŠ‚åŒ…å«äº†å‰©ä¸‹çš„éƒ¨åˆ†ã€‚</p><p>ä¸¾ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«éšæœºå­—èŠ‚çš„ Buffer å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x12</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x34</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x56</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x78</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ readInt16BE è¯»å–å‰ä¸¤ä¸ªå­—èŠ‚ä½œä¸ºä¸€ä¸ª 16 ä½æ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> number1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readInt16BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">number1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 4660</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å†è¯»å–åä¸¤ä¸ªå­—èŠ‚ä½œä¸ºå¦ä¸€ä¸ª 16 ä½æ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> number2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readInt16BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">number2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 22136</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>buf</code> è¢«åˆå§‹åŒ–ä¸ºä¸€ä¸ªåŒ…å«å››ä¸ªå­—èŠ‚çš„ <code>Buffer</code> å®ä¾‹ã€‚æˆ‘ä»¬è°ƒç”¨ <code>readInt16BE()</code> æ–¹æ³•ä¸¤æ¬¡ï¼š</p><ol><li><p>ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶ï¼Œæˆ‘ä»¬æ²¡æœ‰ä¼ é€’ <code>offset</code>ï¼Œæ‰€ä»¥å®ƒä»ç¼“å†²åŒºçš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ˆç´¢å¼•ä¸º <code>0</code>ï¼‰å¼€å§‹è¯»å–ã€‚è¿™ä¸ªæ–¹æ³•è¯»å–äº†å­—èŠ‚ <code>0x12</code> å’Œ <code>0x34</code>ï¼Œå¹¶å°†å®ƒä»¬ç»„åˆæˆä¸€ä¸ªå¤§ç«¯æ ¼å¼çš„ 16 ä½æ•´æ•°ã€‚è¿™ä¸ªæ•´æ•°çš„å€¼æ˜¯ <code>0x1234</code>ï¼ˆåè¿›åˆ¶ä¸­çš„ 4660ï¼‰ã€‚</p></li><li><p>ç¬¬äºŒæ¬¡è°ƒç”¨æ—¶ï¼Œæˆ‘ä»¬ä¼ é€’äº† <code>offset</code> å€¼ <code>2</code>ï¼Œå› æ­¤å®ƒä»ç¼“å†²åŒºçš„ç¬¬ä¸‰ä¸ªå­—èŠ‚å¼€å§‹è¯»å–ã€‚è¿™ä¸ªæ–¹æ³•è¯»å–å­—èŠ‚ <code>0x56</code> å’Œ <code>0x78</code>ï¼Œç„¶åå°†å®ƒä»¬ç»„åˆæˆå¦ä¸€ä¸ªå¤§ç«¯æ ¼å¼çš„ 16 ä½æ•´æ•°ã€‚è¿™ä¸ªæ•´æ•°çš„å€¼æ˜¯ <code>0x5678</code>ï¼ˆåè¿›åˆ¶ä¸­çš„ 22136ï¼‰ã€‚</p></li></ol><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥ä»ä¸€ä¸ªåŒ…å«äºŒè¿›åˆ¶æ•°æ®çš„ <code>Buffer</code> ä¸­è¯»å–æ ¼å¼åŒ–çš„æ•°æ®ã€‚è¿™åœ¨å¤„ç†ç½‘ç»œé€šä¿¡ã€æ–‡ä»¶è¯»å†™ç­‰åœºæ™¯æ—¶éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºè¿™äº›ç¯å¢ƒä¸‹ç»å¸¸éœ€è¦æ“ä½œä¸åŒæ•°æ®ç±»å‹çš„äºŒè¿›åˆ¶è¡¨ç¤ºã€‚</p><h3 id="buf-readint16le-offset" tabindex="-1"><a class="header-anchor" href="#buf-readint16le-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreadint16leoffset" target="_blank" rel="noopener noreferrer">buf.readInt16LE([offset])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹ Node.js ä¸­ <code>buf.readInt16LE([offset])</code> æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå®ƒé€šå¸¸å¦‚ä½•ä½¿ç”¨ã€‚</p><p><code>Buffer</code> åœ¨ Node.js ä¸­æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œå®ƒå…è®¸æˆ‘ä»¬å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµã€‚ä½ å¯ä»¥æŠŠ <code>Buffer</code> æƒ³è±¡æˆä¸€ä¸ªå¯ä»¥å­˜å‚¨ä»»æ„ç±»å‹æ•°æ®ï¼ˆä¾‹å¦‚æ–‡ä»¶å†…å®¹ã€ç½‘ç»œæ•°æ®ç­‰ï¼‰çš„æ•°ç»„ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬å…ˆç†è§£å‡ ä¸ªæ¦‚å¿µï¼š</p><ol><li><p><strong>Int16</strong>ï¼šè¿™é‡Œçš„ &quot;Int16&quot; è¡¨ç¤º 16 ä½æ•´æ•°ï¼Œä¹Ÿå°±æ˜¯å ç”¨ä¸¤ä¸ªå­—èŠ‚çš„æ•´æ•°å€¼ã€‚å®ƒå¯ä»¥è¡¨ç¤ºèŒƒå›´åœ¨ -32768 åˆ° 32767 ä¹‹é—´çš„æ•´æ•°ã€‚</p></li><li><p><strong>LE</strong>ï¼šLE ä»£è¡¨ &quot;Little Endian&quot;ï¼Œå³å°ç«¯æ¨¡å¼ã€‚è¿™æ˜¯è®¡ç®—æœºå†…å­˜å­˜å‚¨å¤šå­—èŠ‚æ•°æ®çš„ä¸€ç§æ ¼å¼ï¼Œåœ¨å°ç«¯æ¨¡å¼ä¸­ï¼Œæœ€ä½æœ‰æ•ˆå­—èŠ‚å­˜å‚¨åœ¨æœ€å°çš„åœ°å€ä¸Šã€‚</p></li><li><p><strong>offset</strong>ï¼šåç§»é‡ï¼Œè¿™ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œé»˜è®¤ä¸º 0ã€‚å®ƒæŒ‡çš„æ˜¯ä» <code>Buffer</code> çš„å“ªä¸ªä½ç½®å¼€å§‹è¯»å–æ•°æ®ã€‚</p></li></ol><p>é‚£ä¹ˆ <code>buf.readInt16LE([offset])</code> æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¥ä» <code>Buffer</code> å¯¹è±¡ä¸­è¯»å– 16 ä½æ•´æ•°çš„ï¼Œå¹¶ä¸”æŒ‰ç…§å°ç«¯æ¨¡å¼æ¥è§£æè¿™ä¸ªæ•´æ•°ã€‚å¦‚æœä½ æä¾›äº† <code>offset</code> å€¼ï¼Œå®ƒä¼šä» <code>Buffer</code> ä¸­çš„å¯¹åº”ä½ç½®å¼€å§‹è¯»å–è¿™ä¸ªæ•´æ•°ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªå®é™…çš„ä¾‹å­æ¥åŠ æ·±ç†è§£ï¼š</p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä»æ–‡ä»¶æˆ–ç½‘ç»œæ¥æ”¶åˆ°çš„äºŒè¿›åˆ¶æ•°æ®æµï¼Œå¹¶ä¸”çŸ¥é“å…¶ä¸­åŒ…å«äº†æˆ‘ä»¬éœ€è¦çš„ 16 ä½æ•´æ•°æ•°æ®ã€‚æˆ‘ä»¬é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ª <code>Buffer</code> å®ä¾‹æ¥ä¿å­˜è¿™äº›æ•°æ®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯æˆ‘ä»¬è·å–çš„äºŒè¿›åˆ¶æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> binaryData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x01</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x02</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x03</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x04</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª Buffer å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">binaryData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ª <code>Buffer</code> ç°åœ¨åŒ…å«äº†å››ä¸ªå­—èŠ‚ï¼Œåˆ†åˆ«æ˜¯ <code>0x01</code>, <code>0x02</code>, <code>0x03</code>, <code>0x04</code>ã€‚</p><p>æ¥ç€ï¼Œæˆ‘ä»¬æƒ³è¦è¯»å–è¿™ä¸ª <code>Buffer</code> ä¸­çš„ 16 ä½æ•´æ•°ï¼ˆå°ç«¯æ¨¡å¼ï¼‰ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä» Buffer ä¸­è¯»å– 16 ä½æ•´æ•°ï¼ˆå°ç«¯æ¨¡å¼ï¼‰ï¼Œæ²¡æœ‰æä¾›åç§»é‡ï¼Œé»˜è®¤ä»å¤´å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> int16</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readInt16LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">int16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå°†ä¼šæ˜¯ 513ï¼Œå› ä¸ºåœ¨å°ç«¯æ¨¡å¼ä¸­ï¼Œ0x0201 è¢«è§£æä¸º 513</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœæˆ‘ä»¬æä¾›ä¸€ä¸ªåç§»é‡ï¼Œæ¯”å¦‚ 1ï¼Œå®ƒå°†ä»ç¬¬äºŒä¸ªå­—èŠ‚å¼€å§‹è¯»å–</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> int16WithOffset</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readInt16LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">int16WithOffset</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå°†ä¼šæ˜¯ 1027ï¼Œå› ä¸º 0x0302 è¢«è§£æä¸º 1027</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°é€šè¿‡ä¸åŒçš„ <code>offset</code>ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè¯»å–åˆ° <code>Buffer</code> ä¸­ä¸åŒä½ç½®çš„ 16 ä½æ•´æ•°ã€‚</p><p>è¿™ä¸ªæ–¹æ³•åœ¨å¤„ç†è¯¸å¦‚ç½‘ç»œé€šä¿¡ã€æ–‡ä»¶è¯»å–ç­‰åœºæ™¯ä¸­æ¶‰åŠçš„äºŒè¿›åˆ¶æ•°æ®æ—¶éå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œå½“ä½ è¯»å–ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå¯èƒ½æ˜¯ä¸€ä¸ªå›¾åƒæˆ–éŸ³é¢‘æ–‡ä»¶ï¼‰å¹¶ä¸”æƒ³è¦è§£æå…¶ä¸­çš„æŸäº›ç‰¹å®šæ•°æ®æ—¶ï¼Œ<code>readInt16LE</code> æ–¹æ³•å¯ä»¥å¸®åŠ©ä½ å¾—åˆ°æ­£ç¡®çš„æ•°å€¼ã€‚</p><h3 id="buf-readint32be-offset" tabindex="-1"><a class="header-anchor" href="#buf-readint32be-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreadint32beoffset" target="_blank" rel="noopener noreferrer">buf.readInt32BE([offset])</a></span></a></h3><p>å¥½çš„ï¼ŒNode.js ä¸­çš„ <code>buf.readInt32BE([offset])</code> æ–¹æ³•æ˜¯ä¸€ä¸ªç”¨äºä» bufferï¼ˆç¼“å†²åŒºï¼‰ä¸­æŒ‰å¤§ç«¯é¡ºåºï¼ˆBig-Endianï¼‰è¯»å–ä¸€ä¸ª 32 ä½æ•´æ•°çš„å‡½æ•°ã€‚</p><p>é¦–å…ˆï¼Œè§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯ Bufferã€‚åœ¨ Node.js ä¸­ï¼ŒBuffer æ˜¯ä¸€ä¸ªå­˜å‚¨äºŒè¿›åˆ¶æ•°æ®çš„å®¹å™¨ï¼Œç±»ä¼¼äºæ•°ç»„ï¼Œä½†ä¸“é—¨ç”¨æ¥å¤„ç†åƒ TCP æµæˆ–æ–‡ä»¶æµç­‰ IO æ“ä½œä¸­çš„åŸå§‹äºŒè¿›åˆ¶æ•°æ®ã€‚ç”±äº JavaScript åŸç”Ÿä¸æ”¯æŒè¯»å†™äºŒè¿›åˆ¶æ•°æ®ï¼ŒNode.js æä¾›äº† Buffer ç±»æ¥æ»¡è¶³è¿™ä¸ªéœ€æ±‚ã€‚</p><p>ç„¶åï¼Œæ¥ç†è§£â€œå¤§ç«¯é¡ºåºï¼ˆBig-Endianï¼‰â€çš„æ¦‚å¿µã€‚å¤§ç«¯å’Œå°ç«¯æ˜¯æŒ‡å¤šå­—èŠ‚æ•°æ®çš„å­˜å‚¨é¡ºåºã€‚åœ¨å¤§ç«¯æ¨¡å¼ä¸‹ï¼Œé«˜ä½å­—èŠ‚è¢«å­˜å‚¨åœ¨å†…å­˜çš„ä½åœ°å€ç«¯ï¼Œè€Œåœ¨å°ç«¯æ¨¡å¼ä¸‹ï¼Œåˆ™æ˜¯ç›¸åã€‚</p><p>ç°åœ¨ï¼Œè®²è§£ <code>buf.readInt32BE([offset])</code> æ–¹æ³•ï¼š</p><ul><li><code>readInt32BE</code> æ˜¯ Buffer ç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºä» Buffer å¯¹è±¡ä¸­è¯»å–ä¸€ä¸ª 32 ä½çš„æœ‰ç¬¦å·æ•´æ•°ï¼ˆå³å¯ä»¥æ˜¯æ­£æ•°ä¹Ÿå¯ä»¥æ˜¯è´Ÿæ•°ï¼‰ã€‚</li><li><code>[offset]</code> æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œä»£è¡¨ä» Buffer çš„å“ªä¸ªä½ç½®å¼€å§‹è¯»å–æ•°æ®ã€‚å¦‚æœä½ ä¸æä¾›è¿™ä¸ªå‚æ•°ï¼Œå®ƒé»˜è®¤ä¸º 0ï¼Œå³ä» Buffer å¼€å¤´å¤„å¼€å§‹ã€‚</li><li>è¿™ä¸ªæ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå³ä» Buffer é‡Œè¯»å‡ºçš„é‚£ä¸ª 32 ä½æ•´æ•°çš„å€¼ã€‚</li></ul><p>ä¸¾ä¸ªä¾‹å­è¯´æ˜å¦‚ä½•ä½¿ç”¨ <code>buf.readInt32BE([offset])</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«ç‰¹å®šæ•°æ®çš„ Bufferã€‚</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¸‹é¢æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå…·æœ‰4ä¸ªå­—èŠ‚ï¼ˆ32ä½ï¼‰çš„Bufferã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x01</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨æˆ‘ä»¬æƒ³è¦è¯»å–è¿™å››ä¸ªå­—èŠ‚ä»£è¡¨çš„32ä½æ•´æ•°ã€‚</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬ä½¿ç”¨readInt32BE()æ–¹æ³•ä»ç¬¬ä¸€ä¸ªå­—èŠ‚(ç´¢å¼•ä¸º0)å¼€å§‹è¯»å–ã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> number</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readInt32BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºè¯»å–åˆ°çš„å€¼ï¼ŒæœŸæœ›æ˜¯ 1ï¼Œå› ä¸ºå››ä¸ªå­—èŠ‚è¡¨ç¤ºçš„å°±æ˜¯æ•°å­— 1ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">number</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåªåŒ…å«ä¸€ä¸ªæ•´æ•° 1 çš„ Bufferã€‚è¿™ä¸ªæ•´æ•°ä»¥å¤§ç«¯æ¨¡å¼å­˜å‚¨ï¼Œæœ€é«˜ä½å­—èŠ‚åœ¨å‰ã€‚é€šè¿‡ <code>buffer.readInt32BE()</code>ï¼Œæˆ‘ä»¬æ­£ç¡®åœ°ä» Buffer ä¸­è¯»å–äº†è¿™ä¸ªæ•´æ•°ï¼Œå¹¶ä¸”æ‰“å°å‡ºæ¥ã€‚</p><p>å¦‚æœè¦ä» Buffer ä¸­é—´çš„æŸä¸ªä½ç½®å¼€å§‹è¯»å–ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ <code>readInt32BE</code> æ–¹æ³•ä¼ é€’ä¸€ä¸ªåç§»é‡ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªè¾ƒå¤§çš„Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bigBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x12</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x34</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x56</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x78</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬æƒ³è¦ä»ç¬¬ä¸‰ä¸ªå­—èŠ‚å¼€å§‹ï¼Œè¯»å–æ¥ä¸‹æ¥çš„32ä½æ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰€ä»¥æˆ‘ä»¬ä¼ é€’2ä½œä¸ºoffsetï¼ˆå› ä¸ºç´¢å¼•ä»0å¼€å§‹ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> intFromMiddle</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bigBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readInt32BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºè¯»å–çš„å€¼ï¼ŒæœŸæœ›æ˜¯0x12345678å¯¹åº”çš„åè¿›åˆ¶æ•°ï¼š305419896</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">intFromMiddle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 305419896</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä» Buffer çš„ç¬¬ä¸‰ä¸ªå­—èŠ‚å¼€å§‹è¯»å–ï¼Œå› ä¸ºæˆ‘ä»¬è®¾ç½®äº†åç§»é‡ä¸º 2ï¼Œå®ƒæˆåŠŸåœ°è¯»å–äº†å››ä¸ªå­—èŠ‚å¹¶è½¬æ¢æˆäº†ä¸€ä¸ªæ•´æ•°ã€‚</p><h3 id="buf-readint32le-offset" tabindex="-1"><a class="header-anchor" href="#buf-readint32le-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreadint32leoffset" target="_blank" rel="noopener noreferrer">buf.readInt32LE([offset])</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘ä¼šåŠªåŠ›ä»¥é€šä¿—æ˜“æ‡‚çš„æ–¹å¼è§£é‡Š <code>buf.readInt32LE([offset])</code> è¿™ä¸ªæ–¹æ³•ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code>ç±»æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„å·¥å…·ï¼Œå¯ä»¥æƒ³è±¡æˆä¸€ä¸ªå¯ä»¥å­˜å‚¨å­—èŠ‚çš„æ•°ç»„ã€‚<code>Buffer</code>æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œä½ ä¸éœ€è¦å¼•å…¥ä»»ä½•æ¨¡å—å°±å¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒã€‚</p><p><code>buf.readInt32LE([offset])</code> æ˜¯ <code>Buffer</code> ç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥åœ°æ¥äº†è§£å®ƒï¼š</p><h3 id="_1-readint32le-æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#_1-readint32le-æ˜¯ä»€ä¹ˆ"><span>1. <code>readInt32LE</code> æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h3><p>è¿™ä¸ªæ–¹æ³•ç”¨äºä» buffer ä¸­è¯»å– 32 ä½(4 bytes)çš„æ•´æ•°ï¼Œå¹¶ä¸”å‡è®¾è¿™ä¸ªæ•´æ•°æ˜¯ä»¥å°ç«¯åºå­˜å‚¨çš„ã€‚</p><ul><li><strong>32 ä½</strong>: è¡¨ç¤ºæ•´æ•°å ç”¨ 32 ä½å†…å­˜ç©ºé—´ï¼Œä¹Ÿå°±æ˜¯ 4 ä¸ªå­—èŠ‚ï¼ˆæ¯ä¸ªå­—èŠ‚ 8 ä½ï¼‰ã€‚</li><li><strong>å°ç«¯åº(LE - Little-Endian)</strong>: å°ç«¯åºæ˜¯ä¸€ç§å­˜å‚¨æˆ–ä¼ è¾“æ•°æ®çš„æ–¹å¼ï¼Œå…¶ä¸­æœ€ä½æœ‰æ•ˆå­—èŠ‚(LSB)åœ¨å‰é¢ï¼ˆè¾ƒå°çš„åœ°å€ï¼‰ï¼Œè€Œæœ€é«˜æœ‰æ•ˆå­—èŠ‚(MSB)åœ¨åé¢ï¼ˆè¾ƒå¤§çš„åœ°å€ï¼‰ã€‚ä¸ä¹‹ç›¸å¯¹çš„æ˜¯å¤§ç«¯åº(BE - Big-Endian)ï¼Œæ­£å¥½ç›¸åã€‚</li></ul><h3 id="_2-offset-å‚æ•°æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#_2-offset-å‚æ•°æ˜¯ä»€ä¹ˆ"><span>2. <code>[offset]</code> å‚æ•°æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h3><ul><li><strong>[offset]</strong>: æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºä» buffer çš„å“ªä¸ªä½ç½®å¼€å§‹è¯»å–æ•°æ®ã€‚å¦‚æœä¸æŒ‡å®š <code>offset</code>ï¼Œé»˜è®¤å€¼æ˜¯ 0ï¼Œä¹Ÿå°±æ˜¯è¯´ä» buffer çš„èµ·å§‹å¤„å¼€å§‹è¯»ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æ”¶åˆ°äº†ä¸€ä¸ªå«æœ‰äºŒè¿›åˆ¶æ•°æ®çš„ TCP æµæˆ–è€…æ–‡ä»¶ï¼Œå¹¶ä¸”æˆ‘ä»¬çŸ¥é“åœ¨è¿™ä¸ªæµæˆ–æ–‡ä»¶çš„æŸä¸ªä½ç½®ï¼Œæœ‰ä¸€ä¸ª 32 ä½çš„æ•´æ•°ä»¥å°ç«¯åºå­˜å‚¨ç€ã€‚æˆ‘ä»¬æƒ³è¦è¯»å–è¿™ä¸ªæ•´æ•°ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€äº›å®é™…çš„ä»£ç ä¾‹å­ï¼š</p><p><strong>ä¾‹å­ 1ï¼šè¯»å– Buffer å¼€å¤´çš„ 32 ä½å°ç«¯æ•´æ•°</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«éšæœºå­—èŠ‚çš„ Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x01</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯»å–32ä½å°ç«¯æ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> num</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readInt32LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">num</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º 1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>Buffer</code> åŒ…å«äº†å››ä¸ªå­—èŠ‚ï¼Œåˆ†åˆ«æ˜¯ <code>0x01, 0x00, 0x00, 0x00</code>ã€‚å› ä¸ºæˆ‘ä»¬æ˜¯æŒ‰ç…§å°ç«¯åºè¯»å–çš„ï¼Œæ‰€ä»¥æœ€ä½æœ‰æ•ˆå­—èŠ‚ï¼ˆLSBï¼‰æ˜¯ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œå€¼ä¸º 1ï¼Œå…¶ä»–çš„éƒ½æ˜¯ 0ï¼Œæ‰€ä»¥è¯»å‡ºæ¥çš„æ•´æ•°å°±æ˜¯ 1ã€‚</p><p><strong>ä¾‹å­ 2ï¼šæŒ‡å®š offset è¯»å– 32 ä½å°ç«¯æ•´æ•°</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«éšæœºå­—èŠ‚çš„ Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xff</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xff</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xff</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xff</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x78</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x56</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x34</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x12</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»ç¬¬5ä¸ªå­—èŠ‚å¼€å§‹ï¼ˆindexä¸º4ï¼Œå› ä¸ºindexä»0å¼€å§‹è®¡æ•°ï¼‰è¯»å–32ä½å°ç«¯æ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> num</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readInt32LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">num</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º 305419896</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æƒ³è¦è¯»å–çš„æ•´æ•°ä» buffer çš„ç¬¬ 5 ä¸ªå­—èŠ‚å¼€å§‹ï¼ˆç´¢å¼•ä¸º 4 çš„ä½ç½®ï¼Œå› ä¸ºç´¢å¼•æ˜¯ä» 0 å¼€å§‹çš„ï¼‰ã€‚æ•´æ•°çš„å››ä¸ªå­—èŠ‚ä¾æ¬¡æ˜¯ <code>0x78, 0x56, 0x34, 0x12</code>ã€‚æŒ‰ç…§å°ç«¯åºï¼Œè¿™ä¸ªæ•´æ•°è¡¨ç¤ºä¸º <code>0x12345678</code>ï¼ˆåå…­è¿›åˆ¶ï¼‰ï¼Œè½¬æ¢ä¸ºåè¿›åˆ¶å°±æ˜¯ <code>305419896</code>ã€‚</p><p>é€šè¿‡è¿™äº›æ–¹æ³•å’Œä¾‹å­ï¼Œä½ åº”è¯¥èƒ½å¤Ÿç†è§£ <code>buf.readInt32LE([offset])</code> å¦‚ä½•åœ¨å®é™…ç¼–ç¨‹ä¸­è¢«åº”ç”¨äº†ã€‚è®°å¾—ï¼Œå¤„ç† Buffer æ•°æ®æ—¶å¿…é¡»ç¡®ä¿ä½ çš„ Buffer è¶³å¤Ÿå¤§ï¼Œå¯ä»¥å®¹çº³ä½ å°è¯•è¯»å–çš„æ•°æ®ç±»å‹ï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯ã€‚</p><h3 id="buf-readintbe-offset-bytelength" tabindex="-1"><a class="header-anchor" href="#buf-readintbe-offset-bytelength"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreadintbeoffset-bytelength" target="_blank" rel="noopener noreferrer">buf.readIntBE(offset, byteLength)</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹ <code>buf.readIntBE(offset, byteLength)</code> è¿™ä¸ªæ–¹æ³•ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code>æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ç±»ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒå°±åƒä¸€ä¸ªå¯ä»¥å­˜å‚¨å­—èŠ‚çš„æ•°ç»„ã€‚è¿™äº›å­—èŠ‚é€šå¸¸ç”¨æ¥è¡¨ç¤ºå„ç§ç±»å‹çš„æ•°æ®ï¼Œæ¯”å¦‚æ–‡ä»¶å†…å®¹ã€æ•°æ®åŒ…ç­‰ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬å‡è®¾æœ‰ä¸€ä¸²äºŒè¿›åˆ¶æ•°æ®ï¼Œä½ æƒ³ä»ä¸­è¯»å–ä¸€ä¸ªæ•´æ•°ã€‚ä½†é—®é¢˜æ˜¯ï¼Œè®¡ç®—æœºå­˜å‚¨æ•´æ•°çš„æ–¹å¼æœ‰ä¸¤ç§ï¼šå¤§ç«¯åºï¼ˆBig Endianï¼‰å’Œå°ç«¯åºï¼ˆLittle Endianï¼‰ã€‚åŒºåˆ«åœ¨äºæ•°å­—çš„é«˜ä½ï¼ˆå³æœ€é‡è¦çš„ä½ï¼‰æ˜¯æ”¾åœ¨å­—èŠ‚åºåˆ—çš„å¼€å¤´ï¼ˆå¤§ç«¯åºï¼‰ï¼Œè¿˜æ˜¯æ”¾åœ¨æœ«å°¾ï¼ˆå°ç«¯åºï¼‰ã€‚</p><p>åœ¨ Node.js çš„ Buffer ä¸­ï¼Œ<code>readIntBE()</code>æ–¹æ³•è¢«ç”¨æ¥ä»¥å¤§ç«¯åºçš„æ–¹å¼ä»ç¼“å†²åŒºä¸­è¯»å–ä¸€ä¸ªæ•´æ•°ã€‚</p><ul><li><code>offset</code> å‚æ•°æŒ‡å®šäº†ä»å“ªä¸ªä½ç½®å¼€å§‹è¯»å–ã€‚</li><li><code>byteLength</code> å‚æ•°å®šä¹‰äº†è¦è¯»å–å¤šå°‘å­—èŠ‚ã€‚</li></ul><p>æ•´æ•°å¯ä»¥å ç”¨ä¸åŒçš„å­—èŠ‚æ•°ï¼Œæ¯”å¦‚ 2 å­—èŠ‚ï¼ˆ16 ä½ï¼‰ã€4 å­—èŠ‚ï¼ˆ32 ä½ï¼‰ç­‰ã€‚</p><p>ä¸¾å‡ ä¸ªå®ä¾‹æ¥è¯´æ˜ï¼š</p><h3 id="å®ä¾‹-1-è¯»å–ä¸€ä¸ª-16-ä½çš„æ•´æ•°" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-1-è¯»å–ä¸€ä¸ª-16-ä½çš„æ•´æ•°"><span>å®ä¾‹ 1ï¼šè¯»å–ä¸€ä¸ª 16 ä½çš„æ•´æ•°</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ ç°åœ¨æ‰‹ä¸Šæœ‰ä¸€ä¸ª Buffer å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº†è¿™æ ·ä¸€ä¸²å­—èŠ‚ï¼š<code>01 02</code>ã€‚è¿™é‡Œæˆ‘ä»¬å‡è®¾è¿™ä»£è¡¨ä¸€ä¸ª 16 ä½çš„å¤§ç«¯æ•´æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x01</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x02</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> number</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readIntBE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">number</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º 258</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ul><li>æ•°ç»„ <code>[0x01, 0x02]</code> æ˜¯åå…­è¿›åˆ¶çš„è¡¨ç¤ºæ–¹å¼ï¼Œå®ƒç›¸å½“äº <code>[1, 2]</code>ã€‚</li><li>æˆ‘ä»¬ä½¿ç”¨ <code>readIntBE(0, 2)</code> è¯»å–äº†ä»ä½ç½® 0 å¼€å§‹çš„ 2 ä¸ªå­—èŠ‚ï¼Œè½¬æ¢æˆäº†ä¸€ä¸ªæ•´æ•°ã€‚</li><li>å› ä¸ºæ˜¯å¤§ç«¯åºï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯æœ€é«˜ä½ï¼Œç»“æœå°±æ˜¯ <code>1 * 256 + 2 * 1 = 258</code>ã€‚</li></ul><h3 id="å®ä¾‹-2-è¯»å–ä¸€ä¸ª-32-ä½çš„æ•´æ•°" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-2-è¯»å–ä¸€ä¸ª-32-ä½çš„æ•´æ•°"><span>å®ä¾‹ 2ï¼šè¯»å–ä¸€ä¸ª 32 ä½çš„æ•´æ•°</span></a></h3><p>å¦‚æœä½ æœ‰å¦‚ä¸‹çš„å­—èŠ‚åºåˆ—ï¼š<code>00 00 01 02</code>ï¼Œå¹¶ä¸”è¿™å››ä¸ªå­—èŠ‚ä»£è¡¨ä¸€ä¸ªå¤§ç«¯åºçš„ 32 ä½æ•´æ•°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x01</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x02</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> number</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readIntBE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">number</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º 258</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>readIntBE(0, 4)</code> ä»ä½ç½® 0 å¼€å§‹è¯»å– 4 ä¸ªå­—èŠ‚ï¼Œå°±å¾—åˆ°äº†æ•´æ•° <code>258</code>ï¼Œè®¡ç®—è¿‡ç¨‹å’Œä¸Šé¢ç±»ä¼¼ã€‚</p><h3 id="å®ä¾‹-3-ä»-buffer-ä¸­é—´è¯»å–æ•´æ•°" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-3-ä»-buffer-ä¸­é—´è¯»å–æ•´æ•°"><span>å®ä¾‹ 3ï¼šä» Buffer ä¸­é—´è¯»å–æ•´æ•°</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªæ›´é•¿çš„ Bufferï¼Œä½ éœ€è¦ä»ä¸­é—´æŸä¸ªä½ç½®è¯»å–ä¸€ä¸ªæ•´æ•°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xff</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xfe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xfd</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xfc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xfb</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xfa</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> number</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readIntBE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">number</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º -50462970</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä»ç´¢å¼•ä¸º 2 çš„ä½ç½®å¼€å§‹ï¼Œè¯»å–äº† 4 ä¸ªå­—èŠ‚ã€‚å› ä¸º <code>0xFD</code> çš„æœ€é«˜ä½æ˜¯ 1ï¼ˆåå…­è¿›åˆ¶çš„ F ä»£è¡¨ 1111ï¼‰ï¼Œè¿™æ„å‘³ç€è¯¥æ•´æ•°æ˜¯è´Ÿæ•°ã€‚</p><p>æ ¹æ®å¤§ç«¯åºçš„è§„åˆ™ï¼Œè¯»å–çš„å€¼å°†ä¼šæ˜¯ <code>(0xFD </code>&lt;<code>&lt;` 24) | (0xFC `&lt;</code>&lt;<code>16) | (0xFB</code>&lt;``&lt;<code> 8) | 0xFA</code>ï¼Œè®¡ç®—å‡ºæ¥çš„ç»“æœæ˜¯ <code>-50462970</code>ã€‚</p><p>æ³¨æ„è¿™é‡Œçš„è´Ÿæ•°æ˜¯ç”±è¡¥ç è¡¨ç¤ºçš„ï¼Œè®¡ç®—æ—¶éœ€è¦æ³¨æ„ç¬¦å·ä½å’Œè¡¥ç çš„è½¬æ¢è§„åˆ™ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯ <code>buf.readIntBE(offset, byteLength)</code> æ–¹æ³•çš„ä½¿ç”¨ç¤ºä¾‹ã€‚è¿™ä¸ªæ–¹æ³•åœ¨å¤„ç†ç½‘ç»œåè®®ã€äºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼æˆ–å…¶ä»–éœ€è¦ç›´æ¥æ“ä½œå­—èŠ‚æ•°æ®çš„åœºåˆéå¸¸æœ‰ç”¨ã€‚å¸Œæœ›è¿™äº›ä¾‹å­èƒ½å¸®åŠ©ä½ ç†è§£å®ƒçš„å·¥ä½œåŸç†ï¼</p><h3 id="buf-readintle-offset-bytelength" tabindex="-1"><a class="header-anchor" href="#buf-readintle-offset-bytelength"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreadintleoffset-bytelength" target="_blank" rel="noopener noreferrer">buf.readIntLE(offset, byteLength)</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘ä¼šå°½é‡è¯¦ç»†åœ°è§£é‡Šè¿™ä¸ªæ–¹æ³•ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code>ç±»æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„å…¨å±€å¯¹è±¡ã€‚å½“ä½ éœ€è¦å¤„ç†åƒ TCP æµæˆ–æ–‡ä»¶ç³»ç»Ÿæ“ä½œé‚£æ ·çš„äºŒè¿›åˆ¶æ•°æ®åŒ…æ—¶ï¼Œå°±ä¼šç”¨åˆ°å®ƒã€‚<code>Buffer</code>å¯¹è±¡å¯ä»¥å°†åŸå§‹æ•°æ®å­˜å‚¨ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œè¿™äº›æ•°æ®é€šå¸¸è¡¨ç¤ºå¤šä¸ªå­—èŠ‚ã€‚</p><p><code>buf.readIntLE(offset, byteLength)</code>æ˜¯<code>Buffer</code>ç±»ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒä»<code>Buffer</code>ä¸­è¯»å–ä¸€ä¸ªæ•´æ•°ï¼Œå¹¶ä¸”æ˜¯ä»¥å°ç«¯åºï¼ˆLittle-Endianï¼‰çš„æ–¹å¼æ¥è§£è¯»è¿™äº›å­—èŠ‚ã€‚å°ç«¯åºæ˜¯æŒ‡æœ€ä½æœ‰æ•ˆå­—èŠ‚æ’åœ¨å‰é¢ï¼Œè€Œæœ€é«˜æœ‰æ•ˆå­—èŠ‚æ’åœ¨åé¢ã€‚</p><p>å‚æ•°è§£é‡Š:</p><ul><li><code>offset</code>: æ˜¯æŒ‡å®šä»å“ªä¸ªä½ç½®å¼€å§‹è¯»å–çš„åç§»é‡ã€‚</li><li><code>byteLength</code>: è¯»å–å¤šå°‘ä¸ªå­—èŠ‚æ¥æ„æˆæ•´æ•°ã€‚è¿™ä¸ªå€¼å¯ä»¥æ˜¯ 1ã€2ã€3ã€4ã€5ã€6 ä»¥åŠ 6 ä¸ªä»¥ä¸Šï¼Œå…·ä½“å–å†³äºä½ æƒ³è¦è¯»å–çš„æ•´æ•°å¤§å°ã€‚</li></ul><p>ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­:</p><p>ä¾‹å­ 1ï¼šè¯»å–ä¸€ä¸ª 16 ä½çš„æ•´æ•°</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«ç‰¹å®šå­—èŠ‚çš„Bufferå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x12</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x34</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯»å–Bufferä¸­ä»ä½ç½®0å¼€å§‹çš„2ä¸ªå­—èŠ‚ï¼Œå¹¶æŠŠè¿™ä¸¤ä¸ªå­—èŠ‚æŒ‰å°ç«¯åºç†è§£ä¸ºä¸€ä¸ªæ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> number</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readIntLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">number</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 13330</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ•´æ•°<code>13330</code>æ˜¯é€šè¿‡å°†<code>0x3412</code>è½¬æ¢ä¸ºåè¿›åˆ¶å¾—åˆ°çš„ã€‚å› ä¸ºå°ç«¯åºï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆè¯»å–<code>0x12</code>ä½œä¸ºä½ä½å­—èŠ‚ï¼Œç„¶åæ˜¯<code>0x34</code>ä½œä¸ºé«˜ä½å­—èŠ‚ã€‚</p><p>ä¾‹å­ 2ï¼šè¯»å–ä¸€ä¸ª 32 ä½æ•´æ•°</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«ç‰¹å®šå­—èŠ‚çš„Bufferå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xff</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xff</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯»å–Bufferä¸­ä»ä½ç½®0å¼€å§‹çš„4ä¸ªå­—èŠ‚ï¼Œå¹¶æŠŠè¿™å››ä¸ªå­—èŠ‚æŒ‰å°ç«¯åºç†è§£ä¸ºä¸€ä¸ªæ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> number</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readIntLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">number</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 65535</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>0x0000FFFF</code>è¢«è§£é‡Šä¸º 65535ã€‚å†æ¬¡å¼ºè°ƒï¼Œç”±äºä½¿ç”¨çš„æ˜¯å°ç«¯åºï¼Œæ‰€ä»¥é¦–å…ˆè¯»å–äº†<code>0xFF</code>ä½œä¸ºæœ€ä½æœ‰æ•ˆå­—èŠ‚ã€‚</p><p>æ³¨æ„ï¼šå¦‚æœè¯•å›¾ä» Buffer ä¸­è¯»å–è¶…å‡ºå…¶èŒƒå›´çš„æ•°æ®ï¼Œæˆ–è€…<code>byteLength</code>è¶…å‡ºäº†å…è®¸çš„èŒƒå›´ï¼ŒNode.js å°†ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p><p>ç†è§£äº†å¦‚ä½•ä½¿ç”¨<code>readIntLE</code>ä¹‹åï¼Œä½ å¯ä»¥è¯»å–å„ç§å¤§å°çš„æ•´æ•°ï¼Œå¹¶ä¸”å¯ä»¥å¤„ç†æ¥è‡ªä¸åŒå¹³å°å’Œåè®®çš„æ•°æ®ï¼Œå› ä¸ºä¸åŒçš„ç³»ç»Ÿå¯èƒ½ä¼šä»¥ä¸åŒçš„å­—èŠ‚é¡ºåºæ¥å­˜å‚¨æ•´æ•°ã€‚</p><h3 id="buf-readuint8-offset" tabindex="-1"><a class="header-anchor" href="#buf-readuint8-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreaduint8offset" target="_blank" rel="noopener noreferrer">buf.readUInt8([offset])</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹ <code>buf.readUInt8([offset])</code> è¿™ä¸ªæ–¹æ³•ã€‚</p><p>é¦–å…ˆï¼Œè¦äº†è§£ Node.js ä¸­çš„ Buffer ç±»å‹ã€‚Buffer æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„å†…ç½®å¯¹è±¡ã€‚åœ¨ Node.js ä¸­ï¼Œå½“ä½ éœ€è¦å¤„ç†åƒ TCP æµæˆ–æ–‡ä»¶ç³»ç»Ÿæ“ä½œç­‰æ¶‰åŠåˆ°äºŒè¿›åˆ¶æ•°æ®çš„åœºåˆæ—¶ï¼Œç»å¸¸ä¼šä½¿ç”¨åˆ° Buffer å¯¹è±¡ã€‚</p><p>æ¥ç€ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ <code>readUInt8</code> æ–¹æ³•ï¼š</p><ul><li><code>readUInt8</code> æ˜¯ Buffer å¯¹è±¡æä¾›çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨æ¥ä» Buffer å¯¹è±¡ä¸­è¯»å–ä¸€ä¸ªæ— ç¬¦å·çš„ 8 ä½æ•´æ•°ï¼ˆå³ä¸€ä¸ªå­—èŠ‚ï¼‰ã€‚</li><li><code>[offset]</code> æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºä»ç¼“å†²åŒºçš„å“ªä¸ªä½ç½®å¼€å§‹è¯»å–è¿™ä¸ªæ— ç¬¦å·çš„ 8 ä½æ•´æ•°ã€‚å¦‚æœä½ ä¸æä¾›è¿™ä¸ªå‚æ•°ï¼Œå®ƒé»˜è®¤ä» 0 ä½ç½®ï¼ˆå³ç¼“å†²åŒºçš„å¼€å§‹ï¼‰è¯»å–ã€‚</li><li>å½“ä½ è°ƒç”¨ <code>buf.readUInt8([offset])</code> æ—¶ï¼Œå®ƒä¼šè¿”å›ç¼“å†²åŒºä¸­æŒ‡å®šä½ç½®çš„é‚£ä¸ªå­—èŠ‚çš„æ•°å€¼ï¼ˆèŒƒå›´æ˜¯ 0 åˆ° 255ï¼‰ã€‚</li></ul><p>ç°åœ¨ï¼Œæ¥ä¸¾ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªäºŒè¿›åˆ¶æ•°æ®æµï¼Œå…¶ä¸­åŒ…å«äº†ä¸€ç³»åˆ—çš„çŠ¶æ€ç ï¼Œæ¯ä¸ªçŠ¶æ€ç éƒ½æ˜¯ä¸€ä¸ªå­—èŠ‚é•¿ï¼Œå¹¶ä¸”æ¯ä¸ªçŠ¶æ€ç ä»£è¡¨ä¸€ä¸ªç‰¹å®šçš„å«ä¹‰ã€‚ä½ æƒ³è¦è¯»å–è¿™äº›çŠ¶æ€ç å¹¶å¯¹å…¶è¿›è¡Œå¤„ç†ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥ Buffer æ¨¡å—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«éšæœºäºŒè¿›åˆ¶æ•°æ®çš„ Buffer å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x01</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x02</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xff</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x0a</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ readUInt8 è¯»å–ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ˆç´¢å¼•ä¸º 0ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> statusCode1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readUInt8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">statusCode1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ readUInt8 è¯»å–ç¬¬äºŒä¸ªå­—èŠ‚ï¼ˆç´¢å¼•ä¸º 1ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> statusCode2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readUInt8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">statusCode2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ readUInt8 è¯»å–ç¬¬ä¸‰ä¸ªå­—èŠ‚ï¼ˆç´¢å¼•ä¸º 2ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> statusCode3</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readUInt8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">statusCode3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 255</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ readUInt8 è¯»å–ç¬¬å››ä¸ªå­—èŠ‚ï¼ˆç´¢å¼•ä¸º 3ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> statusCode4</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readUInt8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">statusCode4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 10</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ª Buffer å®ä¾‹ï¼Œå¹¶ç”¨ä¸€äº›éšæœºçš„å­—èŠ‚åˆå§‹åŒ–å®ƒã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ†åˆ«è¯»å–äº†è¿™ä¸ªç¼“å†²åŒºçš„å‰å››ä¸ªå­—èŠ‚ï¼Œå¹¶æ‰“å°å‡ºäº†æ¯ä¸ªå­—èŠ‚æ‰€ä»£è¡¨çš„æ•°å€¼ã€‚</p><p>è¿™å°±æ˜¯ <code>buf.readUInt8([offset])</code> æ–¹æ³•çš„åŸºæœ¬ç”¨æ³•å’Œä¸€ä¸ªç®€å•ç¤ºä¾‹ã€‚è¿™ä¸ªæ–¹æ³•é€šå¸¸ç”¨äºè§£æäºŒè¿›åˆ¶åè®®ã€å¤„ç†ç½‘ç»œåŒ…æˆ–è€…è¯»å–å…¶ä»–éœ€è¦æŒ‰å­—èŠ‚æ“ä½œçš„æ•°æ®ç»“æ„ã€‚</p><h3 id="buf-readuint16be-offset" tabindex="-1"><a class="header-anchor" href="#buf-readuint16be-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreaduint16beoffset" target="_blank" rel="noopener noreferrer">buf.readUInt16BE([offset])</a></span></a></h3><p><code>buf.readUInt16BE([offset])</code> æ˜¯ä¸€ä¸ªåœ¨ Node.js ä¸­ç”¨æ¥ä»ç¼“å†²åŒºï¼ˆBufferï¼‰è¯»å–æ•°æ®çš„æ–¹æ³•ã€‚åœ¨è¿™ä¸ªä¸Šä¸‹æ–‡ä¸­ï¼Œâ€œBEâ€ä»£è¡¨ Big-Endianï¼Œæ„æ€æ˜¯åœ¨è¯»å–å¤šå­—èŠ‚å€¼æ—¶ï¼Œæœ€é«˜æœ‰æ•ˆä½ï¼ˆmost significant byteï¼‰åœ¨å‰ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬äº†è§£ä¸€ä¸‹ç¼“å†²åŒºï¼ˆBufferï¼‰ã€‚åœ¨ Node.js ä¸­ï¼ŒBuffer ç±»è¢«ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµã€‚æƒ³è±¡ä½ æœ‰ä¸€ä¸²åŸå§‹çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œè¿™äº›æ•°æ®å¯èƒ½æ¥è‡ªæ–‡ä»¶ã€ç½‘ç»œé€šä¿¡æˆ–å…¶ä»–æºã€‚Buffer æä¾›äº†ä¸€ä¸ªæ›´åº•å±‚çš„æ–¹å¼æ¥è¯»å–å’Œæ“ä½œè¿™äº›äºŒè¿›åˆ¶æ•°æ®ã€‚</p><p>ç°åœ¨ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª 16 ä½çš„æ•°å€¼éœ€è¦ä» Buffer é‡Œè¯»å–å‡ºæ¥ï¼Œè¿™å°±æ˜¯ <code>readUInt16BE</code> æ–¹æ³•æ´¾ä¸Šç”¨åœºçš„åœ°æ–¹ã€‚è¯¥æ–¹æ³•ä»æŒ‡å®šçš„ <code>offset</code> å¼€å§‹ï¼Œè¯»å– 2 ä¸ªå­—èŠ‚ï¼ˆå› ä¸ºæ˜¯ UInt16ï¼Œå³æ— ç¬¦å·çš„ 16 ä½æ•´æ•°ï¼‰ï¼Œå¹¶æŒ‰ç…§ Big-Endian çš„é¡ºåºå°†è¿™ä¸¤ä¸ªå­—èŠ‚ç»„åˆæˆä¸€ä¸ª JavaScript æ•°å­—ã€‚</p><p>å¦‚æœæ²¡æœ‰æä¾› <code>offset</code>ï¼Œé‚£ä¹ˆé»˜è®¤ä»ç¼“å†²åŒºçš„å¼€å§‹å¤„è¯»å–ã€‚</p><p>ä¸¾å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><h3 id="å®ä¾‹-1-è¯»å–ç½‘ç»œæ•°æ®" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-1-è¯»å–ç½‘ç»œæ•°æ®"><span>å®ä¾‹ 1ï¼šè¯»å–ç½‘ç»œæ•°æ®</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç½‘ç»œåº”ç”¨ç¨‹åºï¼Œå®¢æˆ·ç«¯å‘é€äº†ä¸€ä¸ªåŒ…å«å¤šç§æ•°æ®ç±»å‹çš„æ¶ˆæ¯ç»™æœåŠ¡å™¨ã€‚è¿™ä¸ªæ¶ˆæ¯ä»¥ä¸€ä¸ª 16 ä½çš„æ— ç¬¦å·æ•´æ•°å¼€å¤´ï¼Œè¡¨ç¤ºåç»­æ•°æ®çš„é•¿åº¦ã€‚å½“è¿™ä¸ªæ¶ˆæ¯åˆ°è¾¾æœåŠ¡å™¨æ—¶ï¼Œå®ƒå°†ä»¥ Buffer çš„å½¢å¼å­˜åœ¨ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨ <code>readUInt16BE</code> æ¥è¯»å–é‚£ä¸ªé•¿åº¦ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ &#39;data&#39; æ˜¯ä¸€ä¸ªå·²ç»æ¥æ”¶åˆ°çš„ Buffer å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> length</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readUInt16BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ¶ˆæ¯é•¿åº¦:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ä¾‹-2-è§£æäºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-2-è§£æäºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼"><span>å®ä¾‹ 2ï¼šè§£æäºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼</span></a></h3><p>å¾ˆå¤šæ–‡ä»¶æ ¼å¼ï¼ˆæ¯”å¦‚å›¾åƒæˆ–éŸ³é¢‘æ–‡ä»¶ï¼‰éƒ½æœ‰äºŒè¿›åˆ¶æ ¼å¼çš„å¤´éƒ¨ä¿¡æ¯ã€‚æ¯”å¦‚ä¸€ä¸ªç®€å•çš„å›¾ç‰‡æ ¼å¼å¯èƒ½åœ¨æ–‡ä»¶çš„å¼€å§‹æœ‰ä¸€ä¸ª 16 ä½çš„ç‰ˆæœ¬å·å­—æ®µã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨ <code>readUInt16BE</code> ä»æ–‡ä»¶ä¸­è¯»å–è¿™ä¸ªç‰ˆæœ¬å·ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŒæ­¥åœ°è¯»å–æ–‡ä»¶å†…å®¹åˆ° Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;image.myformat&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ç‰ˆæœ¬å·åœ¨æ–‡ä»¶çš„ç¬¬ä¸€ä¸ª16ä½ï¼ˆå‰ä¸¤ä¸ªå­—èŠ‚ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> versionNumber</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readUInt16BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å›¾ç‰‡æ ¼å¼ç‰ˆæœ¬:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">versionNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ä¾‹-3-æ“ä½œç¡¬ä»¶è®¾å¤‡è¿”å›çš„æ•°æ®" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-3-æ“ä½œç¡¬ä»¶è®¾å¤‡è¿”å›çš„æ•°æ®"><span>å®ä¾‹ 3ï¼šæ“ä½œç¡¬ä»¶è®¾å¤‡è¿”å›çš„æ•°æ®</span></a></h3><p>å½“ä¸ç¡¬ä»¶è®¾å¤‡é€šä¿¡æ—¶ï¼Œè®¾å¤‡å¯èƒ½ä¼šä»¥äºŒè¿›åˆ¶æ•°æ®æµçš„å½¢å¼è¿”å›æ•°æ®ã€‚æ¯”å¦‚ä¸€ä¸ªæ¸©åº¦ä¼ æ„Ÿå™¨æ¯éš”ä¸€æ®µæ—¶é—´å‘å›ä¸€ä¸ªåŒ…å«å½“å‰æ¸©åº¦çš„ 16 ä½æ— ç¬¦å·æ•´æ•°ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•è§£æè¯¥æ¸©åº¦å€¼ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ &#39;data&#39; æ˜¯ä»ç¡¬ä»¶è®¾å¤‡æ¥æ”¶åˆ°çš„ Buffer å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> temperature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readUInt16BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å½“å‰æ¸©åº¦:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">temperature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> /</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æ¸©åº¦å€¼éœ€è¦é™¤ä»¥100æ¥å¾—åˆ°çœŸå®æ¸©åº¦</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ€»ç»“ï¼š<code>buf.readUInt16BE([offset])</code> æ˜¯ä¸€ä¸ªç”¨æ¥ä» Buffer ä¸­æŒ‰ Big-Endian æ ¼å¼è¯»å– 16 ä½æ— ç¬¦å·æ•´æ•°çš„æ–¹æ³•ã€‚åœ¨å¤„ç†ç½‘ç»œé€šä¿¡ã€æ–‡ä»¶è§£ææˆ–ä¸ç¡¬ä»¶è®¾å¤‡äº¤äº’ç­‰æƒ…å†µä¸‹å¯¹äºŒè¿›åˆ¶æ•°æ®è¿›è¡Œè¯»å–æ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="buf-readuint16le-offset" tabindex="-1"><a class="header-anchor" href="#buf-readuint16le-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreaduint16leoffset" target="_blank" rel="noopener noreferrer">buf.readUInt16LE([offset])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬è¯¦ç»†è§£é‡Šä¸€ä¸‹ Node.js ä¸­ <code>buf.readUInt16LE([offset])</code> è¿™ä¸ªæ–¹æ³•ã€‚</p><p>åœ¨ Node.js ä¸­ï¼ŒBuffer å¯¹è±¡æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„å…¨å±€å¯¹è±¡ã€‚ç®€å•è¯´ï¼Œå°±åƒæ•°ç»„ä¸€æ ·ï¼Œä½†å®ƒæ˜¯ä¸“é—¨ç”¨æ¥å­˜æ”¾äºŒè¿›åˆ¶æ•°æ®çš„ã€‚å½“ä½ åœ¨å¤„ç†æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡æˆ–è€…å…¶ä»– I/Oï¼ˆè¾“å…¥/è¾“å‡ºï¼‰æ“ä½œæ—¶ï¼Œç»å¸¸ä¼šç”¨åˆ° Buffer æ¥å¤„ç†æ•°æ®ã€‚</p><p>ç°åœ¨å…·ä½“æ¥çœ‹ <code>buf.readUInt16LE([offset])</code> è¿™ä¸ªæ–¹æ³•ï¼š</p><ul><li><code>readUInt16LE</code> æ˜¯ Buffer ç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºä» bufferï¼ˆç¼“å†²åŒºï¼‰ä¸­è¯»å– 2 ä¸ªå­—èŠ‚çš„æ— ç¬¦å·æ•´æ•°ã€‚</li><li><code>Uint16</code> è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæ— ç¬¦å·çš„ 16 ä½æ•´æ•°ï¼Œæ„å‘³ç€å¯ä»¥è¡¨ç¤ºçš„æ•°å€¼èŒƒå›´æ˜¯ 0 è‡³ 65535ã€‚</li><li><code>LE</code> ä»£è¡¨ Little Endianï¼ˆå°ç«¯åºï¼‰ï¼Œè¿™æ˜¯è®¡ç®—æœºç§‘å­¦ä¸­çš„ä¸€ä¸ªæœ¯è¯­ï¼Œè¡¨ç¤ºè¿™ä¸¤ä¸ªå­—èŠ‚çš„æœ€ä½æœ‰æ•ˆå­—èŠ‚åœ¨å‰é¢ã€‚å¤§ç«¯åºï¼ˆBig Endianï¼‰åˆ™ç›¸åï¼Œæœ€é«˜æœ‰æ•ˆå­—èŠ‚åœ¨å‰é¢ã€‚ä¸åŒçš„ç³»ç»Ÿå¯èƒ½ä¼šä½¿ç”¨ä¸åŒçš„å­—èŠ‚åºï¼Œæ‰€ä»¥åœ¨è¯»å†™æ•°æ®æ—¶éœ€è¦çŸ¥é“æ­£ç¡®çš„å­—èŠ‚åºã€‚</li><li><code>[offset]</code> æ˜¯å¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºä» buffer çš„å“ªä¸ªä½ç½®å¼€å§‹è¯»å–ã€‚å¦‚æœçœç•¥ï¼Œé‚£ä¹ˆé»˜è®¤ä» buffer çš„èµ·å§‹ä½ç½®è¯»å–ã€‚</li></ul><p>å®é™…è¿ç”¨ä¾‹å­ï¼š</p><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç¨‹åºæ¥ä¸æŸç§ç¡¬ä»¶è®¾å¤‡é€šä¿¡ï¼Œè¯¥è®¾å¤‡é€šè¿‡ç½‘ç»œå‘é€æ•°æ®åŒ…ï¼Œå¹¶ä¸”æ¯ä¸ªæ•°æ®åŒ…çš„å‰ä¸¤ä¸ªå­—èŠ‚ä»£è¡¨äº†åç»­æ•°æ®çš„é•¿åº¦ã€‚è¿™ä¸ªé•¿åº¦ä¿¡æ¯æ˜¯ä»¥å°ç«¯åºæ ¼å¼ç¼–ç çš„ã€‚é‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨ <code>readUInt16LE</code> æ–¹æ³•æ¥è¯»å–è¿™ä¸ªé•¿åº¦å€¼ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™é‡Œçš„ data æ˜¯ä¸€ä¸ªåŒ…å«æ•°æ®åŒ…å†…å®¹çš„ Buffer å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x30</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x75</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æ•°æ®åŒ…å¼€å¤´æ˜¯é•¿åº¦ä¿¡æ¯</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ buf.readUInt16LE(offset) æ–¹æ³•è¯»å–å‰ä¸¤ä¸ªå­—èŠ‚çš„æ•°æ®é•¿åº¦</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> length</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readUInt16LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š30000</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>0x30</code> å’Œ <code>0x75</code> æ˜¯ä¸¤ä¸ªåå…­è¿›åˆ¶æ•°å­—ï¼Œå¯¹åº”çš„åè¿›åˆ¶æ˜¯ <code>48</code> å’Œ <code>117</code>ã€‚å› ä¸ºæ˜¯å°ç«¯åºï¼Œæ‰€ä»¥ <code>0x7530</code> å®é™…ä¸Šå°±æ˜¯ <code>117 * 256 + 48</code>ï¼Œç»“æœæ˜¯ 30000ï¼Œè¡¨ç¤ºåç»­æ•°æ®çš„é•¿åº¦ã€‚</p><p>è¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå®é™…åº”ç”¨ä¸­ <code>readUInt16LE</code> å¯èƒ½ä¼šæ›´åŠ å¤æ‚ï¼Œä¾‹å¦‚åœ¨å¤„ç†å›¾ç‰‡ã€éŸ³è§†é¢‘æ•°æ®æµæˆ–å…¶ä»–åè®®çš„äºŒè¿›åˆ¶æ•°æ®æ—¶ã€‚å¸Œæœ›è¿™ä¸ªè§£é‡Šå’Œä¾‹å­å¸®åŠ©ä½ ç†è§£äº† <code>buf.readUInt16LE([offset])</code> çš„åŸºæœ¬æ¦‚å¿µå’Œç”¨æ³•ï¼</p><h3 id="buf-readuint32be-offset" tabindex="-1"><a class="header-anchor" href="#buf-readuint32be-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreaduint32beoffset" target="_blank" rel="noopener noreferrer">buf.readUInt32BE([offset])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥åˆ†è§£å¹¶ç†è§£ Node.js ä¸­ <code>buf.readUInt32BE([offset])</code> æ–¹æ³•çš„ä½œç”¨ã€‚</p><p>é¦–å…ˆï¼ŒNode.js æ˜¯ä¸€ä¸ªåŸºäº JavaScript çš„åç«¯è¿è¡Œç¯å¢ƒï¼Œå¯ä»¥è®©å¼€å‘è€…ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡ç«¯è½¯ä»¶ã€‚Node.js ä¸­çš„ <code>Buffer</code> ç±»æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨äºç›´æ¥æ“ä½œå†…å­˜ä¸­çš„äºŒè¿›åˆ¶æ•°æ®æµã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code> å¯¹è±¡é€šå¸¸ç”¨æ¥å¤„ç†åƒæ–‡ä»¶å’Œç½‘ç»œè¯·æ±‚ç­‰ I/O æ“ä½œæ—¶çš„æ•°æ®ã€‚è¿™äº›æ•°æ®é€šå¸¸ä¸æ˜¯å­—ç¬¦ä¸²æ ¼å¼çš„ï¼Œå¯èƒ½æ˜¯å›¾ç‰‡ã€è§†é¢‘ã€æˆ–è€…å…¶ä»–äºŒè¿›åˆ¶æ–‡ä»¶ã€‚è€Œ <code>buf.readUInt32BE()</code> æ–¹æ³•æ˜¯ç”¨æ¥ä»ç¼“å†²åŒºï¼ˆä¹Ÿå°±æ˜¯ <code>Buffer</code> å¯¹è±¡ï¼‰ä¸­è¯»å– 32 ä½æ— ç¬¦å·æ•´æ•°çš„æ–¹æ³•ã€‚</p><p>ä¸‹é¢è¯¦ç»†è§£é‡Šä¸€ä¸‹ <code>buf.readUInt32BE([offset])</code>ï¼š</p><ul><li><p><code>readUInt32BE</code>ï¼šè¿™æ˜¯ä¸€ä¸ªæ–¹æ³•åï¼Œâ€œreadâ€ è¡¨ç¤ºè¯»å–ï¼Œâ€œUInt32â€ è¡¨ç¤ºæ— ç¬¦å· 32 ä½æ•´æ•°ï¼Œâ€œBEâ€ è¡¨ç¤º Big-Endianï¼Œå³å¤§ç«¯åºã€‚æ‰€è°“çš„å¤§ç«¯åºæŒ‡çš„æ˜¯é«˜ä½å­—èŠ‚å­˜æ”¾åœ¨ä½åœ°å€ä¸Šã€‚</p></li><li><p><code>[offset]</code>ï¼šæ–¹æ‹¬å·è¡¨ç¤ºè¿™ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ã€‚<code>offset</code> æ˜¯ä¸€ä¸ªæ•°å­—å€¼ï¼ŒæŒ‡å®šä»å“ªä¸ªä½ç½®å¼€å§‹è¯»å–æ•°æ®ã€‚å¦‚æœä½ ä¸æä¾›è¿™ä¸ªå€¼ï¼Œå®ƒé»˜è®¤ä»ç¼“å†²åŒºçš„å¼€å§‹å¤„å³åç§»é‡ 0 çš„ä½ç½®å¼€å§‹è¯»å–ã€‚</p></li></ul><p>ç°åœ¨ï¼Œä¸¾å‡ ä¸ªå®é™…åº”ç”¨çš„ä¾‹å­æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨ <code>buf.readUInt32BE([offset])</code>ï¼š</p><h3 id="å®ä¾‹-1-è¯»å–ç½‘ç»œæ•°æ®-1" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-1-è¯»å–ç½‘ç»œæ•°æ®-1"><span>å®ä¾‹ 1ï¼šè¯»å–ç½‘ç»œæ•°æ®</span></a></h3><p>å‡è®¾ä½ æ¥æ”¶åˆ°äº†ä¸€ä¸ªåŒ…å«äº†å¤šä¸ªå­—æ®µçš„ç½‘ç»œæ•°æ®åŒ…ï¼Œå…¶ä¸­ä¸€ä¸ªå­—æ®µæ˜¯ 32 ä½æ— ç¬¦å·æ•´æ•°ï¼Œå¹¶ä¸”è¿™ä¸ªæ•´æ•°æ˜¯ä½¿ç”¨å¤§ç«¯åºç¼–ç çš„ã€‚ä½ æƒ³è¦è¯»å–è¿™ä¸ªæ•´æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æ”¶åˆ°ä¸€ä¸ªbufferå¯¹è±¡ï¼Œå®ƒåŒ…å«äº†ç½‘ç»œæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xa5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x02</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬æƒ³è¦è¯»å–è¿™ä¸ªbufferä¸­çš„ç¬¬ä¸€ä¸ª32ä½æ— ç¬¦å·æ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readUInt32BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š165ï¼Œå³åå…­è¿›åˆ¶çš„0xA5è½¬æ¢ä¸ºåè¿›åˆ¶</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ä¾‹-2-å¤„ç†æ–‡ä»¶å¤´ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-2-å¤„ç†æ–‡ä»¶å¤´ä¿¡æ¯"><span>å®ä¾‹ 2ï¼šå¤„ç†æ–‡ä»¶å¤´ä¿¡æ¯</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œå…¶å¤´éƒ¨ä¿¡æ¯åŒ…å«äº†ä¸€äº›ä»¥å¤§ç«¯åºæ ¼å¼ä¿å­˜çš„ 32 ä½æ— ç¬¦å·æ•´æ•°ï¼Œä¾‹å¦‚å›¾åƒæ–‡ä»¶(png, jpeg ç­‰)ä¼šåœ¨æ–‡ä»¶å¤´éƒ¨ä¿å­˜å®½åº¦å’Œé«˜åº¦ç­‰ä¿¡æ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾bufferä»£è¡¨äº†æ–‡ä»¶çš„å¤´éƒ¨éƒ¨åˆ†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŒæ­¥åœ°è¯»å–æ–‡ä»¶çš„å‰8ä¸ªå­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;some_image.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">slice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å›¾åƒå®½åº¦é€šå¸¸å­˜å‚¨åœ¨ offset ä¸º 0 çš„åœ°æ–¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> width</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readUInt32BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å›¾åƒé«˜åº¦é€šå¸¸å­˜å‚¨åœ¨ offset ä¸º 4 çš„åœ°æ–¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> height</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readUInt32BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Width: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">width</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, Height: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">height</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™ä¼šè¾“å‡ºç±»ä¼¼ &quot;Width: 400, Height: 300&quot; è¿™æ ·çš„ä¿¡æ¯ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å½“ç„¶å–å†³äºä½ æ‰€è¯»å–çš„å®é™…å›¾ç‰‡æ–‡ä»¶çš„å¤§å°ã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è®°ä½ï¼Œå½“ä½¿ç”¨ <code>readUInt32BE</code> æ—¶ï¼Œç¡®ä¿ä½ çš„ <code>Buffer</code> è‡³å°‘æœ‰è¶³å¤Ÿçš„å­—èŠ‚æ¥è¯»å–ä¸€ä¸ª 32 ä½æ•´æ•°ï¼ˆå³è‡³å°‘æœ‰ 4 ä¸ªå­—èŠ‚ï¼‰ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªèŒƒå›´é”™è¯¯ã€‚</p><p>å¸Œæœ›è¿™äº›è§£é‡Šå’Œä¾‹å­èƒ½å¸®åŠ©ä½ ç†è§£å¦‚ä½•åœ¨ Node.js v21.7.1 ä¸­ä½¿ç”¨ <code>buf.readUInt32BE([offset])</code> æ–¹æ³•ã€‚</p><h3 id="buf-readuint32le-offset" tabindex="-1"><a class="header-anchor" href="#buf-readuint32le-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreaduint32leoffset" target="_blank" rel="noopener noreferrer">buf.readUInt32LE([offset])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹ <code>buf.readUInt32LE([offset])</code> è¿™ä¸ªæ–¹æ³•åœ¨ Node.js ä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦äº†è§£å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p><ol><li><p><code>Buffer</code> - åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code>ç±»ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚å½“ä½ è¦ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’æˆ–è€…ä»ç½‘ç»œæ¥æ”¶æ•°æ®æ—¶ï¼Œè¿™äº›æ•°æ®é€šå¸¸ä¼šä»¥äºŒè¿›åˆ¶å½¢å¼å­˜åœ¨ï¼Œè€Œ<code>Buffer</code>å°±æ˜¯ä¸€ä¸ªå¯ä»¥å­˜å‚¨æ­¤ç±»äºŒè¿›åˆ¶æ•°æ®çš„å¯¹è±¡ã€‚</p></li><li><p><code>readUInt32LE</code> - è¿™æ˜¯<code>Buffer</code>å¯¹è±¡ä¸Šçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨äºä»<code>Buffer</code>ä¸­è¯»å– 32 ä½æ— ç¬¦å·æ•´æ•°ï¼ˆä¹Ÿå°±æ˜¯å¯ä»¥è¡¨ç¤º 0 åˆ° 4294967295 èŒƒå›´å†…çš„æ•°å­—ï¼‰ã€‚<code>LE</code>ä»£è¡¨<code>Little Endian</code>ï¼Œæ„å‘³ç€è¿™äº›å­—èŠ‚æŒ‰ç…§ä»æœ€ä½æœ‰æ•ˆä½åˆ°æœ€é«˜æœ‰æ•ˆä½çš„é¡ºåºè¿›è¡Œè¯»å–ã€‚</p></li><li><p><code>offset</code> - è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºå¼€å§‹è¯»å–æ•°æ®çš„ä½ç½®ï¼ˆåç§»é‡ï¼‰ï¼Œå•ä½æ˜¯å­—èŠ‚ã€‚å¦‚æœä¸æä¾›ï¼Œåˆ™é»˜è®¤ä¸º 0ï¼Œå³ä»<code>Buffer</code>çš„å¼€å¤´è¯»å–ã€‚</p></li></ol><p>ç°åœ¨ï¼Œä¸¾ä¸ªä¾‹å­æ¥è¯´æ˜<code>buf.readUInt32LE([offset])</code>æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š</p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«äºŒè¿›åˆ¶æ•°æ®çš„<code>Buffer</code>å¯¹è±¡ï¼Œå¹¶ä¸”æˆ‘ä»¬æƒ³è¦ä»ä¸­è¯»å–ä¸€ä¸ª 32 ä½çš„æ— ç¬¦å·æ•´æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 4 å­—èŠ‚çš„ Buffer å®ä¾‹ï¼Œåˆå§‹åŒ–ä¸ºå…¨0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬å‘è¿™ä¸ª Buffer å†™å…¥ä¸€ä¸ªç‰¹å®šçš„32ä½æ— ç¬¦å·æ•´æ•°ï¼š123456789</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ JavaScript ä¸­ï¼Œè¿™å¯ä»¥é€šè¿‡ writeUInt32LE æ–¹æ³•å®Œæˆ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeUInt32LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">123456789</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨æˆ‘ä»¬æ¥è¯»å–è¿™ä¸ªæ•°å­—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> num</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readUInt32LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">num</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡º 123456789</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º 4 ä¸ªå­—èŠ‚çš„<code>Buffer</code>ï¼Œå› ä¸º 32 ä½æ•´æ•°æ­£å¥½æ˜¯ 4 ä¸ªå­—èŠ‚ã€‚ç„¶åä½¿ç”¨<code>writeUInt32LE</code>æ–¹æ³•å°†æ•°å­—<code>123456789</code>å†™å…¥åˆ°<code>Buffer</code>ä¸­ã€‚ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨<code>readUInt32LE</code>æ–¹æ³•ä»åŒä¸€<code>Buffer</code>ä¸­è¯»å–è¯¥æ•°å€¼ã€‚</p><p>æ³¨æ„ï¼Œåœ¨è°ƒç”¨<code>readUInt32LE</code>æ—¶ï¼Œæˆ‘ä»¬ä¼ å…¥äº†<code>0</code>ä½œä¸º<code>offset</code>å‚æ•°ï¼Œè¿™æ„å‘³ç€è¯»å–æ“ä½œå°†ä»<code>Buffer</code>çš„ç¬¬ 0 ä¸ªå­—èŠ‚ï¼ˆå³æœ€å¼€å§‹çš„ä½ç½®ï¼‰å¼€å§‹ã€‚</p><p>å¦‚æœæˆ‘ä»¬çš„<code>Buffer</code>ä¸­åŒ…å«äº†å¤šä¸ªæ•´æ•°ï¼Œæˆ–è€…æˆ‘ä»¬åªå¯¹<code>Buffer</code>ä¸­æŸä¸ªç‰¹å®šä½ç½®çš„æ•´æ•°æ„Ÿå…´è¶£ï¼Œé‚£ä¹ˆå°±éœ€è¦åˆé€‚åœ°è®¾ç½®<code>offset</code>å‚æ•°ã€‚ä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 8 å­—èŠ‚çš„ Buffer å®ä¾‹ï¼Œåˆå§‹åŒ–ä¸ºå…¨0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‘ Buffer çš„å¼€å§‹ä½ç½®å†™å…¥ä¸€ä¸ª 32 ä½æ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeUInt32LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">123456789</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‘ Buffer çš„ç¬¬ 4 ä¸ªå­—èŠ‚å†™å…¥å¦ä¸€ä¸ª 32 ä½æ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeUInt32LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">987654321</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ†åˆ«è¯»å–è¿™ä¸¤ä¸ªæ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> num1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readUInt32LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»ç¬¬ 0 ä¸ªå­—èŠ‚å¼€å§‹è¯»å–</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> num2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readUInt32LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»ç¬¬ 4 ä¸ªå­—èŠ‚å¼€å§‹è¯»å–</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">num1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å° 123456789</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">num2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å° 987654321</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>Buffer</code>çš„é•¿åº¦æ˜¯ 8 ä¸ªå­—èŠ‚ï¼Œæˆ‘ä»¬åœ¨å…¶ä¸­å­˜å‚¨äº†ä¸¤ä¸ª 32 ä½çš„æ— ç¬¦å·æ•´æ•°ã€‚ä½¿ç”¨<code>readUInt32LE(0)</code>å¯ä»¥è¯»å–ç¬¬ä¸€ä¸ªæ•°ï¼Œè€Œ<code>readUInt32LE(4)</code>åˆ™ä¼šè·³è¿‡å‰ 4 ä¸ªå­—èŠ‚å¹¶è¯»å–æ¥ä¸‹æ¥çš„ 4 ä¸ªå­—èŠ‚ï¼Œå³ç¬¬äºŒä¸ªæ•°ã€‚</p><h3 id="buf-readuintbe-offset-bytelength" tabindex="-1"><a class="header-anchor" href="#buf-readuintbe-offset-bytelength"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreaduintbeoffset-bytelength" target="_blank" rel="noopener noreferrer">buf.readUIntBE(offset, byteLength)</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘ä¼šå°½å¯èƒ½é€šä¿—æ˜“æ‡‚åœ°è§£é‡Š <code>buf.readUIntBE(offset, byteLength)</code> è¿™ä¸ªæ–¹æ³•åœ¨ Node.js ä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code> å¯¹è±¡æ˜¯ä¸€ä¸ªç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„æ–¹å¼ã€‚å‡è®¾ä½ æœ‰ä¸€ä¸²äºŒè¿›åˆ¶æ•°æ®ï¼Œä½ å¯èƒ½æƒ³ä»ä¸­è¯»å–ç‰¹å®šçš„æ•°å­—æˆ–å­—ç¬¦ä¸²ã€‚Buffer è®©è¿™å˜å¾—å¯è¡Œã€‚</p><p><code>buf.readUIntBE(offset, byteLength)</code> æ˜¯ä¸€ä¸ªè¯»å–æ“ä½œï¼Œåœ¨ä¸€ä¸ª Buffer å¯¹è±¡ä¸Šè°ƒç”¨ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ ä» Buffer ä¸­æŒ‡å®šçš„ä½ç½®ï¼ˆå³ offsetï¼‰å¼€å§‹è¯»å–æŒ‡å®šé•¿åº¦ï¼ˆå³ byteLengthï¼‰çš„æ— ç¬¦å·æ•´æ•°ï¼Œå¹¶ä¸”ä»¥å¤§ç«¯å­—èŠ‚åºï¼ˆBig-Endianï¼‰çš„æ ¼å¼ã€‚</p><p>å¤§ç«¯å­—èŠ‚åºï¼ˆBEï¼‰ç®€å•æ¥è¯´å°±æ˜¯å°†é«˜ä½å­—èŠ‚å­˜å‚¨åœ¨ä½åœ°å€ä¸Šï¼Œè€Œå°ç«¯å­—èŠ‚åºï¼ˆLEï¼‰åˆ™ç›¸åï¼Œå°†ä½ä½å­—èŠ‚å­˜å‚¨åœ¨ä½åœ°å€ä¸Šã€‚ä¸åŒçš„è®¡ç®—æœºç³»ç»Ÿå¯èƒ½ä¼šä½¿ç”¨ä¸åŒçš„å­—èŠ‚åºï¼Œæ‰€ä»¥åœ¨ç½‘ç»œä¼ è¾“æˆ–æ–‡ä»¶äº¤æ¢æ—¶ï¼Œæ˜ç¡®å­—èŠ‚åºå¾ˆé‡è¦ã€‚</p><p>ç°åœ¨æ¥è§£é‡Šå‚æ•°ï¼š</p><ul><li><code>offset</code>ï¼šè¿™ä¸ªå‚æ•°æ˜¯å‘Šè¯‰æ–¹æ³•ï¼Œä» Buffer çš„å“ªä¸ªä½ç½®å¼€å§‹è¯»å–ã€‚</li><li><code>byteLength</code>ï¼šè¿™ä¸ªå‚æ•°è¯´æ˜è¦è¯»å–çš„å­—èŠ‚æ•°ã€‚å¯¹äºæ— ç¬¦å·æ•´æ•°ï¼Œåˆæ³•çš„ byteLength å¯ä»¥æ˜¯ 1ã€2ã€4ã€6ã€‚</li></ul><p>ç°åœ¨ä¸¾å‡ ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«å¦‚ä¸‹åå…­è¿›åˆ¶æ•°æ®çš„ Bufferï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>const buf = Buffer.from([0x12, 0x34, 0x56, 0x78]);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™é‡Œ <code>0x12</code> æ˜¯æ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œ<code>0x34</code> æ˜¯ç¬¬äºŒä¸ªå­—èŠ‚ï¼Œä¾æ­¤ç±»æ¨ã€‚</p><p>å¦‚æœæˆ‘ä»¬æƒ³è¯»å–å‰ä¸¤ä¸ªå­—èŠ‚ (<code>0x12</code> å’Œ <code>0x34</code>) ç»„æˆçš„æ— ç¬¦å·æ•´æ•°ï¼Œå¹¶ä¸”ä»¥å¤§ç«¯å­—èŠ‚åºè¯»å–ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readUIntBE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// offset æ˜¯ 0ï¼Œå› ä¸ºæˆ‘ä»¬ä»ç¬¬ä¸€ä¸ªå­—èŠ‚å¼€å§‹ï¼ŒbyteLength æ˜¯ 2ï¼Œå› ä¸ºæˆ‘ä»¬è¯»å–ä¸¤ä¸ªå­—èŠ‚ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 4660</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>åå…­è¿›åˆ¶æ•° <code>0x1234</code> è½¬æ¢ä¸ºåè¿›åˆ¶å°±æ˜¯ <code>4660</code>ã€‚</p><p>å†ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¯»å–åä¸‰ä¸ªå­—èŠ‚ (<code>0x34</code>, <code>0x56</code>, <code>0x78</code>) ç»„æˆçš„æ— ç¬¦å·æ•´æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> anotherValue</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readUIntBE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// offset æ˜¯ 1ï¼Œå› ä¸ºæˆ‘ä»¬ä»ç¬¬äºŒä¸ªå­—èŠ‚å¼€å§‹ï¼ŒbyteLength æ˜¯ 3ï¼Œå› ä¸ºæˆ‘ä»¬è¯»å–ä¸‰ä¸ªå­—èŠ‚ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">anotherValue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 3451752</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>åå…­è¿›åˆ¶æ•° <code>0x345678</code> è½¬æ¢ä¸ºåè¿›åˆ¶å°±æ˜¯ <code>3451752</code>ã€‚</p><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ åº”è¯¥èƒ½å¤Ÿäº†è§£ <code>buf.readUIntBE(offset, byteLength)</code> æ–¹æ³•åœ¨ Node.js ä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä»¥åŠå®ƒå¦‚ä½•ä» Buffer ä¸­è¯»å–å¤§ç«¯å­—èŠ‚åºçš„æ— ç¬¦å·æ•´æ•°ã€‚è®°ä½ï¼Œæ“ä½œ Buffer çš„æ—¶å€™æ€»æ˜¯è¦éå¸¸æ³¨æ„ offset å’Œ byteLength çš„é€‰æ‹©ï¼Œå› ä¸ºé”™è¯¯çš„å€¼å¯èƒ½å¯¼è‡´è¯»å–åˆ°é”™è¯¯çš„æ•°æ®æˆ–è€…è¿è¡Œæ—¶é”™è¯¯ã€‚</p><h3 id="buf-readuintle-offset-bytelength" tabindex="-1"><a class="header-anchor" href="#buf-readuintle-offset-bytelength"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufreaduintleoffset-bytelength" target="_blank" rel="noopener noreferrer">buf.readUIntLE(offset, byteLength)</a></span></a></h3><p>Node.js ä¸­çš„ <code>buf.readUIntLE(offset, byteLength)</code> æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºä» Buffer å¯¹è±¡ä¸­è¯»å–æŒ‡å®šæ•°é‡çš„å­—èŠ‚ï¼Œå¹¶ä¸”æŒ‰ç…§å°ç«¯åºï¼ˆlittle-endianï¼‰çš„æ ¼å¼è§£é‡Šè¿™äº›å­—èŠ‚ä¸ºæ— ç¬¦å·æ•´æ•°ã€‚Buffer æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œç”¨æ¥ç›´æ¥æ“ä½œå†…å­˜ä¸­çš„äºŒè¿›åˆ¶æ•°æ®ã€‚</p><p>åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œæ•´æ•°åœ¨å†…å­˜ä¸­å¯ä»¥æŒ‰ç…§ä¸¤ç§ä¸åŒçš„æ–¹å¼å­˜å‚¨ï¼š</p><ul><li><strong>å°ç«¯åº</strong>ï¼ˆLittle-Endianï¼‰ï¼šæœ€ä½æœ‰æ•ˆå­—èŠ‚ä½äºæœ€ä½åœ°å€ã€‚</li><li><strong>å¤§ç«¯åº</strong>ï¼ˆBig-Endianï¼‰ï¼šæœ€é«˜æœ‰æ•ˆå­—èŠ‚ä½äºæœ€ä½åœ°å€ã€‚</li></ul><p><code>readUIntLE</code> æ–¹æ³•æ­£æ˜¯ç”¨æ¥æŒ‰å°ç«¯åºçš„æ–¹å¼ä»ç¼“å†²åŒºè¯»å–æ•°æ®çš„ã€‚</p><h3 id="å‚æ•°è§£é‡Š-2" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-2"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>offset</code>: è¿™æ˜¯è¦å¼€å§‹è¯»å–çš„ä½ç½®çš„ç´¢å¼•ï¼Œä» 0 å¼€å§‹ã€‚</li><li><code>byteLength</code>: è¦è¯»å–çš„å­—èŠ‚æ•°ï¼Œå¯ä»¥æ˜¯ 1 åˆ° 6 ä¹‹é—´çš„ä»»æ„æ•´æ•°ï¼Œå› ä¸º JavaScript ä¸­ Number ç±»å‹èƒ½å¤Ÿå®‰å…¨è¡¨ç¤ºçš„æœ€å¤§æ— ç¬¦å·æ•´æ•°æ˜¯ 2^53 - 1ã€‚</li></ul><h3 id="è¿”å›å€¼-5" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-5"><span>è¿”å›å€¼</span></a></h3><p>è°ƒç”¨è¿™ä¸ªæ–¹æ³•åï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°ï¼Œå…¶å€¼å°±æ˜¯æ ¹æ®å‚æ•°æŒ‡å®šçš„å†…å­˜ä½ç½®å’Œå­—èŠ‚æ•°è§£æå¾—åˆ°çš„ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ä½ æ­£åœ¨å¤„ç†ä¸€ä¸ªç½‘ç»œé€šä¿¡çš„åœºæ™¯ï¼Œä½ æ”¶åˆ°äº†ä¸€ä¸ªåŒ…å«å¤šç§æ•°æ®ç±»å‹çš„äºŒè¿›åˆ¶æ¶ˆæ¯ã€‚åœ¨è¿™ä¸ªæ¶ˆæ¯ä¸­ï¼Œæœ‰ä¸€ä¸ªéƒ¨åˆ†å‘Šè¯‰ä½ æŸä¸ªè®¾å¤‡å‘é€çš„ä¿¡å·å¼ºåº¦ï¼Œè¿™ä¸ªå€¼æ˜¯ä¸€ä¸ªå°ç«¯åºçš„ 16 ä½æ— ç¬¦å·æ•´æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æ”¶åˆ°äº†ä¸€ä¸ªåŒ…å«äºŒè¿›åˆ¶æ•°æ®çš„Bufferå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x78</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x56</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x34</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x12</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬çŸ¥é“ä¿¡å·å¼ºåº¦çš„å€¼æ˜¯ä»ç¬¬ä¸€ä¸ªå­—èŠ‚å¼€å§‹çš„ä¸¤ä¸ªå­—èŠ‚çš„å°ç«¯åºæ— ç¬¦å·æ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signalStrength</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readUIntLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">signalStrength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 22136</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª Buffer å®ä¾‹ï¼Œå¹¶å‡è®¾å®ƒå·²ç»åŒ…å«äº†ä»ç½‘ç»œæ¥æ”¶åˆ°çš„æ•°æ® <code>[0x78, 0x56, 0x34, 0x12]</code>ã€‚è°ƒç”¨ <code>readUIntLE(0, 2)</code> åï¼Œå®ƒä»¥å°ç«¯åºæ–¹å¼è¯»å–å‰ä¸¤ä¸ªå­—èŠ‚ (<code>0x78</code> å’Œ <code>0x56</code>) å¹¶å°†å®ƒä»¬è§£é‡Šæˆä¸€ä¸ªæ— ç¬¦å·æ•´æ•°ã€‚</p><p>ç”±äºæ˜¯å°ç«¯åºï¼Œ<code>0x56</code> æ˜¯é«˜ä½å­—èŠ‚ï¼Œ<code>0x78</code> æ˜¯ä½ä½å­—èŠ‚ã€‚æ‰€ä»¥å®é™…çš„åå…­è¿›åˆ¶æ•°åº”è¯¥æ˜¯ <code>0x5678</code>ï¼Œè½¬æ¢ä¸ºåè¿›åˆ¶å°±æ˜¯ <code>22136</code>ï¼Œè¿™å°±æ˜¯ <code>signalStrength</code> çš„å€¼ã€‚</p><p>å¸Œæœ›é€šè¿‡è¿™ä¸ªä¾‹å­ï¼Œä½ å¯¹ <code>readUIntLE</code> æ–¹æ³•æœ‰äº†æ›´å¥½çš„ç†è§£ã€‚è®°ä½ï¼Œå¤„ç†å­—èŠ‚é¡ºåºåœ¨å¤„ç†ä½çº§ç½‘ç»œé€šä¿¡æˆ–æ–‡ä»¶æ ¼å¼æ—¶éå¸¸é‡è¦ï¼Œå› ä¸ºä¸åŒçš„ç³»ç»Ÿå¯èƒ½ä¼šä»¥ä¸åŒçš„å­—èŠ‚é¡ºåºå­˜å‚¨ç›¸åŒçš„æ•°æ®ã€‚</p><h3 id="buf-subarray-start-end" tabindex="-1"><a class="header-anchor" href="#buf-subarray-start-end"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufsubarraystart-end" target="_blank" rel="noopener noreferrer">buf.subarray([start[, end]])</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘ä¼šå°½é‡é€šä¿—æ˜“æ‡‚åœ°è§£é‡Šç»™ä½ ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code>æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ç±»ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒå°±åƒä¸€ä¸ªå¯ä»¥å­˜å‚¨å­—èŠ‚çš„æ•°ç»„ã€‚æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½åªæƒ³æ“ä½œæˆ–è®¿é—®è¿™ä¸ª&quot;æ•°ç»„&quot;çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯æ•´ä¸ª Bufferã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨<code>buf.subarray()</code>æ–¹æ³•ã€‚</p><p><code>buf.subarray([start[, end]])</code>æ–¹æ³•å…è®¸æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„<code>Buffer</code>è§†å›¾ï¼Œè¿™ä¸ªæ–°è§†å›¾å¼•ç”¨åŸå§‹ Buffer ä¸­çš„æ•°æ®ï¼Œä½†åªåŒ…æ‹¬æŒ‡å®šèŒƒå›´çš„å­—èŠ‚ã€‚å®ƒæ¥å—ä¸¤ä¸ªå¯é€‰å‚æ•°ï¼š</p><ul><li><code>start</code>ï¼ˆé»˜è®¤å€¼æ˜¯ 0ï¼‰ï¼šå¼€å§‹ä½ç½®çš„ç´¢å¼•ï¼Œä»è¿™é‡Œå¼€å§‹å–å­æ•°ç»„ã€‚</li><li><code>end</code>ï¼ˆé»˜è®¤å€¼æ˜¯ buffer.lengthï¼‰ï¼šç»“æŸä½ç½®çš„ç´¢å¼•ï¼Œä½†ä¸åŒ…æ‹¬<code>end</code>æœ¬èº«ã€‚</li></ul><p>è¿™äº›å‚æ•°ä¸ JavaScript æ•°ç»„çš„<code>slice()</code>æ–¹æ³•å¾ˆç›¸ä¼¼ã€‚</p><p>é‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œ<code>subarray()</code>è¿”å›çš„æ˜¯åŸå§‹ Buffer çš„ä¸€ä¸ªè§†å›¾ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¤åˆ¶ã€‚è¿™æ„å‘³ç€ä¿®æ”¹è¿”å›çš„å­æ•°ç»„ä¹Ÿä¼šå½±å“åŸå§‹ Bufferã€‚</p><p>ä¸‹é¢æˆ‘å°†ä¸¾å‡ ä¸ªä¾‹å­æ¥è¯´æ˜è¿™ä¸ªæ–¹æ³•çš„å…·ä½“åº”ç”¨ã€‚</p><h3 id="ä¾‹å­-1-è·å–-buffer-çš„ä¸€éƒ¨åˆ†" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-è·å–-buffer-çš„ä¸€éƒ¨åˆ†"><span>ä¾‹å­ 1ï¼šè·å– Buffer çš„ä¸€éƒ¨åˆ†</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«ä¸€äº›æ•°å­—çš„ Bufferï¼Œå¹¶ä¸”æˆ‘ä»¬æƒ³å¾—åˆ°å…¶ä¸­ä¸€å°æ®µã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–bufferä¸­ä»ä½ç½®2ï¼ˆåŒ…æ‹¬ï¼‰åˆ°ä½ç½®4ï¼ˆä¸åŒ…æ‹¬ï¼‰çš„éƒ¨åˆ†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> subBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">subarray</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">subBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š`&lt;`Buffer 03 04&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>subBuffer</code>ç°åœ¨æ˜¯åŸå§‹<code>buffer</code>çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒåªåŒ…å«åŸå§‹ Buffer ä¸­ä½ç½® 2 å’Œä½ç½® 3 çš„æ•°æ®ï¼Œå³æ•°å­— 3 å’Œ 4ã€‚</p><h3 id="ä¾‹å­-2-ä¸æä¾›ç»“æŸä½ç½®" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ä¸æä¾›ç»“æŸä½ç½®"><span>ä¾‹å­ 2ï¼šä¸æä¾›ç»“æŸä½ç½®</span></a></h3><p>å¦‚æœæˆ‘ä»¬æ²¡æœ‰æä¾›ç»“æŸä½ç½®ï¼Œ<code>subarray()</code>å°†è¿”å›ä»å¼€å§‹ä½ç½®åˆ° Buffer æœ«å°¾çš„æ‰€æœ‰æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–bufferä¸­ä»ä½ç½®3ï¼ˆåŒ…æ‹¬ï¼‰åˆ°æœ«å°¾çš„æ‰€æœ‰æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> subBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">subarray</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">subBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š`&lt;`Buffer 04 05&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªä»ä½ç½® 3 å¼€å§‹åˆ° buffer ç»“æŸçš„å­æ•°ç»„ã€‚</p><h3 id="ä¾‹å­-3-ä¿®æ”¹å­æ•°ç»„å½±å“åŸå§‹-buffer" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-3-ä¿®æ”¹å­æ•°ç»„å½±å“åŸå§‹-buffer"><span>ä¾‹å­ 3ï¼šä¿®æ”¹å­æ•°ç»„å½±å“åŸå§‹ Buffer</span></a></h3><p>ç”±äº<code>subarray()</code>è¿”å›çš„æ˜¯å¯¹åŸå§‹ Buffer ä¸­æ•°æ®çš„å¼•ç”¨ï¼Œå› æ­¤å¦‚æœæˆ‘ä»¬ä¿®æ”¹è¿™ä¸ªå­æ•°ç»„ï¼ŒåŸå§‹ Buffer ä¹Ÿä¼šè¢«ä¿®æ”¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> subBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">subarray</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">subBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">subBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š`&lt;`Buffer 06 04&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š`&lt;`Buffer 01 02 06 04 05&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ”¹å˜äº†<code>subBuffer</code>çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆåŸå§‹ Buffer çš„ç¬¬ä¸‰ä¸ªå…ƒç´ ï¼‰ï¼ŒåŸå§‹çš„<code>buffer</code>ä¹Ÿåæ˜ äº†è¿™ä¸ªæ”¹å˜ã€‚</p><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ åº”è¯¥èƒ½æ›´æ¸…æ¥šåœ°ç†è§£<code>buf.subarray(start, end)</code>æ–¹æ³•å¦‚ä½•å·¥ä½œï¼Œä»¥åŠä¸ºä»€ä¹ˆè¿™ä¸ªæ–¹æ³•åœ¨éœ€è¦å¤„ç† Buffer çš„ä¸€éƒ¨åˆ†æ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="buf-slice-start-end" tabindex="-1"><a class="header-anchor" href="#buf-slice-start-end"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufslicestart-end" target="_blank" rel="noopener noreferrer">buf.slice([start[, end]])</a></span></a></h3><p>Node.js ä¸­çš„ <code>Buffer</code> æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ç±»ï¼Œå¯ä»¥å°†å…¶çœ‹ä½œæ˜¯ä¸€ä¸ªå­˜æ”¾åŸå§‹äºŒè¿›åˆ¶æ•°æ®çš„æ•°ç»„ã€‚ä¾‹å¦‚ï¼Œåœ¨è¯»å–æ–‡ä»¶æˆ–ç½‘ç»œæ•°æ®ä¼ è¾“æ—¶ï¼Œä½ å¯èƒ½ä¼šæ¥è§¦åˆ°äºŒè¿›åˆ¶æ•°æ®ã€‚<code>Buffer</code> æä¾›äº†ä¸€ç³»åˆ—æ–¹æ³•æ¥æ“ä½œè¿™äº›äºŒè¿›åˆ¶æ•°æ®ã€‚</p><p><code>buf.slice([start[, end]])</code> æ–¹æ³•æ˜¯ <code>Buffer</code> ç±»ä¸­çš„ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ–¹æ³•ï¼Œå®ƒå…è®¸ä½ åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Buffer</code> å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯åŸå§‹ <code>Buffer</code> çš„ä¸€ä¸ªåˆ‡ç‰‡ï¼ˆå­åºåˆ—ï¼‰ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ä»ä¸€ä¸ªè¾ƒå¤§çš„ <code>Buffer</code> ä¸­æŠ½å–ä¸€éƒ¨åˆ†å†…å®¹ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„ <code>Buffer</code> å¯¹è±¡ï¼Œè€Œä¸æ”¹å˜åŸå§‹çš„ <code>Buffer</code> æ•°æ®ã€‚</p><p>å‚æ•°ï¼š</p><ul><li><code>start</code> ï¼ˆå¯é€‰ï¼‰ï¼šä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šå¼€å§‹åˆ‡ç‰‡çš„ä½ç½®ã€‚é»˜è®¤å€¼ä¸º 0ã€‚</li><li><code>end</code> ï¼ˆå¯é€‰ï¼‰ï¼šä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šç»“æŸåˆ‡ç‰‡çš„ä½ç½®ï¼ˆä¸åŒ…å«è¯¥ä½ç½®çš„æ•°æ®ï¼‰ã€‚å¦‚æœæ²¡æœ‰æä¾›ï¼Œé»˜è®¤æ˜¯ <code>Buffer</code> çš„é•¿åº¦ã€‚</li></ul><p>è¿”å›å€¼ï¼š</p><ul><li>è¿”å›ä¸€ä¸ªæ–°çš„ <code>Buffer</code> å¯¹è±¡ï¼Œå®ƒå¼•ç”¨ä¸åŸå§‹ <code>Buffer</code> ç›¸åŒçš„å†…å­˜ç©ºé—´ï¼Œä½†åªè¡¨ç¤º <code>start</code> å’Œ <code>end</code> ä¹‹é—´çš„æ•°æ®ã€‚</li></ul><p>å®é™…åº”ç”¨ç¤ºä¾‹ï¼š</p><ol><li><strong>è¯»å–éƒ¨åˆ†æ–‡ä»¶å†…å®¹</strong>:<br> å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç¨‹åºæ¥è¯»å–æ–‡ä»¶çš„éƒ¨åˆ†å†…å®¹ï¼Œå¹¶ä¸”ä¸éœ€è¦æ•´ä¸ªæ–‡ä»¶ã€‚ä½ å¯ä»¥é¦–å…ˆå°†æ–‡ä»¶è¯»å–åˆ° Buffer ä¸­ï¼Œç„¶åä½¿ç”¨ <code>slice()</code> è·å–æ–‡ä»¶çš„æŸä¸ªç‰¹å®šéƒ¨åˆ†ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼‚æ­¥è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾æˆ‘ä»¬åªéœ€è¦æ–‡ä»¶çš„ç¬¬10åˆ°ç¬¬20å­—èŠ‚ä¹‹é—´çš„å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> slicedBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">slice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ç°åœ¨slicedBufferåŒ…å«example.txtçš„ç¬¬10åˆ°19å­—èŠ‚çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">slicedBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>å¤„ç†ç½‘ç»œè¯·æ±‚æ•°æ®</strong>:<br> å½“ä½ çš„ Node.js æœåŠ¡å™¨æ”¶åˆ°ä¸€ä¸ªåˆ†å—ä¸Šä¼ çš„å¤§æ–‡ä»¶æ—¶ï¼Œä½ å¯èƒ½æƒ³è¦é€æ­¥å¤„ç†æ¯ä¸€ä¸ªæ•°æ®å—ã€‚ä½¿ç”¨ <code>slice()</code> å¯ä»¥å¸®åŠ©ä½ è·å–å¹¶å¤„ç†è¿™äº›åˆ†æ®µæ•°æ®ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">http</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> body</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    req</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        // å°†æ¥æ”¶åˆ°çš„æ•°æ®å— chunk æ”¶é›†èµ·æ¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        body</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">        body</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">concat</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">body</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†æ‰€æœ‰çš„ Buffer åˆå¹¶æˆä¸€ä¸ª</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        // å‡è®¾æˆ‘ä»¬åªå…³å¿ƒæ•°æ®çš„å‰åŠéƒ¨åˆ†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> halfIndex</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Math</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">floor</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">body</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> /</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> firstHalf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> body</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">slice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">halfIndex</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        // å¤„ç† firstHalf...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Data processed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8080</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Server running at http://127.0.0.1:8080/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>åˆ›å»ºç¼“å†²åŒºå‰¯æœ¬ç‰‡æ®µ</strong>:<br> åœ¨ä¸€äº›éœ€è¦å¤„ç†æ•°æ®å‰¯æœ¬çš„åœºæ™¯ä¸­ï¼Œä½¿ç”¨ <code>slice()</code> å¯ä»¥é¿å…ä¿®æ”¹åŸå§‹æ•°æ®ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;This is a buffer example.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬æƒ³è¦å¤åˆ¶ &quot;is a&quot; éƒ¨åˆ†çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> slicedBuf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">slice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">slicedBuf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: is a</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ³¨æ„ï¼Œå°½ç®¡ slicedBuf æ˜¯åŸå§‹ Buffer çš„ä¸€ä¸ªâ€œè§†å›¾â€ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½†æ˜¯å¯¹ slicedBuf è¿›è¡Œä¿®æ”¹ä¸ä¼šå½±å“ buf1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">slicedBuf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0x68</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// &#39;h&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">slicedBuf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: his a</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: This is a buffer example.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šå°±æ˜¯ <code>buf.slice([start[, end]])</code> æ–¹æ³•çš„åŸºæœ¬ä»‹ç»å’Œå‡ ä¸ªå®ç”¨çš„ä¾‹å­ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£è¿™ä¸ªæ–¹æ³•çš„ç”¨é€”ã€‚</p><h3 id="buf-swap16" tabindex="-1"><a class="header-anchor" href="#buf-swap16"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufswap16" target="_blank" rel="noopener noreferrer">buf.swap16()</a></span></a></h3><p>å¥½çš„ï¼ŒNode.js ä¸­çš„ <code>buf.swap16()</code> æ˜¯ä¸€ä¸ªç”¨äºäº¤æ¢ Buffer å¯¹è±¡ä¸­æ¯å¯¹å­—èŠ‚é¡ºåºçš„æ–¹æ³•ã€‚åœ¨è§£é‡Šè¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€äº›åŸºæœ¬æ¦‚å¿µã€‚</p><p><strong>Buffer æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p><p>åœ¨ Node.js ä¸­ï¼ŒBuffer ç±»æ˜¯ä¸€ä¸ªå…¨å±€å¯ç”¨çš„ç±»ï¼Œç”¨äºç›´æ¥æ“ä½œå†…å­˜ä¸­çš„æ•°æ®ã€‚å½“ä½ å¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼ˆå¦‚æ–‡ä»¶è¯»å†™ã€ç½‘ç»œé€šä¿¡ç­‰ï¼‰æ—¶ï¼Œå°±ä¼šç”¨åˆ°å®ƒã€‚Buffer å®ä¾‹ç±»ä¼¼äºæ•´æ•°æ•°ç»„ï¼Œä½†å®ƒä»¬æ˜¯å›ºå®šå¤§å°çš„ï¼Œå¹¶ä¸”ç›´æ¥æ˜ å°„åˆ°åº•å±‚å†…å­˜ï¼Œè€Œä¸æ˜¯åƒæ™®é€šçš„ JavaScript æ•°ç»„é‚£æ ·åŠ¨æ€æ‰©å±•ã€‚</p><p><strong>ä¸ºä»€ä¹ˆéœ€è¦ swap16 æ–¹æ³•ï¼Ÿ</strong></p><p>è®¡ç®—æœºæœ‰ä¸¤ç§å­˜å‚¨å¤šå­—èŠ‚æ•°æ®ï¼ˆæ¯”å¦‚æ•°å­—å¤§äº 255 çš„æ•´æ•°ï¼‰çš„æ–¹å¼ï¼šå¤§ç«¯æ¨¡å¼ï¼ˆBig-Endianï¼‰å’Œå°ç«¯æ¨¡å¼ï¼ˆLittle-Endianï¼‰ã€‚è¿™ä¸¤ç§æ–¹å¼å®šä¹‰äº†å­—èŠ‚çš„é¡ºåºã€‚åœ¨å¤§ç«¯æ¨¡å¼ä¸­ï¼Œæœ€é‡è¦çš„å­—èŠ‚ï¼ˆé«˜ä½å­—èŠ‚ï¼‰æ”¾åœ¨å†…å­˜çš„ä½åœ°å€ç«¯ï¼Œè€Œåœ¨å°ç«¯æ¨¡å¼ä¸­ï¼Œåˆ™æ˜¯ç›¸åã€‚</p><p>æœ‰æ—¶å€™ï¼Œåœ¨ä¸åŒæ¶æ„æˆ–åè®®é—´äº¤æ¢æ•°æ®æ—¶ï¼Œä½ å¯èƒ½éœ€è¦å°†æ•°æ®ä»ä¸€ç§å­—èŠ‚åºè½¬æ¢ä¸ºå¦ä¸€ç§å­—èŠ‚åºã€‚è¿™å°±æ˜¯ <code>buf.swap16()</code> æ–¹æ³•çš„ä½œç”¨ã€‚</p><p><strong>å¦‚ä½•ä½¿ç”¨ swap16 æ–¹æ³•ï¼Ÿ</strong></p><p>è¿™ä¸ªæ–¹æ³•ä¼šæŠŠ Buffer å¯¹è±¡ä¸­çš„å­—èŠ‚é¡ºåºä»ä¸¤ä¸ªå­—èŠ‚ä¸ºä¸€å•ä½è¿›è¡Œäº¤æ¢ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹çš„ 16 ä½æ•°æ®ï¼ˆ2 å­—èŠ‚ï¼‰:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>åŸå§‹æ•°æ®: 0xABCD</span></span>
<span class="line"><span>å†…å­˜è¡¨ç¤º (å¤§ç«¯): AB CD</span></span>
<span class="line"><span>å†…å­˜è¡¨ç¤º (å°ç«¯): CD AB</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä½ çš„ Buffer æ˜¯ä»¥å°ç«¯æ–¹å¼å­˜å‚¨è¿™ä¸ªæ•°å€¼ï¼Œè€Œä½ éœ€è¦å°†å…¶è½¬æ¢ä¸ºå¤§ç«¯æ–¹å¼ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>swap16</code> æ¥äº¤æ¢å­—èŠ‚é¡ºåºã€‚</p><p>è®©æˆ‘ä»¬é€šè¿‡ä¸€äº›å®é™…çš„ä»£ç ç¤ºä¾‹æ¥ç†è§£è¿™ä¸ªè¿‡ç¨‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xab</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xcd</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸¤ä¸ªå­—èŠ‚çš„ Buffer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// `&lt;`Buffer ab cd&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">swap16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†æ¯å¯¹å­—èŠ‚é¡ºåºäº¤æ¢</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// `&lt;`Buffer cd ab&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ…å« 0xAB å’Œ 0xCD çš„ Bufferã€‚åœ¨è°ƒç”¨ <code>swap16()</code> æ–¹æ³•ä¹‹å‰ï¼Œå®ƒçš„å†…å®¹æ˜¯ AB CDï¼ˆå¤§ç«¯æ–¹å¼ï¼‰ã€‚è°ƒç”¨ <code>swap16()</code> åï¼Œå†…éƒ¨å­—èŠ‚é¡ºåºå˜ä¸ºäº† CD AB ï¼ˆå°ç«¯æ–¹å¼ï¼‰ã€‚</p><p>æ³¨æ„ï¼Œä½¿ç”¨ <code>swap16</code> çš„ Buffer å¤§å°å¿…é¡»æ˜¯å¶æ•°ï¼Œå› ä¸ºå®ƒæ˜¯æŒ‰ç…§æ¯ä¸¤ä¸ªå­—èŠ‚ä¸ºä¸€ç»„æ¥äº¤æ¢çš„ã€‚å¦‚æœ Buffer é•¿åº¦æ˜¯å¥‡æ•°ï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•å°†ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><p>å¸Œæœ›è¿™æ ·è§£é‡Šèƒ½å¸®åŠ©ä½ ç†è§£ Node.js ä¸­çš„ <code>buf.swap16()</code> æ–¹æ³•ã€‚</p><h3 id="buf-swap32" tabindex="-1"><a class="header-anchor" href="#buf-swap32"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufswap32" target="_blank" rel="noopener noreferrer">buf.swap32()</a></span></a></h3><p>Node.js ä¸­çš„ <code>Buffer</code> å¯¹è±¡æ˜¯ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ã€‚æ¯å½“ä½ åœ¨ Node.js ä¸­éœ€è¦ç›´æ¥æ“ä½œå­—èŠ‚æ•°æ®æ—¶ï¼Œæ¯”å¦‚ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®æˆ–è€…ä¸ç½‘ç»œé€šä¿¡ï¼Œå°±ä¼šé‡åˆ° <code>Buffer</code>ã€‚</p><p><code>buf.swap32()</code> æ˜¯ <code>Buffer</code> å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒå…è®¸ä½ å°† <code>Buffer</code> å®ä¾‹å†…éƒ¨çš„æ¯ 4 ä¸ªå­—èŠ‚ï¼ˆä¹Ÿå°±æ˜¯ 32 ä½ï¼‰ä½œä¸ºä¸€ä¸ªå•ä½è¿›è¡Œç«¯åºäº¤æ¢ã€‚&quot;ç«¯åº&quot;ï¼ˆEndiannessï¼‰æ˜¯æŒ‡æ•°æ®çš„å­—èŠ‚åºï¼Œå³å¤šå­—èŠ‚æ•°æ®åœ¨å†…å­˜ä¸­çš„æ’åˆ—æ–¹å¼ã€‚å¸¸è§çš„æœ‰ä¸¤ç§ç«¯åºï¼š</p><ol><li><strong>å¤§ç«¯åºï¼ˆBig-endianï¼‰</strong>ï¼šé«˜ä½å­—èŠ‚å­˜æ”¾åœ¨å†…å­˜çš„ä½åœ°å€ç«¯ï¼Œä½ä½å­—èŠ‚å­˜æ”¾åœ¨é«˜åœ°å€ç«¯ã€‚</li><li><strong>å°ç«¯åºï¼ˆLittle-endianï¼‰</strong>ï¼šä½ä½å­—èŠ‚å­˜æ”¾åœ¨å†…å­˜çš„ä½åœ°å€ç«¯ï¼Œé«˜ä½å­—èŠ‚å­˜æ”¾åœ¨é«˜åœ°å€ç«¯ã€‚</li></ol><p>ä¸åŒçš„è®¡ç®—æœºç³»ç»Ÿå¯èƒ½é‡‡ç”¨ä¸åŒçš„ç«¯åºå­˜å‚¨æ•°æ®ã€‚å½“åœ¨è¿™äº›ç³»ç»Ÿä¹‹é—´ä¼ è¾“æ•°æ®æ—¶ï¼Œå¯èƒ½éœ€è¦å¯¹æ•°æ®çš„ç«¯åºè¿›è¡Œè½¬æ¢ï¼Œä»¥ç¡®ä¿æ•°æ®è¢«æ­£ç¡®è§£é‡Šå’Œå¤„ç†ã€‚è€Œ <code>buf.swap32()</code> å°±æ˜¯ç”¨æ¥åšè¿™æ ·çš„è½¬æ¢ã€‚</p><p>ä¸¾ä¾‹è¯´æ˜ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x00</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x01</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x02</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x03</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x04</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x05</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x06</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x07</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾bufçš„å†…å®¹æ˜¯ [00, 01, 02, 03, 04, 05, 06, 07]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œçš„æ¯ä¸€é¡¹ä»£è¡¨äº†ä¸€ä¸ªå­—èŠ‚ï¼Œå¹¶ç”¨åå…­è¿›åˆ¶è¡¨ç¤º</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">swap32</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨bufçš„å†…å®¹ä¼šå˜ä¸º [03, 02, 01, 00, 07, 06, 05, 04]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// swap32()æ–¹æ³•å°†æ¯å››ä¸ªå­—èŠ‚ä¸ºä¸€ç»„è¿›è¡Œäº†ç«¯åºç¿»è½¬</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ…å« 8 ä¸ªå­—èŠ‚çš„ <code>Buffer</code> å¯¹è±¡ã€‚è°ƒç”¨ <code>swap32()</code> æ–¹æ³•å‰ï¼Œè¿™ 8 ä¸ªå­—èŠ‚çš„æ’åˆ—é¡ºåºæ˜¯ <code>[00, 01, 02, 03, 04, 05, 06, 07]</code>ã€‚è¿™ä¸ªæ’åˆ—é¡ºåºå¯ä»¥çœ‹ä½œæ˜¯ä¸¤ä¸ª 32 ä½æ•°ï¼Œåˆ†åˆ«æ˜¯ <code>0x00010203</code> å’Œ <code>0x04050607</code>ã€‚è°ƒç”¨ <code>swap32()</code> åï¼Œè¿™ä¸¤ä¸ªæ•°çš„å­—èŠ‚åºè¢«é¢ å€’äº†ï¼Œå˜æˆäº† <code>0x03020100</code> å’Œ <code>0x07060504</code>ï¼Œå› æ­¤æ–°çš„ <code>Buffer</code> å†…å®¹å°±å˜æˆäº† <code>[03, 02, 01, 00, 07, 06, 05, 04]</code>ã€‚</p><p>è¿™ç§æ“ä½œåœ¨ä½ éœ€è¦å°†æ•°æ®ä»ä¸€ä¸ªä½¿ç”¨å¤§ç«¯åºçš„ç³»ç»Ÿä¼ è¾“åˆ°ä¸€ä¸ªä½¿ç”¨å°ç«¯åºçš„ç³»ç»Ÿæ—¶éå¸¸æœ‰ç”¨ï¼Œæˆ–è€…åè¿‡æ¥ã€‚ä¾‹å¦‚ï¼ŒæŸäº›ç½‘ç»œåè®®è§„å®šæ•°æ®å¿…é¡»ä½¿ç”¨å¤§ç«¯åºå‘é€ï¼Œå¦‚æœä½ çš„æœåŠ¡å™¨è¿è¡Œåœ¨å°ç«¯åºçš„ç³»ç»Ÿä¸Šï¼Œé‚£ä¹ˆåœ¨å‘é€æ•°æ®ä¹‹å‰ï¼Œä½ å¯èƒ½éœ€è¦ä½¿ç”¨ <code>buf.swap32()</code> æ¥è°ƒæ•´æ•°æ®çš„ç«¯åºã€‚</p><h3 id="buf-swap64" tabindex="-1"><a class="header-anchor" href="#buf-swap64"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufswap64" target="_blank" rel="noopener noreferrer">buf.swap64()</a></span></a></h3><p><code>buf.swap64()</code> æ˜¯ Node.js ä¸­ Buffer å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºäº¤æ¢ç¼“å†²åŒºä¸­ 64 ä½ï¼ˆ8 å­—èŠ‚ï¼‰æ•´æ•°çš„å­—èŠ‚åºã€‚å­—èŠ‚åºæ˜¯æŒ‡å­˜å‚¨æˆ–ä¼ è¾“æ•°æ®æ—¶æ¯ä¸ªæ•°å­—çš„å­—èŠ‚æ’åˆ—é¡ºåºï¼Œå¹¶ä¸”æœ‰ä¸¤ç§ç±»å‹ï¼šå¤§ç«¯åºï¼ˆbig-endianï¼‰å’Œå°ç«¯åºï¼ˆlittle-endianï¼‰ã€‚</p><p>åœ¨å¤§ç«¯åºä¸­ï¼Œæœ€é‡è¦çš„å­—èŠ‚ï¼ˆé«˜ä½å­—èŠ‚ï¼‰æ”¾åœ¨æ•°å­—çš„èµ·å§‹ä½ç½®ï¼ˆå†…å­˜åœ°å€æœ€ä½çš„ä½ç½®ï¼‰ã€‚åœ¨å°ç«¯åºä¸­ï¼Œæœ€é‡è¦çš„å­—èŠ‚æ”¾åœ¨æ•°å­—çš„ç»“æŸä½ç½®ï¼ˆå†…å­˜åœ°å€æœ€é«˜çš„ä½ç½®ï¼‰ã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨å¤§ç«¯åºä¸­ï¼Œ16 è¿›åˆ¶æ•° <code>0x0123456789ABCDEF</code> åœ¨å†…å­˜ä¸­çš„å­˜å‚¨ä¼šæ˜¯è¿™æ ·çš„ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>01 23 45 67 89 AB CD EF</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è€Œåœ¨å°ç«¯åºä¸­ï¼Œåˆ™ä¼šå­˜å‚¨ä¸ºï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EF CD AB 89 67 45 23 01</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>åœ¨ä¸åŒçš„ç³»ç»Ÿæ¶æ„ä¸­ï¼Œå­—èŠ‚åºå¯èƒ½ä¸åŒã€‚å› æ­¤ï¼Œå½“æ•°æ®åœ¨ä¸åŒæ¶æ„ä¹‹é—´ä¼ è¾“æ—¶ï¼Œéœ€è¦æ­£ç¡®å¤„ç†å­—èŠ‚åºä»¥ç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§ã€‚</p><p><code>buf.swap64()</code> æ–¹æ³•å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œå­˜åœ¨çš„ã€‚å®ƒå¯ä»¥è®©ä½ è½»æ¾åœ°åœ¨æ¥æ”¶åˆ°çš„æ•°æ®å—ä¸­å°†æ¯ 8 ä¸ªå­—èŠ‚çš„é¡ºåºé€†è½¬ï¼Œè¿™é€šå¸¸ç”¨äºä»ä¸€ä¸ªä½¿ç”¨ä¸åŒå­—èŠ‚åºçš„ç³»ç»Ÿæ”¶åˆ°æ•°æ®æ—¶ã€‚</p><p>ä¸‹é¢ä¸¾ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨ <code>buf.swap64()</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥ Node.js çš„ buffer æ¨¡å—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å« 64 ä½æ•´æ•°çš„ Buffer å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª 64 ä½æ•´æ•° 0x0123456789ABCDEF</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨å°ç«¯åºç³»ç»Ÿä¸­ï¼Œå®ƒçš„è¡¨ç¤ºä¼šåƒè¿™æ ·ï¼š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xef</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xcd</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xab</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x89</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x67</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x45</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x23</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x01</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åŸå§‹çš„ buffer:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ buf.swap64() æ–¹æ³•å°†å°ç«¯åºè½¬æ¢ä¸ºå¤§ç«¯åº</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">swap64</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è°ƒç”¨ swap64 åçš„ buffer:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªåŒ…å«ç‰¹å®š 64 ä½æ•´æ•°çš„ Buffer å®ä¾‹ï¼Œç„¶åè°ƒç”¨ <code>buf.swap64()</code> æ–¹æ³•æ¥æ”¹å˜å­—èŠ‚åºã€‚å¦‚æœä½ è¿è¡Œè¿™æ®µä»£ç ï¼Œä½ ä¼šçœ‹åˆ°è¾“å‡ºç»“æœä¸­å­—èŠ‚åºå‘ç”Ÿäº†åè½¬ã€‚</p><p>è¯·æ³¨æ„ï¼Œä½¿ç”¨ <code>buf.swap64()</code> ä¹‹å‰å¿…é¡»ç¡®ä¿ Buffer çš„é•¿åº¦æ˜¯ 8 çš„å€æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå¿…é¡»åŒ…å«å®Œæ•´çš„ 64 ä½æ•´æ•°ã€‚å¦‚æœ Buffer çš„é•¿åº¦ä¸ç¬¦åˆè¿™ä¸ªæ¡ä»¶ï¼ŒNode.js å°†ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p><p>è¿™ä¸ªåŠŸèƒ½åœ¨å¤„ç†ç½‘ç»œé€šä¿¡æˆ–æ–‡ä»¶è¯»å†™æ—¶éå¸¸æœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯å½“ä½ è¿›è¡Œè·¨å¹³å°å¼€å‘æˆ–ä¸å…¶ä»–ä½¿ç”¨ä¸åŒå­—èŠ‚åºæ¶æ„çš„ç³»ç»Ÿäº¤äº’æ•°æ®æ—¶ã€‚é€šè¿‡æ­£ç¡®åœ°å¤„ç†å­—èŠ‚åºï¼Œä½ å¯ä»¥ç¡®ä¿æ•°æ®çš„å‡†ç¡®æ€§å’Œå¯ç§»æ¤æ€§ã€‚</p><h3 id="buf-tojson" tabindex="-1"><a class="header-anchor" href="#buf-tojson"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#buftojson" target="_blank" rel="noopener noreferrer">buf.toJSON()</a></span></a></h3><p><code>buf.toJSON()</code> æ˜¯ Node.js ä¸­ <code>Buffer</code> ç±»çš„ä¸€ä¸ªæ–¹æ³•ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code> ç±»æ˜¯ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ï¼Œæ¯”å¦‚ä»æ–‡ä»¶è¯»å–æ•°æ®æˆ–è€…å¤„ç†ç½‘ç»œè¯·æ±‚æ—¶æ”¶åˆ°çš„æ•°æ®ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šé‡åˆ°æ–‡æœ¬æ•°æ®æˆ–è€…äºŒè¿›åˆ¶æ•°æ®ï¼Œè€Œ <code>Buffer</code> å°±æ˜¯ç”¨äºå¤„ç†è¿™äº›æ•°æ®çš„ä¸€ç§æ–¹å¼ã€‚</p><p><code>buf.toJSON()</code> æ–¹æ³•çš„ä½œç”¨æ˜¯å°† Buffer å¯¹è±¡è½¬æ¢æˆä¸€ä¸ª JSON è¡¨ç¤ºçš„å¯¹è±¡ã€‚å½“ä½ è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œå®ƒè¿”å›çš„å¯¹è±¡ä¼šåŒ…å«ä¸€ä¸ª <code>type</code> å±æ€§ï¼Œè¡¨ç¤ºæ•°æ®ç±»å‹ï¼ˆé€šå¸¸ä¸º &#39;Buffer&#39;ï¼‰ï¼Œå’Œä¸€ä¸ª <code>data</code> å±æ€§ï¼ŒåŒ…å«ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯åŸå§‹çš„å­—èŠ‚å€¼ï¼ˆ0-255 ä¹‹é—´çš„æ•°å­—ï¼‰ã€‚</p><p>è¿™é‡Œä¸¾ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ï¼š</p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€æ®µæ–‡æœ¬ &quot;Hello&quot;ï¼Œåœ¨è®¡ç®—æœºä¸­ï¼Œè¿™æ®µæ–‡æœ¬ä¼šä»¥æŸç§å½¢å¼å­˜å‚¨ä¸ºäºŒè¿›åˆ¶æ•°æ®ã€‚åœ¨ Node.js ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Buffer ç±»æ¥å¤„ç†è¿™æ ·çš„æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å« &quot;Hello&quot; æ–‡æœ¬çš„ Buffer å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ toJSON æ–¹æ³•å°† Buffer è½¬åŒ–ä¸º JSON å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> json</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toJSON</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">json</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œè¿™æ®µä»£ç ï¼Œä½ å°†å¾—åˆ°ç±»ä¼¼ä»¥ä¸‹è¾“å‡ºçš„ç»“æœï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">  &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">  &quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">72</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">101</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">108</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">108</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">111</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒJSON å¯¹è±¡çš„ <code>data</code> æ•°ç»„åŒ…å«äº†å­—ç¬¦ä¸² &quot;Hello&quot; çš„ ASCII ç å€¼ã€‚ä¾‹å¦‚ï¼Œ&#39;H&#39; çš„ ASCII ç æ˜¯ 72ï¼Œ&#39;e&#39; çš„ ASCII ç æ˜¯ 101ï¼Œä¾æ­¤ç±»æ¨ã€‚</p><p>å®é™…åº”ç”¨ä¸­ï¼Œ<code>buf.toJSON()</code> å¾ˆå°‘å•ç‹¬ä½¿ç”¨ï¼Œå› ä¸ºç›´æ¥æ“ä½œäºŒè¿›åˆ¶æ•°æ®æ›´ä¸ºå¸¸è§ã€‚ä¸è¿‡ï¼Œåœ¨éœ€è¦å°† Buffer æ•°æ®ç»“æ„åºåˆ—åŒ–ä¸ºå¯ä»¥é€šè¿‡ç½‘ç»œå‘é€æˆ–å­˜å‚¨çš„æ ¼å¼æ—¶ï¼Œå°†å…¶è½¬æ¢ä¸º JSON å¯¹è±¡å¯èƒ½æ˜¯æœ‰ç”¨çš„ã€‚ç‰¹åˆ«æ˜¯åœ¨è¿›è¡Œè·¨å¹³å°æˆ–è·¨è¯­è¨€çš„é€šä¿¡æ—¶ï¼ŒJSON æ ¼å¼å…·æœ‰è‰¯å¥½çš„å…¼å®¹æ€§å’Œæ˜“äºç†è§£çš„ç‰¹æ€§ã€‚ç„¶è€Œï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä¸ºäº†æ•ˆç‡è€ƒè™‘ï¼Œäººä»¬ä¼šç›´æ¥å‘é€å’Œæ¥æ”¶ Buffer æ•°æ®ï¼Œè€Œä¸ä¼šå…ˆè½¬æ¢ä¸º JSONã€‚</p><h3 id="buf-tostring-encoding-start-end" tabindex="-1"><a class="header-anchor" href="#buf-tostring-encoding-start-end"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#buftostringencoding-start-end" target="_blank" rel="noopener noreferrer">buf.toString([encoding[, start[, end]]])</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘æ¥ç»™ä½ è¯¦ç»†è§£é‡Šä¸€ä¸‹ Node.js ä¸­çš„ <code>buf.toString([encoding[, start[, end]]])</code> æ–¹æ³•ã€‚</p><p>åœ¨ Node.js ä¸­ï¼ŒBuffer æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ç±»ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå°±åƒä¸€ä¸ªå¯ä»¥å­˜æ”¾å¾ˆå¤šå°ç›’å­çš„å¤§ç›’å­ï¼Œæ¯ä¸ªå°ç›’å­é‡Œé¢å¯ä»¥æ”¾å…¥æ•°å­—ï¼Œè¿™äº›æ•°å­—èŒƒå›´é€šå¸¸æ˜¯ 0 åˆ° 255ï¼ˆå³ 8 ä½äºŒè¿›åˆ¶ï¼‰ã€‚Buffer ä¸»è¦ç”¨äºå¤„ç†æ–‡ä»¶ç³»ç»Ÿæ“ä½œã€ç½‘ç»œæ“ä½œç­‰æ¶‰åŠåˆ°äºŒè¿›åˆ¶æ•°æ®æµçš„åœºæ™¯ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬çŸ¥é“äº† Buffer ç”¨æ¥å­˜å‚¨äºŒè¿›åˆ¶æ•°æ®ã€‚ä½†æ˜¯æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æŠŠè¿™äº›äºŒè¿›åˆ¶æ•°æ®è½¬æ¢æˆäººç±»å¯è¯»çš„å½¢å¼ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²ã€‚è¿™å°±æ˜¯ <code>buf.toString()</code> æ–¹æ³•çš„ç”¨é€”ã€‚</p><h3 id="buf-tostring-encoding-start-end-çš„å‚æ•°è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#buf-tostring-encoding-start-end-çš„å‚æ•°è§£é‡Š"><span><code>buf.toString([encoding[, start[, end]]])</code> çš„å‚æ•°è§£é‡Šï¼š</span></a></h3><ol><li><code>encoding</code>ï¼šæŒ‡å®šå­—ç¬¦ç¼–ç ï¼Œé»˜è®¤æ˜¯ &#39;utf8&#39;ã€‚å…¶ä»–å¯èƒ½çš„ç¼–ç åŒ…æ‹¬ &#39;ascii&#39;, &#39;utf16le&#39;, &#39;ucs2&#39;, &#39;base64&#39;, &#39;binary&#39;, &#39;hex&#39; ç­‰ã€‚</li><li><code>start</code>ï¼šæŒ‡å®šå¼€å§‹è½¬æ¢çš„ä½ç½®ï¼Œé»˜è®¤æ˜¯ 0ï¼Œä¹Ÿå°±æ˜¯ä» Buffer çš„å¼€å¤´å¼€å§‹ã€‚</li><li><code>end</code>ï¼šæŒ‡å®šç»“æŸè½¬æ¢çš„ä½ç½®ï¼Œé»˜è®¤æ˜¯ Buffer çš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯è¯´é»˜è®¤æƒ…å†µä¸‹ä¼šè½¬æ¢æ•´ä¸ª Bufferã€‚</li></ol><h3 id="å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­"><span>å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ï¼š</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«æ–‡æœ¬æ•°æ®çš„ Bufferï¼Œæˆ‘ä»¬æƒ³æŠŠå®ƒè½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª Buffer å®ä¾‹ï¼Œé‡Œé¢åŒ…å«äº†ä¸€æ®µæ–‡æœ¬çš„äºŒè¿›åˆ¶æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†æ•´ä¸ª Buffer è½¬æ¢ä¸º UTF-8 ç¼–ç çš„å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fullString</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é»˜è®¤ç¼–ç ä¸º &#39;utf8&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fullString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: Hello World</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åªè½¬æ¢ Buffer ä¸­çš„ä¸€éƒ¨åˆ†ä¸ºå­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> partialString</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">partialString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: Hello</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ä¸åŒçš„ç¼–ç è½¬æ¢ Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hexString</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hexString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 48656c6c6f20576f726c64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ base64 ç¼–ç è½¬æ¢ Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> base64String</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">base64String</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: SGVsbG8gV29ybGQ=</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä»¥ä¸Šä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>buf.toString()</code> æ–¹æ³•çš„çµæ´»æ€§ã€‚ä½ å¯ä»¥é€‰æ‹©æ•´ä¸ª Buffer å¯¹è±¡æˆ–è€… Buffer çš„ä¸€éƒ¨åˆ†æ¥è¿›è¡Œè½¬æ¢ï¼Œå¹¶ä¸”è¿˜èƒ½æŒ‡å®šä¸åŒçš„ç¼–ç æ ¼å¼ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½ä¼šæ ¹æ®éœ€æ±‚å°†ä»æ–‡ä»¶è¯»å–çš„æ•°æ®ã€ç½‘ç»œè¯·æ±‚æ¥æ”¶åˆ°çš„æ•°æ®è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œä»¥æ–¹ä¾¿è¿›è¡Œåç»­å¤„ç†ã€‚</p><h3 id="buf-values" tabindex="-1"><a class="header-anchor" href="#buf-values"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufvalues" target="_blank" rel="noopener noreferrer">buf.values()</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘å¾ˆä¹æ„å¸®åŠ©ä½ ç†è§£ Node.js ä¸­çš„<code>buf.values()</code>æ–¹æ³•ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ä»åŸºç¡€å¼€å§‹ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code>æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ç±»ï¼ˆå¯ä»¥æƒ³è±¡æˆä¸€ä¸ªå¯ä»¥å­˜æ”¾å­—èŠ‚çš„æ•°ç»„ï¼‰ã€‚ä¾‹å¦‚ï¼Œåœ¨è¯»å–æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡æˆ–å¤„ç†å›¾åƒå’Œè§†é¢‘æ•°æ®æ—¶ï¼Œä½ ä¼šç”¨åˆ°<code>Buffer</code>ã€‚</p><p>ç°åœ¨ï¼Œ<code>buf.values()</code>è¿™ä¸ªæ–¹æ³•æ˜¯<code>Buffer</code>ç±»çš„ä¸€ä¸ªå®ä¾‹æ–¹æ³•ã€‚å½“ä½ è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼ˆiteratorï¼‰ï¼Œå…è®¸ä½ éå† Buffer å¯¹è±¡ä¸­çš„æ¯ä¸€ä¸ªå­—èŠ‚ï¼ˆbyteï¼‰ã€‚åœ¨ JavaScript ä¸­ï¼Œè¿­ä»£å™¨æ˜¯ä¸€ç§ç‰¹åˆ«çš„å¯¹è±¡ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªåºåˆ—ï¼Œå¹¶ä¸”æä¾›äº†ä¸€ä¸ªæ¥å£æ¥éå†è¿™ä¸ªåºåˆ—ã€‚</p><p>ä¸‹é¢ï¼Œæˆ‘å°†ç”¨å‡ ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨<code>buf.values()</code>æ–¹æ³•ã€‚</p><p><strong>ä¾‹å­ 1ï¼šåˆ›å»ºä¸€ä¸ª Buffer å¹¶éå†å…¶å€¼</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªBufferå®ä¾‹åŒ…å«ä¸€äº›æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è°ƒç”¨values()æ–¹æ³•è·å–è¿­ä»£å™¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> values</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">values</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨for...ofå¾ªç¯éå†è¿­ä»£å™¨ä¸­çš„å€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> of</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> values</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 2</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 3</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 4</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªåŒ…å«[1, 2, 3, 4]å››ä¸ªå­—èŠ‚çš„ Buffer å¯¹è±¡ã€‚æˆ‘ä»¬è°ƒç”¨<code>buf.values()</code>å¾—åˆ°ä¸€ä¸ªåŒ…å«è¿™äº›å­—èŠ‚çš„è¿­ä»£å™¨ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨<code>for...of</code>å¾ªç¯æ¥è¾“å‡ºæ¯ä¸ªå­—èŠ‚çš„å€¼ã€‚</p><p><strong>ä¾‹å­ 2ï¼šä¿®æ”¹ Buffer å†…å®¹å¹¶ä½¿ç”¨ values()æ£€æŸ¥æ›´æ”¹</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªBufferå®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x20</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x30</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¿®æ”¹Bufferä¸­çš„ç¬¬ä¸€ä¸ªå­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0xff</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–è¿­ä»£å™¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> values</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">values</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// éå†è¿­ä»£å™¨ä¸­çš„å€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> of</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> values</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 255</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 32</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 48</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ Buffer å®ä¾‹ï¼Œå¹¶ä¿®æ”¹äº†å…¶ä¸­ä¸€ä¸ªå­—èŠ‚çš„å€¼ã€‚ç„¶åï¼Œæˆ‘ä»¬å†æ¬¡ä½¿ç”¨<code>buf.values()</code>æ¥è·å–ä¸€ä¸ªè¿­ä»£å™¨å¹¶éå†è¯¥ Buffer å¯¹è±¡çš„å­—èŠ‚ï¼Œæ‰“å°å‡ºæ¥å¯ä»¥çœ‹åˆ°æ›´æ”¹åçš„å€¼ã€‚</p><p>æ€»ä¹‹ï¼Œ<code>buf.values()</code>æ–¹æ³•æ˜¯ Buffer å¯¹è±¡æä¾›ç»™ä½ çš„ä¸€ç§æ–¹ä¾¿çš„æ–¹å¼å»æŒ‰é¡ºåºè®¿é—®é‡Œé¢çš„å­—èŠ‚ï¼Œç‰¹åˆ«æ˜¯å½“ä½ éœ€è¦å¯¹æ•°æ®è¿›è¡Œè¿­ä»£æ“ä½œæ—¶ã€‚è®°ä½ï¼Œç”±äº Buffer ä¸»è¦å¤„ç†çš„æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œæ‰€ä»¥è¿™é‡Œçš„å€¼å°†æ˜¯ 0~255 ä¹‹é—´çš„æ•´æ•°ï¼Œå¯¹åº”äºäºŒè¿›åˆ¶æ•°æ®çš„å„ä¸ªå­—èŠ‚ã€‚</p><h3 id="buf-write-string-offset-length-encoding" tabindex="-1"><a class="header-anchor" href="#buf-write-string-offset-length-encoding"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwritestring-offset-length-encoding" target="_blank" rel="noopener noreferrer">buf.write(string[, offset[, length]][, encoding])</a></span></a></h3><p>Node.js ä¸­çš„ <code>Buffer</code> æ˜¯ä¸€ä¸ªç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ç±»ï¼Œå¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€æ®µå†…å­˜ç©ºé—´ã€‚åœ¨å¤„ç† TCP æµæˆ–æ–‡ä»¶æ—¶ï¼Œä½ ä¼šé¢‘ç¹åœ°ä¸ <code>Buffer</code> æ‰“äº¤é“ã€‚</p><p>å½“ä½ éœ€è¦æŠŠä¸€ä¸ªå­—ç¬¦ä¸²å†™å…¥åˆ°ä¸€ä¸ª Buffer ä¸­æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>buf.write()</code> æ–¹æ³•ã€‚ä¸‹é¢æˆ‘å°†é€æ­¥è§£é‡Šè¿™ä¸ªæ–¹æ³•çš„å‚æ•°å’Œç”¨æ³•ï¼Œå¹¶ç»™å‡ºå®é™…çš„ä¾‹å­ã€‚</p><h3 id="å‚æ•°è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯´æ˜"><span>å‚æ•°è¯´æ˜</span></a></h3><ol><li><code>string</code>ï¼šè¿™æ˜¯ä½ æƒ³è¦å†™å…¥ buffer çš„æ–‡æœ¬å†…å®¹ã€‚</li><li><code>offset</code>ï¼ˆå¯é€‰ï¼‰ï¼šè¿™æ˜¯æŒ‡ä½ æƒ³ä» buffer çš„å“ªä¸ªä½ç½®å¼€å§‹å†™å…¥æ•°æ®ï¼Œé»˜è®¤å€¼æ˜¯ 0ï¼Œå³ä» buffer çš„å¼€å¤´å¼€å§‹ã€‚</li><li><code>length</code>ï¼ˆå¯é€‰ï¼‰ï¼šè¿™æ˜¯æŒ‡ä½ æƒ³è¦å†™å…¥çš„æœ€å¤§å­—èŠ‚æ•°ï¼Œå¦‚æœæ²¡æœ‰è®¾å®šè¿™ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆå°±ä¼šå†™å…¥æ•´ä¸ªå­—ç¬¦ä¸²ã€‚</li><li><code>encoding</code>ï¼ˆå¯é€‰ï¼‰ï¼šè¿™æ˜¯æŒ‡å­—ç¬¦ä¸²çš„ç¼–ç æ ¼å¼ï¼Œé»˜è®¤æ˜¯ <code>&#39;utf8&#39;</code>ï¼Œå…¶ä»–å¸¸è§çš„è¿˜æœ‰ <code>&#39;ascii&#39;</code>, <code>&#39;utf16le&#39;</code>, <code>&#39;ucs2&#39;</code>, <code>&#39;base64&#39;</code> æˆ–è€… <code>&#39;hex&#39;</code>ã€‚</li></ol><h3 id="ä½¿ç”¨ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­-5"><span>ä½¿ç”¨ä¾‹å­</span></a></h3><h4 id="ç¤ºä¾‹-1-åŸºç¡€å†™å…¥" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åŸºç¡€å†™å…¥"><span>ç¤ºä¾‹ 1ï¼šåŸºç¡€å†™å…¥</span></a></h4><p>å‡è®¾ä½ æƒ³åœ¨ä¸€ä¸ª Buffer ä¸­å†™å…¥ &quot;Hello World&quot; è¿™ä¸ªå­—ç¬¦ä¸²ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">11</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª 11 å­—èŠ‚é•¿çš„ buffer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ buffer ä¸­å†™å…¥å­—ç¬¦ä¸² &quot;Hello World&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// `&lt;`Buffer 48 65 6c 6c 6f 20 57 6f 72 6c 64&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º 11 å­—èŠ‚çš„æ–° Bufferï¼ˆå› ä¸º &quot;Hello World&quot; å­—ç¬¦ä¸²æ­£å¥½æ˜¯ 11 ä¸ªå­—ç¬¦ï¼‰ï¼Œç„¶åä½¿ç”¨ <code>write()</code> æ–¹æ³•å†™å…¥å­—ç¬¦ä¸²ã€‚ç”±äºæˆ‘ä»¬æ²¡æœ‰æŒ‡å®š <code>offset</code> å’Œ <code>length</code>ï¼Œæ‰€ä»¥å®ƒä¼šä»ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ˆbuffer å¼€å¤´ï¼‰å¼€å§‹å†™å…¥ï¼Œç›´åˆ°å­—ç¬¦ä¸²ç»“æŸã€‚</p><h4 id="ç¤ºä¾‹-2-æŒ‡å®šåç§»é‡å†™å…¥" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æŒ‡å®šåç§»é‡å†™å…¥"><span>ç¤ºä¾‹ 2ï¼šæŒ‡å®šåç§»é‡å†™å…¥</span></a></h4><p>å¦‚æœä½ åªæƒ³ä» <code>Buffer</code> çš„ç‰¹å®šä½ç½®å¼€å§‹å†™ï¼Œå¯ä»¥è®¾ç½® <code>offset</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª 20 å­—èŠ‚é•¿çš„ buffer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ buffer å¼€å¤´å†™å…¥ &quot;Hello&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä» buffer çš„ç¬¬ 6 ä¸ªå­—èŠ‚å¼€å§‹å†™å…¥ &quot;World&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: HelloWorld</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ›´é•¿çš„ Bufferï¼Œå¹¶ä¸”é€šè¿‡è®¾ç½® <code>offset</code>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Buffer çš„ä¸åŒä½ç½®å†™å…¥ä¸åŒçš„å­—ç¬¦ä¸²ã€‚</p><h4 id="ç¤ºä¾‹-3-é™åˆ¶å†™å…¥é•¿åº¦" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-é™åˆ¶å†™å…¥é•¿åº¦"><span>ç¤ºä¾‹ 3ï¼šé™åˆ¶å†™å…¥é•¿åº¦</span></a></h4><p>æœ‰æ—¶å€™ä½ å¯èƒ½ä¸å¸Œæœ›å†™å…¥æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™æ—¶å¯ä»¥è®¾ç½® <code>length</code> å‚æ•°æ¥é™åˆ¶å†™å…¥é•¿åº¦ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª 10 å­—èŠ‚é•¿çš„ buffer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;HelloWorld&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»…å†™å…¥ &quot;HelloWorld&quot; çš„å‰äº”ä¸ªå­—ç¬¦ &quot;Hello&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: Hello</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™é‡Œ <code>length</code> è¢«è®¾ç½®ä¸º 5ï¼Œå› æ­¤å³ä½¿åŸå§‹å­—ç¬¦ä¸²æ¯” buffer é•¿ï¼Œä¹Ÿåªæœ‰ &quot;Hello&quot; è¢«å†™å…¥ bufferã€‚</p><h3 id="ç»“è¯­" tabindex="-1"><a class="header-anchor" href="#ç»“è¯­"><span>ç»“è¯­</span></a></h3><p><code>buf.write()</code> æ˜¯ Node.js ç¼–ç¨‹ä¸­ç”¨äºå°†å­—ç¬¦ä¸²æ•°æ®å†™å…¥åˆ° Buffer ä¸­çš„åŸºæœ¬æ–¹æ³•ã€‚é€šè¿‡æ­£ç¡®åœ°ä½¿ç”¨ <code>offset</code>, <code>length</code> å’Œ <code>encoding</code> å‚æ•°ï¼Œä½ å¯ä»¥ç²¾ç¡®æ§åˆ¶å¦‚ä½•ä»¥åŠå“ªäº›æ•°æ®å†™å…¥ Bufferã€‚è¿™åœ¨å¤„ç†ç½‘ç»œé€šä¿¡ã€æ–‡ä»¶æ“ä½œç­‰æ¶‰åŠå¤§é‡äºŒè¿›åˆ¶æ•°æ®çš„åœºæ™¯ä¸­éå¸¸æœ‰ç”¨ã€‚</p><h3 id="buf-writebigint64be-value-offset" tabindex="-1"><a class="header-anchor" href="#buf-writebigint64be-value-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwritebigint64bevalue-offset" target="_blank" rel="noopener noreferrer">buf.writeBigInt64BE(value[, offset])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘æ¥è§£é‡Šä¸€ä¸‹ <code>buf.writeBigInt64BE(value[, offset])</code> è¿™ä¸ªæ–¹æ³•åœ¨ Node.js ä¸­æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼ŒåŒæ—¶ä¼šç»™ä½ ä¸¾ä¸€äº›å®é™…çš„ä¾‹å­ã€‚</p><p>é¦–å…ˆï¼Œ<code>Buffer</code> åœ¨ Node.js ä¸­æ˜¯ä¸€ä¸ªéå¸¸åŸºç¡€ä¹Ÿå¾ˆé‡è¦çš„æ¨¡å—ã€‚å®ƒç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµï¼Œåƒæ˜¯ä»æ–‡ä»¶è¯»å–çš„æ•°æ®æˆ–è€…ç½‘ç»œä¼ è¾“çš„æ•°æ®ã€‚</p><p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹ <code>buf.writeBigInt64BE(value[, offset])</code> è¿™ä¸ªæ–¹æ³•ï¼š</p><ul><li><code>writeBigInt64BE</code> æ˜¯ <code>Buffer</code> ç±»é‡Œé¢çš„ä¸€ä¸ªæ–¹æ³•ã€‚</li><li><code>value</code> å‚æ•°ä»£è¡¨ä½ æƒ³å†™å…¥ç¼“å†²åŒºçš„ 64 ä½ bigint å€¼ã€‚</li><li><code>offset</code> å‚æ•°æ˜¯å¯é€‰çš„ï¼Œè¡¨ç¤ºä» Buffer å¯¹è±¡å¼€å§‹çš„å“ªä¸ªä½ç½®ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰å¼€å§‹å†™å…¥è¿™ä¸ªå€¼ã€‚å¦‚æœä¸æŒ‡å®š <code>offset</code>ï¼Œé»˜è®¤ä» 0 å¼€å§‹ã€‚</li><li><code>BE</code> ä»£è¡¨ Big-Endianï¼ˆå¤§ç«¯åºï¼‰ï¼Œæ„æ€æ˜¯æœ€é«˜æœ‰æ•ˆå­—èŠ‚ï¼ˆthe most significant byteï¼‰åœ¨å‰é¢ã€‚å¯¹äºåŒæ ·çš„æ•°å­—ï¼Œå¤§ç«¯åºå’Œå°ç«¯åºåœ¨å†…å­˜ä¸­çš„è¡¨ç¤ºæ˜¯ä¸åŒçš„ã€‚</li></ul><p>ç°åœ¨æ¥ä¸¾å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><h3 id="ç¤ºä¾‹-1-å†™å…¥ä¸€ä¸ª-bigint-åˆ°-buffer-å¹¶ä¸”ä¸æŒ‡å®šåç§»é‡" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-å†™å…¥ä¸€ä¸ª-bigint-åˆ°-buffer-å¹¶ä¸”ä¸æŒ‡å®šåç§»é‡"><span>ç¤ºä¾‹ 1: å†™å…¥ä¸€ä¸ª BigInt åˆ° Buffer å¹¶ä¸”ä¸æŒ‡å®šåç§»é‡</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªè¶³å¤Ÿå¤§çš„ Buffer æ¥å­˜æ”¾ä¸€ä¸ª 64 ä½çš„ BigIntï¼ˆ8 å­—èŠ‚ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¦å†™å…¥çš„ BigInt å€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bigIntValue</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1234567890123456789</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">n</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ writeBigInt64BE æ–¹æ³•å°† BigInt å€¼ä»¥å¤§ç«¯åºæ ¼å¼å†™å…¥åˆ° Buffer ä¸­</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeBigInt64BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bigIntValue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºçš„ Buffer å°†åŒ…å« bigIntValue çš„å­—èŠ‚è¡¨ç¤º</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç¤ºä¾‹-2-æŒ‡å®šåç§»é‡å†™å…¥-1" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æŒ‡å®šåç§»é‡å†™å…¥-1"><span>ç¤ºä¾‹ 2: æŒ‡å®šåç§»é‡å†™å…¥</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªè¶³å¤Ÿå¤§çš„ Bufferï¼ˆæ¯”å¦‚è¯´16å­—èŠ‚ï¼Œå¯ä»¥å­˜ä¸¤ä¸ª64ä½çš„BigIntï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¦å†™å…¥çš„ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ª BigInt å€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> firstBigIntValue</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1234567890123456789</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">n</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secondBigIntValue</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9876543210987654321</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">n</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é¦–å…ˆå†™å…¥ç¬¬ä¸€ä¸ªå€¼ï¼Œä¸æŒ‡å®šåç§»é‡ï¼Œé»˜è®¤æ˜¯ä»0å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeBigInt64BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">firstBigIntValue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç„¶åå†™å…¥ç¬¬äºŒä¸ªå€¼ï¼ŒæŒ‡å®šåç§»é‡ä¸º8ï¼Œå› ä¸ºå‰ä¸€ä¸ªBigIntå·²ç»å ç”¨äº†å‰8ä¸ªå­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeBigInt64BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secondBigIntValue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºçš„ Buffer å°†å…ˆåŒ…å« firstBigIntValue çš„å­—èŠ‚è¡¨ç¤ºï¼Œç„¶åæ˜¯ secondBigIntValue çš„å­—èŠ‚è¡¨ç¤º</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä»¥ä¸Šç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ° <code>writeBigInt64BE</code> æ–¹æ³•å¦‚ä½•ç”¨æ¥å‘ Buffer å†™å…¥ 64 ä½çš„ BigInt æ•°æ®ï¼Œå¹¶é€šè¿‡æŒ‡å®š offset æ§åˆ¶å†™å…¥ä½ç½®ã€‚è®°ä½ï¼ŒNode.js çš„ Buffer é»˜è®¤ä½¿ç”¨ Big-Endian æ ¼å¼æ¥å¤„ç†å¤šå­—èŠ‚æ•°æ®ç±»å‹ï¼Œè¿™ç¬¦åˆç½‘ç»œåè®®å’Œè®¸å¤šæ“ä½œç³»ç»Ÿçš„å†…éƒ¨è¡¨ç¤ºã€‚</p><h3 id="buf-writebigint64le-value-offset" tabindex="-1"><a class="header-anchor" href="#buf-writebigint64le-value-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwritebigint64levalue-offset" target="_blank" rel="noopener noreferrer">buf.writeBigInt64LE(value[, offset])</a></span></a></h3><p><code>buf.writeBigInt64LE(value[, offset])</code> æ˜¯ Node.js ä¸­ <code>Buffer</code> ç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºå°†ä¸€ä¸ª 64-bit (8 å­—èŠ‚) çš„æ•´æ•°ä»¥å°ç«¯å­—èŠ‚åºï¼ˆLittle-Endianï¼‰æ ¼å¼å†™å…¥åˆ°ç¼“å†²åŒºï¼ˆbufferï¼‰ä¸­ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code>æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„å…¨å±€å¯¹è±¡ã€‚</p><p>è®©æˆ‘ä»¬æ‹†åˆ†è¿™ä¸ªæ–¹æ³•æ¥ç†è§£æ¯ä¸ªéƒ¨åˆ†ï¼š</p><ol><li><p><code>writeBigInt64LE</code>ï¼šè¿™ä¸ªæ–¹æ³•ååŒ…å«å‡ éƒ¨åˆ†ä¿¡æ¯ã€‚</p><ul><li><code>write</code> è¡¨ç¤ºæˆ‘ä»¬è¦å°†æ•°æ®å†™å…¥ç¼“å†²åŒºã€‚</li><li><code>BigInt64</code> è¡¨ç¤ºæˆ‘ä»¬æƒ³è¦å†™å…¥çš„æ•°æ®ç±»å‹æ˜¯ä¸€ä¸ª 64-bit å¤§çš„ BigInt ç±»å‹çš„æ•´æ•°ã€‚</li><li><code>LE</code> ä»£è¡¨ Little-Endianï¼Œè¯´æ˜æ•°å­—çš„æœ€ä½æœ‰æ•ˆå­—èŠ‚ï¼ˆLeast Significant Byteï¼‰å‚¨å­˜åœ¨å†…å­˜çš„èµ·å§‹ä½ç½®ï¼Œå³å°ç«¯æ¨¡å¼ã€‚</li></ul></li><li><p><code>value</code>ï¼šè¿™ä¸ªå‚æ•°æ˜¯ä½ æƒ³è¦å†™å…¥ç¼“å†²åŒºçš„å…·ä½“æ•°å€¼ï¼Œå®ƒå¿…é¡»æ˜¯ä¸€ä¸ª BigInt ç±»å‹çš„æ•´æ•°ã€‚åœ¨ JavaScript ä¸­ï¼ŒBigInt æ˜¯ä¸€ç§å¯ä»¥è¡¨ç¤ºéå¸¸å¤§çš„æ•´æ•°çš„åŸå§‹æ•°æ®ç±»å‹ã€‚</p></li><li><p><code>offset</code>ï¼šè¿™ä¸ªå¯é€‰å‚æ•°è¡¨ç¤ºä»ç¼“å†²åŒºçš„å“ªä¸ªä½ç½®å¼€å§‹å†™å…¥è¿™ä¸ªæ•°å€¼ã€‚å¦‚æœçœç•¥æ­¤å‚æ•°ï¼Œé»˜è®¤ä»ç¼“å†²åŒºçš„èµ·å§‹ä½ç½®ï¼ˆ0 ç´¢å¼•å¤„ï¼‰å¼€å§‹å†™å…¥ã€‚</p></li></ol><p>ç°åœ¨ï¼Œè®©æˆ‘ä¸¾å‡ ä¸ªä¾‹å­æ¥å±•ç¤ºå¦‚ä½•ä½¿ç”¨ <code>writeBigInt64LE</code> æ–¹æ³•ã€‚</p><h3 id="ç¤ºä¾‹ä¸€-åŸºæœ¬ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä¸€-åŸºæœ¬ç”¨æ³•"><span>ç¤ºä¾‹ä¸€ï¼šåŸºæœ¬ç”¨æ³•</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º8å­—èŠ‚çš„ç¼“å†²åŒº</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bigIntValue</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1234567890123456789</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">n</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®šä¹‰ä¸€ä¸ª BigInt å€¼</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†bigIntValueå†™å…¥ç¼“å†²åŒºï¼Œä»ç¬¬0ä½å¼€å§‹ï¼ˆé»˜è®¤ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeBigInt64LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bigIntValue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ª 8 å­—èŠ‚å¤§å°çš„ç¼“å†²åŒºã€‚ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª BigInt ç±»å‹çš„æ•°å€¼ <code>bigIntValue</code>ã€‚æ¥ç€ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>writeBigInt64LE</code> æ–¹æ³•å°†è¿™ä¸ªæ•°å€¼å†™å…¥åˆ°ç¼“å†²åŒºä¸­ï¼Œå¹¶ä¸”æ‰“å°å‡ºç¼“å†²åŒºçš„å†…å®¹ã€‚</p><h3 id="ç¤ºä¾‹äºŒ-å¸¦åç§»é‡çš„å†™å…¥" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹äºŒ-å¸¦åç§»é‡çš„å†™å…¥"><span>ç¤ºä¾‹äºŒï¼šå¸¦åç§»é‡çš„å†™å…¥</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º16å­—èŠ‚çš„ç¼“å†²åŒº</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bigIntValue1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1234567890123456789</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">n</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bigIntValue2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1234567890123456789</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">n</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†bigIntValue1å†™å…¥ç¼“å†²åŒºï¼Œä»ç¬¬0ä½å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeBigInt64LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bigIntValue1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†bigIntValue2å†™å…¥ç¼“å†²åŒºï¼Œä»ç¬¬8ä½å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeBigInt64LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bigIntValue2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ›´å¤§çš„ç¼“å†²åŒºï¼Œå¤§å°ä¸º 16 å­—èŠ‚ã€‚æˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ª BigInt ç±»å‹çš„æ•°å€¼ <code>bigIntValue1</code> å’Œ <code>bigIntValue2</code>ï¼Œä¸€ä¸ªä¸ºæ­£æ•°ï¼Œå¦ä¸€ä¸ªä¸ºè´Ÿæ•°ã€‚æ¥ç€ï¼Œæˆ‘ä»¬åˆ†åˆ«å°†è¿™ä¸¤ä¸ªæ•°å€¼å†™å…¥ç¼“å†²åŒºçš„ä¸åŒä½ç½®ï¼Œç¬¬ä¸€ä¸ªæ•°å€¼ä»ç´¢å¼• 0 å¼€å§‹ï¼Œç¬¬äºŒä¸ªæ•°å€¼ä»ç´¢å¼• 8 å¼€å§‹ã€‚</p><p>è¿™äº›ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>writeBigInt64LE</code> æ–¹æ³•å‘ç¼“å†²åŒºå†™å…¥å¤§æ•´æ•°ï¼Œå¹¶ä¸”æŒ‡å®šå†™å…¥çš„èµ·å§‹ä½ç½®ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™å¯èƒ½ç”¨äºç½‘ç»œé€šä¿¡æˆ–æ–‡ä»¶æ“ä½œç­‰åœºæ™¯ï¼Œå½“éœ€è¦å°†å¤§æ•´æ•°ç²¾ç¡®åœ°ç¼–ç è‡³æŸä¸ªäºŒè¿›åˆ¶æ ¼å¼å¹¶ç¡®ä¿è·¨å¹³å°å…¼å®¹æ€§æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚</p><h3 id="buf-writebiguint64be-value-offset" tabindex="-1"><a class="header-anchor" href="#buf-writebiguint64be-value-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwritebiguint64bevalue-offset" target="_blank" rel="noopener noreferrer">buf.writeBigUInt64BE(value[, offset])</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­ <code>buf.writeBigUInt64BE(value[, offset])</code> è¿™ä¸ªæ–¹æ³•ã€‚åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç™½å‡ ä¸ªæ¦‚å¿µï¼š</p><ol><li><p>Bufferï¼šåœ¨ Node.js ä¸­ï¼ŒBuffer æ˜¯ä¸€ä¸ªç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ç±»ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ å¤„ç†åƒ TCP æµæˆ–æ–‡ä»¶ç³»ç»Ÿæ“ä½œç­‰åœºæ™¯ä¸­çš„åŸå§‹æ•°æ®ã€‚</p></li><li><p>Big-endianï¼ˆå¤§ç«¯åºï¼‰ï¼šè¿™æ˜¯ä¸€ç§å­˜å‚¨æˆ–ä¼ è¾“äºŒè¿›åˆ¶æ•°æ®çš„æ–¹å¼ã€‚åœ¨å¤§ç«¯åºä¸­ï¼Œæœ€é«˜æœ‰æ•ˆå­—èŠ‚ï¼ˆbiggest endï¼‰è¢«å­˜å‚¨åœ¨æœ€ä½çš„å†…å­˜åœ°å€ä¸Šã€‚</p></li></ol><p>ç°åœ¨æ¥çœ‹ <code>buf.writeBigUInt64BE(value[, offset])</code> è¿™ä¸ªæ–¹æ³•ï¼š</p><ul><li><code>value</code>ï¼šè¦å†™å…¥ buffer çš„ 64 ä½æ— ç¬¦å·æ•´æ•°ï¼ˆå³æ­£æ•´æ•°ï¼ŒåŒ…æ‹¬ 0ï¼‰ã€‚</li><li><code>offset</code>ï¼šå¯é€‰å‚æ•°ï¼ŒæŒ‡å®šä» buffer çš„å“ªä¸ªä½ç½®å¼€å§‹å†™å…¥ valueã€‚å¦‚æœä¸æä¾›ï¼Œåˆ™é»˜è®¤ä» 0 å¼€å§‹ã€‚</li></ul><p>è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯åœ¨ buffer ä¸­æŒ‰ç…§ big-endianï¼ˆå¤§ç«¯åºï¼‰çš„é¡ºåºå†™å…¥ä¸€ä¸ª 64 ä½çš„æ— ç¬¦å·æ•´æ•°ã€‚è¿™æ„å‘³ç€æ•°å­—çš„æœ€é«˜æœ‰æ•ˆå­—èŠ‚ä¼šè¢«æ”¾ç½®åœ¨æŒ‡å®šåç§»é‡çš„å¼€å§‹å¤„ã€‚</p><p>è®©æˆ‘ä»¬é€šè¿‡ä¸€äº›å®é™…çš„ä¾‹å­æ¥ç†è§£è¿™ä¸ªæ–¹æ³•çš„ä½¿ç”¨ï¼š</p><h3 id="ä¾‹å­-1-åŸºæœ¬çš„å†™å…¥" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-åŸºæœ¬çš„å†™å…¥"><span>ä¾‹å­ 1: åŸºæœ¬çš„å†™å…¥</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 8 å­—èŠ‚çš„ bufferï¼ˆå› ä¸º 64 ä½æ­£å¥½æ˜¯ 8 å­—èŠ‚ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0x1234567890abcdef</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">n</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®šä¹‰ä¸€ä¸ªå¤§æ•´æ•°ï¼Œåç¼€ &#39;n&#39; è¡¨ç¤ºè¿™æ˜¯ BigInt ç±»å‹</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeBigUInt64BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†è¿™ä¸ªå€¼ä»¥å¤§ç«¯åºå†™å…¥ buffer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå¯èƒ½ä¼šæ˜¯ï¼š`&lt;`Buffer 12 34 56 78 90 ab cd ef&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™è¡¨ç¤º buffer ä¸­çš„æ¯ä¸ªå­—èŠ‚éƒ½æŒ‰å¤§ç«¯åºæ’åˆ—</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä¾‹å­-2-ä½¿ç”¨-offset-å‚æ•°" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ä½¿ç”¨-offset-å‚æ•°"><span>ä¾‹å­ 2: ä½¿ç”¨ offset å‚æ•°</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 16 å­—èŠ‚çš„ buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0x1234567890abcdef</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">n</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŒæ ·çš„å¤§æ•´æ•°å€¼</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeBigUInt64BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä» buffer çš„ç¬¬ 4 å­—èŠ‚å¼€å§‹å†™å…¥ value</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå¯èƒ½ä¼šæ˜¯ï¼š`&lt;`Buffer 00 00 00 00 12 34 56 78 90 ab cd ef 00 00 00 00&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ³¨æ„ 64 ä½çš„å€¼æ˜¯ä»ç¬¬ 5 ä¸ªå­—èŠ‚å¼€å§‹çš„ï¼ˆç´¢å¼•ä¸º 4ï¼Œå› ä¸ºç´¢å¼•æ˜¯ä» 0 å¼€å§‹çš„ï¼‰</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åº”ç”¨åœºæ™¯å¯èƒ½åŒ…æ‹¬ï¼šå½“ä½ å¤„ç†ç½‘ç»œåè®®ã€äºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼æˆ–è€…å…¶ä»–éœ€è¦ä¸¥æ ¼çš„äºŒè¿›åˆ¶æ•°æ®å¸ƒå±€æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•å°±ç‰¹åˆ«æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½éœ€è¦å‘ä¸€ä¸ªç½‘ç»œæœåŠ¡å‘é€ä¸€ä¸ªæ¶ˆæ¯ï¼Œè¯¥æ¶ˆæ¯éœ€è¦å«æœ‰ä¸€ä¸ªç‰¹å®šå¤§å°çš„æ•´æ•°ä½œä¸ºæ¶ˆæ¯çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”è¿™ä¸ªæ•´æ•°å¿…é¡»ä»¥å¤§ç«¯åºæ ¼å¼å‘é€ã€‚</p><p>å¸Œæœ›è¿™äº›è§£é‡Šå’Œä¾‹å­èƒ½å¤Ÿå¸®åŠ©ä½ ç†è§£ <code>buf.writeBigUInt64BE(value[, offset])</code> æ–¹æ³•çš„ä½œç”¨å’Œå¦‚ä½•ä½¿ç”¨ã€‚</p><h3 id="buf-writebiguint64le-value-offset" tabindex="-1"><a class="header-anchor" href="#buf-writebiguint64le-value-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwritebiguint64levalue-offset" target="_blank" rel="noopener noreferrer">buf.writeBigUInt64LE(value[, offset])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥è°ˆè°ˆ Node.js ä¸­çš„ <code>buf.writeBigUInt64LE(value[, offset])</code> å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°æ˜¯åœ¨ Buffer ç±»ä¸­å®šä¹‰çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºå°†ä¸€ä¸ªå¤§æ•´æ•°ï¼ˆBig Unsigned Integerï¼Œä¹Ÿå°±æ˜¯éè´Ÿå¹¶ä¸”å¯èƒ½éå¸¸å¤§çš„æ•´æ•°ï¼‰ä»¥å°ç«¯æ ¼å¼ï¼ˆLittle-Endianï¼‰å†™å…¥åˆ° Buffer å¯¹è±¡ä¸­ã€‚</p><p>å…ˆæ¥è§£é‡Šä¸‹è¿™é‡Œçš„å‡ ä¸ªå…³é”®æ¦‚å¿µï¼š</p><ol><li><p><strong>Buffer</strong>: åœ¨ Node.js ä¸­ï¼ŒBuffer æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ç±»ã€‚å½“ä½ è¦å¤„ç†æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡ç­‰æ¶‰åŠäºŒè¿›åˆ¶æ•°æ®çš„åœºæ™¯æ—¶ï¼Œç»å¸¸ä¼šç”¨åˆ° Bufferã€‚</p></li><li><p><strong>å¤§æ•´æ•° (BigUInt64)</strong>: JavaScript æ ‡å‡†å†…ç½®å¯¹è±¡ BigInt å…è®¸ä½ å®‰å…¨åœ°å­˜å‚¨å’Œæ“ä½œå¤§æ•´æ•°ï¼Œå³ä½¿è¿™äº›æ•°å­—è¶…å‡ºäº† Number ç±»å‹èƒ½å¤Ÿè¡¨ç¤ºçš„èŒƒå›´ã€‚åœ¨è¿™ä¸ªæ–¹æ³•çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬å¯¹å¾…çš„æ˜¯ 64 ä½æ— ç¬¦å·å¤§æ•´æ•°ã€‚</p></li><li><p><strong>å°ç«¯ (Little-Endian)</strong>: åœ¨äºŒè¿›åˆ¶æ•°æ®ä¸­ï¼Œå°ç«¯æ–¹å¼è¡¨ç¤ºæœ€ä½æœ‰æ•ˆå­—èŠ‚ä½äºæœ€å‰é¢çš„ä½ç½®ã€‚ä¸ä¹‹ç›¸å¯¹çš„æ˜¯å¤§ç«¯ï¼ˆBig-Endianï¼‰ï¼Œå…¶ä¸­æœ€é«˜æœ‰æ•ˆå­—èŠ‚æ’åœ¨æœ€å‰é¢ã€‚ä¸åŒçš„è®¡ç®—æœºæ¶æ„å¯èƒ½ä¼šä½¿ç”¨ä¸åŒçš„å­—èŠ‚åºï¼Œè€Œå°ç«¯æ˜¯ Intel å¤„ç†å™¨åŠå…¼å®¹å¤„ç†å™¨ä¸­çš„æ ‡å‡†ã€‚</p></li></ol><p>å¥½ï¼Œç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ <code>buf.writeBigUInt64LE()</code> æ–¹æ³•ï¼Œå¹¶ç»™å‡ºä¸€äº›å®é™…çš„ä¾‹å­ã€‚</p><h3 id="ä½¿ç”¨æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•"><span>ä½¿ç”¨æ–¹æ³•:</span></a></h3><p><code>buf.writeBigUInt64LE(value[, offset])</code></p><ul><li><code>value</code>: è¿™æ˜¯ä½ æƒ³å†™å…¥ Buffer çš„å¤§æ•´æ•°ã€‚</li><li><code>offset</code> (å¯é€‰): è¿™æ˜¯å¼€å§‹å†™å…¥æ•°æ®åˆ° Buffer çš„èµ·å§‹ä½ç½®çš„ç´¢å¼•ã€‚é»˜è®¤å€¼æ˜¯ <code>0</code>ã€‚</li></ul><h3 id="ä¾‹å­-1-å†™å…¥å¤§æ•´æ•°åˆ°-buffer" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-å†™å…¥å¤§æ•´æ•°åˆ°-buffer"><span>ä¾‹å­ 1ï¼šå†™å…¥å¤§æ•´æ•°åˆ° Buffer</span></a></h3><p>å‡è®¾ä½ æƒ³å°†ä¸€ä¸ªå¤§æ•´æ•° <code>12345678901234567890n</code> å†™å…¥ä¸€ä¸ª Buffer ä¸­ã€‚è¿™é‡Œçš„ <code>n</code> è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª BigInt ç±»å‹çš„æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º 8 å­—èŠ‚çš„ buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bigIntValue</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 12345678901234567890</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">n</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeBigUInt64LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bigIntValue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå¯èƒ½ä¼šåƒè¿™æ ·ï¼š`&lt;`Buffer 02 b7 9e e6 fc d8 29 01&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªå¤§å°ä¸º 8 å­—èŠ‚çš„æ–° Bufferï¼Œå› ä¸ºä¸€ä¸ª 64 ä½çš„æ•´æ•°æ­£å¥½éœ€è¦ 8 å­—èŠ‚çš„ç©ºé—´ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>writeBigUInt64LE</code> æ–¹æ³•å°† <code>bigIntValue</code> å†™å…¥ Bufferã€‚</p><h3 id="ä¾‹å­-2-æŒ‡å®š-offset-å†™å…¥å¤§æ•´æ•°" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-æŒ‡å®š-offset-å†™å…¥å¤§æ•´æ•°"><span>ä¾‹å­ 2ï¼šæŒ‡å®š Offset å†™å…¥å¤§æ•´æ•°</span></a></h3><p>å¦‚æœä½ æƒ³åœ¨ Buffer çš„ç‰¹å®šä½ç½®å¼€å§‹å†™å…¥æ•°æ®ï¼Œå¯ä»¥æä¾›ä¸€ä¸ª offsetã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º 16 å­—èŠ‚çš„ buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bigIntValue</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 12345678901234567890</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">n</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> offset</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬å°†ä»ç¬¬ 5 ä¸ªå­—èŠ‚çš„ä½ç½®å¼€å§‹å†™å…¥</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeBigUInt64LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bigIntValue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">offset</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå¯èƒ½ä¼šåƒè¿™æ ·ï¼š`&lt;`Buffer 00 00 00 00 02 b7 9e e6 fc d8 29 01 00 00 00 00&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ¬¡æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ›´å¤§çš„ Bufferï¼Œè€Œä¸”æˆ‘ä»¬æŒ‡å®šä»ç¬¬ 5 ä¸ªå­—èŠ‚ï¼ˆç´¢å¼•ä¸º 4ï¼‰å¼€å§‹å†™å…¥æˆ‘ä»¬çš„å¤§æ•´æ•°ã€‚æ³¨æ„ï¼ŒBuffer çš„ç´¢å¼•æ˜¯ä» 0 å¼€å§‹çš„ã€‚åœ¨è¾“å‡ºä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°å‰å››ä¸ªå­—èŠ‚æ˜¯é›¶ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰åœ¨é‚£é‡Œå†™å…¥ä»»ä½•æ•°æ®ã€‚</p><p>ä½¿ç”¨ <code>writeBigUInt64LE()</code> æ–¹æ³•ï¼Œä½ å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å°†å¤§æ•´æ•°ä»¥å°ç«¯å½¢å¼å†™å…¥ Bufferï¼Œè¿™åœ¨è¿›è¡Œä½çº§äºŒè¿›åˆ¶æ•°æ®å¤„ç†æ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="buf-writedoublebe-value-offset" tabindex="-1"><a class="header-anchor" href="#buf-writedoublebe-value-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwritedoublebevalue-offset" target="_blank" rel="noopener noreferrer">buf.writeDoubleBE(value[, offset])</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘ä¼šå°½é‡ç”¨é€šä¿—æ˜“æ‡‚çš„æ–¹å¼æ¥è§£é‡Š <code>buf.writeDoubleBE(value[, offset])</code> è¿™ä¸ªæ–¹æ³•ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code> å¯¹è±¡æ˜¯ä¸€ä¸ªç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ç±»ä¼¼æ•°ç»„çš„ç»“æ„ã€‚ä½ å¯ä»¥æƒ³è±¡å®ƒå°±åƒæ˜¯ä¸€ä¸²ç å­ï¼Œæ¯ä¸ªç å­å¯ä»¥å­˜å‚¨ä¸€ä¸ªå­—èŠ‚ï¼ˆ8 ä½ï¼‰çš„æ•°æ®ã€‚</p><p>å½“æˆ‘ä»¬åœ¨ç¼–ç¨‹ä¸­å¤„ç†æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡æˆ–è€…å…¶ä»–çš„ IO æ“ä½œæ—¶ï¼Œç»å¸¸éœ€è¦å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµã€‚ä¾‹å¦‚ï¼Œè¯»å–ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶çš„å†…å®¹ï¼Œæˆ–è€…å‘é€ä¸€ä¸ªåŒ…å«æ•°å­—ä¿¡æ¯çš„æ¶ˆæ¯åˆ°å¦ä¸€å°è®¡ç®—æœºã€‚</p><p><code>buf.writeDoubleBE(value[, offset])</code> æ˜¯ä¸€ä¸ªç”¨æ¥å‘ <code>Buffer</code> å¯¹è±¡ä¸­å†™å…¥ä¸€ä¸ª 64 ä½åŒç²¾åº¦æµ®ç‚¹æ•°ï¼ˆå³ JavaScript ä¸­çš„ <code>number</code> ç±»å‹ï¼‰ï¼Œå¹¶ä¸”ä½¿ç”¨å¤§ç«¯å­—èŠ‚åºï¼ˆBig-Endianï¼‰è¿›è¡Œç¼–ç çš„æ–¹æ³•ã€‚</p><h3 id="å¤§ç«¯-big-endian-å­—èŠ‚åºæ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#å¤§ç«¯-big-endian-å­—èŠ‚åºæ˜¯ä»€ä¹ˆ"><span>å¤§ç«¯ï¼ˆBig-Endianï¼‰å­—èŠ‚åºæ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h3><p>ç®€å•æ¥è¯´ï¼Œå¤§ç«¯å­—èŠ‚åºæ˜¯ä¸€ç§å­˜å‚¨æˆ–ä¼ è¾“æ•°æ®çš„æ–¹å¼ï¼Œå…¶ä¸­æœ€é‡è¦çš„å­—èŠ‚ï¼ˆç§°ä¸ºâ€œé«˜ä½å­—èŠ‚â€ï¼‰æ”¾åœ¨åœ°å€æœ€ä½çš„å­˜å‚¨å•å…ƒï¼Œæ¥ç€æ˜¯æ¬¡é‡è¦å­—èŠ‚ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°æœ€ä¸é‡è¦çš„å­—èŠ‚ï¼ˆç§°ä¸ºâ€œä½ä½å­—èŠ‚â€ï¼‰è¢«æ”¾ç½®åœ¨åœ°å€æœ€é«˜çš„å­˜å‚¨å•å…ƒã€‚</p><p>è¿™ä¸ªæ¦‚å¿µå¯¹äºç†è§£ä¸åŒè®¡ç®—æœºç³»ç»Ÿå¦‚ä½•äº¤æ¢æ•°æ®éå¸¸é‡è¦ï¼Œå› ä¸ºä¸åŒç³»ç»Ÿå¯èƒ½é‡‡ç”¨ä¸åŒçš„å­—èŠ‚åºæ–¹å¼ã€‚</p><h3 id="å‚æ•°è§£é‡Š-3" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-3"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>value</code>ï¼šè¿™æ˜¯ä½ æƒ³è¦å†™å…¥ <code>Buffer</code> çš„é‚£ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°ã€‚</li><li><code>offset</code> (å¯é€‰)ï¼šè¿™æ˜¯å¼€å§‹å†™å…¥æ•°æ®åˆ° <code>Buffer</code> çš„èµ·å§‹ä½ç½®ï¼ˆåç§»é‡ï¼‰ã€‚å¦‚æœä½ ä¸æä¾›è¿™ä¸ªå‚æ•°ï¼Œé»˜è®¤å€¼æ˜¯ <code>0</code>ï¼Œè¡¨ç¤ºä» <code>Buffer</code> çš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¼€å§‹å†™å…¥ã€‚</li></ul><p>ç°åœ¨ä¸¾ä¸¤ä¸ªå…·ä½“çš„ä¾‹å­æ¥è¯´æ˜ <code>writeDoubleBE</code> æ–¹æ³•çš„ä½¿ç”¨ï¼š</p><h3 id="ç¤ºä¾‹-1-åˆ›å»ºä¸€ä¸ª-buffer-å¹¶å†™å…¥ä¸€ä¸ªæ•°å­—" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åˆ›å»ºä¸€ä¸ª-buffer-å¹¶å†™å…¥ä¸€ä¸ªæ•°å­—"><span>ç¤ºä¾‹ 1ï¼šåˆ›å»ºä¸€ä¸ª Buffer å¹¶å†™å…¥ä¸€ä¸ªæ•°å­—</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªè¶³å¤Ÿå¤§çš„ Buffer æ¥å­˜å‚¨ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°ï¼ˆ8å­—èŠ‚ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å†™å…¥ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•° 123.456 åˆ° Buffer ä¸­</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨å¤§ç«¯å­—èŠ‚åºæ ¼å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeDoubleBE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">123.456</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å° Buffer çš„å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º 8 å­—èŠ‚çš„ <code>Buffer</code> å¯¹è±¡ï¼Œå› ä¸ºä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°éœ€è¦ 8 ä¸ªå­—èŠ‚æ¥å­˜å‚¨ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>writeDoubleBE</code> æ–¹æ³•å°†æ•°å­— <code>123.456</code> å†™å…¥åˆ°è¿™ä¸ª <code>Buffer</code> ä¸­ã€‚æœ€åï¼Œæ§åˆ¶å°æ‰“å°å‡º <code>Buffer</code> çš„å†…å®¹ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ç³»åˆ—ä»£è¡¨è¿™ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°çš„äºŒè¿›åˆ¶æ•°æ®ã€‚</p><h3 id="ç¤ºä¾‹-2-æŒ‡å®šåç§»é‡å†™å…¥-2" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æŒ‡å®šåç§»é‡å†™å…¥-2"><span>ç¤ºä¾‹ 2ï¼šæŒ‡å®šåç§»é‡å†™å…¥</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ›´å¤§çš„ Bufferï¼Œå¯ä»¥å­˜å‚¨ä¸¤ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬å†™å…¥ä¸¤ä¸ªæ•°å­—ï¼Œç¬¬äºŒä¸ªæ•°å­—ä» Buffer çš„ç¬¬ 9 ä¸ªå­—èŠ‚å¼€å§‹ï¼ˆåç§»é‡æ˜¯ 8ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeDoubleBE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">123.456</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å†™å…¥ç¬¬ä¸€ä¸ªæ•°ï¼Œä»ç¬¬ 1 ä¸ªå­—èŠ‚å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeDoubleBE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">789.101</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å†™å…¥ç¬¬äºŒä¸ªæ•°ï¼Œä»ç¬¬ 9 ä¸ªå­—èŠ‚å¼€å§‹</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å° Buffer çš„å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•åœ¨åŒä¸€ä¸ª <code>Buffer</code> ä¸­å†™å…¥ä¸¤ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°ï¼Œå¹¶ä¸”ç¬¬äºŒä¸ªæ•°æ˜¯ä»ç¬¬ 9 ä¸ªå­—èŠ‚å¼€å§‹çš„ã€‚è¿™é‡Œæˆ‘ä»¬è®¾ç½®äº†ä¸€ä¸ªåç§»é‡ <code>8</code>ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“ç¬¬ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°å·²ç»å ç”¨äº†å‰é¢çš„ 8 ä¸ªå­—èŠ‚ã€‚</p><p>è®°å¾— <code>Buffer</code> æ“ä½œæ¶‰åŠçš„æ˜¯åº•å±‚çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œæ‰€ä»¥åœ¨å¤„ç†å®ƒä»¬çš„æ—¶å€™éœ€è¦æ ¼å¤–å°å¿ƒï¼Œç¡®ä¿æ­£ç¡®åœ°åˆ†é…ç©ºé—´å’Œæ­£ç¡®åœ°ä½¿ç”¨å­—èŠ‚åºã€‚</p><h3 id="buf-writedoublele-value-offset" tabindex="-1"><a class="header-anchor" href="#buf-writedoublele-value-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwritedoublelevalue-offset" target="_blank" rel="noopener noreferrer">buf.writeDoubleLE(value[, offset])</a></span></a></h3><p>å¥½çš„ï¼Œé¦–å…ˆæˆ‘ä»¬æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­çš„ <code>Buffer</code> æ˜¯ä»€ä¹ˆã€‚åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code> ç±»æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„å…¨å±€å¯¹è±¡ã€‚å®ƒæä¾›äº†ä¸€ç§æ–¹å¼æ¥è¡¨ç¤ºå›ºå®šé•¿åº¦çš„å­—èŠ‚åºåˆ—ã€‚</p><p>ç°åœ¨è®©æˆ‘ä»¬èšç„¦äº <code>buf.writeDoubleLE(value[, offset])</code> æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯ <code>Buffer</code> å¯¹è±¡ä¸Šçš„ä¸€ä¸ªåŠŸèƒ½ï¼Œç”¨äºå°†ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°ï¼ˆdoubleï¼‰å†™å…¥ <code>Buffer</code> ä¸­ï¼Œå¹¶ä¸”ä»¥â€œå°ç«¯â€ï¼ˆLEï¼ŒLittle-Endianï¼‰æ–¹å¼å­˜å‚¨ã€‚æ‰€è°“çš„â€œå°ç«¯â€æ–¹å¼æŒ‡çš„æ˜¯æœ€ä½æœ‰æ•ˆå­—èŠ‚ä½äºæœ€å‰é¢ã€‚ç›¸å¯¹åº”åœ°ï¼Œâ€œå¤§ç«¯â€ï¼ˆBig-Endianï¼‰æ–¹å¼åˆ™æ˜¯æœ€é«˜æœ‰æ•ˆå­—èŠ‚ä½äºæœ€å‰é¢ã€‚</p><p>è¿™é‡Œçš„å‚æ•°è§£é‡Šå¦‚ä¸‹ï¼š</p><ul><li><code>value</code>: è¿™æ˜¯ä½ æƒ³è¦å†™å…¥ buffer çš„åŒç²¾åº¦æµ®ç‚¹æ•°ã€‚</li><li><code>offset</code> (å¯é€‰): è¿™æ˜¯æ•°å­—å°†è¦å¼€å§‹å†™å…¥çš„ä½ç½®çš„ç´¢å¼•ã€‚é»˜è®¤å€¼æ˜¯ 0ï¼Œä¹Ÿå°±æ˜¯ä» buffer çš„èµ·å§‹å¤„å¼€å§‹ã€‚</li></ul><p><code>writeDoubleLE</code> æ–¹æ³•ä¼šå°† <code>value</code> å†™å…¥è‡³è°ƒç”¨å®ƒçš„ Buffer å®ä¾‹ï¼Œä» <code>offset</code> æŒ‡å®šçš„ä½ç½®å¼€å§‹ï¼Œå ç”¨ 8 ä¸ªå­—èŠ‚çš„ç©ºé—´ï¼Œå› ä¸ºä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°éœ€è¦ 8 å­—èŠ‚æ¥å­˜å‚¨ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œå½“ä½ è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼ŒNode.js ä¼šæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ‰§è¡Œï¼š</p><ol><li>æ£€æŸ¥ <code>offset</code> æ˜¯å¦åœ¨åˆæ³•èŒƒå›´å†…ï¼ˆ0 åˆ° buffer é•¿åº¦å‡å» 8ï¼‰ï¼Œå› ä¸º double ç±»å‹å ç”¨ 8 ä¸ªå­—èŠ‚ã€‚</li><li>å°† <code>value</code> è½¬æ¢ä¸ºäºŒè¿›åˆ¶è¡¨ç¤ºå½¢å¼ï¼ŒæŒ‰ç…§ IEEE 754 æ ‡å‡†æ¥è¡¨ç¤ºæµ®ç‚¹æ•°ã€‚</li><li>æŒ‰ç…§â€œå°ç«¯â€æ ¼å¼ï¼Œå³ä»æ•°å€¼çš„ä½ä½å­—èŠ‚å¼€å§‹æ”¾ç½®ï¼ŒæŠŠè¿™äº›å­—èŠ‚ä¾æ¬¡å†™å…¥åˆ° Buffer ä¸­ã€‚</li></ol><p>æ¥çœ‹å‡ ä¸ªä¾‹å­ï¼š</p><h3 id="ç¤ºä¾‹-1-åŸºæœ¬ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åŸºæœ¬ä½¿ç”¨"><span>ç¤ºä¾‹ 1ï¼šåŸºæœ¬ä½¿ç”¨</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 8 çš„ buffer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 12.34</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™æ˜¯æˆ‘ä»¬è¦å†™å…¥çš„åŒç²¾åº¦æµ®ç‚¹æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeDoubleLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ buffer çš„èµ·å§‹ä½ç½®å†™å…¥è¯¥æ•°å€¼</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º 8 ä¸ªå­—èŠ‚çš„ <code>Buffer</code>ï¼Œå› ä¸ºä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°æ­£å¥½éœ€è¦ 8 ä¸ªå­—èŠ‚æ¥å­˜å‚¨ã€‚ç„¶åæˆ‘ä»¬ç”¨ <code>writeDoubleLE</code> æ–¹æ³•å°†æ•°å€¼ <code>12.34</code> å†™å…¥ <code>Buffer</code> ä¸­ã€‚</p><h3 id="ç¤ºä¾‹-2-å¸¦åç§»é‡çš„ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å¸¦åç§»é‡çš„ä½¿ç”¨"><span>ç¤ºä¾‹ 2ï¼šå¸¦åç§»é‡çš„ä½¿ç”¨</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 16 çš„ buffer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> value1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 12.34</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> value2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 56.78</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ buffer çš„èµ·å§‹ä½ç½®å†™å…¥ç¬¬ä¸€ä¸ªå€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeDoubleLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">value1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ buffer ä¸­åç§» 8 ä¸ªå­—èŠ‚çš„ä½ç½®å†™å…¥ç¬¬äºŒä¸ªå€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeDoubleLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">value2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º 16 ä¸ªå­—èŠ‚çš„ <code>Buffer</code>ã€‚æ¥ç€ï¼Œæˆ‘ä»¬åœ¨ <code>Buffer</code> çš„èµ·å§‹ä½ç½®å†™å…¥äº†ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•° <code>value1</code>ã€‚ç”±äºä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°å ç”¨ 8 å­—èŠ‚ï¼Œæˆ‘ä»¬ç”¨åç§»é‡ 8 æ¥æŒ‡å®š <code>value2</code> åº”è¯¥å†™å…¥çš„ä½ç½®ï¼Œè¿™æ ·ä¸¤ä¸ªæ•°å°±ä¸ä¼šäº’ç›¸è¦†ç›–ã€‚</p><p>é€šè¿‡è¿™ä¸¤ä¸ªä¾‹å­ï¼Œä½ åº”è¯¥èƒ½å¤Ÿç†è§£ <code>buf.writeDoubleLE(value[, offset])</code> çš„åŸºæœ¬ç”¨æ³•äº†ã€‚è¿™ä¸ªæ–¹æ³•åœ¨éœ€è¦å°†æµ®ç‚¹æ•°ç›´æ¥å†™å…¥åˆ°äºŒè¿›åˆ¶æµæˆ–è€…å½“ä¸å…¶ä»–ç³»ç»Ÿè¿›è¡ŒäºŒè¿›åˆ¶é€šè®¯æ—¶éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚åœ¨ç½‘ç»œåè®®æˆ–æ–‡ä»¶æ ¼å¼ä¸­ç»å¸¸ä¼šç”¨åˆ°äºŒè¿›åˆ¶æ•°æ®ã€‚</p><h3 id="buf-writefloatbe-value-offset" tabindex="-1"><a class="header-anchor" href="#buf-writefloatbe-value-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwritefloatbevalue-offset" target="_blank" rel="noopener noreferrer">buf.writeFloatBE(value[, offset])</a></span></a></h3><p>Node.js ä¸­çš„ <code>buf.writeFloatBE(value[, offset])</code> æ˜¯ä¸€ä¸ªç”¨æ¥å‘ç¼“å†²åŒºï¼ˆBufferï¼‰å†™å…¥ä¸€ä¸ª 32 ä½æµ®ç‚¹æ•°çš„æ–¹æ³•ã€‚è¿™é‡Œçš„ &quot;BE&quot; ä»£è¡¨ Big-Endianï¼Œæ„æ€æ˜¯åœ¨å†…å­˜ä¸­ä»¥å¤§ç«¯å­—èŠ‚åºå­˜å‚¨è¿™ä¸ªæµ®ç‚¹æ•°ã€‚å­—èŠ‚åºæ˜¯æŒ‡å¤šå­—èŠ‚æ•°æ®åœ¨å†…å­˜ä¸­çš„å­˜æ”¾é¡ºåºï¼Œå¤§ç«¯è¡¨ç¤ºæœ€é‡è¦çš„å­—èŠ‚æ’åœ¨å‰é¢ã€‚</p><p>è®©æˆ‘ä»¬åˆ†è§£ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•ï¼š</p><ul><li><code>buf</code>: è¿™æ˜¯ Node.js ä¸­çš„ Buffer å¯¹è±¡ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€å—å†…å­˜ç©ºé—´ï¼Œç”¨äºç›´æ¥æ“ä½œäºŒè¿›åˆ¶æ•°æ®ã€‚</li><li><code>.writeFloatBE()</code>: è¿™æ˜¯ä¸€ä¸ª Buffer å®ä¾‹ä¸Šçš„æ–¹æ³•ï¼Œç”¨äºå†™å…¥ä¸€ä¸ª 32 ä½çš„æµ®ç‚¹æ•°ã€‚</li><li><code>value</code>: è¿™æ˜¯ä½ æƒ³è¦å†™å…¥çš„æµ®ç‚¹æ•°å€¼ã€‚</li><li><code>offset</code> (å¯é€‰): è¿™æ˜¯æ•°å­—å†™å…¥åˆ°ç¼“å†²åŒºå¼€å§‹çš„ç´¢å¼•ä½ç½®ï¼Œé»˜è®¤ä» 0 å¼€å§‹ã€‚</li></ul><p>å®é™…åº”ç”¨åœºæ™¯åŒ…æ‹¬ï¼š</p><ol><li><p>ç½‘ç»œé€šä¿¡ï¼šåœ¨è¿›è¡Œç½‘ç»œé€šä¿¡æ—¶ï¼Œå¯èƒ½éœ€è¦å°†å„ç§æ•°æ®ç±»å‹é€šè¿‡äºŒè¿›åˆ¶æµçš„å½¢å¼å‘é€ç»™æ¥æ”¶æ–¹ï¼Œæ¯”å¦‚è¦å‘é€ä¸€ä¸ªæµ®ç‚¹æ•°ï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>buf.writeFloatBE()</code> å°†è¯¥æ•°å€¼æ”¾å…¥ä¸€ä¸ª Buffer ä¸­å†å‘é€å‡ºå»ã€‚</p></li><li><p>æ–‡ä»¶æ“ä½œï¼šå½“ä½ éœ€è¦å°†æ•°æ®å†™å…¥äºŒè¿›åˆ¶æ–‡ä»¶æ—¶ï¼Œä¾‹å¦‚ä¿å­˜å›¾åƒå¤„ç†åçš„å‚æ•°æˆ–è€…æ¸¸æˆçš„å¾—åˆ†ç­‰æµ®ç‚¹æ•°ï¼Œåœ¨å†™å…¥ä¹‹å‰ä¼šå…ˆç”¨ Buffer ç¼–ç ã€‚</p></li><li><p>ç¡¬ä»¶äº¤äº’ï¼šä¸ç¡¬ä»¶è®¾å¤‡é€šä¿¡æ—¶ï¼Œç»å¸¸éœ€è¦å‘é€å’Œæ¥æ”¶åŸå§‹å­—èŠ‚æ•°æ®ï¼Œè¿™æ—¶å€™å°±å¯èƒ½ä¼šç”¨åˆ° Buffer æ¥å¤„ç†è¿™äº›æµ®ç‚¹æ•°æ•°æ®ã€‚</p></li></ol><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><p>å‡è®¾ä½ æƒ³åœ¨ä¸€ä¸ª Buffer ä¸­å­˜å‚¨æ¸©åº¦å€¼ 24.5 åº¦ï¼ˆä¸€ä¸ªæµ®ç‚¹æ•°ï¼‰ï¼Œç„¶åå‡†å¤‡å‘é€åˆ°å¦ä¸€å°æœºå™¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªè¶³å¤Ÿå­˜å‚¨å•ä¸ª32ä½æµ®ç‚¹æ•°çš„ç¼“å†²åŒºï¼ˆ4ä¸ªå­—èŠ‚ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å†™å…¥æµ®ç‚¹æ•°24.5ï¼Œä¸æŒ‡å®šåç§»é‡é»˜è®¤ä»0å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeFloatBE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">24.5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½ ç°åœ¨å¯ä»¥æŠŠè¿™ä¸ª Buffer å‘é€åˆ°éœ€è¦çš„åœ°æ–¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å° Buffer çš„å†…å®¹ï¼Œè¾“å‡ºå¯èƒ½ç±»ä¼¼ï¼š`&lt;`Buffer 41 c4 00 00&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™æ˜¯äºŒè¿›åˆ¶è¡¨ç¤ºçš„24.5æµ®ç‚¹æ•°</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>writeFloatBE</code> æ–¹æ³•ä¼šæŠŠæ•°å­— 24.5 è½¬æ¢ä¸ºäºŒè¿›åˆ¶å½¢å¼ï¼Œå¹¶æŒ‰ç…§å¤§ç«¯æ ¼å¼å­˜å‚¨åœ¨ Buffer ä¸­ã€‚éšåï¼Œä½ å¯ä»¥é€šè¿‡ç½‘ç»œã€æ–‡ä»¶ç³»ç»Ÿæˆ–å…¶ä»–é€”å¾„å‘é€è¿™ä¸ª Bufferã€‚æ¥æ”¶æ–¹åœ¨æ”¶åˆ° Buffer åï¼Œéœ€è¦æ­£ç¡®åœ°è§£è¯»å‡ºé‡Œé¢çš„æµ®ç‚¹æ•°ã€‚å¦‚æœæ¥æ”¶æ–¹ä¹Ÿæ˜¯ä½¿ç”¨ Node.jsï¼Œä»–ä»¬å¯ä»¥ç”¨ç›¸åº”çš„è¯»å–æ–¹æ³•ï¼Œæ¯”å¦‚ <code>buf.readFloatBE(offset)</code> æ¥è·å–åŸå§‹çš„æµ®ç‚¹æ•°å€¼ã€‚</p><h3 id="buf-writefloatle-value-offset" tabindex="-1"><a class="header-anchor" href="#buf-writefloatle-value-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwritefloatlevalue-offset" target="_blank" rel="noopener noreferrer">buf.writeFloatLE(value[, offset])</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘å°†ä¸ºæ‚¨è§£é‡Š Node.js ä¸­<code>buf.writeFloatLE(value[, offset])</code>å‡½æ•°çš„ç”¨æ³•ã€‚</p><p>åœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨åƒ Array æˆ– Object è¿™æ ·çš„æ•°æ®ç»“æ„æ¥å¤„ç†æ•°æ®ã€‚ä½†æ˜¯å½“æˆ‘ä»¬éœ€è¦ä¸ TCP æµã€æ–‡ä»¶ç³»ç»Ÿæ“ä½œã€æˆ–è€…éœ€è¦å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„æ—¶å€™ï¼Œå°±éœ€è¦ä¸€ä¸ªæ›´å¤æ‚çš„æ–¹å¼æ¥è¯»å†™æ•°æ®äº†ã€‚Node.js æä¾›äº†<code>Buffer</code>ç±»æ¥ä¸“é—¨å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµã€‚</p><p><code>Buffer</code>ç±»æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨äºç›´æ¥å¤„ç†å†…å­˜åˆ†é…ä»¥åŠæ“ä½œäºŒè¿›åˆ¶æ•°æ®ã€‚ç°åœ¨è®©æˆ‘ä»¬è¯¦ç»†äº†è§£ä¸€ä¸‹<code>buf.writeFloatLE(value[, offset])</code>æ–¹æ³•ï¼š</p><h3 id="buf-writefloatle-value-offset-1" tabindex="-1"><a class="header-anchor" href="#buf-writefloatle-value-offset-1"><span><code>buf.writeFloatLE(value[, offset])</code></span></a></h3><p>è¿™ä¸ªæ–¹æ³•ç”¨äºå°†ä¸€ä¸ª 32 ä½æµ®ç‚¹æ•°å†™å…¥åˆ° buffer ä¸­ï¼Œä½¿ç”¨å°ç«¯æ ¼å¼ï¼ˆLE ä»£è¡¨ Little-Endianï¼‰ã€‚å°ç«¯æ ¼å¼æ„å‘³ç€ä½åºå­—èŠ‚è¢«æ”¾ç½®åœ¨å†…å­˜çš„å‰é¢ï¼ˆå¼€å§‹çš„ä½ç½®ï¼‰ï¼Œé«˜åºå­—èŠ‚è¢«æ”¾ç½®åœ¨åé¢ã€‚è¿™æ˜¯å¤„ç†äºŒè¿›åˆ¶æ•°æ®æ—¶å­—èŠ‚é¡ºåºçš„æ¦‚å¿µã€‚</p><h4 id="å‚æ•°-5" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-5"><span>å‚æ•°ï¼š</span></a></h4><ul><li><code>value</code>ï¼šè¿™æ˜¯ä½ è¦å†™å…¥ buffer çš„æµ®ç‚¹æ•°ã€‚</li><li><code>offset</code>ï¼šè¿™æ˜¯å¯é€‰å‚æ•°ï¼Œä»£è¡¨ buffer ä¸­å¼€å§‹å†™å…¥çš„ä½ç½®ï¼ˆå­—èŠ‚åç§»é‡ï¼‰ã€‚å¦‚æœæ²¡æœ‰æä¾› offsetï¼Œé»˜è®¤å€¼æ˜¯ 0ï¼Œå³ä» buffer çš„èµ·å§‹ä½ç½®å†™å…¥ã€‚</li></ul><h4 id="è¿”å›å€¼-6" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-6"><span>è¿”å›å€¼ï¼š</span></a></h4><ul><li>æ–¹æ³•è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºä¸‹ä¸€æ¬¡å†™å…¥çš„èµ·å§‹ä½ç½®çš„åç§»é‡ã€‚</li></ul><h4 id="ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹"><span>ç¤ºä¾‹ï¼š</span></a></h4><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨ç¼–å†™ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºéœ€è¦é€šè¿‡ç½‘ç»œå‘é€ä¸€ä¸ªåŒ…å«æ¸©åº¦å’Œæ¹¿åº¦çš„ä¼ æ„Ÿå™¨æ•°æ®ã€‚</p><p>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªè¶³å¤Ÿå¤§çš„ buffer æ¥å­˜å‚¨è¿™ä¸¤ä¸ª 32 ä½æµ®ç‚¹æ•°ï¼ˆæ¯ä¸ªæ•°éœ€è¦ 4 ä¸ªå­—èŠ‚ï¼‰ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ†é…8ä¸ªå­—èŠ‚çš„buffer</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç„¶åï¼Œæˆ‘ä»¬å°†æ¸©åº¦å’Œæ¹¿åº¦å†™å…¥ buffer ä¸­ã€‚æ¯”å¦‚æ¸©åº¦æ˜¯ 24.5Â°Cï¼Œæ¹¿åº¦æ˜¯ 50.3%RHï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeFloatLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">24.5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¸©åº¦å†™å…¥bufferçš„å¼€å§‹ä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeFloatLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">50.3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¹¿åº¦å†™å…¥bufferçš„ç¬¬4ä¸ªå­—èŠ‚çš„ä½ç½®</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œ<code>writeFloatLE</code>çš„è°ƒç”¨ä¼šæŠŠæµ®ç‚¹æ•°è½¬æ¢æˆäºŒè¿›åˆ¶å½¢å¼ï¼Œå¹¶ä¸”æŒ‰ç…§å°ç«¯å­—èŠ‚é¡ºåºå­˜å‚¨åœ¨ buffer ä¸­ã€‚ç¬¬ä¸€æ¬¡è°ƒç”¨å†™å…¥æ¸©åº¦å€¼ä¸éœ€è¦æŒ‡å®š offsetï¼Œå› ä¸ºå®ƒé»˜è®¤ä» 0 å¼€å§‹ã€‚ç¬¬äºŒæ¬¡è°ƒç”¨å†™å…¥æ¹¿åº¦å€¼æ—¶ï¼ŒæŒ‡å®š offset ä¸º 4ï¼Œè¡¨ç¤ºè·³è¿‡å‰å››ä¸ªå­—èŠ‚ã€‚</p><p>æœ€åï¼Œè¿™ä¸ª buffer å¯ä»¥é€šè¿‡ TCP æˆ–å…¶ä»–åè®®å‘é€ç»™å¦ä¸€ä¸ªç³»ç»Ÿè¿›è¡Œå¤„ç†ã€‚</p><p>è¯·æ³¨æ„ï¼Œå½“å¤„ç†<code>Buffer</code>æ•°æ®æ—¶ï¼Œå¿…é¡»ç¡®ä¿ä½ çš„è¯»å–å’Œå†™å…¥æ“ä½œä¸ä¼šè¶Šç•Œï¼ˆå³è®¿é—® buffer ä¹‹å¤–çš„å†…å­˜ï¼‰ã€‚å¦‚æœæä¾›çš„<code>offset</code>è¶…å‡ºäº† buffer çš„èŒƒå›´ï¼ŒNode.js å°†ä¼šæŠ›å‡ºä¸€ä¸ª<code>RangeError</code>é”™è¯¯ã€‚</p><h3 id="buf-writeint8-value-offset" tabindex="-1"><a class="header-anchor" href="#buf-writeint8-value-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwriteint8value-offset" target="_blank" rel="noopener noreferrer">buf.writeInt8(value[, offset])</a></span></a></h3><p>å¥½çš„ï¼ŒNode.js ä¸­çš„ <code>buf.writeInt8(value[, offset])</code> æ˜¯ä¸€ä¸ªç”¨æ¥å†™å…¥æ•°æ®åˆ°ä¸€ä¸ª Buffer å¯¹è±¡çš„æ–¹æ³•ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä»€ä¹ˆæ˜¯ Bufferã€‚</p><p>åœ¨ Node.js ä¸­ï¼ŒBuffer æ˜¯ä¸€ç§ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„æ–¹å¼ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªå¯ä»¥å­˜å‚¨å­—èŠ‚çš„æ•°ç»„ã€‚å› ä¸º JavaScript æœ€åˆå¹¶ä¸æ˜¯è®¾è®¡æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ï¼Œæ‰€ä»¥ Buffer ç±»å‹è¢«å¼•å…¥ä½œä¸ºä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œä½¿å¾—åœ¨ Node.js ç¯å¢ƒä¸‹å¯ä»¥æ–¹ä¾¿åœ°æ“ä½œäºŒè¿›åˆ¶æ•°æ®ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ·±å…¥äº†è§£ <code>buf.writeInt8(value[, offset])</code>ï¼š</p><ul><li><code>writeInt8</code>: è¿™ä¸ªæ–¹æ³•å…è®¸ä½ å†™å…¥ä¸€ä¸ª 8 ä½ï¼ˆ1 å­—èŠ‚ï¼‰çš„æœ‰ç¬¦å·æ•´æ•°åˆ° Buffer ä¸­ã€‚</li><li><code>value</code>: è¿™æ˜¯ä½ æƒ³è¦å†™å…¥çš„æ•´æ•°å€¼ã€‚å› ä¸ºæ˜¯ 8 ä½æ•´æ•°ï¼Œæ‰€ä»¥èŒƒå›´å¿…é¡»åœ¨ -128 åˆ° 127 ä¹‹é—´ã€‚</li><li><code>offset</code> (å¯é€‰): è¿™æ˜¯æ•°å€¼å†™å…¥çš„èµ·å§‹ä½ç½®ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰åœ¨ Buffer ä¸­çš„ç´¢å¼•ã€‚å¦‚æœä½ ä¸æä¾›è¿™ä¸ªå‚æ•°ï¼Œé»˜è®¤å€¼æ˜¯ 0ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé»˜è®¤ä» Buffer çš„å¼€å¤´å¼€å§‹å†™å…¥ã€‚</li></ul><p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ æƒ³åœ¨ä¸€ä¸ª Buffer ä¸­å­˜å‚¨ä¸€äº›æ¸©åº¦å€¼ï¼Œè€Œè¿™äº›æ¸©åº¦å€¼éƒ½æ˜¯ 8 ä½çš„æœ‰ç¬¦å·æ•´æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªè¶³å¤Ÿå¤§çš„ Buffer æ¥å­˜å‚¨ä½ çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæœ‰ 4 ä¸ªå­—èŠ‚çš„ç©º Buffer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨ï¼Œä½¿ç”¨ writeInt8 æ–¹æ³•å†™å…¥å››ä¸ªæ¸©åº¦å€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeInt8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">25</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ç¬¬ 0 çš„ä½ç½®å†™å…¥ 25</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeInt8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ç¬¬ 1 çš„ä½ç½®å†™å…¥ -5ï¼ˆè¡¨ç¤ºè´Ÿæ¸©åº¦ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeInt8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ç¬¬ 2 çš„ä½ç½®å†™å…¥ 10</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeInt8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ç¬¬ 3 çš„ä½ç½®å†™å…¥ 30</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ†é…äº†ä¸€ä¸ªé•¿åº¦ä¸º 4 å­—èŠ‚çš„ Bufferã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>writeInt8</code> åˆ†åˆ«åœ¨æ¯ä¸ªä½ç½®å†™å…¥äº†ä¸€ä¸ªå­—èŠ‚å¤§å°çš„æ•´æ•°ã€‚è¾“å‡ºçš„ Buffer çœ‹èµ·æ¥ä¼šåŒ…å«å››ä¸ªæ¸©åº¦å€¼ï¼Œæ¯ä¸ªå€¼å æ®ä¸€ä¸ªå­—èŠ‚ã€‚</p><p>æ³¨æ„ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ éœ€è¦ç¡®ä¿å†™å…¥çš„ <code>value</code> å€¼åœ¨æœ‰æ•ˆèŒƒå›´å†…ï¼ˆ-128 åˆ° 127ï¼‰ï¼ŒåŒæ—¶è¦æ³¨æ„ä¸è¦è¶…å‡º Buffer çš„ç•Œé™ï¼ˆå³ <code>offset</code> åŠ ä¸Šå†™å…¥çš„å­—èŠ‚æ•°ä¸èƒ½è¶…è¿‡ Buffer çš„æ€»å¤§å°ï¼‰ã€‚å¦‚æœè¶…å‡ºèŒƒå›´ï¼ŒNode.js ä¼šæŠ›å‡º RangeError å¼‚å¸¸ã€‚</p><h3 id="buf-writeint16be-value-offset" tabindex="-1"><a class="header-anchor" href="#buf-writeint16be-value-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwriteint16bevalue-offset" target="_blank" rel="noopener noreferrer">buf.writeInt16BE(value[, offset])</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘ä¼šç›´æ¥è¿›å…¥ä¸»é¢˜ã€‚</p><p>Node.js ä¸­çš„ <code>Buffer</code> ç±»æ˜¯ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ã€‚ç®€å•æ¥è¯´ï¼Œä¸€ä¸ª <code>Buffer</code> å¯¹è±¡å°±åƒä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œä½†å®ƒæ˜¯ç”¨æ¥ä¸“é—¨å­˜å‚¨äºŒè¿›åˆ¶æ•°æ®çš„ã€‚æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼ˆ8 ä½ï¼‰ï¼Œå€¼ä»‹äº 0-255 ä¹‹é—´ã€‚</p><p><code>Buffer</code> çš„ <code>writeInt16BE</code> æ–¹æ³•å…è®¸ä½ åœ¨ç¼“å†²åŒºï¼ˆbufferï¼‰é‡Œå†™å…¥ä¸€ä¸ª 16 ä½çš„æ•´æ•°ï¼ˆä¹Ÿå°±æ˜¯ 2 å­—èŠ‚ï¼‰ï¼Œå¹¶ä¸”æ˜¯æŒ‰ç…§å¤§ç«¯åºï¼ˆBEï¼ŒBig-Endianï¼‰çš„æ–¹å¼æ¥å†™å…¥çš„ã€‚</p><p>å…ˆè§£é‡Šä¸€ä¸‹â€œå¤§ç«¯åº (Big-Endian)â€ï¼š</p><ul><li>å¤§ç«¯åºæ˜¯æŒ‡é«˜ä½å­—èŠ‚æ’æ”¾åœ¨å†…å­˜çš„ä½åœ°å€ç«¯ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å¤šå­—èŠ‚çš„è¡¨ç¤ºä¸­ï¼Œæœ€é‡è¦çš„å­—èŠ‚ï¼ˆé€šå¸¸æ˜¯æœ€å·¦è¾¹çš„å­—èŠ‚ï¼‰å­˜å‚¨åœ¨æœ€ä½çš„åœ°å€ä¸Šã€‚</li></ul><p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹ <code>writeInt16BE</code> æ–¹æ³•çš„å‚æ•°ï¼š</p><ul><li><code>value</code> æ˜¯ä½ æƒ³è¦å†™å…¥çš„æ•´æ•°ã€‚</li><li><code>offset</code> æ˜¯å¼€å§‹å†™å…¥çš„ä½ç½®ï¼ˆä» 0 å¼€å§‹è®¡ç®—ï¼‰ã€‚å¦‚æœçœç•¥è¿™ä¸ªå‚æ•°ï¼Œé»˜è®¤ä»å¤´å¼€å§‹å†™å…¥ï¼ˆå³ä»ä½ç½® 0 å¼€å§‹ï¼‰ã€‚</li></ul><p>æ¥ä¸¾ä¸€ä¸ªå®é™…ä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€ä¸ª <code>Buffer</code> å¹¶ä¸”åœ¨å…¶ä¸­å†™å…¥ä¸€ä¸ª 16 ä½çš„æ•´æ•°å€¼ 12345ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ†é…ä¸€ä¸ªåŒ…å«4å­—èŠ‚çš„Buffer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeInt16BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">12345</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨Bufferçš„èµ·å§‹ä½ç½®å†™å…¥æ•´æ•°12345ï¼Œä»¥å¤§ç«¯åºçš„æ ¼å¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“æ‰§è¡Œä¸Šé¢çš„ä»£ç åï¼Œ<code>buf</code> ä¸­çš„å†…å®¹å°†ä¼šæ˜¯ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>| 48 | 57 | 00 | 00 |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™é‡Œçš„ <code>48</code> å’Œ <code>57</code> æ˜¯åè¿›åˆ¶æ•° 12345 çš„ 16 ä½å¤§ç«¯åºè¡¨ç¤ºã€‚åœ¨å†…å­˜ä¸­ï¼Œ12345 è¢«åˆ†æˆäº†ä¸¤ä¸ªå­—èŠ‚ï¼š<code>48</code>ï¼ˆåœ¨é«˜ä½ï¼‰å’Œ<code>57</code>ï¼ˆåœ¨ä½ä½ï¼‰ï¼Œè€Œä¸”ç”±äºæˆ‘ä»¬çš„ Buffer å¤§å°ä¸º 4 å­—èŠ‚ï¼Œåé¢ä¸¤ä¸ªå­—èŠ‚é»˜è®¤ä¸º 0ã€‚</p><p>åŒæ ·çš„æ“ä½œï¼Œå¦‚æœæˆ‘ä»¬æ”¹å˜ <code>offset</code> å‚æ•°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeInt16BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">12345</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†12345å†™å…¥Bufferï¼Œä»ä½ç½®1å¼€å§‹</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>é‚£ä¹ˆ <code>buf</code> çš„å†…å®¹å°±ä¼šå˜æˆï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>| 00 | 48 | 57 | 00 |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ­¤æ—¶ï¼Œç”±äºæˆ‘ä»¬ä»ä½ç½® 1 å¼€å§‹å†™å…¥ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªå­—èŠ‚ä¿æŒä¸º 0ï¼Œæ¥ä¸‹æ¥ä¸¤ä¸ªå­—èŠ‚ä¸º 12345 çš„å¤§ç«¯åºè¡¨ç¤ºï¼Œæœ€åä¸€ä¸ªå­—èŠ‚ä¸º 0ã€‚</p><p>å½“å¤„ç† TCP æµæˆ–æ–‡ä»¶è¯»å†™ç­‰éœ€è¦ç²¾ç¡®æ§åˆ¶äºŒè¿›åˆ¶æ•°æ®æ—¶ï¼Œè¿™äº›æ–¹æ³•éå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½éœ€è¦å‘ä¸€ä¸ªç½‘ç»œåè®®å†™å…¥ç‰¹å®šçš„æ¶ˆæ¯æ ¼å¼ï¼Œæˆ–è€…å‘ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶å†™å…¥ç‰¹å®šæ ¼å¼çš„æ•°æ®ï¼Œè¿™æ—¶å€™å¯¹å­—èŠ‚åºçš„æ§åˆ¶å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚</p><h3 id="buf-writeint16le-value-offset" tabindex="-1"><a class="header-anchor" href="#buf-writeint16le-value-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwriteint16levalue-offset" target="_blank" rel="noopener noreferrer">buf.writeInt16LE(value[, offset])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥æ·±å…¥äº†è§£ä¸€ä¸‹ <code>Buffer</code> å¯¹è±¡ä¸­çš„ <code>writeInt16LE</code> æ–¹æ³•åœ¨ Node.js ä¸­çš„ä½œç”¨ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-buffer-1" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-buffer-1"><span>ä»€ä¹ˆæ˜¯ <code>Buffer</code>ï¼Ÿ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code> ç±»æ˜¯ä¸€ä¸ªå…¨å±€å¯ç”¨çš„ç±»ï¼Œç”¨äºç›´æ¥æ“ä½œå†…å­˜ä¸­çš„æ•°æ®ã€‚è¿™ä¸ªç±»è¢«ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµï¼Œå¦‚ä»æ–‡ä»¶ç³»ç»Ÿè¯»å–æ–‡ä»¶æˆ–ä¸ç½‘ç»œé€šä¿¡æ—¶ï¼Œå› ä¸º JavaScript æœ¬èº«æœ€åˆæ˜¯æ²¡æœ‰æä¾›å¯¹äºŒè¿›åˆ¶æ•°æ®çš„ç›´æ¥æ”¯æŒã€‚</p><h3 id="ç†è§£-writeint16le" tabindex="-1"><a class="header-anchor" href="#ç†è§£-writeint16le"><span>ç†è§£ <code>writeInt16LE</code></span></a></h3><p>æ–¹æ³•å <code>writeInt16LE</code> å¯ä»¥æ‹†åˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†æ¥ç†è§£ï¼š</p><ul><li><code>write</code>ï¼š å†™å…¥æ•°æ®ã€‚</li><li><code>Int16</code>ï¼š è¡¨ç¤ºå†™å…¥çš„æ•°æ®æ˜¯ä¸€ä¸ª 16 ä½çš„æ•´æ•°ï¼ˆå ç”¨ä¸¤ä¸ªå­—èŠ‚ï¼‰ã€‚</li><li><code>LE</code>ï¼šè¡¨ç¤ºâ€œLittle Endianâ€çš„ç¼©å†™ã€‚åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼ŒEndian æ˜¯æŒ‡æ•°æ®çš„å­—èŠ‚é¡ºåºã€‚Little Endian æ„å‘³ç€ä½ä½å­—èŠ‚æ’åœ¨å‰é¢ï¼ˆè¾ƒå°çš„åœ°å€ï¼‰ï¼Œé«˜ä½å­—èŠ‚æ’åœ¨åé¢ï¼ˆè¾ƒå¤§çš„åœ°å€ï¼‰ã€‚å¦å¤–ä¸€ç§æ˜¯ Big Endianã€‚</li></ul><h3 id="å‡½æ•°å‚æ•°" tabindex="-1"><a class="header-anchor" href="#å‡½æ•°å‚æ•°"><span>å‡½æ•°å‚æ•°</span></a></h3><ul><li><code>value</code>ï¼šéœ€è¦å†™å…¥çš„æ•°å€¼ï¼Œåº”è¯¥åœ¨ <code>Int16</code>ï¼ˆå³ -32,768 è‡³ 32,767ï¼‰çš„èŒƒå›´å†…ã€‚</li><li><code>offset</code>ï¼šå¯é€‰çš„å‚æ•°ï¼ŒæŒ‡å®šåœ¨ <code>Buffer</code> çš„å“ªä¸ªä½ç½®å¼€å§‹å†™å…¥è¿™ä¸ªæ•°å€¼ã€‚å¦‚æœä¸æä¾›ï¼Œé»˜è®¤ä¸º 0ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-1"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æƒ³è¦å°†ä¸€ä¸ªç‰¹å®šçš„ 16 ä½æ•´æ•°å€¼å†™å…¥åˆ°ä¸€ä¸ª Buffer ä¸­ï¼Œå¹¶ä¸”éœ€è¦è€ƒè™‘åˆ°ä½ çš„è®¡ç®—æœºæ¶æ„å¯èƒ½æ˜¯ Little Endian æ ¼å¼çš„ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 2 çš„ç©º Bufferï¼ˆå› ä¸ºä¸€ä¸ª Int16 å ç”¨ 2 ä¸ªå­—èŠ‚ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æƒ³è¦å†™å…¥æ•°å€¼ 12345</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 12345</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ writeInt16LE å°†æ•°å€¼å†™å…¥ Buffer çš„èµ·å§‹ä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeInt16LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå¯èƒ½ç±»ä¼¼äºï¼š`&lt;`Buffer 39 30&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™è¡¨ç¤ºåœ¨ Little Endian æ ¼å¼ä¸­ï¼Œ12345 è¢«ç¼–ç ä¸º ä¸¤ä¸ªå­—èŠ‚ï¼š39 å’Œ 30</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªç©ºçš„ <code>Buffer</code> å®ä¾‹ï¼Œç„¶åè°ƒç”¨ <code>writeInt16LE</code> æ–¹æ³•å°†æ•°å€¼ 12345 å†™å…¥ <code>Buffer</code>ã€‚ç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ Little Endian æ ¼å¼ï¼Œæ‰€ä»¥è¾ƒä½ä½çš„å­—èŠ‚ï¼ˆ39ï¼‰è¢«å†™å…¥åˆ° <code>Buffer</code> çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼Œè€Œè¾ƒé«˜ä½çš„å­—èŠ‚ï¼ˆ30ï¼‰ç´§éšå…¶åã€‚</p><h3 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“"><span>æ€»ç»“</span></a></h3><p><code>writeInt16LE</code> æ–¹æ³•åœ¨ Node.js ä¸­éå¸¸æœ‰ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†æ¶‰åŠç«¯åˆ°ç«¯é€šä¿¡ã€æ–‡ä»¶è¯»å†™ç­‰åœºåˆçš„äºŒè¿›åˆ¶æ•°æ®æ—¶ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¼€å‘è€…å¯ä»¥ç¡®ä¿æ•°æ®æŒ‰ç…§æ­£ç¡®çš„å­—èŠ‚é¡ºåºè¢«å†™å…¥åˆ° Buffer ä¸­ï¼Œæ— è®ºåœ¨ä½•ç§æ¶æ„çš„è®¡ç®—æœºä¸Šæ‰§è¡Œä»£ç ã€‚</p><h3 id="buf-writeint32be-value-offset" tabindex="-1"><a class="header-anchor" href="#buf-writeint32be-value-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwriteint32bevalue-offset" target="_blank" rel="noopener noreferrer">buf.writeInt32BE(value[, offset])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥æ·±å…¥äº†è§£ä¸€ä¸‹ Node.js ä¸­çš„ <code>buf.writeInt32BE(value[, offset])</code> å‡½æ•°ã€‚</p><p>é¦–å…ˆï¼ŒNode.js æ˜¯ä¸€ä¸ªåŸºäº Chrome çš„ V8 JavaScript å¼•æ“çš„å¹³å°ï¼Œå®ƒä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚åœ¨ Node.js ä¸­æœ‰ä¸€ä¸ªå…¨å±€å¯¹è±¡å«åš <code>Buffer</code>ï¼Œè¿™ä¸ªå¯¹è±¡ç”¨æ¥ç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµã€‚</p><p>åœ¨è®¡ç®—æœºä¸­ï¼Œå†…å­˜æ˜¯ä»¥å­—èŠ‚ä¸ºå•ä½å­˜å‚¨æ•°æ®çš„ã€‚ä¸ºäº†èƒ½å¤Ÿæœ‰æ•ˆåœ°æ“ä½œè¿™äº›å­—èŠ‚æ•°æ®ï¼ŒNode.js æä¾›äº† Buffer ç±»æ¥åˆ›å»ºä¸€ä¸ªä¸“é—¨å­˜å‚¨åŸå§‹äºŒè¿›åˆ¶æ•°æ®çš„ç¼“å†²åŒºï¼ˆç±»ä¼¼äºæ•°ç»„ï¼‰ã€‚ä½ å¯ä»¥è®¤ä¸º Buffer å°±åƒä¸€ä¸ªå¯ä»¥å­˜æ”¾å­—èŠ‚çš„å®¹å™¨ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬èŠèŠ <code>writeInt32BE</code> è¿™ä¸ªæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯ Buffer å¯¹è±¡ä¸Šçš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå…è®¸ä½ åœ¨ç¼“å†²åŒºä¸­å†™å…¥ 4 å­—èŠ‚çš„æ•´æ•°ï¼ˆä¹Ÿå°±æ˜¯ 32 ä½æ•´æ•°ï¼‰ã€‚è¿™ä¸ªæ–¹æ³•éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼š</p><ol><li>value: è¦å†™å…¥ç¼“å†²åŒºçš„æ•´æ•°å€¼ã€‚</li><li>offset (å¯é€‰): åç§»é‡ï¼Œè¡¨ç¤ºä»ç¼“å†²åŒºçš„å“ªä¸ªä½ç½®å¼€å§‹å†™å…¥æ•°æ®ã€‚å¦‚æœæ²¡æœ‰æä¾›ï¼Œé»˜è®¤æ˜¯ä» 0 å¼€å§‹ï¼ˆå³ç¼“å†²åŒºçš„èµ·å§‹ä½ç½®ï¼‰ã€‚</li></ol><p><code>writeInt32BE</code> æ–¹æ³•çš„ &quot;BE&quot; æ„å‘³ç€ &quot;Big Endian&quot;ã€‚å¤§ç«¯åºæ˜¯ä¸€ç§å­—èŠ‚åºï¼Œå®ƒå°†æœ€é«˜æœ‰æ•ˆå­—èŠ‚ï¼ˆMSBï¼‰å­˜å‚¨åœ¨æœ€ä½çš„å†…å­˜åœ°å€ä¸Šï¼Œå³ä¸€ä¸ªæ•°å­—çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ˆæœ€å·¦è¾¹çš„å­—èŠ‚ï¼‰ä¼šè¢«æ”¾ç½®åˆ°ç¼“å†²åŒºçš„æŒ‡å®šå¼€å§‹ä½ç½®ã€‚</p><p>æ¥çœ‹å‡ ä¸ªå®é™…ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥ Buffer ç±»</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 4 çš„ç¼“å†²åŒº</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¤ºä¾‹ 1ï¼šå°†æ•°å­— 123456789 å†™å…¥ç¼“å†²åŒº</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeInt32BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">123456789</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º `&lt;`Buffer 07 5b cd 15&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¤ºä¾‹ 2ï¼šæŒ‡å®šåç§»é‡  //æ¥æºï¼šdoc.cherrychat.org è¯·å‹¿å•†ç”¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufferWithOffset</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 6 çš„ç¼“å†²åŒº</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">bufferWithOffset</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeInt32BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">123456789</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»ç¼“å†²åŒºçš„ç¬¬ 2 å­—èŠ‚å¼€å§‹å†™å…¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bufferWithOffset</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º `&lt;`Buffer 00 00 07 5b cd 15&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ç¤ºä¾‹ 1 ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º 4 å­—èŠ‚çš„ç¼“å†²åŒºï¼Œå¹¶ä½¿ç”¨ <code>writeInt32BE</code> æ–¹æ³•å°†æ•´æ•° <code>123456789</code> å†™å…¥åˆ°äº†è¿™ä¸ªç¼“å†²åŒºä¸­ï¼Œä¸å¸¦åç§»é‡é»˜è®¤ä»å¤´å¼€å§‹ã€‚å½“æˆ‘ä»¬æ‰“å°è¿™ä¸ªç¼“å†²åŒºæ—¶ï¼Œå®ƒæ˜¾ç¤ºå‡ºäº†è¿™ä¸ªæ•´æ•°çš„äºŒè¿›åˆ¶æ ¼å¼ã€‚</p><p>åœ¨ç¤ºä¾‹ 2 ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º 6 å­—èŠ‚çš„ç¼“å†²åŒºï¼Œå¹¶å°†ç›¸åŒçš„æ•´æ•°å†™å…¥ç¼“å†²åŒºä¸­ï¼Œä½†è¿™æ¬¡æˆ‘ä»¬æŒ‡å®šäº†ä¸€ä¸ªåç§»é‡ <code>2</code>ã€‚è¿™æ„å‘³ç€æ•´æ•°çš„äºŒè¿›åˆ¶å½¢å¼å°†ä»ç¼“å†²åŒºçš„ç¬¬ä¸‰ä¸ªå­—èŠ‚ï¼ˆç´¢å¼•ä¸º 2 çš„ä½ç½®ï¼‰å¼€å§‹å†™å…¥ã€‚</p><p>è¿™ä¸ªæ–¹æ³•åœ¨å¤„ç†ç½‘ç»œé€šä¿¡ã€æ–‡ä»¶æ“ä½œã€æˆ–ä»»ä½•éœ€è¦ç²¾ç¡®æ§åˆ¶å­—èŠ‚å±‚é¢æ•°æ®çš„åœºæ™¯ä¸­éƒ½éå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªéœ€è¦ä¸ç¡¬ä»¶é€šä¿¡çš„ç¨‹åºï¼Œå¯èƒ½éœ€è¦å‘é€ç‰¹å®šçš„äºŒè¿›åˆ¶æŒ‡ä»¤ï¼Œé‚£ä¹ˆ <code>Buffer</code> ç±»å’Œ <code>writeInt32BE</code> æ–¹æ³•ä¼šéå¸¸æ–¹ä¾¿ï¼Œå› ä¸ºå®ƒä»¬å…è®¸ä½ ç²¾ç¡®åœ°æ„é€ å‡ºå¿…è¦çš„æ•°æ®ç»“æ„ã€‚</p><h3 id="buf-writeint32le-value-offset" tabindex="-1"><a class="header-anchor" href="#buf-writeint32le-value-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwriteint32levalue-offset" target="_blank" rel="noopener noreferrer">buf.writeInt32LE(value[, offset])</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­<code>buf.writeInt32LE(value[, offset])</code>æ–¹æ³•çš„ä½œç”¨å’Œä½¿ç”¨ã€‚</p><p>é¦–å…ˆï¼ŒBuffer å¯¹è±¡æ˜¯ Node.js ä¸­ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ä¸€ä¸ªç±»ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ åœ¨ JavaScript ä¸­å­˜å‚¨å’Œæ“ä½œäºŒè¿›åˆ¶æ•°æ®ã€‚è¿™å¾ˆæœ‰ç”¨ï¼Œå› ä¸º JavaScript æœ¬èº«å¹¶æ²¡æœ‰æä¾›ç›´æ¥æ“ä½œäºŒè¿›åˆ¶æ•°æ®çš„èƒ½åŠ›ã€‚</p><p><code>buf.writeInt32LE(value[, offset])</code>æ˜¯ Buffer ç±»é‡Œé¢çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒçš„ä½œç”¨æ˜¯åœ¨ buffer å¯¹è±¡ä¸­å†™å…¥ä¸€ä¸ª 32 ä½æ•´æ•°ã€‚è¿™ä¸ªæ•´æ•°ä»¥å°ç«¯å­—èŠ‚åºï¼ˆLE, Little-Endianï¼‰çš„æ ¼å¼å†™å…¥ã€‚å°ç«¯å­—èŠ‚åºæŒ‡çš„æ˜¯æœ€ä½æœ‰æ•ˆå­—èŠ‚æ’åœ¨å‰é¢ï¼ˆå†…å­˜åœ°å€å°çš„ä½ç½®ï¼‰ã€‚ç›¸å¯¹çš„è¿˜æœ‰å¤§ç«¯å­—èŠ‚åºï¼ˆBE, Big-Endianï¼‰ï¼Œå…¶ä¸­æœ€é«˜æœ‰æ•ˆå­—èŠ‚æ’åœ¨å‰é¢ã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>value</code>: è¦å†™å…¥ buffer çš„å€¼ï¼Œå®ƒåº”è¯¥æ˜¯ä¸€ä¸ª 32 ä½æ•´æ•°ã€‚</li><li><code>offset</code>: åœ¨ buffer ä¸­å¼€å§‹å†™å…¥çš„ç´¢å¼•ï¼Œé»˜è®¤ä¸º 0ï¼Œä¹Ÿå°±æ˜¯ä» buffer çš„èµ·å§‹ä½ç½®å¼€å§‹å†™ã€‚</li></ul><p>ç°åœ¨æ¥çœ‹å‡ ä¸ªä¾‹å­ï¼š</p><p><strong>ä¾‹å­ 1ï¼šåˆ›å»ºä¸€ä¸ª Bufferï¼Œå¹¶å†™å…¥ä¸€ä¸ª 32 ä½æ•´æ•°</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º4å­—èŠ‚çš„Bufferï¼Œå› ä¸ºä¸€ä¸ª32ä½æ•´æ•°éœ€è¦4å­—èŠ‚ç©ºé—´</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å†™å…¥ä¸€ä¸ª32ä½æ•´æ•°ï¼Œä¾‹å¦‚æˆ‘ä»¬å†™å…¥æ•°å­—1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeInt32LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºBufferçš„å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º 4 å­—èŠ‚çš„ Bufferï¼Œå¹¶åœ¨ index 0 çš„ä½ç½®å†™å…¥äº†æ•°å­— 1ã€‚ç”±äº 1 çš„ 32 ä½è¡¨ç¤ºå½¢å¼ä¸º 00000001ï¼Œåœ¨å°ç«¯åºä¸­å®ƒä¼šè¢«å­˜å‚¨ä¸º<code>01 00 00 00</code>ã€‚</p><p><strong>ä¾‹å­ 2ï¼šå†™å…¥è´Ÿæ•°</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å†™å…¥ä¸€ä¸ª32ä½æ•´æ•°-1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeInt32LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºBufferçš„å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ä½ å†™å…¥-1 æ—¶ï¼Œç”±äºè®¡ç®—æœºä½¿ç”¨è¡¥ç è¡¨ç¤ºè´Ÿæ•°ï¼Œ-1 çš„ 32 ä½è¡¥ç ä¸º<code>FF FF FF FF</code>ï¼Œå› æ­¤åœ¨ Buffer ä¸­å°†ä¼šå­˜å‚¨ä¸º<code>FF FF FF FF</code>ã€‚</p><p><strong>ä¾‹å­ 3ï¼šä¸æŒ‡å®šåç§»é‡</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¸æŒ‡å®šoffsetï¼Œé»˜è®¤ä»0å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeInt32LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">123456789</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºBufferçš„å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çœç•¥äº† offset å‚æ•°ï¼Œæ‰€ä»¥é»˜è®¤æ˜¯ä» Buffer çš„æœ€å¼€å§‹ä½ç½®ï¼ˆ0 ç´¢å¼•ï¼‰å¼€å§‹å†™å…¥ã€‚æ•°å­— 123456789 åœ¨å°ç«¯åºä¸­è¡¨ç¤ºä¸º<code>15 CD 5B 07</code>ã€‚</p><p>æ³¨æ„ï¼Œå½“è°ƒç”¨<code>writeInt32LE</code>å†™å…¥æ•°æ®æ—¶ï¼Œè¯·ç¡®ä¿ Buffer æœ‰è¶³å¤Ÿçš„ç©ºé—´ï¼ˆè‡³å°‘ 4 å­—èŠ‚ï¼‰ï¼Œå¦åˆ™ä¼šæŠ›å‡ºé”™è¯¯ã€‚è€Œä¸”ï¼Œä½ å†™å…¥çš„ value å€¼åº”è¯¥åœ¨ 32 ä½æ•´æ•°èƒ½è¡¨ç¤ºçš„èŒƒå›´å†…ï¼Œå³<code>-2^31</code>åˆ°<code>2^31 - 1</code>ä¹‹é—´ã€‚å¦‚æœ value è¶…å‡ºè¿™ä¸ªèŒƒå›´ï¼Œä¹Ÿä¼šæŠ›å‡ºé”™è¯¯ã€‚</p><h3 id="buf-writeintbe-value-offset-bytelength" tabindex="-1"><a class="header-anchor" href="#buf-writeintbe-value-offset-bytelength"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwriteintbevalue-offset-bytelength" target="_blank" rel="noopener noreferrer">buf.writeIntBE(value, offset, byteLength)</a></span></a></h3><p>åœ¨è§£é‡Š <code>buf.writeIntBE(value, offset, byteLength)</code> ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆéœ€è¦äº†è§£ä¸€äº›åŸºæœ¬æ¦‚å¿µã€‚</p><h3 id="buffer-æ˜¯ä»€ä¹ˆ-1" tabindex="-1"><a class="header-anchor" href="#buffer-æ˜¯ä»€ä¹ˆ-1"><span>Buffer æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code> ç±»æ˜¯ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒå°±åƒä¸€ä¸ªå¯ä»¥å­˜æ”¾åŸå§‹æ•°æ®çš„å®¹å™¨ï¼Œè¿™äº›åŸå§‹æ•°æ®é€šå¸¸æ˜¯æ–‡ä»¶æˆ–è€…ç½‘ç»œä¼ è¾“ä¸­çš„å­—èŠ‚æ•°æ®ã€‚</p><h3 id="ä¸ºä»€ä¹ˆéœ€è¦-buffer" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆéœ€è¦-buffer"><span>ä¸ºä»€ä¹ˆéœ€è¦ Bufferï¼Ÿ</span></a></h3><p>JavaScript æœ€åˆæ˜¯ä¸ºäº†å¤„ç†ç½‘é¡µå’Œæ–‡æœ¬å†…å®¹è®¾è®¡çš„ï¼Œè€Œä¸æ˜¯äºŒè¿›åˆ¶æ•°æ®ã€‚ä½†éšç€ Node.js çš„å‡ºç°ï¼Œéœ€è¦åœ¨æœåŠ¡å™¨ç«¯å¤„ç†å¦‚æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡ç­‰äºŒè¿›åˆ¶å†…å®¹ï¼Œå› æ­¤å¼•å…¥äº† <code>Buffer</code> æ¥å¸®åŠ©å¼€å‘è€…æ“ä½œè¿™ç±»æ•°æ®ã€‚</p><h3 id="big-endian-be-æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#big-endian-be-æ˜¯ä»€ä¹ˆ"><span>Big Endian (BE) æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h3><p>Big Endian æ˜¯ä¸€ç§å­—èŠ‚åºï¼ŒæŒ‡åœ¨å†…å­˜ä¸­å­˜å‚¨å¤šå­—èŠ‚æ•°æ®æ—¶ï¼Œæœ€é‡è¦çš„å­—èŠ‚ï¼ˆç§°ä¸ºé«˜ä½å­—èŠ‚ï¼‰æ’åœ¨æœ€å‰é¢ã€‚ä¾‹å¦‚ï¼Œåœ¨ 16 ä½æ•´æ•° 0x1234 ä¸­ï¼Œ0x12 æ˜¯é«˜ä½å­—èŠ‚ï¼Œ0x34 æ˜¯ä½ä½å­—èŠ‚ï¼Œåœ¨ Big Endian æ¨¡å¼ä¸‹ï¼Œå®ƒä»¬åœ¨å†…å­˜ä¸­çš„æ’åˆ—é¡ºåºæ˜¯ <code>0x12 0x34</code>ã€‚</p><h3 id="writeintbe-å‡½æ•°åšä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#writeintbe-å‡½æ•°åšä»€ä¹ˆ"><span>writeIntBE å‡½æ•°åšä»€ä¹ˆï¼Ÿ</span></a></h3><p><code>writeIntBE</code> æ–¹æ³•å…è®¸ä½ å°†ä¸€ä¸ªæ•´æ•°ä»¥ Big Endian å­—èŠ‚åºå†™å…¥åˆ° <code>Buffer</code> å¯¹è±¡ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå¯ä»¥æŠŠä¸€ä¸ªæ•°å­—è½¬æ¢æˆä¸€ä¸²ç‰¹å®šé•¿åº¦çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œå¹¶æŒ‰ç…§ Big Endian çš„è§„åˆ™å­˜æ”¾åˆ° <code>Buffer</code> ä¸­ã€‚</p><ul><li><code>value</code>ï¼šä½ æƒ³è¦å†™å…¥ <code>Buffer</code> çš„æ•´æ•°å€¼ã€‚</li><li><code>offset</code>ï¼šä» <code>Buffer</code> çš„å“ªä¸ªä½ç½®å¼€å§‹å†™å…¥ã€‚</li><li><code>byteLength</code>ï¼šè¿™ä¸ªæ•´æ•°å ç”¨å¤šå°‘å­—èŠ‚ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-2"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æƒ³è¦åˆ›å»ºä¸€ä¸ª <code>Buffer</code> å¹¶å†™å…¥ä¸€ä¸ª 16 ä½çš„æ•´æ•°ï¼ˆæ¯”å¦‚ 300ï¼‰ï¼Œé‚£ä¹ˆä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º2çš„Bufferï¼Œå› ä¸º16ä½æ•´æ•°éœ€è¦2å­—èŠ‚</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeIntBE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">300</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†æ•°å­—300æŒ‰ç…§Big Endianå­—èŠ‚åºå†™å…¥Buffer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š`&lt;`Buffer 01 2c&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œ300 çš„åå…­è¿›åˆ¶è¡¨ç¤ºæ˜¯ <code>0x012C</code>ï¼Œå®ƒè¢«æ­£ç¡®åœ°ä»¥ Big Endian æ ¼å¼å†™å…¥äº†ä¸¤ä¸ªå­—èŠ‚çš„ <code>Buffer</code> ä¸­ã€‚</p><p>å¦‚æœä½ æƒ³å†™å…¥ä¸€ä¸ª 32 ä½çš„æ•´æ•° 70000ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º4çš„Bufferï¼Œå› ä¸º32ä½æ•´æ•°éœ€è¦4å­—èŠ‚</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeIntBE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">70000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†æ•°å­—70000æŒ‰ç…§Big Endianå­—èŠ‚åºå†™å…¥Buffer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š`&lt;`Buffer 00 01 11 70&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ70000 çš„åå…­è¿›åˆ¶è¡¨ç¤ºæ˜¯ <code>0x00011170</code>ï¼Œå¹¶ä¸”è¢«æ­£ç¡®åœ°å†™å…¥åˆ°äº†å››ä¸ªå­—èŠ‚çš„ <code>Buffer</code> ä¸­ã€‚</p><p>é€šè¿‡ä½¿ç”¨ <code>writeIntBE</code>ï¼Œä½ å¯ä»¥ç¡®ä¿æ‰€å†™å…¥çš„æ•°å€¼èƒ½å¤Ÿè¢«è¯»å–ç³»ç»Ÿç†è§£ï¼Œæ— è®ºå…¶åœ¨ä¸åŒè®¡ç®—æœºæ¶æ„ï¼ˆæœ‰äº›å¯èƒ½é»˜è®¤ä½¿ç”¨ Little Endian å­—èŠ‚åºï¼‰ä¹‹é—´å¦‚ä½•ä¼ è¾“ã€‚è¿™å¯¹äºç½‘ç»œåè®®å’ŒäºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼å°¤ä¸ºé‡è¦ï¼Œå› ä¸ºå®ƒä»¬å¸¸å¸¸è§„å®šäº†æ•°æ®å¿…é¡»ä»¥ Big Endian æ ¼å¼è¿›è¡Œç¼–ç ã€‚</p><h3 id="buf-writeintle-value-offset-bytelength" tabindex="-1"><a class="header-anchor" href="#buf-writeintle-value-offset-bytelength"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwriteintlevalue-offset-bytelength" target="_blank" rel="noopener noreferrer">buf.writeIntLE(value, offset, byteLength)</a></span></a></h3><p><code>buf.writeIntLE(value, offset, byteLength)</code> æ˜¯ä¸€ä¸ªç”¨äºå‘ç¼“å†²åŒºï¼ˆBufferï¼‰å†™å…¥æ•°æ®çš„æ–¹æ³•ï¼Œå®ƒæ˜¯ Node.js ä¸­ Buffer å¯¹è±¡æä¾›çš„ä¸€ç§ APIã€‚åœ¨è§£é‡Šè¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç†è§£å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p><ol><li><p><strong>Buffer</strong>: åœ¨ Node.js ä¸­ï¼ŒBuffer ç±»ç”¨æ¥æ“ä½œäºŒè¿›åˆ¶æ•°æ®æµã€‚ç”±äº JavaScript æœ¬èº«ä¸åƒå…¶ä»–è¯­è¨€é‚£æ ·æœ‰å¯¹äºŒè¿›åˆ¶æ•°æ®çš„ç›´æ¥æ”¯æŒï¼ŒBuffer ç±»å°±æˆäº†å¤„ç† TCP æµæˆ–æ–‡ä»¶ç³»ç»Ÿæ“ä½œæ—¶éå¸¸æœ‰ç”¨çš„å·¥å…·ã€‚</p></li><li><p><strong>å­—èŠ‚åºï¼ˆByte Orderï¼‰</strong>: è®¡ç®—æœºå­˜å‚¨æ•°å­—æ—¶å­˜åœ¨ä¸¤ç§æ–¹å¼ï¼Œå³å¤§ç«¯åºï¼ˆBig-Endianï¼‰å’Œå°ç«¯åºï¼ˆLittle-Endianï¼‰ã€‚ç®€å•æ¥è¯´ï¼Œå¤§ç«¯åºè¡¨ç¤ºé«˜ä½å­—èŠ‚æ’æ”¾åœ¨å†…å­˜çš„å‰é¢ï¼ˆä½åœ°å€ç«¯ï¼‰ï¼Œè€Œå°ç«¯åºåˆ™ç›¸åï¼Œé«˜ä½å­—èŠ‚æ’åœ¨åé¢ï¼ˆé«˜åœ°å€ç«¯ï¼‰ã€‚</p></li></ol><p>ç°åœ¨æ¥çœ‹ <code>writeIntLE</code> æ–¹æ³•æœ¬èº«ï¼š</p><ul><li><strong>value</strong>: è¦å†™å…¥çš„æ•´æ•°å€¼ã€‚</li><li><strong>offset</strong>: ç¼“å†²åŒºå¼€å§‹å†™å…¥çš„ç´¢å¼•ä½ç½®ã€‚</li><li><strong>byteLength</strong>: å†™å…¥çš„å­—èŠ‚æ•°ã€‚</li></ul><p><code>writeIntLE</code> æ–¹æ³•å…è®¸ä½ ä»¥<strong>å°ç«¯åº</strong>çš„å½¢å¼å°†ä¸€ä¸ªæ•´æ•°å†™å…¥åˆ°ç¼“å†²åŒºä¸­ã€‚ä½ å¯ä»¥æŒ‡å®šå†™å…¥æ•´æ•°çš„å¤§å°ï¼ˆé€šè¿‡ <code>byteLength</code> å‚æ•°ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥æ§åˆ¶ä»ç¼“å†²åŒºçš„å“ªä¸ªä½ç½®å¼€å§‹å†™å…¥ï¼ˆé€šè¿‡ <code>offset</code> å‚æ•°ï¼‰ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€äº›å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><h3 id="ç¤ºä¾‹-1-å†™å…¥ä¸€ä¸ª-16-ä½æ•´æ•°" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-å†™å…¥ä¸€ä¸ª-16-ä½æ•´æ•°"><span>ç¤ºä¾‹ 1ï¼šå†™å…¥ä¸€ä¸ª 16 ä½æ•´æ•°</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 4 çš„ç¼“å†²åŒºï¼Œå¹¶ç”¨ 0 å¡«å……</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeIntLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x1234</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†æ•´æ•° 0x1234 å†™å…¥ç¼“å†²åŒºçš„å‰ä¸¤ä¸ªå­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: `&lt;`Buffer 34 12 00 00&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ0x1234 æ˜¯ä¸€ä¸ªåå…­è¿›åˆ¶çš„æ•´æ•°ã€‚è¯¥æ–¹æ³•ä¼šæŠŠè¿™ä¸ªæ•°å€¼ä»¥å°ç«¯åºå†™å…¥åˆ°ç¼“å†²åŒºçš„å‰ä¸¤ä¸ªå­—èŠ‚ã€‚å› æ­¤ï¼Œ34 æ˜¯ä½ä½å­—èŠ‚ï¼Œè¢«é¦–å…ˆå†™å…¥ï¼›12 æ˜¯é«˜ä½å­—èŠ‚ï¼Œè¢«å†™å…¥åˆ°ç¬¬äºŒä¸ªå­—èŠ‚ä½ç½®ã€‚</p><h3 id="ç¤ºä¾‹-2-å†™å…¥ä¸€ä¸ª-32-ä½æ•´æ•°" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å†™å…¥ä¸€ä¸ª-32-ä½æ•´æ•°"><span>ç¤ºä¾‹ 2ï¼šå†™å…¥ä¸€ä¸ª 32 ä½æ•´æ•°</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 6 çš„ç¼“å†²åŒºï¼Œå¹¶ç”¨ 0 å¡«å……</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeIntLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x12345678</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†æ•´æ•° 0x12345678 å†™å…¥ç¼“å†²åŒºçš„å‰å››ä¸ªå­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: `&lt;`Buffer 78 56 34 12 00 00&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ0x12345678 æ˜¯ä¸€ä¸ªè¾ƒå¤§çš„åå…­è¿›åˆ¶æ•´æ•°ã€‚è¯¥æ–¹æ³•ä¼šæŠŠæ•°å€¼ä»¥å°ç«¯åºå†™å…¥ç¼“å†²åŒºçš„å‰å››ä¸ªå­—èŠ‚ï¼Œå…¶ä¸­ 78 æ˜¯æœ€ä½ä½ï¼Œè¢«é¦–å…ˆå†™å…¥ã€‚</p><h3 id="ç¤ºä¾‹-3-å°è¯•å†™å…¥è¶…å‡ºèŒƒå›´çš„æ•´æ•°" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-å°è¯•å†™å…¥è¶…å‡ºèŒƒå›´çš„æ•´æ•°"><span>ç¤ºä¾‹ 3ï¼šå°è¯•å†™å…¥è¶…å‡ºèŒƒå›´çš„æ•´æ•°</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 4 çš„ç¼“å†²åŒºï¼Œå¹¶ç”¨ 0 å¡«å……</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeIntLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x123456789</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°è¯•å†™å…¥ä¸€ä¸ªå¤§äº 32 ä½çš„æ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Error:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ•è·é”™è¯¯å¹¶æ‰“å°é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç”±äºæ•´æ•° 0x123456789 å¤§äºå¯ä»¥å®¹çº³åœ¨ 4 å­—èŠ‚ä¸­çš„èŒƒå›´ï¼Œæ‰€ä»¥å½“ä½ å°è¯•å†™å…¥æ—¶ï¼Œä¼šå¯¼è‡´ä¸€ä¸ªèŒƒå›´é”™è¯¯ï¼ˆRangeErrorï¼‰ï¼Œå¹¶æ•è·æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚</p><p>äº†è§£è¿™äº›æ–¹æ³•å¦‚ä½•å·¥ä½œéå¸¸é‡è¦ï¼Œå› ä¸ºä»–ä»¬å…è®¸ä½ åœ¨è¿›è¡Œç½‘ç»œé€šä¿¡æˆ–æ–‡ä»¶æ“ä½œæ—¶ç²¾ç¡®æ§åˆ¶æ•°æ®çš„è¡¨ç¤ºå’Œä¼ è¾“æ–¹å¼ã€‚</p><h3 id="buf-writeuint8-value-offset" tabindex="-1"><a class="header-anchor" href="#buf-writeuint8-value-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwriteuint8value-offset" target="_blank" rel="noopener noreferrer">buf.writeUInt8(value[, offset])</a></span></a></h3><p><code>buf.writeUInt8(value[, offset])</code> æ˜¯ä¸€ä¸ªåœ¨ Node.js ä¸­ç”¨äºå‘ <code>Buffer</code> å¯¹è±¡å†™å…¥æ•°æ®çš„æ–¹æ³•ã€‚<code>Buffer</code> å¯¹è±¡æ˜¯ä¸€ç§ç”¨äºè¡¨ç¤ºå›ºå®šé•¿åº¦çš„å­—èŠ‚åºåˆ—çš„æ•°æ®ç»“æ„ï¼Œå¸¸ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµï¼Œæ¯”å¦‚æ–‡ä»¶è¯»å†™ã€ç½‘ç»œé€šä¿¡ç­‰ã€‚</p><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>value</code>: è¿™æ˜¯ä½ æƒ³è¦å†™å…¥ Buffer çš„æ— ç¬¦å·æ•´æ•°å€¼ï¼ˆunsigned 8-bit integerï¼‰ï¼Œå®ƒåº”è¯¥æ˜¯åœ¨ 0 åˆ° 255 (åŒ…æ‹¬ 0 å’Œ 255) çš„èŒƒå›´å†…ã€‚</li><li><code>offset</code> (å¯é€‰): è¿™ä¸ªå‚æ•°æŒ‡å®šäº†åœ¨ Buffer ä¸­å¼€å§‹å†™å…¥çš„ä½ç½®ï¼ˆåç§»é‡ï¼‰ã€‚å®ƒçš„é»˜è®¤å€¼æ˜¯ 0ï¼Œæ„å‘³ç€å¦‚æœä¸æä¾›è¿™ä¸ªå‚æ•°ï¼Œå†™å…¥ä¼šä» Buffer çš„å¼€å¤´å¼€å§‹ã€‚</li></ul><p>ä»¥ä¸‹æ˜¯ <code>buf.writeUInt8</code> æ–¹æ³•çš„ä¸€ä¸ªå®é™…è¿ç”¨ä¾‹å­ï¼š</p><h3 id="ç¤ºä¾‹-1-åŸºæœ¬ä½¿ç”¨-1" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åŸºæœ¬ä½¿ç”¨-1"><span>ç¤ºä¾‹ 1ï¼šåŸºæœ¬ä½¿ç”¨</span></a></h3><p>å‡è®¾æˆ‘ä»¬éœ€è¦å‘ä¸€ä¸ª Buffer ä¸­å†™å…¥ä¸€ä¸ª 8 ä½æ— ç¬¦å·æ•´æ•°ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè¶³å¤Ÿå¤§çš„ Buffer æ¥å­˜å‚¨è¿™ä¸ªæ•´æ•°ï¼ˆå› ä¸ºä¸€ä¸ª 8 ä½çš„æ•´æ•°åªéœ€è¦ 1 ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª 1 å­—èŠ‚å¤§å°çš„ Bufferï¼‰ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º 1 å­—èŠ‚çš„ Buffer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeUInt8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">255</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ Buffer çš„ç¬¬ 0 ä¸ªä½ç½®å†™å…¥å€¼ 255</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š`&lt;`Buffer ff&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>255</code> æ˜¯æˆ‘ä»¬æƒ³è¦å†™å…¥çš„å€¼ï¼Œè€Œ <code>0</code> è¡¨ç¤ºå†™å…¥æ“ä½œçš„èµ·å§‹ä½ç½®æ˜¯ Buffer çš„ç¬¬ 0 ä¸ªå­—èŠ‚ã€‚æ§åˆ¶å°è¾“å‡º <code>&lt;`Buffer ff`&gt;</code>è¡¨ç¤º Buffer ä¸­åŒ…å«ä¸€ä¸ªå­—èŠ‚ï¼Œå…¶å€¼ä¸º<code>ff</code>ï¼Œè¿™æ˜¯åå…­è¿›åˆ¶è¡¨ç¤ºå½¢å¼ã€‚</p><h3 id="ç¤ºä¾‹-2-å¸¦åç§»é‡çš„å†™å…¥" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å¸¦åç§»é‡çš„å†™å…¥"><span>ç¤ºä¾‹ 2ï¼šå¸¦åç§»é‡çš„å†™å…¥</span></a></h3><p>æ¥ä¸‹æ¥çœ‹ä¸€ä¸ªä½¿ç”¨åç§»é‡çš„ä¾‹å­ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ›´å¤§çš„ Bufferï¼Œå¹¶ä¸”æˆ‘ä»¬æƒ³åœ¨ä¸åŒçš„ä½ç½®å†™å…¥å¤šä¸ªå­—èŠ‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º 4 å­—èŠ‚çš„ Buffer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‘ Buffer ä¸­å†™å…¥å‡ ä¸ªä¸åŒçš„å€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeUInt8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ç¬¬ 0 ä¸ªä½ç½®å†™å…¥æ•°å­— 10</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeUInt8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ç¬¬ 1 ä¸ªä½ç½®å†™å…¥æ•°å­— 20</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeUInt8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ç¬¬ 2 ä¸ªä½ç½®å†™å…¥æ•°å­— 30</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeUInt8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ç¬¬ 3 ä¸ªä½ç½®å†™å…¥æ•°å­— 40</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºï¼š`&lt;`Buffer 0a 14 1e 28&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª 4 å­—èŠ‚çš„ Bufferï¼Œå¹¶ä¸”åœ¨ä¸åŒçš„ä½ç½®åˆ†åˆ«å†™å…¥äº†ä¸åŒçš„å€¼ï¼ˆ10, 20, 30, 40ï¼‰ã€‚æ¯æ¬¡å†™å…¥æ—¶ï¼Œæˆ‘ä»¬éƒ½é€šè¿‡ <code>offset</code> å‚æ•°æŒ‡å®šäº†å†™å…¥çš„èµ·å§‹ä½ç½®ï¼Œä»è€Œå¯ä»¥å°†å¤šä¸ªå€¼é¡ºåºåœ°å­˜æ”¾åœ¨ Buffer ä¸­ã€‚</p><p>ç†è§£ <code>buf.writeUInt8</code> æ˜¯å¾ˆé‡è¦çš„ï¼Œå°¤å…¶æ˜¯å½“ä½ éœ€è¦ç²¾ç¡®åœ°æ§åˆ¶å¦‚ä½•å‘ Buffer ä¸­å†™å…¥æ•°æ®ï¼Œæˆ–è€…å½“ä½ åœ¨å¤„ç†è¯¸å¦‚ç½‘ç»œåè®®åŒ…ã€äºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼ç­‰éœ€è¦ç›´æ¥ä¸äºŒè¿›åˆ¶æ•°æ®æ‰“äº¤é“çš„åœºæ™¯ã€‚</p><h3 id="buf-writeuint16be-value-offset" tabindex="-1"><a class="header-anchor" href="#buf-writeuint16be-value-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwriteuint16bevalue-offset" target="_blank" rel="noopener noreferrer">buf.writeUInt16BE(value[, offset])</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹ <code>buf.writeUInt16BE(value[, offset])</code> è¿™ä¸ªæ–¹æ³•ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code> å¯¹è±¡æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„å…¨å±€å¯¹è±¡ã€‚å½“ä½ éœ€è¦å¤„ç†åƒ TCP æµæˆ–è€…æ–‡ä»¶ç³»ç»Ÿæ“ä½œè¿™æ ·çš„äºŒè¿›åˆ¶åŒ…æ—¶ï¼Œä½ é€šå¸¸ä¼šä½¿ç”¨ Buffer æ¥å¤„ç†è¿™äº›æ•°æ®ã€‚</p><p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹ <code>writeUInt16BE</code> è¿™ä¸ªæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¥å¾€ buffer å¯¹è±¡ä¸­å†™å…¥ä¸€ä¸ªæ— ç¬¦å·çš„ã€16 ä½çš„æ•´æ•°ï¼Œå¹¶ä¸”ä»¥å¤§ç«¯å­—èŠ‚åºï¼ˆBig-Endianï¼‰çš„æ–¹å¼æ¥å†™ã€‚åœ¨å¤§ç«¯å­—èŠ‚åºä¸­ï¼Œæœ€é«˜æœ‰æ•ˆä½ï¼ˆå³ &quot;big end&quot;ï¼‰å­˜å‚¨åœ¨æ•°å­—è¡¨ç¤ºä¸­çš„æœ€ä½å†…å­˜åœ°å€ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä¸€ä¸ªå¤šå­—èŠ‚å€¼ä¸­ï¼Œæœ€é‡è¦çš„é‚£ä¸ªå­—èŠ‚å°†è¢«æ”¾åœ¨æœ€å‰é¢ï¼‰ã€‚</p><p>è¿™ä¸ªæ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š</p><ol><li><code>value</code>: è¦å†™å…¥çš„æ— ç¬¦å·çŸ­æ•´æ•°å€¼ã€‚</li><li><code>offset</code>(å¯é€‰): åœ¨ buffer ä¸­å¼€å§‹å†™å…¥çš„ä½ç½®ï¼Œé»˜è®¤ä¸º 0ã€‚</li></ol><p>å‚æ•° <code>value</code> å¿…é¡»åœ¨ä¸€ä¸ªæ— ç¬¦å· 16 ä½æ•´æ•°å¯ä»¥è¡¨ç¤ºçš„èŒƒå›´å†…ï¼Œå³ 0 è‡³ 65535 (0xFFFF)ã€‚</p><p>å¦‚æœ <code>offset</code> + 2 è¶…è¿‡äº† buffer çš„é•¿åº¦ï¼Œå°±ä¼šæŠ›å‡ºä¸€ä¸ª <code>RANGE_ERROR</code> é”™è¯¯ï¼Œå› ä¸ºæ¯æ¬¡å†™å…¥éƒ½éœ€è¦ 2 ä¸ªå­—èŠ‚çš„ç©ºé—´ï¼ˆå› ä¸º 16 ä½ç­‰äº 2 ä¸ªå­—èŠ‚ï¼‰ã€‚</p><p>ä»¥ä¸‹æ˜¯å‡ ä¸ªå®é™…çš„ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 4 å­—èŠ‚çš„ç©º Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ writeUInt16BE æ–¹æ³•å†™å…¥ä¸€ä¸ªå€¼</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œæˆ‘ä»¬å†™å…¥å€¼ 0x1234 åˆ° buffer çš„èµ·å§‹ä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeUInt16BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x1234</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºåº”è¯¥ä¸ºï¼š `&lt;`Buffer 12 34 00 00&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å†å†™å…¥ä¸€ä¸ªå€¼ï¼Œä½†è¿™æ¬¡æˆ‘ä»¬ä»ç¬¬ä¸‰ä¸ªå­—èŠ‚å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬å†™å…¥å€¼ 0xABCD ä» buffer ä¸­çš„ç¬¬ 3 ä¸ªå­—èŠ‚å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeUInt16BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xabcd</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºåº”è¯¥ä¸ºï¼š `&lt;`Buffer 12 34 ab cd&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º 4 å­—èŠ‚çš„ç©º Bufferã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>writeUInt16BE</code> æ–¹æ³•å‘è¿™ä¸ª Buffer ä¸­å†™å…¥äº†ä¸¤ä¸ª 16-bit çš„æ•´æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯ <code>0x1234</code>ï¼Œå®ƒè¢«å†™å…¥åˆ° buffer çš„èµ·å§‹ä½ç½®ï¼›ç¬¬äºŒä¸ªæ˜¯ <code>0xABCD</code>ï¼Œå®ƒä» buffer ä¸­çš„ç¬¬ 3 ä¸ªå­—èŠ‚å¼€å§‹å†™å…¥ã€‚</p><p>è¿™ç§ç±»å‹çš„æ“ä½œé€šå¸¸åœ¨ä½ éœ€è¦ç²¾ç¡®æ§åˆ¶å¦‚ä½•åœ¨å†…å­˜ä¸­è¡¨ç¤ºå’Œå­˜å‚¨æ•°å€¼æ—¶éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚åœ¨ç½‘ç»œåè®®æˆ–è€…æ–‡ä»¶æ ¼å¼ç¼–ç ä¸­å¸¸è§åˆ°éœ€è¦æŒ‰ç…§ç‰¹å®šå­—èŠ‚é¡ºåºè¯»å†™æ•´æ•°ã€‚</p><h3 id="buf-writeuint16le-value-offset" tabindex="-1"><a class="header-anchor" href="#buf-writeuint16le-value-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwriteuint16levalue-offset" target="_blank" rel="noopener noreferrer">buf.writeUInt16LE(value[, offset])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­ <code>buf.writeUInt16LE(value[, offset])</code> æ–¹æ³•æ˜¯åšä»€ä¹ˆçš„ï¼Œä»¥åŠå¦‚ä½•åœ¨å®é™…ä¸­ä½¿ç”¨å®ƒã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦çŸ¥é“ Node.js ä¸­çš„ <code>Buffer</code> å¯¹è±¡æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„å…¨å±€å¯¹è±¡ã€‚åœ¨ç½‘ç»œä¼ è¾“ã€æ–‡ä»¶æ“ä½œç­‰åœºæ™¯ä¸­ï¼Œç»å¸¸ä¼šç”¨åˆ° Buffer æ¥å¤„ç†åƒå›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘è¿™æ ·çš„äºŒè¿›åˆ¶æ•°æ®ã€‚</p><p><code>buf.writeUInt16LE(value[, offset])</code> æ˜¯ Buffer å¯¹è±¡æä¾›çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºå°†ä¸€ä¸ª 16 ä½çš„æ— ç¬¦å·æ•´æ•°å†™å…¥åˆ° Buffer ä¸­ï¼Œè€Œä¸”æ˜¯æŒ‰ç…§â€œå°ç«¯â€ï¼ˆlittle-endianï¼‰çš„å­—èŠ‚é¡ºåºã€‚è¿™é‡Œå¯èƒ½éœ€è¦è§£é‡Šä¸¤ä¸ªæ¦‚å¿µï¼š</p><ol><li><p><strong>æ— ç¬¦å·æ•´æ•°</strong>ï¼šæŒ‡çš„æ˜¯åªèƒ½è¡¨ç¤ºéè´Ÿæ•´æ•°ï¼ˆ0 åŠæ­£æ•´æ•°ï¼‰çš„æ•°æ®ç±»å‹ï¼Œä¸åŒ…å«ç¬¦å·ä½ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ— ç¬¦å·çš„ 16 ä½æ•´æ•°èƒ½å¤Ÿè¡¨ç¤ºçš„èŒƒå›´æ˜¯ä» 0 åˆ° 65535ã€‚</p></li><li><p><strong>å°ç«¯å­—èŠ‚åºï¼ˆLittle-Endianï¼‰</strong>ï¼šæ˜¯ä¸€ç§è®¡ç®—æœºå­˜å‚¨æ•°æ®çš„æ–¹å¼ï¼ŒæŒ‡çš„æ˜¯æœ€ä½æœ‰æ•ˆå­—èŠ‚å­˜æ”¾åœ¨å†…å­˜çš„æœ€ä½åœ°å€ç«¯ï¼Œå³ &quot;å°ç«¯&quot;ã€‚ç›¸å¯¹åº”çš„æœ‰â€œå¤§ç«¯â€ï¼ˆBig-Endianï¼‰ï¼Œå³æœ€é«˜æœ‰æ•ˆå­—èŠ‚æ”¾åœ¨æœ€ä½åœ°å€ã€‚è®¡ç®—æœºçš„å­—èŠ‚åºä¸åŒä¼šå½±å“æ•°æ®çš„è¯»å†™ã€‚</p></li></ol><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>value</code> æ˜¯è¦å†™å…¥ Buffer çš„æ— ç¬¦å·çŸ­æ•´æ•°ï¼ˆ16 ä½ï¼‰ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªæ•°å€¼ä¸èƒ½è¶…è¿‡æ— ç¬¦å· 16 ä½æ•´æ•°çš„æœ€å¤§å€¼ï¼Œä¹Ÿå°±æ˜¯ 65535ã€‚</li><li><code>offset</code> æ˜¯ä¸€ä¸ªå¯é€‰çš„æ•°å­—å‚æ•°ï¼Œè¡¨ç¤ºä» Buffer å¯¹è±¡çš„èµ·å§‹ä½ç½®å¼€å§‹ï¼Œè·³è¿‡å¤šå°‘å­—èŠ‚åå¼€å§‹å†™å…¥è¿™ä¸ªæ•°å€¼ã€‚å¦‚æœçœç•¥è¿™ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆå°±ä» Buffer çš„å¼€å¤´å†™èµ·ã€‚</li></ul><p>ä¸¾å‡ ä¸ªä¾‹å­æ¥è¯´æ˜ï¼š</p><h3 id="å®ä¾‹-1-åˆ›å»ºä¸€ä¸ª-buffer-å¹¶å†™å…¥ä¸€ä¸ª-16-ä½æ— ç¬¦å·æ•´æ•°" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-1-åˆ›å»ºä¸€ä¸ª-buffer-å¹¶å†™å…¥ä¸€ä¸ª-16-ä½æ— ç¬¦å·æ•´æ•°"><span>å®ä¾‹ 1ï¼šåˆ›å»ºä¸€ä¸ª Buffer å¹¶å†™å…¥ä¸€ä¸ª 16 ä½æ— ç¬¦å·æ•´æ•°</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 4 å­—èŠ‚çš„ Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ writeUInt16LE æ–¹æ³•å†™å…¥ä¸€ä¸ªæ•°å€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeUInt16LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">12345</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ buffer çš„ç¬¬ 0 ä¸ªå­—èŠ‚å¤„å¼€å§‹å†™å…¥æ•°å€¼ 12345</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªå¤§å°ä¸º 4 ä¸ªå­—èŠ‚çš„æ–° Bufferã€‚ç„¶åæˆ‘ä»¬è°ƒç”¨ <code>writeUInt16LE</code> æ–¹æ³•ï¼Œåœ¨ Buffer çš„å¼€å¤´å†™å…¥äº†ä¸€ä¸ª 16 ä½çš„æ— ç¬¦å·æ•´æ•°ï¼ˆ12345ï¼‰ã€‚å› ä¸º JavaScript ä¸­çš„æ•°å­—é»˜è®¤æ˜¯å¤§ç«¯æ ¼å¼ï¼Œè€Œ <code>writeUInt16LE</code> å†™å…¥çš„æ˜¯å°ç«¯æ ¼å¼ï¼Œæ‰€ä»¥åœ¨ Buffer ä¸­çš„æ’åˆ—é¡ºåºä¸æ•°å­—åœ¨å†…å­˜ä¸­çš„å­˜å‚¨é¡ºåºå¯èƒ½ä¸åŒã€‚</p><h3 id="å®ä¾‹-2-å‘-buffer-ä¸­å†™å…¥ä¸¤ä¸ª-16-ä½æ— ç¬¦å·æ•´æ•°" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-2-å‘-buffer-ä¸­å†™å…¥ä¸¤ä¸ª-16-ä½æ— ç¬¦å·æ•´æ•°"><span>å®ä¾‹ 2ï¼šå‘ Buffer ä¸­å†™å…¥ä¸¤ä¸ª 16 ä½æ— ç¬¦å·æ•´æ•°</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ†é…ä¸€ä¸ª 4 å­—èŠ‚é•¿çš„ Bufferï¼ˆå¯ä»¥å­˜å‚¨ä¸¤ä¸ª 16 ä½æ•´æ•°ï¼‰</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å†™å…¥ä¸¤ä¸ªæ— ç¬¦å·æ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeUInt16LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">65535</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æœ€å¤§çš„ 16 ä½æ— ç¬¦å·æ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeUInt16LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ Buffer ç¬¬ 3 å’Œç¬¬ 4 å­—èŠ‚å†™å…¥æ•°å€¼ 256</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åŒæ ·åˆ›å»ºäº†ä¸€ä¸ª 4 å­—èŠ‚çš„ Bufferã€‚æ¥ç€ï¼Œæˆ‘ä»¬åœ¨ Buffer çš„èµ·å§‹ä½ç½®å†™å…¥äº†æœ€å¤§çš„ 16 ä½æ— ç¬¦å·æ•´æ•°ï¼ˆ65535ï¼‰ï¼Œç„¶ååœ¨ç¬¬ 3 ä¸ªå­—èŠ‚çš„ä½ç½®ï¼ˆå³åç§»é‡ä¸º 2ï¼‰å†™å…¥äº†å¦ä¸€ä¸ªæ•°å€¼ï¼ˆ256ï¼‰ã€‚è¿™é‡Œæ¯ä¸ªæ— ç¬¦å·æ•´æ•°å ç”¨ 2 ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ Buffer æ­£å¥½è¢«å¡«æ»¡ã€‚</p><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ åº”è¯¥å¯ä»¥ç†è§£ <code>buf.writeUInt16LE</code> æ–¹æ³•æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä»¥åŠå®ƒåœ¨å®é™…ç¼–ç¨‹ä¸­æ˜¯å¦‚ä½•è¢«ä½¿ç”¨çš„ã€‚è¿™ä¸ªæ–¹æ³•åœ¨å¤„ç†äºŒè¿›åˆ¶é€šä¿¡åè®®æˆ–æ–‡ä»¶æ ¼å¼æ—¶å°¤å…¶æœ‰ç”¨ï¼Œå› ä¸ºä½ ç»å¸¸éœ€è¦ç²¾ç¡®åœ°æ§åˆ¶å­—èŠ‚åºå’Œæ•°æ®çš„æ’åˆ—æ–¹å¼ã€‚</p><h3 id="buf-writeuint32be-value-offset" tabindex="-1"><a class="header-anchor" href="#buf-writeuint32be-value-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwriteuint32bevalue-offset" target="_blank" rel="noopener noreferrer">buf.writeUInt32BE(value[, offset])</a></span></a></h3><p>å½“ç„¶ï¼Œè®©æˆ‘æ¥è¯¦ç»†ä¸ºä½ è§£é‡Šä¸€ä¸‹ Node.js ä¸­ <code>buf.writeUInt32BE(value[, offset])</code> æ–¹æ³•çš„ä½œç”¨å’Œä½¿ç”¨ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ Node.js ä¸­çš„ Buffer å¯¹è±¡æ˜¯ä»€ä¹ˆã€‚Buffer æ˜¯ Node.js ä¸­ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ä¸€ä¸ªç±»ï¼Œå®ƒå¯ä»¥å­˜å‚¨ä»»æ„å¤§å°çš„æ•°æ®ã€‚åœ¨å¤„ç†æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡ç­‰éœ€è¦æ“ä½œäºŒè¿›åˆ¶æ•°æ®çš„åœºæ™¯æ—¶éå¸¸æœ‰ç”¨ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥èšç„¦äº <code>writeUInt32BE</code> è¿™ä¸ªæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯ Buffer ç±»çš„ä¸€ä¸ªå®ä¾‹æ–¹æ³•ï¼Œä½œç”¨æ˜¯å°†ä¸€ä¸ªæ— ç¬¦å·çš„ 32 ä½æ•´æ•°ï¼ˆ4 å­—èŠ‚ï¼‰å†™å…¥åˆ° buffer ä¸­ï¼Œä»¥å¤§ç«¯åºï¼ˆBig-Endianï¼‰çš„å½¢å¼ã€‚æ‰€è°“çš„å¤§ç«¯åºï¼Œå³æœ€é«˜æœ‰æ•ˆå­—èŠ‚ï¼ˆMSBï¼‰å­˜å‚¨åœ¨æœ€ä½çš„å†…å­˜åœ°å€ä¸Šï¼Œå…¶ä»–å­—èŠ‚ä¾æ¬¡æ’åˆ—ã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>value</code>: è¿™æ˜¯ä½ è¦å†™å…¥çš„é‚£ä¸ªæ— ç¬¦å· 32 ä½æ•´æ•°çš„å€¼ã€‚</li><li><code>offset</code> (å¯é€‰): è¿™æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºä» buffer çš„å“ªä¸ªä½ç½®å¼€å§‹å†™å…¥è¿™ä¸ªå€¼ã€‚å¦‚æœä¸æä¾›è¿™ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆé»˜è®¤ä» 0 å¼€å§‹ã€‚</li></ul><p>ç°åœ¨ä¸¾å‡ ä¸ªå®é™…åº”ç”¨çš„ä¾‹å­ï¼š</p><h3 id="ç¤ºä¾‹-1-åŸºæœ¬ä½¿ç”¨-2" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åŸºæœ¬ä½¿ç”¨-2"><span>ç¤ºä¾‹ 1ï¼šåŸºæœ¬ä½¿ç”¨</span></a></h3><p>å‡è®¾ä½ æƒ³åœ¨ä¸€ä¸ª Buffer ä¸­å†™å…¥ä¸€ä¸ªæ•´æ•°å€¼ <code>123456789</code>ï¼Œå¹¶ä¸”ä½ å¸Œæœ›ä» Buffer çš„èµ·å§‹å¤„å¼€å§‹å†™å…¥ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º4å­—èŠ‚çš„Buffer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†æ•°å­—123456789ä»¥å¤§ç«¯åºæ–¹å¼å†™å…¥Buffer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeUInt32BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">123456789</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œä¸Šé¢çš„ä»£ç å°†ä¼šè¾“å‡º Buffer ä¸­çš„å†…å®¹ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨äº†å¤§ç«¯åºï¼Œæ‰€ä»¥è¾ƒé«˜æœ‰æ•ˆå­—èŠ‚å°†ä¼šè¢«æ”¾ç½®åœ¨å‰é¢ã€‚</p><h3 id="ç¤ºä¾‹-2-æŒ‡å®šåç§»é‡" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æŒ‡å®šåç§»é‡"><span>ç¤ºä¾‹ 2ï¼šæŒ‡å®šåç§»é‡</span></a></h3><p>ç°åœ¨æˆ‘ä»¬å°è¯•å†™å…¥åŒæ ·çš„æ•´æ•°ï¼Œä½†æ˜¯è¿™æ¬¡æˆ‘ä»¬æƒ³è¦å®ƒä» Buffer çš„ç¬¬äºŒä¸ªå­—èŠ‚å¼€å§‹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º6å­—èŠ‚çš„Buffer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥äº†1ï¼Œæ„å‘³ç€ä»bufferçš„ç¬¬äºŒä¸ªå­—èŠ‚å¼€å§‹å†™</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeUInt32BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">123456789</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”±äºæˆ‘ä»¬è®¾å®šåç§»é‡ä¸º 1ï¼Œé‚£ä¹ˆæ•´æ•°çš„ç¬¬ä¸€ä¸ªå­—èŠ‚å°†ä¼šè¢«å†™å…¥åˆ° Buffer çš„ç¬¬äºŒä¸ªä½ç½®ã€‚å‰©ä½™çš„å­—èŠ‚å°†æŒ‰ç…§å¤§ç«¯åºåç»­æ’åˆ—ã€‚</p><h3 id="ç¤ºä¾‹-3-æ²¡æœ‰è¶³å¤Ÿç©ºé—´" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-æ²¡æœ‰è¶³å¤Ÿç©ºé—´"><span>ç¤ºä¾‹ 3ï¼šæ²¡æœ‰è¶³å¤Ÿç©ºé—´</span></a></h3><p>å¦‚æœ Buffer æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´æ¥å®¹çº³è¿™ä¸ª 32 ä½æ•´æ•°ï¼ŒNode.js å°†ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚æ¯”å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åªæœ‰3å­—èŠ‚å¤§å°çš„Buffer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å°è¯•å†™å…¥ä¸€ä¸ª4å­—èŠ‚å¤§å°çš„æ•´æ•°å°†ä¼šå¤±è´¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeUInt32BE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">123456789</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å‘ç”Ÿé”™è¯¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šä»£ç ä¼šæ•è·åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œå¹¶ä¸”è¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰æä¾›è¶³å¤Ÿçš„ç©ºé—´æ¥å­˜å‚¨ä¸€ä¸ª 32 ä½æ•´æ•°ã€‚</p><p>è¿™å°±æ˜¯ <code>writeUInt32BE</code> æ–¹æ³•çš„åŸºæœ¬ç”¨æ³•å’Œä¸€äº›ç¤ºä¾‹ã€‚è®°å¾—åœ¨å®é™…åº”ç”¨ä¸­æ£€æŸ¥ Buffer çš„å¤§å°ä»¥ç¡®ä¿æœ‰è¶³å¤Ÿçš„ç©ºé—´è¿›è¡Œæ“ä½œï¼Œé¿å…é”™è¯¯çš„å‘ç”Ÿã€‚</p><h3 id="buf-writeuint32le-value-offset" tabindex="-1"><a class="header-anchor" href="#buf-writeuint32le-value-offset"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwriteuint32levalue-offset" target="_blank" rel="noopener noreferrer">buf.writeUInt32LE(value[, offset])</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘ä¼šå°½é‡é€šä¿—å’Œè¯¦ç»†åœ°è§£é‡Šè¿™ä¸ªæ¦‚å¿µã€‚</p><p>Node.js ä¸­çš„ <code>Buffer</code> å¯¹è±¡æ˜¯ç”¨æ¥ç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ã€‚åœ¨è®¡ç®—æœºä¸­ï¼Œæ‰€æœ‰æ•°æ®æœ€ç»ˆéƒ½æ˜¯ä»¥äºŒè¿›åˆ¶çš„å½¢å¼è¡¨ç¤ºçš„ï¼Œä½†æ˜¯åœ¨ JavaScript è¿™ç§é«˜çº§è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¸éœ€è¦å…³å¿ƒè¿™ä¸ªå±‚é¢çš„äº‹æƒ…ã€‚ç„¶è€Œï¼Œå½“ä½ å¤„ç†æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡æˆ–è€…å…¶ä»– I/Oï¼ˆè¾“å…¥/è¾“å‡ºï¼‰æ“ä½œæ—¶ï¼Œç›´æ¥æ“ä½œè¿™äº›äºŒè¿›åˆ¶æ•°æ®å°±å˜å¾—å¾ˆé‡è¦äº†ï¼Œè¿™æ—¶å€™ <code>Buffer</code> ç±»å°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p><h3 id="buf-writeuint32le-value-offset-1" tabindex="-1"><a class="header-anchor" href="#buf-writeuint32le-value-offset-1"><span>buf.writeUInt32LE(value[, offset])</span></a></h3><p>è¿™ä¸ªæ–¹æ³•æ˜¯ <code>Buffer</code> ç±»çš„ä¸€ä¸ªå®ä¾‹æ–¹æ³•ï¼Œå®ƒå…è®¸ä½ å°†ä¸€ä¸ªæ— ç¬¦å·çš„ 32 ä½æ•´æ•°ï¼ˆunsigned 32-bit integerï¼‰å†™å…¥åˆ° Buffer ä¸­ï¼Œä½¿ç”¨å°ç«¯å­—èŠ‚åºï¼ˆlittle-endianï¼‰ã€‚</p><ul><li><strong>value</strong>: è¿™æ˜¯ä½ æƒ³è¦å†™å…¥ Buffer çš„æ•°å€¼ã€‚å®ƒåº”è¯¥æ˜¯ä¸€ä¸ªæ— ç¬¦å·çš„ 32 ä½æ•´æ•°ã€‚</li><li><strong>offset</strong> (å¯é€‰): è¿™æ˜¯æ•°å€¼å†™å…¥ Buffer çš„èµ·å§‹ä½ç½®ã€‚å¦‚æœä½ ä¸æŒ‡å®šè¿™ä¸ªå‚æ•°ï¼Œé»˜è®¤å€¼æ˜¯ <code>0</code>ï¼Œå³ä» Buffer çš„å¼€å¤´å¼€å§‹å†™å…¥ã€‚</li></ul><p>â€œå°ç«¯å­—èŠ‚åºâ€ï¼ˆlittle-endianï¼‰æ˜¯ä¸€ç§å­—èŠ‚åºï¼Œè¿™é‡Œçš„â€œå­—èŠ‚åºâ€æŒ‡çš„æ˜¯å¤šå­—èŠ‚æ•°æ®çš„å­˜å‚¨é¡ºåºã€‚åœ¨å°ç«¯å­—èŠ‚åºä¸­ï¼Œä½åºå­—èŠ‚ï¼ˆè¾ƒå°çš„éƒ¨åˆ†ï¼Œé€šå¸¸æ˜¯å³è¾¹çš„æ•°å­—ï¼‰æ’åœ¨å‰é¢ï¼Œè€Œé«˜åºå­—èŠ‚ï¼ˆè¾ƒå¤§çš„éƒ¨åˆ†ï¼‰æ’åœ¨åé¢ã€‚ä¾‹å¦‚ï¼Œåœ¨å°ç«¯å­—èŠ‚åºä¸­ï¼Œæ•°å€¼ <code>0x12345678</code> ä¼šè¢«å­˜å‚¨ä¸º <code>78 56 34 12</code>ã€‚</p><h4 id="å®é™…è¿ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-1"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js ç¨‹åºï¼Œéœ€è¦ä¸ä¸€ä¸ªç¡¬ä»¶è®¾å¤‡é€šä¿¡ï¼Œè¿™ä¸ªè®¾å¤‡éœ€è¦ä¸€ä¸ªç‰¹å®šæ ¼å¼çš„äºŒè¿›åˆ¶åè®®ã€‚æ ¹æ®åè®®ï¼Œä½ éœ€è¦å‘é€ä¸€ä¸ªæ— ç¬¦å·çš„ 32 ä½æ•´æ•°æ¥è¡¨ç¤ºæŸä¸ªè®¾ç½®çš„å€¼ã€‚</p><p>ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨ <code>writeUInt32LE</code> æ–¹æ³•æ¥å‡†å¤‡è¿™æ ·ä¸€ä¸ª Buffer çš„æ­¥éª¤ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªè¶³å¤Ÿå®¹çº³ 32 ä½æ•´æ•°çš„ Bufferï¼ˆ4 å­—èŠ‚ï¼Œå› ä¸º 1 å­—èŠ‚ = 8 ä½ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆå§‹å†…å®¹æ˜¯ 0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬è¦å‘é€çš„æ•´æ•°æ˜¯ 300</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 300</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ writeUInt32LE æ–¹æ³•å°†è¿™ä¸ªæ•´æ•°å†™å…¥åˆ° Buffer ä¸­</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬æ²¡æœ‰æŒ‡å®š offsetï¼Œæ‰€ä»¥å®ƒé»˜è®¤ä» Buffer çš„å¼€å¤´å†™èµ·ï¼ˆå³ offset ä¸º 0ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeUInt32LE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨ Buffer çš„å†…å®¹å°±æ˜¯å¯¹åº” 300 è¿™ä¸ªæ•´æ•°çš„äºŒè¿›åˆ¶è¡¨ç¤º</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå¯èƒ½ç±»ä¼¼äºï¼š`&lt;`Buffer 2c 01 00 00&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯´æ˜ï¼š2c æ˜¯ 300 çš„åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œ01 00 00 è¡¨ç¤ºå‰©ä½™çš„å­—èŠ‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ Bufferï¼Œå¹¶ä¸”ä½¿ç”¨ <code>writeUInt32LE</code> æ–¹æ³•å°†æ•°å€¼ <code>300</code> å†™å…¥åˆ°è¿™ä¸ª Buffer ä¸­ã€‚ç°åœ¨è¿™ä¸ª Buffer åŒ…å«äº†æ­£ç¡®çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œå¯ä»¥è¢«å‘é€åˆ°ç¡¬ä»¶è®¾å¤‡æ‰§è¡Œç›¸åº”çš„æ“ä½œã€‚</p><p>è®°ä½ï¼Œæ“ä½œ Buffer å’ŒäºŒè¿›åˆ¶æ•°æ®é€šå¸¸å’Œåº•å±‚çš„ç¡¬ä»¶æ“ä½œã€ç½‘ç»œé€šä¿¡ç­‰åœºæ™¯ç›¸å…³ã€‚åœ¨è¿™äº›åœºåˆï¼Œæ§åˆ¶æ•°æ®çš„ç²¾ç¡®æ ¼å¼éå¸¸é‡è¦ï¼Œå› ä¸ºç›®æ ‡ç³»ç»Ÿæˆ–åè®®æœŸæœ›å¾—åˆ°ç‰¹å®šçš„æ•°æ®å¸ƒå±€ã€‚</p><h3 id="buf-writeuintbe-value-offset-bytelength" tabindex="-1"><a class="header-anchor" href="#buf-writeuintbe-value-offset-bytelength"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwriteuintbevalue-offset-bytelength" target="_blank" rel="noopener noreferrer">buf.writeUIntBE(value, offset, byteLength)</a></span></a></h3><p>Node.js ä¸­çš„ <code>Buffer</code> ç±»æ˜¯ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ã€‚ä¸€ä¸ª <code>Buffer</code> å¯ä»¥è¢«æƒ³è±¡æˆæ˜¯ä¸€å—åœ¨ Node.js ä¸­ç”¨æ¥å­˜æ”¾åŸå§‹æ•°æ®çš„å†…å­˜åŒºåŸŸâ€”â€”ä½ å¯ä»¥æŠŠå®ƒçœ‹ä½œä¸€ä¸ªå¯ä»¥å­˜å‚¨å­—èŠ‚çš„æ•°ç»„ã€‚</p><p><code>buf.writeUIntBE(value, offset, byteLength)</code> æ˜¯ <code>Buffer</code> ç±»ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºå°†æ— ç¬¦å·æ•´æ•°å†™å…¥åˆ° buffer ä¸­ï¼Œé‡‡ç”¨å¤§ç«¯å­—èŠ‚åºï¼ˆBig-Endianï¼‰ã€‚è®©æˆ‘ä»¬æ¥é€ä¸€è§£é‡Šè¿™äº›æ¦‚å¿µï¼š</p><ul><li>æ— ç¬¦å·æ•´æ•°ï¼šæ˜¯ä¸ªæ­£æ•´æ•°æˆ–é›¶ï¼Œä¸åŒ…å«è´Ÿå·ã€‚</li><li>å¤§ç«¯å­—èŠ‚åºï¼ˆBig-Endianï¼‰ï¼šæ˜¯ä¸€ä¸ªæœ¯è¯­ï¼ŒæŒ‡åœ¨å­—èŠ‚åºåˆ—ä¸­æœ€é‡è¦çš„å­—èŠ‚ï¼ˆé€šå¸¸æ˜¯æœ€é«˜æœ‰æ•ˆå­—èŠ‚ï¼‰å­˜å‚¨åœ¨æœ€ä½çš„å†…å­˜åœ°å€ä¸Šã€‚</li><li><code>value</code>ï¼šè¿™æ˜¯ä½ è¦å†™å…¥ buffer çš„æ— ç¬¦å·æ•´æ•°çš„å€¼ã€‚</li><li><code>offset</code>ï¼šè¿™æ˜¯ buffer å†…çš„èµ·å§‹ä½ç½®ï¼Œä»è¿™é‡Œå¼€å§‹å†™å…¥æ•°æ®ã€‚</li><li><code>byteLength</code>ï¼šè¿™æ˜¯è¦å†™å…¥çš„å­—èŠ‚æ•°ã€‚ç”±äºä½ åœ¨æ“ä½œäºŒè¿›åˆ¶æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦æ˜ç¡®æŒ‡å®šä½ æ‰“ç®—å†™å…¥å¤šå°‘å­—èŠ‚ã€‚</li></ul><p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬æƒ³åœ¨ä¸€ä¸ª buffer ä¸­å†™å…¥æ— ç¬¦å·æ•´æ•° 123456ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªæ•´æ•°å æ® buffer çš„ 3 ä¸ªå­—èŠ‚ï¼Œå¹¶ä¸”ä½¿ç”¨å¤§ç«¯æ ¼å¼ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º3ä¸ªå­—èŠ‚çš„buffer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†123456è¿™ä¸ªæ•°å€¼æŒ‰ç…§å¤§ç«¯æ ¼å¼å†™å…¥åˆ°bufferçš„ç¬¬0ä½å¼€å§‹çš„ä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeUIntBE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">123456</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ä½ è¿è¡Œè¿™æ®µä»£ç æ—¶ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªåŒ…å«äº†ç‰¹å®šå­—èŠ‚çš„ bufferã€‚è¾“å‡ºå¯èƒ½æ˜¯ä¸€ä¸²çœ‹ä¼¼ä¸ç›¸å…³çš„æ•°å­—ï¼Œè¿™æ˜¯å› ä¸ºå®ƒä»¬ä»£è¡¨çš„æ˜¯ buffer ä¸­æ¯ä¸ªå­—èŠ‚çš„åè¿›åˆ¶å€¼ã€‚</p><p>å¦‚æœæˆ‘ä»¬è¿›ä¸€æ­¥åˆ†æï¼Œ123456 åœ¨åå…­è¿›åˆ¶ä¸­æ˜¯ <code>0x01E240</code>ï¼Œè¿™å°†è¢«æ‹†åˆ†å¹¶å†™å…¥åˆ° buffer ä¸­å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>01 E2 40</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™ä¸‰ä¸ªå­—èŠ‚å°±æ˜¯æ•°å­— 123456 çš„å¤§ç«¯è¡¨ç¤ºã€‚åœ¨ buffer ä¸­ï¼Œè¿™ä¸ªæ•°å­—çš„æœ€é«˜æœ‰æ•ˆå­—èŠ‚ <code>01</code> è¢«æ”¾ç½®åœ¨äº†æœ€å‰é¢çš„ä½ç½®ï¼ˆä½åœ°å€ï¼‰ï¼Œæ¥ç€æ˜¯ <code>E2</code> å’Œ <code>40</code>ã€‚</p><p>ä½¿ç”¨ <code>writeUIntBE</code> æ–¹æ³•ï¼Œä½ èƒ½å¤Ÿç²¾å‡†åœ°æ§åˆ¶æ•°å€¼æ˜¯å¦‚ä½•åœ¨ buffer ä¸­è¡¨ç¤ºçš„ï¼Œè¿™å¯¹äºå¤„ç†ç½‘ç»œåè®®ã€äºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼æˆ–ä»»ä½•å…¶ä»–éœ€è¦ç›´æ¥æ“ä½œå­—èŠ‚çš„åœºæ™¯éƒ½éå¸¸æœ‰ç”¨ã€‚</p><p>è®°å¾— <code>value</code> å¿…é¡»åœ¨ 0 åˆ° 2^(8 * byteLength) - 1 èŒƒå›´å†…ï¼Œå¦åˆ™ä¼šæŠ›å‡º RangeError å¼‚å¸¸ï¼Œå› ä¸ºè¶…å‡ºäº†èƒ½å¤Ÿåœ¨æŒ‡å®šå­—èŠ‚é•¿åº¦å†…è¡¨ç¤ºçš„èŒƒå›´ã€‚åŒæ—¶ï¼Œ<code>offset</code> åŠ ä¸Š <code>byteLength</code> ä¸èƒ½è¶…è¿‡ buffer çš„æ€»é•¿åº¦ã€‚</p><h3 id="buf-writeuintle-value-offset-bytelength" tabindex="-1"><a class="header-anchor" href="#buf-writeuintle-value-offset-bytelength"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufwriteuintlevalue-offset-bytelength" target="_blank" rel="noopener noreferrer">buf.writeUIntLE(value, offset, byteLength)</a></span></a></h3><p><code>buf.writeUIntLE(value, offset, byteLength)</code> è¿™ä¸ªå‡½æ•°æ˜¯ Node.js ä¸­ Buffer å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨æ¥å°†æ— ç¬¦å·æ•´æ•°ä»¥å°ç«¯å­—èŠ‚åºçš„å½¢å¼å†™å…¥åˆ° Buffer ä¸­ã€‚</p><p>é¦–å…ˆäº†è§£å‡ ä¸ªæ¦‚å¿µï¼š</p><ol><li><p><strong>Buffer</strong>: åœ¨ Node.js ä¸­ï¼ŒBuffer ç±»æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨äºç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚å½“æˆ‘ä»¬éœ€è¦å¤„ç†åƒ TCP æµæˆ–æ–‡ä»¶ç³»ç»Ÿæ“ä½œè¿™ç±»ä¸ IO ç›¸å…³çš„ä»»åŠ¡æ—¶ï¼Œå°±ä¼šä½¿ç”¨åˆ° Bufferã€‚</p></li><li><p><strong>æ— ç¬¦å·æ•´æ•°</strong>: æ— ç¬¦å·æ•´æ•°æ˜¯æŒ‡åªèƒ½è¡¨ç¤ºéè´Ÿæ•´æ•°ï¼ˆ0 å’Œæ­£æ•´æ•°ï¼‰çš„ä¸€ç§æ•°å­—è¡¨ç¤ºæ–¹å¼ã€‚</p></li><li><p><strong>å°ç«¯å­—èŠ‚åºï¼ˆLittle-Endianï¼‰</strong>: å­—èŠ‚åºæŒ‡ç”µè„‘å­˜å‚¨æ•°æ®çš„é¡ºåºã€‚å°ç«¯å­—èŠ‚åºæ„å‘³ç€ä½åºå­—èŠ‚æ”¾åœ¨å‰é¢ï¼ˆå³å†…å­˜åœ°å€å°çš„ä½ç½®ï¼‰ï¼Œé«˜åºå­—èŠ‚æ”¾åœ¨åé¢ï¼ˆå†…å­˜åœ°å€å¤§çš„ä½ç½®ï¼‰ã€‚ä¾‹å¦‚ï¼Œæ•°å­—<code>0x12345678</code>åœ¨å°ç«¯æ¨¡å¼ä¸‹å­˜å‚¨ä¸º<code>78 56 34 12</code>ã€‚</p></li></ol><p>ç°åœ¨è®©æˆ‘ä»¬è¯¦ç»†è§£é‡Šä¸€ä¸‹<code>buf.writeUIntLE(value, offset, byteLength)</code> æ–¹æ³•ï¼š</p><ul><li><code>value</code>: éœ€è¦å†™å…¥ buffer çš„æ— ç¬¦å·æ•´æ•°å€¼ã€‚</li><li><code>offset</code>: æ˜¯å¼€å§‹å†™å…¥çš„ç´¢å¼•ä½ç½®ï¼ˆä» 0 å¼€å§‹è®¡æ•°ï¼‰ï¼Œå³åœ¨ buffer çš„å“ªä¸ªä½ç½®å¼€å§‹å†™å…¥æ•°æ®ã€‚</li><li><code>byteLength</code>: å†™å…¥å¤šå°‘å­—èŠ‚çš„æ— ç¬¦å·æ•´æ•°ã€‚ç”±äºä¸åŒçš„æ•´æ•°å¯èƒ½éœ€è¦ä¸åŒå¤§å°çš„ç©ºé—´ï¼Œå› æ­¤ä½ éœ€è¦æŒ‡å®šå†™å…¥çš„å­—èŠ‚æ•°ã€‚ä¾‹å¦‚ï¼Œ8 ä½æ— ç¬¦å·æ•´æ•°å ç”¨ 1 ä¸ªå­—èŠ‚ï¼Œ16 ä½æ— ç¬¦å·æ•´æ•°å ç”¨ 2 ä¸ªå­—èŠ‚ï¼Œ32 ä½åˆ™å ç”¨ 4 ä¸ªå­—èŠ‚ï¼Œä»¥æ­¤ç±»æ¨ã€‚</li></ul><h3 id="ä½¿ç”¨å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨å®ä¾‹"><span>ä½¿ç”¨å®ä¾‹</span></a></h3><p>æ¯”å¦‚è¯´ï¼Œä½ æƒ³æŠŠæ•°å­—<code>1000</code>ä½œä¸ºä¸€ä¸ª 16 ä½çš„æ— ç¬¦å·æ•´æ•°å†™å…¥åˆ°ä¸€ä¸ª Buffer ä¸­ï¼Œå¹¶ä¸”ä½ å¸Œæœ›ä½¿ç”¨å°ç«¯å­—èŠ‚åºã€‚ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º4å­—èŠ‚çš„Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¦å†™å…¥çš„æ•°å€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> offset</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»Bufferçš„ç¬¬0ä¸ªä½ç½®å¼€å§‹å†™</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> byteLength</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å› ä¸ºæ˜¯16ä½çš„æ— ç¬¦å·æ•´æ•°ï¼Œæ‰€ä»¥å ç”¨2ä¸ªå­—èŠ‚</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeUIntLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">offset</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">byteLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç åˆ›å»ºäº†ä¸€ä¸ª 4 å­—èŠ‚é•¿åº¦çš„ Bufferï¼Œå¹¶ç”¨ 0 åˆå§‹åŒ–ã€‚éšåæˆ‘ä»¬ç”¨<code>writeUIntLE</code>æ–¹æ³•å°†æ•°å€¼<code>1000</code>ï¼ˆåå…­è¿›åˆ¶è¡¨ç¤ºä¸º<code>0x03E8</code>ï¼‰ä»¥å°ç«¯æ ¼å¼å†™å…¥åˆ° Buffer çš„å¼€å§‹ä½ç½®ã€‚ç”±äºæˆ‘ä»¬æŒ‡å®šäº†ä½¿ç”¨ 2 ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ç»“æœåº”è¯¥æ˜¯<code>E8 03</code>ï¼Œè¿™ä¸¤ä¸ªå­—èŠ‚å°±ä»£è¡¨äº†å°ç«¯æ ¼å¼ä¸‹çš„<code>1000</code>ã€‚</p><p>æ‰§è¡Œä¸Šè¿°ä»£ç ï¼Œä½ å¯ä»¥ç”¨<code>console.log</code>çœ‹åˆ° Buffer é‡Œå­˜å‚¨çš„å†…å®¹ï¼Œè¾“å‡ºçš„ç»“æœå°†ç±»ä¼¼äºä»¥ä¸‹ 16 è¿›åˆ¶çš„ Buffer å†…å®¹ï¼š</p><div class="language-plaintext line-numbers-mode" data-highlighter="shiki" data-ext="plaintext" data-title="plaintext" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>`&lt;`Buffer e8 03 00 00&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™é‡Œ<code>e8 03</code>æ˜¯æˆ‘ä»¬å†™å…¥çš„ 1000 è¿™ä¸ªæ•°å€¼ï¼Œåé¢çš„<code>00 00</code>æ˜¯å› ä¸ºæˆ‘ä»¬åˆ†é…äº† 4 ä¸ªå­—èŠ‚çš„ Bufferï¼Œè€Œæˆ‘ä»¬åªä½¿ç”¨äº† 2 ä¸ªå­—èŠ‚æ¥å­˜å‚¨æˆ‘ä»¬çš„æ•°å€¼ã€‚</p><p>è¿™ä¸ªæ–¹æ³•åœ¨éœ€è¦ç²¾ç¡®æ§åˆ¶æ•°æ®å¦‚ä½•å­˜å‚¨åˆ° Buffer ä¸­æ—¶éå¸¸æœ‰ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†éœ€è¦è·¨ä¸åŒç³»ç»Ÿä¼ è¾“æ•°æ®ï¼Œå¹¶ä¸”è¿™äº›ç³»ç»Ÿå¯èƒ½æœ‰ä¸åŒçš„å­—èŠ‚åºè¦æ±‚æ—¶ã€‚é€šè¿‡ç›´æ¥æ“ä½œå­—èŠ‚åºï¼Œå¼€å‘è€…å¯ä»¥ç¡®ä¿æ•°æ®æ­£ç¡®æ— è¯¯åœ°è¢«è¯»å–å’Œè§£é‡Šã€‚</p><h3 id="new-buffer-array" tabindex="-1"><a class="header-anchor" href="#new-buffer-array"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#new-bufferarray" target="_blank" rel="noopener noreferrer">new Buffer(array)</a></span></a></h3><p>Node.js ä¸­çš„ <code>Buffer</code> ç±»æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨äºç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚åœ¨ Node.js çš„æ—©æœŸç‰ˆæœ¬ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>new Buffer()</code> æ„é€ å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ª <code>Buffer</code> å®ä¾‹ã€‚ä½†éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œä» Node.js v6.0.0 å¼€å§‹ï¼Œ<code>new Buffer()</code> æ„é€ å‡½æ•°å·²ç»è¢«åºŸå¼ƒï¼Œå¹¶åœ¨åç»­çš„ç‰ˆæœ¬ä¸­å®Œå…¨ç§»é™¤ã€‚å®ƒè¢«è®¤ä¸ºæ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šå¯¼è‡´ä¸€äº›å®‰å…¨éšæ‚£ï¼Œå¦‚æœªåˆå§‹åŒ–çš„å†…å­˜è®¿é—®ã€‚</p><p>ç°åœ¨ï¼Œè¦åˆ›å»ºä¸€ä¸ª <code>Buffer</code> å¯¹è±¡ï¼Œåº”ä½¿ç”¨ä»¥ä¸‹æ›¿ä»£æ–¹æ³•ä¹‹ä¸€ï¼š</p><ol><li><code>Buffer.from(array)</code>ï¼šä»ä¸€ä¸ªå…«ä½å­—èŠ‚ï¼ˆå³ 8 ä½æ— ç¬¦å·æ•´æ•°ï¼‰æ•°ç»„åˆ›å»ºä¸€ä¸ªæ–°çš„ Bufferã€‚</li><li><code>Buffer.alloc(size)</code>ï¼šåˆ›å»ºä¸€ä¸ªæŒ‡å®šå¤§å°çš„å·²åˆå§‹åŒ–ï¼ˆå¡«å……ä¸ºé›¶ï¼‰çš„ Bufferã€‚</li><li><code>Buffer.allocUnsafe(size)</code>ï¼šåˆ›å»ºä¸€ä¸ªæŒ‡å®šå¤§å°çš„æœªåˆå§‹åŒ–çš„ Bufferï¼ˆå¯èƒ½åŒ…å«æ•æ„Ÿæ•°æ®ï¼‰ã€‚</li><li><code>Buffer.allocUnsafeSlow(size)</code>ï¼šä¸ <code>Buffer.allocUnsafe()</code> ç±»ä¼¼ï¼Œä½†ç”¨äºåˆ›å»ºè¾ƒå¤§çš„ Buffer å®ä¾‹ã€‚</li></ol><p>è™½ç„¶ä½ æåˆ°äº† <code>new Buffer(array)</code>ï¼Œä½†ä»¥é˜²ä¸‡ä¸€ï¼Œæˆ‘ä»ç„¶æƒ³é‡ç”³ï¼Œè¿™ç§æ–¹å¼æ˜¯ä¸æ¨èã€ä¹Ÿä¸å®‰å…¨çš„ï¼Œä¸”åœ¨ Node.js v21.7.1 ä¸­åº”è¯¥æ˜¯ä¸å¯ç”¨çš„ã€‚ä¸‹é¢æ˜¯ä½¿ç”¨å½“å‰æ¨èæ–¹æ³•åˆ›å»º <code>Buffer</code> å®ä¾‹çš„å‡ ä¸ªå®é™…ç¤ºä¾‹ï¼š</p><p><strong>ä¾‹å­ 1ï¼šåˆ›å»ºä¸€ä¸ªåŒ…å«åˆå§‹æ•°æ®çš„ Buffer</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufFrom</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x48</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x65</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x6c</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x6c</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x6f</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å« ASCII ç çš„ &quot;Hello&quot; å­—ç¬¦ä¸²çš„ Buffer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">bufFrom</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: Hello</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä¾‹å­ 2ï¼šåˆ›å»ºä¸€ä¸ªå¡«å……ä¸ºé›¶çš„ Buffer</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufAlloc</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 10 çš„åˆå§‹åŒ– Bufferï¼Œå…¶ä¸­æ¯ä¸ªå­—èŠ‚éƒ½è¢«è®¾ç½®ä¸º 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bufAlloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// `&lt;`Buffer 00 00 00 00 00 00 00 00 00 00&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä¾‹å­ 3ï¼šåˆ›å»ºä¸€ä¸ªæœªåˆå§‹åŒ–çš„ Buffer</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufAllocUnsafe</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">allocUnsafe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 10 çš„æœªåˆå§‹åŒ– Buffer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bufAllocUnsafe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// `&lt;`Buffer (å¯èƒ½åŒ…å«ä»»æ„æ•°æ®)&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ€»ç»“èµ·æ¥ï¼Œå°½ç®¡ <code>new Buffer(array)</code> æ›¾ç»å­˜åœ¨ï¼Œç›®å‰æ­£ç¡®ä¸”å®‰å…¨çš„åšæ³•æ˜¯ä½¿ç”¨ <code>Buffer.from()</code>, <code>Buffer.alloc()</code>, æˆ–è€… <code>Buffer.allocUnsafe()</code> æ¥åˆ›å»º <code>Buffer</code> å®ä¾‹ï¼Œå¹¶ä¸”è¿™äº›æ–¹æ³•èƒ½å¤Ÿæ›´å¥½åœ°ä¿è¯ä»£ç çš„å®‰å…¨æ€§å’Œå¯é æ€§ã€‚</p><h3 id="new-buffer-arraybuffer-byteoffset-length" tabindex="-1"><a class="header-anchor" href="#new-buffer-arraybuffer-byteoffset-length"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#new-bufferarraybuffer-byteoffset-length" target="_blank" rel="noopener noreferrer">new Buffer(arrayBuffer[, byteOffset[, length]])</a></span></a></h3><p>Node.js ä¸­çš„ Buffer ç±»æ˜¯ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ã€‚åœ¨æ—©æœŸç‰ˆæœ¬ä¸­ï¼ŒBuffer çš„å®ä¾‹å¯ä»¥é€šè¿‡ <code>new Buffer()</code> æ–¹æ³•åˆ›å»ºï¼Œä½†è¿™ç§æ–¹å¼å·²è¢«åºŸå¼ƒï¼Œå¹¶ä¸”åœ¨ Node.js æ–‡æ¡£ä¸­æ¨èä½¿ç”¨æ–°çš„æ–¹æ³•ï¼Œå¦‚ <code>Buffer.from()</code>, <code>Buffer.alloc()</code>, å’Œ <code>Buffer.allocUnsafe()</code>ã€‚</p><p>ä¸è¿‡ï¼Œä¸ºäº†å›ç­”ä½ çš„é—®é¢˜ï¼Œæˆ‘å°†è§£é‡Š <code>new Buffer(arrayBuffer[, byteOffset[, length]])</code> è¿™ä¸ªåœ¨ Node.js v21.7.1 æ–‡æ¡£ä¸­å‡ºç°çš„æ„é€ å‡½æ•°ï¼Œä½†è¯·æ³¨æ„ï¼Œä½ åº”è¯¥é¿å…åœ¨æ–°ä»£ç ä¸­ä½¿ç”¨å®ƒï¼Œå¹¶ä¸”ä½¿ç”¨æ¨èçš„æ›¿ä»£æ–¹æ¡ˆã€‚</p><p><code>new Buffer(arrayBuffer[, byteOffset[, length]])</code> æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨äºä»ä¸€ä¸ª ArrayBuffer å¯¹è±¡åˆ›å»ºä¸€ä¸ªæ–°çš„ Buffer å¯¹è±¡ã€‚ArrayBuffer æ˜¯ JavaScript ä¸­ä¸€ç§è¡¨ç¤ºå›ºå®šé•¿åº¦åŸå§‹äºŒè¿›åˆ¶æ•°æ®ç¼“å†²åŒºçš„ç±»ã€‚Buffer åˆ™ä¸“é—¨ä¸º Node.js è®¾è®¡ï¼Œæä¾›äº†æ›´å¤šä¸äºŒè¿›åˆ¶æ•°æ®äº¤äº’çš„æ¥å£å’Œæ–¹æ³•ã€‚</p><p>è¿™é‡Œçš„å‚æ•°è¯´æ˜å¦‚ä¸‹ï¼š</p><ul><li><code>arrayBuffer</code>: è¿™æ˜¯æä¾›æºæ•°æ®çš„ ArrayBuffer å¯¹è±¡ã€‚</li><li><code>byteOffset</code> (å¯é€‰): ä¸€ä¸ªæ•°å­—ï¼ŒæŒ‡å®šäº†ä» <code>arrayBuffer</code> ä¸­å¼€å§‹è¯»å–æ•°æ®çš„èµ·å§‹å­—èŠ‚ä½ç½®ã€‚</li><li><code>length</code> (å¯é€‰): ä¸€ä¸ªæ•°å­—ï¼ŒæŒ‡å®šäº†è¦è¯»å–çš„å­—èŠ‚æ•°ã€‚</li></ul><p>å¦‚æœä½ æ²¡æœ‰æä¾› <code>byteOffset</code> å’Œ <code>length</code>ï¼Œé‚£ä¹ˆæ•´ä¸ª <code>arrayBuffer</code> å°†ä¼šè¢«ç”¨æ¥åˆ›å»º Bufferã€‚</p><p><strong>ä¸¾ä¾‹ï¼š</strong></p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª ArrayBufferï¼ŒåŒ…å«äº†ä¸€ç³»åˆ—çš„å­—èŠ‚ï¼ˆæ¯”å¦‚ä»æ–‡ä»¶è¯»å–çš„æ•°æ®æˆ–è€…æ˜¯ç½‘ç»œé€šä¿¡ä¸­æ¥æ”¶åˆ°çš„äºŒè¿›åˆ¶æ•°æ®ï¼‰ï¼Œæˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€æ®µå¯¹åº”çš„ Buffer æ¥å¤„ç†è¿™äº›æ•°æ®ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª ArrayBuffer å¹¶é™„ä¸Šä¸€äº›æ•°æ®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª ArrayBufferï¼Œé•¿åº¦ä¸º 16 å­—èŠ‚ã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> arrayBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> ArrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬ç”¨æŸç§æ–¹å¼å¡«å……äº†è¿™ä¸ª ArrayBufferï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¾‹å¦‚å¯ä»¥ç”¨ä¸€ä¸ªè§†å›¾ï¼ˆå¦‚ Uint8Arrayï¼‰æ¥æ“ä½œå®ƒã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> view</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Uint8Array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">arrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> view</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    view</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªåŒ…å«äº† 0 åˆ° 15 æ•°å­—çš„ ArrayBufferã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç”¨è¿™ä¸ª ArrayBuffer æ¥åˆ›å»ºä¸€ä¸ª Buffer å®ä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ³¨æ„ï¼šä»¥ä¸‹ä»£ç ä½¿ç”¨äº†å·²ç»åºŸå¼ƒçš„ new Buffer() æ–¹å¼ï¼Œä¸å»ºè®®åœ¨æ–°ä»£ç ä¸­ä½¿ç”¨ã€‚</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªä» arrayBuffer çš„ç¬¬ 0 å­—èŠ‚å¼€å§‹ï¼Œé•¿åº¦ä¸º 16 å­—èŠ‚çš„ Bufferã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">arrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ª Buffer å®ä¾‹ï¼ŒåŒ…å«ç›¸åŒçš„æ•°æ®ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Buffer çš„æ–¹æ³•æ¥æ“ä½œè¿™äº›æ•°æ®ï¼Œæ¯”å¦‚è¯»å–ã€å†™å…¥ã€å¤åˆ¶ç­‰ã€‚</p><p><strong>é‡è¦æç¤º</strong>ï¼š</p><p>è™½ç„¶ä»¥ä¸Šä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>new Buffer(arrayBuffer[, byteOffset[, length]])</code>ï¼Œä½†ç”±äºè¿™ç§åˆ›å»ºæ–¹å¼å¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ï¼ˆå¦‚æœªåˆå§‹åŒ–çš„å†…å­˜è®¿é—®ï¼‰ï¼Œæ‰€ä»¥åœ¨å®é™…ç¼–ç ä¸­åº”è¯¥ä½¿ç”¨æ–°çš„ APIã€‚ä¸‹é¢æ˜¯ä½¿ç”¨æ¨è API çš„ç›¸åŒä¾‹å­çš„æ›¿ä»£æ–¹å¼ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ Buffer.from() æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ Bufferï¼ŒåŸºäºç›¸åŒçš„ ArrayBuffer æ•°æ®ã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> safeBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">arrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœä½ æƒ³è·å¾—ç‰¹å®šçš„ä¸€éƒ¨åˆ†ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯ä»¥åœ¨ from æ–¹æ³•ä¸­æŒ‡å®š byteOffset å’Œ lengthã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> partialBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">arrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»…åŒ…å«å‰ 8 ä¸ªå­—èŠ‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨ <code>Buffer.from()</code>ã€<code>Buffer.alloc()</code> æˆ– <code>Buffer.allocUnsafe()</code> å¯ç¡®ä¿ä»£ç çš„å®‰å…¨æ€§å’Œæœ€ä½³å®è·µã€‚</p><h3 id="new-buffer-buffer" tabindex="-1"><a class="header-anchor" href="#new-buffer-buffer"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#new-bufferbuffer" target="_blank" rel="noopener noreferrer">new Buffer(buffer)</a></span></a></h3><p>åœ¨è®¨è®º <code>new Buffer(buffer)</code> ä¹‹å‰ï¼Œéœ€è¦å…ˆäº†è§£ä»€ä¹ˆæ˜¯ Bufferã€‚åœ¨ Node.js ä¸­ï¼ŒBuffer æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ç±»ï¼Œå¯ä»¥å­˜å‚¨å’Œæ“ä½œæ¥è‡ªä¾‹å¦‚æ–‡ä»¶ç³»ç»Ÿæˆ–ç½‘ç»œä¼ è¾“ä¸­çš„åŸå§‹æ•°æ®ã€‚</p><p><code>new Buffer(buffer)</code> è¿™ä¸ªæ„é€ å‡½æ•°çš„ä½œç”¨æ˜¯å¤åˆ¶ä¼ å…¥çš„ Buffer å®ä¾‹ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ Buffer å¯¹è±¡ï¼Œå®ƒåŒ…å«ä¸åŸå§‹ Buffer ç›¸åŒçš„å­—èŠ‚æ•°æ®ã€‚ç„¶è€Œï¼Œéœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œ<code>new Buffer()</code> æ„é€ å‡½æ•°åœ¨ Node.js ä¸­å·²ç»è¢«åºŸå¼ƒï¼ˆdeprecatedï¼‰ï¼Œå› ä¸ºå®ƒå­˜åœ¨ä¸€äº›å®‰å…¨æ€§å’Œæ€§èƒ½ä¸Šçš„é—®é¢˜ã€‚</p><p>ä» Node.js v6 å¼€å§‹ï¼Œæ¨èä½¿ç”¨ä»¥ä¸‹æ›¿ä»£æ–¹æ³•æ¥åˆ›å»º Buffer å®ä¾‹ï¼š</p><ul><li><code>Buffer.from(array)</code>ï¼šæ ¹æ®ä¸€ä¸ªå…ƒç´ æ•°ç»„åˆ›å»º Bufferã€‚</li><li><code>Buffer.from(arrayBuffer[, byteOffset[, length]])</code>ï¼šæ ¹æ®ä¸€ä¸ª ArrayBuffer åˆ›å»º Bufferï¼Œå¯é€‰åœ°æŒ‡å®šåç§»é‡å’Œé•¿åº¦ã€‚</li><li><code>Buffer.from(buffer)</code>ï¼šå¤åˆ¶ä¼ å…¥çš„ Buffer å®ä¾‹ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ Bufferã€‚</li><li><code>Buffer.from(string[, encoding])</code>ï¼šæ ¹æ®ä¸€ä¸ªå­—ç¬¦ä¸²åˆ›å»º Bufferï¼Œå¯ä»¥æŒ‡å®šç¼–ç ï¼Œé»˜è®¤æ˜¯ &#39;utf8&#39;ã€‚</li><li><code>Buffer.alloc(size[, fill[, encoding]])</code>ï¼šåˆ›å»ºä¸€ä¸ªæŒ‡å®šå¤§å°çš„ Bufferï¼Œå¹¶ä¸”å¯ä»¥é€‰æ‹©å¡«å……å†…å®¹å’Œç¼–ç ã€‚</li><li><code>Buffer.allocUnsafe(size)</code>ï¼šåˆ›å»ºä¸€ä¸ªæŒ‡å®šå¤§å°çš„ Bufferï¼Œä½†ä¸ä¼šåˆå§‹åŒ–æ•°æ®ï¼Œå¯èƒ½åŒ…å«æ•æ„Ÿæ•°æ®ã€‚</li></ul><p>ç°åœ¨ï¼Œå¦‚æœä½ è¦å¤åˆ¶ä¸€ä¸ª Buffer å®ä¾‹ï¼Œä½ åº”è¯¥ä½¿ç”¨ <code>Buffer.from(buffer)</code> è€Œé <code>new Buffer(buffer)</code>ã€‚</p><p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªå®é™…çš„ä¾‹å­è¯´æ˜å¦‚ä½•ä½¿ç”¨è¿™äº›æ–¹æ³•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å« ASCII å­—ç¬¦ä¸² &#39;hello&#39; çš„ Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> buf1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ascii&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å° buf1 çš„å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: `&lt;`Buffer 68 65 6c 6c 6f&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨æˆ‘ä»¬æƒ³å¤åˆ¶buf1ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ Buffer å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> buf2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ”¹å˜ buf2 çš„ç¬¬ä¸€ä¸ªå­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0x48</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å° buf1 å’Œ buf2 çš„å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: `&lt;`Buffer 68 65 6c 6c 6f&gt; (æ²¡æœ‰æ”¹å˜)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: `&lt;`Buffer 48 65 6c 6c 6f&gt; (&#39;h&#39; å˜æˆäº† &#39;H&#39;)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º 10 å­—èŠ‚çš„å®‰å…¨çš„ Bufferï¼Œå¹¶å¡«å……å…¨ä¸º &#39;A&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> buf3</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å° buf3 çš„å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: `&lt;`Buffer 41 41 41 41 41 41 41 41 41 41&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å†™ä»£ç æ—¶ï¼Œè®°å¾—é¿å…ä½¿ç”¨å·²åºŸå¼ƒçš„æ–¹æ³•ï¼Œä»¥ç¡®ä¿ä½ çš„ä»£ç æ›´å®‰å…¨ã€æ›´å¯ç»´æŠ¤ã€‚</p><h3 id="new-buffer-size" tabindex="-1"><a class="header-anchor" href="#new-buffer-size"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#new-buffersize" target="_blank" rel="noopener noreferrer">new Buffer(size)</a></span></a></h3><p>é¦–å…ˆï¼Œéœ€è¦æ³¨æ„çš„æ˜¯åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code>ç±»æ˜¯ä¸€ä¸ªç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„å·¥å…·ã€‚ä½†æ˜¯ï¼Œè‡ªä» Node.js v6 ä»¥åï¼Œä½¿ç”¨<code>new Buffer(size)</code>çš„æ–¹å¼åˆ›å»º<code>Buffer</code>ä¸å†æ¨èï¼Œå› ä¸ºè¿™ç§æ–¹å¼å¯èƒ½ä¼šå¯¼è‡´å®‰å…¨é—®é¢˜å’Œæ€§èƒ½é—®é¢˜ã€‚ç›¸åï¼Œç°åœ¨æ¨èä½¿ç”¨<code>Buffer.alloc()</code>, <code>Buffer.from()</code>ç­‰æ–¹æ³•æ¥åˆ›å»º Buffer å¯¹è±¡ã€‚</p><p>å°½ç®¡ä¸æ¨èä½¿ç”¨<code>new Buffer(size)</code>ï¼Œä½†æˆ‘ä¾ç„¶å¯ä»¥è§£é‡Šå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œç„¶åç»™ä½ æ¨èæ›´å®‰å…¨çš„æ›¿ä»£æ–¹æ³•ã€‚</p><h3 id="æ—§çš„new-buffer-size-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#æ—§çš„new-buffer-size-æ–¹æ³•"><span>æ—§çš„<code>new Buffer(size)</code>æ–¹æ³•</span></a></h3><p><code>new Buffer(size)</code>ä¼šåˆ›å»ºä¸€ä¸ªæŒ‡å®šå¤§å°çš„æ–°çš„<code>Buffer</code>å¯¹è±¡ï¼Œè¿™ä¸ª<code>size</code>æ˜¯æ•´æ•°ï¼Œè¡¨ç¤ºè¦åˆ†é…å¤šå°‘å­—èŠ‚çš„å†…å­˜ã€‚æ­¤æ—¶ï¼Œ<code>Buffer</code>ä¸­çš„å†…å®¹æ˜¯æœªåˆå§‹åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯è¯´é‡Œé¢å¯èƒ½åŒ…å«æ—§çš„æ•°æ®æˆ–è€…å†…å­˜åƒåœ¾ã€‚è¿™æ ·çš„è¡Œä¸ºå¯èƒ½ä¼šæœ‰å®‰å…¨é—®é¢˜ï¼Œæ¯”å¦‚æš´éœ²æ—§çš„æ•æ„Ÿæ•°æ®ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœä½ ä½¿ç”¨<code>new Buffer(10)</code>ï¼Œä½ å°†å¾—åˆ°ä¸€ä¸ªå®¹é‡ä¸º 10 å­—èŠ‚çš„ Buffer å¯¹è±¡ï¼Œä½†é‡Œé¢å¯èƒ½åŒ…å«ä»»æ„çš„æ•°æ®ï¼Œåƒè¿™æ ·ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¸æ¨èè¿™ä¹ˆåš</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå¯èƒ½æ˜¯ `&lt;`Buffer 78 fc 2a b1 c5 00 00 00 00 01&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ³¨æ„ï¼šè¾“å‡ºçš„å…·ä½“å€¼åœ¨æ¯æ¬¡è¿è¡Œæ—¶éƒ½å¯èƒ½ä¸åŒã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ¨èæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#æ¨èæ–¹æ³•"><span>æ¨èæ–¹æ³•</span></a></h3><p>ä¸ºäº†é¿å…ä¸Šè¿°é—®é¢˜ï¼Œåº”è¯¥ä½¿ç”¨ä»¥ä¸‹æ›¿ä»£æ–¹æ³•ä¹‹ä¸€ï¼š</p><h4 id="ä½¿ç”¨buffer-alloc-size" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨buffer-alloc-size"><span>ä½¿ç”¨<code>Buffer.alloc(size)</code></span></a></h4><p>è¿™ä¸ªæ–¹æ³•åˆ›å»ºä¸€ä¸ªæŒ‡å®šå¤§å°çš„ Buffer å¯¹è±¡ï¼Œå¹¶ä¸”å®ƒä¼šåˆå§‹åŒ–å†…å­˜ï¼Œå¡«å……ä¸º 0ã€‚è¿™æ ·æ›´å®‰å…¨ï¼Œå› ä¸ºä¸ä¼šåŒ…å«ä»»ä½•æ—§çš„æˆ–è€…ä¸å¯é¢„çŸ¥çš„æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º10ï¼Œä¸”ç”¨0å¡«å……çš„Buffer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º `&lt;`Buffer 00 00 00 00 00 00 00 00 00 00&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä½¿ç”¨buffer-from-array" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨buffer-from-array"><span>ä½¿ç”¨<code>Buffer.from(array)</code></span></a></h4><p>è¿™ä¸ªæ–¹æ³•å¯ä»¥é€šè¿‡ä¸€ä¸ªæ•°ç»„æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ Buffer å¯¹è±¡ï¼Œæ•°ç»„ä¸­çš„å…ƒç´ æ˜¯æ•°å€¼ï¼Œä»£è¡¨å­—èŠ‚ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x62</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x75</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x66</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x66</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x65</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x72</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªBufferåŒ…å« &quot;buffer&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º &#39;buffer&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä½¿ç”¨buffer-from-string-encoding" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨buffer-from-string-encoding"><span>ä½¿ç”¨<code>Buffer.from(string[, encoding])</code></span></a></h4><p>è¿™ä¸ªæ–¹æ³•é€šè¿‡ä¸€ä¸ªå­—ç¬¦ä¸²æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ Buffer å¯¹è±¡ï¼Œä½ è¿˜å¯ä»¥æŒ‡å®šå­—ç¬¦ä¸²çš„ç¼–ç ï¼ˆé»˜è®¤æ˜¯&#39;utf8&#39;ï¼‰ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º &#39;Hello World&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ€»ç»“èµ·æ¥ï¼Œè™½ç„¶å†å²ä¸Šå­˜åœ¨<code>new Buffer(size)</code>çš„ç”¨æ³•ï¼Œä½†å‡ºäºå®‰å…¨å’Œæ€§èƒ½çš„è€ƒè™‘ï¼Œå®ƒå·²ç»è¢«åºŸå¼ƒï¼Œä¸åº”å½“å†è¢«ä½¿ç”¨ã€‚æ–°æ‰‹åº”è¯¥é‡‡ç”¨<code>Buffer.alloc()</code>, <code>Buffer.from()</code>ç­‰æ–¹æ³•æ¥åˆ›å»º Buffer å¯¹è±¡ã€‚</p><h3 id="new-buffer-string-encoding" tabindex="-1"><a class="header-anchor" href="#new-buffer-string-encoding"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#new-bufferstring-encoding" target="_blank" rel="noopener noreferrer">new Buffer(string[, encoding])</a></span></a></h3><p>é¦–å…ˆï¼Œéœ€è¦æŒ‡å‡ºçš„æ˜¯ <code>new Buffer(string[, encoding])</code> æ˜¯ä¸€ä¸ªå·²ç»åºŸå¼ƒï¼ˆdeprecatedï¼‰çš„æ–¹æ³•ï¼Œåœ¨ Node.js ä¸­åˆ›å»º Buffer åº”è¯¥ä½¿ç”¨æ–°çš„æ–¹æ³•ã€‚ä½†ä¸ºäº†è§£ç­”ä½ çš„é—®é¢˜ï¼Œæˆ‘ä¼šå…ˆè§£é‡Šè¿™ä¸ªåºŸå¼ƒçš„æ–¹æ³•å†å‘Šè¯‰ä½ ç°åœ¨åº”è¯¥å¦‚ä½•æ­£ç¡®åˆ›å»º Bufferã€‚</p><h2 id="ä»€ä¹ˆæ˜¯-buffer-2" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-buffer-2"><span>ä»€ä¹ˆæ˜¯ Buffer?</span></a></h2><p>åœ¨ Node.js ä¸­ï¼ŒBuffer æ˜¯ä¸€ç§ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„å¯¹è±¡ã€‚å°±åƒå¯ä»¥å°†å­—ç¬¦ä¸²è§†ä¸ºå­—ç¬¦çš„æ•°ç»„ä¸€æ ·ï¼ŒBuffer å®é™…ä¸Šæ˜¯å­—èŠ‚çš„æ•°ç»„ã€‚å®ƒè¢«ç”¨æ¥å¤„ç†ä¾‹å¦‚æ–‡ä»¶è¯»å†™ã€ç½‘ç»œé€šä¿¡ç­‰åœºåˆï¼Œå› ä¸ºè¿™äº›æ“ä½œé€šå¸¸éœ€è¦å¤„ç†å¤§é‡çš„äºŒè¿›åˆ¶æ•°æ®ã€‚</p><h2 id="å·²åºŸå¼ƒçš„-new-buffer-string-encoding" tabindex="-1"><a class="header-anchor" href="#å·²åºŸå¼ƒçš„-new-buffer-string-encoding"><span>å·²åºŸå¼ƒçš„ <code>new Buffer(string[, encoding])</code></span></a></h2><p>ä¹‹å‰ç‰ˆæœ¬çš„ Node.js æ”¯æŒé€šè¿‡<code>new Buffer()</code>æ„é€ å‡½æ•°æ¥åˆ›å»º Buffer å®ä¾‹ã€‚å‚æ•°<code>string</code>ä»£è¡¨ä½ æƒ³è¦æ”¾å…¥ Buffer ä¸­çš„å­—ç¬¦ä¸²ï¼Œè€Œå¯é€‰çš„å‚æ•°<code>encoding</code>åˆ™è¡¨ç¤ºè¿™ä¸ªå­—ç¬¦ä¸²çš„ç¼–ç æ ¼å¼ï¼ˆæ¯”å¦‚&#39;utf8&#39;, &#39;ascii&#39;ç­‰ï¼‰ï¼Œå¦‚æœä¸æä¾›ï¼Œé»˜è®¤æ˜¯&#39;utf8&#39;ã€‚</p><p>ä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Deprecated way to create a Buffer from a string</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œåˆ›å»ºäº†ä¸€ä¸ªåŒ…å«â€œHello Worldâ€æ–‡æœ¬çš„ Bufferï¼Œä½¿ç”¨&#39;utf8&#39;ç¼–ç ã€‚</p><p>ç„¶è€Œï¼Œç”±äºå®‰å…¨æ€§å’Œæ€§èƒ½åŸå› ï¼ŒNode.js ç¤¾åŒºå†³å®šåºŸå¼ƒ<code>new Buffer()</code>æ„é€ å‡½æ•°ï¼Œå¹¶æ¨èä½¿ç”¨å…¶ä»–æ–¹æ³•æ¥åˆ›å»º Buffer å®ä¾‹ã€‚</p><h2 id="æ­£ç¡®åˆ›å»º-buffer-çš„æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#æ­£ç¡®åˆ›å»º-buffer-çš„æ–¹å¼"><span>æ­£ç¡®åˆ›å»º Buffer çš„æ–¹å¼</span></a></h2><p>ç›®å‰æ¨èçš„åˆ›å»º Buffer å®ä¾‹çš„æ–¹æ³•æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><h3 id="buffer-from" tabindex="-1"><a class="header-anchor" href="#buffer-from"><span><code>Buffer.from()</code></span></a></h3><p>æœ€å¸¸è§çš„æ–¹æ³•æ˜¯ä½¿ç”¨<code>Buffer.from()</code>æ–¹æ³•ï¼Œå®ƒæ¥å—åŒæ ·çš„å‚æ•°å¹¶ä¸”æ›´å®‰å…¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Correct way to create a Buffer from a string</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å’Œä¸Šé¢çš„æ—§è¡Œä¸ºä¸€æ ·ï¼Œä¹Ÿæ˜¯åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«â€œHello Worldâ€çš„ Bufferã€‚</p><h3 id="buffer-alloc" tabindex="-1"><a class="header-anchor" href="#buffer-alloc"><span><code>Buffer.alloc()</code></span></a></h3><p>å½“ä½ æƒ³è¦åˆ›å»ºä¸€ä¸ªç‰¹å®šå¤§å°çš„ Bufferï¼Œå¹¶ä¸”ç”¨ 0 æ¥å¡«å……æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>Buffer.alloc()</code>æ–¹æ³•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Creating a filled Buffer of length 10</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Creates a Buffer of size 10 bytes, filled with zeros.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="buffer-allocunsafe" tabindex="-1"><a class="header-anchor" href="#buffer-allocunsafe"><span><code>Buffer.allocUnsafe()</code></span></a></h3><p>å¦‚æœä½ æƒ³è¦åˆ›å»ºä¸€ä¸ªç‰¹å®šå¤§å°çš„ Bufferï¼Œä½†æ˜¯ä¸éœ€è¦ç”¨ 0 å¡«å……ï¼ˆè¿™å¯èƒ½ç•¥å¾®æå‡æ€§èƒ½ï¼Œä½†ä½¿ç”¨æ—¶è¦å°å¿ƒï¼Œå› ä¸ºå®ƒå¯èƒ½åŒ…å«æ—§æ•°æ®ï¼‰ï¼Œåˆ™å¯ä»¥ä½¿ç”¨<code>Buffer.allocUnsafe()</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Creating an uninitialized Buffer of length 10 (potentially unsafe)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">allocUnsafe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Faster, but the allocated segment of memory might contain old data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å®é™…è¿ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h2><h3 id="æ–‡ä»¶è¯»å–" tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶è¯»å–"><span>æ–‡ä»¶è¯»å–</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨è¯»å–ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶ï¼Œä½ å¯èƒ½éœ€è¦å°†è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹è¯»å…¥åˆ°ä¸€ä¸ª Buffer ä¸­ä»¥ä¾¿åç»­å¤„ç†ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path/to/image.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// &#39;data&#39; is an instance of Buffer containing the file content</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç½‘ç»œè¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#ç½‘ç»œè¯·æ±‚"><span>ç½‘ç»œè¯·æ±‚</span></a></h3><p>å½“ä½ é€šè¿‡ HTTP è·å–æ•°æ®æ—¶ï¼ŒæœåŠ¡å™¨è¿”å›çš„æ•°æ®å¯èƒ½æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æµï¼Œä½ å¯ä»¥å°†è¿™äº›æ•°æ®å­˜å‚¨åœ¨ Buffer å¯¹è±¡ä¸­ä»¥ä¾¿åç»­å¤„ç†ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">http</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> chunks</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  res</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      chunks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">concat</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">chunks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// &#39;data&#39; is a Buffer containing the whole response body</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ€»ç»“ï¼šè™½ç„¶<code>new Buffer()</code>æ–¹æ³•å·²ç»åºŸå¼ƒï¼Œä½†ç†è§£ Buffer çš„æ¦‚å¿µåŠå…¶åœ¨ Node.js ä¸­çš„åº”ç”¨éå¸¸é‡è¦ã€‚åœ¨å¤„ç†å„ç§ I/O æ“ä½œï¼Œå¦‚æ–‡ä»¶è¯»å–æˆ–ç½‘ç»œé€šä¿¡æ—¶ï¼ŒBuffer æ˜¯ä¸èƒ½æˆ–ç¼ºçš„å·¥å…·ã€‚ç°åœ¨ä½ åº”è¯¥ä½¿ç”¨<code>Buffer.from()</code>, <code>Buffer.alloc()</code>, æˆ–è€…<code>Buffer.allocUnsafe()</code>æ¥åˆ›å»º Buffer å®ä¾‹ã€‚</p><h2 id="class-file" tabindex="-1"><a class="header-anchor" href="#class-file"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#class-file" target="_blank" rel="noopener noreferrer">Class: File</a></span></a></h2><p>Node.js ä¸­çš„ <code>File</code> ç±»å¹¶éç›´æ¥éƒ¨åˆ†ï¼Œä½ å¯èƒ½æ˜¯åœ¨æåˆ° <code>fs.File</code> ç±»ï¼Œè¿™æ˜¯åœ¨ Node.js çš„æ–‡ä»¶ç³»ç»Ÿ (<code>fs</code>) æ¨¡å—ä¸­å¼•å…¥çš„ã€‚ä» v15.4.0 ç‰ˆæœ¬å¼€å§‹ï¼ŒNode.js å¼•å…¥äº†ä¸€ä¸ªæ–°çš„å®éªŒæ€§ API <code>fs.promises</code> æ–‡ä»¶å¥æŸ„ç±»ï¼Œä¹Ÿå°±æ˜¯ <code>fs.FileHandle</code>ã€‚è¿™ä¸ªç±»å…è®¸ä½ å¯¹æ–‡ä»¶è¿›è¡Œæ›´åº•å±‚çš„æ“ä½œã€‚</p><p>ä¸ºäº†ä¾¿äºç†è§£ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ <code>fs/promises</code> æ¨¡å—ä¸­çš„ <code>file</code> ç±»æ¥ä¸¾ä¾‹è¯´æ˜ã€‚è¿™ä¸ªç±»æä¾›äº†ä¸€ç³»åˆ—æ–¹æ³•ç”¨äºå¼‚æ­¥åœ°æ“ä½œæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶ã€‚è¿™é‡Œæœ‰ä¸€äº›æœ€å¸¸ç”¨çš„æ–¹æ³•ï¼š</p><ol><li><strong>open()</strong> - æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å¹¶è¿”å›ä¸€ä¸ª <code>FileHandle</code> å¯¹è±¡ã€‚</li><li><strong>read()</strong> - è¯»å–ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶çš„æ•°æ®ã€‚</li><li><strong>write()</strong> - å†™å…¥æ•°æ®åˆ°ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶ä¸­ã€‚</li><li><strong>close()</strong> - å…³é—­ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶ã€‚</li></ol><p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡å‡ ä¸ªå®é™…çš„ä¾‹å­æ¥è¯¦ç»†è¯´æ˜è¿™äº›æ–¹æ³•çš„ä½¿ç”¨ï¼š</p><h3 id="open" tabindex="-1"><a class="header-anchor" href="#open"><span>open()</span></a></h3><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fsPromises</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs/promises&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> openFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fileHandle</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">open</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;r&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å¼€æ–‡ä»¶ä»¥è¿›è¡Œè¯»å–</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;File opened successfully&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> fileHandle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Error opening file:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">openFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°è¯•æ‰“å¼€ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡ä»¶ã€‚ç¬¬äºŒä¸ªå‚æ•° <code>&#39;r&#39;</code> è¡¨ç¤ºæˆ‘ä»¬ä»¥åªè¯»æ–¹å¼æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ã€‚è¿™ä¸ªæ“ä½œæ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ <code>await</code> å…³é”®å­—ç­‰å¾…å®ƒå®Œæˆï¼Œå¹¶å°†ç»“æœèµ‹ç»™ <code>fileHandle</code> å˜é‡ã€‚</p><h3 id="read" tabindex="-1"><a class="header-anchor" href="#read"><span>read()</span></a></h3><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">fileHandle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1024</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªBufferæ¥å­˜æ”¾è¯»å–çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">bytesRead</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">readBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fileHandle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">read</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      offset</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      position</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Read from file:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">readBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bytesRead</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Error reading file:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fileHandle</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> openFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨å‰é¢çš„ openFile å‡½æ•°æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fileHandle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fileHandle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">close</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯»å–æ–‡ä»¶ï¼Œå¹¶åœ¨å®Œæˆåå…³é—­æ–‡ä»¶</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªå¤§å°ä¸º 1024 å­—èŠ‚çš„ç¼“å†²åŒºæ¥æ¥æ”¶æ–‡ä»¶å†…å®¹ã€‚ç„¶åè°ƒç”¨ <code>fileHandle.read()</code> æ–¹æ³•æ¥è¯»å–æ•°æ®ï¼Œå¹¶å°†ç»“æœè¾“å‡ºåˆ°æ§åˆ¶å°ã€‚</p><h3 id="write" tabindex="-1"><a class="header-anchor" href="#write"><span>write()</span></a></h3><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> writeFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">fileHandle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">bytesWritten</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fileHandle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Wrote </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bytesWritten</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bytes to the file.`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Error writing to file:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fileHandle</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> openFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ openFile å‡½æ•°æ‰“å¼€æ–‡ä»¶ï¼ˆæ­¤æ—¶åº”è¯¥ä»¥å†™å…¥æ¨¡å¼æ‰“å¼€ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fileHandle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, Node.js!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fileHandle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">close</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å†™å…¥&quot;Hello, Node.js!&quot;åˆ°æ–‡ä»¶</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>fileHandle.write()</code> æ–¹æ³•å‘æ–‡ä»¶å†™å…¥ä¸€æ®µæ–‡æœ¬ <code>&quot;Hello, Node.js!&quot;</code>ã€‚æ³¨æ„ï¼Œå¦‚æœæˆ‘ä»¬è¦å†™å…¥æ–‡ä»¶ï¼Œæ‰“å¼€æ–‡ä»¶æ—¶åº”è¯¥ä½¿ç”¨ä¸åŒçš„æ¨¡å¼ï¼ˆä¾‹å¦‚ <code>&#39;w&#39;</code> å†™å…¥æ¨¡å¼ï¼‰ã€‚</p><h3 id="close" tabindex="-1"><a class="header-anchor" href="#close"><span>close()</span></a></h3><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> closeFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">fileHandle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fileHandle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">close</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;File closed successfully&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Error closing file:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fileHandle</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> openFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ...è¿›è¡Œè¯»å–æˆ–å†™å…¥æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">closeFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fileHandle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®Œæˆæ“ä½œåå…³é—­æ–‡ä»¶</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨ <code>fileHandle.close()</code> æ–¹æ³•æ¥å…³é—­ä¸€ä¸ªå·²ç»æ‰“å¼€çš„æ–‡ä»¶ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ¯å½“ä½ æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å¹¶è·å¾—äº†ä¸€ä¸ª <code>FileHandle</code> å¯¹è±¡åï¼Œæ— è®ºæ“ä½œæˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½åº”å½“ç¡®ä¿åœ¨ç»“æŸæ—¶å…³é—­è¿™ä¸ªæ–‡ä»¶ï¼Œä»¥é‡Šæ”¾ç³»ç»Ÿèµ„æºã€‚</p><p>ä»¥ä¸Šå°±æ˜¯å…³äº <code>fs/promises</code> ä¸­ <code>FileHandle</code> ç±»çš„åŸºæœ¬ä½¿ç”¨ã€‚è™½ç„¶ä¸Šè¿°ä¾‹å­ä¸­çš„ <code>FileHandle</code> ç±»è¢«ç§°ä¸º <code>File</code>ï¼Œä½†è¯·è®°ä½åœ¨ Node.js æ–‡æ¡£ä¸­æŸ¥æ‰¾ <code>fs.promises.FileHandle</code> è·å–æ›´è¯¦ç»†çš„ä¿¡æ¯å’Œå…¶ä»–æ–¹æ³•ã€‚è€Œä¸”ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªå®éªŒæ€§çš„ APIï¼Œæ‰€ä»¥åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨å®ƒæ—¶åº”è¯¥è°¨æ…ï¼Œå¹¶ä¸”éšæ—¶å…³æ³¨ Node.js çš„æ›´æ–°ï¼Œä»¥é˜²è¿™äº› API å‘ç”Ÿå˜åŒ–ã€‚</p><h3 id="new-buffer-file-sources-filename-options" tabindex="-1"><a class="header-anchor" href="#new-buffer-file-sources-filename-options"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#new-bufferfilesources-filename-options" target="_blank" rel="noopener noreferrer">new buffer.File(sources, fileName[, options])</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ç¨‹åºã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ä¸ªå…¨å±€çš„ <code>buffer</code> æ¨¡å—ï¼Œå®ƒæä¾›äº†ä¸€ç§ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„æ–¹å¼ã€‚</p><p>æˆªè‡³æˆ‘çŸ¥è¯†æ›´æ–°çš„æ—¶é—´ç‚¹ï¼ˆ2023 å¹´ï¼‰ï¼Œ<code>buffer.File</code> ä¸æ˜¯ Node.js å®˜æ–¹æ–‡æ¡£ä¸­æä¾›çš„ APIã€‚å› æ­¤ï¼Œæˆ‘æ¨æµ‹æ‚¨å¯èƒ½æ˜¯è¯¯è§£äº†æŸäº›ä¿¡æ¯æˆ–è€…çœ‹åˆ°äº†ç¬¬ä¸‰æ–¹åº“çš„ APIã€‚</p><p>ä½†æ˜¯ï¼Œä¸ºäº†å¸®åŠ©ä½ ç†è§£ä¸ä¹‹ç±»ä¼¼çš„æ¦‚å¿µï¼Œæˆ‘å¯ä»¥ç»™ä½ è®²è§£ Buffer ç±»åœ¨ Node.js ä¸­çš„ä½œç”¨ï¼Œå¹¶ä¸¾ä¾‹å…¶å¦‚ä½•ä½¿ç”¨ã€‚</p><p>Buffer ç±»åœ¨ Node.js ä¸­æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œä¸éœ€è¦é€šè¿‡ <code>require(&#39;buffer&#39;)</code> æ¥å¼•å…¥ã€‚Buffer è¢«ç”¨æ¥ç›´æ¥æ“ä½œå†…å­˜ä¸­çš„æ•°æ®ã€‚è¿™å¯¹äºå¤„ç†åƒ TCP æµæˆ–æ–‡ä»¶ç³»ç»Ÿæ“ä½œç­‰ I/O ä»»åŠ¡éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºè¿™äº›ä»»åŠ¡é€šå¸¸æ¶‰åŠåˆ°å¤„ç†å¤§é‡çš„äºŒè¿›åˆ¶æ•°æ®ã€‚</p><p>åˆ›å»º Buffer çš„ä¾‹å­:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º10å­—èŠ‚çš„Bufferå®ä¾‹ï¼Œæ‰€æœ‰å­—èŠ‚è¢«åˆå§‹åŒ–ä¸º0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªBufferå®ä¾‹å¹¶ä»¥ç‰¹å®šçš„æ•°æ®å¡«å……å®ƒ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªBufferå®ä¾‹å¹¶æ ¹æ®ç»™å®šçš„å­—ç¬¦ä¸²å¡«å……å®ƒ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf3</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf-8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µï¼šæ¯”å¦‚ä½ è¦ä»ä¸€ä¸ªæ–‡ä»¶ä¸­è¯»å–æ•°æ®æˆ–è€…æ”¶åˆ°äº†ä¸€ä¸ªç½‘ç»œè¯·æ±‚çš„æ•°æ®ï¼Œé‚£ä¹ˆè¿™äº›æ•°æ®å°±ä¼šä»¥ Buffer çš„å½¢å¼å‡ºç°ã€‚</p><p>ä¾‹å¦‚ï¼Œä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼‚æ­¥è¯»å–æ–‡ä»¶çš„å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/path/to/file.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // &#39;data&#39;æ˜¯ä¸€ä¸ªBufferï¼ŒåŒ…å«äº†æ–‡ä»¶çš„å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå½“ readFile å‡½æ•°è¯»å–æ–‡ä»¶å†…å®¹æ—¶ï¼Œå®ƒå°†å†…å®¹ä¿å­˜åœ¨ Buffer <code>data</code> ä¸­ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥è°ƒç”¨ <code>toString()</code> æ–¹æ³•å°† Buffer ä¸­çš„æ•°æ®è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚</p><p>è¯·æ³¨æ„ï¼Œå³ä½¿ <code>buffer.File</code> åœ¨æ‚¨æä¾›çš„é“¾æ¥ä¸­å¹¶ä¸å­˜åœ¨ï¼Œä¸Šè¿°çš„ Buffer çš„ä½¿ç”¨æ–¹æ³•ä¾ç„¶æ˜¯ Node.js å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„æ ‡å‡†æ–¹å¼ã€‚</p><p>å¦‚æœæ‚¨ç¡®å®é‡åˆ°äº† <code>buffer.File</code> è¿™ä¸ª APIï¼Œå¹¶ä¸”å®ƒæ¥è‡ªäºæŸä¸ªç‰¹å®šçš„ Node.js ç‰ˆæœ¬æˆ–è€…ç¬¬ä¸‰æ–¹åº“ï¼Œè¯·æŸ¥é˜…ç›¸åº”çš„æ–‡æ¡£ä»¥è·å¾—æ­£ç¡®çš„æŒ‡å¯¼ã€‚</p><h3 id="file-name" tabindex="-1"><a class="header-anchor" href="#file-name"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#filename" target="_blank" rel="noopener noreferrer">file.name</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>file.name</code>å¹¶ä¸æ˜¯ä¸€ä¸ªå®˜æ–¹çš„ API æˆ–è€…ç‰¹æ€§ã€‚ä½ å¯èƒ½æ˜¯åœ¨æåˆ°ä¸æ–‡ä»¶æ“ä½œç›¸å…³çš„æŸä¸ªåº“æˆ–æ–¹æ³•ä¸­çœ‹åˆ°äº†<code>file.name</code>è¿™æ ·çš„ç”¨æ³•ã€‚</p><p>é€šå¸¸ï¼Œåœ¨ç¼–ç¨‹ä¸­ï¼Œå½“æˆ‘ä»¬å¼•ç”¨<code>file.name</code>æ—¶ï¼Œæˆ‘ä»¬æ˜¯åœ¨è®¨è®ºä¸€ä¸ªåŒ…å«æœ‰å…³æ–‡ä»¶ä¿¡æ¯çš„å¯¹è±¡çš„å±æ€§ï¼Œå…¶ä¸­<code>.name</code>å±æ€§é€šå¸¸æŒ‡æ–‡ä»¶çš„åç§°ã€‚ç„¶è€Œï¼Œåœ¨ Node.js å®˜æ–¹æ–‡æ¡£ä¸­ï¼Œå¹¶æ²¡æœ‰ç›´æ¥æåˆ°åä¸º<code>file.name</code>çš„ APIã€‚</p><p>ä¸è¿‡ï¼Œæˆ‘å¯ä»¥å‘Šè¯‰ä½ é€šå¸¸å¦‚ä½•åœ¨ Node.js ä¸­å¤„ç†æ–‡ä»¶åï¼ˆå¹¶ç»™å‡ºä¸€äº›å‡å®šåœºæ™¯ä¸­çš„ä¾‹å­ï¼‰ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œå¦‚æœä½ æƒ³å¤„ç†æ–‡ä»¶ç³»ç»Ÿï¼Œä½ ä¼šç”¨åˆ°<code>fs</code>æ¨¡å—ï¼ˆæ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼‰ã€‚è¯¥æ¨¡å—æä¾›äº†ä¸€ç³»åˆ—ç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„ APIã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>fs.stat()</code>ï¼Œ<code>fs.readFile()</code>ï¼Œä»¥åŠ<code>fs.writeFile()</code>ç­‰å‡½æ•°æ¥è·å–æ–‡ä»¶çŠ¶æ€ã€è¯»å–æ–‡ä»¶å†…å®¹å’Œå†™å…¥å†…å®¹åˆ°æ–‡ä»¶ã€‚</p><p>è¿™é‡Œæœ‰å‡ ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼š</p><p><strong>ä¾‹å­ 1ï¼šè¯»å–æ–‡ä»¶çš„å†…å®¹</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼‚æ­¥è¯»å–æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/path/to/your/file.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºæ–‡ä»¶çš„å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä¾‹å­ 2ï¼šå†™å…¥å†…å®¹åˆ°æ–‡ä»¶</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼‚æ­¥å†™å…¥å†…å®¹åˆ°æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/path/to/your/file.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;The file has been saved!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ–‡ä»¶è¢«ä¿å­˜åçš„å›è°ƒ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä¾‹å­ 3ï¼šè¯»å–ç›®å½•å¹¶è¾“å‡ºæ‰€æœ‰æ–‡ä»¶çš„åç§°</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> path</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼‚æ­¥è¯»å–ç›®å½•å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readdir</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/path/to/your/directory/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">files</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  files</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">file</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">file</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œçš„fileå°±æ˜¯æ–‡ä»¶åï¼ˆåŒ…æ‹¬æ‰©å±•åï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™äº›ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ç›´æ¥ä½¿ç”¨<code>file.name</code>ï¼Œä½†æ˜¯æˆ‘ä»¬é€šè¿‡<code>fs</code>æ¨¡å—ä¸æ–‡ä»¶äº’åŠ¨ï¼Œæˆ‘ä»¬å¯ä»¥è·å–æ–‡ä»¶çš„è·¯å¾„ã€å†…å®¹ã€çŠ¶æ€ç­‰ä¿¡æ¯ã€‚</p><p>å¦‚æœä½ æ˜¯åœ¨æŸä¸ªç‰¹å®šçš„ä¸Šä¸‹æ–‡ï¼ˆæ¯”å¦‚å…·ä½“çš„åº“æˆ–æ¡†æ¶ï¼‰ä¸­è§åˆ°<code>file.name</code>ï¼Œéœ€å‚è€ƒé‚£ä¸ªç‰¹å®šç¯å¢ƒçš„æ–‡æ¡£ä»¥è·å¾—æ›´å‡†ç¡®çš„ä¿¡æ¯ã€‚</p><h3 id="file-lastmodified" tabindex="-1"><a class="header-anchor" href="#file-lastmodified"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#filelastmodified" target="_blank" rel="noopener noreferrer">file.lastModified</a></span></a></h3><p><code>file.lastModified</code> åœ¨ Node.js çš„ä¸Šä¸‹æ–‡ä¸­å¹¶ä¸æ˜¯ä¸€ä¸ªç›´æ¥çš„å‡½æ•°æˆ–å±æ€§ï¼Œè€Œæ˜¯é€šå¸¸ä¸ Web æµè§ˆå™¨ç¯å¢ƒä¸­çš„ <code>File</code> å¯¹è±¡ API ç›¸å…³è”ã€‚åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ï¼Œ<code>File</code> å¯¹è±¡ä»£è¡¨ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸” <code>lastModified</code> å±æ€§è¿”å›ä¸€ä¸ªæ—¶é—´æˆ³ï¼ˆè‡ª 1970 å¹´ 1 æœˆ 1 æ—¥ 00:00:00 UTC ä»¥æ¥ç»è¿‡çš„æ¯«ç§’æ•°ï¼‰ï¼Œè¡¨ç¤ºæ–‡ä»¶æœ€åä¸€æ¬¡è¢«ä¿®æ”¹çš„æ—¶é—´ã€‚</p><p>ç„¶è€Œï¼Œåœ¨ Node.js ä¸­ï¼Œç±»ä¼¼çš„åŠŸèƒ½æ˜¯é€šè¿‡ä½¿ç”¨ <code>fs</code> æ¨¡å—ï¼ˆæ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼‰æä¾›çš„æ–¹æ³•æ¥å®ç°çš„ã€‚è¿™ä¸ªæ¨¡å—å…è®¸ä½ ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’ï¼Œæ¯”å¦‚è¯»å–å’Œå†™å…¥æ–‡ä»¶ä»¥åŠè·å–æ–‡ä»¶ä¿¡æ¯ã€‚</p><p>è¦è·å–æ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´ï¼Œé€šå¸¸ä¼šä½¿ç”¨ <code>fs.stat()</code> æˆ–è€… <code>fs.statSync()</code> æ–¹æ³•ã€‚å½“ä½ è°ƒç”¨è¿™äº›æ–¹æ³•æ—¶ï¼Œå®ƒä»¬ä¼šè¿”å›ä¸€ä¸ª <code>fs.Stats</code> å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº†æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æœ€åä¿®æ”¹æ—¶é—´ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ <code>fs.statSync()</code> è·å–æ–‡ä»¶æœ€åä¿®æ”¹æ—¥æœŸçš„ Node.js ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŒæ­¥ç‰ˆæœ¬ï¼Œä¼šé˜»å¡çº¿ç¨‹ç›´åˆ°æ–‡ä»¶ä¿¡æ¯è¢«è¯»å–</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è°ƒç”¨ fs.statSync() æ¥è·å–æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> stats</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">statSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œçš„ &#39;example.txt&#39; æ˜¯ä½ æƒ³è¦æ£€æŸ¥çš„æ–‡ä»¶å</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä½¿ç”¨ stats å¯¹è±¡çš„ mtime å±æ€§æ¥è·å–æœ€åä¿®æ”¹æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ–‡ä»¶æœ€åä¿®æ”¹æ—¶é—´ä¸º: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stats</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">mtime</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è·å–æ–‡ä»¶ä¿¡æ¯æ—¶å‡ºé”™: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">error</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä½ åå¥½éé˜»å¡å¼‚æ­¥æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ <code>fs.stat()</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼‚æ­¥ç‰ˆæœ¬ï¼Œä¸ä¼šé˜»å¡çº¿ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">stat</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">stats</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è·å–æ–‡ä»¶ä¿¡æ¯æ—¶å‡ºé”™: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">error</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ–‡ä»¶æœ€åä¿®æ”¹æ—¶é—´ä¸º: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stats</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">mtime</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸¤ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éƒ½åœ¨è¯•å›¾è·å–åä¸º &#39;example.txt&#39; æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯ã€‚å¦‚æœæˆåŠŸï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¿é—®å…¶ä¸­çš„ <code>mtime</code> å±æ€§ï¼Œè¿™æ˜¯ä¸€ä¸ª <code>Date</code> å¯¹è±¡ï¼Œä»£è¡¨æœ€åä¿®æ”¹æ—¶é—´ã€‚</p><p>æ³¨æ„ï¼Œæˆ‘åœ¨è¿™é‡Œå‡å®šä½ æ­£åœ¨ä½¿ç”¨ç‰ˆæœ¬ v21.7.1 çš„ Node.jsï¼Œä½†åœ¨å¤§å¤šæ•°ç‰ˆæœ¬çš„ Node.js ä¸­ï¼Œ<code>fs.stat()</code> å’Œ <code>fs.statSync()</code> çš„è¡Œä¸ºåº”è¯¥æ˜¯ç›¸ä¼¼çš„ã€‚åœ¨ç¼–å†™ä»»ä½•æ¶‰åŠæ–‡ä»¶ç³»ç»Ÿäº’åŠ¨çš„ä»£ç æ—¶ï¼Œè¯·ç¡®ä¿å¤„ç†å¯èƒ½å‘ç”Ÿçš„é”™è¯¯ï¼Œä¾‹å¦‚æ–‡ä»¶ä¸å­˜åœ¨æˆ–æ²¡æœ‰æƒé™è¯»å–æ–‡ä»¶ç­‰æƒ…å†µã€‚</p><h2 id="node-buffer-module-apis" tabindex="-1"><a class="header-anchor" href="#node-buffer-module-apis"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#nodebuffer-module-apis" target="_blank" rel="noopener noreferrer">node:buffer module APIs</a></span></a></h2><p>Node.js ä¸­çš„ <code>buffer</code> æ¨¡å—æä¾›äº†ä¸€ç§ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„æ–¹å¼ã€‚åœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å¤„ç†çš„æ˜¯æ–‡æœ¬æ•°æ®ï¼Œå¦‚å­—ç¬¦ä¸²ã€‚ä½†åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†åƒå›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘æˆ–è€…ä»ç½‘ç»œæ¥æ”¶å’Œå‘é€çš„åŸå§‹æ•°æ®è¿™æ ·çš„äºŒè¿›åˆ¶æ•°æ®ã€‚è¿™äº›ç±»å‹çš„æ•°æ®æ— æ³•ä»¥ä¼ ç»Ÿçš„å­—ç¬¦ä¸²å½¢å¼æœ‰æ•ˆåœ°è¡¨ç¤ºå’Œå¤„ç†ï¼Œå› æ­¤ Node.js æä¾›äº† Buffer ç±»æ¥ä¸“é—¨å¤„ç†è¿™ç±»æ•°æ®ã€‚</p><p>Buffer ç±»æ˜¯ Node.js çš„å…¨å±€å˜é‡ï¼Œæ‰€ä»¥ä¸éœ€è¦ä½¿ç”¨ <code>require</code> æ¥å¼•å…¥ã€‚ä¸‹é¢æ˜¯å…³äº Node.js ä¸­ Buffer çš„å‡ ä¸ªåŸºæœ¬æ¦‚å¿µå’Œä½¿ç”¨ä¾‹å­ï¼š</p><h3 id="åˆ›å»º-buffer" tabindex="-1"><a class="header-anchor" href="#åˆ›å»º-buffer"><span>åˆ›å»º Buffer</span></a></h3><p>å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼åˆ›å»ºä¸€ä¸ª Buffer å®ä¾‹ï¼š</p><ol><li><p>ä½¿ç”¨ <code>Buffer.alloc(size)</code> æ–¹æ³•åˆ›å»ºä¸€ä¸ªæŒ‡å®šå¤§å°çš„ Bufferï¼Œå¹¶è‡ªåŠ¨å¡«å……ä¸º 0ã€‚ä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª10å­—èŠ‚çš„ç©ºé—´ï¼Œæ‰€æœ‰å­—èŠ‚åˆå§‹åŒ–ä¸º0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ä½¿ç”¨ <code>Buffer.from(array)</code> ä»ä¸€ä¸ªæ•°ç»„åˆ›å»ºä¸€ä¸ª Bufferã€‚ä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x62</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x75</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x66</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x66</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å« ASCII å­—ç¬¦ &#39;buff&#39; çš„ Buffer</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ä½¿ç”¨ <code>Buffer.from(string)</code> ä»ä¸€ä¸ªå­—ç¬¦ä¸²åˆ›å»ºä¸€ä¸ª Bufferã€‚ä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŒ…å« &#39;Hello World&#39; æ–‡æœ¬çš„ Buffer</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ol><h3 id="å†™å…¥å’Œè¯»å–-buffer" tabindex="-1"><a class="header-anchor" href="#å†™å…¥å’Œè¯»å–-buffer"><span>å†™å…¥å’Œè¯»å– Buffer</span></a></h3><p>ä¸€æ—¦æœ‰äº† Buffer å®ä¾‹ï¼Œå°±å¯ä»¥è¿›è¡Œå†™å…¥å’Œè¯»å–æ“ä½œã€‚</p><ul><li><p>å†™å…¥ Buffer:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hi&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ Buffer çš„ç¬¬ 0 ä½ç½®å¼€å§‹å†™å…¥å­—ç¬¦ä¸² &#39;Hi&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>è¯»å– Buffer:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º Buffer è½¬æ¢æˆçš„å­—ç¬¦ä¸²ï¼Œé»˜è®¤ç¼–ç æ˜¯ UTF-8</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><h3 id="buffer-å’Œ-i-o-æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#buffer-å’Œ-i-o-æ“ä½œ"><span>Buffer å’Œ I/O æ“ä½œ</span></a></h3><p>Buffer å¸¸ç”¨äºæ–‡ä»¶ç³»ç»Ÿæ“ä½œå’Œç½‘ç»œæ“ä½œä¸­ï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶æˆ–æ¥æ”¶ç½‘ç»œè¯·æ±‚æ—¶ã€‚</p><ul><li><p>ä»æ–‡ä»¶ç³»ç»Ÿè¯»å–æ•°æ®åˆ° Bufferï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path/to/file&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// data æ˜¯ä¸€ä¸ª Buffer å¯¹è±¡ï¼ŒåŒ…å«æ–‡ä»¶çš„äºŒè¿›åˆ¶å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å‘é€ Buffer æ•°æ®é€šè¿‡ HTTP å“åº”ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> server</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeHead</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Content-Type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;text/plain&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‘é€ Buffer åˆ°å®¢æˆ·ç«¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="buffer-çš„å…¶ä»–æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#buffer-çš„å…¶ä»–æ“ä½œ"><span>Buffer çš„å…¶ä»–æ“ä½œ</span></a></h3><p>Buffer API è¿˜æä¾›äº†è®¸å¤šå…¶ä»–æ–¹æ³•æ¥æ“ä½œäºŒè¿›åˆ¶æ•°æ®ï¼Œä¾‹å¦‚ï¼š</p><ul><li><p>åˆ‡å‰² Bufferï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufSlice</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">slice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ–°çš„ Bufferï¼ŒåªåŒ…å« &#39;Hello&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">bufSlice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æ¯”è¾ƒ Bufferï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;321&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">compare</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿”å›ä¸€ä¸ªæ•°å­—è¡¨æ˜ buf1 æ˜¯å¦åœ¨ buf2 ä¹‹å‰ã€ä¹‹åæˆ–ç›¸åŒ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å¤åˆ¶ Bufferï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">copy</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°† buf1 ä¸­çš„æ•°æ®å¤åˆ¶åˆ° buf2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>Buffer æ˜¯åœ¨ Node.js ä¸­å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„åŸºç¡€ï¼Œäº†è§£å’Œç†Ÿç»ƒä½¿ç”¨ Buffer å¯¹äºå¼€å‘å„ç§ Node.js åº”ç”¨éå¸¸é‡è¦ã€‚ä¸Šè¿°ä¾‹å­å±•ç¤ºäº† Buffer æœ€åŸºç¡€çš„å‡ ä¸ªåº”ç”¨åœºæ™¯ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©ä½ ç†è§£ Buffer çš„ä½œç”¨å’ŒåŸºæœ¬ä½¿ç”¨æ–¹æ³•ã€‚</p><h3 id="buffer-atob-data" tabindex="-1"><a class="header-anchor" href="#buffer-atob-data"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufferatobdata" target="_blank" rel="noopener noreferrer">buffer.atob(data)</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥çœ‹ã€‚</p><h3 id="node-js-ä¸­çš„-buffer-atob-data" tabindex="-1"><a class="header-anchor" href="#node-js-ä¸­çš„-buffer-atob-data"><span>Node.js ä¸­çš„ <code>buffer.atob(data)</code></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>buffer.atob(data)</code>æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºå°† Base64 ç¼–ç çš„å­—ç¬¦ä¸²è½¬æ¢æˆäºŒè¿›åˆ¶å½¢å¼ã€‚Base64 æ˜¯ä¸€ç§ç¼–ç æ–¹æ³•ï¼Œå¯ä»¥è®©äºŒè¿›åˆ¶æ•°æ®ä»¥æ–‡æœ¬æ ¼å¼å­˜å‚¨å’Œä¼ è¾“ï¼Œé€šå¸¸ç”¨äºåœ¨ç½‘ç»œä¸Šä¼ è¾“å›¾ç‰‡æˆ–å…¶ä»–åª’ä½“æ–‡ä»¶ã€‚</p><p>è¿™é‡Œæåˆ°çš„&quot;Base64&quot;å…¶å®å°±æ˜¯ä¸€ç§ä½¿ç”¨ 64 ä¸ªå­—ç¬¦æ¥è¡¨ç¤ºä»»æ„äºŒè¿›åˆ¶æ•°æ®çš„æ–¹æ³•ã€‚å®ƒé€‰ç”¨äº†å¤§å°å†™è‹±æ–‡å­—æ¯ã€æ•°å­—å’Œ&quot;+/&quot;å…± 64 ä¸ªå­—ç¬¦æ¥è¡¨ç¤ºäºŒè¿›åˆ¶æ•°æ®ã€‚</p><p>ç°åœ¨è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªä¾‹å­æ¥è§£é‡Š<code>buffer.atob(data)</code>æ€ä¹ˆå·¥ä½œã€‚</p><p>å‡è®¾ä½ æ”¶åˆ°äº†ä¸€ä¸ª Base64 ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²ä»£è¡¨äº†ä¸€ä¸ªå›¾åƒçš„æ•°æ®ã€‚å¦‚æœä½ æƒ³åœ¨ Node.js ç¨‹åºä¸­ä½¿ç”¨è¿™ä¸ªå›¾åƒï¼Œä½ éœ€è¦å…ˆæŠŠå®ƒä» Base64 æ ¼å¼è½¬æ¢å›åŸå§‹çš„äºŒè¿›åˆ¶å½¢å¼ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªBase64ç¼–ç çš„å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> base64Data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;aGVsbG8gd29ybGQ=&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™ä¸ªæ˜¯&quot;hello world&quot;çš„Base64ç¼–ç </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨buffer.atobå‡½æ•°å°†å…¶è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> binaryData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">atob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">base64Data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨binaryDataå˜é‡ä¸­å­˜å‚¨çš„å°±æ˜¯åŸå§‹çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œå¯ä»¥è¿›è¡Œåç»­å¤„ç†</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>base64Data</code>å­—ç¬¦ä¸²æ˜¯&quot;hello world&quot;è¿™ä¸ªæ–‡æœ¬çš„ Base64 ç¼–ç å½¢å¼ã€‚åˆ©ç”¨<code>buffer.atob</code>å‡½æ•°ï¼Œæˆ‘ä»¬å°†å®ƒè½¬æ¢æˆäº†åŸå§‹çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œå¹¶å­˜å‚¨åœ¨<code>binaryData</code>å˜é‡ä¸­ã€‚ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹è¿™äº›æ•°æ®è¿›è¡Œæ“ä½œï¼Œæ¯”å¦‚å°†å®ƒä¿å­˜ä¸ºæ–‡ä»¶æˆ–è€…é€šè¿‡ç½‘ç»œå‘é€ç»™å…¶ä»–æœåŠ¡ç­‰ã€‚</p><p>é‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œ<code>buffer.atob(data)</code>å¤„ç†çš„æ˜¯ ASCII å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæœŸæœ›è¾“å…¥çš„å­—ç¬¦ä¸²åªåŒ…å« ASCII å­—ç¬¦ã€‚è¿™æ˜¯å› ä¸º Base64 ç¼–ç è¾“å‡ºçš„ç»“æœæ˜¯ ASCII å­—ç¬¦é›†å†…çš„å­—ç¬¦ã€‚</p><p>è¿™é‡Œè¿˜è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œåœ¨ Node.js ä¸­ï¼Œå…¨å±€å¯¹è±¡<code>buffer</code>æ˜¯å°å†™çš„ï¼Œä¸åŒäºæµè§ˆå™¨ä¸­çš„<code>window.Buffer</code>ï¼ŒNode.js ä¸­<code>Buffer</code>ä¹Ÿæ˜¯ä¸€ä¸ªå…¨å±€å¯è®¿é—®çš„æ„é€ å‡½æ•°ï¼Œç”¨æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ Buffer å®ä¾‹ã€‚</p><p>å¸Œæœ›ä»¥ä¸Šè§£é‡Šèƒ½å¸®åŠ©ä½ ç†è§£<code>buffer.atob(data)</code>å‡½æ•°åœ¨ Node.js ä¸­çš„ä½œç”¨ï¼</p><h3 id="buffer-btoa-data" tabindex="-1"><a class="header-anchor" href="#buffer-btoa-data"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufferbtoadata" target="_blank" rel="noopener noreferrer">buffer.btoa(data)</a></span></a></h3><p>Node.js ä¸­çš„ <code>buffer.btoa(data)</code> å‡½æ•°æ˜¯ç”¨æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆæˆ–è€…å¯ä»¥è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„æ•°æ®ï¼‰ç¼–ç æˆ Base64 æ ¼å¼çš„å·¥å…·ã€‚Base64 æ˜¯ä¸€ç§ç¼–ç æ–¹æ³•ï¼Œå®ƒå¯ä»¥å°†äºŒè¿›åˆ¶æ•°æ®è½¬æ¢ä¸ºç”± 64 ä¸ªæ‰“å°å­—ç¬¦ç»„æˆçš„ ASCII å­—ç¬¦ä¸²ã€‚è¿™é€šå¸¸ç”¨äºåœ¨é‚£äº›ä¸æ”¯æŒæ‰€æœ‰äºŒè¿›åˆ¶æ•°æ®çš„ç³»ç»Ÿä¸­ä¼ è¾“æ•°æ®ï¼Œä¾‹å¦‚åœ¨ç½‘é¡µä¸Šã€‚</p><p><code>btoa</code> æ˜¯â€œBinary to ASCIIâ€çš„ç¼©å†™ï¼Œè€Œ <code>atob</code> æ˜¯å…¶é€†æ“ä½œï¼Œå³â€œASCII to Binaryâ€ã€‚</p><p>è¿™é‡Œæœ‰ä¸€äº›å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><h3 id="ä¾‹å­-1-ç¼–ç ä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-ç¼–ç ä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²"><span>ä¾‹å­ 1: ç¼–ç ä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ™®é€šçš„æ–‡æœ¬å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬æƒ³æŠŠå®ƒè½¬æ¢ä¸º Base64 ç¼–ç ä»¥ä¾¿å®‰å…¨åœ°é€šè¿‡äº’è”ç½‘å‘é€ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> str</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Hello, world!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encodedStr</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">btoa</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encodedStr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: SGVsbG8sIHdvcmxkIQ==</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† Node.js çš„ <code>buffer</code> æ¨¡å—ï¼Œç„¶ååˆ›å»ºäº†ä¸€ä¸ªå­—ç¬¦ä¸² <code>str</code>ï¼Œæ¥ç€æˆ‘ä»¬ä½¿ç”¨ <code>buffer.btoa</code> å°†è¿™ä¸ªå­—ç¬¦ä¸²è½¬æ¢æˆäº† Base64 ç¼–ç çš„æ ¼å¼ï¼Œå¹¶å­˜å‚¨åœ¨å˜é‡ <code>encodedStr</code> ä¸­ã€‚æœ€åï¼Œæˆ‘ä»¬è¾“å‡ºäº†è¿™ä¸ªç¼–ç ä¹‹åçš„å­—ç¬¦ä¸²ã€‚</p><h3 id="ä¾‹å­-2-åœ¨-http-è¯·æ±‚ä¸­ç¼–ç ç”¨æˆ·å‡­è¯" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-åœ¨-http-è¯·æ±‚ä¸­ç¼–ç ç”¨æˆ·å‡­è¯"><span>ä¾‹å­ 2: åœ¨ HTTP è¯·æ±‚ä¸­ç¼–ç ç”¨æˆ·å‡­è¯</span></a></h3><p>å½“ä½ éœ€è¦é€šè¿‡ HTTP è¯·æ±‚å‘é€åŸºç¡€è®¤è¯ä¿¡æ¯æ—¶ï¼Œé€šå¸¸éœ€è¦å°†ç”¨æˆ·åå’Œå¯†ç ä»¥ <code>username:password</code> çš„å½¢å¼ç¼–ç ä¸º Base64ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”¨æˆ·åå’Œå¯†ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> username</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;user&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> password</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;pass&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª &quot;user:pass&quot; å½¢å¼çš„å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> credentials</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> username</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;:&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†å‡­è¯ç¼–ç ä¸ºBase64</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encodedCredentials</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">btoa</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">credentials</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encodedCredentials</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç±»ä¼¼äº: dXNlcjpwYXNz</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªç”±ç”¨æˆ·åå’Œå¯†ç ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œç„¶åä½¿ç”¨ <code>buffer.btoa</code> å¯¹å®ƒä»¬è¿›è¡Œäº† Base64 ç¼–ç ã€‚è¿™æ ·å¾—åˆ°çš„ç¼–ç åçš„å‡­æ®å¯ä»¥è¢«æ·»åŠ åˆ° HTTP è¯·æ±‚çš„å¤´éƒ¨ä¸­ï¼Œå¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;Authorization&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;Basic &#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encodedCredentials</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="æ³¨æ„äº‹é¡¹-1" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-1"><span>æ³¨æ„äº‹é¡¹</span></a></h3><p>è¯·æ³¨æ„ï¼Œæˆªè‡³æˆ‘çŸ¥è¯†æ›´æ–°çš„æ—¶å€™ï¼ˆ2023 å¹´ï¼‰ï¼ŒNode.js çš„ç¨³å®šç‰ˆè¿˜æ²¡æœ‰å†…ç½®å…·æœ‰ <code>buffer.btoa</code> è¿™ä¸ªå‡½æ•°åçš„å‡½æ•°ã€‚ä½†æ˜¯ï¼Œä½ å¯ä»¥ä½¿ç”¨å…¶ä»–æ–¹å¼æ¥å®Œæˆ Base64 çš„ç¼–ç ï¼Œä¾‹å¦‚ä½¿ç”¨ <code>Buffer.from(string).toString(&#39;base64&#39;)</code> æ¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> str</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Hello, world!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encodedStr</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encodedStr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: SGVsbG8sIHdvcmxkIQ==</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ€»ä¹‹ï¼Œæ— è®ºä½ ä½¿ç”¨ <code>buffer.btoa</code> è¿˜æ˜¯ <code>Buffer.from().toString(&#39;base64&#39;)</code> ï¼Œå…³é”®ç‚¹æ˜¯å°†åŸå§‹æ•°æ®è½¬æ¢æˆä¸€ç§é€šè¿‡æ–‡æœ¬æ ¼å¼å®‰å…¨ä¼ è¾“çš„ç¼–ç æ–¹å¼ï¼Œè¿™åœ¨ Web å¼€å‘ä¸­éå¸¸å¸¸è§ã€‚</p><h3 id="buffer-isascii-input" tabindex="-1"><a class="header-anchor" href="#buffer-isascii-input"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufferisasciiinput" target="_blank" rel="noopener noreferrer">buffer.isAscii(input)</a></span></a></h3><p>Node.js ä¸­çš„<code>buffer.isAscii(input)</code>æ˜¯ä¸€ä¸ªç”¨æ¥åˆ¤æ–­ç»™å®šè¾“å…¥æ˜¯å¦ä¸ºçº¯ ASCII å­—ç¬¦çš„æ–¹æ³•ã€‚åœ¨äº†è§£è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç®€å•äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ Buffer å’Œ ASCIIã€‚</p><p>Bufferï¼ˆç¼“å†²åŒºï¼‰æ˜¯ Node.js ä¸­ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ç±»ï¼ˆç±»ä¼¼äºåœ¨å…¶ä»–è¯­è¨€ä¸­çš„æ•°ç»„æˆ–åˆ—è¡¨ï¼‰ã€‚å½“ä½ å¤„ç†æ–‡ä»¶ã€ç½‘ç»œæ“ä½œæˆ–ä»»ä½•ç±»å‹çš„æµæ•°æ®æ—¶ï¼Œç»å¸¸ä¼šç”¨åˆ°å®ƒã€‚ä¾‹å¦‚ï¼Œè¯»å–ä¸€ä¸ªæ–‡ä»¶æˆ–æ¥æ”¶ç½‘ç»œè¯·æ±‚çš„æ•°æ®ï¼Œé€šå¸¸å¾—åˆ°çš„å°±æ˜¯ Buffer å¯¹è±¡ã€‚</p><p>ASCIIï¼ˆç¾å›½æ ‡å‡†ä¿¡æ¯äº¤æ¢ç ï¼‰æ˜¯ä¸€ç§å­—ç¬¦ç¼–ç æ ‡å‡†ï¼Œç”¨äºåŸºäºæ–‡æœ¬çš„æ•°æ®é€šä¿¡ã€‚ASCII è¡¨å®šä¹‰äº† 128 ä¸ªå­—ç¬¦ï¼ŒåŒ…æ‹¬è‹±æ–‡å­—æ¯ã€æ•°å­—ã€æ ‡ç‚¹ç¬¦å·ç­‰ï¼Œå¹¶ä¸ºæ¯ä¸€ä¸ªå­—ç¬¦åˆ†é…äº†ä¸€ä¸ªä» 0 åˆ° 127 çš„ç¼–å·ã€‚æ‰€æœ‰è¿™äº›å­—ç¬¦éƒ½å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå­—èŠ‚ï¼ˆ8 ä½ï¼‰è¡¨ç¤ºã€‚</p><p>ç°åœ¨å›åˆ°<code>buffer.isAscii(input)</code>ï¼Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯æ£€æŸ¥ä¸€ä¸ª Buffer å¯¹è±¡æˆ–è€…å­—ç¬¦ä¸²æ˜¯å¦åªåŒ…å« ASCII å­—ç¬¦ã€‚å¦‚æœä¼ å…¥çš„æ•°æ®å®Œå…¨ç”± ASCII å­—ç¬¦ç»„æˆï¼Œé‚£ä¹ˆå®ƒå°±è¿”å›<code>true</code>ï¼›å¦åˆ™è¿”å›<code>false</code>ã€‚</p><p>ä¸‹é¢ä¸¾å‡ ä¸ªä¾‹å­æ¥è¯´æ˜<code>buffer.isAscii(input)</code>çš„ä½¿ç”¨ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¾‹å­1ï¼šåˆ›å»ºä¸€ä¸ªçº¯ASCIIå­—ç¬¦çš„Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> buf1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">isAscii</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¾‹å­2ï¼šåˆ›å»ºåŒ…å«éASCIIå­—ç¬¦çš„Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> buf2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ã“ã‚“ã«ã¡ã¯ä¸–ç•Œ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŒ…å«æ—¥è¯­å­—ç¬¦</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">isAscii</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buf2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: false</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¾‹å­3ï¼šç›´æ¥æ£€æŸ¥å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> str1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Just some text.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">isAscii</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">str1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> str2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Texto con Ã¡ccentos&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŒ…å«è¥¿ç­ç‰™è¯­ç‰¹æ®Šå­—ç¬¦</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">isAscii</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">str2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: false</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½æƒ³è¦çŸ¥é“ä¸€æ®µä»å¤–éƒ¨æ¥æºçš„æ•°æ®æ˜¯å¦å¯ä»¥å®‰å…¨åœ°è½¬åŒ–ä¸º ASCII å­—ç¬¦ä¸²ï¼Œæˆ–è€…åˆ¤æ–­æŸäº›æ•°æ®æ˜¯å¦å…¼å®¹æ—§ç³»ç»Ÿï¼Œå› ä¸ºæ—§ç³»ç»Ÿæœ‰æ—¶å€™åªæ”¯æŒ ASCII ç¼–ç ã€‚ä½¿ç”¨<code>buffer.isAscii(input)</code>èƒ½å¤Ÿå¸®ä½ å¿«é€Ÿåšå‡ºè¿™æ ·çš„åˆ¤æ–­ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œéšç€æŠ€æœ¯çš„å‘å±•ï¼Œå¤§å¤šæ•°ç°ä»£ç³»ç»Ÿæ”¯æŒæ›´å¹¿æ³›çš„å­—ç¬¦é›†ï¼ˆå¦‚ UTF-8ï¼‰ï¼Œè¿™ä½¿å¾— ASCII æ£€æŸ¥åœ¨æŸäº›æƒ…å†µä¸‹ä¸å†é‚£ä¹ˆé‡è¦ã€‚ä½†å¯¹äºä¸€äº›ç‰¹å®šåœºæ™¯ï¼Œæ¯”å¦‚ä½çº§ç½‘ç»œåè®®çš„è®¾è®¡æˆ–æŸäº›æ—§ç³»ç»Ÿçš„äº¤äº’ï¼Œç¡®è®¤æ•°æ®ä»…ä½¿ç”¨ ASCII å­—ç¬¦é›†è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚</p><h3 id="buffer-isutf8-input" tabindex="-1"><a class="header-anchor" href="#buffer-isutf8-input"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufferisutf8input" target="_blank" rel="noopener noreferrer">buffer.isUtf8(input)</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼ŒBuffer æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ç±»ã€‚å®ƒå¯ä»¥ç”¨æ¥æ“ä½œå¤šç§æ ¼å¼çš„æ•°æ®ï¼Œæ¯”å¦‚ utf-8ã€asciiã€base64 ç­‰ã€‚</p><p><code>buffer.isUtf8(input)</code> æ˜¯ Node.js çš„ä¸€ä¸ªå®ç”¨å‡½æ•°ï¼Œç”¨äºæ£€æŸ¥æä¾›ç»™å®ƒçš„æ•°æ®ï¼ˆå³ <code>input</code> å‚æ•°ï¼‰æ˜¯å¦æ˜¯æœ‰æ•ˆçš„ UTF-8 ç¼–ç ã€‚UTF-8 æ˜¯ä¸€ç§å­—ç¬¦ç¼–ç ï¼Œå¯ä»¥è¡¨ç¤ºä¸–ç•Œä¸Šç»å¤§å¤šæ•°çš„ä¹¦é¢è¯­è¨€ï¼Œå®ƒæ˜¯ç½‘ç»œä¸Šä½¿ç”¨æœ€å¹¿æ³›çš„å­—ç¬¦ç¼–ç ä¹‹ä¸€ã€‚</p><p>ä¸‹é¢é€šè¿‡ä¸€äº›ä¾‹å­æ¥äº†è§£ <code>buffer.isUtf8(input)</code> çš„å…·ä½“ç”¨æ³•å’ŒåŠŸèƒ½ï¼š</p><h3 id="å®ä¾‹-1-æ£€æŸ¥ä¸€ä¸ªåˆæ³•çš„-utf-8-ç¼–ç çš„-buffer" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-1-æ£€æŸ¥ä¸€ä¸ªåˆæ³•çš„-utf-8-ç¼–ç çš„-buffer"><span>å®ä¾‹ 1ï¼šæ£€æŸ¥ä¸€ä¸ªåˆæ³•çš„ UTF-8 ç¼–ç çš„ Buffer</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">isUtf8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå«æœ‰ UTF-8 ç¼–ç å­—ç¬¦ä¸²çš„ Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> validUtf8Buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, ä¸–ç•Œï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf-8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥è¿™ä¸ª Buffer æ˜¯å¦æ˜¯ UTF-8 ç¼–ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">isUtf8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">validUtf8Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªåŒ…å« UTF-8 ç¼–ç æ–‡æœ¬ &quot;Hello, ä¸–ç•Œï¼&quot; çš„ Buffer å¯¹è±¡ã€‚ç„¶åä½¿ç”¨ <code>isUtf8()</code> å‡½æ•°æ¥æ£€æŸ¥å®ƒæ˜¯å¦æ˜¯æœ‰æ•ˆçš„ UTF-8 ç¼–ç ã€‚å› ä¸ºæˆ‘ä»¬æ­£ç¡®åœ°åˆ›å»ºäº†ä¸€ä¸ª UTF-8 ç¼–ç çš„ Bufferï¼Œæ‰€ä»¥å‡½æ•°è¿”å›äº† <code>true</code>ã€‚</p><h3 id="å®ä¾‹-2-æ£€æŸ¥ä¸€ä¸ªéæ³•çš„-utf-8-ç¼–ç çš„-buffer" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-2-æ£€æŸ¥ä¸€ä¸ªéæ³•çš„-utf-8-ç¼–ç çš„-buffer"><span>å®ä¾‹ 2ï¼šæ£€æŸ¥ä¸€ä¸ªéæ³•çš„ UTF-8 ç¼–ç çš„ Buffer</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">isUtf8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¯èƒ½ä¸æ˜¯æœ‰æ•ˆ UTF-8 ç¼–ç çš„ Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> invalidUtf8Buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xff</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xfe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0xfd</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥è¿™ä¸ª Buffer æ˜¯å¦æ˜¯ UTF-8 ç¼–ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">isUtf8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">invalidUtf8Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: false</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«éšæœºå­—èŠ‚çš„ Buffer å¯¹è±¡ã€‚è¿™ä¸ªéšæœºå­—èŠ‚åºåˆ—å¹¶ä¸æ˜¯æœ‰æ•ˆçš„ UTF-8 ç¼–ç ï¼Œæ‰€ä»¥ <code>isUtf8()</code> å‡½æ•°è¿”å›äº† <code>false</code>ã€‚</p><h3 id="å®é™…è¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨åœºæ™¯"><span>å®é™…è¿ç”¨åœºæ™¯ï¼š</span></a></h3><p>å½“ä½ ä»æŸä¸ªæ¥æºï¼ˆæ¯”å¦‚æ–‡ä»¶ã€ç½‘ç»œè¯·æ±‚ç­‰ï¼‰æ¥æ”¶åˆ°æ•°æ®ï¼Œå¹¶ä¸”éœ€è¦ç¡®ä¿è¿™äº›æ•°æ®æ˜¯ä»¥ UTF-8 æ ¼å¼ç¼–ç çš„ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨ <code>isUtf8()</code> å‡½æ•°æ¥è¿›è¡Œæ£€æŸ¥ï¼š</p><ul><li>åœ¨è§£ææ–‡æœ¬æ–‡ä»¶æ—¶ï¼Œç¡®ä¿æ–‡ä»¶æ˜¯ UTF-8 ç¼–ç ã€‚</li><li>åœ¨å¤„ç†æ¥è‡ªå®¢æˆ·ç«¯çš„ HTTP è¯·æ±‚æ—¶ï¼ŒéªŒè¯è¯·æ±‚ä½“æ˜¯å¦ä¸º UTF-8 ç¼–ç ï¼Œä»¥ä¾¿æ­£ç¡®è§£ææ–‡æœ¬å†…å®¹ã€‚</li></ul><p>æ€»ç»“èµ·æ¥ï¼Œ<code>buffer.isUtf8(input)</code> æ˜¯ä¸€ä¸ªè¾…åŠ©å·¥å…·ï¼Œç”¨äºéªŒè¯æ•°æ®æ˜¯å¦ç¬¦åˆ UTF-8 ç¼–ç æ ‡å‡†ã€‚å¯¹äºå›½é™…åŒ–åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œç¡®ä¿ç¼–ç çš„æ­£ç¡®æ€§æ˜¯éå¸¸é‡è¦çš„ï¼Œè¿™ä¸ªå‡½æ•°å°±åœ¨è¿™æ–¹é¢æä¾›å¸®åŠ©ã€‚</p><h3 id="buffer-inspect-max-bytes" tabindex="-1"><a class="header-anchor" href="#buffer-inspect-max-bytes"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufferinspect_max_bytes" target="_blank" rel="noopener noreferrer">buffer.INSPECT_MAX_BYTES</a></span></a></h3><p><code>buffer.INSPECT_MAX_BYTES</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå…¨å±€é…ç½®ï¼Œå®ƒå†³å®šäº†å½“ä½ åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­æ‰“å°ä¸€ä¸ª <code>Buffer</code> å¯¹è±¡æ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šå±•ç¤ºå¤šå°‘å­—èŠ‚ã€‚<code>Buffer</code> æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ç±»ã€‚</p><p>é€šå¸¸åœ¨ Node.js ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†åƒæ–‡ä»¶å†…å®¹ã€ç½‘ç»œè¯·æ±‚ç­‰äº§ç”Ÿçš„äºŒè¿›åˆ¶æ•°æ®ï¼Œè¿™äº›æ•°æ®è¢«å­˜å‚¨åœ¨ <code>Buffer</code> å¯¹è±¡ä¸­ã€‚è°ƒè¯•æ—¶ï¼Œä¸ºäº†æŸ¥çœ‹ä¸€ä¸ª <code>Buffer</code> åŒ…å«çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæ‰“å°å®ƒçš„å€¼ã€‚ä½†æ˜¯ <code>Buffer</code> ä¸­å¯èƒ½åŒ…å«å¤§é‡çš„æ•°æ®ï¼Œå¦‚æœå…¨éƒ¨æ‰“å°å‡ºæ¥ï¼Œä¸ä»…ä¼šè®©æ§åˆ¶å°å˜å¾—éå¸¸æ‚ä¹±ï¼Œè¿˜ä¼šå¢åŠ è°ƒè¯•éš¾åº¦ã€‚å› æ­¤ï¼Œ<code>buffer.INSPECT_MAX_BYTES</code> è®¾ç½®äº†ä¸€ä¸ªä¸Šé™ï¼Œä»¥é˜²æ­¢æ‰“å°è¿‡å¤šçš„æ•°æ®ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>buffer.INSPECT_MAX_BYTES</code> çš„å€¼ä¸º 50ã€‚è¿™æ„å‘³ç€å½“ä½ ä½¿ç”¨ <code>console.log</code> æ‰“å° <code>Buffer</code> å¯¹è±¡æ—¶ï¼Œåªæœ‰å‰ 50 ä¸ªå­—èŠ‚ä¼šè¢«æ˜¾ç¤ºã€‚å¦‚æœ <code>Buffer</code> å¤§å°è¶…è¿‡ 50 å­—èŠ‚ï¼Œå‰©ä½™çš„éƒ¨åˆ†å°±ä¸ä¼šæ˜¾ç¤ºå‡ºæ¥ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€æ®µç®€å•çš„ä»£ç ç¤ºä¾‹æ¥è¯´æ˜è¿™ä¸ªæ¦‚å¿µï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¿™é‡Œæ˜¯ä¸€ä¸²å¾ˆé•¿å¾ˆé•¿çš„æ–‡æœ¬ä¿¡æ¯ï¼Œä»…ä½œä¸ºæ¼”ç¤ºç”¨é€”&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œå‡è®¾ buffer.INSPECT_MAX_BYTES æ˜¯é»˜è®¤çš„ 50</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°ç»“æœå¯èƒ½ä¼šæ˜¯ï¼š`&lt;`Buffer e8 bf 99 é‡Œ ... &gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«é•¿æ–‡æœ¬ä¿¡æ¯çš„ <code>Buffer</code> å¯¹è±¡ã€‚å°è¯•æ‰“å°è¿™ä¸ªå¯¹è±¡æ—¶ï¼Œç”±äº <code>buffer.INSPECT_MAX_BYTES</code> çš„é™åˆ¶ï¼Œåªä¼šæ˜¾ç¤ºå¼€å§‹çš„ 50 ä¸ªå­—èŠ‚ã€‚</p><p>å¦‚æœä½ æƒ³æ”¹å˜è¿™ä¸ªè¡Œä¸ºï¼Œå¯ä»¥ä¿®æ”¹ <code>buffer.INSPECT_MAX_BYTES</code> çš„å€¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³æ‰“å°æ›´å¤šæˆ–è€…æ›´å°‘çš„å­—èŠ‚ï¼Œå¯ä»¥è¿™ä¹ˆåšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½® buffer.INSPECT_MAX_BYTES çš„å€¼ä¸º 100</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">INSPECT_MAX_BYTES</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¿™é‡Œæ˜¯ä¸€ä¸²å¾ˆé•¿å¾ˆé•¿çš„æ–‡æœ¬ä¿¡æ¯ï¼Œä»…ä½œä¸ºæ¼”ç¤ºç”¨é€”&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨ä¼šæ‰“å°å‡ºæ›´å¤šçš„å­—èŠ‚ï¼Œå› ä¸ºæˆ‘ä»¬æå‡äº† INSPECT_MAX_BYTES çš„å€¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè°ƒæ•´ <code>buffer.INSPECT_MAX_BYTES</code> å¯ä»¥å¸®åŠ©ä½ æ›´å¥½åœ°æ§åˆ¶åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­éœ€è¦å…³æ³¨çš„ <code>Buffer</code> æ•°æ®é‡ã€‚è®°ä½ï¼Œå½“ä½ å®Œæˆäº†è°ƒè¯•å·¥ä½œåï¼Œæœ€å¥½å°†è¿™ä¸ªå€¼é‡ç½®ä¸ºé»˜è®¤å€¼ï¼Œé¿å…å¯¹å…¶ä»–éƒ¨åˆ†çš„è°ƒè¯•é€ æˆå½±å“ã€‚</p><h3 id="buffer-kmaxlength" tabindex="-1"><a class="header-anchor" href="#buffer-kmaxlength"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufferkmaxlength" target="_blank" rel="noopener noreferrer">buffer.kMaxLength</a></span></a></h3><p><code>buffer.kMaxLength</code> æ˜¯ Node.js ä¸­ä¸€ä¸ªè¡¨ç¤º Buffer å¯¹è±¡èƒ½å¤Ÿåˆ†é…çš„æœ€å¤§å†…å­˜å¤§å°çš„å±æ€§ã€‚åœ¨ JavaScript ä¸­ï¼ŒBuffer ç±»å‹æ˜¯ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ï¼Œè€Œ <code>buffer.kMaxLength</code> é™åˆ¶äº†å•ä¸ª Buffer å®ä¾‹èƒ½å¤Ÿä½¿ç”¨çš„æœ€å¤§å†…å­˜é‡ã€‚</p><p>ç”±äº Node.js æ˜¯æ„å»ºäº V8 JavaScript å¼•æ“ä¹‹ä¸Šçš„ï¼ˆè¿™ä¹Ÿæ˜¯ Google Chrome æµè§ˆå™¨ä½¿ç”¨çš„å¼•æ“ï¼‰ï¼Œ<code>buffer.kMaxLength</code> çš„å€¼å®é™…ä¸Šå—åˆ° V8 å¼•æ“å¯¹ ArrayBuffers æœ€å¤§å…è®¸å¤§å°çš„é™åˆ¶ã€‚è¿™ä¸ªå€¼å¯ä»¥æ ¹æ®ä½ çš„æ“ä½œç³»ç»Ÿå’Œ Node.js ç‰ˆæœ¬æœ‰æ‰€ä¸åŒã€‚</p><p>ä¸ºä»€ä¹ˆè¦æœ‰è¿™æ ·çš„é™åˆ¶å‘¢ï¼Ÿå› ä¸ºåœ¨ Node.js è¿è¡Œæ—¶ç¯å¢ƒä¸­ï¼Œå­˜åœ¨ç€èµ„æºç®¡ç†å’Œç¨³å®šæ€§çš„è€ƒè™‘ã€‚å¦‚æœä½ å°è¯•åˆ†é…è¶…è¿‡æœ€å¤§é™åˆ¶çš„ç¼“å†²åŒºï¼ŒNode.js å¯èƒ½æ— æ³•æˆåŠŸåˆ†é…å†…å­˜ï¼Œæˆ–è€…å¯èƒ½å¯¼è‡´æ€§èƒ½é—®é¢˜åŠç¨³å®šæ€§é£é™©ã€‚</p><h3 id="ä¸¾ä¾‹è¯´æ˜-1" tabindex="-1"><a class="header-anchor" href="#ä¸¾ä¾‹è¯´æ˜-1"><span>ä¸¾ä¾‹è¯´æ˜</span></a></h3><ol><li><strong>æ–‡ä»¶è¯»å–</strong>ï¼šå½“ä½ ä½¿ç”¨ fs æ¨¡å—ä»æ–‡ä»¶ç³»ç»Ÿä¸­è¯»å–ä¸€ä¸ªéå¸¸å¤§çš„æ–‡ä»¶æ—¶ï¼Œä½ å¯èƒ½ä¼šæƒ³è¦æ£€æŸ¥ <code>buffer.kMaxLength</code>ï¼Œä»¥ç¡®ä¿ä½ ä¸ä¼šè¯•å›¾ä¸€æ¬¡æ€§è¯»å–ä¸€ä¸ªè¶…å‡ºè¿™ä¸ªæœ€å¤§é•¿åº¦çš„æ–‡ä»¶ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;fs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;buffer&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æƒ³è¦ä¸€æ¬¡æ€§è¯»å–ä¸€ä¸ªå¤§æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> FILE_PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;/path/to/large/file&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–æ–‡ä»¶çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">stat</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">FILE_PATH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">stats</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stats</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">kMaxLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¦‚æœæ–‡ä»¶å¤§å°å°äºæœ€å¤§é•¿åº¦ï¼Œåˆ™å®‰å…¨è¯»å–</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">FILE_PATH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // åœ¨è¿™é‡Œå¤„ç†æ–‡ä»¶æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;æ–‡ä»¶å¤ªå¤§ï¼Œæ— æ³•ä¸€æ¬¡æ€§è¯»å–ï¼&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // éœ€è¦åˆ†æ­¥éª¤è¯»å–æ–‡ä»¶æˆ–é‡‡å–å…¶ä»–æªæ–½</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>æ•°æ®ä¼ è¾“</strong>ï¼šå¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦å¤„ç†å¤§é‡æ•°æ®çš„ç½‘ç»œåº”ç”¨ï¼Œæ¯”å¦‚ä¸Šä¼ å¤§æ–‡ä»¶ï¼Œä½ å¯èƒ½è¦åœ¨ä»£ç ä¸­æ£€æŸ¥ <code>buffer.kMaxLength</code> æ¥å†³å®šä½ æ˜¯å¦éœ€è¦åˆ†ç‰‡å¤„ç†æ•°æ®æµã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">http</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> totalDataLength</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      totalDataLength</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">totalDataLength</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">kMaxLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        // æ•°æ®å¤ªå¤§ï¼Œæ–­å¼€è¿æ¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeHead</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">413</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Request Entity Too Large&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // å¤„ç†æ¥æ”¶åˆ°çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8080</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä»¥ä¸Šä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ£€æŸ¥ä¸Šä¼ çš„æ•°æ®æ€»é‡æ˜¯å¦è¶…å‡ºäº† Buffer çš„æœ€å¤§é•¿åº¦é™åˆ¶ï¼Œå¦‚æœè¶…å‡ºåˆ™è¿”å› HTTP çŠ¶æ€ç  413 è¡¨ç¤ºè¯·æ±‚å®ä½“è¿‡å¤§ã€‚</p><p>æ³¨æ„ï¼Œä½ ä¸éœ€è¦ç»å¸¸æ£€æŸ¥ <code>buffer.kMaxLength</code>ï¼Œåªæœ‰åœ¨ä½ é¢„è®¡å°†è¦å¤„ç†å¤§é‡æ•°æ®ï¼Œå¹¶æ€€ç–‘å¯èƒ½æ¥è¿‘æˆ–è¶…å‡ºè¿™ä¸ªé™åˆ¶æ—¶æ‰éœ€è¦æ£€æŸ¥å®ƒã€‚å¤§å¤šæ•°æ­£å¸¸çš„æ“ä½œéƒ½ä¸ä¼šæ¥è¿‘è¿™ä¸ªé•¿åº¦é™åˆ¶ã€‚</p><h3 id="buffer-kstringmaxlength" tabindex="-1"><a class="header-anchor" href="#buffer-kstringmaxlength"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufferkstringmaxlength" target="_blank" rel="noopener noreferrer">buffer.kStringMaxLength</a></span></a></h3><p><code>buffer.kStringMaxLength</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒä»£è¡¨åœ¨ JavaScript å±‚é¢ä¸Šï¼Œä½ å¯ä»¥åˆ›å»ºçš„å­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦ã€‚è¿™ä¸ªé™åˆ¶æ˜¯ç”±äº V8 å¼•æ“ï¼ˆNode.js ä¸‹ä½¿ç”¨çš„ JavaScript å¼•æ“ï¼‰çš„å†…éƒ¨å®ç°æ‰€å†³å®šçš„ã€‚</p><p>ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸ªé™åˆ¶å‘¢ï¼Ÿåœ¨ V8 å¼•æ“ä¸­ï¼ŒJavaScript å­—ç¬¦ä¸²æ˜¯ä½œä¸º UTF-16 ä»£ç å•å…ƒåºåˆ—å­˜å‚¨çš„ï¼Œä½¿ç”¨ä¸€ç§ç§°ä¸º ConsString çš„ä¼˜åŒ–å½¢å¼æ¥è¡¨ç¤ºé•¿å­—ç¬¦ä¸²ã€‚ä½†æ˜¯ï¼Œå³ä½¿æœ‰äº†è¿™ç§ä¼˜åŒ–ï¼ŒV8 ä¹Ÿéœ€è¦å¯¹å­—ç¬¦ä¸²é•¿åº¦è®¾ç½®ä¸€ä¸ªä¸Šé™ï¼Œä»¥ç¡®ä¿å®ƒèƒ½æœ‰æ•ˆåœ°ç®¡ç†å†…å­˜å¹¶é¿å…å¯èƒ½å‡ºç°çš„æ€§èƒ½é—®é¢˜ã€‚</p><p>å…·ä½“åˆ° <code>buffer.kStringMaxLength</code> è¿™ä¸ªå±æ€§ï¼Œåœ¨ç¼–å†™ Node.js ç¨‹åºæ—¶ï¼Œä½ å¾ˆå°‘ä¼šç›´æ¥ä¸è¿™ä¸ªå±æ€§æ‰“äº¤é“ï¼Œé™¤éä½ æ­£åœ¨å¤„ç†éå¸¸å¤§çš„æ•°æ®å—ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ è¯•å›¾å°†ä¸€ä¸ªéå¸¸å¤§çš„æ–‡ä»¶å®Œæ•´åœ°ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²è¯»å…¥å†…å­˜ï¼Œå°±å¯èƒ½ä¼šè¶…è¿‡è¿™ä¸ªé™åˆ¶ï¼Œä»è€Œå¯¼è‡´é”™è¯¯ã€‚</p><p>è®©æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªä¾‹å­ï¼š</p><ol><li><p><strong>è¯»å–å¤§æ–‡ä»¶</strong></p><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªéå¸¸å¤§çš„æ–‡æœ¬æ–‡ä»¶ï¼Œä½ æƒ³è¦ç”¨ Node.js è¯»å–å®ƒã€‚å¦‚æœè¿™ä¸ªæ–‡ä»¶çš„å¤§å°è¶…å‡ºäº† <code>buffer.kStringMaxLength</code>ï¼Œä½ ä¸èƒ½ç®€å•åœ°ä¸€æ¬¡æ€§è¯»å–æ•´ä¸ªæ–‡ä»¶åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ï¼Œå¦åˆ™ç¨‹åºä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ç›¸åï¼Œä½ éœ€è¦åˆ†å—è¯»å–æ–‡ä»¶å†…å®¹ï¼Œæˆ–è€…é‡‡ç”¨æµçš„æ–¹å¼è¿›è¡Œå¤„ç†ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¯è¯»æµ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> readStream</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createReadStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;large-file.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  encoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç›‘å¬ &#39;data&#39; äº‹ä»¶æ¥å¤„ç†æ–‡ä»¶ç‰‡æ®µ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">readStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¤„ç†æ¯ä¸ªæ•°æ®å—ï¼ˆchunkï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>å¤„ç†å¤§é‡æ•°æ®</strong></p><p>å¦‚æœä½ åœ¨ç¼–å†™æœåŠ¡å™¨åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”éœ€è¦å¤„ç†å®¢æˆ·ç«¯ä¸Šä¼ çš„å¤§å‹æ•°æ®ï¼Œä½ ä¹Ÿéœ€è¦ç•™æ„è¿™ä¸ªé™åˆ¶ã€‚è‹¥æ•°æ®è¶…è¿‡ <code>buffer.kStringMaxLength</code>ï¼Œä½ éœ€è¦è®¾è®¡ä½ çš„åº”ç”¨é€»è¾‘æ¥åˆ†æ‰¹å¤„ç†è¿™äº›æ•°æ®ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§å°†å…¶è½¬æ¢ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;http&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">http</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ç›‘å¬ &#39;data&#39; äº‹ä»¶ä»¥æ¥æ”¶æ•°æ®å—</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;data&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">kStringMaxLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // è¶…å‡ºå­—ç¬¦ä¸²æœ€å¤§é•¿åº¦é™åˆ¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeHead</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">413</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;Content-Type&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;text/plain&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;Request entity too large&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;end&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ‰€æœ‰æ•°æ®æ¥æ”¶å®Œæ¯•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;Data received&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8080</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>å†…éƒ¨ä¼˜åŒ–</strong></p><p>å¯èƒ½ä½ æ­£åœ¨å°è¯•æ„å»ºè‡ªå·±çš„åº“æˆ–è€…æ¡†æ¶ï¼Œå¦‚æœå…¶ä¸­æ¶‰åŠåˆ°å­—ç¬¦ä¸²æ“ä½œï¼Œä½ å¯èƒ½éœ€è¦è€ƒè™‘ <code>buffer.kStringMaxLength</code> æ¥ç¡®ä¿ä½ çš„åº“åœ¨å¤„ç†å¤§å‹æ•°æ®æ—¶ä¸ä¼šå‡ºé”™ã€‚</p></li></ol><p>åœ¨æ›´æ—¥å¸¸çš„å¼€å‘å·¥ä½œä¸­ï¼Œå¦‚ç½‘ç«™åç«¯å¼€å‘ã€API å¼€å‘ç­‰ï¼Œé€šå¸¸ä¸ä¼šç¢°åˆ° <code>buffer.kStringMaxLength</code> çš„é™åˆ¶ï¼Œå› ä¸ºè¯·æ±‚å’Œå“åº”ä½“çš„å†…å®¹å¤§å°é€šå¸¸è¿œè¿œä½äºè¿™ä¸ªé˜ˆå€¼ã€‚ç„¶è€Œï¼Œäº†è§£è¿™ä¸ªé™åˆ¶çš„å­˜åœ¨å¯¹äºç‰¹å®šåœºæ™¯ä¸‹çš„é”™è¯¯æ’æŸ¥å’Œæ€§èƒ½ä¼˜åŒ–æ˜¯æœ‰å¸®åŠ©çš„ã€‚</p><h3 id="buffer-resolveobjecturl-id" tabindex="-1"><a class="header-anchor" href="#buffer-resolveobjecturl-id"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufferresolveobjecturlid" target="_blank" rel="noopener noreferrer">buffer.resolveObjectURL(id)</a></span></a></h3><p>æˆªè‡³æˆ‘çŸ¥è¯†æ›´æ–°çš„æ—¶é—´ï¼ˆ2023 å¹´ï¼‰ï¼Œåœ¨ Node.js çš„å®˜æ–¹æ–‡æ¡£ä¸­å¹¶æ²¡æœ‰ <code>buffer.resolveObjectURL(id)</code> è¿™ä¸ªå‡½æ•°ã€‚è¿™çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªå‡å®šçš„ APIï¼Œå¹¶éå®é™…å­˜åœ¨äº Node.js ä¸­ã€‚</p><p>é€šå¸¸ï¼Œ<code>resolveObjectURL</code> è¿™æ ·çš„å‘½åå¯èƒ½ä¼šä¸ web æµè§ˆå™¨ä¸­å¤„ç†äºŒè¿›åˆ¶æ•°æ®æˆ–è€…ç®¡ç†èµ„æºçš„ URL ç›¸å…³è”ã€‚ä¾‹å¦‚ï¼Œåœ¨æµè§ˆå™¨ä¸­æœ‰ä¸€ä¸ªä¸äºŒè¿›åˆ¶æ•°æ®å¤„ç†ç›¸å…³çš„å…¨å±€å¯¹è±¡å« <code>URL</code>ï¼Œå®ƒæä¾›äº†å¦‚ <code>createObjectURL</code> å’Œ <code>revokeObjectURL</code> ç­‰æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºå’Œæ’¤é”€å¯¹åŒ…å«æ–‡ä»¶å†…å®¹çš„äºŒè¿›åˆ¶æ•°æ®çš„å¼•ç”¨ã€‚</p><p>åœ¨ Node.js ä¸­å¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ Buffer ç±»ã€‚Buffer æ˜¯ Node.js çš„ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨äºç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµã€‚ä»¥ä¸‹æ˜¯ä¸€äº›çœŸå®çš„ Buffer ç±»çš„ç”¨æ³•ä¾‹å­ï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ª Buffer å¯¹è±¡ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™é‡Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«å­—ç¬¦ä¸² &quot;Hello World&quot; çš„ Buffer å®ä¾‹ï¼Œä½¿ç”¨ utf8 ç¼–ç ã€‚</p><ol start="2"><li>ä» Buffer å¯¹è±¡è¯»å–æ•°æ®ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: Hello World</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•å°† Buffer å¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚</p><ol start="3"><li>å†™å…¥ Buffer å¯¹è±¡ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hi&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: Hi World</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å°†åŸæœ‰çš„ &quot;Hello&quot; æ›¿æ¢æˆäº† &quot;Hi&quot;ã€‚</p><p>ç”±äº <code>buffer.resolveObjectURL(id)</code> ä¸æ˜¯ä¸€ä¸ªç°æœ‰çš„ Node.js å‡½æ•°ï¼Œæˆ‘æ— æ³•ä¸ºæ‚¨æä¾›å…·ä½“çš„ä¾‹å­ã€‚å¦‚æœæ‚¨æ˜¯åœ¨å¯»æ‰¾ç±»ä¼¼åŠŸèƒ½çš„è¯ï¼Œè¯·æ ¸å®å‡†ç¡®çš„ API åç§°æˆ–ç›®æ ‡åŠŸèƒ½ã€‚å¦‚æœæ‚¨æ˜¯æƒ³æ“ä½œæ–‡ä»¶ç³»ç»Ÿä¸­çš„è·¯å¾„æˆ–è€… URLsï¼ŒNode.js ä¸­æœ‰ <code>path</code> å’Œ <code>url</code> æ¨¡å—ï¼Œå…¶ä¸­æä¾›äº†å¾ˆå¤šå¤„ç†è·¯å¾„å’Œ URL çš„å®ç”¨å‡½æ•°ã€‚å¦‚éœ€è¿›ä¸€æ­¥å¸®åŠ©ï¼Œè¯·æä¾›æ›´å¤šå…·ä½“ä¿¡æ¯ã€‚</p><h3 id="buffer-transcode-source-fromenc-toenc" tabindex="-1"><a class="header-anchor" href="#buffer-transcode-source-fromenc-toenc"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#buffertranscodesource-fromenc-toenc" target="_blank" rel="noopener noreferrer">buffer.transcode(source, fromEnc, toEnc)</a></span></a></h3><p>Buffer åœ¨ Node.js ä¸­æ˜¯ä¸€ä¸ªç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ç±»ã€‚ç®€å•åœ°è¯´ï¼Œå®ƒå°±åƒä¸€ä¸ªå¯ä»¥å­˜æ”¾å¤šä¸ªå­—èŠ‚çš„æ•°ç»„ï¼ˆå°½ç®¡æŠ€æœ¯ä¸Šä¸æ˜¯æ•°ç»„çš„ä¸€ç§ï¼‰ã€‚åœ¨ç½‘ç»œé€šä¿¡æˆ–æ–‡ä»¶æ“ä½œä¸­ç»å¸¸éœ€è¦å¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼ŒNode.js çš„ Buffer ç±»å°±æ˜¯ä¸ºäº†ç®€åŒ–è¿™äº›æ“ä½œè€Œè®¾è®¡çš„ã€‚</p><p><code>buffer.transcode(source, fromEnc, toEnc)</code> æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œç”¨äºè½¬æ¢ Buffer å¯¹è±¡çš„ç¼–ç ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥å°†ä¸€ä¸ª Buffer ä»ä¸€ç§å­—ç¬¦ç¼–ç è½¬æ¢ä¸ºå¦ä¸€ç§å­—ç¬¦ç¼–ç ã€‚å­—ç¬¦ç¼–ç æ˜¯è®¡ç®—æœºç”¨äºæ˜ å°„å­—ç¬¦ï¼ˆæ¯”å¦‚å­—æ¯å’Œæ•°å­—ï¼‰åˆ°æ•°å­—è¡¨ç¤ºçš„æ–¹å¼ï¼Œä¸åŒçš„ç³»ç»Ÿæˆ–ç¨‹åºå¯èƒ½éœ€è¦ä½¿ç”¨ä¸åŒçš„ç¼–ç æ–¹å¼ã€‚</p><ul><li><code>source</code>ï¼šæº Buffer å®ä¾‹ï¼Œå³åŒ…å«è¦è½¬æ¢çš„æ•°æ®çš„ Bufferã€‚</li><li><code>fromEnc</code>ï¼šæŒ‡å®š <code>source</code> ä¸­æ•°æ®çš„å½“å‰ç¼–ç æ ¼å¼ã€‚</li><li><code>toEnc</code>ï¼šæŒ‡å®šè¦å°†æ•°æ®è½¬æ¢åˆ°çš„ç›®æ ‡ç¼–ç æ ¼å¼ã€‚</li></ul><p>è¿™ä¸ªæ–¹æ³•åœ¨å¤„ç†æ–‡æœ¬æ•°æ®æ—¶ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºæ–‡æœ¬æ•°æ®å¯ä»¥æœ‰å¤šç§ç¼–ç ï¼Œæ¯”å¦‚ UTF-8ã€ASCII æˆ–è€… ISO-8859-1 ç­‰ç­‰ã€‚å½“ä½ éœ€è¦åœ¨ä¸åŒç¼–ç ä¹‹é—´è½¬æ¢æ–‡æœ¬æ—¶ï¼Œ<code>transcode</code> æ–¹æ³•ä¼šéå¸¸æœ‰å¸®åŠ©ã€‚</p><p>è®©æˆ‘ä»¬ä¸¾å‡ ä¸ªå®ä¾‹æ¥è¯´æ˜ <code>buffer.transcode</code> æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä½¿ç”¨ Latin-1ï¼ˆISO-8859-1ï¼‰ç¼–ç çš„å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> latin1Buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;latin1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨æˆ‘ä»¬æƒ³æŠŠè¿™ä¸ªå­—ç¬¦ä¸²è½¬æ¢æˆ UTF-8 ç¼–ç çš„æ ¼å¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> utf8Buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">transcode</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">latin1Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;latin1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºè½¬æ¢åçš„ Buffer å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">utf8Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: Hello World</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªç”¨ Latin-1 ç¼–ç çš„ Buffer å®ä¾‹ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>Buffer.transcode</code> å°†å…¶ä» Latin-1 è½¬æ¢ä¸º UTF-8 ç¼–ç ã€‚æœ€åï¼Œæˆ‘ä»¬æ‰“å°å‡ºè½¬æ¢åçš„ UTF-8 ç¼–ç çš„å­—ç¬¦ä¸²ã€‚</p><p>å‡è®¾ä½ è¦å¤„ç†ä¸åŒçš„æ•°æ®æºï¼Œè¿™äº›æ•°æ®æºä½¿ç”¨ä¸åŒçš„ç¼–ç ï¼Œä½ å°±å¯èƒ½éœ€è¦åœ¨å®ƒä»¬ä¹‹é—´è¿›è¡Œè½¬æ¢ï¼Œä»¥ç¡®ä¿ä½ çš„åº”ç”¨ç¨‹åºå¯ä»¥æ­£ç¡®ç†è§£å’Œå¤„ç†è¿™äº›æ•°æ®ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„ Node.js åº”ç”¨éœ€è¦ä»ä¸€ä¸ªè€æ—§ç³»ç»Ÿæ¥æ”¶æ•°æ®ï¼Œè¯¥ç³»ç»Ÿä½¿ç”¨äº†ä¸åŒäºä½ çš„ç³»ç»Ÿçš„ç¼–ç ï¼Œé‚£ä¹ˆ <code>buffer.transcode</code> æ–¹æ³•å¯ä»¥å¸®åŠ©ä½ å°†æ•°æ®è½¬æ¢æˆä½ çš„ç³»ç»Ÿèƒ½å¤Ÿå¤„ç†çš„ç¼–ç æ ¼å¼ã€‚</p><p>é‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ç¼–ç è½¬æ¢éƒ½æ˜¯å¯è¡Œçš„ï¼Œå› ä¸ºæŸäº›å­—ç¬¦åœ¨ä¸åŒç¼–ç é›†ä¹‹é—´å¯èƒ½ä¸å­˜åœ¨å¯¹åº”å…³ç³»ã€‚æ‰€ä»¥åœ¨ä½¿ç”¨ <code>buffer.transcode</code> æ–¹æ³•æ—¶ï¼Œä½ åº”è¯¥ç¡®ä¿ä½ æ­£åœ¨è¿›è¡Œçš„ç¼–ç è½¬æ¢æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå¹¶ä¸”æºç¼–ç ä¸­çš„æ‰€æœ‰å­—ç¬¦éƒ½èƒ½åœ¨ç›®æ ‡ç¼–ç ä¸­æ‰¾åˆ°å¯¹åº”çš„å­—ç¬¦ã€‚</p><h3 id="class-slowbuffer" tabindex="-1"><a class="header-anchor" href="#class-slowbuffer"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#class-slowbuffer" target="_blank" rel="noopener noreferrer">Class: SlowBuffer</a></span></a></h3><p><code>SlowBuffer</code> ç±»åœ¨ Node.js ä¸­æ˜¯ä¸€ä¸ªå·²ç»åºŸå¼ƒçš„ç±»ï¼Œå®ƒæ›¾ç»ç”¨äºåˆ†é…å’Œç®¡ç†å†…å­˜ä¸­çš„â€œåŸå§‹â€æ•°æ®ã€‚è‡ª Node.js v6 ä¹‹åï¼Œå®ƒå°±ä¸å†æ¨èä½¿ç”¨äº†ï¼Œå¹¶ä¸”ç°åœ¨å·²ç»å®Œå…¨è¢« <code>Buffer</code> ç±»æ›¿ä»£ã€‚</p><p>Node.js ä¸­çš„ <code>Buffer</code> ç±»æ˜¯ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ã€‚åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œå½“ä½ ä¸æ–‡ä»¶ç³»ç»Ÿæ‰“äº¤é“ã€æ“ä½œç½‘ç»œèµ„æºã€æˆ–è€…å¤„ç†ä»»ä½•å½¢å¼çš„äºŒè¿›åˆ¶æ•°æ®æµæ—¶ï¼Œéƒ½å¯èƒ½ä¼šä½¿ç”¨åˆ° <code>Buffer</code>ã€‚<code>Buffer</code> å¯ä»¥æ›´é«˜æ•ˆåœ°å¤„ç†è¿™äº›æ•°æ®ï¼Œå› ä¸ºå®ƒç›´æ¥æ“ä½œå†…å­˜ï¼Œè€Œä¸åƒå…¶ä»– JavaScript å¯¹è±¡éœ€è¦è¿›è¡Œé¢å¤–çš„å¤„ç†ã€‚</p><p>é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆ <code>SlowBuffer</code> è¢«ç§°ä¸ºâ€œæ…¢â€ï¼Ÿä¸»è¦æ˜¯å› ä¸ºåœ¨æ—©æœŸç‰ˆæœ¬çš„ Node.js ä¸­ï¼Œ<code>Buffer</code> çš„å®ä¾‹åŒ–è¿‡ç¨‹ä¸­åŒ…å«äº†ä¸€ä¸ªå®‰å…¨æœºåˆ¶ï¼Œå³é›¶å¡«å……ï¼ˆzero-fillingï¼‰ï¼Œä»¥é˜²æ­¢æ–°åˆ›å»ºçš„ <code>Buffer</code> å®ä¾‹æš´éœ²æ—§çš„ã€æ½œåœ¨æ•æ„Ÿçš„å†…å­˜æ•°æ®ã€‚<code>SlowBuffer</code> åˆ™æ²¡æœ‰è¿™ä¸ªé›¶å¡«å……è¿‡ç¨‹ï¼Œå› æ­¤åœ¨åˆ›å»ºä¸Šé€Ÿåº¦è¾ƒå¿«ï¼Œä½†åŒæ—¶ä¹Ÿä¸å¤Ÿå®‰å…¨ã€‚</p><p>éšç€ Node.js çš„å‘å±•ï¼Œå¼€å‘è€…ä»¬æ³¨æ„åˆ°äº†è¿™ç§å·®å¼‚ï¼Œå¹¶æœ€ç»ˆå†³å®šå°† <code>Buffer</code> çš„é»˜è®¤è¡Œä¸ºä¿®æ”¹ä¸ºä¸è¿›è¡Œé›¶å¡«å……ï¼Œä½†æä¾›äº†é€‰é¡¹æ¥æ‰‹åŠ¨å¯ç”¨è¿™ä¸ªç‰¹æ€§ã€‚è¿™æ ·ï¼Œ<code>Buffer.alloc()</code> æ–¹æ³•é»˜è®¤ä¼šé›¶å¡«å……ï¼Œè€Œ <code>Buffer.allocUnsafe()</code> åˆ™ä¸ä¼šã€‚éšç€è¿™ä¸ªå˜åŒ–ï¼Œ<code>SlowBuffer</code> å°±å˜å¾—å¤šä½™äº†ï¼Œå› æ­¤è¢«é€æ¸æ·˜æ±°ã€‚</p><p>è¦åˆ›å»º Buffer çš„å®ä¾‹ï¼Œä½ å¯ä½¿ç”¨å¦‚ä¸‹æ–¹å¼ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º10å­—èŠ‚çš„Bufferï¼Œå¹¶ä½¿ç”¨é›¶å¡«å……</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º10å­—èŠ‚çš„Bufferï¼Œä½†ä¸å¡«å……ã€‚è¿™å¯èƒ½åŒ…å«æ—§æ•°æ®ï¼Œå› æ­¤ä½¿ç”¨æ—¶éœ€è°¨æ…</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buf2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">allocUnsafe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®é™…ä½¿ç”¨ä¾‹å­ï¼š</p><ol><li><p>è¯»å–æ–‡ä»¶å†…å®¹åˆ° <code>Buffer</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼‚æ­¥è¯»å–æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// &#39;data&#39; æ˜¯ä¸€ä¸ªBufferå¯¹è±¡ï¼ŒåŒ…å«æ–‡ä»¶çš„äºŒè¿›åˆ¶å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ç½‘ç»œé€šä¿¡ä¸­å‘é€å’Œæ¥æ”¶äºŒè¿›åˆ¶æ•°æ®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">http</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">concat</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // æ­¤æ—¶ &#39;buffer&#39; åŒ…å«äº†è¯·æ±‚ä½“çš„å®Œæ•´äºŒè¿›åˆ¶æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8080</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å›¾åƒå¤„ç†æˆ–éŸ³é¢‘å¤„ç†ç­‰å¤šåª’ä½“åº”ç”¨ï¼Œè¿™é€šå¸¸éœ€è¦å¤„ç†å¤§é‡çš„äºŒè¿›åˆ¶æ•°æ®ã€‚</p></li></ol><p>è¯·è®°ä½ï¼Œåœ¨ç¼–å†™ Node.js åº”ç”¨ç¨‹åºæ—¶ï¼Œç›´æ¥ä½¿ç”¨ <code>Buffer.alloc()</code> æˆ– <code>Buffer.from()</code> æ–¹æ³•æ¥åˆ›å»ºå’Œæ“ä½œ <code>Buffer</code> å®ä¾‹æ˜¯æ¨èçš„åšæ³•ã€‚é¿å…ä½¿ç”¨ <code>Buffer</code> æ„é€ å‡½æ•°æˆ–ä»»ä½•å·²ç»è¢«åºŸå¼ƒçš„æ–¹æ³•ï¼Œæ¯”å¦‚ <code>SlowBuffer</code>ï¼Œä»¥ç¡®ä¿ä»£ç çš„å®‰å…¨æ€§å’Œæœ€ä½³æ€§èƒ½ã€‚</p><h4 id="new-slowbuffer-size" tabindex="-1"><a class="header-anchor" href="#new-slowbuffer-size"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#new-slowbuffersize" target="_blank" rel="noopener noreferrer">new SlowBuffer(size)</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome çš„ V8 JavaScript å¼•æ“çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå®ƒè®©æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼ŒBuffer ç±»æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨äºç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚</p><p>åœ¨æ—§ç‰ˆæœ¬çš„ Node.js ä¸­ï¼Œå­˜åœ¨ä¸€ç§å«åš <code>SlowBuffer</code> çš„ç±»ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä½ æåˆ°çš„ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>SlowBuffer</code> å·²ç»è¢«åºŸå¼ƒå¹¶ä¸”ä¸æ¨èä½¿ç”¨äº†ã€‚ç°ä»£çš„ Node.js ä½¿ç”¨ <code>Buffer</code> ç±»æ¥åˆ›å»ºå’Œæ“ä½œäºŒè¿›åˆ¶æ•°æ®ç¼“å†²åŒºã€‚</p><p>å…ˆå‰ï¼Œ<code>SlowBuffer</code> ä¸»è¦ç”¨æ³•æ˜¯å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> slowBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> SlowBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™é‡Œçš„ <code>size</code> æ˜¯æŒ‡å®šç¼“å†²åŒºå¤§å°çš„ä¸€ä¸ªæ•´æ•°å‚æ•°ï¼Œå•ä½æ˜¯å­—èŠ‚ã€‚</p><p>ç„¶è€Œï¼Œç°åœ¨æˆ‘ä»¬åº”è¯¥ä½¿ç”¨ <code>Buffer.alloc()</code>ã€<code>Buffer.allocUnsafe()</code> æˆ– <code>Buffer.from()</code> æ–¹æ³•æ¥åˆ›å»º <code>Buffer</code> å®ä¾‹ã€‚ä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º 10 å­—èŠ‚çš„ Bufferï¼Œå¹¶ä¸”ç”¨é›¶å¡«å……ï¼Œè¿™æ˜¯å®‰å…¨çš„æ–¹æ³•ã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º 10 å­—èŠ‚çš„ Bufferï¼Œä½†æ˜¯ä¸åˆå§‹åŒ–ï¼Œå¯èƒ½åŒ…å«æ•æ„Ÿæ•°æ®ï¼Œè¿™æ˜¯ä¸å®‰å…¨çš„ã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> unsafeBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">allocUnsafe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»ä¸€ä¸ªå­—ç¬¦ä¸²åˆ›å»º Buffer å®ä¾‹ã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> stringBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨ Buffer å¯ä»¥æ–¹ä¾¿åœ°å¤„ç†æ–‡ä»¶è¯»å†™ã€ç½‘ç»œé€šä¿¡ç­‰æ¶‰åŠäºŒè¿›åˆ¶æ•°æ®çš„åœºæ™¯ã€‚ä¸¾å‡ ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><ol><li><p>è¯»å–æ–‡ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼‚æ­¥è¯»å–æ–‡ä»¶å†…å®¹åˆ° Buffer ä¸­</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/path/to/file&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// &#39;data&#39; æ˜¯ä¸€ä¸ª Buffer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ç½‘ç»œé€šä¿¡ï¼š</p><p>åœ¨ä¸€ä¸ª TCP æœåŠ¡å™¨ä¸­ï¼Œå½“æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®æ—¶ï¼Œè¯¥æ•°æ®ä¼šä½œä¸º Buffer å®ä¾‹ä¼ é€’ç»™äº‹ä»¶ç›‘å¬å™¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> net</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;net&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> server</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> net</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">socket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  socket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// &#39;data&#39; æ˜¯ä¸€ä¸ª Buffer å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8080</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å›¾åƒå¤„ç†ï¼š</p><p>å¦‚æœä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªéœ€è¦å¤„ç†å›¾åƒæ•°æ®çš„ç¨‹åºï¼Œä½ å¯èƒ½ä¼šæ¥æ”¶åˆ°åŸå§‹çš„å›¾åƒäºŒè¿›åˆ¶æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ Buffer æ¥å¤„ç†è¿™äº›æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> imageBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">rawImageData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¥ä¸‹æ¥å¯ä»¥ä½¿ç”¨æŸäº›åº“æ¥è§£æå’Œä¿®æ”¹å›¾ç‰‡ï¼Œæœ€åä¿å­˜æˆ–å‘é€</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>ä»¥ä¸Šå°±æ˜¯å…³äº <code>SlowBuffer</code> å’Œç°ä»£ <code>Buffer</code> ç±»çš„è¯´æ˜ï¼Œä»¥åŠå¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨ <code>Buffer</code> å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ä¾‹å­ã€‚è®°å¾—å§‹ç»ˆä½¿ç”¨æœ€æ–°çš„ API æ–¹æ³•ï¼Œå› ä¸ºå®ƒä»¬æ›´å®‰å…¨ã€æ•ˆç‡æ›´é«˜ã€‚</p><h3 id="buffer-constants" tabindex="-1"><a class="header-anchor" href="#buffer-constants"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#buffer-constants" target="_blank" rel="noopener noreferrer">Buffer constants</a></span></a></h3><p>Node.js ä¸­çš„ Buffer ç±»æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨äºç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚åœ¨ç½‘ç»œæ“ä½œæˆ–æ–‡ä»¶ç³»ç»Ÿå·¥ä½œç­‰åœºæ™¯ä¸­ï¼Œä½ ç»å¸¸éœ€è¦å¤„ç†åƒå›¾ç‰‡ã€éŸ³é¢‘æˆ–å…¶ä»–äºŒè¿›åˆ¶æ–‡ä»¶è¿™æ ·çš„åŸå§‹æ•°æ®ã€‚Buffer ç±»å°±æ˜¯ä¸ºäº†æ–¹ä¾¿è¿™æ ·çš„æ“ä½œè€Œå­˜åœ¨çš„ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­çš„æ–‡æ¡£é‡Œï¼Œæåˆ°äº†â€œBuffer constantsâ€ï¼Œè¿™äº›å¸¸é‡é€šå¸¸æ˜¯ä¸€äº›é¢„å®šä¹‰çš„å€¼ï¼Œç”¨äºå¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°ä½¿ç”¨ Buffer ç±»ã€‚ä»¥ä¸‹æ˜¯ä¸€äº› Buffer å¸¸é‡çš„ä¾‹å­åŠå…¶åº”ç”¨ï¼š</p><ol><li><p><code>Buffer.constants.MAX_LENGTH</code>ï¼š<br> è¿™ä¸ªå¸¸é‡ä»£è¡¨äº† Node.js é‡Œé¢å•ä¸ª Buffer å®ä¾‹å¯ä»¥åˆ†é…çš„æœ€å¤§å†…å­˜å¤§å°ã€‚è¿™ä¸ªå€¼å–å†³äº Node.js çš„ç‰ˆæœ¬å’Œåº•å±‚æ“ä½œç³»ç»Ÿã€‚äº†è§£è¿™ä¸ªå€¼å¯¹äºç¼–å†™å†…å­˜æ•æ„Ÿçš„åº”ç”¨ç¨‹åºéå¸¸é‡è¦ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ å°è¯•ä¸ºè¶…è¿‡è¿™ä¸ªé™åˆ¶çš„æ•°æ®åˆ†é…ä¸€ä¸ª Bufferï¼ŒNode.js å°†ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">MAX_LENGTH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç¤ºä¾‹ï¼š2147483647 (è¿™ä¸ªå€¼å¯èƒ½å› å¹³å°è€Œå¼‚)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>Buffer.constants.MAX_STRING_LENGTH</code>ï¼š<br> è¿™ä¸ªå¸¸é‡è¡¨ç¤ºåœ¨ Node.js é‡Œï¼Œå¯ä»¥åˆ›å»ºçš„æœ€å¤§å­—ç¬¦ä¸²é•¿åº¦ã€‚å®ƒé€šå¸¸ç”¨äºæ“ä½œå¤§é‡çš„å­—ç¬¦ä¸²æ•°æ®æ—¶ï¼Œé˜²æ­¢è¶…è¿‡ V8 å¼•æ“çš„é™åˆ¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">MAX_STRING_LENGTH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç¤ºä¾‹ï¼š1073741799 (è¿™ä¸ªå€¼å¯èƒ½å› å¹³å°è€Œå¼‚)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>å®é™…è¿ç”¨ç¤ºä¾‹ï¼š</p><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç¨‹åºï¼Œéœ€è¦ä»æ–‡ä»¶ç³»ç»Ÿè¯»å–ä¸€ä¸ªéå¸¸å¤§çš„æ–‡ä»¶ã€‚åœ¨è¿›è¡Œè¿™æ ·çš„æ“ä½œä¹‹å‰ï¼Œä½ éœ€è¦æ£€æŸ¥è¿™ä¸ªæ–‡ä»¶æ˜¯å¦å¯èƒ½å¤§äº <code>Buffer.constants.MAX_LENGTH</code>ï¼Œä»¥ç¡®ä¿ä½ èƒ½å¤Ÿå®‰å…¨åœ°è¯»å–æ–‡ä»¶è€Œä¸ä¼šå¯¼è‡´ç¨‹åºå´©æºƒã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;fs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> path</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;path&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> filePath</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> path</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">join</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">__dirname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;very-large-file.dat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–æ–‡ä»¶ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> stats</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">statSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">filePath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥æ–‡ä»¶å¤§å°æ˜¯å¦è¶…è¿‡æœ€å¤§ Buffer å¤§å°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stats</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">MAX_LENGTH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å®‰å…¨åœ°è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">filePath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä¹‹åä½ å¯ä»¥ç”¨dataæ¥åšä½ éœ€è¦çš„ä»»ä½•äº‹æƒ…ï¼Œä¾‹å¦‚è§£ææ•°æ®ã€ä¿®æ”¹å®ƒæˆ–å°†å…¶å‘é€åˆ°ç½‘ç»œä¸Šçš„å¦ä¸€å°è®¡ç®—æœºã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;æ–‡ä»¶å¤ªå¤§ï¼Œä¸èƒ½å®‰å…¨åœ°ä½¿ç”¨ Buffer è¯»å–ã€‚&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™åªæ˜¯ä¸€ä¸ªéå¸¸åŸºç¡€çš„ä½¿ç”¨æ¡ˆä¾‹ï¼Œä½†å®ƒå±•ç¤ºäº†ä¸ºä»€ä¹ˆçŸ¥é“è¿™äº›å¸¸é‡å¾ˆé‡è¦ã€‚åœ¨å®è·µä¸­ï¼Œä½ å¯èƒ½è¿˜éœ€è¦é€šè¿‡æµï¼ˆStreamsï¼‰å’Œé€å—å¤„ç†ï¼ˆchunk processingï¼‰ç­‰æŠ€æœ¯æ¥å¤„ç†å¤§æ–‡ä»¶ï¼Œè¿™æ ·å¯ä»¥é¿å…ä¸€æ¬¡æ€§åŠ è½½æ•´ä¸ªæ–‡ä»¶åˆ°å†…å­˜ä¸­å»ã€‚</p><p>äº†è§£è¿™äº› Buffer çš„å¸¸é‡ï¼Œå¯ä»¥å¸®åŠ©ä½ åœ¨å¤„ç†äºŒè¿›åˆ¶æ•°æ®æ—¶ç¼–å†™å‡ºæ›´ç¨³å¥å’Œé«˜æ•ˆçš„ä»£ç ã€‚</p><h4 id="buffer-constants-max-length" tabindex="-1"><a class="header-anchor" href="#buffer-constants-max-length"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufferconstantsmax_length" target="_blank" rel="noopener noreferrer">buffer.constants.MAX_LENGTH</a></span></a></h4><p>å¥½çš„ï¼Œè®©æˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­çš„ <code>buffer.constants.MAX_LENGTH</code>ã€‚</p><p>åœ¨ Node.js ä¸­ï¼ŒBuffer æ˜¯ä¸€ä¸ªç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ç±»ã€‚ä½ å¯ä»¥æŠŠ Buffer ç†è§£æˆä¸€ä¸ªå¯ä»¥å­˜å‚¨å¤šä¸ªå­—èŠ‚çš„å®¹å™¨ï¼Œå¸¸ç”¨æ¥å¤„ç†æ–‡ä»¶è¯»å†™ã€ç½‘ç»œé€šä¿¡ç­‰æ¶‰åŠäºŒè¿›åˆ¶æ•°æ®çš„åœºæ™¯ã€‚</p><p>ä½†æ˜¯ï¼Œç”±äº JavaScript æœ€åˆè¢«è®¾è®¡ä¸ºåœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œè€Œä¸æ˜¯å¤„ç†å¤§é‡äºŒè¿›åˆ¶æ•°æ®ï¼Œæ‰€ä»¥åŸç”Ÿçš„ JavaScript å¹¶æ²¡æœ‰æä¾›è¶³å¤Ÿçš„æœºåˆ¶æ¥é«˜æ•ˆåœ°å¤„ç†è¿™äº›æ•°æ®ã€‚Node.js é€šè¿‡å¼•å…¥ Buffer ç±»æ¥è¡¥è¶³è¿™ä¸€åŠŸèƒ½ã€‚</p><p><code>buffer.constants.MAX_LENGTH</code> æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªå¸¸é‡ï¼Œå®ƒè¡¨ç¤ºåœ¨ä¸€ä¸ª Buffer å®ä¾‹ä¸­å¯ä»¥åˆ†é…çš„æœ€å¤§å†…å­˜é‡ã€‚è¿™ä¸ªé™åˆ¶æ˜¯ç”± Node.js åº•å±‚çš„ V8 JavaScript å¼•æ“å†³å®šçš„ï¼Œå¹¶ä¸”éšç€ Node.js å’Œ V8 å¼•æ“çš„ç‰ˆæœ¬ä¸åŒï¼Œè¿™ä¸ªå€¼ä¹Ÿå¯èƒ½ä¼šæœ‰æ‰€å˜åŒ–ã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œè¿™ä¸ªå€¼é€šå¸¸ä¸ºï¼š</p><ul><li>åœ¨ 64 ä½ç³»ç»Ÿä¸Šçº¦ä¸º 2 çš„ 32 æ¬¡æ–¹ï¼ˆ4GBï¼‰å‡å» 1ã€‚</li><li>åœ¨ 32 ä½ç³»ç»Ÿä¸Šåˆ™å°å¾—å¤šï¼Œå› ä¸ºå†…å­˜åœ°å€ç©ºé—´æœ‰é™ã€‚</li></ul><p>å®é™…ä½¿ç”¨ä¸­ï¼Œä½ å¾ˆå°‘ä¼šæ¥è§¦åˆ°è¿™ä¹ˆå¤§çš„ Bufferï¼Œå› ä¸ºé‚£å°†éœ€è¦æ¶ˆè€—éå¸¸å¤šçš„å†…å­˜ã€‚ä½†äº†è§£è¿™ä¸ªé™åˆ¶æ˜¯é‡è¦çš„ï¼Œç‰¹åˆ«æ˜¯å½“ä½ åœ¨å¤„ç†å¤§æ–‡ä»¶æˆ–è€…å¤§é‡æ•°æ®æ—¶ï¼Œç¡®ä¿ä¸ä¼šè¶…å‡ºè¿™ä¸ªé™åˆ¶ã€‚</p><h3 id="ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1"><span>ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js ç¨‹åºæ¥å¤„ç†ä¸Šä¼ çš„è§†é¢‘æ–‡ä»¶ã€‚å¦‚æœä¸Šä¼ çš„æ–‡ä»¶éå¸¸å¤§ï¼Œå¯èƒ½ä¼šæ¥è¿‘æˆ–è¶…è¿‡ <code>buffer.constants.MAX_LENGTH</code> è®¾å®šçš„é™åˆ¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufferConstants</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;buffer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªéå¸¸å¤§çš„æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> largeFilePath</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/path/to/large/video/file.mp4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°è¯•åˆ›å»ºä¸€ä¸ª Buffer æ¥è¯»å–æ•´ä¸ªæ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">largeFilePath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¦‚æœæ–‡ä»¶è¿‡å¤§ï¼Œè¯»å–æ—¶å¯èƒ½ä¼šé‡åˆ°é—®é¢˜</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bufferConstants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">MAX_LENGTH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ–‡ä»¶å¤ªå¤§ï¼Œæ— æ³•æ”¾å…¥å•ä¸ª Buffer!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // è¿™é‡Œå¯ä»¥å®‰å…¨åœ°å¤„ç†æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ–‡ä»¶è¯»å–æˆåŠŸï¼Œå¯ä»¥ç»§ç»­å¤„ç†æ•°æ®ã€‚&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå¦‚æœå°è¯•è¯»å–ä¸€ä¸ªè¶…è¿‡ <code>buffer.constants.MAX_LENGTH</code> çš„æ–‡ä»¶ï¼Œä¼šå¯¼è‡´é”™è¯¯ã€‚æ‰€ä»¥å½“å¤„ç†æ½œåœ¨çš„å¤§æ–‡ä»¶æ—¶ï¼Œåº”è¯¥ä½¿ç”¨æµï¼ˆstreamingï¼‰æ–¹å¼é€éƒ¨åˆ†åœ°è¯»å–å’Œå¤„ç†æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥å†…å­˜ä¸­çš„ Bufferã€‚è¿™æ ·å¯ä»¥é¿å…è¶…å‡ºå†…å­˜é™åˆ¶ï¼Œå¹¶ä¸”å¯¹ç³»ç»Ÿèµ„æºçš„ä½¿ç”¨æ›´åŠ é«˜æ•ˆã€‚</p><p>å¸Œæœ›è¿™ä¸ªè§£é‡Šèƒ½å¸®åŠ©ä½ ç†è§£ <code>buffer.constants.MAX_LENGTH</code> çš„æ¦‚å¿µå’Œå®ƒåœ¨ Node.js ä¸­çš„åº”ç”¨ã€‚</p><h4 id="buffer-constants-max-string-length" tabindex="-1"><a class="header-anchor" href="#buffer-constants-max-string-length"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufferconstantsmax_string_length" target="_blank" rel="noopener noreferrer">buffer.constants.MAX_STRING_LENGTH</a></span></a></h4><p><code>buffer.constants.MAX_STRING_LENGTH</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå¸¸é‡ï¼Œå®ƒä»£è¡¨åœ¨ JavaScript çš„ V8 å¼•æ“ä¸­å¯ä»¥åˆ›å»ºçš„æœ€é•¿å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚è¿™ä¸ªé™åˆ¶æ˜¯ç”± V8 å¼•æ“çš„å†…éƒ¨å®ç°å†³å®šçš„ï¼Œå¹¶ä¸”å¯èƒ½éšç€ V8 å¼•æ“çš„ç‰ˆæœ¬ä¸åŒè€Œæœ‰æ‰€å˜åŒ–ã€‚</p><p>ä¸ºä»€ä¹ˆä¼šæœ‰è¿™æ ·çš„é™åˆ¶ï¼ŸJavaScript ä½¿ç”¨ UTF-16 ç¼–ç å­—ç¬¦ä¸²ï¼Œæ¯ä¸ªå­—ç¬¦é€šå¸¸éœ€è¦ 2 ä¸ªå­—èŠ‚æ¥å­˜å‚¨ã€‚V8 å¼•æ“ä¸ºäº†æ€§èƒ½å’Œå†…å­˜ç®¡ç†çš„è€ƒè™‘ï¼Œè®¾å®šäº†å­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦é™åˆ¶ã€‚å¦‚æœä½ å°è¯•åˆ›å»ºä¸€ä¸ªè¶…è¿‡è¿™ä¸ªé•¿åº¦çš„å­—ç¬¦ä¸²ï¼ŒJavaScript å°†ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p><p>åœ¨ Node.js ä¸­ï¼ŒBuffer ç±»æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„å…¨å±€å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡ç»å¸¸ç”¨äºå¤„ç†åƒæ–‡ä»¶ç³»ç»Ÿå’Œç½‘ç»œé€šä¿¡è¿™æ ·çš„ I/O æ“ä½œã€‚ç†è§£ <code>buffer.constants.MAX_STRING_LENGTH</code> å¯¹äºå¼€å‘è€…æ¥è¯´æ˜¯å¾ˆé‡è¦çš„ï¼Œå› ä¸ºå®ƒå½±å“åˆ°å¦‚ä½•å®‰å…¨åœ°å¤„ç†å¤§å®¹é‡çš„æ•°æ®ã€‚</p><p>ä¸‹é¢é€šè¿‡å‡ ä¸ªä¾‹å­æ¥å±•ç¤º <code>buffer.constants.MAX_STRING_LENGTH</code> çš„åº”ç”¨ï¼š</p><ol><li>å¤„ç†å¤§æ–‡ä»¶ï¼šå½“ä½ ä½¿ç”¨ Node.js è¯»å–éå¸¸å¤§çš„æ–‡ä»¶æ—¶ï¼Œä½ å¯èƒ½ä¼šä½¿ç”¨ Buffer æ¥åˆ†å—è¯»å–æ•°æ®ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ è¯•å›¾å°†æ•´ä¸ªæ–‡ä»¶çš„å†…å®¹ä¸€æ¬¡æ€§è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆå°±å¿…é¡»ç¡®ä¿è½¬æ¢åçš„å­—ç¬¦ä¸²é•¿åº¦ä¸è¶…è¿‡ <code>buffer.constants.MAX_STRING_LENGTH</code>ã€‚å¦‚æœæ–‡ä»¶å¾ˆå¤§ï¼Œä½ åº”è¯¥å°†å…¶åˆ†å‰²æˆå¤šä¸ªå°å—ï¼Œç„¶åé€ä¸€å¤„ç†ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;fs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªéå¸¸å¤§çš„æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> stream</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createReadStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;huge_file.txt&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;utf8&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;data&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ¯ä¸€ä¸ª chunk éƒ½æ˜¯æ–‡ä»¶çš„ä¸€éƒ¨åˆ†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">MAX_STRING_LENGTH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        // å¯ä»¥å®‰å…¨åœ°å¤„ç†è¿™ä¸ªå­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;Chunk size is within the limit&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        // å¿…é¡»è¦å¤„ç†è¿™ä¸ªæƒ…å†µï¼Œä¸èƒ½è®©å­—ç¬¦ä¸²è¶…è¿‡æœ€å¤§é•¿åº¦</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;Chunk size exceeds the maximum string length&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>ç½‘ç»œè¯·æ±‚å¤„ç†ï¼šå½“ä½ æ¥æ”¶åˆ° HTTP è¯·æ±‚æ—¶ï¼Œè¯·æ±‚ä½“å¯èƒ½å¾ˆå¤§ã€‚å¦‚æœä½ æƒ³å°†æ•´ä¸ªè¯·æ±‚ä½“ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²å¤„ç†ï¼ŒåŒæ ·éœ€è¦æ£€æŸ¥å®ƒæ˜¯å¦è¶…è¿‡äº† <code>buffer.constants.MAX_STRING_LENGTH</code>ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;http&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> server</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> body</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;data&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        body</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;end&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">        body</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">concat</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">body</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        // åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åº”è¯¥æ£€æŸ¥ body çš„é•¿åº¦</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">body</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">MAX_STRING_LENGTH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">            // å®‰å…¨åœ°å¤„ç†è¯·æ±‚ä½“</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">            console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;Request body is within the limit&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">            // è¯·æ±‚ä½“å¤ªå¤§ï¼Œéœ€è¦é€‚å½“å¤„ç†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">            console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;Request body exceeds the maximum string length&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;Received&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8080</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šå°±æ˜¯å¯¹ <code>buffer.constants.MAX_STRING_LENGTH</code> çš„ç®€å•è¯´æ˜å’Œå®ƒåœ¨å®é™…æƒ…å†µä¸­çš„åº”ç”¨ã€‚æ€»ç»“èµ·æ¥ï¼Œæ‡‚å¾—è¿™ä¸ªé™åˆ¶å¯ä»¥å¸®åŠ©å¼€å‘è€…é¿å…åœ¨å¤„ç†å¤§å‹æ•°æ®æ—¶é‡åˆ°æ½œåœ¨çš„é—®é¢˜ã€‚</p><h2 id="buffer-from-buffer-alloc-and-buffer-allocunsafe" tabindex="-1"><a class="header-anchor" href="#buffer-from-buffer-alloc-and-buffer-allocunsafe"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#bufferfrom-bufferalloc-and-bufferallocunsafe" target="_blank" rel="noopener noreferrer">Buffer.from(), Buffer.alloc(), and Buffer.allocUnsafe()</a></span></a></h2><p>Node.js ä¸­çš„ Buffer ç±»æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨äºç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚åœ¨æ—©æœŸçš„ Node.js ç‰ˆæœ¬ä¸­ï¼Œåˆ›å»º Buffer å®ä¾‹çš„æ–¹å¼ä¸å¤ªå®‰å…¨ï¼Œä¹Ÿä¸æ˜“äºç†è§£ã€‚éšç€æ—¶é—´çš„å‘å±•ï¼Œæ–°çš„ã€æ›´å®‰å…¨å’Œæ˜“ç”¨çš„æ–¹æ³•è¢«å¼•å…¥ã€‚è¿™äº›æ–¹æ³•å°±åŒ…æ‹¬ <code>Buffer.from()</code>, <code>Buffer.alloc()</code>, å’Œ <code>Buffer.allocUnsafe()</code>ã€‚</p><h3 id="buffer-from-1" tabindex="-1"><a class="header-anchor" href="#buffer-from-1"><span>Buffer.from()</span></a></h3><p><code>Buffer.from()</code> æ–¹æ³•ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Buffer</code> å®ä¾‹ï¼Œè¯¥å®ä¾‹åŒ…å«äº†æä¾›çš„å‚æ•°çš„å‰¯æœ¬ã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼š</p><ol><li>ä»å­—ç¬¦ä¸²åˆ›å»ºä¸€ä¸ª Bufferã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufFromString</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é»˜è®¤ä»¥ &#39;utf8&#39; ç¼–ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bufFromString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: `&lt;`Buffer 48 65 6c 6c 6f 20 57 6f 72 6c 64&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>ä» buffer æ•°ç»„åˆ›å»ºä¸€ä¸ªæ–°çš„ Bufferã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufFromArray</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x48</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x65</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x6c</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x6c</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x6f</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bufFromArray</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: `&lt;`Buffer 48 65 6c 6c 6f&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>ä»ç°æœ‰çš„ Buffer åˆ›å»ºä¸€ä¸ªæ–°çš„ Bufferã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufFromBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bufFromArray</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bufFromBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: `&lt;`Buffer 48 65 6c 6c 6f&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="buffer-alloc-1" tabindex="-1"><a class="header-anchor" href="#buffer-alloc-1"><span>Buffer.alloc()</span></a></h3><p><code>Buffer.alloc()</code> æ–¹æ³•ç”¨æ¥åˆ›å»ºä¸€ä¸ªæŒ‡å®šå¤§å°çš„æ–° <code>Buffer</code> å®ä¾‹ï¼Œå¹¶ä¸”å®ƒä¼šç”¨ 0 å¡«å……åˆå§‹åŒ–ï¼Œç¡®ä¿åˆ›å»ºå‡ºæ¥çš„ Buffer å®ä¾‹å†…å®¹éƒ½æ˜¯ç¡®å®šçš„ï¼ˆé¢„å¡«å……ä¸º 0ï¼‰ã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 10ï¼Œä¸”ç”¨é›¶å¡«å……çš„ Bufferã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufAlloc</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bufAlloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: `&lt;`Buffer 00 00 00 00 00 00 00 00 00 00&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="buffer-allocunsafe-1" tabindex="-1"><a class="header-anchor" href="#buffer-allocunsafe-1"><span>Buffer.allocUnsafe()</span></a></h3><p>ä¸ <code>Buffer.alloc()</code> ä¸åŒï¼Œ<code>Buffer.allocUnsafe()</code> åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Buffer</code> å®ä¾‹ï¼Œä½†å®ƒä¸ä¼šåˆå§‹åŒ–å†…å­˜ä¸­çš„æ•°æ®ã€‚è¿™å°±æ„å‘³ç€æ–°åˆ›å»ºçš„ Buffer å®ä¾‹å¯èƒ½ä¼šåŒ…å«æ—§æ•°æ®æˆ–åƒåœ¾æ•°æ®ï¼Œå› æ­¤æ˜¯â€œä¸å®‰å…¨â€çš„ã€‚è¿™ä¸ªæ–¹æ³•æ¯” <code>Buffer.alloc()</code> å¿«ï¼Œå› ä¸ºå®ƒè·³è¿‡äº†åˆå§‹åŒ–æ­¥éª¤ã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 10 çš„ Bufferï¼Œä½†æ˜¯ä¸åˆå§‹åŒ–ï¼ˆå†…å®¹æ˜¯æœªçŸ¥çš„ï¼‰ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufAllocUnsafe</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">allocUnsafe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bufAllocUnsafe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: `&lt;`Buffer (å¯èƒ½æ˜¯ä»»ä½•å€¼)&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼šåªæœ‰å½“ä½ èƒ½å¤Ÿç«‹åˆ»è¦†ç›–è¿™å—å†…å­˜åŒºåŸŸï¼Œæˆ–è€…ä½ å¯¹æ€§èƒ½æœ‰æé«˜è¦æ±‚å¹¶æ˜ç™½è¿™å¯èƒ½å¯¼è‡´çš„é£é™©æ—¶ï¼Œæ‰åº”è¯¥ä½¿ç”¨ <code>Buffer.allocUnsafe()</code>ã€‚å¦åˆ™ï¼Œé€šå¸¸å»ºè®®ä½¿ç”¨ <code>Buffer.alloc()</code> æ¥ç¡®ä¿æ•°æ®çš„å®‰å…¨æ€§ã€‚</p><p>æ€»ç»“ï¼š<code>Buffer.from()</code> ç”¨äºå°†ç°æœ‰æ•°æ®è½¬æ¢æˆ Bufferï¼›<code>Buffer.alloc()</code> ç”¨äºåˆ›å»ºä¸€ä¸ªé¢„å¡«å……çš„å®‰å…¨ Bufferï¼›<code>Buffer.allocUnsafe()</code> ç”¨äºå¿«é€Ÿåˆ›å»º Bufferï¼Œä½†å¯èƒ½åŒ…å«æ•æ„Ÿæ•°æ®ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œåº”è¯¥æ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ–¹æ³•æ¥åˆ›å»º Bufferã€‚</p><h3 id="the-zero-fill-buffers-command-line-option" tabindex="-1"><a class="header-anchor" href="#the-zero-fill-buffers-command-line-option"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#the---zero-fill-buffers-command-line-option" target="_blank" rel="noopener noreferrer">The --zero-fill-buffers command-line option</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­çš„ <code>--zero-fill-buffers</code> å‘½ä»¤è¡Œé€‰é¡¹ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code> å¯¹è±¡æ˜¯ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ã€‚å½“ä½ åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Buffer</code> å®ä¾‹ï¼Œä½†æ²¡æœ‰æ˜¾å¼åœ°å¡«å……å®ƒæ—¶ï¼Œè¿™ä¸ªç¼“å†²åŒºé‡Œä¼šåŒ…å«ä¸€äº›æ—§çš„ã€éšæœºçš„å†…å­˜æ•°æ®ã€‚è¿™å°±æ˜¯æ‰€è°“çš„â€œæœªåˆå§‹åŒ–çš„å†…å­˜â€ã€‚ç”±äºå®‰å…¨åŸå› ï¼ˆä¾‹å¦‚ï¼Œé˜²æ­¢ä¸å°å¿ƒæ³„éœ²æ•æ„Ÿä¿¡æ¯ï¼‰ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›å°†è¿™äº›ç¼“å†²åŒºçš„å†…å®¹åˆå§‹åŒ–ä¸º 0ï¼Œå³æ‰€æœ‰ä½éƒ½æ˜¯ 0ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>--zero-fill-buffers</code> æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œé€‰é¡¹ï¼Œä½ å¯ä»¥åœ¨å¯åŠ¨ Node.js ç¨‹åºæ—¶åŠ ä¸Šå®ƒï¼Œå®ƒä¼šå½±å“ Buffer çš„é»˜è®¤è¡Œä¸ºã€‚å½“ä½ ä½¿ç”¨è¿™ä¸ªé€‰é¡¹æ—¶ï¼ŒNode.js ä¼šè‡ªåŠ¨æŠŠæ‰€æœ‰æ–°åˆ†é…çš„ <code>Buffer</code> å†…å®¹åˆå§‹åŒ–ä¸º 0ã€‚è¿™æ ·ï¼Œä½ å°±ä¸éœ€è¦æ‰‹åŠ¨å°†æ¯ä¸ªæ–°å»ºçš„ <code>Buffer</code> æ¸…é›¶äº†ã€‚</p><p>ä¸‹é¢é€šè¿‡å‡ ä¸ªå®é™…çš„ç¤ºä¾‹æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨ <code>--zero-fill-buffers</code>ï¼š</p><p><strong>æ²¡æœ‰ä½¿ç”¨ <code>--zero-fill-buffers</code> çš„æƒ…å†µ:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ çš„ Node.js æ²¡æœ‰ä½¿ç”¨ --zero-fill-buffers å¯åŠ¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">allocUnsafe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ†é…ä¸€ä¸ªåŒ…å«æ—§æ•°æ®çš„ 10 å­—èŠ‚é•¿åº¦çš„ç¼“å†²åŒº</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå¯èƒ½æ˜¯ï¼š`&lt;`Buffer 78 f6 04 05 00 00 02 a0 00 20&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ³¨æ„ï¼šè¾“å‡ºçš„å†…å®¹æ¯æ¬¡éƒ½å¯èƒ½ä¸åŒï¼Œå› ä¸ºå®ƒåŒ…å«éšæœºçš„å†…å­˜æ•°æ®</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä½¿ç”¨ <code>--zero-fill-buffers</code> çš„æƒ…å†µ:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">## åœ¨å‘½ä»¤è¡Œä¸­å¯åŠ¨ Node.js ç¨‹åºæ—¶ï¼Œæ·»åŠ  --zero-fill-buffers é€‰é¡¹</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">node</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --zero-fill-buffers</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> your-script.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶ååœ¨ä½ çš„ Node.js è„šæœ¬ (<code>your-script.js</code>) ä¸­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">allocUnsafe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å³ä½¿æ˜¯ allocUnsafeï¼Œç°åœ¨ä¹Ÿä¼šè¢«è‡ªåŠ¨å¡«å……ä¸º0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå°†ä¼šæ˜¯ï¼š`&lt;`Buffer 00 00 00 00 00 00 00 00 00 00&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼Œé€šå¸¸æ¨èä½¿ç”¨ <code>Buffer.alloc()</code> æ¥ä»£æ›¿ <code>Buffer.allocUnsafe()</code>ï¼Œå› ä¸º <code>alloc</code> æ–¹æ³•é»˜è®¤å°±ä¼šåˆå§‹åŒ–å†…å­˜ä¸º 0ã€‚ä½†æ˜¯å¦‚æœä½ å› ä¸ºæ€§èƒ½è€ƒè™‘è€Œé€‰æ‹© <code>allocUnsafe</code> å¹¶ä¸”åˆæƒ³ç¡®ä¿å®‰å…¨æ€§ï¼Œé‚£ä¹ˆ <code>--zero-fill-buffers</code> å°±ä¼šå¾ˆæœ‰ç”¨ã€‚</p><p>æœ€åæé†’ä¸€ä¸‹ï¼Œä»…åœ¨ä½ ç¡®å®šè¦è¿™æ ·åšï¼Œå¹¶ä¸”ç†è§£äº†å…¶å¯¹æ€§èƒ½å¯èƒ½äº§ç”Ÿçš„å½±å“ä¹‹åï¼Œå†ä½¿ç”¨ <code>--zero-fill-buffers</code> é€‰é¡¹ï¼Œå› ä¸ºè‡ªåŠ¨å¡«å……ç¼“å†²åŒºä¸º 0 ä¼šç¨å¾®å¢åŠ ç³»ç»Ÿæ‰§è¡Œçš„å¼€é”€ã€‚</p><h3 id="what-makes-buffer-allocunsafe-and-buffer-allocunsafeslow-unsafe" tabindex="-1"><a class="header-anchor" href="#what-makes-buffer-allocunsafe-and-buffer-allocunsafeslow-unsafe"><span><a href="https://nodejs.org/docs/latest/api/buffer.html#what-makes-bufferallocunsafe-and-bufferallocunsafeslow-unsafe" target="_blank" rel="noopener noreferrer">What makes Buffer.allocUnsafe() and Buffer.allocUnsafeSlow() &quot;unsafe&quot;?</a></span></a></h3><p>Node.js ä¸­çš„ Buffer ç±»æ˜¯ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå¯ä»¥å­˜æ”¾å­—èŠ‚æ•°æ®çš„æ•°ç»„ã€‚å½“ä½ æƒ³è¦åœ¨ Node.js ä¸­å¤„ç†æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡ç­‰æ¶‰åŠäºŒè¿›åˆ¶æ•°æ®çš„æ—¶å€™ï¼ŒBuffer å°±éå¸¸æœ‰ç”¨ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œåˆ›å»º Buffer å¯¹è±¡çš„ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨ <code>Buffer.allocUnsafe()</code> æˆ– <code>Buffer.allocUnsafeSlow()</code> æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•ä¹‹æ‰€ä»¥è¢«ç§°ä¸ºâ€œä¸å®‰å…¨â€(unsafe)ï¼Œæ˜¯å› ä¸ºå®ƒä»¬åˆ†é…çš„å†…å­˜åŒºåŸŸå¯èƒ½åŒ…å«ä¸€äº›æ—§çš„ã€æ•æ„Ÿçš„æ•°æ®ã€‚è®©æˆ‘ä»¬æ¥è¯¦ç»†äº†è§£ä¸€ä¸‹ã€‚</p><h3 id="ä¸ºä»€ä¹ˆæ˜¯-ä¸å®‰å…¨-çš„" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆæ˜¯-ä¸å®‰å…¨-çš„"><span>ä¸ºä»€ä¹ˆæ˜¯â€œä¸å®‰å…¨â€çš„ï¼Ÿ</span></a></h3><p>å½“ä½ ä½¿ç”¨ <code>Buffer.allocUnsafe()</code> æˆ– <code>Buffer.allocUnsafeSlow()</code> åˆ›å»ºä¸€ä¸ªæ–°çš„ Buffer æ—¶ï¼ŒNode.js ä¼šç»™ä½ ä¸€æ®µåŸå§‹çš„å†…å­˜ç©ºé—´ï¼Œè€Œè¿™ä¸ªå†…å­˜ç©ºé—´ä¹‹å‰å¯èƒ½å·²ç»è¢«å…¶ä»–åº”ç”¨ç¨‹åºä½¿ç”¨è¿‡äº†ã€‚å¦‚æœè¿™å—å†…å­˜æ²¡æœ‰è¢«æ¸…é™¤ï¼ˆä¹Ÿå°±æ˜¯è¯´é‡Œé¢å¯èƒ½æœ‰æ®‹ç•™æ•°æ®ï¼‰ï¼Œé‚£ä¹ˆè¿™äº›æ—§æ•°æ®å¯èƒ½ä¼šè¢«æ–°åˆ›å»ºçš„ Buffer ä¸å°å¿ƒè¯»å–åˆ°ã€‚</p><p>ä¸ºä»€ä¹ˆ Node.js è¦æä¾›è¿™æ ·çš„æ–¹æ³•å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æ€§èƒ½ã€‚è¿™ç§æœªåˆå§‹åŒ–çš„ Buffer åˆ›å»ºèµ·æ¥éå¸¸å¿«ï¼Œå› ä¸ºç³»ç»Ÿä¸éœ€è¦å»æ¸…é›¶å†…å­˜æˆ–è€…åšå…¶ä»–çš„åˆå§‹åŒ–å·¥ä½œã€‚ä½†æ˜¯ï¼Œè¿™å¸¦æ¥äº†ä¸€å®šçš„å®‰å…¨é£é™©ã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯"><span>ä½¿ç”¨åœºæ™¯</span></a></h3><p>ä½ åº”è¯¥åªåœ¨ç¡®å®šå®‰å…¨æ€§ä¸æ˜¯é¦–è¦è€ƒè™‘ï¼Œå¹¶ä¸”ç´§æ¥ç€ä¼šå®Œå…¨è¦†ç›–æ‰å†…å­˜æ•°æ®çš„æƒ…å†µä¸‹ï¼Œæ‰ä½¿ç”¨ <code>Buffer.allocUnsafe()</code>ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ å³å°†ç«‹å³è¯»å–ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹å¹¶ä¸”å¡«å……åˆ°è¿™ä¸ª Bufferï¼Œè€Œè¿™ä¸ªæ–‡ä»¶çš„å¤§å°å’Œä½ åˆ†é…çš„ Buffer å®Œå…¨åŒ¹é…ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨ <code>Buffer.allocUnsafe()</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ fs æ˜¯æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼Œæˆ‘ä»¬æƒ³è¦å¼‚æ­¥åœ°è¯»å–ä¸€ä¸ªæ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ†é…ä¸€ä¸ªä¸å®‰å…¨çš„ Bufferï¼Œå¤§å°ä¸ºæ–‡ä»¶å¤§å°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> unsafeBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">allocUnsafe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fileSize</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¡«å…… Bufferï¼Œä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">copy</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">unsafeBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†æ–‡ä»¶æ•°æ®å¤åˆ¶åˆ°ä¸å®‰å…¨çš„ Buffer ä¸­</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ç”±äºæ•´ä¸ª Buffer éƒ½è¢«æ–‡ä»¶æ•°æ®è¦†ç›–ï¼Œæ‰€ä»¥ç°åœ¨ä½¿ç”¨æ˜¯å®‰å…¨çš„</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®‰å…¨æ›¿ä»£æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#å®‰å…¨æ›¿ä»£æ–¹æ¡ˆ"><span>å®‰å…¨æ›¿ä»£æ–¹æ¡ˆ</span></a></h3><p>ç›¸åï¼Œ<code>Buffer.alloc(size)</code> æ–¹æ³•åˆ™æ€»æ˜¯è¿”å›ä¸€ä¸ªåˆå§‹åŒ–è¿‡çš„ã€æ¸…é›¶çš„ Bufferã€‚è¿™ç¡®ä¿æ–°åˆ›å»ºçš„ Buffer ä¸ä¼šåŒ…å«ä»»ä½•æ—§æ•°æ®ï¼Œå› æ­¤æ˜¯å®‰å…¨çš„ã€‚ä½†æ˜¯ï¼Œè¿™ç§å®‰å…¨æ€§æ˜¯ä»¥æ€§èƒ½ä¸ºä»£ä»·çš„ï¼Œå› ä¸ºæ¸…é›¶æ“ä½œéœ€è¦é¢å¤–çš„æ—¶é—´ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå‡ºäºå®‰å…¨è€ƒè™‘ï¼Œä½ åº”è¯¥é»˜è®¤ä½¿ç”¨ <code>Buffer.alloc(size)</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> safeBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1024</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ†é…ä¸€ä¸ªå®‰å…¨çš„ Bufferï¼Œå¤§å°ä¸º 1024 å­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™ä¸ª Buffer çš„æ¯ä¸ªå­—èŠ‚éƒ½è¢«åˆå§‹åŒ–ä¸º 0ï¼Œå› æ­¤å®ƒä¸åŒ…å«ä»»ä½•æ—§æ•°æ®</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ€»ç»“æ¥è¯´ï¼Œ<code>Buffer.allocUnsafe()</code> å’Œ <code>Buffer.allocUnsafeSlow()</code> æä¾›äº†ä¸€ç§å¿«é€Ÿåˆ†é…å†…å­˜çš„é€”å¾„ï¼Œä½†è¿™ç§æ–¹æ³•å¹¶ä¸å®‰å…¨ï¼Œå› ä¸ºå®ƒä»¬ä¸ä¼šæ¸…é™¤å¯èƒ½åŒ…å«çš„æ•æ„Ÿæ—§æ•°æ®ã€‚åœ¨å¤„ç†ä¸æ¶‰åŠæ•æ„Ÿä¿¡æ¯çš„åœºæ™¯ï¼Œå¹¶ä¸”å¾ˆå¿«å°±ä¼šå®Œå…¨è¦†ç›–æ‰ Buffer å†…å®¹çš„æ—¶å€™ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å®ƒä»¬ã€‚ç„¶è€Œï¼Œä¸ºäº†ç¡®ä¿æ•°æ®çš„å®‰å…¨æ€§ï¼Œæœ€å¥½è¿˜æ˜¯ä½¿ç”¨ <code>Buffer.alloc(size)</code> æ¥åˆ›å»ºæ–°çš„ Buffer å®ä¾‹ã€‚</p></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: kamiacgxu@gmail.com">kamishima-kaede</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/document/node-doc/Asynchronous%20context%20tracking.html" aria-label="Asynchronous context tracking"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Asynchronous context tracking</div></a><a class="route-link auto-link next" href="/document/node-doc/C__%20addons.html" aria-label="C++ addons"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">C++ addons<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><!----><div class="vp-copyright">Copyright Â© 2018-present hanekawa-shiki</div></footer></div><!--]--><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.c5220139.js" defer></script><script src="/assets/js/7531.f2f134c8.js" defer></script><script src="/assets/js/app.af931348.js" defer></script>
  </body>
</html>
