<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.50" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://hanekawa.top/document/node-doc/DNS.html"><meta property="og:site_name" content="hanekawa-shiki"><meta property="og:title" content="DNS"><meta property="og:description" content="DNS Node.js ä¸­çš„ DNS æ¨¡å—å…è®¸ä½ ä¸ç½‘ç»œä¸Šçš„åŸŸåç³»ç»Ÿï¼ˆDomain Name Systemï¼‰è¿›è¡Œäº¤äº’ã€‚ç®€å•æ¥è¯´ï¼Œå½“ä½ æƒ³è¦è®¿é—®ä¸€ä¸ªç½‘ç«™æ¯”å¦‚www.example.comæ—¶ï¼Œä½ çš„è®¡ç®—æœºéœ€è¦çŸ¥é“è¿™ä¸ªç½‘å€å¯¹åº”çš„ IP åœ°å€æ˜¯ä»€ä¹ˆï¼Œå› ä¸ºåœ¨ç½‘ç»œä¸–ç•Œä¸­ï¼Œè®¡ç®—æœºæ˜¯é€šè¿‡ IP åœ°å€æ¥æ‰¾åˆ°å¹¶è¿æ¥å½¼æ­¤çš„ã€‚DNS å°±åƒæ˜¯ä¸€ä¸ªç”µè¯ç°¿ï¼Œå®ƒå¸®åŠ©ä½ å°†å®¹æ˜“è®°ä½çš„åŸŸåï¼ˆä¾‹å¦‚..."><meta property="og:type" content="website"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-06-21T09:46:17.000Z"><meta property="article:author" content="hanekawa-shiki"><meta property="article:modified_time" content="2024-06-21T09:46:17.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"WebPage","name":"DNS","description":"DNS Node.js ä¸­çš„ DNS æ¨¡å—å…è®¸ä½ ä¸ç½‘ç»œä¸Šçš„åŸŸåç³»ç»Ÿï¼ˆDomain Name Systemï¼‰è¿›è¡Œäº¤äº’ã€‚ç®€å•æ¥è¯´ï¼Œå½“ä½ æƒ³è¦è®¿é—®ä¸€ä¸ªç½‘ç«™æ¯”å¦‚www.example.comæ—¶ï¼Œä½ çš„è®¡ç®—æœºéœ€è¦çŸ¥é“è¿™ä¸ªç½‘å€å¯¹åº”çš„ IP åœ°å€æ˜¯ä»€ä¹ˆï¼Œå› ä¸ºåœ¨ç½‘ç»œä¸–ç•Œä¸­ï¼Œè®¡ç®—æœºæ˜¯é€šè¿‡ IP åœ°å€æ¥æ‰¾åˆ°å¹¶è¿æ¥å½¼æ­¤çš„ã€‚DNS å°±åƒæ˜¯ä¸€ä¸ªç”µè¯ç°¿ï¼Œå®ƒå¸®åŠ©ä½ å°†å®¹æ˜“è®°ä½çš„åŸŸåï¼ˆä¾‹å¦‚..."}</script><meta name="keywords" content="JavaScript,HTML,CSS"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/assets/icons/chrome-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icons/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icons/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icons/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#5c92d1"><link rel="apple-touch-icon" href="/assets/icons/apple-touch-icon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="white"><meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><title>DNS | hanekawa-shiki</title><meta name="description" content="DNS Node.js ä¸­çš„ DNS æ¨¡å—å…è®¸ä½ ä¸ç½‘ç»œä¸Šçš„åŸŸåç³»ç»Ÿï¼ˆDomain Name Systemï¼‰è¿›è¡Œäº¤äº’ã€‚ç®€å•æ¥è¯´ï¼Œå½“ä½ æƒ³è¦è®¿é—®ä¸€ä¸ªç½‘ç«™æ¯”å¦‚www.example.comæ—¶ï¼Œä½ çš„è®¡ç®—æœºéœ€è¦çŸ¥é“è¿™ä¸ªç½‘å€å¯¹åº”çš„ IP åœ°å€æ˜¯ä»€ä¹ˆï¼Œå› ä¸ºåœ¨ç½‘ç»œä¸–ç•Œä¸­ï¼Œè®¡ç®—æœºæ˜¯é€šè¿‡ IP åœ°å€æ¥æ‰¾åˆ°å¹¶è¿æ¥å½¼æ­¤çš„ã€‚DNS å°±åƒæ˜¯ä¸€ä¸ªç”µè¯ç°¿ï¼Œå®ƒå¸®åŠ©ä½ å°†å®¹æ˜“è®°ä½çš„åŸŸåï¼ˆä¾‹å¦‚...">
    <link rel="stylesheet" href="/assets/css/styles.6fad2577.css">
    <link rel="preload" href="/assets/js/runtime~app.2cf91084.js" as="script"><link rel="preload" href="/assets/css/styles.6fad2577.css" as="style"><link rel="preload" href="/assets/js/7531.f2f134c8.js" as="script"><link rel="preload" href="/assets/js/app.a2d0f323.js" as="script">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo light" src="/assets/svg/logo.svg" alt><img class="vp-nav-logo dark" src="/assets/svg/logo.svg" alt><span class="vp-site-name hide-in-pad">hanekawa-shiki</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="åšå®¢ä¸»é¡µ"><!--[--><span class="font-icon icon home" style=""></span><!--]-->åšå®¢ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="å­¦ä¹ ç¬”è®°"><!--[--><span class="font-icon icon framework" style=""></span>å­¦ä¹ ç¬”è®°<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">å‰ç«¯æ¡†æ¶</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/framework_front/vue3/" aria-label="Vue3ç¬”è®°"><!--[--><span class="font-icon icon vue" style=""></span><!--]-->Vue3ç¬”è®°<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/framework_front/react/" aria-label="Reactç¬”è®°"><!--[--><span class="font-icon icon react" style=""></span><!--]-->Reactç¬”è®°<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="æ–‡æ¡£"><!--[--><span class="font-icon icon framework" style=""></span>æ–‡æ¡£<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">æ¬è¿</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link route-link-active auto-link" href="/document/node-doc/" aria-label="Node.jsæ–‡æ¡£"><!--[--><span class="font-icon icon circle-info" style=""></span><!--]-->Node.jsæ–‡æ¡£<!----></a></li></ul></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/hanekawa-shiki/hanekawa-shiki.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/" aria-label="Node.jsæ–‡æ¡£"><!--[--><span class="font-icon icon circle-info" style=""></span><!--]-->Node.jsæ–‡æ¡£<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Assert.html" aria-label="Assert"><!---->Assert<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Async%20hooks.html" aria-label="Async hooks"><!---->Async hooks<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Asynchronous%20context%20tracking.html" aria-label="Asynchronous context tracking"><!---->Asynchronous context tracking<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Buffer.html" aria-label="Buffer"><!---->Buffer<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/C__%20addons.html" aria-label="C++ addons"><!---->C++ addons<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/C__%20embedder%20API.html" aria-label="C++ embedder API"><!---->C++ embedder API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Child%20process.html" aria-label="Child process"><!---->Child process<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Cluster.html" aria-label="Cluster"><!---->Cluster<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Command-line%20API.html" aria-label="Command-line API"><!---->Command-line API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Console.html" aria-label="Console"><!---->Console<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Corepack.html" aria-label="Corepack"><!---->Corepack<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Crypto.html" aria-label="Crypto"><!---->Crypto<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Debugger.html" aria-label="Debugger"><!---->Debugger<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Deprecated%20APIs.html" aria-label="Deprecated APIs"><!---->Deprecated APIs<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Diagnostic%20report.html" aria-label="Diagnostic report"><!---->Diagnostic report<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Diagnostics%20Channel.html" aria-label="Diagnostics Channel"><!---->Diagnostics Channel<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/document/node-doc/DNS.html" aria-label="DNS"><!---->DNS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Domain.html" aria-label="Domain"><!---->Domain<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Errors.html" aria-label="Errors"><!---->Errors<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Events.html" aria-label="Events"><!---->Events<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/File%20system.html" aria-label="File system"><!---->File system<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Global%20objects.html" aria-label="Global objects"><!---->Global objects<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/HTTP.html" aria-label="HTTP"><!---->HTTP<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/HTTPS.html" aria-label="HTTPS"><!---->HTTPS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Inspector.html" aria-label="Inspector"><!---->Inspector<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Internationalization%20support.html" aria-label="Internationalization support"><!---->Internationalization support<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-CommonJS%20modules.html" aria-label="Modules: CommonJS modules"><!---->Modules: CommonJS modules<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-ECMAScript%20modules.html" aria-label="Modules: ECMAScript modules"><!---->Modules: ECMAScript modules<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-node%20module%20API.html" aria-label="Modules: node:module API"><!---->Modules: node:module API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-Packages.html" aria-label="Modules: Packages"><!---->Modules: Packages<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Net.html" aria-label="Net"><!---->Net<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Node-API.html" aria-label="Node-API"><!---->Node-API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/OS.html" aria-label="OS"><!---->OS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Path.html" aria-label="Path"><!---->Path<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Performance%20measurement%20APIs.html" aria-label="Performance measurement APIs"><!---->Performance measurement APIs<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Permissions.html" aria-label="Permissions"><!---->Permissions<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Process.html" aria-label="Process"><!---->Process<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Punycode.html" aria-label="Punycode"><!---->Punycode<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Query%20string.html" aria-label="Query string"><!---->Query string<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Readline.html" aria-label="Readline"><!---->Readline<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/REPL.html" aria-label="REPL"><!---->REPL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Stream.html" aria-label="Stream"><!---->Stream<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/String%20decoder.html" aria-label="String decoder"><!---->String decoder<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Test%20runner.html" aria-label="Test runner"><!---->Test runner<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Timers.html" aria-label="Timers"><!---->Timers<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/TLS%20(SSL).html" aria-label="TLS (SSL)"><!---->TLS (SSL)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Trace%20events.html" aria-label="Trace events"><!---->Trace events<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/TTY.html" aria-label="TTY"><!---->TTY<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/URL.html" aria-label="URL"><!---->URL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Util.html" aria-label="Util"><!---->Util<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/V8.html" aria-label="V8"><!---->V8<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/VM%20(executing%20JavaScript).html" aria-label="VM (executing JavaScript)"><!---->VM (executing JavaScript)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Web%20Crypto%20API.html" aria-label="Web Crypto API"><!---->Web Crypto API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Web%20Streams%20API.html" aria-label="Web Streams API"><!---->Web Streams API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/WebAssembly%20System%20Interface%20(WASI).html" aria-label="WebAssembly System Interface (WASI)"><!---->WebAssembly System Interface (WASI)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Worker%20threads.html" aria-label="Worker threads"><!---->Worker threads<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Zlib.html" aria-label="Zlib"><!---->Zlib<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->DNS</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://hanekawa.top" target="_blank" rel="noopener noreferrer">hanekawa-shiki</a></span><span property="author" content="hanekawa-shiki"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-06-21T09:46:17.000Z"></span><!----><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 105 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT105M"></span><span class="page-word-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon" name="word"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 31456 å­—</span><meta property="wordCount" content="31456"></span><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-dns-resolver">Class: dns.Resolver</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹åŒ–-dns-resolver">å®ä¾‹åŒ– dns.Resolver</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-dns-resolver-è¿›è¡ŒæŸ¥è¯¢">ä½¿ç”¨ dns.Resolver è¿›è¡ŒæŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#äº‹ä»¶ç›‘å¬">äº‹ä»¶ç›‘å¬</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#resolver-options">Resolver([options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åˆ›å»ºä¸€ä¸ª-resolver-å®ä¾‹">åˆ›å»ºä¸€ä¸ª Resolver å®ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-options-å‚æ•°">ä½¿ç”¨ options å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#resolver-cancel">resolver.cancel()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#resolver-setlocaladdress-ipv4-ipv6">resolver.setLocalAddress([ipv4][, ipv6])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#é»˜è®¤è¡Œä¸º">é»˜è®¤è¡Œä¸º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-resolver-setlocaladdress">ä½¿ç”¨ resolver.setLocalAddress</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-1">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-getservers">dns.getServers()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-lookup-hostname-options-callback">dns.lookup(hostname[, options], callback)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dns-lookup-hostname-options-callback-1">dns.lookup(hostname[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#supported-getaddrinfo-flags">Supported getaddrinfo flags</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-lookupservice-address-port-callback">dns.lookupService(address, port, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-resolve-hostname-rrtype-callback">dns.resolve(hostname[, rrtype], callback)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-è§£æ-a-è®°å½•">ç¤ºä¾‹ 1ï¼šè§£æ A è®°å½•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-è§£æ-mx-è®°å½•">ç¤ºä¾‹ 2ï¼šè§£æ MX è®°å½•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-3-è§£æé»˜è®¤è®°å½•ç±»å‹-a-è®°å½•">ç¤ºä¾‹ 3ï¼šè§£æé»˜è®¤è®°å½•ç±»å‹ï¼ˆA è®°å½•ï¼‰</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-resolve4-hostname-options-callback">dns.resolve4(hostname[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-resolve6-hostname-options-callback">dns.resolve6(hostname[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-resolveany-hostname-callback">dns.resolveAny(hostname, callback)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dns-resolveany-è¯¦è§£">dns.resolveAny() è¯¦è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯´æ˜">å‚æ•°è¯´æ˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¸¾ä¾‹">ä½¿ç”¨ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-2">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-resolvecname-hostname-callback">dns.resolveCname(hostname, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-resolvecaa-hostname-callback">dns.resolveCaa(hostname, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-resolvemx-hostname-callback">dns.resolveMx(hostname, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-resolvenaptr-hostname-callback">dns.resolveNaptr(hostname, callback)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dns-ç®€ä»‹">DNS ç®€ä»‹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#naptr-è®°å½•ç®€ä»‹">NAPTR è®°å½•ç®€ä»‹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-dns-resolvenaptr">ä½¿ç”¨ dns.resolveNaptr()ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹">ç¤ºä¾‹ï¼š</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-resolvens-hostname-callback">dns.resolveNs(hostname, callback)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‡½æ•°è§£é‡Š">å‡½æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-1">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-resolveptr-hostname-callback">dns.resolvePtr(hostname, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-resolvesoa-hostname-callback">dns.resolveSoa(hostname, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-resolvesrv-hostname-callback">dns.resolveSrv(hostname, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-resolvetxt-hostname-callback">dns.resolveTxt(hostname, callback)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‡½æ•°åŸå‹">å‡½æ•°åŸå‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹ä»£ç -1">ç¤ºä¾‹ä»£ç </a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-reverse-ip-callback">dns.reverse(ip, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-setdefaultresultorder-order">dns.setDefaultResultOrder(order)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-getdefaultresultorder">dns.getDefaultResultOrder()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-setservers-servers">dns.setServers(servers)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¯­æ³•">è¯­æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-2">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dns-promises-api">DNS promises API</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-è§£æåŸŸåä¸º-ip-åœ°å€">ä¾‹å­ 1ï¼šè§£æåŸŸåä¸º IP åœ°å€</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-åå‘è§£æ-ip-åœ°å€ä¸ºåŸŸå">ä¾‹å­ 2ï¼šåå‘è§£æ IP åœ°å€ä¸ºåŸŸå</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-3-æŸ¥æ‰¾æ‰€æœ‰ç±»å‹çš„è®°å½•">ä¾‹å­ 3ï¼šæŸ¥æ‰¾æ‰€æœ‰ç±»å‹çš„è®°å½•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#class-dnspromises-resolver">Class: dnsPromises.Resolver</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#resolver-cancel-1">resolver.cancel()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-getservers">dnsPromises.getServers()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-lookup-hostname-options">dnsPromises.lookup(hostname[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-1-åŸºæœ¬ç”¨æ³•">å®ä¾‹ 1: åŸºæœ¬ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-2-ä½¿ç”¨-options-å‚æ•°">å®ä¾‹ 2: ä½¿ç”¨ options å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-3-é”™è¯¯å¤„ç†">å®ä¾‹ 3: é”™è¯¯å¤„ç†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-lookupservice-address-port">dnsPromises.lookupService(address, port)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-resolve-hostname-rrtype">dnsPromises.resolve(hostname[, rrtype])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-1">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-resolve4-hostname-options">dnsPromises.resolve4(hostname[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-1">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-resolve6-hostname-options">dnsPromises.resolve6(hostname[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-åŸºæœ¬ç”¨æ³•">ç¤ºä¾‹ 1ï¼šåŸºæœ¬ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-å¸¦é€‰é¡¹çš„ç”¨æ³•">ç¤ºä¾‹ 2ï¼šå¸¦é€‰é¡¹çš„ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-resolveany-hostname">dnsPromises.resolveAny(hostname)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-resolveany-hostname-1">dnsPromises.resolveAny(hostname)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-resolvecaa-hostname">dnsPromises.resolveCaa(hostname)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-resolvecname-hostname">dnsPromises.resolveCname(hostname)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cname-è®°å½•æ˜¯ä»€ä¹ˆ">CNAME è®°å½•æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-dnspromises-resolvecname-hostname">å¦‚ä½•ä½¿ç”¨ dnsPromises.resolveCname(hostname)ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-3">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-resolvemx-hostname">dnsPromises.resolveMx(hostname)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-resolvenaptr-hostname">dnsPromises.resolveNaptr(hostname)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-resolvens-hostname">dnsPromises.resolveNs(hostname)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-resolvens-hostname-1">dnsPromises.resolveNs(hostname)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨åœºæ™¯">å®é™…åº”ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-resolveptr-hostname">dnsPromises.resolvePtr(hostname)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-resolvesoa-hostname">dnsPromises.resolveSoa(hostname)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-resolvesrv-hostname">dnsPromises.resolveSrv(hostname)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dns-å’Œ-srv-è®°å½•">DNS å’Œ SRV è®°å½•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-çš„-dnspromises-resolvesrv">Node.js çš„ dnsPromises.resolveSrv</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-4">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-resolvetxt-hostname">dnsPromises.resolveTxt(hostname)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-è§£æåŸŸåçš„-txt-è®°å½•">ç¤ºä¾‹ 1: è§£æåŸŸåçš„ TXT è®°å½•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-éªŒè¯åŸŸåæ‰€æœ‰æƒ">ç¤ºä¾‹ 2: éªŒè¯åŸŸåæ‰€æœ‰æƒ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-reverse-ip">dnsPromises.reverse(ip)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬ä½¿ç”¨æ–¹æ³•">åŸºæœ¬ä½¿ç”¨æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#é”™è¯¯å¤„ç†">é”™è¯¯å¤„ç†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨åœºæ™¯-1">å®é™…åº”ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-setdefaultresultorder-order">dnsPromises.setDefaultResultOrder(order)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-getdefaultresultorder">dnsPromises.getDefaultResultOrder()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dnspromises-setservers-servers">dnsPromises.setServers(servers)</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#error-codes">Error codes</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#implementation-considerations">Implementation considerations</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dns-lookup">dns.lookup()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç”¨æ³•">ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2">ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è®¾ç½®åœ°å€æ—">è®¾ç½®åœ°å€æ—</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-5">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dns-resolve-dns-resolve-and-dns-reverse">dns.resolve(), dns.resolve*(), and dns.reverse()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dns-resolve">dns.resolve()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dns-resolve-1">dns.resolve*()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dns-reverse">dns.reverse()</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="dns" tabindex="-1"><a class="header-anchor" href="#dns"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dns" target="_blank" rel="noopener noreferrer">DNS</a></span></a></h1><p>Node.js ä¸­çš„ DNS æ¨¡å—å…è®¸ä½ ä¸ç½‘ç»œä¸Šçš„åŸŸåç³»ç»Ÿï¼ˆDomain Name Systemï¼‰è¿›è¡Œäº¤äº’ã€‚ç®€å•æ¥è¯´ï¼Œå½“ä½ æƒ³è¦è®¿é—®ä¸€ä¸ªç½‘ç«™æ¯”å¦‚<code>www.example.com</code>æ—¶ï¼Œä½ çš„è®¡ç®—æœºéœ€è¦çŸ¥é“è¿™ä¸ªç½‘å€å¯¹åº”çš„ IP åœ°å€æ˜¯ä»€ä¹ˆï¼Œå› ä¸ºåœ¨ç½‘ç»œä¸–ç•Œä¸­ï¼Œè®¡ç®—æœºæ˜¯é€šè¿‡ IP åœ°å€æ¥æ‰¾åˆ°å¹¶è¿æ¥å½¼æ­¤çš„ã€‚DNS å°±åƒæ˜¯ä¸€ä¸ªç”µè¯ç°¿ï¼Œå®ƒå¸®åŠ©ä½ å°†å®¹æ˜“è®°ä½çš„åŸŸåï¼ˆä¾‹å¦‚<code>www.example.com</code>ï¼‰ç¿»è¯‘æˆè®¡ç®—æœºèƒ½ç†è§£çš„ IP åœ°å€ã€‚</p><p>åœ¨ Node.js ä¸­ï¼ŒDNS æ¨¡å—æä¾›äº†ä¸€ç³»åˆ—å‡½æ•°ï¼Œè®©ä½ å¯ä»¥æ‰§è¡Œè¿™ç§è½¬æ¢ï¼Œä»¥åŠå…¶ä»–ä¸åŸŸåè§£æç›¸å…³çš„æ“ä½œã€‚ä»¥ä¸‹æ˜¯å‡ ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><ol><li><p><strong>æŸ¥æ‰¾ IP åœ°å€</strong>:<br> å‡è®¾ä½ æƒ³è¦è·å–<code>www.google.com</code>çš„ IP åœ°å€ï¼Œå¯ä»¥ä½¿ç”¨ DNS æ¨¡å—çš„<code>resolve4()</code>æ–¹æ³•æ¥æŸ¥è¯¢ IPv4 åœ°å€ï¼Œæˆ–è€…<code>resolve6()</code>æ¥æŸ¥è¯¢ IPv6 åœ°å€ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;www.google.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`IP åœ°å€: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šè¾“å‡º Google ä¸»é¡µçš„ IPv4 åœ°å€ã€‚</p></li><li><p><strong>åå‘æŸ¥æ‰¾</strong>:<br> æœ‰æ—¶å€™ä½ å¯èƒ½æ‹¥æœ‰ä¸€ä¸ª IP åœ°å€ï¼Œæƒ³è¦æ‰¾å‡ºå®ƒå¯¹åº”çš„åŸŸåï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨<code>reverse()</code>æ–¹æ³•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">reverse</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;8.8.8.8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">hostnames</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`åå‘è§£æ 8.8.8.8: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostnames</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šè¾“å‡º</p></li></ol><h2 id="class-dns-resolver" tabindex="-1"><a class="header-anchor" href="#class-dns-resolver"><span><a href="https://nodejs.org/docs/latest/api/dns.html#class-dnsresolver" target="_blank" rel="noopener noreferrer">Class: dns.Resolver</a></span></a></h2><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬ç®€å•æ˜äº†åœ°è®²è§£ Node.js ä¸­çš„ <code>dns.Resolver</code> ç±»ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ DNSï¼ˆDomain Name Systemï¼‰æ˜¯äº’è”ç½‘ä¸Šç”¨äºå°†åŸŸåè½¬æ¢æˆ IP åœ°å€çš„ç³»ç»Ÿã€‚å½“ä½ åœ¨æµè§ˆå™¨è¾“å…¥ä¸€ä¸ªç½‘ç«™åœ°å€æ¯”å¦‚ &quot;<a href="http://www.example.com" target="_blank" rel="noopener noreferrer">www.example.com</a>&quot; çš„æ—¶å€™ï¼ŒDNS æœåŠ¡å™¨è´Ÿè´£å‘Šè¯‰ä½ çš„è®¡ç®—æœºè¿™ä¸ªåŸŸåå¯¹åº”çš„ IP åœ°å€ã€‚</p><p><code>dns.Resolver</code> æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªå·¥å…·ç±»ï¼Œç”¨æ¥è¿›è¡Œè‡ªå®šä¹‰çš„ DNS æŸ¥è¯¢ã€‚ä½¿ç”¨å®ƒï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ DNS è§£æå™¨å®ä¾‹ï¼Œè¿™ä¸ªå®ä¾‹ä¼šä½¿ç”¨ä¸€ç»„æŒ‡å®šçš„ DNS æœåŠ¡å™¨ï¼Œè€Œä¸ä»…ä»…æ˜¯ä½ ç”µè„‘æˆ–è€…ç½‘ç»œé»˜è®¤çš„ DNS è®¾ç½®ã€‚è¿™ç»™ä½ æ›´å¤šæ§åˆ¶æƒå’Œçµæ´»æ€§å»åš DNS æŸ¥è¯¢ã€‚</p><h3 id="å®ä¾‹åŒ–-dns-resolver" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹åŒ–-dns-resolver"><span>å®ä¾‹åŒ– dns.Resolver</span></a></h3><p>å½“ä½ åˆ›å»ºä¸€ä¸ª <code>dns.Resolver</code> å¯¹è±¡æ—¶ï¼Œä½ å¯ä»¥æŒ‡å®šç‰¹å®šçš„ DNS æœåŠ¡å™¨ï¼Œé€šè¿‡ <code>resolver.setServers()</code> æ–¹æ³•è®¾ç½®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> resolver</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;8.8.8.8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½® Google çš„å…¬å…±DNSæœåŠ¡å™¨</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä½¿ç”¨-dns-resolver-è¿›è¡ŒæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-dns-resolver-è¿›è¡ŒæŸ¥è¯¢"><span>ä½¿ç”¨ dns.Resolver è¿›è¡ŒæŸ¥è¯¢</span></a></h3><p>åˆ›å»ºäº† <code>dns.Resolver</code> å®ä¾‹åï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥æ‰§è¡Œå„ç§ DNS æŸ¥è¯¢ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥æŸ¥æ‰¾ä¸€ä¸ªåŸŸåçš„ IP åœ°å€ï¼Œåå‘æŸ¥æ‰¾ IP åœ°å€å¯¹åº”çš„åŸŸåï¼Œæˆ–è€…æŸ¥è¯¢é‚®ç®±æœåŠ¡å™¨çš„åœ°å€ç­‰ã€‚</p><h4 id="æŸ¥è¯¢-ip-åœ°å€-a-è®°å½•" tabindex="-1"><a class="header-anchor" href="#æŸ¥è¯¢-ip-åœ°å€-a-è®°å½•"><span>æŸ¥è¯¢ IP åœ°å€ (A è®°å½•)</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`IPåœ°å€: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç æŸ¥è¯¢åŸŸå &quot;<a href="http://example.com" target="_blank" rel="noopener noreferrer">example.com</a>&quot; çš„ IPv4 åœ°å€ï¼Œç„¶åæ‰“å°å‡ºç»“æœã€‚</p><h4 id="åå‘æŸ¥è¯¢åŸŸå-ptr-è®°å½•" tabindex="-1"><a class="header-anchor" href="#åå‘æŸ¥è¯¢åŸŸå-ptr-è®°å½•"><span>åå‘æŸ¥è¯¢åŸŸå (PTR è®°å½•)</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">reverse</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;93.184.216.34&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">hostnames</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`åŸŸå: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostnames</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä½ æœ‰ä¸€ä¸ª IP åœ°å€ï¼Œæƒ³æ‰¾åˆ°å®ƒå¯¹åº”çš„åŸŸåï¼Œä½ å¯ä»¥ç”¨ä¸Šé¢çš„ä»£ç è¿›è¡Œåå‘æŸ¥è¯¢ã€‚</p><h4 id="æŸ¥è¯¢é‚®ä»¶äº¤æ¢è®°å½•-mx-è®°å½•" tabindex="-1"><a class="header-anchor" href="#æŸ¥è¯¢é‚®ä»¶äº¤æ¢è®°å½•-mx-è®°å½•"><span>æŸ¥è¯¢é‚®ä»¶äº¤æ¢è®°å½• (MX è®°å½•)</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveMx</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">mxRecord</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      `é‚®ä»¶äº¤æ¢è®°å½•: ä¼˜å…ˆçº§ - </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mxRecord</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">priority</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, é‚®ä»¶æœåŠ¡å™¨ - </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mxRecord</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exchange</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å¸®åŠ©ä½ æŸ¥è¯¢å¤„ç† &quot;<a href="http://example.com" target="_blank" rel="noopener noreferrer">example.com</a>&quot; é‚®ä»¶çš„æœåŠ¡å™¨ä¿¡æ¯ã€‚</p><h3 id="äº‹ä»¶ç›‘å¬" tabindex="-1"><a class="header-anchor" href="#äº‹ä»¶ç›‘å¬"><span>äº‹ä»¶ç›‘å¬</span></a></h3><p><code>dns.Resolver</code> ç±»è¿˜æ”¯æŒäº‹ä»¶ç›‘å¬ï¼Œåƒä»»ä½•å…¶ä»–çš„ Node.js äº‹ä»¶å‘å°„å™¨ä¸€æ ·ã€‚ä½ å¯ä»¥ç›‘å¬ <code>resolve</code> äº‹ä»¶ï¼Œå½“ DNS æŸ¥è¯¢å®Œæˆæ—¶è·å–é€šçŸ¥ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;resolve&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">rrtype</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">ttl</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">cname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    `åœ°å€: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">address</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, ç±»å‹: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">rrtype</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, TTL: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ttl</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, CNAME: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">cname</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ³¨æ„äº‹é¡¹" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>å¼‚æ­¥æ“ä½œï¼šè¿™äº› DNS æŸ¥è¯¢éƒ½æ˜¯å¼‚æ­¥è¿›è¡Œçš„ï¼Œæ‰€ä»¥å®ƒä»¬ä¸ä¼šé˜»å¡ä½ çš„ç¨‹åºå…¶ä»–éƒ¨åˆ†çš„æ‰§è¡Œã€‚</li><li>é”™è¯¯å¤„ç†ï¼šæ³¨æ„æ£€æŸ¥å’Œå¤„ç†å›è°ƒä¸­å¯èƒ½å‡ºç°çš„é”™è¯¯ï¼ˆä¾‹å¦‚ï¼Œå½“åŸŸåä¸å­˜åœ¨æ—¶ï¼‰ã€‚</li></ul><p>ä»¥ä¸Šå°±æ˜¯ <code>dns.Resolver</code> ç±»çš„ä¸€ä¸ªåŸºç¡€ä»‹ç»ï¼Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥æ„å»ºæ›´å¤æ‚çš„ç½‘ç»œæœåŠ¡æˆ–åº”ç”¨ç¨‹åºï¼Œè¿™äº›æœåŠ¡æˆ–åº”ç”¨éœ€è¦è¿›è¡Œé«˜çº§çš„ DNS æ“ä½œæˆ–è€…è‡ªå®šä¹‰ DNS æŸ¥è¯¢é€»è¾‘ã€‚</p><h3 id="resolver-options" tabindex="-1"><a class="header-anchor" href="#resolver-options"><span><a href="https://nodejs.org/docs/latest/api/dns.html#resolveroptions" target="_blank" rel="noopener noreferrer">Resolver([options])</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>dns</code>è¿™ä¸ªæ ¸å¿ƒæ¨¡å—æä¾›äº†å¾ˆå¤šä¸åŸŸåè§£æç›¸å…³çš„å‡½æ•°ã€‚<code>Resolver</code>æ˜¯<code>dns</code>æ¨¡å—å†…ä¸€ä¸ªå¯ä»¥è®©ä½ æ›´çµæ´»åœ°æ§åˆ¶åŸŸåè§£æçš„ç±»ã€‚</p><p>å½“ä½ åˆ›å»ºä¸€ä¸ª<code>Resolver</code>çš„å®ä¾‹æ—¶ï¼Œå¯ä»¥é€šè¿‡ä¼ é€’ä¸€äº›é€‰é¡¹æ¥å®šåˆ¶è¿™ä¸ªè§£æå™¨çš„è¡Œä¸ºã€‚ä¸‹é¢æˆ‘ä¼šè§£é‡Š<code>Resolver</code>ä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒï¼Œå¹¶é€šè¿‡ä¸¾ä¾‹æ¥å¸®åŠ©ä½ ç†è§£ã€‚</p><h3 id="åˆ›å»ºä¸€ä¸ª-resolver-å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºä¸€ä¸ª-resolver-å®ä¾‹"><span>åˆ›å»ºä¸€ä¸ª Resolver å®ä¾‹</span></a></h3><p>é¦–å…ˆï¼Œä½ éœ€è¦åŒ…å« Node.js çš„<code>dns</code>æ¨¡å—ï¼Œå¹¶åˆ›å»ºä¸€ä¸ª<code>Resolver</code>çš„æ–°å®ä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> resolver</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ª<code>resolver</code>å¯¹è±¡å°±æ˜¯ä¸€ä¸ªæ–°çš„è§£æå™¨å®ä¾‹ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥è¿›è¡Œè‡ªå®šä¹‰çš„åŸŸåè§£ææ“ä½œã€‚</p><h3 id="ä½¿ç”¨-options-å‚æ•°" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-options-å‚æ•°"><span>ä½¿ç”¨ options å‚æ•°</span></a></h3><p>åœ¨åˆ›å»º<code>Resolver</code>å®ä¾‹æ—¶ï¼Œä½ å¯ä»¥ä¼ é€’ä¸€ä¸ª<code>options</code>å¯¹è±¡æ¥é…ç½®è§£æå™¨ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥è®¾ç½®è¶…æ—¶æ—¶é—´ï¼ŒæŒ‡å®šä½¿ç”¨çš„ DNS æœåŠ¡å™¨ç­‰ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„é€‰é¡¹ï¼š</p><ul><li><code>timeout</code>: æŒ‡å®šè§£æè¯·æ±‚çš„è¶…æ—¶æ—¶é—´ï¼ˆä»¥æ¯«ç§’è®¡ï¼‰ã€‚</li><li><code>servers</code>: æŒ‡å®šä¸€ç»„è¦ä½¿ç”¨çš„ DNS æœåŠ¡å™¨çš„ IP åœ°å€ã€‚</li></ul><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªé…ç½®äº†è¶…æ—¶æ—¶é—´å’Œç‰¹å®š DNS æœåŠ¡å™¨çš„è§£æå™¨ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> resolver</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¶…æ—¶æ—¶é—´è®¾å®šä¸º1000æ¯«ç§’</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  servers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;8.8.8.8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;8.8.4.4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨Googleçš„å…¬å…±DNSæœåŠ¡å™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ï¼Œå½“ä½ ä½¿ç”¨è¿™ä¸ª<code>resolver</code>å®ä¾‹å»è§£æåŸŸåæ—¶ï¼Œå¦‚æœ 1 ç§’å†…æ²¡æœ‰å“åº”ï¼Œå°±ä¼šè¶…æ—¶ï¼›è€Œä¸”è§£æå™¨ä¼šé€šè¿‡æŒ‡å®šçš„ Google DNS æœåŠ¡å™¨å»æŸ¥æ‰¾åŸŸåå¯¹åº”çš„ IP åœ°å€ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>æ¯”å¦‚ï¼Œç°åœ¨ä½ æƒ³æŸ¥æ‰¾<code>example.com</code>è¿™ä¸ªåŸŸåå¯¹åº”çš„ IP åœ°å€ã€‚ä½ å¯ä»¥ä½¿ç”¨<code>resolver</code>å®ä¾‹æä¾›çš„<code>resolve4</code>æ–¹æ³•ï¼Œå®ƒä¸“é—¨ç”¨äºè§£æ IPv4 åœ°å€ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;IPv4åœ°å€:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>resolve4</code>æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªæ˜¯éœ€è¦è§£æçš„åŸŸåï¼Œç¬¬äºŒä¸ªæ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚å½“åŸŸåè¢«è§£æä¹‹åï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°ä¼šè¢«è°ƒç”¨ï¼Œ<code>addresses</code>å˜é‡å°†åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæ‰¾åˆ°çš„ IPv4 åœ°å€ã€‚</p><p>å‡å¦‚ä½ éœ€è¦è§£æçš„ä¸ä»…ä»…æ˜¯ IPv4 åœ°å€ï¼Œè¿˜æœ‰åˆ«çš„è®°å½•ç±»å‹ï¼Œæ¯”å¦‚ MX è®°å½•ï¼ˆé‚®ä»¶äº¤æ¢è®°å½•ï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>resolver.resolve</code>æ–¹æ³•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;MX&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;MXè®°å½•:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç”¨<code>&#39;MX&#39;</code>ä½œä¸º<code>resolve</code>æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ„å‘³ç€æˆ‘ä»¬æƒ³è¦å¾—åˆ°<code>example.com</code>çš„ MX è®°å½•ã€‚åŒæ ·ï¼Œç»“æœä¼šåœ¨å›è°ƒå‡½æ•°ä¸­è¿”å›ã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼Œ<code>Resolver</code>ç±»æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥ç”¨äºæ‰§è¡Œè‡ªå®šä¹‰é…ç½®çš„åŸŸåè§£æã€‚ä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚ï¼Œè®¾ç½®è¶…æ—¶ã€DNS æœåŠ¡å™¨ç­‰é€‰é¡¹ï¼Œç„¶ååˆ©ç”¨å…¶æä¾›çš„å„ç§æ–¹æ³•æ¥æŸ¥è¯¢ä¸åŒç±»å‹çš„ DNS è®°å½•ã€‚</p><h3 id="resolver-cancel" tabindex="-1"><a class="header-anchor" href="#resolver-cancel"><span><a href="https://nodejs.org/docs/latest/api/dns.html#resolvercancel" target="_blank" rel="noopener noreferrer">resolver.cancel()</a></span></a></h3><p>å¥½çš„ï¼Œæ¥è¯¦ç»†äº†è§£ä¸€ä¸‹ Node.js ä¸­ <code>resolver.cancel()</code> å‡½æ•°ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>dns</code> æ¨¡å—æ˜¯ç”¨äºè¿›è¡Œç½‘ç»œè¯·æ±‚ä¸­ä¸åŸŸåç³»ç»Ÿï¼ˆDNSï¼‰äº¤äº’çš„æ¨¡å—ã€‚è¿™ä¸ªæ¨¡å—ä¸­æœ‰ä¸€ä¸ª <code>Resolver</code> ç±»ï¼Œå®ƒæä¾›äº†è‡ªå®šä¹‰çš„ DNS è§£ææ–¹æ³•ã€‚å½“ä½ ä½¿ç”¨ <code>Resolver</code> å®ä¾‹å‘èµ·ä¸€ä¸ª DNS è§£æè¯·æ±‚æ—¶ï¼Œå¯èƒ½ä¼šéœ€è¦åœ¨æŸäº›æƒ…å†µä¸‹å–æ¶ˆè¿™ä¸ªæ­£åœ¨è¿›è¡Œçš„è¯·æ±‚ã€‚è¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨ <code>resolver.cancel()</code> æ–¹æ³•ã€‚</p><p><code>resolver.cancel()</code> æ–¹æ³•æ˜¯è¿™æ ·å·¥ä½œçš„ï¼šå®ƒå–æ¶ˆ <code>Resolver</code> å®ä¾‹ä¸Šæ‰€æœ‰æ­£åœ¨è¿›è¡Œçš„ DNS è¯·æ±‚ã€‚å¦‚æœæœ‰ä»»ä½•è¯·æ±‚è¢«å–æ¶ˆäº†ï¼Œå®ƒä»¬å¯¹åº”çš„å›è°ƒå‡½æ•°å°†ä¼šä»¥é”™è¯¯ <code>ECANCELLED</code> è¢«è°ƒç”¨ã€‚</p><p>ä¸¾ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸€ä¸ªåŠŸèƒ½æ˜¯æŸ¥æ‰¾ç”¨æˆ·è¾“å…¥çš„åŸŸåå¯¹åº”çš„ IP åœ°å€ã€‚å½“ç”¨æˆ·è¾“å…¥ä¸€ä¸ªåŸŸåå¹¶ç‚¹å‡»â€œæŸ¥æ‰¾â€æŒ‰é’®æ—¶ï¼Œä½ çš„åº”ç”¨å°†ä½¿ç”¨ <code>dns.Resolver</code> æ¥è§£æè¿™ä¸ªåŸŸåã€‚ä½†æ˜¯ï¼Œå¦‚æœç”¨æˆ·åœ¨è§£æå®Œæˆå‰æ”¹å˜äº†ä¸»æ„ï¼Œå¹¶ç‚¹å‡»äº†ä¸€ä¸ªâ€œå–æ¶ˆâ€æŒ‰é’®ï¼Œä½ çš„åº”ç”¨åº”è¯¥èƒ½å¤Ÿç«‹åˆ»åœæ­¢ç­‰å¾… DNS å“åº”ï¼Œè€Œä¸æ˜¯æ— è°“åœ°ç­‰å¾…ä¸€ä¸ªå·²ç»ä¸å†éœ€è¦çš„ç»“æœã€‚è¿™æ—¶å€™ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨ <code>resolver.cancel()</code> æ–¹æ³•æ¥å–æ¶ˆä¹‹å‰çš„ DNS è§£æè¯·æ±‚ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€åŒ–ç‰ˆçš„ Node.js ä»£ç ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> resolver</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”¨æˆ·å‘èµ· DNS è§£æè¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;IPåœ°å€:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨å¦ä¸€ä¸ªäº‹ä»¶ä¸­ï¼Œæ¯”å¦‚ç”¨æˆ·ç‚¹å‡»å–æ¶ˆæŒ‰é’®</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯ä»¥å–æ¶ˆä¸Šé¢çš„ DNS è§£æè¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">cancel</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† <code>dns</code> æ¨¡å—ï¼Œå¹¶åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ <code>Resolver</code> å®ä¾‹ã€‚ç„¶åæˆ‘ä»¬è°ƒç”¨ <code>resolver.resolve4()</code> æ–¹æ³•æ¥å¼‚æ­¥åœ°è§£æ &#39;<a href="http://example.com" target="_blank" rel="noopener noreferrer">example.com</a>&#39; è¿™ä¸ªåŸŸåçš„ IPv4 åœ°å€ã€‚å¦‚æœç”¨æˆ·åœ¨å›è°ƒæ‰§è¡Œä¹‹å‰å–æ¶ˆäº†æ“ä½œï¼Œæˆ‘ä»¬åˆ™è°ƒç”¨ <code>resolver.cancel()</code> æ–¹æ³•ï¼Œè¿™å°†å¯¼è‡´ä¸Šè¿°çš„ DNS è¯·æ±‚è¢«å–æ¶ˆï¼Œå¹¶ä¸”å›è°ƒå‡½æ•°ä¼šæ¥æ”¶åˆ°ä¸€ä¸ªé”™è¯¯å‚æ•°è¡¨æ˜è¯·æ±‚è¢«å–æ¶ˆäº†ã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œ<code>resolver.cancel()</code> æ˜¯ä¸€ä¸ªç”¨äºä¸­æ­¢æ‰€æœ‰æŒ‚èµ·çš„ DNS æŸ¥è¯¢çš„å®ç”¨æ–¹æ³•ï¼Œå®ƒå¢åŠ äº† Node.js åº”ç”¨ç¨‹åºå¤„ç† DNS è¯·æ±‚çš„çµæ´»æ€§å’Œå“åº”ç”¨æˆ·æ“ä½œçš„èƒ½åŠ›ã€‚</p><h3 id="resolver-setlocaladdress-ipv4-ipv6" tabindex="-1"><a class="header-anchor" href="#resolver-setlocaladdress-ipv4-ipv6"><span><a href="https://nodejs.org/docs/latest/api/dns.html#resolversetlocaladdressipv4-ipv6" target="_blank" rel="noopener noreferrer">resolver.setLocalAddress([ipv4][, ipv6])</a></span></a></h3><p><code>resolver.setLocalAddress([ipv4][, ipv6])</code> æ˜¯ Node.js ä¸­çš„ DNS è§£æå™¨ï¼ˆresolverï¼‰é…ç½®çš„ä¸€ä¸ªæ–¹æ³•ã€‚DNS è§£æå™¨ç”¨äºå¸®åŠ©å°†äººç±»å¯è¯»çš„åŸŸåï¼ˆå¦‚ <code>www.example.com</code>ï¼‰è½¬æ¢æˆæœºå™¨å¯ä»¥ç†è§£å’Œè·¯ç”±çš„ IP åœ°å€ï¼ˆå¦‚ <code>192.0.2.1</code>ï¼‰ã€‚è¿™ä¸ªè½¬æ¢è¿‡ç¨‹ç§°ä¸º DNS æŸ¥æ‰¾æˆ–è€… DNS è§£æã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œä½ æœ‰å¯èƒ½æƒ³è‡ªå®šä¹‰ä½ çš„ DNS è§£æå™¨æ¥è¿›è¡Œç‰¹å®šçš„ç½‘ç»œè¯·æ±‚ï¼Œè€Œ <code>resolver.setLocalAddress</code> å…è®¸ä½ ä¸ºè¿™äº› DNS è¯·æ±‚æŒ‡å®šæœ¬åœ°æ¥æº IP åœ°å€ã€‚è¿™å°±æ„å‘³ç€å½“ DNS è§£æå™¨å°è¯•è§£æä¸€ä¸ªåŸŸåæ—¶ï¼Œå®ƒä¼šä»æŒ‡å®šçš„æœ¬åœ° IP åœ°å€å‘å‡ºè¯·æ±‚ã€‚</p><p>ç°åœ¨æˆ‘ä¼šé€šè¿‡å‡ ä¸ªä¾‹å­æ¥è§£é‡Šè¿™ä¸ªæ–¹æ³•çš„ä½œç”¨ï¼š</p><h3 id="é»˜è®¤è¡Œä¸º" tabindex="-1"><a class="header-anchor" href="#é»˜è®¤è¡Œä¸º"><span>é»˜è®¤è¡Œä¸º</span></a></h3><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œå½“ä½ çš„ç¨‹åºéœ€è¦è¿æ¥åˆ°äº’è”ç½‘ä¸Šçš„ä¸€ä¸ªæœåŠ¡æ—¶ï¼Œä¾‹å¦‚åŠ è½½ä¸€ä¸ªç½‘é¡µï¼Œå®ƒé¦–å…ˆéœ€è¦æ‰¾åˆ°é‚£ä¸ªç½‘é¡µæ‰€å¯¹åº”æœåŠ¡å™¨çš„ IP åœ°å€ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯è‡ªåŠ¨å®Œæˆçš„ï¼Œå¹¶ä½¿ç”¨äº†ç³»ç»Ÿé»˜è®¤çš„ç½‘ç»œæ¥å£ï¼ˆæ¯”å¦‚ä½ çš„ç”µè„‘è¿æ¥çš„ Wi-Fi æˆ–è€…æœ‰çº¿ç½‘ç»œï¼‰çš„ IP åœ°å€ã€‚</p><h3 id="ä½¿ç”¨-resolver-setlocaladdress" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-resolver-setlocaladdress"><span>ä½¿ç”¨ <code>resolver.setLocalAddress</code></span></a></h3><p>å‡è®¾ä½ æœ‰å¤šä¸ªç½‘ç»œæ¥å£ï¼Œæ¯”å¦‚ä¸¤å¼ ç½‘ç»œå¡ï¼Œä¸€å¼ è¿æ¥äº†å…¬å¸ç½‘ç»œï¼Œå¦ä¸€å¼ è¿æ¥äº†å®¶åº­ç½‘ç»œï¼Œä¸”æ¯å¼ å¡éƒ½æœ‰è‡ªå·±çš„ IP åœ°å€ã€‚å¦‚æœä½ æƒ³è®©ä½ çš„ç¨‹åºä¸é€šè¿‡é»˜è®¤çš„ç½‘ç»œæ¥å£è¿›è¡Œ DNS æŸ¥è¯¢ï¼Œè€Œæ˜¯æŒ‡å®šä½¿ç”¨å®¶åº­ç½‘ç»œçš„æ¥å£ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>resolver.setLocalAddress</code> æ¥è®¾ç½®å‘é€ DNS æŸ¥è¯¢çš„æº IP åœ°å€ã€‚</p><h4 id="ç¤ºä¾‹ä»£ç " tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç "><span>ç¤ºä¾‹ä»£ç </span></a></h4><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå¦‚ä½•ä½¿ç”¨ <code>resolver.setLocalAddress</code> çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> resolver</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ å®¶åº­ç½‘ç»œçš„ IPv4 åœ°å€æ˜¯ &#39;192.168.1.5&#39;ï¼ŒIPv6 åœ°å€æ˜¯ &#39;fe80::1ff:fe23:4567:890a&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setLocalAddress</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;192.168.1.5&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fe80::1ff:fe23:4567:890a&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨è¿›è¡Œ DNS æŸ¥è¯¢æ—¶ï¼Œå°†ä¼šä½¿ç”¨ä¸Šé¢è®¾ç½®çš„æœ¬åœ°åœ°å€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`IP åœ°å€: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ³¨æ„äº‹é¡¹-1" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-1"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>å½“ä½ è°ƒç”¨ <code>setLocalAddress</code> æ–¹æ³•æ—¶ï¼Œä½ å¯ä»¥é€‰æ‹©åªä¼ é€’ IPv4 åœ°å€ï¼Œæˆ–è€…åŒæ—¶ä¼ å…¥ IPv4 å’Œ IPv6 åœ°å€ã€‚</li><li>ä½ å¿…é¡»ä¿è¯ä½ ä¼ å…¥çš„ IP åœ°å€æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”ä½ çš„è®¾å¤‡å·²ç»é…ç½®äº†è¯¥åœ°å€ã€‚</li><li>å¦‚æœæ²¡æœ‰è°ƒç”¨ <code>setLocalAddress</code> æ–¹æ³•ï¼ŒDNS æŸ¥è¯¢å°†ä¼šä½¿ç”¨ç³»ç»Ÿé»˜è®¤åˆ†é…çš„ IP åœ°å€ã€‚</li></ul><p>è®°ä½ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ™®é€šç”¨æˆ·å’Œå¼€å‘è€…ä¸éœ€è¦æ‰‹åŠ¨è®¾ç½®æœ¬åœ°åœ°å€ã€‚è¿™ä¸ªåŠŸèƒ½ä¸»è¦ç”¨äºç‰¹æ®Šåœºæ™¯ï¼Œæ¯”å¦‚åœ¨å…·æœ‰å¤æ‚ç½‘ç»œé…ç½®çš„ä¼ä¸šç¯å¢ƒä¸­ï¼Œæˆ–è€…åœ¨éœ€è¦ç»†ç²’åº¦æ§åˆ¶ç½‘ç»œæµé‡æºå¤´çš„æ—¶å€™ã€‚</p><h2 id="dns-getservers" tabindex="-1"><a class="header-anchor" href="#dns-getservers"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnsgetservers" target="_blank" rel="noopener noreferrer">dns.getServers()</a></span></a></h2><p>å½“ä½ ä¸Šç½‘æµè§ˆç½‘ç«™æ—¶ï¼Œå¦‚è®¿é—®<code>www.google.com</code>ï¼Œä½ çš„ç”µè„‘éœ€è¦çŸ¥é“è¿™ä¸ªç½‘å€å¯¹åº”çš„ IP åœ°å€æ‰èƒ½æ‰¾åˆ°å¹¶è¿æ¥åˆ°è°·æ­Œçš„æœåŠ¡å™¨ã€‚DNSï¼ˆåŸŸåç³»ç»Ÿï¼‰å°±æ˜¯å¸®åŠ©ä½ çš„ç”µè„‘æ‰¾åˆ°æ­£ç¡® IP åœ°å€çš„æœåŠ¡ã€‚æ¯”å¦‚è¯´ï¼Œä½ å‘Šè¯‰ä½ çš„æœ‹å‹è¦å»â€œå›¾ä¹¦é¦†â€è€Œä¸æ˜¯ç»™ä»–ä¸€ä¸ªå…·ä½“çš„åœ°å€ï¼Œä½ çš„æœ‹å‹é€šè¿‡æŸ¥è¯¢åœ°å›¾ï¼Œç›¸å½“äº DNS æœåŠ¡å™¨ï¼Œæ¥æ‰¾åˆ°å›¾ä¹¦é¦†çš„å‡†ç¡®ä½ç½®ã€‚</p><p>Node.js ä¸­çš„<code>dns.getServers()</code>æ–¹æ³•å…è®¸ä½ æŸ¥çœ‹å½“å‰ç”¨äºæ­¤ç±»è½¬æ¢çš„ DNS æœåŠ¡å™¨åˆ—è¡¨ã€‚è¿™ä¸ªåŠŸèƒ½åœ¨ä½ éœ€è¦äº†è§£æˆ–è€…è°ƒè¯•ç½‘ç»œåº”ç”¨ç¨‹åºå¤„ç† DNS æŸ¥è¯¢çš„æ–¹å¼æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœä½ å†™äº†ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”ç”¨æˆ·æŠ¥å‘Šäº†ä¸€äº›å…³äºåŸŸåè§£æçš„é—®é¢˜ï¼Œä½ å¯èƒ½ä¼šæƒ³è¦æ£€æŸ¥ä¸€ä¸‹åº”ç”¨ç¨‹åºæ­£åœ¨ä½¿ç”¨å“ªäº› DNS æœåŠ¡å™¨ã€‚é‚£ä¹ˆï¼Œä½ å¯ä»¥ä½¿ç”¨<code>dns.getServers()</code>æ¥è·å–å’Œæ‰“å°å‡ºå½“å‰é…ç½®çš„ DNS æœåŠ¡å™¨åˆ—è¡¨ã€‚</p><p>è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><p>å‡è®¾ä½ åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œå®ƒéœ€è¦ä»ä¸€ä¸ª API è·å–æ•°æ®ã€‚è¯¥ API ä½äº<code>api.example.com</code>ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶å€™ä½ æ³¨æ„åˆ°è¯·æ±‚å¤±è´¥ï¼Œå› ä¸º<code>api.example.com</code>æ— æ³•è§£æã€‚ä½ æ€€ç–‘å¯èƒ½æ˜¯ DNS æœåŠ¡å™¨çš„é—®é¢˜ï¼Œæ‰€ä»¥ä½ å†³å®šæ‰“å°å‡ºå½“å‰ä½¿ç”¨çš„ DNS æœåŠ¡å™¨åˆ—è¡¨ã€‚</p><p>ä½ å¯ä»¥ç¼–å†™å¦‚ä¸‹çš„ Node.js ä»£ç ç‰‡æ®µï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–å¹¶ä¸”æ‰“å°å‡ºå½“å‰é…ç½®çš„DNSæœåŠ¡å™¨åˆ—è¡¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> servers</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å½“å‰é…ç½®çš„DNSæœåŠ¡å™¨åˆ—è¡¨:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">servers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œè¿™æ®µä»£ç åï¼Œä½ å°†çœ‹åˆ°è¾“å‡ºç±»ä¼¼äºä»¥ä¸‹å†…å®¹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>å½“å‰é…ç½®çš„DNSæœåŠ¡å™¨åˆ—è¡¨: [ &#39;8.8.8.8&#39;, &#39;8.8.4.4&#39; ]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™ä¸ªç»“æœè¡¨æ˜ä½ çš„ Node.js åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ˜¯ Google æä¾›çš„å…¬å…± DNS æœåŠ¡å™¨ï¼ˆIP åœ°å€åˆ†åˆ«æ˜¯ 8.8.8.8 å’Œ 8.8.4.4ï¼‰ã€‚å¦‚æœä½ å‘ç°è¿™äº›æœåŠ¡å™¨ä¸æ˜¯æœŸæœ›çš„ï¼Œæˆ–è€…ä½ éœ€è¦æ›¿æ¢å®ƒä»¬è¿›è¡Œæµ‹è¯•ï¼Œä½ å¯èƒ½éœ€è¦è¿›å…¥ä½ çš„ç½‘ç»œè®¾ç½®æˆ–è€…è”ç³»ä½ çš„ç½‘ç»œç®¡ç†å‘˜æ¥æ›´æ”¹ DNS æœåŠ¡å™¨é…ç½®ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>dns.getServers()</code>æ˜¯ Node.js ä¸­ç”¨äºè·å–å½“å‰ä½¿ç”¨çš„ DNS æœåŠ¡å™¨åˆ—è¡¨çš„ç®€å•è€Œå®ç”¨çš„æ–¹æ³•ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ è°ƒè¯•ç½‘ç»œé—®é¢˜æˆ–éªŒè¯ä½ çš„åº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†æ­£ç¡®çš„ DNS æœåŠ¡ã€‚</p><h2 id="dns-lookup-hostname-options-callback" tabindex="-1"><a class="header-anchor" href="#dns-lookup-hostname-options-callback"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnslookuphostname-options-callback" target="_blank" rel="noopener noreferrer">dns.lookup(hostname[, options], callback)</a></span></a></h2><p>å½“ç„¶ï¼Œæˆ‘å¾ˆä¹æ„å¸®åŠ©ä½ ç†è§£ Node.js ä¸­çš„<code>dns.lookup</code>å‡½æ•°ã€‚</p><p>DNSï¼ˆåŸŸåç³»ç»Ÿï¼‰æ˜¯äº’è”ç½‘ä¸Šç”¨äºå°†äººç±»å‹å¥½çš„åŸŸåè½¬æ¢æˆ IP åœ°å€çš„ç³»ç»Ÿï¼Œè¿™æ ·è®¡ç®—æœºæ‰èƒ½å¤Ÿå®šä½å’Œè®¿é—®è¿™äº›åŸŸåæ‰€æŒ‡å‘çš„æœåŠ¡å™¨ã€‚ä¾‹å¦‚ï¼Œå½“ä½ åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ <code>www.google.com</code> å¹¶æŒ‰å›è½¦æ—¶ï¼Œä½ çš„è®¡ç®—æœºä¼šä½¿ç”¨ DNS æ¥æ‰¾å‡ºå¯¹åº”çš„ IP åœ°å€ï¼Œç„¶åé€šè¿‡è¯¥ IP åœ°å€ä¸ Google æœåŠ¡å™¨å»ºç«‹è¿æ¥ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>dns.lookup</code> å‡½æ•°æ˜¯ç”¨æ¥æ‰§è¡Œè¿™ä¸ªè½¬æ¢è¿‡ç¨‹çš„ä¸€ç§æ–¹æ³•ã€‚ç°åœ¨æˆ‘ä»¬æ¥é€æ­¥è§£é‡Šå¹¶ä¸¾ä¾‹è¿™ä¸ªå‡½æ•°æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><h3 id="dns-lookup-hostname-options-callback-1" tabindex="-1"><a class="header-anchor" href="#dns-lookup-hostname-options-callback-1"><span>dns.lookup(hostname[, options], callback)</span></a></h3><p>è¿™æ˜¯<code>dns.lookup</code>å‡½æ•°çš„åŸºæœ¬è¯­æ³•ã€‚</p><ul><li><code>hostname</code>ï¼šè¿™æ˜¯ä½ æƒ³è¦æŸ¥è¯¢çš„åŸŸåï¼Œæ¯”å¦‚ <code>&#39;www.google.com&#39;</code>ã€‚</li><li><code>options</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå¯ä»¥ç”¨æ¥æŒ‡å®šå¦‚ä½•è¿›è¡ŒæŸ¥æ‰¾ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥é€‰æ‹© IPv4 (<code>family: 4</code>)æˆ– IPv6 (<code>family: 6</code>) åœ°å€ï¼Œæˆ–è€…ä¸¤è€…éƒ½æŸ¥è¯¢ã€‚</li><li><code>callback</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå½“æŸ¥æ‰¾å®Œæˆæ—¶è¢« Node.js è°ƒç”¨çš„å‡½æ•°ã€‚å®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼š<code>err</code> å’Œ <code>address</code>ã€‚å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œ<code>err</code> ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼›å¦åˆ™ï¼Œ<code>address</code> å°†åŒ…å«è¯·æ±‚çš„ IP åœ°å€ã€‚</li></ul><h4 id="å®é™…è¿ç”¨çš„ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­"><span>å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</span></a></h4><p>å‡è®¾æˆ‘ä»¬æƒ³è¦æŸ¥è¯¢&quot;<a href="http://www.google.com" target="_blank" rel="noopener noreferrer">www.google.com</a>&quot;çš„IPåœ°å€ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„Node.jsè„šæœ¬ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¦æŸ¥è¯¢çš„åŸŸå</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hostname</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;www.google.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨dns.lookupå‡½æ•°æŸ¥è¯¢åŸŸåçš„IPåœ°å€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">family</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯å¹¶é€€å‡ºå‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ‰“å°å‡ºè·å–çš„IPåœ°å€å’Œåœ°å€å®¶æ—ï¼ˆIPv4 æˆ– IPv6ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`åœ°å€: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">address</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, åœ°å€æ—: IPv</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">family</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œä¸Šé¢çš„è„šæœ¬ï¼ˆä¿å­˜ä¸º.js æ–‡ä»¶ï¼Œå¹¶åœ¨å‘½ä»¤è¡Œç”¨ Node.js è¿è¡Œï¼‰ï¼Œå°†ä¼šè¾“å‡ºç±»ä¼¼ä¸‹é¢çš„ç»“æœï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>åœ°å€: 172.217.14.196, åœ°å€æ—: IPv4</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ç»“æœè¡¨æ˜ï¼Œ&quot;<a href="http://www.google.com" target="_blank" rel="noopener noreferrer">www.google.com</a>&quot; å¯¹åº”çš„ IPv4 åœ°å€æ˜¯ <code>172.217.14.196</code>ã€‚</p><p>è¯·æ³¨æ„ï¼Œ<code>dns.lookup()</code>å‡½æ•°åœ¨å†…éƒ¨ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„ DNS è§£æå™¨ï¼Œè¿™æ„å‘³ç€å®ƒçš„è¡Œä¸ºå¯èƒ½ä¼šæ ¹æ®ä½ çš„æ“ä½œç³»ç»Ÿå’Œé…ç½®æœ‰æ‰€ä¸åŒã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæœ‰äº›å¼€å‘äººå‘˜å¯èƒ½ä¼šä½¿ç”¨<code>dns.resolve</code>ç³»åˆ—å‡½æ•°ï¼Œå› ä¸ºå®ƒä»¬èƒ½æä¾›æ›´ä¸€è‡´çš„ç½‘ç»œå±‚ä¸Šçš„ DNS æŸ¥è¯¢ã€‚</p><p>ä½†å¯¹äºå¤§å¤šæ•°åŸºæœ¬åº”ç”¨ï¼Œ<code>dns.lookup</code> æä¾›äº†ä¸€ç§å¿«é€Ÿæ–¹ä¾¿çš„æ–¹å¼æ¥æ‰§è¡Œ DNS æŸ¥è¯¢å¹¶è·å–ä¸€ä¸ªåŸŸåçš„ IP åœ°å€ã€‚</p><h3 id="supported-getaddrinfo-flags" tabindex="-1"><a class="header-anchor" href="#supported-getaddrinfo-flags"><span><a href="https://nodejs.org/docs/latest/api/dns.html#supported-getaddrinfo-flags" target="_blank" rel="noopener noreferrer">Supported getaddrinfo flags</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ç¨‹åºã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰å¾ˆå¤šå†…ç½®æ¨¡å—ï¼Œå…¶ä¸­ <code>dns</code> æ¨¡å—å°±æ˜¯ç”¨æ¥è¿›è¡ŒåŸŸåè§£æçš„ã€‚</p><p>å½“ä½ åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ä¸€ä¸ªç½‘å€æ—¶ï¼Œæ¯”å¦‚ <code>www.example.com</code>ï¼Œä½ çš„è®¡ç®—æœºå®é™…ä¸Šå¹¶ä¸çŸ¥é“è¿™ä¸ªåœ°å€çš„ IP åœ°å€åœ¨å“ªé‡Œã€‚IP åœ°å€æ˜¯äº’è”ç½‘ä¸Šæ¯å°è®¡ç®—æœºçš„å”¯ä¸€æ ‡è¯†ã€‚å› æ­¤ï¼Œåœ¨èƒ½å¤Ÿè¿æ¥åˆ° <code>www.example.com</code> å¹¶ä»é‚£é‡Œè·å–ä¿¡æ¯ä¹‹å‰ï¼Œä½ çš„è®¡ç®—æœºéœ€è¦æ‰¾å‡ºå®ƒå¯¹åº”çš„ IP åœ°å€ã€‚è¿™ä¸ªæŸ¥æ‰¾è¿‡ç¨‹ç§°ä¸º &quot;åŸŸåè§£æ&quot;ï¼Œå®ƒé€šå¸¸ç”± DNSï¼ˆDomain Name Systemï¼‰æœåŠ¡å™¨å®Œæˆã€‚</p><p>åœ¨ Node.js çš„ <code>dns</code> æ¨¡å—ä¸­ï¼Œ<code>getaddrinfo</code> æ˜¯ä¸€ä¸ªåº•å±‚çš„å‡½æ•°ï¼Œç”¨äºæ‰§è¡Œè¿™ç§åŸŸåè§£æã€‚å®ƒæ”¯æŒä¸€ç³»åˆ—çš„ flagsï¼ˆæ ‡å¿—ï¼‰ï¼Œè¿™äº›æ ‡å¿—èƒ½å¤Ÿå½±å“åŸŸåè§£æçš„è¡Œä¸ºã€‚</p><p>åˆ°äº† Node.js v21.7.1 ç‰ˆæœ¬ï¼Œ<code>dns</code> æ¨¡å—æ”¯æŒä»¥ä¸‹ flagsï¼š</p><ol><li><p><code>AI_ADDRCONFIG</code>ï¼šè¿™ä¸ª flag ä¼šè€ƒè™‘ä¸»æœºçš„ç½‘ç»œé…ç½®ï¼Œåªè¿”å›ä¸é…ç½®ç›¸ç¬¦çš„åœ°å€ç±»å‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„ä¸»æœºæ²¡æœ‰é…ç½® IPv6 åœ°å€ï¼Œé‚£ä¹ˆä½¿ç”¨ <code>AI_ADDRCONFIG</code> å°±ä¸ä¼šè¿”å› IPv6 åœ°å€ã€‚</p></li><li><p><code>AI_ALL</code>ï¼šè¿™ä¸ª flag é€šå¸¸ä¸ <code>AI_V4MAPPED</code> ç»“åˆä½¿ç”¨ã€‚å¦‚æœæ²¡æœ‰å‘ç° IPv6 åœ°å€ï¼Œå®ƒä¼šè¯·æ±‚è¿”å›æ‰€æœ‰çš„ IPv4 å’Œ IPv6 åœ°å€ã€‚</p></li><li><p><code>AI_V4MAPPED</code>ï¼šå½“ä½¿ç”¨è¿™ä¸ª flag ä¸”æ— æ³•æ‰¾åˆ° IPv6 åœ°å€æ—¶ï¼Œå®ƒä¼šè¿”å›æ˜ å°„åˆ° IPv6 æ ¼å¼çš„ IPv4 åœ°å€ã€‚</p></li><li><p><code>AI_CANONNAME</code>ï¼šé™¤äº†è¿”å›åœ°å€ä¹‹å¤–ï¼Œè¿˜ä¼šè¿”å›è¯¥åœ°å€çš„è§„èŒƒåï¼ˆcanonical nameï¼‰ã€‚è§„èŒƒåæ˜¯ä¸€ä¸ªä¸»æœºçš„å®˜æ–¹åç§°ï¼Œå¯èƒ½å’Œä½ æœ€åˆç”¨æ¥æŸ¥è¯¢çš„åå­—ä¸åŒã€‚</p></li></ol><p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­ç†è§£ä¸€ä¸‹å¦‚ä½•åœ¨å®é™…ä¸­ä½¿ç”¨è¿™äº› flagsï¼š</p><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js ç¨‹åºï¼Œéœ€è¦è§£æä¸€ä¸ªåŸŸåçš„ IP åœ°å€ï¼Œå¹¶å¸Œæœ›ç¡®ä¿è¿”å›çš„æ˜¯è·Ÿä½ ç”µè„‘ç½‘ç»œé…ç½®ç›¸åŒ¹é…çš„åœ°å€ç±»å‹ï¼Œä½ å¯ä»¥åƒè¿™æ ·ä½¿ç”¨ <code>dns.lookup</code> å‡½æ•°å’Œ <code>AI_ADDRCONFIG</code> flagï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> options</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  family</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æŒ‡å®šä½¿ç”¨ IPv6</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  hints</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">ADDRCONFIG</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ AI_ADDRCONFIG flag</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è§£æ example.com çš„åœ°å€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">family</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è§£æå‡ºé”™:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åœ°å€:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åœ°å€ç±»å‹:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">family</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> ?</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;IPv4&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;IPv6&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šè¿°ä»£ç å°†å°è¯•è·å– <code>example.com</code> çš„ IPv6 åœ°å€ï¼Œä½†åªåœ¨ä½ çš„ç”µè„‘é…ç½®äº† IPv6 åœ°å€çš„æƒ…å†µä¸‹ã€‚å¦‚æœä½ çš„ç½‘ç»œåªæ”¯æŒ IPv4ï¼Œé‚£ä¹ˆ <code>AI_ADDRCONFIG</code> å°†æç¤º <code>dns.lookup</code> ä¸è¦è¿”å› IPv6 åœ°å€ï¼Œå³ä½¿ <code>family</code> è®¾ç½®ä¸º 6ã€‚</p><p>é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼ŒNode.js çš„ <code>dns</code> æ¨¡å—ç»™äº†å¼€å‘è€…çµæ´»çš„æ§åˆ¶æƒï¼Œå…è®¸ä»–ä»¬æ ¹æ®éœ€è¦é€‰æ‹©é€‚å½“çš„åŸŸåè§£æç­–ç•¥ã€‚</p><h2 id="dns-lookupservice-address-port-callback" tabindex="-1"><a class="header-anchor" href="#dns-lookupservice-address-port-callback"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnslookupserviceaddress-port-callback" target="_blank" rel="noopener noreferrer">dns.lookupService(address, port, callback)</a></span></a></h2><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥é€šä¿—æ˜“æ‡‚åœ°äº†è§£ä¸€ä¸‹ Node.js ä¸­çš„ <code>dns.lookupService(address, port, callback)</code> å‡½æ•°ã€‚</p><p>é¦–å…ˆï¼Œ<code>dns</code> æ˜¯ Node.js ä¸­ç”¨æ¥å¤„ç†ç½‘ç»œä¸­çš„åŸŸåç³»ç»Ÿï¼ˆDomain Name Systemï¼‰ç›¸å…³æ“ä½œçš„ä¸€ä¸ªæ¨¡å—ã€‚å®ƒèƒ½å¤ŸæŠŠäººç±»å¯è¯»çš„åŸŸåè½¬æ¢ä¸ºæœºå™¨å¯ä»¥ç†è§£çš„ IP åœ°å€ï¼ˆæ¯”å¦‚æŠŠ &quot;<a href="http://www.google.com" target="_blank" rel="noopener noreferrer">www.google.com</a>&quot; è½¬æ¢æˆ &quot;172.217.0.4&quot;ï¼‰ï¼Œæˆ–è€…æ‰§è¡Œå…¶ä»–ä¸åŸŸåå’Œç½‘ç»œåœ°å€ç›¸å…³çš„æŸ¥è¯¢ã€‚</p><p><code>dns.lookupService()</code> æ˜¯è¿™ä¸ªæ¨¡å—æä¾›çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºæŸ¥è¯¢æŸä¸ªç‰¹å®šçš„ IP åœ°å€å’Œç«¯å£å·å¯¹åº”çš„ä¸»æœºåï¼ˆhostnameï¼‰å’ŒæœåŠ¡åç§°ï¼ˆservice nameï¼‰ã€‚è¿™ä¸ªåŠŸèƒ½åœ¨ä½ éœ€è¦æ ¹æ®ç½‘ç»œä¸Šçš„åœ°å€ä¿¡æ¯åå‘æŸ¥æ‰¾é…ç½®æˆ–æœåŠ¡çš„æ—¶å€™å¾ˆæœ‰ç”¨ã€‚</p><p>è¿™ä¸ªå‡½æ•°æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼š</p><ol><li><code>address</code>: ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»£è¡¨è¦æŸ¥è¯¢çš„ IP åœ°å€ã€‚</li><li><code>port</code>: ä¸€ä¸ªæ•°å­—ï¼Œä»£è¡¨è¦æŸ¥è¯¢çš„ç«¯å£å·ã€‚</li><li><code>callback</code>: ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“æŸ¥è¯¢å®Œæˆåè¢«è°ƒç”¨ï¼Œå¸¦æœ‰ä¸¤ä¸ªå‚æ•°ï¼šé”™è¯¯ä¿¡æ¯å’Œç»“æœã€‚</li></ol><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæœåŠ¡å™¨è¿è¡Œåœ¨æœ¬åœ° IP åœ°å€ <code>127.0.0.1</code> ä¸Šçš„ <code>80</code> ç«¯å£ï¼ˆé€šå¸¸æ˜¯ HTTP æœåŠ¡ï¼‰ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“è¿™ä¸ªåœ°å€å’Œç«¯å£å¯¹åº”çš„æœåŠ¡ä¿¡æ¯ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬è¦æŸ¥è¯¢çš„IPåœ°å€å’Œç«¯å£å·</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> address</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;127.0.0.1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> port</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 80</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è°ƒç”¨ dns.lookupService è·å–æœåŠ¡ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookupService</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">port</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">service</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœæœ‰é”™è¯¯ï¼Œè¾“å‡ºé”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`The service running on </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">address</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">port</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> is:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Hostname: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, Service: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">service</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // è¾“å‡ºè·å–åˆ°çš„ä¸»æœºåå’ŒæœåŠ¡å</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œè¿™æ®µä»£ç ï¼Œå¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œæ§åˆ¶å°å¯èƒ½ä¼šæ‰“å°å‡ºç±»ä¼¼ä¸‹é¢çš„ä¿¡æ¯ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>The service running on 127.0.0.1:80 is:</span></span>
<span class="line"><span>Hostname: localhost, Service: http</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ„å‘³ç€åœ¨ <code>127.0.0.1</code> çš„ <code>80</code> ç«¯å£ä¸Šè¿è¡Œçš„æœåŠ¡æ‹¥æœ‰ä¸»æœºå <code>localhost</code>ï¼Œå¹¶ä¸”æ˜¯ä¸€ä¸ª <code>http</code> æœåŠ¡ï¼ˆä¹Ÿå°±æ˜¯ç½‘é¡µæœåŠ¡å™¨ï¼‰ã€‚</p><p>è¿™ä¸ªå‡½æ•°é€šå¸¸ç”¨äºç½‘ç»œè¯Šæ–­æˆ–é…ç½®ç¨‹åºä¸­ï¼Œå®ƒå…è®¸å¼€å‘è€…é€šè¿‡ IP åœ°å€å’Œç«¯å£äº†è§£æ­£åœ¨è¿è¡ŒæœåŠ¡çš„è¯¦ç»†ä¿¡æ¯ï¼Œæœ‰åŠ©äºè°ƒè¯•æˆ–è€…ç›‘æ§ç½‘ç»œçŠ¶å†µã€‚</p><h2 id="dns-resolve-hostname-rrtype-callback" tabindex="-1"><a class="header-anchor" href="#dns-resolve-hostname-rrtype-callback"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnsresolvehostname-rrtype-callback" target="_blank" rel="noopener noreferrer">dns.resolve(hostname[, rrtype], callback)</a></span></a></h2><p>Node.js ä¸­çš„ <code>dns.resolve()</code> æ–¹æ³•ç”¨äºå°†ä¸€ä¸ªåŸŸåï¼ˆå¦‚ &#39;<a href="http://example.com" target="_blank" rel="noopener noreferrer">example.com</a>&#39;ï¼‰è§£æä¸ºä¸åŒç±»å‹çš„è®°å½•ï¼Œè¿™äº›è®°å½•ä¸åŸŸåå¯¹åº”çš„æœåŠ¡å™¨æˆ–æœåŠ¡æœ‰å…³ã€‚<code>rrtype</code> å‚æ•°æŒ‡å®šäº†ä½ æƒ³è¦æŸ¥è¯¢çš„è®°å½•ç±»å‹ï¼Œæ¯”å¦‚ A è®°å½•ä»£è¡¨åœ°å€è®°å½•ï¼Œå¯ä»¥ç”¨æ¥å¯»æ‰¾åŸŸåå¯¹åº”çš„ IP åœ°å€ã€‚è€Œ <code>callback</code> æ˜¯ä¸€ä¸ªåœ¨è§£æç»“æŸæ—¶è¢«è°ƒç”¨çš„å‡½æ•°ã€‚</p><p>ä¸‹é¢æ˜¯ <code>dns.resolve()</code> æ–¹æ³•çš„å‚æ•°è¯¦è§£ï¼š</p><ol><li><p><code>hostname</code>: è¿™ä¸ªå‚æ•°æ˜¯ä½ æƒ³è¦æŸ¥è¯¢çš„åŸŸåå­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ &#39;<a href="http://google.com" target="_blank" rel="noopener noreferrer">google.com</a>&#39;ï¼‰ã€‚</p></li><li><p><code>[rrtype]</code>: è¯¥å¯é€‰å‚æ•°è¡¨ç¤ºè§£æçš„è®°å½•ç±»å‹ï¼Œé»˜è®¤ä¸º &#39;A&#39;ã€‚å¸¸è§çš„è®°å½•ç±»å‹åŒ…æ‹¬ï¼š</p><ul><li>&#39;A&#39;: IPv4 åœ°å€è®°å½•</li><li>&#39;AAAA&#39;: IPv6 åœ°å€è®°å½•</li><li>&#39;MX&#39;: é‚®ä»¶äº¤æ¢è®°å½•</li><li>&#39;TXT&#39;: æ–‡æœ¬è®°å½•</li><li>&#39;SRV&#39;: æœåŠ¡å®šä½è®°å½•</li><li>&#39;PTR&#39;: æŒ‡é’ˆè®°å½•</li><li>&#39;NS&#39;: åç§°æœåŠ¡å™¨è®°å½•</li><li>&#39;CNAME&#39;: è§„èŒƒåç§°è®°å½•</li><li>&#39;SOA&#39;: æˆæƒå¼€å§‹è®°å½•</li></ul></li><li><p><code>callback(err, addresses)</code>: å½“ DNS è§£æå®Œæˆæˆ–å‡ºé”™æ—¶ï¼Œä¼šè°ƒç”¨æ­¤å‡½æ•°ã€‚å®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼š</p><ul><li><code>err</code>: å¦‚æœè§£æè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œè¿™ä¸ªå‚æ•°ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼›å¦‚æœæ²¡æœ‰é”™è¯¯åˆ™ä¸º <code>null</code>ã€‚</li><li><code>addresses</code>: å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œè¿™ä¸ªå‚æ•°ä¼šåŒ…å«è§£æç»“æœï¼Œå…¶å…·ä½“æ ¼å¼å–å†³äºè¯·æ±‚çš„ <code>rrtype</code>ã€‚</li></ul></li></ol><p>è®©æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><h3 id="ç¤ºä¾‹-1-è§£æ-a-è®°å½•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-è§£æ-a-è®°å½•"><span>ç¤ºä¾‹ 1ï¼šè§£æ A è®°å½•</span></a></h3><p>ä»¥ä¸‹ä»£ç å°†è§£æ &#39;<a href="http://example.com" target="_blank" rel="noopener noreferrer">example.com</a>&#39; åŸŸåçš„ A è®°å½•ï¼Œå³æŸ¥æ‰¾å…¶ IPv4 åœ°å€ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;DNS è§£æå‡ºé”™:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A è®°å½•åœ°å€:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæˆåŠŸï¼Œ<code>addresses</code> å°†æ˜¯ä¸€ä¸ªåŒ…å« &#39;<a href="http://example.com" target="_blank" rel="noopener noreferrer">example.com</a>&#39; æ‰€æœ‰ IPv4 åœ°å€çš„æ•°ç»„ã€‚</p><h3 id="ç¤ºä¾‹-2-è§£æ-mx-è®°å½•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-è§£æ-mx-è®°å½•"><span>ç¤ºä¾‹ 2ï¼šè§£æ MX è®°å½•</span></a></h3><p>MX è®°å½•ç”¨äºç¡®å®šå‘é€åˆ°è¯¥åŸŸåçš„ç”µå­é‚®ä»¶åº”è¯¥è¢«ä¼ é€åˆ°å“ªé‡Œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;MX&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;DNS è§£æå‡ºé”™:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;MX è®°å½•:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæˆåŠŸï¼Œ<code>addresses</code> å°†æ˜¯ä¸€ä¸ªå¯¹è±¡æ•°ç»„ï¼Œæ¯ä¸ªå¯¹è±¡åŒ…å«é‚®ä»¶æœåŠ¡å™¨çš„ä¼˜å…ˆçº§å’Œåœ°å€ã€‚</p><h3 id="ç¤ºä¾‹-3-è§£æé»˜è®¤è®°å½•ç±»å‹-a-è®°å½•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-è§£æé»˜è®¤è®°å½•ç±»å‹-a-è®°å½•"><span>ç¤ºä¾‹ 3ï¼šè§£æé»˜è®¤è®°å½•ç±»å‹ï¼ˆA è®°å½•ï¼‰</span></a></h3><p>å¦‚æœä½ çœç•¥äº† <code>rrtype</code> å‚æ•°ï¼Œ<code>dns.resolve()</code> ä¼šé»˜è®¤è§£æ A è®°å½•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;DNS è§£æå‡ºé”™:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;é»˜è®¤ï¼ˆA è®°å½•ï¼‰åœ°å€:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨é»˜è®¤å‚æ•°è§£æå‡ºæ¥çš„ç»“æœè·Ÿç¤ºä¾‹ 1 ç›¸åŒã€‚</p><p>é€šè¿‡ä¸Šè¿°ç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>dns.resolve()</code> åœ¨ Node.js ç¨‹åºä¸­å¯ä»¥ç”¨æ¥è·å–å„ç§ DNS è®°å½•ä¿¡æ¯ï¼Œä»è€Œå¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£å’Œæ§åˆ¶ç½‘ç»œé€šä¿¡ï¼Œä»¥åŠå¤„ç†ä¸åŸŸåç›¸å…³çš„å„ç±»é—®é¢˜ã€‚</p><h2 id="dns-resolve4-hostname-options-callback" tabindex="-1"><a class="header-anchor" href="#dns-resolve4-hostname-options-callback"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnsresolve4hostname-options-callback" target="_blank" rel="noopener noreferrer">dns.resolve4(hostname[, options], callback)</a></span></a></h2><p>å½“ç„¶ï¼Œæˆ‘å¾ˆä¹æ„å¸®ä½ ç†è§£ Node.js ä¸­çš„<code>dns.resolve4</code>å‡½æ•°ã€‚</p><p>é¦–å…ˆï¼Œäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ DNSï¼šDNSï¼ˆåŸŸåç³»ç»Ÿï¼‰æ˜¯äº’è”ç½‘ä¸Šç”¨äºå°†åŸŸåè½¬æ¢ä¸º IP åœ°å€çš„æœåŠ¡ã€‚æ¯”å¦‚ï¼Œå½“ä½ åœ¨æµè§ˆå™¨ä¸­è¾“å…¥<code>www.example.com</code>æ—¶ï¼Œå®é™…ä¸Šæ˜¯é€šè¿‡ DNS æœåŠ¡æŸ¥æ‰¾åˆ°è¿™ä¸ªåŸŸåå¯¹åº”çš„ IP åœ°å€ï¼Œç„¶åæ‰èƒ½è®¿é—®åˆ°ç›¸åº”çš„æœåŠ¡å™¨ã€‚</p><p>ç°åœ¨æ¥çœ‹<code>dns.resolve4</code>è¿™ä¸ªå‡½æ•°ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>dns</code>æ¨¡å—åŒ…å«äº†ä¸€ç³»åˆ—ç”¨äºå¤„ç†åŸŸåè§£æçš„åŠŸèƒ½ã€‚<code>dns.resolve4</code>ä¸“é—¨ç”¨äºè§£æ IPv4 åœ°å€ã€‚å¦‚æœä½ æƒ³å¾—åˆ°ä¸€ä¸ªåŸŸåå¯¹åº”çš„ IPv4 åœ°å€ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p><p>å®ƒçš„åŸºæœ¬ç”¨æ³•æ˜¯ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// hostnameæ˜¯ä½ æƒ³è¦è§£æçš„åŸŸå</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`IP åœ°å€: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œæœ‰å‡ ä¸ªä¸»è¦éƒ¨åˆ†éœ€è¦å…³æ³¨ï¼š</p><ol><li><code>hostname</code>ï¼šè¿™æ˜¯ä½ æƒ³è¦è§£æçš„åŸŸåï¼Œæ¯”å¦‚ <code>google.com</code>ã€‚</li><li><code>options</code>ï¼ˆå¯é€‰ï¼‰ï¼šè¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥è®¾ç½®ä¸€äº›é¢å¤–çš„è§£æé€‰é¡¹ï¼Œæ¯”å¦‚è®¾ç½®è¶…æ—¶æ—¶é—´æˆ–è€…æŒ‡å®šä¸€ä¸ªç‰¹å®šçš„ DNS æœåŠ¡å™¨ã€‚å¦‚æœä¸éœ€è¦ç‰¹åˆ«è®¾ç½®ï¼Œè¿™ä¸ªå‚æ•°å¯ä»¥çœç•¥ã€‚</li><li><code>callback</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“ DNS è§£æå®Œæˆæˆ–å‘ç”Ÿé”™è¯¯æ—¶ä¼šè¢«è°ƒç”¨ã€‚å®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼š<code>err</code>å’Œ<code>addresses</code>ã€‚ <ul><li><code>err</code>ï¼šå¦‚æœè§£æè¿‡ç¨‹ä¸­å‡ºé”™äº†ï¼Œ<code>err</code>ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ã€‚</li><li><code>addresses</code>ï¼šè¿™æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†è§£æåˆ°çš„æ‰€æœ‰ IPv4 åœ°å€ã€‚é€šå¸¸ä¸€ä¸ªåŸŸåå¯èƒ½å¯¹åº”å¤šä¸ª IP åœ°å€ã€‚</li></ul></li></ol><p>ä¸¾ä¸€ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬è¦å¼€å‘ä¸€ä¸ªå°å·¥å…·ï¼Œè¿™ä¸ªå·¥å…·å¯ä»¥æ£€æŸ¥ä¸€ä¸ªç½‘ç«™æ˜¯å¦æœ‰å¯¹åº”çš„ IPv4 åœ°å€ã€‚æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨<code>dns.resolve4</code>æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> checkWebsite</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`åœ¨è§£æ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ—¶å‘ç”Ÿé”™è¯¯: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">err</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> çš„IPv4 åœ°å€æ˜¯: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">addresses</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">join</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;, &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥æ£€æŸ¥ google.com å’Œä¸€ä¸ªä¸å­˜åœ¨çš„åŸŸå</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">checkWebsite</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;google.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">checkWebsite</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;nonexistentwebsite.example&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœ<code>google.com</code>æˆåŠŸè§£æï¼Œæ§åˆ¶å°ä¼šæ‰“å°å‡ºå®ƒçš„ IP åœ°å€ã€‚å¦‚æœ<code>nonexistentwebsite.example</code>æ— æ³•è§£æï¼ˆå› ä¸ºå®ƒä¸å­˜åœ¨ï¼‰ï¼Œæ§åˆ¶å°åˆ™ä¼šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œ<code>dns.resolve4</code>æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªå¾ˆå®ç”¨çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è·å–å’Œå¤„ç†ä¸åŸŸåç›¸å…³çš„ IP åœ°å€ä¿¡æ¯ã€‚</p><h2 id="dns-resolve6-hostname-options-callback" tabindex="-1"><a class="header-anchor" href="#dns-resolve6-hostname-options-callback"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnsresolve6hostname-options-callback" target="_blank" rel="noopener noreferrer">dns.resolve6(hostname[, options], callback)</a></span></a></h2><p>å¥½çš„ï¼Œè®©æˆ‘æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹ Node.js ä¸­çš„ <code>dns.resolve6</code> å‡½æ•°æ˜¯åšä»€ä¹ˆçš„ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒã€‚</p><p><strong>ä»€ä¹ˆæ˜¯ DNSï¼Ÿ</strong></p><p>DNSï¼ˆåŸŸåç³»ç»Ÿï¼‰æ˜¯ä¸€ä¸ªå°†åŸŸåè½¬æ¢æˆ IP åœ°å€çš„ç³»ç»Ÿã€‚å½“ä½ åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ä¸€ä¸ªç½‘ç«™åœ°å€æ¯”å¦‚ <code>www.example.com</code> çš„æ—¶å€™ï¼Œä½ çš„è®¡ç®—æœºä¼šä½¿ç”¨ DNS æ¥æ‰¾åˆ°è¿™ä¸ªç½‘ç«™å¯¹åº”çš„ IP åœ°å€ï¼Œç„¶åæ‰èƒ½è¿æ¥åˆ°è¯¥æœåŠ¡å™¨ä¸‹è½½ç½‘é¡µå†…å®¹ã€‚</p><p><strong>ä»€ä¹ˆæ˜¯ IPv6 åœ°å€ï¼Ÿ</strong></p><p>IPv6 æ˜¯æœ€æ–°çš„ç½‘ç»œå±‚åè®®ï¼Œå®ƒçš„åœ°å€æ›´é•¿ï¼Œå¯ä»¥æä¾›æ¯” IPv4 æ›´å¤šçš„åœ°å€ç©ºé—´ã€‚IPv4 åœ°å€é€šå¸¸é•¿è¿™æ ·ï¼š192.168.1.1ï¼Œè€Œ IPv6 åœ°å€å¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š2001:0db8:85a3:0000:0000:8a2e:0370:7334ã€‚</p><p><strong><code>dns.resolve6</code> å‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p><p><code>dns.resolve6</code> æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†åŸŸåè§£æä¸º IPv6 åœ°å€ã€‚å½“ä½ æƒ³è¦è·å–ä¸€ä¸ªåŸŸåå¯¹åº”çš„ IPv6 åœ°å€æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><code>hostname</code>: è¿™æ˜¯ä½ æƒ³è¦æŸ¥è¯¢çš„åŸŸåï¼Œæ¯”å¦‚ &quot;<a href="http://google.com" target="_blank" rel="noopener noreferrer">google.com</a>&quot;ã€‚</li><li><code>options</code>: ï¼ˆå¯é€‰å‚æ•°ï¼‰å¯ä»¥æä¾›é¢å¤–çš„é€‰é¡¹ï¼Œä¾‹å¦‚è®¾ç½®è¶…æ—¶æ—¶é—´ç­‰ã€‚</li><li><code>callback</code>: å½“ DNS æŸ¥è¯¢å®Œæˆåï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°å°†è¢«è°ƒç”¨ã€‚å®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼š<code>error</code> å’Œ <code>addresses</code>ã€‚å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œ<code>error</code> ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼›å¦åˆ™ï¼Œ<code>error</code> ä¸º <code>null</code>ï¼Œå¹¶ä¸” <code>addresses</code> æ˜¯ä¸€ä¸ªåŒ…å«äº†æ‰¾åˆ°çš„æ‰€æœ‰ IPv6 åœ°å€çš„æ•°ç»„ã€‚</li></ul><p><strong>ä½¿ç”¨ä¾‹å­ï¼š</strong></p><p>å‡è®¾ä½ æƒ³è¦æŸ¥æ‰¾ Google çš„ IPv6 åœ°å€ï¼Œä½ çš„ä»£ç å¯èƒ½ä¼šé•¿è¿™æ ·ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ dns.resolve6 æ¥æŸ¥è¯¢ google.com çš„ IPv6 åœ°å€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;google.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Error:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æˆåŠŸçš„è¯ï¼Œæ‰“å°å‡º IPv6 åœ°å€åˆ—è¡¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;IPv6 Addresses:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè½½å…¥ Node.js çš„ <code>dns</code> æ¨¡å—ã€‚æ¥ç€ä½¿ç”¨ <code>dns.resolve6</code> æ–¹æ³•æ¥æŸ¥è¯¢ &#39;<a href="http://google.com" target="_blank" rel="noopener noreferrer">google.com</a>&#39; çš„ IPv6 åœ°å€ã€‚æˆ‘ä»¬ä¼ é€’äº†åŸŸåå’Œä¸€ä¸ªå›è°ƒå‡½æ•°ç»™ <code>resolve6</code> æ–¹æ³•ã€‚å½“æŸ¥è¯¢å®Œæˆæ—¶ï¼Œå›è°ƒå‡½æ•°è¢«è°ƒç”¨ï¼Œå¹¶æ ¹æ®æ˜¯å¦æœ‰é”™è¯¯æ¥æ‰§è¡Œä¸åŒçš„æ“ä½œã€‚</p><p>å¦‚æœæˆåŠŸï¼Œä½ å°†ä¼šåœ¨æ§åˆ¶å°çœ‹åˆ° Google åŸŸåå¯¹åº”çš„ä¸€ä¸ªæˆ–å¤šä¸ª IPv6 åœ°å€ã€‚å¦‚æœå¤±è´¥ï¼ˆæ¯”å¦‚ç½‘ç»œé—®é¢˜ï¼Œæˆ–è€…è¯¥åŸŸåæ²¡æœ‰é…ç½® IPv6 åœ°å€ï¼‰ï¼Œåˆ™ä¼šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯ <code>dns.resolve6</code> æ–¹æ³•çš„ä»‹ç»å’Œä½¿ç”¨ç¤ºä¾‹ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥è½»æ¾åœ°åœ¨è‡ªå·±çš„ Node.js åº”ç”¨ç¨‹åºä¸­è¿›è¡Œ DNS æŸ¥è¯¢ï¼Œè·å–ç›¸å…³çš„ç½‘ç»œä¿¡æ¯ã€‚</p><h2 id="dns-resolveany-hostname-callback" tabindex="-1"><a class="header-anchor" href="#dns-resolveany-hostname-callback"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnsresolveanyhostname-callback" target="_blank" rel="noopener noreferrer">dns.resolveAny(hostname, callback)</a></span></a></h2><p>å¥½çš„ï¼Œæˆ‘å°†ä¸ºä½ è§£é‡Š <code>dns.resolveAny(hostname, callback)</code> è¿™ä¸ªå‡½æ•°ä»¥åŠå…¶åœ¨ Node.js ä¸­çš„ä½¿ç”¨ã€‚</p><h3 id="dns-resolveany-è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#dns-resolveany-è¯¦è§£"><span>dns.resolveAny() è¯¦è§£</span></a></h3><p><code>dns.resolveAny()</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œå®ƒç”¨æ¥æŸ¥è¯¢åŸŸåçš„å„ç§è®°å½•ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥é€šè¿‡æ­¤å‡½æ•°è·å–æŒ‡å®šåŸŸåçš„æ‰€æœ‰ç±»å‹çš„ DNS è®°å½•ï¼Œæ¯”å¦‚ A è®°å½•ï¼ˆç”¨äº IP åœ°å€è§£æï¼‰ã€MX è®°å½•ï¼ˆç”¨äºé‚®ä»¶äº¤æ¢æœåŠ¡å™¨ï¼‰ç­‰ã€‚</p><h3 id="å‚æ•°è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯´æ˜"><span>å‚æ•°è¯´æ˜</span></a></h3><ul><li><code>hostname</code>: è¿™æ˜¯ä½ æƒ³è¦æŸ¥è¯¢ DNS è®°å½•çš„åŸŸåã€‚ä¾‹å¦‚ï¼š&quot;<a href="http://google.com" target="_blank" rel="noopener noreferrer">google.com</a>&quot;ã€‚</li><li><code>callback</code>: å½“ DNS æŸ¥è¯¢å®Œæˆæˆ–å‡ºç°é”™è¯¯æ—¶ï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°ä¼šè¢«æ‰§è¡Œã€‚å›è°ƒå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼š <ul><li><code>error</code>: å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œè¿™é‡Œä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼›å¦‚æœæ²¡æœ‰é”™è¯¯å‘ç”Ÿï¼Œåˆ™å€¼ä¸º <code>null</code>ã€‚</li><li><code>records</code>: æŸ¥è¯¢åˆ°çš„ DNS è®°å½•æ•°ç»„ã€‚</li></ul></li></ul><h3 id="ä½¿ç”¨ä¸¾ä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¸¾ä¾‹"><span>ä½¿ç”¨ä¸¾ä¾‹</span></a></h3><p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡å‡ ä¸ªç¤ºä¾‹æ¥æ¼”ç¤º <code>dns.resolveAny()</code> å‡½æ•°çš„ä½¿ç”¨ï¼š</p><h4 id="ç¤ºä¾‹-1-æŸ¥è¯¢åŸŸåçš„æ‰€æœ‰-dns-è®°å½•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æŸ¥è¯¢åŸŸåçš„æ‰€æœ‰-dns-è®°å½•"><span>ç¤ºä¾‹ 1ï¼šæŸ¥è¯¢åŸŸåçš„æ‰€æœ‰ DNS è®°å½•</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬æƒ³è¦æŸ¥è¯¢ google.com çš„æ‰€æœ‰DNSè®°å½•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveAny</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;google.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">records</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æŸ¥è¯¢DNSæ—¶å‡ºç°é”™è¯¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ‰“å°æŸ¥è¯¢ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;DNS è®°å½•:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">records</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>dns.resolveAny()</code> æŸ¥è¯¢äº† &quot;<a href="http://google.com" target="_blank" rel="noopener noreferrer">google.com</a>&quot; åŸŸåçš„æ‰€æœ‰ DNS è®°å½•ã€‚å½“æŸ¥è¯¢å®Œæˆæ—¶ï¼Œæˆ‘ä»¬çš„å›è°ƒå‡½æ•°è¢«è°ƒç”¨ï¼Œå¦‚æœæ²¡æœ‰é”™è¯¯å‘ç”Ÿï¼Œå°±ä¼šæ‰“å°å‡ºæ‰€æœ‰çš„ DNS è®°å½•ã€‚</p><h4 id="ç¤ºä¾‹-2-å¤„ç†æŸ¥è¯¢é”™è¯¯" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å¤„ç†æŸ¥è¯¢é”™è¯¯"><span>ç¤ºä¾‹ 2ï¼šå¤„ç†æŸ¥è¯¢é”™è¯¯</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°è¯•æŸ¥è¯¢ä¸€ä¸ªå¯èƒ½ä¸å­˜åœ¨çš„åŸŸå</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveAny</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;someunknownwebsite.example&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">records</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æŸ¥è¯¢DNSæ—¶å‡ºç°é”™è¯¯ï¼Œå¯èƒ½æ˜¯å› ä¸ºåŸŸåä¸å­˜åœ¨:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ‰“å°æŸ¥è¯¢ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;DNS è®°å½•:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">records</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°è¯•æŸ¥è¯¢ä¸€ä¸ªå¯èƒ½ä¸å­˜åœ¨çš„åŸŸåã€‚å¦‚æœåŸŸåç¡®å®ä¸å­˜åœ¨æˆ–è€…å…¶ä»–ä»»ä½•åŸå› å¯¼è‡´æŸ¥è¯¢å¤±è´¥ï¼Œé”™è¯¯å¯¹è±¡ <code>error</code> å°†ä¼šåŒ…å«ç›¸å…³é”™è¯¯ä¿¡æ¯ï¼Œå¹¶é€šè¿‡ <code>console.error</code> è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-2" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-2"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li><code>dns.resolveAny()</code> æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œæ‰€ä»¥ä½ ä¸ä¼šç«‹å³å¾—åˆ°ç»“æœï¼Œè€Œæ˜¯éœ€è¦ç­‰å¾…å›è°ƒå‡½æ•°è¢«è§¦å‘ã€‚</li><li>æŸ¥è¯¢ DNS å¯èƒ½ä¼šå—åˆ°ç½‘ç»œç¯å¢ƒçš„å½±å“ï¼Œå› æ­¤åœ¨ä½¿ç”¨æ—¶è¯·è€ƒè™‘åˆ°å¯èƒ½ä¼šé‡åˆ°ç½‘ç»œå»¶è¿Ÿæˆ–æŸ¥è¯¢è¶…æ—¶çš„é—®é¢˜ã€‚</li><li>æ­£ç¡®å¤„ç†é”™è¯¯éå¸¸é‡è¦ï¼Œä»¥é˜²æ­¢ç¨‹åºåœ¨é‡åˆ°æŸ¥è¯¢é—®é¢˜æ—¶å´©æºƒã€‚</li></ul><p>é€šè¿‡ä¸Šé¢çš„è§£é‡Šå’Œç¤ºä¾‹ï¼Œå¸Œæœ›ä½ å¯¹ <code>dns.resolveAny()</code> åœ¨ Node.js ä¸­çš„ä½¿ç”¨æœ‰äº†æ›´æ¸…æ™°çš„ç†è§£ã€‚</p><h2 id="dns-resolvecname-hostname-callback" tabindex="-1"><a class="header-anchor" href="#dns-resolvecname-hostname-callback"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnsresolvecnamehostname-callback" target="_blank" rel="noopener noreferrer">dns.resolveCname(hostname, callback)</a></span></a></h2><p>Node.js ä¸­çš„ <code>dns.resolveCname</code> å‡½æ•°æ˜¯ç”¨æ¥æŸ¥è¯¢ä¸€ä¸ªåŸŸåçš„ CNAME è®°å½•çš„ã€‚åœ¨äº†è§£è¿™ä¸ªå‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¦æ˜ç™½ä»€ä¹ˆæ˜¯ CNAME è®°å½•ã€‚</p><p>CNAME ä»£è¡¨ Canonical Nameï¼ˆè§„èŒƒåç§°ï¼‰ï¼Œå®ƒå…è®¸ä½ å°†ä¸€ä¸ªåŸŸåæŒ‡å‘å¦ä¸€ä¸ªåŸŸåã€‚è¿™é€šå¸¸åœ¨ä½ æƒ³è¦ä¸ºåŒä¸€ä¸ª IP åœ°å€æä¾›å¤šä¸ªæœåŠ¡æ—¶ä½¿ç”¨ã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½æœ‰ä¸€ä¸ªè¿è¡Œç½‘ç«™çš„æœåŠ¡å™¨ï¼Œå®ƒçš„åŸŸåæ˜¯ <code>www.example.com</code>ã€‚åæ¥ä½ å†³å®šæ·»åŠ ä¸€ä¸ªåšå®¢ï¼Œåœ¨ä¸æ›´æ¢æœåŠ¡å™¨çš„æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªåä¸º <code>blog.example.com</code> çš„ CNAME è®°å½•ï¼ŒæŒ‡å‘ <code>www.example.com</code>ã€‚</p><p>ç°åœ¨è¯´å› Node.js ä¸­çš„ <code>dns.resolveCname</code>ï¼Œè¿™ä¸ªå‡½æ•°çš„ä½œç”¨å°±æ˜¯æŸ¥è¯¢ç»™å®šåŸŸåçš„ CNAME è®°å½•ã€‚å…¶åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveCname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>hostname</code>ï¼šè¦æŸ¥è¯¢çš„åŸŸåå­—ç¬¦ä¸²ã€‚</li><li><code>callback</code>ï¼šå®ŒæˆæŸ¥è¯¢åçš„å›è°ƒå‡½æ•°ï¼Œå®ƒå¸¦æœ‰ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªé”™è¯¯å¯¹è±¡ï¼ˆå¦‚æœæŸ¥è¯¢å¤±è´¥ï¼‰å’Œä¸€ä¸ª CNAME è®°å½•æ•°ç»„ï¼ˆæŸ¥è¯¢æˆåŠŸæ—¶ï¼‰ã€‚</li></ul><p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ æƒ³æŸ¥è¯¢ &quot;<a href="http://blog.example.com" target="_blank" rel="noopener noreferrer">blog.example.com</a>&quot; çš„ CNAME è®°å½•ï¼Œä½ å¯ä»¥è¿™æ ·å†™ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveCname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;blog.example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æŸ¥è¯¢å‡ºé”™: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">err</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`CNAMEè®°å½•ä¸º: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ä¸Šé¢çš„ä»£ç æ‰§è¡Œæ—¶ï¼ŒNode.js å°†ä¼šæŸ¥æ‰¾ &quot;<a href="http://blog.example.com" target="_blank" rel="noopener noreferrer">blog.example.com</a>&quot; çš„ CNAME è®°å½•ã€‚æŸ¥è¯¢ç»“æœï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡å‘çš„åŸŸåï¼‰ä¼šé€šè¿‡ <code>addresses</code> å‚æ•°è¿”å›ï¼Œå¹¶åœ¨æ§åˆ¶å°æ‰“å°å‡ºæ¥ã€‚</p><p>è¿™ä¸ªæ–¹æ³•ä¸»è¦è¢«ç”¨äºéœ€è¦å¤„ç†åŸŸåè®°å½•çš„ç¨‹åºä¸­ï¼Œä¾‹å¦‚é‚®ç®±æœåŠ¡ã€è´Ÿè½½å‡è¡¡å™¨æˆ–è€…æ˜¯ç½‘ç»œç›‘æ§å·¥å…·ç­‰ã€‚åˆ©ç”¨ <code>dns.resolveCname</code> å‡½æ•°ï¼Œè¿™äº›ç¨‹åºå¯ä»¥åŠ¨æ€åœ°ç¡®å®šæŸä¸ªç‰¹å®šæœåŠ¡å®é™…æŒ‡å‘çš„æœåŠ¡ä¸»æœºï¼Œä»è€Œè¿›è¡Œç›¸åº”çš„æ“ä½œå¤„ç†ã€‚</p><h2 id="dns-resolvecaa-hostname-callback" tabindex="-1"><a class="header-anchor" href="#dns-resolvecaa-hostname-callback"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnsresolvecaahostname-callback" target="_blank" rel="noopener noreferrer">dns.resolveCaa(hostname, callback)</a></span></a></h2><p><code>dns.resolveCaa()</code> æ˜¯ Node.js çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæŸ¥è¯¢æŒ‡å®šåŸŸåçš„ DNS CAA è®°å½•ï¼ˆCertification Authority Authorizationï¼‰ã€‚CAA è®°å½•æ˜¯ä¸€ç§ DNS èµ„æºè®°å½•ï¼Œå®ƒå…è®¸åŸŸåæ‰€æœ‰è€…å£°æ˜å“ªäº›è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰è¢«æˆæƒä¸ºè¯¥åŸŸåé¢å‘ SSL/TLS è¯ä¹¦ã€‚è¿™æœ‰åŠ©äºå¢åŠ ç½‘ç«™çš„å®‰å…¨æ€§ï¼Œå› ä¸ºå®ƒå¯ä»¥é˜²æ­¢æœªç»æˆæƒçš„ CA é¢å‘è¯ä¹¦ã€‚</p><p>ä½¿ç”¨ <code>dns.resolveCaa()</code> å‡½æ•°æ—¶ï¼Œä½ éœ€è¦æä¾›ä¸¤ä¸ªå‚æ•°ï¼š<code>hostname</code> å’Œ <code>callback</code>ã€‚</p><ul><li><code>hostname</code>: è¿™æ˜¯ä½ æƒ³è¦æŸ¥è¯¢ CAA è®°å½•çš„åŸŸåå­—ç¬¦ä¸²ã€‚</li><li><code>callback</code>: è¿™æ˜¯ä¸€ä¸ªå½“ <code>dns.resolveCaa()</code> å®ŒæˆæŸ¥è¯¢åè¢«è°ƒç”¨çš„å‡½æ•°ã€‚è¿™ä¸ªå›è°ƒå‡½æ•°åº”è¯¥æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šerror å’Œ recordsã€‚å¦‚æœå‡ºç°é”™è¯¯ï¼ˆå¦‚æŸ¥è¯¢å¤±è´¥ï¼‰ï¼Œerror å°†ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼›å¦‚æœæŸ¥è¯¢æˆåŠŸï¼Œerror å°†ä¼šæ˜¯ nullï¼Œrecords æ•°ç»„å°†åŒ…å« CAA è®°å½•çš„è¯¦ç»†ä¿¡æ¯ã€‚</li></ul><p>ä¸‹é¢ä¸¾ä¾‹è¯´æ˜å¦‚ä½•ä½¿ç”¨ <code>dns.resolveCaa()</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æƒ³æŸ¥è¯¢&quot;example.com&quot;çš„CAAè®°å½•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hostname</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨dns.resolveCaa()å‡½æ•°æŸ¥è¯¢CAAè®°å½•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveCaa</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">records</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¦‚æœå‡ºç°é”™è¯¯ï¼Œå¯èƒ½æ˜¯ç½‘ç»œé—®é¢˜æˆ–åŸŸåä¸å­˜åœ¨ç­‰åŸå› ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Error fetching CAA records:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œæˆ‘ä»¬å°†è·å¾—CAAè®°å½•çš„æ•°ç»„</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;CAA records for&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">records</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ‰“å°æ¯æ¡è®°å½•çš„è¯¦ç»†ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    records</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`- Flags: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">record</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">flags</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`- Tag: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">record</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">tag</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`- Value: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">record</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">value</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† Node.js çš„<code>dns</code>æ¨¡å—ï¼Œç„¶åå®šä¹‰äº†æˆ‘ä»¬æƒ³è¦æŸ¥è¯¢çš„åŸŸå<code>hostname</code>ã€‚æ¥ç€ï¼Œæˆ‘ä»¬è°ƒç”¨<code>dns.resolveCaa()</code>å‡½æ•°ï¼Œå¹¶ä¼ é€’åŸŸåå’Œä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚å¦‚æœæŸ¥è¯¢æˆåŠŸï¼Œæˆ‘ä»¬ä¼šåœ¨æ§åˆ¶å°ä¸Šçœ‹åˆ° CAA è®°å½•çš„è¯¦ç»†ä¿¡æ¯ï¼›å¦‚æœæŸ¥è¯¢å¤±è´¥ï¼Œåˆ™ä¼šçœ‹åˆ°é”™è¯¯ä¿¡æ¯ã€‚</p><p>å‡è®¾ &quot;<a href="http://example.com" target="_blank" rel="noopener noreferrer">example.com</a>&quot; æœ‰ä»¥ä¸‹ CAA è®°å½•ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>0 issue &quot;letsencrypt.org&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>é‚£ä¹ˆæ‰§è¡Œä¸Šé¢çš„ä»£ç å°†ä¼šåœ¨æ§åˆ¶å°ä¸Šè¾“å‡ºç±»ä¼¼ä»¥ä¸‹ç»“æœï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CAA records for example.com : [ { flags: 0, tag: &#39;issue&#39;, value: &#39;letsencrypt.org&#39; } ]</span></span>
<span class="line"><span>- Flags: 0</span></span>
<span class="line"><span>- Tag: issue</span></span>
<span class="line"><span>- Value: letsencrypt.org</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™è¡¨ç¤º &quot;<a href="http://example.com" target="_blank" rel="noopener noreferrer">example.com</a>&quot; å…è®¸ Let&#39;s Encrypt è¿™ä¸ª CA é¢å‘è¯ä¹¦ã€‚</p><p>è®°ä½ï¼Œä¸æ˜¯æ‰€æœ‰çš„åŸŸåéƒ½æœ‰ CAA è®°å½•ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ä»»ä½•è®°å½•ï¼Œ<code>records</code> æ•°ç»„å°†ä¼šæ˜¯ç©ºçš„ã€‚</p><h2 id="dns-resolvemx-hostname-callback" tabindex="-1"><a class="header-anchor" href="#dns-resolvemx-hostname-callback"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnsresolvemxhostname-callback" target="_blank" rel="noopener noreferrer">dns.resolveMx(hostname, callback)</a></span></a></h2><p>Node.js ä¸­çš„ <code>dns.resolveMx</code> å‡½æ•°æ˜¯ç”¨æ¥æŸ¥è¯¢ä¸€ä¸ªåŸŸåï¼ˆæ¯”å¦‚ &quot;<a href="http://example.com" target="_blank" rel="noopener noreferrer">example.com</a>&quot;ï¼‰çš„é‚®ä»¶äº¤æ¢ï¼ˆMXï¼‰è®°å½•çš„å‡½æ•°ã€‚MX è®°å½•æ˜¯äº’è”ç½‘ä¸Šç”¨æ¥ç¡®å®šå¦‚ä½•å‘æŸä¸ªåŸŸå‘é€ç”µå­é‚®ä»¶çš„ä¸€ç§ DNS è®°å½•ç±»å‹ã€‚</p><p>å½“ä½ å‘é€ä¸€å°ç”µå­é‚®ä»¶æ—¶ï¼Œä½ çš„é‚®ç®±æœåŠ¡æä¾›å•†éœ€è¦çŸ¥é“å°†é‚®ä»¶å‘é€åˆ°å“ªé‡Œã€‚ä¸ºæ­¤ï¼Œå®ƒä¼šæŸ¥æ‰¾æ¥æ”¶åŸŸï¼ˆå³æ”¶ä»¶äººç”µå­é‚®ä»¶åœ°å€ä¸­ &quot;@&quot; ç¬¦å·ä¹‹åéƒ¨åˆ†ï¼‰çš„ MX è®°å½•ã€‚æ¯ä¸ª MX è®°å½•åŒ…å«ä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ï¼šä¼˜å…ˆçº§å’Œé‚®ç®±æœåŠ¡å™¨åœ°å€ã€‚ä¼˜å…ˆçº§å‘Šè¯‰æˆ‘ä»¬å“ªä¸ªé‚®ç®±æœåŠ¡å™¨åº”è¯¥é¦–å…ˆå°è¯•è”ç³»ï¼›è¾ƒä½çš„æ•°å­—æ„å‘³ç€æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>dns.resolveMx</code> å‡½æ•°è®©ä½ èƒ½å¤Ÿç¼–ç¨‹å¼åœ°æ‰§è¡Œè¿™é¡¹æŸ¥è¯¢ã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼š</p><ol><li><code>hostname</code> - ä½ è¦æŸ¥è¯¢ MX è®°å½•çš„åŸŸåã€‚</li><li><code>callback</code> - å½“æŸ¥è¯¢å®Œæˆæ—¶è¢«è°ƒç”¨çš„å‡½æ•°ã€‚è¿™ä¸ªå›è°ƒå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼š<code>error</code> å’Œ <code>addresses</code>ã€‚å¦‚æœå‡ºé”™äº†ï¼Œ<code>error</code> ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼›å¦‚æœæˆåŠŸäº†ï¼Œ<code>addresses</code> å°†ä¼šæ˜¯ä¸€ä¸ªåŒ…å« MX è®°å½•çš„æ•°ç»„ã€‚</li></ol><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ <code>dns.resolveMx</code> çš„ç®€å•ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬æƒ³è¦æŸ¥è¯¢çš„åŸŸå</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hostname</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;gmail.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨dnsæ¨¡å—ä¸­çš„resolveMxæ–¹æ³•æ¥æŸ¥è¯¢MXè®°å½•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveMx</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œæ‰“å°å‡ºæ¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æŸ¥è¯¢MXè®°å½•æ—¶å‘ç”Ÿé”™è¯¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¦‚æœæˆåŠŸï¼Œæ‰“å°å‡ºMXè®°å½•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æŸ¥è¯¢åˆ°çš„MXè®°å½•ä¸º:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">mxRecord</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        `ä¼˜å…ˆçº§: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mxRecord</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">priority</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, é‚®ç®±æœåŠ¡å™¨: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mxRecord</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exchange</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ä½ è¿è¡Œè¿™ä¸ªè„šæœ¬æ—¶ï¼Œå®ƒä¼šæŸ¥è¯¢ &quot;<a href="http://gmail.com" target="_blank" rel="noopener noreferrer">gmail.com</a>&quot; çš„ MX è®°å½•ï¼Œå¹¶æ‰“å°å‡ºç»“æœã€‚è¾“å‡ºå¯èƒ½ä¼šæ˜¯è¿™æ ·çš„ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>æŸ¥è¯¢åˆ°çš„MXè®°å½•ä¸º:</span></span>
<span class="line"><span>ä¼˜å…ˆçº§: 5, é‚®ç®±æœåŠ¡å™¨: gmail-smtp-in.l.google.com.</span></span>
<span class="line"><span>ä¼˜å…ˆçº§: 10, é‚®ç®±æœåŠ¡å™¨: alt1.gmail-smtp-in.l.google.com.</span></span>
<span class="line"><span>...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™è¡¨ç¤º &quot;<a href="http://gmail.com" target="_blank" rel="noopener noreferrer">gmail.com</a>&quot; çš„ç”µå­é‚®ä»¶é¦–å…ˆåº”è¯¥å‘é€åˆ° &quot;<a href="http://gmail-smtp-in.l.google.com" target="_blank" rel="noopener noreferrer">gmail-smtp-in.l.google.com</a>&quot;ï¼Œå¦‚æœé‚£ä¸ªæœåŠ¡å™¨ä¸å¯ç”¨ï¼Œåˆ™å°è¯• &quot;<a href="http://alt1.gmail-smtp-in.l.google.com" target="_blank" rel="noopener noreferrer">alt1.gmail-smtp-in.l.google.com</a>&quot;ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><p>æ€»ç»“èµ·æ¥ï¼Œ<code>dns.resolveMx</code> æ˜¯ä¸€ä¸ªåœ¨ Node.js åº”ç”¨ç¨‹åºä¸­æŸ¥è¯¢ MX è®°å½•çš„å·¥å…·ï¼Œéå¸¸é€‚åˆç”¨äºå¼€å‘ç”µå­é‚®ä»¶ç›¸å…³æœåŠ¡ï¼Œå¦‚éªŒè¯ç”µå­é‚®ä»¶åœ°å€çœŸå®æ€§ã€è·¯ç”±è‡ªå®šä¹‰é‚®ä»¶æœåŠ¡ç­‰åœºæ™¯ã€‚</p><h2 id="dns-resolvenaptr-hostname-callback" tabindex="-1"><a class="header-anchor" href="#dns-resolvenaptr-hostname-callback"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnsresolvenaptrhostname-callback" target="_blank" rel="noopener noreferrer">dns.resolveNaptr(hostname, callback)</a></span></a></h2><p><code>dns.resolveNaptr()</code> æ–¹æ³•æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºæŸ¥è¯¢æŒ‡å®šä¸»æœºåï¼ˆhostnameï¼‰çš„ NAPTR è®°å½•ã€‚NAPTR è®°å½•å±äº DNSï¼ˆåŸŸåç³»ç»Ÿï¼‰è®°å½•çš„ä¸€ç§ï¼Œä¸»è¦ç”¨äºæ”¯æŒç”µè¯å·ç æ˜ å°„å’ŒåŸºäºè§„åˆ™çš„åŠ¨æ€è§£ææœåŠ¡ï¼Œæ¯”å¦‚ ENUM å’Œ SIPï¼ˆSession Initiation Protocolï¼Œç”¨äºå¯åŠ¨äº¤äº’å¼ç”¨æˆ·ä¼šè¯çš„åè®®ï¼‰ã€‚</p><p>åœ¨ä»‹ç» <code>dns.resolveNaptr()</code> ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ DNS å’Œ NAPTR è®°å½•ã€‚</p><h3 id="dns-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#dns-ç®€ä»‹"><span>DNS ç®€ä»‹ï¼š</span></a></h3><p>DNS æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œå¯ä»¥æ ¹æ®ä¸»æœºåï¼ˆä¾‹å¦‚ <a href="http://www.example.com" target="_blank" rel="noopener noreferrer">www.example.com</a>ï¼‰æ¥æŸ¥æ‰¾å¯¹åº”çš„ IP åœ°å€ã€‚å½“ä½ åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ä¸€ä¸ªç½‘ç«™åœ°å€æ—¶ï¼ŒDNS è´Ÿè´£å°†è¯¥ç½‘ç«™åœ°å€è½¬æ¢ä¸ºæœåŠ¡å™¨çš„ IP åœ°å€ï¼Œä»¥ä¾¿æµè§ˆå™¨èƒ½å¤ŸåŠ è½½å¹¶æ˜¾ç¤ºç½‘é¡µå†…å®¹ã€‚</p><h3 id="naptr-è®°å½•ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#naptr-è®°å½•ç®€ä»‹"><span>NAPTR è®°å½•ç®€ä»‹ï¼š</span></a></h3><p>NAPTR è®°å½•ï¼ˆNaming Authority Pointerï¼‰é€šå¸¸ä¸ ENUM æˆ–å…¶ä»–æœåŠ¡ä¸€èµ·ä½¿ç”¨ï¼Œå®ƒå…è®¸åŸºäºè§„åˆ™çš„é‡å†™å’Œæ›¿ä»£ã€‚æ¯ä¸ª NAPTR è®°å½•å®šä¹‰äº†ä¸€æ¡è§„åˆ™ï¼Œè¿™æ¡è§„åˆ™è¯´æ˜äº†å¦‚ä½•å¤„ç†æŸäº›ç±»å‹çš„æ ‡è¯†ç¬¦ï¼ˆå¦‚ç”µè¯å·ç ï¼‰ï¼Œå¹¶å°†å…¶æ˜ å°„åˆ° URIã€é‚®ç®±æˆ–å…¶ä»–ä½ç½®ã€‚</p><h3 id="ä½¿ç”¨-dns-resolvenaptr" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-dns-resolvenaptr"><span>ä½¿ç”¨ <code>dns.resolveNaptr()</code>ï¼š</span></a></h3><p>ç°åœ¨ï¼Œå›åˆ° <code>dns.resolveNaptr()</code> å‡½æ•°ã€‚è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š<code>hostname</code> å’Œ <code>callback</code>ã€‚</p><ul><li><code>hostname</code>ï¼šå­—ç¬¦ä¸²ï¼Œè¦è§£æå…¶ NAPTR è®°å½•çš„ä¸»æœºåã€‚</li><li><code>callback</code>ï¼šå‡½æ•°ï¼Œåœ¨è§£æå®Œæˆåè¢«è°ƒç”¨ã€‚å›è°ƒå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é”™è¯¯ä¿¡æ¯ï¼ˆå¦‚æœæ²¡æœ‰å‘ç”Ÿé”™è¯¯ï¼Œåˆ™ä¸º nullï¼‰ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è§£æå¾—åˆ°çš„ NAPTR è®°å½•æ•°ç»„ã€‚</li></ul><h3 id="ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹"><span>ç¤ºä¾‹ï¼š</span></a></h3><p>å‡è®¾æˆ‘ä»¬æƒ³è¦æŸ¥è¯¢ &quot;<a href="http://example.com" target="_blank" rel="noopener noreferrer">example.com</a>&quot; çš„ NAPTR è®°å½•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¸»æœºå</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hostname</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ dns.resolveNaptr æ–¹æ³•æ¥è§£æ NAPTR è®°å½•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveNaptr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">records</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è§£æå‘ç”Ÿé”™è¯¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ‰“å°å‡ºè§£æå¾—åˆ°çš„ NAPTR è®°å½•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`NAPTR è®°å½•ï¼š`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  records</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ä½ è¿è¡Œä¸Šè¿°ä»£ç æ—¶ï¼ŒNode.js ä¼šå¼‚æ­¥åœ°æŸ¥è¯¢ &quot;<a href="http://example.com" target="_blank" rel="noopener noreferrer">example.com</a>&quot; çš„ NAPTR è®°å½•ï¼Œå¹¶åœ¨æœ‰ç»“æœæ—¶é€šè¿‡ <code>callback</code> å‡½æ•°è¿”å›ã€‚</p><p>è¾“å‡ºç¤ºä¾‹å¯èƒ½ä¼šåƒè¿™æ ·ï¼ˆå–å†³äºå®é™…çš„ DNS è®°å½•ï¼‰ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>NAPTR è®°å½•ï¼š</span></span>
<span class="line"><span>[</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        flags: &#39;s&#39;,</span></span>
<span class="line"><span>        service: &#39;SIP+D2U&#39;,</span></span>
<span class="line"><span>        regexp: &#39;&#39;,</span></span>
<span class="line"><span>        replacement: &#39;_sip._udp.example.com.&#39;,</span></span>
<span class="line"><span>        order: 100,</span></span>
<span class="line"><span>        preference: 10</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¶ä¸­æ¯ä¸ªè®°å½•éƒ½åŒ…å«äº† NAPTR è®°å½•çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ¯”å¦‚ <code>flags</code>ã€<code>service</code>ã€<code>regexp</code>ã€<code>replacement</code>ã€<code>order</code> å’Œ <code>preference</code>ã€‚</p><p>æ³¨æ„ï¼šåœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¸æ˜¯æ‰€æœ‰çš„åŸŸåéƒ½é…ç½®äº† NAPTR è®°å½•ï¼Œå¦‚æœè¯•å›¾æŸ¥è¯¢ä¸å­˜åœ¨ NAPTR è®°å½•çš„åŸŸåï¼Œå›è°ƒå‡½æ•°ä¸­çš„ <code>err</code> å‚æ•°å°†ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼Œè¡¨æ˜è§£æå¤±è´¥ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯å…³äº <code>dns.resolveNaptr()</code> æ–¹æ³•çš„ä»‹ç»ï¼Œå®ƒæ˜¯ä¸€ä¸ªåœ¨ç‰¹å®šåœºæ™¯ä¸‹æœ‰ç”¨çš„å·¥å…·ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦è¿›è¡Œå¤æ‚çš„ URI æ˜ å°„å’Œç”µè¯å·ç æœåŠ¡è§£ææ—¶ã€‚</p><h2 id="dns-resolvens-hostname-callback" tabindex="-1"><a class="header-anchor" href="#dns-resolvens-hostname-callback"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnsresolvenshostname-callback" target="_blank" rel="noopener noreferrer">dns.resolveNs(hostname, callback)</a></span></a></h2><p>å¥½çš„ï¼ŒNode.js ä¸­çš„ <code>dns.resolveNs(hostname, callback)</code> æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°ç”¨äºè§£æç»™å®šä¸»æœºåï¼ˆhostnameï¼‰çš„åç§°æœåŠ¡å™¨è®°å½•ï¼ˆNS è®°å½•ï¼‰ã€‚åœ¨äº’è”ç½‘ä¸­ï¼Œæ¯ä¸ªåŸŸåéƒ½éœ€è¦æœ‰è‡³å°‘ä¸€æ¡åç§°æœåŠ¡å™¨è®°å½•ï¼Œè¿™äº›è®°å½•æŒ‡å®šäº†å“ªäº›æœåŠ¡å™¨è´Ÿè´£å›ç­”å…³äºè¯¥åŸŸåçš„ DNS æŸ¥è¯¢ã€‚</p><p>ä¸‹é¢æˆ‘ä¼šè¯¦ç»†è§£é‡Šè¿™ä¸ªå‡½æ•°ä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒï¼ŒåŒæ—¶ä¸¾å‡ ä¸ªå®é™…çš„ä¾‹å­ã€‚</p><h3 id="å‡½æ•°è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#å‡½æ•°è§£é‡Š"><span>å‡½æ•°è§£é‡Š</span></a></h3><p><code>dns.resolveNs(hostname, callback)</code> æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š</p><ol><li><code>hostname</code>: è¿™æ˜¯ä½ æƒ³è¦æŸ¥è¯¢ NS è®°å½•çš„åŸŸåã€‚æ¯”å¦‚ &quot;<a href="http://google.com" target="_blank" rel="noopener noreferrer">google.com</a>&quot;ã€‚</li><li><code>callback</code>: è¿™æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå½“ NS è®°å½•æŸ¥è¯¢å®Œæˆåä¼šè¢«è°ƒç”¨ã€‚è¿™ä¸ªå›è°ƒå‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š <ul><li><code>error</code>: å¦‚æœåœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œè¿™ä¸ªå‚æ•°ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰å‘ç”Ÿé”™è¯¯ï¼Œå®ƒå°†æ˜¯ nullã€‚</li><li><code>addresses</code>: è¿™æ˜¯ä¸€ä¸ªåŒ…å«æ‰€æœ‰æ‰¾åˆ°çš„åç§°æœåŠ¡å™¨è®°å½•çš„æ•°ç»„ï¼Œåªæœ‰åœ¨æ²¡æœ‰å‘ç”Ÿé”™è¯¯æ—¶æ‰æœ‰å€¼ã€‚</li></ul></li></ol><h3 id="å¦‚ä½•ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>ä½¿ç”¨è¿™ä¸ªå‡½æ•°å¾ˆç®€å•ã€‚é¦–å…ˆï¼Œä½ éœ€è¦å¼•å…¥ Node.js çš„<code>dns</code>æ¨¡å—ã€‚ç„¶åï¼Œè°ƒç”¨<code>dns.resolveNs()</code>å‡½æ•°ï¼Œå¹¶ä¼ å…¥ä½ è¦æŸ¥è¯¢çš„ä¸»æœºåå’Œä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚</p><p>è¿™é‡Œæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥dnsæ¨¡å—</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¦æŸ¥è¯¢çš„åŸŸå</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hostname</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨dns.resolveNs()æ¥æŸ¥è¯¢NSè®°å½•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveNs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æŸ¥è¯¢å‡ºé”™: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">error</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`åç§°æœåŠ¡å™¨è®°å½•: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬è¯•å›¾è·å–<code>example.com</code>çš„ NS è®°å½•ã€‚å¦‚æœæˆåŠŸï¼Œæ§åˆ¶å°å°†è¾“å‡ºè¿™äº›è®°å½•ã€‚å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œæ¯”å¦‚å¦‚æœåŸŸåä¸å­˜åœ¨æˆ–è€…ç½‘ç»œé—®é¢˜ï¼Œé‚£ä¹ˆé”™è¯¯ä¿¡æ¯ä¼šè¢«è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-1"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™ç®¡ç†å·¥å…·ï¼Œä½ éœ€è¦éªŒè¯ç”¨æˆ·æä¾›çš„åŸŸåæ˜¯å¦æœ‰æ­£ç¡®é…ç½®çš„ NS è®°å½•ã€‚ä½ å¯ä»¥ä½¿ç”¨<code>dns.resolveNs()</code>å‡½æ•°æ¥æ£€æŸ¥å¹¶æ˜¾ç¤ºè¿™äº›è®°å½•ã€‚</p><p>å¦å¤–ä¸€ä¸ªä¾‹å­å¯èƒ½æ¶‰åŠåˆ°å®‰å…¨æ€§ï¼Œä½ å¯èƒ½æ­£åœ¨ç¼–å†™ä¸€ä¸ªè„šæœ¬æ¥åˆ†æä¸åŒåŸŸåçš„ NS è®°å½•ï¼Œä»¥å‘ç°æ½œåœ¨çš„é…ç½®é”™è¯¯æˆ–è€…å¯»æ‰¾ç”±ç›¸åŒæä¾›å•†æ‰˜ç®¡çš„å…¶å®ƒåŸŸåï¼Œè¿™å¯èƒ½å¯¹ä¿¡æ¯æ”¶é›†æˆ–ç«äº‰æƒ…æŠ¥éå¸¸æœ‰ä»·å€¼ã€‚</p><p>å¸Œæœ›è¿™ä¸ªè§£é‡Šå’Œä¾‹å­å¸®åŠ©ä½ ç†è§£<code>dns.resolveNs()</code>å‡½æ•°åœ¨ Node.js ä¸­å¦‚ä½•å·¥ä½œä»¥åŠå®ƒå¯ä»¥ç”¨æ¥åšä»€ä¹ˆã€‚å¦‚æœä½ æœ‰ä»»ä½•å…¶ä»–é—®é¢˜ï¼Œè¯·éšæ—¶æé—®ï¼</p><h2 id="dns-resolveptr-hostname-callback" tabindex="-1"><a class="header-anchor" href="#dns-resolveptr-hostname-callback"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnsresolveptrhostname-callback" target="_blank" rel="noopener noreferrer">dns.resolvePtr(hostname, callback)</a></span></a></h2><p>å½“ç„¶å¯ä»¥è§£é‡Šç»™ä½ å¬ã€‚Node.js ä¸­çš„<code>dns.resolvePtr(hostname, callback)</code>å‡½æ•°æ˜¯ç”¨æ¥è¿›è¡Œ DNS é€†å‘æŸ¥è¯¢çš„ã€‚æ‰€è°“é€†å‘æŸ¥è¯¢ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯é€šè¿‡ç½‘ç»œä¸Šçš„ IP åœ°å€æ‰¾åˆ°å¯¹åº”çš„åŸŸåã€‚è¿™ä¸æˆ‘ä»¬é€šå¸¸çš„ DNS æŸ¥è¯¢ï¼ˆæ­£å‘æŸ¥è¯¢ï¼‰ç›¸åï¼Œæ­£å‘æŸ¥è¯¢æ˜¯é€šè¿‡åŸŸåæ¥æŸ¥æ‰¾å¯¹åº”çš„ IP åœ°å€ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ DNSï¼š</p><p>DNSï¼ˆDomain Name Systemï¼‰æ˜¯äº’è”ç½‘çš„ä¸€é¡¹æ ¸å¿ƒæœåŠ¡ï¼Œå®ƒä½œä¸ºå°†äººç±»å‹å¥½çš„åŸŸåï¼ˆå¦‚ <code>www.example.com</code>ï¼‰è½¬æ¢ä¸ºæœºå™¨èƒ½ç†è§£çš„ IP åœ°å€ï¼ˆå¦‚ <code>192.0.2.1</code>ï¼‰çš„ç¿»è¯‘ç³»ç»Ÿã€‚</p><p>ç°åœ¨æ¥å…·ä½“è®²è®²<code>dns.resolvePtr()</code>å‡½æ•°ï¼š</p><ul><li><code>hostname</code>: è¿™ä¸ªå‚æ•°æŒ‡çš„æ˜¯ä½ æƒ³è¦æŸ¥è¯¢çš„ IP åœ°å€ã€‚</li><li><code>callback</code>: è¿™æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨ DNS æŸ¥è¯¢å®Œæˆåä¼šè¢«è°ƒç”¨ã€‚è¿™ä¸ªå›è°ƒå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼š<code>error</code>å’Œ<code>addresses</code>ã€‚å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œ<code>error</code>ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼›å¦‚æœæŸ¥è¯¢æˆåŠŸï¼Œ<code>addresses</code>åˆ™ä¼šåŒ…å«æŸ¥è¯¢åˆ°çš„åŸŸåæ•°ç»„ã€‚</li></ul><p>ä½¿ç”¨<code>dns.resolvePtr()</code>çš„å®é™…ä¾‹å­ï¼š</p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª IP åœ°å€<code>8.8.8.8</code>ï¼Œè¿™æ˜¯ Google çš„å…¬å…± DNS æœåŠ¡å™¨ä¹‹ä¸€ã€‚æˆ‘ä»¬æƒ³è¦æ‰¾å‡ºå“ªäº›åŸŸåä¸è¿™ä¸ª IP åœ°å€ç›¸å…³è”ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ª Node.js è„šæœ¬ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨<code>dns.resolvePtr()</code>æ¥å®ç°è¿™ä¸ªç›®çš„ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬è¦æŸ¥è¯¢çš„IPåœ°å€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> ipAddress</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;8.8.8.8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨dns.resolvePtræ¥è¿›è¡Œé€†å‘DNSæŸ¥è¯¢</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolvePtr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ipAddress</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¦‚æœå‡ºç°é”™è¯¯ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;DNS reverse lookup failed:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œæ‰“å°æŸ¥è¯¢åˆ°çš„åŸŸå</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Reverse lookup for </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ipAddress</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`- </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">address</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ä½ è¿è¡Œè¿™æ®µä»£ç æ—¶ï¼Œå®ƒä¼šè¾“å‡ºä¸ IP åœ°å€<code>8.8.8.8</code>ç›¸å…³è”çš„æ‰€æœ‰åŸŸåã€‚è¿™åœ¨å¾ˆå¤šæƒ…å†µä¸‹éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚å®‰å…¨åˆ†æä¸­ç¡®å®šæ”»å‡»è€…çš„åŸŸåï¼Œæˆ–è€…åœ¨ç½‘ç»œç®¡ç†ä¸­è·Ÿè¸ªé…ç½®é—®é¢˜ç­‰ã€‚</p><p>è®°ä½ï¼Œç”±äºä¸æ˜¯æ‰€æœ‰çš„ IP åœ°å€éƒ½ä¼šè®¾ç½® PTR è®°å½•ï¼Œå› æ­¤å¹¶éæ¯æ¬¡é€†å‘ DNS æŸ¥è¯¢éƒ½ä¼šè¿”å›ç»“æœã€‚PTR è®°å½•éœ€è¦ç”±æ‹¥æœ‰ IP åœ°å€çš„å®ä½“ï¼ˆé€šå¸¸æ˜¯ ISP æˆ–æ‰˜ç®¡æœåŠ¡æä¾›å•†ï¼‰ä¸»åŠ¨è®¾ç½®ã€‚</p><h2 id="dns-resolvesoa-hostname-callback" tabindex="-1"><a class="header-anchor" href="#dns-resolvesoa-hostname-callback"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnsresolvesoahostname-callback" target="_blank" rel="noopener noreferrer">dns.resolveSoa(hostname, callback)</a></span></a></h2><p>Node.js ä¸­çš„ <code>dns.resolveSoa(hostname, callback)</code> æ˜¯ä¸€ä¸ªç”¨äºæŸ¥è¯¢åŸŸåçš„â€œå¼€å§‹æˆæƒâ€è®°å½•ï¼ˆSOAï¼‰çš„å‡½æ•°ã€‚SOA è®°å½•æ˜¯ DNSï¼ˆåŸŸåç³»ç»Ÿï¼‰ä¸­çš„ä¸€ç§è®°å½•ï¼Œå®ƒåŒ…å«äº†å…³äºè¯¥åŸŸçš„ä¸€äº›åŸºç¡€ä¿¡æ¯ï¼Œæ¯”å¦‚åŸŸçš„ç®¡ç†å‘˜è”ç³»ä¿¡æ¯ï¼ŒåŸŸçš„ä¸»åç§°æœåŠ¡å™¨ï¼Œä»¥åŠä¸åŸŸç›¸å…³çš„æ•°æ®åˆ·æ–°é¢‘ç‡ç­‰ã€‚</p><p>åœ¨ Node.js çš„ <code>dns</code> æ¨¡å—ä¸­ï¼Œ<code>resolveSoa</code> å‡½æ•°ä¼šå¼‚æ­¥åœ°è§£ææä¾›çš„ hostnameï¼ˆä¸»æœºåæˆ–åŸŸåï¼‰ï¼Œå¹¶è¿”å›ä¸€ä¸ª SOA è®°å½•å¯¹è±¡ã€‚å¦‚æœè§£ææˆåŠŸï¼Œè¿™ä¸ªå¯¹è±¡å°†ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ç»™å›è°ƒå‡½æ•°ï¼ˆcallbackï¼‰ã€‚å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ™é”™è¯¯å¯¹è±¡ä¼šä½œä¸ºå›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ <code>dns.resolveSoa</code> çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬è¦æŸ¥è¯¢çš„åŸŸåæ˜¯ &quot;example.com&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hostname</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ resolveSoa å‡½æ•°è§£æè¯¥åŸŸåå¯¹åº”çš„ SOA è®°å½•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveSoa</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">soa</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œæ¯”å¦‚ç½‘ç»œé—®é¢˜æˆ–åŸŸåä¸å­˜åœ¨ï¼Œå°±æ‰“å°å‡ºé”™ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è§£æSOAè®°å½•æ—¶å‘ç”Ÿé”™è¯¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œå°±æ‰“å°å‡ºæ‰€å¾—åˆ°çš„ SOA è®°å½•ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;SOAè®°å½•:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">soa</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ‰“å°çš„ soa å¯¹è±¡å¯èƒ½åŒ…æ‹¬å¦‚ä¸‹å±æ€§ï¼š</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // nsname   - ä¸»NSè®°å½•</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // hostmaster - åŸŸç®¡ç†å‘˜çš„é‚®ç®±</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // serial   - åºåˆ—å·</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // refresh  - åˆ·æ–°æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // retry    - é‡è¯•æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // expire   - è¿‡æœŸæ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // minttl   - æœ€å°TTLå€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† Node.js çš„ <code>dns</code> æ¨¡å—ã€‚ç„¶åå®šä¹‰äº†æˆ‘ä»¬æƒ³è¦æŸ¥è¯¢çš„ hostname ä¸º &quot;<a href="http://example.com" target="_blank" rel="noopener noreferrer">example.com</a>&quot;ã€‚ä¹‹åè°ƒç”¨äº† <code>dns.resolveSoa</code> å‡½æ•°è¿›è¡Œå¼‚æ­¥è§£ææ“ä½œï¼Œå¹¶ä¸”å®šä¹‰äº†ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥å¤„ç†ç»“æœã€‚å¦‚æœæˆåŠŸè·å–åˆ° SOA è®°å½•ï¼Œå®ƒä¼šæ‰“å°å‡ºè¿™ä¸ªè®°å½•æ‰€åŒ…å«çš„ä¿¡æ¯ï¼›å¦‚æœå¤±è´¥ï¼Œæ¯”å¦‚å› ä¸ºç½‘ç»œé—®é¢˜æˆ–è€…åŸŸåä¸å­˜åœ¨ï¼Œå®ƒä¼šæ‰“å°å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p><p>å®é™…ä¸Šï¼ŒSOA è®°å½•é€šå¸¸ç”¨äºç®¡ç† DNS è®°å½•ï¼Œè€Œä¸æ˜¯æ—¥å¸¸ç¼–ç¨‹å·¥ä½œä¸­ç»å¸¸æ¥è§¦åˆ°çš„å†…å®¹ã€‚ä½†äº†è§£å®ƒå¯¹äºç†è§£ DNS å’Œç½‘ç»œåŸºç¡€æ¶æ„å¾ˆæœ‰å¸®åŠ©ã€‚ä¾‹å¦‚ï¼Œç½‘ç«™ç®¡ç†å‘˜å¯èƒ½éœ€è¦æŸ¥çœ‹æˆ–è€…æ›´æ–° SOA è®°å½•æ¥ç®¡ç† DNS ç¼“å­˜ï¼Œæˆ–è€…è°ƒæ•´åŸŸåçš„åˆ·æ–°å’Œé‡è¯•ç­–ç•¥ã€‚</p><h2 id="dns-resolvesrv-hostname-callback" tabindex="-1"><a class="header-anchor" href="#dns-resolvesrv-hostname-callback"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnsresolvesrvhostname-callback" target="_blank" rel="noopener noreferrer">dns.resolveSrv(hostname, callback)</a></span></a></h2><p>å¥½çš„ï¼ŒNode.js ä¸­çš„ <code>dns.resolveSrv(hostname, callback)</code> æ˜¯ä¸€ä¸ªç”¨æ¥è§£æ SRV è®°å½•çš„å‡½æ•°ã€‚SRV è®°å½•æ˜¯ä¸€ç§åœ¨ DNSï¼ˆåŸŸåç³»ç»Ÿï¼‰ä¸­å®šä¹‰ç‰¹å®šæœåŠ¡çš„æœåŠ¡å™¨çš„åœ°å€ä»¥åŠè¯¥æœåŠ¡çš„ç«¯å£å·å’Œåè®®çš„è®°å½•ã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦äº†è§£ä»€ä¹ˆæ˜¯ DNSã€‚ç®€å•æ¥è¯´ï¼ŒDNS æ˜¯äº’è”ç½‘ä¸Šçš„ç”µè¯ç°¿ã€‚å½“ä½ è¾“å…¥ä¸€ä¸ªç½‘å€ï¼Œå¦‚ <code>www.example.com</code>ï¼Œä½ çš„è®¡ç®—æœºä¼šä½¿ç”¨ DNS æ¥æŸ¥æ‰¾å¯¹åº”çš„ IP åœ°å€ï¼Œä»è€Œè¿æ¥åˆ°æ­£ç¡®çš„æœåŠ¡å™¨ã€‚</p><p>SRV è®°å½•åˆ™æ›´åŠ ç»†åŒ–ï¼Œå®ƒä¸ä»…åŒ…å«æœåŠ¡å™¨çš„åœ°å€ï¼Œè¿˜åŒ…æ‹¬äº†è¿è¡Œåœ¨æœåŠ¡å™¨ä¸Šçš„ç‰¹å®šæœåŠ¡çš„ç«¯å£å·å’Œåè®®ä¿¡æ¯ã€‚è¿™å…è®¸å®¢æˆ·ç«¯æ‰¾åˆ°æä¾›ç‰¹å®šæœåŠ¡çš„ç¡®åˆ‡ä½ç½®ï¼Œå³ä½¿è¿™äº›æœåŠ¡æ²¡æœ‰è¿è¡Œåœ¨æ ‡å‡†ç«¯å£ä¸Šã€‚</p><p>ç°åœ¨ï¼Œæ¥çœ‹ <code>dns.resolveSrv</code> è¿™ä¸ªå‡½æ•°æ€ä¹ˆä½¿ç”¨ã€‚è¿™ä¸ªå‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š</p><ol><li><code>hostname</code>ï¼šä½ æƒ³è¦æŸ¥è¯¢ SRV è®°å½•çš„åŸŸåã€‚</li><li><code>callback</code>ï¼šä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œåœ¨ DNS æŸ¥æ‰¾å®Œæˆæ—¶è¢«è°ƒç”¨ã€‚å®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼š<code>error</code> å’Œ <code>addresses</code>ã€‚å¦‚æœå‡ºç°é”™è¯¯ï¼Œ<code>error</code> ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼›å¦‚æœæˆåŠŸï¼Œ<code>addresses</code> ä¼šåŒ…å« SRV è®°å½•çš„æ•°ç»„ã€‚</li></ol><p>ä¸‹é¢æ˜¯ä¸€ä¸ª <code>dns.resolveSrv</code> çš„å®é™…ä¾‹å­ã€‚</p><p>å‡è®¾ä½ æƒ³è¦æ‰¾åˆ°ä¸€ä¸ª XMPPï¼ˆä¸€ç§å³æ—¶é€šè®¯åè®®ï¼‰æœåŠ¡çš„æœåŠ¡å™¨å’Œç«¯å£ä¿¡æ¯ï¼Œä½ å¯ä»¥è¿™æ ·ä½¿ç”¨ <code>dns.resolveSrv</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬è¦æŸ¥æ‰¾çš„XMPPæœåŠ¡çš„åŸŸåæ˜¯ &quot;xmpp-server.example.com&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveSrv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;xmpp-server.example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å‘ç”Ÿé”™è¯¯ï¼Œå¯èƒ½æ˜¯å› ä¸ºç½‘ç»œé—®é¢˜æˆ–è€…åŸŸåä¸å­˜åœ¨ç­‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ— æ³•è§£æSRVè®°å½•ï¼š&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æˆåŠŸè·å–SRVè®°å½•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;SRVè®°å½•ï¼š&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // addresses å¯èƒ½ç±»ä¼¼äºï¼š</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // [</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    //   { name: &#39;server1.example.com&#39;, port: 5222, priority: 10, weight: 5 },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    //   { name: &#39;server2.example.com&#39;, port: 5222, priority: 20, weight: 5 }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // ]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // è¿™é‡Œçš„ &#39;name&#39; å¯¹åº”æœåŠ¡çš„ä¸»æœºåï¼Œ&#39;port&#39; æ˜¯æœåŠ¡çš„ç«¯å£å·ã€‚</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // &#39;priority&#39; å’Œ &#39;weight&#39; ç”¨äºåœ¨æœ‰å¤šä¸ªæœåŠ¡å™¨å¯ç”¨æ—¶å†³å®šä¼˜é€‰å“ªä¸ªã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœè§£ææˆåŠŸï¼Œä½ å°†å¾—åˆ°ä¸€ä¸ªåŒ…å«å„ä¸ªæœåŠ¡å™¨ä¿¡æ¯çš„æ•°ç»„ï¼Œå…¶ä¸­åŒ…æ‹¬æœåŠ¡å™¨çš„åŸŸåã€ç«¯å£ä»¥åŠå…¶ä»–å¯èƒ½çš„ SRV è®°å½•ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯å¯ä»¥ç”¨äºé…ç½®å®¢æˆ·ç«¯è¿æ¥åˆ°æ­£ç¡®çš„æœåŠ¡å™¨å’Œç«¯å£ã€‚</p><p>è®°ä½ï¼Œä½¿ç”¨ <code>dns.resolveSrv</code> è¿›è¡Œ DNS æŸ¥è¯¢æ˜¯å¼‚æ­¥çš„ï¼Œè¿™æ„å‘³ç€ä»£ç ä¸ä¼šåœåœ¨é‚£é‡Œç­‰å¾… DNS å“åº”ï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œä¸‹å»ã€‚å½“ DNS å“åº”åˆ°è¾¾æ—¶ï¼Œä¼šè°ƒç”¨ä¼ å…¥çš„å›è°ƒå‡½æ•°æ¥å¤„ç†ç»“æœã€‚</p><h2 id="dns-resolvetxt-hostname-callback" tabindex="-1"><a class="header-anchor" href="#dns-resolvetxt-hostname-callback"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnsresolvetxthostname-callback" target="_blank" rel="noopener noreferrer">dns.resolveTxt(hostname, callback)</a></span></a></h2><p><code>dns.resolveTxt(hostname, callback)</code> æ˜¯ Node.js ä¸­ç”¨äºè§£æ DNS è®°å½•çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå±äº<code>dns</code>æ¨¡å—ã€‚åœ¨äº’è”ç½‘ä¸­ï¼ŒåŸŸåç³»ç»Ÿï¼ˆDNSï¼‰æ˜¯å¸®åŠ©å°†äººç±»å¯è¯»çš„åŸŸåè½¬æ¢æˆæœºå™¨èƒ½ç†è§£çš„ IP åœ°å€çš„ç³»ç»Ÿã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒDNS è¿˜èƒ½å­˜å‚¨æ›´å¤šç±»å‹çš„ä¿¡æ¯ï¼ŒTXT è®°å½•å°±æ˜¯å…¶ä¸­ä¸€ç§ã€‚</p><p>TXT è®°å½•é€šå¸¸åŒ…å«äº†äººç±»å¯è¯»çš„æ–‡æœ¬ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¯ä»¥è¢«ç”¨äºå„ç§ç›®çš„ï¼Œæ¯”å¦‚éªŒè¯åŸŸåæ‰€æœ‰æƒã€æä¾›é¢å¤–çš„ä¿¡æ¯ç­‰ã€‚</p><p>ä¸‹é¢æ˜¯<code>dns.resolveTxt()</code>å‡½æ•°çš„åŸºç¡€ä»‹ç»å’Œä½¿ç”¨ä¾‹å­ï¼š</p><h3 id="å‡½æ•°åŸå‹" tabindex="-1"><a class="header-anchor" href="#å‡½æ•°åŸå‹"><span>å‡½æ•°åŸå‹</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveTxt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>hostname</code>: ä½ æƒ³è¦æŸ¥è¯¢ TXT è®°å½•çš„åŸŸåï¼ˆå­—ç¬¦ä¸²ç±»å‹ï¼‰ã€‚</li><li><code>callback</code>: å›è°ƒå‡½æ•°ï¼Œåœ¨è§£æå®Œæˆæˆ–å‘ç”Ÿé”™è¯¯æ—¶è¢«è°ƒç”¨ã€‚è¿™ä¸ªå›è°ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼š<code>error</code> å’Œ <code>records</code>ã€‚å¦‚æœå‡ºé”™äº†ï¼Œ<code>error</code>ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼›å¦åˆ™ï¼Œ<code>error</code>ä¸º<code>null</code>ï¼Œ<code>records</code>ä¼šæ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†å¯¹åº”åŸŸåçš„æ‰€æœ‰ TXT è®°å½•ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>éªŒè¯åŸŸåæ‰€æœ‰æƒ</strong>ï¼š<br> å½“ä½ åœ¨ä½¿ç”¨æŸäº›æœåŠ¡ï¼ˆæ¯”å¦‚ Google Workspace æˆ–è€…å…¶ä»–é‚®ä»¶æœåŠ¡ï¼‰æ—¶ï¼Œä»–ä»¬å¯èƒ½è¦æ±‚ä½ æ·»åŠ ä¸€ä¸ªç‰¹å®šå†…å®¹çš„ TXT è®°å½•åˆ°ä½ çš„åŸŸåè§£æè®¾ç½®é‡Œï¼Œä»¥è¯æ˜ä½ æ‹¥æœ‰è¯¥åŸŸåã€‚ä½ å¯ä»¥ä½¿ç”¨<code>dns.resolveTxt()</code>æ¥ç¡®è®¤è¿™ä¸ªè®°å½•å·²è¢«æ­£ç¡®æ·»åŠ ã€‚</p></li><li><p><strong>å‘é€é‚®ä»¶æ—¶é˜²æ­¢åƒåœ¾é‚®ä»¶</strong>ï¼š<br> ä½¿ç”¨ SPF(Sender Policy Framework)è®°å½•ï¼Œä¸€ä¸ª TXT è®°å½•çš„å½¢å¼ï¼Œå¯ä»¥å¸®åŠ©æ¥æ”¶é‚®ä»¶æœåŠ¡å™¨æ£€æŸ¥å‘é‚®ä»¶çš„æœåŠ¡å™¨æ˜¯å¦è¢«åŸŸåæ‰€æœ‰è€…æˆæƒã€‚è¿™æœ‰åŠ©äºå‡å°‘åƒåœ¾é‚®ä»¶ã€‚</p></li><li><p><strong>DNS-based Authentication of Named Entities (DANE)</strong>:<br> é€šè¿‡ TXT è®°å½•å¯ä»¥å®ç° DANEï¼Œå®ƒåˆ©ç”¨ DNSSEC ä¿æŠ¤åŸŸåå’ŒæœåŠ¡çš„ TLS è¯ä¹¦ä¸è¢«ç¯¡æ”¹ã€‚</p></li></ol><h3 id="ç¤ºä¾‹ä»£ç -1" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç -1"><span>ç¤ºä¾‹ä»£ç </span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬è¦æŸ¥è¯¢ &#39;example.com&#39; çš„ TXT è®°å½•ã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hostname</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveTxt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">records</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¦‚æœæœ‰é”™è¯¯ï¼Œæ‰“å°å‡ºæ¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è§£æTXTè®°å½•æ—¶å‘ç”Ÿé”™è¯¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æˆåŠŸè§£æï¼Œæ‰“å°å‡ºæ‰€æœ‰TXTè®°å½•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> çš„ TXT è®°å½•:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">records</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ä½ è¿è¡Œè¿™æ®µä»£ç æ—¶ï¼Œå®ƒä¼šå°è¯•è·å–<code>example.com</code>çš„ TXT è®°å½•ï¼Œå¹¶ä¸”å°†ç»“æœæ‰“å°åˆ°æ§åˆ¶å°ä¸Šã€‚å¦‚æœæˆåŠŸï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢åŒ…å«äº†è¿™ä¸ªåŸŸåæ‰€æœ‰çš„ TXT è®°å½•ã€‚è¿™æ ·ï¼Œä½ å°±å¯ä»¥æŸ¥çœ‹æ˜¯å¦å­˜åœ¨ç‰¹å®šçš„ TXT è®°å½•ï¼Œæˆ–è€…è¿™äº›è®°å½•çš„å†…å®¹æ˜¯å¦ç¬¦åˆæœŸæœ›å€¼ã€‚</p><h2 id="dns-reverse-ip-callback" tabindex="-1"><a class="header-anchor" href="#dns-reverse-ip-callback"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnsreverseip-callback" target="_blank" rel="noopener noreferrer">dns.reverse(ip, callback)</a></span></a></h2><p><code>dns.reverse(ip, callback)</code>æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºè¿›è¡Œ DNS é€†å‘è§£æã€‚æ‰€è°“çš„é€†å‘è§£æï¼Œå°±æ˜¯å°† IP åœ°å€è½¬æ¢æˆå¯¹åº”çš„åŸŸåã€‚è¿™ä¸ªå‡½æ•°å±äº Node.js çš„ DNS æ¨¡å—ï¼Œè¯¥æ¨¡å—æä¾›äº†ä¸€ç³»åˆ—ç”¨äºä¸åŸŸåæœåŠ¡å™¨è¿›è¡Œäº¤äº’çš„å‡½æ•°ã€‚</p><p>å½“ä½ è°ƒç”¨<code>dns.reverse()</code>æ—¶ï¼Œéœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼š</p><ol><li><code>ip</code>ï¼šè¿™æ˜¯ä½ æƒ³è¦è¿›è¡Œé€†å‘è§£æçš„ IPv4 æˆ– IPv6 åœ°å€çš„å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚<code>&quot;8.8.8.8&quot;</code>ã€‚</li><li><code>callback</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“é€†å‘è§£ææ“ä½œå®Œæˆæ—¶ï¼ŒNode.js ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¹¶å°†ç»“æœæˆ–é”™è¯¯ä¿¡æ¯ä½œä¸ºå‚æ•°ä¼ é€’ç»™å®ƒã€‚</li></ol><p>å›è°ƒå‡½æ•°é€šå¸¸æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š</p><ul><li><code>err</code>ï¼šå¦‚æœå‡ºç°é”™è¯¯ï¼Œåˆ™æ­¤å‚æ•°åŒ…å«é”™è¯¯ä¿¡æ¯ï¼›å¦‚æœæ“ä½œæˆåŠŸï¼Œåˆ™æ­¤å‚æ•°ä¸º<code>null</code>ã€‚</li><li><code>hostnames</code>ï¼šå¦‚æœæ“ä½œæˆåŠŸï¼Œè¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼ŒåŒ…å«ä¸æŒ‡å®š IP åœ°å€ç›¸å¯¹åº”çš„æ‰€æœ‰åŸŸåã€‚</li></ul><p>ä¸‹é¢æ˜¯ä¸€ä¸ª<code>dns.reverse()</code>å‡½æ•°çš„ä½¿ç”¨ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”¨Googleçš„å…¬å…±DNSæœåŠ¡å™¨8.8.8.8ä½œä¸ºä¾‹å­</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> ipAddress</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;8.8.8.8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è°ƒç”¨dns.reverse()è¿›è¡Œé€†å‘è§£æ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">reverse</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ipAddress</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">hostnames</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`é€†å‘è§£æå¤±è´¥: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">err</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ‰“å°å‡ºé€†å‘è§£æå¾—åˆ°çš„åŸŸåæ•°ç»„</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`é€†å‘è§£æ</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ipAddress</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">å¾—åˆ°çš„åŸŸå: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostnames</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œä»¥ä¸Šä»£ç åï¼Œå¦‚æœæ²¡æœ‰é”™è¯¯å‘ç”Ÿï¼Œä½ å°†åœ¨æ§åˆ¶å°ä¸Šçœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„è¾“å‡ºï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>é€†å‘è§£æ8.8.8.8å¾—åˆ°çš„åŸŸå: [&#39;google-public-dns-a.google.com&#39;]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™è¡¨æ˜ IP åœ°å€<code>8.8.8.8</code>è¢«é€†å‘è§£æåˆ°äº†åŸŸå<code>google-public-dns-a.google.com</code>ã€‚</p><p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œé€†å‘è§£æå¯ä»¥å¸®åŠ©ä½ è·å–å®¢æˆ·ç«¯çš„åŸŸåä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªç½‘ç»œæ—¥å¿—åˆ†æç³»ç»Ÿä¸­ï¼Œä½ å¯èƒ½ä¼šè®°å½•è®¿é—®è€…çš„ IP åœ°å€ï¼Œç„¶åä½¿ç”¨é€†å‘è§£ææ¥æ‰¾å‡ºè®¿é—®è€…æ‰€ä»£è¡¨çš„ç»„ç»‡æˆ–æœåŠ¡æä¾›å•†ã€‚è¿™æ ·å¯ä»¥å¸®åŠ©ç†è§£æµé‡æ¥æºï¼Œä»è€Œæ›´å¥½åœ°ä¼˜åŒ–æœåŠ¡å’Œå®‰å…¨ç­–ç•¥ã€‚</p><h2 id="dns-setdefaultresultorder-order" tabindex="-1"><a class="header-anchor" href="#dns-setdefaultresultorder-order"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnssetdefaultresultorderorder" target="_blank" rel="noopener noreferrer">dns.setDefaultResultOrder(order)</a></span></a></h2><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥æ¢è®¨ä¸€ä¸‹ Node.js ä¸­ <code>dns.setDefaultResultOrder(order)</code> çš„åŠŸèƒ½ã€‚</p><p>é¦–å…ˆï¼Œ<code>dns</code> æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªæ¨¡å—ï¼Œå®ƒå…è®¸ä½ ä¸ç½‘ç»œä¸Šçš„åŸŸåç³»ç»Ÿï¼ˆDNSï¼‰è¿›è¡Œäº¤äº’ã€‚ç®€å•æ¥è¯´ï¼ŒDNS å°±åƒæ˜¯äº’è”ç½‘çš„ç”µè¯ç°¿ï¼Œå®ƒå°†äººä»¬å®¹æ˜“è®°ä½çš„åŸŸåï¼ˆä¾‹å¦‚ &quot;<a href="http://google.com" target="_blank" rel="noopener noreferrer">google.com</a>&quot;ï¼‰è½¬æ¢æˆè®¡ç®—æœºå¯ä»¥ç†è§£çš„ IP åœ°å€ï¼ˆä¾‹å¦‚ &quot;172.217.14.196&quot;ï¼‰ï¼Œè¿™æ ·ç”µè„‘æ‰èƒ½æ‰¾åˆ°å¹¶è¿æ¥åˆ°æ­£ç¡®çš„æœåŠ¡å™¨ã€‚</p><p><code>dns.setDefaultResultOrder(order)</code> è¿™ä¸ªå‡½æ•°å…è®¸ä½ è®¾ç½®åœ¨ä½¿ç”¨ DNS è§£æåŸŸåæ—¶è¿”å›ç»“æœçš„é¡ºåºã€‚å½“ä½ è°ƒç”¨è¯¸å¦‚ <code>dns.resolve4()</code> æˆ– <code>dns.resolve6()</code> ä¹‹ç±»çš„å‡½æ•°å»è·å–ä¸€ä¸ªåŸŸåçš„ IPv4 æˆ– IPv6 åœ°å€æ—¶ï¼Œä¼šæ¶‰åŠåˆ°å¤šä¸ªç»“æœçš„æ’åºé—®é¢˜ã€‚</p><p>é€šå¸¸ï¼Œä¸€ä¸ªåŸŸåå¯èƒ½å¯¹åº”å¤šä¸ª IP åœ°å€ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä¸€ä¸ªå¤§å‹ç½‘ç«™æœ‰å¤šå°æœåŠ¡å™¨åˆ†å¸ƒåœ¨å…¨çƒä¸åŒçš„åœ°æ–¹ï¼Œé‚£ä¹ˆè¿™ä¸ªç½‘ç«™çš„åŸŸåå¯èƒ½å°±ä¼šæœ‰å¤šä¸ª IP åœ°å€ã€‚å½“ä½ é€šè¿‡ DNS æŸ¥è¯¢è¿™ä¸ªåŸŸåæ—¶ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªåŒ…å«å¤šä¸ª IP åœ°å€çš„åˆ—è¡¨ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒNode.js ä¼šä»¥æ”¶åˆ°å®ƒä»¬çš„é¡ºåºè¿”å›è¿™äº› IP åœ°å€ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶å€™ä½ å¯èƒ½æƒ³è¦è¿™äº›ç»“æœæŒ‰ç…§æŸç§ç‰¹å®šçš„é¡ºåºæ’åºï¼Œæ¯”å¦‚ IPv4 åœ°å€ä¼˜å…ˆäº IPv6 åœ°å€ï¼Œæˆ–è€…ç›¸åã€‚è¿™å°±æ˜¯ <code>dns.setDefaultResultOrder(order)</code> å‡½æ•°çš„ä½œç”¨æ‰€åœ¨ã€‚</p><p>è®©æˆ‘ä»¬æ¥çœ‹ä¸¤ä¸ªå‚æ•° <code>order</code> å¯ä»¥å–çš„å€¼ï¼š</p><ol><li><p><code>&#39;ipv4first&#39;</code> - å¦‚æœä½ è®¾ç½® <code>order</code> ä¸º <code>&#39;ipv4first&#39;</code>ï¼Œé‚£ä¹ˆå½“æŸ¥è¯¢ç»“æœä¸­åŒæ—¶åŒ…å« IPv4 å’Œ IPv6 åœ°å€æ—¶ï¼ŒIPv4 åœ°å€ä¼šè¢«æ”¾åœ¨æ•°ç»„çš„å‰é¢ã€‚</p></li><li><p><code>&#39;verbatim&#39;</code> - å¦‚æœä½ è®¾ç½® <code>order</code> ä¸º <code>&#39;verbatim&#39;</code>ï¼ŒDNS æ¨¡å—ä¼šä¿æŒè¿”å›ç»“æœçš„åŸå§‹é¡ºåºï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ä¼šåšä»»ä½•æ’åºå¤„ç†ã€‚</p></li></ol><p>å…·ä½“çš„ä½¿ç”¨ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½® DNS ç»“æœæ’åºï¼Œä½¿ IPv4 åœ°å€ä¼˜å…ˆè¿”å›</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setDefaultResultOrder</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ipv4first&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`IPv4 åœ°å€: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ example.com å¯¹åº”ä¸¤ä¸ª IPv4 åœ°å€å’Œä¸€ä¸ª IPv6 åœ°å€ï¼Œè¾“å‡ºå¯èƒ½ä¼šç±»ä¼¼ï¼š</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// IPv4 åœ°å€: [ &#39;93.184.216.34&#39;, &#39;93.184.216.35&#39; ]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† <code>dns</code> æ¨¡å—ï¼Œç„¶åé€šè¿‡ <code>dns.setDefaultResultOrder(&#39;ipv4first&#39;)</code> è®¾ç½®äº†ç»“æœæ’åºã€‚è¿™æ„å‘³ç€å½“æˆ‘ä»¬ä½¿ç”¨ <code>dns.resolve4(&#39;example.com&#39;, callback)</code> æŸ¥è¯¢åŸŸå &quot;<a href="http://example.com" target="_blank" rel="noopener noreferrer">example.com</a>&quot; çš„ IPv4 åœ°å€æ—¶ï¼Œå°†ä¼šå¾—åˆ°ä¸€ä¸ªåˆ—è¡¨ï¼Œå…¶ä¸­ IPv4 åœ°å€ä¼šæ’åœ¨å‰é¢ã€‚</p><p>è¯·æ³¨æ„ï¼Œå®é™…ä½¿ç”¨æ—¶ï¼Œå¹¶éæ‰€æœ‰ç‰ˆæœ¬çš„ Node.js éƒ½æ”¯æŒ <code>dns.setDefaultResultOrder(order)</code> æ–¹æ³•ã€‚åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œæ‚¨éœ€è¦ç¡®è®¤æ­£åœ¨ä½¿ç”¨çš„ Node.js ç‰ˆæœ¬æ˜¯å¦æä¾›æ­¤åŠŸèƒ½ã€‚</p><h2 id="dns-getdefaultresultorder" tabindex="-1"><a class="header-anchor" href="#dns-getdefaultresultorder"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnsgetdefaultresultorder" target="_blank" rel="noopener noreferrer">dns.getDefaultResultOrder()</a></span></a></h2><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬ç®€å•æ˜äº†åœ°èŠä¸€ä¸‹ Node.js ä¸­çš„ <code>dns.getDefaultResultOrder()</code> å‡½æ•°ã€‚</p><p>DNSï¼Œå³åŸŸåç³»ç»Ÿï¼Œå®ƒä¸»è¦ç”¨æ¥å°†æ˜“äºè®°å¿†çš„åŸŸåï¼ˆæ¯”å¦‚ <code>google.com</code>ï¼‰è½¬æ¢ä¸ºå®é™…çš„ IP åœ°å€ï¼ˆæ¯”å¦‚ <code>142.250.190.14</code>ï¼‰ï¼Œè¿™æ ·ä½ çš„è®¡ç®—æœºå°±èƒ½æ‰¾åˆ°å¹¶è¿æ¥åˆ°æ­£ç¡®çš„æœåŠ¡å™¨ã€‚</p><p>åœ¨ Node.js v21.7.1 æ–‡æ¡£ä¸­æåˆ°çš„ <code>dns.getDefaultResultOrder()</code> æ˜¯ä¸€ä¸ªä¸ DNS è§£æç›¸å…³çš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå‘Šè¯‰ä½ å½“ DNS æŸ¥è¯¢è¿”å›å¤šä¸ª IP åœ°å€æ—¶ï¼Œé»˜è®¤çš„ç»“æœæ’åºæ˜¯æ€æ ·çš„ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå½“ä½ è¯·æ±‚ä¸€ä¸ªåŸŸåçš„ IP åœ°å€ï¼Œå¯èƒ½ä¼šå¾—åˆ°ä¸€ä¸ª IPv4 åœ°å€çš„åˆ—è¡¨å’Œ/æˆ–ä¸€ä¸ª IPv6 åœ°å€çš„åˆ—è¡¨ã€‚é»˜è®¤çš„ç»“æœæ’åºä¼šå½±å“ä½ æ”¶åˆ°è¿™äº›åœ°å€çš„é¡ºåºï¼Œè¿™å¯èƒ½ä¼šè¿›ä¸€æ­¥å½±å“åˆ°ä½ çš„åº”ç”¨ç¨‹åºè¿æ¥åˆ°å“ªä¸ªå…·ä½“çš„æœåŠ¡å™¨åœ°å€ã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œé»˜è®¤æ’åºå¯èƒ½æ˜¯é¦–å…ˆ IPv4ï¼Œç„¶åæ˜¯ IPv6ï¼Œæˆ–è€…åè¿‡æ¥ã€‚è¿™æ„å‘³ç€å¦‚æœä¸€ä¸ªåŸŸååŒæ—¶æœ‰ IPv4 å’Œ IPv6 åœ°å€å¯ç”¨ï¼ŒNode.js ä¼šæ ¹æ®è¿™ä¸ªé»˜è®¤é¡ºåºæ¥é€‰æ‹©ä½¿ç”¨å“ªä¸€ä¸ªåœ°å€è¿›è¡Œè¿æ¥ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸ªå‡è®¾çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æƒ³çŸ¥é“é»˜è®¤çš„ DNS ç»“æœæ’åºæ˜¯ä»€ä¹ˆ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> defaultOrder</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getDefaultResultOrder</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">defaultOrder</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™å¯èƒ½ä¼šè¾“å‡º &quot;ipv4first&quot; æˆ–è€… &quot;verbatim&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åªæ˜¯ç®€å•åœ°è°ƒç”¨äº† <code>getDefaultResultOrder()</code> å‡½æ•°ï¼Œå¹¶æ‰“å°å‡ºäº†å®ƒçš„è¿”å›å€¼ã€‚è¿™ä¸ªå€¼ç»™ä½ çš„ä»£ç æä¾›äº†å…³äºå¦‚ä½•å¤„ç†å¤šä¸ª DNS ç»“æœçš„çº¿ç´¢ã€‚è€Œå®é™…ä¸Šï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œå¼€å‘è€…ä¸éœ€è¦æ‰‹åŠ¨å¹²é¢„è¿™ä¸ªé¡ºåºï¼Œå› ä¸º Node.js çš„ç½‘ç»œåº“å·²ç»ä¸ºä½ å¤„ç†å¥½äº†é»˜è®¤çš„è¿æ¥é€»è¾‘ã€‚</p><p>æ€»ä¹‹ï¼Œ<code>dns.getDefaultResultOrder()</code> å‡½æ•°å…è®¸ä½ è·çŸ¥ Node.js åœ¨è§£æ DNS æ—¶é»˜è®¤é‡‡ç”¨çš„ IP åœ°å€ç»“æœæ’åºæ–¹å¼ï¼Œè¿™å¯¹äºç†è§£å’Œè°ƒè¯•æ¶‰åŠç½‘ç»œè¿æ¥çš„åº”ç”¨ç¨‹åºè¡Œä¸ºå¯èƒ½å¾ˆæœ‰å¸®åŠ©ã€‚</p><h2 id="dns-setservers-servers" tabindex="-1"><a class="header-anchor" href="#dns-setservers-servers"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnssetserversservers" target="_blank" rel="noopener noreferrer">dns.setServers(servers)</a></span></a></h2><p>åœ¨è§£é‡Š <code>dns.setServers(servers)</code> ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£ä¸€äº›åŸºæœ¬çš„æ¦‚å¿µã€‚</p><p><strong>DNS</strong>ï¼ˆDomain Name Systemï¼‰æ˜¯ç½‘ç»œæœåŠ¡ï¼Œå®ƒå°†äººç±»å¯è¯»çš„åŸŸåï¼ˆä¾‹å¦‚ï¼š<code>www.google.com</code>ï¼‰è½¬æ¢ä¸ºæœºå™¨å¯è¯»çš„ IP åœ°å€ï¼ˆä¾‹å¦‚ï¼š<code>172.217.10.14</code>ï¼‰ï¼Œè¿™æ ·è®¡ç®—æœºæ‰èƒ½å®šä½å¹¶è®¿é—®è¿™äº›ç½‘ç«™ã€‚</p><p><strong>Node.js</strong> æ˜¯ä¸€ä¸ªå¼€æºå’Œè·¨å¹³å°çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚Node.js ä¸­æœ‰ä¸€ä¸ª <code>dns</code> æ¨¡å—ï¼Œå®ƒæä¾›äº†ç”¨äºä¸ DNS æœåŠ¡å™¨è¿›è¡Œäº¤äº‘å’ŒæŸ¥è¯¢çš„åŠŸèƒ½ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ <code>dns.setServers(servers)</code> çš„ä½œç”¨ï¼š</p><p><code>dns.setServers(servers)</code> æ˜¯ <code>dns</code> æ¨¡å—æä¾›çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå…è®¸ä½ åœ¨ Node.js åº”ç”¨ç¨‹åºä¸­åŠ¨æ€åœ°æ›´æ”¹ç”¨äºè§£æ DNS çš„æœåŠ¡å™¨ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼ŒDNS è§£æä¼šä½¿ç”¨æ“ä½œç³»ç»Ÿé…ç½®çš„ DNS æœåŠ¡å™¨ï¼Œä½†æœ‰æ—¶ä½ å¯èƒ½éœ€è¦è‡ªå®šä¹‰è§£æç­–ç•¥ï¼Œæ¯”å¦‚ä½¿ç”¨ä¸åŒçš„ DNS æœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ã€‚</p><h3 id="è¯­æ³•" tabindex="-1"><a class="header-anchor" href="#è¯­æ³•"><span>è¯­æ³•</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">servers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>servers</code> å‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²éƒ½æ˜¯æŒ‡å®šçš„ DNS æœåŠ¡å™¨çš„ IP åœ°å€ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-2"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨åˆ›å»ºä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œéœ€è¦æ ¹æ®ç”¨æˆ·çš„åœ°ç†ä½ç½®æˆ–ç‰¹å®šæ¡ä»¶ä½¿ç”¨ä¸åŒçš„ DNS æœåŠ¡å™¨æ¥è§£æåŸŸåã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥Node.jsä¸­çš„dnsæ¨¡å—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯é»˜è®¤çš„DNSæœåŠ¡å™¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> defaultServers</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;8.8.8.8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;8.8.4.4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™äº›æ˜¯Googleçš„å…¬å…±DNSæœåŠ¡å™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">defaultServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥å½“å‰è®¾ç½®çš„Serveråˆ—è¡¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Default DNS Servers: &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¥ä¸‹æ¥ï¼Œæ ¹æ®æŸäº›æ¡ä»¶ï¼Œä½ æƒ³è¦åˆ‡æ¢åˆ°å¦ä¸€ç»„DNSæœåŠ¡å™¨ï¼Œæ¯”å¦‚OpenDNSçš„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> specialCondition</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä¸€ä¸ªç‰¹å®šçš„æ¡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">specialCondition</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> customServers</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;208.67.222.222&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;208.67.220.220&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// OpenDNSæœåŠ¡å™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">customServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Custom DNS Servers (after condition): &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨DNSæŸ¥è¯¢å°†é€šè¿‡æ–°è®¾ç½®çš„OpenDNSæœåŠ¡å™¨æ¥å®Œæˆ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Addresses: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">JSON</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">stringify</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† <code>dns</code> æ¨¡å—ï¼Œå¹¶ä¸”è®¾ç½®äº†ä¸€ä¸ªé»˜è®¤çš„ DNS æœåŠ¡å™¨åˆ—è¡¨ã€‚ç„¶åï¼Œæˆ‘ä»¬æ£€æŸ¥äº†ä¸€ä¸ªç‰¹å®šçš„æ¡ä»¶ï¼Œå¦‚æœè¯¥æ¡ä»¶ä¸ºçœŸï¼Œåˆ™æ›´æ”¹ä¸ºå¦ä¸€ç»„ DNS æœåŠ¡å™¨ã€‚æœ€åï¼Œæˆ‘ä»¬æ‰§è¡Œäº†ä¸€ä¸ª DNS æŸ¥è¯¢ï¼ŒæŸ¥è¯¢çš„ç»“æœå°†é€šè¿‡æˆ‘ä»¬æœ€è¿‘è®¾ç½®çš„ DNS æœåŠ¡å™¨è¿”å›ã€‚</p><p>é‡è¦çš„æ˜¯æ³¨æ„ï¼Œä¿®æ”¹ DNS æœåŠ¡å™¨åªä¼šå½±å“ä½¿ç”¨ Node.js <code>dns</code> æ¨¡å—å‘èµ·çš„æŸ¥è¯¢ï¼Œè€Œä¸ä¼šå½±å“æ“ä½œç³»ç»Ÿçº§åˆ«æˆ–å…¶ä»–ç¨‹åºçš„ DNS æŸ¥è¯¢ã€‚</p><p>å¸Œæœ›è¿™ä¸ªè§£é‡Šå’Œä¾‹å­å¯ä»¥å¸®åŠ©ä½ ç†è§£ <code>dns.setServers(servers)</code> åœ¨ Node.js ä¸­çš„ç”¨æ³•å’Œç›®çš„ã€‚</p><h2 id="dns-promises-api" tabindex="-1"><a class="header-anchor" href="#dns-promises-api"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dns-promises-api" target="_blank" rel="noopener noreferrer">DNS promises API</a></span></a></h2><p>Node.js ä¸­çš„ DNS (Domain Name System) Promises API æä¾›äº†ä¸€ç§ä½¿ç”¨ promises æ¥å¤„ç†å¼‚æ­¥ DNS æŸ¥è¯¢çš„æ–¹å¼ã€‚åœ¨ Node.js ä¸­ï¼Œä½ å¯ä»¥ç”¨ <code>require(&#39;dns&#39;).promises</code> æ¥è·å–ä¸€ä¸ªåŒ…å« DNS è§£æå‡½æ•°çš„å¯¹è±¡ï¼Œè¿™äº›å‡½æ•°è¿”å› promise å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ä¼ ç»Ÿçš„å›è°ƒå‡½æ•°ã€‚</p><p>è®©æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯ Promiseã€‚Promise æ˜¯å¼‚æ­¥ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œå®ƒä»£è¡¨äº†ä¸€ä¸ªå¯èƒ½è¿˜æ²¡æœ‰å®Œæˆï¼Œä½†æœªæ¥ä¼šå®Œæˆçš„æ“ä½œï¼Œå¹¶ä¸”æä¾›äº†ä¸€ç§æ–¹æ³•æ¥å¤„ç†å…¶æˆåŠŸå€¼æˆ–å¤±è´¥åŸå› ã€‚å½“ä½ ä½¿ç”¨ Promise çš„æ—¶å€™ï¼Œä½ å¯ä»¥å°†æ¥ä¸‹æ¥ä¾èµ–äºå¼‚æ­¥æ“ä½œç»“æœçš„ä»£ç æ”¾åœ¨ <code>.then()</code> æ–¹æ³•é‡Œé¢ï¼Œå¦‚æœå‡ºç°é”™è¯¯ï¼Œåˆ™ç”¨ <code>.catch()</code> æ–¹æ³•æ•æ‰ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ï¼ŒDNS Promises API å…è®¸ä½ æ‰§è¡Œå„ç§ DNS æŸ¥è¯¢ï¼Œå¹¶ä»¥æ›´ç°ä»£ã€æ˜“äºç®¡ç†çš„æ–¹å¼å¤„ç†ç»“æœã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å®é™…ä¾‹å­ï¼š</p><h3 id="ä¾‹å­-1-è§£æåŸŸåä¸º-ip-åœ°å€" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-è§£æåŸŸåä¸º-ip-åœ°å€"><span>ä¾‹å­ 1ï¼šè§£æåŸŸåä¸º IP åœ°å€</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> resolveDomain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">domain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> addresses</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">domain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">domain</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> çš„ IPv4 åœ°å€æ˜¯ï¼š`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`åœ¨è§£æ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">domain</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ—¶å‘ç”Ÿé”™è¯¯: `</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveDomain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>dns.resolve4()</code> å‡½æ•°æ¥å°† &#39;<a href="http://example.com" target="_blank" rel="noopener noreferrer">example.com</a>&#39; åŸŸåè§£ææˆ IPv4 åœ°å€ã€‚å½“ <code>await</code> è¡¨è¾¾å¼å®Œæˆåï¼Œå®ƒä¼šå¾—åˆ°ä¸€ä¸ªåŒ…å« IP åœ°å€çš„æ•°ç»„ï¼Œç„¶åæˆ‘ä»¬å°†å…¶æ‰“å°å‡ºæ¥ã€‚</p><h3 id="ä¾‹å­-2-åå‘è§£æ-ip-åœ°å€ä¸ºåŸŸå" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-åå‘è§£æ-ip-åœ°å€ä¸ºåŸŸå"><span>ä¾‹å­ 2ï¼šåå‘è§£æ IP åœ°å€ä¸ºåŸŸå</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> reverseLookup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">ip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> domains</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">reverse</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ip</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> å¯¹åº”çš„åŸŸåæ˜¯ï¼š`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">domains</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`åœ¨å¯¹ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ip</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> è¿›è¡Œåå‘è§£ææ—¶å‘ç”Ÿé”™è¯¯: `</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">reverseLookup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;8.8.8.8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æ­¤ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>dns.reverse()</code> æ–¹æ³•æ¥æ‰¾å‡º IP åœ°å€ &#39;8.8.8.8&#39; å¯¹åº”çš„åŸŸåã€‚è¿™é€šå¸¸ç”¨äºæ—¥å¿—åˆ†æå’Œç½‘ç»œç›‘æ§ã€‚</p><h3 id="ä¾‹å­-3-æŸ¥æ‰¾æ‰€æœ‰ç±»å‹çš„è®°å½•" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-3-æŸ¥æ‰¾æ‰€æœ‰ç±»å‹çš„è®°å½•"><span>ä¾‹å­ 3ï¼šæŸ¥æ‰¾æ‰€æœ‰ç±»å‹çš„è®°å½•</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> lookupRecords</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">domain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> records</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">domain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">domain</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> çš„æ‰€æœ‰è®°å½•ï¼š`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">records</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`åœ¨æŸ¥è¯¢ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">domain</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> çš„è®°å½•æ—¶å‘ç”Ÿé”™è¯¯: `</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookupRecords</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>dns.resolve()</code> æ–¹æ³•é»˜è®¤æƒ…å†µä¸‹ä¼šè¿”å›æŒ‡å®šåŸŸåçš„æ‰€æœ‰ç±»å‹çš„ DNS è®°å½•ã€‚</p><p>ä½¿ç”¨ DNS Promises API å¯ä»¥ä½¿ä½ çš„ä»£ç æ›´åŠ ç®€æ´å’Œæ˜“äºé˜…è¯»ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤šä¸ªå¼‚æ­¥ DNS æŸ¥è¯¢æ—¶ï¼Œä½ å¯ä»¥ç”¨ <code>Promise.all()</code> æ¥åŒæ—¶å¤„ç†å®ƒä»¬ï¼Œå¹¶ç­‰å¾…æ‰€æœ‰æŸ¥è¯¢éƒ½å®Œæˆã€‚è¿™æ ·å¯ä»¥é¿å…å›è°ƒåœ°ç‹±ï¼Œä½¿ä»£ç é€»è¾‘æ›´ä¸ºæ¸…æ™°ã€‚</p><h3 id="class-dnspromises-resolver" tabindex="-1"><a class="header-anchor" href="#class-dnspromises-resolver"><span><a href="https://nodejs.org/docs/latest/api/dns.html#class-dnspromisesresolver" target="_blank" rel="noopener noreferrer">Class: dnsPromises.Resolver</a></span></a></h3><p>Node.js ä¸­çš„ <code>dnsPromises.Resolver</code> ç±»æ˜¯ DNSï¼ˆDomain Name Systemï¼‰æ“ä½œçš„ä¸€ä¸ªå·¥å…·ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ åœ¨ Node.js åº”ç”¨ç¨‹åºä¸­æ‰§è¡Œä¸åŸŸåè§£æç›¸å…³çš„å„ç§å¼‚æ­¥ç½‘ç»œè¯·æ±‚ã€‚è¿™ä¸ªç±»çš„æ–¹æ³•éƒ½è¿”å› Promise å¯¹è±¡ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨ <code>async/await</code> æˆ– <code>.then()</code> é“¾å¼è°ƒç”¨æ¥å¤„ç†å¼‚æ­¥ç»“æœã€‚</p><p>é¦–å…ˆï¼Œç®€å•äº†è§£ä¸€ä¸‹ DNSï¼šå®ƒæ˜¯äº’è”ç½‘ä¸Šç”¨äºå°†äººç±»å¯è¯»çš„åŸŸåï¼ˆå¦‚ <code>google.com</code>ï¼‰è½¬æ¢ä¸ºæœºå™¨å¯è¯»çš„ IP åœ°å€ï¼ˆå¦‚ <code>172.217.16.206</code>ï¼‰çš„ç³»ç»Ÿã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹å‡ ä¸ª <code>dnsPromises.Resolver</code> ç±»çš„å¸¸ç”¨æ–¹æ³•å’Œå®é™…ç”¨ä¾‹ï¼š</p><ol><li><strong>åˆ›å»º Resolver å®ä¾‹</strong></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> resolver</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä»¥ä¸Šä»£ç ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª <code>Resolver</code> çš„å®ä¾‹ï¼Œå®ƒå…è®¸æˆ‘ä»¬è‡ªå®šä¹‰ DNS è§£æçš„æœåŠ¡å™¨å’Œè¡Œä¸ºã€‚</p><ol start="2"><li><strong>è®¾ç½® DNS æœåŠ¡å™¨</strong></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;8.8.8.8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;8.8.4.4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®ä¸º Google çš„å…¬å…± DNS æœåŠ¡å™¨</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ä½¿ç”¨ <code>setServers</code> æ–¹æ³•ï¼Œä½ å¯ä»¥æŒ‡å®š Resolver å®ä¾‹è¦ä½¿ç”¨çš„ DNS æœåŠ¡å™¨ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®äº† Google æä¾›çš„ä¸¤ä¸ªå…¬å…± DNS æœåŠ¡å™¨ã€‚</p><ol start="3"><li><strong>è§£æåŸŸå</strong></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> resolveDomain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">domain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> addresses</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">domain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`IP åœ°å€åˆ—è¡¨: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ— æ³•è§£æåŸŸå: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveDomain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>resolve4</code> æ–¹æ³•ç”¨äºè§£æ IPv4 åœ°å€ã€‚åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å°è¯•è§£æ <code>example.com</code> åŸŸåï¼Œå¹¶æ‰“å°å‡ºå…¶ IP åœ°å€ã€‚å¦‚æœè§£æå¤±è´¥ï¼Œä¼šæ•è·é”™è¯¯å¹¶æ‰“å°ã€‚</p><ol start="4"><li><strong>åå‘è§£æ IP åœ°å€</strong></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> reverseLookup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">ip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hostnames</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">reverse</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`å¯¹åº”çš„ä¸»æœºå: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostnames</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ— æ³•åå‘è§£æ IP åœ°å€: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">reverseLookup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;8.8.8.8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>reverse</code> æ–¹æ³•ç”¨äºåå‘è§£æç»™å®šçš„ IP åœ°å€ï¼Œå³æ‰¾åˆ°ä¸ä¹‹å…³è”çš„åŸŸåã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°è¯•åå‘è§£æ Google å…¬å…± DNS æœåŠ¡å™¨çš„ IP åœ°å€ <code>8.8.8.8</code>ã€‚</p><ol start="5"><li><strong>å…¶ä»– DNS è®°å½•ç±»å‹çš„è§£æ</strong></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> resolveMX</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">domain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> mxRecords</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveMx</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">domain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`é‚®ä»¶äº¤æ¢è®°å½•: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">JSON</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">stringify</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">mxRecords</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">null</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ— æ³•è§£æ MX è®°å½•: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveMX</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;gmail.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>resolveMx</code> æ–¹æ³•è¢«ç”¨æ¥è§£æç‰¹å®šåŸŸåçš„é‚®ä»¶äº¤æ¢ï¼ˆMXï¼‰è®°å½•ï¼Œè¿™äº›è®°å½•æŒ‡ç¤ºæ¥æ”¶ç”µå­é‚®ä»¶æ—¶åº”è¯¥å°†é‚®ä»¶å‘é€åˆ°å“ªä¸ªæœåŠ¡å™¨ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°è¯•è§£æ <code>gmail.com</code> çš„ MX è®°å½•ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯ <code>dnsPromises.Resolver</code> ç±»åœ¨ Node.js ä¸­çš„åŸºæœ¬ç”¨æ³•ç¤ºä¾‹ã€‚é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ å¯ä»¥å¼€å§‹ç†è§£å¦‚ä½•åœ¨ä½ è‡ªå·±çš„ Node.js åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ DNS è§£æåŠŸèƒ½æ¥è·å–æœ‰å…³ä¸åŒåŸŸåçš„ä¿¡æ¯ã€‚</p><h3 id="resolver-cancel-1" tabindex="-1"><a class="header-anchor" href="#resolver-cancel-1"><span><a href="https://nodejs.org/docs/latest/api/dns.html#resolvercancel_1" target="_blank" rel="noopener noreferrer">resolver.cancel()</a></span></a></h3><p>Node.js ä¸­çš„ <code>resolver.cancel()</code> æ–¹æ³•æ˜¯ DNS è§£æå™¨(<code>dns.Resolver</code>)çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå…è®¸ä½ å–æ¶ˆä¸€ä¸ªæˆ–å¤šä¸ªè¿˜æœªå®Œæˆçš„(å³ä»å¤„äºç­‰å¾…çŠ¶æ€çš„) DNS æŸ¥è¯¢è¯·æ±‚ã€‚</p><p>å½“ä½ è°ƒç”¨ DNS è§£æå™¨æ¥æŸ¥æ‰¾åŸŸåå¯¹åº”çš„ IP åœ°å€æ—¶ï¼Œè¿™ä¸ªæ“ä½œå¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´æ¥å®Œæˆï¼Œå› ä¸ºå®ƒæ¶‰åŠç½‘ç»œé€šä¿¡ã€‚å¦‚æœåœ¨æŸ¥è¯¢ç»“æœè¿”å›ä¹‹å‰ï¼Œä½ å†³å®šä¸å†éœ€è¦è¿™ä¸ªç»“æœäº†ï¼Œæˆ–è€…ä½ æƒ³è¦ä¼˜å…ˆå¤„ç†å…¶ä»–äº‹æƒ…ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>resolver.cancel()</code> æ¥å–æ¶ˆè¿™äº›å°šæœªå®Œæˆçš„æŸ¥è¯¢ã€‚</p><p>ä¸‹é¢é€šè¿‡ä¸€ä¸ªå®é™…çš„ä¾‹å­æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨ <code>resolver.cancel()</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> resolver</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯åŠ¨ä¸€ä¸ª DNS æŸ¥è¯¢</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      &quot;DNS query was cancelled or there was an error:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;IP addresses for example.com:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾å‡ºäºæŸç§åŸå› æˆ‘ä»¬éœ€è¦å–æ¶ˆä¸Šé¢å‘èµ·çš„ DNS æŸ¥è¯¢</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">cancel</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥ Node.js çš„ <code>dns</code> æ¨¡å—ï¼Œå¹¶åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ <code>dns.Resolver</code> å®ä¾‹ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªè§£æå™¨å®ä¾‹æ¥å¼‚æ­¥åœ°è§£æ &quot;<a href="http://example.com" target="_blank" rel="noopener noreferrer">example.com</a>&quot; è¿™ä¸ªç½‘ç«™çš„ IPv4 åœ°å€ã€‚å¦‚æœè¿™ä¸ªæŸ¥è¯¢æˆåŠŸå®Œæˆï¼Œè¿”å›çš„ IP åœ°å€å°†ä¼šåœ¨å›è°ƒå‡½æ•°ä¸­è¢«æ‰“å°å‡ºæ¥ã€‚</p><p>ä½†æ˜¯ï¼Œåœ¨æŸ¥è¯¢è¿˜æ²¡ç»“æŸä¹‹å‰ï¼Œæˆ‘ä»¬è°ƒç”¨äº† <code>resolver.cancel()</code> æ–¹æ³•ã€‚è¿™å¯¼è‡´äº†ä»»ä½•æŒ‚èµ·çš„ DNS æŸ¥è¯¢è¢«å–æ¶ˆã€‚å¦‚æœæŸ¥è¯¢è¢«æˆåŠŸå–æ¶ˆï¼Œé‚£ä¹ˆå›è°ƒå‡½æ•°å°†æ”¶åˆ°ä¸€ä¸ªé”™è¯¯æç¤º DNS æŸ¥è¯¢å·²è¢«å–æ¶ˆã€‚è¿™æ ·æˆ‘ä»¬å°±èƒ½é¿å…ç­‰å¾…ä¸€ä¸ªæˆ‘ä»¬ä¸å†éœ€è¦çš„ç»“æœï¼ŒèŠ‚çœæ—¶é—´å’Œèµ„æºã€‚</p><p>è¿™ç§å–æ¶ˆ DNS æŸ¥è¯¢çš„åŠŸèƒ½åœ¨å¼€å‘ä¸€äº›å®é™…åº”ç”¨æ—¶å¾ˆæœ‰ç”¨ï¼Œæ¯”å¦‚ï¼š</p><ul><li>ç”¨æˆ·ç•Œé¢ç¨‹åºï¼šå‡å¦‚ç”¨æˆ·å¯ä»¥è¾“å…¥ä¸€ä¸ªåŸŸåè¿›è¡ŒæŸ¥è¯¢ï¼Œä½†ä»–ä»¬åœ¨æŸ¥è¯¢å®Œæˆå‰æ”¹å˜äº†ä¸»æ„ï¼Œä½ å¯ä»¥ç«‹å³å–æ¶ˆæœªå®Œæˆçš„æŸ¥è¯¢ã€‚</li><li>è¶…æ—¶æœºåˆ¶ï¼šä½ å¯ä»¥ä¸º DNS æŸ¥è¯¢è®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œå¦‚æœè¶…è¿‡äº†è¿™ä¸ªæ—¶é—´ï¼Œè‡ªåŠ¨å–æ¶ˆæŸ¥è¯¢ä»¥é¿å…æ— é™æœŸåœ°ç­‰å¾…ã€‚</li><li>è§„èŒƒèµ„æºä½¿ç”¨ï¼šåœ¨ä¸€ä¸ªæ‹¥æœ‰é«˜å¹¶å‘è¯·æ±‚çš„ç³»ç»Ÿä¸­ï¼Œå–æ¶ˆä¸å¿…è¦çš„æŸ¥è¯¢å¯ä»¥å¸®åŠ©å‡å°‘ä¸å¿…è¦çš„è´Ÿè½½å’Œæ½œåœ¨çš„å»¶è¿Ÿã€‚</li></ul><p>è¿™ä¸ªæ–¹æ³•æ˜¯ Node.js åœ¨ API æ–¹é¢ä¸ºå¼€å‘è€…æä¾›çš„çµæ´»æ€§ï¼Œä½¿å¾—æ§åˆ¶åº”ç”¨ç¨‹åºçš„è¡Œä¸ºå’Œèµ„æºç®¡ç†æ›´åŠ ç²¾ç¡®æœ‰æ•ˆã€‚</p><h3 id="dnspromises-getservers" tabindex="-1"><a class="header-anchor" href="#dnspromises-getservers"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromisesgetservers" target="_blank" rel="noopener noreferrer">dnsPromises.getServers()</a></span></a></h3><p><code>dnsPromises.getServers()</code> æ˜¯ Node.js ä¸­å†…ç½® <code>dns</code> æ¨¡å—çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºè·å–å½“å‰ä½¿ç”¨çš„ DNS æœåŠ¡å™¨çš„åœ°å€åˆ—è¡¨ã€‚è¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨ <code>.then()</code> å’Œ <code>.catch()</code> æ–¹æ³•æ¥å¤„ç†è¿”å›ç»“æœæˆ–è€…æ•è·å¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚</p><p>åœ¨ Node.js åº”ç”¨ä¸­ï¼ŒDNSï¼ˆåŸŸåç³»ç»Ÿï¼‰ç”¨äºå°†åŸŸåè½¬æ¢ä¸º IP åœ°å€ã€‚ä¾‹å¦‚ï¼Œå½“ä½ åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ <code>www.example.com</code> æ—¶ï¼ŒDNS æœåŠ¡å™¨ä¼šå‘Šè¯‰ä½ è¿™ä¸ªåŸŸåå¯¹åº”çš„ IP åœ°å€ï¼Œç„¶åä½ çš„è®¡ç®—æœºæ‰èƒ½è¿æ¥åˆ° <code>www.example.com</code> æ‰€åœ¨çš„æœåŠ¡å™¨ã€‚</p><p>å½“ä½ ä½¿ç”¨ <code>dnsPromises.getServers()</code> å‡½æ•°æ—¶ï¼ŒNode.js ä¼šè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†æ‰€æœ‰é…ç½®ç»™ Node.js è¿›ç¨‹çš„ DNS æœåŠ¡å™¨çš„ IP åœ°å€ã€‚è¿™ä¸ªæ“ä½œé€šå¸¸ç”¨äºè°ƒè¯•ç›®çš„ï¼Œå¸®åŠ©å¼€å‘è€…äº†è§£ Node.js åº”ç”¨å½“å‰æ­£åœ¨ä½¿ç”¨å“ªäº› DNS æœåŠ¡å™¨ã€‚</p><p><strong>å®é™…ä¾‹å­ï¼š</strong></p><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”ä½ æƒ³è¦æ£€æŸ¥ä½ çš„åº”ç”¨å½“å‰ä½¿ç”¨äº†å“ªäº› DNS æœåŠ¡å™¨ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ async/await è·å– DNS æœåŠ¡å™¨åˆ—è¡¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> checkDNSServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> servers</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å½“å‰ä½¿ç”¨çš„ DNS æœåŠ¡å™¨:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">servers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è·å– DNS æœåŠ¡å™¨æ—¶å‡ºé”™:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è°ƒç”¨ä¸Šé¢å®šä¹‰çš„å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">checkDNSServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œé¦–å…ˆé€šè¿‡ <code>require(&#39;dns&#39;)</code> å¯¼å…¥ Node.js çš„ <code>dns</code> æ¨¡å—ï¼Œå¹¶ä½¿ç”¨æ¨¡å—æä¾›çš„ <code>promises</code> å±æ€§æ¥è®¿é—® <code>getServers()</code> æ–¹æ³•ã€‚æ¥ä¸‹æ¥ï¼Œå®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° <code>checkDNSServers</code>ï¼Œå®ƒä½¿ç”¨ <code>await</code> æ¥ç­‰å¾… <code>dnsPromises.getServers()</code> è¿”å›ç»“æœã€‚å¦‚æœæˆåŠŸï¼Œå®ƒä¼šæ‰“å°å‡ºå½“å‰ä½¿ç”¨çš„ DNS æœåŠ¡å™¨çš„åˆ—è¡¨ï¼Œå¦‚æœå¤±è´¥ï¼Œåˆ™ä¼šæ•è·é”™è¯¯å¹¶æ‰“å°å‡ºæ¥ã€‚</p><p>è¿è¡Œè¿™æ®µä»£ç ï¼Œä½ å°†åœ¨æ§åˆ¶å°çœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹çš„è¾“å‡ºï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>å½“å‰ä½¿ç”¨çš„ DNS æœåŠ¡å™¨: [ &#39;8.8.8.8&#39;, &#39;8.8.4.4&#39; ]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ä¸Šé¢è¾“å‡ºæ˜¾ç¤ºäº†ä¸¤ä¸ª DNS æœåŠ¡å™¨çš„ IP åœ°å€ï¼Œè¿™å¯èƒ½æ˜¯ä½ çš„ç½‘ç»œè®¾ç½®æˆ–ç³»ç»Ÿé…ç½®ä¸­æŒ‡å®šçš„ DNS æœåŠ¡å™¨ã€‚è¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½†åœ¨å®é™…å¼€å‘ä¸­ï¼Œäº†è§£ DNS æœåŠ¡å™¨ä¿¡æ¯å¯èƒ½å¯¹è§£å†³ç½‘ç»œç›¸å…³é—®é¢˜éå¸¸æœ‰å¸®åŠ©ã€‚</p><h3 id="dnspromises-lookup-hostname-options" tabindex="-1"><a class="header-anchor" href="#dnspromises-lookup-hostname-options"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromiseslookuphostname-options" target="_blank" rel="noopener noreferrer">dnsPromises.lookup(hostname[, options])</a></span></a></h3><p>Node.js ä¸­çš„ <code>dnsPromises.lookup(hostname[, options])</code> å‡½æ•°æ˜¯ä¸€ä¸ªç”¨äºæŸ¥è¯¢åŸŸåå¯¹åº”çš„ IP åœ°å€çš„å¼‚æ­¥å‡½æ•°ï¼Œå®ƒè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚è¿™ä¸ªå‡½æ•°å±äº Node.js çš„ <code>dns</code> æ¨¡å—ï¼Œå¹¶ä¸”å…¶æ“ä½œæ˜¯åŸºäºç³»ç»Ÿåº•å±‚çš„ DNS è§£ææœåŠ¡çš„ï¼Œè¿™æ„å‘³ç€ç»“æœä¼šå—åˆ°æœ¬åœ° hosts æ–‡ä»¶å’Œç½‘ç»œé…ç½®çš„å½±å“ã€‚</p><p>é¦–å…ˆï¼Œæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªå‡½æ•°çš„å‚æ•°ï¼š</p><ol><li><code>hostname</code>: è¿™æ˜¯ä½ æƒ³è¦æŸ¥è¯¢ IP åœ°å€çš„åŸŸåï¼Œæ¯”å¦‚ <code>&#39;google.com&#39;</code>ã€‚</li><li><code>options</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå¯ä»¥æ§åˆ¶å‡½æ•°çš„ä¸€äº›è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå®ƒå¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº† <code>family</code> å±æ€§ï¼ˆå€¼å¯ä»¥æ˜¯ <code>4</code> æˆ– <code>6</code>ï¼‰ï¼Œç”¨æ¥æŒ‡å®šä½ æƒ³è¦å¾—åˆ° IPv4 è¿˜æ˜¯ IPv6 åœ°å€ã€‚</li></ol><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡å‡ ä¸ªå®ä¾‹æ¥æ›´å¥½åœ°ç†è§£è¿™ä¸ªå‡½æ•°çš„ä½¿ç”¨ã€‚</p><h3 id="å®ä¾‹-1-åŸºæœ¬ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-1-åŸºæœ¬ç”¨æ³•"><span>å®ä¾‹ 1: åŸºæœ¬ç”¨æ³•</span></a></h3><p>å‡è®¾ä½ æƒ³è¦æ‰¾å‡º <code>&#39;google.com&#39;</code> åŸŸåå¯¹åº”çš„ IPv4 åœ°å€ï¼Œä½ å¯ä»¥è¿™æ ·å†™ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> lookupDomain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;google.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`åœ°å€: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">result</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">address</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, åœ°å€æ—: IPv</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">result</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">family</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è§£æå‡ºé”™:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookupDomain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šè¾“å‡ºç±»ä¼¼ä»¥ä¸‹å†…å®¹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>åœ°å€: 172.217.14.206, åœ°å€æ—: IPv4</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="å®ä¾‹-2-ä½¿ç”¨-options-å‚æ•°" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-2-ä½¿ç”¨-options-å‚æ•°"><span>å®ä¾‹ 2: ä½¿ç”¨ options å‚æ•°</span></a></h3><p>å¦‚æœä½ åªå¯¹ IPv6 åœ°å€æ„Ÿå…´è¶£ï¼Œä½ å¯ä»¥è®¾ç½® <code>options</code> å‚æ•°æ¥æŒ‡å®š <code>family</code> ä¸º <code>6</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> lookupDomainIPv6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;google.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">family</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`IPv6 åœ°å€: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">result</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">address</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è§£æå‡ºé”™:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookupDomainIPv6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™å¯èƒ½ä¼šè¾“å‡ºç±»ä¼¼ä»¥ä¸‹å†…å®¹ï¼ˆæ³¨æ„ IPv6 åœ°å€æ ¼å¼ï¼‰ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>IPv6 åœ°å€: 2607:f8b0:4005:808::200e</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="å®ä¾‹-3-é”™è¯¯å¤„ç†" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-3-é”™è¯¯å¤„ç†"><span>å®ä¾‹ 3: é”™è¯¯å¤„ç†</span></a></h3><p>å½“ä½ æŸ¥è¯¢ä¸€ä¸ªä¸å­˜åœ¨çš„åŸŸåæ—¶ï¼ŒPromise å°†ä¼šè¢«æ‹’ç»ï¼Œä½ éœ€è¦æ­£ç¡®åœ°æ•è·å¹¶å¤„ç†è¿™ä¸ªé”™è¯¯ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> lookupInvalidDomain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;thisdomaindoesnotexist.xyz&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è§£æå‡ºé”™:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œå°†ä¼šæ•è·é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookupInvalidDomain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œä¸Šé¢çš„ä»£ç å°†ä¼šå¾—åˆ°é”™è¯¯ä¿¡æ¯ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>è§£æå‡ºé”™: Error: getaddrinfo ENOTFOUND thisdomaindoesnotexist.xyz</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™è¯´æ˜ç³»ç»Ÿæ— æ³•è§£æè¯¥åŸŸåçš„ IP åœ°å€ã€‚</p><p>é€šè¿‡ä¸Šè¿°ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>dnsPromises.lookup</code> å¦‚ä½•åœ¨ Node.js ä¸­å·¥ä½œä»¥åŠå¦‚ä½•å¤„ç†æ­£å¸¸æƒ…å†µå’Œå¼‚å¸¸æƒ…å†µã€‚è¿™ä¸ªå‡½æ•°åœ¨ä»»ä½•éœ€è¦æ ¹æ®åŸŸåè·å– IP åœ°å€çš„ç½‘ç»œåº”ç”¨ä¸­éƒ½éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚åœ¨åˆ›å»º HTTP å®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨çš„æ—¶å€™éªŒè¯åŸŸåçš„æœ‰æ•ˆæ€§ç­‰åœºæ™¯ã€‚</p><h3 id="dnspromises-lookupservice-address-port" tabindex="-1"><a class="header-anchor" href="#dnspromises-lookupservice-address-port"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromiseslookupserviceaddress-port" target="_blank" rel="noopener noreferrer">dnsPromises.lookupService(address, port)</a></span></a></h3><p><code>dnsPromises.lookupService(address, port)</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå±äº <code>dns</code> æ¨¡å—ä¸­è¿”å› promises çš„æ–¹æ³•é›†åˆã€‚è¿™ä¸ªå‡½æ•°ç”¨æ¥æŸ¥è¯¢ç»™å®š IP åœ°å€å’Œç«¯å£å·å¯¹åº”çš„ä¸»æœºå(hostname)å’ŒæœåŠ¡å(service name)ã€‚</p><p>é¦–å…ˆï¼Œè§£é‡Šä¸€äº›åŸºç¡€æ¦‚å¿µï¼š</p><ul><li><strong>IP åœ°å€</strong>ï¼šäº’è”ç½‘ä¸Šæ¯ä¸ªè®¾å¤‡çš„å”¯ä¸€æ ‡è¯†ï¼Œä¾‹å¦‚ <code>192.168.1.1</code>ã€‚</li><li><strong>ç«¯å£å·</strong>ï¼šä¸€ä¸ªç”¨äºåŒºåˆ†è®¾å¤‡ä¸Šä¸åŒæœåŠ¡æˆ–åº”ç”¨ç¨‹åºçš„æ•°å­—ï¼Œå¦‚ HTTP åè®®é€šå¸¸ä½¿ç”¨ç«¯å£ 80ã€‚</li><li><strong>ä¸»æœºå</strong>ï¼šä¸ IP åœ°å€ç›¸å¯¹åº”çš„æ›´å®¹æ˜“è®°ä½çš„åå­—ï¼Œå¦‚ <code>www.example.com</code>ã€‚</li><li><strong>æœåŠ¡å</strong>ï¼šä¸ç«¯å£å·ç›¸å…³è”çš„é»˜è®¤æœåŠ¡åç§°ï¼Œå¦‚ç«¯å£ <code>80</code> é€šå¸¸ä¸ <code>http</code> æœåŠ¡å…³è”ã€‚</li></ul><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ <code>dnsPromises.lookupService(address, port)</code> è¿™ä¸ªå‡½æ•°æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š</p><p>è¿™ä¸ªå‡½æ•°éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªæ˜¯ IP åœ°å€ (<code>address</code>)ï¼Œå¦ä¸€ä¸ªæ˜¯ç«¯å£å· (<code>port</code>)ã€‚å½“ä½ è°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ª Promiseï¼Œè¿™æ„å‘³ç€å‡½æ•°ä¼šç«‹å³è¿”å›ï¼Œä½†å®é™…çš„æ“ä½œå¯èƒ½ä¼šç¨åå®Œæˆã€‚Promise åœ¨å®Œæˆæ—¶å¯ä»¥æ˜¯æˆåŠŸ(resolved)çš„çŠ¶æ€ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤±è´¥(rejected)çš„çŠ¶æ€ã€‚</p><p>å¦‚æœæ“ä½œæˆåŠŸï¼Œä½ å°†å¾—åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«ä¸¤ä¸ªå±æ€§ï¼š<code>hostname</code> å’Œ <code>service</code>ã€‚<code>hostname</code> æ˜¯ä¸æä¾›çš„ IP åœ°å€å…³è”çš„ä¸»æœºåï¼Œè€Œ <code>service</code> æ˜¯ä¸æä¾›çš„ç«¯å£å·å…³è”çš„æœåŠ¡åã€‚</p><p>è®©æˆ‘ä»¬é€šè¿‡å‡ ä¸ªä¾‹å­æ¥è¯´æ˜å®ƒæ˜¯å¦‚ä½•è¿ç”¨çš„ï¼š</p><p>ä¾‹å­ 1ï¼šæŸ¥è¯¢æœ¬åœ°æ•°æ®åº“æœåŠ¡<br> å‡è®¾ä½ æœ‰ä¸€ä¸ªæœ¬åœ°è¿è¡Œçš„æ•°æ®åº“æœåŠ¡å™¨ï¼Œå®ƒåœ¨ IP åœ°å€ <code>127.0.0.1</code> ä¸Šçš„ç«¯å£ <code>5432</code> ï¼ˆPostgreSQL æ•°æ®åº“çš„é»˜è®¤ç«¯å£ï¼‰ä¸Šä¾¦å¬è¯·æ±‚ã€‚ä½ æƒ³è¦çŸ¥é“è¿™ä¸ªç«¯å£å¯¹åº”çš„æœåŠ¡åã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> lookupService</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookupService</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;127.0.0.1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5432</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`The service on 127.0.0.1:5432 is: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">result</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">service</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Error:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookupService</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œè¿™æ®µä»£ç å°†è¾“å‡º PostgreSQL æ•°æ®åº“æœåŠ¡çš„åç§°ã€‚</p><p>ä¾‹å­ 2ï¼šæ£€æŸ¥è¿œç¨‹ API æœåŠ¡å™¨<br> å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå®ƒéœ€è¦è¿æ¥åˆ°è¿œç¨‹ API æœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨ä½äº IP åœ°å€ <code>93.184.216.34</code> ä¸Šçš„ç«¯å£ <code>80</code> ã€‚ä½ æƒ³ç¡®è®¤è¿™ä¸ªç«¯å£æ˜¯ä¸æ˜¯çœŸçš„æœåŠ¡äº HTTP è¯·æ±‚ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> checkRemoteService</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookupService</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;93.184.216.34&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Host: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">result</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, Service: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">result</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">service</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Error:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">checkRemoteService</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤ä»£ç å°†å°è¯•æ‰¾å‡ºè¿œç¨‹æœåŠ¡å™¨çš„ä¸»æœºåå’ŒæœåŠ¡åã€‚å¦‚æœç«¯å£ 80 ç¡®å®ä¸º HTTP æœåŠ¡ï¼Œä½ åº”è¯¥ä¼šçœ‹åˆ°æœåŠ¡åä¸º &#39;http&#39;ã€‚</p><p>æ€»ä¹‹ï¼Œ<code>dnsPromises.lookupService(address, port)</code> æ˜¯ä¸€ä¸ªç”¨æ¥è·å–ç‰¹å®š IP åœ°å€å’Œç«¯å£å¯¹åº”çš„ä¸»æœºåå’ŒæœåŠ¡åçš„å·¥å…·ï¼Œéå¸¸é€‚åˆäºç½‘ç»œåº”ç”¨ç¨‹åºä¸­çš„æœåŠ¡å‘ç°å’ŒéªŒè¯ã€‚</p><h3 id="dnspromises-resolve-hostname-rrtype" tabindex="-1"><a class="header-anchor" href="#dnspromises-resolve-hostname-rrtype"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromisesresolvehostname-rrtype" target="_blank" rel="noopener noreferrer">dnsPromises.resolve(hostname[, rrtype])</a></span></a></h3><p>Node.js ä¸­<code>dnsPromises.resolve(hostname[, rrtype])</code>æ˜¯ä¸€ä¸ªç”¨äºè§£æåŸŸåçš„å‡½æ•°ï¼Œå®ƒå±äº Node.js çš„ DNSï¼ˆDomain Name System åŸŸåç³»ç»Ÿï¼‰æ¨¡å—ã€‚åœ¨ç½‘ç»œé€šè®¯ä¸­ï¼ŒDNS è´Ÿè´£å°†äººç±»å¯è¯»çš„ç½‘å€ï¼ˆå¦‚ <code>www.example.com</code>ï¼‰è½¬æ¢æˆè®¡ç®—æœºå¯ä»¥ç†è§£çš„ IP åœ°å€ï¼ˆå¦‚ <code>93.184.216.34</code>ï¼‰ã€‚<code>resolve</code>æ–¹æ³•æ­£æ˜¯ç”¨äºæ‰§è¡Œè¿™ç§è½¬æ¢çš„æ“ä½œã€‚</p><p>è¯¥å‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè¿™æ„å‘³ç€å®ƒæ”¯æŒå¼‚æ­¥æ“ä½œã€‚å½“ä½ è°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶ï¼Œå®ƒä¸ä¼šç«‹å³é˜»å¡ä»£ç çš„ç»§ç»­æ‰§è¡Œï¼›ç›¸åï¼Œå®ƒä¼šåœ¨åå°å¤„ç†åŸŸåè§£æï¼Œå¹¶ä¸”ä¸€æ—¦å®Œæˆå°±é€šè¿‡ Promise æ¥å‘ŠçŸ¥ç»“æœã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>hostname</code>ï¼šè¿™æ˜¯ä½ æƒ³è¦è§£æçš„åŸŸåå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ <code>&quot;google.com&quot;</code>ã€‚</li><li><code>rrtype</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºè®°å½•ç±»å‹ã€‚DNS æœ‰å¤šç§ç±»å‹çš„è®°å½•ï¼Œæ¯”å¦‚<code>&#39;A&#39;</code>è®°å½•ä»£è¡¨åœ°å€ï¼ŒæŒ‡å‘ä¸€ä¸ª IPv4 åœ°å€ï¼Œ<code>&#39;AAAA&#39;</code>è®°å½•æŒ‡å‘ä¸€ä¸ª IPv6 åœ°å€ï¼Œ<code>&#39;MX&#39;</code>ç”¨äºé‚®ä»¶äº¤æ¢æœåŠ¡å™¨ç­‰ã€‚å¦‚æœä½ ä¸æŒ‡å®š<code>rrtype</code>ï¼Œé»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨<code>&#39;A&#39;</code>è®°å½•ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-1"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><strong>è·å–ä¸€ä¸ªç½‘ç«™çš„ IP åœ°å€</strong>ï¼š</li></ol><p>å‡è®¾ä½ æƒ³è¦è·å–åŸŸå<code>&quot;example.com&quot;</code>çš„ IP åœ°å€ã€‚ä½ å¯ä»¥ä½¿ç”¨<code>dnsPromises.resolve()</code>å‡½æ•°æ¥è·å–è¿™ä¸ªä¿¡æ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getIPAddress</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> addresses</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`The IP address for </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> is: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Error in DNS resolve: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getIPAddress</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>æŸ¥æ‰¾åŸŸåçš„é‚®ç®±æœåŠ¡å™¨(MX è®°å½•)</strong>ï¼š</li></ol><p>å¦‚æœä½ æƒ³æŸ¥æ‰¾ä¸€ä¸ªåŸŸåå¯¹åº”çš„é‚®ä»¶æœåŠ¡å™¨ï¼Œä½ å¯ä»¥æŒ‡å®š<code>rrtype</code>ä¸º<code>&#39;MX&#39;</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getMailServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> mailServers</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;MX&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Mail servers for </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">mailServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œä¼šåˆ—å‡ºç›¸å…³çš„MXè®°å½•ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Error in DNS MX resolve: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getMailServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>æŸ¥è¯¢ DNS TXT è®°å½•</strong>:</li></ol><p>TXT è®°å½•é€šå¸¸åŒ…å«äº†ä¸€äº›æ–‡æœ¬ä¿¡æ¯ï¼Œå®ƒä»¬å¯ä»¥è¢«ç”¨æ¥éªŒè¯åŸŸåæ‰€æœ‰æƒã€SPF è®°å½•ï¼ˆç”¨æ¥è¯†åˆ«é‚®ä»¶å‘é€çš„åˆæ³•æ€§ï¼‰ç­‰ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">//æ¥æºï¼šdoc.cherrychat.org è¯·å‹¿å“’å“’å“’å•†ç”¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getTXTRecords</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> txtRecords</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;TXT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`TXT records for </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">txtRecords</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ˜¾ç¤ºTXTè®°å½•çš„æ•°ç»„</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Error in DNS TXT resolve: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getTXTRecords</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä»¥ä¸Šçš„ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>dnsPromises.resolve</code>åœ¨å®é™…ä¸­å¯ä»¥å¸®åŠ©æˆ‘ä»¬ä»¥ç¼–ç¨‹æ–¹å¼æŸ¥è¯¢å„ç§ç±»å‹çš„ DNS è®°å½•ï¼Œè¿™åœ¨å¼€å‘æ¶‰åŠç½‘ç»œæ“ä½œå’Œå®‰å…¨æ€§æ ¡éªŒçš„åº”ç”¨ç¨‹åºæ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="dnspromises-resolve4-hostname-options" tabindex="-1"><a class="header-anchor" href="#dnspromises-resolve4-hostname-options"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromisesresolve4hostname-options" target="_blank" rel="noopener noreferrer">dnsPromises.resolve4(hostname[, options])</a></span></a></h3><p>å¥½çš„ï¼Œæ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹ <code>dnsPromises.resolve4</code> è¿™ä¸ªæ–¹æ³•ã€‚</p><p>é¦–å…ˆï¼Œ<code>dnsPromises</code> æ˜¯ Node.js ä¸­ <code>dns</code> æ¨¡å—çš„ä¸€ä¸ªå­æ¨¡å—ï¼Œå®ƒæä¾›äº†åŸºäº Promise çš„ API æ¥å¤„ç†å’Œè½¬æ¢åŸŸåç³»ç»Ÿï¼ˆDNSï¼‰æŸ¥è¯¢ã€‚ä¸ä¼ ç»Ÿçš„åŸºäºå›è°ƒçš„ DNS æ–¹æ³•ä¸åŒï¼Œå®ƒå…è®¸ä½ ä½¿ç”¨ <code>async/await</code> æˆ–è€… <code>.then()</code>/.catch()` é“¾å¼è°ƒç”¨ï¼Œå†™å‡ºæ›´åŠ ç®€æ´å’Œç°ä»£çš„å¼‚æ­¥ä»£ç ã€‚</p><p>ç°åœ¨ï¼Œè¯´åˆ° <code>resolve4</code> è¿™ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ä¸“é—¨ç”¨æ¥è§£æ IPv4 åœ°å€çš„ã€‚å½“ä½ æƒ³è¦è·å–ä¸€ä¸ªä¸»æœºå(hostname)å¯¹åº”çš„ IPv4 åœ°å€æ—¶ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨ <code>dnsPromises.resolve4</code>ã€‚</p><p>å‡½æ•°çš„ç­¾åæ˜¯è¿™æ ·çš„ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>hostname</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œè¡¨ç¤ºä½ æƒ³è¦è§£æçš„åŸŸåï¼Œæ¯”å¦‚ <code>&quot;example.com&quot;</code>ã€‚</li><li><code>options</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå®ƒå¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥æ§åˆ¶ä¸€äº›è§£æçš„é€‰é¡¹ã€‚æ¯”å¦‚ä½ å¯ä»¥è®¾ç½® <code>{ ttl: true }</code> æ¥è·å–æ¯ä¸ªè®°å½•çš„ç”Ÿå­˜æ—¶é—´ï¼ˆTTL: Time to Liveï¼‰ã€‚</li></ul><p>è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª Promiseï¼Œå®ƒä¼šè§£å†³ä¸ºä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«ç€æ‰¾åˆ°çš„ IPv4 åœ°å€ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-1"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js åº”ç”¨ï¼Œä½ éœ€è¦æ‰¾åˆ° <code>&quot;google.com&quot;</code> è¿™ä¸ªåŸŸåçš„ IPv4 åœ°å€ã€‚ä½ å¯ä»¥åƒè¿™æ ·ä½¿ç”¨ <code>dnsPromises.resolve4</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ async/await</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getIPv4Address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> addresses</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;google.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æŸ¥æ‰¾è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getIPv4Address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ–è€…å¦‚æœä½ æ›´å–œæ¬¢ä½¿ç”¨ <code>.then()</code> å’Œ <code>.catch()</code> çš„æ–¹å¼ï¼Œä¹Ÿå¯ä»¥è¿™ä¹ˆå†™ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ .then() å’Œ .catch()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">dnsPromises</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;google.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æŸ¥æ‰¾è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œä¸Šé¢çš„ä»£ç åï¼Œä½ ä¼šåœ¨æ§åˆ¶å°çœ‹åˆ°ç±»ä¼¼äºä»¥ä¸‹çš„è¾“å‡ºï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>[ &#39;172.217.14.238&#39;, &#39;172.217.15.78&#39;, ... ]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™è¡¨æ˜ <code>&quot;google.com&quot;</code> è¿™ä¸ªåŸŸåè¢«è§£ææˆäº†ä¸€ç³»åˆ—çš„ IPv4 åœ°å€ï¼Œæ˜¾ç¤ºçš„æ˜¯ Google çš„æœåŠ¡å™¨ IP åœ°å€åˆ—è¡¨ã€‚</p><p>æ€»ç»“èµ·æ¥ï¼Œ<code>dnsPromises.resolve4</code> æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œç”¨äºè·å–åŸŸåå¯¹åº”çš„ IPv4 åœ°å€ï¼Œå®ƒæ˜¯ç°ä»£åŒ– Node.js å¼‚æ­¥ç¼–ç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œå…è®¸å¼€å‘äººå‘˜ä»¥ä¼˜é›…ä¸”æ˜“è¯»çš„æ–¹å¼å¤„ç† DNS æŸ¥è¯¢ã€‚</p><h3 id="dnspromises-resolve6-hostname-options" tabindex="-1"><a class="header-anchor" href="#dnspromises-resolve6-hostname-options"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromisesresolve6hostname-options" target="_blank" rel="noopener noreferrer">dnsPromises.resolve6(hostname[, options])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥æ­¥äº†è§£ <code>dnsPromises.resolve6(hostname[, options])</code> è¿™ä¸ªåŠŸèƒ½ã€‚</p><p>é¦–å…ˆï¼ŒNode.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œ JavaScriptã€‚Node.js æä¾›äº†å¾ˆå¤šæ¨¡å—ï¼Œå…¶ä¸­ <code>dns</code>ï¼ˆDomain Name System åŸŸåç³»ç»Ÿï¼‰æ˜¯ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œç”¨äºè¿›è¡Œå„ç§ç±»å‹çš„ DNS æŸ¥æ‰¾å’Œè§£æã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>dnsPromises</code> æ˜¯ <code>dns</code> æ¨¡å—çš„ä¸€ä¸ªå­é›†ï¼Œå®ƒæä¾›äº†åŸºäº Promise çš„æ¥å£æ¥å¤„ç†å¼‚æ­¥ DNS æŸ¥è¯¢ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨ <code>.then()</code>ã€<code>.catch()</code> å’Œ <code>async/await</code> ç­‰ç°ä»£ JavaScript åŠŸèƒ½æ¥å¤„ç† DNS è§£æç»“æœã€‚</p><p>ç°åœ¨ï¼Œå…³äº <code>dnsPromises.resolve6(hostname[, options])</code> è¿™ä¸ªæ–¹æ³•ï¼š</p><ol><li><p><strong>ä½œç”¨</strong>: å®ƒç”¨äºè§£æç»™å®šä¸»æœºåï¼ˆä¾‹å¦‚ <code>&#39;example.com&#39;</code>ï¼‰çš„ IPv6 åœ°å€ã€‚ç®€å•åœ°è¯´ï¼Œå®ƒä¼šå‘Šè¯‰ä½ ä¸€ä¸ªåŸŸåå¯¹åº”çš„ IPv6 åœ°å€æ˜¯ä»€ä¹ˆã€‚</p></li><li><p><strong>å‚æ•°</strong>:</p><ul><li><code>hostname</code>: è¿™æ˜¯ä½ æƒ³è¦è§£æçš„åŸŸåï¼Œæ¯”å¦‚ <code>&#39;google.com&#39;</code>ã€‚</li><li><code>options</code> (å¯é€‰): ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«å„ç§é…ç½®é€‰é¡¹ã€‚æ¯”å¦‚ï¼Œå¯ä»¥è®¾ç½® <code>ttl: true</code> æ¥è·å–è®°å½•çš„ç”Ÿå­˜æ—¶é—´ï¼ˆTime-To-Liveï¼‰ã€‚</li></ul></li><li><p><strong>è¿”å›å€¼</strong>: è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª Promiseï¼Œå®ƒä¼šå¼‚æ­¥è§£æå¹¶æä¾› IPv6 åœ°å€æ•°ç»„ã€‚å¦‚æœè§£ææˆåŠŸï¼ŒPromise å°†è¢« <code>resolve</code> å¹¶è¿”å›åœ°å€åˆ—è¡¨ï¼›å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ™ Promise å°†è¢« <code>reject</code> å¹¶è¿”å›é”™è¯¯ä¿¡æ¯ã€‚</p></li></ol><p>è®©æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªä¾‹å­ã€‚</p><h3 id="ç¤ºä¾‹-1-åŸºæœ¬ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åŸºæœ¬ç”¨æ³•"><span>ç¤ºä¾‹ 1ï¼šåŸºæœ¬ç”¨æ³•</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getIPv6Address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> addresses</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`IPv6 Addresses: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Error:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getIPv6Address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;google.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° <code>getIPv6Address</code>ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªä¸»æœºåï¼Œå¹¶ä½¿ç”¨ <code>dnsPromises.resolve6</code> æ¥è§£æå…¶ IPv6 åœ°å€ã€‚å¦‚æœæˆåŠŸï¼Œå®ƒä¼šæ‰“å°å‡ºåœ°å€ï¼›å¦‚æœæœ‰é”™è¯¯ï¼Œå®ƒä¼šæ‰“å°å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="ç¤ºä¾‹-2-å¸¦é€‰é¡¹çš„ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å¸¦é€‰é¡¹çš„ç”¨æ³•"><span>ç¤ºä¾‹ 2ï¼šå¸¦é€‰é¡¹çš„ç”¨æ³•</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getIPv6AddressWithTTL</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> results</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ttl</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    results</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Address: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">result</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">address</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, TTL: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">result</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ttl</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Error:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getIPv6AddressWithTTL</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;google.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ <code>{ ttl: true }</code> ä½œä¸ºé€‰é¡¹ä¼ é€’ç»™ <code>resolve6</code> æ–¹æ³•ï¼Œè¿™æ ·æˆ‘ä»¬ä¸ä»…è·å¾— IPv6 åœ°å€ï¼Œè¿˜è·å¾—äº†æ¯ä¸ªåœ°å€çš„ç”Ÿå­˜æ—¶é—´ï¼ˆTTLï¼‰ã€‚ç„¶åï¼Œæˆ‘ä»¬å¾ªç¯éå†ç»“æœæ•°ç»„ï¼Œåˆ†åˆ«æ‰“å°å‡ºæ¯ä¸ªåœ°å€å’Œå…¶ TTLã€‚</p><p>é€šè¿‡ä¸Šé¢è¿™äº›ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>dnsPromises.resolve6</code> åœ¨å®é™…æƒ…å†µä¸‹æ˜¯å¦‚ä½•è¢«ä½¿ç”¨çš„ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ åœ¨å¼€å‘ä¸­å¤„ç†ä¸ DNS ç›¸å…³çš„éœ€æ±‚ã€‚</p><h3 id="dnspromises-resolveany-hostname" tabindex="-1"><a class="header-anchor" href="#dnspromises-resolveany-hostname"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromisesresolveanyhostname" target="_blank" rel="noopener noreferrer">dnsPromises.resolveAny(hostname)</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥è°ˆè°ˆ Node.js ä¸­çš„ <code>dnsPromises.resolveAny(hostname)</code>ã€‚</p><p>é¦–å…ˆï¼Œ<code>dnsPromises</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œä¸“é—¨ç”¨äºå¤„ç†ä¸ DNSï¼ˆåŸŸåç³»ç»Ÿï¼‰ç›¸å…³çš„å„ç§æŸ¥è¯¢æ“ä½œã€‚DNS åŸºæœ¬ä¸Šæ˜¯äº’è”ç½‘ä¸Šçš„ç”µè¯ç°¿ï¼šå½“æ‚¨å°è¯•è®¿é—®ç½‘ç«™æ—¶ï¼Œå®ƒå°†äººç±»å¯è¯»çš„ç½‘å€ï¼ˆæ¯”å¦‚ <a href="http://www.google.com" target="_blank" rel="noopener noreferrer">www.google.com</a>ï¼‰è½¬æ¢ä¸ºæœºå™¨å¯ä»¥ç†è§£çš„ IP åœ°å€ã€‚</p><p><code>resolveAny</code> æ˜¯ <code>dnsPromises</code> ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå¼‚æ­¥åœ°è§£æç»™å®šçš„ä¸»æœºååˆ°å¤šç§å¯èƒ½çš„è®°å½•ï¼Œå¹¶ä»¥æ•°ç»„çš„å½¢å¼è¿”å›æ‰€æœ‰å¯èƒ½çš„è®°å½•ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥è¯¦ç»†çœ‹çœ‹è¿™ä¸ªå‡½æ•°ï¼š</p><h3 id="dnspromises-resolveany-hostname-1" tabindex="-1"><a class="header-anchor" href="#dnspromises-resolveany-hostname-1"><span>dnsPromises.resolveAny(hostname)</span></a></h3><ul><li><strong>å‚æ•°</strong>: <code>hostname</code> â€”â€” ä¸»æœºåï¼Œå³ä½ æƒ³è¦æŸ¥è¯¢çš„åŸŸåï¼Œæ¯”å¦‚ï¼š&quot;<a href="http://google.com" target="_blank" rel="noopener noreferrer">google.com</a>&quot;ã€‚</li><li><strong>è¿”å›å€¼</strong>: è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå½“è§£ææˆåŠŸæ—¶ï¼ŒPromise å°†è¢«è§£æï¼ˆresolveï¼‰å¹¶è¿”å›ä¸€ç³»åˆ— DNS è®°å½•ã€‚è¿™äº›è®°å½•å¯èƒ½åŒ…æ‹¬ä¸åŒç±»å‹çš„ä¿¡æ¯ï¼Œå¦‚ A è®°å½•ï¼ˆIP åœ°å€ï¼‰ã€AAAA è®°å½•ï¼ˆIPv6 åœ°å€ï¼‰ã€MX è®°å½•ï¼ˆé‚®ä»¶äº¤æ¢è®°å½•ï¼‰ã€TXT è®°å½•ç­‰ã€‚</li></ul><p>ç°åœ¨ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŸŸå &quot;<a href="http://example.com" target="_blank" rel="noopener noreferrer">example.com</a>&quot;ï¼Œæˆ‘ä»¬æƒ³è·å–å®ƒçš„æ‰€æœ‰ DNS è®°å½•ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨ Node.js ä¸­çš„ <code>dnsPromises.resolveAny()</code> å‡½æ•°æ¥å®ç°æ­¤ç›®æ ‡çš„ä»£ç ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> resolver</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getDnsRecords</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> records</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> resolver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveAny</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">records</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;DNS è§£æå‡ºé”™:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getDnsRecords</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ol><li>æˆ‘ä»¬å¯¼å…¥äº† Node.js çš„ <code>dns</code> æ¨¡å—ã€‚</li><li>é€šè¿‡ <code>dns.promises</code> è®¿é—®äº†æ¨¡å—ä¸‹ promise é£æ ¼çš„ APIã€‚</li><li>æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° <code>getDnsRecords</code>ï¼Œå®ƒæ¥å—ä¸€ä¸ª <code>hostname</code> å‚æ•°ã€‚</li><li>åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>await</code> å…³é”®å­—ç­‰å¾… <code>resolver.resolveAny(hostname)</code> çš„æ‰§è¡Œç»“æœã€‚</li><li>å¦‚æœå‡½æ•°æˆåŠŸæ‰§è¡Œï¼Œå®ƒå°†æ‰“å°å‡ºæ‰€æœ‰çš„ DNS è®°å½•ã€‚</li><li>å¦‚æœå‡ºç°é”™è¯¯ï¼ˆæ¯”å¦‚ç½‘ç»œé—®é¢˜æˆ–ä¸»æœºåä¸å­˜åœ¨ï¼‰ï¼Œåˆ™ä¼šæ•è·å¼‚å¸¸å¹¶æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚</li></ol><p>å½“ä½ è°ƒç”¨ <code>getDnsRecords(&#39;example.com&#39;)</code>ï¼Œè¿™ä¸ªå‡½æ•°ä¼šå»æŸ¥è¯¢ &quot;<a href="http://example.com" target="_blank" rel="noopener noreferrer">example.com</a>&quot; çš„æ‰€æœ‰ DNS è®°å½•ï¼Œå¹¶å°†å…¶æ‰“å°å‡ºæ¥ã€‚è¿™å¯èƒ½åŒ…æ‹¬è¯¥åŸŸåçš„ IP åœ°å€ã€ç”¨äºç”µå­é‚®ä»¶äº¤æ¢çš„æœåŠ¡å™¨åœ°å€ç­‰ä¿¡æ¯ã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œ<code>dnsPromises.resolveAny(hostname)</code> æ˜¯ä¸€ä¸ªåœ¨ Node.js ç¨‹åºä¸­æŸ¥è¯¢ DNS è®°å½•çš„å·¥å…·ï¼Œå®ƒå¯ä»¥è¿”å›åŸŸåå…³è”çš„æ‰€æœ‰ç±»å‹çš„è®°å½•ï¼Œè¿™åœ¨éœ€è¦å¯¹åŸŸåè¿›è¡Œè¯¦ç»†åˆ†ææˆ–è€…ç®¡ç† DNS è®°å½•æ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="dnspromises-resolvecaa-hostname" tabindex="-1"><a class="header-anchor" href="#dnspromises-resolvecaa-hostname"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromisesresolvecaahostname" target="_blank" rel="noopener noreferrer">dnsPromises.resolveCaa(hostname)</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Google Chrome çš„ V8 JavaScript å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ JavaScript ä»£ç ã€‚Node.js è‡ªå¸¦äº†å¾ˆå¤šå†…ç½®çš„æ¨¡å—ï¼Œå…¶ä¸­ <code>dns</code> æ¨¡å—æä¾›äº†ä¸€ç³»åˆ—å‡½æ•°ç”¨äºè¿›è¡ŒåŸŸåè§£æï¼ŒåŒ…æ‹¬é€šè¿‡ä¸åŒç±»å‹çš„ DNS æŸ¥è¯¢æ¥è·å–åŸŸåä¿¡æ¯ã€‚</p><p>åœ¨ <code>dns</code> æ¨¡å—ä¸­ï¼Œæœ‰ä¸€ä¸ª <code>dnsPromises</code> æ¥å£ï¼Œè¿™æ˜¯å¯¹åŸæœ‰çš„å›è°ƒé£æ ¼ <code>dns</code> å‡½æ•°çš„ promise é£æ ¼ç‰ˆæœ¬ï¼Œå®ƒä½¿å¾—æˆ‘ä»¬å¯ä»¥æ›´æ–¹ä¾¿åœ°ä½¿ç”¨å¼‚æ­¥/ç­‰å¾… (async/await) æ¨¡å¼æ¥å¤„ç† DNS æŸ¥è¯¢ã€‚</p><p>å…¶ä¸­ <code>dnsPromises.resolveCaa(hostname)</code> å‡½æ•°ç”¨äºè§£æç»™å®šä¸»æœºåçš„ DNS CAA è®°å½•ï¼ˆCertificate Authority Authorizationï¼‰ã€‚CAA è®°å½•æ˜¯ä¸€ç§ DNS èµ„æºè®°å½•ï¼Œå®ƒå…è®¸åŸŸåæ‰€æœ‰è€…æŒ‡å®šå“ªäº›è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰è¢«æˆæƒä¸ºè¯¥åŸŸåé¢å‘è¯ä¹¦ã€‚è¿™æ˜¯ä¸€ç§å®‰å…¨æªæ–½ï¼Œå¯é˜²æ­¢æœªç»æˆæƒçš„è¯ä¹¦è¢«é”™è¯¯åœ°é¢å‘å‡ºå»ã€‚</p><p>å½“ä½ è°ƒç”¨ <code>dnsPromises.resolveCaa(hostname)</code> æ—¶ï¼ŒNode.js ä¼šå‘ DNS æœåŠ¡å™¨æŸ¥è¯¢ä¸è¯¥ä¸»æœºåç›¸å…³è”çš„ CAA è®°å½•ã€‚å¦‚æœæŸ¥è¯¢æˆåŠŸï¼Œè¿”å›çš„å°†æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå®ƒä¼šè§£ææˆä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªæ•°ç»„å…ƒç´ éƒ½ä»£è¡¨ä¸€ä¸ª CAA è®°å½•ã€‚</p><p>ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨ <code>dnsPromises.resolveCaa(hostname)</code> çš„ç®€å•ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> printCaaRecords</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> records</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveCaa</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`CAA records for </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    records</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`- </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">record</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">flags</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;"> ${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">record</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">tag</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">record</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">value</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Error fetching CAA records for </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨è¯¥å‡½æ•°æŸ¥è¯¢ç‰¹å®šåŸŸåçš„CAAè®°å½•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">printCaaRecords</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª <code>printCaaRecords</code> å¼‚æ­¥å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ª <code>hostname</code> å‚æ•°å¹¶æ‰“å°å‡ºè¿™ä¸ªä¸»æœºåçš„ CAA è®°å½•ã€‚æˆ‘ä»¬é¦–å…ˆå°è¯•ç­‰å¾… <code>dnsPromises.resolveCaa</code> å‡½æ•°çš„ç»“æœï¼Œç„¶åä»¥ä¸€å®šæ ¼å¼è¾“å‡ºè®°å½•çš„å†…å®¹ã€‚å¦‚æœè¿‡ç¨‹ä¸­å‡ºç°ä»»ä½•é”™è¯¯ï¼ˆä¾‹å¦‚ç½‘ç»œé—®é¢˜æˆ–ä¸»æœºåä¸å­˜åœ¨ CAA è®°å½•ï¼‰ï¼Œæˆ‘ä»¬æ•è·è¿™ä¸ªé”™è¯¯å¹¶è¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p><p>å‡è®¾ <code>example.com</code> æœ‰ä¸¤æ¡ CAA è®°å½•ï¼Œè¾“å‡ºå¯èƒ½ç±»ä¼¼è¿™æ ·ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CAA records for example.com:</span></span>
<span class="line"><span>- 0 issue &quot;letsencrypt.org&quot;</span></span>
<span class="line"><span>- 0 issuewild &quot;;&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¯æ¡è®°å½•ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š<code>flags</code>ã€<code>tag</code> å’Œ <code>value</code>ã€‚<code>flags</code> æ˜¯è®°å½•çš„æ ‡å¿—ä½ï¼Œé€šå¸¸ä¸º 0ï¼›<code>tag</code> è¡¨ç¤ºè®°å½•ç±»å‹ï¼Œå¦‚ <code>issue</code> æˆ– <code>issuewild</code>ï¼›è€Œ <code>value</code> åˆ™æ˜¯è®°å½•çš„å…·ä½“å€¼ï¼Œæ¯”å¦‚æŒ‡å®šçš„ CA åŸŸåã€‚</p><h3 id="dnspromises-resolvecname-hostname" tabindex="-1"><a class="header-anchor" href="#dnspromises-resolvecname-hostname"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromisesresolvecnamehostname" target="_blank" rel="noopener noreferrer">dnsPromises.resolveCname(hostname)</a></span></a></h3><p><code>dnsPromises.resolveCname(hostname)</code> æ˜¯ä¸€ä¸ª Node.js ä¸­çš„ DNSï¼ˆåŸŸåç³»ç»Ÿï¼‰æŸ¥è¯¢å‡½æ•°ï¼Œå®ƒç”¨äºå¼‚æ­¥åœ°æŸ¥è¯¢å’Œè·å–ç»™å®šä¸»æœºåï¼ˆhostnameï¼‰çš„ CNAMEï¼ˆè§„èŒƒåç§°ï¼‰è®°å½•ã€‚è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå½“è§£ææˆåŠŸæ—¶ä¼šè¢« resolveï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ªåŒ…å«æ‰€æœ‰ CNAME è®°å½•çš„æ•°ç»„ï¼›å¦‚æœå‡ºç°ä»»ä½•é”™è¯¯ï¼Œåˆ™ Promise ä¼šè¢« rejectï¼Œå¹¶è¿”å›é”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="cname-è®°å½•æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#cname-è®°å½•æ˜¯ä»€ä¹ˆ"><span>CNAME è®°å½•æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h3><p>CNAME è®°å½•æ˜¯ä¸€ç§ DNS è®°å½•ç±»å‹ï¼Œå®ƒå°†ä¸€ä¸ªåŸŸåæ˜ å°„åˆ°å¦ä¸€ä¸ªåŸŸåã€‚é€šå¸¸ï¼Œè¿™æ˜¯ä¸ºäº†å¯ä»¥è®©ä¸€ä¸ªåŸŸåä½œä¸ºåˆ«åæŒ‡å‘å¦ä¸€ä¸ªåŸŸåï¼Œè€Œä¸æ˜¯ç›´æ¥æŒ‡å‘ä¸€ä¸ª IP åœ°å€ã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½æœ‰ä¸€ä¸ªåŸŸå <code>www.example.com</code>ï¼Œå®ƒå®é™…ä¸Šæ˜¯é€šè¿‡ <code>example.net</code> æä¾›æœåŠ¡çš„ï¼Œè¿™æ—¶å°±å¯ä»¥è®¾ç½® <code>www.example.com</code> çš„ CNAME è®°å½•ä¸º <code>example.net</code>ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-dnspromises-resolvecname-hostname" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-dnspromises-resolvecname-hostname"><span>å¦‚ä½•ä½¿ç”¨ <code>dnsPromises.resolveCname(hostname)</code>ï¼Ÿ</span></a></h3><p>é¦–å…ˆï¼Œéœ€è¦å¼•å…¥ Node.js çš„<code>dns</code>æ¨¡å—ï¼Œå¹¶ä¸”ä½¿ç”¨å…¶ä¸­çš„<code>promises</code>æ¥å£ï¼Œä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getCnamesForHostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cnames</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveCname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">cnames</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Error occurred:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨è¯¥å‡½æ•°æŸ¥è¯¢ç‰¹å®šåŸŸåçš„CNAMEè®°å½•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getCnamesForHostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;www.example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•°<code>getCnamesForHostname</code>ï¼Œå®ƒæ¥å—ä¸€ä¸ª<code>hostname</code>ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªå‡½æ•°å†…éƒ¨è°ƒç”¨äº†<code>dnsPromises.resolveCname(hostname)</code>ï¼Œå¹¶ç­‰å¾…å…¶ Promise è§£å†³ã€‚å¦‚æœè§£ææˆåŠŸï¼Œå®ƒä¼šè¾“å‡º CNAME è®°å½•åˆ—è¡¨ï¼›å¦‚æœå‡ºé”™ï¼Œåˆ™ä¼šæ•è·é”™è¯¯å¹¶æ‰“å°å‡ºæ¥ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-3"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™ç®¡ç†å·¥å…·ï¼Œéœ€è¦éªŒè¯ç”¨æˆ·æä¾›çš„åŸŸåæ˜¯å¦æ­£ç¡®åœ°è®¾ç½®äº† CNAME è®°å½•ï¼Œä»¥ç¡®ä¿ä»–ä»¬çš„ç½‘ç«™èƒ½å¤Ÿé€šè¿‡ä¸€ä¸ªæ›´å‹å¥½çš„åŸŸåæ¥è®¿é—®ã€‚è¿™æ—¶ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨<code>dnsPromises.resolveCname(hostname)</code>æ¥æŸ¥è¯¢å’ŒéªŒè¯è®¾ç½®æƒ…å†µã€‚</p><p>æˆ–è€…ï¼Œåœ¨æ„å»ºä¸€ä¸ªç½‘ç»œåº”ç”¨æˆ–æœåŠ¡æ—¶ï¼Œä½ å¯èƒ½éœ€è¦åŠ¨æ€åœ°ç¡®å®šæœåŠ¡ä¾èµ–é¡¹çš„ä½ç½®ï¼Œè¿™æ—¶å€™æŸ¥è¯¢ CNAME è®°å½•èƒ½å¸®åŠ©ä½ æ‰¾åˆ°æ­£ç¡®çš„æœåŠ¡ç«¯ç‚¹ã€‚</p><p>æ€»ä¹‹ï¼Œ<code>dnsPromises.resolveCname(hostname)</code>æ˜¯å¤„ç† DNS ç›¸å…³é—®é¢˜æ—¶éå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ åœ¨ Node.js ç¯å¢ƒä¸­ç®€å•ã€æœ‰æ•ˆåœ°è·å–åŸŸåçš„ CNAME è®°å½•ä¿¡æ¯ã€‚</p><h3 id="dnspromises-resolvemx-hostname" tabindex="-1"><a class="header-anchor" href="#dnspromises-resolvemx-hostname"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromisesresolvemxhostname" target="_blank" rel="noopener noreferrer">dnsPromises.resolveMx(hostname)</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹ Node.js ä¸­ <code>dnsPromises.resolveMx(hostname)</code> è¿™ä¸ªåŠŸèƒ½ã€‚</p><p>é¦–å…ˆï¼Œ<code>dnsPromises</code> æ˜¯ Node.js çš„ä¸€ä¸ªæ¨¡å—ï¼Œå®ƒæä¾›äº†ç”¨äºä¸ç½‘ç»œåŸŸåç³»ç»Ÿï¼ˆDNSï¼‰äº¤äº’çš„æ–¹æ³•ï¼Œä½†è¿™äº›æ–¹æ³•è¿”å›çš„æ˜¯ Promise å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„å›è°ƒå‡½æ•°ã€‚Promise æ˜¯ JavaScript ä¸­å¤„ç†å¼‚æ­¥æ“ä½œçš„ä¸€ç§æ–¹å¼ã€‚</p><p>æ¥ç€ï¼Œ<code>resolveMx</code> æ˜¯ <code>dnsPromises</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨äºæŸ¥è¯¢æŒ‡å®šåŸŸåï¼ˆå¦‚ &quot;<a href="http://example.com" target="_blank" rel="noopener noreferrer">example.com</a>&quot;ï¼‰çš„é‚®ä»¶äº¤æ¢ï¼ˆMXï¼‰è®°å½•ã€‚MX è®°å½•æ˜¯ DNS çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªåŸŸåæ¥æ”¶ç”µå­é‚®ä»¶æ—¶ä½¿ç”¨çš„é‚®ä»¶æœåŠ¡å™¨åŠå…¶ä¼˜å…ˆçº§ã€‚</p><p>å½“ä½ è°ƒç”¨ <code>dnsPromises.resolveMx(hostname)</code> æ—¶ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æœ€ç»ˆä¼šè§£æä¸ºä¸€ä¸ªæ•°ç»„ï¼Œè¯¥æ•°ç»„åŒ…å«äº†ä¸ç»™å®š hostname ç›¸å…³çš„æ‰€æœ‰ MX è®°å½•ã€‚æ¯ä¸ª MX è®°å½•éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä¸¤ä¸ªå±æ€§ï¼š<code>priority</code>ï¼ˆä¼˜å…ˆçº§ï¼‰å’Œ <code>exchange</code>ï¼ˆé‚®ä»¶æœåŠ¡å™¨çš„åœ°å€ï¼‰ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®é™…çš„ä¾‹å­æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨ <code>dnsPromises.resolveMx(hostname)</code>ï¼š</p><p>å‡è®¾ä½ æƒ³æŸ¥è¯¢ &quot;<a href="http://google.com" target="_blank" rel="noopener noreferrer">google.com</a>&quot; åŸŸåçš„ MX è®°å½•ï¼Œä½ å¯ä»¥è¿™æ ·å†™ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getMxRecords</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> records</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveMx</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`MX records for </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    records</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Priority: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">record</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">priority</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, Exchange: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">record</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exchange</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Error getting MX records for </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getMxRecords</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;google.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† <code>dns</code> æ¨¡å—ï¼Œå¹¶ä¸”è·å–äº† <code>dnsPromises</code> æ¥å£ã€‚ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° <code>getMxRecords</code>ï¼Œå®ƒå°è¯•ä½¿ç”¨ <code>await dnsPromises.resolveMx(hostname)</code> è·å– MX è®°å½•ï¼Œå¹¶æ‰“å°å‡ºæ¥ã€‚</p><p>å¦‚æœæˆåŠŸï¼Œæ§åˆ¶å°å°†è¾“å‡ºç±»ä¼¼ä»¥ä¸‹å†…å®¹çš„ä¿¡æ¯ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>MX records for google.com:</span></span>
<span class="line"><span>Priority: 10, Exchange: aspmx.l.google.com</span></span>
<span class="line"><span>Priority: 20, Exchange: alt1.aspmx.l.google.com</span></span>
<span class="line"><span>// ... å¯èƒ½è¿˜æœ‰æ›´å¤šçš„ MX è®°å½• ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¯æ¡è®°å½•æ˜¾ç¤ºäº†è¯¥é‚®ä»¶æœåŠ¡å™¨çš„ä¼˜å…ˆçº§å’Œå¯¹åº”çš„æœåŠ¡å™¨åœ°å€ã€‚é‚®ç®±æœåŠ¡å™¨åœ¨å‘é€ç”µå­é‚®ä»¶æ—¶ï¼Œä¼šé¦–å…ˆè€ƒè™‘ä¼˜å…ˆçº§æœ€é«˜ï¼ˆæ•°å€¼æœ€å°ï¼‰çš„ MX è®°å½•ã€‚å¦‚æœç¬¬ä¸€ä¸ªæœåŠ¡å™¨ä¸å¯ç”¨ï¼Œå°±ä¼šæŒ‰ç…§ä¼˜å…ˆçº§é¡ºåºå°è¯•ä¸‹ä¸€ä¸ª MX è®°å½•ã€‚</p><p>è¿™ä¸ªåŠŸèƒ½åœ¨å¼€å‘éœ€è¦å¤„ç†é‚®ä»¶å‘é€æˆ–è€…éªŒè¯åŸŸåæ˜¯å¦é…ç½®äº†æœ‰æ•ˆé‚®ä»¶æœåŠ¡çš„åº”ç”¨æ—¶éå¸¸æœ‰ç”¨ã€‚</p><p>å¸Œæœ›è¿™ä¸ªè§£é‡Šå’Œä¾‹å­èƒ½å¸®åŠ©ä½ ç†è§£ <code>dnsPromises.resolveMx(hostname)</code> åœ¨ Node.js ä¸­çš„ä½œç”¨å’Œåº”ç”¨æ–¹å¼ã€‚</p><h3 id="dnspromises-resolvenaptr-hostname" tabindex="-1"><a class="header-anchor" href="#dnspromises-resolvenaptr-hostname"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromisesresolvenaptrhostname" target="_blank" rel="noopener noreferrer">dnsPromises.resolveNaptr(hostname)</a></span></a></h3><p><code>dnsPromises.resolveNaptr(hostname)</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå±äº <code>dns</code> æ¨¡å—ï¼ˆç”¨äºè§£æåŸŸåç›¸å…³ä¿¡æ¯çš„æ¨¡å—ï¼‰ä¸­çš„ <code>promises</code> æ¥å£éƒ¨åˆ†ã€‚è¿™ä¸ªå‡½æ•°ç”¨æ¥å¼‚æ­¥åœ°è§£æä¸€ä¸ªåŸŸåçš„ NAPTR è®°å½•ã€‚</p><p>åœ¨ä½ ç†è§£è¿™ä¸ªå‡½æ•°ä¹‹å‰ï¼Œä½ éœ€è¦çŸ¥é“ä¸€äº›åŸºç¡€çš„ DNSï¼ˆDomain Name System åŸŸåç³»ç»Ÿï¼‰çŸ¥è¯†å’Œ NAPTR è®°å½•æ˜¯ä»€ä¹ˆã€‚DNS æ˜¯äº’è”ç½‘ä¸Šç”¨äºå°†åŸŸåè½¬æ¢æˆå¯¹åº” IP åœ°å€çš„ç³»ç»Ÿã€‚æ¯å½“ä½ è®¿é—®ä¸€ä¸ªç½‘ç«™ï¼Œæ¯”å¦‚è¾“å…¥ <code>www.example.com</code> æ—¶ï¼Œä½ çš„ç”µè„‘ä¼šä½¿ç”¨ DNS æ¥æ‰¾åˆ°è¿™ä¸ªç½‘ç«™å¯¹åº”çš„ IP åœ°å€ã€‚</p><p>è€Œ NAPTRï¼ˆNaming Authority Pointerï¼‰è®°å½•æ˜¯ DNS çš„ä¸€ç§è®°å½•ç±»å‹ï¼Œé€šå¸¸ç”¨äº SIPï¼ˆSession Initiation Protocol é€šä¿¡åè®®ï¼‰å’Œ ENUMï¼ˆç”µè¯å·ç æ˜ å°„ï¼‰ç­‰æœåŠ¡ã€‚NAPTR è®°å½•èƒ½å¤Ÿå®šä¹‰ä¸€ä¸ªè§„åˆ™ï¼Œè¿™ä¸ªè§„åˆ™å¯ä»¥å‘Šè¯‰å®¢æˆ·ç«¯å¦‚ä½•æ ¹æ®ç‰¹å®šçš„æœåŠ¡éœ€æ±‚é‡æ–°ç¼–å†™æŸ¥è¯¢çš„åŸŸåï¼Œè¿›è€ŒæŒ‡å‘å¦ä¸€ä¸ªæœåŠ¡çš„ä½ç½®ã€‚</p><p>ä¸‹é¢é€šè¿‡ Node.js ä¸­ <code>dnsPromises.resolveNaptr(hostname)</code> å‡½æ•°çš„ç¤ºä¾‹ï¼Œæ¥å¸®ä½ æ›´å¥½åœ°ç†è§£ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">promisify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;util&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°† resolveNaptr æ–¹æ³•è½¬æ¢ä¸º Promise å½¢å¼ï¼Œæ–¹ä¾¿ä½¿ç”¨ async/await</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> resolveNaptr</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> promisify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">resolveNaptr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getNaptrRecord</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">domain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> records</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> resolveNaptr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">domain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">records</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // è¾“å‡º NAPTR è®°å½•çš„åˆ—è¡¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> record</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> of</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> records</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Order: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">record</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">order</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Preference: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">record</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">preference</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Flags: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">record</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">flags</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Service: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">record</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">service</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Regexp: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">record</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">regexp</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Replacement: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">record</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">replacement</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // è¿™äº›å±æ€§æ˜¯ NAPTR è®°å½•çš„ç»„æˆéƒ¨åˆ†ï¼ŒåŒ…æ‹¬ä¼˜å…ˆçº§ã€æ ‡å¿—ã€æœåŠ¡æ ‡è¯†ç¬¦ç­‰ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      `Error retrieving NAPTR records for </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">domain</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">err</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è°ƒç”¨å‡½æ•°æŸ¥æ‰¾ example.com çš„ NAPTR è®°å½•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getNaptrRecord</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† <code>dns</code> æ¨¡å—å’Œ <code>promisify</code> å‡½æ•°ã€‚ç„¶åå®šä¹‰äº†ä¸€ä¸ª <code>getNaptrRecord</code> å¼‚æ­¥å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªåŸŸåä½œä¸ºå‚æ•°ï¼Œå¹¶å°è¯•å»è·å–è¿™ä¸ªåŸŸåçš„ NAPTR è®°å½•ã€‚å¦‚æœæˆåŠŸï¼Œå®ƒä¼šæ‰“å°å‡º NAPTR è®°å½•çš„è¯¦ç»†ä¿¡æ¯ï¼›å¦‚æœå¤±è´¥ï¼Œå®ƒä¼šæ•è·é”™è¯¯å¹¶æ‰“å°é”™è¯¯æ¶ˆæ¯ã€‚</p><p>è¯·æ³¨æ„ï¼Œç”±äºä¸æ˜¯æ‰€æœ‰çš„åŸŸåéƒ½æœ‰ NAPTR è®°å½•ï¼Œæ‰€ä»¥åœ¨å®é™…è¿ç”¨ä¸­å¯èƒ½ä¼šå‡ºç°æ²¡æœ‰ç»“æœæˆ–è€…é”™è¯¯ä¿¡æ¯æç¤ºæ‰¾ä¸åˆ°è®°å½•çš„æƒ…å†µã€‚</p><p>è¿™ä¸ªå‡½æ•°å¯¹äºéœ€è¦å¤„ç† VoIPï¼ˆVoice over Internet Protocolï¼Œç½‘ç»œç”µè¯ï¼‰ã€ENUM æŸ¥è¯¢æˆ–è€…ä»»ä½•æ¶‰åŠåˆ° NAPTR è§£æçš„åº”ç”¨ç¨‹åºéå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œç”µä¿¡æœåŠ¡æä¾›å•†å¯èƒ½ä¼šç”¨è¿™äº›è®°å½•æ¥å¸®åŠ©è·¯ç”±ç”µè¯å‘¼å«åˆ°åˆé€‚çš„ç½‘ç»œæœåŠ¡ã€‚</p><h3 id="dnspromises-resolvens-hostname" tabindex="-1"><a class="header-anchor" href="#dnspromises-resolvens-hostname"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromisesresolvenshostname" target="_blank" rel="noopener noreferrer">dnsPromises.resolveNs(hostname)</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥äº†è§£ä¸€ä¸‹ Node.js ä¸­çš„ <code>dnsPromises.resolveNs(hostname)</code> è¿™ä¸ªå‡½æ•°ã€‚</p><p>é¦–å…ˆï¼Œ<code>dnsPromises</code> æ˜¯ Node.js å†…ç½®çš„ <code>dns</code> æ¨¡å—çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå®ƒæä¾›äº†åŸºäº Promise çš„æ¥å£ï¼Œä½¿å¾—è¿›è¡Œ DNS æŸ¥è¯¢å¯ä»¥æ›´åŠ æ–¹ä¾¿åœ°ä½¿ç”¨åœ¨å¼‚æ­¥æ“ä½œä¸­ã€‚è€Œä¸æ˜¯ä¼ ç»Ÿçš„å›è°ƒæ–¹å¼ã€‚</p><p>ç°åœ¨ï¼Œæ¥è¯¦ç»†çœ‹ä¸€ä¸‹ <code>resolveNs</code> è¿™ä¸ªæ–¹æ³•ï¼š</p><h3 id="dnspromises-resolvens-hostname-1" tabindex="-1"><a class="header-anchor" href="#dnspromises-resolvens-hostname-1"><span>dnsPromises.resolveNs(hostname)</span></a></h3><p><code>resolveNs(hostname)</code> æ–¹æ³•ç”¨äºæŸ¥è¯¢æŒ‡å®šåŸŸåï¼ˆhostnameï¼‰çš„åç§°æœåŠ¡å™¨ï¼ˆName Serverï¼Œç®€ç§° NSï¼‰ã€‚åç§°æœåŠ¡å™¨æ˜¯äº’è”ç½‘ä¸Šè´Ÿè´£å“åº”å…³äºåŸŸåç³»ç»Ÿï¼ˆDNSï¼‰æŸ¥è¯¢è¯·æ±‚çš„æœåŠ¡å™¨ã€‚å½“ä½ æƒ³è¦çŸ¥é“ä¸€ä¸ªç‰¹å®šåŸŸåçš„ DNS ä¿¡æ¯æ˜¯å¦‚ä½•åˆ†é…å’Œç®¡ç†çš„æ—¶å€™ï¼Œè¿™ä¸ªå‡½æ•°å°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p><p>è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨æˆåŠŸæ—¶å°†ä¼šè¢«è§£æä¸ºä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†æ‰€æœ‰ä¸ç»™å®šåŸŸåç›¸å…³çš„åç§°æœåŠ¡å™¨è®°å½•ã€‚</p><h4 id="ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1"><span>ç¤ºä¾‹</span></a></h4><p>å‡è®¾ä½ æƒ³æŸ¥æ‰¾ &#39;<a href="http://google.com" target="_blank" rel="noopener noreferrer">google.com</a>&#39; åŸŸåçš„åç§°æœåŠ¡å™¨ï¼Œä½ å¯ä»¥è¿™æ ·å†™ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é¦–å…ˆï¼Œéœ€è¦å¯¼å…¥ dns æ¨¡å—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®šä¹‰ä¸€ä¸ªå¼‚æ­¥å‡½æ•°æ¥æ‰§è¡Œæˆ‘ä»¬çš„ DNS æŸ¥è¯¢</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> findNameServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">domain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // è°ƒç”¨ resolveNs æ–¹æ³•ï¼Œå¹¶ç­‰å¾…å…¶ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> nameServers</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveNs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">domain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Name servers for </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">domain</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // è¾“å‡ºè·å–åˆ°çš„åç§°æœåŠ¡å™¨æ•°ç»„</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">nameServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œæ¯”å¦‚ç½‘ç»œé—®é¢˜æˆ–åŸŸåä¸å­˜åœ¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Error:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨å®šä¹‰å¥½çš„å‡½æ•°æ¥æŸ¥è¯¢ google.com çš„åç§°æœåŠ¡å™¨</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">findNameServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;google.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œè¿™æ®µä»£ç åï¼Œä½ å¯ä»¥åœ¨æ§åˆ¶å°è¾“å‡ºä¸­çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„ä¿¡æ¯ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>Name servers for google.com:</span></span>
<span class="line"><span>[ &#39;ns1.google.com&#39;,</span></span>
<span class="line"><span>  &#39;ns2.google.com&#39;,</span></span>
<span class="line"><span>  &#39;ns3.google.com&#39;,</span></span>
<span class="line"><span>  &#39;ns4.google.com&#39; ]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™è¡¨ç¤º <code>google.com</code> åŸŸåè‡³å°‘æœ‰ 4 å°åç§°æœåŠ¡å™¨åœ¨å¤„ç†ä¸ä¹‹ç›¸å…³çš„ DNS è¯·æ±‚ã€‚</p><h3 id="å®é™…åº”ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨åœºæ™¯"><span>å®é™…åº”ç”¨åœºæ™¯</span></a></h3><ol><li><p><strong>åŸŸåè¿ç§»</strong>: å¦‚æœä½ æ­£åœ¨è´Ÿè´£è¿ç§»ä¸€ä¸ªç½‘ç«™åˆ°æ–°çš„æ‰˜ç®¡æœåŠ¡ï¼Œä½ å¯èƒ½éœ€è¦æ£€æŸ¥åŸŸåçš„åç§°æœåŠ¡å™¨è®°å½•ï¼Œä»¥ç¡®ä¿å®ƒä»¬å·²ç»æ­£ç¡®æ›´æ–°åˆ°æ–°çš„ DNS æœåŠ¡å™¨ã€‚</p></li><li><p><strong>æ•…éšœæ’æŸ¥</strong>: å¦‚æœä¸€ä¸ªç½‘ç«™å‡ºç° DNS è§£æé—®é¢˜ï¼Œäº†è§£å®ƒçš„åç§°æœåŠ¡å™¨æœ‰åŠ©äºæ’æŸ¥é—®é¢˜æ‰€åœ¨ï¼Œä¾‹å¦‚åˆ¤æ–­æ˜¯å¦æ˜¯å› ä¸ºåç§°æœåŠ¡å™¨é…ç½®ä¸å½“é€ æˆçš„ã€‚</p></li><li><p><strong>å®‰å…¨æ£€æŸ¥</strong>: æ£€æŸ¥å’ŒéªŒè¯åŸŸåçš„åç§°æœåŠ¡å™¨ä¿¡æ¯ï¼Œå¯ä»¥å¸®åŠ©è¯†åˆ«å’Œé¢„é˜²åŸŸååŠ«æŒæˆ–å…¶ä»–ç±»å‹çš„ DNS æ”»å‡»ã€‚</p></li></ol><p><code>dnsPromises.resolveNs(hostname)</code> æä¾›äº†ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ¥å¼‚æ­¥åœ°è·å–å’Œå¤„ç†è¿™ç§ç±»å‹çš„ DNS ä¿¡æ¯ï¼Œä½¿å¾—è¿™äº›ä»»åŠ¡å¯ä»¥è½»æ¾é›†æˆåˆ°åŸºäº Node.js çš„è‡ªåŠ¨åŒ–è„šæœ¬æˆ–åº”ç”¨ç¨‹åºä¸­ã€‚</p><h3 id="dnspromises-resolveptr-hostname" tabindex="-1"><a class="header-anchor" href="#dnspromises-resolveptr-hostname"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromisesresolveptrhostname" target="_blank" rel="noopener noreferrer">dnsPromises.resolvePtr(hostname)</a></span></a></h3><p>Node.js ä¸­çš„ <code>dnsPromises.resolvePtr(hostname)</code> æ˜¯ä¸€ä¸ªç”¨äºæ‰§è¡Œ DNS PTR (Pointer) è®°å½•æŸ¥è¯¢çš„å‡½æ•°ã€‚è¿™ä¸ªåŠŸèƒ½å±äº Node.js çš„ DNS æ¨¡å—ï¼Œè€Œä¸”å®ƒè¿”å›ä¸€ä¸ª promiseï¼Œpromise æ˜¯ç°ä»£ JavaScript ç¼–ç¨‹ä¸­å¸¸ç”¨çš„å¼‚æ­¥ç¼–ç¨‹æ¨¡å¼ã€‚</p><p>PTR è®°å½•é€šå¸¸ç”¨äºåå‘ DNS æŸ¥è¯¢ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡ IP åœ°å€æŸ¥æ‰¾å®ƒå¯¹åº”çš„åŸŸåã€‚è¿™ä¸æˆ‘ä»¬é€šå¸¸çš„ DNS æŸ¥è¯¢æ­£å¥½ç›¸åï¼Œå¹³æ—¶æˆ‘ä»¬é€šå¸¸æ˜¯çŸ¥é“åŸŸåï¼Œæƒ³è¦è·å–å…¶å¯¹åº”çš„ IP åœ°å€ã€‚</p><p>åœ¨ Node.js ä¸­ä½¿ç”¨ <code>dnsPromises.resolvePtr(hostname)</code> å‡½æ•°ä¹‹å‰ï¼Œéœ€è¦å…ˆå¼•å…¥ <code>dns</code> æ¨¡å—ï¼Œå¹¶ä½¿ç”¨å…¶æä¾›çš„ <code>promises</code> æ¥å£ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç„¶åï¼Œä½ å¯ä»¥è°ƒç”¨ <code>resolvePtr</code> æ–¹æ³•æ¥è¿›è¡Œ PTR è®°å½•æŸ¥è¯¢ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ async-await ç»“æ„ï¼Œæ›´å®¹æ˜“ç†è§£å’Œå¤„ç†å¼‚æ­¥æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> queryPTRRecord</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">ipAddress</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> ptrRecords</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolvePtr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ipAddress</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`PTR Records for </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ipAddress</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ptrRecords</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      `Error trying to resolve PTR records for </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ipAddress</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è°ƒç”¨ä¸Šé¢å®šä¹‰çš„å‡½æ•°ï¼Œå‡è®¾ä½ æœ‰ä¸€ä¸ª IP åœ°å€ &#39;8.8.8.8&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">queryPTRRecord</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;8.8.8.8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¸­ï¼Œ<code>queryPTRRecord</code> æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œå®ƒå°è¯•å»æŸ¥æ‰¾ä¼ å…¥çš„ IP åœ°å€çš„ PTR è®°å½•ã€‚å¦‚æœæˆåŠŸæ‰¾åˆ°ï¼Œå®ƒä¼šæ˜¾ç¤ºè¿™äº›è®°å½•ï¼›å¦‚æœå¤±è´¥ï¼ˆæ¯”å¦‚å› ä¸ºç½‘ç»œé—®é¢˜æˆ–è€…æ²¡æœ‰æ‰¾åˆ° PTR è®°å½•ï¼‰ï¼Œå®ƒä¼šæ•è·å¼‚å¸¸å¹¶æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚</p><p>å®é™…è¿ç”¨çš„ä¾‹å­å¯èƒ½åŒ…æ‹¬ï¼š</p><ol><li><p><strong>é‚®ä»¶æœåŠ¡å™¨è®¾ç½®</strong>ï¼šé‚®ä»¶æœåŠ¡å™¨åœ¨å‘é€é‚®ä»¶æ—¶ï¼Œæ¥æ”¶æ–¹çš„æœåŠ¡å™¨å¯èƒ½ä¼šé€šè¿‡åå‘ DNS æŸ¥æ‰¾æ¥éªŒè¯å‘ä¿¡æœåŠ¡å™¨çš„åŸŸåæ˜¯å¦ä¸å…¶ IP åœ„å€åŒ¹é…ï¼Œä»¥æ­¤ä½œä¸ºé˜²æ­¢åƒåœ¾é‚®ä»¶çš„å…¶ä¸­ä¸€ä¸ªæªæ–½ã€‚</p></li><li><p><strong>æ—¥å¿—åˆ†æ</strong>ï¼šåœ¨æœåŠ¡å™¨æ—¥å¿—åˆ†æä¸­ï¼Œç®¡ç†å‘˜å¯èƒ½ä¼šé‡åˆ°ä¸€äº›æ¥æº IP åœ°å€ï¼Œä»–ä»¬å¯èƒ½å¸Œæœ›é€šè¿‡åå‘ DNS æ¥ç¡®å®šè¿™äº› IP åœ°å€å¯¹åº”çš„åŸŸåï¼Œäº†è§£æµé‡çš„æ¥æºã€‚</p></li><li><p><strong>ç½‘ç»œç›‘æ§å’Œç®¡ç†</strong>ï¼šç½‘ç»œç®¡ç†å‘˜å¯èƒ½ç”¨ PTR è®°å½•æ¥æ£€æŸ¥ç½‘ç»œä¸­çš„è®¾å¤‡æ˜¯å¦æŒ‰ç…§é¢„æœŸé…ç½®ï¼Œä»¥åŠå®¡è®¡åŸŸåä¸ IP åœ°å€ä¹‹é—´çš„æ˜ å°„æ˜¯å¦æ­£ç¡®ã€‚</p></li></ol><h3 id="dnspromises-resolvesoa-hostname" tabindex="-1"><a class="header-anchor" href="#dnspromises-resolvesoa-hostname"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromisesresolvesoahostname" target="_blank" rel="noopener noreferrer">dnsPromises.resolveSoa(hostname)</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘ä¼šä¸ºæ‚¨è¯¦ç»†è®²è§£ Node.js ä¸­çš„ <code>dnsPromises.resolveSoa(hostname)</code> å‡½æ•°ã€‚</p><p>åœ¨è§£é‡Šè¿™ä¸ªå‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä¸€ä¸‹ DNSï¼ˆåŸŸåç³»ç»Ÿï¼‰å’Œ SOAï¼ˆStart of Authorityï¼‰è®°å½•æ˜¯ä»€ä¹ˆã€‚</p><p>DNS æ˜¯å¸®åŠ©æˆ‘ä»¬å°†äººç±»å¯è¯»çš„ç½‘å€ï¼ˆå¦‚ <code>www.example.com</code>ï¼‰è½¬æ¢æˆæœºå™¨å¯ä»¥ç†è§£çš„ IP åœ°å€ï¼ˆå¦‚ <code>192.0.2.1</code>ï¼‰çš„ä¸€ç§ç³»ç»Ÿã€‚å®ƒå°±åƒäº’è”ç½‘çš„ç”µè¯ç°¿ã€‚SOA è®°å½•åˆ™æ˜¯ä¸€ç§åœ¨è¿™ä¸ªç”µè¯ç°¿ä¸­çš„è®°å½•ç±»å‹ï¼Œå®ƒåŒ…å«äº†å…³äºåŸŸçš„é‡è¦ä¿¡æ¯ï¼Œå¦‚ï¼š</p><ul><li>åŸŸåæœåŠ¡å™¨çš„ä¸»æœºå</li><li>è´Ÿè´£è¯¥åŒºåŸŸçš„ç®¡ç†å‘˜çš„é‚®ç®±</li><li>åŸŸçš„åºåˆ—å·</li><li>ä¸€äº›æ—¶é—´é—´éš”çš„æ•°å€¼ï¼Œä¾‹å¦‚å¤šä¹…åˆ·æ–°ã€é‡è¯•ç­‰</li></ul><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ Node.js ä¸­çš„ <code>dnsPromises.resolveSoa(hostname)</code>ã€‚è¿™ä¸ªå‡½æ•°å±äº Node.js çš„ <code>dns</code> æ¨¡å—ï¼Œå¹¶ä¸”æ˜¯åŸºäº Promise çš„å¼‚æ­¥ç‰ˆæœ¬ã€‚å®ƒç”¨äºæŸ¥è¯¢ç»™å®šåŸŸåçš„ SOA è®°å½•ã€‚</p><p>ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ—¶ï¼Œä½ éœ€è¦ä¼ å…¥ä¸€ä¸ªå‚æ•° <code>hostname</code>ï¼Œå³ä½ æƒ³æŸ¥è¯¢çš„åŸŸåã€‚å‡½æ•°è°ƒç”¨åä¼šè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¦‚æœæˆåŠŸè§£æï¼Œåˆ™è¯¥ Promise ä¼šè¢« <code>resolve</code> å¹¶è¿”å› SOA è®°å½•çš„ç›¸å…³ä¿¡æ¯ï¼›å¦‚æœå¤±è´¥ï¼Œåˆ™ä¼šè¢« <code>reject</code> å¹¶è¿”å›é”™è¯¯ä¿¡æ¯ã€‚</p><p>ä¸‹é¢ä¸¾ä¸ªä¾‹å­è¯´æ˜å¦‚ä½•ä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ dns æ¨¡å—ä¸­çš„ promises æ¥å£</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æƒ³æŸ¥è¯¢ example.com çš„ SOA è®°å½•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hostname</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getSOARecord</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // ä½¿ç”¨ dnsPromises.resolveSoa å‡½æ•°è¿›è¡ŒæŸ¥è¯¢</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> soaRecord</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveSoa</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¦‚æœæŸ¥è¯¢æˆåŠŸï¼Œè¾“å‡º SOA è®°å½•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">soaRecord</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¦‚æœæŸ¥è¯¢å¤±è´¥ï¼Œæ•è·å¹¶è¾“å‡ºé”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æŸ¥è¯¢å¤±è´¥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è°ƒç”¨ä¸Šé¢å®šä¹‰çš„ async å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getSOARecord</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† Node.js <code>dns</code> æ¨¡å—çš„ <code>promises</code> æ¥å£ã€‚ç„¶åå®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° <code>getSOARecord</code>ï¼Œåœ¨æ­¤å‡½æ•°å†…éƒ¨æˆ‘ä»¬è°ƒç”¨ <code>dnsPromises.resolveSoa(hostname)</code> å¹¶ç­‰å¾…å®ƒçš„ç»“æœã€‚å¦‚æœæŸ¥è¯¢æˆåŠŸï¼Œå°†è¾“å‡ºå¾—åˆ°çš„ SOA è®°å½•ä¿¡æ¯ï¼Œå¦‚æœå¤±è´¥ï¼Œåˆ™è¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è·å–ä»»ä½•åŸŸåçš„ SOA è®°å½•ï¼Œå¹¶åœ¨ Node.js åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨è¿™äº›æ•°æ®ã€‚</p><h3 id="dnspromises-resolvesrv-hostname" tabindex="-1"><a class="header-anchor" href="#dnspromises-resolvesrv-hostname"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromisesresolvesrvhostname" target="_blank" rel="noopener noreferrer">dnsPromises.resolveSrv(hostname)</a></span></a></h3><p>å¥½çš„ï¼Œåœ¨è§£é‡Š <code>dnsPromises.resolveSrv(hostname)</code> è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€äº›èƒŒæ™¯çŸ¥è¯†ã€‚</p><h3 id="dns-å’Œ-srv-è®°å½•" tabindex="-1"><a class="header-anchor" href="#dns-å’Œ-srv-è®°å½•"><span>DNS å’Œ SRV è®°å½•</span></a></h3><p>DNSï¼ˆåŸŸåç³»ç»Ÿï¼‰æ˜¯äº’è”ç½‘ä¸Šç”¨äºå°†åŸŸåè½¬æ¢ä¸º IP åœ°å€çš„æœåŠ¡ã€‚å½“ä½ åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ä¸€ä¸ªç½‘å€æ—¶ï¼Œæ¯”å¦‚ <code>www.example.com</code>ï¼Œä½ çš„ç”µè„‘ä¼šè¯¢é—® DNS æœåŠ¡å™¨è¿™ä¸ªåŸŸåå¯¹åº”çš„ IP åœ°å€æ˜¯ä»€ä¹ˆï¼Œç„¶åæ‰èƒ½æ‰¾åˆ°å¹¶è®¿é—®å¯¹åº”çš„ç½‘ç«™ã€‚</p><p>SRV è®°å½•æ˜¯ DNS ä¸­çš„ä¸€ç§è®°å½•ç±»å‹ï¼Œå®ƒä¸ä»…æä¾›äº†åŸŸåå¯¹åº”çš„æœåŠ¡å™¨ IPï¼Œè¿˜åŒ…æ‹¬äº†æœåŠ¡å™¨ä¸Šç‰¹å®šæœåŠ¡çš„ç«¯å£å·ä»¥åŠåè®®ä¿¡æ¯ã€‚è¿™åœ¨éœ€è¦çŸ¥é“æœåŠ¡å…·ä½“è¿è¡Œåœ¨å“ªä¸ªç«¯å£æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚æ¯”å¦‚ï¼Œè®¸å¤šåœ¨çº¿æ¸¸æˆå’ŒèŠå¤©åº”ç”¨å°±ä¼šä½¿ç”¨ SRV è®°å½•æ¥æŒ‡å¯¼å®¢æˆ·ç«¯è¿æ¥åˆ°æ­£ç¡®çš„æœåŠ¡å™¨ç«¯å£ã€‚</p><h3 id="node-js-çš„-dnspromises-resolvesrv" tabindex="-1"><a class="header-anchor" href="#node-js-çš„-dnspromises-resolvesrv"><span>Node.js çš„ <code>dnsPromises.resolveSrv</code></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>dns</code> æ¨¡å—æä¾›äº†ç”¨äºä¸ DNS æœåŠ¡å™¨è¿›è¡Œäº¤äº’çš„å‡½æ•°ï¼Œè€Œ <code>dnsPromises</code> æ˜¯è¯¥æ¨¡å—åŸºäº Promise çš„å¼‚æ­¥ API ç‰ˆæœ¬ã€‚<code>dnsPromises.resolveSrv(hostname)</code> å°±æ˜¯å…¶ä¸­ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºæŸ¥è¯¢ç»™å®šä¸»æœºåï¼ˆhostnameï¼‰çš„ SRV è®°å½•ã€‚</p><p>å½“ä½ è°ƒç”¨ <code>dnsPromises.resolveSrv(hostname)</code> æ–¹æ³•æ—¶ï¼ŒNode.js ä¼šè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æœ€ç»ˆä¼šè§£ææˆä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„é‡Œé¢åŒ…å«äº†æ‰€æœ‰ä¸è¯¥ä¸»æœºåç›¸å…³çš„ SRV è®°å½•ä¿¡æ¯ã€‚æ¯ä¸ª SRV è®°å½•éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹å±æ€§ï¼š</p><ul><li><code>priority</code>: è®°å½•çš„ä¼˜å…ˆçº§ï¼Œæ•°å­—è¶Šå°è¡¨ç¤ºä¼˜å…ˆçº§è¶Šé«˜ã€‚</li><li><code>weight</code>: æƒé‡ï¼Œç”¨æ¥åœ¨å…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„è®°å½•ä¹‹é—´åšè´Ÿè½½å¹³è¡¡ã€‚</li><li><code>port</code>: æœåŠ¡æ‰€åœ¨çš„ç«¯å£å·ã€‚</li><li><code>name</code>: æä¾›æœåŠ¡çš„æœåŠ¡å™¨çš„ä¸»æœºåã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-4"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦è¿æ¥åˆ° XMPP èŠå¤©æœåŠ¡å™¨çš„åº”ç”¨ç¨‹åºã€‚XMPP æœåŠ¡å™¨çš„ SRV è®°å½•å¯èƒ½ä¼šè¢«è®¾ç½®ä¸º <code>_xmpp-server._tcp.example.com</code>ã€‚é€šè¿‡æŸ¥è¯¢è¿™ä¸ª SRV è®°å½•ï¼Œä½ å¯ä»¥æ‰¾å‡ºå®é™…çš„æœåŠ¡å™¨åœ°å€å’Œç«¯å£å·ï¼Œç„¶åæ‰èƒ½å»ºç«‹è¿æ¥ã€‚</p><p>ä¸‹é¢æ˜¯ä½¿ç”¨ <code>dnsPromises.resolveSrv</code> æŸ¥è¯¢ SRV è®°å½•çš„ä»£ç ç¤ºä¾‹ï¼š</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> resolveSrvRecord</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> records</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveSrv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`SRV records for </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">records</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Could not resolve SRV records for </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨å‡½æ•°æŸ¥è¯¢ç‰¹å®šçš„SRVè®°å½•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveSrvRecord</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;_xmpp-server._tcp.example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é¦–å…ˆå¼•å…¥äº† Node.js çš„ <code>dns</code> æ¨¡å—ä¸­çš„ <code>promises</code> APIï¼Œç„¶åå®šä¹‰äº†ä¸€ä¸ªå‡½æ•° <code>resolveSrvRecord</code>ï¼Œè¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ªä¸»æœºåä½œä¸ºå‚æ•°ï¼Œå¹¶æ‰“å°å‡ºæ‰€æœ‰å…³è”çš„ SRV è®°å½•æˆ–åœ¨æ— æ³•è§£ææ—¶æŠ¥é”™ã€‚æœ€åè°ƒç”¨è¿™ä¸ªå‡½æ•°æ¥è·å– <code>_xmpp-server._tcp.example.com</code> çš„ SRV è®°å½•ã€‚</p><h3 id="dnspromises-resolvetxt-hostname" tabindex="-1"><a class="header-anchor" href="#dnspromises-resolvetxt-hostname"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromisesresolvetxthostname" target="_blank" rel="noopener noreferrer">dnsPromises.resolveTxt(hostname)</a></span></a></h3><p><code>dnsPromises.resolveTxt(hostname)</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå±äº <code>dns</code> æ¨¡å—çš„ <code>promises</code> æ¥å£ã€‚è¿™ä¸ªå‡½æ•°ç”¨äºå¼‚æ­¥åœ°è§£æç»™å®šä¸»æœºåï¼ˆhostnameï¼‰çš„ TXT è®°å½•ã€‚TXT è®°å½•æ˜¯åŸŸåç³»ç»Ÿï¼ˆDNSï¼‰ä¸­ç”¨æ¥å­˜å‚¨æ–‡æœ¬ä¿¡æ¯çš„ä¸€ç§èµ„æºè®°å½•ç±»å‹ï¼Œå¸¸ç”¨äºå„ç§éªŒè¯ç›®çš„ï¼Œæ¯”å¦‚éªŒè¯åŸŸåæ‰€æœ‰æƒã€å‘é€é‚®ä»¶æœåŠ¡å™¨çš„ SPF è®°å½•ç­‰ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œä½¿ç”¨ <code>dnsPromises</code> å¯¹è±¡è°ƒç”¨ <code>resolveTxt</code> å‡½æ•°æ—¶ï¼Œä¼šè¿”å›ä¸€ä¸ªæ‰¿è¯ºï¼ˆPromiseï¼‰ï¼Œè¿™æ„å‘³ç€è¿™ä¸ªæ“ä½œæ˜¯å¼‚æ­¥çš„ï¼Œä¸ä¼šç«‹å³è¿”å›ç»“æœï¼Œè€Œæ˜¯åœ¨æŸ¥æ‰¾å®Œæˆåé€šè¿‡æ‰¿è¯ºå¤„ç†ç»“æœã€‚</p><p>ä¸‹é¢æˆ‘å°†é€šè¿‡å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­æ¥è§£é‡Šè¿™ä¸ªå‡½æ•°çš„ä½¿ç”¨æ–¹æ³•ï¼š</p><h3 id="ç¤ºä¾‹-1-è§£æåŸŸåçš„-txt-è®°å½•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-è§£æåŸŸåçš„-txt-è®°å½•"><span>ç¤ºä¾‹ 1: è§£æåŸŸåçš„ TXT è®°å½•</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥ dns çš„ promises æ¥å£</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> resolveTxtRecord</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // ä½¿ç”¨ resolveTxt å‡½æ•°æŸ¥è¯¢æŒ‡å®š hostname çš„ TXT è®°å½•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> records</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveTxt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`TXT records for </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">records</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¦‚æœå‡ºç°é”™è¯¯ï¼ˆä¾‹å¦‚ç½‘ç»œé—®é¢˜æˆ–åŸŸåä¸å­˜åœ¨ï¼‰ï¼Œåˆ™æ‰“å°é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Error occurred: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">error</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è°ƒç”¨å‡½æ•°å¹¶ä¼ å…¥ä¸€ä¸ªéœ€è¦æŸ¥è¯¢ TXT è®°å½•çš„åŸŸå</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveTxtRecord</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç¤ºä¾‹-2-éªŒè¯åŸŸåæ‰€æœ‰æƒ" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-éªŒè¯åŸŸåæ‰€æœ‰æƒ"><span>ç¤ºä¾‹ 2: éªŒè¯åŸŸåæ‰€æœ‰æƒ</span></a></h3><p>å½“ä½ ä¸ºä½ çš„ç½‘ç«™è®¾ç½®ç¬¬ä¸‰æ–¹æœåŠ¡ï¼ˆæ¯”å¦‚ Google Workspace æˆ– Microsoft 365ï¼‰æ—¶ï¼Œå®ƒä»¬å¯èƒ½è¦æ±‚ä½ æ·»åŠ ä¸€ä¸ªç‰¹å®šçš„ TXT è®°å½•åˆ°ä½ çš„åŸŸåä¸­ï¼Œæ¥è¯æ˜ä½ æ‹¥æœ‰é‚£ä¸ªåŸŸåã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> verifyDomainOwnership</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">domain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">expectedValue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> txtRecordsArray</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveTxt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">domain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> txtRecords</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [].</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">concat</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">txtRecordsArray</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†å¤šç»´æ•°ç»„æ‰å¹³åŒ–</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">txtRecords</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">includes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">expectedValue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`The domain </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">domain</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> is verified.`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`The domain </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">domain</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> could not be verified.`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Verification failed: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">error</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> myDomain</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;mywebsite.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> myExpectedTxtValue</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;my-verification-code-from-third-party-service&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">verifyDomainOwnership</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">myDomain</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">myExpectedTxtValue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡è§£æ <code>mywebsite.com</code> åŸŸåçš„ TXT è®°å½•ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦åŒ…å«äº†ç¬¬ä¸‰æ–¹æœåŠ¡æä¾›çš„éªŒè¯ä»£ç  &#39;my-verification-code-from-third-party-service&#39; æ¥éªŒè¯åŸŸåæ‰€æœ‰æƒã€‚å¦‚æœ TXT è®°å½•ä¸­åŒ…å«è¿™ä¸ªå€¼ï¼Œæ„å‘³ç€éªŒè¯æˆåŠŸã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>dnsPromises.resolveTxt(hostname)</code> æ˜¯ä¸€ä¸ªç”¨äºè·å–æŸä¸ªåŸŸå TXT è®°å½•çš„ Node.js å‡½æ•°ã€‚å®ƒè¿”å›ä¸€ä¸ªæ‰¿è¯ºï¼Œè¯¥æ‰¿è¯ºåœ¨è§£æå®Œæˆåï¼Œèƒ½å¤Ÿè®©ä½ å¤„ç†ç»“æœï¼Œç”¨äºåƒéªŒè¯åŸŸåæ‰€æœ‰æƒæˆ–æ£€ç´¢é…ç½®ä¿¡æ¯è¿™æ ·çš„åœºæ™¯ã€‚</p><h3 id="dnspromises-reverse-ip" tabindex="-1"><a class="header-anchor" href="#dnspromises-reverse-ip"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromisesreverseip" target="_blank" rel="noopener noreferrer">dnsPromises.reverse(ip)</a></span></a></h3><p>Node.js çš„ <code>dnsPromises.reverse(ip)</code> å‡½æ•°æ˜¯ç”¨äºè¿›è¡Œ IP åœ°å€åå‘è§£æçš„ï¼Œå®ƒå°†ä¸€ä¸ª IPv4 æˆ– IPv6 åœ°å€è½¬æ¢æˆåŸŸåã€‚è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè¿™æ„å‘³ç€å®ƒæ”¯æŒå¼‚æ­¥æ“ä½œï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨ <code>.then</code>, <code>.catch</code> ä»¥åŠ <code>async/await</code> è¿™æ ·çš„ç°ä»£ JavaScript åŠŸèƒ½æ¥å¤„ç†ç»“æœå’Œæ•è·é”™è¯¯ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>dnsPromises</code> æ˜¯ <code>dns</code> æ¨¡å—ä¸­æä¾›çš„ä¸€ä¸ªå¯¹è±¡ï¼Œä¸“é—¨ç”¨äºå¤„ç† DNSï¼ˆåŸŸåç³»ç»Ÿï¼‰æŸ¥è¯¢ï¼Œå¹¶é‡‡ç”¨ Promise é£æ ¼çš„ APIã€‚ä¸ä¼ ç»Ÿçš„å›è°ƒé£æ ¼ä¸åŒï¼ŒPromise é£æ ¼è®©ä½ èƒ½å†™å‡ºæ›´åŠ æ¸…æ™°å’Œæ˜“äºç»´æŠ¤çš„å¼‚æ­¥ä»£ç ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡å‡ ä¸ªä¾‹å­æ¥é€æ­¥äº†è§£ <code>dnsPromises.reverse(ip)</code> çš„ä½¿ç”¨æ–¹å¼ï¼š</p><h3 id="åŸºæœ¬ä½¿ç”¨æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ä½¿ç”¨æ–¹æ³•"><span>åŸºæœ¬ä½¿ç”¨æ–¹æ³•</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">reverse</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> reverseLookup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">ip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hostnames</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> reverse</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`IP åœ°å€ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ip</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> å¯¹åº”çš„åŸŸå: `</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostnames</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ— æ³•è§£æ IP åœ°å€ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ip</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: `</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">reverseLookup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;8.8.8.8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°è¯•å¯¹ Google å…¬å…± DNS çš„ IP è¿›è¡Œåå‘è§£æ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† Node.js æ ¸å¿ƒçš„ <code>dns</code> æ¨¡å—ã€‚ç„¶åï¼Œä» <code>dns.promises</code> å¯¹è±¡ä¸­è§£æ„å‡º <code>reverse</code> å‡½æ•°ã€‚è¿™ä¸ª <code>reverseLookup</code> å‡½æ•°æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•° (<code>async function</code>)ï¼Œå®ƒå°è¯•æ‰§è¡Œ IP åœ°å€çš„åå‘è§£æã€‚å¦‚æœæˆåŠŸï¼Œå®ƒä¼šè¾“å‡ºè¯¥ IP å¯¹åº”çš„åŸŸåï¼›å¦‚æœå¤±è´¥ï¼Œå®ƒä¼šæ•è·é”™è¯¯å¹¶è¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="é”™è¯¯å¤„ç†" tabindex="-1"><a class="header-anchor" href="#é”™è¯¯å¤„ç†"><span>é”™è¯¯å¤„ç†</span></a></h3><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œé”™è¯¯æ˜¯é€šè¿‡ <code>try...catch</code> ç»“æ„è¿›è¡Œå¤„ç†çš„ã€‚å¦‚æœç”±äºæŸäº›åŸå› ï¼ˆå¦‚ç½‘ç»œé—®é¢˜ã€æ— æ•ˆçš„ IPã€æ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„åŸŸåç­‰ï¼‰<code>reverse</code> æ–¹æ³•å¤±è´¥äº†ï¼Œå®ƒä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œä½ å¯ä»¥åœ¨ <code>catch</code> å—ä¸­è·å–åˆ°è¿™ä¸ªé”™è¯¯å¹¶åšç›¸åº”çš„å¤„ç†ã€‚</p><h3 id="å®é™…åº”ç”¨åœºæ™¯-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨åœºæ™¯-1"><span>å®é™…åº”ç”¨åœºæ™¯</span></a></h3><ol><li><p><strong>æ—¥å¿—åˆ†æï¼š</strong> åœ¨æœåŠ¡å™¨æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œé€šå¸¸è®°å½•äº†è®¿é—®è€…çš„ IP åœ°å€ã€‚ä¸ºäº†å¾—åˆ°æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼Œä½ å¯èƒ½éœ€è¦çŸ¥é“è¿™äº› IP åœ°å€å¯¹åº”çš„åŸŸåã€‚ä½¿ç”¨ <code>dnsPromises.reverse(ip)</code> å¯ä»¥å¸®åŠ©ä½ å®ç°è¿™ä¸€åŠŸèƒ½ã€‚</p></li><li><p><strong>å®‰å…¨å®¡è®¡ï¼š</strong> å½“ä½ çš„æœåŠ¡å™¨é­å—å¯ç–‘è®¿é—®æ—¶ï¼Œåå‘è§£ææ”»å‡»è€…çš„ IP åœ°å€å¯èƒ½å¸®åŠ©ä½ è¿½è¸ªåˆ°æºå¤´æˆ–è€…äº†è§£æ”»å‡»è€…èƒŒåå¯èƒ½çš„ç»„ç»‡ã€‚</p></li><li><p><strong>ç½‘ç»œç›‘æ§å·¥å…·ï¼š</strong> å¦‚æœä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç½‘ç»œç›‘æ§å·¥å…·ï¼Œä½ å¯èƒ½éœ€è¦å°†æ•æ‰åˆ°çš„ IP åœ°å€è½¬åŒ–ä¸ºç”¨æˆ·å‹å¥½çš„åŸŸåï¼Œä»¥ä¾¿äºå¯¹ç›‘æ§æ•°æ®è¿›è¡Œåˆ†æå’ŒæŠ¥å‘Šã€‚</p></li></ol><p>è®°ä½ï¼Œåœ¨ä½¿ç”¨ <code>dnsPromises.reverse(ip)</code> æˆ–ä»»ä½•æ¶‰åŠç½‘ç»œæ“ä½œçš„ API æ—¶ï¼Œä½ åº”è¯¥è€ƒè™‘åˆ°å®ƒä»¬å¯èƒ½ä¼šå—åˆ°ç½‘ç»œå»¶è¿Ÿçš„å½±å“ï¼Œå¼‚æ­¥æ“ä½œå’Œæ­£ç¡®çš„é”™è¯¯å¤„ç†æ˜¯éå¸¸é‡è¦çš„ã€‚</p><h3 id="dnspromises-setdefaultresultorder-order" tabindex="-1"><a class="header-anchor" href="#dnspromises-setdefaultresultorder-order"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromisessetdefaultresultorderorder" target="_blank" rel="noopener noreferrer">dnsPromises.setDefaultResultOrder(order)</a></span></a></h3><p>å½“ç„¶ï¼Œå¾ˆä¹æ„ä¸ºä½ è§£é‡Š <code>dnsPromises.setDefaultResultOrder(order)</code> è¿™ä¸ªåŠŸèƒ½ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>dns</code> æ¨¡å—è´Ÿè´£ç½‘ç»œä¸ŠåŸŸåå’Œåœ°å€ä¹‹é—´çš„è½¬æ¢ï¼Œå°±åƒæ˜¯äº’è”ç½‘çš„ç”µè¯ç°¿ä¸€æ ·ã€‚è¿™ä¸ªæ¨¡å—æä¾›äº†åŸºäº Promise çš„æ¥å£ï¼Œå³ <code>dnsPromises</code>ï¼Œä½¿å¾—å¼‚æ­¥å¤„ç† DNS ç›¸å…³æ“ä½œå˜å¾—æ›´åŠ ç®€å•å’Œç°ä»£åŒ–ã€‚</p><p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹ <code>dnsPromises.setDefaultResultOrder(order)</code> è¿™ä¸ªæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•å½±å“çš„æ˜¯ <code>dnsPromises.resolve()</code> å‡½æ•°è¿”å› IP åœ°å€æ—¶çš„é¡ºåºã€‚é€šå¸¸ï¼Œå½“ä½ å°è¯•è§£æä¸€ä¸ªåŸŸåæ¯”å¦‚ &quot;<a href="http://example.com" target="_blank" rel="noopener noreferrer">example.com</a>&quot; æ—¶ï¼Œå¯èƒ½ä¼šå¾—åˆ°å¤šä¸ª IP åœ°å€ä½œä¸ºç»“æœï¼Œå› ä¸ºå¤§å‹ç½‘ç«™ä¼šéƒ¨ç½²åœ¨å¤šä¸ªæœåŠ¡å™¨ä¸Šä»¥å¢å¼ºå¯é æ€§å’Œæ€§èƒ½ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒIPv4 åœ°å€ï¼ˆä½¿ç”¨ <code>A</code> è®°å½•ï¼‰å¯èƒ½ä¼šæ’åœ¨ IPv6 åœ°å€ï¼ˆä½¿ç”¨ <code>AAAA</code> è®°å½•ï¼‰å‰é¢ï¼Œæˆ–è€…åè¿‡æ¥ã€‚ä½†å¦‚æœä½ æƒ³è¦æŒ‡å®šä¸€ä¸ªé»˜è®¤çš„æ’åºé¡ºåºï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>dnsPromises.setDefaultResultOrder(order)</code> æ¥å®ç°ã€‚</p><p>å‚æ•° <code>order</code> å¯ä»¥å–ä»¥ä¸‹ä¸¤ä¸ªå€¼ä¹‹ä¸€ï¼š</p><ol><li><code>&#39;ipv4first&#39;</code>: è¿™ä¼šå¯¼è‡´ IPv4 åœ°å€åœ¨ä»»ä½• IPv6 åœ°å€ä¹‹å‰è¿”å›ã€‚</li><li><code>&#39;verbatim&#39;</code>: ç»“æœå°†æŒ‰ç…§ä»åº•å±‚ DNS è§£æå™¨è¿”å›çš„åŸå§‹é¡ºåºè¿”å›ã€‚</li></ol><p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ æ­£åœ¨æ„å»ºä¸€ä¸ªéœ€è¦è¿æ¥åˆ°æŸä¸ªæœåŠ¡çš„ Node.js åº”ç”¨ç¨‹åºï¼Œè€Œè¯¥æœåŠ¡åŒæ—¶æ”¯æŒ IPv4 å’Œ IPv6ã€‚ä½ å¯èƒ½ä¼šé¦–å…ˆæƒ³å°è¯•ä½¿ç”¨ IPv4 æ¥è¿æ¥ï¼Œå› ä¸ºç›®å‰ IPv4 ä»ç„¶æ˜¯ Internet ä¸Šæœ€å¹¿æ³›ä½¿ç”¨çš„åè®®ï¼Œå¹¶ä¸”ä¸æ˜¯æ‰€æœ‰ç¯å¢ƒéƒ½æ”¯æŒ IPv6ã€‚é‚£ä¹ˆï¼Œä½ å¯ä»¥åœ¨ä½ çš„åº”ç”¨ç¨‹åºåˆå§‹åŒ–æ—¶è®¾ç½®é»˜è®¤çš„è§£æé¡ºåºä¸º <code>&#39;ipv4first&#39;</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®é»˜è®¤çš„è§£æé¡ºåºä¸ºIPv4ä¼˜å…ˆ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setDefaultResultOrder</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ipv4first&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç„¶åå½“ä½ è§£æä¸€ä¸ªåŸŸåæ—¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">dns</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œçš„addressesæ•°ç»„å°†ä¼šæ˜¯IPv4åœ°å€åœ¨å‰çš„</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä½ æ²¡æœ‰è°ƒç”¨ <code>dnsPromises.setDefaultResultOrder(order)</code> æ–¹æ³•è®¾ç½®é¡ºåºï¼Œæˆ–è€…è®¾ç½®äº† <code>&#39;verbatim&#39;</code>ï¼Œé‚£ä¹ˆ IP åœ°å€å°†ä¼šæŒ‰ç…§ DNS æœåŠ¡å™¨è¿”å›çš„åŸå§‹é¡ºåºç»™å‡ºã€‚</p><p>è¯·æ³¨æ„ï¼Œè¿™ä¸ªæ–¹æ³•ä¸ä¿è¯åœ¨æ‰€æœ‰å¹³å°ä¸Šéƒ½èƒ½æŒ‰é¢„æœŸå·¥ä½œï¼Œå› ä¸ºå®ƒä¾èµ–äºåº•å±‚æ“ä½œç³»ç»Ÿå¯¹ DNS è®°å½•çš„å¤„ç†æ–¹å¼ï¼Œæ‰€ä»¥åœ¨æŸäº›å¹³å°ä¸Šï¼Œå¯èƒ½æ— æ³•å®Œå…¨æ§åˆ¶ç»“æœçš„é¡ºåºã€‚</p><h3 id="dnspromises-getdefaultresultorder" tabindex="-1"><a class="header-anchor" href="#dnspromises-getdefaultresultorder"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromisesgetdefaultresultorder" target="_blank" rel="noopener noreferrer">dnsPromises.getDefaultResultOrder()</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­ <code>dnsPromises.getDefaultResultOrder()</code> è¿™ä¸ªå‡½æ•°ã€‚</p><p>DNSï¼ˆDomain Name Systemï¼‰æ˜¯äº’è”ç½‘ä¸Šç”¨äºå°†åŸŸåè½¬æ¢ä¸º IP åœ°å€çš„ç³»ç»Ÿã€‚å½“ä½ è¯•å›¾è¿æ¥åˆ°ä¸€ä¸ªç½‘ç«™æ—¶ï¼Œä¾‹å¦‚è®¿é—® <code>www.google.com</code>ï¼Œä½ çš„ç”µè„‘éœ€è¦çŸ¥é“è¿™ä¸ªåŸŸåå¯¹åº”çš„ IP åœ°å€æ‰èƒ½å»ºç«‹è¿æ¥ã€‚è¿™å°±æ˜¯ DNS è§£æçš„ä½œç”¨ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>dnsPromises</code> æ¨¡å—æä¾›äº†ä¸€ç³»åˆ—ç”¨äºæ‰§è¡Œ DNS æŸ¥è¯¢çš„å‡½æ•°ï¼Œè¿™äº›å‡½æ•°è¿”å› Promise å¯¹è±¡ï¼Œä¾¿äºä½¿ç”¨ async/await è¯­æ³•ç¼–å†™å¼‚æ­¥ä»£ç ã€‚</p><p><code>dnsPromises.getDefaultResultOrder()</code> å‡½æ•°çš„ä½œç”¨æ˜¯è·å–å½“å‰ç¯å¢ƒé»˜è®¤çš„ DNS è§£æç»“æœæ’åºæ–¹å¼ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸€ä¸ªåŸŸåå¯èƒ½ä¼šè§£æå‡ºå¤šä¸ª IP åœ°å€ï¼Œè¿™äº›åœ°å€å¯ä»¥æŒ‰ IPv4 åœ¨å‰æˆ–è€… IPv6 åœ¨å‰çš„é¡ºåºæ’åˆ—ã€‚è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ª Promiseï¼Œè§£æåå¾—åˆ°çš„å€¼æ˜¯ <code>&#39;ipv4first&#39;</code> æˆ– <code>&#39;verbatim&#39;</code>â€”â€”å‰è€…è¡¨ç¤ºé»˜è®¤å°† IPv4 åœ°å€æ”¾åœ¨å‰é¢ï¼Œåè€…è¡¨ç¤ºä¿æŒ DNS è§£æç»“æœçš„åŸå§‹é¡ºåºã€‚</p><p>ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> checkDefaultResultOrder</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> order</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dnsPromises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getDefaultResultOrder</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`é»˜è®¤çš„ DNS è§£æç»“æœæ’åºæ–¹å¼æ˜¯: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">order</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è·å– DNS è§£æç»“æœæ’åºæ–¹å¼å‡ºé”™:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">checkDefaultResultOrder</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† <code>dns.promises</code> æ¨¡å—ã€‚ç„¶åå®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° <code>checkDefaultResultOrder</code>ï¼Œå®ƒä½¿ç”¨äº† <code>await</code> å…³é”®å­—ç­‰å¾… <code>getDefaultResultOrder()</code> çš„ç»“æœã€‚ä¸€æ—¦ç»“æœå¯ç”¨ï¼Œå®ƒå°†æ‰“å°å‡ºé»˜è®¤çš„æ’åºæ–¹å¼ï¼›å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œå®ƒå°†æ‰“å°å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p><p>è¿™ä¸ªå‡½æ•°æœ¬èº«çš„å®é™…è¿ç”¨åœºæ™¯ç›¸å¯¹è¾ƒå°‘ï¼Œå› ä¸ºå¤§å¤šæ•°å¼€å‘è€…å¯èƒ½å¹¶ä¸éœ€è¦å…³å¿ƒå¤šä¸ª IP åœ°å€çš„æ’åºé—®é¢˜ï¼Œä½†æ˜¯å¯¹äºéœ€è¦ä¼˜åŒ–ç½‘ç»œè¿æ¥çš„å¼€å‘è€…ï¼Œäº†è§£é»˜è®¤çš„æ’åºæ–¹å¼æˆ–è®¸æœ‰åŠ©äºæ›´å¥½åœ°æ§åˆ¶ DNS è§£æè¡Œä¸ºã€‚</p><p>å¸Œæœ›è¿™èƒ½å¸®åŠ©ä½ ç†è§£ <code>dnsPromises.getDefaultResultOrder()</code> çš„ä½œç”¨å’Œå¦‚ä½•åœ¨ä»£ç ä¸­ä½¿ç”¨å®ƒã€‚</p><h3 id="dnspromises-setservers-servers" tabindex="-1"><a class="header-anchor" href="#dnspromises-setservers-servers"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnspromisessetserversservers" target="_blank" rel="noopener noreferrer">dnsPromises.setServers(servers)</a></span></a></h3><p>Node.js ä¸­çš„ <code>dnsPromises.setServers(servers)</code> å‡½æ•°æ˜¯ç”¨äºæ”¹å˜åœ¨è¿›è¡Œ DNS è§£ææ—¶æ‰€ä½¿ç”¨çš„æœåŠ¡å™¨åœ°å€ã€‚è¿™ä¸ªåŠŸèƒ½å±äº Node.js çš„ <code>dns</code> æ¨¡å—ï¼Œè¯¥æ¨¡å—æä¾›äº†ä¸€äº›å‡½æ•°æ¥ä¸ç½‘ç»œä¸Šçš„åŸŸåç³»ç»Ÿè¿›è¡Œäº’åŠ¨ã€‚</p><p>DNSï¼ˆåŸŸåç³»ç»Ÿï¼‰è´Ÿè´£å°†äººç±»å¯è¯»çš„ç½‘å€ï¼ˆå¦‚ <code>www.example.com</code>ï¼‰è½¬æ¢æˆè®¡ç®—æœºå¯ä»¥ç†è§£çš„ IP åœ°å€ï¼ˆå¦‚ <code>93.184.216.34</code>ï¼‰ï¼Œå› ä¸ºåœ¨äº’è”ç½‘ä¸Šï¼Œè®¡ç®—æœºä¹‹é—´æ˜¯é€šè¿‡ IP åœ°å€æ¥é€šä¿¡çš„ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ä½ çš„åº”ç”¨ç¨‹åºéœ€è¦è¿›è¡Œ DNS è§£ææ—¶ï¼ˆä¾‹å¦‚å½“ä½ å°è¯•è¿æ¥åˆ°æŸä¸ªæœåŠ¡å™¨æˆ–è€…è¯·æ±‚ä¸€ä¸ªç½‘é¡µæ—¶ï¼‰ï¼Œå®ƒä¼šä½¿ç”¨æ“ä½œç³»ç»Ÿé…ç½®çš„ DNS æœåŠ¡å™¨ã€‚ä½†æœ‰æ—¶å€™ï¼Œä½ å¯èƒ½å¸Œæœ›è‡ªå®šä¹‰ DNS æœåŠ¡å™¨ï¼Œä¾‹å¦‚ä¸ºäº†å¢åŠ éšç§ã€æé«˜æ€§èƒ½ã€è¿›è¡Œæµ‹è¯•æˆ–è€…é¿å…æŸäº›ç½‘ç»œé—®é¢˜ã€‚</p><p><code>dnsPromises.setServers(servers)</code> å°±æ˜¯ç”¨æ¥è®¾ç½®è¿™äº›è‡ªå®šä¹‰ DNS æœåŠ¡å™¨çš„ã€‚å®ƒæ¥æ”¶ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ä¸²çš„æ•°ç»„ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²ä»£è¡¨ä¸€ä¸ª DNS æœåŠ¡å™¨çš„ IP åœ°å€ã€‚</p><p>ä¾‹å­ï¼š</p><p>å‡è®¾æˆ‘ä»¬æƒ³ä½¿ç”¨ Google æä¾›çš„å…¬å…± DNS æœåŠ¡å™¨ï¼ˆ<code>8.8.8.8</code> å’Œ <code>8.8.4.4</code>ï¼‰æ¥è¿›è¡Œ DNS è§£æã€‚ä»¥ä¸‹æ˜¯åœ¨ Node.js åº”ç”¨ä¸­è®¾ç½®è¿™äº›æœåŠ¡å™¨çš„ä»£ç ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> setCustomDNSServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // è®¾ç½®è‡ªå®šä¹‰ DNS æœåŠ¡å™¨åœ°å€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;8.8.8.8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;8.8.4.4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;DNS servers have been set successfully.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Error setting DNS servers:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setCustomDNSServers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† Node.js çš„ <code>dns</code> æ¨¡å—ï¼Œå¹¶é€‰æ‹©ä½¿ç”¨å…¶ Promise-based APIï¼ˆå³ <code>dns.promises</code>ï¼‰ã€‚ç„¶åæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° <code>setCustomDNSServers</code>ï¼Œåœ¨è¿™ä¸ªå‡½æ•°å†…éƒ¨ï¼Œæˆ‘ä»¬è°ƒç”¨äº† <code>dns.setServers()</code> æ–¹æ³•å¹¶ä¼ é€’äº†ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ï¼Œæ•°ç»„é‡ŒåŒ…å«äº†ä¸¤ä¸ª Google DNS æœåŠ¡å™¨çš„ IP åœ°å€ã€‚éšåï¼Œæˆ‘ä»¬é€šè¿‡ <code>await</code> å…³é”®å­—ç­‰å¾…è®¾ç½®å®Œæˆã€‚</p><p>å¦‚æœ DNS æœåŠ¡å™¨æˆåŠŸè®¾ç½®ï¼Œæ§åˆ¶å°å°†æ‰“å°å‡º &quot;DNS servers have been set successfully.&quot;ï¼›å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œæ¯”å¦‚ä¼ å…¥æ— æ•ˆçš„ IP åœ°å€ï¼Œå°†æ•è·å¼‚å¸¸å¹¶åœ¨æ§åˆ¶å°æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚</p><p>è¯·æ³¨æ„ï¼Œåœ¨ Node.js åº”ç”¨ä¸­æ›´æ”¹ DNS æœåŠ¡å™¨åªä¼šå½±å“å½“å‰è¿è¡Œçš„ Node.js è¿›ç¨‹ã€‚å®ƒä¸ä¼šæ”¹å˜ä½ æœºå™¨ä¸Šçš„å…¨å±€ DNS è®¾ç½®ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä½ çš„ Node.js ç¨‹åºåœæ­¢è¿è¡Œåï¼Œè¿™äº›è®¾ç½®å¹¶ä¸ä¼šä¿ç•™ã€‚</p><h2 id="error-codes" tabindex="-1"><a class="header-anchor" href="#error-codes"><span><a href="https://nodejs.org/docs/latest/api/dns.html#error-codes" target="_blank" rel="noopener noreferrer">Error codes</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå®ƒè®©å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ç¨‹åºã€‚åœ¨ Node.js ä¸­ï¼Œå¤„ç†ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶æ“ä½œç­‰å¼‚æ­¥ä»»åŠ¡æ—¶ç»å¸¸ä¼šç¢°åˆ°å„ç§é”™è¯¯ã€‚ä¸ºäº†ä¾¿äºå¤„ç†å’ŒåŒºåˆ†è¿™äº›é”™è¯¯ï¼ŒNode.js å®šä¹‰äº†ä¸€ç³»åˆ—æ ‡å‡†çš„é”™è¯¯ä»£ç ã€‚</p><p>åœ¨ Node.js çš„ DNSï¼ˆDomain Name Systemï¼‰æ¨¡å—ä¸­ï¼Œä¹Ÿå®šä¹‰äº†ä¸€äº›ç‰¹å®šçš„é”™è¯¯ä»£ç ï¼Œç”¨æ¥æè¿°åœ¨è§£æåŸŸåæ—¶å¯èƒ½å‡ºç°çš„é—®é¢˜ã€‚DNS æ˜¯äº’è”ç½‘çš„ç”µè¯ç°¿ï¼Œè´Ÿè´£å°†äººç±»å¯è¯»çš„ç½‘ç«™åœ°å€ï¼ˆä¾‹å¦‚ <code>www.example.com</code>ï¼‰è½¬æ¢ä¸ºæœºå™¨å¯è¯»çš„ IP åœ°å€ï¼ˆä¾‹å¦‚ <code>192.0.2.1</code>ï¼‰ã€‚</p><p>ä¸‹é¢æ˜¯ Node.js v21.7.1 ä¸­ä¸€äº›å¸¸è§çš„ DNS é”™è¯¯ä»£ç ä»¥åŠä»–ä»¬çš„å«ä¹‰ï¼Œæˆ‘è¿˜ä¼šä¸¾ä¾‹è¯´æ˜æ¯ä¸ªé”™è¯¯å¯èƒ½åœ¨ä»€ä¹ˆæƒ…å†µä¸‹å‘ç”Ÿï¼š</p><ol><li><code>EADDRINFO</code> - æ— æ³•è·å–åœ°å€ä¿¡æ¯ <ul><li>å½“å°è¯•ç”¨ <code>dns.lookup()</code> æ–¹æ³•è§£æä¸€ä¸ªåŸŸåï¼Œä½†æ— æ³•è·å¾—ä»»ä½•åœ°å€ä¿¡æ¯æ—¶ï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§é”™è¯¯ã€‚</li><li>ä¾‹å­ï¼šå½“æ‚¨å°è¯•è¿æ¥åˆ°ä¸€ä¸ªä¸å­˜åœ¨çš„åŸŸåæ—¶å¯èƒ½ä¼šé‡åˆ°è¿™ç§é”™è¯¯ã€‚</li></ul></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;someinvalidwebsite.example&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">code</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;EADDRINFO&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ— æ³•è·å–åœ°å€ä¿¡æ¯&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><code>ENOTFOUND</code> - åŸŸåæœªæ‰¾åˆ° <ul><li>è§£æåŸŸåæ—¶å¦‚æœè¯¥åŸŸåä¸å­˜åœ¨ï¼Œåˆ™ä¼šè¿”å›æ­¤é”™è¯¯ã€‚</li><li>ä¾‹å­ï¼šæ‚¨å°è¯•æŸ¥æ‰¾ä¸€ä¸ªæ‹¼å†™é”™è¯¯çš„åŸŸåæˆ–è€…ä¸€ä¸ªæ ¹æœ¬å°±æ²¡æœ‰æ³¨å†Œçš„åŸŸåã€‚</li></ul></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;nonexistentdomain.example&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">code</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;ENOTFOUND&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åŸŸåæœªæ‰¾åˆ°&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><code>ETIMEOUT</code> - è¿æ¥è¶…æ—¶ <ul><li>å¦‚æœåœ¨æŒ‡å®šçš„æ—¶é—´å†…æ— æ³•å®ŒæˆåŸŸåè§£ææ“ä½œï¼Œå°±ä¼šå‘ç”Ÿè¶…æ—¶é”™è¯¯ã€‚</li><li>ä¾‹å­ï¼šä½ çš„ç½‘ç»œè¿æ¥å¾ˆæ…¢ï¼Œæˆ–è€… DNS æœåŠ¡å™¨æ²¡æœ‰å“åº”ã€‚</li></ul></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æœ‰ä¸€ä¸ªè¶…æ—¶è®¾ç½®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">code</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;ETIMEOUT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¿æ¥è¶…æ—¶&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li><code>ESERVFAIL</code> - æœåŠ¡å™¨å¤±è´¥ <ul><li>è¡¨ç¤ºåŸŸåæœåŠ¡å™¨è¿”å›äº†ä¸€ä¸ªé€šç”¨çš„å¤±è´¥æ¶ˆæ¯ã€‚</li><li>ä¾‹å­ï¼šDNS æœåŠ¡é‡åˆ°é—®é¢˜ï¼Œä¸èƒ½å®Œæˆè¯·æ±‚ã€‚</li></ul></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œæ²¡æœ‰ç›´æ¥çš„ Node.js ç¤ºä¾‹ï¼Œå› ä¸ºå®ƒé€šå¸¸æ˜¯ç”± DNS æœåŠ¡å™¨è¿”å›çš„é”™è¯¯ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è€Œä¸æ˜¯ç”± Node.js æ§åˆ¶çš„ã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li><code>ENODATA</code> - æ²¡æœ‰ç›¸åº”ç±»å‹çš„è®°å½• <ul><li>è¯·æ±‚çš„åŸŸåæ˜¯å­˜åœ¨çš„ï¼Œä½†æ˜¯æ‰€è¯·æ±‚çš„è®°å½•ç±»å‹åœ¨åŸŸåæœåŠ¡å™¨ä¸Šæ²¡æœ‰æ‰¾åˆ°ã€‚</li><li>ä¾‹å­ï¼šä½ å¯èƒ½å°è¯•æŸ¥æ‰¾ä¸€ä¸ªåŸŸåçš„ MX è®°å½•ï¼Œä½†æ˜¯è¯¥åŸŸåæ²¡æœ‰é…ç½®é‚®ä»¶äº¤æ¢è®°å½•ã€‚</li></ul></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;MX&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">code</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;ENODATA&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ²¡æœ‰ç›¸åº”ç±»å‹çš„è®°å½•&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šæ˜¯å¯¹ Node.js ä¸­ DNS é”™è¯¯ä»£ç çš„ä¸€äº›è§£é‡Šå’Œç®€å•çš„ç¤ºä¾‹ã€‚äº†è§£è¿™äº›é”™è¯¯ä»£ç èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°è°ƒè¯•å’Œå¤„ç†åœ¨ä½¿ç”¨ DNS æ¨¡å—æ—¶å¯èƒ½é‡åˆ°çš„é—®é¢˜ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ ä¼šéœ€è¦æ ¹æ®é”™è¯¯çš„ç±»å‹æ¥å†³å®šå¦‚ä½•æ¢å¤ç¨‹åºçš„æ‰§è¡Œæˆ–ç»™ç”¨æˆ·æä¾›é€‚å½“çš„åé¦ˆä¿¡æ¯ã€‚</p><h2 id="implementation-considerations" tabindex="-1"><a class="header-anchor" href="#implementation-considerations"><span><a href="https://nodejs.org/docs/latest/api/dns.html#implementation-considerations" target="_blank" rel="noopener noreferrer">Implementation considerations</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„ JavaScript ç¯å¢ƒï¼Œå®ƒå…è®¸ä½ ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡ç«¯ä»£ç ã€‚å…¶ä¸­æœ‰ä¸€ä¸ªæ¨¡å—æ˜¯ DNSï¼ˆDomain Name System åŸŸåç³»ç»Ÿï¼‰ï¼ŒDNS æ¨¡å—å…è®¸ä½ ä¸ç½‘ç»œä¸­çš„åŸŸåç›¸å…³çš„å„ç§æ“ä½œäº¤äº’ï¼Œæ¯”å¦‚è§£æåŸŸåè·å– IP åœ°å€ç­‰ã€‚</p><p>åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œâ€œImplementation considerationsâ€å¯èƒ½æ˜¯ä¸€ä¸ªç« èŠ‚ï¼Œå®ƒä¼šè®¨è®ºå®ç° DNS æ¨¡å—æ—¶è¦è€ƒè™‘çš„ä¸€äº›æŠ€æœ¯ç»†èŠ‚å’Œé—®é¢˜ã€‚å…·ä½“åˆ°è¿™ä¸ªç‰ˆæœ¬ï¼Œæˆ‘æ²¡æœ‰è¯¦ç»†çš„å˜æ›´æ—¥å¿—ï¼Œä½†æˆ‘å¯ä»¥ç»™ä½ ä¸€ä¸ªé€šç”¨çš„æ¦‚è¿°ï¼š</p><ol><li><p><strong>DNS æ¨¡å—çš„ä½œç”¨</strong>ï¼šå½“ä½ åœ¨æµè§ˆå™¨è¾“å…¥ä¸€ä¸ªç½‘ç«™åœ°å€æ—¶ï¼ŒDNS æœåŠ¡å¸®åŠ©ä½ å°†è¿™ä¸ªäººç±»å‹å¥½çš„åŸŸåï¼ˆæ¯”å¦‚ <code>www.example.com</code>ï¼‰è½¬æ¢æˆæœºå™¨èƒ½ç†è§£çš„ IP åœ°å€ï¼ˆæ¯”å¦‚ <code>192.0.2.1</code>ï¼‰ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>dns</code> æ¨¡å—æä¾›äº†æ‰§è¡Œè¿™æ ·çš„è½¬æ¢çš„æ–¹æ³•ã€‚</p></li><li><p><strong>åº•å±‚å®ç°</strong>ï¼šNode.js çš„ <code>dns</code> æ¨¡å—å¯èƒ½ç›´æ¥ä½¿ç”¨åº•å±‚æ“ä½œç³»ç»Ÿæä¾›çš„ DNS åŠŸèƒ½ï¼Œä¹Ÿå¯èƒ½ä½¿ç”¨ä¸€ä¸ªçº¯ JavaScript å®ç°çš„ DNS è§£æå™¨ã€‚è¿™ä¸¤ç§æ–¹å¼åœ¨æ€§èƒ½ã€å¯é æ€§å’ŒåŠŸèƒ½ä¸Šå¯èƒ½æœ‰æ‰€ä¸åŒã€‚</p></li><li><p><strong>å¼‚æ­¥ä¸åŒæ­¥</strong>ï¼šåœ¨ Node.js ä¸­ï¼Œå¾ˆå¤šæ“ä½œé»˜è®¤æ˜¯å¼‚æ­¥çš„ï¼Œè¿™æ„å‘³ç€å®ƒä»¬ä¸ä¼šç«‹å³å®Œæˆï¼Œè€Œä¼šåœ¨å°†æ¥çš„æŸä¸ªæ—¶é—´ç‚¹å®Œæˆï¼Œè€Œç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ä¼šç»§ç»­æ‰§è¡Œã€‚<code>dns</code> æ¨¡å—æä¾›äº†å¼‚æ­¥æ–¹æ³•ï¼ˆä¾‹å¦‚ <code>dns.lookup()</code>ï¼‰ï¼Œä¹Ÿæä¾›äº†å¯¹åº”çš„åŒæ­¥æ–¹æ³•ï¼ˆä¾‹å¦‚ <code>dns.lookupSync()</code>ï¼‰ã€‚å¼‚æ­¥æ–¹æ³•ä¸ä¼šé˜»å¡ç¨‹åºçš„æ‰§è¡Œï¼Œè€ŒåŒæ­¥æ–¹æ³•ä¼šã€‚</p></li><li><p><strong>é”™è¯¯å¤„ç†</strong>ï¼šå½“è¿›è¡Œ DNS æŸ¥è¯¢æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°å„ç§é”™è¯¯ï¼Œæ¯”å¦‚åŸŸåä¸å­˜åœ¨æˆ–ç½‘ç»œé—®é¢˜ã€‚åœ¨ Node.js ä¸­ï¼Œè¿™äº›é”™è¯¯éœ€è¦è¢«å¦¥å–„å¤„ç†ï¼Œä»¥ç¡®ä¿ç¨‹åºçš„ç¨³å®šè¿è¡Œã€‚</p></li></ol><p>ä¸¾å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><p><strong>ä¾‹å­ 1ï¼šå¼‚æ­¥è§£æåŸŸå</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;www.example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">family</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`åœ°å€: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">address</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, å®¶æ—: IPv</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">family</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šå¼‚æ­¥åœ°è§£æ <code>www.example.com</code> çš„åŸŸåï¼Œå¹¶æ‰“å°å‡ºè§£æå¾—åˆ°çš„ IP åœ°å€åŠ IP ç‰ˆæœ¬ã€‚</p><p><strong>ä¾‹å­ 2ï¼šä½¿ç”¨ Promise è§£æåŸŸå</strong><br> Node.js åœ¨åç»­çš„ç‰ˆæœ¬ä¸­æ”¯æŒäº† Promises APIï¼Œå¯ä»¥è¿™æ ·ä½¿ç”¨ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">promisify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;util&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> lookupAsync</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> promisify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">lookup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookupAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;www.example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç åŒæ ·æ˜¯è§£æåŸŸåï¼Œä½†æ˜¯é‡‡ç”¨äº†ç°ä»£çš„ Promise é£æ ¼ï¼Œå¯ä»¥æ›´æ–¹ä¾¿åœ°è¿›è¡Œé”™è¯¯å¤„ç†å’Œé“¾å¼è°ƒç”¨ã€‚</p><p><strong>ä¾‹å­ 3ï¼šåŒæ­¥è§£æåŸŸå</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookupSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;www.example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šåŒæ­¥åœ°è§£æåŸŸåï¼Œæ„å‘³ç€ä»£ç ä¼šåœåœ¨è¿™é‡Œç­‰å¾…è§£æå®Œæˆï¼Œç„¶åå†ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç æˆ–è€…åœ¨å‘ç”Ÿé”™è¯¯æ—¶æ•è·å¼‚å¸¸ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯å…³äº Node.js çš„ <code>dns</code> æ¨¡å—çš„ä¸€äº›åŸºç¡€çŸ¥è¯†å’Œåº”ç”¨å®ä¾‹ã€‚å¸Œæœ›è¿™äº›è§£é‡Šå’Œä¾‹å­èƒ½å¸®åŠ©ä½ ç†è§£ Node.js ä¸­å…³äº DNS çš„å®ç°è€ƒè™‘ã€‚</p><h3 id="dns-lookup" tabindex="-1"><a class="header-anchor" href="#dns-lookup"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnslookup" target="_blank" rel="noopener noreferrer">dns.lookup()</a></span></a></h3><p>Node.js ä¸­çš„ <code>dns.lookup()</code> æ–¹æ³•æ˜¯ç”¨æ¥è§£æä¸€ä¸ªåŸŸåï¼ˆæ¯”å¦‚ <code>www.example.com</code>ï¼‰åˆ°å¯¹åº”çš„ IP åœ°å€ã€‚å½“æˆ‘ä»¬åœ¨æµè§ˆå™¨é‡Œè¾“å…¥ä¸€ä¸ªç½‘ç«™åœ°å€æ—¶ï¼Œå®é™…ä¸Šæµè§ˆå™¨ä¼šå…ˆæ‰¾åˆ°è¯¥ç½‘ç«™çš„ IP åœ°å€ï¼Œç„¶åé€šè¿‡è¿™ä¸ª IP åœ°å€å»è®¿é—®æœåŠ¡å™¨ã€‚<code>dns.lookup()</code> å°±æ˜¯ç”¨æ¥åšè¿™ä¸ª&quot;æ‰¾ IP åœ°å€&quot;çš„å·¥ä½œã€‚</p><p>ä¸‹é¢æˆ‘ä¼šè¯¦ç»†è§£é‡Š <code>dns.lookup()</code> æ–¹æ³•ï¼Œå¹¶ä¸¾å‡ ä¸ªä¾‹å­æ¥è¯´æ˜å¦‚ä½•åœ¨å®é™…ä¸­ä½¿ç”¨å®ƒã€‚</p><h3 id="ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#ç”¨æ³•"><span>ç”¨æ³•</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;dns&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>hostname</code> æ˜¯ä½ æƒ³è¦æŸ¥è¯¢çš„åŸŸåï¼Œä¾‹å¦‚ <code>&#39;google.com&#39;</code>ã€‚</li><li><code>options</code> æ˜¯å¯é€‰å‚æ•°ï¼Œå¯ä»¥æ§åˆ¶å¦‚ä½•æ‰§è¡ŒæŸ¥æ‰¾ï¼Œæ¯”å¦‚å¯ä»¥è®¾ç½®åœ°å€æ—ä¸º IPv4 æˆ– IPv6ã€‚</li><li><code>callback</code> æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå½“ <code>dns.lookup()</code> æ‰§è¡Œå®Œæ¯•åä¼šè¢«è°ƒç”¨ï¼Œå¹¶å¸¦æœ‰ä¸¤ä¸ªå‚æ•°ï¼š<code>err</code> å’Œ <code>address</code>ã€‚å¦‚æœå‡ºé”™äº†ï¼Œ<code>err</code> ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼Œå¦åˆ™ <code>err</code> ä¸º <code>null</code>ã€‚<code>address</code> æ˜¯æ‰¾åˆ°çš„ IP åœ°å€ã€‚</li></ul><h3 id="ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2"><span>ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æƒ³è¦æ‰¾å‡º <code>&#39;nodejs.org&#39;</code> çš„ IP åœ°å€ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ dns.lookup() æ–¹æ³•æŸ¥è¯¢ &#39;nodejs.org&#39; çš„ IP åœ°å€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;nodejs.org&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`&#39;nodejs.org&#39; çš„ IP åœ°å€æ˜¯ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">address</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œè¿™æ®µä»£ç ï¼Œä½ ä¼šå¾—åˆ°ç±»ä¼¼ä¸‹é¢çš„è¾“å‡ºï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>&#39;nodejs.org&#39; çš„ IP åœ°å€æ˜¯ï¼š104.20.22.46</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ³¨æ„ï¼Œå› ä¸ºæŸäº›åŸŸåå¯èƒ½ä¼šæœ‰å¤šä¸ª IP åœ°å€ï¼Œæ‰€ä»¥ <code>address</code> å¯èƒ½åªæ˜¯å…¶ä¸­ä¸€ä¸ªåœ°å€ã€‚</p><h3 id="è®¾ç½®åœ°å€æ—" tabindex="-1"><a class="header-anchor" href="#è®¾ç½®åœ°å€æ—"><span>è®¾ç½®åœ°å€æ—</span></a></h3><p>ä½ è¿˜å¯ä»¥æŒ‡å®šä½ å¸Œæœ›å¾—åˆ°çš„æ˜¯ IPv4 åœ°å€è¿˜æ˜¯ IPv6 åœ°å€ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ åªæƒ³è¦ IPv4 åœ°å€ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lookup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;nodejs.org&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">family</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`&#39;nodejs.org&#39; çš„ IPv4 åœ°å€æ˜¯ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">address</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-5"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p><strong>1. å¥åº·æ£€æŸ¥ï¼š</strong> å¦‚æœä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªéœ€è¦ç›‘æ§ç½‘ç«™æ˜¯å¦åœ¨çº¿çš„ç¨‹åºï¼Œä½ å¯ä»¥å®šæœŸåœ°ä½¿ç”¨ <code>dns.lookup()</code> æ¥ç¡®ä¿ä½ å¯ä»¥è§£æç½‘ç«™çš„åŸŸåã€‚å¦‚æœæŸä¸€æ¬¡è§£æå¤±è´¥ï¼Œé‚£å¯èƒ½æ„å‘³ç€ç½‘ç«™æœ‰é—®é¢˜ï¼Œä½ çš„ç¨‹åºå¯ä»¥æ®æ­¤é‡‡å–ç›¸åº”çš„æªæ–½ã€‚</p><p><strong>2. è´Ÿè½½å‡è¡¡ï¼š</strong> åœ¨ä¸€äº›å¤§å‹çš„ç½‘ç»œæœåŠ¡ä¸­ï¼ŒåŒä¸€ä¸ªåŸŸåå¯èƒ½ä¼šå¯¹åº”å¤šä¸ª IP åœ°å€ï¼Œè€Œæ¯ä¸ªåœ°å€éƒ½ä»£è¡¨ç€ä¸€ä¸ªæœåŠ¡å™¨èŠ‚ç‚¹ã€‚ä½¿ç”¨ <code>dns.lookup()</code> å¯ä»¥å¸®åŠ©å®¢æˆ·ç«¯è½¯ä»¶ç¡®å®šå“ªäº›æœåŠ¡å™¨èŠ‚ç‚¹æ˜¯å¯ç”¨çš„ï¼Œå¹¶å°†è¯·æ±‚åˆ†é…ç»™è¿™äº›èŠ‚ç‚¹ä¹‹ä¸€ã€‚</p><p><strong>3. ç½‘ç»œè¯Šæ–­å·¥å…·ï¼š</strong> ç½‘ç»œç®¡ç†å‘˜æˆ– IT ä¸“å®¶å¯èƒ½ä¼šç¼–å†™è‡ªåŠ¨åŒ–è„šæœ¬æ¥è¯Šæ–­ç½‘ç»œé—®é¢˜ã€‚<code>dns.lookup()</code> å¯ä»¥æˆä¸ºè¿™äº›è„šæœ¬çš„ä¸€éƒ¨åˆ†ï¼Œç”¨æ¥ç¡®è®¤ DNS è§£ææ˜¯å¦æ­£å¸¸å·¥ä½œã€‚</p><p>å¸Œæœ›è¿™äº›è§£é‡Šå’Œä¾‹å­å¯¹ä½ ç†è§£ <code>dns.lookup()</code> æ€ä¹ˆç”¨ä»¥åŠå®ƒç”¨é€”æœ‰æ‰€å¸®åŠ©ï¼</p><h3 id="dns-resolve-dns-resolve-and-dns-reverse" tabindex="-1"><a class="header-anchor" href="#dns-resolve-dns-resolve-and-dns-reverse"><span><a href="https://nodejs.org/docs/latest/api/dns.html#dnsresolve-dnsresolve-and-dnsreverse" target="_blank" rel="noopener noreferrer">dns.resolve(), dns.resolve*(), and dns.reverse()</a></span></a></h3><p>Node.js ä¸­çš„<code>dns</code>æ¨¡å—åŒ…å«äº†ä¸€ç³»åˆ—ç”¨äºè¿›è¡ŒåŸŸåè§£æçš„å‡½æ•°ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹<code>dns.resolve()</code>, <code>dns.resolve*()</code> å’Œ <code>dns.reverse()</code> è¿™å‡ ä¸ªå‡½æ•°æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><h3 id="dns-resolve" tabindex="-1"><a class="header-anchor" href="#dns-resolve"><span>dns.resolve()</span></a></h3><p><code>dns.resolve()</code> å‡½æ•°ç”¨äºå°†ä¸€ä¸ªåŸŸåï¼ˆæ¯”å¦‚ &#39;<a href="http://google.com" target="_blank" rel="noopener noreferrer">google.com</a>&#39;ï¼‰è½¬æ¢ä¸ºä¸€ç»„ä¸ä¹‹ç›¸å…³çš„ IP åœ°å€ã€‚è¯¥å‡½æ•°æ˜¯å¼‚æ­¥çš„ï¼Œä¸ä¼šé˜»å¡ Node.js äº‹ä»¶å¾ªç¯ã€‚</p><p>åŸºæœ¬ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dns</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;google.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`åœ°å€: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">JSON</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">stringify</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœè§£ææˆåŠŸï¼Œ<code>addresses</code> å°†ä¼šæ˜¯ä¸€ä¸ªåŒ…å« IP åœ°å€çš„æ•°ç»„ã€‚</p><h3 id="dns-resolve-1" tabindex="-1"><a class="header-anchor" href="#dns-resolve-1"><span>dns.resolve*()</span></a></h3><p><code>dns.resolve*()</code> å‡½æ•°æ—å…¶å®æ˜¯ä¸€ç»„å‡½æ•°ï¼Œå…¶ä¸­çš„æ¯ä¸ªå‡½æ•°éƒ½ç”¨äºè§£æç‰¹å®šç±»å‹çš„ DNS è®°å½•ã€‚è¿™é‡Œ &quot;*&quot; å¯ä»¥æ˜¯å¤šç§ DNS è®°å½•ç±»å‹ï¼Œä¾‹å¦‚ <code>A</code> ï¼ˆè¿”å› IPv4 åœ°å€ï¼‰ï¼Œ<code>AAAA</code> ï¼ˆè¿”å› IPv6 åœ°å€ï¼‰ï¼Œ<code>MX</code> ï¼ˆé‚®ä»¶äº¤æ¢è®°å½•ï¼‰ï¼Œ<code>TXT</code> ï¼ˆæ–‡æœ¬è®°å½•ï¼‰ï¼Œç­‰ç­‰ã€‚</p><p>ä¾‹å­ï¼šè·å– MX è®°å½•</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolveMx</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;google.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;MX records:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">mxRecord</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`ä¼˜å…ˆçº§: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mxRecord</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">priority</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, äº¤æ¢: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mxRecord</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exchange</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>dns.resolveMx()</code> æ¥è·å–æŒ‡å®šåŸŸåçš„é‚®ä»¶æœåŠ¡å™¨ä¿¡æ¯ã€‚è¾“å‡ºä¸º MX è®°å½•çš„æ•°ç»„ï¼ŒåŒ…æ‹¬é‚®ä»¶æœåŠ¡å™¨çš„ä¼˜å…ˆçº§å’Œåœ°å€ã€‚</p><h3 id="dns-reverse" tabindex="-1"><a class="header-anchor" href="#dns-reverse"><span>dns.reverse()</span></a></h3><p><code>dns.reverse()</code> å‡½æ•°ç”¨äºæ‰§è¡Œåå‘ DNS æŸ¥æ‰¾ã€‚ç»™å®šä¸€ä¸ª IP åœ°å€ï¼Œå®ƒä¼šå°è¯•è§£æå‡ºä¸è¯¥ IP åœ°å€å…³è”çš„åŸŸåã€‚</p><p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> ip</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;8.8.8.8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¸¾ä¾‹ Google çš„å…¬å…± DNS æœåŠ¡å™¨ IP</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">dns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">reverse</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">hostnames</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`IP åœ°å€ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ip</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> å¯¹åº”çš„åŸŸå: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">JSON</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">stringify</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostnames</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ä¼ é€’ Google å…¬å…± DNS æœåŠ¡å™¨çš„ IP åœ°å€æ¥æŸ¥æ‰¾å…¶å¯¹åº”çš„åŸŸåã€‚å¦‚æœæˆåŠŸï¼Œ<code>hostnames</code> åº”è¯¥ä¼šåŒ…å«è¯¥ IP åœ°å€çš„ä¸€ä¸ªæˆ–å¤šä¸ªåŸŸåã€‚</p><p>æ³¨æ„ï¼šæ‰€æœ‰è¿™äº›å‡½æ•°éƒ½é‡‡ç”¨å¼‚æ­¥çš„æ–¹å¼å·¥ä½œï¼Œéœ€è¦ä¼ é€’ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥æ¥æ”¶ç»“æœã€‚è¿™æ„å‘³ç€ Node.js åœ¨ç­‰å¾… DNS æŸ¥è¯¢ç»“æœçš„æ—¶å€™ï¼Œå¯ä»¥ç»§ç»­æ‰§è¡Œå…¶ä»–ä»£ç ï¼Œæé«˜äº†ç¨‹åºçš„æ•ˆç‡ã€‚åŒæ—¶ï¼ŒDNS æŸ¥è¯¢æœ‰æ—¶å¯èƒ½ä¼šå¤±è´¥ï¼Œå› æ­¤å¿…é¡»æ­£ç¡®å¤„ç†é”™è¯¯æƒ…å†µã€‚</p></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><!----></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/document/node-doc/Diagnostics%20Channel.html" aria-label="Diagnostics Channel"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Diagnostics Channel</div></a><a class="route-link auto-link next" href="/document/node-doc/Domain.html" aria-label="Domain"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">Domain<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><!----><div class="vp-copyright">Copyright Â© 2022-present hanekawa-shiki</div></footer></div><!--]--><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.2cf91084.js" defer></script><script src="/assets/js/7531.f2f134c8.js" defer></script><script src="/assets/js/app.a2d0f323.js" defer></script>
  </body>
</html>
