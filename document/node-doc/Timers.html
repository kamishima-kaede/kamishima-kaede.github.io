<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.49" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://hanekawa.top/document/node-doc/Timers.html"><meta property="og:site_name" content="hanekawa-shiki"><meta property="og:title" content="Timers"><meta property="og:description" content="Timers Node.js çš„å®šæ—¶å™¨ï¼ˆTimersï¼‰æ¨¡å—æ˜¯æä¾›ä¸€ç³»åˆ—æ–¹æ³•æ¥æ‰§è¡Œåœ¨ç‰¹å®šæ—¶é—´åçš„ä»£ç ã€‚è¿™ä½¿å¾—ä½ å¯ä»¥å®‰æ’ä»£ç åœ¨å°†æ¥æŸä¸ªæ—¶åˆ»æ‰§è¡Œï¼Œè€Œä¸æ˜¯ç«‹å³æ‰§è¡Œã€‚Node.js å®ç°äº†ä¸æµè§ˆå™¨ç±»ä¼¼çš„å®šæ—¶å™¨ APIï¼Œå¦‚ setTimeout, setInterval, å’Œ setImmediateã€‚è¿™é‡Œï¼Œæˆ‘å°†ä¾æ® Node.js v21.7.1 ç‰ˆæœ¬ä¸ºä½ è¯¦ç»†è§£..."><meta property="og:type" content="website"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-06-21T09:46:17.000Z"><meta property="article:author" content="hanekawa-shiki"><meta property="article:modified_time" content="2024-06-21T09:46:17.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"WebPage","name":"Timers","description":"Timers Node.js çš„å®šæ—¶å™¨ï¼ˆTimersï¼‰æ¨¡å—æ˜¯æä¾›ä¸€ç³»åˆ—æ–¹æ³•æ¥æ‰§è¡Œåœ¨ç‰¹å®šæ—¶é—´åçš„ä»£ç ã€‚è¿™ä½¿å¾—ä½ å¯ä»¥å®‰æ’ä»£ç åœ¨å°†æ¥æŸä¸ªæ—¶åˆ»æ‰§è¡Œï¼Œè€Œä¸æ˜¯ç«‹å³æ‰§è¡Œã€‚Node.js å®ç°äº†ä¸æµè§ˆå™¨ç±»ä¼¼çš„å®šæ—¶å™¨ APIï¼Œå¦‚ setTimeout, setInterval, å’Œ setImmediateã€‚è¿™é‡Œï¼Œæˆ‘å°†ä¾æ® Node.js v21.7.1 ç‰ˆæœ¬ä¸ºä½ è¯¦ç»†è§£..."}</script><meta name="keywords" content="JavaScript,HTML,CSS"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/assets/icons/chrome-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icons/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icons/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icons/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#5c92d1"><link rel="apple-touch-icon" href="/assets/icons/apple-touch-icon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="white"><meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><title>Timers | hanekawa-shiki</title><meta name="description" content="Timers Node.js çš„å®šæ—¶å™¨ï¼ˆTimersï¼‰æ¨¡å—æ˜¯æä¾›ä¸€ç³»åˆ—æ–¹æ³•æ¥æ‰§è¡Œåœ¨ç‰¹å®šæ—¶é—´åçš„ä»£ç ã€‚è¿™ä½¿å¾—ä½ å¯ä»¥å®‰æ’ä»£ç åœ¨å°†æ¥æŸä¸ªæ—¶åˆ»æ‰§è¡Œï¼Œè€Œä¸æ˜¯ç«‹å³æ‰§è¡Œã€‚Node.js å®ç°äº†ä¸æµè§ˆå™¨ç±»ä¼¼çš„å®šæ—¶å™¨ APIï¼Œå¦‚ setTimeout, setInterval, å’Œ setImmediateã€‚è¿™é‡Œï¼Œæˆ‘å°†ä¾æ® Node.js v21.7.1 ç‰ˆæœ¬ä¸ºä½ è¯¦ç»†è§£...">
    <link rel="stylesheet" href="/assets/css/styles.a84c0532.css">
    <link rel="preload" href="/assets/js/runtime~app.be370b10.js" as="script"><link rel="preload" href="/assets/css/styles.a84c0532.css" as="style"><link rel="preload" href="/assets/js/4485.e6fe7c7b.js" as="script"><link rel="preload" href="/assets/js/app.bf6f64e3.js" as="script">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo light" src="/assets/svg/logo.svg" alt><img class="vp-nav-logo dark" src="/assets/svg/logo.svg" alt><span class="vp-site-name hide-in-pad">hanekawa-shiki</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="åšå®¢ä¸»é¡µ"><!--[--><span class="font-icon icon home" style=""></span><!--]-->åšå®¢ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="å­¦ä¹ ç¬”è®°"><!--[--><span class="font-icon icon framework" style=""></span>å­¦ä¹ ç¬”è®°<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">å‰ç«¯æ¡†æ¶</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/framework_front/vue3/" aria-label="Vue3ç¬”è®°"><!--[--><span class="font-icon icon vue" style=""></span><!--]-->Vue3ç¬”è®°<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/framework_front/react/" aria-label="Reactç¬”è®°"><!--[--><span class="font-icon icon react" style=""></span><!--]-->Reactç¬”è®°<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="æ–‡æ¡£"><!--[--><span class="font-icon icon framework" style=""></span>æ–‡æ¡£<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">æ¬è¿</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link route-link-active auto-link" href="/document/node-doc/" aria-label="Node.jsæ–‡æ¡£"><!--[--><span class="font-icon icon circle-info" style=""></span><!--]-->Node.jsæ–‡æ¡£<!----></a></li></ul></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/hanekawa-shiki/hanekawa-shiki.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/" aria-label="Node.jsæ–‡æ¡£"><!--[--><span class="font-icon icon circle-info" style=""></span><!--]-->Node.jsæ–‡æ¡£<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Assert.html" aria-label="Assert"><!---->Assert<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Async%20hooks.html" aria-label="Async hooks"><!---->Async hooks<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Asynchronous%20context%20tracking.html" aria-label="Asynchronous context tracking"><!---->Asynchronous context tracking<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Buffer.html" aria-label="Buffer"><!---->Buffer<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/C__%20addons.html" aria-label="C++ addons"><!---->C++ addons<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/C__%20embedder%20API.html" aria-label="C++ embedder API"><!---->C++ embedder API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Child%20process.html" aria-label="Child process"><!---->Child process<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Cluster.html" aria-label="Cluster"><!---->Cluster<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Command-line%20API.html" aria-label="Command-line API"><!---->Command-line API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Console.html" aria-label="Console"><!---->Console<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Corepack.html" aria-label="Corepack"><!---->Corepack<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Crypto.html" aria-label="Crypto"><!---->Crypto<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Debugger.html" aria-label="Debugger"><!---->Debugger<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Deprecated%20APIs.html" aria-label="Deprecated APIs"><!---->Deprecated APIs<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Diagnostic%20report.html" aria-label="Diagnostic report"><!---->Diagnostic report<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Diagnostics%20Channel.html" aria-label="Diagnostics Channel"><!---->Diagnostics Channel<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/DNS.html" aria-label="DNS"><!---->DNS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Domain.html" aria-label="Domain"><!---->Domain<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Errors.html" aria-label="Errors"><!---->Errors<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Events.html" aria-label="Events"><!---->Events<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/File%20system.html" aria-label="File system"><!---->File system<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Global%20objects.html" aria-label="Global objects"><!---->Global objects<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/HTTP.html" aria-label="HTTP"><!---->HTTP<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/HTTPS.html" aria-label="HTTPS"><!---->HTTPS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Inspector.html" aria-label="Inspector"><!---->Inspector<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Internationalization%20support.html" aria-label="Internationalization support"><!---->Internationalization support<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Net.html" aria-label="Net"><!---->Net<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Node-API.html" aria-label="Node-API"><!---->Node-API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/OS.html" aria-label="OS"><!---->OS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Path.html" aria-label="Path"><!---->Path<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Performance%20measurement%20APIs.html" aria-label="Performance measurement APIs"><!---->Performance measurement APIs<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Permissions.html" aria-label="Permissions"><!---->Permissions<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Process.html" aria-label="Process"><!---->Process<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Punycode.html" aria-label="Punycode"><!---->Punycode<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Query%20string.html" aria-label="Query string"><!---->Query string<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Readline.html" aria-label="Readline"><!---->Readline<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/REPL.html" aria-label="REPL"><!---->REPL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Stream.html" aria-label="Stream"><!---->Stream<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/String%20decoder.html" aria-label="String decoder"><!---->String decoder<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Test%20runner.html" aria-label="Test runner"><!---->Test runner<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/document/node-doc/Timers.html" aria-label="Timers"><!---->Timers<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/TLS%20(SSL).html" aria-label="TLS (SSL)"><!---->TLS (SSL)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Trace%20events.html" aria-label="Trace events"><!---->Trace events<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/TTY.html" aria-label="TTY"><!---->TTY<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/URL.html" aria-label="URL"><!---->URL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Util.html" aria-label="Util"><!---->Util<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/V8.html" aria-label="V8"><!---->V8<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/VM%20(executing%20JavaScript).html" aria-label="VM (executing JavaScript)"><!---->VM (executing JavaScript)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Web%20Crypto%20API.html" aria-label="Web Crypto API"><!---->Web Crypto API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Web%20Streams%20API.html" aria-label="Web Streams API"><!---->Web Streams API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/WebAssembly%20System%20Interface%20(WASI).html" aria-label="WebAssembly System Interface (WASI)"><!---->WebAssembly System Interface (WASI)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Worker%20threads.html" aria-label="Worker threads"><!---->Worker threads<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Zlib.html" aria-label="Zlib"><!---->Zlib<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Timers</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://hanekawa.top" target="_blank" rel="noopener noreferrer">hanekawa-shiki</a></span><span property="author" content="hanekawa-shiki"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-06-21T09:46:17.000Z"></span><!----><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 63 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT63M"></span><span class="page-word-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon" name="word"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 18812 å­—</span><meta property="wordCount" content="18812"></span><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-settimeout">1. setTimeout</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-setinterval">2. setInterval</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-setimmediate">3. setImmediate</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-immediate">Class: Immediate</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#immediate-åŸºç¡€">Immediate åŸºç¡€</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#immediate-hasref">immediate.hasRef()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#immediate-hasref-1">immediate.hasRef()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#immediate-ref">immediate.ref()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#immediate-å¯¹è±¡">Immediate å¯¹è±¡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#immediate-unref">immediate.unref()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#äº‹ä»¶å¾ªç¯-event-loop">äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¼•ç”¨-ref">å¼•ç”¨ï¼ˆRefï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#immediate-unref-1">immediate.unref()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-1">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#immediatesymbol-dispose-https-nodejs-org-docs-latest-api-timers-html-immediatesymboldispose">[immediateSymbol.dispose](https://nodejs.org/docs/latest/api/timers.html#immediatesymboldispose)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#immediatesymbol-dispose">immediateSymbol.dispose</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-1">å°ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-timeout">Class: Timeout</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-timeout-ç±»">ä»€ä¹ˆæ˜¯ Timeout ç±»ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨">å¦‚ä½•ä½¿ç”¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-1">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-2">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timeout-close">timeout.close()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-2">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-1">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timeout-hasref">timeout.hasRef()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­">å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-2">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timeout-ref">timeout.ref()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®šæ—¶å™¨å’Œäº‹ä»¶å¾ªç¯">å®šæ—¶å™¨å’Œäº‹ä»¶å¾ªç¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#unref-å’Œ-ref">unref() å’Œ ref()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-2">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timeout-refresh">timeout.refresh()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#é€šä¿—è§£é‡Š">é€šä¿—è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬ç”¨æ³•">åŸºæœ¬ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-3">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timeout-unref">timeout.unref()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#äº‹ä»¶å¾ªç¯å’Œsettimeout">äº‹ä»¶å¾ªç¯å’ŒsetTimeout()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timeout-unref-çš„ä½œç”¨">timeout.unref()çš„ä½œç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timeoutsymbol-toprimitive-https-nodejs-org-docs-latest-api-timers-html-timeoutsymboltoprimitive">[timeoutSymbol.toPrimitive](https://nodejs.org/docs/latest/api/timers.html#timeoutsymboltoprimitive)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-åˆ›å»ºä¸€ä¸ªtimeoutå¹¶å°è¯•è½¬æ¢ä¸ºæ•°å­—">1. åˆ›å»ºä¸€ä¸ªtimeoutå¹¶å°è¯•è½¬æ¢ä¸ºæ•°å­—</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹ä»£ç ">ç¤ºä¾‹ä»£ç ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-æ—¥å¿—è®°å½•">2. æ—¥å¿—è®°å½•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-3">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timeoutsymbol-dispose-https-nodejs-org-docs-latest-api-timers-html-timeoutsymboldispose">[timeoutSymbol.dispose](https://nodejs.org/docs/latest/api/timers.html#timeoutsymboldispose)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€æ¦‚å¿µ">åŸºç¡€æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timeout-symbol-dispose-è¯¦è§£">timeout[Symbol.dispose]() è¯¦è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ç¤ºä¾‹">ä½¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨åœºæ™¯">å®é™…åº”ç”¨åœºæ™¯</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#scheduling-timers">Scheduling timers</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#settimeout">setTimeout()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#setinterval">setInterval()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#setimmediate">setImmediate()</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å®é™…åº”ç”¨">å®é™…åº”ç”¨</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#setimmediate-callback-args">setImmediate(callback[, ...args])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£setimmediate">ç†è§£setImmediate()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-1">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-4">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#setinterval-callback-delay-args">setInterval(callback[, delay[, ...args]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-3">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#settimeout-callback-delay-args">setTimeout(callback[, delay[, ...args]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#settimeout-çš„ä½œç”¨">setTimeout çš„ä½œç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬è¯­æ³•">åŸºæœ¬è¯­æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-1">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-5">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cancelling-timers">Cancelling timers</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å–æ¶ˆè®¡æ—¶å™¨çš„æ–¹æ³•">å–æ¶ˆè®¡æ—¶å™¨çš„æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­">ä½¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-3">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#clearimmediate-immediate">clearImmediate(immediate)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#setimmediate-callback-args-1">setImmediate(callback, [...args])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#clearimmediate-immediate-1">clearImmediate(immediate)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨åœºæ™¯">å®é™…è¿ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#clearinterval-timeout">clearInterval(timeout)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬åŸç†">åŸºæœ¬åŸç†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-2">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cleartimeout-timeout">clearTimeout(timeout)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯cleartimeout-timeout">ä»€ä¹ˆæ˜¯clearTimeout(timeout)ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨cleartimeout-timeout">å¦‚ä½•ä½¿ç”¨clearTimeout(timeout)ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-4">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#timers-promises-api">Timers Promises API</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-ç®€ä»‹">Node.js ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#promise-ç®€ä»‹">Promise ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timers-promises-api-1">Timers Promises API</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timerspromises-settimeout-delay-value-options">timersPromises.setTimeout([delay[, value[, options]]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-1">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-1">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ç¤ºä¾‹-1">ä½¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-6">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timerspromises-setimmediate-value-options">timersPromises.setImmediate([value[, options]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-5">å®é™…è¿ç”¨ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timerspromises-setinterval-delay-value-options">timersPromises.setInterval([delay[, value[, options]]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-2">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timerspromises-setinterval">timersPromises.setInterval</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timerspromises-scheduler-wait-delay-options">timersPromises.scheduler.wait(delay[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-2">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-7">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timerspromises-scheduler-yield">timersPromises.scheduler.yield()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¼‚æ­¥ç¼–ç¨‹ä¸äº‹ä»¶å¾ªç¯">å¼‚æ­¥ç¼–ç¨‹ä¸äº‹ä»¶å¾ªç¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timerspromises-scheduler-yield-1">timersPromises.scheduler.yield()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-3">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="timers" tabindex="-1"><a class="header-anchor" href="#timers"><span><a href="https://nodejs.org/docs/latest/api/timers.html#timers" target="_blank" rel="noopener noreferrer">Timers</a></span></a></h1><p>Node.js çš„å®šæ—¶å™¨ï¼ˆTimersï¼‰æ¨¡å—æ˜¯æä¾›ä¸€ç³»åˆ—æ–¹æ³•æ¥æ‰§è¡Œåœ¨ç‰¹å®šæ—¶é—´åçš„ä»£ç ã€‚è¿™ä½¿å¾—ä½ å¯ä»¥å®‰æ’ä»£ç åœ¨å°†æ¥æŸä¸ªæ—¶åˆ»æ‰§è¡Œï¼Œè€Œä¸æ˜¯ç«‹å³æ‰§è¡Œã€‚Node.js å®ç°äº†ä¸æµè§ˆå™¨ç±»ä¼¼çš„å®šæ—¶å™¨ APIï¼Œå¦‚ <code>setTimeout</code>, <code>setInterval</code>, å’Œ <code>setImmediate</code>ã€‚è¿™é‡Œï¼Œæˆ‘å°†ä¾æ® Node.js v21.7.1 ç‰ˆæœ¬ä¸ºä½ è¯¦ç»†è§£é‡Šå¹¶æä¾›å®é™…åº”ç”¨çš„ä¾‹å­ã€‚</p><h3 id="_1-settimeout" tabindex="-1"><a class="header-anchor" href="#_1-settimeout"><span>1. setTimeout</span></a></h3><p><code>setTimeout</code> å‡½æ•°ç”¨æ¥å®‰æ’ä¸€ä¸ªå‡½æ•°åœ¨æŒ‡å®šçš„æ¯«ç§’æ•°åæ‰§è¡Œã€‚å®ƒè¿”å›ä¸€ä¸ªå®šæ—¶å™¨æ ‡è¯†ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>clearTimeout</code> æ¥å–æ¶ˆè¿™ä¸ªå®šæ—¶å™¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> displayMessage</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello, after 3 seconds!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®‰æ’displayMessageå‡½æ•°åœ¨3000æ¯«ç§’(å³3ç§’)åæ‰§è¡Œ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> timerId</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">displayMessage</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 3000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¦‚æœéœ€è¦ï¼Œåœ¨3ç§’ä¹‹å‰å–æ¶ˆå®šæ—¶å™¨</span></span>
<span class="line"><span style="color:#616E88;">// clearTimeout(timerId);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å®é™…åº”ç”¨ä¾‹å­:</strong> åœ¨ Web æœåŠ¡å™¨ä¸Šï¼Œå¯èƒ½éœ€è¦å»¶è¿Ÿå‘é€å“åº”ç»™å®¢æˆ·ç«¯ï¼Œæˆ–è€…åœ¨å°è¯•è¿æ¥å¤–éƒ¨èµ„æºå¤±è´¥åï¼Œæƒ³è¦ç­‰å¾…ä¸€æ®µæ—¶é—´å†é‡è¯•ã€‚</p><h3 id="_2-setinterval" tabindex="-1"><a class="header-anchor" href="#_2-setinterval"><span>2. setInterval</span></a></h3><p><code>setInterval</code> å‡½æ•°ç”¨æ¥å®‰æ’ä¸€ä¸ªå‡½æ•°æ¯éš”æŒ‡å®šçš„æ¯«ç§’æ•°é‡å¤æ‰§è¡Œã€‚ä¸ <code>setTimeout</code> ç±»ä¼¼ï¼Œå®ƒä¹Ÿè¿”å›ä¸€ä¸ªå®šæ—¶å™¨æ ‡è¯†ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>clearInterval</code> æ¥åœæ­¢é‡å¤æ‰§è¡Œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> displayRepeatedMessage</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">This message is displayed every 2 seconds</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ¯2000æ¯«ç§’ï¼ˆå³2ç§’ï¼‰é‡å¤æ‰§è¡ŒdisplayRepeatedMessageå‡½æ•°</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> intervalId</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setInterval</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">displayRepeatedMessage</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 2000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åœæ­¢é‡å¤æ‰§è¡Œï¼Œéœ€è¦çš„è¯å¯ä»¥è°ƒç”¨clearInterval(intervalId);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å®é™…åº”ç”¨ä¾‹å­:</strong> åœ¨ä¸€ä¸ªé•¿æ—¶é—´è¿è¡Œçš„åº”ç”¨ä¸­ï¼Œæ¯”å¦‚éœ€è¦å®šæœŸæ¸…ç†ç¼“å­˜ã€æ£€æŸ¥ç³»ç»Ÿå¥åº·çŠ¶æ€æˆ–æ‰§è¡Œå®šæœŸåŒæ­¥ã€‚</p><h3 id="_3-setimmediate" tabindex="-1"><a class="header-anchor" href="#_3-setimmediate"><span>3. setImmediate</span></a></h3><p><code>setImmediate</code> å‡½æ•°æ˜¯ç”¨æ¥å®‰æ’ä¸€ä¸ªå‡½æ•°åœ¨å½“å‰äº‹ä»¶å¾ªç¯å‘¨æœŸç»“æŸåå°½å¿«æ‰§è¡Œã€‚è¿™é‡Œâ€œå°½å¿«â€æ„å‘³ç€æ‰€æœ‰å¯æ‰§è¡Œä»£ç æ‰§è¡Œå®Œæ¯•åã€ä»»ä½• I/O æ“ä½œï¼ˆä¾‹å¦‚è¯»å†™æ–‡ä»¶ï¼‰ä¹‹å‰ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> displayImmediateMessage</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">This message is displayed immediately after I/O events</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®‰æ’displayImmediateMessageå‡½æ•°å°½å¿«æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#88C0D0;">setImmediate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">displayImmediateMessage</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å®é™…åº”ç”¨ä¾‹å­:</strong> å½“ä½ å¸Œæœ›åœ¨å®Œæˆä¸€ç»„ä»»åŠ¡ï¼ˆå¦‚æ–‡ä»¶è¯»å†™ï¼‰åï¼Œç«‹å³ä½†ä¼˜é›…åœ°è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œè€Œä¸é˜»å¡ I/O äº‹ä»¶ã€‚</p><h3 id="å°ç»“" tabindex="-1"><a class="header-anchor" href="#å°ç»“"><span>å°ç»“</span></a></h3><p>Node.js çš„å®šæ—¶å™¨æä¾›äº†çµæ´»çš„æ–¹æ³•æ¥æ§åˆ¶ä»£ç æ‰§è¡Œçš„æ—¶æœºã€‚é€šè¿‡ä½¿ç”¨ <code>setTimeout</code>ï¼Œä½ å¯ä»¥åœ¨æœªæ¥æŸä¸€æ—¶åˆ»æ‰§è¡Œä»£ç ï¼›ä½¿ç”¨ <code>setInterval</code> å¯ä»¥è®©ä»£ç æŒ‰å›ºå®šçš„æ—¶é—´é—´éš”é‡å¤æ‰§è¡Œï¼›è€Œ <code>setImmediate</code> åˆ™æä¾›äº†ä¸€ç§æ–¹å¼åœ¨å½“å‰äº‹ä»¶å¾ªç¯çš„æœ«å°¾æ‰§è¡Œä»£ç ã€‚è¿™äº›åŠŸèƒ½åœ¨å¼€å‘ä¸­éå¸¸æœ‰ç”¨ï¼Œæ— è®ºæ˜¯å¤„ç†å»¶è¿Ÿæ“ä½œã€å®‰æ’é‡å¤ä»»åŠ¡è¿˜æ˜¯ç¡®ä¿ä»£ç å¼‚æ­¥æ‰§è¡Œéƒ½èƒ½æ´¾ä¸Šç”¨åœºã€‚</p><h2 id="class-immediate" tabindex="-1"><a class="header-anchor" href="#class-immediate"><span><a href="https://nodejs.org/docs/latest/api/timers.html#class-immediate" target="_blank" rel="noopener noreferrer">Class: Immediate</a></span></a></h2><p>ç†è§£ Node.js ä¸­çš„ <code>Immediate</code> å¯¹è±¡ï¼Œæˆ‘ä»¬å…ˆä»åŸºæœ¬æ¦‚å¿µå¼€å§‹ã€‚åœ¨ Node.js ä¸­ï¼Œå¾ˆå¤šæ—¶å€™éœ€è¦å¤„ç†å¼‚æ­¥æ“ä½œï¼Œæ¯”å¦‚æ–‡ä»¶è¯»å†™ã€è®¿é—®ç½‘ç»œç­‰ã€‚ä¸ºäº†æœ‰æ•ˆç®¡ç†è¿™äº›å¼‚æ­¥æ“ä½œï¼ŒNode.js æä¾›äº†ä¸€ç³»åˆ—çš„å·¥å…·å’Œæœºåˆ¶ï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯ <code>Immediate</code>ã€‚</p><h3 id="immediate-åŸºç¡€" tabindex="-1"><a class="header-anchor" href="#immediate-åŸºç¡€"><span>Immediate åŸºç¡€</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>Immediate</code> æ˜¯ä¸€ä¸ªç”¨æ¥è°ƒåº¦ç«‹å³æ‰§è¡Œçš„ä»£ç å¯¹è±¡ã€‚å½“ä½ åˆ›å»ºä¸€ä¸ª <code>Immediate</code> å¯¹è±¡æ—¶ï¼Œä½ å®é™…ä¸Šæ˜¯å‘Šè¯‰ Node.jsï¼š&quot;å˜¿ï¼Œæˆ‘æœ‰ä¸€æ®µä»£ç ï¼Œå¸Œæœ›ä½ åœ¨å½“å‰äº‹ä»¶å¾ªç¯çš„æ‰€æœ‰ I/O æ“ä½œå®Œæˆåï¼Œä½†åœ¨å®šæ—¶å™¨è§¦å‘ä¹‹å‰æ‰§è¡Œå®ƒã€‚&quot;</p><p>ä½¿ç”¨ <code>setImmediate()</code> å‡½æ•°å¯ä»¥åˆ›å»ºä¸€ä¸ª <code>Immediate</code> å¯¹è±¡ã€‚å®ƒæ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°å°±æ˜¯é‚£æ®µå¸Œæœ›ç«‹å³æ‰§è¡Œçš„ä»£ç ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>è®©æˆ‘ä»¬åˆ†åˆ«çœ‹çœ‹ä¸€äº›ç®€å•æ˜äº†çš„ <code>Immediate</code> ä½¿ç”¨åœºæ™¯ã€‚</p><h4 id="ç¤ºä¾‹-1-å¼‚æ­¥æ—¥å¿—è®°å½•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-å¼‚æ­¥æ—¥å¿—è®°å½•"><span>ç¤ºä¾‹ 1: å¼‚æ­¥æ—¥å¿—è®°å½•</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œéœ€è¦åœ¨æ‰§è¡ŒæŸä¸ªæ“ä½œåç«‹å³è®°å½•æ—¥å¿—ï¼Œä½†ä½ ä¸æƒ³é˜»ç¢å½“å‰æ­£åœ¨è¿›è¡Œçš„ I/O æ“ä½œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å¼•å…¥ fs æ¨¡å—ç”¨äºæ–‡ä»¶æ“ä½œ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥å†™å…¥æ—¥å¿—åˆ°æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> logMessage</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">message</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">  setImmediate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">appendFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">log.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> message</span><span style="color:#81A1C1;"> +</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ—¥å¿—è®°å½•æˆåŠŸ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">logMessage</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯ä¸€ä¸ªæ—¥å¿—ä¿¡æ¯</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ<code>setImmediate()</code> ç¡®ä¿æ—¥å¿—å†™å…¥çš„æ“ä½œæ˜¯åœ¨å½“å‰äº‹ä»¶å¾ªç¯çš„æœ€åè¿›è¡Œçš„ï¼Œè¿™æ ·å®ƒå°±ä¸ä¼šå¹²æ‰°åˆ°å…¶ä»– I/O æ“ä½œã€‚</p><h4 id="ç¤ºä¾‹-2-åˆ†æ•£è®¡ç®—è´Ÿè·" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-åˆ†æ•£è®¡ç®—è´Ÿè·"><span>ç¤ºä¾‹ 2: åˆ†æ•£è®¡ç®—è´Ÿè·</span></a></h4><p>å¦‚æœä½ æœ‰ä¸€ä¸ªè®¡ç®—å¯†é›†å‹çš„ä»»åŠ¡ï¼Œå¯èƒ½ä¼šé˜»å¡äº‹ä»¶å¾ªç¯ï¼Œå½±å“æ€§èƒ½ã€‚ä½¿ç”¨ <code>Immediate</code> å¯ä»¥å°†ä»»åŠ¡åˆ†å‰²æˆå°å—ï¼Œé¿å…é˜»å¡ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> performHeavyTask</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> callback</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // å‡è®¾è¿™é‡Œæœ‰ä¸€ä¸ªéå¸¸è€—æ—¶çš„æ“ä½œ</span></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> result</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // åˆ©ç”¨ setImmediate å°†ä»»åŠ¡æ‹†è§£ï¼Œé¿å…é˜»å¡</span></span>
<span class="line"><span style="color:#88C0D0;">  setImmediate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    result</span><span style="color:#81A1C1;"> +=</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">ç»è¿‡å¤æ‚è®¡ç®—åçš„ç»“æœ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#88C0D0;">    callback</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">result</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">performHeavyTask</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">åˆå§‹æ•°æ®</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">result</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">result</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œ<code>setImmediate()</code> å…è®¸æˆ‘ä»¬å°†è€—æ—¶çš„æ“ä½œæ¨è¿Ÿåˆ°ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯ï¼Œä»è€Œä½¿å¾—å…¶ä»–çš„ I/O æ“ä½œæˆ–è€…å®šæ—¶å™¨æ²¡æœ‰è¢«å»¶è¿Ÿæ‰§è¡Œã€‚</p><h3 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡ä»¥ä¸Šç¤ºä¾‹ï¼Œå¯ä»¥çœ‹å‡º <code>Immediate</code> åœ¨ Node.js ä¸­æ˜¯å¤„ç†å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ä¸ªå¼ºå¤§å·¥å…·ã€‚å®ƒèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°æ§åˆ¶ä»£ç æ‰§è¡Œé¡ºåºï¼Œæé«˜åº”ç”¨æ€§èƒ½å’Œå“åº”èƒ½åŠ›ã€‚ç‰¹åˆ«æ˜¯åœ¨å¼€å‘ä¸­ï¼Œåˆç†åˆ©ç”¨ <code>Immediate</code> å¯ä»¥ä¼˜åŒ–ä»£ç é€»è¾‘ï¼Œé¿å…æ½œåœ¨çš„é˜»å¡é—®é¢˜ï¼Œä½¿å¾—æˆ‘ä»¬çš„ Node.js åº”ç”¨æ›´åŠ é«˜æ•ˆå’Œå¯é ã€‚</p><h3 id="immediate-hasref" tabindex="-1"><a class="header-anchor" href="#immediate-hasref"><span><a href="https://nodejs.org/docs/latest/api/timers.html#immediatehasref" target="_blank" rel="noopener noreferrer">immediate.hasRef()</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå®ƒå…è®¸åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨ JavaScript æ¥ç¼–å†™åç«¯ä»£ç ï¼Œå°±åƒä½¿ç”¨ PHPã€Python æˆ– Ruby ç­‰å…¶ä»–åç«¯è¯­è¨€ä¸€æ ·ã€‚Node.js éå¸¸é€‚åˆå¤„ç†é«˜å¹¶å‘ã€I/O å¯†é›†å‹çš„å®æ—¶åº”ç”¨ï¼Œæ¯”å¦‚èŠå¤©åº”ç”¨æˆ–è€…æ¸¸æˆæœåŠ¡ç«¯ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ä¸ªå…¨å±€çš„ <code>timers</code> æ¨¡å—ï¼Œå®ƒæä¾›äº†ä¸€äº›åŸºæœ¬çš„å®šæ—¶å™¨åŠŸèƒ½ï¼Œä¾‹å¦‚å»¶è¿Ÿæ‰§è¡Œ (<code>setTimeout</code>) å’Œå‘¨æœŸæ€§æ‰§è¡Œ (<code>setInterval</code>)ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ <code>setImmediate</code> å‡½æ•°ï¼Œå®ƒç”¨æ¥å®‰æ’åœ¨ I/O äº‹ä»¶çš„å›è°ƒåç«‹å³æ‰§è¡Œçš„è„šæœ¬ã€‚</p><h3 id="immediate-hasref-1" tabindex="-1"><a class="header-anchor" href="#immediate-hasref-1"><span>immediate.hasRef()</span></a></h3><p>å½“ä½ ä½¿ç”¨ <code>setImmediate()</code> åˆ›å»ºäº†ä¸€ä¸ª Immediate å¯¹è±¡åï¼Œä½ å¯èƒ½æƒ³çŸ¥é“è¿™ä¸ªå¯¹è±¡æ˜¯å¦ä»ç„¶æ˜¯æ´»è·ƒçš„ï¼Œæˆ–è€…è¯´æ˜¯å¦è¿˜ä¼šå½±å“ Node.js äº‹ä»¶å¾ªç¯çš„ç»§ç»­æ‰§è¡Œã€‚è¿™é‡Œï¼Œâ€œæ´»è·ƒâ€çš„æ„æ€æ˜¯è¯¥ Immediate æ˜¯å¦è¢« Node.js çš„äº‹ä»¶ç³»ç»Ÿè®¡ç®—åœ¨å†…ï¼Œä»è€Œé˜²æ­¢ç¨‹åºé€€å‡ºç›´åˆ° Immediate è¢«æ‰§è¡Œã€‚</p><p>è¿™å°±æ˜¯ <code>immediate.hasRef()</code> æ–¹æ³•çš„ç”¨å¤„ã€‚ç®€å•åœ°è¯´ï¼Œ<code>hasRef()</code> æ–¹æ³•ç”¨æ¥æ£€æŸ¥ Immediate å¯¹è±¡æ˜¯å¦è¢«è®¾ç½®ä¸ºæ´»è·ƒçŠ¶æ€ã€‚å¦‚æœä¸€ä¸ª Immediate å¯¹è±¡é»˜è®¤æƒ…å†µä¸‹æ˜¯æ´»è·ƒçš„ï¼Œé‚£ä¹ˆåªè¦å®ƒå­˜åœ¨ï¼ŒNode.js è¿›ç¨‹å°±ä¸ä¼šé€€å‡ºã€‚ä½†æ˜¯ï¼Œä½ å¯ä»¥é€šè¿‡è°ƒç”¨ <code>immediate.unref()</code> æ˜ç¡®åœ°å°†æ­¤ Immediate æ ‡è®°ä¸ºéæ´»è·ƒï¼Œè¿™æ ·ï¼Œå³ä½¿å®ƒè¿˜æ²¡æœ‰è¢«æ‰§è¡Œï¼ŒNode.js è¿›ç¨‹ä¹Ÿèƒ½é€€å‡ºã€‚ç›¸å¯¹åœ°ï¼Œä½ å¯ä»¥é€šè¿‡ <code>immediate.ref()</code> æ¥é‡æ–°æ ‡è®°ä¸ºæ´»è·ƒã€‚</p><h4 id="å®é™…è¿ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­"><span>å®é™…è¿ç”¨ä¾‹å­ï¼š</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦åœ¨æ”¶åˆ°ç‰¹å®šçš„ç”¨æˆ·è¯·æ±‚åï¼Œç¨åç«‹å³å¤„ç†ä¸€äº›æ•°æ®ï¼Œä½†è¿™ä¸ªå¤„ç†è¿‡ç¨‹ä¸åº”è¯¥é˜»æ­¢ç¨‹åºåœ¨æ²¡æœ‰å…¶ä»–æ´»åŠ¨ï¼ˆå¦‚å…¶ä»–ç”¨æˆ·è¯·æ±‚ï¼‰æ—¶æ­£å¸¸é€€å‡ºã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> immediate</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setImmediate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç«‹å³æ‰§è¡Œ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ£€æŸ¥è¿™ä¸ª immediate æ˜¯å¦æ´»è·ƒ</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">immediate</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">hasRef</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾åœ¨æŸä¸ªæ¡ä»¶ä¸‹ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›å› ä¸ºè¿™ä¸ª immediate è€Œé˜»æ­¢ç¨‹åºé€€å‡º</span></span>
<span class="line"><span style="color:#D8DEE9;">immediate</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unref</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å†æ¬¡æ£€æŸ¥çŠ¶æ€</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">immediate</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">hasRef</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¦‚æœåæ¥åˆå†³å®šè¿™ä¸ª immediate åº”è¯¥é˜»æ­¢ç¨‹åºé€€å‡º</span></span>
<span class="line"><span style="color:#D8DEE9;">immediate</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">ref</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å†æ¬¡æ£€æŸ¥çŠ¶æ€</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">immediate</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">hasRef</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ul><li>æˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ª Immediate å¯¹è±¡ï¼Œå‡†å¤‡ç«‹åˆ»æ‰§è¡Œä¸€æ®µä»£ç ã€‚</li><li>æˆ‘ä»¬é€šè¿‡ <code>hasRef()</code> æ£€æŸ¥äº†è¿™ä¸ª Immediate å¯¹è±¡é»˜è®¤æ˜¯æ´»è·ƒçš„ã€‚</li><li>ä½¿ç”¨ <code>unref()</code> å°†å…¶è®¾ç½®ä¸ºéæ´»è·ƒï¼Œè¿™æ ·å³ä½¿è¿™ä¸ª Immediate å¯¹è±¡è¿˜æœªæ‰§è¡Œï¼ŒNode.js è¿›ç¨‹ä¹Ÿèƒ½åœ¨æ²¡æœ‰å…¶ä»–æ´»è·ƒä»»åŠ¡æ—¶é€€å‡ºã€‚</li><li>æˆ‘ä»¬ç”¨ <code>ref()</code> æ–¹æ³•æ¢å¤äº† Immediate çš„æ´»è·ƒçŠ¶æ€ï¼Œè¿™æ · Node.js è¿›ç¨‹å°†ç­‰å¾…è¿™ä¸ª Immediate å¯¹è±¡æ‰§è¡Œå®Œæ¯•æ‰ä¼šè€ƒè™‘é€€å‡ºã€‚</li></ul><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œ<code>hasRef()</code>, <code>unref()</code>, å’Œ <code>ref()</code> è¿™å‡ ä¸ªæ–¹æ³•å…±åŒä½œç”¨ï¼Œç»™äºˆä½ æ›´ç»†è‡´çš„æ§åˆ¶ï¼Œä»¥å†³å®šä½•æ—¶å…è®¸ä½ çš„ Node.js åº”ç”¨ç¨‹åºé€€å‡ºã€‚</p><h3 id="immediate-ref" tabindex="-1"><a class="header-anchor" href="#immediate-ref"><span><a href="https://nodejs.org/docs/latest/api/timers.html#immediateref" target="_blank" rel="noopener noreferrer">immediate.ref()</a></span></a></h3><p>Node.js ä¸­çš„ <code>immediate.ref()</code> æ–¹æ³•å’Œå®šæ—¶å™¨æœ‰å…³ï¼Œä½†è¦ç†è§£è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ä¸€äº›èƒŒæ™¯ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œå½“ä½ æƒ³è¦æ‰§è¡Œä¸€äº›ä»£ç ä½†å¸Œæœ›å®ƒåœ¨å½“å‰æ‰§è¡Œæ ˆæ¸…ç©ºåç«‹å³è¿è¡Œï¼ˆæ¯”å¦‚æ‰€æœ‰åŒæ­¥ä»£ç æ‰§è¡Œå®Œæ¯•åï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>setImmediate()</code> å‡½æ•°ã€‚è¿™é€šå¸¸ç”¨äºå¤„ç†å¼‚æ­¥æ“ä½œçš„å›è°ƒï¼Œæˆ–è€…å½“ä½ æƒ³è¦ç¡®ä¿æŸæ®µä»£ç åœ¨äº‹ä»¶å¾ªç¯çš„ä¸‹ä¸€ä¸ªé˜¶æ®µè¿è¡Œã€‚</p><p><code>setImmediate()</code> è¿”å›ä¸€ä¸ª <code>Immediate</code> å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä»£è¡¨é‚£ä¸ªå³å°†è¢«æ‰§è¡Œçš„ä»£ç å—ã€‚</p><h3 id="immediate-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#immediate-å¯¹è±¡"><span>Immediate å¯¹è±¡</span></a></h3><p><code>Immediate</code> å¯¹è±¡æœ‰ä¸¤ä¸ªä¸»è¦æ–¹æ³•ï¼š<code>.ref()</code> å’Œ <code>.unref()</code>ã€‚è¿™ä¸¤ä¸ªæ–¹æ³•æ§åˆ¶ç€ Node.js äº‹ä»¶å¾ªç¯å¯¹å¾…è¿™ä¸ª Immediate å¯¹è±¡çš„æ–¹å¼ã€‚</p><ul><li><p><code>.unref()</code> æ–¹æ³•ä¼šå‘Šè¯‰ Node.js çš„äº‹ä»¶å¾ªç¯ï¼šâ€œå¦‚æœè¿™ä¸ª Immediate å¯¹è±¡æ˜¯äº‹ä»¶å¾ªç¯ä¸­å¾…æ‰§è¡Œçš„å”¯ä¸€äº‹åŠ¡ï¼Œè¯·é€€å‡ºäº‹ä»¶å¾ªç¯ã€‚â€ è¿™æ„å‘³ç€å¦‚æœä½ çš„ç¨‹åºåªå‰©ä¸‹é€šè¿‡ <code>setImmediate()</code> è°ƒåº¦çš„å›è°ƒå¾…æ‰§è¡Œï¼ŒNode.js å¯èƒ½ä¼šç»“æŸè¿›ç¨‹ï¼Œä¸å†ç­‰å¾…ã€‚</p></li><li><p><code>.ref()</code> æ–¹æ³•åˆ™ä¸ä¹‹ç›¸åã€‚å®ƒå‘Šè¯‰ Node.js çš„äº‹ä»¶å¾ªç¯ï¼šâ€œå³ä½¿è¿™æ˜¯æœ€åçš„å¾…æ‰§è¡Œäº‹åŠ¡ï¼Œä¹Ÿè¯·ç»§ç»­ç­‰å¾…ã€‚â€ å¦‚æœä¸€ä¸ª Immediate å¯¹è±¡è¢« <code>unref()</code> è¿‡ï¼Œä½¿ç”¨ <code>ref()</code> å¯ä»¥æ’¤é”€è¿™ä¸ªæ“ä½œï¼Œç¡®ä¿ Node.js ä¼šç­‰å¾…è¿™ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•ã€‚</p></li></ul><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨æ„å»ºä¸€ä¸ªæœåŠ¡å™¨ï¼Œæˆ‘ä»¬æƒ³åœ¨æœåŠ¡å™¨å‡†å¤‡å°±ç»ªåç«‹å³æ‰§è¡Œä¸€äº›åˆå§‹åŒ–æ“ä½œï¼Œä½†ä¸æƒ³é˜»å¡è¿›ç¨‹é€€å‡ºï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–æ´»åŠ¨ï¼ˆä¾‹å¦‚æ‰“å¼€çš„ç½‘ç»œè¿æ¥ï¼‰ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> immediate</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setImmediate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ‰§è¡Œåˆå§‹åŒ–æ“ä½œ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// é»˜è®¤æƒ…å†µä¸‹ï¼Œå› ä¸ºæœ‰è¿™ä¸ª immediateï¼ŒNode.js ä¼šä¿æŒè¿›ç¨‹æ´»è·ƒç›´åˆ°å®ƒè¢«æ‰§è¡Œã€‚</span></span>
<span class="line"><span style="color:#616E88;">// ä½†å¦‚æœæˆ‘ä»¬ç¡®å®šé™¤äº†è¿™ä¸ª immediate å¤–æ— å…¶ä»–æ´»åŠ¨ï¼Œä¸”æƒ³è®© Node.js åœ¨æ‰§è¡Œå®Œæ¯•åèƒ½ç«‹å³é€€å‡ºï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">immediate</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unref</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½†å¦‚æœåæ¥æˆ‘ä»¬åˆæ·»åŠ äº†ä¸€äº›æ“ä½œï¼Œæ¯”å¦‚å¯åŠ¨äº†ä¸€ä¸ª HTTP æœåŠ¡å™¨ï¼Œå¹¶ä¸”æˆ‘ä»¬å¸Œæœ›ç¡®ä¿åˆå§‹åŒ–æ“ä½œå®Œæˆï¼Œå³ä½¿å®ƒæ˜¯æœ€åçš„æ´»åŠ¨ï¼Œæˆ‘ä»¬å¯ä»¥å†æ¬¡å¼•ç”¨å®ƒã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">immediate</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">ref</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // ç¡®ä¿ Node.js ä¸ä¼šå› ä¸º immediate æ˜¯å”¯ä¸€æ´»åŠ¨å°±é€€å‡º</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ€»ç»“èµ·æ¥ï¼Œ<code>immediate.ref()</code> å…è®¸æˆ‘ä»¬æ›´ç²¾ç»†åœ°æ§åˆ¶ Node.js çš„è¡Œä¸ºï¼Œç‰¹åˆ«æ˜¯åœ¨æ¶‰åŠäº‹ä»¶å¾ªç¯å¦‚ä½•å†³å®šç¨‹åºæ˜¯å¦ç»§ç»­è¿è¡Œçš„åœºæ™¯ä¸­ã€‚è¿™åœ¨åˆ›å»ºå¤æ‚çš„åå°æœåŠ¡æˆ–å¤„ç†å„ç§å¼‚æ­¥ä»»åŠ¡æ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="immediate-unref" tabindex="-1"><a class="header-anchor" href="#immediate-unref"><span><a href="https://nodejs.org/docs/latest/api/timers.html#immediateunref" target="_blank" rel="noopener noreferrer">immediate.unref()</a></span></a></h3><p>åœ¨è§£é‡Š <code>immediate.unref()</code> ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£ Node.js ä¸­çš„ä¸¤ä¸ªå…³é”®æ¦‚å¿µï¼šäº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰å’Œå¼•ç”¨ï¼ˆRefï¼‰ã€‚è¿™å°†å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ <code>immediate.unref()</code> çš„ä½œç”¨ã€‚</p><h3 id="äº‹ä»¶å¾ªç¯-event-loop" tabindex="-1"><a class="header-anchor" href="#äº‹ä»¶å¾ªç¯-event-loop"><span>äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰</span></a></h3><p>Node.js æ˜¯åŸºäºéé˜»å¡ I/O å’Œå¼‚æ­¥ç¼–ç¨‹çš„ã€‚å®ƒä½¿ç”¨äº‹ä»¶å¾ªç¯æ¥å¤„ç†å¼‚æ­¥æ“ä½œï¼Œæ¯”å¦‚è¯»å†™æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡ç­‰ã€‚ç®€å•æ¥è¯´ï¼Œäº‹ä»¶å¾ªç¯å…è®¸ Node.js åœ¨æ²¡æœ‰æ˜ç¡®çš„å›è°ƒå‡½æ•°è°ƒç”¨æ—¶ä»ç„¶ä¿æŒè¿è¡Œï¼Œç­‰å¾…æ–°çš„äº‹ä»¶å‘ç”Ÿå¹¶å¤„ç†å®ƒä»¬ã€‚</p><h3 id="å¼•ç”¨-ref" tabindex="-1"><a class="header-anchor" href="#å¼•ç”¨-ref"><span>å¼•ç”¨ï¼ˆRefï¼‰</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œä¸€ä¸ªå®šæ—¶å™¨ï¼ˆå¦‚ setTimeout æˆ– setIntervalï¼‰æˆ–ç«‹å³æ‰§è¡Œä»£ç ï¼ˆsetImmediateï¼‰è¢«åˆ›å»ºæ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯â€œæ´»è·ƒâ€çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ˜¯è¢«â€œå¼•ç”¨â€çš„ã€‚è¿™æ„å‘³ç€åªè¦è¿™äº›è®¡æ—¶å™¨æˆ–ç«‹å³æ‰§è¡Œä»£ç å­˜åœ¨ï¼Œå®ƒä»¬å°±ä¼šé˜»æ­¢ Node.js è¿›ç¨‹é€€å‡ºã€‚</p><h3 id="immediate-unref-1" tabindex="-1"><a class="header-anchor" href="#immediate-unref-1"><span>immediate.unref()</span></a></h3><p>å½“ä½ è°ƒç”¨ <code>setImmediate()</code> æ—¶ï¼ŒNode.js ä¼šå®‰æ’ä¸€ä¸ªå›è°ƒå‡½æ•°å°½å¯èƒ½å¿«åœ°åœ¨æœªæ¥æŸä¸ªæ—¶é—´ç‚¹æ‰§è¡Œã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªé€šè¿‡ <code>setImmediate()</code> åˆ›å»ºçš„å›è°ƒæ˜¯æ´»è·ƒçš„ï¼Œå³ä¼šé˜»æ­¢ç¨‹åºé€€å‡ºç›´åˆ°å®ƒè¢«æ‰§è¡Œã€‚</p><p>ä½†æœ‰äº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¸å¸Œæœ›ä¸€ä¸ªå¾…æ‰§è¡Œçš„å›è°ƒé˜»æ­¢ç¨‹åºé€€å‡ºã€‚è¿™æ—¶ï¼Œ<code>immediate.unref()</code> å°±æ´¾ä¸Šç”¨åœºäº†ã€‚è°ƒç”¨ <code>immediate.unref()</code> åï¼Œå¦‚æœè¿™ä¸ªç«‹å³æ‰§è¡Œçš„å›è°ƒæ˜¯å”¯ä¸€å‰©ä½™çš„å·¥ä½œï¼Œåˆ™ Node.js è¿›ç¨‹å¯ä»¥æ­£å¸¸é€€å‡ºè€Œä¸æ˜¯ç­‰å¾…å®ƒæ‰§è¡Œã€‚æ¢å¥è¯è¯´ï¼Œ<code>unref()</code> å¯ä»¥ç”¨æ¥è¡¨ç¤ºè¿™ä¸ªç‰¹å®šçš„å›è°ƒä¸åº”è¯¥é˜»æ­¢ç¨‹åºé€€å‡ºã€‚</p><p>å¦‚æœåç»­åˆè°ƒç”¨äº† <code>immediate.ref()</code>ï¼Œåˆ™ä¼šæ’¤é”€ <code>unref()</code> çš„æ•ˆæœï¼Œä½¿å¾— Node.js è¿›ç¨‹ä¼šå†æ¬¡ç­‰å¾…è¿™ä¸ªå›è°ƒæ‰§è¡Œåæ‰èƒ½é€€å‡ºã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-1"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-ä½¿ç”¨-immediate-unref" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ä½¿ç”¨-immediate-unref"><span>ç¤ºä¾‹ 1: ä½¿ç”¨ <code>immediate.unref()</code></span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> immediate</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setImmediate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™ä¸ªå›è°ƒä¸ä¼šé˜»æ­¢ç¨‹åºé€€å‡º</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨ unref() è®© Node.js ç¨‹åºå¯ä»¥åœ¨æ­¤å›è°ƒä¹‹å‰é€€å‡º</span></span>
<span class="line"><span style="color:#D8DEE9;">immediate</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unref</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå³ä½¿ <code>setImmediate()</code> å®‰æ’äº†ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œç¨‹åºä¹Ÿå¯ä»¥åœ¨æ‰§è¡Œè¯¥å›è°ƒä¹‹å‰é€€å‡ºï¼Œå› ä¸ºæˆ‘ä»¬è°ƒç”¨äº† <code>immediate.unref()</code>ã€‚</p><h4 id="ç¤ºä¾‹-2-æ’¤é”€-unref-çš„æ•ˆæœ" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æ’¤é”€-unref-çš„æ•ˆæœ"><span>ç¤ºä¾‹ 2: æ’¤é”€ <code>unref()</code> çš„æ•ˆæœ</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> immediate</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setImmediate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™ä¸ªå›è°ƒæœ€ç»ˆä¼šæ‰§è¡Œ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å…ˆè®©è¿™ä¸ªå›è°ƒä¸é˜»æ­¢ç¨‹åºé€€å‡º</span></span>
<span class="line"><span style="color:#D8DEE9;">immediate</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unref</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç„¶ååˆæ”¹å˜ä¸»æ„ï¼Œå¸Œæœ›å®ƒé˜»æ­¢ç¨‹åºé€€å‡º</span></span>
<span class="line"><span style="color:#D8DEE9;">immediate</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">ref</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ç¬¬äºŒä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å…ˆæ˜¯é€šè¿‡ <code>immediate.unref()</code> è¡¨æ˜äº†è¿™ä¸ªå›è°ƒä¸åº”é˜»æ­¢ç¨‹åºé€€å‡ºã€‚ä½†ç´§æ¥ç€ï¼Œé€šè¿‡ <code>immediate.ref()</code> åˆæ¢å¤äº†å®ƒçš„â€œå¼•ç”¨â€çŠ¶æ€ï¼Œè¿™æ„å‘³ç€ Node.js è¿›ç¨‹ä¼šç­‰å¾…è¿™ä¸ªå›è°ƒæ‰§è¡Œå®Œæ¯•åæ‰é€€å‡ºã€‚</p><p>é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œ<code>unref()</code> å’Œ <code>ref()</code> æ–¹æ³•æä¾›äº†ä¸€ç§çµæ´»çš„æœºåˆ¶ï¼Œè®©å¼€å‘è€…å¯ä»¥æ ¹æ®éœ€è¦æ§åˆ¶ Node.js è¿›ç¨‹çš„é€€å‡ºæ—¶æœºã€‚</p><h3 id="immediatesymbol-dispose-https-nodejs-org-docs-latest-api-timers-html-immediatesymboldispose" tabindex="-1"><a class="header-anchor" href="#immediatesymbol-dispose-https-nodejs-org-docs-latest-api-timers-html-immediatesymboldispose"><span>[immediate<a href="">Symbol.dispose</a>](<a href="https://nodejs.org/docs/latest/api/timers.html#immediatesymboldispose" target="_blank" rel="noopener noreferrer">https://nodejs.org/docs/latest/api/timers.html#immediatesymboldispose</a>)</span></a></h3><p>è®©æˆ‘ä»¬æ·±å…¥äº†è§£ <code>immediate[Symbol.dispose]()</code> åœ¨ Node.js v21.7.1 ä¸­çš„ä½œç”¨ï¼Œä»¥åŠå¦‚ä½•åœ¨å®é™…åº”ç”¨ä¸­ä½¿ç”¨å®ƒã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç†è§£å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p><ol><li><strong>Node.js</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå¼€æºå’Œè·¨å¹³å°çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚</li><li><strong>Immediate å¯¹è±¡</strong>ï¼šåœ¨ Node.js ä¸­ï¼ŒImmediate å¯¹è±¡æ˜¯ä¸€ç§ç‰¹æ®Šçš„å®šæ—¶å™¨ï¼Œå®ƒå…è®¸ä½ å®‰æ’ä¸€ä¸ªå‡½æ•°åœ¨å½“å‰äº‹ä»¶å¾ªç¯å‘¨æœŸç»“æŸåã€ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯å‘¨æœŸå¼€å§‹å‰ç«‹å³æ‰§è¡Œã€‚</li><li><strong>Symbols</strong>ï¼šåœ¨ JavaScript ä¸­ï¼Œ<code>Symbol</code> æ˜¯ä¸€ç§åŸå§‹æ•°æ®ç±»å‹ï¼Œå…¶è¡¨ç¤ºç‹¬ä¸€æ— äºŒçš„å€¼ã€‚åœ¨è®¸å¤šé«˜çº§åŠŸèƒ½ä¸­ï¼ŒSymbols è¢«ç”¨ä½œå¯¹è±¡å±æ€§çš„é”®ï¼Œè¿™äº›å±æ€§é€šå¸¸ä»£è¡¨ä¸€äº›ä¸æƒ³è®©ä»£ç çš„å…¶ä»–éƒ¨åˆ†è½»æ˜“è®¿é—®æˆ–è¦†ç›–çš„å†…éƒ¨åŠŸèƒ½ã€‚</li></ol><p>ç°åœ¨ï¼Œä»‹ç» <code>immediate[Symbol.dispose]()</code> è¿™ä¸ªå…·ä½“çš„åŠŸèƒ½ã€‚</p><h3 id="immediatesymbol-dispose" tabindex="-1"><a class="header-anchor" href="#immediatesymbol-dispose"><span>immediate<a href="">Symbol.dispose</a></span></a></h3><p><code>immediate[Symbol.dispose]()</code> æ˜¯ä¸€ä¸ªåœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­å¼•å…¥çš„æ–¹æ³•ï¼Œå…¶ä½œç”¨æ˜¯å–æ¶ˆä¸€ä¸ªç”± <code>setImmediate()</code> å‡½æ•°åˆ›å»ºçš„ Immediate å¯¹è±¡ã€‚ç®€å•æ¥è¯´ï¼Œå¦‚æœä½ æœ‰ä¸€æ®µä»£ç è®¡åˆ’åœ¨æœªæ¥å°½å¿«æ‰§è¡Œï¼Œä½†çªç„¶å†³å®šä¸å†éœ€è¦æ‰§è¡Œå®ƒï¼Œé‚£ä¹ˆä½ å¯ä»¥é€šè¿‡è°ƒç”¨ <code>immediate[Symbol.dispose]()</code> æ¥å–æ¶ˆå®ƒã€‚</p><h4 id="å®é™…è¿ç”¨ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-1"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h4><p>å‡è®¾ï¼Œåœ¨ä¸€ä¸ªç½‘ç»œåº”ç”¨ç¨‹åºä¸­ï¼Œç”¨æˆ·è¯·æ±‚äº†æŸä¸ªèµ„æºçš„å¤„ç†ï¼Œè¿™ä¸ªå¤„ç†è¿‡ç¨‹éœ€è¦ä¸€äº›æ—¶é—´ï¼Œæ‰€ä»¥ä½ å†³å®šä½¿ç”¨ <code>setImmediate()</code> æ¥å®‰æ’ä¸€ä¸ªå‡½æ•°åœ¨å½“å‰æ“ä½œå®Œæˆåå°½å¿«æ‰§è¡Œï¼Œä»¥ä¾¿å‘ç”¨æˆ·å‘é€å“åº”ã€‚ä½†å¦‚æœåœ¨æ‰§è¡Œä¹‹å‰ï¼Œç”¨æˆ·å–æ¶ˆäº†è¯·æ±‚ï¼Œæˆ–è€…å‡ºç°äº†æŸç§é”™è¯¯ï¼Œä½ å¯èƒ½å°±ä¸æƒ³è¦ç»§ç»­è¿™ä¸ªå·²ç»å®‰æ’å¥½çš„æ“ä½œäº†ã€‚</p><p>çœ‹ä¸€ä¸ªå…·ä½“çš„ä»£ç ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å¼•å…¥ Node.js çš„ timers æ¨¡å—</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> setImmediate</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">timers</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ setImmediate() å®‰æ’ä¸€ä¸ªä»»åŠ¡</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> immediate</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setImmediate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™ä¸ªå‡½æ•°ä¼šåœ¨ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯ä¸­å°½å¿«æ‰§è¡Œ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç°åœ¨å‡è®¾å› ä¸ºæŸç§åŸå› ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦æ‰§è¡Œä¸Šé¢å®‰æ’çš„ä»»åŠ¡äº†</span></span>
<span class="line"><span style="color:#616E88;">// æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ immediate[Symbol.dispose]() æ¥å–æ¶ˆå®ƒ</span></span>
<span class="line"><span style="color:#D8DEE9;">immediate</span><span style="color:#D8DEE9FF;">[</span><span style="color:#D8DEE9;">Symbol</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">dispose</span><span style="color:#D8DEE9FF;">]()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¦‚æœå–æ¶ˆæˆåŠŸï¼Œé‚£ä¹ˆä¸Šé¢å®‰æ’çš„å‡½æ•°å°†ä¸ä¼šæ‰§è¡Œ</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å·²å–æ¶ˆå®‰æ’çš„ä»»åŠ¡</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨ <code>setImmediate()</code> å®‰æ’äº†ä¸€ä¸ªå‡½æ•°ç¨åæ‰§è¡Œã€‚è¿™ä¸ªå‡½æ•°ç®€å•åœ°æ‰“å°ä¸€æ¡æ¶ˆæ¯ã€‚æ¥ç€ï¼Œæˆ‘ä»¬å†³å®šå–æ¶ˆè¿™ä¸ªå®‰æ’çš„ä»»åŠ¡ï¼Œäºæ˜¯æˆ‘ä»¬è°ƒç”¨äº† <code>immediate[Symbol.dispose]()</code> æ–¹æ³•ã€‚ç»“æœæ˜¯ï¼ŒåŸæœ¬å°†è¦æ‰§è¡Œçš„æ‰“å°æ“ä½œä¸ä¼šå‘ç”Ÿï¼Œå› ä¸ºä»»åŠ¡å·²ç»è¢«å–æ¶ˆäº†ã€‚</p><h3 id="å°ç»“-1" tabindex="-1"><a class="header-anchor" href="#å°ç»“-1"><span>å°ç»“</span></a></h3><p><code>immediate[Symbol.dispose]()</code> æä¾›äº†ä¸€ç§æœºåˆ¶æ¥å–æ¶ˆé‚£äº›å·²ç»å®‰æ’ä½†è¿˜æœªæ‰§è¡Œçš„ Immediate å¯¹è±¡çš„æ‰§è¡Œã€‚è¿™åœ¨ç¼–å†™å¤æ‚çš„å¼‚æ­¥é€»è¾‘æ—¶éå¸¸æœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯å½“ä½ éœ€è¦åŸºäºæ–°å‘ç”Ÿçš„äº‹ä»¶ï¼ˆä¾‹å¦‚ç”¨æˆ·è¾“å…¥ã€ç½‘ç»œå“åº”ç­‰ï¼‰åŠ¨æ€è°ƒæ•´ä½ çš„ç¨‹åºè¡Œä¸ºæ—¶ã€‚é€šè¿‡æŒæ¡è¿™ä¸ªæ–¹æ³•ï¼Œä½ å¯ä»¥æ›´çµæ´»åœ°ç®¡ç†ä½ çš„å¼‚æ­¥ä»£ç ï¼Œç¡®ä¿åªæœ‰çœŸæ­£éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡æ‰ä¼šæ‰§è¡Œï¼Œé¿å…æµªè´¹èµ„æºã€‚</p><h2 id="class-timeout" tabindex="-1"><a class="header-anchor" href="#class-timeout"><span><a href="https://nodejs.org/docs/latest/api/timers.html#class-timeout" target="_blank" rel="noopener noreferrer">Class: Timeout</a></span></a></h2><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ·±å…¥äº†è§£ Node.js ä¸­çš„ <code>Timeout</code> ç±»ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-timeout-ç±»" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-timeout-ç±»"><span>ä»€ä¹ˆæ˜¯ Timeout ç±»ï¼Ÿ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>Timeout</code> ç±»æ˜¯ä¸è®¡æ—¶å™¨ç›¸å…³åŠŸèƒ½çš„ä¸€éƒ¨åˆ†ã€‚å®ƒå…è®¸ä½ åœ¨æŒ‡å®šçš„å»¶è¿Ÿåæ‰§è¡Œä»£ç ã€‚è¿™æ˜¯é€šè¿‡è°ƒç”¨å…¨å±€å‡½æ•°å¦‚ <code>setTimeout()</code> å®ç°çš„ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œ<code>setTimeout()</code> è¿”å›ä¸€ä¸ª <code>Timeout</code> å¯¹è±¡ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥å¼•ç”¨æˆ–æ§åˆ¶å»¶è¿Ÿæ‰§è¡Œçš„ä»£ç ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨"><span>å¦‚ä½•ä½¿ç”¨ï¼Ÿ</span></a></h3><p>åŸºæœ¬ä¸Šï¼Œä½ ä¼šç”¨åˆ°ä¸¤ä¸ªä¸»è¦æ–¹æ³•ï¼š<code>setTimeout(callback, delay, [...args])</code> å’Œ <code>clearTimeout(timeout)</code></p><ol><li><p><strong>setTimeout(callback, delay, [...args])</strong>: å®‰æ’ä¸€ä¸ªå›è°ƒå‡½æ•°åœ¨ç‰¹å®šå»¶è¿Ÿä¹‹åæ‰§è¡Œã€‚</p><ul><li><code>callback</code>: æ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚</li><li><code>delay</code>: å»¶è¿Ÿçš„æ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚</li><li><code>[...args]</code>: å¯é€‰å‚æ•°ï¼Œä¼ é€’ç»™å›è°ƒå‡½æ•°ã€‚</li></ul></li><li><p><strong>clearTimeout(timeout)</strong>: æ¸…é™¤ä¹‹å‰è®¾ç½®çš„ Timeoutã€‚</p><ul><li><code>timeout</code>: æ˜¯é€šè¿‡ <code>setTimeout()</code> åˆ›å»ºçš„ Timeout å¯¹è±¡ã€‚</li></ul></li></ol><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-1"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-ç®€å•å»¶è¿Ÿæ‰§è¡Œ" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ç®€å•å»¶è¿Ÿæ‰§è¡Œ"><span>ç¤ºä¾‹ 1ï¼šç®€å•å»¶è¿Ÿæ‰§è¡Œ</span></a></h4><p>å‡è®¾ä½ æƒ³åœ¨ 3 ç§’ååœ¨æ§åˆ¶å°æ‰“å°ä¸€æ¡æ¶ˆæ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> timeoutId</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ¡ä¿¡æ¯åœ¨3ç§’åæ˜¾ç¤ºã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 3000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¦‚æœéœ€è¦çš„è¯ï¼Œå¯ä»¥å–æ¶ˆè¿™ä¸ª Timeout</span></span>
<span class="line"><span style="color:#616E88;">// clearTimeout(timeoutId);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-å¸¦å‚æ•°çš„å»¶è¿Ÿæ‰§è¡Œ" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å¸¦å‚æ•°çš„å»¶è¿Ÿæ‰§è¡Œ"><span>ç¤ºä¾‹ 2ï¼šå¸¦å‚æ•°çš„å»¶è¿Ÿæ‰§è¡Œ</span></a></h4><p>å¦‚æœä½ æƒ³åœ¨å»¶è¿Ÿåæ‰§è¡Œä¸€ä¸ªéœ€è¦å‚æ•°çš„å‡½æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> displayMessage</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">message</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">message</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> timeoutId</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">displayMessage</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 2000</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, Node.js!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¯ä»¥ç”¨ clearTimeout(timeoutId) æ¥å–æ¶ˆ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-3-æ¸…é™¤-timeout-é˜²æ­¢æ‰§è¡Œ" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-æ¸…é™¤-timeout-é˜²æ­¢æ‰§è¡Œ"><span>ç¤ºä¾‹ 3ï¼šæ¸…é™¤ Timeout é˜²æ­¢æ‰§è¡Œ</span></a></h4><p>æœ‰æ—¶å€™ï¼Œåœ¨å»¶è¿Ÿç»“æŸä¹‹å‰ï¼Œä½ å¯èƒ½å†³å®šä¸æ‰§è¡ŒåŸå®šçš„æ“ä½œäº†ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> timeoutId</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ¡ä¿¡æ¯æ°¸è¿œä¸ä¼šæ˜¾ç¤ºã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 4000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å†³å®šå–æ¶ˆå®ƒ</span></span>
<span class="line"><span style="color:#88C0D0;">clearTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">timeoutId</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å°ç»“-2" tabindex="-1"><a class="header-anchor" href="#å°ç»“-2"><span>å°ç»“</span></a></h3><p>é€šè¿‡ <code>Timeout</code> ç±»ï¼ŒNode.js æä¾›äº†ä¸€ç§çµæ´»çš„æ–¹å¼æ¥å®‰æ’å’Œå–æ¶ˆæœªæ¥çš„ä»»åŠ¡ã€‚æ— è®ºæ˜¯æ·»åŠ å»¶è¿Ÿã€å‘¨æœŸæ€§æ‰§è¡Œè¿˜æ˜¯åœ¨æœªæ¥æŸä¸ªæ—¶åˆ»è§¦å‘äº‹ä»¶ï¼Œ<code>Timeout</code> ç±»éƒ½æ˜¯å®ç°è¿™äº›éœ€æ±‚çš„å…³é”®å·¥å…·ä¹‹ä¸€ã€‚ç†è§£å’Œæ­£ç¡®ä½¿ç”¨è¿™äº›æœºåˆ¶ï¼Œå¯¹äºåˆ›å»ºå“åº”å¼å’Œæ€§èƒ½è‰¯å¥½çš„åº”ç”¨è‡³å…³é‡è¦ã€‚</p><h3 id="timeout-close" tabindex="-1"><a class="header-anchor" href="#timeout-close"><span><a href="https://nodejs.org/docs/latest/api/timers.html#timeoutclose" target="_blank" rel="noopener noreferrer">timeout.close()</a></span></a></h3><p>è¦è§£é‡Š <code>timeout.close()</code> æ–¹æ³•ï¼Œæˆ‘ä»¬å…ˆå¾—æ˜ç™½ Node.js ä¸­çš„å®šæ—¶å™¨ï¼ˆtimersï¼‰æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚åœ¨ Node.js ä¸­ï¼Œå½“ä½ æƒ³è¦åœ¨ä¸€å®šæ—¶é—´åæ‰§è¡ŒæŸæ®µä»£ç ï¼Œä½ å¯èƒ½ä¼šä½¿ç”¨ <code>setTimeout</code> å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ª <code>Timeout</code> å¯¹è±¡ï¼Œå®ƒä»£è¡¨é‚£ä¸ªå°†æ¥æŸä¸€æ—¶åˆ»è¦æ‰§è¡Œçš„ä»»åŠ¡ã€‚</p><p>ç°åœ¨ï¼Œæƒ³è±¡ä½ è®¾ç½®äº†ä¸€ä¸ª <code>setTimeout</code> æ¥åœ¨ 10 ç§’åæ‰§è¡Œä¸€æ®µä»£ç ï¼Œä½†åœ¨ 5 ç§’æ—¶ï¼Œä½ æ”¹å˜äº†ä¸»æ„ï¼Œä¸æƒ³è®©é‚£æ®µä»£ç æ‰§è¡Œäº†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>timeout.close()</code> æ–¹æ³•æ¥å–æ¶ˆè¿™ä¸ªå³å°†æ‰§è¡Œçš„ä»»åŠ¡ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-2"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="ä¾‹å­-1-å–æ¶ˆæœªæ‰§è¡Œçš„å®šæ—¶ä»»åŠ¡" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-å–æ¶ˆæœªæ‰§è¡Œçš„å®šæ—¶ä»»åŠ¡"><span>ä¾‹å­ 1ï¼šå–æ¶ˆæœªæ‰§è¡Œçš„å®šæ—¶ä»»åŠ¡</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™ï¼Œç”¨æˆ·å¡«å†™äº†ä¸€ä¸ªè¡¨å•åï¼Œç½‘ç«™æ˜¾ç¤ºä¸€ä¸ªæ¶ˆæ¯è¯´â€œæ‚¨çš„æ“ä½œå°†åœ¨ 10 ç§’åå®Œæˆâ€ï¼Œä½†å¦‚æœç”¨æˆ·åœ¨è¿™ 10 ç§’å†…ç‚¹å‡»äº†â€œå–æ¶ˆâ€æŒ‰é’®ï¼Œä½ éœ€è¦ç«‹åˆ»åœæ­¢æ“ä½œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// è®¾ç½®ä¸€ä¸ª10ç§’åæ‰§è¡Œçš„å®šæ—¶å™¨</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> timeout</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ“ä½œå®Œæˆï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 10000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾è¿™æ˜¯ç”¨æˆ·ç‚¹å‡»â€œå–æ¶ˆâ€æŒ‰é’®è§¦å‘çš„å‡½æ•°</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> cancelOperation</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // å–æ¶ˆå®šæ—¶å™¨</span></span>
<span class="line"><span style="color:#D8DEE9;">  timeout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ“ä½œå·²å–æ¶ˆï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ¨¡æ‹Ÿç”¨æˆ·åœ¨5ç§’åç‚¹å‡»â€œå–æ¶ˆâ€</span></span>
<span class="line"><span style="color:#88C0D0;">setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">cancelOperation</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 5000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå³ä½¿å®šæ—¶å™¨è¢«è®¾ç½®ä¸º 10 ç§’åæ‰§è¡Œï¼Œç”¨æˆ·åœ¨ 5 ç§’åç‚¹å‡»å–æ¶ˆï¼Œ<code>cancelOperation</code> å‡½æ•°ä¼šè¢«è°ƒç”¨ï¼Œå¹¶ä½¿ç”¨ <code>timeout.close()</code> æ¥é˜»æ­¢åŸå®šçš„æ“ä½œæ‰§è¡Œã€‚</p><h4 id="ä¾‹å­-2-é¿å…é•¿æ—¶é—´ç­‰å¾…çš„æ•°æ®åº“æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-é¿å…é•¿æ—¶é—´ç­‰å¾…çš„æ•°æ®åº“æŸ¥è¯¢"><span>ä¾‹å­ 2ï¼šé¿å…é•¿æ—¶é—´ç­‰å¾…çš„æ•°æ®åº“æŸ¥è¯¢</span></a></h4><p>å‡è®¾ä½ çš„åº”ç”¨éœ€è¦ä»æŸä¸ªæ…¢é€Ÿçš„æ•°æ®åº“ä¸­è·å–æ•°æ®ã€‚å‡ºäºç”¨æˆ·ä½“éªŒè€ƒè™‘ï¼Œå¦‚æœæŸ¥è¯¢è¶…è¿‡ 3 ç§’è¿˜æ²¡æœ‰ç»“æœï¼Œä½ å†³å®šä¸å†ç­‰å¾…ç»“æœï¼Œè€Œæ˜¯é‡‡å–å…¶ä»–æªæ–½ï¼ˆæ¯”å¦‚è½½å…¥ç¼“å­˜çš„æ•°æ®æˆ–æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼‰ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// æ¨¡æ‹Ÿä¸€ä¸ªæ•°æ®åº“æŸ¥è¯¢çš„å‡½æ•°ï¼Œè¿™é‡Œä»…ä¸ºç¤ºä¾‹</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> slowDatabaseQuery</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">callback</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // å‡è®¾æŸ¥è¯¢éœ€è¦å¾ˆé•¿æ—¶é—´</span></span>
<span class="line"><span style="color:#88C0D0;">  setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">    callback</span><span style="color:#D8DEE9FF;">(</span><span style="color:#81A1C1;">null</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">æŸ¥è¯¢ç»“æœ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span><span style="color:#B48EAD;"> 10000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ¨¡æ‹ŸæŸ¥è¯¢è€—æ—¶10ç§’</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è®¾ç½®ä¸€ä¸ª3ç§’åæ‰§è¡Œçš„å®šæ—¶å™¨ï¼Œä»¥é™åˆ¶æŸ¥è¯¢æ—¶é—´</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> timeout</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æŸ¥è¯¢è¶…æ—¶ï¼ŒåŠ è½½å¤‡ç”¨æ•°æ®ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 3000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">slowDatabaseQuery</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> result</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">result</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // å¦‚æœæŸ¥è¯¢æˆåŠŸï¼Œå–æ¶ˆå®šæ—¶å™¨</span></span>
<span class="line"><span style="color:#D8DEE9;">    timeout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ•°æ®åº“æŸ¥è¯¢ç»“æœï¼š</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> result</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå³ä½¿æ•°æ®åº“æŸ¥è¯¢å¯èƒ½éœ€è¦ 10 ç§’æ‰èƒ½å®Œæˆï¼Œæˆ‘ä»¬é€šè¿‡è®¾ç½®ä¸€ä¸ª 3 ç§’çš„å®šæ—¶å™¨æ¥å†³å®šæ˜¯å¦ç»§ç»­ç­‰å¾…ã€‚å¦‚æœ 3 ç§’å†…æ•°æ®åº“æŸ¥è¯¢æˆåŠŸå®Œæˆï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>timeout.close()</code> æ–¹æ³•æ¥å–æ¶ˆå®šæ—¶å™¨ï¼Œå¦åˆ™å®šæ—¶å™¨åˆ°æ—¶é—´åä¼šé€šçŸ¥ç”¨æˆ·æŸ¥è¯¢è¶…æ—¶ï¼Œå¹¶é‡‡å–ç›¸åº”æªæ–½ã€‚</p><h3 id="æ€»ç»“-1" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-1"><span>æ€»ç»“</span></a></h3><p><code>timeout.close()</code> æ–¹æ³•åœ¨ Node.js ç¨‹åºä¸­éå¸¸æœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯å½“ä½ éœ€è¦æ›´ç»†ç²’åº¦åœ°æ§åˆ¶å¼‚æ­¥æ“ä½œçš„æ‰§è¡Œã€‚é€šè¿‡åŠæ—¶å–æ¶ˆä¸å†éœ€è¦çš„å®šæ—¶ä»»åŠ¡ï¼Œå¯ä»¥æé«˜ç¨‹åºçš„æ•ˆç‡å’Œå“åº”æ€§ï¼Œé¿å…ä¸å¿…è¦çš„èµ„æºæµªè´¹ã€‚</p><h3 id="timeout-hasref" tabindex="-1"><a class="header-anchor" href="#timeout-hasref"><span><a href="https://nodejs.org/docs/latest/api/timers.html#timeouthasref" target="_blank" rel="noopener noreferrer">timeout.hasRef()</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘ç›´æ¥è¿›å…¥æ­£é¢˜ã€‚</p><p>Node.js ä¸­çš„<code>timeout.hasRef()</code>æ–¹æ³•æ˜¯ä¸è®¡æ—¶å™¨ï¼ˆå¦‚ setTimeout æˆ– setIntervalï¼‰ç›¸å…³è”çš„ã€‚è¿™ä¸ªæ–¹æ³•ç”¨äºæ£€æŸ¥ä¸€ä¸ªè®¡æ—¶å™¨æ˜¯å¦ä»ç„¶åœ¨ Node.js çš„äº‹ä»¶å¾ªç¯ä¸­è¢«è€ƒè™‘ï¼ˆå³å®ƒæ˜¯å¦ä»ç„¶å¯ä»¥é˜»æ­¢ç¨‹åºé€€å‡ºï¼‰ã€‚ç®€å•æ¥è¯´ï¼Œå¦‚æœä¸€ä¸ªè®¡æ—¶å™¨æœ‰å¼•ç”¨ï¼ˆ<code>.hasRef()</code>è¿”å›<code>true</code>ï¼‰ï¼Œé‚£ä¹ˆå®ƒä¼šé˜»æ­¢ä½ çš„ Node.js åº”ç”¨ç¨‹åºé€€å‡ºï¼Œç›´åˆ°å®ƒè¢«è§¦å‘æˆ–è€…è¢«å–æ¶ˆã€‚å¦‚æœæ²¡æœ‰å¼•ç”¨ï¼ˆ<code>.hasRef()</code>è¿”å›<code>false</code>ï¼‰ï¼Œäº‹ä»¶å¾ªç¯åˆ™ä¸ä¼šå› ä¸ºè¿™ä¸ªè®¡æ—¶å™¨è€Œä¿æŒæ´»è·ƒï¼Œåº”ç”¨ç¨‹åºå¯ä»¥æ­£å¸¸é€€å‡ºï¼Œå³ä½¿è¿™ä¸ªè®¡æ—¶å™¨è¿˜æ²¡å®Œæˆã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­"><span>å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</span></a></h3><h4 id="_1-ä½¿ç”¨settimeoutåˆ›å»ºä¸€ä¸ªè®¡æ—¶å™¨" tabindex="-1"><a class="header-anchor" href="#_1-ä½¿ç”¨settimeoutåˆ›å»ºä¸€ä¸ªè®¡æ—¶å™¨"><span>1. ä½¿ç”¨<code>setTimeout</code>åˆ›å»ºä¸€ä¸ªè®¡æ—¶å™¨</span></a></h4><p>å…ˆæ¥çœ‹ä¸€ä¸ªåŸºæœ¬çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> timeout</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™å°†ä¼šè¢«æ‰“å°å‡ºæ¥</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 5000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">timeout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">hasRef</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®äº†ä¸€ä¸ªå°†åœ¨ 5 ç§’åæ‰§è¡Œçš„å®šæ—¶å™¨ã€‚<code>timeout.hasRef()</code>çš„è°ƒç”¨ç»“æœæ˜¯<code>true</code>ï¼Œæ„å‘³ç€åªè¦è¿™ä¸ªå®šæ—¶å™¨è¿˜æ²¡æ‰§è¡Œï¼Œå®ƒå°±ä¼šé˜»æ­¢ Node.js ç¨‹åºé€€å‡ºã€‚</p><h4 id="_2-å–æ¶ˆå¯¹äº‹ä»¶å¾ªç¯çš„é˜»æ­¢" tabindex="-1"><a class="header-anchor" href="#_2-å–æ¶ˆå¯¹äº‹ä»¶å¾ªç¯çš„é˜»æ­¢"><span>2. å–æ¶ˆå¯¹äº‹ä»¶å¾ªç¯çš„é˜»æ­¢</span></a></h4><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å–æ¶ˆè¿™ç§é˜»æ­¢è¡Œä¸ºï¼Œå…è®¸ Node.js ç¨‹åºåœ¨å®šæ—¶å™¨è§¦å‘å‰é€€å‡ºã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> timeout</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ®µæ–‡å­—ä¸ä¼šè¢«æ‰“å°ï¼Œå› ä¸ºå®šæ—¶å™¨ä¼šåœ¨è§¦å‘å‰è¢«å–æ¶ˆ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 5000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å–æ¶ˆå®šæ—¶å™¨é˜»æ­¢äº‹ä»¶å¾ªç¯é€€å‡º</span></span>
<span class="line"><span style="color:#D8DEE9;">timeout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unref</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">timeout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">hasRef</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // false</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è°ƒç”¨<code>timeout.unref()</code>ï¼Œæˆ‘ä»¬å‘Šè¯‰ Node.js ä¸éœ€è¦å› ä¸ºè¿™ä¸ªå®šæ—¶å™¨è€Œä¿æŒç¨‹åºè¿è¡Œã€‚<code>timeout.hasRef()</code>ç°åœ¨è¿”å›<code>false</code>ï¼Œè¡¨æ˜è¿™ä¸ªå®šæ—¶å™¨å·²ç»ä¸å†é˜»æ­¢äº‹ä»¶å¾ªç¯äº†ã€‚å› æ­¤ï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–ä»»åŠ¡åœ¨äº‹ä»¶å¾ªç¯ä¸­ï¼ŒNode.js åº”ç”¨ç¨‹åºå¯ä»¥åœ¨å®šæ—¶å™¨è§¦å‘ä¹‹å‰é€€å‡ºã€‚</p><h4 id="_3-å†æ¬¡å¼•ç”¨è®¡æ—¶å™¨" tabindex="-1"><a class="header-anchor" href="#_3-å†æ¬¡å¼•ç”¨è®¡æ—¶å™¨"><span>3. å†æ¬¡å¼•ç”¨è®¡æ—¶å™¨</span></a></h4><p>å¦‚æœæˆ‘ä»¬åœ¨æŸä¸ªæ—¶åˆ»å†³å®šè¿™ä¸ªå®šæ—¶å™¨åˆå˜å¾—é‡è¦ï¼Œæƒ³è¦é˜»æ­¢ç¨‹åºé€€å‡ºç›´åˆ°è¯¥å®šæ—¶å™¨æ‰§è¡Œï¼Œå¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å‡è®¾timeoutä¹‹å‰è°ƒç”¨äº†unref()</span></span>
<span class="line"><span style="color:#D8DEE9;">timeout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">ref</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">timeout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">hasRef</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è°ƒç”¨<code>timeout.ref()</code>ï¼Œæˆ‘ä»¬é‡æ–°å¼•ç”¨äº†å®šæ—¶å™¨ï¼Œä½¿å…¶å†æ¬¡èƒ½å¤Ÿé˜»æ­¢äº‹ä»¶å¾ªç¯é€€å‡ºã€‚è¿™æ„å‘³ç€<code>timeout.hasRef()</code>ä¼šè¿”å›<code>true</code>ï¼Œè¡¨ç¤ºäº‹ä»¶å¾ªç¯ä¼šå› ä¸ºè¿™ä¸ªå®šæ—¶å™¨çš„å­˜åœ¨è€Œä¿æŒæ´»è·ƒï¼Œç›´è‡³å®šæ—¶å™¨æ‰§è¡Œæˆ–è¢«å–æ¶ˆã€‚</p><h3 id="æ€»ç»“-2" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-2"><span>æ€»ç»“</span></a></h3><p>æ€»çš„æ¥è¯´ï¼Œ<code>hasRef()</code>å¯ç”¨äºæ£€æŸ¥ä¸€ä¸ªè®¡æ—¶å™¨æ˜¯å¦å…·æœ‰é˜»æ­¢ Node.js äº‹ä»¶å¾ªç¯é€€å‡ºçš„å¼•ç”¨ã€‚é€šè¿‡<code>unref()</code>å’Œ<code>ref()</code>æ–¹æ³•ï¼Œå¯ä»¥åŠ¨æ€åœ°æ§åˆ¶è®¡æ—¶å™¨å¯¹äº‹ä»¶å¾ªç¯çš„å½±å“ï¼Œè¿™åœ¨å¼€å‘æŸäº›éœ€è¦ç²¾ç»†æ§åˆ¶äº‹ä»¶å¾ªç¯è¡Œä¸ºçš„åº”ç”¨æ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="timeout-ref" tabindex="-1"><a class="header-anchor" href="#timeout-ref"><span><a href="https://nodejs.org/docs/latest/api/timers.html#timeoutref" target="_blank" rel="noopener noreferrer">timeout.ref()</a></span></a></h3><p>Node.js ä¸­çš„ <code>timeout.ref()</code> å‡½æ•°æ˜¯ç”¨äºå¤„ç†å®šæ—¶å™¨çš„ä¸€ä¸ªæ–¹æ³•ã€‚åœ¨è§£é‡Šè¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£ Node.js ä¸­çš„å®šæ—¶å™¨ï¼ˆå¦‚ <code>setTimeout</code> å’Œ <code>setInterval</code>ï¼‰ä»¥åŠäº‹ä»¶å¾ªç¯çš„æ¦‚å¿µã€‚</p><h3 id="å®šæ—¶å™¨å’Œäº‹ä»¶å¾ªç¯" tabindex="-1"><a class="header-anchor" href="#å®šæ—¶å™¨å’Œäº‹ä»¶å¾ªç¯"><span>å®šæ—¶å™¨å’Œäº‹ä»¶å¾ªç¯</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œå½“ä½ è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼ˆæ¯”å¦‚ä½¿ç”¨ <code>setTimeout(fn, delay)</code>ï¼‰ï¼Œä½ å®é™…ä¸Šæ˜¯åœ¨æŒ‡å®šä¸€ä¸ªå‡½æ•° <code>fn</code> åœ¨è‡³å°‘å»¶è¿Ÿ <code>delay</code> æ¯«ç§’åæ‰§è¡Œã€‚Node.js ä¼šå°†è¿™ä¸ªå®šæ—¶ä»»åŠ¡åŠ å…¥åˆ°äº‹ä»¶å¾ªç¯ä¸­ï¼Œç­‰å¾…æ‰§è¡Œã€‚äº‹ä»¶å¾ªç¯è´Ÿè´£ç®¡ç†æ‰€æœ‰å¼‚æ­¥æ“ä½œçš„æ‰§è¡Œé¡ºåºã€‚å®šæ—¶å™¨å°±æ˜¯å…¶ä¸­ä¸€ç§å¼‚æ­¥æ“ä½œã€‚</p><h3 id="unref-å’Œ-ref" tabindex="-1"><a class="header-anchor" href="#unref-å’Œ-ref"><span>unref() å’Œ ref()</span></a></h3><p>æ¯ä¸ªé€šè¿‡ <code>setTimeout</code> æˆ– <code>setInterval</code> åˆ›å»ºçš„å®šæ—¶å™¨é»˜è®¤éƒ½æ˜¯æ´»è·ƒçš„ï¼Œå³å®ƒä»¬ä¼šé˜»æ­¢ Node.js è¿›ç¨‹é€€å‡ºï¼Œç›´åˆ°æ‰€æœ‰å®šæ—¶å™¨éƒ½æ‰§è¡Œå®Œæ¯•ã€‚æœ‰æ—¶ï¼Œæˆ‘ä»¬å¹¶ä¸å¸Œæœ›ä¸€ä¸ªå®šæ—¶å™¨é˜»æ­¢ç¨‹åºé€€å‡ºï¼ˆä¾‹å¦‚ï¼Œåœ¨æŸäº›é•¿æ—¶é—´è¿è¡Œçš„åå°ä»»åŠ¡ä¸­ï¼‰ã€‚è¿™æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>unref()</code> æ–¹æ³•æ¥æ ‡è®°è¿™ä¸ªå®šæ—¶å™¨ä¸ºéæ´»è·ƒçš„ï¼Œå…è®¸ç¨‹åºåœ¨è¯¥å®šæ—¶å™¨æœªæ‰§è¡Œå®Œæ—¶ä¹Ÿèƒ½æ­£å¸¸é€€å‡ºã€‚</p><p>ç›¸å¯¹åº”åœ°ï¼Œå¦‚æœä½ ä¹‹å‰å¯¹æŸä¸ªå®šæ—¶å™¨è°ƒç”¨äº† <code>unref()</code> æ–¹æ³•ï¼Œä½†åæ¥åˆæƒ³è®©å®ƒé‡æ–°é˜»æ­¢ Node.js è¿›ç¨‹é€€å‡ºï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>timeout.ref()</code> æ–¹æ³•ã€‚è°ƒç”¨ <code>timeout.ref()</code> åï¼Œè¯¥å®šæ—¶å™¨ä¼šå†æ¬¡è¢«è§†ä¸ºæ´»è·ƒçš„ï¼Œå³å®ƒä¼šé˜»æ­¢ Node.js è¿›ç¨‹é€€å‡ºï¼Œç›´åˆ°è¯¥å®šæ—¶å™¨æ‰§è¡Œå®Œæ¯•ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-2"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™çš„åå°æœåŠ¡ï¼ŒæœåŠ¡ä¸­åŒ…å«ä¸€ä¸ªå®šæ—¶æ¸…ç†ä¸´æ—¶æ–‡ä»¶çš„åŠŸèƒ½ã€‚è¿™ä¸ªåŠŸèƒ½ä¸æ˜¯æ ¸å¿ƒæœåŠ¡çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥ä½ ä¸å¸Œæœ›å› ä¸ºè¿™ä¸ªå®šæ—¶ä»»åŠ¡è€Œé˜»æ­¢ç¨‹åºé€€å‡ºã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ¸…ç†ä¸´æ—¶æ–‡ä»¶çš„å‡½æ•°</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> cleanTempFolder</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> tempFolderPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/temp</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">tempFolderPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> files</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    for</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> file</span><span style="color:#81A1C1;"> of</span><span style="color:#D8DEE9;"> files</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unlink</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">tempFolderPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> file</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è®¾ç½®å®šæ—¶å™¨ï¼Œæ¯å°æ—¶æ¸…ç†ä¸€æ¬¡ä¸´æ—¶æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> timeout</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setInterval</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">cleanTempFolder</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 3600000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // 3600000æ¯«ç§’ = 1å°æ—¶</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ unref() ä½¿ Node.js åœ¨æ­¤å®šæ—¶å™¨å¾…æ‰§è¡Œæ—¶ä¹Ÿå¯æ­£å¸¸é€€å‡º</span></span>
<span class="line"><span style="color:#D8DEE9;">timeout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unref</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœåç»­å†³å®šè¿™ä¸ªå®šæ—¶æ¸…ç†ä»»åŠ¡å˜å¾—å¾ˆé‡è¦ï¼Œéœ€è¦ä¿è¯å®ƒå®Œæˆåæ‰å…è®¸è¿›ç¨‹é€€å‡ºï¼Œé‚£ä¹ˆä½ å¯ä»¥è¿™æ ·ä¿®æ”¹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å¦‚æœå†³å®šè¿™ä¸ªå®šæ—¶ä»»åŠ¡å¾ˆé‡è¦ï¼Œéœ€è¦é˜»æ­¢ç¨‹åºé€€å‡ºç›´åˆ°ä»»åŠ¡å®Œæˆ</span></span>
<span class="line"><span style="color:#D8DEE9;">timeout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">ref</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥çµæ´»åœ°æ§åˆ¶å®šæ—¶å™¨å¯¹ Node.js åº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸçš„å½±å“ã€‚</p><h3 id="timeout-refresh" tabindex="-1"><a class="header-anchor" href="#timeout-refresh"><span><a href="https://nodejs.org/docs/latest/api/timers.html#timeoutrefresh" target="_blank" rel="noopener noreferrer">timeout.refresh()</a></span></a></h3><p>Node.js ä¸­çš„ <code>timeout.refresh()</code> æ–¹æ³•æ˜¯ç”¨äºé‡ç½®å®šæ—¶å™¨çš„è¶…æ—¶æ—¶é—´ã€‚æ¯æ¬¡è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œå®šæ—¶å™¨çš„è¶…æ—¶è®¡æ•°ä¼šé‡æ–°å¼€å§‹ã€‚è¿™æ„å‘³ç€å¦‚æœä½ è®¾ç½®äº†ä¸€ä¸ªå®šæ—¶å™¨åœ¨ä¸€æ®µæ—¶é—´åæ‰§è¡ŒæŸé¡¹ä»»åŠ¡ï¼Œä½†åœ¨åˆ°è¾¾æŒ‡å®šæ—¶é—´å‰è°ƒç”¨äº† <code>timeout.refresh()</code>ï¼Œé‚£ä¹ˆå®šæ—¶å™¨å°±ä¼šä»æ–°è®¡ç®—æ—¶é—´ï¼Œå»¶é•¿ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´ã€‚</p><h3 id="é€šä¿—è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#é€šä¿—è§£é‡Š"><span>é€šä¿—è§£é‡Š</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨ä½¿ç”¨å¾®æ³¢ç‚‰åŠ çƒ­é£Ÿç‰©ï¼Œå¹¶è®¾å®šäº† 2 åˆ†é’Ÿçš„å®šæ—¶ã€‚å‡å¦‚åœ¨è¿‡äº† 1 åˆ†é’Ÿæ—¶ï¼Œä½ çªç„¶å†³å®šéœ€è¦æ›´å¤šæ—¶é—´æ¥åŠ çƒ­é£Ÿç‰©ï¼Œäºæ˜¯ä½ å–æ¶ˆäº†å½“å‰çš„å®šæ—¶å¹¶é‡æ–°è®¾å®šäº† 2 åˆ†é’Ÿã€‚è¿™é‡Œï¼Œ<code>timeout.refresh()</code> ç±»ä¼¼äºä½ å–æ¶ˆå¹¶é‡æ–°è®¾å®šå¾®æ³¢ç‚‰çš„å®šæ—¶ï¼Œè®©å®šæ—¶å¼€å§‹çš„ç‚¹â€œåˆ·æ–°â€äº†ã€‚</p><h3 id="åŸºæœ¬ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç”¨æ³•"><span>åŸºæœ¬ç”¨æ³•</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œä½¿ç”¨ <code>setTimeout()</code> æ–¹æ³•å¯ä»¥åˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨ï¼Œè¯¥æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šè¦æ‰§è¡Œçš„å‡½æ•°å’Œå»¶è¿Ÿçš„æ¯«ç§’æ•°ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> timeout</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">This will be logged after 2 seconds</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 2000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// Deciding to extend the timeout duration before the first one finishes</span></span>
<span class="line"><span style="color:#88C0D0;">setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  timeout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">refresh</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // Resets the timer</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Timer refreshed!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 1000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè®¾ç½®äº†ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå®ƒä¼šåœ¨ 2 ç§’åæ‰“å°ä¸€æ¡æ¶ˆæ¯ã€‚ç´§æ¥ç€æˆ‘ä»¬è®¾ç½®äº†å¦ä¸€ä¸ªå®šæ—¶å™¨ï¼Œåœ¨ 1 ç§’åè°ƒç”¨ <code>timeout.refresh()</code> æ–¹æ³•ã€‚è¿™æ ·ï¼ŒåŸæœ¬åº”è¯¥åœ¨ 2 ç§’åè¢«æ‰§è¡Œçš„ä»»åŠ¡ç°åœ¨ä¼šåœ¨ 3 ç§’åè¢«æ‰§è¡Œï¼ˆå› ä¸ºå®ƒè¢«åˆ·æ–°äº†ï¼‰ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-3"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-web-æœåŠ¡å™¨è¯·æ±‚è¶…æ—¶é‡ç½®" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-web-æœåŠ¡å™¨è¯·æ±‚è¶…æ—¶é‡ç½®"><span>ç¤ºä¾‹ 1: Web æœåŠ¡å™¨è¯·æ±‚è¶…æ—¶é‡ç½®</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œä½ å¸Œæœ›å¯¹æ¯ä¸ªè¯·æ±‚è®¾ç½®ä¸€ä¸ªè¶…æ—¶é™åˆ¶ï¼Œä½†å¦‚æœåœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­æœ‰æ–°çš„æ•°æ®åˆ°è¾¾ï¼Œä½ å¯èƒ½å¸Œæœ›é‡ç½®è¿™ä¸ªè¶…æ—¶è®¡æ—¶å™¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> http</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">http</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> server</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> http</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createServer</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">req</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> res</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> timeout</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Request timed out</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Timeout</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span><span style="color:#B48EAD;"> 5000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // Set a 5-second timeout for every request</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  req</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">data</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Received new data chunk</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    timeout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">refresh</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // Data arrived, refresh timeout</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  req</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">end</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">    clearTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">timeout</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // Clear the timeout on request end</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Request ended successfully</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Success</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">server</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">listen</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">3000</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Server running on port 3000</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¯¹äºæ¯ä¸ªæ¥æ”¶åˆ°çš„è¯·æ±‚ï¼Œæˆ‘ä»¬è®¾å®šäº† 5 ç§’çš„è¶…æ—¶æ—¶é—´ã€‚å¦‚æœåœ¨è¿™ 5 ç§’å†…æœ‰æ–°çš„æ•°æ®å—åˆ°è¾¾ï¼ˆæ¯”å¦‚å®¢æˆ·ç«¯ä¸Šä¼ æ–‡ä»¶ï¼‰ï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨ <code>timeout.refresh()</code> æ¥é‡ç½®è¶…æ—¶è®¡æ—¶å™¨ï¼Œç¡®ä¿ä¸ä¼šå› ä¸ºæ•°æ®ä¼ è¾“è€Œé”™è¯¯åœ°ä¸­æ–­è¯·æ±‚ã€‚</p><h4 id="ç¤ºä¾‹-2-åŠ¨æ€è°ƒæ•´å®šæ—¶ä»»åŠ¡" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-åŠ¨æ€è°ƒæ•´å®šæ—¶ä»»åŠ¡"><span>ç¤ºä¾‹ 2: åŠ¨æ€è°ƒæ•´å®šæ—¶ä»»åŠ¡</span></a></h4><p>è€ƒè™‘ä¸€ä¸ªåœºæ™¯ï¼Œä½ åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦å®šæœŸä»è¿œç¨‹ API è·å–æ•°æ®ã€‚åŸºäºç½‘ç»œæ¡ä»¶æˆ– API å“åº”æ—¶é—´çš„å˜åŒ–ï¼Œä½ å¯èƒ½ä¼šæƒ³åŠ¨æ€è°ƒæ•´è¯·æ±‚é—´éš”ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> interval</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 3000</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // Initial interval set to 3 seconds</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#88C0D0;"> fetchData</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Fetching data...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // Simulate varying processing time or conditions</span></span>
<span class="line"><span style="color:#D8DEE9;">  interval</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Math</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">random</span><span style="color:#D8DEE9FF;">() </span><span style="color:#81A1C1;">&gt;</span><span style="color:#B48EAD;"> 0.5</span><span style="color:#81A1C1;"> ?</span><span style="color:#B48EAD;"> 2000</span><span style="color:#81A1C1;"> :</span><span style="color:#B48EAD;"> 4000</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> timeout</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fetchData</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> interval</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  timeout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">refresh</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // Refresh with the new interval</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">fetchData</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ ¹æ®æ¡ä»¶åŠ¨æ€æ”¹å˜äº†å®šæ—¶å™¨çš„é—´éš”æ—¶é—´ã€‚æ¯æ¬¡è°ƒç”¨ <code>fetchData</code> æ—¶ï¼Œéƒ½ä¼šæ ¹æ®æŸäº›æ¡ä»¶ï¼ˆè¿™é‡Œä½¿ç”¨äº†éšæœºæ•°æ¨¡æ‹Ÿï¼‰æ¥å†³å®šä¸‹ä¸€æ¬¡è°ƒç”¨çš„é—´éš”ï¼Œç„¶åé€šè¿‡ <code>timeout.refresh()</code> åº”ç”¨æ–°çš„é—´éš”æ—¶é—´ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œ<code>timeout.refresh()</code> æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ–¹æ³•ï¼Œå®ƒå¯ä»¥å¸®åŠ©å¼€å‘è€…åœ¨éœ€è¦æ—¶é‡æ–°è®¡ç®—å®šæ—¶å™¨ï¼Œæ— è®ºæ˜¯å»¶é•¿è¿˜æ˜¯ç¼©çŸ­åŸå®šçš„ç­‰å¾…æ—¶é—´ï¼Œéƒ½èƒ½çµæ´»è°ƒæ•´ã€‚</p><h3 id="timeout-unref" tabindex="-1"><a class="header-anchor" href="#timeout-unref"><span><a href="https://nodejs.org/docs/latest/api/timers.html#timeoutunref" target="_blank" rel="noopener noreferrer">timeout.unref()</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>timeout.unref()</code>æ˜¯ä¸<code>setTimeout()</code>æ–¹æ³•ç›¸å…³çš„ä¸€ä¸ªåŠŸèƒ½ã€‚ä¸ºäº†ç†è§£<code>unref()</code>ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦äº†è§£ Node.js çš„äº‹ä»¶å¾ªç¯å’Œ<code>setTimeout()</code>çš„ä½œç”¨ã€‚</p><h3 id="äº‹ä»¶å¾ªç¯å’Œsettimeout" tabindex="-1"><a class="header-anchor" href="#äº‹ä»¶å¾ªç¯å’Œsettimeout"><span>äº‹ä»¶å¾ªç¯å’Œ<code>setTimeout()</code></span></a></h3><p>Node.js è¿è¡Œåœ¨å•çº¿ç¨‹ä¸Šï¼Œä½†å®ƒä½¿ç”¨äº‹ä»¶é©±åŠ¨çš„ç¼–ç¨‹æ¨¡å‹æ¥å¤„ç†å¤šä¸ªæ“ä½œï¼Œè¿™å°±æ˜¯æ‰€è°“çš„&quot;äº‹ä»¶å¾ªç¯&quot;ã€‚ç®€å•æ¥è¯´ï¼Œäº‹ä»¶å¾ªç¯å…è®¸ Node.js æ‰§è¡Œéé˜»å¡ I/O æ“ä½œï¼ˆå¦‚è¯»å†™æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡ç­‰ï¼‰â€” å°½ç®¡ JavaScript æ˜¯å•çº¿ç¨‹çš„ â€” é€šè¿‡æŠŠæ“ä½œæ”¾åˆ°é˜Ÿåˆ—ä¸­ï¼Œåœ¨åå°æ‰§è¡Œï¼Œå†åœ¨æ“ä½œå®Œæˆæ—¶å°†å›è°ƒå‡½æ•°æ”¾å›è°ƒé˜Ÿåˆ—ï¼Œæœ€åæ‰§è¡Œè¿™äº›å›è°ƒå‡½æ•°ã€‚</p><p>å½“ä½ ä½¿ç”¨<code>setTimeout()</code>è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨æ—¶ï¼Œä½ å‘Šè¯‰ Node.jsï¼š&quot;åœ¨ X æ¯«ç§’åï¼Œæ‰§è¡Œè¿™æ®µä»£ç &quot;ã€‚è¿™æ®µä»£ç ï¼ˆæˆ–ç§°ä¸ºå›è°ƒå‡½æ•°ï¼‰ä¼šè¢«åŠ å…¥åˆ°ä¸Šè¿°æåˆ°çš„å›è°ƒé˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…æ‰§è¡Œã€‚</p><h3 id="timeout-unref-çš„ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#timeout-unref-çš„ä½œç”¨"><span><code>timeout.unref()</code>çš„ä½œç”¨</span></a></h3><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœ Node.js è¿˜æœ‰å®šæ—¶å™¨ç­‰å¾…æ‰§è¡Œï¼Œäº‹ä»¶å¾ªç¯ä¼šä¿æŒæ´»è·ƒçŠ¶æ€ï¼Œå³ä½¿æ²¡æœ‰å…¶ä»–ä»»ä½• I/O æ“ä½œå‘ç”Ÿã€‚è¿™æ„å‘³ç€ï¼Œå³ä¾¿ä½ çš„åº”ç”¨å·²ç»å®Œæˆäº†æ‰€æœ‰å·¥ä½œï¼Œåªè¦è¿˜æœ‰å®šæ—¶å™¨æœªè§¦å‘ï¼ŒNode.js è¿›ç¨‹ä¸ä¼šé€€å‡ºã€‚</p><p>è¿™æ—¶<code>timeout.unref()</code>å°±æ˜¾å¾—éå¸¸æœ‰ç”¨äº†ã€‚è°ƒç”¨<code>timeout.unref()</code>å¯ä»¥è®© Node.js çŸ¥é“ï¼šè¿™ä¸ªå®šæ—¶å™¨ä¸åº”è¯¥é˜»æ­¢ Node.js è¿›ç¨‹é€€å‡ºã€‚å¦‚æœè¿™ä¸ªå®šæ—¶å™¨æ˜¯äº‹ä»¶å¾ªç¯ä¸­å¾…æ‰§è¡Œçš„å”¯ä¸€ä»»åŠ¡ï¼Œé‚£ä¹ˆäº‹ä»¶å¾ªç¯å°†ä¸ä¼šå› ä¸ºè¿™ä¸ªå®šæ—¶å™¨è€Œä¿æŒæ´»è·ƒçŠ¶æ€ï¼ŒNode.js è¿›ç¨‹å¯ä»¥æ­£å¸¸é€€å‡ºã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œå®ƒè¿˜åŒ…æ‹¬ä¸€ä¸ªå®šæœŸæ¸…ç†ç¼“å­˜çš„åŠŸèƒ½ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> http</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">http</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> cacheCleanupTimer</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">http</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">createServer</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">req</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> res</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // å¤„ç†è¯·æ±‚...</span></span>
<span class="line"><span style="color:#D8DEE9;">    res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello World</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å¼€å§‹ä¸€ä¸ªå®šæ—¶å™¨ï¼Œæ¯å°æ—¶æ¸…ç†ä¸€æ¬¡ç¼“å­˜</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">!</span><span style="color:#D8DEE9;">cacheCleanupTimer</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      cacheCleanupTimer</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ¸…ç†ç¼“å­˜...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">        // æ¸…ç†ç¼“å­˜çš„ä»£ç ...</span></span>
<span class="line"><span style="color:#ECEFF4;">      },</span><span style="color:#B48EAD;"> 3600000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // 3600000æ¯«ç§’ = 1å°æ—¶</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">      // è°ƒç”¨unref()ç¡®ä¿å®šæ—¶å™¨ä¸ä¼šé˜»æ­¢åº”ç”¨é€€å‡º</span></span>
<span class="line"><span style="color:#D8DEE9;">      cacheCleanupTimer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unref</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">listen</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">3000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:3000/</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒæœåŠ¡å™¨æ¯å°æ—¶ä¼šè‡ªåŠ¨æ¸…ç†ä¸€æ¬¡ç¼“å­˜ï¼Œä½†å› ä¸º<code>timeout.unref()</code>çš„è°ƒç”¨ï¼Œå¦‚æœæœåŠ¡å™¨é™¤äº†è¿™ä¸ªå®šæ—¶å™¨å¤–æ²¡æœ‰å…¶ä»–æ´»åŠ¨ï¼ˆæ¯”å¦‚ä¸å†æ¥æ”¶æ–°çš„ HTTP è¯·æ±‚ï¼‰ï¼Œå®ƒä»ç„¶å¯ä»¥æ­£å¸¸å…³é—­ï¼Œè€Œä¸ä¼šè¢«å®šæ—¶å™¨æ‰€é˜»å¡ã€‚</p><h3 id="ç»“è®º" tabindex="-1"><a class="header-anchor" href="#ç»“è®º"><span>ç»“è®º</span></a></h3><p>æ€»çš„æ¥è¯´ï¼Œ<code>timeout.unref()</code>æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªå¼ºå¤§åŠŸèƒ½ï¼Œå®ƒå¯ä»¥å¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°æ§åˆ¶åº”ç”¨çš„è¡Œä¸ºï¼Œç‰¹åˆ«æ˜¯åœ¨æ¶‰åŠåˆ°å®šæ—¶å™¨å¯èƒ½é˜»æ­¢åº”ç”¨é€€å‡ºçš„åœºæ™¯ä¸­ã€‚é€šè¿‡åˆç†ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œå¯ä»¥é¿å…ä¸å¿…è¦çš„èµ„æºå ç”¨ï¼Œä½¿ Node.js åº”ç”¨æ›´åŠ é«˜æ•ˆã€‚</p><h3 id="timeoutsymbol-toprimitive-https-nodejs-org-docs-latest-api-timers-html-timeoutsymboltoprimitive" tabindex="-1"><a class="header-anchor" href="#timeoutsymbol-toprimitive-https-nodejs-org-docs-latest-api-timers-html-timeoutsymboltoprimitive"><span>[timeout<a href="">Symbol.toPrimitive</a>](<a href="https://nodejs.org/docs/latest/api/timers.html#timeoutsymboltoprimitive" target="_blank" rel="noopener noreferrer">https://nodejs.org/docs/latest/api/timers.html#timeoutsymboltoprimitive</a>)</span></a></h3><p>å¼€å§‹ä¹‹å‰ï¼Œäº†è§£ä¸€ç‚¹å…³äº<code>Symbol.toPrimitive</code>æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚åœ¨ JavaScript ä¸­ï¼Œ<code>Symbol.toPrimitive</code>æ˜¯ä¸€ä¸ªå†…ç½®çš„ Symbol å€¼ï¼Œå®ƒç”¨æ¥æŒ‡å®šä¸€ä¸ªå¯¹è±¡è¢«è½¬æ¢ä¸ºç›¸åº”åŸå§‹å€¼æ—¶åº”è¯¥è°ƒç”¨çš„æ–¹æ³•ã€‚ç®€å•æ¥è¯´ï¼Œå½“ä½ å°è¯•å°†ä¸€ä¸ªå¯¹è±¡è½¬æ¢æˆä¸€ä¸ªåŸºæœ¬ç±»å‹ï¼ˆæ¯”å¦‚æ•°å­—æˆ–å­—ç¬¦ä¸²ï¼‰æ—¶ï¼Œå¦‚æœè¿™ä¸ªå¯¹è±¡æœ‰<code>Symbol.toPrimitive</code>æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°±ä¼šè¢«è°ƒç”¨ï¼Œæ¥å†³å®šå¦‚ä½•è¿›è¡Œè½¬æ¢ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>timeout</code>å¯¹è±¡ï¼ˆå®ƒæ¥æºäº Node.js çš„è®¡æ—¶å™¨åŠŸèƒ½ï¼Œæ¯”å¦‚ä½¿ç”¨<code>setTimeout</code>å‡½æ•°åˆ›å»ºçš„å»¶æ—¶å™¨ï¼‰å¢åŠ äº†ä¸€ä¸ª<code>Symbol.toPrimitive</code>çš„å®ç°ã€‚è¿™æ„å‘³ç€å½“ä½ å°è¯•å°†ä¸€ä¸ª<code>timeout</code>å¯¹è±¡è½¬æ¢ä¸ºä¸€ä¸ªåŸå§‹å€¼æ—¶ï¼ˆé€šå¸¸æ˜¯æ•°å­—æˆ–å­—ç¬¦ä¸²ï¼‰ï¼Œè¿™ä¸ª<code>Symbol.toPrimitive</code>æ–¹æ³•å°±ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ï¼Œå¹¶è¿”å›ä¸€ä¸ªç‰¹å®šçš„å€¼ã€‚</p><p>ä¸¾ä¾‹è¯´æ˜ï¼š</p><h3 id="_1-åˆ›å»ºä¸€ä¸ªtimeoutå¹¶å°è¯•è½¬æ¢ä¸ºæ•°å­—" tabindex="-1"><a class="header-anchor" href="#_1-åˆ›å»ºä¸€ä¸ªtimeoutå¹¶å°è¯•è½¬æ¢ä¸ºæ•°å­—"><span>1. åˆ›å»ºä¸€ä¸ª<code>timeout</code>å¹¶å°è¯•è½¬æ¢ä¸ºæ•°å­—</span></a></h3><p>å½“ä½ åˆ›å»ºä¸€ä¸ª<code>timeout</code>å¯¹è±¡ï¼Œæ¯”å¦‚é€šè¿‡<code>setTimeout()</code>è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå¹¶ä¸”åç»­éœ€è¦è·å–è¿™ä¸ªå®šæ—¶å™¨çš„å»¶è¿Ÿæ—¶é—´ï¼ˆæ¯”å¦‚ä¸ºäº†æ—¥å¿—è®°å½•ã€è°ƒè¯•æˆ–ä»»ä½•å…¶ä»–ç›®çš„ï¼‰ï¼Œä½ å¯èƒ½ä¼šå°è¯•ç›´æ¥å°†è¿™ä¸ª<code>timeout</code>å¯¹è±¡è½¬æ¢æˆä¸€ä¸ªæ•°å­—ã€‚åœ¨å¼•å…¥<code>Symbol.toPrimitive</code>ä¹‹å‰ï¼Œè¿™æ ·ç›´æ¥è½¬æ¢å¯èƒ½ä¸ä¼šå¾—åˆ°ä½ æœŸæœ›çš„ç»“æœï¼Œå› ä¸º<code>timeout</code>å¯¹è±¡å¹¶ä¸æ˜¯ä¸€ä¸ªæ•°å­—ã€‚ä½†ç°åœ¨ï¼Œç”±äº<code>timeout[Symbol.toPrimitive]()</code>çš„å®ç°ï¼Œå°è¯•å°†<code>timeout</code>å¯¹è±¡è½¬æ¢ä¸ºæ•°å­—ä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä»è€Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªæœ‰æ„ä¹‰çš„æ•°å€¼ï¼Œæ¯”å¦‚å‰©ä½™çš„å»¶è¿Ÿæ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚</p><h3 id="ç¤ºä¾‹ä»£ç " tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç "><span>ç¤ºä¾‹ä»£ç ï¼š</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> timeout</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {},</span><span style="color:#B48EAD;"> 1000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æˆ‘ä»¬æƒ³è¦è·å–è¿™ä¸ªtimeoutå¯¹è±¡ä»£è¡¨çš„å»¶æ—¶æ—¶é—´</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> delay</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;">timeout</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¿™é‡Œçš„+å·ä¼šå°è¯•å°†å¯¹è±¡è½¬ä¸ºæ•°å­—</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">delay</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼šè¿™ä¸ªå…·ä½“çš„æ•°å€¼ï¼ˆæ¯”å¦‚æ˜¯å¦çœŸçš„è¿”å›å‰©ä½™çš„å»¶æ—¶æ—¶é—´ï¼‰å–å†³äº Node.js å¯¹<code>Symbol.toPrimitive</code>çš„å…·ä½“å®ç°ï¼Œä¸Šé¢çš„ä»£ç ä»…ç”¨äºè¯´æ˜è¿™ç§è½¬æ¢çš„å¯èƒ½æ€§ã€‚</p><h3 id="_2-æ—¥å¿—è®°å½•" tabindex="-1"><a class="header-anchor" href="#_2-æ—¥å¿—è®°å½•"><span>2. æ—¥å¿—è®°å½•</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œéœ€è¦è¯¦ç»†è®°å½•å„ä¸ªå®šæ—¶å™¨çš„è§¦å‘æ—¶é—´ã€‚ä½ å¯èƒ½ä¼šæ‰“å°æ¯ä¸ª<code>timeout</code>å¯¹è±¡ï¼Œä»¥ä¾¿äºè°ƒè¯•ã€‚æœ‰äº†<code>Symbol.toPrimitive</code>çš„å®ç°ï¼Œå½“ä½ å°è¯•å°†<code>timeout</code>å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶æ—¶ï¼Œå¯ä»¥å¾—åˆ°æ›´åŠ äººç±»å¯è¯»çš„ä¿¡æ¯ï¼Œæ¯”å¦‚å®šæ—¶å™¨çš„å”¯ä¸€æ ‡è¯†ç¬¦æˆ–å‰©ä½™æ—¶é—´ï¼Œè€Œæ— éœ€æ‰‹åŠ¨ç¼–å†™é¢å¤–çš„é€»è¾‘æ¥æå–è¿™äº›ä¿¡æ¯ã€‚</p><h3 id="æ€»ç»“-3" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-3"><span>æ€»ç»“</span></a></h3><p><code>timeout[Symbol.toPrimitive]()</code>çš„åŠ å…¥ä¸º Node.js ä¸­ä¸æ—¶é—´ç›¸å…³çš„å¯¹è±¡æä¾›äº†ä¸€ç§æ ‡å‡†åŒ–å’Œç®€ä¾¿çš„æ–¹å¼æ¥è·å–å…¶åŸå§‹å€¼è¡¨ç¤ºï¼Œæ— è®ºæ˜¯æ•°å­—è¿˜æ˜¯å­—ç¬¦ä¸²å½¢å¼ã€‚è¿™åœ¨å®é™…ç¼–ç¨‹ä¸­æå¤§åœ°ç®€åŒ–äº†æŸäº›ä»»åŠ¡ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦å¤„ç†ã€è®°å½•æˆ–æ¯”è¾ƒå¤šä¸ªå®šæ—¶å™¨å¯¹è±¡æ—¶ã€‚</p><h3 id="timeoutsymbol-dispose-https-nodejs-org-docs-latest-api-timers-html-timeoutsymboldispose" tabindex="-1"><a class="header-anchor" href="#timeoutsymbol-dispose-https-nodejs-org-docs-latest-api-timers-html-timeoutsymboldispose"><span>[timeout<a href="">Symbol.dispose</a>](<a href="https://nodejs.org/docs/latest/api/timers.html#timeoutsymboldispose" target="_blank" rel="noopener noreferrer">https://nodejs.org/docs/latest/api/timers.html#timeoutsymboldispose</a>)</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>timeout[Symbol.dispose]()</code> æ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°çš„åŠŸèƒ½ï¼Œå®ƒæä¾›äº†ä¸€ç§ä¼˜é›…åœ°å–æ¶ˆå·²ç»è®¾å®šä½†è¿˜æœªæ‰§è¡Œçš„è¶…æ—¶ï¼ˆtimeoutï¼‰æ“ä½œçš„æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¸»è¦å½’å±äº Node.js çš„å®šæ—¶å™¨ï¼ˆtimersï¼‰åŠŸèƒ½ä¹‹ä¸€ã€‚ç†è§£è¿™ä¸ªåŠŸèƒ½ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆä»åŸºç¡€æ¦‚å¿µå’Œç›¸å…³èƒŒæ™¯å¼€å§‹ã€‚</p><h3 id="åŸºç¡€æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æ¦‚å¿µ"><span>åŸºç¡€æ¦‚å¿µ</span></a></h3><ol><li><p><strong>å®šæ—¶å™¨ï¼ˆTimersï¼‰</strong>: åœ¨ JavaScript å’Œ Node.js ä¸­ï¼Œå®šæ—¶å™¨å…è®¸ä½ å®‰æ’ä»£ç åœ¨å°†æ¥æŸä¸ªç‰¹å®šæ—¶é—´ç‚¹æ‰§è¡Œã€‚è¿™é€šå¸¸é€šè¿‡ <code>setTimeout</code> å’Œ <code>setInterval</code> å‡½æ•°å®ç°ã€‚</p></li><li><p><strong>Symbol</strong>: åœ¨ JavaScript ä¸­ï¼Œ<code>Symbol</code> æ˜¯ä¸€ç§ç‹¬ç‰¹ä¸”ä¸å¯å˜çš„æ•°æ®ç±»å‹ï¼Œå¸¸ç”¨ä½œå¯¹è±¡å±æ€§çš„é”®ã€‚</p></li><li><p><strong>dispose æ–¹æ³•</strong>: Dispose æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œç”¨äºè¿›è¡Œèµ„æºç®¡ç†ï¼Œç‰¹åˆ«æ˜¯é‡Šæ”¾æˆ–æ¸…ç†ä¸å†éœ€è¦çš„èµ„æºã€‚</p></li></ol><h3 id="timeout-symbol-dispose-è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#timeout-symbol-dispose-è¯¦è§£"><span><code>timeout[Symbol.dispose]()</code> è¯¦è§£</span></a></h3><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>timeout[Symbol.dispose]()</code> æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿå–æ¶ˆå’Œæ¸…ç†å°šæœªæ‰§è¡Œçš„è¶…æ—¶å›è°ƒå‡½æ•°ã€‚å½“ä½ åˆ›å»ºäº†ä¸€ä¸ªè¶…æ—¶æ“ä½œï¼ˆæ¯”å¦‚ä½¿ç”¨ <code>setTimeout</code>ï¼‰ï¼Œä½†åœ¨è¶…æ—¶å›è°ƒè¢«æ‰§è¡Œä¹‹å‰ï¼Œä½ å†³å®šä¸å†éœ€è¦è¿™ä¸ªæ“ä½œæ—¶ï¼Œè¿™ä¸ªæ–¹æ³•å°±éå¸¸æœ‰ç”¨ã€‚</p><p>è¿™ä¸ªæ–¹æ³•çš„å·¥ä½œæ–¹å¼æ˜¯ï¼Œé€šè¿‡è°ƒç”¨ä¸ <code>setTimeout</code> è¿”å›çš„ <code>Timeout</code> å¯¹è±¡ç›¸å…³è”çš„ <code>[Symbol.dispose]()</code> æ–¹æ³•ï¼Œç«‹å³å–æ¶ˆè¯¥è¶…æ—¶æ“ä½œã€‚è¿™æ ·åšæ—¢æ¸…é™¤äº†è¶…æ—¶å›è°ƒï¼Œåˆå…è®¸ Node.js çš„äº‹ä»¶å¾ªç¯æ›´é«˜æ•ˆåœ°è¿è¡Œï¼Œå› ä¸ºå®ƒä¸å¿…è¿½è¸ªå’Œç®¡ç†é‚£äº›æœ€ç»ˆä¸ä¼šè¢«æ‰§è¡Œçš„è¶…æ—¶æ“ä½œã€‚</p><h3 id="ä½¿ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹"><span>ä½¿ç”¨ç¤ºä¾‹</span></a></h3><p>æƒ³è±¡ä¸€ä¸ªç®€å•çš„åœºæ™¯ï¼šä½ è®¾ç½®äº†ä¸€ä¸ªè¶…æ—¶å›è°ƒï¼Œä»¥åœ¨ 10 ç§’åæ‰§è¡ŒæŸé¡¹ä»»åŠ¡ã€‚ä½†åœ¨ 5 ç§’æ—¶ï¼ŒåŸºäºæŸä¸ªæ¡ä»¶ï¼Œä½ å†³å®šä¸å†éœ€è¦æ‰§è¡Œé‚£é¡¹ä»»åŠ¡ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// è®¾ç½®ä¸€ä¸ªå°†åœ¨10ç§’åè§¦å‘çš„è¶…æ—¶æ“ä½œ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> timeout</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ®µä»£ç å°†ä¸ä¼šæ‰§è¡Œ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 10000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾åœ¨5ç§’åï¼Œæˆ‘ä»¬å†³å®šå–æ¶ˆä¸Šé¢è®¾ç½®çš„è¶…æ—¶æ“ä½œ</span></span>
<span class="line"><span style="color:#88C0D0;">setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">timeout</span><span style="color:#D8DEE9FF;">[</span><span style="color:#D8DEE9;">Symbol</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">dispose</span><span style="color:#D8DEE9FF;">]) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    timeout</span><span style="color:#D8DEE9FF;">[</span><span style="color:#D8DEE9;">Symbol</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">dispose</span><span style="color:#D8DEE9FF;">]()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å–æ¶ˆè¶…æ—¶æ“ä½œ</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¶…æ—¶æ“ä½œå·²å–æ¶ˆ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 5000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…åº”ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨åœºæ™¯"><span>å®é™…åº”ç”¨åœºæ™¯</span></a></h3><ul><li><p><strong>Web æœåŠ¡å™¨</strong>: åœ¨å¤„ç† HTTP è¯·æ±‚æ—¶ï¼Œå¯èƒ½ä¼šè®¾ç½®ä¸€ä¸ªè¶…æ—¶æ“ä½œï¼Œä»¥ç¡®ä¿åœ¨ç‰¹å®šæ—¶é—´å†…è·å¾—å“åº”ã€‚å¦‚æœæå‰è·å¾—äº†å“åº”ï¼Œå¯ä»¥ä½¿ç”¨ <code>timeout[Symbol.dispose]()</code> æ¥å–æ¶ˆå‰©ä½™çš„è¶…æ—¶æ“ä½œã€‚</p></li><li><p><strong>æ¸¸æˆå¼€å‘</strong>: åœ¨æ¸¸æˆé€»è¾‘ä¸­ï¼Œå¯èƒ½ä¼šæ ¹æ®ç©å®¶çš„è¡ŒåŠ¨è®¾ç½®è¶…æ—¶æ“ä½œæ¥è§¦å‘æŸäº›äº‹ä»¶ã€‚å¦‚æœæ¸¸æˆçŠ¶æ€å˜åŒ–ä½¿å¾—è¿™äº›äº‹ä»¶ä¸å†ç›¸å…³ï¼Œå¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³•æå‰æ¸…ç†ã€‚</p></li><li><p><strong>ç‰©è”ç½‘(IoT)åº”ç”¨</strong>: åœ¨è®¾å¤‡é€šä¿¡æ—¶ï¼Œå¯èƒ½ä¼šè®¾ç½®è¶…æ—¶ä»¥ç­‰å¾…è®¾å¤‡å“åº”ã€‚å¦‚æœè®¾å¤‡åœ¨é¢„æœŸæ—¶é—´å†…å“åº”ï¼Œä¸éœ€è¦ç­‰å¾…è¶…æ—¶ç»“æŸï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•å–æ¶ˆè¶…æ—¶ã€‚</p></li></ul><p>æ€»ç»“ï¼Œ<code>timeout[Symbol.dispose]()</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå®ƒå¢å¼ºäº† Node.js åº”ç”¨ç¨‹åºåœ¨ç®¡ç†èµ„æºå’Œä¼˜åŒ–æ€§èƒ½æ–¹é¢çš„èƒ½åŠ›ã€‚é€šè¿‡å…è®¸å¼€å‘è€…å–æ¶ˆä¸å†éœ€è¦çš„è¶…æ—¶æ“ä½œï¼Œå®ƒä½¿å¾—ä»£ç æ›´åŠ çµæ´»å’Œé«˜æ•ˆã€‚</p><h2 id="scheduling-timers" tabindex="-1"><a class="header-anchor" href="#scheduling-timers"><span><a href="https://nodejs.org/docs/latest/api/timers.html#scheduling-timers" target="_blank" rel="noopener noreferrer">Scheduling timers</a></span></a></h2><p>ç†è§£ Node.js ä¸­çš„å®šæ—¶å™¨è°ƒåº¦æ˜¯ç®¡ç†æ—¶é—´å’Œæ‰§è¡Œä»£ç åœ¨ç‰¹å®šæ—¶åˆ»çš„ä¸€ç§å¼ºå¤§æ–¹å¼ã€‚åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œ<code>timers</code> æ¨¡å—æä¾›äº†å‡ ç§æ–¹æ³•æ¥å®‰æ’å‡½æ•°åœ¨å°†æ¥æŸä¸ªæ—¶é—´ç‚¹æ‰§è¡Œæˆ–é‡å¤æ‰§è¡Œã€‚æˆ‘ä»¬å°†é€šè¿‡å‡ ä¸ªå…³é”®å‡½æ•°æ¥æ¢ç´¢è¿™ä¸ªæ¦‚å¿µï¼š<code>setTimeout()</code>, <code>setInterval()</code>, å’Œ <code>setImmediate()</code>ï¼Œå¹¶ä¸”ä¼šç»™å‡ºä¸€äº›å®é™…åº”ç”¨çš„ä¾‹å­ã€‚</p><h3 id="settimeout" tabindex="-1"><a class="header-anchor" href="#settimeout"><span><code>setTimeout()</code></span></a></h3><p><code>setTimeout()</code> å‡½æ•°ç”¨äºåœ¨æŒ‡å®šçš„æ¯«ç§’æ•°åæ‰§è¡Œä¸€ä¸ªå‡½æ•°ã€‚è¿™å¯¹äºå»¶è¿Ÿæ‰§è¡Œä»»åŠ¡éå¸¸æœ‰ç”¨ã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼šå‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç»œåº”ç”¨ï¼Œå¹¶å¸Œæœ›åœ¨ç”¨æˆ·æäº¤è¡¨å•åæ˜¾ç¤ºä¸€ä¸ªâ€œæˆåŠŸâ€æ¶ˆæ¯ï¼Œä½†æƒ³è¦ç¨å¾®å»¶è¿Ÿæ˜¾ç¤ºï¼Œä»¥ä¾¿ç»™ç”¨æˆ·ä¸€ç§å“åº”æ­£åœ¨å¤„ç†çš„æ„Ÿè§‰ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> showSuccessMessage</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Form submitted successfully!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ˜¾ç¤ºæ¶ˆæ¯å°†åœ¨2ç§’ï¼ˆ2000æ¯«ç§’ï¼‰åæ‰§è¡Œ</span></span>
<span class="line"><span style="color:#88C0D0;">setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">showSuccessMessage</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 2000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="setinterval" tabindex="-1"><a class="header-anchor" href="#setinterval"><span><code>setInterval()</code></span></a></h3><p><code>setInterval()</code> å‡½æ•°å¯è®©ä½ æŒ‰ç…§æŒ‡å®šçš„å‘¨æœŸï¼ˆä»¥æ¯«ç§’è®¡ï¼‰é‡å¤æ‰§è¡ŒæŸä¸ªå‡½æ•°ã€‚è¿™é€‚åˆéœ€è¦å®šæœŸæ‰§è¡Œçš„ä»»åŠ¡ï¼Œæ¯”å¦‚æ›´æ–° UI å…ƒç´ ç­‰ã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼šå¦‚æœä½ æ­£åœ¨åˆ›å»ºä¸€ä¸ªåŠ¨æ€çš„ä»ªè¡¨æ¿ï¼Œéœ€è¦æ¯ 10 ç§’é’Ÿä»æœåŠ¡å™¨è·å–æœ€æ–°æ•°æ®å¹¶æ›´æ–°æ˜¾ç¤ºã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> fetchDataAndUpdateUI</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Fetching and updating data...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // å‡è®¾è¿™é‡ŒåŒ…å«ä»æœåŠ¡å™¨è·å–æ•°æ®å’Œæ›´æ–°UIçš„ä»£ç </span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ¯10ç§’é’Ÿæ‰§è¡Œä¸€æ¬¡fetchDataAndUpdateUIå‡½æ•°</span></span>
<span class="line"><span style="color:#88C0D0;">setInterval</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fetchDataAndUpdateUI</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 10000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="setimmediate" tabindex="-1"><a class="header-anchor" href="#setimmediate"><span><code>setImmediate()</code></span></a></h3><p><code>setImmediate()</code> å‡½æ•°ç”¨äºåœ¨å½“å‰äº‹ä»¶å¾ªç¯ç»“æŸåç«‹å³æ‰§è¡Œä¸€ä¸ªå‡½æ•°ã€‚è¿™å¯¹äºå°†ä»»åŠ¡å¼‚æ­¥åœ°æ¨è¿Ÿåˆ°åŒæ­¥ä»£ç æ‰§è¡Œå®Œæˆåä½†ä¸å…·ä½“å»¶è¿Ÿåˆ°æŸä¸ªæ—¶é—´ç‚¹éå¸¸æœ‰ç”¨ã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼šè€ƒè™‘ä¸€ä¸ªåœºæ™¯ï¼Œä½ çš„åº”ç”¨åœ¨å¯åŠ¨æ—¶éœ€è¦åŠ è½½å¤§é‡æ•°æ®ã€‚ä¸ºäº†ä¸é˜»å¡äº‹ä»¶å¾ªç¯ï¼Œå¯ä»¥ä½¿ç”¨ <code>setImmediate()</code> å°†åŠ è½½ä»»åŠ¡æ’åœ¨äº‹ä»¶é˜Ÿåˆ—çš„ä¸‹ä¸€ä¸ªå‘¨æœŸæ‰§è¡Œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> loadData</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Loading data...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // å‡è®¾è¿™é‡ŒåŒ…å«åŠ è½½æ•°æ®çš„ä»£ç </span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// loadDataå°†åœ¨å½“å‰æ‰§è¡Œæ ˆæ¸…ç©ºåç«‹å³æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#88C0D0;">setImmediate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">loadData</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å®é™…åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨"><span>å®é™…åº”ç”¨</span></a></h2><ul><li><strong>Web æœåŠ¡å™¨</strong>ï¼šä½¿ç”¨ <code>setTimeout()</code> æ¥å¤„ç†è¶…æ—¶ï¼Œç¡®ä¿é•¿æ—¶é—´è¿è¡Œçš„è¯·æ±‚ä¸ä¼šæ°¸ä¹…å ç”¨èµ„æºã€‚</li><li><strong>æ¸¸æˆå¼€å‘</strong>ï¼šé€šè¿‡ <code>setInterval()</code> å®šæ—¶æ›´æ–°æ¸¸æˆçŠ¶æ€æˆ–ç•Œé¢ï¼Œå¦‚æ¯ç§’æ›´æ–°ä¸€æ¬¡ç©å®¶å¾—åˆ†ã€‚</li><li><strong>å®æ—¶æ•°æ®å¤„ç†</strong>ï¼šä½¿ç”¨ <code>setImmediate()</code> åœ¨å¤„ç†å®Œä¸€æ‰¹æ•°æ®åç«‹å³å¼€å§‹å¤„ç†ä¸‹ä¸€æ‰¹ï¼Œä¼˜åŒ–æ•°æ®å¤„ç†æµç¨‹ï¼Œæé«˜æ•ˆç‡ã€‚</li></ul><p>ç†è§£å’Œè¿ç”¨è¿™äº›å®šæ—¶å™¨æ–¹æ³•èƒ½å¤Ÿè®©ä½ åœ¨ Node.js åº”ç”¨å¼€å‘ä¸­æ›´æœ‰æ•ˆåœ°ç®¡ç†å’Œè§„åˆ’ä»»åŠ¡æ‰§è¡Œæ—¶é—´ï¼Œæ— è®ºæ˜¯åœ¨ Web å¼€å‘ã€åç«¯æœåŠ¡è¿˜æ˜¯å¤æ‚çš„ç³»ç»Ÿè®¾è®¡ä¸­ã€‚</p><h3 id="setimmediate-callback-args" tabindex="-1"><a class="header-anchor" href="#setimmediate-callback-args"><span><a href="https://nodejs.org/docs/latest/api/timers.html#setimmediatecallback-args" target="_blank" rel="noopener noreferrer">setImmediate(callback[, ...args])</a></span></a></h3><p>Node.js ä¸­çš„<code>setImmediate(callback[, ...args])</code>æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„å‡½æ•°ï¼Œä¸»è¦ç”¨äºå®‰æ’ä¸€ä¸ªå›è°ƒå‡½æ•°å°½å¯èƒ½å¿«åœ°åœ¨å½“å‰äº‹ä»¶å¾ªç¯å‘¨æœŸçš„ç»“æŸæ—¶æ‰§è¡Œã€‚æ¢å¥è¯è¯´ï¼Œå®ƒæŒ‡ç¤º Node.js åœ¨å®Œæˆç°æœ‰çš„æ“ä½œåï¼Œä½†åœ¨å¤„ç†ä¸‹ä¸€è½®äº‹ä»¶ä¹‹å‰ï¼Œè¿è¡Œä½ çš„å›è°ƒå‡½æ•°ã€‚</p><h3 id="å‚æ•°è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><strong>callback</strong>ï¼šè¿™æ˜¯ä½ å¸Œæœ›åœ¨å½“å‰äº‹ä»¶å¾ªç¯å°½å¿«æ‰§è¡Œçš„å‡½æ•°ã€‚</li><li><strong>...args</strong>ï¼šå¯é€‰å‚æ•°ã€‚è¿™äº›æ˜¯ä¼ é€’ç»™å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚</li></ul><h3 id="ç†è§£setimmediate" tabindex="-1"><a class="header-anchor" href="#ç†è§£setimmediate"><span>ç†è§£<code>setImmediate()</code></span></a></h3><p>ä¸ºäº†æ·±å…¥ç†è§£<code>setImmediate()</code>çš„ä½œç”¨ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä»€ä¹ˆæ˜¯äº‹ä»¶å¾ªç¯ã€‚Node.js ä½¿ç”¨äº‹ä»¶å¾ªç¯æ¥å¤„ç†å¼‚æ­¥æ“ä½œã€‚äº‹ä»¶å¾ªç¯å…è®¸ Node.js æ‰§è¡Œéé˜»å¡ I/O æ“ä½œï¼ˆå³ä½¿åœ¨èƒŒåå®ƒä½¿ç”¨äº†å‡ ä¹å…¨æ˜¯é˜»å¡çš„ç³»ç»Ÿè°ƒç”¨ï¼‰â€” ä¾‹å¦‚è¯»å–ç½‘ç»œå†…å®¹ã€è®¿é—®æ•°æ®åº“æˆ–æ–‡ä»¶ç³»ç»Ÿç­‰ï¼Œè€Œæ— éœ€ç­‰å¾…å®ƒä»¬å®Œæˆï¼Œç„¶åå†è¿›è¡Œä¸‹ä¸€é¡¹ä»»åŠ¡ã€‚</p><p>å½“ä½ æŠŠå‡½æ•°æ”¾åˆ°<code>setImmediate()</code>é‡Œï¼Œä½ å‘Šè¯‰ Node.jsï¼š&quot;å˜¿ï¼Œå°½ç®¡æˆ‘ç°åœ¨æœ‰å…¶ä»–ä»£ç æ­£åœ¨è¿è¡Œï¼Œä½†ä¸€æ—¦ä½ å®Œæˆäº†å½“å‰çš„å·¥ä½œï¼Œè¯·å°½å¿«è¿è¡Œè¿™ä¸ªå‡½æ•°ã€‚&quot;</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-1"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><h4 id="ç¤ºä¾‹-1-åŸºæœ¬ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åŸºæœ¬ä½¿ç”¨"><span>ç¤ºä¾‹ 1ï¼šåŸºæœ¬ä½¿ç”¨</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œéœ€è¦åœ¨å®Œæˆä¸€ç³»åˆ—åˆå§‹åŒ–ä»»åŠ¡åç«‹å³å¼€å§‹å¤„ç†æ•°æ®ï¼Œä½†æ˜¯ä¸æƒ³é˜»å¡åç»­çš„ I/O æ“ä½œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å¼€å§‹æ‰§è¡Œ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">setImmediate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç«‹åˆ»æ‰§è¡Œçš„å›è°ƒ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ‰§è¡Œç»“æŸ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡ºé¡ºåºå°†æ˜¯ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>å¼€å§‹æ‰§è¡Œ</span></span>
<span class="line"><span>æ‰§è¡Œç»“æŸ</span></span>
<span class="line"><span>ç«‹åˆ»æ‰§è¡Œçš„å›è°ƒ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å³ä½¿<code>setImmediate()</code>è¢«è°ƒç”¨æ—¶å¤„äºä»£ç ä¸­é—´ä½ç½®ï¼Œå›è°ƒå‡½æ•°ä¹Ÿä¼šç­‰åˆ°å½“å‰äº‹ä»¶å¾ªç¯ç»“æŸåæ‰æ‰§è¡Œã€‚</p><h4 id="ç¤ºä¾‹-2-ä¸-settimeout-å¯¹æ¯”" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä¸-settimeout-å¯¹æ¯”"><span>ç¤ºä¾‹ 2ï¼šä¸ setTimeout å¯¹æ¯”</span></a></h4><p>ç†è§£<code>setImmediate()</code>å’Œ<code>setTimeout(fn, 0)</code>ä¹‹é—´çš„å·®å¼‚ä¹Ÿå¾ˆé‡è¦ï¼Œåè€…æ˜¯å¦ä¸€ç§å°è¯•ç«‹å³æ‰§è¡Œä»£ç çš„æ–¹å¼ã€‚è™½ç„¶ä¸¤è€…çœ‹èµ·æ¥ç›¸ä¼¼ï¼Œä½†å®ƒä»¬åœ¨äº‹ä»¶å¾ªç¯ä¸­çš„å…·ä½“æ‰§è¡Œæ—¶æœºæœ‰æ‰€ä¸åŒã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">setImmediate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">setImmediate æ‰§è¡Œ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">setTimeout æ‰§è¡Œ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 0</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™ä¸¤ä¸ªè°ƒç”¨çš„æ‰§è¡Œé¡ºåºæ˜¯ä¸ç¡®å®šçš„ï¼Œå–å†³äºå®ƒä»¬è¢«è°ƒåº¦åˆ°äº‹ä»¶å¾ªç¯ä¸­çš„å…·ä½“æ—¶æœºã€‚ä½†é€šå¸¸ï¼Œå®ƒä»¬éƒ½ä¼šåœ¨å½“å‰æ‰§è¡Œæ ˆæ¸…ç©ºåå°½å¿«æ‰§è¡Œã€‚</p><h3 id="æ€»ç»“-4" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-4"><span>æ€»ç»“</span></a></h3><p><code>setImmediate()</code>æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œç”¨äºç¡®ä¿å‡½æ•°èƒ½å¤Ÿåœ¨å½“å‰äº‹ä»¶å¾ªç¯ç»“æŸåã€ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯å¼€å§‹ä¹‹å‰å°½å¿«æ‰§è¡Œã€‚è¿™å¯¹äºéœ€è¦ä¼˜åŒ–å’Œæ§åˆ¶å¼‚æ­¥æ“ä½œæ‰§è¡Œé¡ºåºçš„åœºæ™¯ç‰¹åˆ«æœ‰ç”¨ã€‚</p><h3 id="setinterval-callback-delay-args" tabindex="-1"><a class="header-anchor" href="#setinterval-callback-delay-args"><span><a href="https://nodejs.org/docs/latest/api/timers.html#setintervalcallback-delay-args" target="_blank" rel="noopener noreferrer">setInterval(callback[, delay[, ...args]])</a></span></a></h3><p>å½“ç„¶ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥è§£æ<code>setInterval(callback[, delay[, ...args]])</code>è¿™ä¸ªæ–¹æ³•ï¼Œåœ¨ Node.js ä¸­çš„ç”¨æ³•å’Œå®ƒçš„å®é™…åº”ç”¨åœºæ™¯ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>é¦–å…ˆï¼Œ<code>setInterval</code>æ˜¯ä¸€ä¸ª JavaScript å‡½æ•°ï¼Œç”¨äºè®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå®ƒä¼šæŒ‰ç…§æŒ‡å®šçš„æ—¶é—´é—´éš”(<code>delay</code>)é‡å¤è°ƒç”¨æŸä¸ªå‡½æ•°(<code>callback</code>)ã€‚è¿™ä¸ªæ–¹æ³•åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹å¸¸ç”¨äºæ›´æ–° UIï¼ˆæ¯”å¦‚å€’è®¡æ—¶æ˜¾ç¤ºï¼‰ï¼Œè€Œåœ¨ Node.js ä¸­ï¼Œå®ƒå¯ä»¥ç”¨äºä»»ä½•éœ€è¦å‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡çš„åœºæ™¯ã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>callback</code>ï¼šè¿™æ˜¯æ‚¨å¸Œæœ›å‘¨æœŸæ€§æ‰§è¡Œçš„å‡½æ•°ã€‚</li><li><code>delay</code>ï¼šæ—¶é—´é—´éš”ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚è¿™å®šä¹‰äº†<code>callback</code>å‡½æ•°è°ƒç”¨ä¹‹é—´çš„æ—¶é—´ã€‚å¦‚æœçœç•¥ï¼Œæˆ–è€…æä¾›çš„å€¼å°äºç­‰äº 0ï¼Œé‚£ä¹ˆé»˜è®¤å€¼ä¼šè¢«è®¾ä¸º 1ï¼Œæ„å‘³ç€å›è°ƒå°½å¯èƒ½é¢‘ç¹åœ°æ‰§è¡Œã€‚</li><li><code>...args</code>ï¼šè¿™æ˜¯ä¼ é€’ç»™<code>callback</code>å‡½æ•°çš„å¯é€‰å‚æ•°åˆ—è¡¨ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-3"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>è®©æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªç®€å•ä½†å®ç”¨çš„ä¾‹å­ï¼š</p><h4 id="ä¾‹å­-1-ç®€å•å€’è®¡æ—¶" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-ç®€å•å€’è®¡æ—¶"><span>ä¾‹å­ 1: ç®€å•å€’è®¡æ—¶</span></a></h4><p>å‡è®¾ä½ æƒ³åœ¨æ§åˆ¶å°ä¸Šå®ç°ä¸€ä¸ªç®€å•çš„ 10 ç§’å€’è®¡æ—¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> counter</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 10</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> countdown</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setInterval</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">counter</span><span style="color:#81A1C1;"> +</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;"> seconds remaining</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    counter</span><span style="color:#81A1C1;">--;</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">counter</span><span style="color:#ECEFF4;"> `</span><span style="color:#A3BE8C;">&lt;</span><span style="color:#ECEFF4;">`</span><span style="color:#B48EAD;"> 0</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#88C0D0;">        clearInterval</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">countdown</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Countdown finished!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 1000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸º<code>countdown</code>çš„å®šæ—¶å™¨ï¼Œæ¯ 1000 æ¯«ç§’ï¼ˆ1 ç§’ï¼‰æ‰“å°å‰©ä½™æ—¶é—´ï¼Œå¹¶ä¸”æ¯æ¬¡æ‰“å°åå‡å°‘è®¡æ•°å™¨ã€‚å½“è®¡æ•°å™¨ä½äº 0 æ—¶ï¼Œæˆ‘ä»¬ç”¨<code>clearInterval</code>åœæ­¢å®šæ—¶å™¨ï¼Œå¹¶æ‰“å°â€œCountdown finished!â€ã€‚</p><h4 id="ä¾‹å­-2-å®šæœŸæ£€æŸ¥æ–‡ä»¶å˜åŒ–" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-å®šæœŸæ£€æŸ¥æ–‡ä»¶å˜åŒ–"><span>ä¾‹å­ 2: å®šæœŸæ£€æŸ¥æ–‡ä»¶å˜åŒ–</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç¨‹åºï¼Œéœ€è¦æ¯ 5 ç§’æ£€æŸ¥ä¸€æ¬¡ç‰¹å®šæ–‡ä»¶çš„å˜åŒ–ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">setInterval</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      return;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filePath</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> last modified at: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mtime</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 5000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>fs.stat</code>æ¥è·å–æ–‡ä»¶çŠ¶æ€ï¼Œå¹¶æ‰“å°å…¶æœ€åä¿®æ”¹æ—¶é—´ã€‚é€šè¿‡<code>setInterval</code>ï¼Œæˆ‘ä»¬æ¯ 5 ç§’æ‰§è¡Œä¸€æ¬¡è¿™ä¸ªæ“ä½œã€‚</p><h3 id="æ³¨æ„äº‹é¡¹" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>ä½¿ç”¨<code>setInterval</code>æ—¶è¦æ³¨æ„å†…å­˜æ³„æ¼é—®é¢˜ï¼Œç¡®ä¿åœ¨ä¸å†éœ€è¦å®šæ—¶å™¨æ—¶ç”¨<code>clearInterval</code>æ¸…é™¤ã€‚</li><li>å¯¹äº<code>delay</code>å‚æ•°ï¼Œè™½ç„¶æŒ‡å®šçš„æ˜¯æ¯«ç§’æ•°ï¼Œä½†å®é™…æ‰§è¡Œé—´éš”å¯èƒ½ä¼šæœ‰å¾®å°çš„å·®å¼‚ï¼Œå› ä¸º Node.js çš„äº‹ä»¶å¾ªç¯å’Œå…¶ä»–ç³»ç»Ÿæ´»åŠ¨å¯èƒ½ä¼šå½±å“å®šæ—¶ç²¾åº¦ã€‚</li></ul><p>ä»¥ä¸Šå°±æ˜¯å…³äº<code>setInterval</code>çš„ä¸€ä¸ªç®€å•ä»‹ç»åŠå…¶åœ¨ Node.js ä¸­çš„å‡ ä¸ªå®ç”¨ä¾‹å­ï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼</p><h3 id="settimeout-callback-delay-args" tabindex="-1"><a class="header-anchor" href="#settimeout-callback-delay-args"><span><a href="https://nodejs.org/docs/latest/api/timers.html#settimeoutcallback-delay-args" target="_blank" rel="noopener noreferrer">setTimeout(callback[, delay[, ...args]])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬ä»åŸºç¡€å¼€å§‹è®²è§£ <code>setTimeout(callback[, delay[, ...args]])</code> å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯åœ¨ Node.js ä¸­éå¸¸å¸¸ç”¨çš„ä¸€ä¸ªåŠŸèƒ½ï¼ŒåŒæ ·ä¹Ÿåœ¨æµè§ˆå™¨çš„ JavaScript ä¸­å¹¿æ³›ä½¿ç”¨ã€‚</p><h3 id="settimeout-çš„ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#settimeout-çš„ä½œç”¨"><span><strong>setTimeout çš„ä½œç”¨</strong></span></a></h3><p>ç®€å•æ¥è¯´ï¼Œ<code>setTimeout</code> æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œå®ƒå…è®¸ä½ è®¾å®šä¸€ä¸ªå›è°ƒå‡½æ•°ï¼ˆcallbackï¼‰ï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯åœ¨ä½ æŒ‡å®šçš„å»¶è¿Ÿæ—¶é—´åæ‰§è¡Œã€‚è¿™ä¸ªç‰¹æ€§è®©ä½ å¯ä»¥å®‰æ’ä¸€äº›ä»»åŠ¡åœ¨å°†æ¥çš„æŸä¸ªæ—¶åˆ»è¿è¡Œï¼Œè€Œä¸ä¼šé˜»å¡ä»£ç å½“å‰çš„æ‰§è¡Œæµç¨‹ã€‚</p><h3 id="åŸºæœ¬è¯­æ³•" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬è¯­æ³•"><span><strong>åŸºæœ¬è¯­æ³•</strong></span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// ì´ ë¬¸ì„œëŠ” ì‰ì°¨ì˜¤ ì°¨(Ying Chao Tea)ì—ì„œ ì˜¨ ê²ƒì…ë‹ˆë‹¤. ìƒì—…ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ë§ˆì‹­ì‹œì˜¤.</span></span>
<span class="line"><span style="color:#88C0D0;">setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">callback</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> delay</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> ...</span><span style="color:#D8DEE9;">args</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>callback</code>: è¿™æ˜¯å½“è®¡æ—¶å™¨åˆ°æ—¶é—´åè¦æ‰§è¡Œçš„å‡½æ•°ã€‚</li><li><code>delay</code>: å»¶è¿Ÿçš„æ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚å¦‚æœçœç•¥æˆ–è€…æä¾›éæ­£æ•°å€¼ï¼Œå°†é»˜è®¤ä¸º 0ã€‚</li><li><code>...args</code>: åœ¨è°ƒç”¨å›è°ƒå‡½æ•°æ—¶ä¼ é€’ç»™å®ƒçš„é¢å¤–å‚æ•°ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-1"><span><strong>å®é™…è¿ç”¨çš„ä¾‹å­</strong></span></a></h3><h4 id="ä¾‹å­-1-åŸºç¡€ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-åŸºç¡€ä½¿ç”¨"><span><strong>ä¾‹å­ 1: åŸºç¡€ä½¿ç”¨</strong></span></a></h4><p>å‡è®¾ä½ å¸Œæœ›æ˜¾ç¤ºä¸€ä¸ªæ¶ˆæ¯ï¼Œä½†è¦åœ¨ç”¨æˆ·åŠ è½½é¡µé¢åçš„ 2 ç§’é’Ÿæ‰å‡ºç°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ¡æ¶ˆæ¯ä¼šåœ¨2ç§’åæ˜¾ç¤º</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 2000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼ˆArrow functionï¼‰ï¼Œå®ƒåœ¨ 2 ç§’åæ‰§è¡Œï¼Œå¹¶æ‰“å°å‡ºä¸€æ®µæ¶ˆæ¯ã€‚</p><h4 id="ä¾‹å­-2-ä½¿ç”¨é¢å¤–çš„å‚æ•°" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ä½¿ç”¨é¢å¤–çš„å‚æ•°"><span><strong>ä¾‹å­ 2: ä½¿ç”¨é¢å¤–çš„å‚æ•°</strong></span></a></h4><p>ä½ å¯èƒ½éœ€è¦åœ¨å›è°ƒä¸­ä½¿ç”¨ä¸€äº›é¢å¤–çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œä½ æƒ³åœ¨å»¶è¿Ÿåä¸ä»…æ‰“å°æ¶ˆæ¯è¿˜è¦æŒ‡æ˜æ˜¯å“ªä¸ªç”¨æˆ·çš„æ¶ˆæ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">setTimeout</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#D8DEE9;">user</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">user</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">çš„æ¶ˆæ¯</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span></span>
<span class="line"><span style="color:#B48EAD;">  3000</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">Alice</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åœ¨ 3 ç§’åæ‰“å°å‡ºâ€œ<code>Aliceçš„æ¶ˆæ¯</code>â€ã€‚&#39;Alice&#39;è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯ä½œä¸ºé¢å¤–çš„å‚æ•°ä¼ é€’ç»™<code>setTimeout</code>çš„ï¼Œç„¶åè¢«å›è°ƒå‡½æ•°æ¥æ”¶å’Œä½¿ç”¨ã€‚</p><h4 id="ä¾‹å­-3-å–æ¶ˆ-settimeout" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-3-å–æ¶ˆ-settimeout"><span><strong>ä¾‹å­ 3: å–æ¶ˆ setTimeout</strong></span></a></h4><p>æœ‰æ—¶å€™ï¼Œä½ è®¾ç½®çš„å»¶æ—¶æ“ä½œå¯èƒ½ä¸å†éœ€è¦æ‰§è¡Œï¼Œè¿™æ—¶ä½ å¯ä»¥å–æ¶ˆå®ƒã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> timerId</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ¡æ¶ˆæ¯ä¸ä¼šæ˜¾ç¤º</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 4000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å–æ¶ˆ setTimeout</span></span>
<span class="line"><span style="color:#88C0D0;">clearTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">timerId</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡ä¿å­˜<code>setTimeout</code>è¿”å›çš„æ ‡è¯†ç¬¦ï¼ˆ<code>timerId</code>ï¼‰, ç„¶åä½¿ç”¨<code>clearTimeout</code>å‡½æ•°å¹¶ä¼ é€’è¿™ä¸ªæ ‡è¯†ç¬¦æ¥å–æ¶ˆå®ƒã€‚å› æ­¤ï¼Œä¸Šé¢çš„å›è°ƒå‡½æ•°æ°¸è¿œä¸ä¼šè¢«è°ƒç”¨ã€‚</p><h3 id="æ€»ç»“-5" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-5"><span><strong>æ€»ç»“</strong></span></a></h3><p><code>setTimeout</code> æ˜¯å¤„ç†å¼‚æ­¥æ“ä½œã€å»¶è¿Ÿä»»åŠ¡æˆ–ç®€å•çš„è®¡æ—¶éœ€æ±‚æ—¶éå¸¸å®ç”¨çš„å·¥å…·ã€‚ç†è§£å®ƒå¦‚ä½•å·¥ä½œä»¥åŠå¦‚ä½•åœ¨å®è·µä¸­åº”ç”¨å®ƒï¼Œå¯¹äºä»»ä½•å­¦ä¹  Node.js æˆ–å‰ç«¯å¼€å‘çš„äººæ¥è¯´éƒ½æ˜¯éå¸¸æœ‰ä»·å€¼çš„ã€‚é€šè¿‡ä¸Šè¿°ç¤ºä¾‹ï¼Œä½ åº”è¯¥èƒ½å¤Ÿå¼€å§‹åœ¨ä½ è‡ªå·±çš„é¡¹ç›®ä¸­ä½¿ç”¨ <code>setTimeout</code> äº†ã€‚</p><h2 id="cancelling-timers" tabindex="-1"><a class="header-anchor" href="#cancelling-timers"><span><a href="https://nodejs.org/docs/latest/api/timers.html#cancelling-timers" target="_blank" rel="noopener noreferrer">Cancelling timers</a></span></a></h2><p>åœ¨ Node.js ä¸­ï¼Œè®¡æ—¶å™¨æ˜¯æˆ‘ä»¬ç”¨æ¥åœ¨å°†æ¥çš„æŸä¸ªæ—¶é—´ç‚¹æ‰§è¡Œä»£ç çš„æœºåˆ¶ã€‚Node.js æä¾›äº†å‡ ç§è®¾ç½®å®šæ—¶ä»»åŠ¡çš„å‡½æ•°ï¼Œå¦‚ <code>setTimeout</code>, <code>setInterval</code>, å’Œ <code>setImmediate</code>ã€‚ä½†æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½åœ¨è®¾å®šçš„æ—¶é—´åˆ°æ¥ä¹‹å‰å°±ä¸å†éœ€è¦æ‰§è¡Œè¿™äº›ä»»åŠ¡äº†ï¼Œè¿™æ—¶å€™å–æ¶ˆè®¡æ—¶å™¨å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚</p><h3 id="å–æ¶ˆè®¡æ—¶å™¨çš„æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#å–æ¶ˆè®¡æ—¶å™¨çš„æ–¹æ³•"><span>å–æ¶ˆè®¡æ—¶å™¨çš„æ–¹æ³•</span></a></h3><ol><li><strong>clearTimeout</strong> - ç”¨æ¥å–æ¶ˆç”± <code>setTimeout()</code> è®¾ç½®çš„å®šæ—¶å™¨ã€‚</li><li><strong>clearInterval</strong> - ç”¨æ¥å–æ¶ˆç”± <code>setInterval()</code> è®¾ç½®çš„å®šæ—¶å™¨ã€‚</li><li><strong>clearImmediate</strong> - ç”¨æ¥å–æ¶ˆç”± <code>setImmediate()</code> è®¾ç½®çš„ç«‹å³æ‰§è¡Œå‡½æ•°ã€‚</li></ol><h3 id="ä½¿ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­"><span>ä½¿ç”¨ä¾‹å­</span></a></h3><h4 id="_1-å–æ¶ˆ-settimeout" tabindex="-1"><a class="header-anchor" href="#_1-å–æ¶ˆ-settimeout"><span>1. å–æ¶ˆ setTimeout</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// è®¾ç½®ä¸€ä¸ª setTimeout è®¡æ—¶å™¨</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> timerId</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ¡æ¶ˆæ¯ä¸ä¼šè¢«æ‰“å°</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 1000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å–æ¶ˆ setTimeout</span></span>
<span class="line"><span style="color:#88C0D0;">clearTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">timerId</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨ <code>setTimeout</code> å‡½æ•°è®¾ç½®äº†ä¸€ä¸ªå»¶è¿Ÿ 1 ç§’æ‰§è¡Œçš„å®šæ—¶ä»»åŠ¡ï¼Œä½†ç´§æ¥ç€æˆ‘ä»¬è°ƒç”¨äº† <code>clearTimeout</code> å¹¶ä¼ å…¥äº† <code>setTimeout</code> è¿”å›çš„æ ‡è¯†ç¬¦ï¼ˆtimerIdï¼‰ï¼Œè¿™æ ·åŸæœ¬ 1 ç§’åè¦æ‰§è¡Œçš„ä»£ç å°±ä¸ä¼šè¢«æ‰§è¡Œäº†ã€‚</p><h4 id="_2-å–æ¶ˆ-setinterval" tabindex="-1"><a class="header-anchor" href="#_2-å–æ¶ˆ-setinterval"><span>2. å–æ¶ˆ setInterval</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// è®¾ç½®ä¸€ä¸ªæ¯ç§’é‡å¤æ‰§è¡Œçš„å‡½æ•°</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> counter</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> intervalId</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setInterval</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> ++</span><span style="color:#D8DEE9;">counter</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 1000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 3ç§’åå–æ¶ˆè¿™ä¸ª setInterval</span></span>
<span class="line"><span style="color:#88C0D0;">setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">  clearInterval</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">intervalId</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 3000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>setInterval</code> è®¾ç½®äº†ä¸€ä¸ªæ¯ 1 ç§’æ‰§è¡Œä¸€æ¬¡çš„å®šæ—¶ä»»åŠ¡ï¼Œé€šè¿‡ <code>setInterval</code> è¿”å›çš„ IDï¼ˆintervalIdï¼‰å¯ä»¥åœ¨å°†æ¥æŸä¸ªæ—¶é—´ç‚¹å–æ¶ˆè¿™ä¸ªå®šæ—¶ä»»åŠ¡ã€‚æˆ‘ä»¬é€šè¿‡å¦ä¸€ä¸ª <code>setTimeout</code> è®¾ç½®äº† 3 ç§’åå–æ¶ˆè¿™ä¸ªå¾ªç¯çš„å®šæ—¶å™¨ã€‚å› æ­¤ï¼Œ&quot;Hello&quot; æ¶ˆæ¯å°†åªä¼šè¢«æ‰“å°ä¸‰æ¬¡ã€‚</p><h4 id="_3-å–æ¶ˆ-setimmediate" tabindex="-1"><a class="header-anchor" href="#_3-å–æ¶ˆ-setimmediate"><span>3. å–æ¶ˆ setImmediate</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// è®¾ç½®ä¸€ä¸ªç«‹å³æ‰§è¡Œçš„å‡½æ•°</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> immediateId</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setImmediate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ¡æ¶ˆæ¯ä¸ä¼šè¢«æ‰“å°</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å–æ¶ˆç«‹å³æ‰§è¡Œçš„å‡½æ•°</span></span>
<span class="line"><span style="color:#88C0D0;">clearImmediate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">immediateId</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>setImmediate</code> è®¾ç½®ä¸€ä¸ªç«‹å³æ‰§è¡Œçš„ä»»åŠ¡ï¼Œç„¶åç«‹åˆ»ä½¿ç”¨ <code>clearImmediate</code> è¿›è¡Œå–æ¶ˆã€‚ç”±äºå–æ¶ˆåŠ¨ä½œå‘ç”Ÿåœ¨ä»»ä½• I/O äº‹ä»¶ï¼ˆæ¯”å¦‚æ–‡ä»¶è¯»å†™ã€ç½‘ç»œé€šä¿¡ç­‰ï¼‰ä¹‹å‰ï¼Œæ‰€ä»¥è¿™ä¸ªç«‹å³æ‰§è¡Œçš„å‡½æ•°æ ¹æœ¬ä¸ä¼šå¾—åˆ°æ‰§è¡Œã€‚</p><h3 id="å°ç»“-3" tabindex="-1"><a class="header-anchor" href="#å°ç»“-3"><span>å°ç»“</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦åœ¨ä»£ç ä¸­è®¾ç½®å®šæ—¶ä»»åŠ¡æ¥å»¶è¿Ÿä»£ç æ‰§è¡Œæˆ–è€…å‘¨æœŸæ€§åœ°æ‰§è¡ŒæŸäº›æ“ä½œã€‚ä¸è¿‡ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå½“åŸæœ¬çš„é€»è¾‘éœ€æ±‚å˜æ›´ï¼Œæˆ–è€…ä¸æƒ³è®©æŸäº›æ“ä½œæ‰§è¡Œæ—¶ï¼Œå–æ¶ˆè¿™äº›å®šæ—¶å™¨å°±æ˜¾å¾—éå¸¸é‡è¦ã€‚é€šè¿‡ä½¿ç”¨ <code>clearTimeout</code>, <code>clearInterval</code>, æˆ– <code>clearImmediate</code> æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰æ•ˆåœ°æ§åˆ¶è¿™äº›å®šæ—¶ä»»åŠ¡çš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™å¯¹äºå†…å­˜ç®¡ç†å’Œé¿å…ä¸å¿…è¦çš„æ“ä½œæ˜¯éå¸¸æœ‰ç›Šå¤„çš„ï¼Œå°¤å…¶æ˜¯åœ¨æ¶‰åŠå¤§é‡å®šæ—¶å™¨æˆ–å¤æ‚é€»è¾‘çš„åº”ç”¨ç¨‹åºä¸­ã€‚</p><h3 id="clearimmediate-immediate" tabindex="-1"><a class="header-anchor" href="#clearimmediate-immediate"><span><a href="https://nodejs.org/docs/latest/api/timers.html#clearimmediateimmediate" target="_blank" rel="noopener noreferrer">clearImmediate(immediate)</a></span></a></h3><p>Node.js ä¸­çš„<code>clearImmediate(immediate)</code>æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„å‡½æ•°ï¼Œå®ƒå±äº Node.js çš„å®šæ—¶å™¨åŠŸèƒ½ä¹‹ä¸€ã€‚è¦ç†è§£<code>clearImmediate(immediate)</code>ï¼Œæˆ‘ä»¬å…ˆå¾—çŸ¥é“ä»€ä¹ˆæ˜¯<code>setImmediate(callback, [...args])</code>ã€‚</p><h3 id="setimmediate-callback-args-1" tabindex="-1"><a class="header-anchor" href="#setimmediate-callback-args-1"><span><code>setImmediate(callback, [...args])</code></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œå½“ä½ æƒ³è¦å®‰æ’ä¸€ä¸ªä»»åŠ¡åœ¨å½“å‰äº‹ä»¶å¾ªç¯å‘¨æœŸå®Œæˆåç«‹å³æ‰§è¡Œï¼Œä½†æ˜¯ä¸æƒ³ç­‰å¾…ä¸‹ä¸ªäº‹ä»¶å¾ªç¯å‘¨æœŸï¼Œä½ å¯ä»¥ä½¿ç”¨<code>setImmediate()</code>å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå¹¶ä¸”å¯ä»¥ä¼ é€’é¢å¤–çš„å‚æ•°ç»™è¿™ä¸ªå›è°ƒå‡½æ•°ã€‚ä¸€æ—¦å½“å‰äº‹ä»¶å¾ªç¯å‘¨æœŸå®Œæˆï¼ŒNode.js ä¼šå°½å¿«æ‰§è¡Œè¿™ä¸ªå›è°ƒå‡½æ•°ã€‚</p><p>ä¾‹å¦‚ï¼Œä½ å¯èƒ½æœ‰ä¸€ä¸ªæœåŠ¡å™¨å¤„ç†æŸä¸ªè¯·æ±‚ï¼Œå¹¶ä¸”åœ¨å“åº”å‘é€å‰ï¼Œä½ æƒ³å¼‚æ­¥è®°å½•ä¸€äº›æ—¥å¿—ä¿¡æ¯è€Œä¸é˜»å¡å½“å‰çš„æ“ä½œï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">setImmediate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å¼‚æ­¥æ‰§è¡Œæ—¥å¿—è®°å½•</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯·æ±‚å¤„ç†ä¸­...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¸­ï¼Œå³ä½¿æ—¥å¿—è®°å½•çš„ä»£ç å†™åœ¨å¤„ç†è¯·æ±‚çš„è¯­å¥ä¹‹åï¼Œç”±äºå®ƒè¢«åŒ…è£¹åœ¨<code>setImmediate()</code>é‡Œï¼Œå®é™…ä¸Šå®ƒä¼šåœ¨æ‰€æœ‰åŒæ­¥ä»»åŠ¡å®Œæˆåæ‰æ‰§è¡Œã€‚</p><h3 id="clearimmediate-immediate-1" tabindex="-1"><a class="header-anchor" href="#clearimmediate-immediate-1"><span><code>clearImmediate(immediate)</code></span></a></h3><p>ç°åœ¨ï¼Œå‡è®¾åœ¨æŸç§æƒ…å†µä¸‹ï¼Œä½ å†³å®šåœ¨<code>setImmediate()</code>æŒ‡å®šçš„ä»»åŠ¡æ‰§è¡Œå‰å–æ¶ˆè¿™ä¸ªå³å°†æ‰§è¡Œçš„æ“ä½œã€‚è¿™æ­£æ˜¯<code>clearImmediate(immediate)</code>å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚å®ƒå–æ¶ˆäº†ç”±<code>setImmediate()</code>æ–¹æ³•è®¾ç½®çš„æ“ä½œã€‚</p><p><code>clearImmediate()</code>æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°æ˜¯<code>setImmediate()</code>è¿”å›çš„ Immediate å¯¹è±¡ã€‚</p><p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­è¯´æ˜å¦‚ä½•ä½¿ç”¨<code>clearImmediate()</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> immediateId</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setImmediate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ®µä»£ç ä¸ä¼šæ‰§è¡Œ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å–æ¶ˆåˆšæ‰è®¾ç½®çš„ç«‹å³æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#88C0D0;">clearImmediate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">immediateId</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å…¶ä»–ä»£ç ç»§ç»­æ‰§è¡Œ...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨<code>setImmediate()</code>è®¡åˆ’äº†ä¸€ä¸ªä»»åŠ¡ï¼Œç„¶åç«‹å³ä½¿ç”¨<code>clearImmediate()</code>å–æ¶ˆäº†å®ƒã€‚å› æ­¤ï¼Œé‚£æ®µæ‰“å°ä¿¡æ¯çš„ä»£ç æ°¸è¿œä¸ä¼šæ‰§è¡Œã€‚è€Œç¨‹åºä¼šç»§ç»­æ‰§è¡Œ<code>clearImmediate()</code>åé¢çš„ä»£ç ã€‚</p><h3 id="å®é™…è¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨åœºæ™¯"><span>å®é™…è¿ç”¨åœºæ™¯</span></a></h3><p><code>clearImmediate()</code>çš„å®é™…ä½¿ç”¨åœºæ™¯å¯èƒ½ç›¸å¯¹è¾ƒå°‘ï¼Œä½†å®ƒåœ¨éœ€è¦å–æ¶ˆå·²å®‰æ’çš„ç«‹å³ä»»åŠ¡æ—¶éå¸¸æœ‰ç”¨ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸€ä¸ªå¤æ‚çš„é€»è¾‘æµä¸­ï¼Œå¦‚æœæ ¹æ®æŸäº›æ¡ä»¶åˆ¤å®šä¸å†éœ€è¦æ‰§è¡ŒæŸä¸ªé¢„å®šç«‹å³æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨<code>clearImmediate()</code>æ¥é¿å…ä¸å¿…è¦çš„æ“ä½œï¼Œä»è€Œä¼˜åŒ–ç¨‹åºæ€§èƒ½å’Œèµ„æºåˆ©ç”¨ã€‚</p><p>æ€»ç»“èµ·æ¥ï¼Œ<code>clearImmediate(immediate)</code>æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œå…è®¸å¼€å‘è€…æœ‰æ›´ç²¾ç»†çš„æ§åˆ¶æƒï¼Œä»¥ä¾¿äºç®¡ç†å’Œå–æ¶ˆé‚£äº›å·²ç»å®‰æ’åœ¨äº‹ä»¶å¾ªç¯ä¸­çš„ä»»åŠ¡ã€‚å°½ç®¡å…¶ä½¿ç”¨åœºæ™¯å¯èƒ½ä¸å¦‚å…¶ä»–å®šæ—¶å™¨å‡½æ•°å¹¿æ³›ï¼Œä½†å®ƒåœ¨ç‰¹å®šæƒ…å†µä¸‹ä¾ç„¶æ˜¯ä¸€ä¸ªéå¸¸æœ‰ä»·å€¼çš„å·¥å…·ã€‚</p><h3 id="clearinterval-timeout" tabindex="-1"><a class="header-anchor" href="#clearinterval-timeout"><span><a href="https://nodejs.org/docs/latest/api/timers.html#clearintervaltimeout" target="_blank" rel="noopener noreferrer">clearInterval(timeout)</a></span></a></h3><p>Node.js ä¸­çš„<code>clearInterval(timeout)</code>æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºåœæ­¢ç”±<code>setInterval()</code>è®¾ç½®çš„å‘¨æœŸæ€§æ‰§è¡Œæ“ä½œã€‚å½“ä½ ä½¿ç”¨<code>setInterval()</code>æ—¶ï¼Œå®ƒä¼šå®šæœŸï¼ˆæŒ‰ç…§æŒ‡å®šçš„æ—¶é—´é—´éš”ï¼‰æ‰§è¡ŒæŒ‡å®šçš„å‡½æ•°ã€‚å¦‚æœåœ¨æŸä¸ªæ—¶åˆ»ä½ æƒ³åœæ­¢è¿™ä¸ªå‘¨æœŸæ€§æ‰§è¡Œï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨<code>clearInterval()</code>ã€‚</p><h3 id="åŸºæœ¬åŸç†" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬åŸç†"><span>åŸºæœ¬åŸç†</span></a></h3><ul><li><strong><code>setInterval(function, interval)</code></strong>: æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä½ æƒ³è¦å‘¨æœŸæ€§æ‰§è¡Œçš„å‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ—¶é—´é—´éš”ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚è¿”å›ä¸€ä¸ªç‰¹æ®Šçš„æ ‡è¯†ç¬¦ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªæ•°å­—ï¼‰ï¼Œè¯¥æ ‡è¯†ç¬¦å¯ç”¨äºç¨åé€šè¿‡<code>clearInterval()</code>å–æ¶ˆå¾ªç¯ã€‚</li><li><strong><code>clearInterval(timeout)</code></strong>: æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œå³<code>setInterval()</code>è¿”å›çš„æ ‡è¯†ç¬¦ã€‚è°ƒç”¨åï¼Œä¸è¯¥æ ‡è¯†ç¬¦å…³è”çš„å‘¨æœŸæ€§æ‰§è¡Œå°†è¢«å–æ¶ˆã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-2"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><h4 id="ä¾‹å­-1-å®šæ—¶æé†’" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-å®šæ—¶æé†’"><span>ä¾‹å­ 1: å®šæ—¶æé†’</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨åˆ¶ä½œä¸€ä¸ªå­¦ä¹ åº”ç”¨ï¼Œä½ æƒ³æ¯éš”ä¸€å°æ—¶æé†’ç”¨æˆ·ä¼‘æ¯ä¸€ä¸‹çœ¼ç›ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// è®¾ç½®å®šæ—¶å™¨</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> restReminder</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setInterval</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯·ä¼‘æ¯ä¸€ä¸‹çœ¼ç›ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 3600000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ¯éš”ä¸€å°æ—¶æé†’ä¸€æ¬¡</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾ç”¨æˆ·è¿›å…¥äº†â€œä¸æ‰“æ‰°â€æ¨¡å¼ï¼Œæˆ‘ä»¬å¸Œæœ›åœæ­¢æé†’</span></span>
<span class="line"><span style="color:#88C0D0;">setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">  clearInterval</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">restReminder</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æé†’å·²åœæ­¢ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 10000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // 10ç§’ååœæ­¢æé†’</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨<code>setInterval()</code>è®¾ç½®äº†ä¸€ä¸ªæ¯å°æ—¶æé†’ç”¨æˆ·çš„è®¡æ—¶å™¨ã€‚ç„¶åï¼Œæˆ‘ä»¬å‡è®¾ç”¨æˆ·å¯ç”¨äº†æŸç§æ¨¡å¼ï¼ˆä¾‹å¦‚â€œä¸æ‰“æ‰°â€æ¨¡å¼ï¼‰ï¼Œéœ€è¦åœæ­¢æé†’ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨<code>setTimeout()</code>æ¥æ¨¡æ‹Ÿè¿™ä¸ªåœºæ™¯ï¼Œåœ¨ 10 ç§’åè°ƒç”¨<code>clearInterval()</code>æ¥åœæ­¢ä¹‹å‰è®¾ç½®çš„å‘¨æœŸæ€§æé†’ã€‚</p><h4 id="ä¾‹å­-2-ç½‘ç«™è½®æ’­å›¾è‡ªåŠ¨åˆ‡æ¢" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ç½‘ç«™è½®æ’­å›¾è‡ªåŠ¨åˆ‡æ¢"><span>ä¾‹å­ 2: ç½‘ç«™è½®æ’­å›¾è‡ªåŠ¨åˆ‡æ¢</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªç½‘ç«™ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªè½®æ’­å›¾ç»„ä»¶ã€‚ä½ å¸Œæœ›æ¯ 5 ç§’è‡ªåŠ¨åˆ‡æ¢åˆ°ä¸‹ä¸€å¼ å›¾ç‰‡ï¼Œä½†æ˜¯å½“ç”¨æˆ·å¼€å§‹æ‰‹åŠ¨åˆ‡æ¢å›¾ç‰‡æ—¶ï¼Œè‡ªåŠ¨åˆ‡æ¢å°±åº”è¯¥åœæ­¢ï¼Œä»¥é¿å…å¹²æ‰°ç”¨æˆ·ä½“éªŒã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> currentImageIndex</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> images</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">image1.jpg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">image2.jpg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">image3.jpg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">]</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è‡ªåŠ¨åˆ‡æ¢å›¾ç‰‡</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> imageRotator</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setInterval</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  currentImageIndex</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">currentImageIndex</span><span style="color:#81A1C1;"> +</span><span style="color:#B48EAD;"> 1</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">%</span><span style="color:#D8DEE9;"> images</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">length</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">å½“å‰å›¾ç‰‡: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">images</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9;">currentImageIndex</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 5000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ¨¡æ‹Ÿç”¨æˆ·å¼€å§‹æ‰‹åŠ¨åˆ‡æ¢å›¾ç‰‡</span></span>
<span class="line"><span style="color:#D8DEE9;">document</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getElementById</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">nextButton</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">addEventListener</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">click</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">  clearInterval</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">imageRotator</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å·²åœæ­¢è‡ªåŠ¨åˆ‡æ¢å›¾ç‰‡ï¼Œå› ä¸ºç”¨æˆ·å¼€å§‹æ‰‹åŠ¨åˆ‡æ¢ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>setInterval()</code>æ¥å®ç°å›¾ç‰‡çš„è‡ªåŠ¨åˆ‡æ¢ã€‚å½“ç”¨æˆ·ç‚¹å‡»â€œä¸‹ä¸€å¼ â€æŒ‰é’®æ—¶ï¼Œé€šè¿‡æ·»åŠ çš„äº‹ä»¶ç›‘å¬å™¨è°ƒç”¨<code>clearInterval(imageRotator)</code>æ¥åœæ­¢è‡ªåŠ¨åˆ‡æ¢ã€‚</p><p>é€šè¿‡ä»¥ä¸Šç¤ºä¾‹ï¼Œä½ åº”è¯¥èƒ½å¤Ÿçœ‹å‡º<code>setInterval()</code>å’Œ<code>clearInterval()</code>åœ¨ JavaScript å®šæ—¶ä»»åŠ¡ç®¡ç†ä¸­çš„é‡è¦æ€§ã€‚å®ƒä»¬ä¸ºå¼€å‘äººå‘˜æä¾›äº†æ§åˆ¶å®šæ—¶æ‰§è¡Œä»£ç çš„èƒ½åŠ›ï¼Œè¿™åœ¨åˆ›å»ºåŠ¨æ€äº¤äº‘å’Œæå‡ç”¨æˆ·ä½“éªŒæ–¹é¢æå…¶æœ‰ç”¨ã€‚</p><h3 id="cleartimeout-timeout" tabindex="-1"><a class="header-anchor" href="#cleartimeout-timeout"><span><a href="https://nodejs.org/docs/latest/api/timers.html#cleartimeouttimeout" target="_blank" rel="noopener noreferrer">clearTimeout(timeout)</a></span></a></h3><p>å½“ä½ åœ¨ä½¿ç”¨ Node.js å¼€å‘åº”ç”¨æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°éœ€è¦å»¶è¿Ÿæ‰§è¡ŒæŸäº›æ“ä½œçš„æƒ…å†µã€‚è¿™æ—¶å€™ï¼Œä½ å¯èƒ½ä¼šç”¨åˆ°<code>setTimeout</code>è¿™ä¸ªå‡½æ•°ï¼Œå®ƒå¯ä»¥è®©ä½ æŒ‡å®šä¸€ä¸ªå‡½æ•°åœ¨å¤šå°‘æ¯«ç§’åæ‰§è¡Œã€‚ç„¶è€Œï¼Œæœ‰æ—¶å€™åœ¨è¿™ä¸ªå»¶è¿Ÿç»“æŸä¹‹å‰ï¼Œä½ åˆæƒ³å–æ¶ˆè¿™ä¸ªå¾…æ‰§è¡Œçš„æ“ä½œï¼Œè¿™å°±æ˜¯<code>clearTimeout()</code>å‘æŒ¥ä½œç”¨çš„æ—¶åˆ»ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯cleartimeout-timeout" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯cleartimeout-timeout"><span>ä»€ä¹ˆæ˜¯<code>clearTimeout(timeout)</code>ï¼Ÿ</span></a></h3><p><code>clearTimeout()</code>æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå–æ¶ˆç”±<code>setTimeout()</code>åˆ›å»ºçš„ä¸€ä¸ªå»¶è¿Ÿæ‰§è¡Œçš„è®¡åˆ’ã€‚å½“ä½ è°ƒç”¨<code>setTimeout()</code>æ—¶ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ª<code>timeout</code>å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä»£è¡¨äº†é‚£ä¸ªå°†æ¥ä¼šæ‰§è¡Œçš„æ“ä½œã€‚å¦‚æœåœ¨æ“ä½œæ‰§è¡Œä¹‹å‰ä½ æ”¹å˜äº†ä¸»æ„ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªå¯¹è±¡ä½œä¸º<code>clearTimeout()</code>çš„å‚æ•°æ¥å–æ¶ˆå®ƒã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨cleartimeout-timeout" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨cleartimeout-timeout"><span>å¦‚ä½•ä½¿ç”¨<code>clearTimeout(timeout)</code>ï¼Ÿ</span></a></h3><p>é¦–å…ˆï¼Œä½ éœ€è¦è°ƒç”¨<code>setTimeout()</code>å¹¶è·å–å®ƒè¿”å›çš„<code>timeout</code>å¯¹è±¡ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// è®¾ç½®ä¸€ä¸ªå°†åœ¨3ç§’åæ‰§è¡Œçš„æ“ä½œ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> myTimeout</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ¡ä¿¡æ¯å°†ä¸ä¼šæ˜¾ç¤º</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 3000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœåœ¨ 3 ç§’å†…æƒ³å–æ¶ˆä¸Šé¢è®¾ç½®çš„æ“ä½œï¼Œå¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">clearTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">myTimeout</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>é€šè¿‡è°ƒç”¨<code>clearTimeout()</code>å¹¶ä¼ å…¥ä¹‹å‰ä»<code>setTimeout()</code>è·å¾—çš„<code>timeout</code>å¯¹è±¡ï¼Œå³å¯å–æ¶ˆè¯¥å»¶è¿Ÿæ‰§è¡Œçš„æ“ä½œã€‚æ­¤æ—¶ï¼Œ<code>setTimeout()</code>ä¸­è®¾ç½®çš„å‡½æ•°å°†ä¸ä¼šè¢«æ‰§è¡Œã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-4"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="ä¾‹å­-1-ç½‘ç»œè¯·æ±‚è¶…æ—¶å¤„ç†" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-ç½‘ç»œè¯·æ±‚è¶…æ—¶å¤„ç†"><span>ä¾‹å­ 1: ç½‘ç»œè¯·æ±‚è¶…æ—¶å¤„ç†</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç½‘ç«™åç«¯ï¼Œéœ€è¦å‘å¦ä¸€ä¸ªæœåŠ¡å‘é€ç½‘ç»œè¯·æ±‚ã€‚ä½†æ˜¯ï¼Œä½ å¸Œæœ›å¦‚æœè¯¥æœåŠ¡åœ¨ 5 ç§’å†…æ²¡æœ‰å“åº”ï¼Œå°±è‡ªåŠ¨å–æ¶ˆè¿™ä¸ªè¯·æ±‚ä»¥é¿å…è¿‡é•¿æ—¶é—´ç­‰å¾…ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> http</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">http</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è®°å½•`setTimeout()`çš„è¿”å›å€¼</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> timeoutId</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  request</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">abort</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å–æ¶ˆè¯·æ±‚</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯·æ±‚å·²è¶…æ—¶ï¼Œå¹¶è¢«å–æ¶ˆ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 5000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> request</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> http</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">get</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">http://example.com</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">response</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">    clearTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">timeoutId</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¯·æ±‚æˆåŠŸè¿”å›ï¼Œå–æ¶ˆè¶…æ—¶é€»è¾‘</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ”¶åˆ°å“åº”ï¼ŒçŠ¶æ€ç :</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> response</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">statusCode</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">error</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">e</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">    clearTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">timeoutId</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å‘ç”Ÿé”™è¯¯ï¼Œä¹Ÿå–æ¶ˆè¶…æ—¶é€»è¾‘</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">é‡åˆ°é”™è¯¯: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">e</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä¾‹å­-2-ç”¨æˆ·è¡Œä¸ºç­‰å¾…è¶…æ—¶" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ç”¨æˆ·è¡Œä¸ºç­‰å¾…è¶…æ—¶"><span>ä¾‹å­ 2: ç”¨æˆ·è¡Œä¸ºç­‰å¾…è¶…æ—¶</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨åˆ¶ä½œä¸€ä¸ªåœ¨çº¿æ¸¸æˆï¼Œç©å®¶å¿…é¡»åœ¨ 10 ç§’å†…åšå‡ºé€‰æ‹©ï¼Œå¦åˆ™é»˜è®¤æ”¾å¼ƒã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> playerDecisionTimeout</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æœªåœ¨è§„å®šæ—¶é—´å†…åšå‡ºé€‰æ‹©ï¼Œè§†ä¸ºæ”¾å¼ƒ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // æ‰§è¡Œç›¸å…³çš„æ”¾å¼ƒé€»è¾‘</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 10000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾è¿™é‡Œæ•è·åˆ°äº†ç©å®¶çš„é€‰æ‹©è¡Œä¸º</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> onPlayerMadeChoice</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">  clearTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">playerDecisionTimeout</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ¸…é™¤ç­‰å¾…è®¡æ—¶å™¨</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç©å®¶å·²åšå‡ºé€‰æ‹©</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // è¿›è¡Œä¸‹ä¸€æ­¥é€»è¾‘</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸¤ä¸ªä¾‹å­ä¸­ï¼Œ<code>clearTimeout()</code>éƒ½æ˜¯ç”¨æ¥é˜²æ­¢ä¸€æ®µä»£ç åœ¨æœªæ¥æŸä¸ªä¸å†éœ€è¦çš„æ—¶é—´ç‚¹æ‰§è¡Œã€‚è¿™æ ·èƒ½æœ‰æ•ˆåœ°ç®¡ç†èµ„æºå’Œé¿å…æ½œåœ¨çš„é”™è¯¯æˆ–ä¸å¿…è¦çš„æ“ä½œã€‚</p><h2 id="timers-promises-api" tabindex="-1"><a class="header-anchor" href="#timers-promises-api"><span><a href="https://nodejs.org/docs/latest/api/timers.html#timers-promises-api" target="_blank" rel="noopener noreferrer">Timers Promises API</a></span></a></h2><p>åœ¨è§£é‡Š Node.js v21.7.1 ä¸­çš„ Timers Promises API ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹ Node.js å’Œ Promise æ˜¯ä»€ä¹ˆã€‚</p><h3 id="node-js-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#node-js-ç®€ä»‹"><span>Node.js ç®€ä»‹</span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªå¼€æºã€è·¨å¹³å°çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨åŒä¸€ç§è¯­è¨€æ—¢ç¼–å†™å®¢æˆ·ç«¯ä»£ç ï¼ˆå³åœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„ä»£ç ï¼‰ä¹Ÿç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚</p><h3 id="promise-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#promise-ç®€ä»‹"><span>Promise ç®€ä»‹</span></a></h3><p>Promise æ˜¯ JavaScript ä¸­ç”¨äºå¤„ç†å¼‚æ­¥æ“ä½œçš„å¯¹è±¡ã€‚ä¸€ä¸ª Promise æœ‰ä¸‰ç§çŠ¶æ€ï¼š</p><ul><li><strong>Pendingï¼ˆè¿›è¡Œä¸­ï¼‰</strong>ï¼šåˆå§‹çŠ¶æ€ï¼Œæ—¢ä¸æ˜¯æˆåŠŸï¼Œä¹Ÿä¸æ˜¯å¤±è´¥ã€‚</li><li><strong>Fulfilledï¼ˆå·²æˆåŠŸï¼‰</strong>ï¼šè¡¨ç¤ºæ“ä½œæˆåŠŸå®Œæˆã€‚</li><li><strong>Rejectedï¼ˆå·²å¤±è´¥ï¼‰</strong>ï¼šè¡¨ç¤ºæ“ä½œå¤±è´¥ã€‚</li></ul><p>Promise æä¾›äº†ä¸€ä¸ª <code>.then()</code> æ–¹æ³•æ¥å¤„ç†æˆåŠŸå’Œå¤±è´¥çš„æƒ…å†µï¼Œä»¥åŠä¸€ä¸ª <code>.catch()</code> æ–¹æ³•æ¥æ•è·é”™è¯¯ã€‚</p><h3 id="timers-promises-api-1" tabindex="-1"><a class="header-anchor" href="#timers-promises-api-1"><span>Timers Promises API</span></a></h3><p>Timers æ˜¯ Node.js æ ¸å¿ƒæ¨¡å—ä¹‹ä¸€ï¼Œæä¾›äº†å„ç§è®¡æ—¶åŠŸèƒ½ï¼Œæ¯”å¦‚è®¾ç½®è¶…æ—¶ï¼ˆsetTimeoutï¼‰ã€é—´éš”ï¼ˆsetIntervalï¼‰ç­‰ã€‚åœ¨ Node.js v15.0.0 ä¸­ï¼Œå¼•å…¥äº†åŸºäº Promise çš„ Timers APIï¼Œä½¿å¾—ä½¿ç”¨è®¡æ—¶å™¨å˜å¾—æ›´åŠ æ–¹ä¾¿å’Œç°ä»£åŒ–ã€‚é€šè¿‡è¿™ä¸ª APIï¼Œä½ å¯ä»¥ä½¿ç”¨ async/await æˆ–è€… <code>.then()</code> å’Œ <code>.catch()</code> æ–¹æ³•æ¥å¤„ç†å¼‚æ­¥è®¡æ—¶äº‹ä»¶ï¼Œè€Œä¸å¿…ä¾èµ–ä¼ ç»Ÿçš„å›è°ƒå‡½æ•°ã€‚</p><h4 id="å®é™…åº”ç”¨ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-2"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h4><h5 id="ç¤ºä¾‹-1-ä½¿ç”¨-settimeout-è®¡æ—¶å™¨" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ä½¿ç”¨-settimeout-è®¡æ—¶å™¨"><span>ç¤ºä¾‹ 1ï¼šä½¿ç”¨ setTimeout è®¡æ—¶å™¨</span></a></h5><p>å‡è®¾ä½ è¦åˆ›å»ºä¸€ä¸ªç®€å•çš„è®¡æ—¶å™¨ï¼Œ2 ç§’åæ‰“å°å‡º &quot;Hello, World!&quot;ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> setTimeout</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">timers/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> helloWorld</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">2000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // ç­‰å¾… 2000 æ¯«ç§’ï¼ˆ2ç§’ï¼‰</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello, World!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">helloWorld</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é¦–å…ˆä» <code>timers/promises</code> API å¼•å…¥äº†åŸºäº Promise çš„ <code>setTimeout</code> å‡½æ•°ã€‚ç„¶åå®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° <code>helloWorld</code>ï¼Œåœ¨è¿™ä¸ªå‡½æ•°å†…éƒ¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>await</code> å…³é”®å­—ç­‰å¾… 2 ç§’é’Ÿï¼Œç„¶åæ‰“å°å‡º &quot;Hello, World!&quot;ã€‚</p><h5 id="ç¤ºä¾‹-2-ç»“åˆ-try-catch-ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ç»“åˆ-try-catch-ä½¿ç”¨"><span>ç¤ºä¾‹ 2ï¼šç»“åˆ try-catch ä½¿ç”¨</span></a></h5><p>åŸºäº Promise çš„ API å¾ˆè‡ªç„¶åœ°æ”¯æŒé”™è¯¯å¤„ç†ã€‚å‡è®¾ä½ æƒ³åœ¨ç­‰å¾…æ—¶é—´è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå–æ¶ˆç­‰å¾…ï¼Œè¿™æ—¶å€™å°±éœ€è¦æ•è·å¼‚å¸¸ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> setTimeout</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">timers/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> timeoutWithCatch</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">duration</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // å‡è®¾ duration ä¸æ˜¯æ•°å€¼æˆ–è€…ä¸ºè´Ÿæ•°ï¼ŒsetTimeout å°†ä¼šæŠ›å‡ºå¼‚å¸¸</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">duration</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Completed without interruption</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#A3BE8C;">Timer was interrupted or an invalid duration was passed</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9;">      error</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    )</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ­£å¸¸æƒ…å†µ</span></span>
<span class="line"><span style="color:#88C0D0;">timeoutWithCatch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">2000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// å¼‚å¸¸æƒ…å†µ</span></span>
<span class="line"><span style="color:#88C0D0;">timeoutWithCatch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#81A1C1;">-</span><span style="color:#B48EAD;">1000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå¦‚æœä¼ é€’ç»™ <code>setTimeout</code> çš„æ—¶é—´å€¼æ˜¯è´Ÿæ•°æˆ–è€…å…¶ä»–æ— æ•ˆå€¼ï¼Œå®ƒå°†æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚æˆ‘ä»¬åœ¨ <code>try-catch</code> å—ä¸­æ•è·è¿™ä¸ªå¼‚å¸¸ï¼Œå¹¶å¤„ç†å®ƒï¼Œç¡®ä¿ç¨‹åºèƒ½å¤Ÿä¼˜é›…åœ°å¤„ç†é”™è¯¯æƒ…å†µã€‚</p><p>è¿™äº›ç¤ºä¾‹å±•ç¤ºäº† Timers Promises API å¦‚ä½•ç®€åŒ–å¼‚æ­¥å»¶æ—¶ä»»åŠ¡çš„å¤„ç†ï¼Œæä¾›äº†æ›´åŠ ç›´è§‚å’Œå¼ºå¤§çš„æ–¹å¼æ¥å¤„ç† Node.js ä¸­çš„å®šæ—¶å™¨åŠŸèƒ½ã€‚</p><h3 id="timerspromises-settimeout-delay-value-options" tabindex="-1"><a class="header-anchor" href="#timerspromises-settimeout-delay-value-options"><span><a href="https://nodejs.org/docs/latest/api/timers.html#timerspromisessettimeoutdelay-value-options" target="_blank" rel="noopener noreferrer">timersPromises.setTimeout([delay[, value[, options]]])</a></span></a></h3><p>å½“ç„¶ï¼Œè®©æˆ‘ä»¬æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹ Node.js ä¸­<code>timersPromises.setTimeout([delay[, value[, options]]])</code>çš„ç”¨æ³•ï¼Œå¹¶é€šè¿‡å®ä¾‹æ¥åŠ æ·±ç†è§£ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-1" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-1"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>timersPromises.setTimeout()</code>æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒåŸºäº Promise è€Œä¸æ˜¯ä¼ ç»Ÿçš„å›è°ƒæ–¹å¼æ¥å»¶è¿Ÿæ‰§è¡Œä»£ç ã€‚è¿™ä½¿å¾—å¼‚æ­¥ä»£ç æ›´å®¹æ˜“ç¼–å†™å’Œç†è§£ï¼Œç‰¹åˆ«æ˜¯å½“ä½ ä½¿ç”¨ async/await è¯­æ³•æ—¶ã€‚</p><h3 id="å‚æ•°è§£é‡Š-1" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-1"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>delay</code>: æŒ‡å®šåœ¨æ‰§è¡Œä¹‹å‰ç­‰å¾…çš„æ¯«ç§’æ•°ã€‚å¦‚æœçœç•¥æˆ–ä¸º 0ï¼ŒPromise å°†å°½å¯èƒ½å¿«åœ°è§£å†³ã€‚</li><li><code>value</code> (å¯é€‰): è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå½“è®¡æ—¶å™¨å®Œæˆæ—¶ï¼Œå®ƒä¼šè¢«ä½œä¸º Promise çš„ç»“æœè¿”å›ã€‚</li><li><code>options</code> (å¯é€‰): æä¾›é¢å¤–çš„é…ç½®é€‰é¡¹ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥è®¾ç½®ä¸€ä¸ª<code>signal</code>æ¥å–æ¶ˆè®¡æ—¶å™¨ã€‚</li></ul><h3 id="ä½¿ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹-1"><span>ä½¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-åŸºæœ¬ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åŸºæœ¬ç”¨æ³•"><span>ç¤ºä¾‹ 1: åŸºæœ¬ç”¨æ³•</span></a></h4><p>å‡è®¾ä½ æƒ³åœ¨ 3 ç§’åæ‰“å°ä¸€æ¡æ¶ˆæ¯åˆ°æ§åˆ¶å°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#ECEFF4;"> {</span><span style="color:#8FBCBB;"> setTimeout</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">timers/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> delayPrint</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">3000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // ç­‰å¾…3ç§’</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ¡æ¶ˆæ¯ä¼šåœ¨3ç§’åæ˜¾ç¤º</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">delayPrint</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>setTimeout()</code>å»¶è¿Ÿæ‰§è¡Œæ“ä½œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨<code>value</code>å‚æ•°ï¼Œå› ä¸ºæˆ‘ä»¬åªå…³å¿ƒç­‰å¾…æ—¶é—´ã€‚</p><h4 id="ç¤ºä¾‹-2-ä½¿ç”¨-value-å‚æ•°" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨-value-å‚æ•°"><span>ç¤ºä¾‹ 2: ä½¿ç”¨ value å‚æ•°</span></a></h4><p>å¦‚æœä½ æƒ³åœ¨ç­‰å¾…è¿‡ç¨‹ç»“æŸæ—¶è·å–ä¸€ä¸ªå€¼ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#ECEFF4;"> {</span><span style="color:#8FBCBB;"> setTimeout</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">timers/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> getValueAfterDelay</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> result</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">2000</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello World!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">result</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ‰“å°: Hello World!</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">getValueAfterDelay</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•åœ¨å»¶è¿Ÿç»“æŸæ—¶ä» Promise ä¸­è·å–ä¸€ä¸ªå€¼ã€‚åœ¨è¿™é‡Œï¼Œ&quot;Hello World!&quot;å°†åœ¨ 2 ç§’åæ‰“å°åˆ°æ§åˆ¶å°ã€‚</p><h4 id="ç¤ºä¾‹-3-ä½¿ç”¨-options-å‚æ•°å–æ¶ˆè®¡æ—¶å™¨" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-ä½¿ç”¨-options-å‚æ•°å–æ¶ˆè®¡æ—¶å™¨"><span>ç¤ºä¾‹ 3: ä½¿ç”¨ options å‚æ•°å–æ¶ˆè®¡æ—¶å™¨</span></a></h4><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½éœ€è¦åœ¨è¿˜æ²¡åˆ°æ—¶é—´å°±å–æ¶ˆè®¡æ—¶å™¨ã€‚è¿™å¯ä»¥é€šè¿‡<code>AbortController</code>å®ç°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#ECEFF4;"> {</span><span style="color:#8FBCBB;"> setTimeout</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">timers/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">import</span><span style="color:#ECEFF4;"> {</span><span style="color:#8FBCBB;"> AbortController</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">abort-controller</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> cancellableDelay</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> controller</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> AbortController</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> signal</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> controller</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // åœ¨1ç§’åå–æ¶ˆè®¡æ—¶å™¨</span></span>
<span class="line"><span style="color:#88C0D0;">  setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">1000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">then</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#D8DEE9;"> controller</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">abort</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">5000</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> undefined</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> signal</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ¡æ¶ˆæ¯ä¸ä¼šè¢«æ‰“å°</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è®¡æ—¶å™¨è¢«å–æ¶ˆ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">cancellableDelay</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªç¤ºä¾‹åˆ›å»ºäº†ä¸€ä¸ª 5 ç§’çš„è®¡æ—¶å™¨ï¼Œä½†åœ¨ 1 ç§’åï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨<code>controller.abort()</code>å–æ¶ˆäº†å®ƒã€‚å› æ­¤ï¼Œ<code>catch</code>å—æ•è·äº†å¼‚å¸¸ï¼Œè¡¨ç¤ºè®¡æ—¶å™¨å·²è¢«å–æ¶ˆã€‚</p><h3 id="æ€»ç»“-6" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-6"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡ä»¥ä¸Šç¤ºä¾‹ï¼Œä½ åº”è¯¥å¯¹å¦‚ä½•ä½¿ç”¨ Node.js ä¸­çš„<code>timersPromises.setTimeout()</code>æœ‰äº†åŸºæœ¬çš„ç†è§£ã€‚å®ƒå…è®¸ä½ ä»¥ä¸€ç§æ›´ç°ä»£ä¸”æ˜“äºç†è§£çš„æ–¹å¼å¤„ç†å¼‚æ­¥å»¶è¿Ÿä»»åŠ¡ã€‚è®°ä½ï¼Œä½¿ç”¨ Promise å’Œ async/await å¯ä»¥è®©ä½ çš„ä»£ç æ›´åŠ æ¸…æ™°ä¸”æ˜“äºç»´æŠ¤ã€‚</p><h3 id="timerspromises-setimmediate-value-options" tabindex="-1"><a class="header-anchor" href="#timerspromises-setimmediate-value-options"><span><a href="https://nodejs.org/docs/latest/api/timers.html#timerspromisessetimmediatevalue-options" target="_blank" rel="noopener noreferrer">timersPromises.setImmediate([value[, options]])</a></span></a></h3><p>ç†è§£ <code>timersPromises.setImmediate([value[, options]])</code> è¿™ä¸ªå‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€ä¸‹ Node.js ç¯å¢ƒä¸­çš„å‡ ä¸ªæ¦‚å¿µï¼šäº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰ã€å›è°ƒå‡½æ•°å’Œ Promiseã€‚</p><p>Node.js æ˜¯åŸºäºäº‹ä»¶é©±åŠ¨çš„ï¼Œå®ƒæœ‰ä¸€ä¸ªè¿è¡Œæœºåˆ¶å«åšäº‹ä»¶å¾ªç¯ã€‚åœ¨è¿™ä¸ªå¾ªç¯ä¸­ï¼ŒNode.js ä¼šæ‰§è¡Œä»£ç ã€æ”¶é›†å’Œå¤„ç†äº‹ä»¶ï¼Œå¹¶æ‰§è¡Œé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚äº‹ä»¶å¾ªç¯ä½¿å¾— Node.js å¯ä»¥è¿›è¡Œéé˜»å¡ I/O æ“ä½œï¼Œå°½ç®¡ JavaScript æ˜¯å•çº¿ç¨‹çš„ï¼Œä½†å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼é«˜æ•ˆåœ°å¤„ç†å¤šä»»åŠ¡ã€‚</p><p>å›è°ƒå‡½æ•°æ˜¯ä¸€ä¸ªåœ¨æŸä¸ªç‰¹å®šçš„äº‹ä»¶å‘ç”Ÿæˆ–æ˜¯æŸä¸ªæ“ä½œå®Œæˆåè¢«è°ƒç”¨çš„å‡½æ•°ã€‚</p><p>Promise æ˜¯ JavaScript ä¸­ç”¨äºå¼‚æ­¥æ“ä½œçš„å¯¹è±¡ï¼Œå®ƒä»£è¡¨äº†ä¸€ä¸ªå¯èƒ½åœ¨æœªæ¥æŸä¸ªæ—¶é—´ç‚¹ä¸Šå®Œæˆæˆ–å¤±è´¥çš„æ“ä½œåŠå…¶ç»“æœå€¼ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬èšç„¦äº <code>timersPromises.setImmediate([value[, options]])</code>ã€‚</p><p>è¿™æ˜¯ Node.js v15.0.0 å¼•å…¥çš„ä¸€ä¸ª APIï¼Œå±äº timers æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ª Promise ç‰ˆæœ¬çš„ <code>setImmediate</code>ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>setImmediate</code> å‡½æ•°æ˜¯ç”¨æ¥å®‰æ’ä¸€ä¸ªä»»åŠ¡åœ¨å½“å‰äº‹ä»¶å¾ªç¯å‘¨æœŸçš„æ‰€æœ‰ I/O æ“ä½œå®Œæˆåç«‹å³æ‰§è¡Œçš„ã€‚</p><p><code>timersPromises.setImmediate([value[, options]])</code> å…è®¸ä½ ä»¥ Promise çš„æ–¹å¼ä½¿ç”¨ <code>setImmediate</code>ã€‚å½“ä½ è°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶ï¼Œå®ƒè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè¿™ä¸ª Promise ä¼šåœ¨ Node.js äº‹ä»¶å¾ªç¯çš„å½“å‰é˜¶æ®µç»“æŸåã€ä¸‹ä¸€ä¸ªé˜¶æ®µå¼€å§‹å‰è§£å†³ã€‚</p><p>å‚æ•°ï¼š</p><ul><li><code>value</code> (å¯é€‰)ï¼šå½“ Promise è§£å†³æ—¶ï¼Œå®ƒä¼šæºå¸¦è¿™ä¸ª value å€¼ã€‚</li><li><code>options</code> (å¯é€‰)ï¼šæä¾›é¢å¤–çš„é…ç½®é€‰é¡¹ã€‚ç›®å‰æ–‡æ¡£æŒ‡å‡ºçš„å”¯ä¸€é€‰é¡¹æ˜¯ <code>signal</code>ï¼Œè¿™å…è®¸ä½ ä¼ é€’ä¸€ä¸ª AbortSignal å¯¹è±¡ä»¥å–æ¶ˆç«‹å³æ“ä½œã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-5"><span>å®é™…è¿ç”¨ä¾‹å­ï¼š</span></a></h3><ol><li><p><strong>å»¶è¿Ÿæ—¥å¿—æ‰“å°</strong></p><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œéœ€è¦åœ¨æ‰€æœ‰åˆå§‹åŒ–æ“ä½œå®Œæˆåç«‹å³æ‰“å°ä¸€æ¡æ¶ˆæ¯ï¼Œä½†ä½ æƒ³ç¡®ä¿è¿™ä¸ªæ“ä½œçœŸçš„æ˜¯åœ¨æ‰€æœ‰åŒæ­¥å’Œå¼‚æ­¥æ“ä½œéƒ½å®Œæˆåæ‰§è¡Œçš„ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#ECEFF4;"> {</span><span style="color:#8FBCBB;"> setImmediate</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">timers/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">åˆå§‹åŒ–æ“ä½œå¼€å§‹</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å‡è®¾è¿™é‡Œæœ‰ä¸€äº›å¼‚æ­¥æ“ä½œ, å¦‚æ•°æ®åº“è¿æ¥ç­‰</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> Promise</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">resolve</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#88C0D0;"> setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">resolve</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1000</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">åˆå§‹åŒ–æ“ä½œå®Œæˆ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#88C0D0;"> setImmediate</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ¡ä¿¡æ¯å‡ºç°åœ¨æ‰€æœ‰åˆå§‹åŒ–æ“ä½œå®Œæˆä¹‹å</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">main</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>ç»“åˆ Promise è¿›è¡Œæµç¨‹æ§åˆ¶</strong></p><p>å¦‚æœä½ çš„ä»£ç ä¸­æœ‰å¤æ‚çš„å¼‚æ­¥æ“ä½œæµç¨‹ï¼Œéœ€è¦åœ¨æŸäº›æ“ä½œåç«‹åˆ»è¿›è¡Œä¸‹ä¸€æ­¥ï¼Œä½†ä½ åˆä¸å¸Œæœ›å¼•å…¥é¢å¤–çš„å»¶æ—¶ï¼Œä½¿ç”¨ <code>setImmediate</code> çš„ Promise å½¢å¼å¯ä»¥éå¸¸æ–¹ä¾¿åœ°å®ç°è¿™ä¸€ç‚¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#ECEFF4;"> {</span><span style="color:#8FBCBB;"> setImmediate</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">timers/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> complexOperation</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // ç¬¬ä¸€éƒ¨åˆ†æ“ä½œ</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#88C0D0;"> someAsyncOperation</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // åœ¨ä¸Šä¸€ä¸ªæ“ä½œå®Œæˆåç«‹å³æ‰§è¡Œï¼Œä½†ä¸é˜»å¡å…¶ä»–å¹¶å‘æ“ä½œ</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#88C0D0;"> setImmediate</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä¸‹ä¸€ç»„æ“ä½œ</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#88C0D0;"> anotherAsyncOperation</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">complexOperation</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>è¿™æ ·ï¼Œ<code>timersPromises.setImmediate</code> æä¾›äº†ä¸€ä¸ªä¼˜é›…çš„æ–¹å¼ï¼Œåˆ©ç”¨ Promise çš„ç‰¹æ€§ï¼Œåœ¨å¿…è¦çš„æ—¶å€™å°†æ“ä½œæ¨è¿Ÿåˆ°ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯è¿­ä»£ä¸­ï¼ŒåŒæ—¶ä»£ç æ˜“äºé˜…è¯»å’Œç»´æŠ¤ã€‚</p><h3 id="timerspromises-setinterval-delay-value-options" tabindex="-1"><a class="header-anchor" href="#timerspromises-setinterval-delay-value-options"><span><a href="https://nodejs.org/docs/latest/api/timers.html#timerspromisessetintervaldelay-value-options" target="_blank" rel="noopener noreferrer">timersPromises.setInterval([delay[, value[, options]]])</a></span></a></h3><p>Node.js çš„ <code>timersPromises.setInterval</code> æ–¹æ³•æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œå®ƒå…è®¸ä½ ä»¥ä¸€ç§æ›´ç°ä»£ã€æ‰¿è¯ºï¼ˆPromiseï¼‰ä¸ºåŸºç¡€çš„æ–¹å¼æ¥å¤„ç†é‡å¤æ‰§è¡Œä»£ç çš„é€»è¾‘ã€‚æˆ‘ä»¬æ¥ä¸€æ­¥æ­¥åˆ†è§£è¿™ä¸ªåŠŸèƒ½ï¼Œå¹¶é€šè¿‡å®é™…è¿ç”¨çš„ä¾‹å­æ¥ç†è§£å®ƒã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-2" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-2"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>é¦–å…ˆï¼Œäº†è§£å‡ ä¸ªå…³é”®æ¦‚å¿µï¼š</p><ul><li><strong>Promises (æ‰¿è¯º)</strong>: åœ¨ JavaScript ä¸­ï¼ŒPromise æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚ç®€å•æ¥è¯´ï¼ŒPromise æ˜¯ä¸€ä¸ªä»£è¡¨äº†å¼‚æ­¥æ“ä½œæœ€ç»ˆå®Œæˆæˆ–å¤±è´¥çš„å¯¹è±¡ã€‚</li><li><strong>async/await</strong>: è¿™æ˜¯ä¸€ç§ç‰¹æ®Šè¯­æ³•ï¼Œç”¨äºæ›´ç®€å•ã€æ›´ç›´è§‚åœ°å¤„ç† Promiseã€‚<code>async</code>å£°æ˜ä¸€ä¸ªå‡½æ•°æ˜¯å¼‚æ­¥çš„ï¼Œè€Œ<code>await</code>ç”¨äºç­‰å¾…ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼ˆæ¯”å¦‚ä¸€ä¸ª Promiseï¼‰å®Œæˆã€‚</li><li><strong>setInterval</strong>: JavaScript çš„ä¼ ç»Ÿæ–¹æ³•ï¼Œç”¨äºå®šæ—¶é‡å¤æ‰§è¡ŒæŸæ®µä»£ç ã€‚</li></ul><h3 id="timerspromises-setinterval" tabindex="-1"><a class="header-anchor" href="#timerspromises-setinterval"><span>timersPromises.setInterval</span></a></h3><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>timersPromises.setInterval</code>æä¾›äº†ä¸€ç§æ–°çš„æ–¹å¼æ¥å¤„ç†é‡å¤çš„å¼‚æ­¥ä»»åŠ¡ï¼Œè€Œä¸å¿…ä¾èµ–å›è°ƒå‡½æ•°ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯å¯ä»¥è®©ä»£ç æ›´åŠ æ¸…æ™°æ˜“è¯»ï¼Œå°¤å…¶æ˜¯å½“å¤„ç†å¤æ‚çš„å¼‚æ­¥é€»è¾‘æ—¶ã€‚</p><h4 id="å‚æ•°" tabindex="-1"><a class="header-anchor" href="#å‚æ•°"><span>å‚æ•°</span></a></h4><ul><li><strong>delay</strong> (å¯é€‰): è®¾ç½®é—´éš”æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ã€‚å¦‚æœä¸è®¾ç½®ï¼Œåˆ™é»˜è®¤ä¸º 0ã€‚</li><li><strong>value</strong> (å¯é€‰): æ¯æ¬¡é—´éš”åˆ°äº†åè¦ä¼ é€’ç»™è¿­ä»£å™¨çš„å€¼ã€‚</li><li><strong>options</strong> (å¯é€‰): ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«å¯é€‰é…ç½®ã€‚æœ€å¸¸ç”¨çš„æ˜¯<code>ref</code>å’Œ<code>signal</code>ï¼š <ul><li><strong>ref</strong>: æ§åˆ¶å®šæ—¶å™¨æ˜¯å¦åº”è¯¥é˜»æ­¢ç¨‹åºé€€å‡ºã€‚</li><li><strong>signal</strong>: å…è®¸ä½¿ç”¨<code>AbortSignal</code>æ¥å–æ¶ˆå®šæ—¶å™¨ã€‚</li></ul></li></ul><h4 id="å®é™…è¿ç”¨ç¤ºä¾‹-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-4"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h4><h5 id="ç¤ºä¾‹-1-åŸºæœ¬ç”¨æ³•-1" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åŸºæœ¬ç”¨æ³•-1"><span>ç¤ºä¾‹ 1ï¼šåŸºæœ¬ç”¨æ³•</span></a></h5><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#ECEFF4;"> {</span><span style="color:#8FBCBB;"> timersPromises</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">node:timers/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> example</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  for</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> startTime</span><span style="color:#81A1C1;"> of</span><span style="color:#D8DEE9;"> timersPromises</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">setInterval</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">1000</span><span style="color:#D8DEE9FF;">)) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ¯ç§’æ‰“å°ä¸€æ¬¡ï¼Œå½“å‰æ—¶é—´ï¼š</span><span style="color:#81A1C1;">${</span><span style="color:#81A1C1;">new</span><span style="color:#88C0D0;"> Date</span><span style="color:#ECEFF4;">().</span><span style="color:#88C0D0;">toISOString</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å‡è®¾æˆ‘ä»¬åªæƒ³æ‰“å°äº”æ¬¡</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">startTime</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getSeconds</span><span style="color:#D8DEE9FF;">() </span><span style="color:#81A1C1;">%</span><span style="color:#B48EAD;"> 5</span><span style="color:#81A1C1;"> ===</span><span style="color:#B48EAD;"> 0</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">      break;</span><span style="color:#616E88;"> // è·³å‡ºå¾ªç¯ï¼Œç»“æŸå®šæ—¶å™¨</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">example</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯¼å…¥äº† Node.js çš„<code>timersPromises</code>æ¨¡å—ï¼Œå¹¶ä½¿ç”¨<code>setInterval</code>æ–¹æ³•æ¯ç§’æ‰“å°å½“å‰æ—¶é—´ã€‚å€ŸåŠ©<code>for await...of</code>å¾ªç¯ï¼Œæˆ‘ä»¬ä»¥å¼‚æ­¥çš„æ–¹å¼é‡å¤æ‰§è¡Œä»£ç å—ï¼Œå¹¶åœ¨æ»¡è¶³æŸä¸ªæ¡ä»¶æ—¶è·³å‡ºå¾ªç¯ã€‚</p><h5 id="ç¤ºä¾‹-2-ä½¿ç”¨valueå‚æ•°" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨valueå‚æ•°"><span>ç¤ºä¾‹ 2ï¼šä½¿ç”¨<code>value</code>å‚æ•°</span></a></h5><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#ECEFF4;"> {</span><span style="color:#8FBCBB;"> timersPromises</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">node:timers/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> exampleWithValue</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> counter</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 1</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // è®¾å®šé—´éš”ä¸º1ç§’ï¼Œå¹¶ä¼ é€’ä¸€ä¸ªè‡ªå¢çš„è®¡æ•°å™¨ä½œä¸ºå€¼</span></span>
<span class="line"><span style="color:#81A1C1;">  for</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> count</span><span style="color:#81A1C1;"> of</span><span style="color:#D8DEE9;"> timersPromises</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">setInterval</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">1000</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> counter</span><span style="color:#D8DEE9FF;">)) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">è¿™æ˜¯ç¬¬ </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">count</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> æ¬¡æ‰§è¡Œ</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // æ›´æ–°è®¡æ•°å™¨å€¼</span></span>
<span class="line"><span style="color:#D8DEE9;">    counter</span><span style="color:#81A1C1;">++;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">counter</span><span style="color:#81A1C1;"> &gt;</span><span style="color:#B48EAD;"> 5</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">      break;</span><span style="color:#616E88;"> // å½“è®¡æ•°å™¨è¶…è¿‡5æ—¶åœæ­¢</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">exampleWithValue</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œé™¤äº†å»¶è¿Ÿï¼Œæˆ‘ä»¬è¿˜å‘<code>setInterval</code>ä¼ é€’äº†ä¸€ä¸ªå€¼ï¼ˆ<code>counter</code>ï¼‰ï¼Œè¿™ä¸ªå€¼ä¼šåœ¨æ¯æ¬¡è¿­ä»£æ—¶æ›´æ–°å¹¶è¾“å‡ºã€‚</p><p>æ€»ä¹‹ï¼Œ<code>timersPromises.setInterval</code>æ˜¯å¤„ç†å‘¨æœŸæ€§å¼‚æ­¥ä»»åŠ¡çš„å¼ºå¤§å·¥å…·ã€‚é€šè¿‡ä¸Šè¿°ç¤ºä¾‹ï¼Œä½ åº”è¯¥èƒ½å¤Ÿç†è§£å®ƒçš„åŸºç¡€ç”¨æ³•å’Œå¦‚ä½•åœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨äº†ã€‚</p><h3 id="timerspromises-scheduler-wait-delay-options" tabindex="-1"><a class="header-anchor" href="#timerspromises-scheduler-wait-delay-options"><span><a href="https://nodejs.org/docs/latest/api/timers.html#timerspromisesschedulerwaitdelay-options" target="_blank" rel="noopener noreferrer">timersPromises.scheduler.wait(delay[, options])</a></span></a></h3><p>Node.js çš„ <code>timersPromises.scheduler.wait(delay[, options])</code> æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¼‚æ­¥ç¼–ç¨‹æ—¶ã€‚è¿™ä¸ªå‡½æ•°å…è®¸ä½ æš‚åœä»£ç æ‰§è¡Œä¸€æ®µæŒ‡å®šçš„æ—¶é—´ï¼Œç„¶åè‡ªåŠ¨ç»§ç»­ã€‚å®ƒè¿”å›ä¸€ä¸ª Promiseï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥å¾ˆå¥½åœ°ä¸ async/await è¯­æ³•æ­é…ä½¿ç”¨ã€‚</p><h3 id="è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š"><span>è§£é‡Š</span></a></h3><h4 id="å‚æ•°-1" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-1"><span>å‚æ•°</span></a></h4><ul><li><strong>delay</strong>: è¿™æ˜¯ä½ å¸Œæœ›ä»£ç æš‚åœæ‰§è¡Œçš„æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ è®¾ç½® <code>delay</code> ä¸º 1000ï¼Œé‚£ä¹ˆä»£ç å°†æš‚åœæ‰§è¡Œ 1 ç§’ã€‚</li><li><strong>options</strong>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œæä¾›é¢å¤–çš„é…ç½®é€‰é¡¹ã€‚åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œ<code>options</code> å¯¹è±¡å¯ä»¥åŒ…å«ä¸€ä¸ªåä¸º <code>ref</code> çš„å±æ€§ã€‚å¦‚æœè®¾ç½®ä¸º <code>false</code>ï¼Œåˆ™æš‚åœæœŸé—´ä¸ä¼šé˜»æ­¢ Node.js è¿›ç¨‹é€€å‡ºã€‚</li></ul><h4 id="è¿”å›å€¼" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼"><span>è¿”å›å€¼</span></a></h4><ul><li>å‡½æ•°è¿”å›ä¸€ä¸ª Promiseï¼Œè¯¥ Promise åœ¨æŒ‡å®šçš„å»¶è¿Ÿæ—¶é—´åè§£å†³ï¼ˆresolveï¼‰ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨ Promise å®Œæˆåç«‹å³è¿è¡Œæ›´å¤šä»£ç ï¼Œè€Œä¸éœ€è¦å›è°ƒå‡½æ•°ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-2"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><h4 id="ä¾‹å­-1-ç®€å•çš„æš‚åœ" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-ç®€å•çš„æš‚åœ"><span>ä¾‹å­ 1ï¼šç®€å•çš„æš‚åœ</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œéœ€è¦åœ¨å‘é€ä¸¤ä¸ªè¯·æ±‚ä¹‹é—´æš‚åœ 2 ç§’é’Ÿã€‚ä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> scheduler</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">timers/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> sendRequests</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‘é€ç¬¬ä¸€ä¸ªè¯·æ±‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // æš‚åœ 2 ç§’</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> scheduler</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">wait</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">2000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‘é€ç¬¬äºŒä¸ªè¯·æ±‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">sendRequests</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>scheduler.wait(2000)</code> å‘Šè¯‰ Node.js æš‚åœ 2 ç§’é’Ÿã€‚å› ä¸ºæˆ‘ä»¬åœ¨ä¸€ä¸ª async å‡½æ•°ä¸­ä½¿ç”¨ <code>await</code> å…³é”®å­—ï¼Œæ‰€ä»¥æ‰§è¡Œä¼šåœ¨è¿™é‡Œæš‚åœï¼Œç›´åˆ° 2 ç§’è¿‡å»åæ‰ç»§ç»­ã€‚</p><h4 id="ä¾‹å­-2-ä½¿ç”¨-options-ä¸é˜»æ­¢è¿›ç¨‹é€€å‡º" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ä½¿ç”¨-options-ä¸é˜»æ­¢è¿›ç¨‹é€€å‡º"><span>ä¾‹å­ 2ï¼šä½¿ç”¨ options ä¸é˜»æ­¢è¿›ç¨‹é€€å‡º</span></a></h4><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½æƒ³è¦ç¨‹åºåœ¨ç­‰å¾…æœŸé—´èƒ½å¤Ÿé€€å‡ºã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½åœ¨ç­‰å¾…ç”¨æˆ·è¾“å…¥ï¼Œä½†ä¹Ÿæƒ³è®©ç”¨æˆ·èƒ½é€šè¿‡ Ctrl+C é€€å‡ºç¨‹åºã€‚ä½ å¯ä»¥é€šè¿‡è®¾ç½® <code>ref: false</code> æ¥å®ç°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> scheduler</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">timers/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> waitForUserInput</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯·åœ¨ 10 ç§’å†…è¾“å…¥ï¼ˆæˆ–æŒ‰ Ctrl+C é€€å‡ºï¼‰...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ç­‰å¾… 10 ç§’ï¼Œä½†å…è®¸è¿›ç¨‹åœ¨æ­¤æœŸé—´é€€å‡º</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> scheduler</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">wait</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">10000</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> ref</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> false</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ—¶é—´åˆ°ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">waitForUserInput</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå³ä½¿æˆ‘ä»¬åœ¨ç­‰å¾…ç”¨æˆ·è¾“å…¥ï¼Œç¨‹åºä¹Ÿå¯ä»¥åœ¨è¿™æ®µæ—¶é—´å†…è¢«æ­£å¸¸é€€å‡ºã€‚</p><h3 id="æ€»ç»“-7" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-7"><span>æ€»ç»“</span></a></h3><p><code>timersPromises.scheduler.wait</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥åœ¨ä½ éœ€è¦çš„æ—¶å€™æš‚åœç¨‹åºçš„æ‰§è¡Œï¼Œå¹¶ä¸”éå¸¸é€‚åˆç”¨äºç®¡ç†å¼‚æ­¥æ“ä½œã€‚é€šè¿‡åˆç†ä½¿ç”¨è¿™ä¸ªå‡½æ•°å’Œå…¶ä»– Node.js æä¾›çš„å·¥å…·ï¼Œå¯ä»¥ä½¿ç¼–å†™å¼‚æ­¥ä»£ç å˜å¾—æ›´ç®€å•ã€æ›´ç›´è§‚ã€‚</p><h3 id="timerspromises-scheduler-yield" tabindex="-1"><a class="header-anchor" href="#timerspromises-scheduler-yield"><span><a href="https://nodejs.org/docs/latest/api/timers.html#timerspromisesscheduleryield" target="_blank" rel="noopener noreferrer">timersPromises.scheduler.yield()</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¹³å°ï¼Œå®ƒä½¿ç”¨ JavaScript ä½œä¸ºç¼–ç¨‹è¯­è¨€ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>timersPromises.scheduler.yield()</code>æ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°çš„åŠŸèƒ½ï¼Œå®ƒå±äº<code>timers/promises</code>æ¨¡å—ã€‚è¦ç†è§£è¿™ä¸ªåŠŸèƒ½ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“å®ƒæ‰€å¤„çš„ä¸Šä¸‹æ–‡ï¼šå¼‚æ­¥ç¼–ç¨‹å’Œäº‹ä»¶å¾ªç¯ã€‚</p><h3 id="å¼‚æ­¥ç¼–ç¨‹ä¸äº‹ä»¶å¾ªç¯" tabindex="-1"><a class="header-anchor" href="#å¼‚æ­¥ç¼–ç¨‹ä¸äº‹ä»¶å¾ªç¯"><span>å¼‚æ­¥ç¼–ç¨‹ä¸äº‹ä»¶å¾ªç¯</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œè®¸å¤šæ“ä½œæ˜¯å¼‚æ­¥çš„ï¼Œæ¯”å¦‚æ–‡ä»¶è¯»å†™ã€ç½‘ç»œè¯·æ±‚ç­‰ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥å‘èµ·è¿™æ ·ä¸€ä¸ªæ“ä½œï¼Œå¹¶ä¸”åœ¨å®ƒå®Œæˆä¹‹å‰ç»§ç»­æ‰§è¡Œå…¶ä»–ä»£ç ã€‚Node.js ç”¨äº‹ä»¶å¾ªç¯æ¥ç®¡ç†è¿™äº›å¼‚æ­¥æ“ä½œï¼Œé¿å…ç¨‹åºè¢«é˜»å¡ã€‚</p><h3 id="timerspromises-scheduler-yield-1" tabindex="-1"><a class="header-anchor" href="#timerspromises-scheduler-yield-1"><span><code>timersPromises.scheduler.yield()</code></span></a></h3><p>è¿™ä¸ªå‡½æ•°æ˜¯<code>timers/promises</code> API çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæä¾›äº†åŸºäº Promise çš„è®¡æ—¶å™¨åŠŸèƒ½ã€‚å…·ä½“åˆ°<code>yield()</code>ï¼Œå®ƒå…è®¸ä½ åœ¨å¼‚æ­¥æ“ä½œä¸­â€œæš‚åœâ€æ‰§è¡Œï¼ŒæŠŠæ§åˆ¶æƒäº¤å›äº‹ä»¶å¾ªç¯ï¼Œè®©å…¶ä»–å¾…å¤„ç†çš„äº‹ä»¶æœ‰æœºä¼šè¿è¡Œã€‚å®Œæˆè¿™äº›åï¼Œå†ç»§ç»­æ‰§è¡ŒåŸæ¥çš„å¼‚æ­¥æ“ä½œã€‚</p><p>æ¢å¥è¯è¯´ï¼Œ<code>yield()</code>å¯ä»¥çœ‹ä½œæ˜¯å‘Šè¯‰ Node.jsï¼šâ€œå˜¿ï¼Œæˆ‘è¿™é‡Œå¯ä»¥æš‚åœä¸€ä¸‹ï¼Œå¦‚æœæœ‰å…¶ä»–äº‹æƒ…è¦åšï¼Œç°åœ¨æ˜¯ä¸€ä¸ªä¸é”™çš„æ—¶æœºã€‚â€</p><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-3" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-3"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js åº”ç”¨ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªéå¸¸è€—æ—¶çš„æ•°æ®å¤„ç†ä»»åŠ¡ã€‚ä½¿ç”¨<code>yield()</code>ï¼Œä½ å¯ä»¥ç¡®ä¿è¿™ä¸ªé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ä¸ä¼šå®Œå…¨å æ® Node.js çš„äº‹ä»¶å¾ªç¯ï¼Œç»™å®šæ—¶å™¨äº‹ä»¶æˆ–è€… IO æ“ä½œç­‰å…¶ä»–ç±»å‹çš„äº‹ä»¶ä»¥å¤„ç†çš„æœºä¼šã€‚</p><h4 id="ç¤ºä¾‹ä»£ç -1" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç -1"><span>ç¤ºä¾‹ä»£ç </span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> scheduler</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">timers/promises</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> processData</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // å‡è®¾è¿™æ˜¯ä¸€ä¸ªéœ€è¦åˆ†æ‰¹å¤„ç†çš„å¤§é‡æ•°æ®</span></span>
<span class="line"><span style="color:#81A1C1;">  for</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9;"> i</span><span style="color:#ECEFF4;"> `</span><span style="color:#A3BE8C;">&lt;</span><span style="color:#ECEFF4;">`</span><span style="color:#B48EAD;"> 10000</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // å¤„ç†æ•°æ®çš„é€»è¾‘...</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">i</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åšä¸€äº›å¤„ç†</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // æ¯å¤„ç†1000æ¡è®°å½•å°±è®©å‡ºæ§åˆ¶æƒä¸€æ¬¡</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">i</span><span style="color:#81A1C1;"> %</span><span style="color:#B48EAD;"> 1000</span><span style="color:#81A1C1;"> ===</span><span style="color:#B48EAD;"> 0</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">      await</span><span style="color:#D8DEE9;"> scheduler</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">yield</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">processData</span><span style="color:#D8DEE9FF;">()</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">then</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#D8DEE9;"> console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">æ•°æ®å¤„ç†å®Œæˆ</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>processData</code>å‡½æ•°å¤„ç†ä¸€ç³»åˆ—æ•°æ®ã€‚é€šè¿‡è°ƒç”¨<code>await scheduler.yield()</code>ï¼Œæˆ‘ä»¬åœ¨æ¯ 1000 æ¡æ•°æ®å¤„ç†åè®©å‡º CPU æ§åˆ¶æƒï¼Œä½¿å¾— Node.js äº‹ä»¶å¾ªç¯æœ‰æœºä¼šå»å¤„ç†å…¶ä»–æŒ‚èµ·çš„å·¥ä½œï¼Œæ¯”å¦‚å“åº”ç”¨æˆ·è¾“å…¥æˆ–è€…å¤„ç†ç½‘ç»œè¯·æ±‚ã€‚è¿™æ ·å¯ä»¥ä½¿åº”ç”¨æ›´åŠ å“åº”ï¼Œé¿å…å› ä¸ºä¸€ä¸ªé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡è€Œé˜»å¡æ•´ä¸ªç³»ç»Ÿã€‚</p><p>æ€»ä¹‹ï¼Œ<code>timersPromises.scheduler.yield()</code>æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„å·¥å…·ï¼Œèƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°ç®¡ç†å¤æ‚çš„å¼‚æ­¥æ“ä½œï¼Œä»è€Œåˆ›å»ºæ—¢é«˜æ•ˆåˆèƒ½è‰¯å¥½å“åº”å¤–éƒ¨äº‹ä»¶çš„ Node.js åº”ç”¨ã€‚</p></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: kamiacgxu@gmail.com">kamishima-kaede</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/document/node-doc/Test%20runner.html" aria-label="Test runner"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Test runner</div></a><a class="route-link auto-link next" href="/document/node-doc/TLS%20(SSL).html" aria-label="TLS (SSL)"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">TLS (SSL)<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><!----><div class="vp-copyright">Copyright Â© 2018-present hanekawa-shiki</div></footer></div><!--]--><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.be370b10.js" defer></script><script src="/assets/js/4485.e6fe7c7b.js" defer></script><script src="/assets/js/app.bf6f64e3.js" defer></script>
  </body>
</html>
