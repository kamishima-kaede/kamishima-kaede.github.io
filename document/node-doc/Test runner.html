<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.50" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://hanekawa.top/document/node-doc/Test%20runner.html"><meta property="og:site_name" content="hanekawa-shiki"><meta property="og:title" content="Test runner"><meta property="og:description" content="Test runner Node.js v21.7.1 ä¸­çš„æµ‹è¯•è¿è¡Œå™¨ï¼ˆTest Runnerï¼‰æ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°å¼•å…¥çš„åŠŸèƒ½ï¼Œå®ƒæä¾›äº†ä¸€ç§åœ¨ Node.js ç¯å¢ƒä¸­æ‰§è¡Œ JavaScript æµ‹è¯•ä»£ç çš„æ ‡å‡†å’Œç®€æ´æ–¹å¼ã€‚æœ¬è´¨ä¸Šï¼Œå®ƒæ˜¯ Node.js ç”Ÿæ€ç³»ç»Ÿä¸­ç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•çš„ä¸€ä¸ªå·¥å…·ï¼Œæ—¨åœ¨è®©å¼€å‘è€…èƒ½å¤Ÿè½»æ¾åœ°ç¼–å†™å’Œè¿è¡Œæµ‹è¯•ï¼Œä»è€Œä¿è¯ä»£ç è´¨é‡ã€‚ åŸºæœ¬æ¦‚å¿µ åœ¨æ·±å…¥..."><meta property="og:type" content="website"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-06-21T09:46:17.000Z"><meta property="article:author" content="hanekawa-shiki"><meta property="article:modified_time" content="2024-06-21T09:46:17.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"WebPage","name":"Test runner","description":"Test runner Node.js v21.7.1 ä¸­çš„æµ‹è¯•è¿è¡Œå™¨ï¼ˆTest Runnerï¼‰æ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°å¼•å…¥çš„åŠŸèƒ½ï¼Œå®ƒæä¾›äº†ä¸€ç§åœ¨ Node.js ç¯å¢ƒä¸­æ‰§è¡Œ JavaScript æµ‹è¯•ä»£ç çš„æ ‡å‡†å’Œç®€æ´æ–¹å¼ã€‚æœ¬è´¨ä¸Šï¼Œå®ƒæ˜¯ Node.js ç”Ÿæ€ç³»ç»Ÿä¸­ç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•çš„ä¸€ä¸ªå·¥å…·ï¼Œæ—¨åœ¨è®©å¼€å‘è€…èƒ½å¤Ÿè½»æ¾åœ°ç¼–å†™å’Œè¿è¡Œæµ‹è¯•ï¼Œä»è€Œä¿è¯ä»£ç è´¨é‡ã€‚ åŸºæœ¬æ¦‚å¿µ åœ¨æ·±å…¥..."}</script><meta name="keywords" content="JavaScript,HTML,CSS"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/assets/icons/chrome-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icons/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icons/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icons/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#5c92d1"><link rel="apple-touch-icon" href="/assets/icons/apple-touch-icon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="white"><meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><title>Test runner | hanekawa-shiki</title><meta name="description" content="Test runner Node.js v21.7.1 ä¸­çš„æµ‹è¯•è¿è¡Œå™¨ï¼ˆTest Runnerï¼‰æ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°å¼•å…¥çš„åŠŸèƒ½ï¼Œå®ƒæä¾›äº†ä¸€ç§åœ¨ Node.js ç¯å¢ƒä¸­æ‰§è¡Œ JavaScript æµ‹è¯•ä»£ç çš„æ ‡å‡†å’Œç®€æ´æ–¹å¼ã€‚æœ¬è´¨ä¸Šï¼Œå®ƒæ˜¯ Node.js ç”Ÿæ€ç³»ç»Ÿä¸­ç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•çš„ä¸€ä¸ªå·¥å…·ï¼Œæ—¨åœ¨è®©å¼€å‘è€…èƒ½å¤Ÿè½»æ¾åœ°ç¼–å†™å’Œè¿è¡Œæµ‹è¯•ï¼Œä»è€Œä¿è¯ä»£ç è´¨é‡ã€‚ åŸºæœ¬æ¦‚å¿µ åœ¨æ·±å…¥...">
    <link rel="stylesheet" href="/assets/css/styles.b040cee0.css">
    <link rel="preload" href="/assets/js/runtime~app.28bb228f.js" as="script"><link rel="preload" href="/assets/css/styles.b040cee0.css" as="style"><link rel="preload" href="/assets/js/6679.86a2b270.js" as="script"><link rel="preload" href="/assets/js/app.de91e5da.js" as="script">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo light" src="/assets/svg/logo.svg" alt><img class="vp-nav-logo dark" src="/assets/svg/logo.svg" alt><span class="vp-site-name hide-in-pad">hanekawa-shiki</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="åšå®¢ä¸»é¡µ"><!--[--><span class="font-icon icon home" style=""></span><!--]-->åšå®¢ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="å­¦ä¹ ç¬”è®°"><!--[--><span class="font-icon icon framework" style=""></span>å­¦ä¹ ç¬”è®°<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">å‰ç«¯æ¡†æ¶</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/framework_front/vue3/" aria-label="Vue3ç¬”è®°"><!--[--><span class="font-icon icon vue" style=""></span><!--]-->Vue3ç¬”è®°<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/framework_front/react/" aria-label="Reactç¬”è®°"><!--[--><span class="font-icon icon react" style=""></span><!--]-->Reactç¬”è®°<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="æ–‡æ¡£"><!--[--><span class="font-icon icon framework" style=""></span>æ–‡æ¡£<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">æ¬è¿</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link route-link-active auto-link" href="/document/node-doc/" aria-label="Node.jsæ–‡æ¡£"><!--[--><span class="font-icon icon circle-info" style=""></span><!--]-->Node.jsæ–‡æ¡£<!----></a></li></ul></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/hanekawa-shiki/hanekawa-shiki.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/" aria-label="Node.jsæ–‡æ¡£"><!--[--><span class="font-icon icon circle-info" style=""></span><!--]-->Node.jsæ–‡æ¡£<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Assert.html" aria-label="Assert"><!---->Assert<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Async%20hooks.html" aria-label="Async hooks"><!---->Async hooks<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Asynchronous%20context%20tracking.html" aria-label="Asynchronous context tracking"><!---->Asynchronous context tracking<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Buffer.html" aria-label="Buffer"><!---->Buffer<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/C__%20addons.html" aria-label="C++ addons"><!---->C++ addons<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/C__%20embedder%20API.html" aria-label="C++ embedder API"><!---->C++ embedder API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Child%20process.html" aria-label="Child process"><!---->Child process<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Cluster.html" aria-label="Cluster"><!---->Cluster<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Command-line%20API.html" aria-label="Command-line API"><!---->Command-line API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Console.html" aria-label="Console"><!---->Console<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Corepack.html" aria-label="Corepack"><!---->Corepack<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Crypto.html" aria-label="Crypto"><!---->Crypto<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Debugger.html" aria-label="Debugger"><!---->Debugger<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Deprecated%20APIs.html" aria-label="Deprecated APIs"><!---->Deprecated APIs<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Diagnostic%20report.html" aria-label="Diagnostic report"><!---->Diagnostic report<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Diagnostics%20Channel.html" aria-label="Diagnostics Channel"><!---->Diagnostics Channel<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/DNS.html" aria-label="DNS"><!---->DNS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Domain.html" aria-label="Domain"><!---->Domain<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Errors.html" aria-label="Errors"><!---->Errors<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Events.html" aria-label="Events"><!---->Events<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/File%20system.html" aria-label="File system"><!---->File system<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Global%20objects.html" aria-label="Global objects"><!---->Global objects<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/HTTP.html" aria-label="HTTP"><!---->HTTP<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/HTTPS.html" aria-label="HTTPS"><!---->HTTPS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Inspector.html" aria-label="Inspector"><!---->Inspector<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Internationalization%20support.html" aria-label="Internationalization support"><!---->Internationalization support<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-CommonJS%20modules.html" aria-label="Modules: CommonJS modules"><!---->Modules: CommonJS modules<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-ECMAScript%20modules.html" aria-label="Modules: ECMAScript modules"><!---->Modules: ECMAScript modules<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-node_module%20API.html" aria-label="Modules: node:module API"><!---->Modules: node:module API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-Packages.html" aria-label="Modules: Packages"><!---->Modules: Packages<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Net.html" aria-label="Net"><!---->Net<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Node-API.html" aria-label="Node-API"><!---->Node-API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/OS.html" aria-label="OS"><!---->OS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Path.html" aria-label="Path"><!---->Path<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Performance%20measurement%20APIs.html" aria-label="Performance measurement APIs"><!---->Performance measurement APIs<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Permissions.html" aria-label="Permissions"><!---->Permissions<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Process.html" aria-label="Process"><!---->Process<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Punycode.html" aria-label="Punycode"><!---->Punycode<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Query%20string.html" aria-label="Query string"><!---->Query string<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Readline.html" aria-label="Readline"><!---->Readline<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/REPL.html" aria-label="REPL"><!---->REPL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Stream.html" aria-label="Stream"><!---->Stream<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/String%20decoder.html" aria-label="String decoder"><!---->String decoder<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/document/node-doc/Test%20runner.html" aria-label="Test runner"><!---->Test runner<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Timers.html" aria-label="Timers"><!---->Timers<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/TLS%20(SSL).html" aria-label="TLS (SSL)"><!---->TLS (SSL)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Trace%20events.html" aria-label="Trace events"><!---->Trace events<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/TTY.html" aria-label="TTY"><!---->TTY<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/URL.html" aria-label="URL"><!---->URL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Util.html" aria-label="Util"><!---->Util<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/V8.html" aria-label="V8"><!---->V8<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/VM%20(executing%20JavaScript).html" aria-label="VM (executing JavaScript)"><!---->VM (executing JavaScript)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Web%20Crypto%20API.html" aria-label="Web Crypto API"><!---->Web Crypto API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Web%20Streams%20API.html" aria-label="Web Streams API"><!---->Web Streams API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/WebAssembly%20System%20Interface%20(WASI).html" aria-label="WebAssembly System Interface (WASI)"><!---->WebAssembly System Interface (WASI)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Worker%20threads.html" aria-label="Worker threads"><!---->Worker threads<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Zlib.html" aria-label="Zlib"><!---->Zlib<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Test runner</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://hanekawa.top" target="_blank" rel="noopener noreferrer">hanekawa-shiki</a></span><span property="author" content="hanekawa-shiki"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-06-21T09:46:17.000Z"></span><!----><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 202 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT202M"></span><span class="page-word-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon" name="word"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 60518 å­—</span><meta property="wordCount" content="60518"></span><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨">å®é™…è¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#subtests">Subtests</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-subtests-çš„å¥½å¤„">ä½¿ç”¨ Subtests çš„å¥½å¤„ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­">å®é™…ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#skipping-tests">Skipping tests</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•è·³è¿‡æµ‹è¯•">å¦‚ä½•è·³è¿‡æµ‹è¯•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#describe-it-syntax">describe/it syntax</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#describe-å’Œ-it-çš„åŸºæœ¬æ¦‚å¿µ">describe å’Œ it çš„åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹">ç¤ºä¾‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#only-tests">only tests</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#only-tests-1">only tests</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#filtering-tests-by-name">Filtering tests by name</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-1">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#extraneous-asynchronous-activity">Extraneous asynchronous activity</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-extraneous-asynchronous-activity">ä»€ä¹ˆæ˜¯ Extraneous Asynchronous Activity?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•å¤„ç†">å¦‚ä½•å¤„ç†</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#watch-mode">Watch mode</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-1">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-1">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#running-tests-from-the-command-line">Running tests from the command line</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-1">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-ä¸­çš„æµ‹è¯•">Node.js ä¸­çš„æµ‹è¯•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-2">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-1">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#test-runner-execution-model">Test runner execution model</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#test-runner-execution-model-ç®€ä»‹">Test Runner Execution Model ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å…³é”®ç‚¹">å…³é”®ç‚¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-2">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#collecting-code-coverage">Collecting code coverage</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¼€å§‹æ”¶é›†ä»£ç è¦†ç›–ç‡">å¼€å§‹æ”¶é›†ä»£ç è¦†ç›–ç‡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-3">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#coverage-reporters">Coverage reporters</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯è¦†ç›–ç‡æŠ¥å‘Š">ä»€ä¹ˆæ˜¯è¦†ç›–ç‡æŠ¥å‘Šï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-v21-7-1-ä¸­çš„è¦†ç›–ç‡æŠ¥å‘Š">Node.js v21.7.1 ä¸­çš„è¦†ç›–ç‡æŠ¥å‘Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-4">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#limitations">Limitations</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-limitations">ä»€ä¹ˆæ˜¯â€œLimitationsâ€ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¸¸è§çš„-node-js-é™åˆ¶ç¤ºä¾‹">å¸¸è§çš„ Node.js é™åˆ¶ç¤ºä¾‹ï¼š</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mocking">Mocking</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-mocking">ä»€ä¹ˆæ˜¯ Mocking?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mocking-çš„å®é™…è¿ç”¨ä¾‹å­">Mocking çš„å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-5">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timers">Timers</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dates">Dates</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-åˆ›å»ºå½“å‰æ—¶é—´çš„æ—¥æœŸå¯¹è±¡">1. åˆ›å»ºå½“å‰æ—¶é—´çš„æ—¥æœŸå¯¹è±¡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-åˆ›å»ºç‰¹å®šæ—¥æœŸçš„å¯¹è±¡">2. åˆ›å»ºç‰¹å®šæ—¥æœŸçš„å¯¹è±¡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-è·å–å’Œè®¾ç½®æ—¥æœŸçš„å„ä¸ªéƒ¨åˆ†">3. è·å–å’Œè®¾ç½®æ—¥æœŸçš„å„ä¸ªéƒ¨åˆ†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-ä½¿ç”¨æ—¥æœŸå’Œæ—¶é—´æˆ³">4. ä½¿ç”¨æ—¥æœŸå’Œæ—¶é—´æˆ³</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨">å®é™…åº”ç”¨</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#test-reporters">Test reporters</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#custom-reporters">Custom reporters</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è‡ªå®šä¹‰æŠ¥å‘Šå™¨æ˜¯ä»€ä¹ˆ">è‡ªå®šä¹‰æŠ¥å‘Šå™¨æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰æŠ¥å‘Šå™¨">å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰æŠ¥å‘Šå™¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è‡ªå®šä¹‰æŠ¥å‘Šå™¨çš„å®é™…ä¾‹å­">è‡ªå®šä¹‰æŠ¥å‘Šå™¨çš„å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-6">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#multiple-reporters">Multiple reporters</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-3">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-multiple-reporters">å¦‚ä½•ä½¿ç”¨ Multiple Reporters</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#run-options">run([options])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-2">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼">è¿”å›å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-2">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“">å°ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#test-name-options-fn">test([name][, options][, fn])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#test-å‡½æ•°ç®€ä»‹">test() å‡½æ•°ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹è¯´æ˜">ç¤ºä¾‹è¯´æ˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è¯­">ç»“è¯­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#test-skip-name-options-fn">test.skip([name][, options][, fn])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š">å‚æ•°è§£é‡Šï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-2">å¦‚ä½•ä½¿ç”¨ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-1">å°ç»“ï¼š</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#test-todo-name-options-fn">test.todo([name][, options][, fn])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¯­æ³•">è¯­æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-3">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#test-only-name-options-fn">test.only([name][, options][, fn])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-1">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#describe-name-options-fn">describe([name][, options][, fn])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€æ¦‚å¿µ">åŸºç¡€æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨æ–¹æ³•">ä½¿ç”¨æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-1">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#describe-skip-name-options-fn">describe.skip([name][, options][, fn])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯´æ˜">å‚æ•°è¯´æ˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸¾ä¾‹è¯´æ˜">ä¸¾ä¾‹è¯´æ˜</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#describe-todo-name-options-fn">describe.todo([name][, options][, fn])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯describe-todo">ä»€ä¹ˆæ˜¯describe.todo</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨describe-todo">å¦‚ä½•ä½¿ç”¨describe.todo</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-4">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#describe-only-name-options-fn">describe.only([name][, options][, fn])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-1">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-1">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#it-name-options-fn">it([name][, options][, fn])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-2">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-5">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#it-skip-name-options-fn">it.skip([name][, options][, fn])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-3">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-it-skip">ä½¿ç”¨ it.skip</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-2">å°ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#it-todo-name-options-fn">it.todo([name][, options][, fn])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#it-only-name-options-fn">it.only([name][, options][, fn])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-2">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-2">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„ç‚¹">æ³¨æ„ç‚¹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#before-fn-options">before([fn][, options])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€æ¦‚å¿µ-1">åŸºç¡€æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯´æ˜-1">å‚æ•°è¯´æ˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-2">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-7">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#after-fn-options">after([fn][, options])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#after-fn-options-ç®€ä»‹">after([fn][, options]) ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-6">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-8">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#beforeeach-fn-options">beforeEach([fn][, options])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-beforeeach">ä»€ä¹ˆæ˜¯ beforeEach?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°-1">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¸¾ä¾‹">å®é™…åº”ç”¨ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-9">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#aftereach-fn-options">afterEach([fn][, options])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-3">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¸¾ä¾‹-1">å®é™…åº”ç”¨ä¸¾ä¾‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-mockfunctioncontext">Class: MockFunctionContext</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯mockfunctioncontext">ä»€ä¹ˆæ˜¯MockFunctionContextï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-2">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-3">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ctx-calls">ctx.calls</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ctx-calls-ç†è§£">ctx.calls ç†è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¸¾ä¾‹">å®é™…è¿ç”¨ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ctx-callcount">ctx.callCount()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-3">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ctx-mockimplementation-implementation">ctx.mockImplementation(implementation)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-mocking-1">ä»€ä¹ˆæ˜¯ Mockingï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ctx-mockimplementation-implementation-ä»‹ç»">ctx.mockImplementation(implementation)ä»‹ç»</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åº”ç”¨ç¤ºä¾‹">åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ctx-mockimplementationonce-implementation-oncall">ctx.mockImplementationOnce(implementation[, onCall])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-4">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯-1">ä½¿ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-4">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-4">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ctx-resetcalls">ctx.resetCalls()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#èƒŒæ™¯">èƒŒæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ctx-resetcalls-1">ctx.resetCalls()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆéœ€è¦å®ƒ">ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-7">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ctx-restore">ctx.restore()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‡è®¾-1-å›¾å½¢å’Œç”»å¸ƒæ“ä½œ">å‡è®¾ 1: å›¾å½¢å’Œç”»å¸ƒæ“ä½œ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‡è®¾-2-mocking-æ¡†æ¶ä¸­çš„ä¸Šä¸‹æ–‡æ¢å¤">å‡è®¾ 2: Mocking æ¡†æ¶ä¸­çš„ä¸Šä¸‹æ–‡æ¢å¤</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-mocktracker">Class: MockTracker</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ¦‚å¿µè§£é‡Š">æ¦‚å¿µè§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-4">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-10">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mock-fn-original-implementation-options">mock.fn([original[, implementation]][, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬ç†è§£">åŸºæœ¬ç†è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯¦è§£">å‚æ•°è¯¦è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-3">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-11">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mock-getter-object-methodname-implementation-options">mock.getter(object, methodName[, implementation][, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-4">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-8">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mock-method-object-methodname-implementation-options">mock.method(object, methodName[, implementation][, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-mocking-2">ä»€ä¹ˆæ˜¯ Mockingï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mock-method-å‡½æ•°">mock.method å‡½æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-3">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mock-reset">mock.reset()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å•å…ƒæµ‹è¯•">å•å…ƒæµ‹è¯•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mocking-1">Mocking</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mock-reset-1">mock.reset()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mock-restoreall">mock.restoreAll()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£-mocking">ç†è§£ Mocking</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mock-restoreall-1">mock.restoreAll()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯å’Œç¤ºä¾‹">ä½¿ç”¨åœºæ™¯å’Œç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mock-setter-object-methodname-implementation-options">mock.setter(object, methodName[, implementation][, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯´æ˜-2">å‚æ•°è¯´æ˜ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­">ä½¿ç”¨ä¾‹å­ï¼š</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-mocktimers">Class: MockTimers</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-mocktimers">å¦‚ä½•ä½¿ç”¨ MockTimersï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-4">å®é™…è¿ç”¨ç¤ºä¾‹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timers-enable-enableoptions">timers.enable([enableOptions])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-5">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timers-reset">timers.reset()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timers-å’Œ-reset-æ¦‚å¿µ">timers å’Œ reset æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‡æƒ³çš„ä½¿ç”¨ä¾‹å­">å‡æƒ³çš„ä½¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-12">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timerssymbol-dispose-https-nodejs-org-docs-latest-api-test-html-timerssymboldispose">[timersSymbol.dispose](https://nodejs.org/docs/latest/api/test.html#timerssymboldispose)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#èƒŒæ™¯-ä»€ä¹ˆæ˜¯å®šæ—¶å™¨">èƒŒæ™¯ï¼šä»€ä¹ˆæ˜¯å®šæ—¶å™¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ–°ç‰¹æ€§-timers-symbol-dispose">æ–°ç‰¹æ€§ï¼štimers[Symbol.dispose]()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åº”ç”¨ç¤ºä¾‹-1">åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-13">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timers-tick-milliseconds">timers.tick(milliseconds)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-6">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯ç¤ºä¾‹">ä½¿ç”¨åœºæ™¯ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-1">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-ç®€å•çš„åŠ æ³•å‡½æ•°">ä¾‹å­ 1ï¼šç®€å•çš„åŠ æ³•å‡½æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-å¼‚æ­¥æ•°æ®è·å–">ä¾‹å­ 2ï¼šå¼‚æ­¥æ•°æ®è·å–</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-3-æ¸…é™¤å®šæ—¶å™¨">ä¾‹å­ 3ï¼šæ¸…é™¤å®šæ—¶å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timers-runall">timers.runAll()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-3">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-2">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timers-settime-milliseconds">timers.setTime(milliseconds)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#settimeout">setTimeout()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#setinterval">setInterval()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ—¥æœŸ-dates-ä¸-node-js">æ—¥æœŸï¼ˆDatesï¼‰ä¸ Node.js</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®šæ—¶å™¨-timers-ä¸-node-js">å®šæ—¶å™¨ï¼ˆTimersï¼‰ä¸ Node.js</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“åˆä½¿ç”¨æ—¥æœŸå’Œå®šæ—¶å™¨">ç»“åˆä½¿ç”¨æ—¥æœŸå’Œå®šæ—¶å™¨</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-testsstream">Class: TestsStream</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç›¸å…³æ¦‚å¿µç®€ä»‹">ç›¸å…³æ¦‚å¿µç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-5">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-test-coverage">Event: &#39;test:coverage&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æµ‹è¯•è¦†ç›–ç‡">æµ‹è¯•è¦†ç›–ç‡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-å†…ç½®æµ‹è¯•æ¡†æ¶">Node.js å†…ç½®æµ‹è¯•æ¡†æ¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#test-coverage-äº‹ä»¶">test:coverage äº‹ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-14">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-test-dequeue">Event: &#39;test:dequeue&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯äº‹ä»¶">ä»€ä¹ˆæ˜¯äº‹ä»¶ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#äº‹ä»¶çš„å·¥ä½œåŸç†">äº‹ä»¶çš„å·¥ä½œåŸç†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-5">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-test-diagnostic">Event: &#39;test:diagnostic&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-emitter">Event Emitter</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#test-diagnostic-äº‹ä»¶">&#39;test:diagnostic&#39; äº‹ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-3">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-test-enqueue">Event: &#39;test:enqueue&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€æ¦‚å¿µ-2">åŸºç¡€æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-event-test-enqueue">è§£é‡Š Event: &#39;test:enqueue&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-4">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-test-fail">Event: &#39;test:fail&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#äº‹ä»¶æ˜¯ä»€ä¹ˆ">äº‹ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-test-fail-çš„å«ä¹‰">Event: &#39;test:fail&#39; çš„å«ä¹‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¸¾ä¾‹-1">å®é™…è¿ç”¨ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•å“åº”-test-fail-äº‹ä»¶">å¦‚ä½•å“åº” test:fail äº‹ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-test-pass">Event: &#39;test:pass&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-3">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-9">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-4">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-test-plan">Event: &#39;test:plan&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-test-start">Event: &#39;test:start&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-test-start-1">Event: &#39;test:start&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-test-stderr">Event: &#39;test:stderr&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€æ¦‚å¿µ-3">åŸºç¡€æ¦‚å¿µï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-test-stderr-1">Event: &#39;test:stderr&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-test-stdout">Event: &#39;test:stdout&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-node-js">ä»€ä¹ˆæ˜¯ Node.jsï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#äº‹ä»¶ç³»ç»Ÿ">äº‹ä»¶ç³»ç»Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ ‡å‡†è¾“å‡º-stdout">æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“åˆæ¦‚å¿µ">ç»“åˆæ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-testdrained">Event: &#39;testâŒšdrained&#39;</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-testcontext">Class: TestContext</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#testcontext-ç±»ç®€ä»‹">TestContext ç±»ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-testcontext">å¦‚ä½•ä½¿ç”¨ TestContext</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨-2">å®é™…åº”ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#context-before-fn-options">context.before([fn][, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£-context-before-fn-options">ç†è§£ context.before([fn][, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-10">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-15">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#context-beforeeach-fn-options">context.beforeEach([fn][, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-7">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#context-beforeeach">context.beforeEach</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#context-after-fn-options">context.after([fn][, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#context-after-fn-options-1">context.after([fn][, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-11">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#context-aftereach-fn-options">context.afterEach([fn][, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£æ">å‚æ•°è§£æ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-7">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-16">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#context-diagnostic-message">context.diagnostic(message)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#é€šä¿—è§£é‡Š">é€šä¿—è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-7">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#context-name">context.name</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸Šä¸‹æ–‡-context-çš„å«ä¹‰">ä¸Šä¸‹æ–‡ï¼ˆContextï¼‰çš„å«ä¹‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åœ¨-node-js-ä¸­çš„åº”ç”¨ç¤ºä¾‹">åœ¨ Node.js ä¸­çš„åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-5">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#context-runonly-shouldrunonlytests">context.runOnly(shouldRunOnlyTests)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#context-runonly-shouldrunonlytests-1">context.runOnly(shouldRunOnlyTests)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-8">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#context-signal">context.signal</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-abortcontroller-å’Œ-abortsignal">ä»€ä¹ˆæ˜¯ AbortController å’Œ AbortSignalï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#context-signal-åœ¨-node-js-ä¸­çš„åº”ç”¨">context.signal åœ¨ Node.js ä¸­çš„åº”ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#context-skip-message">context.skip([message])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯å’Œå®é™…è¿ç”¨ç¤ºä¾‹">ä½¿ç”¨åœºæ™¯å’Œå®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#context-todo-message">context.todo([message])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£-context-todo">ç†è§£ context.todo</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°-4">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-12">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-17">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#context-test-name-options-fn">context.test([name][, options][, fn])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ¦‚å¿µè§£æ">æ¦‚å¿µè§£æ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯¦è§£-1">å‚æ•°è¯¦è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹è®²è§£">å®ä¾‹è®²è§£</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-suitecontext">Class: SuiteContext</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€æ¦‚å¿µ-4">åŸºç¡€æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#suitecontext-ç±»">SuiteContext ç±»</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#context-name-1">context.name</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#context-signal-1">context.signal</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-context-signal">ä»€ä¹ˆæ˜¯ context.signalï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-13">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="test-runner" tabindex="-1"><a class="header-anchor" href="#test-runner"><span><a href="https://nodejs.org/docs/latest/api/test.html#test-runner" target="_blank" rel="noopener noreferrer">Test runner</a></span></a></h1><p>Node.js v21.7.1 ä¸­çš„æµ‹è¯•è¿è¡Œå™¨ï¼ˆTest Runnerï¼‰æ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°å¼•å…¥çš„åŠŸèƒ½ï¼Œå®ƒæä¾›äº†ä¸€ç§åœ¨ Node.js ç¯å¢ƒä¸­æ‰§è¡Œ JavaScript æµ‹è¯•ä»£ç çš„æ ‡å‡†å’Œç®€æ´æ–¹å¼ã€‚æœ¬è´¨ä¸Šï¼Œå®ƒæ˜¯ Node.js ç”Ÿæ€ç³»ç»Ÿä¸­ç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•çš„ä¸€ä¸ªå·¥å…·ï¼Œæ—¨åœ¨è®©å¼€å‘è€…èƒ½å¤Ÿè½»æ¾åœ°ç¼–å†™å’Œè¿è¡Œæµ‹è¯•ï¼Œä»è€Œä¿è¯ä»£ç è´¨é‡ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>åœ¨æ·±å…¥ç ”ç©¶å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç†è§£å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p><ul><li><strong>æµ‹è¯•è¿è¡Œå™¨ï¼ˆTest Runnerï¼‰</strong>ï¼šå°±æ˜¯æ‰§è¡Œæµ‹è¯•è„šæœ¬çš„ç¨‹åºï¼Œå®ƒä¼šè‡ªåŠ¨è¿è¡Œå†™å¥½çš„æµ‹è¯•ä»£ç ï¼Œç„¶åç»™å‡ºæµ‹è¯•æ˜¯å¦é€šè¿‡çš„åé¦ˆã€‚</li><li><strong>æµ‹è¯•æ¡†æ¶ï¼ˆTesting Frameworkï¼‰</strong>ï¼šæä¾›ä¸€å¥—ç¼–å†™æµ‹è¯•ç”¨ä¾‹çš„è§„åˆ™å’Œå·¥å…·ï¼Œä½¿å¾—æµ‹è¯•å¯ä»¥ç³»ç»Ÿæ€§åœ°è¿›è¡Œã€‚</li><li><strong>æ–­è¨€åº“ï¼ˆAssertion Libraryï¼‰</strong>ï¼šæä¾›ä¸€ç³»åˆ—ç”¨äºæµ‹è¯•çš„â€œæ–­è¨€â€æ–¹æ³•ï¼Œç”¨æ¥éªŒè¯ä»£ç è¡Œä¸ºæ˜¯å¦ç¬¦åˆé¢„æœŸã€‚</li></ul><p>Node.js çš„æµ‹è¯•è¿è¡Œå™¨å°±ç»“åˆäº†è¿™äº›åŠŸèƒ½ï¼Œä½¿å¾—åœ¨ Node.js åº”ç”¨æˆ–æ¨¡å—çš„å¼€å‘è¿‡ç¨‹ä¸­åŠ å…¥è‡ªåŠ¨åŒ–æµ‹è¯•å˜å¾—æ›´åŠ å®¹æ˜“ã€‚</p><h3 id="å®é™…è¿ç”¨" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨"><span>å®é™…è¿ç”¨</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„é¡¹ç›®ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå‡½æ•°<code>addNumbers</code>ï¼Œè¿™ä¸ªå‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°å¹¶è¿”å›å®ƒä»¬çš„å’Œã€‚ä½¿ç”¨ Node.js çš„æµ‹è¯•è¿è¡Œå™¨ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åˆ›å»ºä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹æ¥æµ‹è¯•è¿™ä¸ªå‡½æ•°ï¼š</p><ol><li>é¦–å…ˆï¼Œç¡®ä¿ä½ çš„é¡¹ç›®ä¸­æœ‰ Node.js v21.7.1 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚</li><li>æ¥ç€ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œæ¯”å¦‚<code>test.js</code>ã€‚</li></ol><p>ç°åœ¨ï¼Œæˆ‘ä»¬å°†ç¼–å†™å®é™…çš„æµ‹è¯•ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">addNumbers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;./yourFunctionFile.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥ä½ çš„å‡½æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹è¯•ç”¨ä¾‹ï¼šæ£€æŸ¥`addNumbers`å‡½æ•°æ˜¯å¦æ­£å¸¸å·¥ä½œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> testAddNumbers</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> addNumbers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨æ–­è¨€åº“éªŒè¯ç»“æœæ˜¯å¦ä¸º5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">testAddNumbers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰§è¡Œæµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† Node.js åŸç”Ÿçš„<code>assert</code>æ¨¡å—æ¥ä½¿ç”¨å…¶æ–­è¨€æ–¹æ³•ã€‚ç´§æ¥ç€ï¼Œæˆ‘ä»¬å¯¼å…¥äº†æˆ‘ä»¬æœŸæœ›æµ‹è¯•çš„å‡½æ•°<code>addNumbers</code>ã€‚ä¹‹åï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹<code>testAddNumbers</code>ï¼Œåœ¨è¯¥æµ‹è¯•ç”¨ä¾‹ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨äº†<code>addNumbers</code>å‡½æ•°ï¼Œå¹¶ä½¿ç”¨<code>assert.strictEqual</code>æ¥éªŒè¯ç»“æœæ˜¯å¦ç¬¦åˆé¢„æœŸï¼ˆå³ 2 + 3 æ˜¯å¦ç­‰äº 5ï¼‰ã€‚æœ€åï¼Œæˆ‘ä»¬æ‰§è¡Œäº†è¿™ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œå¹¶åœ¨æ§åˆ¶å°æ‰“å°å‡ºæˆåŠŸä¿¡æ¯ã€‚</p><p>è¦è¿è¡Œè¿™ä¸ªæµ‹è¯•ï¼Œä½ åªéœ€åœ¨ç»ˆç«¯ä¸­å¯¼èˆªåˆ°ä½ çš„é¡¹ç›®ç›®å½•ï¼Œå¹¶æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">node</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> test.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œä½ å°†åœ¨æ§åˆ¶å°çœ‹åˆ°â€œæ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼â€çš„æ¶ˆæ¯ã€‚å¦‚æœ<code>addNumbers</code>å‡½æ•°çš„å®ç°æœ‰è¯¯ï¼Œ<code>assert</code>ä¼šæŠ›å‡ºé”™è¯¯ï¼Œå‘ŠçŸ¥ä½ æµ‹è¯•æœªé€šè¿‡ã€‚</p><h3 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“"><span>æ€»ç»“</span></a></h3><p>Node.js çš„æµ‹è¯•è¿è¡Œå™¨æä¾›äº†ä¸€ä¸ªè½»é‡çº§ã€ç®€å•ç›´æ¥çš„æ–¹å¼æ¥ä¸ºä½ çš„ JavaScript ä»£ç ç¼–å†™å’Œæ‰§è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚é€šè¿‡ä½¿ç”¨æµ‹è¯•è¿è¡Œå™¨ï¼Œä½ å¯ä»¥ç¡®ä¿ä½ çš„å‡½æ•°æˆ–åº”ç”¨è¡¨ç°å¦‚é¢„æœŸï¼Œä»è€Œå¤§å¹…åº¦æé«˜å¼€å‘æ•ˆç‡å’Œä»£ç è´¨é‡ã€‚è®°ä½ï¼Œè‰¯å¥½çš„æµ‹è¯•è¦†ç›–æ˜¯é«˜è´¨é‡è½¯ä»¶å¼€å‘çš„å…³é”®ã€‚</p><h2 id="subtests" tabindex="-1"><a class="header-anchor" href="#subtests"><span><a href="https://nodejs.org/docs/latest/api/test.html#subtests" target="_blank" rel="noopener noreferrer">Subtests</a></span></a></h2><p>Node.js ä¸­çš„ &quot;Subtests&quot; æ˜¯æµ‹è¯•ç›¸å…³çš„æ¦‚å¿µï¼Œç”¨äºåœ¨ç¼–å†™ä»£ç æµ‹è¯•æ—¶ç»„ç»‡å’Œåˆ†éš”ä½ çš„æµ‹è¯•ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯é€šè¿‡ Node.js çš„å†…ç½®æµ‹è¯•æ¨¡å—æä¾›çš„ï¼Œè¿™ä¸ªæ¨¡å—é€šå¸¸è¢«ç§°ä¸º <code>assert</code>ã€‚</p><p>æƒ³è±¡ä¸€ä¸‹ï¼Œå½“ä½ å†™äº†ä¸€ä¸ªåº”ç”¨æˆ–è€…åº“æ—¶ï¼Œä½ éœ€è¦ç¡®ä¿å®ƒæŒ‰ç…§é¢„æœŸå·¥ä½œã€‚è¿™é€šå¸¸æ„å‘³ç€ä¸ºä½ çš„ä»£ç ç¼–å†™æµ‹è¯•ã€‚æµ‹è¯•å¯ä»¥å¸®åŠ©ä½ éªŒè¯æ¯éƒ¨åˆ†ä»£ç éƒ½èƒ½å¦‚ä½ æ‰€æ„¿è¿è¡Œã€‚è€Œå½“ä½ æœ‰å¾ˆå¤šæµ‹è¯•éœ€è¦æ‰§è¡Œæ—¶ï¼Œå°†å®ƒä»¬ç»„ç»‡å¾—äº•äº•æœ‰æ¡å°±æ˜¾å¾—å°¤ä¸ºé‡è¦äº†ã€‚</p><h3 id="ä½¿ç”¨-subtests-çš„å¥½å¤„" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-subtests-çš„å¥½å¤„"><span>ä½¿ç”¨ Subtests çš„å¥½å¤„ï¼š</span></a></h3><ul><li><strong>ç»“æ„åŒ–</strong>ï¼šå¸®åŠ©ä½ å°†ç›¸å…³çš„æµ‹è¯•ç»„ç»‡åœ¨ä¸€èµ·ï¼Œè®©æ•´ä¸ªæµ‹è¯•è¿‡ç¨‹æ›´åŠ æœ‰æ¡ç†ã€‚</li><li><strong>æ˜“äºç†è§£</strong>ï¼šå½“åˆ«äººï¼ˆæˆ–æœªæ¥çš„ä½ ï¼‰é˜…è¯»ä½ çš„æµ‹è¯•ä»£ç æ—¶ï¼Œå¯ä»¥æ›´å®¹æ˜“åœ°ç†è§£æ¯ä¸ªæµ‹è¯•åŠå…¶ç›®çš„ã€‚</li><li><strong>åˆ†éš”</strong>ï¼šå…è®¸ä½ ç‹¬ç«‹è¿è¡Œå­éƒ¨åˆ†çš„æµ‹è¯•ï¼Œè¿™å¯¹äºè°ƒè¯•å¤§å‹é¡¹ç›®ç‰¹åˆ«æœ‰ç”¨ã€‚</li></ul><h3 id="å®é™…ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç®€å•çš„åœ¨çº¿å•†åº—åº”ç”¨ï¼Œä½ å¯èƒ½ä¼šæœ‰ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†éœ€è¦æµ‹è¯•ï¼š</p><ol><li><strong>ç”¨æˆ·è®¤è¯</strong>ï¼šæ³¨å†Œã€ç™»å½•ã€ç™»å‡ºã€‚</li><li><strong>å•†å“ç®¡ç†</strong>ï¼šæ·»åŠ å•†å“ã€åˆ é™¤å•†å“ã€ç¼–è¾‘å•†å“ã€‚</li><li><strong>è´­ç‰©è½¦åŠŸèƒ½</strong>ï¼šæ·»åŠ å•†å“åˆ°è´­ç‰©è½¦ã€ä»è´­ç‰©è½¦ä¸­ç§»é™¤å•†å“ã€æ¸…ç©ºè´­ç‰©è½¦ã€‚</li></ol><p>æ²¡æœ‰ä½¿ç”¨ subtests çš„æƒ…å†µä¸‹ï¼Œä½ çš„æµ‹è¯•æ–‡ä»¶å¯èƒ½çœ‹èµ·æ¥ä¼šéå¸¸åºå¤§å’Œæ··ä¹±ã€‚å¼•å…¥ subtests åï¼Œä½ å¯ä»¥æŠŠæ¯ä¸ªä¸»è¦åŠŸèƒ½ç‚¹åˆ†æˆä¸åŒçš„å°ç»„æ¥æµ‹è¯•ï¼Œæ¯ä¸ªå°ç»„é‡Œå†æ ¹æ®å…·ä½“åŠŸèƒ½åˆ’åˆ†å­æµ‹è¯•ã€‚è¿™æ ·å°±èƒ½è®©æ•´ä¸ªæµ‹è¯•ç»“æ„å˜å¾—æ›´æ¸…æ™°ï¼Œä¹Ÿæ›´å®¹æ˜“ç®¡ç†ã€‚</p><p>ä¾‹å¦‚ï¼Œå¯¹äºç”¨æˆ·è®¤è¯åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ç»„ç»‡æµ‹è¯•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">strict</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡å®šæœ‰ä¸€ä¸ªç”¨äºå¤„ç†ç”¨æˆ·è®¤è¯çš„ç±»Authenticator</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> Authenticator</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./Authenticator&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç”¨æˆ·è®¤è¯&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ³¨å†Œ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // Subtest 1: æµ‹è¯•ç”¨æˆ·èƒ½å¦æˆåŠŸæ³¨å†Œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Authenticator</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">register</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;username&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">success</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç™»å½•&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // Subtest 2: æµ‹è¯•ç”¨æˆ·èƒ½å¦æˆåŠŸç™»å½•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Authenticator</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">login</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;username&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">success</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç™»å‡º&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // Subtest 3: æµ‹è¯•ç”¨æˆ·èƒ½å¦æˆåŠŸç™»å‡º</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Authenticator</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">logout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">success</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œ<code>describe</code>å’Œ<code>it</code>å‡½æ•°æ˜¯å¸¸è§çš„æµ‹è¯•æ¡†æ¶ï¼ˆå¦‚ Mochaï¼‰ç”¨äºç»„ç»‡æµ‹è¯•çš„æ–¹æ³•ã€‚æ¯ä¸ª<code>it</code>å‡½æ•°ä»£è¡¨ä¸€ä¸ªå°æµ‹è¯•ï¼ˆæˆ– subtestï¼‰ï¼Œè€Œ<code>describe</code>å‡½æ•°åˆ™ç”¨æ¥å°†è¿™äº›å°æµ‹è¯•èšåˆæˆä¸€ä¸ªå¤§çš„æµ‹è¯•é›†ã€‚è™½ç„¶è¿™ä¸æ˜¯ Node.js åŸç”Ÿæ”¯æŒçš„åŠŸèƒ½ï¼Œä½†å®ƒå±•ç¤ºäº† subtests åœ¨å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨ï¼šå°†ç›¸å…³çš„æµ‹è¯•åˆ†ç»„å¹¶æ¸…æ™°åœ°æè¿°å®ƒä»¬ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆªè‡³æˆ‘æœ€åæ›´æ–°çš„çŸ¥è¯†ï¼ˆ2023 å¹´ï¼‰ï¼ŒNode.js çš„ <code>assert</code> æ¨¡å—æœ¬èº«å¹¶ä¸ç›´æ¥æ”¯æŒ <code>describe</code> å’Œ <code>it</code> è¿™æ ·çš„ç»“æ„ã€‚ä¸Šè¿°ä¾‹å­ä¸­çš„ <code>describe</code> å’Œ <code>it</code> å‡½æ•°é€šå¸¸æ˜¯ç”±ç¬¬ä¸‰æ–¹æµ‹è¯•åº“ï¼ˆå¦‚ Mocha æˆ– Jestï¼‰æä¾›çš„ã€‚è¿™äº›åº“æ‰çœŸæ­£å¼•å…¥äº† subtests çš„æ¦‚å¿µï¼Œå¹¶ä½¿å¾—ç»„ç»‡å’Œæ‰§è¡Œæµ‹è¯•å˜å¾—æ›´å®¹æ˜“ã€‚åœ¨æŸ¥æ‰¾å…³äº Node.js v21.7.1 ç‰¹å®šçš„ <code>Subtests</code> åŠŸèƒ½æ—¶ï¼Œè¯·ç¡®è®¤æ˜¯å¦æ˜¯æŒ‡ Node.js çš„å®˜æ–¹æ–‡æ¡£æˆ– API ä¸­çš„æ–°ç‰¹æ€§ï¼Œå› ä¸ºæ ¹æ®æˆ‘çš„æœ€æ–°ä¿¡æ¯ï¼Œ<code>assert</code> æ¨¡å—ä¸»è¦æ˜¯ç”¨äºæ–­è¨€æµ‹è¯•ç»“æœï¼Œè€Œä¸æ˜¯ç»„ç»‡æµ‹è¯•ã€‚</p><h2 id="skipping-tests" tabindex="-1"><a class="header-anchor" href="#skipping-tests"><span><a href="https://nodejs.org/docs/latest/api/test.html#skipping-tests" target="_blank" rel="noopener noreferrer">Skipping tests</a></span></a></h2><p>åœ¨ç¼–ç¨‹ä¸­ï¼Œç‰¹åˆ«æ˜¯åœ¨è¿›è¡Œè½¯ä»¶å¼€å‘æ—¶ï¼Œæµ‹è¯•æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„éƒ¨åˆ†ã€‚å®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç¡®ä¿ä»£ç æŒ‰é¢„æœŸè¿è¡Œï¼Œå¹¶ä¸”èƒ½å¤Ÿå‘ç°å’Œä¿®å¤æ½œåœ¨çš„é”™è¯¯ã€‚æœ‰æ—¶å€™ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦è·³è¿‡ä¸€äº›æµ‹è¯•ã€‚è¿™å¯èƒ½æ˜¯å› ä¸ºé‚£äº›æµ‹è¯•åœ¨å½“å‰ç¯å¢ƒä¸‹ä¸é€‚ç”¨ï¼Œæˆ–è€…æˆ‘ä»¬æ­£åœ¨å·¥ä½œçš„åŠŸèƒ½è¿˜æ²¡æœ‰å‡†å¤‡å¥½è¿›è¡Œæµ‹è¯•ã€‚</p><p>Node.js æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„æµ‹è¯•æ¡†æ¶ï¼Œå…è®¸å¼€å‘è€…ç¼–å†™å’Œè¿è¡Œæµ‹è¯•ã€‚åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œä¹Ÿæ”¯æŒäº†è·³è¿‡æµ‹è¯•çš„åŠŸèƒ½ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨æµ‹è¯•ä»£ç ä¸­æŒ‡å®šå“ªäº›æµ‹è¯•åº”è¯¥è¢«å¿½ç•¥ï¼Œè€Œä¸æ˜¯å®Œå…¨ç§»é™¤è¿™äº›æµ‹è¯•ä»£ç æˆ–æ‰‹åŠ¨æ³¨é‡Šæ‰å®ƒä»¬ã€‚è¿™ä¸ªåŠŸèƒ½å¯¹äºç®¡ç†å¤§å‹é¡¹ç›®ä¸­çš„æµ‹è¯•ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸å¼€å‘è€…çµæ´»åœ°æ§åˆ¶å“ªäº›æµ‹è¯•è¢«æ‰§è¡Œã€‚</p><h3 id="å¦‚ä½•è·³è¿‡æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•è·³è¿‡æµ‹è¯•"><span>å¦‚ä½•è·³è¿‡æµ‹è¯•</span></a></h3><p>è·³è¿‡æµ‹è¯•é€šå¸¸æ¶‰åŠåˆ°åœ¨æµ‹è¯•ä»£ç ä¸­ä½¿ç”¨ç‰¹å®šçš„å‘½ä»¤æˆ–å‡½æ•°æ¥æ ‡è®°é‚£äº›ä¸åº”è¯¥è¢«æ‰§è¡Œçš„æµ‹è¯•ã€‚</p><p>å‡è®¾ä½ æœ‰ä»¥ä¸‹ç®€å•çš„æµ‹è¯•ç”¨ä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ­£å¸¸çš„æµ‹è¯•ç”¨ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should return true&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// éœ€è¦è¢«è·³è¿‡çš„æµ‹è¯•ç”¨ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should return false&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ Node.js ä¸­ï¼Œå¦‚æœä½ æƒ³è·³è¿‡ç¬¬äºŒä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>.skip</code>æ–¹æ³•æ¥å®ç°ï¼Œåƒè¿™æ ·ä¿®æ”¹ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should return true&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·³è¿‡è¿™ä¸ªæµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">skip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should return false&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡æ·»åŠ <code>.skip</code>ï¼Œç¬¬äºŒä¸ªæµ‹è¯•ç”¨ä¾‹å°†è¢«è·³è¿‡ï¼Œæµ‹è¯•æŠ¥å‘Šå°†æ˜¾ç¤ºè¯¥æµ‹è¯•å·²è¢«è·³è¿‡ï¼Œä½†ä¸ä¼šå½±å“å…¶ä»–æµ‹è¯•ç”¨ä¾‹çš„æ‰§è¡Œã€‚</p><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-æ¡ä»¶æ€§è·³è¿‡æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æ¡ä»¶æ€§è·³è¿‡æµ‹è¯•"><span>ç¤ºä¾‹ 1ï¼šæ¡ä»¶æ€§è·³è¿‡æµ‹è¯•</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œå…¶ä¸­æŸäº›æµ‹è¯•ç”¨ä¾‹åªé€‚ç”¨äºç‰¹å®šçš„æ“ä½œç³»ç»Ÿã€‚ä½ å¯ä»¥åœ¨è¿è¡Œæµ‹è¯•ä¹‹å‰æ£€æŸ¥æ“ä½œç³»ç»Ÿç±»å‹ï¼Œç„¶åæ ¹æ®ç»“æœè·³è¿‡æŸäº›æµ‹è¯•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> os</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;os&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™ä¸ªæµ‹è¯•ä»…åœ¨Linuxä¸Šè¿è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">os</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">platform</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">!==</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;linux&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">skip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should run only on Linux&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æµ‹è¯•å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should run only on Linux&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æµ‹è¯•å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-è·³è¿‡æœªå®Œæˆçš„æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-è·³è¿‡æœªå®Œæˆçš„æµ‹è¯•"><span>ç¤ºä¾‹ 2ï¼šè·³è¿‡æœªå®Œæˆçš„æµ‹è¯•</span></a></h4><p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä½ å¯èƒ½é‡åˆ°ä¸€äº›åŠŸèƒ½è¿˜åœ¨å¼€å‘ä¸­ï¼Œç›¸åº”çš„æµ‹è¯•ç”¨ä¾‹ä¹Ÿè¿˜æ²¡å‡†å¤‡å¥½çš„æƒ…å†µã€‚è¿™æ—¶ï¼Œä½ å¯ä»¥æš‚æ—¶è·³è¿‡è¿™äº›æµ‹è¯•ï¼Œä»¥å…å®ƒä»¬å½±å“åˆ°æ„å»ºè¿‡ç¨‹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™ä¸ªåŠŸèƒ½è¿˜åœ¨å¼€å‘ä¸­</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">skip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should test a feature still under development&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹è¯•å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ€»ä¹‹ï¼Œè·³è¿‡æµ‹è¯•æ˜¯æµ‹è¯•ç­–ç•¥ä¸­çš„ä¸€ä¸ªçµæ´»å·¥å…·ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ æ›´æœ‰æ•ˆåœ°ç®¡ç†å’Œç»´æŠ¤ä½ çš„æµ‹è¯•å¥—ä»¶ã€‚åœ¨ Node.js ä¸­å®ç°è¿™ä¸€åŠŸèƒ½éå¸¸ç®€å•ï¼Œåªéœ€ä½¿ç”¨<code>.skip</code>æ–¹æ³•å³å¯è½»æ¾æ§åˆ¶å“ªäº›æµ‹è¯•è¢«æ‰§è¡Œï¼Œå“ªäº›è¢«è·³è¿‡ã€‚</p><h2 id="describe-it-syntax" tabindex="-1"><a class="header-anchor" href="#describe-it-syntax"><span><a href="https://nodejs.org/docs/latest/api/test.html#describeit-syntax" target="_blank" rel="noopener noreferrer">describe/it syntax</a></span></a></h2><p>Node.js v21.7.1 ä¸­çš„<code>describe/it</code>è¯­æ³•æ˜¯ä¸€ç§ç”¨äºç¼–å†™æµ‹è¯•çš„æ–¹å¼ï¼Œç‰¹åˆ«é€‚ç”¨äºç»„ç»‡å’Œæ‰§è¡Œä½ çš„æµ‹è¯•ä»£ç ã€‚è¿™ç§è¯­æ³•æºè‡ªäºä¸€äº›æµè¡Œçš„ JavaScript æµ‹è¯•æ¡†æ¶ï¼Œå¦‚ Mocha å’Œ Jasmineï¼Œå®ƒä»¬å…è®¸ä½ ä»¥ä¸€ç§éå¸¸äººç±»å¯è¯»çš„å½¢å¼æ¥è¡¨è¾¾æµ‹è¯•æ„å›¾ã€‚è™½ç„¶ Node.js æœ¬èº«å¹¶ä¸ç›´æ¥åŒ…å«æµ‹è¯•æ¡†æ¶ï¼Œä½†è¯¥ç‰ˆæœ¬çš„æ–‡æ¡£å¯èƒ½æåŠäº†å¯¹ç±»ä¼¼äºè¿™äº›æ¡†æ¶çš„æ”¯æŒæˆ–å†…ç½®çš„æµ‹è¯•åŠŸèƒ½ã€‚</p><h3 id="describe-å’Œ-it-çš„åŸºæœ¬æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#describe-å’Œ-it-çš„åŸºæœ¬æ¦‚å¿µ"><span><code>describe</code> å’Œ <code>it</code> çš„åŸºæœ¬æ¦‚å¿µ</span></a></h3><ul><li><code>describe</code> å‡½æ•°ç”¨äºâ€œæè¿°â€ä½ çš„æµ‹è¯•å¥—ä»¶ã€‚ä½ å¯ä»¥å°†å®ƒçœ‹ä½œæ˜¯ä¸€ç»„ç›¸å…³æµ‹è¯•çš„å®¹å™¨ã€‚</li><li><code>it</code> å‡½æ•°ç”¨äºå®šä¹‰ä¸€ä¸ªå…·ä½“çš„æµ‹è¯•æ¡ˆä¾‹ã€‚æ¯ä¸ª<code>it</code>å—åº”è¯¥èšç„¦äºå•ä¸€çš„è¡Œä¸ºæˆ–åŠŸèƒ½ç‚¹ã€‚</li></ul><p>ä½¿ç”¨<code>describe</code>å’Œ<code>it</code>èƒ½å¤Ÿè®©ä½ çš„æµ‹è¯•æ›´åŠ æœ‰ç»„ç»‡ï¼Œæ˜“äºç†è§£å’Œç»´æŠ¤ã€‚</p><h3 id="ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹"><span>ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨æµ‹è¯•ä¸€ä¸ªç®€å•çš„æ•°å­¦åº“ï¼Œå…¶ä¸­åŒ…å«åŠ æ³•å’Œå‡æ³•åŠŸèƒ½ã€‚ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨<code>describe/it</code>è¯­æ³•æ¥ç»„ç»‡æµ‹è¯•çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥æ–­è¨€åº“</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥ä½ çš„æ•°å­¦åº“</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> mathLib</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./mathLib&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨describeå®šä¹‰æµ‹è¯•å¥—ä»¶</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Math Library&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä½¿ç”¨describeè¿›ä¸€æ­¥ç»†åˆ†æµ‹è¯•ç»„</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Addition&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å®šä¹‰å…·ä½“çš„æµ‹è¯•æ¡ˆä¾‹</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should return 5 when adding 2 and 3&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> mathLib</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Subtraction&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should return 1 when subtracting 3 from 4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> mathLib</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">subtract</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº†å¿…éœ€çš„åº“ï¼Œç„¶åä½¿ç”¨<code>describe</code>å®šä¹‰äº†ä¸€ä¸ªåä¸º&quot;Math Library&quot;çš„æµ‹è¯•å¥—ä»¶ã€‚åœ¨è¿™ä¸ªå¤§å¥—ä»¶é‡Œï¼Œæˆ‘ä»¬åˆé€šè¿‡<code>describe</code>å®šä¹‰äº†ä¸¤ä¸ªå°å¥—ä»¶ï¼š&quot;Addition&quot;å’Œ&quot;Subtraction&quot;ï¼Œé’ˆå¯¹åŠ æ³•å’Œå‡æ³•è¿›è¡Œæµ‹è¯•ã€‚æœ€åï¼Œåœ¨æ¯ä¸ªå°å¥—ä»¶ä¸­ï¼Œæˆ‘ä»¬ç”¨<code>it</code>å®šä¹‰äº†å…·ä½“çš„æµ‹è¯•æ¡ˆä¾‹ã€‚</p><p>è¿™ç§æ–¹å¼çš„å¥½å¤„æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼šå®ƒä½¿å¾—æµ‹è¯•ç»“æ„æ¸…æ™°ã€å±‚æ¬¡åˆ†æ˜ï¼ŒåŒæ—¶ä¹Ÿè®©æµ‹è¯•çš„æ„å›¾ä¸€ç›®äº†ç„¶ï¼Œæ˜“äºé˜…è¯»å’Œç»´æŠ¤ã€‚</p><p>æ³¨æ„ï¼Œè™½ç„¶æˆ‘ä½¿ç”¨äº†<code>assert</code>åº“è¿›è¡Œæ–­è¨€ï¼ˆå³éªŒè¯æµ‹è¯•ç»“æœæ˜¯å¦ç¬¦åˆé¢„æœŸï¼‰ï¼Œä½ å®é™…åœ¨ä½¿ç”¨æ—¶å¯èƒ½ä¼šé…åˆå…¶å®ƒçš„æ–­è¨€åº“ä¸€èµ·ä½¿ç”¨ï¼Œå¦‚ Chai ç­‰ã€‚åŒæ ·ï¼Œè™½ç„¶è¿™é‡Œæ˜¯ä»¥ Node.js çš„æŸä¸ªç‰ˆæœ¬ä¸ºèƒŒæ™¯è®¨è®ºï¼Œ<code>describe/it</code>è¯­æ³•çš„å®è´¨æ€§ä½¿ç”¨è¿˜æ˜¯ä¾èµ–äºå…·ä½“çš„æµ‹è¯•æ¡†æ¶ï¼ˆå¦‚ Mocha æˆ– Jasmineï¼‰æä¾›æ”¯æŒã€‚</p><h2 id="only-tests" tabindex="-1"><a class="header-anchor" href="#only-tests"><span><a href="https://nodejs.org/docs/latest/api/test.html#only-tests" target="_blank" rel="noopener noreferrer">only tests</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨åŒä¸€ç§è¯­è¨€æ¥ç¼–å†™å‰ç«¯å’Œåç«¯ä»£ç ï¼Œæå¤§åœ°æé«˜äº†å¼€å‘æ•ˆç‡å’Œçµæ´»æ€§ã€‚</p><p>åœ¨è®¨è®º Node.js æ–‡æ¡£ä¸­çš„ç‰¹å®šéƒ¨åˆ†ä¹‹å‰ï¼Œé‡è¦çš„æ˜¯è¦æ˜ç™½æµ‹è¯•å¯¹äºè½¯ä»¶å¼€å‘çš„é‡è¦æ€§ã€‚æµ‹è¯•ç¡®ä¿ä½ çš„ä»£ç æŒ‰ç…§é¢„æœŸé‚£æ ·å·¥ä½œï¼Œå¹¶ä¸”å½“ä½ æ·»åŠ æ–°åŠŸèƒ½æˆ–ä¿®æ”¹ç°æœ‰ä»£ç æ—¶ï¼Œå®ƒä¸ä¼šç ´åå…¶ä»–éƒ¨åˆ†ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰å¤šç§æ–¹å¼æ¥ç¼–å†™å’Œè¿è¡Œæµ‹è¯•ï¼Œä»¥ç¡®ä¿ä½ çš„åº”ç”¨ç¨‹åºç¨³å®šå¯é ã€‚</p><h3 id="only-tests-1" tabindex="-1"><a class="header-anchor" href="#only-tests-1"><span>only tests</span></a></h3><p>åœ¨ Node.js çš„æµ‹è¯•æ–‡æ¡£ä¸­ï¼Œâ€œonly testsâ€æŒ‡çš„æ˜¯åœ¨ä¸€ç»„æµ‹è¯•ä¸­åªè¿è¡ŒæŒ‡å®šçš„æµ‹è¯•æ¡ˆä¾‹ã€‚è¿™å¯¹äºè°ƒè¯•éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸å¼€å‘è€…é›†ä¸­æ³¨æ„åŠ›åœ¨ä¸€ä¸ªç‰¹å®šçš„é—®é¢˜ä¸Šï¼Œè€Œä¸å¿…æ¯æ¬¡éƒ½è¿è¡Œæ•´ä¸ªæµ‹è¯•å¥—ä»¶ã€‚</p><p>é€šä¿—æ¥è¯´ï¼Œæƒ³è±¡ä½ æ­£åœ¨ä¸€æœ¬ä¹¦é‡Œå¯»æ‰¾æŸä¸ªå…·ä½“çš„æ•…äº‹ç« èŠ‚ï¼Œè€Œä¸æ˜¯ä»å¤´åˆ°å°¾è¯»éå…¨ä¹¦ã€‚&quot;only tests&quot;å°±å¥½æ¯”æ˜¯ä¹¦ç­¾ï¼Œå¸®åŠ©ä½ ç›´æ¥è·³åˆ°é‚£ä¸ªä½ æœ€æ„Ÿå…´è¶£çš„ç« èŠ‚ã€‚</p><h4 id="å®é™…è¿ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­"><span>å®é™…è¿ç”¨ä¾‹å­ï¼š</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ä¸Šå•†åŸï¼Œå¹¶ä¸”ä½ ä¸ºè´­ç‰©è½¦åŠŸèƒ½ç¼–å†™äº†å¤šä¸ªæµ‹è¯•æ¡ˆä¾‹ã€‚çªç„¶ï¼Œä½ å‘ç°å½“ç”¨æˆ·å°è¯•åˆ é™¤è´­ç‰©è½¦ä¸­çš„æœ€åä¸€ä¸ªå•†å“æ—¶ï¼Œå‡ºç°äº†ä¸€ä¸ª bugã€‚ä¸ºäº†ä¿®å¤è¿™ä¸ª bugï¼Œä½ å¯èƒ½éœ€è¦é¢‘ç¹è¿è¡Œä¸è´­ç‰©è½¦åˆ é™¤åŠŸèƒ½ç›¸å…³çš„æµ‹è¯•ï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½è¿è¡Œæ‰€æœ‰çš„æµ‹è¯•æ¡ˆä¾‹ã€‚</p><p>åœ¨ Node.js æµ‹è¯•æ¡†æ¶ï¼ˆå¦‚ Mochaï¼‰ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡ç®€å•åœ°åœ¨ç‰¹å®šçš„æµ‹è¯•å‰åŠ ä¸Š <code>.only</code> æ–¹æ³•ï¼Œæ¥å®ç°åªè¿è¡Œè¯¥æµ‹è¯•æ¡ˆä¾‹ã€‚ä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è´­ç‰©è½¦åŠŸèƒ½&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åº”è¯¥æ­£ç¡®æ·»åŠ å•†å“&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æµ‹è¯•ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">only</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å½“åˆ é™¤æœ€åä¸€ä¸ªå•†å“æ—¶ï¼Œåº”è¯¥æ˜¾ç¤ºè´­ç‰©è½¦ä¸ºç©º&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // åªè¿è¡Œè¿™ä¸ªæµ‹è¯•æ¡ˆä¾‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åº”è¯¥è®¡ç®—æ€»ä»·æ ¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æµ‹è¯•ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå³ä½¿ä½ æœ‰å¤šä¸ªæµ‹è¯•æ¡ˆä¾‹ï¼Œä½¿ç”¨ <code>it.only</code> æŒ‡å®šçš„æµ‹è¯•å°†æ˜¯å”¯ä¸€è¢«æ‰§è¡Œçš„ã€‚è¿™è®©å¼€å‘è€…èƒ½å¤Ÿå¿«é€Ÿè¿­ä»£å¹¶ä¸“æ³¨äºä¿®å¤ç‰¹å®šçš„é—®é¢˜ã€‚</p><p>å½“ä½ å®Œæˆäº†è¿™ä¸ªç‰¹å®šæµ‹è¯•æ¡ˆä¾‹çš„è°ƒè¯•ï¼Œå¹¶ç¡®è®¤é—®é¢˜å·²è§£å†³åï¼Œåˆ«å¿˜äº†ç§»é™¤ <code>.only</code>ï¼Œä»¥ç¡®ä¿æ‰€æœ‰çš„æµ‹è¯•æ¡ˆä¾‹åœ¨æœªæ¥éƒ½èƒ½è¢«æ‰§è¡Œã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œâ€œonly testsâ€æ˜¯å¼€å‘è¿‡ç¨‹ä¸­ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œå®ƒå¸®åŠ©å¼€å‘è€…èŠ‚çœæ—¶é—´ï¼Œæ›´é«˜æ•ˆåœ°å®šä½å’Œä¿®å¤ä»£ç ä¸­çš„é—®é¢˜ã€‚é€šè¿‡åªå…³æ³¨å½“å‰æœ€éœ€è¦è§£å†³çš„é—®é¢˜ï¼Œä½ å¯ä»¥æ›´å¿«åœ°æ”¹å–„ä½ çš„åº”ç”¨ç¨‹åºï¼Œä¿æŒé«˜è´¨é‡çš„ä»£ç æ ‡å‡†ã€‚</p><h2 id="filtering-tests-by-name" tabindex="-1"><a class="header-anchor" href="#filtering-tests-by-name"><span><a href="https://nodejs.org/docs/latest/api/test.html#filtering-tests-by-name" target="_blank" rel="noopener noreferrer">Filtering tests by name</a></span></a></h2><p>Node.js v21.7.1 å¼•å…¥äº†ä¸€ä¸ªç‰¹æ€§ï¼Œå…è®¸ä½ æ ¹æ®æµ‹è¯•åç§°æ¥è¿‡æ»¤è¦è¿è¡Œçš„æµ‹è¯•ã€‚è¿™åœ¨è¿›è¡Œè½¯ä»¶å¼€å‘å’Œæµ‹è¯•æ—¶æ˜¯éå¸¸æœ‰ç”¨çš„åŠŸèƒ½ã€‚å½“ä½ æœ‰å¤§é‡çš„æµ‹è¯•ç”¨ä¾‹æ—¶ï¼Œæœ‰æ—¶ä½ åªæƒ³è¿è¡Œä¸€éƒ¨åˆ†ç›¸å…³çš„æµ‹è¯•ä»¥å¿«é€ŸéªŒè¯ä»£ç æ›´æ”¹æˆ–ä¿®å¤æ˜¯å¦æœ‰æ•ˆï¼Œè€Œä¸æ˜¯ç­‰å¾…æ•´ä¸ªæµ‹è¯•å¥—ä»¶å®Œæˆã€‚è¿™å°±æ˜¯è¿‡æ»¤æµ‹è¯•åç§°åŠŸèƒ½æ´¾ä¸Šç”¨åœºçš„åœ°æ–¹ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œé€‰é¡¹<code>--test-name-pattern</code>æ¥ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œåé¢è·Ÿç€ä½ æƒ³è¦è¿è¡Œçš„æµ‹è¯•åç§°çš„æ¨¡å¼ã€‚è¿™ä¸ªæ¨¡å¼ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼ˆRegular Expressionsï¼‰ï¼Œè¿™æ˜¯ä¸€ç§å¼ºå¤§çš„å­—ç¬¦ä¸²åŒ¹é…å·¥å…·ï¼Œå¯ä»¥è®©ä½ å®šä¹‰å¤æ‚çš„æœç´¢æ¨¡å¼ã€‚</p><h3 id="å®é™…ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-1"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æœ‰ä»¥ä¸‹å‡ ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼š</p><ul><li><code>testAddition()</code> æµ‹è¯•åŠ æ³•å‡½æ•°</li><li><code>testSubtraction()</code> æµ‹è¯•å‡æ³•å‡½æ•°</li><li><code>testMultiplication()</code> æµ‹è¯•ä¹˜æ³•å‡½æ•°</li><li><code>testDivision()</code> æµ‹è¯•é™¤æ³•å‡½æ•°</li></ul><p>å¦‚æœä½ åªæƒ³è¿è¡Œæ‰€æœ‰ä¸â€œåŠ æ³•â€ç›¸å…³çš„æµ‹è¯•ï¼Œä½ å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">node</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> your-test-file.js</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --test-name-pattern=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Addition&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™æ¡å‘½ä»¤ä¼šä½¿å¾—åªæœ‰åå­—ä¸­åŒ…å«&quot;Addition&quot;çš„æµ‹è¯•è¢«æ‰§è¡Œï¼Œå³åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œåªæœ‰<code>testAddition()</code>ä¼šè¢«è¿è¡Œã€‚</p><p>å¦‚æœä½ æƒ³è¦è¿è¡Œæ‰€æœ‰å’Œç®—æœ¯è¿ç®—éƒ½ç›¸å…³çš„æµ‹è¯•ï¼Œä½†åˆä¸æƒ³ä¸€ä¸ªä¸€ä¸ªåœ°æŒ‡å®šå®ƒä»¬çš„åå­—ï¼Œä½ å¯ä»¥ä½¿ç”¨æ›´é€šç”¨çš„æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…ä»»ä½•åŒ…å«â€œtestâ€ä¸”åé¢è·Ÿç€ä»»æ„ç®—æœ¯è¿ç®—åç§°çš„æµ‹è¯•ã€‚ä¾‹å¦‚ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">node</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> your-test-file.js</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --test-name-pattern=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;test(Addition|Subtraction|Multiplication|Division)&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™æ ·å°±ä¼šè¿è¡Œæ‰€æœ‰å››ä¸ªæµ‹è¯•å‡½æ•°ï¼Œå› ä¸ºå®ƒä»¬çš„åå­—éƒ½ç¬¦åˆæŒ‡å®šçš„æ¨¡å¼ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>ä¿è¯ä½ ä½¿ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼æ­£ç¡®æ— è¯¯ï¼Œé”™è¯¯çš„è¡¨è¾¾å¼å¯èƒ½å¯¼è‡´æ²¡æœ‰æµ‹è¯•è¢«æ‰§è¡Œï¼Œæˆ–ä¸æ˜¯ä½ æ‰€æœŸæœ›çš„æµ‹è¯•è¢«æ‰§è¡Œã€‚</li><li>ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½å¯ä»¥å¤§å¤§æé«˜å¼€å‘æ•ˆç‡ï¼Œå°¤å…¶æ˜¯åœ¨ä¿®å¤ bug æˆ–è€…å¢åŠ æ–°åŠŸèƒ½æ—¶ï¼Œèƒ½å¤Ÿå¿«é€ŸéªŒè¯å˜åŠ¨å¯¹ç°æœ‰åŠŸèƒ½çš„å½±å“ã€‚</li></ul><p>é€šè¿‡ä½¿ç”¨æµ‹è¯•åç§°è¿‡æ»¤ï¼Œä½ å¯ä»¥æ›´çµæ´»åœ°æ§åˆ¶æµ‹è¯•æ‰§è¡Œè¿‡ç¨‹ï¼Œä»è€Œæ›´é«˜æ•ˆåœ°è¿›è¡Œè½¯ä»¶å¼€å‘å’Œè´¨é‡ä¿è¯ã€‚</p><h2 id="extraneous-asynchronous-activity" tabindex="-1"><a class="header-anchor" href="#extraneous-asynchronous-activity"><span><a href="https://nodejs.org/docs/latest/api/test.html#extraneous-asynchronous-activity" target="_blank" rel="noopener noreferrer">Extraneous asynchronous activity</a></span></a></h2><p>ç†è§£ Node.js ä¸­çš„ &quot;Extraneous Asynchronous Activity&quot;ï¼ˆé¢å¤–çš„å¼‚æ­¥æ´»åŠ¨ï¼‰æ¦‚å¿µï¼Œæˆ‘ä»¬é¦–å…ˆå¾—äº†è§£ Node.js æ˜¯å¦‚ä½•å¤„ç†å¼‚æ­¥æ“ä½œçš„ã€‚Node.js åŸºäºäº‹ä»¶å¾ªç¯æ¥å¤„ç†å¼‚æ­¥æ“ä½œï¼Œæ¯”å¦‚æ–‡ä»¶è¯»å†™ã€ç½‘ç»œè¯·æ±‚ç­‰ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-extraneous-asynchronous-activity" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-extraneous-asynchronous-activity"><span>ä»€ä¹ˆæ˜¯ Extraneous Asynchronous Activity?</span></a></h3><p>â€œExtraneous Asynchronous Activityâ€æŒ‡çš„æ˜¯åœ¨ä½ çš„æµ‹è¯•ä»£ç æ‰§è¡Œå®Œæ¯•åï¼Œè¿˜å­˜åœ¨ä¸€äº›æœªå®Œæˆçš„å¼‚æ­¥æ“ä½œã€‚è¿™é€šå¸¸æ„å‘³ç€ä½ çš„ä»£ç é‡Œæœ‰å¼‚æ­¥æ“ä½œæœªè¢«å¦¥å–„å¤„ç†æˆ–ç»“æŸï¼Œä¾‹å¦‚å¿˜è®°å…³é—­ä¸€ä¸ªå®šæ—¶å™¨ã€ç½‘ç»œè¯·æ±‚æ²¡æœ‰æ­£ç¡®ç»ˆæ­¢ç­‰ã€‚</p><p>è¿™ç§æƒ…å†µåœ¨å•å…ƒæµ‹è¯•ä¸­å°¤ä¸ºå…³é”®ï¼Œå› ä¸ºå®ƒå¯èƒ½å¯¼è‡´æµ‹è¯•ç”¨ä¾‹çš„ç»“æœä¸å‡†ç¡®æˆ–è€…æµ‹è¯•ç¯å¢ƒæœªèƒ½æ­£ç¡®æ¸…ç†ï¼Œä»è€Œå½±å“åˆ°å…¶ä»–æµ‹è¯•ç”¨ä¾‹çš„æ‰§è¡Œã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨ç¼–å†™ä¸€ä¸ªç®€å•çš„ Node.js åº”ç”¨ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå‡½æ•°éœ€è¦è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼š</p><h4 id="ç¤ºä¾‹-1-æœªå¤„ç†çš„ç½‘ç»œè¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æœªå¤„ç†çš„ç½‘ç»œè¯·æ±‚"><span>ç¤ºä¾‹ 1: æœªå¤„ç†çš„ç½‘ç»œè¯·æ±‚</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> https</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  https</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">        data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        callback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ª <code>fetchData</code> å‡½æ•°æ¥æ”¶ä¸€ä¸ª URL å’Œä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œç„¶åå‘èµ· HTTPS è¯·æ±‚ã€‚å¦‚æœæˆ‘ä»¬åœ¨æµ‹è¯•è¿™ä¸ªå‡½æ•°æ—¶ï¼Œæµ‹è¯•ç»“æŸåæ²¡æœ‰ç­‰å¾…ç½‘ç»œè¯·æ±‚å®Œæˆå°±é€€å‡ºï¼Œé‚£ä¹ˆç½‘ç»œè¯·æ±‚ç›¸å…³çš„ä»£ç å°±æ˜¯æ‰€è°“çš„ &quot;Extraneous Asynchronous Activity&quot;ã€‚</p><h4 id="ç¤ºä¾‹-2-æœªæ¸…ç†çš„å®šæ—¶å™¨" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æœªæ¸…ç†çš„å®šæ—¶å™¨"><span>ç¤ºä¾‹ 2: æœªæ¸…ç†çš„å®šæ—¶å™¨</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> delayedHello</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> timer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    callback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Hello, </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹è¯•ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">delayedHello</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æµ‹è¯•ç»“æŸï¼Œä½†setTimeoutå°šæœªè§¦å‘</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœåœ¨ <code>setTimeout</code> è§¦å‘ä¹‹å‰æµ‹è¯•å°±ç»“æŸäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªå®šæ—¶å™¨å°±æ˜¯ä¸€ä¸ª â€œé¢å¤–çš„å¼‚æ­¥æ´»åŠ¨â€ã€‚</p><h3 id="å¦‚ä½•å¤„ç†" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•å¤„ç†"><span>å¦‚ä½•å¤„ç†</span></a></h3><p>ç¡®ä¿å¼‚æ­¥æ“ä½œåœ¨æµ‹è¯•ç”¨ä¾‹ç»“æŸå‰å®Œæˆæˆ–è¢«å¦¥å–„æ¸…ç†æ˜¯éå¸¸é‡è¦çš„ã€‚å¯¹äºä¸Šé¢çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p><ul><li>å¯¹äºç½‘ç»œè¯·æ±‚ï¼Œç¡®ä¿åœ¨æµ‹è¯•ç»“æŸæ—¶å–æ¶ˆè¯·æ±‚ã€‚</li><li>å¯¹äºå®šæ—¶å™¨ï¼Œç¡®ä¿åœ¨æµ‹è¯•ç”¨ä¾‹ç»“æŸæ—¶æ¸…é™¤å®šæ—¶å™¨ã€‚</li></ul><p>é€šè¿‡é€‚å½“åœ°ç®¡ç†å¼‚æ­¥æ“ä½œï¼Œå¯ä»¥é¿å… â€œExtraneous Asynchronous Activityâ€ çš„é—®é¢˜ï¼Œä¿è¯æµ‹è¯•çš„å‡†ç¡®æ€§å’Œå¯é æ€§ã€‚</p><h2 id="watch-mode" tabindex="-1"><a class="header-anchor" href="#watch-mode"><span><a href="https://nodejs.org/docs/latest/api/test.html#watch-mode" target="_blank" rel="noopener noreferrer">Watch mode</a></span></a></h2><p>Node.js çš„ Watch modeï¼ˆç›‘è§†æ¨¡å¼ï¼‰æ˜¯æŒ‡å½“ä½ åœ¨å¼€å‘æ—¶ï¼Œç³»ç»Ÿèƒ½å¤Ÿç›‘å¬åˆ°æ–‡ä»¶çš„å˜åŠ¨ï¼Œå¹¶è‡ªåŠ¨æ‰§è¡ŒæŸäº›æ“ä½œï¼Œæ¯”å¦‚é‡æ–°è¿è¡Œæµ‹è¯•ã€‚è¿™ç§æ¨¡å¼å¯¹äºå¿«é€Ÿå¼€å‘å’Œè¿­ä»£å°¤å…¶æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå‡å°‘äº†æ‰‹åŠ¨é‡å¤æ“ä½œçš„éœ€è¦ï¼Œè®©å¼€å‘è€…å¯ä»¥æ›´ä¸“æ³¨äºä»£ç çš„ç¼–å†™å’Œæ”¹è¿›ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ï¼ŒWatch mode ä¸»è¦åº”ç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚å½“ä½ å¯åŠ¨æµ‹è¯•è„šæœ¬è¿›å…¥ç›‘è§†æ¨¡å¼åï¼Œæ¯å½“ä½ ä¿®æ”¹å¹¶ä¿å­˜ä»£ç æ–‡ä»¶ï¼Œæµ‹è¯•æ¡†æ¶ä¼šè‡ªåŠ¨é‡æ–°è¿è¡Œç›¸å…³çš„æµ‹è¯•ç”¨ä¾‹ï¼Œæ— éœ€ä½ æ‰‹åŠ¨å†æ¬¡å¯åŠ¨æµ‹è¯•ã€‚è¿™æ ·ä¸ä»…èŠ‚çœäº†æ—¶é—´ï¼Œè¿˜èƒ½å³æ—¶åé¦ˆä»£ç æ›´æ”¹åçš„æ•ˆæœï¼Œå¸®åŠ©åŠæ—¶å‘ç°å’Œä¿®å¤é”™è¯¯ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-1" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-1"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>é€šå¸¸ï¼ŒWatch mode é€šè¿‡å‘½ä»¤è¡Œå‚æ•°æˆ–è€…é…ç½®æ–‡ä»¶æ¥å¯ç”¨ã€‚åœ¨å…·ä½“çš„æµ‹è¯•æ¡†æ¶ä¸­ï¼ˆè­¬å¦‚ Jestã€Mocha ç­‰ï¼‰ï¼Œè¿™å¯èƒ½ç¨æœ‰å·®å¼‚ï¼Œä½†åŸç†ç›¸åŒã€‚ä»¥ Jest ä¸ºä¾‹ï¼Œä½ å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­åŠ ä¸Š <code>--watch</code> å‚æ•°æ¥å¯ç”¨ç›‘è§†æ¨¡å¼ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">jest</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --watch</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™æ¡å‘½ä»¤å°†ä¼šå¯åŠ¨ Jest çš„ç›‘è§†æ¨¡å¼ï¼Œä¸€æ—¦æ£€æµ‹åˆ°æ–‡ä»¶å˜åŠ¨ï¼Œå°±ä¼šè‡ªåŠ¨é‡æ–°è¿è¡Œæµ‹è¯•ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-1"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><ol><li><p><strong>æŒç»­é›†æˆå¼€å‘ç¯å¢ƒä¸­çš„è‡ªåŠ¨æµ‹è¯•ï¼š</strong> å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª web åº”ç”¨ï¼Œå¹¶ä¸”ä¸ºæ¯ä¸ªåŠŸèƒ½æ¨¡å—ç¼–å†™äº†å•å…ƒæµ‹è¯•ã€‚é€šè¿‡åœ¨å¼€å‘ç¯å¢ƒä¸­å¯ç”¨ Watch modeï¼Œæ¯æ¬¡ä¿®æ”¹ä»£ç å¹¶ä¿å­˜åï¼Œç›¸å…³çš„å•å…ƒæµ‹è¯•å°±ä¼šè‡ªåŠ¨è¿è¡Œã€‚è¿™æ ·å¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿç¡®å®šæ–°çš„ä»£ç æ›´æ”¹æ²¡æœ‰ç ´åç°æœ‰çš„åŠŸèƒ½ã€‚</p></li><li><p><strong>æ•™è‚²ä¸åŸ¹è®­ï¼š</strong> åœ¨ç¼–ç¨‹æ•™å­¦è¿‡ç¨‹ä¸­ï¼Œè€å¸ˆå¯ä»¥è®¾ç½® Watch mode æ¥è‡ªåŠ¨è¿è¡Œå­¦ç”Ÿçš„ç»ƒä¹ ä½œä¸šæµ‹è¯•ã€‚å­¦ç”Ÿåªéœ€ä¸“æ³¨äºç¼–å†™æ»¡è¶³æµ‹è¯•æ¡ä»¶çš„ä»£ç ï¼Œä¸€æ—¦ä»£ç è¢«ä¿å­˜ï¼Œç›¸å…³æµ‹è¯•å°±ä¼šç«‹åˆ»è¿è¡Œå¹¶æä¾›åé¦ˆï¼Œæœ‰æ•ˆæé«˜å­¦ä¹ æ•ˆç‡ã€‚</p></li><li><p><strong>å›¢é˜Ÿåä½œå¼€å‘ï¼š</strong> åœ¨ä¸€ä¸ªå›¢é˜Ÿåä½œçš„é¡¹ç›®ä¸­ï¼Œå¼€å¯ Watch mode å¯ä»¥ç¡®ä¿æ¯ä¸ªå›¢é˜Ÿæˆå‘˜çš„ä»£ç æ›´æ”¹éƒ½èƒ½ç«‹å³å¾—åˆ°éªŒè¯ï¼Œå¹¶ä¿ƒè¿›ä»£ç è´¨é‡çš„æŒç»­æå‡ã€‚è¿™å¯¹äºä¿æŒå›¢é˜Ÿå†…ä»£ç çš„ä¸€è‡´æ€§å’Œå‡å°‘ bug çš„äº§ç”Ÿè‡³å…³é‡è¦ã€‚</p></li></ol><p>æ€»ä¹‹ï¼ŒWatch mode æ˜¯ç°ä»£è½¯ä»¶å¼€å‘æµç¨‹ä¸­ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå®ƒé€šè¿‡è‡ªåŠ¨åŒ–æµ‹è¯•çš„æ–¹å¼æé«˜äº†å¼€å‘æ•ˆç‡ï¼Œå¸®åŠ©å¼€å‘è€…æ›´åŠ ä¸“æ³¨äºåˆ›é€ æ€§çš„å·¥ä½œã€‚</p><h2 id="running-tests-from-the-command-line" tabindex="-1"><a class="header-anchor" href="#running-tests-from-the-command-line"><span><a href="https://nodejs.org/docs/latest/api/test.html#running-tests-from-the-command-line" target="_blank" rel="noopener noreferrer">Running tests from the command line</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚éšç€ç‰ˆæœ¬çš„æ›´æ–°ï¼ŒNode.js ä¸æ–­æ¨å‡ºæ–°åŠŸèƒ½å’Œæ”¹è¿›ï¼Œä»¥å¸®åŠ©å¼€å‘è€…æ›´é«˜æ•ˆåœ°å¼€å‘åº”ç”¨ç¨‹åºã€‚åœ¨ Node.js çš„æ–‡æ¡£ä¸­ï¼Œç»å¸¸ä¼šæåˆ°å¦‚ä½•ä»å‘½ä»¤è¡Œè¿è¡Œæµ‹è¯•ã€‚è¿™æ˜¯å› ä¸ºè‡ªåŠ¨åŒ–æµ‹è¯•å¯¹äºç¡®ä¿ä½ çš„åº”ç”¨æ­£å¸¸è¿ä½œè‡³å…³é‡è¦ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-1" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-1"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç®€å•ç†è§£ä¸€ä¸‹â€œä»å‘½ä»¤è¡Œè¿è¡Œæµ‹è¯•â€çš„å«ä¹‰ã€‚åœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œ&quot;æµ‹è¯•&quot;æŒ‡çš„æ˜¯ä¸€ç³»åˆ—è‡ªåŠ¨åŒ–çš„æ£€æŸ¥ï¼Œç”¨æ¥ç¡®ä¿ä½ çš„ä»£ç æŒ‰ç…§é¢„æœŸé‚£æ ·å·¥ä½œã€‚&quot;å‘½ä»¤è¡Œ&quot;æ˜¯ä¸€ç§ä¸è®¡ç®—æœºäº¤äº’çš„æ¥å£ï¼Œé€šè¿‡è¾“å…¥æ–‡æœ¬å½¢å¼çš„å‘½ä»¤æ¥æ‰§è¡Œæ“ä½œã€‚å› æ­¤ï¼Œâ€œä»å‘½ä»¤è¡Œè¿è¡Œæµ‹è¯•â€æ„å‘³ç€ä½ å¯ä»¥ç›´æ¥åœ¨å‘½ä»¤è¡Œç•Œé¢ä¸­è¾“å…¥å‘½ä»¤ï¼Œè®©è®¡ç®—æœºè‡ªåŠ¨è¿è¡Œè¿™äº›æµ‹è¯•ã€‚</p><h3 id="node-js-ä¸­çš„æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#node-js-ä¸­çš„æµ‹è¯•"><span>Node.js ä¸­çš„æµ‹è¯•</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œæœ‰å¾ˆå¤šå·¥å…·å¯ä»¥ç”¨æ¥ç¼–å†™å’Œè¿è¡Œæµ‹è¯•ï¼Œä¾‹å¦‚ Mochaã€Jest æˆ– Node è‡ªèº«çš„ <code>assert</code> æ¨¡å—ç­‰ã€‚æ¯ä¸ªå·¥å…·éƒ½æœ‰è‡ªå·±çš„ç‰¹æ€§å’Œè¯­æ³•ï¼Œä½†å®ƒä»¬çš„æ ¸å¿ƒç›®çš„ç›¸åŒï¼šå¸®åŠ©ä½ éªŒè¯ä½ çš„åº”ç”¨æ˜¯å¦å¦‚é¢„æœŸèˆ¬å·¥ä½œã€‚</p><h3 id="å®é™…ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-2"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ªç®€å•çš„ Node.js åº”ç”¨ï¼Œè¯¥åº”ç”¨åŒ…å«ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºè®¡ç®—ä¸¤ä¸ªæ•°çš„å’Œã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Node çš„ <code>assert</code> æ¨¡å—ç¼–å†™ä¸€ä¸ªæµ‹è¯•æ¡ˆä¾‹æ¥éªŒè¯è¿™ä¸ªå‡½æ•°çš„æ­£ç¡®æ€§ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// sum.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">b</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> a</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> b</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªæµ‹è¯•è¿™ä¸ªå‡½æ•°çš„ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// sum.test.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> sum</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./sum&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹è¯• sum å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;1 åŠ  2 åº”è¯¥ç­‰äº 3&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ‰€æœ‰æµ‹è¯•é€šè¿‡&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¦ä»å‘½ä»¤è¡Œè¿è¡Œè¿™ä¸ªæµ‹è¯•ï¼Œä½ éœ€è¦æ‰“å¼€ç»ˆç«¯ï¼ˆæˆ–å‘½ä»¤æç¤ºç¬¦ï¼‰ï¼Œå¯¼èˆªåˆ°åŒ…å«è¿™äº›æ–‡ä»¶çš„ç›®å½•ï¼Œç„¶åè¿è¡Œ Node.js å‘½ä»¤æ‰§è¡Œæµ‹è¯•è„šæœ¬ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">node</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sum.test.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œä½ ä¼šçœ‹åˆ° &quot;æ‰€æœ‰æµ‹è¯•é€šè¿‡&quot; çš„æ¶ˆæ¯ã€‚å¦‚æœå‡½æ•°ä¸æŒ‰é¢„æœŸå·¥ä½œï¼Œ<code>assert</code> ä¼šæŠ›å‡ºé”™è¯¯ï¼Œå¹¶ä¸”æ˜¾ç¤ºå¤±è´¥çš„ä¿¡æ¯ã€‚</p><h3 id="æ€»ç»“-1" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-1"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡ä»å‘½ä»¤è¡Œè¿è¡Œæµ‹è¯•ï¼Œä½ å¯ä»¥è½»æ¾åœ°é›†æˆè‡ªåŠ¨åŒ–æµ‹è¯•åˆ°ä½ çš„å¼€å‘æµç¨‹ä¸­ï¼Œç¡®ä¿æ¯æ¬¡æ›´æ”¹ä»£ç åéƒ½ä¸ä¼šç ´åç°æœ‰åŠŸèƒ½ã€‚è¿™å¯¹äºä»»ä½•è§„æ¨¡çš„é¡¹ç›®éƒ½æ˜¯éå¸¸é‡è¦çš„ï¼Œå¸®åŠ©ä½ æ„å»ºç¨³å®šå¯é çš„è½¯ä»¶åº”ç”¨ã€‚éšç€ä½ æ·±å…¥å­¦ä¹  Node.jsï¼ŒæŒæ¡å„ç§æµ‹è¯•å·¥å…·å’ŒæŠ€æœ¯å°†ä¼šæ˜¯ä½ æˆä¸ºé«˜æ•ˆå¼€å‘è€…çš„é‡è¦æ­¥éª¤ã€‚</p><h3 id="test-runner-execution-model" tabindex="-1"><a class="header-anchor" href="#test-runner-execution-model"><span><a href="https://nodejs.org/docs/latest/api/test.html#test-runner-execution-model" target="_blank" rel="noopener noreferrer">Test runner execution model</a></span></a></h3><p>Node.js v21.7.1 çš„æ–‡æ¡£ä¸­æåˆ°çš„â€œTest runner execution modelâ€æ˜¯å…³äº Node.js è‡ªå¸¦æµ‹è¯•æ¡†æ¶çš„æ‰§è¡Œæ¨¡å‹çš„è¯´æ˜ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯ä¸ºäº†å¸®åŠ©å¼€å‘è€…æ›´æœ‰æ•ˆåœ°ç¼–å†™å’Œè¿è¡Œæµ‹è¯•ä»£ç ã€‚æˆ‘ä¼šé€æ­¥è§£é‡Šå®ƒçš„æ¦‚å¿µã€é‡ç‚¹å†…å®¹ï¼Œä»¥åŠå¦‚ä½•åº”ç”¨åœ¨å®é™…é¡¹ç›®ä¸­ã€‚</p><h3 id="test-runner-execution-model-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#test-runner-execution-model-ç®€ä»‹"><span>Test Runner Execution Model ç®€ä»‹</span></a></h3><p>é¦–å…ˆï¼Œç†è§£â€œTest runnerâ€æ˜¯ä»€ä¹ˆå¾ˆé‡è¦ã€‚åœ¨ Node.js çš„ä¸–ç•Œé‡Œï¼Œä¸€ä¸ªâ€œTest runnerâ€æ˜¯ä¸€ä¸ªå·¥å…·æˆ–æ¡†æ¶ï¼Œç”¨äºè‡ªåŠ¨åŒ–åœ°æ‰§è¡Œä½ çš„æµ‹è¯•è„šæœ¬ã€‚å®ƒè®©æµ‹è¯•è¿‡ç¨‹å˜å¾—ç®€å•ã€è‡ªåŠ¨åŒ–ï¼Œå¹¶èƒ½ç»™å‡ºæµ‹è¯•ç»“æœã€‚v21.7.1 ç‰ˆæœ¬ä¸­æåˆ°çš„è¿™ä¸ªæ¨¡å‹ï¼Œç‰¹æŒ‡ Node.js å†…ç½®çš„æµ‹è¯•è¿è¡Œå™¨çš„æ‰§è¡Œæ–¹å¼ã€‚</p><h3 id="å…³é”®ç‚¹" tabindex="-1"><a class="header-anchor" href="#å…³é”®ç‚¹"><span>å…³é”®ç‚¹</span></a></h3><ul><li><p><strong>å¹¶è¡Œæ‰§è¡Œ</strong>: Node.js çš„æµ‹è¯•è¿è¡Œå™¨è®¾è®¡æˆå¯ä»¥å¹¶è¡Œæ‰§è¡Œå¤šä¸ªæµ‹è¯•æ–‡ä»¶ã€‚è¿™æ„å‘³ç€å¦‚æœä½ æœ‰å¤šä¸ªæµ‹è¯•æ–‡ä»¶ï¼ŒNode çš„æµ‹è¯•è¿è¡Œå™¨å¯ä»¥åŒæ—¶å¯åŠ¨å¤šä¸ªè¿›ç¨‹æ¥è¿è¡Œå®ƒä»¬ï¼Œå¤§å¤§ç¼©çŸ­æ€»ä½“æµ‹è¯•æ—¶é—´ã€‚</p></li><li><p><strong>éš”ç¦»ç¯å¢ƒ</strong>: æ¯ä¸ªæµ‹è¯•æ–‡ä»¶åœ¨ç‹¬ç«‹çš„è¿›ç¨‹ä¸­è¿è¡Œã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯é¿å…äº†ä¸åŒæµ‹è¯•é—´çš„çŠ¶æ€æ±¡æŸ“ï¼Œæ¯ä¸ªæµ‹è¯•éƒ½åœ¨å¹²å‡€çš„ç¯å¢ƒä¸­å¼€å§‹ï¼Œä¿è¯äº†æµ‹è¯•çš„å¯é æ€§ã€‚</p></li><li><p><strong>èµ„æºç®¡ç†</strong>: å¹¶è¡Œæ‰§è¡Œè™½å¥½ï¼Œä½†ä¹Ÿä¸èƒ½æ— é™åˆ¶åœ°å¢åŠ å¹¶è¡Œåº¦ã€‚Node.js æµ‹è¯•è¿è¡Œå™¨ä¼šæ ¹æ®ç³»ç»Ÿçš„èµ„æºæƒ…å†µï¼ˆå¦‚ CPU æ ¸å¿ƒæ•°ï¼‰æ™ºèƒ½è°ƒæ•´å¹¶è¡Œæ‰§è¡Œçš„æ•°é‡ï¼Œç¡®ä¿ç³»ç»Ÿä¸ä¼šå› ä¸ºè¿‡å¤šçš„å¹¶è¡Œæµ‹è¯•è€Œè¿‡è½½ã€‚</p></li></ul><h3 id="å®é™…åº”ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œå¹¶ä½¿ç”¨ Node.js ä½œä¸ºåç«¯ã€‚ç°åœ¨ï¼Œä½ æœ‰ä»¥ä¸‹å‡ ä¸ªæµ‹è¯•æ–‡ä»¶ï¼š</p><ol><li><code>user.test.js</code>ï¼šæµ‹è¯•ç”¨æˆ·æ³¨å†Œã€ç™»å½•ç­‰åŠŸèƒ½ã€‚</li><li><code>product.test.js</code>ï¼šæµ‹è¯•äº§å“æ·»åŠ ã€æŸ¥è¯¢ç­‰åŠŸèƒ½ã€‚</li><li><code>order.test.js</code>ï¼šæµ‹è¯•è®¢å•åˆ›å»ºã€æ”¯ä»˜ç­‰åŠŸèƒ½ã€‚</li></ol><p>åœ¨ä¼ ç»Ÿçš„ä¸²è¡Œæ‰§è¡Œæ¨¡å¼ä¸‹ï¼Œè¿™äº›æµ‹è¯•å°†ä¼šä¸€ä¸ªæ¥ä¸€ä¸ªåœ°è¿è¡Œã€‚é¦–å…ˆå®Œæˆ<code>user.test.js</code>çš„æ‰€æœ‰æµ‹è¯•ï¼Œç„¶åæ˜¯<code>product.test.js</code>ï¼Œæœ€åæ˜¯<code>order.test.js</code>ã€‚è¿™ç§æ¨¡å¼ç®€å•ç›´è§‚ï¼Œä½†å½“æ¯ä¸ªæµ‹è¯•æ–‡ä»¶åŒ…å«å¤§é‡æµ‹è¯•ä¸”æ‰§è¡Œæ—¶é—´è¾ƒé•¿æ—¶ï¼Œæ•´ä¸ªæµ‹è¯•è¿‡ç¨‹å¯èƒ½ä¼šéå¸¸ç¼“æ…¢ã€‚</p><p>ä½¿ç”¨ Node.js v21.7.1 ä¸­æåˆ°çš„æµ‹è¯•è¿è¡Œæ¨¡å‹ï¼Œäº‹æƒ…å°±å˜å¾—ä¸åŒäº†ï¼š</p><ol><li>å½“ä½ è§¦å‘æµ‹è¯•æ—¶ï¼ŒNode çš„æµ‹è¯•è¿è¡Œå™¨ä¼šåŒæ—¶å¯åŠ¨ä¸‰ä¸ªè¿›ç¨‹ï¼Œåˆ†åˆ«å¯¹åº”ä¸Šè¿°çš„ä¸‰ä¸ªæµ‹è¯•æ–‡ä»¶ã€‚</li><li>æ¯ä¸ªæµ‹è¯•æ–‡ä»¶åœ¨å„è‡ªç‹¬ç«‹çš„è¿›ç¨‹ä¸­æ‰§è¡Œï¼Œäº’ä¸å½±å“ï¼Œä¿è¯äº†æµ‹è¯•ç¯å¢ƒçš„æ¸…æ´ã€‚</li><li>Node çš„æµ‹è¯•è¿è¡Œå™¨ä¼šç›‘æ§ç³»ç»Ÿèµ„æºï¼Œæ ¹æ®å½“å‰æœºå™¨çš„æ€§èƒ½æ™ºèƒ½è°ƒæ•´å¹¶è¡Œè¿è¡Œçš„æµ‹è¯•æ–‡ä»¶æ•°é‡ã€‚</li></ol><p>è¿™æ ·ï¼Œä½ çš„æµ‹è¯•æ•ˆç‡å°†å¤§å¤§æå‡ï¼Œå› ä¸ºä¸‰ç»„æµ‹è¯•å‡ ä¹æ˜¯åœ¨åŒæ—¶å®Œæˆã€‚åŒæ—¶ï¼Œæ¯ç»„æµ‹è¯•ä¿æŒç‹¬ç«‹ï¼Œé¿å…äº†æµ‹è¯•é—´å¯èƒ½çš„å¹²æ‰°ã€‚</p><h3 id="æ€»ç»“-2" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-2"><span>æ€»ç»“</span></a></h3><p>Node.js çš„â€œTest runner execution modelâ€é€šè¿‡å¹¶è¡Œæ‰§è¡Œã€éš”ç¦»ç¯å¢ƒã€æ™ºèƒ½èµ„æºç®¡ç†ç­‰ç­–ç•¥ï¼Œæé«˜äº†æµ‹è¯•çš„æ•ˆç‡å’Œå¯é æ€§ã€‚å¯¹äºä»»ä½•è§„æ¨¡çš„é¡¹ç›®ï¼Œè¿™éƒ½æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ç‰¹æ€§ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦é¢‘ç¹è¿è¡Œå¤§é‡æµ‹è¯•çš„å¼€å‘ç¯å¢ƒä¸­ã€‚</p><h2 id="collecting-code-coverage" tabindex="-1"><a class="header-anchor" href="#collecting-code-coverage"><span><a href="https://nodejs.org/docs/latest/api/test.html#collecting-code-coverage" target="_blank" rel="noopener noreferrer">Collecting code coverage</a></span></a></h2><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ·±å…¥äº†è§£ Node.js ä¸­çš„ä»£ç è¦†ç›–ç‡æ”¶é›†ã€‚ä»£ç è¦†ç›–ç‡æ˜¯ä¸€ä¸ªé‡è¦çš„æŒ‡æ ‡ï¼Œå®ƒå¸®åŠ©å¼€å‘è€…äº†è§£ä»–ä»¬çš„æµ‹è¯•ç”¨ä¾‹æœ‰å¤šå°‘è¦†ç›–äº†å®é™…çš„ä»£ç ã€‚è¿™å¯¹äºç¡®ä¿è½¯ä»¶è´¨é‡å’Œå‘ç°æœªæµ‹è¯•çš„ä»£ç éƒ¨åˆ†éå¸¸æœ‰ç”¨ã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼ˆå’Œå…¶ä»–è¿‘æœŸç‰ˆæœ¬ï¼‰ï¼Œä½ å¯ä»¥é€šè¿‡å†…ç½®çš„å·¥å…·æ¥æ”¶é›†å…³äºä½ çš„åº”ç”¨ç¨‹åºæˆ–åº“çš„ä»£ç è¦†ç›–ç‡ä¿¡æ¯ã€‚è¿™æ„å‘³ç€ä¸éœ€è¦å®‰è£…é¢å¤–çš„åŒ…æˆ–å·¥å…·æ¥è¿›è¡Œè¿™é¡¹å·¥ä½œã€‚ä¸‹é¢ï¼Œæˆ‘ä¼šç®€å•è§£é‡Šæ€æ ·å¼€å§‹ï¼Œå¹¶ç»™å‡ºä¸€äº›å®é™…è¿ç”¨çš„ä¾‹å­ã€‚</p><h3 id="å¼€å§‹æ”¶é›†ä»£ç è¦†ç›–ç‡" tabindex="-1"><a class="header-anchor" href="#å¼€å§‹æ”¶é›†ä»£ç è¦†ç›–ç‡"><span>å¼€å§‹æ”¶é›†ä»£ç è¦†ç›–ç‡</span></a></h3><p>Node.js ä½¿ç”¨ V8 JavaScript å¼•æ“çš„å†…ç½®è¦†ç›–åŠŸèƒ½æ¥æ”¶é›†ä»£ç è¦†ç›–ç‡æ•°æ®ã€‚è¦å¯åŠ¨è¿™ä¸ªåŠŸèƒ½ï¼Œä½ éœ€è¦ä½¿ç”¨ <code>NODE_V8_COVERAGE</code> ç¯å¢ƒå˜é‡ã€‚è¿™ä¸ªç¯å¢ƒå˜é‡æŒ‡å®šä¸€ä¸ªç›®å½•ï¼ŒNode.js ä¼šå°†è¦†ç›–ç‡æŠ¥å‘Šè¾“å‡ºåˆ°é‚£é‡Œã€‚æ“ä½œå¦‚ä¸‹ï¼š</p><ol><li><p><strong>è®¾ç½®ç¯å¢ƒå˜é‡å¹¶è¿è¡Œä½ çš„åº”ç”¨ï¼š</strong></p><ul><li>åœ¨ Unix-like ç³»ç»Ÿï¼ˆå¦‚ Linux æˆ– macOSï¼‰ä¸Šï¼Œä½ å¯ä»¥ä½¿ç”¨ç»ˆç«¯å‘½ä»¤ï¼š<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>NODE_V8_COVERAGE=coverage-directory node your-app.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li>åœ¨ Windows ä¸Šï¼Œå¯ä»¥ä½¿ç”¨ï¼š<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>set NODE_V8_COVERAGE=coverage-directory</span></span>
<span class="line"><span>node your-app.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div>è¿™é‡Œï¼Œâ€œcoverage-directoryâ€æ˜¯ä½ æƒ³è¦ Node.js è¾“å‡ºè¦†ç›–ç‡æ•°æ®çš„ç›®å½•ã€‚è€Œâ€œyour-app.jsâ€åˆ™æ˜¯ä½ çš„åº”ç”¨ç¨‹åºçš„ä¸»æ–‡ä»¶ã€‚</li></ul></li><li><p><strong>æ‰§è¡Œä½ çš„æµ‹è¯•å¥—ä»¶ï¼š</strong> å¦‚æœä½ æœ‰è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆæ¯”å¦‚ä½¿ç”¨ Mochaã€Jest ç­‰æµ‹è¯•æ¡†æ¶ï¼‰ï¼Œç°åœ¨å°±æ‰§è¡Œå®ƒä»¬ã€‚å³ä½¿æ²¡æœ‰è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œåªè¦ä½ çš„åº”ç”¨è¿è¡Œï¼Œè¦†ç›–ç‡æ•°æ®ä¹Ÿä¼šè¢«æ”¶é›†ã€‚</p></li><li><p><strong>æŸ¥çœ‹è¦†ç›–ç‡æŠ¥å‘Šï¼š</strong> è¿è¡Œå®Œæ¯•åï¼Œåœ¨â€œcoverage-directoryâ€ç›®å½•ä¸‹ï¼Œä½ ä¼šå‘ç°ç”Ÿæˆäº†ä¸€äº› JSON æ–‡ä»¶ã€‚è¿™äº›æ˜¯åŸå§‹çš„è¦†ç›–ç‡æ•°æ®ï¼Œéœ€è¦è¿›ä¸€æ­¥å¤„ç†æ‰èƒ½æ˜“äºç†è§£ã€‚</p></li></ol><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç®€å•çš„ web åº”ç”¨ï¼Œä½¿ç”¨ Express æ¡†æ¶ï¼Œå¹¶ä¸”ä½ å†™äº†ä¸€äº› API çš„æµ‹è¯•ã€‚</p><ol><li><p><strong>è¿è¡Œæµ‹è¯•å¹¶æ”¶é›†è¦†ç›–ç‡ï¼š</strong><br> å‡è®¾ä½ çš„æµ‹è¯•è„šæœ¬å‘½åä¸ºâ€œtest.jsâ€ï¼Œä½ å¯ä»¥è¿™æ ·æ”¶é›†è¦†ç›–ç‡æ•°æ®ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>NODE_V8_COVERAGE=coverage node test.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><strong>å¤„ç†è¦†ç›–ç‡æ•°æ®ï¼š</strong><br> è¦†ç›–ç‡æ•°æ®ç°åœ¨å­˜å‚¨åœ¨â€œcoverageâ€æ–‡ä»¶å¤¹ä¸­çš„ JSON æ–‡ä»¶é‡Œï¼Œä½†äººç±»ä¸å¤ªå®¹æ˜“ç›´æ¥ä»ä¸­è·å–ä¿¡æ¯ã€‚å› æ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨åƒ <code>c8</code> è¿™æ ·çš„å·¥å…·æ¥å¤„ç†è¿™äº›æ•°æ®ã€‚<code>c8</code> æ˜¯åŸºäº V8 è¦†ç›–åŠŸèƒ½çš„ Node.js åº“ï¼Œå¯ä»¥ç”Ÿæˆæ›´æ˜“äºé˜…è¯»çš„æŠ¥å‘Šã€‚<br> å®‰è£… <code>c8</code> å¹¶ç”ŸæˆæŠ¥å‘Šï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>npm install -g c8</span></span>
<span class="line"><span>c8 --reporter=html node test.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¼šç”Ÿæˆä¸€ä¸ª HTML æŠ¥å‘Šï¼Œè¯¦ç»†æ˜¾ç¤ºå“ªäº›ä»£ç è¢«æµ‹è¯•è¦†ç›–äº†ï¼Œå“ªäº›æ²¡æœ‰ã€‚</p></li></ol><h3 id="æ€»ç»“-3" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-3"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒNode.js è®©å¼€å‘è€…èƒ½å¤Ÿè½»æ¾åœ°æ”¶é›†å’ŒæŸ¥çœ‹ä»£ç è¦†ç›–ç‡ï¼Œä»è€Œæé«˜ä»£ç è´¨é‡å’Œå¯é æ€§ã€‚è®°ä½ï¼Œé«˜è¦†ç›–ç‡å¹¶ä¸æ€»ç­‰äºé«˜è´¨é‡çš„ä»£ç ï¼Œä½†å®ƒæ˜¯è¯„ä¼°ä½ çš„æµ‹è¯•æ•ˆæœå’Œå‘ç°æ½œåœ¨æœªæµ‹è¯•åŒºåŸŸçš„æœ‰åŠ›å·¥å…·ã€‚</p><h3 id="coverage-reporters" tabindex="-1"><a class="header-anchor" href="#coverage-reporters"><span><a href="https://nodejs.org/docs/latest/api/test.html#coverage-reporters" target="_blank" rel="noopener noreferrer">Coverage reporters</a></span></a></h3><p>Node.js ä¸­çš„ &quot;Coverage Reporters&quot;ï¼ˆè¦†ç›–ç‡æŠ¥å‘Šå™¨ï¼‰æ˜¯ä¸æµ‹è¯•ç›¸å…³çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œç‰¹åˆ«æ˜¯åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ã€‚è¿™é‡Œæˆ‘ä»¬å°†å°è¯•ä»¥é€šä¿—æ˜“æ‡‚çš„æ–¹å¼è§£é‡Šè¿™ä¸ªæ¦‚å¿µï¼Œå¹¶ç»™å‡ºä¸€äº›å®é™…çš„ä¾‹å­ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯è¦†ç›–ç‡æŠ¥å‘Š" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯è¦†ç›–ç‡æŠ¥å‘Š"><span>ä»€ä¹ˆæ˜¯è¦†ç›–ç‡æŠ¥å‘Šï¼Ÿ</span></a></h3><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç†è§£â€œè¦†ç›–ç‡â€ï¼ˆCoverageï¼‰è¿™ä¸ªæœ¯è¯­ã€‚åœ¨è½¯ä»¶æµ‹è¯•ä¸­ï¼Œè¦†ç›–ç‡æ˜¯ä¸€ä¸ªè¡¡é‡æŒ‡æ ‡ï¼Œç”¨æ¥æè¿°ä»£ç æµ‹è¯•çš„å®Œæ•´æ€§ã€‚å®ƒå›ç­”äº†â€œæˆ‘ä»¬çš„æµ‹è¯•è¦†ç›–äº†å¤šå°‘ä»£ç ï¼Ÿâ€è¿™ä¸ªé—®é¢˜ã€‚é«˜çš„è¦†ç›–ç‡æ„å‘³ç€æ›´å¤šçš„ä»£ç è¢«æµ‹è¯•è¦†ç›–ï¼Œä»è€Œå¢åŠ äº†å‘ç°å’Œä¿®å¤é”™è¯¯çš„æœºä¼šã€‚</p><p>è€Œâ€œè¦†ç›–ç‡æŠ¥å‘Šå™¨â€ï¼ˆCoverage Reportersï¼‰ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ç”¨æ¥ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Šçš„å·¥å…·æˆ–æ¨¡å—ã€‚è¿™äº›æŠ¥å‘Šå¯ä»¥ä»¥å¤šç§æ ¼å¼å±•ç¤ºï¼Œæ¯”å¦‚ HTMLã€æ–‡æœ¬ï¼ˆtextï¼‰æˆ– JSON ç­‰ï¼Œå¸®åŠ©å¼€å‘è€…äº†è§£å“ªäº›ä»£ç è¢«æ‰§è¡Œäº†ï¼Œå“ªäº›æ²¡æœ‰ã€‚</p><h3 id="node-js-v21-7-1-ä¸­çš„è¦†ç›–ç‡æŠ¥å‘Š" tabindex="-1"><a class="header-anchor" href="#node-js-v21-7-1-ä¸­çš„è¦†ç›–ç‡æŠ¥å‘Š"><span>Node.js v21.7.1 ä¸­çš„è¦†ç›–ç‡æŠ¥å‘Š</span></a></h3><p>Node.js è‡ªèº«æä¾›äº†ç”¨äºæµ‹è¯•ä»£ç çš„å†…ç½®å·¥å…·ï¼Œå…¶ä¸­åŒ…æ‹¬ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Šçš„èƒ½åŠ›ã€‚è¿™ä½¿å¾—å¼€å‘è€…å¯ä»¥ç›´æ¥åˆ©ç”¨ Node.js æ¥æ£€æŸ¥ä»£ç çš„æµ‹è¯•è¦†ç›–æƒ…å†µï¼Œè€Œä¸éœ€è¦ä¾èµ–å¤–éƒ¨å·¥å…·ã€‚</p><h4 id="å®é™…åº”ç”¨ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-1"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç®€å•çš„ Node.js åº”ç”¨ï¼Œä½ å·²ç»ä¸ºå®ƒå†™äº†ä¸€äº›æµ‹è¯•ã€‚ç°åœ¨ï¼Œä½ æƒ³çŸ¥é“ä½ çš„æµ‹è¯•è¦†ç›–äº†å¤šå°‘ä»£ç ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨ Node.js ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Šçš„æ­¥éª¤ï¼š</p><ol><li><p><strong>ç¼–å†™æµ‹è¯•</strong>ï¼šé¦–å…ˆï¼Œç¡®ä¿ä½ æœ‰é’ˆå¯¹ä½ çš„åº”ç”¨ä»£ç çš„æµ‹è¯•ã€‚è¿™äº›æµ‹è¯•å¯ä»¥ä½¿ç”¨åƒ Mocha æˆ– Jest è¿™æ ·çš„æ¡†æ¶ç¼–å†™ã€‚</p></li><li><p><strong>è¿è¡Œæµ‹è¯•å¹¶ç”ŸæˆæŠ¥å‘Š</strong>ï¼š</p><ul><li>åœ¨ Node.js v21.7.1 ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œä½¿ç”¨å†…ç½®çš„æµ‹è¯•å·¥å…·æ¥è¿è¡Œä½ çš„æµ‹è¯•ï¼Œå¹¶æŒ‡å®šç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Šã€‚</li><li>ä¾‹å¦‚ï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Node.js çš„ <code>node test</code> å‘½ä»¤æ¥è¿è¡Œæµ‹è¯•ï¼Œä½ å¯ä»¥æ·»åŠ é¢å¤–çš„å‚æ•°æ¥ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Šã€‚å…·ä½“çš„å‘½ä»¤å’Œå‚æ•°å¯èƒ½ä¼šæ ¹æ® Node.js çš„ç‰ˆæœ¬å’Œä½ çš„é¡¹ç›®é…ç½®æœ‰æ‰€ä¸åŒã€‚</li></ul></li><li><p><strong>æŸ¥çœ‹æŠ¥å‘Š</strong>ï¼šè¿è¡Œä¸Šè¿°å‘½ä»¤åï¼ŒNode.js ä¼šåœ¨æŒ‡å®šçš„ç›®å½•ä¸­ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Šã€‚ä½ å¯ä»¥æ‰“å¼€è¿™ä¸ªæŠ¥å‘Šæ–‡ä»¶ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ª HTML æ–‡ä»¶ï¼‰ï¼Œåœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹ã€‚æŠ¥å‘Šå°†æ˜¾ç¤ºå“ªäº›ä»£ç è¡Œè¢«æµ‹è¯•è¦†ç›–äº†ï¼Œå“ªäº›æ²¡æœ‰ã€‚</p></li></ol><h3 id="æ€»ç»“-4" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-4"><span>æ€»ç»“</span></a></h3><p>è¦†ç›–ç‡æŠ¥å‘Šæ˜¯äº†è§£ä½ çš„æµ‹è¯•èŒƒå›´å’Œæé«˜ä»£ç è´¨é‡çš„å¼ºå¤§å·¥å…·ã€‚é€šè¿‡ Node.js v21.7.1 ä¸­çš„åŠŸèƒ½ï¼Œç”Ÿæˆè¿™æ ·çš„æŠ¥å‘Šå˜å¾—ç®€å•ä¸”ç›´æ¥ã€‚æ— è®ºä½ æ˜¯æ­£åœ¨å­¦ä¹ ç¼–ç¨‹çš„æ–°æ‰‹ï¼Œè¿˜æ˜¯ç»éªŒä¸°å¯Œçš„å¼€å‘è€…ï¼Œéƒ½å¯ä»¥åˆ©ç”¨è¿™ä¸€åŠŸèƒ½æ¥ç¡®ä¿ä½ çš„åº”ç”¨å°½å¯èƒ½åœ°æ— ç¼ºé™·ã€‚</p><h3 id="limitations" tabindex="-1"><a class="header-anchor" href="#limitations"><span><a href="https://nodejs.org/docs/latest/api/test.html#limitations" target="_blank" rel="noopener noreferrer">Limitations</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªå¼€æºä¸”è·¨å¹³å°çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„å·¥å…·ï¼Œè¢«ç”¨äºæ„å»ºå„ç§ç±»å‹çš„åº”ç”¨ç¨‹åºï¼Œä»ç®€å•çš„ç½‘ç«™åå°åˆ°å¤æ‚çš„ä¼ä¸šçº§ç³»ç»Ÿã€‚</p><p>æˆªè‡³æˆ‘çš„æœ€æ–°çŸ¥è¯†æ›´æ–°ï¼ˆ2023 å¹´ï¼‰ï¼Œæˆ‘æ— æ³•ç›´æ¥æä¾›ç‰¹å®šç‰ˆæœ¬ Node.js v21.7.1 çš„è¯¦ç»†æ–‡æ¡£å†…å®¹ï¼Œå› ä¸ºè¿™äº›å†…å®¹å¯èƒ½ä¼šéšæ—¶æ›´æ–°å’Œå˜åŒ–ã€‚ä½†æˆ‘å¯ä»¥è§£é‡Šä¸€ä¸‹é€šå¸¸åœ¨ Node.js æ–‡æ¡£ä¸­æåˆ°çš„â€œLimitationsâ€ï¼ˆé™åˆ¶ï¼‰éƒ¨åˆ†æ˜¯ä»€ä¹ˆï¼Œä»¥åŠä½ å¯èƒ½åœ¨å®é™…ä½¿ç”¨ä¸­é‡åˆ°çš„ä¸€äº›å¸¸è§é™åˆ¶ç¤ºä¾‹ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-limitations" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-limitations"><span>ä»€ä¹ˆæ˜¯â€œLimitationsâ€ï¼Ÿ</span></a></h3><p>â€œLimitationsâ€æŒ‡çš„æ˜¯åœ¨ä½¿ç”¨ Node.js æˆ–å…¶ç‰¹å®šæ¨¡å—æ—¶å­˜åœ¨çš„ä¸€äº›å±€é™æ€§æˆ–ä¸èƒ½åšçš„äº‹æƒ…ã€‚äº†è§£è¿™äº›é™åˆ¶å¯¹äºå¼€å‘è€…æ¥è¯´æ˜¯å¾ˆé‡è¦çš„ï¼Œå› ä¸ºå®ƒå¸®åŠ©ä½ ç†è§£åœ¨ä»€ä¹ˆæƒ…å†µä¸‹é€‰æ‹©ä½¿ç”¨ Node.js æ˜¯åˆé€‚çš„ï¼Œä»¥åŠå¦‚ä½•è§„åˆ’ä½ çš„é¡¹ç›®ç»“æ„å’Œä»£ç ä»¥é¿å…æ½œåœ¨é—®é¢˜ã€‚</p><h3 id="å¸¸è§çš„-node-js-é™åˆ¶ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å¸¸è§çš„-node-js-é™åˆ¶ç¤ºä¾‹"><span>å¸¸è§çš„ Node.js é™åˆ¶ç¤ºä¾‹ï¼š</span></a></h3><ol><li><p><strong>å•çº¿ç¨‹é™åˆ¶</strong>ï¼š<br> Node.js ä¸»è¦è¿è¡Œåœ¨ä¸€ä¸ªå•ä¸€çš„çº¿ç¨‹ä¸Šã€‚è¿™æ„å‘³ç€æ‰€æœ‰çš„è¯·æ±‚éƒ½æ˜¯é€šè¿‡è¿™ä¸ªå•ä¸€çº¿ç¨‹æ¥å¤„ç†çš„ã€‚è™½ç„¶è¿™æ ·è®¾è®¡å¯ä»¥ç®€åŒ–å¾ˆå¤šå¹¶å‘å¤„ç†çš„å¤æ‚æ€§ï¼Œå¹¶èƒ½æœ‰æ•ˆåˆ©ç”¨äº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼Œè®©åº”ç”¨å¿«é€Ÿå“åº”å’Œé«˜æ•ˆè¿è¡Œï¼Œä½†å®ƒä¹Ÿæ„å‘¸ç€ä½ ä¸èƒ½ç›´æ¥åˆ©ç”¨å¤šæ ¸ CPU çš„å…¨éƒ¨æ½œåŠ›æ¥å¤„ç†å¤šä»»åŠ¡ã€‚ä¸ºäº†å…‹æœè¿™ä¸ªé™åˆ¶ï¼ŒNode.js æä¾›äº† <code>cluster</code> æ¨¡å—æ¥åˆ›å»ºå­è¿›ç¨‹å¤„ç†é¢å¤–çš„ä»»åŠ¡ã€‚</p></li><li><p><strong>å›è°ƒåœ°ç‹±</strong>ï¼š<br> ç”±äº Node.js å¼ºçƒˆä¾èµ–å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ï¼Œæ—©æœŸçš„å¼€å‘ä¸­ï¼Œä»£ç ä¸­å¯èƒ½å……æ»¡äº†åµŒå¥—çš„å›è°ƒå‡½æ•°ï¼Œå¯¼è‡´æ‰€è°“çš„â€œå›è°ƒåœ°ç‹±â€ï¼Œä½¿å¾—ä»£ç éš¾ä»¥é˜…è¯»å’Œç»´æŠ¤ã€‚è™½ç„¶ç°åœ¨æœ‰äº† Promise å’Œ async/await æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯å¯¹äºæŸäº›è€é¡¹ç›®æˆ–ä¸ç†Ÿæ‚‰è¿™äº›ç‰¹æ€§çš„å¼€å‘è€…æ¥è¯´ï¼Œè¿™ä»ç„¶æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ã€‚</p></li><li><p><strong>å…¨å±€çŠ¶æ€ç®¡ç†</strong>ï¼š<br> åœ¨ Node.js ä¸­ï¼Œå¦‚æœä¸å°å¿ƒï¼Œå¾ˆå®¹æ˜“åœ¨æ¨¡å—ä¹‹é—´å…±äº«å’Œä¿®æ”¹å…¨å±€çŠ¶æ€ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´æˆ–æ„æ–™ä¹‹å¤–çš„é”™è¯¯ã€‚æ­£ç¡®çš„åšæ³•æ˜¯å°½é‡é¿å…å…¨å±€çŠ¶æ€ï¼Œæˆ–è€…ä½¿ç”¨ä¸“é—¨çš„çŠ¶æ€ç®¡ç†åº“æ¥æ§åˆ¶ã€‚</p></li><li><p><strong>å¯¹ CPU å¯†é›†å‹ä»»åŠ¡çš„å¤„ç†</strong>ï¼š<br> ç”±äº Node.js é‡‡ç”¨çš„æ˜¯éé˜»å¡ IO å’Œäº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼Œå®ƒæ›´é€‚åˆå¤„ç† I/O å¯†é›†å‹ä»»åŠ¡ï¼ˆå¦‚ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶æ“ä½œç­‰ï¼‰ã€‚å¯¹äºè®¡ç®—å¯†é›†å‹çš„ä»»åŠ¡ï¼ˆå¦‚å¤§é‡å¤æ‚è®¡ç®—ï¼‰ï¼ŒNode.js å¯èƒ½ä¸æ˜¯æœ€ä½³é€‰æ‹©ï¼Œå› ä¸ºè¿™ä¼šå ç”¨å”¯ä¸€çš„çº¿ç¨‹ï¼Œå¯¼è‡´åº”ç”¨æ— æ³•åŠæ—¶å“åº”å…¶ä»–å¼‚æ­¥ä»»åŠ¡ã€‚è™½ç„¶å¯ä»¥é€šè¿‡åˆ›å»ºå­è¿›ç¨‹æ¥å°è¯•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†è¿™å¢åŠ äº†å¤æ‚æ€§ã€‚</p></li></ol><p>æ€»ç»“ä¸Šè¿°å†…å®¹ï¼Œå°½ç®¡ Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§å’Œçµæ´»çš„å·¥å…·ï¼Œé€‚ç”¨äºæ„å»ºå„ç§ç½‘è·¯åº”ç”¨ï¼Œä½†å®ƒä¹Ÿæœ‰è‡ªå·±çš„å±€é™æ€§ã€‚ä½œä¸ºå¼€å‘è€…ï¼Œäº†è§£è¿™äº›å±€é™æ€§ä»¥åŠå¦‚ä½•åœ¨ç‰¹å®šåœºæ™¯ä¸‹è§„é¿æˆ–è§£å†³è¿™äº›é—®é¢˜æ˜¯éå¸¸é‡è¦çš„ã€‚</p><h2 id="mocking" tabindex="-1"><a class="header-anchor" href="#mocking"><span><a href="https://nodejs.org/docs/latest/api/test.html#mocking" target="_blank" rel="noopener noreferrer">Mocking</a></span></a></h2><p>åœ¨ Node.js ä¸­ï¼Œ&quot;Mocking&quot;æ˜¯ä¸€ç§ç”¨äºæµ‹è¯•çš„æŠ€æœ¯ï¼Œå®ƒå…è®¸ä½ æ¨¡æ‹Ÿä¸€ä¸ªæ¨¡å—ã€å‡½æ•°æˆ–è€…æŸäº›è¡Œä¸ºçš„å®ç°ï¼Œä»¥ä¾¿åœ¨ä¸åŒçš„æµ‹è¯•åœºæ™¯ä¸‹æ§åˆ¶è¿™äº›éƒ¨åˆ†çš„è¡Œä¸ºã€‚åœ¨ Node.js ç‰ˆæœ¬ 21.7.1 çš„æ–‡æ¡£ä¸­æåŠçš„ Mocking ä¸»è¦æ˜¯æŒ‡åœ¨ Node.js çš„æµ‹è¯•ç¯å¢ƒä¸­å¦‚ä½•ä½¿ç”¨ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-mocking" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-mocking"><span>ä»€ä¹ˆæ˜¯ Mocking?</span></a></h3><p>ç®€å•æ¥è¯´ï¼ŒMocking å°±æ˜¯åœ¨æµ‹è¯•æ—¶åˆ›å»ºä¸€ä¸ªå‡çš„ï¼ˆmockï¼‰ç‰ˆæœ¬çš„æŸä¸ªéƒ¨åˆ†ï¼Œæ¯”å¦‚ä¸€ä¸ªå‡½æ•°æˆ–æ¨¡å—ï¼Œè¿™æ ·ä½ å°±å¯ä»¥é¢„è®¾è¿™ä¸ªå‡éƒ¨åˆ†çš„è¡Œä¸ºå’Œè¿”å›å€¼ã€‚è¿™éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸ä½ æµ‹è¯•ä»£ç çš„å…¶ä½™éƒ¨åˆ†è€Œä¸ä¾èµ–äºå¤–éƒ¨ç³»ç»Ÿæˆ–å¤æ‚çš„ç¯å¢ƒã€‚</p><h3 id="mocking-çš„å®é™…è¿ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#mocking-çš„å®é™…è¿ç”¨ä¾‹å­"><span>Mocking çš„å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™ï¼Œè¿™ä¸ªç½‘ç«™æœ‰ä¸€ä¸ªåŠŸèƒ½æ˜¯ä»ç¬¬ä¸‰æ–¹ API è·å–å¤©æ°”ä¿¡æ¯å¹¶æ˜¾ç¤ºç»™ç”¨æˆ·ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè°ƒç”¨ç¬¬ä¸‰æ–¹ API çš„ä»£ç éƒ¨åˆ†å¯ä»¥è¢« Mock æ‰ã€‚</p><h4 id="ä¾‹å­-1-æµ‹è¯•å¤©æ°”åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-æµ‹è¯•å¤©æ°”åº”ç”¨"><span>ä¾‹å­ 1ï¼šæµ‹è¯•å¤©æ°”åº”ç”¨</span></a></h4><p>å‡è®¾ä½ æœ‰ä»¥ä¸‹å‡½æ•°ï¼Œå®ƒè´Ÿè´£è°ƒç”¨ç¬¬ä¸‰æ–¹ API è·å–å¤©æ°”ä¿¡æ¯ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetchWeather</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">city</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // çœŸå®é€»è¾‘ä¼šå»è°ƒç”¨ä¸€ä¸ªç¬¬ä¸‰æ–¹APIä»¥è·å–åŸå¸‚çš„å¤©æ°”ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æµ‹è¯•æ—¶ï¼Œä½ ä¸å¸Œæœ›æ¯æ¬¡éƒ½çœŸå®åœ°è°ƒç”¨ç¬¬ä¸‰æ–¹ APIï¼ˆå¯èƒ½ä¼šå¾ˆæ…¢ï¼Œä¸”ä¾èµ–ç½‘ç»œï¼‰ï¼Œæ‰€ä»¥ä½ å¯ä»¥ä½¿ç”¨ Mocking æ¥æ¨¡æ‹Ÿ<code>fetchWeather</code>å‡½æ•°çš„è¡Œä¸ºã€‚</p><p>åˆ©ç”¨ Mockingï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªå‡çš„<code>fetchWeather</code>ï¼Œåƒè¿™æ ·ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ä¼ªé€ çš„æ•°æ®æ¥æ¨¡æ‹ŸfetchWeatherå‡½æ•°çš„è¡Œä¸º</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> mockFetchWeather</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">city</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    temp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">26</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    condition</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Sunny&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ï¼Œåœ¨æµ‹è¯•ä¸­ï¼Œå½“ä»£ç å°è¯•è°ƒç”¨<code>fetchWeather</code>æ—¶ï¼Œå®é™…ä¸Šä¼šè°ƒç”¨<code>mockFetchWeather</code>ï¼Œå®ƒä¼šç«‹å³è¿”å›ä¸€ä¸ªå›ºå®šçš„å¤©æ°”ä¿¡æ¯ï¼Œè€Œä¸æ˜¯è¿›è¡ŒçœŸå®çš„ API è°ƒç”¨ã€‚è¿™è®©æµ‹è¯•å˜å¾—å¿«é€Ÿå¹¶ä¸”å¯é¢„æµ‹ã€‚</p><h4 id="ä¾‹å­-2-æ¨¡æ‹Ÿæ•°æ®åº“æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-æ¨¡æ‹Ÿæ•°æ®åº“æ“ä½œ"><span>ä¾‹å­ 2ï¼šæ¨¡æ‹Ÿæ•°æ®åº“æ“ä½œ</span></a></h4><p>å‡è®¾ä½ çš„åº”ç”¨æœ‰ä¸€ä¸ªåŠŸèƒ½æ˜¯ä»æ•°æ®åº“ä¸­è¯»å–ç”¨æˆ·ä¿¡æ¯ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™æ¶‰åŠåˆ°å¯¹æ•°æ®åº“çš„å®é™…è°ƒç”¨ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getUserFromDatabase</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">userId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å®é™…é€»è¾‘ä¼šä¸æ•°æ®åº“é€šä¿¡ä»¥è·å–ç”¨æˆ·ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿›è¡Œå•å…ƒæµ‹è¯•æ—¶ï¼Œä½ ä¸æƒ³ä¾èµ–äºçœŸå®çš„æ•°æ®åº“ï¼Œå› ä¸ºè¿™ä¼šä½¿æµ‹è¯•å˜æ…¢å¹¶ä¸”éœ€è¦æ•°æ®åº“ç¯å¢ƒã€‚æ‰€ä»¥ï¼Œä½ å¯ä»¥ç”¨ Mocking æ¥æ¨¡æ‹Ÿæ•°æ®åº“è°ƒç”¨ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> mockGetUserFromDatabase</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">userId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">userId</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;John Doe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæµ‹è¯•å¯ä»¥é¿å…å¯¹æ•°æ®åº“çš„å®é™…è°ƒç”¨ï¼Œå¹¶ä¸”ä»ç„¶èƒ½å¤ŸéªŒè¯ä»£ç å…¶ä»–éƒ¨åˆ†çš„è¡Œä¸ºã€‚</p><h3 id="æ€»ç»“-5" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-5"><span>æ€»ç»“</span></a></h3><p>Mocking æ˜¯è½¯ä»¶æµ‹è¯•ä¸­ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ¦‚å¿µï¼Œç‰¹åˆ«æ˜¯åœ¨è¿›è¡Œå•å…ƒæµ‹è¯•æ—¶ã€‚å®ƒå…è®¸å¼€å‘è€…éš”ç¦»å¹¶æµ‹è¯•ä»£ç çš„ç‰¹å®šéƒ¨åˆ†ï¼Œè€Œæ— éœ€æ‹…å¿ƒå¤–éƒ¨ä¾èµ–ï¼Œå¦‚ API è°ƒç”¨ã€æ•°æ®åº“æ“ä½œç­‰ã€‚é€šè¿‡ Mockingï¼Œæµ‹è¯•å˜å¾—æ›´åŠ å¿«é€Ÿã€ç¨³å®šå’Œå¯é¢„æµ‹ã€‚</p><h3 id="timers" tabindex="-1"><a class="header-anchor" href="#timers"><span><a href="https://nodejs.org/docs/latest/api/test.html#timers" target="_blank" rel="noopener noreferrer">Timers</a></span></a></h3><p>Node.js åœ¨å…¶ä¸æ–­çš„è¿­ä»£ä¸­ä¸€ç›´åœ¨æé«˜å…¶æ€§èƒ½å’ŒåŠŸèƒ½ï¼Œè€Œè®¡æ—¶å™¨ï¼ˆTimersï¼‰æ˜¯ Node.js ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªæ¦‚å¿µã€‚å®ƒä»¬ç”¨äºåœ¨æœªæ¥çš„æŸä¸ªæ—¶é—´ç‚¹æ‰§è¡Œä»£ç ã€‚å°½ç®¡ä½ æåˆ°çš„ Node.js v21.7.1 çš„å®˜æ–¹æ–‡æ¡£é“¾æ¥ä¼¼ä¹æŒ‡å‘äº†ä¸€ä¸ªé”™è¯¯çš„åœ°å€ï¼Œæˆ‘å°†åŸºäº Node.js ä¸­é€šç”¨çš„ Timers æ¦‚å¿µæ¥è§£é‡Šã€‚</p><p>åœ¨ Node.js ä¸­ï¼ŒTimers å‡½æ•°å…è®¸ä½ è®¾å®šä¸€ä¸ªå»¶è¿Ÿï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ï¼Œåœ¨å»¶è¿Ÿè¿‡åæ‰§è¡Œå›è°ƒå‡½æ•°ã€‚è¿™åœ¨ä½ éœ€è¦å¼‚æ­¥æ‰§è¡Œä»£ç ã€è®¾ç½®å»¶æ—¶æˆ–å‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡æ—¶éå¸¸æœ‰ç”¨ã€‚ä¸‹é¢æ˜¯å‡ ä¸ªæœ€å¸¸è§çš„è®¡æ—¶å™¨å‡½æ•°ï¼š</p><ol><li><p><strong><code>setTimeout()</code></strong>:</p><ul><li>åŠŸèƒ½ï¼šåœ¨æŒ‡å®šçš„æ¯«ç§’æ•°åæ‰§è¡Œä¸€æ¬¡å›è°ƒå‡½æ•°ã€‚</li><li>ä¾‹å­ï¼šæ¯”å¦‚è¯´ï¼Œä½ æƒ³åœ¨ç”¨æˆ·æäº¤è¡¨å•åï¼Œç­‰å¾… 3 ç§’é’Ÿå†æ˜¾ç¤ºä¸€ä¸ªâ€œæäº¤æˆåŠŸâ€çš„æ¶ˆæ¯ã€‚<div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Submission successful!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç­‰å¾…3ç§’é’Ÿ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p><strong><code>clearTimeout()</code></strong>:</p><ul><li><p>åŠŸèƒ½ï¼šå–æ¶ˆç”± <code>setTimeout()</code> è®¾ç½®çš„å»¶è¿Ÿæ‰§è¡Œã€‚</p></li><li><p>ä¾‹å­ï¼šå¦‚æœç”¨æˆ·å†³å®šæ’¤é”€åˆšæ‰çš„æ“ä½œï¼Œä½ å¯èƒ½æƒ³å–æ¶ˆä¸Šé¢é‚£ä¸ªâ€œæäº¤æˆåŠŸâ€çš„æ¶ˆæ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> timerId</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;This will not run if clearTimeout is called in time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clearTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timerId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å–æ¶ˆsetTimeout</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p><strong><code>setInterval()</code></strong>:</p><ul><li>åŠŸèƒ½ï¼šæŒ‰ç…§æŒ‡å®šçš„æ—¶é—´é—´éš”é‡å¤æ‰§è¡Œå›è°ƒå‡½æ•°ã€‚</li><li>ä¾‹å­ï¼šå‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåœ¨çº¿æ‹å–ç³»ç»Ÿï¼Œä½ å¯èƒ½éœ€è¦æ¯ 10 ç§’é’Ÿåˆ·æ–°ä¸€æ¬¡é¡µé¢ä¸Šçš„å‡ºä»·ä¿¡æ¯ã€‚<div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Refreshing bid information&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¯10ç§’æ‰§è¡Œä¸€æ¬¡</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p><strong><code>clearInterval()</code></strong>:</p><ul><li><p>åŠŸèƒ½ï¼šåœæ­¢ç”± <code>setInterval()</code> åˆ›å»ºçš„å®šæœŸæ‰§è¡Œã€‚</p></li><li><p>ä¾‹å­ï¼šå¦‚æœç”¨æˆ·ç¦»å¼€äº†æ‹å–é¡µé¢ï¼Œä½ å¯èƒ½ä¼šæƒ³åœæ­¢åˆ·æ–°å‡ºä»·ä¿¡æ¯ä»¥èŠ‚çœèµ„æºã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> intervalId</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;This will not run if clearInterval is called.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clearInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">intervalId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœæ­¢å®šæœŸæ‰§è¡Œ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ol><p>è¿™äº›è®¡æ—¶å™¨åŠŸèƒ½åœ¨å¾ˆå¤šåœºæ™¯ä¸‹éƒ½éå¸¸æœ‰ç”¨ã€‚æ— è®ºæ˜¯å¼€å‘å‰ç«¯äº¤äº’é€»è¾‘ã€å¤„ç†åç«¯æ•°æ®å¤„ç†ä»»åŠ¡ï¼Œè¿˜æ˜¯ç®€å•åœ°æ§åˆ¶è„šæœ¬æ‰§è¡Œæµç¨‹ï¼Œåœ¨ Node.js ä¸­çµæ´»è¿ç”¨è¿™äº›è®¡æ—¶å™¨å¯ä»¥å¸®åŠ©ä½ è®¾è®¡å‡ºæ—¢å“åº”å¿«é€Ÿåˆç”¨æˆ·å‹å¥½çš„åº”ç”¨ã€‚</p><h3 id="dates" tabindex="-1"><a class="header-anchor" href="#dates"><span><a href="https://nodejs.org/docs/latest/api/test.html#dates" target="_blank" rel="noopener noreferrer">Dates</a></span></a></h3><p>Node.js v21.7.1 çš„æ–‡æ¡£ä¸­å¹¶æ²¡æœ‰ä¸“é—¨é’ˆå¯¹â€œDatesâ€ï¼ˆæ—¥æœŸï¼‰çš„éƒ¨åˆ†ï¼Œå› æ­¤æˆ‘æ— æ³•ç›´æ¥å¼•ç”¨æˆ–è§£é‡Š Node.js v21.7.1 æ–‡æ¡£ä¸­å…³äºâ€œDatesâ€çš„å†…å®¹ã€‚å¯èƒ½ä½ æ‰€æåˆ°çš„é“¾æ¥ç›®æ ‡å¹¶ä¸æ­£ç¡®ï¼Œæˆ–è€…è¯¯è§£äº†æ–‡æ¡£çš„æŸéƒ¨åˆ†ã€‚</p><p>ä¸è¿‡ï¼Œæˆ‘å¯ä»¥ç»™ä½ è§£é‡Š Node.js ä¸­å¦‚ä½•å¤„ç†å’Œæ“ä½œæ—¥æœŸï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„æŠ€èƒ½ã€‚</p><p>åœ¨ JavaScriptï¼ˆNode.js åŸºäº JavaScriptï¼‰ï¼Œå¤„ç†æ—¥æœŸä¸»è¦é€šè¿‡<code>Date</code>å¯¹è±¡è¿›è¡Œã€‚ä»¥ä¸‹æ˜¯ä¸€äº›åŸºæœ¬å’Œå®ç”¨çš„ä¾‹å­æ¥è¯´æ˜å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨æ—¥æœŸï¼š</p><h3 id="_1-åˆ›å»ºå½“å‰æ—¶é—´çš„æ—¥æœŸå¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_1-åˆ›å»ºå½“å‰æ—¶é—´çš„æ—¥æœŸå¯¹è±¡"><span>1. åˆ›å»ºå½“å‰æ—¶é—´çš„æ—¥æœŸå¯¹è±¡</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> now</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç åˆ›å»ºäº†ä¸€ä¸ªè¡¨ç¤ºå½“å‰æ—¥æœŸå’Œæ—¶é—´çš„<code>Date</code>å¯¹è±¡ï¼Œå¹¶å°†å…¶æ‰“å°å‡ºæ¥ã€‚</p><h3 id="_2-åˆ›å»ºç‰¹å®šæ—¥æœŸçš„å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_2-åˆ›å»ºç‰¹å®šæ—¥æœŸçš„å¯¹è±¡"><span>2. åˆ›å»ºç‰¹å®šæ—¥æœŸçš„å¯¹è±¡</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> specificDate</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;1995-12-17T03:24:00&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">specificDate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªè¡¨ç¤º 1995 å¹´ 12 æœˆ 17 æ—¥ï¼Œå‡Œæ™¨ 3 ç‚¹ 24 åˆ†çš„æ—¥æœŸå¯¹è±¡ã€‚</p><h3 id="_3-è·å–å’Œè®¾ç½®æ—¥æœŸçš„å„ä¸ªéƒ¨åˆ†" tabindex="-1"><a class="header-anchor" href="#_3-è·å–å’Œè®¾ç½®æ—¥æœŸçš„å„ä¸ªéƒ¨åˆ†"><span>3. è·å–å’Œè®¾ç½®æ—¥æœŸçš„å„ä¸ªéƒ¨åˆ†</span></a></h3><p>Date å¯¹è±¡æä¾›äº†å¤šç§æ–¹æ³•æ¥è·å–å’Œè®¾ç½®å®ƒçš„å¹´ã€æœˆã€æ—¥ç­‰éƒ¨åˆ†ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> date</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å½“å‰æ—¥æœŸå’Œæ—¶é—´</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getFullYear</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¹´ä»½</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getMonth</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æœˆä»½ï¼Œ+1æ˜¯å› ä¸ºgetMonth()è¿”å›çš„æœˆä»½ä»0å¼€å§‹è®¡æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getDate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ—¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getHours</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°æ—¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getMinutes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ†é’Ÿ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getSeconds</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç§’</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setFullYear</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2023</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®å¹´ä»½ä¸º2023</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setMonth</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®æœˆä»½ä¸º1æœˆï¼ˆæœˆä»½ä»0å¼€å§‹è®¡æ•°ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setDate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®æ—¥æœŸä¸º1å·</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-ä½¿ç”¨æ—¥æœŸå’Œæ—¶é—´æˆ³" tabindex="-1"><a class="header-anchor" href="#_4-ä½¿ç”¨æ—¥æœŸå’Œæ—¶é—´æˆ³"><span>4. ä½¿ç”¨æ—¥æœŸå’Œæ—¶é—´æˆ³</span></a></h3><p>æ¯ä¸ª Date å¯¹è±¡éƒ½å¯¹åº”ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œå®ƒè¡¨ç¤ºä» 1970 å¹´ 1 æœˆ 1 æ—¥ 00:00:00 UTC åˆ°è¯¥æ—¥æœŸå¯¹è±¡æ‰€è¡¨ç¤ºæ—¶é—´çš„æ¯«ç§’æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> now</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> timestamp</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getTime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timestamp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dateFromTimestamp</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timestamp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">dateFromTimestamp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨æ—¶é—´æˆ³åˆ›å»ºæ—¥æœŸå¯¹è±¡</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨"><span>å®é™…åº”ç”¨</span></a></h3><ul><li><strong>æ—¥å¿—è®°å½•</strong>ï¼šåœ¨ä»»ä½•éœ€è¦è®°å½•ä½•æ—¶å‘ç”Ÿäº‹ä»¶çš„ç³»ç»Ÿä¸­ï¼Œä½¿ç”¨æ—¥æœŸå’Œæ—¶é—´æ˜¯å¾ˆå¸¸è§çš„ã€‚ä¾‹å¦‚ï¼Œè®°å½•ç”¨æˆ·çš„ç™»å½•æ—¶é—´ã€é”™è¯¯å‘ç”Ÿçš„æ—¶é—´ç­‰ã€‚</li><li><strong>æ€§èƒ½ç›‘æµ‹</strong>ï¼šè®°å½•ä»£ç æ‰§è¡Œå‰åçš„æ—¶é—´ï¼Œä»¥è®¡ç®—å‡ºæ‰§è¡Œéœ€è¦èŠ±è´¹çš„æ—¶é—´ï¼Œå¸®åŠ©ä¼˜åŒ–æ€§èƒ½ã€‚</li><li><strong>å®šæ—¶æ‰§è¡Œä»»åŠ¡</strong>ï¼šä½¿ç”¨<code>setTimeout</code>æˆ–<code>setInterval</code>ç»“åˆæ—¥æœŸï¼Œå¯ä»¥åœ¨æŒ‡å®šçš„æ—¶é—´æ‰§è¡Œç‰¹å®šçš„ä»»åŠ¡ï¼Œä¾‹å¦‚ï¼Œæ¯å¤©å®šæ—¶å‘é€æŠ¥å‘Šé‚®ä»¶ã€‚</li></ul><p>è™½ç„¶ Node.js çš„æ ¸å¿ƒ API æä¾›äº†åŸºç¡€çš„æ—¥æœŸå’Œæ—¶é—´å¤„ç†èƒ½åŠ›ï¼Œä½†å¯¹äºå¤æ‚çš„æ—¥æœŸæ“ä½œï¼Œé€šå¸¸ä¼šä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œæ¯”å¦‚<code>moment.js</code>æˆ–<code>date-fns</code>ï¼Œè¿™äº›åº“æä¾›äº†æ›´åŠ ä¸°å¯Œå’Œä¾¿æ·çš„æ—¥æœŸå¤„ç†åŠŸèƒ½ã€‚</p><p>å¸Œæœ›è¿™äº›ç¤ºä¾‹å’Œè§£é‡Šèƒ½å¤Ÿå¸®åŠ©ä½ ç†è§£ Node.js ä¸­å¦‚ä½•å¤„ç†æ—¥æœŸã€‚å¦‚æœæœ‰å…·ä½“çš„ Node.js ç‰ˆæœ¬ä¸­çš„æ–°åŠŸèƒ½æˆ–å˜æ›´ç›¸å…³çš„é—®é¢˜ï¼Œå¯ä»¥æä¾›æ›´æ˜ç¡®çš„ä¿¡æ¯æˆ–è€…å‚è€ƒå®˜æ–¹æ–‡æ¡£æ›´æ–°ã€‚</p><h2 id="test-reporters" tabindex="-1"><a class="header-anchor" href="#test-reporters"><span><a href="https://nodejs.org/docs/latest/api/test.html#test-reporters" target="_blank" rel="noopener noreferrer">Test reporters</a></span></a></h2><p>Node.js ä¸­çš„æµ‹è¯•æŠ¥å‘Šå™¨ï¼ˆTest Reportersï¼‰æ˜¯ä¸€ç§ç”¨äºæ ¼å¼åŒ–æµ‹è¯•æ‰§è¡Œç»“æœçš„å·¥å…·ã€‚åœ¨ç¼–å†™å’Œè¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•æ—¶ï¼Œäº†è§£ä½ çš„æµ‹è¯•æ˜¯å¦é€šè¿‡ã€å“ªäº›å¤±è´¥ä»¥åŠå¤±è´¥çš„åŸå› æ˜¯éå¸¸é‡è¦çš„ã€‚æµ‹è¯•æŠ¥å‘Šå™¨è´Ÿè´£å°†è¿™äº›ä¿¡æ¯ä»¥æ˜“äºç†è§£å’Œåˆ†æçš„å½¢å¼å±•ç¤ºå‡ºæ¥ã€‚</p><p>åœ¨ Node.js çš„ v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œæµ‹è¯•æ¡†æ¶æä¾›äº†ä¸åŒçš„æµ‹è¯•æŠ¥å‘Šå™¨ä¾›å¼€å‘è€…é€‰æ‹©ï¼Œæ¯ç§æŠ¥å‘Šå™¨éƒ½æœ‰å…¶ç‰¹å®šçš„è¾“å‡ºæ ¼å¼ï¼Œè®©å¼€å‘è€…å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚é€‰æ‹©æœ€åˆé€‚çš„ä¸€ç§ã€‚ç°åœ¨æˆ‘ä¼šè§£é‡Šå‡ ç§å¸¸è§çš„æµ‹è¯•æŠ¥å‘Šå™¨ç±»å‹ï¼Œå¹¶ç»™å‡ºä¸€äº›å®é™…åº”ç”¨çš„ä¾‹å­ï¼š</p><ol><li><p><strong>æ ‡å‡†è¾“å‡ºï¼ˆSpecï¼‰</strong>:</p><ul><li><strong>æè¿°</strong>: Spec æŠ¥å‘Šå™¨ä¼šä»¥äººç±»å¯è¯»çš„å½¢å¼è¾“å‡ºæµ‹è¯•ç»“æœï¼Œé€šå¸¸åŒ…æ‹¬æµ‹è¯•å¥—ä»¶åç§°ã€æµ‹è¯•çš„æè¿°ã€é€šè¿‡/å¤±è´¥çš„æµ‹è¯•æ•°ç›®ï¼Œä»¥åŠä»»ä½•å¤±è´¥æµ‹è¯•çš„é”™è¯¯æ¶ˆæ¯ã€‚</li><li><strong>å®é™…åº”ç”¨</strong>: å½“ä½ åœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒä¸­è¿è¡Œæµ‹è¯•å¹¶å¸Œæœ›å¿«é€Ÿäº†è§£å“ªäº›æµ‹è¯•é€šè¿‡äº†ï¼Œå“ªäº›æ²¡é€šè¿‡æ—¶ï¼ŒSpec æŠ¥å‘Šå™¨éå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ åœ¨å¼€å‘ä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œä½¿ç”¨ Spec æŠ¥å‘Šå™¨å¯ä»¥ç«‹å³çœ‹åˆ°å“ªäº› API ç«¯ç‚¹æµ‹è¯•æ²¡æœ‰é€šè¿‡ã€‚</li></ul></li><li><p><strong>ç‚¹ï¼ˆDotï¼‰</strong>:</p><ul><li><strong>æè¿°</strong>: ç‚¹æŠ¥å‘Šå™¨å°†æµ‹è¯•ç»“æœæ˜¾ç¤ºä¸ºä¸€ç³»åˆ—çš„ç‚¹ã€‚æ¯ä¸ªé€šè¿‡çš„æµ‹è¯•ç”¨ä¾‹å¯¹åº”ä¸€ä¸ªç»¿è‰²çš„ç‚¹ï¼Œæ¯ä¸ªå¤±è´¥çš„æµ‹è¯•ç”¨ä¾‹å¯¹åº”ä¸€ä¸ªçº¢è‰²çš„ç‚¹ã€‚</li><li><strong>å®é™…åº”ç”¨</strong>: è¿™ç§æŠ¥å‘Šå™¨éå¸¸é€‚åˆæŒç»­é›†æˆç³»ç»Ÿä¸­çš„ä½¿ç”¨ï¼Œå› ä¸ºå®ƒå¯ä»¥è®©ä½ ä¸€çœ¼çœ‹åˆ°æ‰€æœ‰æµ‹è¯•çš„æ€»ä½“é€šè¿‡æƒ…å†µã€‚æ¯”æ–¹è¯´ï¼Œä½ æ­£åœ¨ GitHub Actions ä¸­è¿è¡Œä½ çš„æµ‹è¯•å¥—ä»¶ï¼Œç‚¹æŠ¥å‘Šå™¨èƒ½å¤Ÿå¿«é€Ÿåœ°ç»™ä½ ä¸€ä¸ªæ˜¯å¦ä¸€åˆ‡æ­£å¸¸çš„è§†è§‰ä¿¡å·ã€‚</li></ul></li><li><p><strong>TAP</strong>:</p><ul><li><strong>æè¿°</strong>: TAPï¼ˆTest Anything Protocolï¼‰æ˜¯ä¸€ç§ç®€å•çš„æ–‡æœ¬åè®®ï¼Œç”¨äºæµ‹è¯•ç»“æœçš„äº¤æµã€‚å®ƒå¯ä»¥è¾“å‡ºæ›´è¯¦ç»†çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä¸ºä»€ä¹ˆæµ‹è¯•å¤±è´¥ã€‚</li><li><strong>å®é™…åº”ç”¨</strong>: å¦‚æœä½ éœ€è¦å°†æµ‹è¯•ç»“æœå¯¼å…¥åˆ°å…¶ä»–å·¥å…·è¿›è¡Œè¿›ä¸€æ­¥çš„åˆ†ææˆ–æŠ¥å‘Šï¼ŒTAP æ ¼å¼å¾ˆæœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªå¤§å‹é¡¹ç›®ä¸­ï¼Œä½ å¯èƒ½æƒ³è¦ä½¿ç”¨ä¸€ä¸ªä¸“é—¨çš„æµ‹è¯•ç»“æœåˆ†æå·¥å…·æ¥æ·±å…¥äº†è§£å¤±è´¥æµ‹è¯•çš„åŸå› ï¼ŒTAP æ ¼å¼å¯ä»¥è½»æ¾åœ°è¢«è¿™äº›å·¥å…·è§£æã€‚</li></ul></li><li><p><strong>JUnit</strong>:</p><ul><li><strong>æè¿°</strong>: JUnit æ ¼å¼æ˜¯ Java ç¯å¢ƒä¸­å¸¸ç”¨çš„æµ‹è¯•æŠ¥å‘Šæ ¼å¼ï¼Œä½†ä¹Ÿè¢«å…¶ä»–è¯­è¨€å’Œç¯å¢ƒé‡‡ç”¨ã€‚å®ƒå°†æµ‹è¯•ç»“æœä¿å­˜åœ¨ XML æ–‡ä»¶ä¸­ï¼Œè¿™ä½¿å¾—å®ƒéå¸¸é€‚åˆä¸æŒç»­é›†æˆå·¥å…·å¦‚ Jenkins é›†æˆã€‚</li><li><strong>å®é™…åº”ç”¨</strong>: å¦‚æœä½ çš„å›¢é˜Ÿä½¿ç”¨ Jenkins ä½œä¸º CI/CD ç®¡é“ï¼Œé‚£ä¹ˆä½¿ç”¨ JUnit æŠ¥å‘Šå™¨å¯ä»¥è®© Jenkins ç›´æ¥è§£ææµ‹è¯•ç»“æœï¼Œä»è€Œåœ¨æ„å»ºè¿‡ç¨‹ä¸­æä¾›è¯¦ç»†çš„æµ‹è¯•åé¦ˆã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ„å»ºå¤±è´¥ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨ Jenkins ç•Œé¢ä¸ŠæŸ¥çœ‹å“ªäº›æµ‹è¯•æ²¡æœ‰é€šè¿‡åŠå…¶å¤±è´¥åŸå› ã€‚</li></ul></li></ol><p>æµ‹è¯•æŠ¥å‘Šå™¨çš„é€‰æ‹©å–å†³äºä½ çš„å…·ä½“éœ€æ±‚ï¼Œæ¯”å¦‚ä½ éœ€è¦çš„ä¿¡æ¯è¯¦ç»†ç¨‹åº¦ã€ä½ ä½¿ç”¨çš„å·¥å…·é“¾ï¼Œä»¥åŠç»“æœçš„å‘ˆç°æ–¹å¼ã€‚æ­£ç¡®é€‰æ‹©å’Œä½¿ç”¨æµ‹è¯•æŠ¥å‘Šå™¨å¯ä»¥æå¤§åœ°æé«˜å¼€å‘æ•ˆç‡ã€æ”¹å–„å›¢é˜Ÿæ²Ÿé€šï¼Œä»¥åŠåŠ å¿«æ•…éšœæ’é™¤çš„è¿‡ç¨‹ã€‚</p><h3 id="custom-reporters" tabindex="-1"><a class="header-anchor" href="#custom-reporters"><span><a href="https://nodejs.org/docs/latest/api/test.html#custom-reporters" target="_blank" rel="noopener noreferrer">Custom reporters</a></span></a></h3><p>Node.js v21.7.1 å¼•å…¥äº†è‡ªå®šä¹‰æŠ¥å‘Šå™¨ï¼ˆCustom Reportersï¼‰çš„åŠŸèƒ½ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äº Node.js çš„å†…å»ºæµ‹è¯•æ¡†æ¶çš„æ–°ç‰¹æ€§ã€‚è®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ¢ç´¢å®ƒçš„æ„ä¹‰å’Œåº”ç”¨ã€‚</p><h3 id="è‡ªå®šä¹‰æŠ¥å‘Šå™¨æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰æŠ¥å‘Šå™¨æ˜¯ä»€ä¹ˆ"><span>è‡ªå®šä¹‰æŠ¥å‘Šå™¨æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h3><p>åœ¨æ·±å…¥è§£é‡Šä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç†è§£æµ‹è¯•æŠ¥å‘Šå™¨ï¼ˆTest Reporterï¼‰æ˜¯åšä»€ä¹ˆçš„ã€‚åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œå½“ä½ è¿è¡Œæµ‹è¯•ï¼ˆæ— è®ºæ˜¯å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•è¿˜æ˜¯ä»»ä½•å½¢å¼çš„è‡ªåŠ¨åŒ–æµ‹è¯•ï¼‰æ—¶ï¼Œæµ‹è¯•æŠ¥å‘Šå™¨è´Ÿè´£ä»¥ä¸€ç§æ˜“äºé˜…è¯»çš„æ–¹å¼æ”¶é›†å¹¶å±•ç¤ºæµ‹è¯•ç»“æœã€‚è¿™å¯ä»¥æ˜¯ç®€å•çš„æ–‡æœ¬è¾“å‡ºï¼Œä¹Ÿå¯ä»¥åŒ…å«æ›´å¤æ‚çš„æ•°æ®å¯è§†åŒ–ã€‚</p><p>Node.js çš„è‡ªå®šä¹‰æŠ¥å‘Šå™¨å…è®¸å¼€å‘è€…æ‰©å±•æˆ–æ”¹å†™æµ‹è¯•æ‰§è¡Œåçš„ç»“æœè¾“å‡ºã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥æŒ‰ç…§é¡¹ç›®éœ€æ±‚æˆ–ä¸ªäººå–œå¥½å®šåˆ¶æŠ¥å‘Šçš„æ ¼å¼å’Œå†…å®¹ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰æŠ¥å‘Šå™¨" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰æŠ¥å‘Šå™¨"><span>å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰æŠ¥å‘Šå™¨ï¼Ÿ</span></a></h3><p>åœ¨ Node.js çš„æµ‹è¯•æ¡†æ¶ä¸­ï¼Œåº”ç”¨è‡ªå®šä¹‰æŠ¥å‘Šå™¨é€šå¸¸æ¶‰åŠä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><ol><li><p><strong>åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰æŠ¥å‘Šå™¨</strong>ï¼šé¦–å…ˆï¼Œä½ éœ€è¦ç¼–å†™ä¸€ä¸ª JavaScript æ–‡ä»¶æ¥å®šä¹‰è‡ªå®šä¹‰æŠ¥å‘Šå™¨ã€‚è¿™ä¸ªæ–‡ä»¶éœ€è¦å¯¼å‡ºä¸€ä¸ªç±»ï¼Œç±»ä¸­åŒ…å«ç‰¹å®šçš„æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•ä¼šåœ¨æµ‹è¯•æ‰§è¡Œçš„ä¸åŒé˜¶æ®µè¢«æµ‹è¯•æ¡†æ¶è°ƒç”¨ã€‚</p></li><li><p><strong>åœ¨æµ‹è¯•å‘½ä»¤ä¸­æŒ‡å®š</strong>ï¼šåˆ›å»ºå¥½è‡ªå®šä¹‰æŠ¥å‘Šå™¨åï¼Œä½ å¯ä»¥é€šè¿‡åœ¨è¿è¡Œæµ‹è¯•å‘½ä»¤æ—¶æ·»åŠ å‚æ•°æ¥æŒ‡å®šä½¿ç”¨ä½ çš„è‡ªå®šä¹‰æŠ¥å‘Šå™¨ã€‚</p></li></ol><h3 id="è‡ªå®šä¹‰æŠ¥å‘Šå™¨çš„å®é™…ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰æŠ¥å‘Šå™¨çš„å®é™…ä¾‹å­"><span>è‡ªå®šä¹‰æŠ¥å‘Šå™¨çš„å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æƒ³è¦ä¸€ä¸ªæŠ¥å‘Šå™¨ï¼Œå®ƒåœ¨æ¯æ¬¡æµ‹è¯•è¿è¡Œç»“æŸæ—¶ï¼Œéƒ½èƒ½ç®€å•åœ°æ‰“å°å‡ºé€šè¿‡ä¸å¤±è´¥çš„æµ‹è¯•æ•°é‡ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¦‚ä½•å®ç°è¿™ä¸ªç›®æ ‡çš„åŸºæœ¬ç¤ºä¾‹ï¼š</p><ol><li><p><strong>ç¼–å†™è‡ªå®šä¹‰æŠ¥å‘Šå™¨ç±»</strong>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// customReporter.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> CustomReporter</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">passedTests</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">failedTests</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  onTestResult</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">status</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;passed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">passedTests</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">status</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;failed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">failedTests</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  onRunComplete</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">contexts</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">results</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Tests passed: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">this</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">passedTests</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Tests failed: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">this</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">failedTests</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> CustomReporter</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>åœ¨æµ‹è¯•å‘½ä»¤ä¸­ä½¿ç”¨è‡ªå®šä¹‰æŠ¥å‘Šå™¨</strong>ï¼š<br> å‡è®¾ä½ çš„ Node.js åº”ç”¨ä½¿ç”¨çš„æ˜¯ npm ä½œä¸ºåŒ…ç®¡ç†å·¥å…·ï¼Œä½ å¯ä»¥åœ¨<code>package.json</code>çš„<code>scripts</code>éƒ¨åˆ†æ·»åŠ ä¸€ä¸ªå‘½ä»¤æ¥è¿è¡Œæµ‹è¯•ï¼Œå¹¶æŒ‡å®šä½¿ç”¨ä½ çš„è‡ªå®šä¹‰æŠ¥å‘Šå™¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;scripts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">  &quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node --test-reporter=./path/to/customReporter.js yourTestFile.js&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œé€šè¿‡è¿è¡Œ<code>npm test</code>å‘½ä»¤ï¼Œä½ å°±å¯ä»¥çœ‹åˆ°è‡ªå®šä¹‰æŠ¥å‘Šå™¨è¾“å‡ºçš„ç»“æœäº†ã€‚</p></li></ol><h3 id="æ€»ç»“-6" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-6"><span>æ€»ç»“</span></a></h3><p>è‡ªå®šä¹‰æŠ¥å‘Šå™¨æ˜¯ Node.js æµ‹è¯•ç”Ÿæ€ç³»ç»Ÿä¸­ä¸€ä¸ªå¼ºå¤§è€Œçµæ´»çš„ç‰¹æ€§ï¼Œé€šè¿‡å®ƒï¼Œå¼€å‘è€…å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦æ¥å®šåˆ¶æµ‹è¯•ç»“æœçš„å±•ç¤ºæ–¹å¼ã€‚ä¸Šè¿°ä¾‹å­åªæ˜¯å…¶ä¸­æœ€åŸºç¡€çš„åº”ç”¨ä¹‹ä¸€ï¼Œéšç€ä½ å¯¹ Node.js å’Œå…¶æµ‹è¯•æ¡†æ¶çš„æ·±å…¥å­¦ä¹ ï¼Œä½ ä¼šå‘ç°è¿˜æœ‰æ›´å¤šçš„å¯èƒ½æ€§ç­‰å¾…æ¢ç´¢ã€‚</p><h3 id="multiple-reporters" tabindex="-1"><a class="header-anchor" href="#multiple-reporters"><span><a href="https://nodejs.org/docs/latest/api/test.html#multiple-reporters" target="_blank" rel="noopener noreferrer">Multiple reporters</a></span></a></h3><p>Node.js v21.7.1 ç‰ˆæœ¬ä¸­çš„â€œMultiple Reportersâ€åŠŸèƒ½æ˜¯æŒ‡åœ¨ä½¿ç”¨ Node.js çš„æµ‹è¯•æ¡†æ¶æ—¶ï¼Œä½ å¯ä»¥åŒæ—¶æŒ‡å®šå¤šä¸ªæŠ¥å‘Šæ ¼å¼ã€‚è¿™å¯¹äºå¼€å‘è€…æ¥è¯´éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸ä½ æ ¹æ®ä¸åŒçš„éœ€æ±‚å’Œåå¥½ï¼Œä»¥å¤šç§æ–¹å¼æŸ¥çœ‹å’Œåˆ†ææµ‹è¯•ç»“æœã€‚</p><p>åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œ&quot;reporter&quot;ï¼ˆæŠ¥å‘Šç”Ÿæˆå™¨ï¼‰æ˜¯ä¸€ä¸ªå·¥å…·æˆ–ç»„ä»¶ï¼Œå®ƒèƒ½å¤Ÿæ•è·æµ‹è¯•è¿è¡Œçš„ç»“æœï¼Œå¹¶å°†è¿™äº›ç»“æœè½¬æ¢æˆæŸç§æ˜“äºç†è§£çš„å½¢å¼ï¼Œæ¯”å¦‚æ–‡æœ¬æ‘˜è¦ã€HTML é¡µé¢æˆ–è€…æ˜¯ JSON æ–‡ä»¶ã€‚ä¸åŒçš„æŠ¥å‘Šæ ¼å¼é€‚åˆäºä¸åŒçš„åœºæ™¯ï¼šä¾‹å¦‚ï¼Œå¼€å‘è€…å¯èƒ½å¸Œæœ›åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¿«é€ŸæŸ¥çœ‹ç®€å•çš„æ–‡æœ¬æ€»ç»“ï¼Œè€Œåœ¨æŒç»­é›†æˆï¼ˆCIï¼‰ç³»ç»Ÿä¸­ï¼Œåˆ™å¯èƒ½æ›´å€¾å‘äºç”Ÿæˆè¯¦ç»†çš„ HTML æŠ¥å‘Šä»¥ä¾¿è¿›ä¸€æ­¥åˆ†æã€‚</p><h3 id="å®é™…ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-3"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œå¹¶ä¸”å·²ç»ç¼–å†™äº†ä¸€ç³»åˆ—è‡ªåŠ¨åŒ–æµ‹è¯•æ¥éªŒè¯ä½ çš„ä»£ç ã€‚ä½¿ç”¨ Node.js v21.7.1 çš„â€œMultiple Reportersâ€åŠŸèƒ½ï¼Œä½ å¯ä»¥é…ç½®ä½ çš„æµ‹è¯•ç¯å¢ƒä»¥ä¾¿åŒæ—¶ç”Ÿæˆå¤šç§ç±»å‹çš„æŠ¥å‘Šã€‚ä»¥ä¸‹æ˜¯å‡ ä¸ªå®é™…åœºæ™¯ï¼š</p><ol><li><p><strong>å¼€å‘é˜¶æ®µ</strong>ï¼šåœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œä½ å¯èƒ½å¸Œæœ›çœ‹åˆ°ä¸€ä¸ªç®€æ´æ˜äº†çš„æ–‡æœ¬æŠ¥å‘Šï¼Œè¿™æ ·ä½ å°±å¯ä»¥è¿…é€Ÿåœ°çŸ¥é“å“ªäº›æµ‹è¯•é€šè¿‡äº†ï¼Œå“ªäº›å¤±è´¥äº†ã€‚æ­¤æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç®€å•çš„æ–‡æœ¬æ ¼å¼æŠ¥å‘Šç”Ÿæˆå™¨ï¼Œå¦‚<code>spec</code>æˆ–<code>dot</code>ã€‚</p></li><li><p><strong>ä»£ç å®¡æŸ¥/å›¢é˜Ÿåˆ†äº«</strong>ï¼šå½“ä½ éœ€è¦ä¸å›¢é˜Ÿæˆå‘˜åˆ†äº«æµ‹è¯•ç»“æœï¼Œæˆ–è€…æäº¤ä»£ç å®¡æŸ¥æ—¶ï¼Œä¸€ä¸ªæ›´è¯¦å°½çš„ HTML æŠ¥å‘Šå¯èƒ½æ›´åŠ æœ‰ç”¨ã€‚å®ƒå¯ä»¥æä¾›å…³äºå¤±è´¥æµ‹è¯•çš„è¯¦ç»†ä¿¡æ¯ï¼Œç”šè‡³åŒ…æ‹¬é”™è¯¯æˆªå›¾ã€‚è¿™æ ·çš„æŠ¥å‘Šå¯ä»¥å¸®åŠ©å›¢é˜Ÿæ›´å¥½åœ°ç†è§£é—®é¢˜å¹¶æä¾›åé¦ˆã€‚</p></li><li><p><strong>æŒç»­é›†æˆï¼ˆCIï¼‰ç¯å¢ƒ</strong>ï¼šåœ¨ CI ç¯å¢ƒä¸­ï¼Œä½ å¯èƒ½å¸Œæœ›ç”Ÿæˆ JUNIT æˆ–å…¶ä»–æ ¼å¼çš„æŠ¥å‘Šï¼Œä»¥ä¾¿ CI å·¥å…·ï¼ˆå¦‚ Jenkinsã€Travis CI ç­‰ï¼‰å¯ä»¥è§£æè¿™äº›æŠ¥å‘Šå¹¶åœ¨æ„å»ºæµæ°´çº¿ä¸­æ˜¾ç¤ºç›¸åº”çš„ç»“æœå’Œè¶‹åŠ¿ã€‚</p></li></ol><h3 id="å¦‚ä½•ä½¿ç”¨-multiple-reporters" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-multiple-reporters"><span>å¦‚ä½•ä½¿ç”¨ Multiple Reporters</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œå‡è®¾ä½ æ­£åœ¨ä½¿ç”¨ä¸€ä¸ªæµè¡Œçš„æµ‹è¯•æ¡†æ¶ï¼Œæ¯”å¦‚ Mochaã€‚åœ¨ v21.7.1 ç‰ˆæœ¬ä¹‹å‰ï¼Œå¦‚æœä½ æƒ³è¦ä½¿ç”¨å¤šä¸ªæŠ¥å‘Šç”Ÿæˆå™¨ï¼Œå¯èƒ½éœ€è¦æ‰‹åŠ¨é…ç½®æˆ–è¿è¡Œå¤šæ¬¡æµ‹è¯•ï¼Œæ¯æ¬¡ä½¿ç”¨ä¸åŒçš„æŠ¥å‘Šç”Ÿæˆå™¨ã€‚ä½†æ˜¯ï¼Œç°åœ¨æœ‰äº†â€œMultiple Reportersâ€çš„æ”¯æŒï¼Œä½ å¯ä»¥åœ¨å•æ¬¡æµ‹è¯•è¿è¡Œä¸­æŒ‡å®šå¤šä¸ªæŠ¥å‘Šç”Ÿæˆå™¨ã€‚è¿™å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œé€‰é¡¹æˆ–é…ç½®æ–‡ä»¶æ¥å®ç°ï¼Œå…·ä½“å–å†³äºæ‰€ä½¿ç”¨çš„æµ‹è¯•æ¡†æ¶ã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨ Mocha ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>--reporter</code>é€‰é¡¹æ¥æŒ‡å®šæŠ¥å‘Šç”Ÿæˆå™¨ã€‚ä½¿ç”¨æ–°çš„ Multiple Reporters åŠŸèƒ½ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mocha</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --reporter=spec</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --reporter=html:path/to/report.html</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ä¸Šé¢çš„å‘½ä»¤ä¼šåœ¨è¿è¡Œæµ‹è¯•æ—¶åŒæ—¶ç”Ÿæˆä¸€ä¸ª<code>spec</code>é£æ ¼çš„æ–‡æœ¬æŠ¥å‘Šå’Œä¸€ä¸ª HTML æŠ¥å‘Šï¼Œå¹¶å°† HTML æŠ¥å‘Šä¿å­˜åˆ°æŒ‡å®šçš„ä½ç½®ã€‚</p><p>æ€»è€Œè¨€ä¹‹ï¼Œâ€œMultiple Reportersâ€æ˜¯ä¸€ä¸ªå¼ºå¤§çš„åŠŸèƒ½ï¼Œå®ƒè®©å¼€å‘è€…å’Œå›¢é˜Ÿåœ¨æ„å»ºå’Œç»´æŠ¤é«˜è´¨é‡çš„è½¯ä»¶é¡¹ç›®æ—¶ï¼Œèƒ½å¤Ÿçµæ´»åœ°é€‰æ‹©å’Œç»„åˆæœ€åˆé€‚çš„æµ‹è¯•æŠ¥å‘Šç­–ç•¥ã€‚</p><h2 id="run-options" tabindex="-1"><a class="header-anchor" href="#run-options"><span><a href="https://nodejs.org/docs/latest/api/test.html#runoptions" target="_blank" rel="noopener noreferrer">run([options])</a></span></a></h2><p>Node.js çš„<code>run([options])</code>æ–¹æ³•æ˜¯ç”¨äºå¯åŠ¨ä¸€ä¸ªæµ‹è¯•çš„ï¼Œä¸»è¦å‡ºç°åœ¨ Node.js çš„æµ‹è¯•æ¡†æ¶ä¸­ã€‚æˆ‘ä»¬æ¥ç®€å•äº†è§£ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•ï¼Œå¹¶é€šè¿‡ä¸€äº›åŸºæœ¬ç¤ºä¾‹è¯´æ˜å…¶ç”¨æ³•å’Œä½œç”¨ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-2" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-2"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>é¦–å…ˆï¼Œéœ€è¦æ˜ç¡®<code>run([options])</code>æ–¹æ³•æ˜¯ Node.js å†…ç½®æµ‹è¯•æ¡†æ¶çš„ä¸€éƒ¨åˆ†ã€‚å®ƒå…è®¸ä½ æ‰§è¡Œä¸€äº›æµ‹è¯•å‘½ä»¤ï¼Œé€šè¿‡ä¼ é€’ä¸åŒçš„é€‰é¡¹æ¥æ§åˆ¶æµ‹è¯•çš„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥æŒ‡å®šæµ‹è¯•è„šæœ¬çš„è·¯å¾„ã€è®¾ç½®ç¯å¢ƒå˜é‡æˆ–è€…æ˜¯å†³å®šæ˜¯å¦ä½¿ç”¨é™é»˜æ¨¡å¼ç­‰ã€‚</p><h3 id="å‚æ•°" tabindex="-1"><a class="header-anchor" href="#å‚æ•°"><span>å‚æ•°</span></a></h3><ul><li><code>options</code>ï¼šä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œæ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚ä½ å¯ä»¥é€šè¿‡è¿™ä¸ªå¯¹è±¡æ¥é…ç½®ä½ çš„æµ‹è¯•è¿è¡Œã€‚å¯èƒ½åŒ…å«å¦‚ä¸‹å±æ€§ï¼š <ul><li><code>testPath</code>ï¼šå®šä¹‰æµ‹è¯•æ–‡ä»¶çš„ä½ç½®ã€‚</li><li><code>silent</code>ï¼šå¸ƒå°”å€¼ï¼Œå®šä¹‰æ˜¯å¦ä»¥é™é»˜æ¨¡å¼è¿è¡Œæµ‹è¯•ï¼Œå³ä¸åœ¨æ§åˆ¶å°è¾“å‡ºæµ‹è¯•è¿‡ç¨‹ä¿¡æ¯ã€‚</li><li><code>env</code>ï¼šå¯¹è±¡ç±»å‹ï¼Œå…è®¸ä½ ä¸ºæµ‹è¯•è¿›ç¨‹è®¾ç½®ç¯å¢ƒå˜é‡ã€‚</li></ul></li></ul><h3 id="è¿”å›å€¼" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼"><span>è¿”å›å€¼</span></a></h3><ul><li>è¿™ä¸ªæ–¹æ³•é€šå¸¸ä¼šè¿”å›ä¸€ä¸ª Promiseï¼Œè¡¨ç¤ºæµ‹è¯•çš„å®ŒæˆçŠ¶æ€ã€‚ä½ å¯ä»¥ä½¿ç”¨<code>.then()</code>å’Œ<code>.catch()</code>æ¥å¤„ç†æˆåŠŸæˆ–å¤±è´¥çš„æƒ…å†µã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-2"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ª Node.js é¡¹ç›®ï¼Œé‡Œé¢æœ‰ä¸€äº›ä½ å†™çš„å‡½æ•°éœ€è¦è¿›è¡Œæµ‹è¯•ï¼š</p><h4 id="ç¤ºä¾‹-1-åŸºç¡€æµ‹è¯•è¿è¡Œ" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åŸºç¡€æµ‹è¯•è¿è¡Œ"><span>ç¤ºä¾‹ 1: åŸºç¡€æµ‹è¯•è¿è¡Œ</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯åŠ¨æµ‹è¯•ï¼Œæ²¡æœ‰ç‰¹åˆ«çš„é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æµ‹è¯•å®Œæˆ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æµ‹è¯•å‘ç”Ÿé”™è¯¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç æ¼”ç¤ºäº†å¦‚ä½•æ— é…ç½®åœ°å¯åŠ¨æµ‹è¯•ï¼Œå¹¶åœ¨æµ‹è¯•å®Œæˆåæ‰“å°ä¸€æ¡æ¶ˆæ¯ã€‚</p><h4 id="ç¤ºä¾‹-2-æŒ‡å®šæµ‹è¯•è„šæœ¬å’Œç¯å¢ƒå˜é‡" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æŒ‡å®šæµ‹è¯•è„šæœ¬å’Œç¯å¢ƒå˜é‡"><span>ç¤ºä¾‹ 2: æŒ‡å®šæµ‹è¯•è„šæœ¬å’Œç¯å¢ƒå˜é‡</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨optionsé…ç½®æµ‹è¯•è·¯å¾„å’Œç¯å¢ƒå˜é‡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  testPath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./tests/myTestFile.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  env</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">NODE_ENV</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æŒ‡å®šæ–‡ä»¶çš„æµ‹è¯•å®Œæˆ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æµ‹è¯•å‘ç”Ÿé”™è¯¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡<code>testPath</code>æŒ‡å®šäº†æµ‹è¯•æ–‡ä»¶çš„å…·ä½“è·¯å¾„ï¼Œå¹¶ä¸”é€šè¿‡<code>env</code>è®¾ç½®äº†ç¯å¢ƒå˜é‡<code>NODE_ENV</code>ä¸º<code>test</code>ã€‚è¿™æ ·çš„è®¾ç½®å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ä¸åŒç¯å¢ƒä¸‹è¿›è¡Œé’ˆå¯¹æ€§çš„æµ‹è¯•ã€‚</p><h3 id="å°ç»“" tabindex="-1"><a class="header-anchor" href="#å°ç»“"><span>å°ç»“</span></a></h3><p><code>run([options])</code>æ–¹æ³•æ˜¯ Node.js å†…ç½®æµ‹è¯•æ¡†æ¶æä¾›çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå…è®¸ä½ çµæ´»åœ°é…ç½®å’Œæ‰§è¡Œä½ çš„æµ‹è¯•ä»£ç ã€‚é€šè¿‡åˆç†åˆ©ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä½ å¯ä»¥æ›´åŠ æ–¹ä¾¿åœ°è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œä»è€Œæé«˜ä»£ç è´¨é‡å’Œå¼€å‘æ•ˆç‡ã€‚</p><h2 id="test-name-options-fn" tabindex="-1"><a class="header-anchor" href="#test-name-options-fn"><span><a href="https://nodejs.org/docs/latest/api/test.html#testname-options-fn" target="_blank" rel="noopener noreferrer">test([name][, options][, fn])</a></span></a></h2><p>ç†è§£ Node.js v21.7.1 ä¸­çš„ <code>test([name][, options][, fn])</code> å‡½æ•°ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ä¸€äº›åŸºç¡€æ¦‚å¿µã€‚Node.js æ˜¯ä¸€ä¸ªå¯ä»¥è®©å¼€å‘è€…ä½¿ç”¨ JavaScript ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç çš„è¿è¡Œæ—¶ç¯å¢ƒã€‚åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œ&quot;æµ‹è¯•&quot;æ˜¯ç¡®ä¿ä½ çš„ä»£ç æŒ‰é¢„æœŸå·¥ä½œçš„é‡è¦æ­¥éª¤ã€‚Node.js v21.7.1 ä¸­å¼•å…¥æˆ–æ›´æ–°çš„ <code>test()</code> å‡½æ•°æ˜¯è¿™ä¸ªç¯å¢ƒæ”¯æŒçš„æµ‹è¯•èƒ½åŠ›çš„ä¸€éƒ¨åˆ†ã€‚</p><h3 id="test-å‡½æ•°ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#test-å‡½æ•°ç®€ä»‹"><span><code>test()</code> å‡½æ•°ç®€ä»‹</span></a></h3><p><code>test()</code> å‡½æ•°æ˜¯ç”¨æ¥å®šä¹‰ä¸€ä¸ªæµ‹è¯•å•å…ƒçš„ã€‚å®ƒé€šå¸¸åŒ…å«ä¸‰ä¸ªå‚æ•°ï¼š<code>name</code>ã€<code>options</code> å’Œ <code>fn</code>ï¼š</p><ul><li><code>name</code>ï¼ˆå¿…éœ€ï¼‰: ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæè¿°äº†æµ‹è¯•çš„å†…å®¹ã€‚</li><li><code>options</code>ï¼ˆå¯é€‰ï¼‰: ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥è°ƒæ•´æµ‹è¯•çš„è¡Œä¸ºã€‚ï¼ˆä¾‹å¦‚ï¼Œä½ å¯èƒ½ä¼šè®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼ŒæŒ‡å®šæµ‹è¯•è¿è¡Œåº”è¯¥åœ¨å¤šé•¿æ—¶é—´å†…å®Œæˆã€‚ï¼‰</li><li><code>fn</code>ï¼ˆå¯é€‰ï¼‰: ä¸€ä¸ªå‡½æ•°ï¼Œå®šä¹‰äº†æµ‹è¯•çš„å…·ä½“æ“ä½œã€‚è¿™é‡Œä½ å°†ç¼–å†™å®é™…çš„æµ‹è¯•é€»è¾‘ã€‚</li></ul><h3 id="ç¤ºä¾‹è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹è¯´æ˜"><span>ç¤ºä¾‹è¯´æ˜</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç®€å•çš„ web åº”ç”¨ï¼Œå¹¶æƒ³è¦æµ‹è¯•ä¸€ä¸ªåŠŸèƒ½ï¼Œæ¯”å¦‚è¯´ç”¨æˆ·åçš„éªŒè¯é€»è¾‘ã€‚è¿™é‡Œæˆ‘ä»¬å°†ä½¿ç”¨ <code>test()</code> å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªæµ‹è¯•æ¡ˆä¾‹ã€‚</p><h4 id="ä¾‹å­-1-æµ‹è¯•ç”¨æˆ·åä¸ä¸ºç©º" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-æµ‹è¯•ç”¨æˆ·åä¸ä¸ºç©º"><span>ä¾‹å­ 1: æµ‹è¯•ç”¨æˆ·åä¸ä¸ºç©º</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">strict</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®šä¹‰æµ‹è¯•æ¡ˆä¾‹</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç”¨æˆ·åä¸åº”ä¸ºç©º&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> username</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;exampleUser&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä»ç”¨æˆ·è¾“å…¥è·å–çš„</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">notStrictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">username</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç”¨æˆ·åä¸åº”ä¸ºç©º&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ <code>options</code> å‚æ•°ï¼Œåªæä¾›äº†ä¸¤ä¸ªå‚æ•°ç»™ <code>test()</code> å‡½æ•°ï¼šæµ‹è¯•çš„åå­—å’Œä¸€ä¸ªå®šä¹‰æµ‹è¯•é€»è¾‘çš„å‡½æ•°ã€‚æˆ‘ä»¬ä½¿ç”¨äº† Node.js å†…ç½®çš„ <code>assert</code> æ¨¡å—æ¥æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦ä¸ºç©ºã€‚å¦‚æœ <code>username</code> æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œæµ‹è¯•å°†å¤±è´¥å¹¶æ˜¾ç¤ºæä¾›çš„é”™è¯¯ä¿¡æ¯ï¼ˆ&#39;ç”¨æˆ·åä¸åº”ä¸ºç©º&#39;ï¼‰ã€‚</p><h4 id="ä¾‹å­-2-ä½¿ç”¨-options-æ§åˆ¶æµ‹è¯•è¶…æ—¶æ—¶é—´" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ä½¿ç”¨-options-æ§åˆ¶æµ‹è¯•è¶…æ—¶æ—¶é—´"><span>ä¾‹å­ 2: ä½¿ç”¨ Options æ§åˆ¶æµ‹è¯•è¶…æ—¶æ—¶é—´</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">strict</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®šä¹‰æµ‹è¯•æ¡ˆä¾‹ï¼Œå¸¦æœ‰è¶…æ—¶è®¾ç½®</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç”¨æˆ·å¹´é¾„è®¡ç®—åŠŸèƒ½&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> age</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> calculateUserAge</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;1990-01-01&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä¸€ä¸ªè®¡ç®—å¹´é¾„çš„å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">age</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">33</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å¹´é¾„åº”å½“ä¸º 33&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1500</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è®¡ç®—å’ŒéªŒè¯è¿‡ç¨‹éœ€è¦ 1500ms</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åŠ å…¥äº† <code>options</code> å‚æ•°ï¼ŒæŒ‡å®šäº†ä¸€ä¸ª <code>timeout</code> å±æ€§ã€‚è¿™æ„å‘³ç€æµ‹è¯•éœ€è¦åœ¨ 2000 æ¯«ç§’å†…å®Œæˆï¼Œå¦åˆ™è®¤ä¸ºæµ‹è¯•å¤±è´¥ã€‚è¿™ç§æ–¹å¼å¾ˆæœ‰ç”¨ï¼Œå°¤å…¶æ˜¯å½“ä½ çš„æµ‹è¯•ä¾èµ–äºæŸäº›å¯èƒ½è€—æ—¶çš„æ“ä½œï¼ˆæ¯”å¦‚ç½‘ç»œè¯·æ±‚æˆ–æ–‡ä»¶æ“ä½œï¼‰æ—¶ã€‚</p><h3 id="ç»“è¯­" tabindex="-1"><a class="header-anchor" href="#ç»“è¯­"><span>ç»“è¯­</span></a></h3><p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>test()</code> å‡½æ•°å¦‚ä½•è¢«ç”¨äºå®šä¹‰å’Œæ‰§è¡Œæµ‹è¯•æ¡ˆä¾‹ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨å‚æ•°æ¥è¯¦ç»†æ§åˆ¶æµ‹è¯•çš„è¡Œä¸ºã€‚æ¯ä¸ªæµ‹è¯•æ¡ˆä¾‹éƒ½å›´ç»•ç‰¹å®šçš„åŠŸèƒ½æˆ–ä»£ç æ®µå±•å¼€ï¼Œå¸®åŠ©å¼€å‘è€…ç¡®ä¿ä»–ä»¬çš„ä»£ç èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚åœ¨å®è·µä¸­ï¼Œä½ ä¼šæ ¹æ®è‡ªå·±çš„éœ€æ±‚ï¼Œç¼–å†™å¤§é‡ä¸åŒçš„æµ‹è¯•æ¡ˆä¾‹ï¼Œä»è€Œæ„å»ºèµ·ä¸€ä¸ªå…¨é¢ä¸”ç¨³å¥çš„æµ‹è¯•å¥—ä»¶ï¼Œç¡®ä¿ä½ çš„åº”ç”¨è´¨é‡ã€‚</p><h2 id="test-skip-name-options-fn" tabindex="-1"><a class="header-anchor" href="#test-skip-name-options-fn"><span><a href="https://nodejs.org/docs/latest/api/test.html#testskipname-options-fn" target="_blank" rel="noopener noreferrer">test.skip([name][, options][, fn])</a></span></a></h2><p>ç†è§£ <code>test.skip([name][, options][, fn])</code> åŠŸèƒ½ä¹‹å‰ï¼Œé¦–å…ˆéœ€è¦çŸ¥é“å®ƒå±äº Node.js ä¸­çš„æµ‹è¯•åŠŸèƒ½ï¼Œä¸“é—¨ç”¨äºç¼–å†™å’Œæ‰§è¡Œä»£ç æµ‹è¯•ã€‚è¿™ä¸ªå…·ä½“æ–¹æ³•æ˜¯ç”¨æ¥è·³è¿‡æŸäº›æµ‹è¯•ç”¨ä¾‹çš„æ‰§è¡Œï¼Œè¿™æ ·åšçš„åŸå› å¯èƒ½æ˜¯å› ä¸ºè¿™äº›æµ‹è¯•ç›®å‰ä¸é€‚ç”¨ã€å­˜åœ¨å·²çŸ¥çš„ bugï¼Œæˆ–è€…ä»…ä»…æ˜¯å› ä¸ºå¼€å‘è€…æƒ³ä¸´æ—¶ç¦ç”¨æŸäº›æµ‹è¯•ã€‚</p><h3 id="å‚æ•°è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š"><span>å‚æ•°è§£é‡Šï¼š</span></a></h3><ul><li><strong>name</strong> (å¯é€‰): è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œç”¨äºæŒ‡å®šæµ‹è¯•æ¡ˆä¾‹çš„åç§°ã€‚</li><li><strong>options</strong> (å¯é€‰): ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥åŒ…å«å¤šç§é…ç½®é€‰é¡¹ã€‚</li><li><strong>fn</strong> (å¯é€‰): æµ‹è¯•å‡½æ•°ï¼Œé‡Œé¢åŒ…å«äº†è¦æ‰§è¡Œçš„æµ‹è¯•ä»£ç ã€‚å¦‚æœçœç•¥è¿™ä¸ªå‚æ•°ï¼Œæ„å‘³ç€æµ‹è¯•ä¼šè¢«æ ‡è®°ä¸ºè·³è¿‡ï¼Œä½†ä¸ä¼šæ‰§è¡Œä»»ä½•æ“ä½œã€‚</li></ul><h3 id="å¦‚ä½•ä½¿ç”¨-2" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-2"><span>å¦‚ä½•ä½¿ç”¨ï¼š</span></a></h3><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œç”¨ <code>test.skip</code> æ¥è·³è¿‡æŸäº›ä½ ä¸å¸Œæœ›æ‰§è¡Œçš„æµ‹è¯•ã€‚è¿™ç‰¹åˆ«æœ‰ç”¨åœ¨ä½ æ­£åœ¨è¿›è¡Œå¤§å‹é¡¹ç›®ä¸­ï¼Œå¹¶ä¸”æŸäº›åŠŸèƒ½æ­£åœ¨å¼€å‘æˆ–è€…ç»´æŠ¤ä¸­ï¼Œæš‚æ—¶ä¸é€‚åˆè¿›è¡Œæµ‹è¯•ã€‚</p><h4 id="ç¤ºä¾‹ä¸€-è·³è¿‡ä¸€ä¸ªç®€å•çš„æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä¸€-è·³è¿‡ä¸€ä¸ªç®€å•çš„æµ‹è¯•"><span>ç¤ºä¾‹ä¸€ï¼šè·³è¿‡ä¸€ä¸ªç®€å•çš„æµ‹è¯•</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå¾…æµ‹è¯•çš„å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">b</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> a</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> b</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ test.skip è·³è¿‡æµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">skip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;add function - should add two numbers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™è¡Œä»£ç ä¸ä¼šè¢«æ‰§è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªéå¸¸ç®€å•çš„ <code>add</code> å‡½æ•°ï¼Œæˆ‘ä»¬æœ¬æ¥æ‰“ç®—å¯¹å®ƒè¿›è¡Œæµ‹è¯•ï¼Œä½†æ˜¯é€šè¿‡ä½¿ç”¨ <code>test.skip</code>ï¼Œè¿™ä¸ªæµ‹è¯•å°†ä¸ä¼šæ‰§è¡Œã€‚è¿™å¯¹äºä¸´æ—¶æ€§åœ°å¿½ç•¥æŸäº›æµ‹è¯•éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚å½“ä½ å·²ç»çŸ¥é“è¿™ä¸ªæµ‹è¯•ç°åœ¨ä¼šå¤±è´¥ï¼Œä½†ä½ å‡ºäºæŸäº›åŸå› ï¼ˆæ¯”å¦‚ç­‰å¾…ä¾èµ–æ›´æ–°ï¼‰å½“å‰ä¸æƒ³ä¿®å¤å®ƒã€‚</p><h4 id="ç¤ºä¾‹äºŒ-è·³è¿‡å¸¦æœ‰ç‰¹å®šæ¡ä»¶çš„æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹äºŒ-è·³è¿‡å¸¦æœ‰ç‰¹å®šæ¡ä»¶çš„æµ‹è¯•"><span>ç¤ºä¾‹äºŒï¼šè·³è¿‡å¸¦æœ‰ç‰¹å®šæ¡ä»¶çš„æµ‹è¯•</span></a></h4><p>æœ‰æ—¶å€™ï¼ŒåŸºäºç‰¹å®šçš„æ¡ä»¶æ¥å†³å®šæ˜¯å¦è·³è¿‡æŸä¸ªæµ‹è¯•ä¹Ÿæ˜¯éå¸¸æœ‰ç”¨çš„ã€‚è¯·çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> isFeatureEnabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">featureName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾è¿™ä¸ªå‡½æ•°æ ¹æ®æŸäº›æ¡ä»¶è¿”å›ç‰¹æ€§æ˜¯å¦å¯ç”¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿç‰¹æ€§æœªå¯ç”¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ¹æ®æ¡ä»¶åŠ¨æ€è·³è¿‡æµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">isFeatureEnabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;new-feature&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">skip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Test for new feature&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æµ‹è¯•ä»£ç ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆæ£€æŸ¥ä¸€ä¸ªåä¸º <code>new-feature</code> çš„ç‰¹æ€§æ˜¯å¦å¯ç”¨ã€‚å‡è®¾ <code>isFeatureEnabled</code> è¿”å› <code>false</code>ï¼Œæ„å‘³ç€è¯¥ç‰¹æ€§æœªå¯ç”¨ï¼Œæˆ‘ä»¬å°±ä½¿ç”¨ <code>test.skip</code> è·³è¿‡ç›¸å…³çš„æµ‹è¯•ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿æˆ‘ä»¬çš„æµ‹è¯•å¥—ä»¶åªè¿è¡Œå½“å‰ç¯å¢ƒæˆ–é…ç½®æ”¯æŒçš„æµ‹è¯•ã€‚</p><h3 id="å°ç»“-1" tabindex="-1"><a class="header-anchor" href="#å°ç»“-1"><span>å°ç»“ï¼š</span></a></h3><p>ä½¿ç”¨ <code>test.skip</code> æ˜¯ä¸€ç§çµæ´»æ§åˆ¶æµ‹è¯•æ‰§è¡Œçš„æ–¹æ³•ã€‚å®ƒå…è®¸å¼€å‘è€…æ ¹æ®éœ€è¦ä¸´æ—¶æˆ–åŸºäºæ¡ä»¶è·³è¿‡æŸäº›æµ‹è¯•ï¼Œè¿™åœ¨å¼€å‘è¿‡ç¨‹ä¸­æä¸ºæœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯é¢å¯¹é‚£äº›ç”±äºå„ç§åŸå› æš‚æ—¶æ— æ³•é€šè¿‡çš„æµ‹è¯•ã€‚</p><h2 id="test-todo-name-options-fn" tabindex="-1"><a class="header-anchor" href="#test-todo-name-options-fn"><span><a href="https://nodejs.org/docs/latest/api/test.html#testtodoname-options-fn" target="_blank" rel="noopener noreferrer">test.todo([name][, options][, fn])</a></span></a></h2><p>Node.js v21.7.1 ä¸­çš„<code>test.todo</code>æ˜¯æµ‹è¯•æ¡†æ¶ Jest çš„ä¸€ä¸ªç‰¹æ€§ï¼Œè¢«ç”¨äºæ ‡è®°é‚£äº›è®¡åˆ’ç¼–å†™ä½†å½“å‰æœªå®ç°æˆ–æœªå®Œæˆçš„æµ‹è¯•ã€‚è¿™æ˜¯ä¸€ç§éå¸¸å®ç”¨çš„åŠŸèƒ½ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…ç»„ç»‡å’Œè§„åˆ’ä»–ä»¬çš„æµ‹è¯•å·¥ä½œï¼ŒåŒæ—¶ä¹Ÿç¡®ä¿äº†æµ‹è¯•å¥—ä»¶çš„å®Œæ•´æ€§ï¼Œå³ä½¿åœ¨æœ‰äº›æµ‹è¯•å°šæœªå‡†å¤‡å¥½è¿è¡Œçš„æƒ…å†µä¸‹ã€‚</p><h3 id="è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š"><span>è§£é‡Š</span></a></h3><p>åœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•æ‰®æ¼”ç€é‡è¦è§’è‰²ã€‚å®ƒèƒ½å¤Ÿç¡®ä¿ä½ çš„ä»£ç æŒ‰é¢„æœŸå·¥ä½œï¼ŒåŒæ—¶å½“ä½ æ·»åŠ æ–°ç‰¹æ€§æˆ–ä¿®å¤ bug æ—¶ï¼Œå®ƒèƒ½å¸®åŠ©ä½ ç¡®ä¿ä¹‹å‰çš„åŠŸèƒ½ä»ç„¶æ­£å¸¸å·¥ä½œã€‚ä½†æœ‰æ—¶å€™ï¼Œåœ¨å¼€å‘çš„æŸä¸ªé˜¶æ®µï¼Œä½ å¯èƒ½ä¼šæ„è¯†åˆ°éœ€è¦å¯¹æŸäº›åŠŸèƒ½è¿›è¡Œæµ‹è¯•ï¼Œä½†ç”±äºå„ç§åŸå› ï¼ˆæ¯”å¦‚åŠŸèƒ½è¿˜æ²¡å®ç°æˆ–è€…ç¼ºå°‘è¶³å¤Ÿçš„ä¿¡æ¯æ¥ç¼–å†™æµ‹è¯•ï¼‰ï¼Œä½ æš‚æ—¶æ— æ³•ç¼–å†™è¿™äº›æµ‹è¯•ã€‚</p><p>è¿™æ—¶ï¼Œ<code>test.todo</code>å°±æ´¾ä¸Šäº†ç”¨åœºã€‚ä½¿ç”¨<code>test.todo</code>ï¼Œä½ å¯ä»¥ä¸ºè¿™äº›å°šæœªç¼–å†™çš„æµ‹è¯•åˆ›å»ºå ä½ç¬¦ã€‚è¿™æ ·åšæœ‰ä¸¤ä¸ªå¥½å¤„ï¼šé¦–å…ˆï¼Œå®ƒæé†’ä½ å’Œä½ çš„å›¢é˜Ÿè¿˜æœ‰å¾…å®Œæˆçš„æµ‹è¯•ï¼›å…¶æ¬¡ï¼Œå®ƒå…è®¸ä½ çš„æµ‹è¯•å¥—ä»¶åœ¨åŒ…å«æœªå®Œæˆçš„æµ‹è¯•æ—¶ä»ç„¶èƒ½å¤Ÿè¿è¡Œå’Œé€šè¿‡ã€‚</p><h3 id="è¯­æ³•" tabindex="-1"><a class="header-anchor" href="#è¯­æ³•"><span>è¯­æ³•</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">todo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">][, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>name</code>: å­—ç¬¦ä¸²ç±»å‹ï¼Œæè¿°å¾…åŠæµ‹è¯•çš„å†…å®¹ã€‚</li><li><code>options</code>: ï¼ˆå¯é€‰ï¼‰å¯¹è±¡ç±»å‹ï¼Œç”¨äºé…ç½®æµ‹è¯•ï¼Œæ¯”å¦‚è¶…æ—¶è®¾ç½®ç­‰ã€‚</li><li><code>fn</code>: ï¼ˆå¯é€‰ï¼‰å‡½æ•°ç±»å‹ï¼Œå¦‚æœæä¾›ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªæµ‹è¯•å®ç°ï¼Œä¸è¿‡é€šå¸¸åœ¨ä½¿ç”¨<code>test.todo</code>æ—¶ä¸ä¼šæä¾›è¿™ä¸ªå‚æ•°ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-3"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œå¹¶ä¸”ä½ æƒ³è¦æµ‹è¯•ç”¨æˆ·ç™»å½•åŠŸèƒ½ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªåŠŸèƒ½è¿˜æ²¡å®ç°ã€‚ä½ å¯ä»¥è¿™æ ·ä½¿ç”¨<code>test.todo</code>æ¥æ ‡è®°è¿™ä¸ªå¾…ç¼–å†™çš„æµ‹è¯•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> test</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æœ‰ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶user.test.js</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ‡è®°ä¸€ä¸ªå¾…åŠé¡¹ï¼šæµ‹è¯•ç”¨æˆ·ç™»å½•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">todo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should authenticate a user&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿™é‡Œå¯ä»¥æ·»åŠ ä¸€äº›é…ç½®é€‰é¡¹ï¼Œä½†é€šå¸¸ç•™ç©º</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯ä»¥ç»§ç»­ç¼–å†™å…¶ä»–å·²ç»å‡†å¤‡å¥½çš„æµ‹è¯•...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨<code>test.todo</code>å¹¶ä¼ é€’æµ‹è¯•åç§°<code>&#39;should authenticate a user&#39;</code>æ¥åˆ›å»ºäº†ä¸€ä¸ªå¾…åŠæµ‹è¯•é¡¹ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ¯å½“æˆ‘ä»¬è¿è¡Œæµ‹è¯•å¥—ä»¶æ—¶ï¼Œæˆ‘ä»¬éƒ½ä¼šçœ‹åˆ°è¿™ä¸ªå¾…åŠé¡¹ï¼Œæé†’æˆ‘ä»¬éœ€è¦å›è¿‡å¤´æ¥å®Œæˆè¿™ä¸ªæµ‹è¯•ã€‚</p><p>æ€»è€Œè¨€ä¹‹ï¼Œ<code>test.todo</code>æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå®ƒå¸®åŠ©ä½ ä¿æŒæµ‹è¯•çš„ç»„ç»‡æ€§å’Œè®¡åˆ’æ€§ï¼ŒåŒæ—¶ç¡®ä¿ä½ çš„æµ‹è¯•å¥—ä»¶å³ä½¿åœ¨å­˜åœ¨æœªå®Œæˆçš„æµ‹è¯•æ—¶ä¹Ÿèƒ½æ­£ç¡®æ‰§è¡Œã€‚</p><h2 id="test-only-name-options-fn" tabindex="-1"><a class="header-anchor" href="#test-only-name-options-fn"><span><a href="https://nodejs.org/docs/latest/api/test.html#testonlyname-options-fn" target="_blank" rel="noopener noreferrer">test.only([name][, options][, fn])</a></span></a></h2><p>åœ¨ Node.js ä¸­ï¼Œ<code>test.only([name][, options][, fn])</code> æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•çš„åŠŸèƒ½ï¼Œç‰¹åˆ«æ˜¯å½“ä½ ä½¿ç”¨å†…ç½®çš„æµ‹è¯•æ¡†æ¶æ—¶ï¼ˆä» Node.js v18.0.0 å¼€å§‹å¼•å…¥çš„å®éªŒæ€§åŠŸèƒ½ï¼‰ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ æŒ‡å®šç‰¹å®šçš„æµ‹è¯•æ¡ˆä¾‹ä»…æ­¤ä¸€æ¬¡è¢«æ‰§è¡Œï¼Œè€Œå¿½ç•¥å…¶ä»–çš„æµ‹è¯•æ¡ˆä¾‹ã€‚è¿™åœ¨è°ƒè¯•æˆ–è€…å¼€å‘è¿‡ç¨‹ä¸­éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå¯ä»¥å¸®åŠ©ä½ é›†ä¸­æ³¨æ„åŠ›åœ¨ç‰¹å®šçš„ä¸€ä¸ªæˆ–å‡ ä¸ªé—®é¢˜ä¸Šï¼Œè€Œä¸æ˜¯è¿è¡Œæ•´ä¸ªæµ‹è¯•å¥—ä»¶ã€‚</p><p><strong>å‚æ•°è§£é‡Šï¼š</strong></p><ul><li><code>name</code>: å¯é€‰å‚æ•°ã€‚è¿™æ˜¯ä½ ç»™æµ‹è¯•ç”¨ä¾‹æŒ‡å®šçš„åå­—ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ æ›´å®¹æ˜“åœ°è¯†åˆ«è¿™ä¸ªæµ‹è¯•ã€‚</li><li><code>options</code>: å¯é€‰å‚æ•°ã€‚æä¾›é¢å¤–çš„é…ç½®é¡¹ç»™æµ‹è¯•ç”¨ä¾‹ã€‚</li><li><code>fn</code>: è¿™æ˜¯ä½ çš„æµ‹è¯•ä»£ç æ‰€åœ¨çš„å‡½æ•°ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-1"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ä¸Šä¹¦åº—çš„åç«¯æœåŠ¡ï¼Œå¹¶ä¸”ä½ å·²ç»å†™äº†è‹¥å¹²æµ‹è¯•æ¥ç¡®ä¿ä½ çš„åº”ç”¨è¡¨ç°æ­£å¸¸ï¼ˆä¾‹å¦‚ï¼Œç”¨æˆ·ç™»å½•ã€å›¾ä¹¦æ£€ç´¢ã€è´­ç‰©è½¦åŠŸèƒ½ç­‰ï¼‰ã€‚çªç„¶ä½ å‘ç°åœ¨å›¾ä¹¦æ£€ç´¢åŠŸèƒ½ä¸­æœ‰ä¸€ä¸ªå°é”™è¯¯ã€‚åœ¨ä¿®å¤è¿™ä¸ªé”™è¯¯ä¹‹åï¼Œä½ å¯èƒ½åªæƒ³è¦é‡æ–°æµ‹è¯•å›¾ä¹¦æ£€ç´¢éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯è¿è¡Œæ‰€æœ‰çš„æµ‹è¯•æ¥çœ‹è¿™ä¸ªç‰¹å®šçš„ä¿®å¤æ˜¯å¦æˆåŠŸã€‚</p><p>è¿™æ—¶å€™ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨ <code>test.only</code> æ¥è¿è¡Œä¸å›¾ä¹¦æ£€ç´¢ç›¸å…³çš„æµ‹è¯•ç”¨ä¾‹ã€‚</p><p>å‡è®¾ä½ çš„æµ‹è¯•æ–‡ä»¶å«åš <code>book.test.js</code>ï¼Œé‡Œé¢åŒ…å«å¤šä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œä½†ä½ ä»…æƒ³æµ‹è¯•å›¾ä¹¦æ£€ç´¢åŠŸèƒ½ï¼š</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> test</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä½ ä¸æƒ³ä¸“æ³¨çš„æµ‹è¯•ç”¨ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;user login&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ç”¨æˆ·ç™»å½•çš„æµ‹è¯•é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨test.onlyæ¥æŒ‡å®šåªè¿è¡Œè¿™ä¸ªæµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">only</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;book search&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å›¾ä¹¦æ£€ç´¢åŠŸèƒ½çš„æµ‹è¯•é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å…¶ä»–çš„æµ‹è¯•ç”¨ä¾‹ï¼Œå°†ä¼šè¢«å¿½ç•¥</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;shopping cart&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è´­ç‰©è½¦åŠŸèƒ½çš„æµ‹è¯•é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå³ä½¿ <code>book.test.js</code> æ–‡ä»¶ä¸­è¿˜æœ‰å…³äºç”¨æˆ·ç™»å½•å’Œè´­ç‰©è½¦çš„æµ‹è¯•ç”¨ä¾‹ï¼Œä½¿ç”¨ <code>test.only(&#39;book search&#39;, ...)</code> åï¼Œåªæœ‰ â€œbook searchâ€ è¿™ä¸ªæµ‹è¯•ç”¨ä¾‹ä¼šè¢«æ‰§è¡Œã€‚è¿™æ ·ä½ å°±èƒ½å¤Ÿä¸“æ³¨äºä½ åˆšåˆšåšå‡ºæ”¹åŠ¨çš„éƒ¨åˆ†ï¼ŒèŠ‚çœæ—¶é—´ï¼Œæé«˜æ•ˆç‡ã€‚</p><p>è®°ä½ï¼Œç”±äºè¿™æ˜¯ä¸€ç§å¿«é€Ÿèšç„¦å•ä¸ªæµ‹è¯•çš„æ‰‹æ®µï¼ŒåŠ¡å¿…åœ¨å®Œæˆç‰¹å®šéƒ¨åˆ†çš„è°ƒè¯•æˆ–å¼€å‘ä¹‹åï¼Œå°† <code>test.only</code> ç§»é™¤æˆ–æ³¨é‡Šæ‰ï¼Œä»¥ç¡®ä¿ä½ çš„æµ‹è¯•è¦†ç›–å…¨éƒ¨åŠŸèƒ½ï¼Œç»´æŒä»£ç è´¨é‡ã€‚</p><h2 id="describe-name-options-fn" tabindex="-1"><a class="header-anchor" href="#describe-name-options-fn"><span><a href="https://nodejs.org/docs/latest/api/test.html#describename-options-fn" target="_blank" rel="noopener noreferrer">describe([name][, options][, fn])</a></span></a></h2><p>Node.js çš„ v21.7.1 ç‰ˆæœ¬å¼•å…¥äº†ä¸€äº›æ–°çš„æµ‹è¯•åŠŸèƒ½ï¼Œå…¶ä¸­åŒ…æ‹¬ <code>describe</code> å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°æ˜¯ç”¨äºç»„ç»‡å’Œæè¿°ä½ çš„æµ‹è¯•ç”¨ä¾‹çš„ï¼Œè®©ä½ çš„æµ‹è¯•ä»£ç æ›´åŠ ç»“æ„åŒ–å’Œæ˜“äºç†è§£ã€‚å®ƒä¸»è¦ç”¨åœ¨ Node.js çš„æµ‹è¯•æ¨¡å—ä¸­ï¼Œå¸®åŠ©å¼€å‘è€…ç¼–å†™å•å…ƒæµ‹è¯•ã€‚</p><h3 id="åŸºç¡€æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æ¦‚å¿µ"><span>åŸºç¡€æ¦‚å¿µ</span></a></h3><p>åœ¨æ·±å…¥åˆ°å…·ä½“çš„ <code>describe</code> å‡½æ•°ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆç®€å•ç†è§£å‡ ä¸ªä¸ä¹‹ç›¸å…³çš„åŸºæœ¬æ¦‚å¿µï¼š</p><ul><li><strong>Node.js</strong>: ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå…è®¸åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚</li><li><strong>æµ‹è¯•</strong>: åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œæµ‹è¯•æ˜¯ç¡®ä¿ä»£ç æŒ‰é¢„æœŸå·¥ä½œçš„è¿‡ç¨‹ã€‚ç‰¹åˆ«æ˜¯å•å…ƒæµ‹è¯•ï¼Œå®ƒå…³æ³¨äºéªŒè¯è½¯ä»¶ä¸­æœ€å°å¯æµ‹è¯•éƒ¨åˆ†çš„è¡Œä¸ºã€‚</li><li><strong>describe å‡½æ•°</strong>: ç”¨äºå®šä¹‰ä¸€ç»„ç›¸å…³çš„æµ‹è¯•ç”¨ä¾‹ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªâ€œæµ‹è¯•å¥—ä»¶â€ã€‚é€šè¿‡ç»™è¿™ç»„æµ‹è¯•ç”¨ä¾‹ä¸€ä¸ªå…±åŒçš„æè¿°ï¼Œä½¿å¾—æµ‹è¯•ç»“æœæŠ¥å‘Šæ›´åŠ æ¸…æ™°ã€‚</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•"><span>ä½¿ç”¨æ–¹æ³•</span></a></h3><p><code>describe</code> å‡½æ•°çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">][, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">][, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>name</code>: æµ‹è¯•å¥—ä»¶çš„åç§°ï¼Œç”¨æ¥æè¿°è¿™ä¸€ç»„æµ‹è¯•çš„ç›®çš„æˆ–æ‰€è¦æµ‹è¯•çš„åŠŸèƒ½ã€‚</li><li><code>options</code>: é…ç½®é€‰é¡¹ï¼Œå¯ç”¨äºè°ƒæ•´æµ‹è¯•çš„è¡Œä¸ºï¼ˆåœ¨æ–‡æ¡£ä¸­æŸ¥æ‰¾å…·ä½“çš„é…ç½®é¡¹ï¼‰ã€‚</li><li><code>fn</code>: ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨è¿™ä¸ªå‡½æ•°ä½“å†…ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>it</code> æˆ–å…¶ä»– <code>describe</code> æ¥å®šä¹‰å…·ä½“çš„æµ‹è¯•ç”¨ä¾‹æˆ–åµŒå¥—æ›´å¤šçš„æµ‹è¯•å¥—ä»¶ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-1"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç®€å•çš„è®¡ç®—å™¨åŠŸèƒ½ï¼Œä½ æƒ³æµ‹è¯•åŠ æ³•(<code>add</code>)å’Œå‡æ³•(<code>subtract</code>)åŠŸèƒ½æ˜¯å¦æŒ‰é¢„æœŸå·¥ä½œã€‚</p><h4 id="_1-å®šä¹‰æµ‹è¯•æ–‡ä»¶-calculator-test-js" tabindex="-1"><a class="header-anchor" href="#_1-å®šä¹‰æµ‹è¯•æ–‡ä»¶-calculator-test-js"><span>1. å®šä¹‰æµ‹è¯•æ–‡ä»¶: calculator.test.js</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">subtract</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./calculator&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ describe ç»„ç»‡æµ‹è¯•ç”¨ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Calculator Tests&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åŠ æ³•æµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Addition&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should return 5 when adding 2 and 3&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡æ³•æµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Subtraction&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should return 1 when subtracting 3 from 4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">subtract</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>describe</code> å‡½æ•°è¢«ç”¨æ¥åˆ›å»ºä¸¤ä¸ªæµ‹è¯•å¥—ä»¶ï¼šä¸€ä¸ªæ˜¯é’ˆå¯¹åŠ æ³•çš„æµ‹è¯•ï¼Œå¦ä¸€ä¸ªæ˜¯é’ˆå¯¹å‡æ³•çš„æµ‹è¯•ã€‚æ¯ä¸ªæµ‹è¯•å¥—ä»¶å†…éƒ¨éƒ½æœ‰è‡ªå·±çš„æµ‹è¯•ç”¨ä¾‹ï¼ˆé€šè¿‡ <code>it</code> å‡½æ•°å®šä¹‰ï¼‰ï¼Œç”¨ä»¥æµ‹è¯•ç‰¹å®šçš„åŠŸèƒ½ç‚¹ã€‚</p><h4 id="è§£é‡Š-1" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-1"><span>è§£é‡Šï¼š</span></a></h4><ul><li><strong>ç¬¬ä¸€ä¸ª <code>describe</code> (&#39;Calculator Tests&#39;)</strong>: è¿™æ˜¯æœ€å¤–å±‚çš„æµ‹è¯•å¥—ä»¶ï¼Œå®ƒæä¾›äº†æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹çš„æ€»æè¿°ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå®ƒè¡¨ç¤ºæˆ‘ä»¬æ­£åœ¨å¯¹â€œè®¡ç®—å™¨â€åŠŸèƒ½è¿›è¡Œæµ‹è¯•ã€‚</li><li><strong>ç¬¬äºŒä¸ª <code>describe</code> (&#39;Addition&#39;)</strong>: è¿™æ˜¯ä¸€ä¸ªåµŒå¥—çš„æµ‹è¯•å¥—ä»¶ï¼Œä¸“é—¨ç”¨äºç»„ç»‡æ‰€æœ‰åŠ æ³•ç›¸å…³çš„æµ‹è¯•ç”¨ä¾‹ã€‚</li><li><strong>ç¬¬ä¸‰ä¸ª <code>describe</code> (&#39;Subtraction&#39;)</strong>: åŒç†ï¼Œè¿™æ˜¯å¦ä¸€ä¸ªåµŒå¥—çš„æµ‹è¯•å¥—ä»¶ï¼Œä½†å®ƒå…³æ³¨äºå‡æ³•åŠŸèƒ½çš„æµ‹è¯•ã€‚</li></ul><p>ä½¿ç”¨ <code>describe</code> æ¥ç»„ç»‡æµ‹è¯•ï¼Œä¸ä»…å¯ä»¥ä½¿å¾—æµ‹è¯•ç»“æ„æ›´åŠ æ¸…æ™°ï¼Œè¿˜èƒ½åœ¨æµ‹è¯•ç»“æœè¾“å‡ºä¸­æ¸…æ¥šåœ°çœ‹åˆ°å“ªä¸€éƒ¨åˆ†åŠŸèƒ½å‡ºç°äº†é—®é¢˜ï¼Œæå¤§åœ°æ–¹ä¾¿äº†æµ‹è¯•å’Œè°ƒè¯•ã€‚</p><h2 id="describe-skip-name-options-fn" tabindex="-1"><a class="header-anchor" href="#describe-skip-name-options-fn"><span><a href="https://nodejs.org/docs/latest/api/test.html#describeskipname-options-fn" target="_blank" rel="noopener noreferrer">describe.skip([name][, options][, fn])</a></span></a></h2><p>åœ¨ Node.js ä¸­ï¼Œ<code>describe.skip([name][, options][, fn])</code> æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•çš„å‡½æ•°ï¼Œå®ƒæ¥è‡ª Node.js çš„æµ‹è¯•æ¡†æ¶ã€‚è¿™ä¸ªå‡½æ•°å…è®¸ä½ è·³è¿‡æŸäº›æµ‹è¯•ç”¨ä¾‹æˆ–æµ‹è¯•ç»„ã€‚åœ¨ç¼–ç¨‹å’Œè½¯ä»¶å¼€å‘ä¸­ï¼Œè¿›è¡Œå•å…ƒæµ‹è¯•æˆ–é›†æˆæµ‹è¯•æ˜¯éå¸¸é‡è¦çš„ä¸€æ­¥ï¼Œå› ä¸ºå®ƒå¸®åŠ©å¼€å‘è€…ç¡®ä¿ä»£ç çš„æ­£ç¡®æ€§å’Œç¨³å®šæ€§ã€‚ä½†æœ‰æ—¶å€™ï¼Œä½ å¯èƒ½ä¸æƒ³æ‰§è¡Œæ‰€æœ‰çš„æµ‹è¯•ï¼Œæˆ–è€…æŸäº›æµ‹è¯•åœ¨å½“å‰çš„å¼€å‘é˜¶æ®µè¿˜ä¸é€‚åˆè¿è¡Œã€‚è¿™å°±æ˜¯<code>describe.skip</code>æ´¾ä¸Šç”¨åœºçš„æ—¶å€™ã€‚</p><h3 id="å‚æ•°è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯´æ˜"><span>å‚æ•°è¯´æ˜</span></a></h3><ul><li><code>name</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œç”¨äºç»™ä½ è·³è¿‡çš„æµ‹è¯•ç»„å‘½åï¼Œä½¿è¾“å‡ºç»“æœæ›´æ˜“è¯»ã€‚</li><li><code>options</code>: è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå¯ä»¥ç”¨æ¥ä¸ºæµ‹è¯•é…ç½®é¢å¤–çš„é€‰é¡¹ã€‚</li><li><code>fn</code>: è¿™æ˜¯å®šä¹‰æµ‹è¯•ç»„çš„å‡½æ•°ã€‚åœ¨ä½¿ç”¨<code>describe.skip</code>æ—¶ï¼Œè¿™ä¸ªå‡½æ•°é‡Œé¢çš„æ‰€æœ‰æµ‹è¯•éƒ½å°†è¢«è·³è¿‡ã€‚</li></ul><h3 id="ä¸¾ä¾‹è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#ä¸¾ä¾‹è¯´æ˜"><span>ä¸¾ä¾‹è¯´æ˜</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œå¹¶ä¸”ä½ æœ‰ä¸€ç»„æµ‹è¯•æ˜¯ä¸“é—¨é’ˆå¯¹ç”¨æˆ·è®¤è¯åŠŸèƒ½çš„ã€‚ä½†æ˜¯ï¼Œç”±äºæŸäº›åŸå› ï¼Œè¿™éƒ¨åˆ†åŠŸèƒ½æš‚æ—¶è¢«æç½®äº†ï¼Œæˆ–è€…æ­£åœ¨è¿›è¡Œå¤§è§„æ¨¡ä¿®æ”¹ï¼Œè€Œè¿™äº›æµ‹è¯•æš‚æ—¶æ— æ³•é€šè¿‡ï¼Œæˆ–è€…å®ƒä»¬çš„è¿è¡Œå¯èƒ½ä¼šå¹²æ‰°åˆ°å…¶ä»–æµ‹è¯•çš„æ­£å¸¸æ‰§è¡Œã€‚è¿™æ—¶å€™ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨<code>describe.skip</code>æ¥æš‚æ—¶è·³è¿‡è¿™ç»„æµ‹è¯•ã€‚</p><p><strong>ä¾‹ 1ï¼šè·³è¿‡æ•´ä¸ªæµ‹è¯•ç»„</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä¸‹é¢æ˜¯ä¸€ä¸ªå…³äºç”¨æˆ·è®¤è¯çš„æµ‹è¯•ç»„</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">skip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç”¨æˆ·è®¤è¯æµ‹è¯•&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç™»å½•æˆåŠŸ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">username</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;123456&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">authenticate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">user</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç™»å½•å¤±è´¥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">username</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;wrongpassword&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">authenticate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">user</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>describe.skip</code>æ¥è·³è¿‡â€œç”¨æˆ·è®¤è¯æµ‹è¯•â€è¿™ä¸ªæµ‹è¯•ç»„ã€‚å³ä½¿è¿™ä¸ªç»„é‡Œæœ‰å¤šä¸ª<code>it</code>æµ‹è¯•ç”¨ä¾‹ï¼Œå®ƒä»¬å…¨éƒ¨ä¼šè¢«è·³è¿‡ï¼Œä¸ä¼šæ‰§è¡Œã€‚</p><p><strong>ä¾‹ 2ï¼šæ¡ä»¶æ€§åœ°è·³è¿‡æµ‹è¯•</strong></p><p>æœ‰æ—¶å€™ï¼Œä½ å¯èƒ½åªæƒ³åœ¨ç‰¹å®šæ¡ä»¶ä¸‹è·³è¿‡æµ‹è¯•ï¼Œä¾‹å¦‚åªåœ¨å¼€å‘ç¯å¢ƒä¸‹è·³è¿‡æŸäº›æµ‹è¯•ã€‚è™½ç„¶ Node.js çš„æµ‹è¯•æ¡†æ¶ç›´æ¥ä¸æä¾›è¿™ç§åŠŸèƒ½ï¼Œä½†ä½ å¯ä»¥é€šè¿‡ç®€å•çš„ JavaScript é€»è¾‘æ¥å®ç°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">NODE_ENV</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;development&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">skip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ•°æ®åº“é›†æˆæµ‹è¯•&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // ä¸€äº›å¯èƒ½ä¼šå½±å“å¼€å‘æ•°æ®åº“çŠ¶æ€çš„æµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ•°æ®åº“é›†æˆæµ‹è¯•&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ­£å¸¸æ‰§è¡Œæµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æ£€æŸ¥ç¯å¢ƒå˜é‡<code>NODE_ENV</code>æ¥å†³å®šæ˜¯å¦è·³è¿‡â€œæ•°æ®åº“é›†æˆæµ‹è¯•â€ã€‚å¦‚æœæˆ‘ä»¬å¤„äºå¼€å‘ç¯å¢ƒï¼ˆ<code>NODE_ENV</code>ç­‰äº<code>development</code>ï¼‰ï¼Œåˆ™è·³è¿‡è¿™ç»„æµ‹è¯•ï¼›å¦åˆ™ï¼Œæ­£å¸¸æ‰§è¡Œã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œ<code>describe.skip</code>åœ¨ Node.js çš„æµ‹è¯•è¿‡ç¨‹ä¸­æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå®ƒä½¿å¾—æµ‹è¯•æ›´åŠ çµæ´»ï¼Œå¸®åŠ©å¼€å‘è€…åœ¨ä¸åŒæƒ…å†µä¸‹æ›´æœ‰æ•ˆåœ°è¿è¡Œæµ‹è¯•ã€‚</p><h2 id="describe-todo-name-options-fn" tabindex="-1"><a class="header-anchor" href="#describe-todo-name-options-fn"><span><a href="https://nodejs.org/docs/latest/api/test.html#describetodoname-options-fn" target="_blank" rel="noopener noreferrer">describe.todo([name][, options][, fn])</a></span></a></h2><p>Node.js v21.7.1 ä¸­å¼•å…¥çš„ <code>describe.todo</code> æ˜¯åœ¨ Node.js çš„æµ‹è¯•æ¨¡å—ä¸­ä½¿ç”¨çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ˜¯ä¸“é—¨ä¸ºäº†å¸®åŠ©å¼€å‘è€…æ ‡æ˜è¿˜æœªç¼–å†™ä½†è®¡åˆ’å®æ–½çš„æµ‹è¯•ç”¨ä¾‹ã€‚è¿™ä¸ªç‰¹æ€§ä½¿å¾—ç®¡ç†æµ‹è¯•æ¡ˆä¾‹å’Œè·Ÿè¸ªå¾…å®Œæˆå·¥ä½œå˜å¾—æ›´åŠ ä¾¿æ·ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯describe-todo" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯describe-todo"><span>ä»€ä¹ˆæ˜¯<code>describe.todo</code></span></a></h3><p>ç®€å•æ¥è¯´ï¼Œ<code>describe.todo</code>å…è®¸ä½ åœ¨æµ‹è¯•ä»£ç ä¸­æ·»åŠ ä¸€ä¸ªå ä½ç¬¦ï¼Œè¿™ä¸ªå ä½ç¬¦è¡¨ç¤ºæœ‰ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹éœ€è¦è¢«å®ç°ï¼Œä½†ç›®å‰è¿˜æ²¡æœ‰å®Œæˆã€‚è¿™æ˜¯ä¸€ç§è§„åˆ’å’Œç»„ç»‡æµ‹è¯•çš„æ–¹æ³•ï¼Œç‰¹åˆ«é€‚åˆåœ¨é¡¹ç›®åˆæœŸæˆ–è€…å½“ä½ æƒ³å…ˆæ¢³ç†å‡ºæ‰€æœ‰éœ€è¦çš„æµ‹è¯•ç”¨ä¾‹ï¼Œç„¶åå†é€ä¸€å®ç°å®ƒä»¬çš„æƒ…æ™¯ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨describe-todo" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨describe-todo"><span>å¦‚ä½•ä½¿ç”¨<code>describe.todo</code></span></a></h3><p><code>describe.todo</code>çš„åŸºæœ¬è¯­æ³•æ˜¯ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">todo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">][, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>name</code>: è¿™é‡Œä½ å¡«å†™çš„æ˜¯æµ‹è¯•ç”¨ä¾‹çš„åç§°ï¼Œå®ƒæè¿°äº†æµ‹è¯•è®¡åˆ’è¦†ç›–çš„åŠŸèƒ½ç‚¹ã€‚</li><li><code>options</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œä½ å¯ä»¥é€šè¿‡å®ƒè®¾ç½®ä¸€äº›é¢å¤–çš„é€‰é¡¹ã€‚</li><li><code>fn</code>: è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…è®¸ä½ å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè™½ç„¶åœ¨<code>todo</code>åœºæ™¯ä¸‹ï¼Œè¿™ä¸ªå‡½æ•°é€šå¸¸ä¸ä¼šè¢«å®ç°ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-4"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªå¾…åŠäº‹é¡¹åˆ—è¡¨çš„åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­åŒ…å«æ·»åŠ æ–°å¾…åŠäº‹é¡¹ã€åˆ é™¤å¾…åŠäº‹é¡¹ç­‰åŠŸèƒ½ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä½ å¯èƒ½ä¼šæƒ³å…ˆè§„åˆ’å‡ºæ‰€æœ‰éœ€è¦çš„æµ‹è¯•ç”¨ä¾‹ã€‚ä½¿ç”¨<code>describe.todo</code>å¯ä»¥å¸®åŠ©ä½ åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼šè§„åˆ’å¾…å®ç°çš„æµ‹è¯•</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> test</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹è¯•â€œå¾…åŠäº‹é¡¹åº”ç”¨â€çš„ç›¸å…³åŠŸèƒ½</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å¾…åŠäº‹é¡¹åº”ç”¨&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ ‡æ˜è¿˜éœ€è¦å®ç°çš„æµ‹è¯•ç”¨ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">todo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ·»åŠ æ–°çš„å¾…åŠäº‹é¡¹&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">todo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åˆ é™¤ä¸€ä¸ªå¾…åŠäº‹é¡¹&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // ä½ å¯ä»¥é€‰æ‹©åœ¨è¿™é‡Œå¤‡æ³¨ä¸€äº›å®ç°æ—¶éœ€è¦æ³¨æ„çš„äº‹é¡¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ª<code>todo</code>æµ‹è¯•ç”¨ä¾‹ï¼Œâ€œæ·»åŠ æ–°çš„å¾…åŠäº‹é¡¹â€å’Œâ€œåˆ é™¤ä¸€ä¸ªå¾…åŠäº‹é¡¹â€ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±èƒ½æ¸…æ™°åœ°çœ‹åˆ°å“ªäº›æµ‹è¯•æ˜¯è®¡åˆ’ä¸­å°šæœªå®ç°çš„ã€‚</p><p><strong>ç¤ºä¾‹ 2ï¼šå…ˆè§„åˆ’åå®ç°</strong></p><p>ä¸€å¼€å§‹ï¼Œä½ å¯èƒ½åªæ˜¯ç”¨<code>describe.todo</code>åˆ—å‡ºæ‰€æœ‰ä½ æƒ³åˆ°çš„æµ‹è¯•ç”¨ä¾‹ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå½“ä½ å‡†å¤‡å¥½ç¼–å†™æŸä¸ªå…·ä½“çš„æµ‹è¯•ç”¨ä¾‹æ—¶ï¼Œå°±å¯ä»¥å°†å¯¹åº”çš„<code>describe.todo</code>æ›¿æ¢æˆå®é™…çš„<code>test</code>æˆ–<code>describe</code>å—ï¼Œå¹¶å®ç°å…·ä½“çš„æµ‹è¯•é€»è¾‘ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> test</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å¾…åŠäº‹é¡¹åº”ç”¨&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æœ€åˆä½¿ç”¨todoæ ‡è®°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">todo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;éªŒè¯å¾…åŠäº‹é¡¹æ˜¯å¦å¯ä»¥æˆåŠŸæ ‡è®°ä¸ºå®Œæˆ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // éšåæ›¿æ¢æˆå…·ä½“å®ç°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;éªŒè¯å¾…åŠäº‹é¡¹æ˜¯å¦å¯ä»¥æˆåŠŸæ ‡è®°ä¸ºå®Œæˆ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ ‡è®°ä¸€ä¸ªå¾…åŠäº‹é¡¹ä¸ºå·²å®Œæˆ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // åœ¨è¿™é‡Œç¼–å†™æµ‹è¯•é€»è¾‘...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä¸Šè¿°ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹å‡º<code>describe.todo</code>æ˜¯å¦‚ä½•å¸®åŠ©ä½ åœ¨å¼€å‘è¿‡ç¨‹ä¸­ç®¡ç†å’Œè§„åˆ’æµ‹è¯•å·¥ä½œçš„ã€‚å®ƒæä¾›äº†ä¸€ç§æ¸…æ™°çš„æ–¹å¼æ¥æ ‡è®°é‚£äº›è®¡åˆ’ä¸­ä½†å°šæœªå®æ–½çš„æµ‹è¯•ï¼Œä»è€Œä½¿å¾—æ•´ä¸ªå¼€å‘æµç¨‹æ›´åŠ æ¡ç†åŒ–ã€‚</p><h2 id="describe-only-name-options-fn" tabindex="-1"><a class="header-anchor" href="#describe-only-name-options-fn"><span><a href="https://nodejs.org/docs/latest/api/test.html#describeonlyname-options-fn" target="_blank" rel="noopener noreferrer">describe.only([name][, options][, fn])</a></span></a></h2><p>Node.js ä¸­çš„ <code>describe.only</code> æ–¹æ³•æ˜¯åœ¨å†™æµ‹è¯•ä»£ç æ—¶ä½¿ç”¨çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œç‰¹åˆ«æ˜¯å½“ä½ ä½¿ç”¨ Node.js è‡ªå¸¦çš„æµ‹è¯•æ¡†æ¶æ—¶ã€‚ä» v21.7.1 ç‰ˆæœ¬å¼€å§‹ï¼ŒNode.js å¼•å…¥äº†è‡ªå·±çš„æµ‹è¯•æ¡†æ¶ï¼Œè¿™ä¸ºå¼€å‘è€…æä¾›äº†æ›´å¤šåŸç”Ÿå·¥å…·æ¥ç¼–å†™å’Œè¿è¡Œæµ‹è¯•ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯<code>describe</code>ã€‚åœ¨æµ‹è¯•æ¡†æ¶ä¸­ï¼Œ<code>describe</code>ç”¨äºå®šä¹‰ä¸€ç»„ç›¸å…³çš„æµ‹è¯•ã€‚å®ƒå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢åŒ…å«äº†ä¸€ç³»åˆ—æµ‹è¯•ç”¨ä¾‹ï¼ˆé€šå¸¸ä½¿ç”¨<code>it</code>æˆ–<code>test</code>å…³é”®è¯å®šä¹‰ï¼‰ã€‚è¿™æ ·åšå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç»„ç»‡æµ‹è¯•ä»£ç ï¼Œè®©å…¶ç»“æ„æ›´æ¸…æ™°ï¼Œæ¯”å¦‚æŒ‰ç…§åŠŸèƒ½ã€ç»„ä»¶æˆ–æ¨¡å—æ¥åˆ†ç»„æµ‹è¯•ã€‚</p><p>ç°åœ¨ï¼Œå†æ¥çœ‹çœ‹ <code>describe.only</code>ã€‚è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯ï¼Œåœ¨ä¸€æ¬¡æµ‹è¯•è¿è¡Œä¸­ï¼Œåªæ‰§è¡Œè¢«<code>describe.only</code>æ ‡è®°çš„é‚£äº›æµ‹è¯•é›†ã€‚å¦‚æœä½ çš„æµ‹è¯•æ–‡ä»¶ä¸­æœ‰å¤šä¸ª<code>describe</code>å—ï¼Œä½†ä½ æš‚æ—¶åªæƒ³å…³æ³¨å…¶ä¸­çš„ä¸€ä¸ªæˆ–å‡ ä¸ªï¼Œå¯ä»¥ä½¿ç”¨<code>describe.only</code>æ¥æŒ‡å®šã€‚è¿™åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºä½ å¯èƒ½ä¸æƒ³æ¯æ¬¡éƒ½è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼Œè€Œåªæƒ³è¿è¡ŒæŸä¸ªç‰¹å®šéƒ¨åˆ†çš„æµ‹è¯•æ¥å¿«é€Ÿå®šä½é—®é¢˜ã€‚</p><h3 id="å‚æ•°è§£é‡Š-1" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-1"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>name</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œç”¨äºç»™ä½ çš„æµ‹è¯•é›†å‘½åã€‚è¿™å¯¹äºç†è§£æµ‹è¯•æŠ¥å‘Šå¾ˆæœ‰å¸®åŠ©ã€‚</li><li><code>options</code>: å…è®¸ä½ é…ç½®ä¸€äº›é€‰é¡¹ï¼Œè¿™ä¹Ÿæ˜¯å¯é€‰çš„ã€‚</li><li><code>fn</code>: è¿™æ˜¯å®šä¹‰æµ‹è¯•é›†å†…éƒ¨æµ‹è¯•ç”¨ä¾‹çš„å‡½æ•°ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-1"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ä¸Šå•†åŸçš„åç«¯æœåŠ¡ï¼Œå¹¶ä¸”ä½ æœ‰ä¸€ç»„æµ‹è¯•é’ˆå¯¹ç”¨æˆ·è´¦æˆ·ç®¡ç†çš„åŠŸèƒ½ï¼ˆå¦‚æ³¨å†Œã€ç™»å½•ã€æŸ¥çœ‹ä¿¡æ¯ç­‰ï¼‰ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹è¯•ç”¨æˆ·ç™»å½•åŠŸèƒ½</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç”¨æˆ·ç®¡ç†&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ­£å¸¸æƒ…å†µä¸‹çš„ç™»å½•æµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ­£å¸¸ç™»å½•&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // è¿™é‡Œä¼šæœ‰ä¸€äº›ç”¨äºæµ‹è¯•ç™»å½•é€»è¾‘çš„ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">login</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;username&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹è¯•å¯†ç é”™è¯¯çš„æƒ…å†µ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å¯†ç é”™è¯¯&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æµ‹è¯•å¯†ç é”™è¯¯æ—¶çš„é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">login</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;username&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;wrong_password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿˜æœ‰å¦ä¸€ä¸ªæµ‹è¯•é›†ï¼Œä¸“é—¨æµ‹è¯•å•†å“æœç´¢åŠŸèƒ½</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å•†å“æœç´¢&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹è¯•æœç´¢å­˜åœ¨çš„å•†å“</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æœç´¢å·²æœ‰å•†å“&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // ç›¸åº”çš„æµ‹è¯•ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹è¯•æœç´¢ä¸å­˜åœ¨çš„å•†å“</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æœç´¢ä¸å­˜åœ¨çš„å•†å“&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // ç›¸åº”çš„æµ‹è¯•ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¦‚æœä½ åªæƒ³æ‰§è¡Œâ€œç”¨æˆ·ç®¡ç†â€ç›¸å…³çš„æµ‹è¯•ï¼Œå¯ä»¥è¿™ä¹ˆå†™ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">only</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç”¨æˆ·ç®¡ç†&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹è¯•ç”¨ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ï¼Œæ— è®ºä½ çš„æµ‹è¯•æ–‡ä»¶ä¸­æœ‰å¤šå°‘å…¶ä»–çš„<code>describe</code>å—ï¼Œæ‰§è¡Œæµ‹è¯•æ—¶åªä¼šè¿è¡Œæ ‡è®°ä¸º<code>describe.only</code>çš„é‚£éƒ¨åˆ†ã€‚è¿™å¯¹äºèšç„¦åœ¨ç‰¹å®šåŠŸèƒ½çš„è°ƒè¯•å’Œå¼€å‘éå¸¸æœ‰å¸®åŠ©ã€‚</p><p>å¸Œæœ›è¿™èƒ½å¸®åŠ©ä½ ç†è§£<code>describe.only</code>çš„ä½œç”¨å’Œå¦‚ä½•ä½¿ç”¨å®ƒï¼</p><h2 id="it-name-options-fn" tabindex="-1"><a class="header-anchor" href="#it-name-options-fn"><span><a href="https://nodejs.org/docs/latest/api/test.html#itname-options-fn" target="_blank" rel="noopener noreferrer">it([name][, options][, fn])</a></span></a></h2><p>Node.js v21.7.1 ä¸­çš„<code>it([name][, options][, fn])</code>æ˜¯æµ‹è¯•æ¡†æ¶ä¸­ç”¨æ¥å®šä¹‰ä¸€ä¸ªå•ç‹¬çš„æµ‹è¯•æ¡ˆä¾‹çš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°æ˜¯åœ¨ Node.js çš„<code>test</code>æ¨¡å—ä¸­ï¼Œé€šå¸¸ç”¨äºè¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œå¸®åŠ©å¼€å‘è€…ç¡®ä¿ä»–ä»¬çš„ä»£ç æŒ‰é¢„æœŸå·¥ä½œã€‚è®©æˆ‘ä»¬é€šè¿‡ä¸€äº›ç®€å•çš„æ¦‚å¿µå’Œå®é™…çš„ä¾‹å­æ¥äº†è§£å®ƒã€‚</p><h3 id="è§£é‡Š-2" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-2"><span>è§£é‡Š</span></a></h3><p>åœ¨ç¼–ç¨‹ä¸­ï¼Œç‰¹åˆ«æ˜¯è¿›è¡Œå¤§è§„æ¨¡æˆ–å¤æ‚é¡¹ç›®å¼€å‘æ—¶ï¼Œç¡®ä¿æ¯ä¸ªåŠŸèƒ½æ¨¡å—æ­£ç¡®æ— è¯¯åœ°å·¥ä½œæ˜¯éå¸¸é‡è¦çš„ã€‚è¿™å°±æ˜¯è‡ªåŠ¨åŒ–æµ‹è¯•å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚<code>it</code>å‡½æ•°å°±æ˜¯è¿™æ ·ä¸€ä¸ªå·¥å…·ï¼Œå®ƒå…è®¸ä½ å®šä¹‰ä¸€ä¸ª&quot;æµ‹è¯•æ¡ˆä¾‹&quot;ï¼Œä¸“æ³¨äºæµ‹è¯•ä»£ç çš„æŸä¸€å°éƒ¨åˆ†æˆ–æŸä¸ªç‰¹å®šåŠŸèƒ½ã€‚</p><ul><li><strong>name</strong>: è¿™æ˜¯ä½ çš„æµ‹è¯•æ¡ˆä¾‹çš„åç§°ï¼Œå®ƒæè¿°äº†æµ‹è¯•çš„ç›®çš„ã€‚å®ƒåº”è¯¥å°½é‡æ¸…æ™°ï¼Œä»¥ä¾¿è®©å…¶ä»–å¼€å‘è€…ï¼ˆæˆ–æœªæ¥çš„ä½ ï¼‰ä¸€çœ‹å°±æ˜ç™½è¿™ä¸ªæµ‹è¯•æ¡ˆä¾‹æ˜¯åšä»€ä¹ˆçš„ã€‚</li><li><strong>options</strong>: è¿™ä¸ªå‚æ•°å…è®¸ä½ è®¾ç½®ä¸€äº›é¢å¤–çš„é…ç½®é€‰é¡¹ï¼Œæ¯”å¦‚æµ‹è¯•è¶…æ—¶æ—¶é—´ç­‰ã€‚</li><li><strong>fn</strong>: è¿™æ˜¯å®é™…æ‰§è¡Œçš„æµ‹è¯•å‡½æ•°ã€‚ä½ ä¼šåœ¨è¿™ä¸ªå‡½æ•°å†…éƒ¨ç¼–å†™æµ‹è¯•é€»è¾‘ï¼Œæ¯”å¦‚æ‰§è¡Œä¸€æ®µä»£ç å¹¶æ£€æŸ¥å®ƒçš„è¾“å‡ºæ˜¯å¦ç¬¦åˆé¢„æœŸã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-5"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><h4 id="ç¤ºä¾‹-1-æµ‹è¯•ä¸€ä¸ªç®€å•çš„åŠ æ³•å‡½æ•°" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æµ‹è¯•ä¸€ä¸ªç®€å•çš„åŠ æ³•å‡½æ•°"><span>ç¤ºä¾‹ 1: æµ‹è¯•ä¸€ä¸ªç®€å•çš„åŠ æ³•å‡½æ•°</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªç®€å•çš„åŠ æ³•å‡½æ•°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">b</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> a</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> b</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ æƒ³æµ‹è¯•è¿™ä¸ªå‡½æ•°æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚ä½¿ç”¨<code>it</code>æ¥å®šä¹‰æµ‹è¯•æ¡ˆä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should add two numbers correctly&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œä½ å®šä¹‰äº†ä¸€ä¸ªæµ‹è¯•æ¡ˆä¾‹ï¼š&quot;should add two numbers correctly&quot;ã€‚åœ¨è¿™ä¸ªæµ‹è¯•æ¡ˆä¾‹ä¸­ï¼Œä½ è°ƒç”¨<code>add</code>å‡½æ•°ï¼Œä¼ å…¥ 2 å’Œ 3 ä½œä¸ºå‚æ•°ï¼Œç„¶åä½¿ç”¨<code>assert.strictEqual</code>æ¥æ–­è¨€ç»“æœåº”å½“ä¸¥æ ¼ç­‰äº 5ã€‚</p><h4 id="ç¤ºä¾‹-2-æµ‹è¯•å¼‚æ­¥ä»£ç " tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æµ‹è¯•å¼‚æ­¥ä»£ç "><span>ç¤ºä¾‹ 2: æµ‹è¯•å¼‚æ­¥ä»£ç </span></a></h4><p>è€ƒè™‘åˆ° Node.js çš„å¼‚æ­¥ç‰¹æ€§ï¼Œè®©æˆ‘ä»¬ä¹Ÿæ¥çœ‹ä¸€ä¸ªæ¶‰åŠå¼‚æ­¥æ“ä½œçš„æµ‹è¯•æ¡ˆä¾‹ï¼š</p><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªå‡½æ•°<code>fetchData</code>ï¼Œå®ƒæ¨¡æ‹Ÿä»æœåŠ¡å™¨è·å–æ•°æ®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    callback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;peanut butter&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ å¦‚ä½•æµ‹è¯•è¿™ä¸ªå¼‚æ­¥å‡½æ•°å‘¢ï¼Ÿå†æ¬¡ä½¿ç”¨<code>it</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fetches data successfully&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">done</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;peanut butter&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    done</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¡¨ç¤ºæµ‹è¯•ç»“æŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>it</code>çš„å›è°ƒå‡½æ•°æ¥æ”¶ä¸€ä¸ª<code>done</code>å‚æ•°ï¼Œè¿™æ˜¯å‘Šè¯‰ Node.js è¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥æµ‹è¯•ã€‚å½“å¼‚æ­¥æ“ä½œå®Œæˆå¹¶ä¸”ä½ å·²ç»åšå®Œæ‰€æœ‰çš„æ–­è¨€åï¼Œä½ è°ƒç”¨<code>done()</code>æ¥å‘Šè¯‰æµ‹è¯•æ¡†æ¶æµ‹è¯•å·²ç»å®Œæˆã€‚</p><p>ä»¥ä¸Šå°±æ˜¯ä½¿ç”¨ Node.js ä¸­<code>it</code>å‡½æ•°å®šä¹‰å’Œè¿è¡Œæµ‹è¯•æ¡ˆä¾‹çš„ç®€ä»‹å’Œä¸€äº›åŸºç¡€ç¤ºä¾‹ã€‚å¸Œæœ›è¿™èƒ½å¸®åŠ©ä½ ç†è§£å¦‚ä½•ä½¿ç”¨è‡ªåŠ¨åŒ–æµ‹è¯•æ¥éªŒè¯ä½ çš„ä»£ç åŠŸèƒ½ã€‚</p><h2 id="it-skip-name-options-fn" tabindex="-1"><a class="header-anchor" href="#it-skip-name-options-fn"><span><a href="https://nodejs.org/docs/latest/api/test.html#itskipname-options-fn" target="_blank" rel="noopener noreferrer">it.skip([name][, options][, fn])</a></span></a></h2><p>Node.js ä¸­çš„ <code>it.skip</code> æ–¹æ³•æ˜¯ç”¨äºæµ‹è¯•æ—¶è·³è¿‡æŸäº›ç‰¹å®šæµ‹è¯•æ¡ˆä¾‹çš„åŠŸèƒ½ã€‚è¿™åœ¨å•å…ƒæµ‹è¯•æˆ–é›†æˆæµ‹è¯•ä¸­éå¸¸æœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯å½“ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåŠŸèƒ½è€Œè¯¥åŠŸèƒ½çš„æŸäº›éƒ¨åˆ†è¿˜æœªå®Œæˆæˆ–è€…ä½ æš‚æ—¶ä¸æƒ³è¿è¡ŒæŸäº›æµ‹è¯•æ—¶ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-3" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-3"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>åœ¨æ·±å…¥äº†è§£ <code>it.skip</code> ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç†è§£ Node.js ä¸­å…³äºæµ‹è¯•çš„ä¸€äº›åŸºç¡€ã€‚Node.js æ”¯æŒä½¿ç”¨è‡ªå¸¦çš„ <code>assert</code> æ¨¡å—æ¥è¿›è¡Œç®€å•çš„æ–­è¨€æµ‹è¯•ï¼Œä½†å¯¹äºæ›´å¤æ‚çš„æµ‹è¯•åœºæ™¯ï¼Œé€šå¸¸ä¼šä½¿ç”¨åƒ Mochaã€Jasmine æˆ– Jest è¿™æ ·çš„æµ‹è¯•æ¡†æ¶ã€‚<code>it</code> å‡½æ•°é€šå¸¸ä¸è¿™äº›æµ‹è¯•æ¡†æ¶ä¸€èµ·ä½¿ç”¨ï¼Œç”¨äºå®šä¹‰ä¸€ä¸ªâ€œæµ‹è¯•ç”¨ä¾‹â€ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should return true when input is positive&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹è¯•ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä½¿ç”¨-it-skip" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-it-skip"><span>ä½¿ç”¨ <code>it.skip</code></span></a></h3><p><code>it.skip</code> å…è®¸ä½ å®šä¹‰ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ä½†è·³è¿‡å®ƒçš„æ‰§è¡Œã€‚è¿™æ„å‘³ç€æµ‹è¯•å¥—ä»¶ä»ç„¶ä¼šæ˜¾ç¤ºè¿™ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œä½†å®ƒä¼šè¢«æ ‡è®°ä¸ºè·³è¿‡ï¼Œå¹¶ä¸”å®ƒçš„æµ‹è¯•é€»è¾‘ä¸ä¼šè¢«æ‰§è¡Œã€‚</p><h4 id="è¯­æ³•-1" tabindex="-1"><a class="header-anchor" href="#è¯­æ³•-1"><span>è¯­æ³•</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">skip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">][, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>name</code>: æµ‹è¯•ç”¨ä¾‹çš„æè¿°ã€‚</li><li><code>options</code>: å¯é€‰å‚æ•°ï¼Œç”¨äºæä¾›æµ‹è¯•é…ç½®ã€‚</li><li><code>fn</code>: æµ‹è¯•å‡½æ•°ï¼ŒåŒ…å«å®é™…çš„æµ‹è¯•ä»£ç ã€‚</li></ul><h4 id="å®é™…è¿ç”¨ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-2"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h4><ol><li><p><strong>å‡è®¾åŠŸèƒ½å°šæœªå®Œæˆ</strong></p><p>å¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œæ¯”å¦‚ä¸€ä¸ªå¯ä»¥è¿”å›ä¸¤ä¸ªæ•°ä¹‹å’Œçš„å‡½æ•°ï¼Œä½†è¿™ä¸ªåŠŸèƒ½è¿˜æ²¡å‡†å¤‡å¥½è¿›è¡Œæµ‹è¯•ã€‚ä½ å¯ä»¥è¿™æ ·å†™ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">skip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should return the sum of two numbers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾è¿™é‡Œæœ‰ä¸€ä¸ªå°šæœªå®Œæˆçš„æµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ï¼Œå³ä½¿ä½ è¿è¡Œæµ‹è¯•å¥—ä»¶ï¼Œè¿™ä¸ªå…·ä½“çš„æµ‹è¯•ä¹Ÿä¸ä¼šæ‰§è¡Œï¼Œä½†ä½ ä¼šåœ¨æµ‹è¯•æŠ¥å‘Šä¸­çœ‹åˆ°å®ƒè¢«è·³è¿‡äº†ã€‚</p></li><li><p><strong>ä¾èµ–å¤–éƒ¨èµ„æºè€Œè¯¥èµ„æºæš‚æ—¶ä¸å¯ç”¨</strong></p><p>å‡è®¾ä½ çš„æµ‹è¯•éœ€è¦è¿æ¥åˆ°å¤–éƒ¨æ•°æ®åº“ï¼Œä½†ç”±äºæŸäº›åŸå› ï¼Œæ•°æ®åº“æš‚æ—¶æ— æ³•è®¿é—®ã€‚æ­¤æ—¶ï¼Œä½ å¯èƒ½ä¸æƒ³å› ä¸ºå¤–éƒ¨é—®é¢˜è€Œå¯¼è‡´æµ‹è¯•å¤±è´¥ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">skip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should fetch user data from the database&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ•°æ®åº“è®¿é—®æµ‹è¯•ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>ä¸´æ—¶è·³è¿‡æŸäº›æµ‹è¯•</strong></p><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½æƒ³ä¸´æ—¶è·³è¿‡ä¸€äº›æµ‹è¯•ç”¨ä¾‹ï¼Œè€Œä¸æ˜¯æ°¸ä¹…ç§»é™¤æˆ–æ³¨é‡Šæ‰å®ƒä»¬ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çŸ¥é“æŸä¸ªåŠŸèƒ½åœ¨è¿‘æœŸçš„ç‰ˆæœ¬ä¸­ç”±äºæŸäº›æ›´æ”¹è€Œæš‚æ—¶å¤±æ•ˆï¼Œè€Œä½ è®¡åˆ’åœ¨æœªæ¥ä¿®å¤ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">skip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should ensure the feature works as expected&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¯¥åŠŸèƒ½çš„æµ‹è¯•ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="å°ç»“-2" tabindex="-1"><a class="header-anchor" href="#å°ç»“-2"><span>å°ç»“</span></a></h3><p>ä½¿ç”¨ <code>it.skip</code> æ˜¯ä¸€ç§çµæ´»çš„æ–¹å¼æ¥ç®¡ç†ä½ çš„æµ‹è¯•ç”¨ä¾‹ï¼Œå®ƒå…è®¸ä½ åœ¨ä¸åŒçš„å¼€å‘é˜¶æ®µæ ¹æ®éœ€è¦åŒ…å«æˆ–æ’é™¤ç‰¹å®šçš„æµ‹è¯•ã€‚å®ƒå¯¹äºä¿æŒæµ‹è¯•çš„æ¸…æ™°åº¦å’Œç»„ç»‡æ€§éå¸¸æœ‰å¸®åŠ©ï¼ŒåŒæ—¶ä¹Ÿç¡®ä¿äº†ä½ çš„æµ‹è¯•æŠ¥å‘Šåæ˜ äº†æœ€å‡†ç¡®çš„å½“å‰çŠ¶æ€ã€‚</p><h2 id="it-todo-name-options-fn" tabindex="-1"><a class="header-anchor" href="#it-todo-name-options-fn"><span><a href="https://nodejs.org/docs/latest/api/test.html#ittodoname-options-fn" target="_blank" rel="noopener noreferrer">it.todo([name][, options][, fn])</a></span></a></h2><p>Node.js ä¸­çš„ <code>it.todo</code> æ˜¯æµ‹è¯•æ¡†æ¶ä¸­çš„ä¸€ä¸ªç‰¹æ€§ï¼Œç”¨äºæ ‡è®°å°šæœªå®ç°æˆ–å°šæœªå®Œæˆçš„æµ‹è¯•ã€‚ç®€å•æ¥è¯´ï¼Œå½“ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªé¡¹ç›®ï¼Œå¹¶ä¸”æœ‰ä¸€äº›åŠŸèƒ½è¿˜æ²¡æœ‰å®Œæˆæ—¶ï¼Œä½ å¯èƒ½å·²ç»çŸ¥é“éœ€è¦å¯¹è¿™äº›åŠŸèƒ½è¿›è¡Œæµ‹è¯•ï¼Œä½†æ˜¯ç”±äºå„ç§åŸå› ï¼ˆæ¯”å¦‚åŠŸèƒ½è¿˜åœ¨å¼€å‘ä¸­ï¼‰ï¼Œä½ è¿˜ä¸èƒ½å†™å‡ºå…·ä½“çš„æµ‹è¯•ä»£ç ã€‚è¿™æ—¶å€™ï¼Œ<code>it.todo</code> å°±æ´¾ä¸Šç”¨åœºäº†ã€‚å®ƒå…è®¸ä½ æå‰å ä½è¿™äº›æµ‹è¯•æ¡ˆä¾‹ï¼Œæ—¢èƒ½å¸®åŠ©ä½ è®°ä½éœ€è¦è¡¥å……çš„æµ‹è¯•ï¼Œåˆèƒ½è®©ä½ çš„æµ‹è¯•å¥—ä»¶é€šè¿‡ã€‚</p><p>åœ¨ Node.js v21.7.1 çš„å®˜æ–¹æ–‡æ¡£ä¸­ï¼Œ<code>it.todo</code> è¢«å®šä¹‰ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œå…¶åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">todo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">][, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>name</code> æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæµ‹è¯•çš„åç§°æˆ–æè¿°ã€‚</li><li><code>options</code> æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå¯ä»¥ç”¨æ¥è®¾ç½®ä¸€äº›æµ‹è¯•çš„é€‰é¡¹ã€‚</li><li><code>fn</code> æ˜¯ä¸€ä¸ªå¯é€‰çš„å‡½æ•°ï¼Œé€šå¸¸åœ¨æ­£å¸¸çš„æµ‹è¯•ä¸­ä¼šç”¨æ¥åŒ…å«æµ‹è¯•çš„æ‰§è¡Œä»£ç ï¼Œä½†åœ¨ä½¿ç”¨ <code>it.todo</code> æ—¶ï¼Œè¿™ä¸ªå‚æ•°é€šå¸¸ä¸ä¼šè¢«å¡«å†™ï¼Œå› ä¸ºå®ƒæ ‡è®°çš„æ˜¯å¾…åŠçš„æµ‹è¯•ã€‚</li></ul><p><strong>å®é™…è¿ç”¨ç¤ºä¾‹ï¼š</strong></p><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç”¨æˆ·ç®¡ç†ç³»ç»Ÿï¼Œç›®å‰æ­£åœ¨å®ç°ç”¨æˆ·ç™»å½•å’Œæ³¨å†Œçš„åŠŸèƒ½ã€‚ä½ è®¡åˆ’ä¸ºè¿™ä¸¤ä¸ªåŠŸèƒ½ç¼–å†™è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œä½†æ˜¯å› ä¸ºè¿™äº›åŠŸèƒ½è¿˜åœ¨å¼€å‘ä¸­ï¼Œæ‰€ä»¥ä½ è¿˜ä¸èƒ½å†™å‡ºå…·ä½“çš„æµ‹è¯•ä»£ç ã€‚è¿™æ—¶ï¼Œä½ å¯ä»¥è¿™æ ·ä½¿ç”¨ <code>it.todo</code> æ¥æ ‡è®°è¿™äº›å¾…å®Œæˆçš„æµ‹è¯•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">todo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åº”è¯¥æ­£ç¡®å¤„ç†ç”¨æˆ·ç™»å½•&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ ä¸€äº›æµ‹è¯•é€‰é¡¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">todo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åº”è¯¥æ­£ç¡®å¤„ç†ç”¨æˆ·æ³¨å†Œ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ ä¸€äº›æµ‹è¯•é€‰é¡¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿™é‡Œå¯ä»¥åŒ…å«å…¶ä»–å·²ç»å¯ä»¥å®ç°çš„æµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä»¥ä¸Šä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ <code>describe</code> å‡½æ•°å®šä¹‰äº†ä¸€ä¸ªæµ‹è¯•å¥—ä»¶ï¼Œâ€œç”¨æˆ·ç®¡ç†ç³»ç»Ÿâ€ï¼Œç„¶åä½¿ç”¨ <code>it.todo</code> æ¥æ·»åŠ äº†ä¸¤ä¸ªå¾…åŠçš„æµ‹è¯•ï¼šâ€œåº”è¯¥æ­£ç¡®å¤„ç†ç”¨æˆ·ç™»å½•â€å’Œâ€œåº”è¯¥æ­£ç¡®å¤„ç†ç”¨æˆ·æ³¨å†Œâ€ã€‚è¿™æ ·ï¼Œå½“æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Šæ—¶ï¼Œä½ å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°å“ªäº›æµ‹è¯•å°šæœªå®Œæˆï¼Œä»è€Œéšç€åŠŸèƒ½çš„å®ç°é€æ­¥è¡¥å…¨æµ‹è¯•ä»£ç ã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œ<code>it.todo</code> æä¾›äº†ä¸€ç§ä¾¿æ·çš„æ–¹å¼æ¥æ ‡è®°é‚£äº›è®¡åˆ’ä¸­ä½†è¿˜æœªå‡†å¤‡å¥½å®æ–½çš„æµ‹è¯•æ¡ˆä¾‹ï¼Œå¸®åŠ©å¼€å‘è€…ç»´æŠ¤å’Œæ›´æ–°ä»–ä»¬çš„æµ‹è¯•è®¡åˆ’ï¼Œç¡®ä¿æœ€ç»ˆæ‰€æœ‰é‡è¦çš„åŠŸèƒ½éƒ½ç»è¿‡äº†å½»åº•çš„æµ‹è¯•ã€‚</p><h2 id="it-only-name-options-fn" tabindex="-1"><a class="header-anchor" href="#it-only-name-options-fn"><span><a href="https://nodejs.org/docs/latest/api/test.html#itonlyname-options-fn" target="_blank" rel="noopener noreferrer">it.only([name][, options][, fn])</a></span></a></h2><p>Node.js v21.7.1 ä¸­çš„<code>it.only([name][, options][, fn])</code>æ˜¯æŒ‡åœ¨ä½¿ç”¨ Node.js å†…ç½®çš„æµ‹è¯•æ¡†æ¶æ—¶ï¼Œå¦‚æœä½ æƒ³è¦åœ¨ä¸€ç»„æµ‹è¯•ä¸­ä»…æ‰§è¡Œä¸€ä¸ªç‰¹å®šçš„æµ‹è¯•ç”¨ä¾‹ï¼Œå¯ä»¥ä½¿ç”¨<code>it.only</code>æ–¹æ³•ã€‚è¿™å¯¹äºèšç„¦è°ƒè¯•æŸä¸ªç‰¹å®šåŠŸèƒ½æˆ–è€…ç‰¹æ€§éå¸¸æœ‰ç”¨ã€‚</p><h3 id="å‚æ•°è§£é‡Š-2" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-2"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>name</code>: å­—ç¬¦ä¸²å‚æ•°ï¼Œè¡¨ç¤ºæµ‹è¯•ç”¨ä¾‹çš„åç§°ã€‚</li><li><code>options</code>: å¯é€‰å‚æ•°ï¼Œå¯¹è±¡ç±»å‹ï¼Œç”¨æ¥è®¾ç½®æµ‹è¯•çš„ä¸€äº›é…ç½®ã€‚</li><li><code>fn</code>: å‡½æ•°å‚æ•°ï¼Œå³å®é™…æ‰§è¡Œçš„æµ‹è¯•ä»£ç å—ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-2"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªè´­ç‰©è½¦æ¨¡å—ï¼Œå¹¶ä¸”ä½ å†™äº†å¤šä¸ªæµ‹è¯•ç”¨ä¾‹æ¥ç¡®ä¿è´­ç‰©è½¦çš„å„é¡¹åŠŸèƒ½éƒ½èƒ½æ­£å¸¸å·¥ä½œï¼Œæ¯”å¦‚æ·»åŠ å•†å“ã€åˆ é™¤å•†å“ã€è®¡ç®—æ€»ä»·ç­‰ç­‰ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥æµ‹è¯•æ¨¡å—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> test</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹è¯•æ·»åŠ å•†å“é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä»è´­ç‰©è½¦åˆ é™¤å•†å“&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹è¯•åˆ é™¤å•†å“é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">only</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è®¡ç®—è´­ç‰©è½¦æ€»ä»·&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä»…è¿è¡Œæ­¤æµ‹è¯•å—ï¼Œå¿½ç•¥å…¶ä»–æµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹è¯•è®¡ç®—æ€»ä»·é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä»¥ä¸Šä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸‰ä¸ªæµ‹è¯•ç”¨ä¾‹ã€‚ä½†æ˜¯é€šè¿‡åœ¨ç¬¬ä¸‰ä¸ªæµ‹è¯•å‰é¢åŠ ä¸Š<code>test.only</code>ï¼Œæˆ‘ä»¬å‘Šè¯‰ Node.js åªæ‰§è¡Œè¿™ä¸ªè®¡ç®—è´­ç‰©è½¦æ€»ä»·çš„æµ‹è¯•ç”¨ä¾‹ï¼Œè€Œå¿½ç•¥å…¶ä»–çš„æµ‹è¯•ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œå½“ä½ æ­£åœ¨ä¸“æ³¨äºè°ƒè¯•æˆ–è€…å¼€å‘ä¸€ä¸ªç‰¹å®šçš„åŠŸèƒ½æ—¶ï¼Œä¸éœ€è¦ç­‰å¾…æ‰€æœ‰çš„æµ‹è¯•ç”¨ä¾‹éƒ½è¿è¡Œå®Œæ¯•ï¼Œä»è€ŒèŠ‚çœäº†æ—¶é—´ã€‚</p><h3 id="æ³¨æ„ç‚¹" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„ç‚¹"><span>æ³¨æ„ç‚¹</span></a></h3><ul><li>ä½¿ç”¨<code>it.only</code>æ—¶ï¼Œå…¶å®ƒæ²¡æœ‰æ ‡è®°çš„æµ‹è¯•ç”¨ä¾‹å°†è¢«è·³è¿‡ï¼Œä¸ä¼šæ‰§è¡Œã€‚</li><li>åœ¨å¤šä¸ªæµ‹è¯•æ–‡ä»¶ä¸­å¦‚æœä½¿ç”¨äº†å¤šä¸ª<code>it.only</code>ï¼Œåˆ™åªæœ‰æ ‡è®°äº†<code>it.only</code>çš„æµ‹è¯•ç”¨ä¾‹ä¼šè¢«æ‰§è¡Œã€‚</li><li>å½“ä½ å®Œæˆç‰¹å®šæµ‹è¯•ç”¨ä¾‹çš„è°ƒè¯•åï¼Œè®°å¾—å»æ‰<code>.only</code>ä»¥ç¡®ä¿æ‰€æœ‰æµ‹è¯•èƒ½å¤Ÿè¢«æ‰§è¡Œï¼Œè¿™æ ·å¯ä»¥ä¿è¯æ•´ä¸ªé¡¹ç›®çš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚</li></ul><p><code>it.only</code>æ˜¯ä¸€ä¸ªååˆ†å®ç”¨çš„å·¥å…·ï¼Œå°¤å…¶åœ¨è¿›è¡Œå¤§è§„æ¨¡æµ‹è¯•æˆ–è€…é›†æˆæµ‹è¯•æ—¶ï¼Œèƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…é›†ä¸­ç²¾åŠ›äºå½“å‰æœ€é‡è¦çš„ä»»åŠ¡ä¸Šã€‚</p><h2 id="before-fn-options" tabindex="-1"><a class="header-anchor" href="#before-fn-options"><span><a href="https://nodejs.org/docs/latest/api/test.html#beforefn-options" target="_blank" rel="noopener noreferrer">before([fn][, options])</a></span></a></h2><p>Node.js çš„ <code>before</code> å‡½æ•¸æ˜¯ä¸€ä¸ªåœ¨æµ‹è¯•ä»£ç ä¸­éå¸¸æœ‰ç”¨çš„å·¥å…·ã€‚å®ƒå±äº Node.js ä¸­çš„æµ‹è¯•æ¨¡å—ï¼Œå…è®¸ä½ åœ¨å®é™…æµ‹è¯•è¿è¡Œä¹‹å‰æ‰§è¡ŒæŸäº›ä»£ç ã€‚è¿™å¯¹äºè®¾ç½®æµ‹è¯•ç¯å¢ƒã€åˆå§‹åŒ–æ•°æ®åº“æˆ–è€…åšä¸€äº›æ¸…ç†å·¥ä½œç­‰åœºæ™¯éå¸¸æœ‰å¸®åŠ©ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ·±å…¥äº†è§£ <code>before</code> å‡½æ•°åŠå…¶åœ¨å®é™…åº”ç”¨ä¸­çš„å‡ ä¸ªä¾‹å­ã€‚</p><h3 id="åŸºç¡€æ¦‚å¿µ-1" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æ¦‚å¿µ-1"><span>åŸºç¡€æ¦‚å¿µ</span></a></h3><p>åœ¨æµ‹è¯•ä»£ç ä¸­ï¼Œ<code>before</code> å‡½æ•°ç”¨äºæŒ‡å®šä¸€ä¸ªåœ¨æ‰€æœ‰æµ‹è¯•ä¹‹å‰è¿è¡Œçš„é’©å­ï¼ˆHookï¼‰ã€‚å®ƒæ¥å—ä¸€ä¸ªå¯é€‰çš„å¼‚æ­¥å‡½æ•° <code>fn</code> å’Œä¸€ä¸ªå¯é€‰çš„ <code>options</code> å¯¹è±¡ã€‚è¿™é‡Œçš„ â€œå¼‚æ­¥â€ æ„å‘³ç€ä½ å¯ä»¥åœ¨å‡½æ•°å†…éƒ¨è¿›è¡Œå¼‚æ­¥æ“ä½œï¼Œæ¯”å¦‚ä»æ•°æ®åº“è·å–æ•°æ®ï¼Œè€Œä¸ä¼šé˜»å¡åç»­ä»£ç çš„æ‰§è¡Œã€‚</p><h3 id="å‚æ•°è¯´æ˜-1" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯´æ˜-1"><span>å‚æ•°è¯´æ˜</span></a></h3><ul><li><code>fn</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ã€‚å¦‚æœæä¾›ï¼Œå®ƒåº”è¯¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ˆå¯ä»¥æ˜¯å¼‚æ­¥çš„ï¼‰ï¼Œå°†åœ¨æ‰€æœ‰æµ‹è¯•ä¹‹å‰æ‰§è¡Œã€‚</li><li><code>options</code>: ä¹Ÿæ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ã€‚å®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥åŒ…å«ä¸€äº›é…ç½®é¡¹ï¼Œæ¯”å¦‚è®¾ç½®è¶…æ—¶æ—¶é—´ç­‰ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-2"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-åˆå§‹åŒ–æ•°æ®åº“" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åˆå§‹åŒ–æ•°æ®åº“"><span>ç¤ºä¾‹ 1: åˆå§‹åŒ–æ•°æ®åº“</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ç³»åˆ—æµ‹è¯•ï¼Œè¿™äº›æµ‹è¯•éœ€è¦å¯¹æ•°æ®åº“è¿›è¡Œå„ç§æ“ä½œï¼ˆå¢ã€åˆ ã€æŸ¥ã€æ”¹ï¼‰ã€‚ä¸ºäº†ç¡®ä¿æ¯æ¬¡æµ‹è¯•çš„ç‹¬ç«‹æ€§å’Œä¸€è‡´æ€§ï¼Œä½ å¯èƒ½å¸Œæœ›åœ¨æµ‹è¯•å¼€å§‹å‰è¿æ¥åˆ°æ•°æ®åº“ï¼Œå¹¶ä¸”é‡ç½®æ•°æ®åº“åˆ°ä¸€ä¸ªå·²çŸ¥çš„åˆå§‹çŠ¶æ€ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">before</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">before</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿æ¥åˆ°æ•°æ®åº“</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> database</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">connect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // é‡ç½®æ•°æ®åº“çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> database</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">reset</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-æ¸…ç†æ—¥å¿—æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æ¸…ç†æ—¥å¿—æ–‡ä»¶"><span>ç¤ºä¾‹ 2: æ¸…ç†æ—¥å¿—æ–‡ä»¶</span></a></h4><p>å¯èƒ½åœ¨è¿›è¡Œå¾ˆå¤šç±»å‹çš„æµ‹è¯•æ—¶ï¼Œä½ çš„åº”ç”¨ç¨‹åºä¼šç”Ÿæˆæ—¥å¿—æ–‡ä»¶ã€‚ä¸ºäº†ç¡®ä¿æµ‹è¯•çš„å‡†ç¡®æ€§ï¼Œä½ å¯èƒ½å¸Œæœ›åœ¨å¼€å§‹æµ‹è¯•å‰æ¸…ç†æ—§çš„æ—¥å¿—æ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">before</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs/promises&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨Node.jsçš„Promise APIæ¥å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ“ä½œ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">before</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åˆ é™¤æ—§çš„æ—¥å¿—æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> fs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">unlink</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/path/to/old/logfile.log&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;No log file to remove, continuing...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-3-è®¾ç½®ç¯å¢ƒå˜é‡" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-è®¾ç½®ç¯å¢ƒå˜é‡"><span>ç¤ºä¾‹ 3: è®¾ç½®ç¯å¢ƒå˜é‡</span></a></h4><p>åœ¨æµ‹è¯•ç‰¹å®šåŠŸèƒ½æ—¶ï¼Œå¯èƒ½éœ€è¦æ ¹æ®ä¸åŒçš„ç¯å¢ƒå˜é‡é…ç½®æ¥è°ƒæ•´æµ‹è¯•çš„è¡Œä¸ºã€‚ä½¿ç”¨ <code>before</code> é’©å­æ¥è®¾ç½®è¿™äº›ç¯å¢ƒå˜é‡èƒ½å¤Ÿç¡®ä¿æ‰€æœ‰æµ‹è¯•éƒ½åœ¨æ­£ç¡®çš„ç¯å¢ƒä¸‹è¿è¡Œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">before</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">before</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è®¾ç½®ç¯å¢ƒå˜é‡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">NODE_ENV</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">DB_HOST</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;localhost&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ€»ç»“-7" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-7"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡ä¸Šè¿°ç¤ºä¾‹å¯ä»¥çœ‹å‡ºï¼Œ<code>before</code> é’©å­åœ¨æµ‹è¯•ä¸­éå¸¸æœ‰ç”¨ã€‚å®ƒå¸®åŠ©ä½ è®¾ç½®ä¸€ä¸ªå¹²å‡€ã€å¯é¢„æµ‹çš„æµ‹è¯•ç¯å¢ƒï¼Œåœ¨è¿›è¡Œä¸€ç³»åˆ—æµ‹è¯•ä¹‹å‰è¿›è¡Œå¿…è¦çš„å‡†å¤‡å·¥ä½œã€‚æ— è®ºæ˜¯æ¸…ç†æ—¥å¿—æ–‡ä»¶ã€è®¾ç½®ç¯å¢ƒå˜é‡è¿˜æ˜¯åˆå§‹åŒ–æ•°æ®åº“ï¼Œä½¿ç”¨ <code>before</code> éƒ½èƒ½è®©ä½ çš„æµ‹è¯•æ›´åŠ ç¨³å®šå’Œå¯é ã€‚</p><h2 id="after-fn-options" tabindex="-1"><a class="header-anchor" href="#after-fn-options"><span><a href="https://nodejs.org/docs/latest/api/test.html#afterfn-options" target="_blank" rel="noopener noreferrer">after([fn][, options])</a></span></a></h2><p>Node.js åœ¨å…¶ v21.7.1 ç‰ˆæœ¬ä¸­å¼•å…¥äº†è®¸å¤šæœ‰è¶£çš„åŠŸèƒ½å’Œå·¥å…·ï¼Œå…¶ä¸­ <code>after([fn][, options])</code> æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„å·¥å…·ï¼Œç‰¹åˆ«æ˜¯åœ¨è¿›è¡Œå•å…ƒæµ‹è¯•æ—¶ã€‚ç†è§£è¿™ä¸ªå‡½æ•°å¯¹äºç¼–å†™é«˜æ•ˆã€å¯é çš„ä»£ç è‡³å…³é‡è¦ã€‚æˆ‘å°†å°½å¯èƒ½ç®€æ´å’Œé€šä¿—åœ°è§£é‡Šå®ƒï¼Œå¹¶æä¾›ä¸€äº›å®é™…è¿ç”¨çš„ä¾‹å­ã€‚</p><h3 id="after-fn-options-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#after-fn-options-ç®€ä»‹"><span><code>after([fn][, options])</code> ç®€ä»‹</span></a></h3><p><code>after()</code> å‡½æ•°æ˜¯ Node.js ä¸­ä¸€ä¸ªç”¨äºæµ‹è¯•çš„åŠ©æ‰‹å‡½æ•°ï¼Œå®ƒä¸»è¦ç”¨äºå®šä¹‰åœ¨ä¸€ç³»åˆ—å¼‚æ­¥æ“ä½œå®Œæˆååº”æ‰§è¡Œçš„æ¸…ç†æˆ–æ–­è¨€ï¼ˆassertionsï¼‰ä»£ç ã€‚å®ƒå±äº Node.js çš„æµ‹è¯•å·¥å…·é›†ï¼Œæœ‰åŠ©äºç»„ç»‡å’Œç®¡ç†æµ‹è¯•ä»£ç ã€‚</p><ul><li><code>fn</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ã€‚å®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼ŒæŒ‡å®šäº†åœ¨æ‰§è¡Œå®Œæ‰€æœ‰æŒ‡å®šçš„å‰ç½®ä»»åŠ¡åéœ€è¦è¿è¡Œçš„ä»£ç ã€‚</li><li><code>options</code>: ä¹Ÿæ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ã€‚å®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥åŒ…å«ä¸€äº›é…ç½®é€‰é¡¹ï¼Œæ¯”å¦‚è®¾ç½®è¶…æ—¶æ—¶é—´ç­‰ã€‚</li></ul><h3 id="ä½¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯"><span>ä½¿ç”¨åœºæ™¯</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç½‘ç»œæœåŠ¡æˆ–ä»»ä½•æ¶‰åŠåˆ°å¼‚æ­¥æ“ä½œçš„ç¨‹åºï¼ˆä¾‹å¦‚æ–‡ä»¶è¯»å†™ã€æ•°æ®åº“æ“ä½œç­‰ï¼‰ã€‚åœ¨æµ‹è¯•è¿™äº›æ“ä½œæ—¶ï¼Œå¾ˆå¤šæ—¶å€™ä½ éœ€è¦åœ¨æ‰€æœ‰æ“ä½œå®Œæˆåè¿›è¡ŒæŸäº›æ¸…ç†å·¥ä½œï¼Œæ¯”å¦‚å…³é—­æ•°æ®åº“è¿æ¥ã€åˆ é™¤æµ‹è¯•äº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶ç­‰ã€‚è¿™æ—¶ï¼Œ<code>after()</code> å‡½æ•°å°±æ˜¾å¾—éå¸¸æœ‰ç”¨ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-6" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-6"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><h4 id="ç¤ºä¾‹-1-åŸºç¡€ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åŸºç¡€ä½¿ç”¨"><span>ç¤ºä¾‹ 1ï¼šåŸºç¡€ä½¿ç”¨</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨æµ‹è¯•ä¸€ä¸ªåˆ›å»ºä¸´æ—¶æ–‡ä»¶çš„åŠŸèƒ½ï¼Œåœ¨æµ‹è¯•ç»“æŸåä½ å¸Œæœ›åˆ é™¤è¿™ä¸ªä¸´æ—¶æ–‡ä»¶ã€‚ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨ <code>after()</code> æ¥å®ç°è¿™ä¸€ç‚¹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">after</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹è¯•åˆ›å»ºæ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åˆ›å»ºä¸´æ—¶æ–‡ä»¶&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> tempFilePath</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/path/to/temp/file&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾ createTempFile æ˜¯ä¸€ä¸ªåˆ›å»ºä¸´æ—¶æ–‡ä»¶çš„å¼‚æ­¥å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> createTempFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">tempFilePath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦çœŸçš„è¢«åˆ›å»ºäº†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">ok</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">existsSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">tempFilePath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä¸´æ—¶æ–‡ä»¶åº”è¯¥å­˜åœ¨&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹è¯•å®Œæˆåæ¸…ç†ä¸´æ—¶æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">after</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> tempFilePath</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/path/to/temp/file&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">existsSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">tempFilePath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">unlinkSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">tempFilePath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-å¸¦æœ‰é…ç½®é€‰é¡¹" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å¸¦æœ‰é…ç½®é€‰é¡¹"><span>ç¤ºä¾‹ 2ï¼šå¸¦æœ‰é…ç½®é€‰é¡¹</span></a></h4><p>å¦‚æœæˆ‘ä»¬æƒ³ç¡®ä¿æ¸…ç†å‡½æ•°åœ¨è§„å®šçš„æ—¶é—´å†…å®Œæˆï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>options</code> å‚æ•°æ¥è®¾å®šä¸€ä¸ªè¶…æ—¶é™åˆ¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">after</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">after</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ‰§è¡Œä¸€äº›å¯èƒ½ä¼šèŠ±è´¹è¾ƒé•¿æ—¶é—´çš„æ¸…ç†æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®è¶…æ—¶æ—¶é—´ä¸º5000æ¯«ç§’</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå¦‚æœæ¸…ç†æ“ä½œè¶…è¿‡ 5 ç§’è¿˜æ²¡æœ‰å®Œæˆï¼Œæµ‹è¯•æ¡†æ¶ä¼šè‡ªåŠ¨æ ‡è®°è¿™ä¸ªæ¸…ç†ä»»åŠ¡ä¸ºå¤±è´¥ï¼Œè¿™æœ‰åŠ©äºå‘ç°é‚£äº›æ½œåœ¨çš„æ€§èƒ½é—®é¢˜æˆ–ä¸æœŸæœ›çš„è¡Œä¸ºã€‚</p><h3 id="æ€»ç»“-8" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-8"><span>æ€»ç»“</span></a></h3><p>ç†è§£å¹¶ä½¿ç”¨ <code>after([fn][, options])</code> å¯ä»¥å¸®åŠ©ä½ æ›´å¥½åœ°ç®¡ç†æµ‹è¯•ä»£ç ä¸­çš„æ¸…ç†å·¥ä½œæˆ–æ–­è¨€ï¼Œä½¿å…¶æ›´åŠ æ¨¡å—åŒ–å’Œæ˜“äºç®¡ç†ã€‚é€šè¿‡ä¸Šè¿°ä¾‹å­ï¼Œä½ åº”è¯¥èƒ½å¤Ÿçœ‹åˆ°å¦‚ä½•åœ¨å®é™…æµ‹è¯•ä¸­åº”ç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¹¶æ ¹æ®éœ€è¦é…ç½®å®ƒã€‚éšç€ä½ é€æ¸æ·±å…¥å­¦ä¹  Node.jsï¼Œä½ ä¼šå‘ç°è¿™æ ·çš„å·¥å…·åœ¨ä¿æŒä»£ç è´¨é‡å’Œç¨³å®šæ€§æ–¹é¢å‘æŒ¥ç€é‡è¦ä½œç”¨ã€‚</p><h2 id="beforeeach-fn-options" tabindex="-1"><a class="header-anchor" href="#beforeeach-fn-options"><span><a href="https://nodejs.org/docs/latest/api/test.html#beforeeachfn-options" target="_blank" rel="noopener noreferrer">beforeEach([fn][, options])</a></span></a></h2><p>ç†è§£ <code>beforeEach([fn][, options])</code> è¿™ä¸ªæ¦‚å¿ˆå’Œå®ƒåœ¨ Node.js v21.7.1 ä¸­çš„ä½¿ç”¨ï¼Œé¦–å…ˆéœ€è¦çŸ¥é“è¿™æ˜¯ Node.js æµ‹è¯•æ¨¡å—ä¸­çš„ä¸€ä¸ªåŠŸèƒ½ã€‚æµ‹è¯•æ˜¯è½¯ä»¶å¼€å‘ä¸­éå¸¸é‡è¦çš„ä¸€ç¯ï¼Œå®ƒå¸®åŠ©æˆ‘ä»¬ç¡®ä¿ä»£ç æŒ‰ç…§é¢„æœŸè¿è¡Œï¼ŒåŒæ—¶ä¹Ÿèƒ½åŠæ—¶å‘ç°ä»£ç æ›´æ”¹åå¼•å…¥çš„é—®é¢˜ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-beforeeach" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-beforeeach"><span>ä»€ä¹ˆæ˜¯ <code>beforeEach</code>?</span></a></h3><p><code>beforeEach</code> æ˜¯ä¸€ä¸ªåœ¨å¤šä¸ªæµ‹è¯•è¿è¡Œä¹‹å‰ï¼Œæ¯ä¸ªæµ‹è¯•è¿è¡Œå‰è‡ªåŠ¨æ‰§è¡Œçš„å‡½æ•°ã€‚è¿™é€šå¸¸ç”¨äºåˆå§‹åŒ–æµ‹è¯•ç¯å¢ƒï¼Œæˆ–è€…é‡ç½®æµ‹è¯•çŠ¶æ€ï¼Œç¡®ä¿æ¯æ¬¡æµ‹è¯•çš„åˆå§‹æ¡ä»¶éƒ½æ˜¯ç›¸åŒçš„ï¼Œä½¿å¾—æµ‹è¯•ç»“æœå¯é ã€ä¸€è‡´ã€‚</p><h3 id="å‚æ•°-1" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-1"><span>å‚æ•°</span></a></h3><ul><li><code>fn</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºè¦åœ¨æ¯ä¸ªæµ‹è¯•æ¡ˆä¾‹æ‰§è¡Œä¹‹å‰è¿è¡Œçš„å‡½æ•°ã€‚</li><li><code>options</code>: è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…è®¸ä½ é…ç½®è¯¥ <code>beforeEach</code> é’©å­çš„è¡Œä¸ºï¼Œæ¯”å¦‚è®¾ç½®è¶…æ—¶æ—¶é—´ç­‰ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ä¸¾ä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¸¾ä¾‹"><span>å®é™…åº”ç”¨ä¸¾ä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªåšå®¢ç³»ç»Ÿï¼Œéœ€è¦å¯¹æ–‡ç« æ¨¡å—çš„æ·»åŠ æ–‡ç« åŠŸèƒ½è¿›è¡Œæµ‹è¯•ã€‚æ¯ä¸ªæµ‹è¯•æ¡ˆä¾‹å¯èƒ½éƒ½éœ€è¦ä¸€ä¸ªå¹²å‡€çš„æ•°æ®åº“ç¯å¢ƒã€‚è¿™é‡Œå°±å¯ä»¥ç”¨åˆ° <code>beforeEach</code>ã€‚</p><h4 id="ä¾‹-1-åˆå§‹åŒ–æ•°æ®åº“" tabindex="-1"><a class="header-anchor" href="#ä¾‹-1-åˆå§‹åŒ–æ•°æ®åº“"><span>ä¾‹ 1: åˆå§‹åŒ–æ•°æ®åº“</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">beforeEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">initDB</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">destroyDB</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">addArticle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./blog&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨æ¯ä¸ªæµ‹è¯•å¼€å§‹å‰ï¼Œåˆå§‹åŒ–æ•°æ®åº“</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">beforeEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> initDB</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨æ¯ä¸ªæµ‹è¯•ç»“æŸåï¼Œæ¸…ç†æ•°æ®åº“</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">afterEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> destroyDB</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;add article&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ·»åŠ æ–‡ç« çš„æµ‹è¯•é€»è¾‘...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> addArticle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    title</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;New Article&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    content</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Content here&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">success</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Article should be added successfully&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>beforeEach</code> å’Œé…å¯¹çš„ <code>afterEach</code>ï¼ˆæ¯ä¸ªæµ‹è¯•ä¹‹åæ‰§è¡Œï¼‰æ¥ä¿è¯æ¯æ¬¡æµ‹è¯•è¿è¡Œçš„æ˜¯ç‹¬ç«‹ä¸”å¹²å‡€çš„ç¯å¢ƒï¼Œä»è€Œæé«˜æµ‹è¯•çš„å‡†ç¡®æ€§å’Œå¯é æ€§ã€‚</p><h4 id="ä¾‹-2-é‡ç½®å…¨å±€å˜é‡" tabindex="-1"><a class="header-anchor" href="#ä¾‹-2-é‡ç½®å…¨å±€å˜é‡"><span>ä¾‹ 2: é‡ç½®å…¨å±€å˜é‡</span></a></h4><p>å‡è®¾ä½ çš„æµ‹è¯•éœ€è¦ä¾èµ–æŸäº›å…¨å±€çŠ¶æ€ï¼Œè€Œè¿™äº›çŠ¶æ€éœ€è¦åœ¨æ¯ä¸ªæµ‹è¯•å‰è¢«é‡ç½®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> counter</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">beforeEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åœ¨æ¯ä¸ªæµ‹è¯•å¼€å§‹å‰é‡ç½®è®¡æ•°å™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  counter</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;increment counter&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  counter</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">counter</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Counter should be 1, got </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">counter</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;decrement counter&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  counter</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">counter</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Counter should be -1, got </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">counter</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„è®¡æ•°å™¨é€»è¾‘éœ€è¦æµ‹è¯•ã€‚é€šè¿‡ <code>beforeEach</code> æ¥é‡ç½® <code>counter</code> çš„å€¼ï¼Œç¡®ä¿æ¯ä¸ªæµ‹è¯•çš„å‡ºå‘ç‚¹éƒ½æ˜¯ç›¸åŒçš„ï¼Œä»è€Œé¿å…æµ‹è¯•ä¹‹é—´çš„ç›¸äº’å½±å“ã€‚</p><h3 id="æ€»ç»“-9" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-9"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡ <code>beforeEach</code> ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿æ¯ä¸ªæµ‹è¯•æ¡ˆä¾‹è¿è¡Œå‰éƒ½æœ‰ä¸€ä¸ªé¢„å®šçš„èµ·å§‹ç¯å¢ƒï¼Œè¿™å¯¹äºç»´æŠ¤æµ‹è¯•çš„ç‹¬ç«‹æ€§å’Œä¸€è‡´æ€§æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚æ— è®ºæ˜¯éœ€è¦é‡ç½®æ•°æ®åº“ï¼Œæ¸…ç©ºç¼“å­˜ï¼Œè¿˜æ˜¯é‡ç½®æŸäº›å…¨å±€å˜é‡ï¼Œ <code>beforeEach</code> éƒ½æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„å·¥å…·ã€‚</p><h2 id="aftereach-fn-options" tabindex="-1"><a class="header-anchor" href="#aftereach-fn-options"><span><a href="https://nodejs.org/docs/latest/api/test.html#aftereachfn-options" target="_blank" rel="noopener noreferrer">afterEach([fn][, options])</a></span></a></h2><p>åœ¨ Node.js ä¸­ï¼Œ<code>afterEach([fn][, options])</code>æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•çš„å‡½æ•°ï¼Œå®ƒå±äº Node.js çš„å†…ç½®æµ‹è¯•æ¡†æ¶ã€‚è¿™ä¸ªå‡½æ•°ç‰¹åˆ«é€‚ç”¨äºæ‰§è¡Œä¸€ç³»åˆ—æµ‹è¯•æ—¶ï¼Œåœ¨æ¯ä¸ªæµ‹è¯•ä¹‹åè‡ªåŠ¨è¿è¡ŒæŸäº›ä»£ç ã€‚è¿™é€šå¸¸ç”¨äºæ¸…ç†æµ‹è¯•ç¯å¢ƒï¼Œæ¯”å¦‚é‡ç½®æ¨¡æ‹Ÿçš„æ•°æ®æˆ–è€…é‡Šæ”¾èµ„æºç­‰ï¼Œç¡®ä¿æ¯ä¸ªæµ‹è¯•éƒ½åœ¨å¹²å‡€çš„ç¯å¢ƒä¸‹è¿è¡Œã€‚</p><h3 id="å‚æ•°è§£é‡Š-3" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-3"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>fn</code>: è¿™æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ˆå¯é€‰ï¼‰ï¼Œå®ƒåŒ…å«äº†ä½ å¸Œæœ›åœ¨æ¯ä¸ªæµ‹è¯•å®Œæˆåæ‰§è¡Œçš„ä»£ç ã€‚</li><li><code>options</code>: ä¸€ä¸ªå¯¹è±¡ï¼ˆå¯é€‰ï¼‰ï¼Œç”¨äºæä¾›é¢å¤–çš„é…ç½®é€‰é¡¹ã€‚å…·ä½“é€‰é¡¹å¯èƒ½éšç‰ˆæœ¬å˜åŒ–ï¼Œæœ€å¥½æŸ¥é˜…å…·ä½“çš„æ–‡æ¡£ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ä¸¾ä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¸¾ä¾‹-1"><span>å®é™…åº”ç”¨ä¸¾ä¾‹</span></a></h3><h4 id="_1-æ¸…ç†æ¨¡æ‹Ÿæ•°æ®" tabindex="-1"><a class="header-anchor" href="#_1-æ¸…ç†æ¨¡æ‹Ÿæ•°æ®"><span>1. æ¸…ç†æ¨¡æ‹Ÿæ•°æ®</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¯¹ä¸€ä¸ªç”¨æˆ·ç®¡ç†ç³»ç»Ÿè¿›è¡Œæµ‹è¯•ï¼Œæ¯ä¸ªæµ‹è¯•ä¼šåœ¨æ•°æ®åº“ä¸­æ·»åŠ ç”¨æˆ·æ•°æ®ã€‚ä¸ºäº†é¿å…æµ‹è¯•é—´çš„æ•°æ®å¹²æ‰°ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>afterEach</code>æ¥æ¸…é™¤æ¯æ¬¡æµ‹è¯•æ·»åŠ çš„æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">afterEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">addUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">deleteUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./userManagement&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾addUseræ˜¯æ·»åŠ ç”¨æˆ·çš„å‡½æ•°ï¼ŒdeleteUseræ˜¯åˆ é™¤ç”¨æˆ·çš„å‡½æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">afterEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾æ‰€æœ‰æµ‹è¯•æ·»åŠ çš„ç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªç‰¹å®šçš„æ ‡è®°ï¼Œè¿™é‡Œæˆ‘ä»¬æ¸…é™¤è¿™äº›ç”¨æˆ·</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> deleteUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">testUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æµ‹è¯•æ·»åŠ ç”¨æˆ·&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> addUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;John Doe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">testUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿›è¡Œæ–­è¨€æ£€æŸ¥...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-é‡ç½®æ¨¡æ‹Ÿå¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_2-é‡ç½®æ¨¡æ‹Ÿå¯¹è±¡"><span>2. é‡ç½®æ¨¡æ‹Ÿå¯¹è±¡</span></a></h4><p>å¦‚æœä½ åœ¨æµ‹è¯•ä¸­ä½¿ç”¨äº†æ¨¡æ‹Ÿå¯¹è±¡ï¼ˆMock Objectsï¼‰ï¼Œå¯èƒ½éœ€è¦åœ¨æ¯ä¸ªæµ‹è¯•åé‡ç½®è¿™äº›å¯¹è±¡ï¼Œä»¥é˜²æ­¢ä¸€ä¸ªæµ‹è¯•çš„æ¨¡æ‹ŸçŠ¶æ€æ±¡æŸ“åˆ°å¦ä¸€ä¸ªæµ‹è¯•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">afterEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> sinon</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sinon&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½¿ç”¨sinonåº“æ¥åˆ›å»ºæ¨¡æ‹Ÿå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> myAPI</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./myAPI&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">afterEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">restore</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é‡ç½®æ¨¡æ‹Ÿå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æµ‹è¯•APIè°ƒç”¨&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  mock</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> sinon</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">myAPI</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">expects</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;call&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">once</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">returns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿›è¡ŒAPIè°ƒç”¨åŠæ–­è¨€æ£€æŸ¥...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-é‡Šæ”¾èµ„æº" tabindex="-1"><a class="header-anchor" href="#_3-é‡Šæ”¾èµ„æº"><span>3. é‡Šæ”¾èµ„æº</span></a></h4><p>åœ¨è¿›è¡Œä¸€äº›éœ€è¦åˆ†é…èµ„æºçš„æµ‹è¯•ï¼Œæ¯”å¦‚æ‰“å¼€æ–‡ä»¶ã€ç½‘ç»œè¿æ¥ç­‰ï¼Œå¯èƒ½éœ€è¦åœ¨æµ‹è¯•åé‡Šæ”¾æˆ–å…³é—­è¿™äº›èµ„æºã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">afterEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨Promiseç‰ˆæœ¬çš„æ–‡ä»¶ç³»ç»ŸAPI</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> tempFilePath</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;./temp.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">afterEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">unlink</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">tempFilePath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ é™¤ä¸´æ—¶æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æµ‹è¯•å†™æ–‡ä»¶&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">tempFilePath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, world!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿›è¡Œæ–‡ä»¶å†…å®¹æ–­è¨€æ£€æŸ¥...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™äº›ç¤ºä¾‹å±•ç¤ºäº†<code>afterEach</code>åœ¨å„ç§åœºæ™¯ä¸‹çš„åº”ç”¨ï¼Œæœ‰åŠ©äºä¿æŒæµ‹è¯•çš„ç‹¬ç«‹æ€§å’Œå‡†ç¡®æ€§ã€‚ä½¿ç”¨<code>afterEach</code>å¯ä»¥å¤§å¤§æé«˜æµ‹è¯•çš„å¯ç»´æŠ¤æ€§å’Œå¯é æ€§ã€‚</p><h2 id="class-mockfunctioncontext" tabindex="-1"><a class="header-anchor" href="#class-mockfunctioncontext"><span><a href="https://nodejs.org/docs/latest/api/test.html#class-mockfunctioncontext" target="_blank" rel="noopener noreferrer">Class: MockFunctionContext</a></span></a></h2><p>Node.js v21.7.1 ä¸­çš„<code>MockFunctionContext</code>æ˜¯åœ¨ Node.js çš„æµ‹è¯•æ¨¡å—ä¸­ä½¿ç”¨çš„ä¸€ä¸ªç±»ï¼Œä¸“é—¨ç”¨äºåˆ›å»ºå’Œç®¡ç†æ¨¡æ‹Ÿå‡½æ•°ï¼ˆMock Functionsï¼‰çš„ä¸Šä¸‹æ–‡ã€‚æ¨¡æ‹Ÿå‡½æ•°ç”¨äºåœ¨æµ‹è¯•è¿‡ç¨‹ä¸­æ›¿æ¢é‚£äº›éœ€è¦è¢«éš”ç¦»æµ‹è¯•çš„å¤æ‚ã€ä¸æ˜“æ§åˆ¶æˆ–å¤–éƒ¨ä¾èµ–çš„çœŸå®å‡½æ•°ã€‚è¿™æ ·å¯ä»¥å¸®åŠ©ä½ ä¸“æ³¨äºè¦æµ‹è¯•çš„ä»£ç éƒ¨åˆ†ï¼Œè€Œæ— éœ€å…³å¿ƒå…¶ä»–éƒ¨åˆ†çš„å…·ä½“å®ç°ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯mockfunctioncontext" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯mockfunctioncontext"><span>ä»€ä¹ˆæ˜¯<code>MockFunctionContext</code>ï¼Ÿ</span></a></h3><p>åœ¨æ·±å…¥ç†è§£<code>MockFunctionContext</code>ä¹‹å‰ï¼Œéœ€è¦æ˜ç™½å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p><ul><li><strong>æ¨¡æ‹Ÿï¼ˆMockingï¼‰</strong>ï¼šåœ¨è½¯ä»¶æµ‹è¯•ä¸­ï¼Œæ¨¡æ‹ŸæŒ‡çš„æ˜¯æ¨¡ä»¿æŸä¸ªç³»ç»Ÿæˆ–æ¨¡å—çš„è¡Œä¸ºï¼Œä½†ä¸æ¶‰åŠå…¶å†…éƒ¨çš„å…·ä½“å®ç°ã€‚</li><li><strong>å‡½æ•°æ¨¡æ‹Ÿï¼ˆFunction Mockingï¼‰</strong>ï¼šç‰¹æŒ‡åˆ›å»ºä¸€äº›æ›¿ä»£åŸæœ‰åŠŸèƒ½çš„å‡½æ•°ï¼Œè¿™äº›å‡½æ•°ä¸æ‰§è¡Œå®é™…çš„é€»è¾‘ï¼Œä½†å¯ä»¥è®°å½•è°ƒç”¨çš„æ¬¡æ•°ã€ä¼ å…¥çš„å‚æ•°ç­‰ä¿¡æ¯ï¼Œç”šè‡³å¯ä»¥é¢„è®¾è¿”å›ç»“æœã€‚</li></ul><p><code>MockFunctionContext</code>ç±»æä¾›äº†ä¸€ä¸ªä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œè®©ä½ èƒ½å¤Ÿåœ¨å…¶ä¸­åˆ›å»ºå’Œé…ç½®æ¨¡æ‹Ÿå‡½æ•°ã€‚é€šè¿‡è¿™ä¸ªç±»ï¼Œä½ å¯ä»¥è¯¦ç»†åœ°æ§åˆ¶æ¨¡æ‹Ÿå‡½æ•°çš„è¡Œä¸ºï¼Œæ¯”å¦‚è®¾ç½®å‡½æ•°è¢«è°ƒç”¨æ—¶çš„è¿”å›å€¼ï¼Œæˆ–è€…ç›‘è§†å‡½æ•°æ˜¯å¦è¢«è°ƒç”¨åŠè°ƒç”¨äº†å¤šå°‘æ¬¡ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-2"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç”µå­å•†åŠ¡ç½‘ç«™çš„åç«¯æœåŠ¡ï¼Œå¹¶ä¸”ä½ çš„ä»£ç ä¸­æœ‰ä¸€ä¸ªå‡½æ•°<code>sendEmailToUser</code>ï¼Œå½“ç”¨æˆ·ä¸‹å•åä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°æ¥å‘é€é‚®ä»¶ç»™ç”¨æˆ·ã€‚åœ¨æµ‹è¯•è¿™éƒ¨åˆ†åŠŸèƒ½æ—¶ï¼Œä½ å¹¶ä¸çœŸçš„æƒ³å‘é€é‚®ä»¶ï¼ˆè¿™å¯èƒ½å¯¼è‡´ä¸å¿…è¦çš„éº»çƒ¦ï¼‰ï¼Œè€Œåªæ˜¯æƒ³ç¡®ä¿åœ¨æ­£ç¡®çš„æ¡ä»¶ä¸‹è°ƒç”¨äº†<code>sendEmailToUser</code>å‡½æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŸå§‹å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> sendEmailToUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">userEmail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">orderDetails</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åœ¨è¿™é‡Œä¼šæœ‰å‘é€é‚®ä»¶ç»™ç”¨æˆ·çš„é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>MockFunctionContext</code>æ¥åˆ›å»ºä¸€ä¸ªæ¨¡æ‹Ÿçš„<code>sendEmailToUser</code>å‡½æ•°ï¼Œå¹¶åœ¨æµ‹è¯•ä¸­ä½¿ç”¨å®ƒï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">expect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">mockFunctionContext</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test/mock&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sendEmailToUser is called when a new order is placed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> context</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> mockFunctionContext</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åˆ›å»ºæ¨¡æ‹Ÿå‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> mockSendEmail</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mockFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">sendEmailToUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä½¿ç”¨æ¨¡æ‹Ÿçš„`sendEmailToUser`å‡½æ•°è¿›è¡Œæµ‹è¯•...</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ¯”å¦‚æ¨¡æ‹Ÿç”¨æˆ·ä¸‹å•çš„æ“ä½œ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // éªŒè¯`sendEmailToUser`æ˜¯å¦è¢«æ­£ç¡®åœ°è°ƒç”¨äº†ä¸€æ¬¡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  expect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">mockSendEmail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toHaveBeenCalledTimes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½¿ç”¨<code>mockFunctionContext</code>åˆ›å»ºäº†ä¸€ä¸ª<code>sendEmailToUser</code>çš„æ¨¡æ‹Ÿç‰ˆæœ¬ã€‚è¿™æ ·ï¼Œåœ¨æµ‹è¯•ä¸­è°ƒç”¨<code>sendEmailToUser</code>æ—¶ï¼Œå®é™…ä¸Šæ˜¯è°ƒç”¨çš„æ¨¡æ‹Ÿå‡½æ•°ï¼Œå®ƒä¸ä¼šæ‰§è¡Œå‘é€é‚®ä»¶çš„é€»è¾‘ï¼Œä½†å¯ä»¥æ£€æŸ¥å®ƒæ˜¯å¦è¢«è°ƒç”¨ä»¥åŠè°ƒç”¨çš„æ¬¡æ•°ï¼Œç¡®ä¿åœ¨ç”¨æˆ·ä¸‹å•æ—¶èƒ½å¤Ÿè§¦å‘é‚®ä»¶å‘é€è¡Œä¸ºã€‚</p><h3 id="å°ç»“-3" tabindex="-1"><a class="header-anchor" href="#å°ç»“-3"><span>å°ç»“</span></a></h3><p><code>MockFunctionContext</code>æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå®ƒåœ¨ Node.js çš„æµ‹è¯•ä¸­æ‰®æ¼”ç€é‡è¦è§’è‰²ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦éš”ç¦»æµ‹è¯•æŸéƒ¨åˆ†ä»£ç è€Œä¸å½±å“å…¶ä»–éƒ¨åˆ†æ—¶ã€‚é€šè¿‡åˆ›å»ºå’Œç®¡ç†æ¨¡æ‹Ÿå‡½æ•°ï¼Œå®ƒå¯ä»¥å¸®åŠ©å¼€å‘è€…æ›´æœ‰æ•ˆåœ°ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œç¡®ä¿ä»£ç çš„è´¨é‡å’Œç¨³å®šæ€§ã€‚</p><h3 id="ctx-calls" tabindex="-1"><a class="header-anchor" href="#ctx-calls"><span><a href="https://nodejs.org/docs/latest/api/test.html#ctxcalls" target="_blank" rel="noopener noreferrer">ctx.calls</a></span></a></h3><p>Node.js v21.7.1 è¿™ä¸ªç‰ˆæœ¬ä¸­ï¼Œ<code>ctx.calls</code> æ˜¯ Node.js æµ‹è¯•æ¡†æ¶çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†ã€‚åœ¨ Node.js çš„æµ‹è¯•ç¯å¢ƒä¸­ï¼Œ<code>ctx</code> æ˜¯ä¸€ä¸ªå…³é”®çš„å¯¹è±¡ï¼Œå®ƒä»£è¡¨äº†å½“å‰çš„æµ‹è¯•ä¸Šä¸‹æ–‡ï¼ˆcontextï¼‰ã€‚è¿™ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡<code>ctx</code>åŒ…å«äº†è®¸å¤šæœ‰ç”¨çš„å±æ€§å’Œæ–¹æ³•ï¼Œå¸®åŠ©ä½ ç¼–å†™å’Œç®¡ç†æµ‹è¯•æ¡ˆä¾‹ã€‚</p><h3 id="ctx-calls-ç†è§£" tabindex="-1"><a class="header-anchor" href="#ctx-calls-ç†è§£"><span><code>ctx.calls</code> ç†è§£</span></a></h3><p><code>ctx.calls</code> ç‰¹åˆ«æ˜¯ï¼Œå®ƒè®°å½•äº†åœ¨å½“å‰æµ‹è¯•ä¸Šä¸‹æ–‡ä¸­å‘ç”Ÿçš„è°ƒç”¨æƒ…å†µã€‚ç®€å•æ¥è¯´ï¼Œæ¯å½“ä½ çš„æµ‹è¯•ä»£ç ä¸­å‘ç”Ÿäº†æŸäº›æ“ä½œã€å‡½æ•°è°ƒç”¨æˆ–è€…æ˜¯å¼‚æ­¥äº‹ä»¶æ—¶ï¼Œ<code>ctx.calls</code> éƒ½å¯ä»¥å¸®åŠ©ä½ è¿½è¸ªå’Œè®°å½•è¿™äº›æ´»åŠ¨ã€‚è¿™å¯¹äºç†è§£æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä»€ä¹ˆï¼Œä»¥åŠä¸ºä»€ä¹ˆæµ‹è¯•å¯èƒ½å¤±è´¥éå¸¸æœ‰å¸®åŠ©ã€‚</p><h3 id="å®é™…è¿ç”¨ä¸¾ä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¸¾ä¾‹"><span>å®é™…è¿ç”¨ä¸¾ä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨æµ‹è¯•ä¸€ä¸ªç®€å•çš„åº”ç”¨ï¼Œè¿™ä¸ªåº”ç”¨æœ‰ä¸€ä¸ªåŠŸèƒ½æ˜¯ï¼šè®¡ç®—ä¸¤ä¸ªæ•°å­—çš„å’Œï¼Œå¹¶è®°å½•æ¯ä¸€æ¬¡è®¡ç®—æ“ä½œã€‚</p><h4 id="_1-åˆ›å»ºä¸€ä¸ªç®€å•çš„è®¡ç®—æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_1-åˆ›å»ºä¸€ä¸ªç®€å•çš„è®¡ç®—æ¨¡å—"><span>1. åˆ›å»ºä¸€ä¸ªç®€å•çš„è®¡ç®—æ¨¡å—ï¼š</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// calculator.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">b</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> a</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> b</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> };</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-ç¼–å†™æµ‹è¯•æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#_2-ç¼–å†™æµ‹è¯•æ¡ˆä¾‹"><span>2. ç¼–å†™æµ‹è¯•æ¡ˆä¾‹ï¼š</span></a></h4><p>åœ¨æ’°å†™æµ‹è¯•æ¡ˆä¾‹æ—¶ï¼Œæˆ‘ä»¬æƒ³è¦ç¡®ä¿æˆ‘ä»¬çš„<code>add</code>å‡½æ•°ä¸ä»…èƒ½æ­£ç¡®è®¡ç®—å‡ºç»“æœï¼Œè€Œä¸”è¿˜èƒ½å¤Ÿåœ¨æ¯æ¬¡è°ƒç”¨æ—¶è¢«æ­£ç¡®åœ°è®°å½•åˆ°<code>ctx.calls</code>å½“ä¸­ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// test.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./calculator&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;add function tests&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;correctly records calls in ctx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–¹æ³•å¯ä»¥è®°å½•å‡½æ•°è°ƒç”¨åˆ°ctx</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">recordCall</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;add&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    expect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ£€æŸ¥ctx.callsæ˜¯å¦åŒ…å«äº†æˆ‘ä»¬çš„&#39;add&#39;è°ƒç”¨</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    expect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">calls</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">contains</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;add&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toBe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº†æˆ‘ä»¬çš„<code>add</code>å‡½æ•°ã€‚ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæµ‹è¯•å¥—ä»¶<code>describe</code>åŒ…å«äº†ä¸€ä¸ªå…·ä½“çš„æµ‹è¯•æ¡ˆä¾‹<code>it</code>ã€‚åœ¨æµ‹è¯•æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬æ‰§è¡Œäº†<code>add(2, 3)</code>å¹¶æœŸæœ›å¾—åˆ°ç»“æœ<code>5</code>ã€‚æ¥ç€ï¼Œæˆ‘ä»¬é€šè¿‡<code>ctx.recordCall(&#39;add&#39;)</code>ï¼ˆè¿™é‡Œå‡è®¾å­˜åœ¨è¿™æ ·ä¸€ä¸ªæ–¹æ³•ï¼‰æ¥æ¨¡æ‹Ÿè®°å½•è¿™æ¬¡è°ƒç”¨è‡³<code>ctx</code>ã€‚æœ€åï¼Œæˆ‘ä»¬éªŒè¯<code>ctx.calls</code>ç¡®å®åŒ…å«äº†æˆ‘ä»¬çš„<code>add</code>è°ƒç”¨ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®é™…çš„ Node.js æµ‹è¯•ç¯å¢ƒå¯èƒ½æ²¡æœ‰ç›´æ¥æä¾›<code>recordCall</code>è¿™æ ·çš„æ–¹æ³•ã€‚è¿™é‡Œçš„<code>ctx.recordCall(&#39;add&#39;);</code>å’Œç›¸åº”çš„éªŒè¯<code>ctx.calls.contains(&#39;add&#39;)</code>æ˜¯å‡æƒ³çš„ç¤ºèŒƒï¼Œæ—¨åœ¨è¯´æ˜å¦‚ä½•åˆ©ç”¨<code>ctx.calls</code>æ¥è¿½è¸ªæµ‹è¯•ä¸­çš„å‡½æ•°è°ƒç”¨ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½¿ç”¨<code>ctx.calls</code>çš„æ–¹å¼å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œå…·ä½“å–å†³äºä½ ä½¿ç”¨çš„æµ‹è¯•æ¡†æ¶å’Œç›¸å…³åº“ã€‚</p><h3 id="ctx-callcount" tabindex="-1"><a class="header-anchor" href="#ctx-callcount"><span><a href="https://nodejs.org/docs/latest/api/test.html#ctxcallcount" target="_blank" rel="noopener noreferrer">ctx.callCount()</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚Node.js å…·æœ‰ä¼—å¤šçš„å†…ç½®æ¨¡å—å’ŒåŠŸèƒ½ï¼Œç”¨äºå¤„ç†å„ç§ä¸åŒçš„ä»»åŠ¡ï¼Œæ¯”å¦‚æ–‡ä»¶ç³»ç»Ÿæ“ä½œã€ç½‘ç»œè¯·æ±‚ã€è·¯å¾„æ“ä½œç­‰ã€‚ä»Šå¤©æˆ‘ä»¬æ¥æ¢è®¨å…¶ä¸­çš„ä¸€ä¸ªéå¸¸ç‰¹å®šä¸”ç›¸å¯¹è¿›é˜¶çš„åŠŸèƒ½ï¼š<code>ctx.callCount()</code>ï¼Œè¿™ä¸ªåŠŸèƒ½æ˜¯åœ¨ Node.js çš„æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨çš„ã€‚</p><p>é¦–å…ˆï¼Œä¸ºäº†ç†è§£<code>ctx.callCount()</code>ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç™½å®ƒå‡ºç°åœ¨ Node.js çš„æµ‹è¯•æ¡†æ¶ä¸Šä¸‹æ–‡ä¸­ã€‚<code>ctx</code>ä»£è¡¨çš„æ˜¯&quot;ä¸Šä¸‹æ–‡(context)&quot;çš„ç®€å†™ï¼Œåœ¨æµ‹è¯•æ¡†æ¶ä¸­ï¼Œä¸Šä¸‹æ–‡é€šå¸¸ç”¨äºä¿å­˜å’Œä¼ é€’åœ¨æ•´ä¸ªæµ‹è¯•å‘¨æœŸä¸­éœ€è¦çš„ä¿¡æ¯ã€‚è€Œ<code>callCount()</code>å‡½æ•°çš„ä½œç”¨ï¼Œåˆ™æ˜¯è¿”å›ä¸€ä¸ªç‰¹å®šå‡½æ•°è¢«è°ƒç”¨çš„æ¬¡æ•°ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-3"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªæµ‹è¯•æ¡ˆä¾‹ï¼Œéœ€è¦éªŒè¯ä¸€ä¸ªåä¸º<code>doSomething()</code>çš„å‡½æ•°æ˜¯å¦è¢«æ­£ç¡®åœ°è°ƒç”¨äº†é¢„æœŸæ¬¡æ•°ã€‚åœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œ<code>ctx.callCount()</code>å¯ä»¥å¸®åŠ©ä½ è·å–åˆ°ç¡®åˆ‡çš„è°ƒç”¨æ¬¡æ•°ï¼Œä»è€Œè®©ä½ çš„æµ‹è¯•æ›´åŠ å‡†ç¡®å’Œå¯é ã€‚</p><h4 id="ç¤ºä¾‹ä»£ç " tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç "><span>ç¤ºä¾‹ä»£ç </span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä½ è¦æµ‹è¯•çš„å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> doSomething</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åœ¨è¿™é‡Œæ‰§è¡Œä¸€äº›æ“ä½œ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿä¸€ä¸ªæµ‹è¯•åœºæ™¯</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;doSomething Tests&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should be called once&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // è¿™é‡Œä½¿ç”¨ ctx.callCount() æ¥æ£€æŸ¥ doSomething å‡½æ•°çš„è°ƒç”¨æ¬¡æ•°</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ³¨æ„: æ­¤è¡Œä»…ä¸ºç¤ºä¾‹ï¼Œå¹¶ä¸èƒ½åœ¨å®é™…ä»£ç ä¸­ç›´æ¥è¿è¡Œï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰çœŸå®çš„ ctx å¯¹è±¡å’Œ callCount æ–¹æ³•ã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> callCount</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">callCount</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">doSomething</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾èƒ½å¤Ÿè¿™æ ·è·å–è°ƒç”¨æ¬¡æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // ä½¿ç”¨æ–­è¨€æ¥ç¡®ä¿å‡½æ•°ç¡®å®è¢«è°ƒç”¨äº†ä¸€æ¬¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">callCount</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œè¿™æ®µä»£ç åªæ˜¯æ¦‚å¿µæ€§çš„å±•ç¤ºï¼Œ<code>ctx</code> å’Œ <code>callCount()</code> çš„å®é™…ä½¿ç”¨å¯èƒ½ä¼šä¾èµ–äºå…·ä½“çš„æµ‹è¯•æ¡†æ¶ã€‚åœ¨ Node.js æ ‡å‡†åº“ä¸­å¹¶ä¸ç›´æ¥æä¾›è¿™ä¸¤è€…ï¼Œå®ƒä»¬æ›´å¯èƒ½æ˜¯æŸäº›ç‰¹å®šæµ‹è¯•æ¡†æ¶æˆ–å·¥å…·ä¸­çš„åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œåœ¨ä½¿ç”¨åƒ Mochaã€Jest è¿™ç±»æµ‹è¯•æ¡†æ¶æ—¶ï¼Œé€šå¸¸ä¼šæœ‰è‡ªå·±çš„æ–¹å¼æ¥è¿½è¸ªå‡½æ•°è°ƒç”¨æ¬¡æ•°ï¼Œæˆ–è€…éœ€è¦æ­é…ä½¿ç”¨è¯¸å¦‚ Sinon è¿™æ ·çš„åº“æ¥å®ç°ç›¸å…³åŠŸèƒ½ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œ<code>ctx.callCount()</code>çš„æ¦‚å¿µä¸»è¦ç”¨äºåœ¨æµ‹è¯•ä¸­è¿½è¸ªå’ŒéªŒè¯ç‰¹å®šå‡½æ•°çš„è°ƒç”¨æƒ…å†µï¼Œä»¥ç¡®ä¿ä»£ç çš„é€»è¾‘æ­£ç¡®æ€§å’Œç¨³å®šæ€§ã€‚å°½ç®¡å…·ä½“çš„å®ç°å’Œä½¿ç”¨ç»†èŠ‚å¯èƒ½åœ¨ä¸åŒçš„ç¯å¢ƒå’Œæ¡†æ¶ä¸­æœ‰æ‰€å·®å¼‚ï¼Œä½†ç†è§£å…¶æ ¸å¿ƒç›®çš„æ˜¯æœ‰åŠ©äºæé«˜æµ‹è¯•çš„è´¨é‡å’Œæ•ˆç‡çš„ã€‚</p><h3 id="ctx-mockimplementation-implementation" tabindex="-1"><a class="header-anchor" href="#ctx-mockimplementation-implementation"><span><a href="https://nodejs.org/docs/latest/api/test.html#ctxmockimplementationimplementation" target="_blank" rel="noopener noreferrer">ctx.mockImplementation(implementation)</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>ctx.mockImplementation(implementation)</code>æ˜¯ä¸€ä¸ªä¸æµ‹è¯•æœ‰å…³çš„åŠŸèƒ½ã€‚ä¸ºäº†è®©ä½ æ›´å¥½åœ°ç†è§£å®ƒï¼Œæˆ‘ä¼šé¦–å…ˆè§£é‡Šç›¸å…³çš„æ¦‚å¿µï¼Œç„¶åå†é€šè¿‡ä¸€äº›å®é™…çš„ä¾‹å­æ¥è¯´æ˜å…¶åº”ç”¨ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-mocking-1" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-mocking-1"><span>ä»€ä¹ˆæ˜¯ Mockingï¼Ÿ</span></a></h3><p>åœ¨ç¼–ç¨‹ä¸­ï¼Œ&quot;mocking&quot;æŒ‡çš„æ˜¯æ¨¡æ‹ŸæŸä¸ªå¯¹è±¡ã€å‡½æ•°æˆ–ç³»ç»Ÿçš„è¡Œä¸ºï¼Œä»¥ä¾¿äºåœ¨æµ‹è¯•ç¯å¢ƒä¸­ä¸éœ€è¦ä¾èµ–çœŸå®çš„å®ç°ã€‚è¿™é€šå¸¸ç”¨äºå•å…ƒæµ‹è¯•ï¼Œç›®çš„æ˜¯ç¡®ä¿æµ‹è¯•çš„é‡ç‚¹æ”¾åœ¨è¢«æµ‹è¯•å•å…ƒä¸Šï¼Œè€Œä¸æ˜¯å¤–éƒ¨ä¾èµ–æˆ–å…¶ä»–ä¸ç¨³å®šå› ç´ ä¸Šã€‚</p><h3 id="ctx-mockimplementation-implementation-ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#ctx-mockimplementation-implementation-ä»‹ç»"><span>ctx.mockImplementation(implementation)ä»‹ç»</span></a></h3><p>å…·ä½“åˆ°<code>ctx.mockImplementation(implementation)</code>ï¼Œè¿™æ˜¯åœ¨ Node.js çš„æµ‹è¯•æ¡†æ¶å†…ä½¿ç”¨çš„æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªâ€œmockâ€å‡½æ•°ï¼Œå¹¶å®šä¹‰å½“è¿™ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶åº”è¯¥æ‰§è¡Œçš„å®ç°ï¼ˆå³ï¼šå®ƒåº”è¯¥åšä»€ä¹ˆï¼‰ã€‚è¿™å…è®¸å¼€å‘è€…åœ¨æµ‹è¯•ç¯å¢ƒä¸­æ§åˆ¶å‡½æ•°çš„è¡Œä¸ºï¼Œè€Œä¸éœ€è¦å…³å¿ƒè¿™ä¸ªå‡½æ•°çš„å®é™…é€»è¾‘ã€‚</p><p>å‚æ•°ï¼š</p><ul><li><code>implementation</code> æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®šä¹‰äº† mock å‡½æ•°è¢«è°ƒç”¨æ—¶çš„è¡Œä¸ºã€‚</li></ul><h3 id="åº”ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#åº”ç”¨ç¤ºä¾‹"><span>åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåº”ç”¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå‘é€ç”µå­é‚®ä»¶çš„åŠŸèƒ½ã€‚æ­¤åŠŸèƒ½ä¾èµ–äºä¸€ä¸ªåä¸º <code>sendEmail</code> çš„å‡½æ•°ï¼Œä½†åœ¨æµ‹è¯•æ—¶ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›çœŸçš„å‘é€ç”µå­é‚®ä»¶ã€‚</p><ol><li><strong>åŸºç¡€ç¤ºä¾‹</strong></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> sendEmail</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> jest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯æˆ‘ä»¬è¦mockçš„å‡½æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">sendEmail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mockImplementation</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Mocked email sending&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾å‘é€æˆåŠŸè¿”å›true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>sendEmail</code> å‡½æ•°è¢« mock äº†ã€‚å½“å®ƒè¢«è°ƒç”¨æ—¶ï¼Œä¸ä¼šçœŸçš„å‘é€ç”µå­é‚®ä»¶ï¼Œè€Œæ˜¯æ‰“å°å‡º &quot;Mocked email sending&quot; å¹¶è¿”å› <code>true</code>ï¼Œè¡¨æ˜é‚®ä»¶å‘é€æ“ä½œæˆåŠŸã€‚</p><ol start="2"><li><strong>å¸¦æ¡ä»¶çš„åŠ¨æ€å“åº”</strong></li></ol><p>æ¥ä¸‹æ¥ï¼Œå‡è®¾æˆ‘ä»¬æƒ³æ ¹æ®è¾“å…¥å†³å®šè¿”å›å€¼ï¼Œä»¥æ›´å¥½åœ°æ¨¡æ‹ŸçœŸå®åœºæ™¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">sendEmail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mockImplementation</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">address</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;test@example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Mocked email sent to test@example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Failed to send mock email to &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿéé¢„æœŸåœ°å€å‘é€å¤±è´¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœä¼ é€’ç»™ <code>sendEmail</code> çš„ç”µå­é‚®ä»¶åœ°å€æ˜¯ &quot;<a href="mailto:test@example.com" target="_blank" rel="noopener noreferrer">test@example.com</a>&quot;ï¼Œåˆ™æ¨¡æ‹Ÿå‘é€æˆåŠŸï¼›å¯¹äºå…¶ä»–åœ°å€ï¼Œåˆ™æ¨¡æ‹Ÿå‘é€å¤±è´¥ã€‚</p><p>é€šè¿‡ä»¥ä¸Šç¤ºä¾‹ï¼Œä½ å¯ä»¥çœ‹åˆ°<code>ctx.mockImplementation(implementation)</code>å¦‚ä½•å…è®¸åœ¨æµ‹è¯•ä¸­æ§åˆ¶å‡½æ•°çš„è¡Œä¸ºï¼Œä½¿å¾—æµ‹è¯•æ›´åŠ é›†ä¸­å’Œé«˜æ•ˆã€‚è®°ä½ï¼Œå°½ç®¡è¿™é‡Œçš„ä¾‹å­å¾ˆç®€å•ï¼Œä½† mocking æ˜¯å•å…ƒæµ‹è¯•ä¸­ä¸€ä¸ªå¼ºå¤§ä¸”å¤æ‚çš„æ¦‚å¿µï¼Œèƒ½å¤Ÿå¤„ç†æ›´å¤šæ ·åŒ–å’Œå¤æ‚çš„æµ‹è¯•åœºæ™¯ã€‚</p><h3 id="ctx-mockimplementationonce-implementation-oncall" tabindex="-1"><a class="header-anchor" href="#ctx-mockimplementationonce-implementation-oncall"><span><a href="https://nodejs.org/docs/latest/api/test.html#ctxmockimplementationonceimplementation-oncall" target="_blank" rel="noopener noreferrer">ctx.mockImplementationOnce(implementation[, onCall])</a></span></a></h3><p>è®©æˆ‘ä»¬ä»¥ä¸€ä¸ªç®€å•ç›´è§‚çš„æ–¹å¼æ¢è®¨ä¸€ä¸‹ Node.js ä¸­ <code>ctx.mockImplementationOnce</code> è¿™ä¸ªåŠŸèƒ½ã€‚</p><p>é¦–å…ˆï¼Œ<code>ctx.mockImplementationOnce</code> æ˜¯æµ‹è¯•ç¯å¢ƒä¸‹ä½¿ç”¨çš„ä¸€ç§æ–¹æ³•ã€‚å®ƒå±äº Mockingï¼ˆæ¨¡æ‹Ÿï¼‰æŠ€æœ¯çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºæ¨¡ä»¿æŸäº›åŠŸèƒ½åœ¨ç‰¹å®šæ¡ä»¶ä¸‹çš„è¡¨ç°ã€‚è¿™å¯¹äºç¼–å†™å•å…ƒæµ‹è¯•å°¤å…¶é‡è¦ï¼Œå› ä¸ºå®ƒå…è®¸ä½ æ§åˆ¶å‡½æ•°çš„è¡Œä¸ºï¼Œç¡®ä¿ä½ å¯ä»¥æµ‹è¯•å„ç§åœºæ™¯è€Œæ— éœ€ä¾èµ–å¤–éƒ¨ç³»ç»Ÿæˆ–å¤æ‚çš„è®¾ç½®ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-4" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-4"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><ul><li><strong>Mocking</strong>ï¼šåœ¨æµ‹è¯•ä¸­æ›¿ä»£çœŸå®å®ç°çš„ä¸€ç§æ‰‹æ®µï¼Œä½¿å¾—æµ‹è¯•ä¸ä¾èµ–å¤–éƒ¨ç³»ç»Ÿã€‚</li><li><strong>ctx.mockImplementationOnce</strong>ï¼šæ˜¯ä¸€ä¸ªå…è®¸ä½ ä¸ºæŸä¸ª mock å‡½æ•°æŒ‡å®šä¸€ä¸ªç‰¹å®šçš„å®ç°ï¼Œä½†åªä¼šå½±å“ä¸‹ä¸€æ¬¡è°ƒç”¨çš„æ–¹æ³•ã€‚éšåçš„è°ƒç”¨å°†ä¸å—è¿™ä¸ªç‰¹å®šå®ç°çš„å½±å“ï¼Œé™¤éå†æ¬¡è®¾ç½®ã€‚</li></ul><h3 id="ä½¿ç”¨åœºæ™¯-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯-1"><span>ä½¿ç”¨åœºæ™¯</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªå¤©æ°”åº”ç”¨ï¼Œè¯¥åº”ç”¨é€šè¿‡è°ƒç”¨å¤–éƒ¨ API æ¥è·å–å½“å‰å¤©æ°”çŠ¶å†µã€‚åœ¨æµ‹è¯•è¿™ä¸ªåŠŸèƒ½æ—¶ï¼Œæˆ‘ä»¬å¹¶ä¸å¸Œæœ›çœŸæ­£å‘èµ· API è¯·æ±‚ï¼Œå› ä¸ºè¿™æ ·åšå¯èƒ½ä¼šå¢åŠ æµ‹è¯•çš„ä¸ç¡®å®šæ€§å’Œæ‰§è¡Œæ—¶é—´ã€‚ç›¸åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>ctx.mockImplementationOnce</code>æ¨¡æ‹Ÿè¿™ä¸ª API è°ƒç”¨çš„è¡Œä¸ºã€‚</p><h3 id="å®é™…ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-4"><span>å®é™…ä¾‹å­</span></a></h3><ol><li><p><strong>æ¨¡æ‹Ÿ API è°ƒç”¨</strong></p><p>å‡è®¾æœ‰ä¸€ä¸ªå‡½æ•° <code>fetchWeather</code>ï¼Œå®ƒè´Ÿè´£è°ƒç”¨å¤–éƒ¨ API è·å–å¤©æ°”ä¿¡æ¯ã€‚åœ¨æµ‹è¯•æœŸé—´ï¼Œæˆ‘ä»¬ä¸æƒ³å®é™…è°ƒç”¨ APIï¼Œè€Œæ˜¯å¸Œæœ›æ¨¡æ‹Ÿä¸åŒçš„è¿”å›å€¼æ¥æµ‹è¯•åº”ç”¨å¦‚ä½•å“åº”ä¸åŒçš„å¤©æ°”çŠ¶å†µã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŸå§‹çš„ fetchWeather å‡½æ•°ï¼ˆæˆ‘ä»¬æƒ³è¦æ¨¡æ‹Ÿå®ƒï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetchWeather</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">city</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å®é™…ä¸Šä¼šä»å¤–éƒ¨APIè·å–å¤©æ°”æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹è¯•ä¸­æ¨¡æ‹Ÿ fetchWeather</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;handles sunny weather&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åªå¯¹ä¸‹ä¸€æ¬¡è°ƒç”¨è¿›è¡Œæ¨¡æ‹Ÿï¼Œå¹¶æ¨¡æ‹Ÿæ™´å¤©æƒ…å†µçš„è¿”å›å€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mockImplementationOnce</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">26</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    condition</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Sunny&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> weather</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetchWeather</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;SomeCity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  expect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">weather</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">condition</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toBe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Sunny&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ¨¡æ‹Ÿå¤±è´¥çš„æƒ…å†µ</strong></p><p>åŒæ ·åœ°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ¨¡æ‹Ÿ API è°ƒç”¨å¤±è´¥çš„æƒ…å†µï¼Œä¾‹å¦‚ç½‘ç»œé—®é¢˜å¯¼è‡´çš„é”™è¯¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;handles network errors&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ¨¡æ‹Ÿç½‘ç»œé”™è¯¯çš„æƒ…å†µ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mockImplementationOnce</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Network error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  expect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetchWeather</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;SomeCity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toThrow</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Network error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="å°ç»“-4" tabindex="-1"><a class="header-anchor" href="#å°ç»“-4"><span>å°ç»“</span></a></h3><p>é€šè¿‡ä½¿ç”¨ <code>ctx.mockImplementationOnce</code>ï¼Œä½ å¯ä»¥é’ˆå¯¹å•ä¸ªæµ‹è¯•ç”¨ä¾‹æ¨¡æ‹Ÿå‡½æ•°çš„ä¸åŒè¡Œä¸ºï¼Œæ— è®ºæ˜¯æˆåŠŸçš„åœºæ™¯è¿˜æ˜¯å¼‚å¸¸å¤„ç†ã€‚è¿™ç§æ–¹å¼æå¤§åœ°å¢åŠ äº†æµ‹è¯•çš„çµæ´»æ€§å’Œå¯é æ€§ï¼Œä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿæ›´åŠ è‡ªä¿¡åœ°ç¡®ä¿ä»–ä»¬çš„ä»£ç èƒ½å¤Ÿæ­£ç¡®å¤„ç†å„ç§å®é™…æƒ…å†µã€‚</p><h3 id="ctx-resetcalls" tabindex="-1"><a class="header-anchor" href="#ctx-resetcalls"><span><a href="https://nodejs.org/docs/latest/api/test.html#ctxresetcalls" target="_blank" rel="noopener noreferrer">ctx.resetCalls()</a></span></a></h3><p>Node.js v21.7.1 çš„æ–‡æ¡£ä¸­æåˆ°çš„ <code>ctx.resetCalls()</code> å‡½æ•°æ˜¯åœ¨ Node.js çš„æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨çš„ä¸€ä¸ªç‰¹å®šåŠŸèƒ½ã€‚ä¸ºäº†è§£é‡Šè¿™ä¸ªæ¦‚å¿µï¼Œè®©æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹å®ƒç”¨åœ¨å“ªé‡Œä»¥åŠä¸ºä»€ä¹ˆéœ€è¦å®ƒã€‚</p><h3 id="èƒŒæ™¯" tabindex="-1"><a class="header-anchor" href="#èƒŒæ™¯"><span>èƒŒæ™¯</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>ctx</code> æ˜¯æŒ‡ä¸Šä¸‹æ–‡ï¼ˆContextï¼‰ï¼Œé€šå¸¸åœ¨ç¼–å†™æµ‹è¯•ä»£ç æ—¶é‡åˆ°ã€‚æµ‹è¯•æ˜¯è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„éƒ¨åˆ†ï¼Œå®ƒå¸®åŠ©å¼€å‘è€…ç¡®ä¿ä»–ä»¬çš„ä»£ç æŒ‰ç…§é¢„æœŸå·¥ä½œï¼Œå¹¶ä¸”åœ¨å°†æ¥ä¿®æ”¹ä»£ç æ—¶ä¸ä¼šæ„å¤–åœ°ç ´åç°æœ‰åŠŸèƒ½ã€‚</p><h3 id="ctx-resetcalls-1" tabindex="-1"><a class="header-anchor" href="#ctx-resetcalls-1"><span>ctx.resetCalls()</span></a></h3><p>å½“ä½ åœ¨ä½¿ç”¨ Node.js ç¼–å†™æµ‹è¯•æ¡ˆä¾‹æ—¶ï¼Œ<code>ctx.resetCalls()</code> å‡½æ•°å…è®¸ä½ é‡ç½®åœ¨æŸä¸ªä¸Šä¸‹æ–‡ (<code>ctx</code>) ä¸­è®°å½•çš„å‡½æ•°è°ƒç”¨çš„çŠ¶æ€ã€‚è¿™æ„å‘³ç€æ‰€æœ‰é€šè¿‡æ­¤ä¸Šä¸‹æ–‡è·Ÿè¸ªçš„å‡½æ•°è°ƒç”¨æ¬¡æ•°ã€ä¼ é€’çš„å‚æ•°ã€è¿”å›çš„ç»“æœç­‰ä¿¡æ¯ä¼šè¢«æ¸…ç©ºï¼Œå°±åƒä»æœªè°ƒç”¨è¿‡è¿™äº›å‡½æ•°ä¸€æ ·ã€‚</p><h3 id="ä¸ºä»€ä¹ˆéœ€è¦å®ƒ" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆéœ€è¦å®ƒ"><span>ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</span></a></h3><p>åœ¨è¿›è¡Œå•å…ƒæµ‹è¯•æˆ–é›†æˆæµ‹è¯•æ—¶ï¼Œç¡®ä¿æµ‹è¯•ä¹‹é—´ç›¸äº’ç‹¬ç«‹éå¸¸é‡è¦ã€‚æ¯ä¸ªæµ‹è¯•åº”è¯¥ä»ä¸€ä¸ªå¹²å‡€çš„çŠ¶æ€å¼€å§‹ï¼Œä»¥é¿å…ä¸€ä¸ªæµ‹è¯•çš„å‰¯ä½œç”¨å½±å“åˆ°å¦ä¸€ä¸ªæµ‹è¯•çš„ç»“æœã€‚å¦‚æœä¸é‡ç½®å‡½æ•°è°ƒç”¨çš„çŠ¶æ€ï¼Œä¹‹å‰çš„æµ‹è¯•å¯èƒ½ä¼šå¯¹å½“å‰æ­£åœ¨è¿›è¡Œçš„æµ‹è¯•äº§ç”Ÿä¸å¯é¢„è§çš„å½±å“ï¼Œå¯¼è‡´æµ‹è¯•ç»“æœä¸å‡†ç¡®ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-7" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-7"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨æµ‹è¯•ä¸€ä¸ªç®€å•çš„ç”¨æˆ·ç®¡ç†ç³»ç»Ÿï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ª <code>createUser</code> å‡½æ•°ï¼Œç”¨äºåœ¨æ•°æ®åº“ä¸­åˆ›å»ºæ–°ç”¨æˆ·ã€‚ä¸ºäº†æµ‹è¯•è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šç¼–å†™å¤šä¸ªæµ‹è¯•æ¡ˆä¾‹ï¼Œåˆ†åˆ«æµ‹è¯•æ­£å¸¸æƒ…å†µå’Œå„ç§å¼‚å¸¸æƒ…å†µï¼ˆå¦‚ç”¨æˆ·åå·²å­˜åœ¨ï¼‰ã€‚åœ¨æ¯ä¸ªæµ‹è¯•æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬éƒ½ä¼šè°ƒç”¨ <code>createUser</code> å‡½æ•°ã€‚</p><p>å¦‚æœæˆ‘ä»¬ä¸åœ¨æ¯ä¸ªæµ‹è¯•ä¹‹åé‡ç½® <code>createUser</code> å‡½æ•°çš„è°ƒç”¨çŠ¶æ€ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªæµ‹è¯•å¯èƒ½ä¼šå½±å“åˆ°åç»­çš„æµ‹è¯•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç¬¬ä¸€ä¸ªæµ‹è¯•åˆ›å»ºäº†ä¸€ä¸ªåä¸º &quot;JohnDoe&quot; çš„ç”¨æˆ·ï¼Œé‚£ä¹ˆåç»­æµ‹è¯•æ£€æŸ¥ç›¸åŒç”¨æˆ·åæ˜¯å¦ä¼šè§¦å‘ç”¨æˆ·åå·²å­˜åœ¨çš„é”™è¯¯æ—¶ï¼Œå°±ä¼šå› ä¸ºä¸Šä¸‹æ–‡æ²¡æœ‰é‡ç½®è€Œå¤±è´¥ã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨ <code>ctx.resetCalls()</code> å°±æ˜¾å¾—éå¸¸æœ‰ç”¨ã€‚åœ¨æ¯ä¸ªæµ‹è¯•ç»“æŸåè°ƒç”¨æ­¤å‡½æ•°ï¼Œå¯ä»¥ç¡®ä¿æ¯ä¸ªæµ‹è¯•éƒ½æ˜¯åœ¨æ¸…æ´çš„ç¯å¢ƒä¸‹è¿è¡Œçš„ï¼Œä»è€Œä½¿æµ‹è¯•ç»“æœæ—¢å‡†ç¡®åˆå¯é ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ä¼ªä»£ç æç»˜çš„æµ‹è¯•ç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;User Management System&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  beforeEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ¯ä¸ªæµ‹è¯•å¼€å§‹ä¹‹å‰é‡ç½®è°ƒç”¨çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resetCalls</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should create a new user successfully&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    createUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;JohnDoe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // éªŒè¯åˆ›å»ºæˆåŠŸçš„é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should throw an error if username already exists&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    createUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;JohnDoe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    expect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> createUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;JohnDoe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toThrow</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Username already exists&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // éªŒè¯ç”¨æˆ·åå·²å­˜åœ¨çš„é”™è¯¯å¤„ç†é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ€»ç»“æ¥è¯´ï¼Œ<code>ctx.resetCalls()</code> åœ¨ç¼–å†™å¯é çš„ã€éš”ç¦»çš„æµ‹è¯•æ¡ˆä¾‹æ—¶èµ·åˆ°å…³é”®ä½œç”¨ï¼Œç¡®ä¿æ¯ä¸ªæµ‹è¯•æ¡ˆä¾‹éƒ½åœ¨ä¸€ä¸ªå¹²å‡€çš„ç¯å¢ƒä¸­æ‰§è¡Œï¼Œæ— éœ€æ‹…å¿ƒä¹‹å‰çš„æµ‹è¯•æ´»åŠ¨å¯¹å½“å‰æµ‹è¯•é€ æˆå¹²æ‰°ã€‚</p><h3 id="ctx-restore" tabindex="-1"><a class="header-anchor" href="#ctx-restore"><span><a href="https://nodejs.org/docs/latest/api/test.html#ctxrestore" target="_blank" rel="noopener noreferrer">ctx.restore()</a></span></a></h3><p>é¦–å…ˆï¼Œæˆ‘æƒ³æ¾„æ¸…ä¸€ç‚¹ï¼šæˆªè‡³æˆ‘æœ€åçš„ä¿¡æ¯æ›´æ–°ï¼ˆ2023 å¹´ï¼‰ï¼ŒNode.js v21.7.1 ä¸­å¹¶æ²¡æœ‰ç›´æ¥æåˆ°<code>ctx.restore()</code>ä½œä¸º Node.js å®˜æ–¹ API çš„ä¸€éƒ¨åˆ†ã€‚ä¸è¿‡ï¼Œæ ¹æ®ä½ æä¾›çš„é“¾æ¥æ ·å¼ï¼Œçœ‹èµ·æ¥è¿™å¯èƒ½æ˜¯é’ˆå¯¹æŸä¸ªç‰¹å®šåº“æˆ–æ¡†æ¶ä¸­çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯ Node.js æ ¸å¿ƒ API çš„ä¸€éƒ¨åˆ†ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä¼šåŸºäº<code>ctx.restore()</code>è¿™ä¸ªåå­—ï¼Œå‡è®¾ä½ å¯èƒ½æ˜¯åœ¨è¯¢é—®æœ‰å…³å›¾åƒå¤„ç†æˆ–è€…ç”»å¸ƒæ“ä½œã€æˆ–è€…æ˜¯ Mockingï¼ˆæ¨¡æ‹Ÿï¼‰ç›¸å…³æ“ä½œçš„ä¸Šä¸‹æ–‡æ¢å¤åŠŸèƒ½ã€‚æˆ‘å°†ä¾æ®è¿™äº›å‡è®¾æ¥è¿›è¡Œè§£é‡Šï¼Œå¹¶ç»™å‡ºä¸€äº›ç›¸å…³çš„ä¾‹å­ã€‚</p><h3 id="å‡è®¾-1-å›¾å½¢å’Œç”»å¸ƒæ“ä½œ" tabindex="-1"><a class="header-anchor" href="#å‡è®¾-1-å›¾å½¢å’Œç”»å¸ƒæ“ä½œ"><span>å‡è®¾ 1: å›¾å½¢å’Œç”»å¸ƒæ“ä½œ</span></a></h3><p>åœ¨è®¸å¤šå›¾å½¢åº“ä¸­ï¼Œ<code>ctx</code>é€šå¸¸æŒ‡ä»£â€œcontextâ€ï¼ˆä¸Šä¸‹æ–‡ï¼‰ï¼Œç‰¹åˆ«æ˜¯åœ¨è¿›è¡Œå›¾å½¢æˆ–ç”»å¸ƒï¼ˆCanvasï¼‰æ“ä½œæ—¶ã€‚ä¾‹å¦‚ï¼Œåœ¨æµè§ˆå™¨çš„ Canvas API ä¸­ï¼Œ<code>ctx.restore()</code>æ˜¯ç”¨æ¥æ¢å¤ Canvas çš„çŠ¶æ€åˆ°æœ€è¿‘çš„<code>ctx.save()</code>è°ƒç”¨ä¿å­˜çš„çŠ¶æ€ã€‚</p><h4 id="å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹"><span>å®ä¾‹ï¼š</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ä½¿ç”¨ Canvas API ç»˜åˆ¶ä¸€ç³»åˆ—å›¾å½¢ï¼Œæ¯”å¦‚æ–¹å—å’Œåœ†ï¼Œä½ æƒ³åœ¨ç»˜åˆ¶æ¯ä¸ªå›¾å½¢å‰åï¼Œä¿å­˜å’Œæ¢å¤ç”»å¸ƒçš„çŠ¶æ€ï¼ˆæ¯”å¦‚é¢œè‰²ã€çº¿æ¡å®½åº¦ç­‰ï¼‰ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–Canvaså…ƒç´ çš„ä¸Šä¸‹æ–‡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> canvas</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> document</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getElementById</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;myCanvas&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> canvas</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getContext</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;2d&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¿å­˜å½“å‰ç”»å¸ƒçŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">save</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®ä¸€äº›å›¾å½¢å±æ€§</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fillStyle</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;green&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fillRect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç»˜åˆ¶ä¸€ä¸ªç»¿è‰²çš„æ–¹å—</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¢å¤ä¹‹å‰ä¿å­˜çš„ç”»å¸ƒçŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">restore</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ­¤æ—¶ï¼Œä»»ä½•æ–°çš„ç»˜å›¾æ“ä½œéƒ½å°†ä½¿ç”¨restore()è°ƒç”¨ä¹‹å‰çš„çŠ¶æ€</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç»§ç»­ç»˜åˆ¶å…¶ä»–å›¾å½¢...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å‡è®¾-2-mocking-æ¡†æ¶ä¸­çš„ä¸Šä¸‹æ–‡æ¢å¤" tabindex="-1"><a class="header-anchor" href="#å‡è®¾-2-mocking-æ¡†æ¶ä¸­çš„ä¸Šä¸‹æ–‡æ¢å¤"><span>å‡è®¾ 2: Mocking æ¡†æ¶ä¸­çš„ä¸Šä¸‹æ–‡æ¢å¤</span></a></h3><p>åœ¨è½¯ä»¶æµ‹è¯•ä¸­ï¼ŒMocking æ˜¯ä¸€ç§é€šè¿‡æ¨¡æ‹Ÿå¤æ‚å¯¹è±¡æˆ–è¡Œä¸ºä»¥ç®€åŒ–æµ‹è¯•çš„æŠ€æœ¯ã€‚æœ‰äº› JavaScript æµ‹è¯•æ¡†æ¶å…è®¸ä½ â€œä¿å­˜â€å’Œâ€œæ¢å¤â€æŸäº›æ“ä½œæˆ–çŠ¶æ€ï¼Œè¿™æœ‰åŠ©äºåœ¨æ‰§è¡Œæµ‹è¯•åæ¸…ç†ç¯å¢ƒã€‚</p><h4 id="å®ä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-1"><span>å®ä¾‹ï¼š</span></a></h4><p>è™½ç„¶è¿™ä¸æ˜¯ Node.js çš„ç›´æ¥åº”ç”¨ï¼Œä½†å‡å¦‚ä½ ä½¿ç”¨çš„æ˜¯æŸä¸ª Node.js æµ‹è¯•åº“ï¼Œæ¯”å¦‚ Sinon.jsï¼Œä½ å¯èƒ½ä¼šé‡åˆ°éœ€è¦æ¢å¤è¢«æ›¿æ¢ï¼ˆspied, stubbed æˆ– mockedï¼‰å‡½æ•°åˆ°å®ƒä»¬åŸå§‹çŠ¶æ€çš„æƒ…å†µï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æœ‰è¿™æ ·ä¸€ä¸ªæ¨¡å—å’Œå‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> dependency</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬ç”¨sinonæ¨¡æ‹Ÿè¿™ä¸ªå‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> sinon</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sinon&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ›¿æ¢`dependency`å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> mock</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> sinon</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">stub</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">returns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;mocked value&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">sinon</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">replace</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">myModule</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dependency&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰§è¡Œä¸€äº›æµ‹è¯•...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹è¯•å®Œæˆåï¼Œæ¢å¤åŸå§‹å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">sinon</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">restore</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼Œå…·ä½“çš„<code>restore</code>æ–¹æ³•è°ƒç”¨ä¼šä¾èµ–äºä½ æ‰€ä½¿ç”¨çš„åº“æˆ–æ¡†æ¶ã€‚</p><p>æ€»ç»“èµ·æ¥ï¼Œ<code>ctx.restore()</code>çš„å«ä¹‰é«˜åº¦ä¾èµ–äºå…¶æ‰€å¤„çš„ä¸Šä¸‹æ–‡ï¼ˆContextï¼‰ã€‚åœ¨å›¾å½¢æ“ä½œä¸­ï¼Œå®ƒå¸¸ç”¨äºæ¢å¤ç”»å¸ƒçŠ¶æ€ï¼›åœ¨ Mocking æ¡†æ¶ä¸­ï¼Œåˆ™ç”¨äºæ¢å¤è¢«æ¨¡æ‹Ÿçš„å‡½æ•°æˆ–å¯¹è±¡çš„åŸå§‹çŠ¶æ€ã€‚å¸Œæœ›è¿™èƒ½å¤Ÿå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£<code>ctx.restore()</code>çš„æ¦‚å¿µå’Œåº”ç”¨ã€‚</p><h2 id="class-mocktracker" tabindex="-1"><a class="header-anchor" href="#class-mocktracker"><span><a href="https://nodejs.org/docs/latest/api/test.html#class-mocktracker" target="_blank" rel="noopener noreferrer">Class: MockTracker</a></span></a></h2><p>äº†è§£<code>MockTracker</code>è¿™ä¸ªç±»ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆå¾—çŸ¥é“å®ƒå‡ºç°åœ¨ Node.js çš„ä¸€ä¸ªç‰¹å®šç¯èŠ‚ä¸­ï¼Œé‚£å°±æ˜¯å•å…ƒæµ‹è¯•ã€‚åœ¨ç¼–ç¨‹é¢†åŸŸï¼Œå•å…ƒæµ‹è¯•æ˜¯ç¡®ä¿ä»£ç æŒ‰ç…§é¢„æœŸå·¥ä½œçš„é‡è¦æ‰‹æ®µã€‚å®ƒå¸®åŠ©å¼€å‘è€…éªŒè¯å‡½æ•°æˆ–æ¨¡å—çš„è¡Œä¸ºæ˜¯å¦æ­£ç¡®ã€‚è€Œ<code>MockTracker</code>åˆ™æ˜¯ä¸æ¨¡æ‹Ÿï¼ˆmockingï¼‰ç›¸å…³çš„åŠŸèƒ½ï¼Œåœ¨æµ‹è¯•ä¸­éå¸¸æœ‰ç”¨ã€‚</p><h3 id="æ¦‚å¿µè§£é‡Š" tabindex="-1"><a class="header-anchor" href="#æ¦‚å¿µè§£é‡Š"><span>æ¦‚å¿µè§£é‡Š</span></a></h3><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>MockTracker</code>æ˜¯ä¸€ç§å·¥å…·ï¼Œå®ƒå±äº Node.js çš„æµ‹è¯•æ¨¡å—ã€‚ç®€å•æ¥è¯´ï¼Œ<code>MockTracker</code>å…è®¸å¼€å‘è€…è¿½è¸ªå’ŒéªŒè¯å‡½æ•°è°ƒç”¨ã€å‚æ•°ç­‰ä¿¡æ¯ï¼Œéå¸¸é€‚åˆåœ¨ä»¿åˆ¶ï¼ˆæˆ–ç§° mockingï¼‰å¤–éƒ¨ç³»ç»Ÿæˆ–å¤æ‚æ“ä½œæ—¶ä½¿ç”¨ã€‚Mocking æ˜¯å•å…ƒæµ‹è¯•ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒæŒ‡åˆ›å»ºä¸€ä¸ªå¯¹è±¡æˆ–å‡½æ•°çš„æ¨¡æ‹Ÿç‰ˆæœ¬ï¼Œä»¥ä¾¿åœ¨æµ‹è¯•ä¸­æ§åˆ¶æŸä¸ªæ¨¡å—çš„è¡Œä¸ºè€Œä¸å½±å“å…¶ä»–éƒ¨åˆ†ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-4"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå‡½æ•°<code>sendEmail(to, subject, body)</code>ï¼Œç”¨äºå‘é€ç”µå­é‚®ä»¶ã€‚åœ¨è¿›è¡Œå•å…ƒæµ‹è¯•æ—¶ï¼Œä½ å¹¶ä¸å¸Œæœ›çœŸçš„å‘é€é‚®ä»¶å»æµ‹è¯•è¿™ä¸ªåŠŸèƒ½ï¼Œè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨ mocking æ¥æ¨¡æ‹Ÿå‘é€é‚®ä»¶çš„è¿‡ç¨‹ã€‚</p><p><strong>æ­¥éª¤ä¸€</strong>ï¼šåˆ›å»ºä¸€ä¸ª<code>MockTracker</code>å®ä¾‹æ¥è¿½è¸ª<code>sendEmail</code>å‡½æ•°çš„è°ƒç”¨æƒ…å†µã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">MockTracker</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sendEmail should be called with correct parameters&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> sendEmailMock</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> MockTracker</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡å®šsendEmailç°åœ¨æ˜¯é€šè¿‡MockTrackeræ¨¡æ‹Ÿçš„</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  sendEmailMock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mockImplementation</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">to</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">subject</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">body</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ¨¡æ‹Ÿå‘é€é‚®ä»¶&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åœ¨è¿™é‡Œè°ƒç”¨åŸæœ¬ä¼šçœŸå®å‘é€é‚®ä»¶çš„å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  sendEmail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example@example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;This is a test email.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ç¡®è®¤sendEmailæ˜¯å¦è¢«æ­£ç¡®è°ƒç”¨ï¼Œä»¥åŠè°ƒç”¨æ—¶çš„å‚æ•°æ˜¯å¦æ­£ç¡®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">sendEmailMock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">calls</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">deepStrictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">sendEmailMock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">calls</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;example@example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;Hello!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;This is a test email.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  ]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰çœŸçš„å‘é€é‚®ä»¶ï¼Œä½†é€šè¿‡<code>MockTracker</code>æˆåŠŸæ¨¡æ‹Ÿäº†<code>sendEmail</code>å‡½æ•°çš„è°ƒç”¨ï¼Œå¹¶èƒ½å¤ŸéªŒè¯å®ƒæ˜¯å¦è¢«æ­£ç¡®è°ƒç”¨ä»¥åŠè°ƒç”¨æ—¶ä½¿ç”¨çš„å‚æ•°ã€‚</p><h3 id="æ€»ç»“-10" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-10"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡<code>MockTracker</code>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸æ‰§è¡Œå®é™…æ“ä½œï¼ˆå¦‚å‘é€é‚®ä»¶ã€è®¿é—®æ•°æ®åº“ç­‰ï¼‰çš„æƒ…å†µä¸‹ï¼Œç¡®è®¤æˆ‘ä»¬çš„ä»£ç ï¼ˆå°¤å…¶æ˜¯å®ƒä»¬çš„è°ƒç”¨å…³ç³»å’Œå‚æ•°ï¼‰æ˜¯å¦æŒ‰é¢„æœŸå·¥ä½œã€‚è¿™å¯¹äºæé«˜ä»£ç è´¨é‡ã€åŠ é€Ÿå¼€å‘è¿‡ç¨‹å’Œé¿å…åœ¨æ—©æœŸå¼•å…¥é”™è¯¯è‡³å…³é‡è¦ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šé¢çš„ä»£ç ç¤ºä¾‹ä½¿ç”¨äº†ç®€åŒ–å¤„ç†ï¼Œä¸»è¦æ˜¯ä¸ºäº†ç†è§£<code>MockTracker</code>çš„åŸºæœ¬æ¦‚å¿µå’Œä½¿ç”¨æ–¹å¼ã€‚åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œè¿˜éœ€è¦æ ¹æ®<code>MockTracker</code>çš„ API æ–‡æ¡£å’Œ Node.js ç‰ˆæœ¬çš„å…·ä½“å®ç°æ¥è°ƒæ•´ã€‚</p><h3 id="mock-fn-original-implementation-options" tabindex="-1"><a class="header-anchor" href="#mock-fn-original-implementation-options"><span><a href="https://nodejs.org/docs/latest/api/test.html#mockfnoriginal-implementation-options" target="_blank" rel="noopener noreferrer">mock.fn([original[, implementation]][, options])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ·±å…¥äº†è§£ Node.js ä¸­çš„ <code>mock.fn([original[, implementation]][, options])</code> æ–¹æ³•ï¼Œå¹¶å°è¯•é€šè¿‡é€šä¿—æ˜“æ‡‚çš„è¯­è¨€æ¥è§£é‡Šå®ƒï¼ŒåŒæ—¶ä¸¾ä¸€äº›å®ç”¨çš„ä¾‹å­ã€‚</p><h3 id="åŸºæœ¬ç†è§£" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç†è§£"><span>åŸºæœ¬ç†è§£</span></a></h3><p>åœ¨è½¯ä»¶æµ‹è¯•ä¸­ï¼Œ&quot;mocking&quot; æ˜¯ä¸€ç§æ¨¡æ‹ŸçœŸå®å¯¹è±¡è¡Œä¸ºçš„æŠ€æœ¯ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†éš”ç¦»æµ‹è¯•ç¯å¢ƒï¼Œç¡®ä¿æµ‹è¯•å¯ä»¥åœ¨ä¸€ä¸ªå¯æ§å’Œé¢„æœŸçš„ç¯å¢ƒä¸‹æ‰§è¡Œã€‚å½“ä½ ä½¿ç”¨ <code>mock.fn()</code> æ–¹æ³•æ—¶ï¼Œä½ åŸºæœ¬ä¸Šæ˜¯åœ¨åˆ›å»ºä¸€ä¸ª&quot;æ¨¡æ‹Ÿå‡½æ•°&quot;ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥æ¨¡æ‹Ÿç‰¹å®šçš„è¡Œä¸ºï¼Œä¹Ÿå¯ä»¥ç”¨æ¥ç›‘è§†å…¶è¢«è°ƒç”¨çš„æƒ…å†µï¼ŒåŒ…æ‹¬è°ƒç”¨æ¬¡æ•°ã€ä¼ é€’çš„å‚æ•°ç­‰ã€‚</p><h3 id="å‚æ•°è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯¦è§£"><span>å‚æ•°è¯¦è§£</span></a></h3><ul><li><p><code>original</code>: è¿™æ˜¯å¯é€‰å‚æ•°ã€‚å¦‚æœæä¾›äº†è¿™ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆæ¨¡æ‹Ÿå‡½æ•°å°†ä¼šåŒ…å«åŸå§‹å‡½æ•°çš„æ‰€æœ‰å±æ€§ã€‚</p></li><li><p><code>implementation</code>: è¿™æ˜¯å¦ä¸€ä¸ªå¯é€‰å‚æ•°ã€‚é€šè¿‡è¿™ä¸ªå‚æ•°ï¼Œä½ å¯ä»¥æŒ‡å®šä¸€ä¸ªå‡½æ•°ä½œä¸ºæ¨¡æ‹Ÿå‡½æ•°çš„å®ç°ã€‚è¿™æ„å‘³ç€æ¯å½“æ¨¡æ‹Ÿå‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå®ƒéƒ½å°†æ‰§è¡Œä½ æä¾›çš„è¿™ä¸ªå‡½æ•°ã€‚</p></li><li><p><code>options</code>: ä¹Ÿæ˜¯å¯é€‰å‚æ•°ã€‚å®ƒå…è®¸ä½ é…ç½®æ¨¡æ‹Ÿå‡½æ•°çš„ä¸€äº›é¢å¤–é€‰é¡¹ï¼Œæ¯”å¦‚åç§°ç­‰ã€‚</p></li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-3"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-åŸºæœ¬ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åŸºæœ¬ç”¨æ³•"><span>ç¤ºä¾‹ 1ï¼šåŸºæœ¬ç”¨æ³•</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå‡½æ•° <code>sendMessage</code> è´Ÿè´£å‘é€æ¶ˆæ¯ã€‚åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œä½ å¯èƒ½ä¸æƒ³çœŸçš„å‘é€æ¶ˆæ¯ï¼Œä»¥é¿å…äº§ç”Ÿä¸å¿…è¦çš„å‰¯ä½œç”¨æˆ–è´¹ç”¨ã€‚è¿™æ—¶ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨ <code>mock.fn()</code> æ¥åˆ›å»º <code>sendMessage</code> çš„æ¨¡æ‹Ÿç‰ˆæœ¬ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> mockSendMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> jest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯æµ‹è¯•æ¡ˆä¾‹çš„ä¸€éƒ¨åˆ†</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mockSendMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mockSendMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">calls</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mockSendMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">calls</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: &quot;Hello, World!&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>jest.fn()</code> åˆ›å»ºäº† <code>sendMessage</code> å‡½æ•°çš„ä¸€ä¸ªæ¨¡æ‹Ÿç‰ˆæœ¬ï¼Œç„¶åæˆ‘ä»¬è°ƒç”¨äº†è¿™ä¸ªæ¨¡æ‹Ÿå‡½æ•°ï¼Œå¹¶å‘å®ƒä¼ é€’äº†ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>.mock.calls</code> å±æ€§æ¥æ£€æŸ¥å‡½æ•°æ˜¯å¦è¢«è°ƒç”¨ï¼Œä»¥åŠè¢«è°ƒç”¨æ—¶çš„å‚æ•°å€¼ã€‚</p><h4 id="ç¤ºä¾‹-2-å¸¦å®ç°çš„æ¨¡æ‹Ÿå‡½æ•°" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å¸¦å®ç°çš„æ¨¡æ‹Ÿå‡½æ•°"><span>ç¤ºä¾‹ 2ï¼šå¸¦å®ç°çš„æ¨¡æ‹Ÿå‡½æ•°</span></a></h4><p>æ¥ä¸‹æ¥ï¼Œå‡è®¾ä½ æƒ³è¦æ¨¡æ‹Ÿä¸€ä¸ªæ›´å¤æ‚çš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°åœ¨è°ƒç”¨æ—¶åº”è¯¥è¿”å›ç‰¹å®šçš„å€¼ã€‚ä½ å¯ä»¥é€šè¿‡ä¼ é€’ <code>implementation</code> å‚æ•°æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> mockProcessData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> jest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Processed data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å½“è°ƒç”¨æ­¤æ¨¡æ‹Ÿå‡½æ•°æ—¶ï¼Œå®ƒå°†è¿”å› &quot;Processed data&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mockProcessData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: &quot;Processed data&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸º <code>mockProcessData</code> çš„æ¨¡æ‹Ÿå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶å°†è¿”å›å­—ç¬¦ä¸² <code>&quot;Processed data&quot;</code>ã€‚è¿™å¯¹äºæ¨¡æ‹Ÿé‚£äº›éœ€è¦è¿”å›ç‰¹å®šç»“æœçš„å‡½æ•°éå¸¸æœ‰ç”¨ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥æµ‹è¯•ä¾èµ–äºè¿™äº›ç»“æœçš„å…¶ä»–ä»£ç éƒ¨åˆ†ã€‚</p><h3 id="æ€»ç»“-11" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-11"><span>æ€»ç»“</span></a></h3><p>æ€»çš„æ¥è¯´ï¼Œ<code>mock.fn()</code> æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä½ åœ¨ Node.js åº”ç”¨ç¨‹åºä¸­è¿›è¡Œæœ‰æ•ˆçš„æµ‹è¯•ã€‚å®ƒä½¿å¾—æ¨¡æ‹Ÿå‡½æ•°çš„è¡Œä¸ºå˜å¾—ç®€å•ï¼ŒåŒæ—¶æä¾›äº†ä¸°å¯Œçš„æ¥å£æ¥æ£€æŸ¥å‡½æ•°çš„è°ƒç”¨æƒ…å†µã€‚æ— è®ºæ˜¯åœ¨å•å…ƒæµ‹è¯•è¿˜æ˜¯é›†æˆæµ‹è¯•ä¸­ï¼Œæ­£ç¡®ä½¿ç”¨æ¨¡æ‹Ÿå‡½æ•°éƒ½èƒ½æ˜¾è‘—æé«˜æµ‹è¯•çš„è´¨é‡å’Œæ•ˆç‡ã€‚</p><h3 id="mock-getter-object-methodname-implementation-options" tabindex="-1"><a class="header-anchor" href="#mock-getter-object-methodname-implementation-options"><span><a href="https://nodejs.org/docs/latest/api/test.html#mockgetterobject-methodname-implementation-options" target="_blank" rel="noopener noreferrer">mock.getter(object, methodName[, implementation][, options])</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>mock.getter(object, methodName[, implementation][, options])</code>æ˜¯ä¸€ä¸ªç”¨äºå•å…ƒæµ‹è¯•çš„åŠŸèƒ½ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ æ¨¡æ‹Ÿï¼ˆmockï¼‰ä¸€ä¸ªå¯¹è±¡çš„ getter å±æ€§ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå®ƒå¯ä»¥è®©ä½ æ§åˆ¶å½“ä½ åœ¨æµ‹è¯•ä»£ç ä¸­è®¿é—®æŸä¸ªå¯¹è±¡çš„ç‰¹å®šå±æ€§æ—¶ï¼Œè¿™ä¸ªå±æ€§è¿”å›ä»€ä¹ˆå€¼æˆ–è€…è¡¨ç°å‡ºæ€æ ·çš„è¡Œä¸ºï¼Œè€Œä¸ç”¨çœŸçš„ä¾èµ–é‚£ä¸ªå¯¹è±¡çš„å†…éƒ¨å®ç°ã€‚è¿™åœ¨å•å…ƒæµ‹è¯•ä¸­éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå¸®åŠ©æˆ‘ä»¬å°†æµ‹è¯•èšç„¦äºè¢«æµ‹è¯•ä»£ç æœ¬èº«ï¼Œè€Œä¸æ˜¯å¤–éƒ¨ä¾èµ–ã€‚</p><h3 id="å‚æ•°è§£é‡Š-4" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-4"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>object</code>: è¦æ¨¡æ‹Ÿçš„å¯¹è±¡ã€‚</li><li><code>methodName</code>: æƒ³è¦æ¨¡æ‹Ÿçš„ getter åç§°ã€‚</li><li><code>[implementation]</code> (å¯é€‰): å½“å°è¯•è·å–è¿™ä¸ªå±æ€§æ—¶ï¼Œä½ æƒ³è¦è¿™ä¸ª getter æ‰§è¡Œçš„å‡½æ•°ã€‚</li><li><code>[options]</code> (å¯é€‰): é¢å¤–çš„é…ç½®é€‰é¡¹ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-8" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-8"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª<code>User</code>ç±»ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªåä¸º<code>age</code>çš„ getter å±æ€§ï¼Œè¿™ä¸ªå±æ€§ä»ç”¨æˆ·çš„å‡ºç”Ÿæ—¥æœŸè®¡ç®—å¹´é¾„ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> User</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">birthYear</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">birthYear</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> birthYear</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  get</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> age</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> currentYear</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getFullYear</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> currentYear</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">birthYear</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½éœ€è¦æµ‹è¯•æ¶‰åŠåˆ°<code>age</code>å±æ€§çš„é€»è¾‘ï¼Œä½†ä½ å¹¶ä¸æƒ³å› ä¸ºå½“å‰å¹´ä»½å˜åŒ–è€Œå½±å“æµ‹è¯•ç»“æœã€‚ä½¿ç”¨<code>mock.getter</code>æ¥æ¨¡æ‹Ÿ<code>age</code>å±æ€§å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªUserå®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> User</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1990</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨mock.getteræ¨¡æ‹Ÿuserå¯¹è±¡çš„ageå±æ€§</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getter</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">user</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;age&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 30</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨æ— è®ºå½“å‰å¹´ä»½æ˜¯å¤šå°‘ï¼Œuser.ageéƒ½ä¼šè¿”å›30</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">user</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">age</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ç›´æ¥ä¾èµ–äº<code>User</code>ç±»ä¸­<code>age</code> getter çš„å®é™…å®ç°ã€‚ç›¸åï¼Œæˆ‘ä»¬é€šè¿‡<code>mock.getter</code>æ¨¡æ‹Ÿäº†<code>age</code>å±æ€§ï¼Œä½¿å…¶æ€»æ˜¯è¿”å› 30ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸è€ƒè™‘å¤–éƒ¨å› ç´ ï¼ˆä¾‹å¦‚å½“å‰å¹´ä»½ï¼‰çš„æƒ…å†µä¸‹æµ‹è¯•ä¸ç”¨æˆ·å¹´é¾„ç›¸å…³çš„é€»è¾‘äº†ã€‚</p><p>ä½¿ç”¨<code>mock.getter</code>çš„å¥½å¤„åœ¨äºï¼Œå®ƒä½¿å¾—æµ‹è¯•æ›´åŠ ç¨³å®šå’Œå¯é¢„æµ‹ï¼Œå› ä¸ºä½ å®Œå…¨æ§åˆ¶äº†æµ‹è¯•ç¯å¢ƒä¸­çš„æ¡ä»¶ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜æé«˜äº†æµ‹è¯•çš„é€Ÿåº¦ï¼Œå› ä¸ºä¸éœ€è¦æ‰§è¡Œå®é™…çš„ getter é€»è¾‘ï¼Œç‰¹åˆ«æ˜¯å½“è¿™äº›é€»è¾‘åŒ…å«è€—æ—¶çš„æ“ä½œï¼ˆå¦‚æ•°æ®åº“æŸ¥è¯¢ï¼‰æ—¶ã€‚</p><h3 id="mock-method-object-methodname-implementation-options" tabindex="-1"><a class="header-anchor" href="#mock-method-object-methodname-implementation-options"><span><a href="https://nodejs.org/docs/latest/api/test.html#mockmethodobject-methodname-implementation-options" target="_blank" rel="noopener noreferrer">mock.method(object, methodName[, implementation][, options])</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„å¹³å°ï¼Œå®ƒå…è®¸ä½ ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚åœ¨ Node.js çš„å„ä¸ªç‰ˆæœ¬ä¸­ï¼Œæä¾›äº†å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½å’Œæ–¹æ³•æ¥å¸®åŠ©å¼€å‘è€…æ›´é«˜æ•ˆåœ°ç¼–å†™ä»£ç ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¼šèŠèŠ Node.js v21.7.1 ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªç‰¹å®šåŠŸèƒ½ï¼š<code>mock.method(object, methodName[, implementation][, options])</code>ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-mocking-2" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-mocking-2"><span>ä»€ä¹ˆæ˜¯ Mockingï¼Ÿ</span></a></h3><p>åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œ&quot;mocking&quot;æ˜¯ä¸€ç§æ¨¡æ‹ŸæŸäº›è¡Œä¸ºæˆ–å“åº”çš„æŠ€æœ¯ï¼Œç‰¹åˆ«æ˜¯åœ¨å•å…ƒæµ‹è¯•ä¸­éå¸¸æœ‰ç”¨ã€‚é€šè¿‡ mockingï¼Œä½ å¯ä»¥æ¨¡æ‹Ÿå¤–éƒ¨ç³»ç»Ÿçš„è¡Œä¸ºï¼ˆæ¯”å¦‚æ•°æ®åº“è°ƒç”¨ã€ç½‘ç»œè¯·æ±‚ç­‰ï¼‰ï¼Œä»è€Œä½¿å¾—æµ‹è¯•ä¸ä¾èµ–äºå¤–éƒ¨ç¯å¢ƒã€‚è¿™æ ·å¯ä»¥ç¡®ä¿æµ‹è¯•çš„é‡å¤æ€§å’Œå¯é æ€§ï¼Œå¹¶ä¸”å¯ä»¥æµ‹è¯•é‚£äº›éš¾ä»¥è§¦å‘çš„é”™è¯¯æƒ…å†µã€‚</p><h3 id="mock-method-å‡½æ•°" tabindex="-1"><a class="header-anchor" href="#mock-method-å‡½æ•°"><span>mock.method å‡½æ•°</span></a></h3><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>mock.method</code>å‡½æ•°æ­£æ˜¯ç”¨äºåˆ›å»º mock æ–¹æ³•çš„å·¥å…·ã€‚å…¶åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">method</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">methodName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, [</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">implementation</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], [</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><strong>object</strong>: è¦åœ¨å…¶ä¸Šåˆ›å»º mock æ–¹æ³•çš„å¯¹è±¡ã€‚</li><li><strong>methodName</strong>: æƒ³è¦ mock çš„æ–¹æ³•åç§°ã€‚</li><li><strong>implementation</strong> (å¯é€‰): ä¸€ä¸ªå‡½æ•°ï¼Œå°†ä½œä¸º methodName æŒ‡å®šçš„æ–¹æ³•çš„æ–°å®ç°ã€‚</li><li><strong>options</strong> (å¯é€‰): ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œå¯ä»¥è¿›ä¸€æ­¥å®šåˆ¶ mock è¡Œä¸ºã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-3"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç®€å•çš„åº”ç”¨ï¼Œè¿™ä¸ªåº”ç”¨éœ€è¦å‘ç¬¬ä¸‰æ–¹æœåŠ¡å‘é€ HTTP è¯·æ±‚ã€‚é€šå¸¸ï¼Œä½ ä¼šåœ¨ä»£ç ä¸­ä½¿ç”¨ä¸€ä¸ª <code>httpClient</code> å¯¹è±¡æ¥å‘é€è¿™äº›è¯·æ±‚ï¼Œä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> httpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https://api.example.com/data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æµ‹è¯•è¿™æ®µä»£ç æ—¶ï¼Œä½ ä¸å¸Œæœ›çœŸçš„å‘é€ HTTP è¯·æ±‚ï¼Œå› ä¸ºè¿™å°†ä½¿æµ‹è¯•å˜æ…¢ï¼Œè€Œä¸”ç»“æœå¯èƒ½ä¸ç¨³å®šï¼ˆç¬¬ä¸‰æ–¹æœåŠ¡å¯èƒ½æš‚æ—¶ä¸å¯ç”¨ï¼‰ã€‚è¿™æ—¶ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨ <code>mock.method</code> æ¥æ¨¡æ‹Ÿ <code>httpClient.get</code> æ–¹æ³•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> mock</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test/mock&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ¨¡æ‹Ÿçš„å“åº”æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> mockData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;value&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ mock.method æ¨¡æ‹Ÿ httpClient.get æ–¹æ³•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">method</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">httpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;get&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">mockData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨ï¼Œå½“ fetchData è¢«è°ƒç”¨æ—¶ï¼Œå®ƒä¼šä½¿ç”¨æ¨¡æ‹Ÿçš„ httpClient.getï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¸ä¼šå‘é€çœŸå®çš„ HTTP è¯·æ±‚ï¼Œè€Œæ˜¯ç›´æ¥è¿”å› mockDataã€‚</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: { key: &#39;value&#39; }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ é¦–å…ˆå¯¼å…¥äº† <code>mock</code> æ¨¡å—ã€‚ç„¶åï¼Œä½ åˆ›å»ºäº†ä¸€ä¸ªæ¨¡æ‹Ÿæ•°æ® <code>mockData</code>ã€‚æ¥ç€ï¼Œä½ ä½¿ç”¨ <code>mock.method</code> æ¥æ›¿æ¢ <code>httpClient.get</code> æ–¹æ³•çš„å®ç°ï¼Œä½¿å…¶ç›´æ¥è¿”å›ä¸€ä¸ªè§£æä¸º <code>mockData</code> çš„ promiseã€‚æœ€åï¼Œå½“ä½ è°ƒç”¨ <code>fetchData</code> æ–¹æ³•æ—¶ï¼Œå®ƒä¼šé€šè¿‡æ¨¡æ‹Ÿçš„ <code>httpClient.get</code> æ–¹æ³•è¿”å›æ¨¡æ‹Ÿæ•°æ®ï¼Œè€Œä¸ä¼šè¿›è¡ŒçœŸå®çš„ç½‘ç»œè¯·æ±‚ã€‚</p><p>è¿™ç§æ–¹å¼ä½¿å¾—ä½ èƒ½å¤Ÿåœ¨ä¸ä¾èµ–å¤–éƒ¨æœåŠ¡çš„æƒ…å†µä¸‹ï¼Œå¯¹ä½ çš„ä»£ç è¿›è¡Œæœ‰æ•ˆçš„æµ‹è¯•ï¼Œä¿è¯äº†æµ‹è¯•çš„å¿«é€Ÿå’Œç¨³å®šæ€§ã€‚</p><h3 id="mock-reset" tabindex="-1"><a class="header-anchor" href="#mock-reset"><span><a href="https://nodejs.org/docs/latest/api/test.html#mockreset" target="_blank" rel="noopener noreferrer">mock.reset()</a></span></a></h3><p>Node.js v21.7.1 å¼•å…¥äº†è®¸å¤šæµ‹è¯•å’Œæ¨¡æ‹ŸåŠŸèƒ½ï¼Œä½¿å¾—ç¼–å†™å’Œæµ‹è¯•ä»£ç å˜å¾—æ›´åŠ æ–¹ä¾¿ã€‚ä¸€ä¸ªç‰¹åˆ«æœ‰ç”¨çš„åŠŸèƒ½æ˜¯<code>mock.reset()</code>ï¼Œè¿™åœ¨å•å…ƒæµ‹è¯•ä¸­éå¸¸å…³é”®ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æ¥ææ¸…æ¥šå‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p><h3 id="å•å…ƒæµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#å•å…ƒæµ‹è¯•"><span>å•å…ƒæµ‹è¯•</span></a></h3><p>å•å…ƒæµ‹è¯•æ˜¯æŒ‡å¯¹è½¯ä»¶åº”ç”¨ç¨‹åºä¸­æœ€å°å¯æµ‹è¯•éƒ¨åˆ†ï¼ˆé€šå¸¸æ˜¯å‡½æ•°æˆ–æ–¹æ³•ï¼‰è¿›è¡Œæ£€æŸ¥å’ŒéªŒè¯ä»¥ç¡®ä¿å®ƒä»¬æŒ‰é¢„æœŸå·¥ä½œã€‚</p><h3 id="mocking-1" tabindex="-1"><a class="header-anchor" href="#mocking-1"><span>Mocking</span></a></h3><p>åœ¨å•å…ƒæµ‹è¯•ä¸­ï¼Œ&quot;mocking&quot; æ˜¯ä¸€ç§æ¨¡æ‹ŸæŸäº›ç»„ä»¶æˆ–æ¨¡å—è¡Œä¸ºçš„æŠ€æœ¯ï¼Œä»¥ä¾¿åœ¨ä¸æ¶‰åŠå…¶ä¾èµ–é¡¹çš„æƒ…å†µä¸‹æµ‹è¯•å‡½æ•°æˆ–æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªå‘é€ç½‘ç»œè¯·æ±‚çš„å‡½æ•°ï¼Œå½“æµ‹è¯•è¿™ä¸ªå‡½æ•°æ—¶ï¼Œå¹¶ä¸çœŸçš„å‘é€ç½‘ç»œè¯·æ±‚ï¼Œè€Œæ˜¯æ¨¡æ‹Ÿï¼ˆmockï¼‰è¯·æ±‚å¹¶æä¾›é¢„è®¾çš„å“åº”ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬èšç„¦äº <code>mock.reset()</code>ã€‚</p><h3 id="mock-reset-1" tabindex="-1"><a class="header-anchor" href="#mock-reset-1"><span>mock.reset()</span></a></h3><p><code>mock.reset()</code> æ˜¯ä¸€ä¸ªç”¨äºé‡ç½®æ¨¡æ‹ŸçŠ¶æ€å’Œè°ƒç”¨çš„å‡½æ•°ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä½ ä¹‹å‰æ¨¡æ‹Ÿäº†ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­æ”¹å˜äº†å®ƒçš„è¡Œä¸ºæˆ–è®°å½•äº†å…¶è¢«è°ƒç”¨çš„æ¬¡æ•°ç­‰ä¿¡æ¯ï¼Œä½¿ç”¨ <code>mock.reset()</code> å¯ä»¥å°†è¿™ä¸ªæ¨¡æ‹Ÿå‡½æ•°é‡ç½®åˆ°åˆå§‹çŠ¶æ€ã€‚</p><h4 id="ä¸ºä»€ä¹ˆéœ€è¦-mock-reset" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆéœ€è¦-mock-reset"><span>ä¸ºä»€ä¹ˆéœ€è¦ mock.reset()ï¼Ÿ</span></a></h4><ul><li><strong>éš”ç¦»æµ‹è¯•ï¼š</strong> ç¡®ä¿æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ä»ä¸€ä¸ªå¹²å‡€çš„çŠ¶æ€å¼€å§‹ï¼Œé¿å…æµ‹è¯•é—´çš„ç›¸äº’å½±å“ã€‚</li><li><strong>é‡ç½®æ¨¡æ‹ŸçŠ¶æ€ï¼š</strong> åœ¨è¿›è¡Œä¸€ç³»åˆ—æµ‹è¯•æ—¶ï¼Œå¯èƒ½éœ€è¦åœ¨ä¸åŒçš„æµ‹è¯•ç”¨ä¾‹ä¸­ä»¥ä¸åŒçš„æ–¹å¼é…ç½®æ¨¡æ‹Ÿã€‚é‡ç½®å¯ä»¥å¸®åŠ©å»é™¤ä¹‹å‰çš„é…ç½®ã€‚</li></ul><h4 id="å®é™…è¿ç”¨ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-4"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°éœ€è¦è°ƒç”¨å¦ä¸€ä¸ªæœåŠ¡æ¥è·å–æ•°æ®ï¼ˆæ¯”å¦‚ï¼Œé€šè¿‡ HTTP è¯·æ±‚ï¼‰ã€‚åœ¨æµ‹è¯•è¿™ä¸ªå‡½æ•°æ—¶ï¼Œä½ ä¸ä¼šæƒ³è¦å®é™…å‘èµ· HTTP è¯·æ±‚ï¼Œå› æ­¤ä½ å¯ä»¥æ¨¡æ‹Ÿè¿™ä¸ª HTTP è¯·æ±‚ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä½ è¦æµ‹è¯•çš„å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> httpGet</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https://api.example.com/data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹è¯•ç”¨ä¾‹1: æ£€æŸ¥æ˜¯å¦æ­£ç¡®è°ƒç”¨äº† httpGet</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fetchData calls httpGet with correct URL&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ¨¡æ‹Ÿ httpGet</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> mock</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> jest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  httpGet</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // éªŒè¯ httpGet æ˜¯å¦è¢«æ­£ç¡®è°ƒç”¨</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  expect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toHaveBeenCalledWith</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https://api.example.com/data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // é‡ç½®æ¨¡æ‹Ÿï¼Œä¸ºä¸‹ä¸€ä¸ªæµ‹è¯•åšå‡†å¤‡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">reset</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹è¯•ç”¨ä¾‹2: æ£€æŸ¥åœ¨å‡ºç°é”™è¯¯æ—¶çš„è¡Œä¸º</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fetchData handles errors&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è®¾ç½® httpGet æ¨¡æ‹ŸæŠ›å‡ºé”™è¯¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> mock</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> jest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mockImplementation</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Network error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  httpGet</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  expect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toThrow</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Network error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å†æ¬¡é‡ç½®æ¨¡æ‹Ÿ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">reset</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>mock.reset()</code> è¢«ç”¨äºåœ¨æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ç»“æŸæ—¶é‡ç½®æ¨¡æ‹Ÿå‡½æ•°ã€‚è¿™æ ·åšæ˜¯ä¸ºäº†ç¡®ä¿ <code>httpGet</code> çš„æ¨¡æ‹Ÿåœ¨æ¯æ¬¡æµ‹è¯•æ—¶éƒ½æ˜¯ä»æœªè¢«è°ƒç”¨çš„æ¸…æ´çŠ¶æ€å¼€å§‹çš„ï¼Œä»è€Œè¾¾åˆ°éš”ç¦»æµ‹è¯•çš„ç›®çš„ã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œ<code>mock.reset()</code> æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå°¤å…¶æ˜¯åœ¨è¿›è¡Œå•å…ƒæµ‹è¯•å’Œæ¨¡æ‹Ÿå¤æ‚äº¤äº’æ—¶ã€‚é€šè¿‡é‡ç½®æ¨¡æ‹Ÿçš„çŠ¶æ€å’Œè°ƒç”¨ï¼Œå®ƒèƒ½å¸®åŠ©ç¡®ä¿ä½ çš„æµ‹è¯•æ—¢ç‹¬ç«‹åˆå¯é ã€‚</p><h3 id="mock-restoreall" tabindex="-1"><a class="header-anchor" href="#mock-restoreall"><span><a href="https://nodejs.org/docs/latest/api/test.html#mockrestoreall" target="_blank" rel="noopener noreferrer">mock.restoreAll()</a></span></a></h3><p>Node.js v21.7.1 ä¸­çš„<code>mock.restoreAll()</code>æ˜¯æµ‹è¯•ç›¸å…³çš„åŠŸèƒ½ï¼Œç‰¹åˆ«å±äº Node.js çš„å®éªŒæ€§è´¨è´¨æµ‹è¯•æ¨¡å—ã€‚è¿™æ„å‘³ç€å®ƒè¿˜åœ¨å¼€å‘å’Œè°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šæœ‰æ‰€å˜åŠ¨ã€‚å°½ç®¡å¦‚æ­¤ï¼Œç†è§£å®ƒçš„ç°æœ‰åŠŸèƒ½å¯¹äºç¼–å†™å¯ç»´æŠ¤å’Œå¥å£®çš„å•å…ƒæµ‹è¯•éå¸¸é‡è¦ã€‚</p><h3 id="ç†è§£-mocking" tabindex="-1"><a class="header-anchor" href="#ç†è§£-mocking"><span>ç†è§£ Mocking</span></a></h3><p>åœ¨æ·±å…¥<code>mock.restoreAll()</code>ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆäº†è§£ä»€ä¹ˆæ˜¯ Mockingã€‚åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼ŒMocking æ˜¯ä¸€ç§æ¨¡æ‹Ÿå¤æ‚å®é™…å¯¹è±¡è¡Œä¸ºçš„æ–¹æ³•ï¼Œç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªè™šå‡çš„ï¼ˆmockï¼‰ç‰ˆæœ¬æ¥æµ‹è¯•å„ç§åœºæ™¯è€Œä¸éœ€è¦ä¾èµ–çœŸå®å®ç°ã€‚è¿™åœ¨å¤„ç†æ•°æ®åº“è°ƒç”¨ã€ç½‘ç»œè¯·æ±‚ç­‰è€—æ—¶æ“ä½œæ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚</p><h3 id="mock-restoreall-1" tabindex="-1"><a class="header-anchor" href="#mock-restoreall-1"><span>mock.restoreAll()</span></a></h3><p><code>mock.restoreAll()</code>æ˜¯ä¸€ä¸ªç”¨äºæ¢å¤æ‰€æœ‰é€šè¿‡ Node.js æµ‹è¯•æ¨¡å— mock è¿‡çš„ç³»ç»Ÿæ“ä½œçš„å‡½æ•°ã€‚ç®€å•æ¥è¯´ï¼Œå½“ä½ åœ¨æµ‹è¯•ä¸­æ›¿æ¢æˆ–è€…â€œmock æ‰â€äº†æŸäº›ç³»ç»Ÿçº§åŠŸèƒ½åï¼Œ<code>mock.restoreAll()</code>å…è®¸ä½ ä¸€æ¬¡æ€§å°†å®ƒä»¬å…¨éƒ¨æ¢å¤åˆ°åŸå§‹çŠ¶æ€ï¼Œè¿™æ ·å¯ä»¥ä¿è¯æ¯ä¸ªæµ‹è¯•è¿è¡Œç»“æŸåç¯å¢ƒå¹²å‡€ã€æ— å‰¯ä½œç”¨ã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯å’Œç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯å’Œç¤ºä¾‹"><span>ä½¿ç”¨åœºæ™¯å’Œç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œå…¶ä¸­åŒ…å«è¯»å†™æ–‡ä»¶å’Œè®¿é—®ç½‘ç»œçš„æ“ä½œã€‚åœ¨è¿›è¡Œå•å…ƒæµ‹è¯•æ—¶ï¼Œä½ å¯èƒ½ä¸æƒ³çœŸçš„å»è§¦ç¢°æ–‡ä»¶ç³»ç»Ÿæˆ–çœŸçš„å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œå› ä¸ºè¿™æ ·åšå¯èƒ½å¯¼è‡´æµ‹è¯•ç¼“æ…¢ä¸”ä¾èµ–å¤–éƒ¨æ¡ä»¶ã€‚è¿™æ—¶ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨ Mocking æ¥æ¨¡æ‹Ÿè¿™äº›æ“ä½œã€‚</p><p><strong>ç¤ºä¾‹ 1: æ¨¡æ‹Ÿæ–‡ä»¶æ“ä½œ</strong></p><p>è€ƒè™‘ä»¥ä¸‹ä»£ç ç‰‡æ®µï¼Œä½ å¯èƒ½æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒè¯»å–ä¸€ä¸ªé…ç½®æ–‡ä»¶çš„å†…å®¹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">filePath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">filePath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æµ‹è¯•è¿™ä¸ªå‡½æ•°æ—¶ï¼Œä½ ä¸æƒ³ä¾èµ–å®é™…çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå› æ­¤å¯ä»¥ mock æ‰<code>fs.readFileSync</code>æ–¹æ³•ã€‚ç„¶åï¼Œåœ¨æµ‹è¯•ç»“æŸæ—¶ï¼Œä½¿ç”¨<code>mock.restoreAll()</code>æ¥æ¢å¤åŸçŠ¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> mock</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test/mock&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Mock fs.readFileSync</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mockImplementation</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;readFileSync&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;mock content&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹è¯•getConfigå‡½æ•°...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¢å¤fs.readFileSync</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">restoreAll</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç¤ºä¾‹ 2: æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚</strong></p><p>å¦‚æœä½ çš„ä»£ç ä¸­æœ‰è¿›è¡Œ HTTP è¯·æ±‚çš„éƒ¨åˆ†ï¼Œä½ åŒæ ·å¯ä»¥ mock æ‰è¿™éƒ¨åˆ†ï¼Œä»¥é¿å…åœ¨æµ‹è¯•ä¸­è¿›è¡ŒçœŸå®çš„ç½‘ç»œé€šä¿¡ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒåšäº†HTTPè¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  http</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">resp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // A chunk of data has been received.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    resp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // The whole response has been received.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    resp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">      callback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨æµ‹è¯•ä¸­ï¼Œä½ å¯ä»¥mock http.get</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mockImplementation</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">http</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;get&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ¨¡æ‹Ÿå“åº”...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹è¯•fetchDataå‡½æ•°...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¢å¤http.get</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">restoreAll</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä½¿ç”¨<code>mock.restoreAll()</code>ï¼Œç¡®ä¿äº†æ¯ä¸ªæµ‹è¯•ä¹‹é—´çš„éš”ç¦»æ€§ï¼Œä½¿å¾—æµ‹è¯•æ›´åŠ å¯é ã€æ˜“äºç®¡ç†ã€‚è®°ä½ï¼Œç”±äº Node.js çš„æµ‹è¯•æ¨¡å—æ˜¯å®éªŒæ€§çš„ï¼Œæ¥å£å’Œè¡Œä¸ºåœ¨å°†æ¥ç‰ˆæœ¬ä¸­å¯èƒ½ä¼šæœ‰å˜åŒ–ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨å‰è¯·åŠ¡å¿…æŸ¥é˜…æœ€æ–°çš„ Node.js æ–‡æ¡£ã€‚</p><h3 id="mock-setter-object-methodname-implementation-options" tabindex="-1"><a class="header-anchor" href="#mock-setter-object-methodname-implementation-options"><span><a href="https://nodejs.org/docs/latest/api/test.html#mocksetterobject-methodname-implementation-options" target="_blank" rel="noopener noreferrer">mock.setter(object, methodName[, implementation][, options])</a></span></a></h3><p>Node.js v21.7.1 ä¸­çš„<code>mock.setter(object, methodName[, implementation][, options])</code>æ˜¯åœ¨ Node.js çš„æµ‹è¯•æ¨¡å—ä¸­ä¸€ä¸ªéå¸¸å®ç”¨çš„åŠŸèƒ½ï¼Œå°¤å…¶åœ¨å•å…ƒæµ‹è¯•æ—¶ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ æ¨¡æ‹Ÿï¼ˆæˆ–ç§°â€œä¼ªé€ â€ï¼‰ä¸€ä¸ªå¯¹è±¡çš„ setter æ–¹æ³•ã€‚å…ˆæ¥è§£é‡Šä¸€ä¸‹å‡ ä¸ªå…³é”®è¯ï¼š</p><ul><li><strong>å¯¹è±¡ï¼ˆobjectï¼‰</strong>ï¼šåœ¨ç¼–ç¨‹ä¸­ï¼Œå¯¹è±¡æ˜¯åŒ…å«å±æ€§å’Œæ–¹æ³•çš„æ•°æ®ç»“æ„ã€‚å±æ€§å­˜å‚¨æ•°æ®ï¼Œæ–¹æ³•å¯ä»¥æ‰§è¡Œæ“ä½œã€‚</li><li><strong>æ–¹æ³•ï¼ˆmethodNameï¼‰</strong>ï¼šæ–¹æ³•æ˜¯å¯¹è±¡èƒ½å¤Ÿæ‰§è¡Œçš„åŠ¨ä½œæˆ–è¡Œä¸ºï¼Œé€šå¸¸è¡¨ç°ä¸ºå‡½æ•°ã€‚</li><li><strong>å®ç°ï¼ˆimplementationï¼‰</strong>ï¼šåœ¨è¿™é‡Œï¼ŒæŒ‡çš„æ˜¯å½“ä½ è°ƒç”¨æ¨¡æ‹Ÿçš„ setter æ–¹æ³•æ—¶ï¼Œä½ æœŸæœ›å®ƒæ‰§è¡Œä»€ä¹ˆæ ·çš„ä»£ç ã€‚</li></ul><p>ä½¿ç”¨<code>mock.setter()</code>å¯ä»¥è®©ä½ å®šä¹‰å½“æŸä¸ªå¯¹è±¡çš„å±æ€§è¢«è®¾ç½®æ—¶åº”è¯¥å‘ç”Ÿä»€ä¹ˆï¼Œè€Œä¸æ˜¯è®©å®ƒè¿›è¡ŒåŸæœ‰çš„å¤„ç†ã€‚è¿™å¯¹äºæ§åˆ¶å¤–éƒ¨ä¾èµ–å¹¶ç¡®ä¿ä½ çš„æµ‹è¯•åªä¸“æ³¨äºå½“å‰æ­£åœ¨æµ‹è¯•çš„ä»£ç éå¸¸æœ‰ç”¨ã€‚</p><h3 id="å‚æ•°è¯´æ˜-2" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯´æ˜-2"><span>å‚æ•°è¯´æ˜ï¼š</span></a></h3><ul><li><strong>object</strong>: è¦æ¨¡æ‹Ÿçš„å¯¹è±¡ã€‚</li><li><strong>methodName</strong>: å¯¹è±¡çš„å±æ€§åç§°ï¼Œä½ å¸Œæœ›æ¨¡æ‹Ÿå…¶ setterã€‚</li><li><strong>implementation (å¯é€‰)</strong>: å½“å±æ€§è¢«è®¾ç½®æ—¶ï¼Œä½ å¸Œæœ›æ‰§è¡Œçš„è‡ªå®šä¹‰é€»è¾‘ã€‚</li><li><strong>options (å¯é€‰)</strong>: é¢å¤–çš„é…ç½®é€‰é¡¹ï¼Œæ¯”å¦‚æ˜¯å¦åº”è¯¥è¦†ç›–å·²æœ‰çš„ setterã€‚</li></ul><h3 id="ä½¿ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­"><span>ä½¿ç”¨ä¾‹å­ï¼š</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ª<code>User</code>ç±»ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ª<code>name</code>å±æ€§ï¼Œå¹¶ä¸”ä½ æƒ³è¦åœ¨æµ‹è¯•ä¸­æ§åˆ¶å½“<code>name</code>å±æ€§è¢«æ”¹å˜æ—¶çš„è¡Œä¸ºã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> User</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  get</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">_name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  set</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> User</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;John&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>mock.setter()</code>æ¥æ¨¡æ‹Ÿ<code>name</code>å±æ€§çš„ setter æ–¹æ³•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> test</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">strict</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;name setter&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ¨¡æ‹ŸUserå¯¹è±¡çš„nameå±æ€§çš„setteræ–¹æ³•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setter</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">user</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `Mocked </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">value</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  user</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Doe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®é™…ä¸Šä¼šè°ƒç”¨åˆ°æˆ‘ä»¬çš„æ¨¡æ‹Ÿå®ç°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // éªŒè¯é€šè¿‡æ¨¡æ‹Ÿçš„setteræ–¹æ³•ï¼Œnameå±æ€§çš„å€¼æ˜¯å¦è¢«æ­£ç¡®è®¾ç½®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">user</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Mocked Doe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè™½ç„¶æˆ‘ä»¬å°è¯•å°†<code>user.name</code>è®¾ç½®ä¸º<code>Doe</code>ï¼Œä½†ç”±äºæˆ‘ä»¬æ¨¡æ‹Ÿäº†<code>name</code>å±æ€§çš„ setter æ–¹æ³•ï¼Œä½¿å¾—æ¯æ¬¡å°è¯•è®¾ç½®<code>name</code>å±æ€§æ—¶ï¼Œå®é™…ä¸Šè®¾ç½®çš„å€¼å˜æˆäº†<code>Mocked Doe</code>ã€‚è¿™ä¸ªåŠŸèƒ½åœ¨ä½ æƒ³è¦æµ‹è¯• setter æ–¹æ³•æ—¶å“åº”çš„è¡Œä¸ºï¼Œæˆ–è€…å½“ä½ éœ€è¦åœ¨ setter è§¦å‘æ—¶æ‰§è¡Œé¢å¤–é€»è¾‘ï¼Œä½†åˆä¸æƒ³æ”¹å˜åŸæœ‰ç±»çš„å®ç°æ—¶éå¸¸æœ‰ç”¨ã€‚</p><p>é€šè¿‡ä½¿ç”¨<code>mock.setter()</code>ï¼Œä½ å¯ä»¥åœ¨ä¸å½±å“åŸæœ‰é€»è¾‘çš„æƒ…å†µä¸‹ï¼Œæœ‰æ•ˆåœ°å¯¹ setter æ–¹æ³•è¿›è¡Œæµ‹è¯•å’Œè°ƒè¯•ï¼Œä½¿å•å…ƒæµ‹è¯•æ›´åŠ çµæ´»å’Œå¼ºå¤§ã€‚</p><h2 id="class-mocktimers" tabindex="-1"><a class="header-anchor" href="#class-mocktimers"><span><a href="https://nodejs.org/docs/latest/api/test.html#class-mocktimers" target="_blank" rel="noopener noreferrer">Class: MockTimers</a></span></a></h2><p>Node.js ä¸­çš„ <code>MockTimers</code> ç±»æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œç”¨äºåœ¨ç¼–å†™æµ‹è¯•æ—¶æ§åˆ¶å’Œæ¨¡æ‹Ÿæ—¶é—´ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€æ¬¾åº”ç”¨ï¼Œå…¶ä¸­æœ‰äº›æ“ä½œä¾èµ–äºæ—¶é—´ï¼ˆæ¯”å¦‚ï¼Œç­‰å¾…å‡ ç§’åå‘é€ä¸€æ¡æ¶ˆæ¯ã€å®šæœŸæ‰§è¡Œä»»åŠ¡ç­‰ï¼‰ã€‚åœ¨æµ‹è¯•è¿™ç±»åŠŸèƒ½æ—¶ï¼ŒçœŸå®åœ°ç­‰å¾…æ—¶é—´æµé€æ—¢ä¸é«˜æ•ˆä¹Ÿä¸å®é™…ã€‚è¿™æ—¶å€™ï¼Œ<code>MockTimers</code> å°±æ´¾ä¸Šç”¨åœºäº†ã€‚å®ƒå…è®¸ä½ â€œå‡è£…â€æ—¶é—´å·²ç»è¿‡å»ï¼Œè€Œæ— éœ€å®é™…ç­‰å¾…ï¼Œä½¿å¾—æµ‹è¯•é€Ÿåº¦æ›´å¿«ã€æ›´å¯æ§ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-mocktimers" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-mocktimers"><span>å¦‚ä½•ä½¿ç”¨ MockTimersï¼Ÿ</span></a></h3><ol><li><p><strong>åˆ›å»º MockTimers å®ä¾‹</strong>ï¼šé¦–å…ˆï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ª <code>MockTimers</code> çš„å®ä¾‹ã€‚è¿™ä¸ªå®ä¾‹å°†è´Ÿè´£ç®¡ç†æ‰€æœ‰çš„æ—¶é—´æ¨¡æ‹Ÿã€‚</p></li><li><p><strong>æ§åˆ¶æ—¶é—´</strong>ï¼šé€šè¿‡è¯¥å®ä¾‹ï¼Œä½ å¯ä»¥è·³è¿‡ç‰¹å®šçš„æ—¶é—´æ®µï¼ˆä¾‹å¦‚ï¼Œå¿«è¿› 10 ç§’ï¼‰ï¼Œæˆ–è€…æŒ‡å®šæŸä¸ªæ—¶é—´ç‚¹åº”è¯¥ç«‹å³è§¦å‘çš„å®šæ—¶å™¨ã€‚</p></li><li><p><strong>æ£€æŸ¥ç»“æœ</strong>ï¼šä¹‹åï¼Œä½ å¯ä»¥æ£€æŸ¥ç”±äºæ—¶é—´å˜åŒ–è€Œåº”è¯¥å‘ç”Ÿçš„äº‹ä»¶æ˜¯å¦ç¡®å®å‘ç”Ÿäº†ã€‚</p></li></ol><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-4"><span>å®é™…è¿ç”¨ç¤ºä¾‹ï¼š</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªåšå®¢ç³»ç»Ÿï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªåŠŸèƒ½æ˜¯ç”¨æˆ·å‘å¸ƒæ–‡ç« åï¼Œå¦‚æœåœ¨ 48 å°æ—¶å†…æ²¡æœ‰äººè¯„è®ºï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å‘é€ä¸€å°æé†’é‚®ä»¶ç»™ä½œè€…ã€‚</p><h4 id="ä¸ä½¿ç”¨-mocktimers-çš„æƒ…å†µ" tabindex="-1"><a class="header-anchor" href="#ä¸ä½¿ç”¨-mocktimers-çš„æƒ…å†µ"><span>ä¸ä½¿ç”¨ MockTimers çš„æƒ…å†µï¼š</span></a></h4><p>ç¼–å†™æµ‹è¯•è¿™ä¸ªåŠŸèƒ½æ—¶ï¼Œä½ å¯èƒ½éœ€è¦çœŸå®åœ°ç­‰å¾… 48 å°æ—¶æ¥æŸ¥çœ‹æ˜¯å¦çœŸçš„å‘é€äº†æé†’é‚®ä»¶ã€‚æ˜¾ç„¶ï¼Œè¿™æ˜¯ä¸ç°å®çš„ã€‚</p><h4 id="ä½¿ç”¨-mocktimers-çš„æƒ…å†µ" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-mocktimers-çš„æƒ…å†µ"><span>ä½¿ç”¨ MockTimers çš„æƒ…å†µï¼š</span></a></h4><ol><li><p><strong>è®¾ç½®æµ‹è¯•ç¯å¢ƒ</strong>ï¼šåœ¨æµ‹è¯•è„šæœ¬å¼€å§‹æ—¶ï¼Œåˆ›å»ºä¸€ä¸ª <code>MockTimers</code> å®ä¾‹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">MockTimers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> mockTimers</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> MockTimers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åç»­çš„æµ‹è¯•ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ¨¡æ‹Ÿæ—¶é—´æµé€</strong>ï¼šå‘å¸ƒæ–‡ç« åï¼Œä½¿ç”¨ <code>MockTimers</code> å®ä¾‹è®©æ—¶é—´â€œå¿«è¿›â€48 å°æ—¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mockTimers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">advanceBy</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">48</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 60</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 60</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¿«è¿›48å°æ—¶</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><strong>éªŒè¯ç»“æœ</strong>ï¼šæ£€æŸ¥æ˜¯å¦å‘é€äº†æé†’é‚®ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ checkReminderMailSent æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥æ£€éªŒæ˜¯å¦å‘é€äº†é‚®ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> mailSent</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> checkReminderMailSent</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">mailSent</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åº”è¯¥åœ¨48å°æ—¶åå‘é€æé†’é‚®ä»¶&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>è¿™æ ·ï¼Œä½ å°±èƒ½åœ¨å‡ æ¯«ç§’å†…å®ŒæˆåŸæœ¬éœ€è¦ç­‰å¾… 48 å°æ—¶çš„æµ‹è¯•ï¼Œæå¤§åœ°æé«˜äº†æµ‹è¯•çš„æ•ˆç‡å’Œå¯è¡Œæ€§ã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œ<code>MockTimers</code> ç±»åœ¨ Node.js å¼€å‘ä¸­ä¸»è¦ç”¨äºæµ‹è¯•é‚£äº›æ¶‰åŠæ—¶é—´å»¶è¿Ÿå’Œå‘¨æœŸæ€§äº‹ä»¶çš„ä»£ç ï¼Œå®ƒé€šè¿‡æ¨¡æ‹Ÿæ—¶é—´æµé€ï¼Œä½¿å¾—æµ‹è¯•å˜å¾—å¿«é€Ÿä¸”å®¹æ˜“æ§åˆ¶ã€‚</p><h3 id="timers-enable-enableoptions" tabindex="-1"><a class="header-anchor" href="#timers-enable-enableoptions"><span><a href="https://nodejs.org/docs/latest/api/test.html#timersenableenableoptions" target="_blank" rel="noopener noreferrer">timers.enable([enableOptions])</a></span></a></h3><p>ç†è§£<code>timers.enable([enableOptions])</code>è¿™ä¸ªåŠŸèƒ½ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹ Node.js ä¸­è®¡æ—¶å™¨ï¼ˆtimersï¼‰çš„åŸºæœ¬æ¦‚å¿µå’Œä½œç”¨ã€‚åœ¨ Node.js ä¸­ï¼Œè®¡æ—¶å™¨å…è®¸æˆ‘ä»¬åœ¨å°†æ¥çš„æŸä¸ªæ—¶é—´ç‚¹æ‰§è¡Œä»£ç ã€‚æœ€å¸¸è§çš„è®¡æ—¶å™¨å‡½æ•°åŒ…æ‹¬<code>setTimeout()</code>ã€<code>setInterval()</code>ä»¥åŠå®ƒä»¬çš„å–æ¶ˆç‰ˆæœ¬<code>clearTimeout()</code>å’Œ<code>clearInterval()</code>ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-5" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-5"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><ul><li><code>setTimeout()</code>: åœ¨æŒ‡å®šçš„å»¶è¿Ÿä¹‹åæ‰§è¡Œå›è°ƒå‡½æ•°ä¸€æ¬¡ã€‚</li><li><code>setInterval()</code>: æŒ‰ç…§æŒ‡å®šçš„å‘¨æœŸï¼ˆé—´éš”ï¼‰é‡å¤æ‰§è¡Œå›è°ƒå‡½æ•°ã€‚</li><li><code>clearTimeout()</code> å’Œ <code>clearInterval()</code>: åˆ†åˆ«ç”¨äºå–æ¶ˆç”±<code>setTimeout()</code>å’Œ<code>setInterval()</code>è®¾ç½®çš„å»¶è¿Ÿæ‰§è¡Œæˆ–é‡å¤æ‰§è¡Œã€‚</li></ul><p>ç°åœ¨ï¼Œå…³äº<code>timers.enable([enableOptions])</code> çš„éƒ¨åˆ†ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆªè‡³æœ€åæ›´æ–°çš„ä¿¡æ¯ï¼Œè¿™ä¼¼ä¹å¹¶ä¸æ˜¯ Node.js çš„ä¸€ä¸ªæ ‡å‡† APIã€‚å› æ­¤ï¼Œç›´æ¥æŸ¥é˜… Node.js çš„å®˜æ–¹æ–‡æ¡£å¯èƒ½ä¸ä¼šæ‰¾åˆ°<code>timers.enable</code>çš„å…·ä½“ä¿¡æ¯ã€‚ä¸è¿‡ï¼Œæˆ‘å¯ä»¥æä¾›ä¸€ä¸ªåŸºäºç°æœ‰çŸ¥è¯†å’Œå‡è®¾çš„è§£é‡Šï¼Œæ—¨åœ¨å¸®åŠ©ä½ ç†è§£è¿™å¯èƒ½æ˜¯ä»€ä¹ˆä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒã€‚</p><p>ä¸€èˆ¬è€Œè¨€ï¼Œå¦‚æœ Node.js æä¾›äº†ä¸€ä¸ªåä¸º<code>timers.enable</code>çš„æ–¹æ³•ï¼Œå®ƒå¾ˆå¯èƒ½è¢«è®¾è®¡ç”¨æ¥å¯ç”¨æˆ–è€…é…ç½®æŸäº›ç‰¹å®šçš„è®¡æ—¶å™¨è¡Œä¸ºã€‚<code>enableOptions</code>å‚æ•°å¯èƒ½å…è®¸å¼€å‘è€…å®šåˆ¶è®¡æ—¶å™¨çš„è¡Œä¸ºï¼Œä¾‹å¦‚ä¿®æ”¹é»˜è®¤è®¡æ—¶å™¨ç²¾åº¦æˆ–è€…å¯ç”¨é¢å¤–çš„è°ƒè¯•ä¿¡æ¯ã€‚</p><h4 id="å‡è®¾çš„ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å‡è®¾çš„ä¾‹å­"><span>å‡è®¾çš„ä¾‹å­</span></a></h4><p>ç”±äº<code>timers.enable([enableOptions])</code> ä¸æ˜¯å®˜æ–¹æ ‡å‡† API çš„ä¸€éƒ¨åˆ†ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªå‡è®¾æ€§çš„ç¤ºä¾‹ï¼Œç”¨äºè¯´æ˜å®ƒå¯èƒ½å¦‚ä½•è¢«ä½¿ç”¨ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾Node.jsæä¾›äº†è¿™ä¸ªåŠŸèƒ½</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> timers</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;timers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯ç”¨è®¡æ—¶å™¨ï¼Œå¸¦æœ‰è‡ªå®šä¹‰é€‰é¡¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">timers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">enable</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  trace</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™ä¸ªé€‰é¡¹èƒ½è®©ç³»ç»Ÿè·Ÿè¸ªå’Œè®°å½•è®¡æ—¶å™¨çš„è°ƒç”¨ç»†èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®ä¸€ä¸ªç®€å•çš„å»¶æ—¶æ‰§è¡Œå‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¿™æ¡æ¶ˆæ¯ä¼šåœ¨1ç§’åæ‰“å°&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªå‡è®¾æ€§çš„ä¾‹å­ä¸­ï¼Œ<code>timers.enable({trace: true})</code> å¯èƒ½ä¼šå¯ç”¨è®¡æ—¶å™¨çš„è·Ÿè¸ªåŠŸèƒ½ï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥æ›´å¥½åœ°äº†è§£å’Œè°ƒè¯•è®¡æ—¶å™¨çš„è¡Œä¸ºã€‚</p><h4 id="å®é™…åº”ç”¨-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨-1"><span>å®é™…åº”ç”¨</span></a></h4><p>å¯¹äºç¼–ç¨‹æ–°æ‰‹æ¥è¯´ï¼Œç†è§£å’Œä½¿ç”¨ Node.js çš„è®¡æ—¶å™¨é€šå¸¸å¼€å§‹äºå­¦ä¹ å¦‚ä½•ä½¿ç”¨<code>setTimeout()</code>å’Œ<code>setInterval()</code>æ¥å¤„ç†å¼‚æ­¥é€»è¾‘ã€‚ä¾‹å¦‚ï¼Œåœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™åç«¯æ—¶ï¼Œä½ å¯èƒ½ä¼šä½¿ç”¨<code>setTimeout()</code>æ¥å»¶è¿Ÿå‘é€å“åº”ï¼Œä»¥æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿæˆ–å¼‚æ­¥æ“ä½œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ setTimeout æ¥æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œçš„å»¶è¿Ÿå“åº”</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ¨¡æ‹Ÿæ•°æ®è¯·æ±‚æˆåŠŸ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿™é‡Œå¯ä»¥æ‰§è¡Œä¸€äº›åç»­æ“ä½œï¼Œæ¯”å¦‚å‘é€HTTPå“åº”ç»™å®¢æˆ·ç«¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 2ç§’åæ‰§è¡Œ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>setInterval()</code>åˆ™å¯ä»¥ç”¨æ¥åˆ›å»ºé‡å¤æ‰§è¡Œçš„ä»»åŠ¡ï¼Œæ¯”å¦‚å®šæœŸæ£€æŸ¥èµ„æºçŠ¶æ€æˆ–æ›´æ–°æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ setInterval åˆ›å»ºä¸€ä¸ªæ¯3ç§’é‡å¤æ‰§è¡Œçš„ä»»åŠ¡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å®šæœŸæ£€æŸ¥é‚®ç®±æ–°é‚®ä»¶&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿™é‡Œå¯ä»¥æ·»åŠ æ£€æŸ¥é‚®ç®±æˆ–å…¶ä»–å®šæœŸä»»åŠ¡çš„é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¯3ç§’æ‰§è¡Œä¸€æ¬¡</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®é™…ç¼–ç¨‹å®è·µä¸­ï¼Œè®¡æ—¶å™¨æ˜¯å¤„ç†å¼‚æ­¥äº‹ä»¶ã€å®ç°å»¶è¿Ÿé€»è¾‘å’Œå‘¨æœŸæ€§ä»»åŠ¡çš„æœ‰æ•ˆå·¥å…·ã€‚ä½†è¦æ³¨æ„æ­£ç¡®ç®¡ç†è®¡æ—¶å™¨ï¼Œé¿å…æ— ç”¨çš„è®¡æ—¶å™¨æ¶ˆè€—èµ„æºæˆ–å¯¼è‡´å†…å­˜æ³„æ¼ã€‚</p><h3 id="timers-reset" tabindex="-1"><a class="header-anchor" href="#timers-reset"><span><a href="https://nodejs.org/docs/latest/api/test.html#timersreset" target="_blank" rel="noopener noreferrer">timers.reset()</a></span></a></h3><p>è¦ç†è§£ <code>timers.reset()</code> åœ¨ Node.js çš„ä½œç”¨ï¼Œé¦–å…ˆå¾—çŸ¥é“ Node.js é‡Œé¢çš„ timers æ˜¯åšä»€ä¹ˆçš„ã€‚ç®€å•æ¥è¯´ï¼Œåœ¨ Node.js ä¸­ï¼Œtimers æä¾›äº†ä¸€ç§æ–¹å¼ï¼Œå¯ä»¥åœ¨å°†æ¥çš„æŸä¸ªæ—¶é—´ç‚¹æ‰§è¡Œä»£ç ã€‚æ¯”å¦‚ä½ æƒ³è¦åœ¨ 3 ç§’åæ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼Œå°±å¯ä»¥ä½¿ç”¨ timer æ¥å®ç°ã€‚</p><p>ä¸è¿‡ï¼Œè¦æ³¨æ„çš„æ˜¯ï¼Œæˆªè‡³æˆ‘æœ€åçš„çŸ¥è¯†æ›´æ–°ï¼ˆ2023 å¹´ï¼‰ï¼Œ<code>timers.reset()</code> å¹¶ä¸æ˜¯ Node.js å®˜æ–¹æ–‡æ¡£ä¸­æ˜ç¡®åˆ—å‡ºçš„ APIã€‚è¿™å¯èƒ½æ„å‘³ç€è¿™ä¸ªåŠŸèƒ½æ˜¯å®éªŒæ€§çš„ï¼Œæˆ–è€…æ˜¯éæ ‡å‡†çš„ï¼Œæˆ–è€…ä½ æåˆ°çš„æ˜¯æŸç§ç‰¹å®šåœºæ™¯ä¸‹çš„ä¸€ä¸ªæ‰©å±•æˆ–å·¥å…·åº“æä¾›çš„åŠŸèƒ½ã€‚å› æ­¤ï¼Œä¸‹é¢çš„å†…å®¹å°†åŸºäºå¯¹ç±»ä¼¼åŠŸèƒ½çš„é€šç”¨è§£é‡Šå’Œå‡è®¾è¿›è¡Œè¯´æ˜ï¼Œå¹¶æä¾›å¯èƒ½çš„ä½¿ç”¨åœºæ™¯ã€‚</p><h3 id="timers-å’Œ-reset-æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#timers-å’Œ-reset-æ¦‚å¿µ"><span>timers å’Œ reset æ¦‚å¿µ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œå¸¸è§çš„ä¸æ—¶é—´ç›¸å…³çš„å‡½æ•°æœ‰ï¼š</p><ul><li><code>setTimeout(fn, delay)</code>: åœ¨æŒ‡å®šçš„å»¶è¿Ÿåæ‰§è¡Œå‡½æ•° <code>fn</code>ã€‚</li><li><code>setInterval(fn, interval)</code>: æ¯éš”æŒ‡å®šçš„é—´éš”æ—¶é—´é‡å¤æ‰§è¡Œå‡½æ•° <code>fn</code>ã€‚</li><li><code>setImmediate(fn)</code>: åœ¨å½“å‰äº‹ä»¶å¾ªç¯ç»“æŸæ—¶æ‰§è¡Œå‡½æ•° <code>fn</code>ã€‚</li></ul><p>å¦‚æœå­˜åœ¨ä¸€ä¸ª <code>reset()</code> æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒçš„ä½œç”¨å¾ˆå¯èƒ½æ˜¯é‡ç½®å®šæ—¶å™¨çš„è¡Œä¸ºã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½è®¾ç½®äº†ä¸€ä¸ªå»¶è¿Ÿæ‰§è¡Œçš„æ“ä½œï¼Œä½†åœ¨å»¶è¿Ÿæ—¶é—´åˆ°è¾¾ä¹‹å‰ï¼Œä½ çš„éœ€æ±‚æ”¹å˜äº†ï¼Œæƒ³è¦å–æ¶ˆè¿™ä¸ªæ“ä½œï¼Œæˆ–è€…æ›´æ”¹æ‰§è¡Œæ—¶é—´ã€‚è¿™æ—¶å€™ï¼Œå¦‚æœæœ‰ <code>reset()</code> æ–¹æ³•ï¼Œå°±å¯ä»¥å¸®åŠ©å®ç°è¿™ç§éœ€æ±‚ã€‚</p><h3 id="å‡æƒ³çš„ä½¿ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å‡æƒ³çš„ä½¿ç”¨ä¾‹å­"><span>å‡æƒ³çš„ä½¿ç”¨ä¾‹å­</span></a></h3><p>å› ä¸º <code>timers.reset()</code> ä¸æ˜¯ Node.js æ ‡å‡† API çš„ä¸€éƒ¨åˆ†ï¼Œä»¥ä¸‹å°†åŸºäºå¯¹ç±»ä¼¼åŠŸèƒ½çš„å‡æƒ³ä»‹ç»å¯èƒ½çš„ä½¿ç”¨åœºæ™¯ã€‚</p><h4 id="åœºæ™¯ä¸€-é‡æ–°è®¾ç½®å»¶æ—¶æ‰§è¡Œçš„æ—¶é—´" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯ä¸€-é‡æ–°è®¾ç½®å»¶æ—¶æ‰§è¡Œçš„æ—¶é—´"><span>åœºæ™¯ä¸€ï¼šé‡æ–°è®¾ç½®å»¶æ—¶æ‰§è¡Œçš„æ—¶é—´</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªéœ€è¦åœ¨ç”¨æˆ·è¾“å…¥å 5 ç§’é’Ÿå¤„ç†æ•°æ®çš„åŠŸèƒ½ï¼Œä½†å¦‚æœç”¨æˆ·åœ¨è¿™ 5 ç§’å†…åˆè¾“å…¥äº†æ–°æ•°æ®ï¼Œä½ å¸Œæœ›é‡ç½®è®¡æ—¶ï¼Œå†ç­‰å¾… 5 ç§’ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> timer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> processData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å¤„ç†æ•°æ®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> resetTimer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  clearTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  timer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">processData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é‡æ–°å¼€å§‹è®¡æ—¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¯æ¬¡ç”¨æˆ·è¾“å…¥æ—¶è°ƒç”¨ resetTimer</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resetTimer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ¯æ¬¡è°ƒç”¨ <code>resetTimer()</code> å‡½æ•°éƒ½ä¼šå–æ¶ˆä¹‹å‰çš„å®šæ—¶å™¨ï¼Œå¹¶å¯åŠ¨ä¸€ä¸ªæ–°çš„ 5 ç§’å®šæ—¶å™¨ã€‚è™½ç„¶è¿™é‡Œä½¿ç”¨çš„æ˜¯ <code>clearTimeout()</code> å’Œ <code>setTimeout()</code> è€Œä¸æ˜¯ <code>reset()</code>ï¼Œä½†åŸç†ç›¸ä¼¼ã€‚</p><h4 id="åœºæ™¯äºŒ-ä¿®æ”¹å‘¨æœŸæ‰§è¡Œä»»åŠ¡çš„é—´éš”" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯äºŒ-ä¿®æ”¹å‘¨æœŸæ‰§è¡Œä»»åŠ¡çš„é—´éš”"><span>åœºæ™¯äºŒï¼šä¿®æ”¹å‘¨æœŸæ‰§è¡Œä»»åŠ¡çš„é—´éš”</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªä»»åŠ¡æ¯ 10 åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œä½†åœ¨æŸäº›æ¡ä»¶ä¸‹ä½ å¸Œæœ›èƒ½å¤Ÿæ›´æ”¹æ‰§è¡Œçš„é¢‘ç‡ï¼Œæ¯”å¦‚æ”¹ä¸ºæ¯ 5 åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> interval</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 600000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 10åˆ†é’Ÿ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> intervalID</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">taskFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">interval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> taskFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ‰§è¡Œä»»åŠ¡&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> resetInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">newInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  clearInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">intervalID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¸…é™¤æ—§çš„å®šæ—¶å™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  interval</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> newInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®æ–°çš„é—´éš”æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  intervalID</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">taskFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">interval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼€å¯æ–°çš„å®šæ—¶å™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å½“éœ€è¦æ”¹å˜ä»»åŠ¡é¢‘ç‡æ—¶è°ƒç”¨</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resetInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">300000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ”¹ä¸ºæ¯5åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŒæ ·åœ°ï¼Œè¿™ä¸ªä¾‹å­ä½¿ç”¨äº† <code>clearInterval()</code> å’Œ <code>setInterval()</code> æ¥æ¨¡æ‹Ÿ <code>reset()</code> çš„åŠŸèƒ½ï¼Œç›®çš„æ˜¯æ¸…é™¤æ—§çš„å®šæ—¶å™¨å¹¶åŸºäºæ–°çš„é—´éš”æ—¶é—´å¯åŠ¨ä¸€ä¸ªæ–°çš„å®šæ—¶å™¨ã€‚</p><h3 id="æ€»ç»“-12" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-12"><span>æ€»ç»“</span></a></h3><p>ç”±äº <code>timers.reset()</code> åœ¨æ ‡å‡† Node.js API æ–‡æ¡£ä¸­æ²¡æœ‰ç›´æ¥å¯¹åº”çš„å‡½æ•°ï¼Œä¸Šè¿°è§£é‡Šå’Œä¾‹å­åŸºäºå¯¹ç±»ä¼¼åŠŸèƒ½çš„ä¸€èˆ¬ç†è§£ã€‚åœ¨å®é™…ç¼–ç¨‹ä¸­ï¼Œé‡è®¾å®šæ—¶å™¨é€šå¸¸æ¶‰åŠæ¸…é™¤åŸå®šæ—¶å™¨å¹¶åˆ›å»ºæ–°å®šæ—¶å™¨æ¥è¾¾åˆ°é¢„æœŸçš„æ•ˆæœã€‚å¦‚æœä½ åœ¨å…·ä½“çš„åº“æˆ–æ¡†æ¶ä¸­é‡åˆ°äº† <code>timers.reset()</code>ï¼Œå»ºè®®æŸ¥é˜…è¯¥åº“æˆ–æ¡†æ¶çš„å®˜æ–¹æ–‡æ¡£ä»¥è·å¾—å‡†ç¡®çš„ä½¿ç”¨æ–¹æ³•å’Œåœºæ™¯ã€‚</p><h3 id="timerssymbol-dispose-https-nodejs-org-docs-latest-api-test-html-timerssymboldispose" tabindex="-1"><a class="header-anchor" href="#timerssymbol-dispose-https-nodejs-org-docs-latest-api-test-html-timerssymboldispose"><span>[timers<a href="">Symbol.dispose</a>](<a href="https://nodejs.org/docs/latest/api/test.html#timerssymboldispose" target="_blank" rel="noopener noreferrer">https://nodejs.org/docs/latest/api/test.html#timerssymboldispose</a>)</span></a></h3><p>Node.js v21.7.1 å¼•å…¥çš„<code>timers[Symbol.dispose]()</code>æ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°çš„ç‰¹æ€§ï¼Œç”¨äºæ¸…ç†å’Œå–æ¶ˆå®šæ—¶å™¨ã€‚ä¸ºäº†è®©è§£é‡Šæ›´åŠ é€šä¿—æ˜“æ‡‚ï¼Œæˆ‘ä»¬å…ˆæ¥ç®€å•å›é¡¾ä¸€ä¸‹åœ¨ Node.js ä¸­å¦‚ä½•ä½¿ç”¨å®šæ—¶å™¨ï¼Œç„¶åå†ä»‹ç»è¿™ä¸ªæ–°ç‰¹æ€§åŠå…¶åº”ç”¨ã€‚</p><h3 id="èƒŒæ™¯-ä»€ä¹ˆæ˜¯å®šæ—¶å™¨" tabindex="-1"><a class="header-anchor" href="#èƒŒæ™¯-ä»€ä¹ˆæ˜¯å®šæ—¶å™¨"><span>èƒŒæ™¯ï¼šä»€ä¹ˆæ˜¯å®šæ—¶å™¨ï¼Ÿ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œå®šæ—¶å™¨å…è®¸ä½ è®¾å®šä¸€ä¸ªåŠ¨ä½œåœ¨æœªæ¥æŸä¸ªæ—¶é—´ç‚¹æ‰§è¡Œï¼Œè€Œä¸æ˜¯ç«‹å³æ‰§è¡Œã€‚è¿™åœ¨å¾ˆå¤šåœºæ™¯ä¸‹éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚ï¼š</p><ul><li>å»¶è¿Ÿæ‰§è¡Œï¼šç­‰å¾…å‡ ç§’é’Ÿåå†å‘é€ç”µå­é‚®ä»¶é€šçŸ¥ã€‚</li><li>å¾ªç¯ä»»åŠ¡ï¼šæ¯éš”ä¸€æ®µæ—¶é—´æ£€æŸ¥æ•°æ®åº“æ›´æ–°ã€‚</li></ul><p>Node.js æä¾›äº†å‡ ç§è®¾ç½®å®šæ—¶å™¨çš„æ–¹æ³•ï¼Œå¦‚<code>setTimeout</code>ç”¨äºå»¶è¿Ÿæ‰§è¡Œï¼Œ<code>setInterval</code>ç”¨äºé‡å¤æ‰§è¡Œã€‚</p><h3 id="æ–°ç‰¹æ€§-timers-symbol-dispose" tabindex="-1"><a class="header-anchor" href="#æ–°ç‰¹æ€§-timers-symbol-dispose"><span>æ–°ç‰¹æ€§ï¼š<code>timers[Symbol.dispose]()</code></span></a></h3><p>åœ¨ Node.js çš„æ—©æœŸç‰ˆæœ¬ä¸­ï¼Œä¸€æ—¦å®šæ—¶å™¨è¢«è®¾ç½®ï¼Œé™¤éå®ƒè‡ªè¡Œè§¦å‘æˆ–è€…ä½ æ‰‹åŠ¨å–æ¶ˆï¼ˆä½¿ç”¨<code>clearTimeout</code>æˆ–<code>clearInterval</code>ï¼‰ï¼Œå¦åˆ™å®ƒä¼šä¿æŒæ´»è·ƒçŠ¶æ€ã€‚è¿™åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½å¯¼è‡´èµ„æºæ³„éœ²ï¼Œæˆ–è€…ä½ éœ€è¦é¢å¤–çš„ä»£ç æ¥ç¡®ä¿å®šæ—¶å™¨åœ¨ä¸å†éœ€è¦æ—¶è¢«æ¸…ç†ã€‚</p><p><code>timers[Symbol.dispose]()</code>æä¾›äº†ä¸€ç§æ–°çš„ã€æ›´æ–¹ä¾¿çš„æ–¹å¼æ¥å–æ¶ˆå’Œæ¸…ç†å®šæ—¶å™¨ã€‚å½“ä½ è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œä¸å®ƒå…³è”çš„å®šæ—¶å™¨å°†è¢«ç›´æ¥å–æ¶ˆï¼Œæ— éœ€é¢å¤–çš„å¼•ç”¨æˆ–è°ƒç”¨<code>clearTimeout</code>/<code>clearInterval</code>ã€‚</p><h3 id="åº”ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#åº”ç”¨ç¤ºä¾‹-1"><span>åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨æ„å»ºä¸€ä¸ªåº”ç”¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥è®¾ç½®ä¸€ä¸ªå®šæ—¶æé†’ã€‚å¦‚æœç”¨æˆ·å†³å®šå–æ¶ˆæé†’ï¼Œä½ éœ€è¦ç¡®ä¿é¢„å®šçš„åŠ¨ä½œä¸ä¼šæ‰§è¡Œã€‚</p><p><strong>ä¼ ç»Ÿæ–¹å¼:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> timeoutId</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æé†’!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 10ç§’åæé†’</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">//ì´ ë¬¸ì„œëŠ” ì‰ì°¨ì˜¤ ì°¨(Ying Chao Tea)ì—ì„œ ì˜¨ ê²ƒì…ë‹ˆë‹¤. ìƒì—…ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ë§ˆì‹­ì‹œì˜¤.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”¨æˆ·å–æ¶ˆæé†’</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clearTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timeoutId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä½¿ç”¨<code>timers[Symbol.dispose]()</code>ï¼š</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> timer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æé†’!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”¨æˆ·å–æ¶ˆæé†’</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Symbol</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">dispose</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ç¬¬äºŒç§æ–¹å¼ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡<code>[Symbol.dispose]()</code>ç›´æ¥åœ¨å®šæ—¶å™¨å¯¹è±¡ä¸Šè°ƒç”¨æ–¹æ³•ï¼Œä»è€Œå–æ¶ˆå®šæ—¶å™¨ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ä»£ç æ›´ç®€æ´ï¼Œä¸”ä¸éœ€è¦é¢å¤–å­˜å‚¨å®šæ—¶å™¨çš„ IDã€‚</p><h3 id="æ€»ç»“-13" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-13"><span>æ€»ç»“</span></a></h3><p><code>timers[Symbol.dispose]()</code>æ˜¯ Node.js ä¸ºäº†ç®€åŒ–å®šæ—¶å™¨æ¸…ç†æµç¨‹è€Œå¼•å…¥çš„ç‰¹æ€§ã€‚å®ƒé€šè¿‡æä¾›ä¸€ä¸ªç›´æ¥åœ¨å®šæ—¶å™¨å¯¹è±¡ä¸Šè°ƒç”¨çš„æ–¹æ³•ï¼Œä½¿å¾—å–æ¶ˆå®šæ—¶å™¨å˜å¾—æ›´åŠ ç›´æ¥å’Œæ–¹ä¾¿ã€‚è¿™å¯¹äºéœ€è¦é«˜åº¦æ§åˆ¶å®šæ—¶å™¨ç”Ÿå‘½å‘¨æœŸçš„åº”ç”¨æ¥è¯´æ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„æ”¹è¿›ã€‚</p><h3 id="timers-tick-milliseconds" tabindex="-1"><a class="header-anchor" href="#timers-tick-milliseconds"><span><a href="https://nodejs.org/docs/latest/api/test.html#timerstickmilliseconds" target="_blank" rel="noopener noreferrer">timers.tick(milliseconds)</a></span></a></h3><p><code>timers.tick(milliseconds)</code> æ˜¯ä¸€ä¸ªç‰¹å®šäº Node.js æµ‹è¯•ç¯å¢ƒä¸­çš„åŠŸèƒ½ï¼Œå®ƒè®¾è®¡ç”¨æ¥åœ¨æµ‹è¯•æ—¶å¿«é€Ÿå‰è¿›æ—¶é—´ã€‚è¿™ä¸ªåŠŸèƒ½ä¸»è¦æ˜¯ä¸ºäº†å¸®åŠ©å¼€å‘äººå‘˜æµ‹è¯•é‚£äº›æ¶‰åŠåˆ°å»¶è¿Ÿå’Œè®¡æ—¶å™¨ï¼ˆå¦‚ <code>setTimeout</code>, <code>setInterval</code> ç­‰ï¼‰çš„ä»£ç ã€‚é€šè¿‡ä½¿ç”¨ <code>timers.tick(milliseconds)</code>, ä½ å¯ä»¥æ¨¡æ‹Ÿæ—¶é—´çš„æµé€ï¼Œè€Œä¸éœ€è¦çœŸå®åœ°ç­‰å¾…é‚£ä¹ˆé•¿çš„æ—¶é—´ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-6" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-6"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>åœ¨è½¯ä»¶æµ‹è¯•ä¸­ï¼Œç‰¹åˆ«æ˜¯å½“å¤„ç†å¼‚æ­¥æ“ä½œå¦‚æ—¶é—´å»¶è¿Ÿå’Œå‘¨æœŸæ€§æ‰§è¡Œçš„ä»»åŠ¡æ—¶ï¼Œç­‰å¾…å®é™…çš„æ—¶é—´è¿‡å»æ—¢ä¸é«˜æ•ˆä¹Ÿä¸å®é™…ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œ<code>timers.tick(milliseconds)</code> å…è®¸ä½ &quot;å¿«è¿›&quot;æ—¶é—´ï¼Œä½¿å¾—å®šæ—¶å™¨è§¦å‘ä»–ä»¬çš„å›è°ƒå‡½æ•°ï¼Œè€Œæ— éœ€å®é™…ç­‰å¾…ã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯ç¤ºä¾‹"><span>ä½¿ç”¨åœºæ™¯ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œè¯¥åº”ç”¨åŒ…å«ä¸€ä¸ªåŠŸèƒ½ï¼Œç”¨æˆ·è¿›è¡ŒæŸé¡¹æ“ä½œåï¼Œç³»ç»Ÿä¼šåœ¨ 10 ç§’é’Ÿåç»™å‡ºåé¦ˆã€‚é€šå¸¸ï¼Œæµ‹è¯•è¿™ç§åŠŸèƒ½éœ€è¦ç­‰å¾… 10 ç§’é’Ÿçœ‹ç»“æœæ˜¯å¦ç¬¦åˆé¢„æœŸã€‚ä½†ä½¿ç”¨ <code>timers.tick(milliseconds)</code>, ä½ å¯ä»¥ç«‹å³è§¦å‘è¿™ä¸ª 10 ç§’åçš„è¡Œä¸ºï¼Œä»è€Œä½¿æµ‹è¯•è¿‡ç¨‹æ›´åŠ é«˜æ•ˆã€‚</p><h4 id="ç¤ºä¾‹ä»£ç -1" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç -1"><span>ç¤ºä¾‹ä»£ç </span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹ç®€å•çš„ Node.js è„šæœ¬ï¼Œå®ƒä½¿ç”¨ <code>setTimeout()</code> åœ¨ä¸€æ®µæŒ‡å®šæ—¶é—´åæ‰“å°ä¸€æ¡æ¶ˆæ¯ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> delayedMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¿™æ¡ä¿¡æ¯ä¼šåœ¨10ç§’åæ˜¾ç¤º&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ˜¾ç¤ºå»¶è¿Ÿæ¶ˆæ¯&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 10000æ¯«ç§’åæ‰§è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">delayedMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦ç­‰å¾… 10 ç§’é’Ÿæ¥çœ‹åˆ° &quot;æ˜¾ç¤ºå»¶è¿Ÿæ¶ˆæ¯&quot; çš„è¾“å‡ºã€‚ä½†åœ¨æµ‹è¯•ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>timers.tick()</code> æ¥æ¨¡æ‹Ÿè¿™ä¸ªè¿‡ç¨‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> timers</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;timers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä½ çš„æµ‹è¯•è„šæœ¬</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> testDelayedMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  delayedMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è°ƒç”¨ä¸Šé¢å®šä¹‰çš„å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  timers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">tick</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// â€œå¿«è¿›â€10ç§’é’Ÿ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ­¤å¤„å¯ä»¥æ·»åŠ æ–­è¨€æ¥éªŒè¯â€œæ˜¾ç¤ºå»¶è¿Ÿæ¶ˆæ¯â€æ˜¯å¦è¢«æ­£ç¡®æ‰“å°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">testDelayedMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ³¨æ„äº‹é¡¹-1" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-1"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>è¿™ä¸ª API ä¸»è¦ç”¨äºæµ‹è¯•ç›®çš„ï¼Œåœ¨å®é™…çš„ç”Ÿäº§ç¯å¢ƒä»£ç ä¸­åº”é¿å…ä½¿ç”¨ã€‚</li><li>ä½¿ç”¨æ­¤åŠŸèƒ½éœ€è¦ç¡®ä¿æµ‹è¯•ç¯å¢ƒå·²ç»é…ç½®äº†ç›¸åº”çš„ Node.js ç‰ˆæœ¬ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°çš„åŠŸèƒ½ã€‚</li><li>å®ƒå¯ä»¥æå¤§åœ°æé«˜æµ‹è¯•æ•ˆç‡ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤æ‚çš„å®šæ—¶å’Œå»¶è¿Ÿé€»è¾‘æ—¶ã€‚</li></ul><p>æ€»çš„æ¥è¯´ï¼Œ<code>timers.tick(milliseconds)</code> æä¾›äº†ä¸€ç§é«˜æ•ˆçš„æ–¹å¼æ¥æµ‹è¯•é‚£äº›ä¾èµ–æ—¶é—´å»¶è¿Ÿçš„ä»£ç ï¼Œé€šè¿‡æ¨¡æ‹Ÿæ—¶é—´çš„æµé€ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿå¿«é€Ÿæ‰§è¡Œå’ŒéªŒè¯å¼‚æ­¥é€»è¾‘ã€‚</p><h4 id="using-clear-functions" tabindex="-1"><a class="header-anchor" href="#using-clear-functions"><span><a href="https://nodejs.org/docs/latest/api/test.html#using-clear-functions" target="_blank" rel="noopener noreferrer">Using clear functions</a></span></a></h4><p>Node.js çš„æ–‡æ¡£å¯¹äºåˆå­¦è€…æ¥è¯´å¯èƒ½æ˜¾å¾—æœ‰äº›å¤æ‚ï¼Œä½†æˆ‘ä¼šå°½åŠ›ä»¥æœ€é€šä¿—æ˜“æ‡‚çš„æ–¹å¼è§£é‡Šç»™ä½ ã€‚</p><p>æˆªè‡³æˆ‘çš„çŸ¥è¯†æ›´æ–°æ—¥æœŸï¼ˆ2023 å¹´ï¼‰ï¼Œåœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œå¹¶æ²¡æœ‰ç›´æ¥æåˆ°ä¸€ä¸ªåä¸ºâ€œUsing clear functionsâ€çš„éƒ¨åˆ†ã€‚è¿™å¯èƒ½æ˜¯ç”±äºç‰ˆæœ¬æ›´æ–°æˆ–è€…æ˜¯ç†è§£ä¸Šçš„è¯¯å·®ã€‚ä¸è¿‡ï¼Œæ ¹æ®ä½ çš„é—®é¢˜ï¼Œæˆ‘çŒœæµ‹ä½ å¯èƒ½æƒ³äº†è§£å¦‚ä½•åœ¨æµ‹è¯•ä¸­ä½¿ç”¨æ¸…æ™°ã€æ˜ç¡®çš„å‡½æ•°ï¼Œæˆ–è€…æ˜¯å…³äº Node.js ä¸­ä¸€äº›æ¸…ç†å·¥ä½œï¼ˆæ¯”å¦‚æ¸…é™¤å®šæ—¶å™¨ã€æ¸…ç©ºç¼“å­˜ç­‰ï¼‰çš„æœ€ä½³å®è·µã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡®ä»€ä¹ˆæ˜¯â€œclear functionsâ€ï¼ˆæ¸…æ™°çš„å‡½æ•°ï¼‰ã€‚è™½ç„¶åœ¨ç¼–ç¨‹é¢†åŸŸæ²¡æœ‰ä¸¥æ ¼å®šä¹‰ï¼Œâ€œæ¸…æ™°çš„å‡½æ•°â€é€šå¸¸æŒ‡çš„æ˜¯é‚£äº›åšå•ä¸€å·¥ä½œã€æ˜“äºç†è§£å’Œç»´æŠ¤çš„å‡½æ•°ã€‚åœ¨æµ‹è¯•ç¯å¢ƒä¸­ï¼Œè¿™æ„å‘³ç€æ¯ä¸ªæµ‹è¯•å‡½æ•°åº”è¯¥æ˜ç¡®åœ°æµ‹è¯•ä¸€ä¸ªå…·ä½“çš„åŠŸèƒ½ç‚¹ï¼Œè€Œä¸”å…¶å‘½ååº”å‡†ç¡®åæ˜ å®ƒæ‰€æµ‹è¯•çš„å†…å®¹ã€‚</p><p>è®©æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªåŸºäº Node.js çš„ä¾‹å­ï¼Œä»¥ç†è§£è¿™ä¸€ç‚¹ï¼š</p><h3 id="ä¾‹å­-1-ç®€å•çš„åŠ æ³•å‡½æ•°" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-ç®€å•çš„åŠ æ³•å‡½æ•°"><span>ä¾‹å­ 1ï¼šç®€å•çš„åŠ æ³•å‡½æ•°</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªç®€å•çš„åŠ æ³•å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">b</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> a</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> b</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæˆ‘ä»¬è¦æµ‹è¯•è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªâ€œæ¸…æ™°çš„â€æµ‹è¯•ç”¨ä¾‹ï¼Œè¿™æ ·ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;add function tests&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should return 5 for add(2, 3)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæµ‹è¯•éå¸¸æ¸…æ™°â€”â€”æˆ‘ä»¬æœŸæœ›å½“è¾“å…¥<code>2</code>å’Œ<code>3</code>åˆ°<code>add</code>å‡½æ•°æ—¶ï¼Œå®ƒè¿”å›<code>5</code>ã€‚</p><h3 id="ä¾‹å­-2-å¼‚æ­¥æ•°æ®è·å–" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-å¼‚æ­¥æ•°æ®è·å–"><span>ä¾‹å­ 2ï¼šå¼‚æ­¥æ•°æ®è·å–</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œç”¨äºä»æŸä¸ª API è·å–æ•°æ®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> response</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> response</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">json</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹äºè¿™æ ·çš„å¼‚æ­¥å‡½æ•°ï¼Œæˆ‘ä»¬åŒæ ·éœ€è¦å†™å‡ºæ¸…æ™°çš„æµ‹è¯•ç”¨ä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fetchData function test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should return data from API&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https://api.example.com/data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">ok</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¡®è®¤æˆ‘ä»¬å¾—åˆ°äº†ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨<code>async/await</code>è¯­æ³•å¯¹å¼‚æ­¥å‡½æ•°è¿›è¡Œæµ‹è¯•ï¼Œç¡®ä¿èƒ½ä»ç‰¹å®š URL è·å–åˆ°æ•°æ®ã€‚</p><h3 id="ä¾‹å­-3-æ¸…é™¤å®šæ—¶å™¨" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-3-æ¸…é™¤å®šæ—¶å™¨"><span>ä¾‹å­ 3ï¼šæ¸…é™¤å®šæ—¶å™¨</span></a></h3><p>å¦‚æœä½ çš„ä»£ç ä¸­ä½¿ç”¨äº†å®šæ—¶å™¨ï¼Œä¾‹å¦‚<code>setTimeout</code>ï¼Œåœ¨æµ‹è¯•æˆ–ä»£ç è¿è¡Œç»“æŸæ—¶åº”å½“æ¸…é™¤å®ƒä»¬ä»¥é¿å…æ½œåœ¨çš„é—®é¢˜ã€‚è¿™ä¹Ÿå¯ä»¥è§†ä¸ºâ€œä½¿ç”¨æ¸…æ™°å‡½æ•°â€çš„ä¸€éƒ¨åˆ†â€”â€”å³æ¸…é™¤å’Œæ•´ç†èµ„æºã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> timerId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> startTimer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  timerId</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> clearTimer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  clearTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timerId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œç¡®ä¿åœ¨ä¸å†éœ€è¦å®šæ—¶å™¨æ—¶æ¸…é™¤å®ƒï¼Œæ˜¯é¿å…å†…å­˜æ³„æ¼å’Œå…¶ä»–æ½œåœ¨é—®é¢˜çš„å¥½æ–¹æ³•ã€‚</p><p>æ€»ä¹‹ï¼Œâ€œä½¿ç”¨æ¸…æ™°å‡½æ•°â€æ„å‘³ç€ç¼–å†™ç›®çš„æ˜ç¡®ã€èŒè´£å•ä¸€ã€æ˜“äºç†è§£å’Œç»´æŠ¤çš„ä»£ç ã€‚åœ¨æµ‹è¯•ç¯å¢ƒä¸‹ï¼Œå®ƒæ¶‰åŠåˆ°ä¸ºæ¯ä¸€ä¸ªåŠŸèƒ½ç‚¹ç¼–å†™ä¸“é—¨çš„æµ‹è¯•ç”¨ä¾‹ï¼Œç¡®ä¿æ¯ä¸ªç”¨ä¾‹éƒ½æ˜¯è‡ªåŒ…å«å’Œæ˜“äºç†è§£çš„ã€‚å¸Œæœ›è¿™äº›è§£é‡Šå’Œä¾‹å­èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ã€‚</p><h4 id="working-with-node-js-timers-modules" tabindex="-1"><a class="header-anchor" href="#working-with-node-js-timers-modules"><span><a href="https://nodejs.org/docs/latest/api/test.html#working-with-nodejs-timers-modules" target="_blank" rel="noopener noreferrer">Working with Node.js timers modules</a></span></a></h4><p>è¦è§£é‡Š Node.js çš„å®šæ—¶å™¨æ¨¡å—ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç†è§£ä»€ä¹ˆæ˜¯ Node.jsã€‚Node.js æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¹³å°ï¼Œå®ƒå…è®¸ä½ ä½¿ç”¨ JavaScript æ¥ç¼–å†™åç«¯ä»£ç ã€‚Node.js éå¸¸é€‚åˆå¼€å‘éœ€è¦å¤„ç†å¤§é‡å¹¶å‘è¿æ¥è€Œä¸ç‰ºç‰²æ€§èƒ½çš„ç½‘ç»œåº”ç”¨ã€‚</p><p>ç°åœ¨ï¼Œè°ˆåˆ°â€œå®šæ—¶å™¨æ¨¡å—â€ï¼Œæˆ‘ä»¬æŒ‡çš„æ˜¯ä¸€ç»„å…è®¸ä½ åœ¨ä»£ç ä¸­å®‰æ’ä»»åŠ¡åœ¨å°†æ¥æŸä¸ªæ—¶é—´ç‚¹æ‰§è¡Œçš„åŠŸèƒ½ã€‚è¿™äº›åŠŸèƒ½åœ¨ç¼–å†™å¼‚æ­¥ä»£ç æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œå®šæ—¶å™¨åŠŸèƒ½ä¸»è¦é€šè¿‡å‡ ä¸ªå…¨å±€æ–¹æ³•æä¾›ï¼š</p><ol><li><p><strong><code>setTimeout()</code></strong>ï¼šè¿™ä¸ªå‡½æ•°ç”¨äºå®‰æ’ä¸€ä¸ªå‡½æ•°åœ¨æŒ‡å®šçš„æ¯«ç§’æ•°ä¹‹åæ‰§è¡Œã€‚</p><ul><li>ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³åœ¨ 5 ç§’åæ‰“å°ä¸€æ¡æ¶ˆæ¯ï¼Œå¯ä»¥è¿™æ ·åšï¼š<div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello after 5 seconds&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p><strong><code>clearTimeout()</code></strong>ï¼šæ­¤å‡½æ•°ç”¨äºå–æ¶ˆç”±<code>setTimeout()</code>è®¾ç½®çš„å®šæ—¶å™¨ã€‚</p><ul><li><p>æ¯”å¦‚è¯´ï¼Œå¦‚æœä½ æ”¹å˜äº†ä¸»æ„ï¼Œä¸æƒ³æ‰§è¡Œä¸Šé¢çš„å»¶è¿Ÿæ¶ˆæ¯ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> timerId</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;This will not run.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clearTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timerId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p><strong><code>setInterval()</code></strong>ï¼šä¸<code>setTimeout()</code>ç±»ä¼¼ï¼Œä½†è¿™ä¸ªå‡½æ•°ä¼šæ¯éš”æŒ‡å®šçš„æ¯«ç§’æ•°é‡å¤æ‰§è¡Œå‡½æ•°ï¼Œè€Œä¸æ˜¯åªæ‰§è¡Œä¸€æ¬¡ã€‚</p><ul><li>ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœä½ æƒ³æ¯ 3 ç§’æ‰“å°ä¸€æ¬¡æ—¶é—´ï¼š<div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toLocaleTimeString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p><strong><code>clearInterval()</code></strong>ï¼šç”¨äºåœæ­¢ç”±<code>setInterval()</code>åˆ›å»ºçš„é‡å¤å®šæ—¶å™¨ã€‚</p><ul><li><p>å¦‚æœä½ æƒ³åœ¨æŸä¸ªç‚¹åœæ­¢ä¸Šé¢çš„æ—¶é—´æ‰“å°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> intervalId</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toLocaleTimeString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ åœ¨10ç§’åå†³å®šåœæ­¢æ‰“å°æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  clearInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">intervalId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ol><p>å®é™…åº”ç”¨åœºæ™¯ä¸¾ä¾‹ï¼š</p><ul><li><strong>è½®è¯¢</strong>ï¼šä½¿ç”¨<code>setInterval()</code>å®šæœŸæ£€æŸ¥èµ„æºçš„çŠ¶æ€æˆ–æ•°æ®å˜åŒ–ï¼Œä¾‹å¦‚ï¼Œæ¯ 30 ç§’æŸ¥è¯¢ä¸€æ¬¡æ•°æ®åº“ä»¥æ›´æ–°ç”¨æˆ·ç•Œé¢ã€‚</li><li><strong>å»¶è¿Ÿå“åº”</strong>ï¼šä½¿ç”¨<code>setTimeout()</code>å»¶è¿Ÿå“åº”ï¼Œæ¯”å¦‚åœ¨ç”¨æˆ·æäº¤è¡¨å•åå»¶è¿Ÿæ˜¾ç¤ºç¡®è®¤ä¿¡æ¯ï¼Œæé«˜ç”¨æˆ·ä½“éªŒã€‚</li><li><strong>èŠ‚æµå’Œé˜²æŠ–</strong>ï¼šåœ¨ Web å¼€å‘ä¸­ï¼Œä¸ºäº†é™åˆ¶æŸäº›æ“ä½œï¼ˆå¦‚çª—å£å¤§å°è°ƒæ•´ã€æ»šåŠ¨äº‹ä»¶ï¼‰çš„é¢‘ç‡ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>setTimeout()</code>æ¥å®ç°èŠ‚æµï¼ˆthrottlingï¼‰å’Œé˜²æŠ–ï¼ˆdebouncingï¼‰æŠ€æœ¯ã€‚</li><li><strong>å®šæ—¶ä»»åŠ¡</strong>ï¼šæ¯”å¦‚ï¼Œåœ¨åº”ç”¨å¯åŠ¨åå»¶è¿Ÿå‡ åˆ†é’Ÿè‡ªåŠ¨æ‰§è¡Œæ•°æ®å¤‡ä»½æ“ä½œã€‚</li></ul><p>ç†è§£å’Œä½¿ç”¨ Node.js çš„å®šæ—¶å™¨æ¨¡å—æ˜¯å®ç°é«˜æ•ˆã€å¯é çš„å¼‚æ­¥ç¼–ç¨‹çš„å…³é”®éƒ¨åˆ†ã€‚å¸Œæœ›è¿™äº›ä¾‹å­èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨å®ƒä»¬ã€‚</p><h3 id="timers-runall" tabindex="-1"><a class="header-anchor" href="#timers-runall"><span><a href="https://nodejs.org/docs/latest/api/test.html#timersrunall" target="_blank" rel="noopener noreferrer">timers.runAll()</a></span></a></h3><p>Node.js ä¸­çš„ <code>timers.runAll()</code> æ˜¯ä¸€ä¸ªåœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­è¢«å¼•å…¥çš„æµ‹è¯•åŠŸèƒ½ï¼Œå®ƒå…è®¸å¼€å‘è€…åœ¨æµ‹è¯•ä»£ç æ—¶ç«‹å³æ‰§è¡Œæ‰€æœ‰ç”± <code>setTimeout()</code>, <code>setInterval()</code>, å’Œ <code>setImmediate()</code> å®‰æ’çš„å›è°ƒå‡½æ•°ã€‚è¿™å¯¹äºç¼–å†™å•å…ƒæµ‹è¯•å°¤å…¶æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå¯ä»¥è®©ä½ ä¸éœ€è¦ç­‰å¾…è®¡æ—¶å™¨å®é™…åˆ°æœŸå°±èƒ½æµ‹è¯•é‚£äº›ä¾èµ–äºæ—¶é—´é€»è¾‘çš„ä»£ç ã€‚</p><p>ç®€å•æ¥è¯´ï¼Œ<code>timers.runAll()</code> åŠŸèƒ½åƒæ˜¯ä¸€ä¸ªåŠ é€Ÿå™¨ï¼Œä½¿å¾—æ‰€æœ‰è®¡åˆ’ä¸­çš„å®šæ—¶ä»»åŠ¡ç«‹å³æ‰§è¡Œï¼Œè€Œä¸æ˜¯ç­‰åˆ°å®ƒä»¬å„è‡ªè®¾å®šçš„æ—¶é—´åˆ°äº†å†è¿è¡Œã€‚</p><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-3" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-3"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-æµ‹è¯•-settimeout" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æµ‹è¯•-settimeout"><span>ç¤ºä¾‹ 1: æµ‹è¯• setTimeout</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªä½¿ç”¨ <code>setTimeout()</code> çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨ 2 ç§’åå°†ä¸€æ¡æ¶ˆæ¯æ‰“å°åˆ°æ§åˆ¶å°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> delayedHello</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello after 2 seconds&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœè¦æµ‹è¯•è¿™ä¸ªå‡½æ•°ï¼Œä½ éœ€è¦ç­‰å¾… 2 ç§’é’Ÿæ‰èƒ½çœ‹åˆ°ç»“æœã€‚ä½†æ˜¯ï¼Œä½¿ç”¨ <code>timers.runAll()</code>ï¼Œä½ å¯ä»¥è®©è¿™ä¸ªå»¶è¿Ÿçš„æ‰“å°æ“ä½œç«‹å³å‘ç”Ÿï¼Œä»è€Œä½¿å¾—æµ‹è¯•è¿è¡Œå¾—æ›´å¿«ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡å®šåœ¨ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒä¸­</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> timers</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;timers/promises&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">timers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">runAll</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">delayedHello</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™ä¼šå¯¼è‡´ &quot;Hello after 2 seconds&quot; ç«‹å³è¢«æ‰“å°å‡ºæ¥</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-æµ‹è¯•-setinterval" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æµ‹è¯•-setinterval"><span>ç¤ºä¾‹ 2: æµ‹è¯• setInterval</span></a></h4><p>è€ƒè™‘ä½ æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒä½¿ç”¨ <code>setInterval()</code> æ¯ 1 ç§’é’Ÿé‡å¤æ‰“å°ä¸€æ¬¡æ¶ˆæ¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> repeatHello</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello every second&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æµ‹è¯•è¿™ä¸ªå‡½æ•°æ—¶ï¼Œä½ å¯èƒ½åªæƒ³éªŒè¯å›è°ƒæ˜¯å¦æ­£å¸¸è®¾ç½®ï¼Œè€Œä¸çœŸçš„æƒ³ç­‰å¾…å®ƒå¤šæ¬¡æ‰§è¡Œã€‚é€šè¿‡ä½¿ç”¨ <code>timers.runAll()</code>ï¼Œæ‰€æœ‰æ’é˜Ÿçš„å‘¨æœŸæ€§å›è°ƒéƒ½ä¼šç«‹å³æ‰§è¡Œä¸€æ¬¡ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡å®šåœ¨ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒä¸­</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> timers</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;timers/promises&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">repeatHello</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">timers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">runAll</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™å°†å¯¼è‡´ &quot;Hello every second&quot; ç«‹å³è¢«æ‰“å°å‡ºæ¥ï¼Œè€Œä¸éœ€è¦ç­‰å¾… 1 ç§’é’Ÿ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ³¨æ„äº‹é¡¹-2" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-2"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>ä½¿ç”¨ <code>timers.runAll()</code> éœ€è¦è°¨æ…ï¼Œå› ä¸ºå®ƒä¼šæ”¹å˜ä»£ç çš„æ‰§è¡Œæ—¶é—´ã€‚ç‰¹åˆ«æ˜¯åœ¨æµ‹è¯•ç¯å¢ƒä¸­ï¼Œç†è§£å®ƒå¦‚ä½•å½±å“ä½ çš„æµ‹è¯•å’Œä»£ç è¡Œä¸ºæ˜¯éå¸¸é‡è¦çš„ã€‚</li><li>è¿™ä¸ªåŠŸèƒ½ä¸»è¦ç”¨äºæµ‹è¯•ç›®çš„ï¼Œä¸å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒçš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ã€‚</li></ul><p>é€šè¿‡ä»¥ä¸Šçš„è§£é‡Šå’Œç¤ºä¾‹ï¼Œå¸Œæœ›ä½ èƒ½å¯¹ <code>timers.runAll()</code> æœ‰ä¸€ä¸ªæ¸…æ™°çš„ç†è§£ï¼Œå¹¶çŸ¥é“å¦‚ä½•åœ¨æµ‹è¯•ä½ çš„ Node.js åº”ç”¨æ—¶ä½¿ç”¨å®ƒã€‚</p><h3 id="timers-settime-milliseconds" tabindex="-1"><a class="header-anchor" href="#timers-settime-milliseconds"><span><a href="https://nodejs.org/docs/latest/api/test.html#timerssettimemilliseconds" target="_blank" rel="noopener noreferrer">timers.setTime(milliseconds)</a></span></a></h3><p>æˆ‘æ³¨æ„åˆ°ä½ çš„é—®é¢˜æåŠäº† <code>timers.setTime(milliseconds)</code> å‡½æ•°ï¼Œä½†æ ¹æ®æˆ‘çš„æœ€æ–°çŸ¥è¯†å’Œå¯¹ Node.js å®˜æ–¹æ–‡æ¡£çš„æ£€æŸ¥ï¼Œä¼¼ä¹æ²¡æœ‰è¿™ä¸ªç‰¹å®šçš„å‡½æ•°ã€‚å¯èƒ½å­˜åœ¨ä¸€äº›è¯¯è§£æˆ–è€…è¯¯å¯¼ä¿¡æ¯ã€‚Node.js æä¾›äº†å®šæ—¶å™¨åŠŸèƒ½ï¼Œæ¯”å¦‚ <code>setTimeout()</code>, <code>setInterval()</code>, å’Œ <code>setImmediate()</code>ï¼Œä½†å¹¶æ²¡æœ‰ç›´æ¥åä¸º <code>timers.setTime()</code> çš„å‡½æ•°ã€‚</p><p>ä¸è¿‡ï¼Œä¸ºäº†å¸®åŠ©ä½ ç†è§£ Node.js ä¸­å®šæ—¶å™¨çš„ä½¿ç”¨ï¼Œæˆ‘å¯ä»¥é€šè¿‡ä»‹ç» <code>setTimeout()</code> å’Œ <code>setInterval()</code> è¿™ä¸¤ä¸ªå¸¸ç”¨çš„å®šæ—¶å™¨å‡½æ•°æ¥æä¾›å¸®åŠ©ã€‚</p><h3 id="settimeout" tabindex="-1"><a class="header-anchor" href="#settimeout"><span>setTimeout()</span></a></h3><p><code>setTimeout()</code> æ˜¯ä¸€ä¸ªåœ¨æŒ‡å®šçš„æ¯«ç§’æ•°åæ‰§è¡Œä»£ç çš„æ–¹æ³•ã€‚ä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼Œä½ å¯ä»¥è®¾ç½®ä¸€ä¸ªå»¶è¿Ÿï¼Œç„¶ååœ¨å»¶è¿Ÿç»“æŸåæ‰§è¡ŒæŸäº›ä»£ç ã€‚</p><h4 id="ä¾‹å­-è®¾ç½®ä¸€ä¸ªç®€å•çš„å»¶æ—¶" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-è®¾ç½®ä¸€ä¸ªç®€å•çš„å»¶æ—¶"><span>ä¾‹å­ï¼šè®¾ç½®ä¸€ä¸ªç®€å•çš„å»¶æ—¶</span></a></h4><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å»¶è¿Ÿ 2000 æ¯«ç§’ï¼ˆ2 ç§’ï¼‰åæ‰“å°æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello after 2 seconds&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>setTimeout()</code> è®¾ç½®äº†ä¸€ä¸ª 2000 æ¯«ç§’ï¼ˆ2 ç§’ï¼‰çš„å»¶æ—¶ã€‚å½“æ—¶é—´åˆ°è¾¾åï¼Œå®ƒä¼šæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œåœ¨æ§åˆ¶å°ä¸Šæ‰“å°å‡º &quot;Hello after 2 seconds&quot;ã€‚</p><h3 id="setinterval" tabindex="-1"><a class="header-anchor" href="#setinterval"><span>setInterval()</span></a></h3><p>ä¸ <code>setTimeout()</code> ç±»ä¼¼ï¼Œ<code>setInterval()</code> å‡½æ•°ç”¨äºæŒ‰ç…§æŒ‡å®šçš„å‘¨æœŸï¼ˆä»¥æ¯«ç§’è®¡ï¼‰é‡å¤è°ƒç”¨å‡½æ•°æˆ–æ‰§è¡Œä»£ç ç‰‡æ®µã€‚</p><h4 id="ä¾‹å­-å®ç°ä¸€ä¸ªç®€å•çš„è®¡æ—¶å™¨" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-å®ç°ä¸€ä¸ªç®€å•çš„è®¡æ—¶å™¨"><span>ä¾‹å­ï¼šå®ç°ä¸€ä¸ªç®€å•çš„è®¡æ—¶å™¨</span></a></h4><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> count</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¯éš” 1 ç§’é’Ÿå¢åŠ è®¡æ•°å™¨å¹¶æ‰“å°å…¶å€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> intervalId</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  count</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Count is </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">count</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å½“è®¡æ•°åˆ° 5 æ—¶åœæ­¢è®¡æ—¶å™¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">count</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    clearInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">intervalId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>setInterval()</code> è®¾ç½®äº†ä¸€ä¸ªæ¯éš” 1000 æ¯«ç§’ï¼ˆ1 ç§’ï¼‰æ‰§è¡Œä¸€æ¬¡çš„å®šæ—¶å™¨ã€‚æ¯æ¬¡å®šæ—¶å™¨è§¦å‘æ—¶ï¼Œå®ƒä¼šå¢åŠ  <code>count</code> å˜é‡çš„å€¼ï¼Œå¹¶æ‰“å°å½“å‰è®¡æ•°ã€‚å½“è®¡æ•°è¾¾åˆ° 5 æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>clearInterval()</code> åœæ­¢å®šæ—¶å™¨ã€‚</p><p>å¸Œæœ›è¿™äº›ä¿¡æ¯èƒ½å¤Ÿå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ Node.js ä¸­å¦‚ä½•ä½¿ç”¨å®šæ—¶å™¨ã€‚å¦‚æœä½ æœ‰ä»»ä½•å…¶ä»–é—®é¢˜ï¼Œè¯·éšæ—¶æé—®ã€‚</p><h4 id="dates-and-timers-working-together" tabindex="-1"><a class="header-anchor" href="#dates-and-timers-working-together"><span><a href="https://nodejs.org/docs/latest/api/test.html#dates-and-timers-working-together" target="_blank" rel="noopener noreferrer">Dates and Timers working together</a></span></a></h4><p>å¯¹ä¸èµ·ï¼Œä½†æ˜¯æ ¹æ®æˆ‘æœ€åçš„æ›´æ–°ï¼ˆ2023 å¹´ï¼‰ï¼ŒNode.js çš„å®˜æ–¹æ–‡æ¡£ä¸­å¹¶æ²¡æœ‰ç›´æ¥æ¶‰åŠ â€œDates and Timers working togetherâ€ è¿™ä¸€å°èŠ‚ã€‚è¿™æœ‰å¯èƒ½æ˜¯ä¸€ä¸ªè¯¯è§£æˆ–è€…æ˜¯æŸ¥æ‰¾é”™è¯¯ã€‚ä½†æˆ‘å¯ä»¥å‘ä½ ä»‹ç» Node.js ä¸­æ—¥æœŸå’Œå®šæ—¶å™¨å¦‚ä½•ååŒå·¥ä½œçš„æ¦‚å¿µï¼Œä»¥åŠå®ƒä»¬åœ¨å®é™…å¼€å‘ä¸­æ˜¯å¦‚ä½•è¢«åº”ç”¨çš„ã€‚</p><h3 id="æ—¥æœŸ-dates-ä¸-node-js" tabindex="-1"><a class="header-anchor" href="#æ—¥æœŸ-dates-ä¸-node-js"><span>æ—¥æœŸï¼ˆDatesï¼‰ä¸ Node.js</span></a></h3><p>åœ¨ JavaScript å’Œ Node.js ä¸­ï¼Œ<code>Date</code> å¯¹è±¡ç”¨äºå¤„ç†æ—¥æœŸå’Œæ—¶é—´ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>new Date()</code> æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸå¯¹è±¡ï¼Œè¯¥å¯¹è±¡é»˜è®¤åŒ…å«äº†åˆ›å»ºå®ƒçš„é‚£ä¸€åˆ»çš„æ—¥æœŸå’Œæ—¶é—´ä¿¡æ¯ã€‚</p><p><strong>ç¤ºä¾‹ï¼šåˆ›å»ºå½“å‰æ—¥æœŸå’Œæ—¶é—´</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> currentDate</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">currentDate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå½“å‰çš„æ—¥æœŸå’Œæ—¶é—´</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®šæ—¶å™¨-timers-ä¸-node-js" tabindex="-1"><a class="header-anchor" href="#å®šæ—¶å™¨-timers-ä¸-node-js"><span>å®šæ—¶å™¨ï¼ˆTimersï¼‰ä¸ Node.js</span></a></h3><p>Node.js æä¾›äº†ä¸€äº›å…¨å±€å‡½æ•°æ¥å¤„ç†å¼‚æ­¥æ“ä½œä¸­çš„æ—¶é—´å»¶è¿Ÿå’Œé—´éš”æ‰§è¡Œï¼Œä¸»è¦åŒ…æ‹¬ï¼š</p><ul><li><code>setTimeout(function, delay)</code>ï¼šåœ¨æŒ‡å®šçš„å»¶è¿Ÿåæ‰§è¡Œä¸€æ¬¡å‡½æ•°ã€‚</li><li><code>setInterval(function, interval)</code>ï¼šæŒ‰ç…§æŒ‡å®šçš„å‘¨æœŸï¼ˆä»¥æ¯«ç§’è®¡ï¼‰ä¸åœåœ°è°ƒç”¨å‡½æ•°ã€‚</li></ul><p><strong>ç¤ºä¾‹ï¼šä½¿ç”¨ <code>setTimeout</code> æ¥å»¶è¿Ÿæ‰§è¡Œ</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello after 3 seconds&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ 3 ç§’åæ‰“å°æ¶ˆæ¯</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç»“åˆä½¿ç”¨æ—¥æœŸå’Œå®šæ—¶å™¨" tabindex="-1"><a class="header-anchor" href="#ç»“åˆä½¿ç”¨æ—¥æœŸå’Œå®šæ—¶å™¨"><span>ç»“åˆä½¿ç”¨æ—¥æœŸå’Œå®šæ—¶å™¨</span></a></h3><p>è™½ç„¶ Node.js æ–‡æ¡£ä¸­æ²¡æœ‰ç‰¹å®šâ€œDates and Timers working togetherâ€çš„éƒ¨åˆ†ï¼Œä½†æˆ‘ä»¬å¯ä»¥æƒ³è±¡ä¸€äº›åœºæ™¯ï¼Œæ¯”å¦‚ä½ æƒ³åœ¨æŸä¸ªå…·ä½“æ—¶é—´è§¦å‘äº‹ä»¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ç»“åˆä½¿ç”¨æ—¥æœŸå¯¹è±¡å’Œå®šæ—¶å™¨åŠŸèƒ½ã€‚</p><p><strong>ç¤ºä¾‹ï¼šåœ¨æœªæ¥ç‰¹å®šæ—¶é—´è§¦å‘</strong></p><p>å‡è®¾ä½ å¸Œæœ›åœ¨ä»Šå¤©ä¸‹åˆ 6 ç‚¹æ•´æé†’è‡ªå·±ç»“æŸå·¥ä½œã€‚</p><ol><li>é¦–å…ˆï¼Œè®¡ç®—ç°åœ¨åˆ°ç›®æ ‡æ—¶é—´çš„å·®å€¼ï¼ˆæ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚</li><li>ä½¿ç”¨ <code>setTimeout</code> æ ¹æ®è¿™ä¸ªå»¶è¿Ÿè®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> now</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> target</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">target</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setHours</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">18</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®ç›®æ ‡æ—¶é—´ä¸ºä»Šå¤©18:00:00</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> delay</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getTime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getTime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¡ç®—å»¶è¿Ÿçš„æ¯«ç§’æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">delay</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¦‚æœå½“å‰æ—¶é—´æ—©äº18:00</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Time to stop working!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">delay</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;It is already past 18:00!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•å°†æ—¥æœŸå’Œå®šæ—¶å™¨ç»“åˆèµ·æ¥è§£å†³å®é™…é—®é¢˜ã€‚ä½ é¦–å…ˆç¡®å®šç›®æ ‡æ—¶é—´å’Œå½“å‰æ—¶é—´ï¼Œç„¶åè®¡ç®—äºŒè€…ä¹‹é—´çš„å·®å¼‚ï¼Œå¹¶ä½¿ç”¨è¿™ä¸ªå·®å¼‚ä½œä¸º <code>setTimeout</code> çš„å»¶è¿Ÿæ—¶é—´ï¼Œä»è€Œåœ¨è¾¾åˆ°ç›®æ ‡æ—¶é—´æ—¶æ‰§è¡Œç‰¹å®šæ“ä½œã€‚</p><p>å¸Œæœ›è¿™äº›è§£é‡Šå’Œä¾‹å­èƒ½å¸®åŠ©ä½ ç†è§£ Node.js ä¸­æ—¥æœŸå’Œå®šæ—¶å™¨å¦‚ä½•å¯ä»¥ä¸€èµ·å·¥ä½œæ¥å®ç°ç‰¹å®šçš„åŠŸèƒ½å’Œé€»è¾‘ã€‚</p><h2 id="class-testsstream" tabindex="-1"><a class="header-anchor" href="#class-testsstream"><span><a href="https://nodejs.org/docs/latest/api/test.html#class-testsstream" target="_blank" rel="noopener noreferrer">Class: TestsStream</a></span></a></h2><p>è®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥åœ°äº†è§£ Node.js ä¸­çš„<code>TestStream</code>ç±»ï¼Œå°è¯•ä»¥é€šä¿—æ˜“æ‡‚çš„æ–¹å¼æ¥è§£é‡Šã€‚é¦–å…ˆï¼Œéœ€è¦æ˜ç¡®çš„æ˜¯ï¼Œæˆªè‡³æˆ‘çš„æœ€åæ›´æ–°ï¼ˆ2023 å¹´ï¼‰ï¼ŒNode.js å®˜æ–¹æ–‡æ¡£ä¸­å¹¶æ²¡æœ‰ç›´æ¥æåŠåä¸º<code>TestStream</code>çš„ç±»ã€‚è¿™å¯èƒ½æ˜¯ä¸€ä¸ªè¯¯è§£æˆ–è€…æ˜¯å¯¹å°†æ¥ç‰ˆæœ¬çš„é¢„æœŸã€‚ä¸è¿‡ï¼Œè€ƒè™‘åˆ°ä½ å¯èƒ½æ˜¯æƒ³äº†è§£ Node.js ä¸­ä¸æµ‹è¯•ç›¸å…³çš„æµï¼ˆStreamsï¼‰å’Œå¦‚ä½•ä½¿ç”¨å®ƒä»¬ï¼Œæˆ‘å°†ä»¥æ­¤ä¸ºåŸºç¡€è¿›è¡Œè§£é‡Šã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œâ€œæµâ€æ˜¯å¤„ç†è¯»å†™æ•°æ®çš„ä¸€ç§æ–¹å¼ï¼Œéå¸¸é€‚åˆå¤„ç†å¤§é‡æ•°æ®æˆ–è€…ä½ ä¸å¸Œæœ›ä¸€æ¬¡æ€§å°†æ‰€æœ‰æ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­çš„åœºæ™¯ã€‚æµå¯ä»¥æ˜¯å¯è¯»çš„ã€å¯å†™çš„ã€æˆ–è€…æ—¢å¯è¯»åˆå¯å†™ã€‚</p><h3 id="ç›¸å…³æ¦‚å¿µç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#ç›¸å…³æ¦‚å¿µç®€ä»‹"><span>ç›¸å…³æ¦‚å¿µç®€ä»‹</span></a></h3><ul><li><p><strong>æµï¼ˆStreamsï¼‰</strong>ï¼šåœ¨ Node.js ä¸­ï¼Œæµæ˜¯ç”¨äºå¤„ç†æ•°æ®çš„åºåˆ—ï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶æˆ–ä»ç½‘ç»œæ¥æ”¶æ•°æ®ã€‚æµå¯ä»¥åˆ†ä¸ºå››ç§ç±»å‹ï¼šå¯è¯»æµã€å¯å†™æµã€åŒå·¥æµï¼ˆæ—¢å¯è¯»åˆå¯å†™ï¼‰ã€è½¬æ¢æµï¼ˆåœ¨è¯»å†™è¿‡ç¨‹ä¸­å¯ä»¥ä¿®æ”¹æ•°æ®ï¼‰ã€‚</p></li><li><p><strong>æµ‹è¯•ï¼ˆTestingï¼‰</strong>ï¼šåœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œæµ‹è¯•æ˜¯ç¡®ä¿ä½ çš„ä»£ç æŒ‰é¢„æœŸå·¥ä½œçš„ä¸€ä¸ªè¿‡ç¨‹ã€‚Node.js ç¤¾åŒºé€šå¸¸ä¼šä½¿ç”¨ä¸€äº›æµè¡Œçš„æµ‹è¯•åº“ï¼Œå¦‚ Mochaã€Jest ç­‰ï¼Œæ¥ç¼–å†™å’Œè¿è¡Œæµ‹è¯•ã€‚</p></li></ul><p>å‡è®¾<code>TestStream</code>æ˜¯æŒ‡åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ä¸æµæ“ä½œç›¸å…³çš„ä¸€ä¸ªæŠ½è±¡æˆ–å…·ä½“å®ç°ï¼Œå…¶ä¸»è¦åº”ç”¨å¯èƒ½åŒ…æ‹¬ï¼š</p><ol><li><p><strong>æ¨¡æ‹Ÿæ•°æ®æµ</strong>ï¼šåœ¨æµ‹è¯•æ¶‰åŠæµæ“ä½œçš„ä»£ç æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦åˆ›å»ºä¸€ä¸ªæ¨¡æ‹Ÿçš„æµç¯å¢ƒï¼Œè¿™æ ·å°±å¯ä»¥æ§åˆ¶è¾“å…¥æ•°æ®ï¼Œå¹¶æ£€æŸ¥ä»£ç å¯¹è¿™äº›æ•°æ®çš„å“åº”æ˜¯å¦ç¬¦åˆé¢„æœŸã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æ­£åœ¨æµ‹è¯•ä¸€ä¸ªåŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½ä»ç½‘ç»œè¯»å–æ•°æ®ç„¶åå¤„ç†ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªâ€œæµ‹è¯•æµâ€æ¥æ¨¡æ‹Ÿç½‘ç»œæ•°æ®çš„è¾“å…¥ã€‚</p></li><li><p><strong>æ€§èƒ½æµ‹è¯•</strong>ï¼šé€šè¿‡ä½¿ç”¨ç‰¹å®šçš„æ•°æ®æµï¼Œæˆ‘ä»¬å¯ä»¥æµ‹è¯•åœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶ï¼Œä»£ç çš„è¡¨ç°å¦‚ä½•ï¼Œè¿›è€Œè¯„ä¼°æ€§èƒ½å’Œæ‰¾å‡ºå¯èƒ½çš„ç“¶é¢ˆã€‚</p></li><li><p><strong>é”™è¯¯å¤„ç†</strong>ï¼šé€šè¿‡æ„é€ é”™è¯¯åœºæ™¯çš„æ•°æ®æµï¼Œå¯ä»¥æµ‹è¯•ä»£ç å¯¹å¼‚å¸¸æƒ…å†µçš„å¤„ç†èƒ½åŠ›ï¼Œç¡®ä¿å½“é‡åˆ°é”™è¯¯è¾“å…¥æˆ–æ–­å¼€è¿æ¥æ—¶ï¼Œä»£ç ä»ç„¶èƒ½å¤Ÿä¼˜é›…åœ°å¤„ç†ã€‚</p></li></ol><h3 id="å®é™…åº”ç”¨ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-5"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„ Node.js åº”ç”¨ç¨‹åºï¼Œå…¶ç›®çš„æ˜¯ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®ï¼Œç„¶åè¿›è¡ŒæŸäº›å¤„ç†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Node.js çš„<code>fs</code>æ¨¡å—æ¥åˆ›å»ºä¸€ä¸ªå¯è¯»æµã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¯è¯»æµ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> readableStream</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createReadStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;input.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">readableStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Received </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">chunk</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bytes of data.`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹äºæµ‹è¯•ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ª<code>TestStream</code>ç±»ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šè¿™æ ·æ¨¡æ‹Ÿæ•°æ®æµï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> TestStream</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;some-test-library&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">TestStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ¨¡æ‹Ÿçš„æ•°æ®æµ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> testStream</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> TestStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨å‡æ•°æ®å¡«å……æµ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">testStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¿™æ˜¯ä¸€æ®µæµ‹è¯•æ•°æ®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿç»“æŸäº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">testStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼Œä¸Šè¿°ä»£ç ä»…ä¸ºç¤ºæ„æ€§è´¨ï¼Œå®é™…ä¸­å¯èƒ½å¹¶ä¸å­˜åœ¨<code>TestStream</code>ç±»ï¼Œä½ éœ€è¦æ ¹æ®å®é™…ä½¿ç”¨çš„æµ‹è¯•åº“æ–‡æ¡£æ¥å®ç°ç›¸åº”çš„æµ‹è¯•é€»è¾‘ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œç†è§£ Node.js ä¸­çš„æµåŠå…¶åœ¨æµ‹è¯•ä¸­çš„åº”ç”¨éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒä»¬ä¸ºå¤„ç†æ•°æ®æä¾›äº†å¼ºå¤§ä¸”çµæ´»çš„æœºåˆ¶ã€‚å¸Œæœ›è¿™ä¸ªè§£é‡Šæœ‰åŠ©äºä½ å¯¹ Node.js ä¸­æµå’Œæµ‹è¯•çš„ç†è§£ï¼</p><h3 id="event-test-coverage" tabindex="-1"><a class="header-anchor" href="#event-test-coverage"><span><a href="https://nodejs.org/docs/latest/api/test.html#event-testcoverage" target="_blank" rel="noopener noreferrer">Event: &#39;test:coverage&#39;</a></span></a></h3><p>Node.js v21.7.1 ä¸­å¼•å…¥çš„<code>test:coverage</code>äº‹ä»¶æ˜¯ä¸ Node.js å†…ç½®æµ‹è¯•æ¡†æ¶ç›¸å…³çš„ä¸€ä¸ªç‰¹æ€§ã€‚è¿™ä¸ªäº‹ä»¶å…è®¸ä½ åœ¨æµ‹è¯•è¦†ç›–ç‡æ•°æ®å¯ç”¨æ—¶æ‰§è¡Œä¸€äº›æ“ä½œã€‚ç†è§£è¿™ä¸ªæ¦‚å¿µä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p><h3 id="æµ‹è¯•è¦†ç›–ç‡" tabindex="-1"><a class="header-anchor" href="#æµ‹è¯•è¦†ç›–ç‡"><span>æµ‹è¯•è¦†ç›–ç‡</span></a></h3><p>æµ‹è¯•è¦†ç›–ç‡æ˜¯è¡¡é‡ä»£ç è¢«è‡ªåŠ¨åŒ–æµ‹è¯•è¦†ç›–ç¨‹åº¦çš„ä¸€ä¸ªæŒ‡æ ‡ã€‚é€šä¿—æ¥è¯´ï¼Œå®ƒè¡¨ç¤ºä½ çš„æµ‹è¯•æœ‰å¤šå°‘ç™¾åˆ†æ¯”çš„ä»£ç è¿è¡Œäº†ã€‚é«˜æµ‹è¯•è¦†ç›–ç‡å¯ä»¥å¸®åŠ©å‘ç°ä»£ç ä¸­çš„é”™è¯¯ï¼Œå¹¶ç¡®ä¿åŠŸèƒ½çš„ç¨³å®šæ€§ã€‚</p><h3 id="node-js-å†…ç½®æµ‹è¯•æ¡†æ¶" tabindex="-1"><a class="header-anchor" href="#node-js-å†…ç½®æµ‹è¯•æ¡†æ¶"><span>Node.js å†…ç½®æµ‹è¯•æ¡†æ¶</span></a></h3><p>Node.js çš„å†…ç½®æµ‹è¯•æ¡†æ¶æ˜¯ä¸€ä¸ªè½»é‡çº§çš„æµ‹è¯•æ¡†æ¶ï¼Œå®ƒç›´æ¥é›†æˆåœ¨ Node.js ç¯å¢ƒä¸­ï¼Œæ— éœ€é¢å¤–å®‰è£…ã€‚å®ƒæ”¯æŒç¼–å†™å’Œè¿è¡Œæµ‹è¯•ç”¨ä¾‹ï¼Œä»¥åŠç”Ÿæˆæµ‹è¯•æŠ¥å‘Šç­‰åŠŸèƒ½ã€‚</p><h3 id="test-coverage-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#test-coverage-äº‹ä»¶"><span><code>test:coverage</code> äº‹ä»¶</span></a></h3><p>å½“ä½ ä½¿ç”¨ Node.js çš„å†…ç½®æµ‹è¯•æ¡†æ¶è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Šæ—¶ï¼Œ<code>test:coverage</code>äº‹ä»¶ä¼šè¢«è§¦å‘ã€‚è¿™ä¸ªäº‹ä»¶å‘ç”Ÿåœ¨æµ‹è¯•è¦†ç›–ç‡æ•°æ®è®¡ç®—å®Œæˆåï¼Œä½ å¯ä»¥ç›‘å¬è¿™ä¸ªäº‹ä»¶ï¼Œä»¥æ‰§è¡Œä¸€äº›é¢å¤–çš„é€»è¾‘ï¼Œæ¯”å¦‚åˆ†ææµ‹è¯•è¦†ç›–ç‡æ•°æ®ï¼Œæˆ–è€…å°†æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Šå‘é€ç»™å¼€å‘å›¢é˜Ÿç­‰ã€‚</p><h4 id="å®é™…è¿ç”¨ç¤ºä¾‹-5" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-5"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h4><p>æƒ³è±¡ä½ æ­£åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­è´Ÿè´£ç¡®ä¿ä»£ç è´¨é‡ã€‚ä½ å¯ä»¥åˆ©ç”¨<code>test:coverage</code>äº‹ä»¶åšä»¥ä¸‹äº‹æƒ…ï¼š</p><ol><li><p><strong>è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š</strong>ï¼šåœ¨<code>test:coverage</code>äº‹ä»¶è§¦å‘åï¼Œè‡ªåŠ¨å°†æµ‹è¯•è¦†ç›–ç‡æ•°æ®ç”ŸæˆæŠ¥å‘Šï¼Œå­˜å‚¨åœ¨åˆ¶å®šä½ç½®ï¼Œæ–¹ä¾¿å›¢é˜ŸæŸ¥çœ‹ã€‚</p></li><li><p><strong>åˆ†ææµ‹è¯•è¦†ç›–ç‡ä¸è¶³çš„æ¨¡å—</strong>ï¼šé€šè¿‡ç›‘å¬<code>test:coverage</code>äº‹ä»¶ï¼Œè·å–åˆ°æµ‹è¯•è¦†ç›–ç‡æ•°æ®åï¼Œä½ å¯ä»¥å¯¹æ•°æ®è¿›è¡Œåˆ†æï¼Œæ‰¾å‡ºè¦†ç›–ç‡è¾ƒä½çš„ä»£ç æ¨¡å—ï¼Œéšåèšç„¦äºæå‡è¿™äº›åŒºåŸŸçš„æµ‹è¯•è¦†ç›–ç‡ã€‚</p></li><li><p><strong>é€šçŸ¥å›¢é˜Ÿæˆå‘˜</strong>ï¼šå¦‚æœæµ‹è¯•è¦†ç›–ç‡ä½äºæŸä¸ªé¢„å®šçš„é˜ˆå€¼ï¼Œä½ å¯ä»¥åœ¨<code>test:coverage</code>äº‹ä»¶çš„å›è°ƒå‡½æ•°ä¸­åŠ å…¥é€»è¾‘ï¼Œä¾‹å¦‚å‘é€é‚®ä»¶æˆ–æ¶ˆæ¯é€šçŸ¥å›¢é˜Ÿæˆå‘˜æ³¨æ„æµ‹è¯•è¦†ç›–ç‡é—®é¢˜ã€‚</p></li></ol><h3 id="æ€»ç»“-14" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-14"><span>æ€»ç»“</span></a></h3><p>Node.js v21.7.1 ä¸­çš„<code>test:coverage</code>äº‹ä»¶ä¸ºå¼€å‘è€…æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œä½¿å…¶èƒ½å¤Ÿåœ¨æµ‹è¯•è¦†ç›–ç‡æ•°æ®å¯ç”¨æ—¶å³åˆ»åšå‡ºå“åº”ã€‚æ— è®ºæ˜¯æ”¹è¿›é¡¹ç›®çš„æµ‹è¯•è¦†ç›–ç‡ï¼Œè¿˜æ˜¯æé«˜å›¢é˜Ÿå¯¹ä»£ç è´¨é‡çš„å…³æ³¨ï¼Œè¿™ä¸ªäº‹ä»¶éƒ½èƒ½å¤§æœ‰è£¨ç›Šã€‚</p><h3 id="event-test-dequeue" tabindex="-1"><a class="header-anchor" href="#event-test-dequeue"><span><a href="https://nodejs.org/docs/latest/api/test.html#event-testdequeue" target="_blank" rel="noopener noreferrer">Event: &#39;test:dequeue&#39;</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå®ƒä½¿å¾—å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚Node.js ä»¥å…¶éé˜»å¡ I/O å’Œäº‹ä»¶é©±åŠ¨çš„ç‰¹æ€§è€ŒçŸ¥åï¼Œè¿™ä½¿å¾—å®ƒç‰¹åˆ«é€‚åˆå¤„ç†æ•°æ®å¯†é›†å‹çš„å®æ—¶åº”ç”¨ã€‚</p><p>åœ¨ Node.js çš„æ–‡æ¡£ä¸­ï¼Œæœ‰æ—¶ä¼šé‡åˆ°ä¸€äº›ä¸“é—¨çš„äº‹ä»¶æˆ–æ–¹æ³•ï¼Œæ¯”å¦‚ä½ æåˆ°çš„ <code>Event: &#39;test:dequeue&#39;</code>ã€‚é¦–å…ˆï¼Œéœ€è¦æ¾„æ¸…çš„æ˜¯ï¼Œåœ¨ Node.js çš„å®˜æ–¹æ–‡æ¡£æˆ–å¸¸è§åŠŸèƒ½ä¸­ï¼Œå¹¶ä¸ç›´æ¥åŒ…å« <code>Event: &#39;test:dequeue&#39;</code> è¿™ä¸ªäº‹ä»¶ã€‚è¿™å¬èµ·æ¥åƒæ˜¯ä¸€ä¸ªç‰¹å®šåº“æˆ–æ¡†æ¶ä¸­å®šä¹‰çš„è‡ªå®šä¹‰äº‹ä»¶ï¼Œæˆ–è€…å¯èƒ½æ˜¯ä¸€ä¸ªå‡è®¾çš„ä¾‹å­ç”¨äºè¯´æ˜ã€‚</p><p>ä½†ä¸ºäº†å›ç­”ä½ çš„è¯·æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥å€Ÿç”¨è¿™ä¸ªæ¦‚å¿µæ¥è§£é‡Šä»€ä¹ˆæ˜¯äº‹ä»¶ä»¥åŠå®ƒä»¬åœ¨ Node.js ä¸­å¦‚ä½•è¿ä½œï¼ŒåŒæ—¶ä¸¾ä¸€äº›ç±»ä¼¼äº‹ä»¶å¤„ç†çš„å®é™…ä¾‹å­ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯äº‹ä»¶"><span>ä»€ä¹ˆæ˜¯äº‹ä»¶ï¼Ÿ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œå¾ˆå¤šå¯¹è±¡éƒ½ä¼šå‘å‡ºäº‹ä»¶ï¼šä¸€ä¸ª HTTP æœåŠ¡å™¨å¯¹è±¡ä¼šå‘å‡ºè¯·æ±‚äº‹ä»¶ï¼Œä¸€ä¸ªæ–‡ä»¶æµä¼šå‘å‡ºæ•°æ®äº‹ä»¶ç­‰ç­‰ã€‚å¼€å‘è€…å¯ä»¥é€šè¿‡ç›‘å¬è¿™äº›äº‹ä»¶æ¥å“åº”ç›¸åº”çš„æ“ä½œã€‚è¿™ç±»ä¼¼äºæ—¥å¸¸ç”Ÿæ´»ä¸­çš„äº‹ä»¶ï¼Œä¾‹å¦‚å½“é“ƒå£°å“èµ·æ—¶æ„å‘³ç€æœ‰äººæŒ‰äº†é—¨é“ƒï¼Œæˆ‘ä»¬å°±ä¼šå»å¼€é—¨ã€‚</p><h3 id="äº‹ä»¶çš„å·¥ä½œåŸç†" tabindex="-1"><a class="header-anchor" href="#äº‹ä»¶çš„å·¥ä½œåŸç†"><span>äº‹ä»¶çš„å·¥ä½œåŸç†</span></a></h3><p>Node.js ä½¿ç”¨äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå…¶ä¸­è§‚å¯Ÿè€…ï¼ˆç›‘å¬å™¨ï¼‰ä¼šè®¢é˜…æ„Ÿå…´è¶£çš„äº‹ä»¶ï¼Œå¹¶åœ¨äº‹ä»¶å‘ç”Ÿæ—¶è¢«è‡ªåŠ¨é€šçŸ¥ã€‚è¿™æ˜¯é€šè¿‡ä½¿ç”¨ <code>EventEmitter</code> ç±»å®ç°çš„ï¼Œå®ƒæ˜¯ Node.js äº‹ä»¶å¤„ç†çš„æ ¸å¿ƒã€‚</p><h3 id="å®é™…ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-5"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨å¤„ç†ä¸€ä¸ªç®€å•çš„åœºæ™¯ï¼Œæ¯”å¦‚ä¸€ä¸ªé˜Ÿåˆ—ç³»ç»Ÿï¼Œå…¶ä¸­é¡¹ç›®éœ€è¦æŒ‰é¡ºåºå¤„ç†ã€‚æˆ‘ä»¬å¯ä»¥æœ‰ä¸€ä¸ª <code>enqueue</code> äº‹ä»¶è¡¨ç¤ºä¸€ä¸ªæ–°çš„ä»»åŠ¡è¢«æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­ï¼Œå’Œä¸€ä¸ª <code>dequeue</code> äº‹ä»¶è¡¨ç¤ºä¸€ä¸ªä»»åŠ¡ä»é˜Ÿåˆ—ä¸­ç§»é™¤å¹¶å‡†å¤‡å¤„ç†ã€‚</p><p>è™½ç„¶æ²¡æœ‰ç›´æ¥ä½¿ç”¨ <code>Event: &#39;test:dequeue&#39;</code>ï¼Œä½†ä»¥ä¸‹æ˜¯å¦‚ä½•åœ¨ Node.js ä¸­å®ç°ä¸€ä¸ªç±»ä¼¼æœºåˆ¶çš„ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> EventEmitter</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;events&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> Queue</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> EventEmitter</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    super</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">items</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  enqueue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">item</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">item</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">emit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;enqueue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">item</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dequeue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> item</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">shift</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">emit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dequeue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">item</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> item</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> myQueue</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Queue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç›‘å¬ &#39;dequeue&#39; äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">myQueue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dequeue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">item</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`å¤„ç†é˜Ÿåˆ—é¡¹: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">item</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿå…¥é˜Ÿå’Œå‡ºé˜Ÿ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">myQueue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">enqueue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä»»åŠ¡1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">myQueue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">enqueue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä»»åŠ¡2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">myQueue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">dequeue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ­¤æ—¶ä¼šè§¦å‘ &#39;dequeue&#39; äº‹ä»¶ï¼Œå¹¶è¾“å‡º &quot;å¤„ç†é˜Ÿåˆ—é¡¹: ä»»åŠ¡1&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>Queue</code> ç±»ç»§æ‰¿è‡ª <code>EventEmitter</code>ã€‚æˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•ï¼š<code>enqueue</code> å’Œ <code>dequeue</code>ï¼Œåˆ†åˆ«ç”¨äºå‘é˜Ÿåˆ—æ·»åŠ é¡¹ç›®å’Œä»é˜Ÿåˆ—ç§»é™¤é¡¹ç›®ã€‚æ¯å½“è°ƒç”¨ <code>dequeue</code> æ–¹æ³•æ—¶ï¼Œéƒ½ä¼šå‘å‡ºä¸€ä¸ª <code>dequeue</code> äº‹ä»¶ï¼Œå¹¶å°†è¢«ç§»é™¤çš„é¡¹ä½œä¸ºå‚æ•°ä¼ é€’ç»™ç›‘å¬å™¨ã€‚</p><p>è¿™ä¸ªç®€å•çš„ä¾‹å­å±•ç¤ºäº†åœ¨ Node.js ä¸­å¦‚ä½•ä½¿ç”¨äº‹ä»¶æ¥å¤„ç†å¼‚æ­¥æ“ä½œï¼Œç±»ä¼¼åœ°ï¼Œå¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚ä½¿ç”¨ä¸åŒçš„äº‹ä»¶å’Œé€»è¾‘æ¥æ„å»ºå¤æ‚çš„åº”ç”¨ç¨‹åºã€‚</p><h3 id="event-test-diagnostic" tabindex="-1"><a class="header-anchor" href="#event-test-diagnostic"><span><a href="https://nodejs.org/docs/latest/api/test.html#event-testdiagnostic" target="_blank" rel="noopener noreferrer">Event: &#39;test:diagnostic&#39;</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©æˆ‘ä»¬å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚Node.js çš„å¼ºå¤§ä¹‹å¤„åœ¨äºå…¶äº‹ä»¶é©±åŠ¨å’Œéé˜»å¡ I/O ç‰¹æ€§ï¼Œè¿™ä½¿å¾—å®ƒç‰¹åˆ«é€‚åˆå¤„ç†æ•°æ®å¯†é›†å‹çš„å®æ—¶åº”ç”¨ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œæœ‰ä¸€ä¸ªç‰¹å®šçš„äº‹ä»¶å«åš <code>&#39;test:diagnostic&#39;</code>ã€‚è¿™ä¸ªäº‹ä»¶å±äº Node.js çš„æµ‹è¯•åŠŸèƒ½ä¸­çš„ä¸€éƒ¨åˆ†ã€‚è¦ç†è§£è¿™ä¸ªäº‹ä»¶ï¼Œé¦–å…ˆéœ€è¦äº†è§£ Node.js ä¸­çš„ Event Emitter å’Œç›‘å¬äº‹ä»¶çš„æ¦‚å¿µã€‚</p><h3 id="event-emitter" tabindex="-1"><a class="header-anchor" href="#event-emitter"><span>Event Emitter</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œå¾ˆå¤šå¯¹è±¡éƒ½ä¼šå‘å°„ï¼ˆemitï¼‰äº‹ä»¶ã€‚è¿™äº›å°±åƒæ˜¯ç°å®ç”Ÿæ´»ä¸­çš„äº‹ä»¶ä¸€æ · â€”â€” æ¯”å¦‚ï¼Œå½“ä½ æŒ‰ä¸‹ä¸€ä¸ªæŒ‰é’®æ—¶ï¼ŒæŒ‰é’®ä¼šâ€œå‘å°„â€ä¸€ä¸ªç‚¹å‡»äº‹ä»¶ã€‚åœ¨ Node.js ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºç›‘å¬å™¨æ¥â€œç›‘å¬â€è¿™äº›äº‹ä»¶ï¼Œå¹¶ä¸”å½“è¿™äº›äº‹ä»¶å‘ç”Ÿæ—¶æ‰§è¡Œä¸€äº›æ“ä½œã€‚</p><h3 id="test-diagnostic-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#test-diagnostic-äº‹ä»¶"><span><code>&#39;test:diagnostic&#39;</code> äº‹ä»¶</span></a></h3><p>è¿™ä¸ªäº‹ä»¶æ˜¯ä¸“é—¨ä¸ºæµ‹è¯•æ¡†æ¶è®¾è®¡çš„ã€‚å½“è¿è¡Œæµ‹è¯•æ—¶ï¼Œå¦‚æœæµ‹è¯•æ¡†æ¶æƒ³è¦æ”¶é›†ä¸€äº›è¯Šæ–­ä¿¡æ¯æˆ–è€…è¾“å‡ºä¸€äº›ä¸æµ‹è¯•ç›¸å…³çš„é¢å¤–ä¿¡æ¯ï¼Œå®ƒå°±ä¼šå‘å°„ <code>&#39;test:diagnostic&#39;</code> äº‹ä»¶ã€‚</p><h4 id="å®é™…è¿ç”¨ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-5"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h4><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ Node.js æ„å»ºä¸€ä¸ªåœ¨çº¿æ•™è‚²å¹³å°ï¼Œå¹¶ä¸”æˆ‘ä»¬æƒ³ç¡®ä¿æˆ‘ä»¬çš„åº”ç”¨åœ¨ä¸åŒçš„ç¯å¢ƒä¸‹éƒ½èƒ½æ­£å¸¸å·¥ä½œã€‚æˆ‘ä»¬å¯èƒ½ä¼šå†™ä¸€ç³»åˆ—çš„è‡ªåŠ¨åŒ–æµ‹è¯•æ¥æ£€æŸ¥è¿™ä¸€ç‚¹ã€‚åœ¨è¿™äº›æµ‹è¯•ä¸­ï¼Œå¯èƒ½ä¼šæœ‰ä¸€äº›å…³é”®ç‚¹æˆ‘ä»¬æƒ³è¦è¯¦ç»†è®°å½•ä¸‹æ¥ï¼Œæ¯”å¦‚æµ‹è¯•çš„å¯åŠ¨æ—¶é—´ã€æµ‹è¯•è¿‡ç¨‹ä¸­çš„å†…å­˜ä½¿ç”¨æƒ…å†µç­‰ç­‰ã€‚</p><ol><li><p><strong>å¯åŠ¨æ—¶é—´æ£€æµ‹</strong>ï¼šå½“æµ‹è¯•å¼€å§‹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å‘å°„ä¸€ä¸ª <code>&#39;test:diagnostic&#39;</code> äº‹ä»¶å¹¶é™„å¸¦æµ‹è¯•çš„å¯åŠ¨æ—¶é—´ã€‚</p></li><li><p><strong>å†…å­˜ä½¿ç”¨æŠ¥å‘Š</strong>ï¼šåœ¨æŸäº›å…³é”®çš„æµ‹è¯•æ­¥éª¤ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å‘å°„ <code>&#39;test:diagnostic&#39;</code> äº‹ä»¶æ¥æŠ¥å‘Šå½“å‰çš„å†…å­˜ä½¿ç”¨æƒ…å†µã€‚</p></li></ol><p>é€šè¿‡ç›‘å¬ <code>&#39;test:diagnostic&#39;</code> äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥æ”¶é›†åˆ°è¿™äº›ä¿¡æ¯ï¼Œå¹¶å°†å…¶ç”¨äºæ€§èƒ½åˆ†æã€èµ„æºä½¿ç”¨ä¼˜åŒ–ï¼Œç”šè‡³æ˜¯å‘ç°æ½œåœ¨çš„é—®é¢˜ç‚¹ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-3" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-3"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>åœ¨ Node.js ä¸­ä½¿ç”¨ <code>&#39;test:diagnostic&#39;</code> äº‹ä»¶ï¼Œé€šå¸¸æ¶‰åŠä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><ol><li><p><strong>å¼•å…¥å¿…è¦çš„æ¨¡å—</strong>ï¼šé¦–å…ˆï¼Œä½ éœ€è¦æœ‰ä¸€ä¸ªèƒ½å¤Ÿå‘å°„å’Œç›‘å¬äº‹ä»¶çš„ç¯å¢ƒã€‚è¿™é€šå¸¸æ˜¯é€šè¿‡ Node.js çš„ <code>EventEmitter</code> ç±»å®ç°çš„ã€‚</p></li><li><p><strong>å‘å°„äº‹ä»¶</strong>ï¼šåœ¨ä½ çš„æµ‹è¯•è„šæœ¬æˆ–æ¡†æ¶ä¸­çš„é€‚å½“ä½ç½®ï¼Œä½¿ç”¨ <code>.emit(&#39;test:diagnostic&#39;, data)</code> æ¥å‘å°„äº‹ä»¶ï¼Œå…¶ä¸­ <code>data</code> æ˜¯ä½ å¸Œæœ›éšäº‹ä»¶ä¼ é€’çš„ä¿¡æ¯ã€‚</p></li><li><p><strong>ç›‘å¬äº‹ä»¶</strong>ï¼šåœ¨ä½ å¸Œæœ›å¤„ç†è¿™äº›è¯Šæ–­ä¿¡æ¯çš„åœ°æ–¹ï¼Œè®¾ç½®ä¸€ä¸ªç›‘å¬å™¨æ¥ç›‘å¬ <code>&#39;test:diagnostic&#39;</code> äº‹ä»¶ï¼Œå¹¶å®šä¹‰ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥å¤„ç†æ¥æ”¶åˆ°çš„ä¿¡æ¯ã€‚</p></li></ol><p>è¯·æ³¨æ„ï¼Œç›´æ¥ä» Node.js å®˜æ–¹æ–‡æ¡£æˆ– API å˜æ›´è®°å½•è·å–æœ€æ–°çš„ä½¿ç”¨æ–¹æ³•å’Œç¤ºä¾‹ä»£ç æ€»æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œå› ä¸º Node.js æ­£åœ¨æŒç»­åœ°æ›´æ–°å’Œæ”¹è¿›ã€‚</p><p>å¸Œæœ›è¿™ä¸ªè§£é‡Šå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£äº† <code>&#39;test:diagnostic&#39;</code> äº‹ä»¶åŠå…¶åœ¨å®é™…å¼€å‘ä¸­çš„åº”ç”¨ï¼</p><h3 id="event-test-enqueue" tabindex="-1"><a class="header-anchor" href="#event-test-enqueue"><span><a href="https://nodejs.org/docs/latest/api/test.html#event-testenqueue" target="_blank" rel="noopener noreferrer">Event: &#39;test:enqueue&#39;</a></span></a></h3><p>Node.js ä¸­çš„ <code>Event: &#39;test:enqueue&#39;</code> æ˜¯ä¸€ä¸ªç‰¹å®šäº Node.js æµ‹è¯•æ¡†æ¶ï¼ˆé€šå¸¸æ˜¯å†…éƒ¨ä½¿ç”¨ï¼‰ç›¸å…³çš„äº‹ä»¶ã€‚åœ¨ v21.7.1 çš„æ–‡æ¡£ä¸­æåŠï¼ŒæŒ‡çš„æ˜¯å½“ä¸€ä¸ªæµ‹è¯•ä»»åŠ¡è¢«åŠ å…¥åˆ°æµ‹è¯•é˜Ÿåˆ—ä¸­æ—¶ä¼šè§¦å‘çš„äº‹ä»¶ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘å°†å°½é‡ç”¨ç®€å•çš„è¯­è¨€å’Œä¸€äº›å‡è®¾çš„åœºæ™¯æ¥è§£é‡Šå®ƒï¼Œå› ä¸ºå…·ä½“åˆ°è¿™ä¸ªäº‹ä»¶ï¼Œå®ƒæ›´å¤šåœ°åº”ç”¨äº Node.js å†…éƒ¨æˆ–è€…é‚£äº›æ·±åº¦ä¾èµ–äº Node.js æµ‹è¯•æœºåˆ¶çš„é«˜çº§ç”¨ä¾‹ã€‚</p><h3 id="åŸºç¡€æ¦‚å¿µ-2" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æ¦‚å¿µ-2"><span>åŸºç¡€æ¦‚å¿µ</span></a></h3><p>é¦–å…ˆï¼Œäº†è§£å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p><ul><li><strong>äº‹ä»¶é©±åŠ¨ç¼–ç¨‹</strong>ï¼šNode.js å¼ºå¤§çš„ä¸€é¢åœ¨äºå…¶éé˜»å¡ã€äº‹ä»¶é©±åŠ¨çš„ç‰¹æ€§ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œç¨‹åºä¼šåœ¨æŸä»¶äº‹æƒ…å‘ç”Ÿæ—¶ï¼ˆä¾‹å¦‚ï¼Œæ–‡ä»¶è¯»å–å®Œæ¯•ï¼‰è§¦å‘äº‹ä»¶ï¼Œå¹¶å“åº”è¿™äº›äº‹ä»¶è¿›è¡Œåç»­æ“ä½œã€‚</li><li><strong>æµ‹è¯•é˜Ÿåˆ—</strong>ï¼šåœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•å¸®åŠ©ç¡®ä¿ä½ çš„ä»£ç æŒ‰é¢„æœŸå·¥ä½œã€‚ä¸€ä¸ªæµ‹è¯•é˜Ÿåˆ—å°±æ˜¯å¾…è¿è¡Œçš„æµ‹è¯•ä»»åŠ¡çš„åˆ—è¡¨ï¼Œè¿™äº›ä»»åŠ¡ä¼šæŒ‰é¡ºåºæ‰§è¡Œã€‚</li></ul><h3 id="è§£é‡Š-event-test-enqueue" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-event-test-enqueue"><span>è§£é‡Š <code>Event: &#39;test:enqueue&#39;</code></span></a></h3><p>åœ¨ Node.js çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œ<code>&#39;test:enqueue&#39;</code> äº‹ä»¶å‘ç”Ÿçš„æ—¶åˆ»æ˜¯ï¼šå½“ä¸€ä¸ªæ–°çš„æµ‹è¯•ä»»åŠ¡è¢«æ·»åŠ åˆ°æµ‹è¯•é˜Ÿåˆ—ä¸­ï¼Œå³å°†ç­‰å¾…æ‰§è¡Œã€‚è¿™å¯¹äºç®¡ç†å’Œç›‘æ§æµ‹è¯•æµç¨‹éå¸¸æœ‰ç”¨ã€‚è™½ç„¶è¿™ä¸ªäº‹ä»¶å¯¹å¤§å¤šæ•°æ—¥å¸¸å¼€å‘è€…å¯èƒ½ä¸å¤ªç›´æ¥ç›¸å…³ï¼Œä½†å®ƒåœ¨æ¶‰åŠè‡ªå®šä¹‰æµ‹è¯•æµç¨‹æˆ–æ€§èƒ½ç›‘æ§æ–¹é¢å¾ˆæœ‰ä»·å€¼ã€‚</p><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-4" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-4"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨æ„å»ºä¸€ä¸ªå¤§å‹é¡¹ç›®ï¼Œå¹¶ä½¿ç”¨ Node.js ç¼–å†™äº†æ•°ç™¾ä¸ªè‡ªåŠ¨åŒ–æµ‹è¯•æ¥ç¡®ä¿ä»£ç è´¨é‡ã€‚ä½ å¯èƒ½æƒ³è¦æ›´ç»†è‡´åœ°ç›‘æ§æµ‹è¯•æµç¨‹çš„å„ä¸ªç¯èŠ‚ã€‚è¿™æ—¶ï¼Œä½ å¯ä»¥åˆ©ç”¨ <code>&#39;test:enqueue&#39;</code> äº‹ä»¶æ¥äº†è§£å“ªäº›æµ‹è¯•æ­£åœ¨è¢«åŠ å…¥é˜Ÿåˆ—ï¼Œä»¥åŠå®ƒä»¬è¢«æ·»åŠ çš„æ—¶é—´ç‚¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> EventEmitter</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;events&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> TestQueue</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> EventEmitter</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®ä¾‹åŒ–ä¸€ä¸ªæµ‹è¯•é˜Ÿåˆ—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> testQueue</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> TestQueue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç›‘å¬ &#39;test:enqueue&#39; äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">testQueue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;test:enqueue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Test added to queue: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿæ·»åŠ æµ‹è¯•åˆ°é˜Ÿåˆ—</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">testQueue</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">emit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;test:enqueue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;API Response Test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šè¿°ä»£ç æ˜¯ä¸€ä¸ªç®€åŒ–çš„ä¾‹å­ï¼Œå±•ç¤ºäº†å¦‚ä½•ç›‘å¬ <code>test:enqueue</code> äº‹ä»¶ã€‚å®é™…ä¸Šï¼ŒNode.js çš„å†…éƒ¨æµ‹è¯•æœºåˆ¶ä¼šæ›´å¤æ‚ï¼Œä½†åŸºæœ¬æ€è·¯ç›¸åŒâ€”â€”ç›‘å¬å’Œå“åº”äº‹ä»¶æ¥ç®¡ç†æµ‹è¯•æµç¨‹ã€‚</p><h3 id="ç»“è®º" tabindex="-1"><a class="header-anchor" href="#ç»“è®º"><span>ç»“è®º</span></a></h3><p>è™½ç„¶ <code>Event: &#39;test:enqueue&#39;</code> ä¸»è¦å…³è”äº Node.js å†…éƒ¨çš„æµ‹è¯•æœºåˆ¶ï¼Œäº†è§£å®ƒå¦‚ä½•å·¥ä½œæœ‰åŠ©äºæ·±å…¥ç†è§£ Node.js çš„äº‹ä»¶é©±åŠ¨æ¨¡å‹ä»¥åŠå¦‚ä½•åœ¨éœ€è¦æ—¶æ‰©å±•æˆ–ä¼˜åŒ–æµ‹è¯•æµç¨‹ã€‚å¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œé‡è¦çš„æ˜¯å…ˆæŒæ¡ Node.js ä¸­äº‹ä»¶ç›‘å¬å’Œå¤„ç†çš„åŸºæœ¬åŸç†ï¼Œéšç€ç»éªŒçš„ç§¯ç´¯ï¼Œå†é€æ­¥æ·±å…¥åˆ°æ›´å…·ä½“çš„åº”ç”¨åœºæ™¯ä¸­ã€‚</p><h3 id="event-test-fail" tabindex="-1"><a class="header-anchor" href="#event-test-fail"><span><a href="https://nodejs.org/docs/latest/api/test.html#event-testfail" target="_blank" rel="noopener noreferrer">Event: &#39;test:fail&#39;</a></span></a></h3><p>Node.js ä¸­çš„ <code>Event: &#39;test:fail&#39;</code> æ˜¯å…³äº Node.js çš„æµ‹è¯•æ¡†æ¶éƒ¨åˆ†ã€‚åœ¨è¿™ä¸ªä¸Šä¸‹æ–‡ä¸­ï¼Œç†è§£äº‹ä»¶å’Œå®ƒä»¬å¦‚ä½•å·¥ä½œæ˜¯å¾ˆé‡è¦çš„ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ˜ç™½ Node.js æ˜¯ä¸€ä¸ªåŸºäºäº‹ä»¶é©±åŠ¨çš„ç¯å¢ƒï¼Œèƒ½å¤Ÿç”¨æ¥æ„å»ºå„ç§åº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬ç½‘ç»œæœåŠ¡å™¨ã€å‘½ä»¤è¡Œå·¥å…·ç­‰ã€‚</p><h3 id="äº‹ä»¶æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#äº‹ä»¶æ˜¯ä»€ä¹ˆ"><span>äº‹ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h3><p>ç®€å•æ¥è¯´ï¼Œäº‹ä»¶æ˜¯åº”ç”¨ç¨‹åºä¸­å‘ç”Ÿçš„äº‹æƒ…æˆ–åŠ¨ä½œï¼Œä½ çš„ä»£ç å¯ä»¥å¯¹å…¶è¿›è¡Œç›‘å¬ï¼ˆå³ç­‰å¾…å®ƒå‘ç”Ÿï¼‰ï¼Œä¸€æ—¦å‘ç”Ÿäº†ç‰¹å®šçš„äº‹ä»¶ï¼Œå°±ä¼šè°ƒç”¨ç›¸åº”çš„å‡½æ•°æ¥å¤„ç†ã€‚è¿™ç±»ä¼¼äºç°å®ç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼šå¦‚æœä½ è®¢é˜…äº†ä¸€ä¸ªæ‚å¿—ï¼Œå½“æ–°ä¸€æœŸå‘å¸ƒæ—¶ï¼Œä½ ä¼šæ”¶åˆ°é€šçŸ¥ï¼ˆäº‹ä»¶ï¼‰ï¼Œç„¶åä½ å¯èƒ½ä¼šå»é˜…è¯»å®ƒï¼ˆå“åº”äº‹ä»¶ï¼‰ã€‚</p><h3 id="event-test-fail-çš„å«ä¹‰" tabindex="-1"><a class="header-anchor" href="#event-test-fail-çš„å«ä¹‰"><span><code>Event: &#39;test:fail&#39;</code> çš„å«ä¹‰</span></a></h3><p>åœ¨ Node.js çš„æµ‹è¯•æ¡†æ¶ä¸­ï¼Œ<code>Event: &#39;test:fail&#39;</code> ç‰¹æŒ‡ä¸€ä¸ªæµ‹è¯•å¤±è´¥çš„äº‹ä»¶ã€‚è¿™æ„å‘³ç€å½“ä½ è¿è¡Œæµ‹è¯•ç”¨ä¾‹ï¼Œè€ŒæŸä¸ªç”¨ä¾‹æ²¡æœ‰æŒ‰ç…§é¢„æœŸé‚£æ ·æ‰§è¡Œï¼ˆæ¯”å¦‚ï¼ŒæœŸæœ›çš„ç»“æœä¸å®é™…ç»“æœä¸åŒ¹é…ï¼‰ï¼Œ&quot;test:fail&quot; äº‹ä»¶å°±ä¼šè¢«è§¦å‘ã€‚</p><h3 id="å®é™…è¿ç”¨ä¸¾ä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¸¾ä¾‹-1"><span>å®é™…è¿ç”¨ä¸¾ä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç®€å•çš„è®¡ç®—å™¨åº”ç”¨ï¼Œå¹¶ä½¿ç”¨ Node.js çš„æµ‹è¯•æ¡†æ¶æ¥ç¡®ä¿æ¯ä¸ªåŠŸèƒ½éƒ½æŒ‰é¢„æœŸå·¥ä½œã€‚ä½ å¯èƒ½æœ‰ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹æ¥æ£€æŸ¥â€œåŠ æ³•â€åŠŸèƒ½ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åŠ æ³•åŠŸèƒ½&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åº”è¯¥æ­£ç¡®è®¡ç®—ä¸¤ä¸ªæ•°å­—çš„å’Œ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å‡è®¾è¿™æ˜¯æˆ‘ä»¬çš„åŠ æ³•å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> sum</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æˆ‘ä»¬æœŸæœ›2åŠ 3çš„ç»“æœæ˜¯5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœç”±äºæŸäº›åŸå› ï¼ˆæ¯”å¦‚ï¼Œåœ¨<code>add</code>å‡½æ•°å†…éƒ¨æœ‰ä¸€ä¸ªé”™è¯¯ï¼‰ï¼Œ<code>add(2, 3)</code>çš„ç»“æœä¸æ˜¯ 5ï¼Œé‚£ä¹ˆè¿™ä¸ªæµ‹è¯•ç”¨ä¾‹å°±ä¼šå¤±è´¥ã€‚å½“è¿™ä¸ªæµ‹è¯•ç”¨ä¾‹å¤±è´¥æ—¶ï¼Œ<code>test:fail</code>äº‹ä»¶å°†è¢«è§¦å‘ã€‚</p><h3 id="å¦‚ä½•å“åº”-test-fail-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•å“åº”-test-fail-äº‹ä»¶"><span>å¦‚ä½•å“åº” <code>test:fail</code> äº‹ä»¶</span></a></h3><p>è™½ç„¶åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¸éœ€è¦ç›´æ¥ç›‘å¬<code>test:fail</code>äº‹ä»¶ï¼ˆæµ‹è¯•æ¡†æ¶ä¼šä¸ºä½ å¤„ç†ï¼‰ï¼Œä½†ç†è§£è¿™ä¸ªæ¦‚å¿µå¯¹äºæ·±å…¥äº†è§£ Node.js çš„äº‹ä»¶é©±åŠ¨æ¨¡å‹ä»¥åŠå¦‚ä½•æ„å»ºå¤æ‚çš„å¼‚æ­¥æµç¨‹æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚</p><p>æ€»ä¹‹ï¼Œ<code>Event: &#39;test:fail&#39;</code> åœ¨ Node.js æµ‹è¯•æ¡†æ¶ä¸­ä»£è¡¨äº†ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹æœªèƒ½é€šè¿‡çš„äº‹ä»¶ã€‚äº†è§£è¿™ä¸ªäº‹ä»¶ä»¥åŠæ›´å¹¿æ³›åœ°äº†è§£äº‹ä»¶å¦‚ä½•åœ¨ Node.js ä¸­è¿ä½œå¯ä»¥å¸®åŠ©ä½ æ›´å¥½åœ°è®¾è®¡å’Œç†è§£ä½ çš„åº”ç”¨ç¨‹åºçš„è¡Œä¸ºã€‚</p><h3 id="event-test-pass" tabindex="-1"><a class="header-anchor" href="#event-test-pass"><span><a href="https://nodejs.org/docs/latest/api/test.html#event-testpass" target="_blank" rel="noopener noreferrer">Event: &#39;test:pass&#39;</a></span></a></h3><p>Node.js çš„ &quot;Event: &#39;test:pass&#39;&quot; æ˜¯åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­å¼•å…¥çš„ä¸€ä¸ªäº‹ä»¶ï¼Œè¿™æ˜¯ä¸“é—¨ç”¨äºæµ‹è¯•æœŸé—´çš„äº‹ä»¶ç›‘å¬å™¨ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯ Node.js çš„ä¸€éƒ¨åˆ†ï¼Œå°¤å…¶æ˜¯å®ƒçš„æµ‹è¯•æ¡†æ¶ã€‚åœ¨ç¼–å†™å’Œè¿è¡Œæµ‹è¯•ä»£ç æ—¶ï¼Œäº†è§£ä¸åŒçš„äº‹ä»¶ä»¥åŠå¦‚ä½•å“åº”è¿™äº›äº‹ä»¶æ˜¯éå¸¸é‡è¦çš„ã€‚</p><h3 id="è§£é‡Š-3" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-3"><span>è§£é‡Š</span></a></h3><p>åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œç‰¹åˆ«æ˜¯è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•æ—¶ï¼Œ&quot;æµ‹è¯•é€šè¿‡(test pass)&quot; å’Œ &quot;æµ‹è¯•å¤±è´¥(test fail)&quot; æ˜¯ä¸¤ä¸ªå¸¸è§çš„æ¦‚å¿µã€‚å½“ä½ è¿è¡Œä¸€ä¸ªæµ‹è¯•å¥—ä»¶ï¼ˆä¸€ç»„æµ‹è¯•ï¼‰æ—¶ï¼Œæ¯ä¸ªæµ‹è¯•æ¡ˆä¾‹éƒ½ä¼šè¢«æ‰§è¡Œä»¥éªŒè¯ä»£ç çš„æŸéƒ¨åˆ†æ˜¯å¦æŒ‰é¢„æœŸå·¥ä½œã€‚å¦‚æœæµ‹è¯•æ¡ˆä¾‹éªŒè¯çš„ä»£ç å®ç°æ»¡è¶³äº†æµ‹è¯•æ¡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªæµ‹è¯•å°±è¢«è§†ä¸ºâ€œé€šè¿‡(pass)â€ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œâ€œEvent: &#39;test:pass&#39;â€è¿™ä¸ªäº‹ä»¶å°±æ˜¯åœ¨ä¸€ä¸ªæµ‹è¯•æ¡ˆä¾‹é€šè¿‡åè§¦å‘çš„ã€‚ä½ å¯ä»¥åœ¨æµ‹è¯•ä»£ç ä¸­ç›‘å¬è¿™ä¸ªäº‹ä»¶ï¼Œå¹¶å®šä¹‰å½“äº‹ä»¶å‘ç”Ÿæ—¶åº”è¯¥æ‰§è¡Œçš„æ“ä½œã€‚è¿™å¯¹äºè·Ÿè¸ªæµ‹è¯•çš„è¿›åº¦ã€ç”Ÿæˆæµ‹è¯•æŠ¥å‘Šæˆ–è€…åšä¸€äº›æ¸…ç†å·¥ä½œç­‰æƒ…å†µå¾ˆæœ‰å¸®åŠ©ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-9" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-9"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><ol><li><p><strong>ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š</strong>ï¼š<br> å‡è®¾ä½ æ­£åœ¨è‡ªåŠ¨åŒ–åœ°è¿è¡Œå¤§é‡çš„æµ‹è¯•æ¡ˆä¾‹ï¼Œä½ å¯èƒ½æƒ³çŸ¥é“å“ªäº›æµ‹è¯•é€šè¿‡äº†ï¼Œå“ªäº›å¤±è´¥äº†ã€‚é€šè¿‡ç›‘å¬â€œtest:passâ€äº‹ä»¶ï¼Œä½ å¯ä»¥åœ¨æ¯ä¸ªæµ‹è¯•é€šè¿‡æ—¶è®°å½•ä¸‹æ¥ï¼Œå¹¶åœ¨æ‰€æœ‰æµ‹è¯•å®Œæˆåç”Ÿæˆä¸€ä¸ªæ±‡æ€»æŠ¥å‘Šã€‚</p></li><li><p><strong>å®æ—¶åé¦ˆ</strong>ï¼š<br> åœ¨ä¸€ä¸ªæŒç»­é›†æˆçš„ç¯å¢ƒä¸­ï¼Œå¾—åˆ°å³æ—¶çš„æµ‹è¯•åé¦ˆæ˜¯éå¸¸é‡è¦çš„ã€‚ä½ å¯ä»¥è®¾ç½®ä¸€ä¸ªç›‘å¬å™¨æ¥æ•æ‰â€œtest:passâ€äº‹ä»¶ï¼Œå¹¶è®©å®ƒå‘é€é€šçŸ¥ç»™å›¢é˜Ÿçš„èŠå¤©å®¤æˆ–è€…æ›´æ–°çœ‹æ¿ï¼Œè¿™æ ·å›¢é˜Ÿæˆå‘˜å°±èƒ½å®æ—¶çœ‹åˆ°æœ€æ–°çš„æµ‹è¯•çŠ¶æ€ã€‚</p></li><li><p><strong>èµ„æºæ¸…ç†</strong>ï¼š<br> åœ¨ä¸€äº›æµ‹è¯•æ¡ˆä¾‹ä¸­ï¼Œä½ å¯èƒ½éœ€è¦é…ç½®ä¸´æ—¶çš„æ•°æ®åº“æ¡ç›®æˆ–è€…åˆ›å»ºä¸´æ—¶æ–‡ä»¶ã€‚é€šè¿‡ç›‘å¬&quot;test:pass&quot;äº‹ä»¶ï¼Œä½ å¯ä»¥åœ¨æµ‹è¯•é€šè¿‡ä¹‹åç«‹åˆ»è¿›è¡Œæ¸…ç†å·¥ä½œï¼Œç¡®ä¿ä¸ä¼šç•™ä¸‹æ— ç”¨çš„æ•°æ®æˆ–æ–‡ä»¶ã€‚</p></li></ol><h3 id="å¦‚ä½•ä½¿ç”¨-4" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-4"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>åœ¨ Node.js çš„æµ‹è¯•æ¡†æ¶ä¸­ï¼Œä½ å¯ä»¥ç”¨ç±»ä¼¼äºä»¥ä¸‹çš„æ–¹å¼æ¥ç›‘å¬&quot;test:pass&quot;äº‹ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> EventEmitter</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;events&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> MyEmitter</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> EventEmitter</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> myEmitter</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> MyEmitter</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç›‘å¬ &#39;test:pass&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">myEmitter</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;test:pass&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A test passed!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿä¸€ä¸ªæµ‹è¯•é€šè¿‡çš„äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">myEmitter</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">emit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;test:pass&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼Œä¸Šé¢çš„ä»£ç åªæ˜¯ä¸ºäº†æ¼”ç¤ºå¦‚ä½•ç›‘å¬å’Œè§¦å‘äº‹ä»¶ï¼Œå¹¶ä¸æ˜¯ Node.js æµ‹è¯•æ¡†æ¶çš„å®é™…ä½¿ç”¨æ–¹å¼ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å°†ä½¿ç”¨ Node.js çš„æµ‹è¯•åº“ï¼ˆä¾‹å¦‚ Mocha æˆ– Jestï¼‰æ¥ç¼–å†™æµ‹è¯•ï¼Œè¿™äº›åº“å†…éƒ¨ä¼šå¤„ç†äº‹ä»¶çš„è§¦å‘ä¸ç›‘å¬ã€‚</p><p>è®°ä½ï¼Œè™½ç„¶ &quot;Event: &#39;test:pass&#39;&quot; æä¾›äº†å¼ºå¤§çš„å·¥å…·æ¥å¸®åŠ©ä½ ç®¡ç†å’Œå“åº”æµ‹è¯•è¿‡ç¨‹ä¸­çš„äº‹ä»¶ï¼Œä½†æ­£ç¡®åœ°ä½¿ç”¨äº‹ä»¶ç›‘å¬ä¸å¤„ç†è¿˜éœ€è¦ä¸€å®šçš„å­¦ä¹ å’Œå®è·µã€‚</p><h3 id="event-test-plan" tabindex="-1"><a class="header-anchor" href="#event-test-plan"><span><a href="https://nodejs.org/docs/latest/api/test.html#event-testplan" target="_blank" rel="noopener noreferrer">Event: &#39;test:plan&#39;</a></span></a></h3><p>Node.js åœ¨å…¶ v21.7.1 ç‰ˆæœ¬ä¸­å¼•å…¥äº†ä¸€äº›æ–°åŠŸèƒ½å’Œæ”¹è¿›ï¼Œå…¶ä¸­ä¹‹ä¸€æ˜¯åœ¨æµ‹è¯•æ¨¡å—ï¼ˆtest moduleï¼‰ç›¸å…³çš„äº‹ä»¶ <code>&#39;test:plan&#39;</code>ã€‚è¿™éƒ¨åˆ†ä¸»è¦æ¶‰åŠåˆ° Node.js çš„æµ‹è¯•æ¨¡å—ï¼Œå®ƒæ˜¯ä¸ºäº†å¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°æ§åˆ¶å’Œç†è§£ä»–ä»¬çš„æµ‹è¯•è®¡åˆ’ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç®€å•åœ°äº†è§£ä¸€ä¸‹ Node.js å’Œå®ƒçš„æµ‹è¯•æ¨¡å—ã€‚</p><p><strong>Node.js ç®€ä»‹</strong></p><p>Node.js æ˜¯ä¸€ä¸ªå¼€æºã€è·¨å¹³å°çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨ JavaScript æ¥ç¼–å†™åç«¯ä»£ç ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¼ ç»Ÿä¸Šç”¨äºå‰ç«¯å¼€å‘çš„å·¥ä½œã€‚Node.js éå¸¸é€‚åˆæ„å»ºé«˜æ€§èƒ½çš„ç½‘ç»œåº”ç”¨ç¨‹åºã€‚</p><p><strong>æµ‹è¯•æ¨¡å—</strong></p><p>æµ‹è¯•æ¨¡å—ï¼ˆé€šå¸¸æŒ‡çš„æ˜¯ Node.js ä¸­çš„æµ‹è¯•æ¡†æ¶ï¼Œæ¯”å¦‚ Mocha, Jest ç­‰ï¼‰å…è®¸å¼€å‘è€…å¯¹ä»–ä»¬çš„ä»£ç è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œç¡®ä¿ä»£ç æŒ‰é¢„æœŸå·¥ä½œï¼Œä¹Ÿæ–¹ä¾¿åœ¨æœªæ¥ä¿®æ”¹ä»£ç æ—¶æ£€æŸ¥æ˜¯å¦ç ´åäº†ç°æœ‰åŠŸèƒ½ã€‚æµ‹è¯•æœ‰å¾ˆå¤šç§ç±»ï¼ŒåŒ…æ‹¬å•å…ƒæµ‹è¯•ï¼ˆæµ‹è¯•å•ä¸ªç»„ä»¶æˆ–å‡½æ•°ï¼‰ã€é›†æˆæµ‹è¯•ï¼ˆæµ‹è¯•å¤šä¸ªç»„ä»¶ååŒå·¥ä½œï¼‰ã€ç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆæµ‹è¯•å®Œæ•´çš„ç”¨æˆ·åœºæ™¯ï¼‰ç­‰ã€‚</p><p><strong>Event: &#39;test:plan&#39; è§£é‡Š</strong></p><p><code>&#39;test:plan&#39;</code> äº‹ä»¶æ˜¯ Node.js æµ‹è¯•æ¨¡å—ä¸­çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå½“ä½ ä½¿ç”¨ Node.js çš„æµ‹è¯•æ¡†æ¶æ—¶ï¼Œè¿™ä¸ªäº‹ä»¶ä¼šåœ¨æµ‹è¯•è®¡åˆ’å¼€å§‹æ‰§è¡Œæ—¶è§¦å‘ã€‚ä¸€ä¸ªâ€œæµ‹è¯•è®¡åˆ’â€æŒ‡çš„æ˜¯ä¸€ä¸ªåŒ…å«äº†å¤šä¸ªæµ‹è¯•ç”¨ä¾‹ï¼ˆtest casesï¼‰çš„é›†åˆï¼Œè¿™äº›ç”¨ä¾‹å°†ä¼šè¢«æ‰§è¡Œæ¥éªŒè¯ä½ çš„ä»£ç ã€‚</p><p>å…·ä½“åˆ° <code>&#39;test:plan&#39;</code> äº‹ä»¶ï¼Œå®ƒå…è®¸ä½ åœ¨æµ‹è¯•è®¡åˆ’å¼€å§‹ä¹‹å‰åšä¸€äº›å‡†å¤‡å·¥ä½œæˆ–è®¾ç½®ï¼Œæ¯”å¦‚ï¼š</p><ul><li>åˆå§‹åŒ–éœ€è¦åœ¨å¤šä¸ªæµ‹è¯•ç”¨ä¾‹ä¸­å…±äº«çš„èµ„æºæˆ–æ•°æ®ã€‚</li><li>è®°å½•æµ‹è¯•å¼€å§‹çš„æ—¶é—´ï¼Œä»¥ä¾¿è®¡ç®—æ•´ä¸ªæµ‹è¯•å¥—ä»¶çš„æ‰§è¡Œæ—¶é—´ã€‚</li><li>è®¾ç½®å…¨å±€å˜é‡æˆ–ç¯å¢ƒå˜é‡ï¼Œè¿™äº›å˜é‡åœ¨æ¥ä¸‹æ¥çš„æµ‹è¯•ç”¨ä¾‹ä¸­å¯èƒ½ä¼šç”¨åˆ°ã€‚</li></ul><p><strong>å®é™…è¿ç”¨ç¤ºä¾‹</strong></p><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª web åº”ç”¨ï¼Œå¹¶ä¸”ä½ æƒ³è¦æµ‹è¯•ä½ çš„ç”¨æˆ·ç™»å½•åŠŸèƒ½ã€‚ä½ çš„æµ‹è¯•è®¡åˆ’å¯èƒ½åŒ…å«å¤šä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œä¾‹å¦‚ï¼š</p><ol><li>æµ‹è¯•ç”¨æˆ·ä½¿ç”¨æ­£ç¡®çš„é‚®ç®±å’Œå¯†ç æ˜¯å¦èƒ½æˆåŠŸç™»å½•ã€‚</li><li>æµ‹è¯•ç”¨æˆ·ä½¿ç”¨é”™è¯¯çš„å¯†ç æ˜¯å¦ä¼šæ”¶åˆ°ç™»å½•å¤±è´¥çš„æç¤ºã€‚</li><li>æµ‹è¯•ç”¨æˆ·å°è¯•ç™»å½•æ¬¡æ•°è¿‡å¤šæ—¶æ˜¯å¦ä¼šè¢«é”å®šã€‚</li></ol><p>åœ¨è¿™ä¸ªæµ‹è¯•è®¡åˆ’å¼€å§‹ä¹‹å‰ï¼Œä½¿ç”¨ <code>&#39;test:plan&#39;</code> äº‹ä»¶ï¼Œä½ å¯ä»¥åšä¸€äº›å‡†å¤‡å·¥ä½œï¼Œæ¯”å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;test:plan&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åˆå§‹åŒ–æ•°æ®åº“è¿æ¥</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  initializeDatabaseConnection</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ¸…ç†æ•°æ®åº“ä¸­çš„æµ‹è¯•æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  clearTestData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åˆ›å»ºæµ‹è¯•æ‰€éœ€çš„è™šæ‹Ÿç”¨æˆ·</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  createTestUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">email</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;test@example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;securepassword&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å±•ç¤ºäº†åœ¨ <code>&#39;test:plan&#39;</code> äº‹ä»¶è§¦å‘æ—¶ï¼Œä½ å¯ä»¥å¦‚ä½•å‡†å¤‡æµ‹è¯•ç¯å¢ƒï¼šåˆå§‹åŒ–æ•°æ®åº“è¿æ¥ã€æ¸…ç†ä¸Šä¸€æ¬¡æµ‹è¯•é—ç•™çš„æ•°æ®ã€åˆ›å»ºæµ‹è¯•ä¸­å°†ä¼šç”¨åˆ°çš„è™šæ‹Ÿç”¨æˆ·ã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œ<code>&#39;test:plan&#39;</code> äº‹ä»¶åœ¨ Node.js v21.7.1 ä¸­æä¾›äº†ä¸€ä¸ªå¾ˆå¥½çš„æœºä¼šï¼Œåœ¨æµ‹è¯•è®¡åˆ’æ‰§è¡Œä¹‹å‰è®¾ç½®æµ‹è¯•ç¯å¢ƒï¼Œç¡®ä¿æ¯æ¬¡æµ‹è¯•éƒ½åœ¨æ¸…æ´å’Œä¸€è‡´çš„ç¯å¢ƒä¸‹è¿è¡Œï¼Œä»è€Œä½¿å¾—æµ‹è¯•ç»“æœæ›´åŠ å¯é å’Œå‡†ç¡®ã€‚</p><h3 id="event-test-start" tabindex="-1"><a class="header-anchor" href="#event-test-start"><span><a href="https://nodejs.org/docs/latest/api/test.html#event-teststart" target="_blank" rel="noopener noreferrer">Event: &#39;test:start&#39;</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚å®ƒä»¥å…¶é«˜æ€§èƒ½å’Œäº‹ä»¶é©±åŠ¨çš„ç‰¹æ€§è‘—ç§°ã€‚Node.js ä¸­æœ‰å¾ˆå¤šå†…ç½®æ¨¡å—å’Œäº‹ä»¶ï¼Œå¸®åŠ©æˆ‘ä»¬æ›´è½»æ¾åœ°å¼€å‘åº”ç”¨ç¨‹åºã€‚ä»Šå¤©ï¼Œæˆ‘ä¼šå‘ä½ ä»‹ç» Node.js v21.7.1 ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªç‰¹å®šäº‹ä»¶ï¼š<code>test:start</code>ã€‚</p><h3 id="event-test-start-1" tabindex="-1"><a class="header-anchor" href="#event-test-start-1"><span>Event: &#39;test:start&#39;</span></a></h3><p>è¿™ä¸ªäº‹ä»¶æ˜¯åœ¨ Node.js çš„æµ‹è¯•æ¡†æ¶ä¸­å‡ºç°çš„ã€‚åœ¨ v21.7.1 ç‰ˆæœ¬ä¸­ï¼ŒNode.js å¼•å…¥äº†ä¸€äº›æ–°çš„ç‰¹æ€§å’Œæ”¹è¿›ï¼Œå…¶ä¸­å°±åŒ…æ‹¬å®ƒè‡ªå·±çš„æµ‹è¯•æ¡†æ¶ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ç›´æ¥åœ¨ Node.js ç¯å¢ƒä¸­å†™å’Œè¿è¡Œæµ‹è¯•ï¼Œè€Œä¸éœ€è¦é¢å¤–å®‰è£…ç¬¬ä¸‰æ–¹åº“å¦‚ Mocha æˆ– Jestã€‚è¿™å¯¹äºç¡®ä¿ä½ çš„ä»£ç è´¨é‡å’Œç¨³å®šæ€§éå¸¸æœ‰å¸®åŠ©ã€‚</p><p>å½“ä½ å¼€å§‹æ‰§è¡Œä¸€ä¸ªæµ‹è¯•å¥—ä»¶æ—¶ï¼Œ<code>test:start</code>äº‹ä»¶ä¼šè¢«è§¦å‘ã€‚äº‹ä»¶ç›‘å¬å™¨å¯ä»¥ç›‘å¬åˆ°è¿™ä¸ªäº‹ä»¶çš„å‘ç”Ÿï¼Œä½¿å¾—ä½ å¯ä»¥åœ¨æµ‹è¯•æ­£å¼å¼€å§‹ä¹‹å‰æ‰§è¡Œä¸€äº›æ“ä½œï¼Œæ¯”å¦‚åˆå§‹åŒ–æµ‹è¯•ç¯å¢ƒã€è®°å½•æ—¥å¿—ä¿¡æ¯æˆ–è€…è®¾ç½®æµ‹è¯•æ‰€éœ€çš„å…¨å±€å˜é‡ç­‰ã€‚</p><h4 id="å®é™…è¿ç”¨ä¾‹å­-6" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-6"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h4><p>æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œè¯´æ˜å¦‚ä½•åˆ©ç”¨<code>test:start</code>äº‹ä»¶ï¼š</p><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Web åº”ç”¨ï¼Œå¹¶æƒ³è¦æµ‹è¯•ä½ çš„ API æ˜¯å¦æŒ‰é¢„æœŸå·¥ä½œã€‚ä½ å¯èƒ½ä¼šå†™ä¸€ä¸ªæµ‹è¯•æ¡ˆä¾‹æ¥å‘é€ HTTP è¯·æ±‚åˆ°ä½ çš„ APIï¼Œå¹¶æ£€æŸ¥è¿”å›ç»“æœæ˜¯å¦æ­£ç¡®ã€‚</p><ol><li><strong>åˆå§‹åŒ–æµ‹è¯•</strong>ï¼š<br> åœ¨æµ‹è¯•å¼€å§‹ä¹‹å‰ï¼Œä½ å¯èƒ½éœ€è¦å¯åŠ¨ä½ çš„åº”ç”¨æœåŠ¡å™¨ã€è¿æ¥æ•°æ®åº“æˆ–è€…åšä¸€äº›å‡†å¤‡å·¥ä½œã€‚ä½¿ç”¨<code>test:start</code>äº‹ä»¶ï¼Œä½ å¯ä»¥åœ¨æµ‹è¯•æ­£å¼å¼€å§‹å‰å®Œæˆè¿™äº›åˆå§‹åŒ–å·¥ä½œã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> testRunner</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">testRunner</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;test:start&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æµ‹è¯•å¼€å§‹ï¼Œè¿›è¡Œåˆå§‹åŒ–...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¯åŠ¨æœåŠ¡å™¨</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿æ¥æ•°æ®åº“ç­‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>å†™ä¸€ä¸ªæµ‹è¯•æ¡ˆä¾‹</strong>ï¼š<br> å‡è®¾ä½ çš„åº”ç”¨æœ‰ä¸€ä¸ªè¿”å›â€œHello, World!â€çš„ API æ¥å£ï¼Œä½ æƒ³è¦æµ‹è¯•è¿™ä¸ªæ¥å£æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fetch</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node-fetch&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½¿ç”¨node-fetchæ¥å‘é€HTTPè¯·æ±‚</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">testRunner</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æµ‹è¯• /hello æ¥å£&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> response</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http://localhost:3000/hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> text</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> response</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>æ‰§è¡Œæµ‹è¯•å¹¶ç›‘å¬äº‹ä»¶</strong>ï¼š<br> å½“ä½ è¿è¡Œæµ‹è¯•è„šæœ¬æ—¶ï¼Œ<code>test:start</code>äº‹ä»¶å°†è¢«è§¦å‘ï¼Œç„¶åä½ çš„æµ‹è¯•æ¡ˆä¾‹å°†ä¼šæ‰§è¡Œã€‚å¦‚æœæ‰€æœ‰å‡†å¤‡å·¥ä½œéƒ½å·²å®Œæˆï¼Œä½ çš„ API æµ‹è¯•å°†ä¼šè¿è¡Œï¼Œå¹¶éªŒè¯ API è¿”å›å€¼æ˜¯å¦ç¬¦åˆæœŸæœ›ã€‚</li></ol><p>é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œ<code>test:start</code>äº‹ä»¶ä¸ºä½ æä¾›äº†ä¸€ä¸ªä¾¿æ·çš„æœºåˆ¶æ¥å‡†å¤‡å’Œç®¡ç†æµ‹è¯•ç¯å¢ƒï¼Œç¡®ä¿æµ‹è¯•çš„é¡ºåˆ©è¿›è¡Œã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œ<code>test:start</code>äº‹ä»¶æ˜¯ Node.js æµ‹è¯•æ¡†æ¶ä¸­çš„ä¸€ä¸ªå°è€Œå®ç”¨çš„åŠŸèƒ½ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ æ›´å¥½åœ°æ§åˆ¶å’Œç®¡ç†æµ‹è¯•æµç¨‹ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦è¿›è¡Œå¤æ‚åˆå§‹åŒ–æ“ä½œçš„åœºæ™¯ä¸‹ã€‚é€šè¿‡ç›‘å¬å’Œå“åº”è¿™ä¸ªäº‹ä»¶ï¼Œä½ å¯ä»¥ç¡®ä¿æµ‹è¯•åœ¨ä¸€ä¸ªæ­£ç¡®é…ç½®ä¸”å‡†å¤‡å°±ç»ªçš„ç¯å¢ƒä¸­æ‰§è¡Œï¼Œä»è€Œæé«˜æµ‹è¯•çš„å¯é æ€§å’Œæœ‰æ•ˆæ€§ã€‚</p><h3 id="event-test-stderr" tabindex="-1"><a class="header-anchor" href="#event-test-stderr"><span><a href="https://nodejs.org/docs/latest/api/test.html#event-teststderr" target="_blank" rel="noopener noreferrer">Event: &#39;test:stderr&#39;</a></span></a></h3><p>è¦äº†è§£ Node.js ä¸­çš„ <code>Event: &#39;test:stderr&#39;</code> äº‹ä»¶ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç†è§£å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼šNode.jsã€äº‹ä»¶ã€æµ‹è¯•æ¡†æ¶ä»¥åŠæ ‡å‡†é”™è¯¯è¾“å‡ºï¼ˆstderrï¼‰ã€‚</p><h3 id="åŸºç¡€æ¦‚å¿µ-3" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æ¦‚å¿µ-3"><span>åŸºç¡€æ¦‚å¿µï¼š</span></a></h3><ol><li><p><strong>Node.js</strong> æ˜¯ä¸€ä¸ªèƒ½å¤Ÿåœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç çš„å¹³å°ã€‚å®ƒå…è®¸å¼€å‘è€…ä½¿ç”¨ JavaScript æ¥ç¼–å†™åç«¯ä»£ç ï¼Œè¿™åœ¨ Node.js å‡ºç°ä¹‹å‰æ˜¯ä¸å¯èƒ½çš„äº‹æƒ…ã€‚</p></li><li><p><strong>äº‹ä»¶</strong> åœ¨ Node.js ä¸­æ˜¯ä¸€é¡¹æ ¸å¿ƒæ¦‚å¿µã€‚Node.js å¤§é‡ä½¿ç”¨äº†äº‹ä»¶é©±åŠ¨çš„æ¶æ„ï¼Œè¿™æ„å‘³ç€å½“æŸäº›äº‹æƒ…å‘ç”Ÿæ—¶ï¼ˆæ¯”å¦‚è¯»å–æ–‡ä»¶å®Œæˆï¼‰ï¼Œä¼šè§¦å‘å¯¹åº”çš„äº‹ä»¶ï¼Œå¹¶æ‰§è¡Œç»‘å®šåˆ°è¿™ä¸ªäº‹ä»¶ä¸Šçš„å›è°ƒå‡½æ•°ã€‚</p></li><li><p><strong>æµ‹è¯•æ¡†æ¶</strong> ç”¨äºè‡ªåŠ¨åŒ–è¿›è¡Œä»£ç æµ‹è¯•ï¼Œç¡®ä¿ä»£ç æŒ‰ç…§é¢„æœŸé‚£æ ·å·¥ä½œã€‚æµ‹è¯•æ˜¯å¼€å‘è¿‡ç¨‹ä¸­éå¸¸é‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œæœ‰åŠ©äºåŠæ—©å‘ç°é”™è¯¯å’Œé—®é¢˜ã€‚</p></li><li><p><strong>æ ‡å‡†é”™è¯¯è¾“å‡ºï¼ˆstderrï¼‰</strong> æ˜¯è®¡ç®—æœºç¨‹åºé€šå¸¸ç”¨äºè¾“å‡ºé”™è¯¯æˆ–è¯Šæ–­ä¿¡æ¯çš„ä¸€ç§æ–¹å¼ã€‚</p></li></ol><h3 id="event-test-stderr-1" tabindex="-1"><a class="header-anchor" href="#event-test-stderr-1"><span>Event: &#39;test:stderr&#39;</span></a></h3><p>åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­æåˆ°çš„ <code>Event: &#39;test:stderr&#39;</code> äº‹ä»¶ï¼Œè¿™æ˜¯åœ¨ Node.js çš„æµ‹è¯•ç¯å¢ƒä¸­ç‰¹åˆ«å®šä¹‰çš„äº‹ä»¶ã€‚è¿™é‡Œçš„ â€œtestâ€ æŒ‡çš„æ˜¯æ­£åœ¨è¿è¡Œçš„æµ‹è¯•æ¡ˆä¾‹ï¼Œè€Œ â€œstderrâ€ åˆ™æ˜¯æŒ‡é”™è¯¯ä¿¡æ¯çš„æ ‡å‡†è¾“å‡ºæµã€‚</p><p>å½“åœ¨ Node.js æµ‹è¯•ç¯å¢ƒä¸‹ï¼Œä¸€ä¸ªæµ‹è¯•æ¡ˆä¾‹è¿è¡Œè¿‡ç¨‹ä¸­äº§ç”Ÿäº†æ ‡å‡†é”™è¯¯è¾“å‡ºï¼ˆä¹Ÿå°±æ˜¯å‡ºç°äº†ä¸€äº›é”™è¯¯æˆ–è­¦å‘Šç­‰éœ€è¦è¢«è®°å½•çš„ä¿¡æ¯ï¼‰ï¼Œ<code>&#39;test:stderr&#39;</code> äº‹ä»¶å°±ä¼šè¢«è§¦å‘ã€‚è¿™ä¸ºå¼€å‘è€…æä¾›äº†ä¸€ä¸ªç›‘å¬å’Œå¤„ç†è¿™äº›é”™è¯¯è¾“å‡ºçš„æœºä¼šï¼Œè¿›è€Œå¯ä»¥æ›´æœ‰æ•ˆåœ°è°ƒè¯•å’Œä¿®å¤ä»£ç ä¸­çš„é—®é¢˜ã€‚</p><h4 id="å®é™…åº”ç”¨ç¤ºä¾‹-5" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-5"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ä½¿ç”¨ Node.js çš„æŸä¸ªæµ‹è¯•æ¡†æ¶ç¼–å†™æµ‹è¯•æ¡ˆä¾‹ï¼Œæ£€æŸ¥ä¸€ä¸ªå‡½æ•°æ˜¯å¦æ­£ç¡®åœ°æ‰§è¡Œäº†å…¶åŠŸèƒ½ã€‚ä½†åœ¨è¿è¡Œæµ‹è¯•æ—¶ï¼Œè¯¥å‡½æ•°å› ä¸ºæŸäº›åŸå› æŠ›å‡ºäº†ä¸€ä¸ªé”™è¯¯ï¼Œè¿™ä¸ªé”™è¯¯ä¿¡æ¯å°±ä¼šé€šè¿‡ stderr è¾“å‡ºã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç®€å•çš„æµ‹è¯•æ¡ˆä¾‹æ¨¡æ‹Ÿ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æœ‰ä¸€ä¸ªéœ€è¦æµ‹è¯•çš„å‡½æ•° myFunction</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> myFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Something went wrong!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹è¯•æ¡†æ¶ä¸­çš„ä¸€æ®µä»£ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  myFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stderr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç›‘å¬ &#39;test:stderr&#39; äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;test:stderr&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ•è·åˆ° stderr è¾“å‡º:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ç¤ºä¾‹ä¸­ï¼Œå½“ <code>myFunction</code> æŠ›å‡ºé”™è¯¯æ—¶ï¼Œæˆ‘ä»¬é€šè¿‡ <code>process.stderr.write()</code> æ–¹æ³•å°†é”™è¯¯ä¿¡æ¯å†™å…¥ stderrã€‚å¦‚æœæµ‹è¯•ç¯å¢ƒæ”¯æŒ <code>&#39;test:stderr&#39;</code> äº‹ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ç›‘å¬è¿™ä¸ªäº‹ä»¶æ¥æ•è·å¹¶å¤„ç†è¿™äº›é”™è¯¯ä¿¡æ¯ï¼Œæ¯”å¦‚è®°å½•æ—¥å¿—æˆ–è¿›è¡Œç‰¹å®šçš„é”™è¯¯å¤„ç†æµç¨‹ã€‚</p><p>è¯·æ³¨æ„ï¼Œä¸Šè¿°ä»£ç æ˜¯ä¸€ä¸ªç®€åŒ–çš„ç¤ºä¾‹ï¼Œå®é™…ä¸Š Node.js æ ‡å‡†åº“ä¸­å¹¶æ²¡æœ‰ç›´æ¥æ”¯æŒ <code>&#39;test:stderr&#39;</code> è¿™æ ·çš„äº‹ä»¶ï¼Œè¿™æ›´å¤šæ˜¯ä¾èµ–äºå…·ä½“çš„æµ‹è¯•æ¡†æ¶å¦‚ä½•å®ç°å’Œç®¡ç†æµ‹è¯•è¿‡ç¨‹ä¸­çš„é”™è¯¯è¾“å‡ºã€‚ä¸åŒçš„æµ‹è¯•æ¡†æ¶å¯èƒ½æœ‰ä¸åŒçš„æœºåˆ¶æ¥å¤„ç†æµ‹è¯•ä¸­çš„é”™è¯¯å’Œè¾“å‡ºã€‚</p><h3 id="event-test-stdout" tabindex="-1"><a class="header-anchor" href="#event-test-stdout"><span><a href="https://nodejs.org/docs/latest/api/test.html#event-teststdout" target="_blank" rel="noopener noreferrer">Event: &#39;test:stdout&#39;</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>Event: &#39;test:stdout&#39;</code> æ˜¯ä¸€ä¸ªä¸æµ‹è¯•ç›¸å…³çš„äº‹ä»¶ï¼Œä½†æˆ‘ä»¬è¦å…ˆæ¾„æ¸…ä¸€ç‚¹ï¼šæˆªè‡³æˆ‘æœ€åæ›´æ–°çš„ä¿¡æ¯ï¼ŒNode.js å®˜æ–¹æ–‡æ¡£ä¸­å¹¶æ²¡æœ‰ç›´æ¥æåŠä¸€ä¸ªåä¸º <code>test:stdout</code> çš„äº‹ä»¶ã€‚é€šå¸¸ï¼ŒNode.js çš„æ–‡æ¡£ä¼šè¯¦ç»†åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„ API å’Œäº‹ä»¶ã€‚å› æ­¤ï¼Œè¿™ä¸ªé—®é¢˜å¯èƒ½æºäºä¸€ä¸ªè¯¯è§£æˆ–ç‰¹å®šç‰ˆæœ¬çš„æ–‡æ¡£ä¸­çš„ä¸€ä¸ªä¸å¸¸è§ç‰¹æ€§ã€‚</p><p>ä¸è¿‡ï¼Œè®©æˆ‘ä»¬åŸºäºé—®é¢˜ä¸­æåˆ°çš„æ¦‚å¿µè¿›è¡Œæ¢è®¨ï¼Œå¹¶ç»“åˆ Node.js ä¸­çš„äº‹ä»¶å’Œæ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰å¦‚ä½•å·¥ä½œæ¥è§£é‡Šã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-node-js" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-node-js"><span>ä»€ä¹ˆæ˜¯ Node.jsï¼Ÿ</span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªå¼€æºå’Œè·¨å¹³å°çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚å®ƒéå¸¸é€‚åˆå¼€å‘éœ€è¦é«˜æ€§èƒ½ã€IO å¯†é›†å‹ï¼ˆå¦‚æ–‡ä»¶å¤„ç†ã€ç½‘ç»œé€šä¿¡ç­‰ï¼‰çš„åº”ç”¨ç¨‹åºã€‚</p><h3 id="äº‹ä»¶ç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#äº‹ä»¶ç³»ç»Ÿ"><span>äº‹ä»¶ç³»ç»Ÿ</span></a></h3><p>Node.js æœ‰ä¸€ä¸ªå†…å»ºçš„æ¨¡å— <code>events</code>ï¼Œä½¿å¾—å¤„ç†äº‹ä»¶å˜å¾—ç®€å•ã€‚ä½ å¯ä»¥åˆ›å»ºã€è§¦å‘å’Œç›‘å¬è‡ªå®šä¹‰äº‹ä»¶ã€‚è¿™å¯¹äºæ„å»ºé«˜æ•ˆçš„å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹éå¸¸æœ‰ç”¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> EventEmitter</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;events&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> MyEmitter</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> EventEmitter</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®ä¾‹åŒ–ä¸€ä¸ªäº‹ä»¶å‘å°„å™¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> myEmitter</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> MyEmitter</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç›‘å¬äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">myEmitter</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;event&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä¸€ä¸ªäº‹ä»¶è¢«è§¦å‘ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è§¦å‘äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">myEmitter</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">emit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;event&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ ‡å‡†è¾“å‡º-stdout" tabindex="-1"><a class="header-anchor" href="#æ ‡å‡†è¾“å‡º-stdout"><span>æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰</span></a></h3><p><code>stdout</code> æ˜¯æŒ‡â€œæ ‡å‡†è¾“å‡ºæµâ€ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>process.stdout</code> æä¾›äº†ä¸€ä¸ªå†™å…¥æ ‡å‡†è¾“å‡ºçš„æµã€‚å®ƒå¯ä»¥ç”¨æ¥æ‰“å°æ—¥å¿—æˆ–è€…è¾“å‡ºä¿¡æ¯ç»™ç”¨æˆ·ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stdout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, World!</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šåœ¨ç»ˆç«¯æ˜¾ç¤º &quot;Hello, World!&quot;ã€‚</p><h3 id="ç»“åˆæ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#ç»“åˆæ¦‚å¿µ"><span>ç»“åˆæ¦‚å¿µ</span></a></h3><p>å‡è®¾å­˜åœ¨ <code>Event: &#39;test:stdout&#39;</code>ï¼Œå®ƒå¯èƒ½æ˜¯æŒ‡åœ¨æµ‹è¯•æœŸé—´ï¼Œå½“æœ‰æ•°æ®å†™å…¥åˆ°æ ‡å‡†è¾“å‡ºæ—¶è§¦å‘çš„ä¸€ä¸ªäº‹ä»¶ã€‚è¿™æ ·çš„æœºåˆ¶åœ¨è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ã€ç›‘æ§æµ‹è¯•è¾“å‡ºå†…å®¹æ—¶ä¼šå¾ˆæœ‰ç”¨ã€‚</p><h4 id="å®é™…åº”ç”¨ç¤ºä¾‹-6" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-6"><span>å®é™…åº”ç”¨ç¤ºä¾‹ï¼š</span></a></h4><p>è™½ç„¶ç›´æ¥çš„ <code>test:stdout</code> äº‹ä»¶ä¸å­˜åœ¨ï¼Œä½†æˆ‘ä»¬å¯ä»¥æ¨¡æ‹Ÿä¸€ä¸ªåœºæ™¯ï¼Œæ¯”å¦‚ä¸€ä¸ªç®€å•çš„æµ‹è¯•æ¡†æ¶ï¼Œå®ƒåœ¨æµ‹è¯•é€šè¿‡æ—¶å‘ <code>stdout</code> è¾“å‡ºç»“æœï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> EventEmitter</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;events&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> TestFramework</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> EventEmitter</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    super</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  runTest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">testName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">testFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Running </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">testName</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">...`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">      testFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">emit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;test:stdout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">testName</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: PASS</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">emit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;test:stdout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">testName</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: FAIL</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> myTestFramework</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> TestFramework</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">myTestFramework</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;test:stdout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">output</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stdout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">output</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">myTestFramework</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">runTest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Example Test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> !==</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>TestFramework</code> ç±»ç»§æ‰¿è‡ª <code>EventEmitter</code>ã€‚å®ƒå¯ä»¥è¿è¡Œæµ‹è¯•å¹¶åœ¨æµ‹è¯•é€šè¿‡æ—¶è§¦å‘ <code>test:stdout</code> äº‹ä»¶ï¼Œé€šè¿‡ç›‘å¬è¿™ä¸ªäº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¾“å‡ºå†…å®¹å†™å…¥æ ‡å‡†è¾“å‡ºã€‚</p><p>æ³¨æ„ï¼Œä¸Šè¿°ä»£ç æ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿçš„ä¾‹å­ï¼Œæ—¨åœ¨å±•ç¤ºå¦‚ä½•é€šè¿‡äº‹ä»¶å’Œæ ‡å‡†è¾“å‡ºç»“åˆä½¿ç”¨æ¥å®ç°ç±»ä¼¼åŠŸèƒ½ï¼Œå¹¶ä¸ä»£è¡¨ Node.js ä¸­å®é™…å­˜åœ¨ <code>test:stdout</code> äº‹ä»¶ã€‚</p><h3 id="event-testdrained" tabindex="-1"><a class="header-anchor" href="#event-testdrained"><span><a href="https://nodejs.org/docs/latest/api/test.html#event-testwatchdrained" target="_blank" rel="noopener noreferrer">Event: &#39;testâŒšdrained&#39;</a></span></a></h3><p>è¦ç†è§£ Node.js v21.7.1 ä¸­<code>Event: &#39;test:watch:drained&#39;</code>çš„æ¦‚å¿µå’Œåº”ç”¨ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦åˆ†è§£å’Œç†è§£å‡ ä¸ªå…³é”®ç‚¹ï¼šNode.jsã€äº‹ä»¶ï¼ˆEventï¼‰ã€ä»¥åŠåœ¨è¿™ä¸ªä¸Šä¸‹æ–‡ä¸­&quot;drained&quot;çš„å«ä¹‰ã€‚</p><p><strong>Node.js ç®€ä»‹</strong><br> Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå®ƒè®©å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚Node.js ç‰¹åˆ«æ“…é•¿å¤„ç† I/O å¯†é›†å‹ä»»åŠ¡ï¼Œå¦‚ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶æ“ä½œç­‰ï¼Œå®ƒé€šè¿‡äº‹ä»¶é©±åŠ¨ã€éé˜»å¡ I/O æ¨¡å‹æ¥é«˜æ•ˆå¤„ç†å¤šä»»åŠ¡ã€‚</p><p><strong>äº‹ä»¶ï¼ˆEventï¼‰æœºåˆ¶</strong><br> Node.js å¤§é‡ä½¿ç”¨äº‹ä»¶ï¼ˆEventsï¼‰æœºåˆ¶ã€‚åœ¨ Node.js ä¸­ï¼Œå¾ˆå¤šå¯¹è±¡éƒ½ä¼šè§¦å‘äº‹ä»¶ï¼šä¾‹å¦‚ï¼Œä¸€ä¸ªç½‘ç»œè¿æ¥çš„å»ºç«‹ï¼ˆ&#39;connect&#39;äº‹ä»¶ï¼‰ï¼Œä¸€ä¸ªæ–‡ä»¶è¯»å–å®Œæˆï¼ˆ&#39;read&#39;äº‹ä»¶ï¼‰ã€‚å¼€å‘è€…å¯ä»¥å¯¹è¿™äº›äº‹ä»¶è¿›è¡Œç›‘å¬ï¼Œå½“äº‹ä»¶å‘ç”Ÿæ—¶æ‰§è¡Œç›¸åº”çš„å¤„ç†å‡½æ•°ã€‚</p><p><strong>&#39;testâŒšdrained&#39; äº‹ä»¶ç®€ä»‹</strong><br> åœ¨ Node.js çš„æµ‹è¯•ç¯å¢ƒä¸­ï¼Œç‰¹åˆ«æ˜¯å½“ä½ ä½¿ç”¨äº†--watch æ¨¡å¼æ¥ç›‘è§†æ–‡ä»¶å˜åŠ¨è‡ªåŠ¨é‡æ–°è¿è¡Œæµ‹è¯•æ—¶ï¼Œ<code>&#39;test:watch:drained&#39;</code>äº‹ä»¶è¡¨ç°å…¶ç‰¹æœ‰çš„æ„ä¹‰ã€‚è¿™ä¸ªäº‹ä»¶åœ¨æµ‹è¯•ç”¨ä¾‹é˜Ÿåˆ—è¢«&quot;è€—å°½&quot;ï¼ˆå³æ‰€æœ‰æ’é˜Ÿçš„æµ‹è¯•ç”¨ä¾‹éƒ½å·²ç»è¿è¡Œå®Œæ¯•ï¼‰æ—¶è§¦å‘ã€‚</p><p><strong>å®é™…åº”ç”¨æ¡ˆä¾‹</strong></p><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web æœåŠ¡ï¼Œå¹¶é‡‡ç”¨ TDDï¼ˆæµ‹è¯•é©±åŠ¨å¼€å‘ï¼‰æ–¹æ³•ã€‚ä½ ä¸ºè¿™ä¸ªæœåŠ¡ç¼–å†™äº†ä¸€ç³»åˆ—è‡ªåŠ¨åŒ–çš„æµ‹è¯•ç”¨ä¾‹ï¼Œå¹¶å¸Œæœ›æ¯å½“æºä»£ç å‘ç”Ÿå˜æ›´æ—¶ï¼Œèƒ½å¤Ÿè‡ªåŠ¨é‡æ–°è¿è¡Œè¿™äº›æµ‹è¯•ç”¨ä¾‹ã€‚Node.js å…è®¸ä½ ä½¿ç”¨<code>--watch</code>æ¨¡å¼æ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p><ol><li><p><strong>è‡ªåŠ¨åŒ–æµ‹è¯•æµç¨‹è®¾ç½®</strong>ï¼š</p><ul><li>ä½ å¯åŠ¨äº† Node.js çš„æµ‹è¯•å·¥å…·ï¼ˆæ¯”å¦‚ Jestã€Mocha ç­‰ï¼‰ï¼Œå¹¶å¼€å¯äº†<code>--watch</code>æ¨¡å¼ã€‚</li><li>å½“ä½ ç¼–è¾‘å¹¶ä¿å­˜ä»£ç æ–‡ä»¶æ—¶ï¼Œæµ‹è¯•å·¥å…·ä¼šæ„ŸçŸ¥åˆ°æ–‡ä»¶å˜åŠ¨ï¼Œå¹¶è‡ªåŠ¨é‡æ–°è¿è¡Œç›¸å…³çš„æµ‹è¯•ç”¨ä¾‹ã€‚</li></ul></li><li><p><strong>åˆ©ç”¨<code>&#39;test:watch:drained&#39;</code>äº‹ä»¶è¿›è¡Œæ‰©å±•</strong>ï¼š</p><ul><li>å‡è®¾ä½ æƒ³åœ¨æ‰€æœ‰æµ‹è¯•éƒ½é€šè¿‡åï¼Œè‡ªåŠ¨éƒ¨ç½²ä½ çš„ Web æœåŠ¡åˆ°æµ‹è¯•ç¯å¢ƒã€‚</li><li>ä½ å¯ä»¥ç›‘å¬<code>&#39;test:watch:drained&#39;</code>äº‹ä»¶ï¼Œå½“æ­¤äº‹ä»¶è§¦å‘ï¼Œå³è¡¨ç¤ºæ‰€æœ‰æ’é˜Ÿçš„æµ‹è¯•ç”¨ä¾‹éƒ½å·²ç»è¢«æ‰§è¡Œäº†ä¸€éã€‚</li><li>åœ¨äº‹ä»¶çš„å›è°ƒå¤„ç†å‡½æ•°ä¸­ï¼Œä½ å¯ä»¥æ£€æŸ¥æµ‹è¯•ç»“æœï¼Œå¦‚æœæ‰€æœ‰æµ‹è¯•éƒ½é€šè¿‡ï¼Œåˆ™æ‰§è¡Œéƒ¨ç½²è„šæœ¬ã€‚</li></ul></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">testRunner</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;test:watch:drained&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">allTestsPassed</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    deployToStaging</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œ<code>testRunner</code>ä»£è¡¨çš„æ˜¯ä½ çš„æµ‹è¯•è¿è¡Œå™¨å®ä¾‹ï¼Œ<code>allTestsPassed</code>æ˜¯ä¸€ä¸ªå‡è®¾çš„å‡½æ•°ï¼Œç”¨æ¥åˆ¤æ–­æ‰€æœ‰æµ‹è¯•æ˜¯å¦é€šè¿‡ï¼Œè€Œ<code>deployToStaging</code>åˆ™æ˜¯è´Ÿè´£éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒçš„å‡½æ•°ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œ<code>&#39;test:watch:drained&#39;</code>äº‹ä»¶æˆä¸ºäº†é“¾æ¥ä½ çš„æµ‹è¯•ç»“æœä¸åç»­æ“ä½œï¼ˆå¦‚éƒ¨ç½²ï¼‰çš„æ¡¥æ¢ï¼Œè®©æ•´ä¸ªå¼€å‘æµç¨‹æ›´åŠ è‡ªåŠ¨åŒ–ä¸é«˜æ•ˆã€‚</p><h2 id="class-testcontext" tabindex="-1"><a class="header-anchor" href="#class-testcontext"><span><a href="https://nodejs.org/docs/latest/api/test.html#class-testcontext" target="_blank" rel="noopener noreferrer">Class: TestContext</a></span></a></h2><p>å½“ä½ å¼€å§‹è¿›å…¥ç¼–ç¨‹ä¸–ç•Œï¼Œå°¤å…¶æ˜¯ Web å¼€å‘çš„æ—¶å€™ï¼ŒNode.js æ˜¯ä¸€ä¸ªä¸å¯æˆ–ç¼ºçš„æŠ€æœ¯ã€‚Node.js å…è®¸ä½ ä½¿ç”¨ JavaScript æ¥æ„å»ºæœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨åŒä¸€ç§è¯­è¨€æ¥ç¼–å†™å‰ç«¯å’Œåç«¯ä»£ç ï¼Œæå¤§åœ°æé«˜äº†å¼€å‘æ•ˆç‡ã€‚</p><p>ä½†ä»Šå¤©æˆ‘ä»¬è¦æ¢è®¨çš„å¹¶é Node.js çš„é€šå¸¸ç”¨é€”ï¼Œè€Œæ˜¯å®ƒåœ¨ 21.7.1 ç‰ˆæœ¬ä¸­å¼•å…¥çš„ä¸€ä¸ªç‰¹å®šåŠŸèƒ½ï¼š<code>TestContext</code> ç±»ã€‚</p><h3 id="testcontext-ç±»ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#testcontext-ç±»ç®€ä»‹"><span>TestContext ç±»ç®€ä»‹</span></a></h3><p>åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œæµ‹è¯•æ˜¯ç¡®ä¿ä½ çš„åº”ç”¨è¿è¡Œå¦‚é¢„æœŸçš„å…³é”®ç¯èŠ‚ã€‚Node.js ä¸ºæ­¤æä¾›äº†è®¸å¤šå·¥å…·å’Œåº“ï¼Œæ¯”å¦‚<code>assert</code>æ¨¡å—ï¼Œä»¥åŠæ›´å…¨é¢çš„æµ‹è¯•æ¡†æ¶å¦‚ Mochaã€Jest ç­‰ã€‚<code>TestContext</code>ç±»æ˜¯ Node.js å†…å»ºçš„æµ‹è¯•åŠŸèƒ½çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªä¸Šä¸‹æ–‡ï¼ˆå³ç¯å¢ƒæˆ–èŒƒå›´ï¼‰ï¼Œè¿™ä¸ªä¸Šä¸‹æ–‡ç‰¹åˆ«é€‚ç”¨äºè¿›è¡Œå•å…ƒæµ‹è¯•ã€‚</p><p>å•å…ƒæµ‹è¯•æŒ‡çš„æ˜¯å¯¹è½¯ä»¶åº”ç”¨ä¸­æœ€å°å¯æµ‹è¯•å•å…ƒè¿›è¡Œæ£€æŸ¥å’ŒéªŒè¯ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªè®¡ç®—å™¨åº”ç”¨ä¸­ï¼Œæ¯ä¸€ä¸ªæ‰§è¡ŒåŠ æ³•ã€å‡æ³•æˆ–ä¹˜æ³•çš„å‡½æ•°éƒ½å¯ä»¥æ˜¯ä¸€ä¸ªå•å…ƒã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-testcontext" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-testcontext"><span>å¦‚ä½•ä½¿ç”¨ TestContext</span></a></h3><p><code>TestContext</code>ç±»ä¸»è¦ä½œç”¨æ˜¯å¸®åŠ©ç®¡ç†å’Œç»´æŠ¤æµ‹è¯•è¿‡ç¨‹ä¸­çš„çŠ¶æ€å’Œç¯å¢ƒã€‚å®ƒå…è®¸ä½ è®¾ç½®ä¸€äº›å‰ææ¡ä»¶ï¼ˆsetupï¼‰ï¼Œæ‰§è¡Œæµ‹è¯•ï¼Œç„¶åè¿›è¡Œæ¸…ç†ï¼ˆteardownï¼‰ã€‚è™½ç„¶ Node.js çš„å®˜æ–¹æ–‡æ¡£æä¾›äº†åŸºæœ¬çš„ API è¯´æ˜ï¼Œä½†æ²¡æœ‰ç»™å‡ºå…·ä½“çš„å®ä¾‹ä»£ç ã€‚å› æ­¤ï¼Œæˆ‘å°†åŸºäº<code>TestContext</code>ç±»çš„æ¦‚å¿µï¼Œæä¾›ä¸€ä¸ªå‡æƒ³çš„ä½¿ç”¨åœºæ™¯æ¥å¸®ä½ ç†è§£ã€‚</p><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨ç¼–å†™ä¸€ä¸ªåœ¨çº¿å•†åŸçš„åå°æœåŠ¡ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªåŠŸèƒ½æ˜¯è®¡ç®—ç”¨æˆ·è®¢å•çš„æ€»ä»·ã€‚æˆ‘ä»¬å¯ä»¥ä¸ºè¿™ä¸ªåŠŸèƒ½ç¼–å†™ä¸€ä¸ªæµ‹è¯•ï¼Œä½¿ç”¨<code>TestContext</code>æ¥ç®¡ç†æµ‹è¯•æµç¨‹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯æˆ‘ä»¬çš„è®¢å•ç±»</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> Order</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">items</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¢å•ä¸­çš„å•†å“é¡¹ [{price: 10}, {price: 20}]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  getTotal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">items</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">reduce</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">acc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">item</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> acc</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> item</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">price</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹è¯•ç”¨ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> testOrderTotal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è®¾ç½®é˜¶æ®µï¼šå‡†å¤‡æµ‹è¯•æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> order</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Order</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([{ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">price</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">price</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ‰§è¡Œé˜¶æ®µï¼šè°ƒç”¨æ–¹æ³•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> total</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> order</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getTotal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // éªŒè¯é˜¶æ®µï¼šä½¿ç”¨assertç¡®è®¤ç»“æœæ˜¯å¦ç¬¦åˆé¢„æœŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">total</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è®¢å•çš„æ€»é‡‘é¢åº”è¯¥æ˜¯30&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾çš„TestContextä½¿ç”¨æ–¹å¼ï¼ˆNode.jså®é™…ä¸Šå¯èƒ½ä¸åŒ…å«ä»¥ä¸‹APIï¼Œè¿™åªæ˜¯ä¸ºäº†ç¤ºä¾‹ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> testContext</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> TestContext</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">testContext</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">testOrderTotal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æµ‹è¯•æˆåŠŸï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æµ‹è¯•å¤±è´¥ï¼š&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª<code>Order</code>ç±»ï¼Œå®ƒæœ‰ä¸€ä¸ª<code>getTotal</code>æ–¹æ³•ç”¨äºè®¡ç®—è®¢å•çš„æ€»é¢ã€‚æˆ‘ä»¬çš„æµ‹è¯•å‡½æ•°<code>testOrderTotal</code>åˆ›å»ºäº†ä¸€ä¸ª<code>Order</code>å®ä¾‹ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªæ–­è¨€æ¥æ£€æŸ¥<code>getTotal</code>æ–¹æ³•è¿”å›çš„å€¼æ˜¯å¦æ­£ç¡®ã€‚</p><p>è¯·æ³¨æ„ï¼Œè¿™é‡Œçš„<code>TestContext</code>çš„ä½¿ç”¨æ˜¯å‡è®¾æ€§çš„ï¼Œæ—¨åœ¨å¸®åŠ©è§£é‡Šæ¦‚å¿µã€‚å®é™…ä¸Šï¼ŒNode.js çš„<code>TestContext</code>ç±»å¯èƒ½æœ‰ä¸åŒçš„ API å’Œç”¨æ³•ã€‚ä½†æ ¸å¿ƒæ€æƒ³æ˜¯åˆ©ç”¨<code>TestContext</code>æ¥ç®¡ç†æµ‹è¯•çš„å‡†å¤‡ã€æ‰§è¡Œå’Œæ¸…ç†å·¥ä½œï¼Œä»è€Œä½¿å¾—æµ‹è¯•ä»£ç æ›´åŠ æ¸…æ™°å’Œæ˜“äºç»´æŠ¤ã€‚</p><h3 id="å®é™…åº”ç”¨-2" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨-2"><span>å®é™…åº”ç”¨</span></a></h3><p>åœ¨å®é™…çš„ Node.js é¡¹ç›®ä¸­ï¼Œä½ å¯èƒ½ä¼šä½¿ç”¨ä¸“é—¨çš„æµ‹è¯•æ¡†æ¶ï¼ˆå¦‚ Jest æˆ– Mochaï¼‰æ¥ç¼–å†™å’Œè¿è¡Œæµ‹è¯•ã€‚è¿™äº›æ¡†æ¶é€šå¸¸æä¾›äº†è‡ªå·±çš„ä¸Šä¸‹æ–‡ç®¡ç†åŠŸèƒ½ï¼Œæ¯”å¦‚ Jest çš„<code>beforeEach</code>å’Œ<code>afterEach</code>é’©å­ã€‚ä½†äº†è§£ Node.js å†…å»ºçš„æµ‹è¯•åŠŸèƒ½ï¼Œå¦‚<code>TestContext</code>ç±»ï¼Œä»ç„¶æ˜¯éå¸¸æœ‰ä»·å€¼çš„ï¼Œå› ä¸ºå®ƒåŠ æ·±äº†ä½ å¯¹æµ‹è¯•æµç¨‹ç®¡ç†çš„ç†è§£ã€‚</p><p>æ€»ä¹‹ï¼Œ<code>TestContext</code>ç±»æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªå·¥å…·ï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°ç¼–å†™å’Œç®¡ç†æµ‹è¯•ä»£ç ã€‚é€šè¿‡æä¾›ä¸€ä¸ªç»Ÿä¸€çš„ä¸Šä¸‹æ–‡æ¥è¿›è¡Œæµ‹è¯•çš„è®¾ç½®ã€æ‰§è¡Œå’Œæ¸…ç†ï¼Œå®ƒæœ‰åŠ©äºä½¿æµ‹è¯•è¿‡ç¨‹å˜å¾—æ›´åŠ é«˜æ•ˆå’Œæœ‰åºã€‚</p><h3 id="context-before-fn-options" tabindex="-1"><a class="header-anchor" href="#context-before-fn-options"><span><a href="https://nodejs.org/docs/latest/api/test.html#contextbeforefn-options" target="_blank" rel="noopener noreferrer">context.before([fn][, options])</a></span></a></h3><p>å½“æˆ‘ä»¬è°ˆåˆ° Node.jsï¼Œæˆ‘ä»¬é€šå¸¸æŒ‡çš„æ˜¯ä¸€ä¸ªèƒ½è®© JavaScript åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œçš„å¹³å°ã€‚Node.js ä¸ºå¼€å‘è€…æä¾›äº†å¾ˆå¤šå·¥å…·å’Œåº“ï¼Œä»¥ä¾¿äºåˆ›å»ºé«˜æ€§èƒ½çš„ç½‘ç»œåº”ç”¨ã€‚è®©æˆ‘ä»¬æ·±å…¥ä¸€ç‚¹ï¼Œè®¨è®º Node.js v21.7.1 ä¸­çš„ä¸€ä¸ªç‰¹å®šåŠŸèƒ½ï¼š<code>context.before([fn][, options])</code>ã€‚</p><h3 id="ç†è§£-context-before-fn-options" tabindex="-1"><a class="header-anchor" href="#ç†è§£-context-before-fn-options"><span>ç†è§£ <code>context.before([fn][, options])</code></span></a></h3><p><code>context.before</code> æ˜¯ Node.js çš„æµ‹è¯•æ¡†æ¶ä¸­æä¾›çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå®šä¹‰ä¸€äº›åœ¨å®é™…æµ‹è¯•æ‰§è¡Œä¹‹å‰éœ€è¦è¿è¡Œçš„å‡†å¤‡å·¥ä½œæˆ–åˆå§‹åŒ–ä»£ç ã€‚è¿™ä¸ªå‡½æ•°æ˜¯å¼‚æ­¥çš„ï¼Œæ„å‘³ç€ä½ å¯ä»¥åœ¨å…¶ä¸­æ‰§è¡Œå¼‚æ­¥æ“ä½œï¼Œå¹¶ä¸”æµ‹è¯•æ¡†æ¶ä¼šç­‰å¾…è¿™äº›æ“ä½œå®Œæˆåå†ç»§ç»­æ‰§è¡Œåé¢çš„æµ‹è¯•ã€‚</p><h4 id="å‚æ•°-2" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-2"><span>å‚æ•°</span></a></h4><ul><li><code>fn</code>: è¿™æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä»£è¡¨åœ¨æµ‹è¯•ä¹‹å‰éœ€è¦æ‰§è¡Œçš„ä»£ç ã€‚</li><li><code>options</code> (å¯é€‰): ä¸€ä¸ªå¯¹è±¡ï¼Œä½ å¯ä»¥é€šè¿‡å®ƒæ¥é…ç½®ä¸€äº›é¢å¤–çš„é€‰é¡¹ï¼Œæ¯”å¦‚è®¾ç½®è¶…æ—¶æ—¶é—´ç­‰ã€‚</li></ul><p>è¿™ä¸ªå‡½æ•°éå¸¸é€‚åˆè®¾ç½®æµ‹è¯•ç¯å¢ƒï¼Œæ¯”å¦‚è¿æ¥æ•°æ®åº“ã€å‡†å¤‡æµ‹è¯•æ•°æ®ç­‰ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-10" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-10"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œå¹¶ä½¿ç”¨ Node.js ä½œä¸ºåç«¯ã€‚æˆ‘ä»¬æƒ³è¦æµ‹è¯•ç”¨æˆ·æ³¨å†Œçš„åŠŸèƒ½ï¼Œè¿™éœ€è¦æ•°æ®åº“è¿æ¥å’Œä¸€äº›åˆå§‹åŒ–æ•°æ®ã€‚</p><ol><li><p><strong>è¿æ¥æ•°æ®åº“</strong></p><p>åœ¨å¼€å§‹æ‰€æœ‰æµ‹è¯•ä¹‹å‰ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦è¿æ¥åˆ°ä¸€ä¸ªæµ‹è¯•æ•°æ®åº“ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">before</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> connectToTestDatabase</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œç”¨äºè¿æ¥æ•°æ®åº“</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>å‡†å¤‡æµ‹è¯•æ•°æ®</strong></p><p>æˆ‘ä»¬ä¹Ÿè®¸è¿˜éœ€è¦åœ¨æ•°æ®åº“ä¸­åˆ›å»ºä¸€äº›åˆå§‹æ•°æ®ï¼Œä»¥ä¾¿æµ‹è¯•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">before</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> createUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">username</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;testUser&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;testPassword&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæµ‹è¯•ç”¨æˆ·</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>ç»„åˆä½¿ç”¨</strong></p><p>å¦‚æœæœ‰å¤šä¸ªæ­¥éª¤éœ€è¦åœ¨æµ‹è¯•å‰æ‰§è¡Œï¼Œä½ å¯ä»¥è¿ç»­è°ƒç”¨ <code>context.before</code> æˆ–åœ¨ä¸€ä¸ª <code>context.before</code> ä¸­å®Œæˆæ‰€æœ‰å‡†å¤‡å·¥ä½œï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">before</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> connectToTestDatabase</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> createUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">username</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;testUser&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;testPassword&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ æ›´å¤šçš„åˆå§‹åŒ–æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>è®¾ç½®è¶…æ—¶</strong></p><p>å¦‚æœæŸä¸ªæ“ä½œéœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡ <code>options</code> å‚æ•°è®¾ç½®ä¸€ä¸ªè‡ªå®šä¹‰çš„è¶…æ—¶æ—¶é—´ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">before</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> performTimeConsumingSetup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®è¶…æ—¶æ—¶é—´ä¸º5000æ¯«ç§’</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="æ€»ç»“-15" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-15"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡ä½¿ç”¨ <code>context.before</code>ï¼Œä½ å¯ä»¥ç¡®ä¿åœ¨è¿›è¡Œå®é™…çš„æµ‹è¯•ä¹‹å‰ï¼Œæ‰€æœ‰å¿…éœ€çš„è®¾ç½®å’Œåˆå§‹åŒ–éƒ½å·²ç»å°±ç»ªã€‚è¿™å¯¹äºç¼–å†™å¯é å’Œé‡å¤çš„è‡ªåŠ¨åŒ–æµ‹è¯•è‡³å…³é‡è¦ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦æ¨¡æ‹ŸçœŸå®åº”ç”¨çŠ¶æ€æˆ–æ‰§è¡Œæ—¶é—´è¾ƒé•¿çš„å‡†å¤‡å·¥ä½œæ—¶ã€‚</p><h3 id="context-beforeeach-fn-options" tabindex="-1"><a class="header-anchor" href="#context-beforeeach-fn-options"><span><a href="https://nodejs.org/docs/latest/api/test.html#contextbeforeeachfn-options" target="_blank" rel="noopener noreferrer">context.beforeEach([fn][, options])</a></span></a></h3><p>Node.js v21.7.1 ä¸­çš„<code>context.beforeEach([fn][, options])</code>æ˜¯ä¸€ä¸ªå…³äºæµ‹è¯•çš„åŠŸèƒ½ï¼Œç‰¹åˆ«æ˜¯åœ¨ Node.js çš„æ–°æµ‹è¯•æ¡†æ¶ï¼ˆè‡ª v18.0.0 èµ·å¼•å…¥çš„å®éªŒæ€§ç‰¹æ€§ï¼‰ä¸­ä½¿ç”¨ã€‚è¿™ä¸ªå‡½æ•°æ˜¯ç”¨æ¥å®šä¹‰ä¸€ä¸ªåœ¨æ¯ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹å¼€å§‹ä¹‹å‰æ‰§è¡Œçš„é’©å­ï¼ˆhookï¼‰ã€‚ç†è§£è¿™ä¸ªæ¦‚å¿µå¯¹äºç¼–å†™æœ‰æ•ˆçš„æµ‹è¯•ä»£ç éå¸¸æœ‰å¸®åŠ©ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-7" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-7"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>é¦–å…ˆï¼Œ&quot;æµ‹è¯•æ¡†æ¶&quot;æ˜¯ä¸€ç»„å·¥å…·å’Œçº¦å®šï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘äººå‘˜ç¼–å†™ã€ç»„ç»‡å’Œè¿è¡Œè½¯ä»¶æµ‹è¯•ã€‚è€Œ&quot;æµ‹è¯•ç”¨ä¾‹&quot;ï¼ˆTest Caseï¼‰æ˜¯æœ€å°çš„æµ‹è¯•å•ä½ï¼Œä»£è¡¨äº†å•ä¸€çš„æµ‹è¯•åœºæ™¯æˆ–æ¡ä»¶ã€‚</p><p>åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°ä¸€äº›å‡†å¤‡å·¥ä½œï¼Œæ¯”å¦‚åˆå§‹åŒ–æ•°æ®åº“è¿æ¥ã€åˆ›å»ºæµ‹è¯•æ•°æ®ç­‰ï¼Œè¿™äº›å·¥ä½œå¦‚æœæ”¾åœ¨æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹é‡Œé‡å¤ç¼–å†™ï¼Œä¼šå¯¼è‡´ä»£ç å†—ä½™ä¸”éš¾ä»¥ç»´æŠ¤ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæµ‹è¯•æ¡†æ¶é€šå¸¸æä¾›äº†â€œé’©å­â€ï¼ˆhooksï¼‰çš„æ¦‚å¿µã€‚</p><h3 id="context-beforeeach" tabindex="-1"><a class="header-anchor" href="#context-beforeeach"><span><code>context.beforeEach</code></span></a></h3><p><code>context.beforeEach</code>å°±æ˜¯è¿™æ ·ä¸€ç§é’©å­ï¼Œå®ƒå…è®¸ä½ å®šä¹‰ä¸€ä¸ªå‡½æ•°<code>fn</code>ï¼Œè¿™ä¸ªå‡½æ•°ä¼šåœ¨æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹è¿è¡Œä¹‹å‰è¢«è°ƒç”¨ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥åœ¨æµ‹è¯•ç”¨ä¾‹ä¹‹é—´å…±äº«è®¾ç½®ä»£ç ï¼Œè€Œä¸å¿…åœ¨æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ä¸­é‡å¤ç›¸åŒçš„å‡†å¤‡å·¥ä½œã€‚</p><h4 id="å‚æ•°-3" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-3"><span>å‚æ•°</span></a></h4><ul><li><code>fn</code>ï¼šä¸€ä¸ªå°†åœ¨æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹å¼€å§‹ä¹‹å‰æ‰§è¡Œçš„å‡½æ•°ã€‚</li><li><code>options</code>ï¼šä¸€ä¸ªå¯é€‰çš„å‚æ•°ï¼Œæä¾›é¢å¤–çš„é…ç½®é€‰é¡¹ã€‚</li></ul><h4 id="å®é™…è¿ç”¨ç¤ºä¾‹-6" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-6"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h4><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨æµ‹è¯•ä¸€ä¸ªåšå®¢åº”ç”¨çš„åç«¯ APIï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦åœ¨æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹è¿è¡Œå‰æ¸…ç©ºæ•°æ®åº“ï¼Œå¹¶åˆ›å»ºä¸€äº›åŸºç¡€çš„æµ‹è¯•æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">beforeEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ¨¡æ‹Ÿæ¸…ç©ºæ•°æ®åº“</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> mockDatabase</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">clear</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åˆ›å»ºæµ‹è¯•ç”¨çš„åŸºç¡€æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> mockDatabase</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">create</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    title</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Test Blog Post&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    content</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;This is a test post.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è·å–åšå®¢æ–‡ç« åˆ—è¡¨&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿™é‡Œç¼–å†™ä½ çš„æµ‹è¯•é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> posts</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> blogApi</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPosts</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictSame</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">posts</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åº”è¯¥åªæœ‰ä¸€ä¸ªæµ‹è¯•æ–‡ç« &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åˆ›å»ºæ–°çš„åšå®¢æ–‡ç« &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿™é‡Œç¼–å†™å¦ä¸€ä¸ªæµ‹è¯•é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> blogApi</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createPost</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    title</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Another Test Post&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    content</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Content of another post.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> posts</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> blogApi</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPosts</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictSame</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">posts</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç°åœ¨åº”è¯¥æœ‰ä¸¤ç¯‡æ–‡ç« äº†&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>context.beforeEach</code>ç”¨äºåœ¨æ¯æ¬¡æµ‹è¯•ä¹‹å‰æ¸…ç©ºå¹¶åˆå§‹åŒ–æ•°æ®åº“ã€‚è¿™ç¡®ä¿äº†æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹éƒ½åœ¨å¹²å‡€ä¸”å·²çŸ¥çš„ç¯å¢ƒä¸‹è¿è¡Œï¼Œæé«˜äº†æµ‹è¯•çš„å¯é æ€§å’Œç‹¬ç«‹æ€§ã€‚</p><h3 id="context-after-fn-options" tabindex="-1"><a class="header-anchor" href="#context-after-fn-options"><span><a href="https://nodejs.org/docs/latest/api/test.html#contextafterfn-options" target="_blank" rel="noopener noreferrer">context.after([fn][, options])</a></span></a></h3><p>äº†è§£ <code>context.after([fn][, options])</code> åŠŸèƒ½ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæ¡å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p><ol><li><strong>Node.js</strong> æ˜¯ä¸€ä¸ªè¿è¡ŒäºæœåŠ¡å™¨ç«¯çš„ JavaScript ç¯å¢ƒï¼Œä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿä½¿ç”¨ JavaScript å¼€å‘æœåŠ¡ç«¯åº”ç”¨ã€‚</li><li><strong>æµ‹è¯•æ¡†æ¶</strong> åœ¨è½¯ä»¶å¼€å‘ä¸­æ‰®æ¼”ç€éå¸¸é‡è¦çš„è§’è‰²ã€‚å®ƒä»¬å¸®åŠ©å¼€å‘è€…ç¡®ä¿ç¼–å†™çš„ä»£ç èƒ½æŒ‰é¢„æœŸå·¥ä½œï¼Œå¹¶ä¸”åœ¨æœªæ¥æ·»åŠ æ–°åŠŸèƒ½æˆ–ä¿®æ”¹ç°æœ‰åŠŸèƒ½æ—¶ä¸ä¼šå¼•å…¥é”™è¯¯ã€‚</li></ol><p>åœ¨ Node.js çš„æ–‡æ¡£ä¸­ï¼Œæåˆ°çš„ <code>context.after([fn][, options])</code> æ˜¯ä¸€ä¸ªä¸æµ‹è¯•ç›¸å…³çš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ Node.js è‡ªèº«ä¸ºæµ‹è¯•ç¯å¢ƒæä¾›çš„ä¸€ç§æœºåˆ¶ï¼Œä¸»è¦ç”¨äºåœ¨ä¸€ç³»åˆ—æµ‹è¯•æ“ä½œä¹‹åæ‰§è¡Œç‰¹å®šçš„æ“ä½œã€‚è®©æˆ‘ä»¬ä¸€æ­¥æ­¥è§£æå®ƒï¼š</p><h3 id="context-after-fn-options-1" tabindex="-1"><a class="header-anchor" href="#context-after-fn-options-1"><span><code>context.after([fn][, options])</code></span></a></h3><ul><li><p><strong>ä½œç”¨</strong>: è¿™ä¸ªæ–¹æ³•çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†åœ¨æµ‹è¯•çš„ä¸Šä¸‹æ–‡ä¸­æ³¨å†Œä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šåœ¨å½“å‰æµ‹è¯•å—çš„æ‰€æœ‰æµ‹è¯•æ¡ˆä¾‹æ‰§è¡Œå®Œæ¯•åæ‰§è¡Œã€‚ç®€å•æ¥è¯´ï¼Œå®ƒå°±åƒæ˜¯ä¸€ä¸ªâ€œæ¸…ç†â€æ­¥éª¤ï¼Œç”¨äºæ‰§è¡Œæµ‹è¯•ç»“æŸåçš„æ”¶å°¾å·¥ä½œï¼Œæ¯”å¦‚å…³é—­æ‰“å¼€çš„æ–‡ä»¶ã€æ•°æ®åº“è¿æ¥ç­‰ã€‚</p></li><li><p><strong>å‚æ•°</strong>:</p><ul><li><code>fn</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ã€‚å®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä½ æƒ³è¦åœ¨æµ‹è¯•ç»“æŸåæ‰§è¡Œçš„é‚£ä¸ªå‡½æ•°ã€‚</li><li><code>options</code>: è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå¯é€‰çš„å‚æ•°ï¼Œå…è®¸ä½ é…ç½®è¿™ä¸ª <code>after</code> é’©å­çš„ä¸€äº›è¡Œä¸ºï¼Œæ¯”å¦‚è®¾ç½®è¶…æ—¶æ—¶é—´ç­‰ã€‚</li></ul></li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-11" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-11"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨ä¸ºä¸€ä¸ªç½‘ç»œåº”ç”¨ç¼–å†™æµ‹è¯•ï¼Œè¿™ä¸ªåº”ç”¨ä½¿ç”¨äº†æ•°æ®åº“æ¥å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ã€‚åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šåˆ›å»ºä¸´æ—¶çš„ç”¨æˆ·è®°å½•æ¥æ£€æŸ¥åº”ç”¨æ˜¯å¦èƒ½æ­£ç¡®å¤„ç†ç”¨æˆ·æ•°æ®ã€‚åœ¨æ‰€æœ‰æµ‹è¯•å®Œæˆåï¼Œæˆ‘ä»¬é€šå¸¸å¸Œæœ›åˆ é™¤è¿™äº›ä¸´æ—¶ç”¨æˆ·ï¼Œä»¥ä¿æŒæ•°æ®åº“çš„æ•´æ´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;User Management&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾ createUser å’Œ deleteUser æ˜¯ä¸¤ä¸ªæ¨¡æ‹Ÿçš„å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ç”¨äºåœ¨æ•°æ®åº“ä¸­åˆ›å»ºå’Œåˆ é™¤ç”¨æˆ·</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> tempUserId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  before</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // åœ¨æ‰€æœ‰æµ‹è¯•ä¹‹å‰åˆ›å»ºä¸€ä¸ªä¸´æ—¶ç”¨æˆ·</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    tempUserId</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> createUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;John Doe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      email</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;john@example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;should update user name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æµ‹è¯•æ›´æ–°ç”¨æˆ·åçš„é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> updateUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">tempUserId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Jane Doe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">tempUserId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">user</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Jane Doe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  context</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">after</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // åœ¨æ‰€æœ‰æµ‹è¯•æ‰§è¡Œå®Œæ¯•ååˆ é™¤ä¸´æ—¶ç”¨æˆ·</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> deleteUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">tempUserId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>context.after()</code> è¢«ç”¨äºæ¸…ç†æµ‹è¯•ç¯å¢ƒï¼Œå³åˆ é™¤æµ‹è¯•è¿‡ç¨‹ä¸­åˆ›å»ºçš„ä¸´æ—¶ç”¨æˆ·ã€‚é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œæˆ‘ä»¬ç¡®ä¿äº†æ¯æ¬¡æµ‹è¯•éƒ½æ˜¯åœ¨å¹²å‡€çš„ç¯å¢ƒä¸‹å¼€å§‹çš„ï¼Œè€Œä¸”ä¸ä¼šå› ä¸ºæ®‹ç•™çš„æµ‹è¯•æ•°æ®è€Œå½±å“å…¶ä»–æµ‹è¯•ã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œ<code>context.after([fn][, options])</code> æä¾›äº†ä¸€ç§æ–¹ä¾¿çš„æœºåˆ¶ï¼Œè®©æˆ‘ä»¬å¯ä»¥åœ¨æµ‹è¯•é›†åˆè¿è¡Œç»“æŸåæ‰§è¡Œä¸€äº›æ¸…ç†å·¥ä½œï¼Œè¿™å¯¹äºä¿æŒæµ‹è¯•ç¯å¢ƒçš„ç¨³å®šæ€§å’Œæ•ˆç‡æ˜¯éå¸¸é‡è¦çš„ã€‚</p><h3 id="context-aftereach-fn-options" tabindex="-1"><a class="header-anchor" href="#context-aftereach-fn-options"><span><a href="https://nodejs.org/docs/latest/api/test.html#contextaftereachfn-options" target="_blank" rel="noopener noreferrer">context.afterEach([fn][, options])</a></span></a></h3><p>Node.js v21.7.1 ä¸­çš„<code>context.afterEach([fn][, options])</code>æ˜¯ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå±äº Node.js çš„æµ‹è¯•åŠŸèƒ½æ¡†æ¶ã€‚è¿™é¡¹åŠŸèƒ½å…è®¸ä½ åœ¨æ¯ä¸ªæµ‹è¯•æ¡ˆä¾‹ä¹‹åæ‰§è¡Œä¸€äº›ç‰¹å®šçš„ä»£ç ã€‚è¿™åœ¨è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•æ—¶éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚æ¸…ç†æµ‹è¯•ç¯å¢ƒã€é‡Šæ”¾èµ„æºæˆ–é‡ç½®æŸäº›çŠ¶æ€ï¼Œä»¥ç¡®ä¿æ¯ä¸ªæµ‹è¯•éƒ½æ˜¯åœ¨å¹²å‡€ä¸”ä¸€è‡´çš„ç¯å¢ƒä¸‹è¿è¡Œçš„ã€‚</p><h3 id="å‚æ•°è§£æ" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£æ"><span>å‚æ•°è§£æ</span></a></h3><ul><li><code>fn</code>: è¿™æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä½ å¸Œæœ›åœ¨æ¯ä¸ªæµ‹è¯•æ¡ˆä¾‹æ‰§è¡Œå®Œæ¯•åæ‰§è¡Œçš„ä»£ç ã€‚</li><li><code>options</code>: ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå¯ä»¥è®©ä½ æ›´ç»†è‡´åœ°æ§åˆ¶<code>afterEach</code>çš„è¡Œä¸ºã€‚</li></ul><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-7" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-7"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåœ¨çº¿å›¾ä¹¦é¦†ç³»ç»Ÿï¼Œå¹¶ä½¿ç”¨ Node.js ç¼–å†™è‡ªåŠ¨åŒ–æµ‹è¯•æ¥éªŒè¯ç³»ç»Ÿçš„å„ä¸ªæ–¹é¢ã€‚åœ¨è¿™æ ·çš„åœºæ™¯ä¸‹ï¼Œ<code>context.afterEach()</code>å¯èƒ½ä¼šè¢«ç”¨æ¥åšä»¥ä¸‹äº‹æƒ…ï¼š</p><h4 id="ç¤ºä¾‹-1-æ¸…ç†æµ‹è¯•æ•°æ®åº“" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æ¸…ç†æµ‹è¯•æ•°æ®åº“"><span>ç¤ºä¾‹ 1: æ¸…ç†æµ‹è¯•æ•°æ®åº“</span></a></h4><p>åœ¨æµ‹è¯•åˆ›å»ºç”¨æˆ·æˆ–æ·»åŠ æ–°å›¾ä¹¦çš„åŠŸèƒ½æ—¶ï¼Œä½ ä¸å¸Œæœ›æµ‹è¯•æ•°æ®æ±¡æŸ“ä½ çš„æµ‹è¯•æ•°æ®åº“ã€‚å› æ­¤ï¼Œåœ¨æ¯ä¸ªæµ‹è¯•æ¡ˆä¾‹ä¹‹åï¼Œä½ å¯ä»¥ä½¿ç”¨<code>context.afterEach()</code>æ¥åˆ é™¤æµ‹è¯•æœŸé—´åˆ›å»ºçš„æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">createUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">deleteUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./user&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">afterEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾deleteTestUsersæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºåˆ é™¤æ‰€æœ‰æ ‡è®°ä¸ºæµ‹è¯•çš„ç”¨æˆ·</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> deleteUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isTestUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;create user test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> createUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Test User&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isTestUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿›è¡Œæ–­è¨€å’Œå…¶ä»–æµ‹è¯•é€»è¾‘...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-é‡ç½®å…¨å±€çŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-é‡ç½®å…¨å±€çŠ¶æ€"><span>ç¤ºä¾‹ 2: é‡ç½®å…¨å±€çŠ¶æ€</span></a></h4><p>å¦‚æœä½ çš„ç³»ç»Ÿä¾èµ–äºæŸäº›å…¨å±€çŠ¶æ€ï¼Œæ¯”å¦‚é…ç½®ä¿¡æ¯ã€ç¼“å­˜ç­‰ï¼Œåœ¨æµ‹è¯•ä¸åŒçš„æ¨¡å—æ—¶ï¼Œè¿™äº›çŠ¶æ€å¯èƒ½éœ€è¦é‡ç½®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> appConfig</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./config&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">afterEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // é‡ç½®é…ç½®åˆ°é»˜è®¤çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  appConfig</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getDefaultConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;feature A test with specific config&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  appConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">featureEnabled</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹è¯•é€»è¾‘...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œ<code>context.afterEach()</code>ç¡®ä¿åœ¨æ¯ä¸ªæµ‹è¯•æ‰§è¡Œåï¼Œåº”ç”¨çš„é…ç½®éƒ½è¢«é‡ç½®ï¼Œé¿å…äº†æµ‹è¯•é—´çš„ç›¸äº’å½±å“ã€‚</p><h3 id="æ€»ç»“-16" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-16"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡ä½¿ç”¨<code>context.afterEach()</code>ï¼Œä½ å¯ä»¥ç¡®ä¿æ¯æ¬¡æµ‹è¯•è¿è¡Œçš„ç¯å¢ƒéƒ½æ˜¯ä¸€è‡´çš„ï¼Œæ— è®ºæ˜¯æ¸…ç†æ•°æ®åº“ã€é‡ç½®å…¨å±€å˜é‡è¿˜æ˜¯é‡Šæ”¾èµ„æºç­‰ã€‚è¿™å¯¹äºç»´æŠ¤æµ‹è¯•çš„å‡†ç¡®æ€§å’Œå¯é æ€§æ˜¯è‡³å…³é‡è¦çš„ã€‚åˆ©ç”¨è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥æ„å»ºå‡ºæ›´åŠ ç¨³å®šå’Œå¯ä¿¡èµ–çš„è‡ªåŠ¨åŒ–æµ‹è¯•å¥—ä»¶ã€‚</p><h3 id="context-diagnostic-message" tabindex="-1"><a class="header-anchor" href="#context-diagnostic-message"><span><a href="https://nodejs.org/docs/latest/api/test.html#contextdiagnosticmessage" target="_blank" rel="noopener noreferrer">context.diagnostic(message)</a></span></a></h3><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>context.diagnostic(message)</code>å±äºæµ‹è¯•åŠŸèƒ½çš„ä¸€éƒ¨åˆ†ï¼Œå°¤å…¶æ˜¯åœ¨ä½¿ç”¨ Node.js è‡ªå¸¦çš„æµ‹è¯•æ¡†æ¶æ—¶ä¼šç”¨åˆ°ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­è¾“å‡ºé¢å¤–çš„è¯Šæ–­ä¿¡æ¯ï¼Œè€Œä¸å½±å“æµ‹è¯•ç»“æœçš„æˆåŠŸæˆ–å¤±è´¥ã€‚ç†è§£è¿™ä¸ªåŠŸèƒ½å¯¹äºç¼–å†™æ›´å¯é ã€æ˜“äºè°ƒè¯•çš„æµ‹è¯•ä»£ç éå¸¸æœ‰å¸®åŠ©ã€‚</p><h3 id="é€šä¿—è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#é€šä¿—è§£é‡Š"><span>é€šä¿—è§£é‡Š</span></a></h3><p>å½“ä½ åœ¨è¿›è¡Œè½¯ä»¶å¼€å‘æ—¶ï¼Œå†™æµ‹è¯•ä»£ç å‡ ä¹å’Œå†™å®é™…çš„åŠŸèƒ½ä»£ç ä¸€æ ·é‡è¦ã€‚æµ‹è¯•èƒ½å¤Ÿå¸®åŠ©ä½ ç¡®ä¿ä½ çš„ä»£ç æŒ‰é¢„æœŸå·¥ä½œï¼Œå¹¶ä¸”åœ¨æœªæ¥ä¿®æ”¹ä»£ç æ—¶ä¸ä¼šæ„å¤–ç ´åç°æœ‰åŠŸèƒ½ã€‚ä½†æœ‰æ—¶å€™ï¼Œä»…ä»…çŸ¥é“ä¸€ä¸ªæµ‹è¯•å¤±è´¥äº†å¯èƒ½ä¸è¶³ä»¥å¸®åŠ©ä½ æ‰¾åˆ°é—®é¢˜æ‰€åœ¨ã€‚è¿™æ—¶å€™ï¼Œ<code>context.diagnostic(message)</code>å°±æ˜¾å¾—éå¸¸æœ‰ç”¨ã€‚</p><p>æƒ³è±¡ä¸€ä¸‹ï¼Œ<code>context.diagnostic(message)</code>åƒæ˜¯åœ¨ä½ çš„æµ‹è¯•ä»£ç ä¸­æ”¾ç½®çš„å°æ ‡è®°ï¼Œå®ƒä»¬å¯ä»¥è¾“å‡ºé¢å¤–çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚å˜é‡çš„å½“å‰å€¼ã€ä»£ç æ‰§è¡Œåˆ°æŸä¸ªç‚¹çš„ç¡®è®¤ç­‰ï¼‰ï¼Œè€Œè¿™äº›ä¿¡æ¯ä»…ä»…æ˜¯ä¸ºäº†å¸®åŠ©ä½ ç†è§£æµ‹è¯•è¿è¡Œçš„ä¸Šä¸‹æ–‡æˆ–è€…æ˜¯ä¸ºä»€ä¹ˆä¼šå‡ºç°æŸä¸ªç»“æœã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-7" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-7"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç½‘ä¸Šå•†åº—çš„åº”ç”¨ï¼Œä½ éœ€è¦æµ‹è¯•ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°æ ¹æ®è´­ç‰©è½¦ä¸­çš„å•†å“æ€»ä»·è®¡ç®—ä¼˜æƒ åçš„ä»·æ ¼ã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸‹ï¼Œä½ æƒ³ç¡®è®¤ä¼˜æƒ é€»è¾‘æ˜¯å¦æ­£ç¡®åº”ç”¨äº†ã€‚å¦‚æœæµ‹è¯•å¤±è´¥ï¼Œä½ å¯èƒ½æƒ³çŸ¥é“åœ¨è®¡ç®—ä¹‹å‰ï¼Œè´­ç‰©è½¦ä¸­çš„æ€»ä»·æ˜¯å¤šå°‘ï¼Œä»¥åŠåº”ç”¨çš„ä¼˜æƒ è§„åˆ™æ˜¯ä»€ä¹ˆã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">strict</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> test</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;calculateDiscount åº”ç”¨10%ä¼˜æƒ &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cartTotal</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è´­ç‰©è½¦æ€»ä»·ä¸º100</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> expected</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 90</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é¢„æœŸè®¡ç®—åçš„ä»·æ ¼ä¸º90</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ·»åŠ ä¸€äº›è¯Šæ–­ä¿¡æ¯æ¥å¸®åŠ©ç†è§£æµ‹è¯•è¿è¡Œçš„æƒ…å†µ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">diagnostic</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è´­ç‰©è½¦åŸå§‹æ€»ä»·: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">cartTotal</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">diagnostic</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`é¢„æœŸä¼˜æƒ åæ€»ä»·: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">expected</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> calculateDiscount</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">cartTotal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™æ˜¯æˆ‘ä»¬è¦æµ‹è¯•çš„å‡½æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ–­è¨€ç»“æœæ˜¯å¦å¦‚é¢„æœŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    expected</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    `ä¼˜æƒ åçš„ä»·æ ¼åº”è¯¥æ˜¯</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">expected</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, ä½†å¾—åˆ°äº†</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">result</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¦‚æœ<code>assert.equal</code>å¤±è´¥äº†ï¼Œå³å®é™…ç»“æœä¸é¢„æœŸä¸ç¬¦ï¼Œé‚£ä¹ˆé€šè¿‡<code>context.diagnostic(message)</code>è¾“å‡ºçš„è¯Šæ–­ä¿¡æ¯å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿäº†è§£åˆ°æµ‹è¯•æ—¶çš„ä¸€äº›å…³é”®æ•°æ®ç‚¹ï¼Œæ¯”å¦‚æ­¤æ—¶è´­ç‰©è½¦çš„æ€»ä»·ä»¥åŠæˆ‘ä»¬æœŸæœ›çš„ä¼˜æƒ åä»·æ ¼ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ›´å®¹æ˜“åœ°å®šä½é—®é¢˜æ‰€åœ¨ï¼Œæ— éœ€æ·±å…¥æŒ–æ˜ä»£ç ç»†èŠ‚æˆ–å¢åŠ ä¸´æ—¶çš„è°ƒè¯•è¯­å¥ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œ<code>context.diagnostic(message)</code>æ˜¯ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„å·¥å…·ï¼Œå¯ä»¥è®©æµ‹è¯•ä»£ç çš„è°ƒè¯•è¿‡ç¨‹å˜å¾—æ›´ç®€å•ã€æ›´ç›´è§‚ã€‚</p><h3 id="context-name" tabindex="-1"><a class="header-anchor" href="#context-name"><span><a href="https://nodejs.org/docs/latest/api/test.html#contextname" target="_blank" rel="noopener noreferrer">context.name</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œè®©å¼€å‘è€…å¯ä»¥ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„åº”ç”¨ã€‚Node.js çš„ç‰¹ç‚¹åŒ…æ‹¬éé˜»å¡ I/O å’Œäº‹ä»¶é©±åŠ¨ï¼Œè¿™è®©å®ƒå°¤å…¶é€‚åˆå¤„ç†é«˜å¹¶å‘çš„ç½‘ç»œåº”ç”¨ã€‚</p><p>åœ¨ä½ æåˆ°çš„ Node.js ç‰ˆæœ¬ 21.7.1 æ–‡æ¡£ä¸­ï¼Œ<code>context.name</code> å¹¶ä¸ç›´æ¥å¯¹åº”åˆ° Node.js çš„æ ¸å¿ƒ API ä¸­çš„æŸä¸ªå…·ä½“åŠŸèƒ½ã€‚å¾ˆå¯èƒ½ä½ çœ‹åˆ°çš„ <code>context.name</code> æ˜¯åœ¨æŸä¸ªå…·ä½“ä¸Šä¸‹æ–‡æˆ–è€…åº“çš„æ–‡æ¡£ä¸­æåˆ°çš„ï¼Œå¹¶ä¸æ˜¯ Node.js å®˜æ–¹æ–‡æ¡£ä¸­ç›´æ¥å®šä¹‰çš„å†…å®¹ã€‚</p><p>ä¸è¿‡ï¼Œä¸ºäº†è®©ä½ å¯¹ç±»ä¼¼æ¦‚å¿µæœ‰æ‰€ç†è§£ï¼Œæˆ‘å¯ä»¥è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯â€œä¸Šä¸‹æ–‡ï¼ˆContextï¼‰â€ä»¥åŠåœ¨ç¼–ç¨‹ä¸­å®ƒé€šå¸¸æ˜¯å¦‚ä½•è¢«ä½¿ç”¨çš„ï¼š</p><h3 id="ä¸Šä¸‹æ–‡-context-çš„å«ä¹‰" tabindex="-1"><a class="header-anchor" href="#ä¸Šä¸‹æ–‡-context-çš„å«ä¹‰"><span>ä¸Šä¸‹æ–‡ï¼ˆContextï¼‰çš„å«ä¹‰</span></a></h3><p>åœ¨ç¼–ç¨‹ä¸­ï¼Œâ€œä¸Šä¸‹æ–‡ï¼ˆContextï¼‰â€æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼ŒæŒ‡çš„æ˜¯å½“å‰æ‰§è¡Œä»£ç æ‰€å¤„çš„ç¯å¢ƒæˆ–çŠ¶æ€ã€‚ä¸Šä¸‹æ–‡èƒ½å¤Ÿæä¾›å¿…è¦çš„ä¿¡æ¯ï¼Œè®©ä»£ç èƒ½å¤Ÿæ­£ç¡®åœ°æ‰§è¡Œä»»åŠ¡ã€‚è¿™äº›ä¿¡æ¯å¯èƒ½åŒ…æ‹¬å˜é‡ã€å‡½æ•°ã€å¯¹è±¡çš„çŠ¶æ€ç­‰ã€‚</p><h3 id="åœ¨-node-js-ä¸­çš„åº”ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#åœ¨-node-js-ä¸­çš„åº”ç”¨ç¤ºä¾‹"><span>åœ¨ Node.js ä¸­çš„åº”ç”¨ç¤ºä¾‹</span></a></h3><p>è™½ç„¶ <code>context.name</code> ä¸æ˜¯ Node.js çš„ä¸€ä¸ªæ ‡å‡† APIï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªæ¯”è¾ƒå¹¿æ³›çš„ä¾‹å­æ¥è¯´æ˜â€œä¸Šä¸‹æ–‡â€çš„ä½œç”¨ã€‚</p><h4 id="ä¾‹å­-1-http-æœåŠ¡å™¨è¯·æ±‚å¤„ç†" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-http-æœåŠ¡å™¨è¯·æ±‚å¤„ç†"><span>ä¾‹å­ 1ï¼šHTTP æœåŠ¡å™¨è¯·æ±‚å¤„ç†</span></a></h4><p>å½“åœ¨ Node.js ä¸­åˆ›å»ºä¸€ä¸ª HTTP æœåŠ¡å™¨æ—¶ï¼Œæ¯å½“æœ‰ç”¨æˆ·å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡å™¨éƒ½ä¼šä¸ºè¿™ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªæ–°çš„â€œä¸Šä¸‹æ–‡â€ã€‚è¿™ä¸ªä¸Šä¸‹æ–‡åŒ…å«äº†è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯ï¼ˆæ¯”å¦‚ URLã€HTTP æ–¹æ³•ç­‰ï¼‰å’Œå“åº”çš„æ–¹æ³•ï¼ˆæ¯”å¦‚å‘é€æ•°æ®ç»™å®¢æˆ·ç«¯ï¼‰ã€‚é€šè¿‡è¿™ä¸ªä¸Šä¸‹æ–‡ï¼Œä½ èƒ½å¤Ÿæ ¹æ®ä¸åŒçš„è¯·æ±‚ URL æˆ–è€…å‚æ•°æ¥è¿”å›ä¸åŒçš„å†…å®¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">http</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // req å’Œ res å‚æ•°æ„æˆäº†å½“å‰è¯·æ±‚çš„â€œä¸Šä¸‹æ–‡â€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿”å›å†…å®¹ç»™å®¢æˆ·ç«¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç»“æŸå“åº”</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Server is running on http://localhost:3000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>req</code> å’Œ <code>res</code> å½¢æˆäº†å¤„ç† HTTP è¯·æ±‚çš„ä¸Šä¸‹æ–‡ï¼Œå…è®¸ä½ æ ¹æ®è¯·æ±‚çš„ä¸åŒè¿›è¡Œä¸åŒçš„å¤„ç†ã€‚</p><h3 id="å°ç»“-5" tabindex="-1"><a class="header-anchor" href="#å°ç»“-5"><span>å°ç»“</span></a></h3><p>å¸Œæœ›è¿™ä¸ªè§£é‡Šèƒ½å¸®åŠ©ä½ ç†è§£â€œä¸Šä¸‹æ–‡â€çš„æ¦‚å¿µï¼Œä»¥åŠå®ƒåœ¨ç¼–ç¨‹ä¸­çš„é‡è¦æ€§ã€‚å³ä½¿ <code>context.name</code> ä¸æ˜¯ Node.js æ ‡å‡† API çš„ä¸€éƒ¨åˆ†ï¼Œç†è§£ä¸Šä¸‹æ–‡è¿™ä¸ªæ¦‚å¿µå¯¹äºç¼–ç¨‹æ¥è¯´ä»ç„¶æ˜¯éå¸¸é‡è¦çš„ã€‚</p><h3 id="context-runonly-shouldrunonlytests" tabindex="-1"><a class="header-anchor" href="#context-runonly-shouldrunonlytests"><span><a href="https://nodejs.org/docs/latest/api/test.html#contextrunonlyshouldrunonlytests" target="_blank" rel="noopener noreferrer">context.runOnly(shouldRunOnlyTests)</a></span></a></h3><p>Node.js v21.7.1 ä¸­çš„<code>context.runOnly(shouldRunOnlyTests)</code>æ˜¯ä¸€ä¸ªæµ‹è¯•æ–¹æ³•ï¼Œå®ƒå±äº Node.js çš„æµ‹è¯•æ¡†æ¶ã€‚ä¸ºäº†ç†è§£è¿™ä¸ªæ–¹æ³•ï¼Œè®©æˆ‘ä»¬å…ˆä»åŸºç¡€å¼€å§‹ã€‚</p><p>åœ¨ Node.js å¼€å‘ä¸­ï¼Œæµ‹è¯•æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç¯èŠ‚ï¼Œå®ƒå¸®åŠ©å¼€å‘è€…ç¡®ä¿ä»£ç æŒ‰é¢„æœŸå·¥ä½œï¼ŒåŒæ—¶ä¹Ÿæ–¹ä¾¿åç»­çš„ä»£ç ç»´æŠ¤å’Œæ›´æ–°ã€‚Node.js æä¾›äº†ä¸€ä¸ªå†…ç½®çš„æµ‹è¯•æ¡†æ¶ï¼Œå…è®¸å¼€å‘è€…ç¼–å†™å’Œæ‰§è¡Œæµ‹è¯•ç”¨ä¾‹ã€‚</p><h3 id="context-runonly-shouldrunonlytests-1" tabindex="-1"><a class="header-anchor" href="#context-runonly-shouldrunonlytests-1"><span><code>context.runOnly(shouldRunOnlyTests)</code></span></a></h3><ul><li><p><strong>åŠŸèƒ½</strong>: è¿™ä¸ªæ–¹æ³•å…è®¸ä½ æŒ‡å®šåªè¿è¡ŒæŸäº›ç‰¹å®šçš„æµ‹è¯•ã€‚é€šè¿‡ä¼ å…¥ä¸€ä¸ªå¸ƒå°”å€¼ï¼ˆ<code>shouldRunOnlyTests</code>ï¼‰ï¼Œä½ å¯ä»¥æ§åˆ¶æ˜¯å¦åªè¿è¡Œæ ‡è®°ä¸º&quot;åªè¿è¡Œ&quot;(<code>only</code>)çš„æµ‹è¯•ã€‚</p></li><li><p><strong>å‚æ•°</strong>: <code>shouldRunOnlyTests</code> æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ã€‚å½“è®¾ç½®ä¸º<code>true</code>æ—¶ï¼Œåªæœ‰æ ‡è®°ä¸º<code>only</code>çš„æµ‹è¯•ä¼šè¢«æ‰§è¡Œï¼›å¦‚æœè®¾ç½®ä¸º<code>false</code>ï¼Œåˆ™æ‰€æœ‰æµ‹è¯•éƒ½ä¼šè¿è¡Œã€‚</p></li></ul><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-8" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-8"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ä¸Šå•†åŸï¼Œå¹¶ä¸”ä½ æƒ³è¦æµ‹è¯•å•†å“æ·»åŠ åˆ°è´­ç‰©è½¦çš„åŠŸèƒ½ã€‚ä½ å¯èƒ½ä¼šæœ‰å¤šä¸ªæµ‹è¯•ç”¨ä¾‹ï¼šä¸€ä¸ªæµ‹è¯•ç©ºè´­ç‰©è½¦æ—¶æ·»åŠ å•†å“çš„æƒ…å†µï¼Œå¦ä¸€ä¸ªæµ‹è¯•è´­ç‰©è½¦å·²æœ‰å•†å“æ—¶æ·»åŠ åŒä¸€å•†å“çš„æƒ…å†µï¼Œç­‰ç­‰ã€‚</p><p>ä½†æ˜¯ï¼Œåœ¨æŸæ¬¡å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä½ å¯èƒ½åªå¯¹ä¿®æ”¹äº†æ·»åŠ åˆ°è´­ç‰©è½¦çš„é€»è¾‘æ„Ÿå…´è¶£ï¼Œå› æ­¤åªæƒ³è¿è¡Œä¸æ­¤ç›¸å…³çš„æµ‹è¯•ï¼Œä»¥å¿«é€Ÿå¾—çŸ¥ä¿®æ”¹æ˜¯å¦å½±å“äº†é¢„æœŸçš„åŠŸèƒ½ã€‚è¿™æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>context.runOnly(true)</code>æ¥æŒ‡å®šåªè¿è¡Œé‚£äº›è¢«æ ‡è®°ä¸º<code>only</code>çš„æµ‹è¯•ç”¨ä¾‹ã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> context</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯æˆ‘ä»¬çš„æµ‹è¯•æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">runOnly</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åªæœ‰æ ‡è®°ä¸ºonlyçš„æµ‹è¯•ä¼šè¢«è¿è¡Œ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ·»åŠ å•†å“åˆ°ç©ºçš„è´­ç‰©è½¦&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹è¯•é€»è¾‘...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">only</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ·»åŠ ç›¸åŒå•†å“åˆ°è´­ç‰©è½¦&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åªæœ‰è¿™ä¸ªæµ‹è¯•ä¼šè¢«æ‰§è¡Œï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨äº†context.runOnly(true)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æµ‹è¯•é€»è¾‘...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå³ä½¿ä½ çš„æµ‹è¯•æ–‡ä»¶ä¸­æœ‰å¤šä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œä½¿ç”¨<code>context.runOnly(true)</code>é…åˆ<code>test.only</code>ï¼Œä½ èƒ½å¤Ÿèšç„¦äºå½“å‰æœ€å…³å¿ƒçš„æµ‹è¯•ï¼Œä»è€Œæå‡å¼€å‘å’Œè°ƒè¯•çš„æ•ˆç‡ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œ<code>context.runOnly(shouldRunOnlyTests)</code>åœ¨å¼€å‘è¿‡ç¨‹ä¸­æä¾›äº†æå¤§çš„çµæ´»æ€§å’Œä¾¿åˆ©ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†åºå¤§ä¸”å¤æ‚çš„ä»£ç åº“æ—¶ï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°ç¼©å°æµ‹è¯•èŒƒå›´ï¼ŒåŠ å¿«é—®é¢˜è¯Šæ–­å’Œä¿®å¤çš„é€Ÿåº¦ã€‚</p><h3 id="context-signal" tabindex="-1"><a class="header-anchor" href="#context-signal"><span><a href="https://nodejs.org/docs/latest/api/test.html#contextsignal" target="_blank" rel="noopener noreferrer">context.signal</a></span></a></h3><p>Node.js çš„ <code>context.signal</code> æ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°å¼•å…¥çš„åŠŸèƒ½ï¼Œç‰¹åˆ«åœ¨ Node.js çš„ v21.7.1 ç‰ˆæœ¬ä¸­æåŠã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯ç”¨äºåœ¨ Node.js ä¸­ç®¡ç†å’Œä½¿ç”¨ AbortController ä¸ AbortSignal çš„ï¼Œä¸»è¦ç”¨äºå¯å–æ¶ˆçš„æ“ä½œï¼Œæ¯”å¦‚ HTTP è¯·æ±‚ã€æ–‡ä»¶è¯»å†™ç­‰ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-abortcontroller-å’Œ-abortsignal" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-abortcontroller-å’Œ-abortsignal"><span>ä»€ä¹ˆæ˜¯ AbortController å’Œ AbortSignalï¼Ÿ</span></a></h3><p>åœ¨æ·±å…¥äº†è§£ <code>context.signal</code> å‰ï¼Œè®©æˆ‘ä»¬å…ˆç®€å•ç†è§£ AbortController å’Œ AbortSignal è¿™ä¸¤ä¸ªæ¦‚å¿µã€‚</p><ul><li><strong>AbortController</strong> æ˜¯ä¸€ä¸ªæ§åˆ¶å™¨ï¼Œç”¨äºå‘å‡ºå–æ¶ˆä¿¡å·ã€‚</li><li><strong>AbortSignal</strong> æ˜¯ç”± AbortController å‘å‡ºçš„ä¿¡å·ï¼Œå¯ä»¥ä¼ é€’ç»™æ”¯æŒå–æ¶ˆæ“ä½œçš„ APIï¼Œä»¥ä¾¿å‘ŠçŸ¥å®ƒä»¬åœæ­¢å½“å‰æ­£åœ¨è¿›è¡Œçš„æ“ä½œã€‚</li></ul><p>è¿™ç§æœºåˆ¶å¹¿æ³›ç”¨äºæµè§ˆå™¨çš„ Fetch API æ¥å–æ¶ˆç½‘ç»œè¯·æ±‚ï¼Œè€Œ Node.js å¼•å…¥è¿™ä¸€æ¦‚å¿µæ˜¯ä¸ºäº†æä¾›ç±»ä¼¼çš„å–æ¶ˆæ“ä½œèƒ½åŠ›ã€‚</p><h3 id="context-signal-åœ¨-node-js-ä¸­çš„åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#context-signal-åœ¨-node-js-ä¸­çš„åº”ç”¨"><span>context.signal åœ¨ Node.js ä¸­çš„åº”ç”¨</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>context.signal</code> ä¸»è¦ä¸æµ‹è¯•ç›¸å…³ï¼Œå°¤å…¶æ˜¯ä¸ Node.js çš„å®éªŒæ€§æµ‹è¯•è¿è¡Œå™¨æœ‰å…³ã€‚å®ƒæä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œå…è®¸ä½ åœ¨æµ‹è¯•ä»£ç ä¸­å‘é€å–æ¶ˆä¿¡å·ï¼Œä»è€Œä¼˜é›…åœ°ç»ˆæ­¢ä¸€äº›å¼‚æ­¥æ“ä½œï¼Œæ¯”å¦‚è¶…æ—¶æˆ–è€…åœ¨ç‰¹å®šæ¡ä»¶ä¸‹ä¸å†éœ€è¦ç»§ç»­æ‰§è¡Œçš„æ“ä½œã€‚</p><h4 id="å®é™…è¿ç”¨ç¤ºä¾‹-7" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-7"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h4><p>è™½ç„¶ <code>context.signal</code> åœ¨ Node.js å®˜æ–¹æ–‡æ¡£ä¸­å¹¶æœªè¯¦ç»†ä»‹ç»ï¼Œä½†æˆ‘å¯ä»¥æ ¹æ® AbortController å’Œ AbortSignal çš„å¸¸è§ç”¨æ³•æ¥æ„å»ºä¸€ä¸ªç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">AbortController</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:abort-controller&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> controller</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> AbortController</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signal</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> controller</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">signal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> controller</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">abort</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 5ç§’åå–æ¶ˆè¯·æ±‚</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> response</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">signal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> response</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;AbortError&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Fetch operation was aborted.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Fetch error:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸º <code>fetchData</code> çš„å¼‚æ­¥å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ª URL ä½œä¸ºå‚æ•°ã€‚æˆ‘ä»¬ä½¿ç”¨ <code>AbortController</code> åˆ›å»ºä¸€ä¸ªå–æ¶ˆæ§åˆ¶å™¨å’Œç›¸åº”çš„ä¿¡å·ï¼ˆ<code>signal</code>ï¼‰ï¼Œå¹¶å°†è¯¥ä¿¡å·ä¼ é€’ç»™ <code>fetch</code> å‡½æ•°ç”¨äºå–æ¶ˆè¯·æ±‚ã€‚å¦‚æœè¯·æ±‚åœ¨æŒ‡å®šæ—¶é—´ï¼ˆä¾‹å¦‚ 5 ç§’ï¼‰å†…æœªå®Œæˆï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨ <code>controller.abort()</code> æ–¹æ³•æ¥å–æ¶ˆè¯·æ±‚ã€‚è¿™é‡Œä½¿ç”¨çš„ <code>fetch</code> å‡½æ•°åº”è¢«è§†ä¸ºä¸€ä¸ªæ¨¡æ‹Ÿçš„å¼‚æ­¥æ“ä½œï¼Œå› ä¸º Node.js åŸç”Ÿæš‚ä¸æ”¯æŒ <code>fetch</code>ï¼Œä½†ä½ å¯ä»¥é€šè¿‡é¢å¤–çš„åº“å¦‚ <code>node-fetch</code> æ¥ä½¿ç”¨å®ƒã€‚</p><p>è¯·æ³¨æ„ï¼Œåœ¨ Node.js çš„å®é™…åº”ç”¨ä¸­ï¼Œ<code>context.signal</code> å¯èƒ½æ¶‰åŠåˆ°æ›´å…·ä½“çš„æµ‹è¯•åœºæ™¯å’Œ APIsï¼Œä¸”ä¸Šè¿°ç¤ºä¾‹ä¸»è¦æ˜¯ä¸ºäº†è§£é‡Š AbortController å’Œ AbortSignal çš„åŸºæœ¬ç”¨æ³•å’Œæ¦‚å¿µã€‚åœ¨ç¼–å†™å®é™…çš„ Node.js åº”ç”¨ç¨‹åºæ—¶ï¼Œå»ºè®®æŸ¥é˜…æœ€æ–°çš„å®˜æ–¹æ–‡æ¡£ä»¥è·å–å‡†ç¡®çš„æŒ‡å¯¼å’Œç¤ºä¾‹ã€‚</p><h3 id="context-skip-message" tabindex="-1"><a class="header-anchor" href="#context-skip-message"><span><a href="https://nodejs.org/docs/latest/api/test.html#contextskipmessage" target="_blank" rel="noopener noreferrer">context.skip([message])</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>context.skip([message])</code>æ˜¯ç”¨äºæµ‹è¯•æ—¶è·³è¿‡ç‰¹å®šæµ‹è¯•ç”¨ä¾‹çš„åŠŸèƒ½ï¼Œè¿™ä¸ªç‰¹æ€§æ˜¯åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­çš„æµ‹è¯•æ¡†æ¶éƒ¨åˆ†æä¾›çš„ã€‚å®ƒå…è®¸ä½ åŸºäºæŸäº›æ¡ä»¶åŠ¨æ€åœ°å†³å®šæ˜¯å¦æ‰§è¡ŒæŸä¸ªæµ‹è¯•ã€‚å½“ä½ è°ƒç”¨<code>context.skip()</code>æ—¶ï¼Œå½“å‰çš„æµ‹è¯•ç”¨ä¾‹å°†è¢«æ ‡è®°ä¸ºè·³è¿‡çŠ¶æ€ï¼Œå¹¶ä¸”ä¸ä¼šæ‰§è¡Œå…¶å†…éƒ¨çš„ä»£ç ã€‚å¯é€‰çš„<code>message</code>å‚æ•°å…è®¸ä½ æŒ‡å®šä¸€ä¸ªè·³è¿‡æµ‹è¯•çš„åŸå› ï¼Œè¿™å¯¹äºæµ‹è¯•æŠ¥å‘Šå’Œæ—¥å¿—æ¥è¯´éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå¯ä»¥æ¸…æ™°åœ°è§£é‡Šä¸ºä»€ä¹ˆè¿™ä¸ªæµ‹è¯•ç”¨ä¾‹æ²¡æœ‰è¢«æ‰§è¡Œã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯å’Œå®é™…è¿ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯å’Œå®é™…è¿ç”¨ç¤ºä¾‹"><span>ä½¿ç”¨åœºæ™¯å’Œå®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”ä½ æœ‰ä¸€ç³»åˆ—è‡ªåŠ¨åŒ–çš„æµ‹è¯•æ¥ç¡®ä¿åº”ç”¨çš„æ¯ä¸ªéƒ¨åˆ†æŒ‰é¢„æœŸå·¥ä½œã€‚ä½†æ˜¯ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½å¸Œæœ›åŸºäºç‰¹å®šæ¡ä»¶è·³è¿‡ä¸€äº›æµ‹è¯•ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä½¿ç”¨<code>context.skip</code>çš„å®é™…åœºæ™¯ï¼š</p><h4 id="åœºæ™¯-1-å¹³å°ç›¸å…³çš„æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯-1-å¹³å°ç›¸å…³çš„æµ‹è¯•"><span>åœºæ™¯ 1: å¹³å°ç›¸å…³çš„æµ‹è¯•</span></a></h4><p>å¦‚æœä½ çš„åº”ç”¨éœ€è¦åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œï¼Œå¯èƒ½æœ‰äº›æµ‹è¯•åªé€‚ç”¨äºç‰¹å®šçš„æ“ä½œç³»ç»Ÿã€‚ä¾‹å¦‚ï¼ŒæŸäº›æ–‡ä»¶è·¯å¾„å¤„ç†åœ¨ Windows ä¸Šä¸ Linux æˆ– MacOS ä¸Šä¸åŒã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> os</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;os&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> context</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™ä¸ªæµ‹è¯•åªé€‚ç”¨äºéWindowså¹³å°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">os</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">platform</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;win32&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  context</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">skip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ­¤æµ‹è¯•ä¸é€‚ç”¨äºWindowsæ“ä½œç³»ç»Ÿ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½ çš„æµ‹è¯•ä»£ç ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="åœºæ™¯-2-åŠŸèƒ½ç‰¹æ€§å¼€å…³" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯-2-åŠŸèƒ½ç‰¹æ€§å¼€å…³"><span>åœºæ™¯ 2: åŠŸèƒ½ç‰¹æ€§å¼€å…³</span></a></h4><p>åœ¨å¼€å‘æ–°åŠŸèƒ½æ—¶ï¼Œä½ å¯èƒ½é€šè¿‡ç‰¹æ€§å¼€å…³ï¼ˆfeature flagsï¼‰æ§åˆ¶æ–°åŠŸèƒ½çš„å¯ç”¨ä¸å¦ã€‚ä¸€äº›æµ‹è¯•å¯èƒ½åªæœ‰åœ¨ç‰¹å®šåŠŸèƒ½å¼€å¯æ—¶æ‰æœ‰æ„ä¹‰ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> context</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> featureFlags</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getFeatureFlags</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä»é…ç½®æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡è·å–ç‰¹æ€§æ ‡å¿—çš„å‡½æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœ&quot;æ–°åŠŸèƒ½X&quot;æœªå¯ç”¨ï¼Œåˆ™è·³è¿‡æ­¤æµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">featureFlags</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">isEnabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;newFeatureX&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  context</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">skip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ–°åŠŸèƒ½Xæœªå¯ç”¨ï¼Œè·³è¿‡æµ‹è¯•&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½ çš„æµ‹è¯•ä»£ç ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="åœºæ™¯-3-ä¾èµ–æœåŠ¡çš„å¯ç”¨æ€§" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯-3-ä¾èµ–æœåŠ¡çš„å¯ç”¨æ€§"><span>åœºæ™¯ 3: ä¾èµ–æœåŠ¡çš„å¯ç”¨æ€§</span></a></h4><p>å¦‚æœä½ çš„åº”ç”¨ä¾èµ–å¤–éƒ¨æœåŠ¡æˆ– APIï¼Œè€Œè¿™äº›æœåŠ¡åœ¨æµ‹è¯•ç¯å¢ƒä¸­ä¸å¯ç”¨ï¼Œä½ å¯èƒ½æƒ³è¦è·³è¿‡é‚£äº›ä¾èµ–äºè¿™äº›æœåŠ¡çš„æµ‹è¯•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> context</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> externalService</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./externalService&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥å¤–éƒ¨æœåŠ¡æ˜¯å¦å¯ç”¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">externalService</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">checkAvailability</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">isAvailable</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isAvailable</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    context</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">skip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å¤–éƒ¨æœåŠ¡ä¸å¯ç”¨ï¼Œè·³è¿‡æµ‹è¯•&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä½ çš„æµ‹è¯•ä»£ç ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šå°±æ˜¯<code>context.skip([message])</code>çš„ç”¨æ³•å’Œä¸€äº›å®é™…åº”ç”¨çš„ä¾‹å­ã€‚é€šè¿‡ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œä½ å¯ä»¥æ›´çµæ´»åœ°æ§åˆ¶æµ‹è¯•çš„æ‰§è¡Œï¼Œå¹¶ä¸”æ ¹æ®æµ‹è¯•ç¯å¢ƒçš„ä¸åŒæƒ…å†µé€‰æ‹©æ€§åœ°è·³è¿‡æŸäº›æµ‹è¯•ï¼ŒåŒæ—¶æä¾›æ˜ç¡®çš„è·³è¿‡åŸå› ï¼Œæœ‰åŠ©äºæµ‹è¯•ç»“æœçš„ç†è§£å’Œé—®é¢˜çš„æ’æŸ¥ã€‚</p><h3 id="context-todo-message" tabindex="-1"><a class="header-anchor" href="#context-todo-message"><span><a href="https://nodejs.org/docs/latest/api/test.html#contexttodomessage" target="_blank" rel="noopener noreferrer">context.todo([message])</a></span></a></h3><p>Node.js ä¸­çš„<code>context.todo</code>æ˜¯ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå±äº Node.js çš„æµ‹è¯•å·¥å…·ã€‚åœ¨æˆ‘ä»¬ç¼–å†™ä»£ç æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸€äº›åŠŸèƒ½æˆ–ä¿®å¤æˆ‘ä»¬æƒ³è¦ç¨åå®ç°æˆ–æ·»åŠ çš„åœ°æ–¹ã€‚<code>context.todo</code>å°±æ˜¯ç”¨æ¥å¸®åŠ©æˆ‘ä»¬æ ‡è®°è¿™äº›éƒ¨åˆ†ã€‚</p><h3 id="ç†è§£-context-todo" tabindex="-1"><a class="header-anchor" href="#ç†è§£-context-todo"><span>ç†è§£ <code>context.todo</code></span></a></h3><p>ç®€å•æ¥è¯´ï¼Œ<code>context.todo</code>å…è®¸ä½ åœ¨æµ‹è¯•ä¸­æ ‡è®°ä¸€ä¸ªå¾…åŠäº‹é¡¹ã€‚å®ƒé€šå¸¸ä¸æµ‹è¯•æ¡†æ¶ä¸€èµ·ä½¿ç”¨ï¼Œåœ¨æµ‹è¯•ä»£ç ä¸­è¡¨ç¤ºæŸä¸ªç‰¹å®šçš„åŠŸèƒ½æµ‹è¯•è¿˜æœªå®Œæˆæˆ–è€…éœ€è¦åœ¨æœªæ¥è¢«å®ç°ã€‚å½“ä½ è¿è¡Œæµ‹è¯•æ—¶ï¼Œè¿™äº›ç”¨<code>context.todo</code>æ ‡è®°çš„æµ‹è¯•ä¸ä¼šè¢«æ‰§è¡Œï¼Œä½†ä¼šåœ¨æµ‹è¯•ç»“æœä¸­ä»¥ç‰¹å®šæ–¹å¼ï¼ˆé€šå¸¸æ˜¯ TODOï¼‰åˆ—å‡ºï¼Œæé†’å¼€å‘è€…è¿™éƒ¨åˆ†åŠŸèƒ½è¿˜éœ€è¦è¿›ä¸€æ­¥çš„å¼€å‘æˆ–ä¿®å¤ã€‚</p><h3 id="å‚æ•°-4" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-4"><span>å‚æ•°</span></a></h3><ul><li><code>message</code>ï¼šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨æ¥æè¿°è¿™ä¸ªå¾…åŠäº‹é¡¹æˆ–æœªå®ç°åŠŸèƒ½çš„ç»†èŠ‚ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-12" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-12"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ä¸Šä¹¦åº—çš„åç«¯æœåŠ¡ï¼Œå¹¶ä¸”ä½ ä½¿ç”¨ Node.js è¿›è¡Œå¼€å‘ã€‚åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­ï¼Œä½ å¯èƒ½éœ€è¦å®ç°è¯¸å¦‚ç”¨æˆ·ç™»å½•ã€æµè§ˆå›¾ä¹¦ã€æ·»åŠ å›¾ä¹¦åˆ°è´­ç‰©è½¦ç­‰åŠŸèƒ½ã€‚å¦‚æœä½ ç›®å‰æ­£åœ¨ä¸“æ³¨äºç”¨æˆ·ç™»å½•åŠŸèƒ½ï¼Œä½†ä½ å·²ç»çŸ¥é“æ¥ä¸‹æ¥éœ€è¦ä¸ºâ€œæ·»åŠ å›¾ä¹¦åˆ°è´­ç‰©è½¦â€åŠŸèƒ½ç¼–å†™æµ‹è¯•ï¼Œé‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨<code>context.todo</code>æ¥æ ‡è®°è¿™ä¸ªå¾…åŠäº‹é¡¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;assert&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> test</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç”¨æˆ·ç™»å½•&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ç”¨æˆ·ç™»å½•æµ‹è¯•ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">loginSuccess</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ·»åŠ å›¾ä¹¦åˆ°è´­ç‰©è½¦&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿™æ˜¯ä¸€ä¸ªå¾…åŠé¡¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆæ ‡è®°ä¸ºtodo</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">todo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å¾…å®ç°ï¼šç¡®ä¿ç”¨æˆ·å¯ä»¥å°†å›¾ä¹¦æ·»åŠ åˆ°è´­ç‰©è½¦&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå½“ä½ è¿è¡Œæµ‹è¯•å¥—ä»¶æ—¶ï¼Œâ€œç”¨æˆ·ç™»å½•â€æµ‹è¯•å°†ä¼šè¢«æ‰§è¡Œï¼Œè€Œâ€œæ·»åŠ å›¾ä¹¦åˆ°è´­ç‰©è½¦â€çš„æµ‹è¯•åˆ™è¢«æ ‡è®°ä¸º TODO å¹¶åœ¨ç»“æœä¸­æç¤ºå¼€å‘è€…è¯¥åŠŸèƒ½å°šå¾…å®ç°ã€‚</p><h3 id="æ€»ç»“-17" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-17"><span>æ€»ç»“</span></a></h3><p>ä½¿ç”¨<code>context.todo</code>æ˜¯ä¸€ç§é«˜æ•ˆçš„ç®¡ç†å’Œè¿½è¸ªé¡¹ç›®ä¸­å¾…å®Œæˆå·¥ä½œçš„æ–¹æ³•ã€‚å®ƒä¸ä»…èƒ½å¤Ÿå¸®åŠ©å›¢é˜Ÿè®°ä½å“ªäº›åŠŸèƒ½éœ€è¦è¢«å®ç°æˆ–ä¿®å¤ï¼Œè¿˜èƒ½å¤Ÿåœ¨è‡ªåŠ¨åŒ–æµ‹è¯•è¿‡ç¨‹ä¸­æ¸…æ™°åœ°å±•ç¤ºå‡ºé¡¹ç›®çš„è¿›åº¦å’Œå¾…åšäº‹é¡¹ï¼Œä»è€Œæé«˜å¼€å‘æ•ˆç‡å’Œé¡¹ç›®ç®¡ç†çš„é€æ˜åº¦ã€‚</p><h3 id="context-test-name-options-fn" tabindex="-1"><a class="header-anchor" href="#context-test-name-options-fn"><span><a href="https://nodejs.org/docs/latest/api/test.html#contexttestname-options-fn" target="_blank" rel="noopener noreferrer">context.test([name][, options][, fn])</a></span></a></h3><p>å½“æˆ‘ä»¬è°ˆè®ºåˆ° Node.js ä¸­çš„<code>context.test([name][, options][, fn])</code>ï¼Œæˆ‘ä»¬å…¶å®æ˜¯åœ¨è®¨è®º Node.js çš„æµ‹è¯•æ¡†æ¶éƒ¨åˆ†ã€‚ä» Node.js v18 ç‰ˆæœ¬å¼€å§‹å¼•å…¥äº†ä¸€ä¸ªåä¸º<code>node:test</code>çš„å®éªŒæ€§æ¨¡å—ï¼Œä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªè½»é‡çº§çš„æµ‹è¯•å·¥å…·ï¼Œç›´æ¥é›†æˆäº Node.js ç¯å¢ƒä¸­ï¼Œæ— éœ€å®‰è£…é¢å¤–çš„åŒ…æˆ–è½¯ä»¶ã€‚è¿™å¯¹äºå¼€å‘è€…æ¥è¯´æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„ä¾¿åˆ©ï¼Œå°¤å…¶æ˜¯å½“ä½ éœ€è¦å¯¹ä½ çš„ä»£ç è¿›è¡Œå¿«é€Ÿä¸”ç®€å•çš„æµ‹è¯•æ—¶ã€‚</p><p>åœ¨ v21.7.1 ç‰ˆçš„æ–‡æ¡£ä¸­æåˆ°çš„<code>context.test([name][, options][, fn])</code>æ–¹æ³•ï¼Œæ˜¯è¿™ä¸ªæµ‹è¯•æ¡†æ¶ä¸­çš„æ ¸å¿ƒéƒ¨åˆ†ä¹‹ä¸€ã€‚è®©æˆ‘ä»¬é€æ­¥è§£é‡Šå’Œç†è§£å®ƒï¼š</p><h3 id="æ¦‚å¿µè§£æ" tabindex="-1"><a class="header-anchor" href="#æ¦‚å¿µè§£æ"><span>æ¦‚å¿µè§£æ</span></a></h3><ul><li><p><strong>context</strong>: åœ¨æµ‹è¯•ä¸­ï¼Œ<code>context</code>å¯ä»¥è¢«è®¤ä¸ºæ˜¯å½“å‰æµ‹è¯•çš„ç¯å¢ƒæˆ–ä½œç”¨åŸŸã€‚æ¯å½“ä½ å£°æ˜ä¸€ä¸ªæ–°çš„æµ‹è¯•æ—¶ï¼Œä½ éƒ½ä¼šåœ¨ä¸€ä¸ªç‰¹å®šçš„<code>context</code>ä¸‹å·¥ä½œã€‚è¿™æœ‰åŠ©äºéš”ç¦»æµ‹è¯•ç”¨ä¾‹ï¼Œä¿è¯å„è‡ªç‹¬ç«‹è¿›è¡Œï¼Œäº’ä¸å¹²æ‰°ã€‚</p></li><li><p><strong>test() æ–¹æ³•</strong>: è¿™æ˜¯å®šä¹‰ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹çš„æ–¹æ³•ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥æŒ‡å®šæµ‹è¯•çš„åç§°ã€ç›¸å…³é€‰é¡¹ä»¥åŠå®é™…æ‰§è¡Œçš„å‡½æ•°ï¼ˆå³æµ‹è¯•é€»è¾‘ï¼‰ã€‚</p></li></ul><h3 id="å‚æ•°è¯¦è§£-1" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯¦è§£-1"><span>å‚æ•°è¯¦è§£</span></a></h3><ul><li><p><strong>name</strong>: è¿™æ˜¯ä½ ç»™æµ‹è¯•ç”¨ä¾‹æŒ‡å®šçš„åç§°ã€‚å®ƒæ˜¯å¯é€‰çš„ï¼Œä½†å¼ºçƒˆå»ºè®®æä¾›ï¼Œå› ä¸ºå®ƒèƒ½å¸®åŠ©ä½ è¯†åˆ«å’Œæè¿°æµ‹è¯•çš„ç›®çš„ã€‚</p></li><li><p><strong>options</strong>: ä¸€ä¸ªå¯¹è±¡ï¼Œå…è®¸ä½ é…ç½®æµ‹è¯•çš„ä¸€äº›è¡Œä¸ºã€‚è™½ç„¶æ–‡æ¡£ä¸­å¯èƒ½æ²¡æœ‰è¯¦ç»†åˆ—å‡ºæ‰€æœ‰é€‰é¡¹ï¼Œä½†é€šå¸¸åŒ…æ‹¬è®¾ç½®è¶…æ—¶æ—¶é—´ç­‰ã€‚</p></li><li><p><strong>fn</strong>: è¿™æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨å…¶ä¸­ä½ å°†ç¼–å†™å®é™…çš„æµ‹è¯•é€»è¾‘ã€‚å®ƒå¯ä»¥æ˜¯å¼‚æ­¥çš„ï¼Œå¦‚æœæ˜¯è¿™æ ·ï¼Œæµ‹è¯•åªæœ‰åœ¨è¿™ä¸ªå‡½æ•°è§£å†³ï¼ˆresolveï¼‰åæ‰ä¼šå®Œæˆã€‚</p></li></ul><h3 id="å®ä¾‹è®²è§£" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹è®²è§£"><span>å®ä¾‹è®²è§£</span></a></h3><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ªç®€å•çš„åº”ç”¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå‡½æ•°<code>add</code>ï¼Œç”¨äºè®¡ç®—ä¸¤ä¸ªæ•°çš„å’Œã€‚æˆ‘ä»¬æƒ³è¦ä½¿ç”¨ Node.js çš„æµ‹è¯•æ¡†æ¶æ¥æµ‹è¯•è¿™ä¸ªå‡½æ•°æ˜¯å¦æ­£ç¡®å·¥ä½œã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªéå¸¸ç®€å•çš„<code>add.js</code>æ–‡ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">b</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> a</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> b</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæµ‹è¯•æ–‡ä»¶<code>add.test.js</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;node:test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> assert</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;node:assert/strict&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> add</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;./add.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;addå‡½æ•°æµ‹è¯•&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strictEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;1åŠ 2åº”è¯¥ç­‰äº3&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œçš„ä»£ç åšäº†ä»¥ä¸‹å‡ ä»¶äº‹ï¼š</p><ul><li>å¯¼å…¥<code>test</code>æ–¹æ³•å’Œæ–­è¨€åº“<code>assert</code>ã€‚æ–­è¨€åº“ç”¨äºéªŒè¯æµ‹è¯•ç»“æœã€‚</li><li>å¯¼å…¥æˆ‘ä»¬æƒ³è¦æµ‹è¯•çš„<code>add</code>å‡½æ•°ã€‚</li><li>ä½¿ç”¨<code>test()</code>æ–¹æ³•å®šä¹‰äº†ä¸€ä¸ªæµ‹è¯•æ¡ˆä¾‹ï¼Œåç§°ä¸º<code>&#39;addå‡½æ•°æµ‹è¯•&#39;</code>ã€‚</li><li>åœ¨æµ‹è¯•å‡½æ•°å†…ï¼Œä½¿ç”¨<code>assert.strictEqual</code>æ–¹æ³•éªŒè¯<code>add(1, 2)</code>çš„ç»“æœæ˜¯å¦ç¡®å®ä¸º<code>3</code>ã€‚</li></ul><p>è¿™ä¸ªç®€å•çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>context.test([name][, options][, fn])</code>æ–¹æ³•åœ¨ Node.js ä¸­åˆ›å»ºå’Œè¿è¡Œæµ‹è¯•ç”¨ä¾‹ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥å¯¹ä½ çš„åº”ç”¨ä¸­çš„å„ç§åŠŸèƒ½è¿›è¡Œæµ‹è¯•ï¼Œç¡®ä¿å®ƒä»¬æŒ‰é¢„æœŸå·¥ä½œã€‚</p><h2 id="class-suitecontext" tabindex="-1"><a class="header-anchor" href="#class-suitecontext"><span><a href="https://nodejs.org/docs/latest/api/test.html#class-suitecontext" target="_blank" rel="noopener noreferrer">Class: SuiteContext</a></span></a></h2><p>Node.js åœ¨å…¶ç‰ˆæœ¬ 21.7.1 ä¸­å¼•å…¥äº†è®¸å¤šç‰¹æ€§ï¼ŒåŒ…æ‹¬æµ‹è¯•åŠŸèƒ½çš„æ”¹è¿›ã€‚åœ¨è¿™ä¸ªèƒŒæ™¯ä¸‹ï¼Œ<code>SuiteContext</code> ç±»æ˜¯ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œå®ƒå±äº Node.js çš„æµ‹è¯•æ¡†æ¶ã€‚ä¸ºäº†è®©ä½ æ›´å¥½åœ°ç†è§£ï¼Œæˆ‘å°†ä¼šå…ˆè§£é‡Šä¸€äº›åŸºæœ¬æ¦‚å¿µï¼Œç„¶åå†æ·±å…¥åˆ° <code>SuiteContext</code> ç±»åŠå…¶åº”ç”¨ã€‚</p><h3 id="åŸºç¡€æ¦‚å¿µ-4" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æ¦‚å¿µ-4"><span>åŸºç¡€æ¦‚å¿µ</span></a></h3><ol><li><strong>Node.js</strong>: æ˜¯ä¸€ä¸ªå¼€æºå’Œè·¨å¹³å°çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒã€‚å®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptï¼Œè¿™æ˜¯é€šè¿‡ Google Chrome çš„ V8 JavaScript å¼•æ“å®ç°çš„ã€‚</li><li><strong>æµ‹è¯•æ¡†æ¶</strong>: æµ‹è¯•æ¡†æ¶æ˜¯ä¸ºäº†æ–¹ä¾¿å¼€å‘è€…ç¼–å†™å’Œæ‰§è¡Œæµ‹è¯•ä»£ç è€Œè®¾è®¡çš„ã€‚å®ƒä»¬æä¾›äº†ä¸€å¥—è§„åˆ™å’Œå·¥å…·ï¼Œå¸®åŠ©æ£€æŸ¥ä»£ç çš„æ­£ç¡®æ€§ã€‚</li></ol><h3 id="suitecontext-ç±»" tabindex="-1"><a class="header-anchor" href="#suitecontext-ç±»"><span>SuiteContext ç±»</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>SuiteContext</code> æ˜¯æµ‹è¯•æ¡†æ¶ä¸­çš„ä¸€ä¸ªç±»ï¼Œä¸»è¦ç”¨äºç»„ç»‡å’Œç®¡ç†æµ‹è¯•æ¡ˆä¾‹çš„ä¸Šä¸‹æ–‡ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç¯å¢ƒæˆ–è€…â€œåœºæ™¯â€ï¼Œåœ¨è¿™ä¸ªåœºæ™¯ä¸‹ä½ å¯ä»¥æ‰§è¡Œæµ‹è¯•ä»£ç ï¼ŒåŒæ—¶ä¿æŒæµ‹è¯•æ¡ˆä¾‹ä¹‹é—´çš„éš”ç¦»ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ç¡®ä¿æµ‹è¯•çš„ç‹¬ç«‹æ€§ï¼Œé˜²æ­¢ä¸åŒæµ‹è¯•ä¹‹é—´çš„ç›¸äº’å¹²æ‰°ã€‚</p><h4 id="å®é™…è¿ç”¨ç¤ºä¾‹-8" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-8"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h4><p>è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªä½¿ç”¨ <code>SuiteContext</code> çš„åœºæ™¯ï¼š</p><ol><li><p><strong>åˆ†ç»„æµ‹è¯•</strong>: å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç”µå­å•†åŠ¡ç½‘ç«™ï¼Œå¹¶ä¸”ä½ æƒ³è¦ç‹¬ç«‹åœ°æµ‹è¯•ç”¨æˆ·è´¦å·ç®¡ç†ï¼ˆæ³¨å†Œã€ç™»å½•ã€æ³¨é”€ï¼‰å’Œå•†å“ç®¡ç†ï¼ˆæ·»åŠ å•†å“ã€åˆ é™¤å•†å“ï¼‰ä¸¤ä¸ªæ¨¡å—ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥åˆ›å»ºä¸¤ä¸ªä¸åŒçš„ <code>SuiteContext</code> å®ä¾‹ï¼Œæ¯ä¸ªå®ä¾‹é’ˆå¯¹ä¸€ä¸ªæ¨¡å—ï¼Œä»è€Œä½¿å¾—æµ‹è¯•æ›´åŠ æœ‰æ¡ç†ã€‚</p></li><li><p><strong>å…±äº«è®¾ç½®å’Œæ¸…ç†ä»£ç </strong>: åœ¨ä¸€ç³»åˆ—æµ‹è¯•ä¸­ï¼Œä½ å¯èƒ½éœ€è¦ä¸ºæ¯ä¸ªæµ‹è¯•å‰å‡†å¤‡æ•°æ®ï¼ˆæ¯”å¦‚æ•°æ®åº“å¡«å……ï¼‰ï¼Œå¹¶åœ¨æµ‹è¯•å®Œæˆåè¿›è¡Œæ¸…ç†ï¼ˆä¾‹å¦‚åˆ é™¤æµ‹è¯•æ•°æ®ï¼‰ã€‚<code>SuiteContext</code> å…è®¸ä½ å®šä¹‰åœ¨æ‰€æœ‰æµ‹è¯•å¼€å§‹ä¹‹å‰å’Œæ‰€æœ‰æµ‹è¯•å®Œæˆä¹‹åæ‰§è¡Œçš„ä»£ç ï¼Œä»è€Œé¿å…äº†åœ¨æ¯ä¸ªæµ‹è¯•æ¡ˆä¾‹ä¸­é‡å¤ç›¸åŒçš„è®¾ç½®å’Œæ¸…ç†ä»£ç ã€‚</p></li><li><p><strong>éš”ç¦»æµ‹è¯•è¿è¡Œç¯å¢ƒ</strong>: å¦‚æœä½ çš„æµ‹è¯•éœ€è¦ä¸å¤–éƒ¨ç³»ç»Ÿäº¤äº’ï¼ˆå¦‚å‘é€ç½‘ç»œè¯·æ±‚ï¼‰ï¼Œä½¿ç”¨ <code>SuiteContext</code> å¯ä»¥å¸®åŠ©ä½ åˆ›å»ºä¸€ä¸ªæ¨¡æ‹Ÿçš„ç¯å¢ƒï¼ˆmock environmentï¼‰ï¼Œè¿™æ ·ä½ å°±å¯ä»¥åœ¨ä¸å½±å“çœŸå®ç¯å¢ƒçš„æƒ…å†µä¸‹è¿è¡Œæµ‹è¯•ã€‚</p></li></ol><h4 id="æ€»ç»“-18" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-18"><span>æ€»ç»“</span></a></h4><p>æ€»çš„æ¥è¯´ï¼Œ<code>SuiteContext</code> ç±»åœ¨ Node.js çš„æµ‹è¯•æ¡†æ¶ä¸­æ‰®æ¼”ç€éå¸¸é‡è¦çš„è§’è‰²ã€‚å®ƒä¸ä»…èƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…ç»„ç»‡å’Œç®¡ç†æµ‹è¯•æ¡ˆä¾‹ï¼Œè¿˜èƒ½æä¾›éš”ç¦»çš„æµ‹è¯•ç¯å¢ƒï¼Œä¿ƒè¿›æµ‹è¯•çš„ç‹¬ç«‹æ€§å’Œå¯é æ€§ã€‚é€šè¿‡åˆç†åˆ©ç”¨ <code>SuiteContext</code>ï¼Œä½ å¯ä»¥æ›´é«˜æ•ˆã€æ›´ç³»ç»Ÿåœ°è¿›è¡Œè½¯ä»¶æµ‹è¯•ï¼Œä¿è¯ä»£ç è´¨é‡ã€‚</p><h3 id="context-name-1" tabindex="-1"><a class="header-anchor" href="#context-name-1"><span><a href="https://nodejs.org/docs/latest/api/test.html#contextname_1" target="_blank" rel="noopener noreferrer">context.name</a></span></a></h3><p><code>context.name</code>åœ¨ Node.js ä¸­çš„å…·ä½“åº”ç”¨åœºæ™¯å¹¶ä¸ç›´æ¥å­˜åœ¨ï¼Œå› ä¸ºæˆªè‡³æœ€åçš„ä¿¡æ¯æ›´æ–°ï¼ˆ2023 å¹´ï¼‰ï¼Œå®˜æ–¹çš„ Node.js æ–‡æ¡£é‡Œå¹¶æ²¡æœ‰ç›´æ¥æåˆ°<code>context.name</code>è¿™æ ·ä¸€ä¸ªå±æ€§æˆ–æ–¹æ³•ã€‚è¿™æ„å‘³ç€ï¼Œè¦ä¹ˆæ˜¯ä½ æŒ‡å‘äº†ä¸€ä¸ªç‰¹å®šäºæŸä¸ªåº“æˆ–æ¡†æ¶çš„ APIï¼Œè€Œä¸æ˜¯ Node.js æ ¸å¿ƒ API çš„ä¸€éƒ¨åˆ†ï¼›è¦ä¹ˆæ˜¯ä¸€ä¸ªè¯¯è§£æˆ–è€…ç¬”è¯¯ã€‚</p><p>ç„¶è€Œï¼Œæˆ‘å¯ä»¥æ ¹æ®ä½ çš„æè¿°åšä¸€ä¸ªå‡è®¾æ€§çš„è§£é‡Šï¼Œå¯èƒ½ä¸â€œä¸Šä¸‹æ–‡ï¼ˆcontextï¼‰â€å’Œâ€œåç§°ï¼ˆnameï¼‰â€ç›¸å…³çš„æ¦‚å¿µã€‚åœ¨ Node.js åŠè®¸å¤šç¼–ç¨‹è¯­è¨€ä¸­ï¼Œâ€œä¸Šä¸‹æ–‡ï¼ˆcontextï¼‰â€é€šå¸¸æŒ‡çš„æ˜¯æŸæ®µä»£ç è¿è¡Œæ—¶å…¶å‘¨å›´çš„ç¯å¢ƒæˆ–çŠ¶æ€ã€‚è¿™ä¸ªâ€œä¸Šä¸‹æ–‡â€èƒ½å¤Ÿå½±å“ä»£ç çš„è¡Œä¸ºæˆ–è€…æ˜¯ä»£ç å¦‚ä½•è®¿é—®æ•°æ®ã€‚æ¯”å¦‚ï¼Œåœ¨ Web æœåŠ¡å™¨ç¼–ç¨‹ä¸­ï¼Œè¯·æ±‚çš„ä¸Šä¸‹æ–‡å¯èƒ½åŒ…å«äº† HTTP è¯·æ±‚çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå¦‚å¤´ä¿¡æ¯ã€æŸ¥è¯¢å‚æ•°ã€å‘é€çš„æ•°æ®ç­‰ã€‚</p><p>å¦‚æœæˆ‘ä»¬æš‚æ—¶å¿½ç•¥<code>context.name</code>ä¸åœ¨ Node.js æ–‡æ¡£ä¸­çš„äº‹å®ï¼Œè€ŒæŠŠç„¦ç‚¹æ”¾åœ¨å¯èƒ½çš„å®é™…åº”ç”¨ä¸Šï¼Œå¯ä»¥æƒ³è±¡çš„ä¸€äº›åœºæ™¯åŒ…æ‹¬ï¼š</p><ol><li><p><strong>Web å¼€å‘</strong>ï¼šåœ¨ä½¿ç”¨ Node.js è¿›è¡Œ Web å¼€å‘æ—¶ï¼Œå°¤å…¶æ˜¯å¤„ç† HTTP è¯·æ±‚æ—¶ï¼Œæ¯ä¸€ä¸ªè¯·æ±‚éƒ½å¯ä»¥è§†ä¸ºä¸€ä¸ªâ€œä¸Šä¸‹æ–‡â€ï¼Œåœ¨è¿™ä¸ªä¸Šä¸‹æ–‡ä¸­å¯èƒ½åŒ…å«äº†ç”¨æˆ·ä¿¡æ¯ã€è®¤è¯çŠ¶æ€ç­‰ã€‚è¿™é‡Œçš„<code>.name</code>å¯èƒ½æŒ‡ä»£è¯·æ±‚è€…çš„ç”¨æˆ·åæˆ–å¦å¤–ä¸€äº›æ ‡è¯†ç¬¦ã€‚</p></li><li><p><strong>æ—¥å¿—è®°å½•</strong>ï¼šåœ¨å¤æ‚çš„åº”ç”¨ç¨‹åºä¸­ï¼Œè·Ÿè¸ªå½“å‰æ“ä½œçš„æ‰§è¡Œä¸Šä¸‹æ–‡éå¸¸é‡è¦ã€‚è¿™é‡Œçš„<code>context.name</code>å¯èƒ½æ˜¯å½“å‰æ­£åœ¨æ‰§è¡Œçš„æŸä¸ªå‡½æ•°æˆ–æ¨¡å—çš„åç§°ï¼Œä»¥ä¾¿äºåœ¨æ—¥å¿—æ–‡ä»¶ä¸­æ¸…æ™°åœ°åŒºåˆ†ä¸åŒéƒ¨åˆ†çš„æ—¥å¿—ä¿¡æ¯ã€‚</p></li><li><p><strong>å¼‚æ­¥ç¼–ç¨‹</strong>ï¼šNode.js å¼ºè°ƒéé˜»å¡ I/O å’Œå¼‚æ­¥ç¼–ç¨‹ã€‚åœ¨å¤„ç†å¼‚æ­¥æ“ä½œæ—¶ï¼Œä¿æŒä¸Šä¸‹æ–‡ï¼ˆæ¯”å¦‚è°è§¦å‘äº†è¿™ä¸ªå¼‚æ­¥æ“ä½œï¼‰æ˜¯ä¸ªæŒ‘æˆ˜ã€‚<code>context.name</code>å¯èƒ½æ˜¯å¼‚æ­¥ä»»åŠ¡çš„æ ‡è¯†ï¼Œå¸®åŠ©å¼€å‘è€…ç†è§£äº‹ä»¶å¾ªç¯ä¸­å„ä¸ªä»»åŠ¡çš„æ¥æºã€‚</p></li></ol><p>ä»¥ä¸Šåœºæ™¯éƒ½æ˜¯åŸºäºå‡è®¾çš„è§£é‡Šï¼Œæ—¨åœ¨å¸®åŠ©ä½ ç†è§£<code>context</code>å’Œ<code>name</code>è¿™ä¸¤ä¸ªæ¦‚å¿µåœ¨ç¼–ç¨‹ä¸­å¯èƒ½çš„åº”ç”¨ã€‚ç”±äº<code>context.name</code>å¹¶é Node.js æ ¸å¿ƒ API çš„ä¸€éƒ¨åˆ†ï¼Œå…·ä½“çš„åº”ç”¨ç»†èŠ‚å¯èƒ½ä¼šæ ¹æ®ä½ ä½¿ç”¨çš„åº“æˆ–æ¡†æ¶æœ‰æ‰€ä¸åŒã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œç†è§£å’Œåˆ©ç”¨å¥½ä¸Šä¸‹æ–‡ï¼ˆcontextï¼‰å¯¹äºç®¡ç†ç¨‹åºçš„çŠ¶æ€ã€å¤„ç†å¼‚æ­¥æ“ä½œç­‰éƒ½æ˜¯è‡³å…³é‡è¦çš„ã€‚</p><h3 id="context-signal-1" tabindex="-1"><a class="header-anchor" href="#context-signal-1"><span><a href="https://nodejs.org/docs/latest/api/test.html#contextsignal_1" target="_blank" rel="noopener noreferrer">context.signal</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œè®©ä½ èƒ½å¤Ÿåœ¨æœåŠ¡å™¨ä¾§è¿è¡Œ JavaScriptã€‚å®ƒä½¿å¾—å¼€å‘å…¨æ ˆåº”ç”¨å˜å¾—æ›´ç®€å•ï¼Œå› ä¸ºå‰ç«¯å’Œåç«¯éƒ½å¯ä»¥ä½¿ç”¨åŒä¸€ç§è¯­è¨€ç¼–å†™ã€‚</p><p>åœ¨ Node.js çš„æŒ‡å®šç‰ˆæœ¬ï¼ˆå¦‚ 21.7.1ï¼‰ä¸­æåˆ°çš„ <code>context.signal</code> æ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°ä¸”é«˜çº§çš„ç‰¹æ€§ï¼Œå®ƒæ˜¯ä¸ä»»åŠ¡ã€æ“ä½œæˆ–äº‹ä»¶çš„å–æ¶ˆæ“ä½œç›¸å…³è”çš„ã€‚ä½†è¦æ³¨æ„ï¼Œç›´æ¥ä» Node.js å®˜æ–¹æ–‡æ¡£å¯»æ‰¾ <code>context.signal</code> çš„ç‰¹å®šè¯´æ˜å¯èƒ½ä¼šé‡åˆ°å›°éš¾ï¼Œå› ä¸ºè¿™é€šå¸¸æ¶‰åŠåˆ°æ¯”è¾ƒæ·±å…¥çš„ API ä½¿ç”¨åœºæ™¯ï¼Œä¸”æ–‡æ¡£é“¾æ¥å¯èƒ½ä¼šéšç€ç‰ˆæœ¬æ›´æ–°å‘ç”Ÿå˜åŒ–ã€‚ç„¶è€Œï¼Œæˆ‘å¯ä»¥åŸºäº Node.js ä¸­ä¸ä¿¡å·å’Œä¸Šä¸‹æ–‡ç›¸å…³çš„å¸¸è§æ¦‚å¿µç»™ä½ ä¸€ä¸ªæ¦‚è§ˆï¼Œä»¥åŠå¦‚ä½•åœ¨ç°ä»£ JavaScript ä¸­ä½¿ç”¨è¿™ç±»ç‰¹æ€§çš„ä¾‹å­ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-context-signal" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-context-signal"><span>ä»€ä¹ˆæ˜¯ context.signalï¼Ÿ</span></a></h3><p>åœ¨ç¼–ç¨‹ä¸­ï¼Œ&quot;context&quot; é€šå¸¸æŒ‡çš„æ˜¯æŸä¸ªæ“ä½œæ‰§è¡Œçš„ç¯å¢ƒæˆ–èŒƒå›´ã€‚è€Œ &quot;signal&quot; åœ¨è¿™é‡ŒæŒ‡çš„æ˜¯ä¸€ç§æœºåˆ¶ï¼Œå¯ä»¥ç”¨æ¥é€šçŸ¥æ­£åœ¨è¿›è¡Œçš„æ“ä½œéœ€è¦è¢«å–æ¶ˆã€‚ç»“åˆèµ·æ¥ï¼Œ<code>context.signal</code> å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒæä¾›äº†ä¸€ç§æ–¹å¼æ¥ç›‘å¬å’Œå“åº”å–æ¶ˆè¯·æ±‚ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-13" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-13"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>è™½ç„¶ <code>context.signal</code> çš„ç›´æ¥ä¾‹å­å¯èƒ½ä¸å®¹æ˜“æ‰¾åˆ°ï¼Œä½†æˆ‘ä»¬å¯ä»¥å‚è€ƒä¸€ä¸ªéå¸¸ç›¸ä¼¼çš„ï¼Œåœ¨å¾ˆå¤šç°ä»£ JavaScript åº”ç”¨ä¸­å¹¿æ³›ä½¿ç”¨çš„ç‰¹æ€§ï¼š<code>AbortController</code> å’Œå®ƒçš„ <code>signal</code> å±æ€§ã€‚</p><p><code>AbortController</code> å’Œå®ƒçš„ <code>signal</code> è¢«ç”¨æ¥å–æ¶ˆå¦‚ Fetch API è¯·æ±‚ç­‰ä¸€äº›å¯æ’¤é”€çš„æ“ä½œã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªå¦‚ä½•ä½¿ç”¨å®ƒä»¬çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª AbortController å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> controller</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> AbortController</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä» controller ä¸­è·å– signal</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">signal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> controller</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‘èµ·ä¸€ä¸ª fetch è¯·æ±‚ï¼Œå¹¶å°† signal ä½œä¸ºé€‰é¡¹ä¼ é€’ç»™å®ƒ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">signal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">response</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> response</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">json</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;AbortError&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // å½“è¯·æ±‚è¢«å–æ¶ˆæ—¶å¤„ç†é”™è¯¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Fetch operation was aborted&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // å¤„ç†å…¶ä»–ç±»å‹çš„é”™è¯¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Fetch operation failed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾åœ¨ä¸€æ®µæ—¶é—´åï¼Œä½ å†³å®šå–æ¶ˆè¿™ä¸ªè¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  controller</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">abort</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 5ç§’åå–æ¶ˆè¯·æ±‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>AbortController</code> æ¥åˆ›å»ºä¸€ä¸ªæ§åˆ¶å™¨å’Œå®ƒçš„ <code>signal</code>ã€‚å½“æˆ‘ä»¬æƒ³å–æ¶ˆä¸è¯¥ <code>signal</code> å…³è”çš„æ“ä½œæ—¶ï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼‰ï¼Œæˆ‘ä»¬è°ƒç”¨ <code>controller.abort()</code> æ–¹æ³•ã€‚</p><p>è™½ç„¶ <code>context.signal</code> åœ¨è¯¦ç»†ç»†èŠ‚ä¸Šå¯èƒ½æœ‰æ‰€ä¸åŒï¼Œä½†æ ¸å¿ƒæ¦‚å¿µç±»ä¼¼â€”â€”æä¾›ä¸€ç§æœºåˆ¶æ¥å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„æ“ä½œã€‚è¿™ä¸ªç‰¹æ€§åœ¨å¤„ç†é•¿æ—¶é—´è¿è¡Œçš„æ“ä½œã€ç½‘ç»œè¯·æ±‚æˆ–ä»»ä½•ä½ å¸Œæœ›åœ¨ç‰¹å®šæ¡ä»¶ä¸‹èƒ½å¤Ÿä¼˜é›…é€€å‡ºçš„åœºæ™¯ä¸­ç‰¹åˆ«æœ‰ç”¨ã€‚</p><p>è®°ä½ï¼Œå…·ä½“åˆ° <code>context.signal</code> çš„å®é™…åº”ç”¨å’Œ API ä½¿ç”¨ï¼Œæœ€å¥½æŸ¥é˜…æœ€æ–°çš„ Node.js å®˜æ–¹æ–‡æ¡£ï¼Œä»¥è·å–æœ€å‡†ç¡®ã€æœ€æ–°çš„ä¿¡æ¯ã€‚</p></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: kamiacgxu@gmail.com">kamishima-kaede</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/document/node-doc/String%20decoder.html" aria-label="String decoder"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->String decoder</div></a><a class="route-link auto-link next" href="/document/node-doc/Timers.html" aria-label="Timers"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">Timers<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><!----><div class="vp-copyright">Copyright Â© 2018-present hanekawa-shiki</div></footer></div><!--]--><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.28bb228f.js" defer></script><script src="/assets/js/6679.86a2b270.js" defer></script><script src="/assets/js/app.de91e5da.js" defer></script>
  </body>
</html>
