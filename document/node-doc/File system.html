<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.49" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://hanekawa.top/document/node-doc/File%20system.html"><meta property="og:site_name" content="hanekawa-shiki"><meta property="og:title" content="File system"><meta property="og:description" content="File system Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ï¼Œä»è€Œå¯ä»¥æ„å»ºå¿«é€Ÿã€å¯æ‰©å±•çš„ç½‘ç»œåº”ç”¨ç¨‹åºã€‚Node.js çš„ fsï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰æ¨¡å—æ˜¯ä¸€ç»„å…è®¸ä½ ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº’åŠ¨çš„ APIã€‚ ä¸‹é¢ï¼Œæˆ‘å°†ä»‹ç» Node.js æ–‡ä»¶ç³»ç»Ÿçš„å‡ ä¸ªå…³é”®æ¦‚å¿µå’Œç”¨æ³•ç¤ºä¾‹ï¼š..."><meta property="og:type" content="website"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-06-21T09:46:17.000Z"><meta property="article:author" content="hanekawa-shiki"><meta property="article:modified_time" content="2024-06-21T09:46:17.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"WebPage","name":"File system","description":"File system Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ï¼Œä»è€Œå¯ä»¥æ„å»ºå¿«é€Ÿã€å¯æ‰©å±•çš„ç½‘ç»œåº”ç”¨ç¨‹åºã€‚Node.js çš„ fsï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰æ¨¡å—æ˜¯ä¸€ç»„å…è®¸ä½ ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº’åŠ¨çš„ APIã€‚ ä¸‹é¢ï¼Œæˆ‘å°†ä»‹ç» Node.js æ–‡ä»¶ç³»ç»Ÿçš„å‡ ä¸ªå…³é”®æ¦‚å¿µå’Œç”¨æ³•ç¤ºä¾‹ï¼š..."}</script><meta name="keywords" content="JavaScript,HTML,CSS"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/assets/icons/chrome-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icons/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icons/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icons/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#5c92d1"><link rel="apple-touch-icon" href="/assets/icons/apple-touch-icon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="white"><meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><title>File system | hanekawa-shiki</title><meta name="description" content="File system Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ï¼Œä»è€Œå¯ä»¥æ„å»ºå¿«é€Ÿã€å¯æ‰©å±•çš„ç½‘ç»œåº”ç”¨ç¨‹åºã€‚Node.js çš„ fsï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰æ¨¡å—æ˜¯ä¸€ç»„å…è®¸ä½ ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº’åŠ¨çš„ APIã€‚ ä¸‹é¢ï¼Œæˆ‘å°†ä»‹ç» Node.js æ–‡ä»¶ç³»ç»Ÿçš„å‡ ä¸ªå…³é”®æ¦‚å¿µå’Œç”¨æ³•ç¤ºä¾‹ï¼š...">
    <link rel="stylesheet" href="/assets/css/styles.a84c0532.css">
    <link rel="preload" href="/assets/js/runtime~app.be370b10.js" as="script"><link rel="preload" href="/assets/css/styles.a84c0532.css" as="style"><link rel="preload" href="/assets/js/4485.e6fe7c7b.js" as="script"><link rel="preload" href="/assets/js/app.bf6f64e3.js" as="script">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo light" src="/assets/svg/logo.svg" alt><img class="vp-nav-logo dark" src="/assets/svg/logo.svg" alt><span class="vp-site-name hide-in-pad">hanekawa-shiki</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="åšå®¢ä¸»é¡µ"><!--[--><span class="font-icon icon home" style=""></span><!--]-->åšå®¢ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="å­¦ä¹ ç¬”è®°"><!--[--><span class="font-icon icon framework" style=""></span>å­¦ä¹ ç¬”è®°<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">å‰ç«¯æ¡†æ¶</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/framework_front/vue3/" aria-label="Vue3ç¬”è®°"><!--[--><span class="font-icon icon vue" style=""></span><!--]-->Vue3ç¬”è®°<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/framework_front/react/" aria-label="Reactç¬”è®°"><!--[--><span class="font-icon icon react" style=""></span><!--]-->Reactç¬”è®°<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="æ–‡æ¡£"><!--[--><span class="font-icon icon framework" style=""></span>æ–‡æ¡£<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">æ¬è¿</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link route-link-active auto-link" href="/document/node-doc/" aria-label="Node.jsæ–‡æ¡£"><!--[--><span class="font-icon icon circle-info" style=""></span><!--]-->Node.jsæ–‡æ¡£<!----></a></li></ul></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/hanekawa-shiki/hanekawa-shiki.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/" aria-label="Node.jsæ–‡æ¡£"><!--[--><span class="font-icon icon circle-info" style=""></span><!--]-->Node.jsæ–‡æ¡£<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Assert.html" aria-label="Assert"><!---->Assert<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Async%20hooks.html" aria-label="Async hooks"><!---->Async hooks<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Asynchronous%20context%20tracking.html" aria-label="Asynchronous context tracking"><!---->Asynchronous context tracking<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Buffer.html" aria-label="Buffer"><!---->Buffer<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/C__%20addons.html" aria-label="C++ addons"><!---->C++ addons<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/C__%20embedder%20API.html" aria-label="C++ embedder API"><!---->C++ embedder API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Child%20process.html" aria-label="Child process"><!---->Child process<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Cluster.html" aria-label="Cluster"><!---->Cluster<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Command-line%20API.html" aria-label="Command-line API"><!---->Command-line API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Console.html" aria-label="Console"><!---->Console<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Corepack.html" aria-label="Corepack"><!---->Corepack<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Crypto.html" aria-label="Crypto"><!---->Crypto<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Debugger.html" aria-label="Debugger"><!---->Debugger<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Deprecated%20APIs.html" aria-label="Deprecated APIs"><!---->Deprecated APIs<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Diagnostic%20report.html" aria-label="Diagnostic report"><!---->Diagnostic report<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Diagnostics%20Channel.html" aria-label="Diagnostics Channel"><!---->Diagnostics Channel<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/DNS.html" aria-label="DNS"><!---->DNS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Domain.html" aria-label="Domain"><!---->Domain<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Errors.html" aria-label="Errors"><!---->Errors<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Events.html" aria-label="Events"><!---->Events<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/document/node-doc/File%20system.html" aria-label="File system"><!---->File system<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Global%20objects.html" aria-label="Global objects"><!---->Global objects<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/HTTP.html" aria-label="HTTP"><!---->HTTP<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/HTTPS.html" aria-label="HTTPS"><!---->HTTPS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Inspector.html" aria-label="Inspector"><!---->Inspector<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Internationalization%20support.html" aria-label="Internationalization support"><!---->Internationalization support<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Net.html" aria-label="Net"><!---->Net<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Node-API.html" aria-label="Node-API"><!---->Node-API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/OS.html" aria-label="OS"><!---->OS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Path.html" aria-label="Path"><!---->Path<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Performance%20measurement%20APIs.html" aria-label="Performance measurement APIs"><!---->Performance measurement APIs<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Permissions.html" aria-label="Permissions"><!---->Permissions<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Process.html" aria-label="Process"><!---->Process<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Punycode.html" aria-label="Punycode"><!---->Punycode<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Query%20string.html" aria-label="Query string"><!---->Query string<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Readline.html" aria-label="Readline"><!---->Readline<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/REPL.html" aria-label="REPL"><!---->REPL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Stream.html" aria-label="Stream"><!---->Stream<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/String%20decoder.html" aria-label="String decoder"><!---->String decoder<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Test%20runner.html" aria-label="Test runner"><!---->Test runner<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Timers.html" aria-label="Timers"><!---->Timers<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/TLS%20(SSL).html" aria-label="TLS (SSL)"><!---->TLS (SSL)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Trace%20events.html" aria-label="Trace events"><!---->Trace events<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/TTY.html" aria-label="TTY"><!---->TTY<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/URL.html" aria-label="URL"><!---->URL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Util.html" aria-label="Util"><!---->Util<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/V8.html" aria-label="V8"><!---->V8<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/VM%20(executing%20JavaScript).html" aria-label="VM (executing JavaScript)"><!---->VM (executing JavaScript)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Web%20Crypto%20API.html" aria-label="Web Crypto API"><!---->Web Crypto API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Web%20Streams%20API.html" aria-label="Web Streams API"><!---->Web Streams API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/WebAssembly%20System%20Interface%20(WASI).html" aria-label="WebAssembly System Interface (WASI)"><!---->WebAssembly System Interface (WASI)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Worker%20threads.html" aria-label="Worker threads"><!---->Worker threads<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Zlib.html" aria-label="Zlib"><!---->Zlib<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->File system</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://hanekawa.top" target="_blank" rel="noopener noreferrer">hanekawa-shiki</a></span><span property="author" content="hanekawa-shiki"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-06-21T09:46:17.000Z"></span><!----><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 607 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT607M"></span><span class="page-word-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon" name="word"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 182077 å­—</span><meta property="wordCount" content="182077"></span><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-è¯»å–æ–‡ä»¶å†…å®¹">1. è¯»å–æ–‡ä»¶å†…å®¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-å†™å…¥æ–‡ä»¶">2. å†™å…¥æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-è¿½åŠ å†…å®¹åˆ°æ–‡ä»¶">3. è¿½åŠ å†…å®¹åˆ°æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨">4. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-åˆ›å»ºå’Œåˆ é™¤ç›®å½•">5. åˆ›å»ºå’Œåˆ é™¤ç›®å½•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#promise-example">Promise example</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#callback-example">Callback example</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#synchronous-example">Synchronous example</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŒæ­¥è¯»å–æ–‡ä»¶">åŒæ­¥è¯»å–æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŒæ­¥å†™å…¥æ–‡ä»¶">åŒæ­¥å†™å…¥æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#promises-api">Promises API</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹">å®ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-1">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#class-filehandle">Class: FileHandle</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-è¯»å–æ–‡ä»¶å†…å®¹">ä¾‹å­ 1ï¼šè¯»å–æ–‡ä»¶å†…å®¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-å‘æ–‡ä»¶å†™å…¥å†…å®¹">ä¾‹å­ 2ï¼šå‘æ–‡ä»¶å†™å…¥å†…å®¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-3-å…³é—­æ–‡ä»¶">ä¾‹å­ 3ï¼šå…³é—­æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-è¯»å–æ–‡ä»¶æµå¹¶ç›‘å¬å…³é—­äº‹ä»¶">ç¤ºä¾‹ 1ï¼šè¯»å–æ–‡ä»¶æµå¹¶ç›‘å¬å…³é—­äº‹ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-å†™å…¥æ–‡ä»¶æµå¹¶ç›‘å¬å…³é—­äº‹ä»¶">ç¤ºä¾‹ 2ï¼šå†™å…¥æ–‡ä»¶æµå¹¶ç›‘å¬å…³é—­äº‹ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­">ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£-createreadstream">ç†è§£ createReadStream</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#é€‰é¡¹-options">é€‰é¡¹ (options)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€è§£é‡Š">åŸºç¡€è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-1">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€æ¦‚å¿µ">åŸºç¡€æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#filehandle-datasync-1">filehandle.datasync()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-1">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ–‡ä»¶ç³»ç»Ÿ-file-system">æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer">Buffer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç°åœ¨æ¥çœ‹-filehandle-read-buffer-offset-length-position">ç°åœ¨æ¥çœ‹ filehandle.read(buffer, offset, length, position)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼">è¿”å›å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-1">å®ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#filehandle-read-buffer-options-æ–¹æ³•">filehandle.read(buffer[, options]) æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­">ä½¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#é€‰é¡¹-options-1">é€‰é¡¹ (options)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹">ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£æ-filehandle-readlines-options">è§£æ filehandle.readLines([options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-2">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-1">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯¦è§£">å‚æ•°è¯¦è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼-2">è¿”å›å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-1">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-2">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨filehandle-stat-options">ä½¿ç”¨filehandle.stat([options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨åœºæ™¯">å®é™…åº”ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯´æ˜">å‚æ•°è¯´æ˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-1">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-1">å‚æ•°è§£é‡Šï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-3">å®é™…è¿ç”¨ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-3">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯¦è§£-1">å‚æ•°è¯¦è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼-3">è¿”å›å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-2">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-2">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-2">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-å‘æ–‡ä»¶å†™å…¥å¤šä¸ªæ–‡æœ¬ç‰‡æ®µ">ç¤ºä¾‹ 1ï¼šå‘æ–‡ä»¶å†™å…¥å¤šä¸ªæ–‡æœ¬ç‰‡æ®µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-æŒ‡å®šæ–‡ä»¶ä½ç½®å†™å…¥æ•°æ®">ç¤ºä¾‹ 2ï¼šæŒ‡å®šæ–‡ä»¶ä½ç½®å†™å…¥æ•°æ®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-1">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-access-path-mode">fsPromises.access(path[, mode])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-access-path-mode-1">fsPromises.access(path[, mode])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-appendfile-path-data-options">fsPromises.appendFile(path, data[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-appendfile-path-data-options-1">fsPromises.appendFile(path, data[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-4">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-chmod-path-mode">fsPromises.chmod(path, mode)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-fspromises-chmod-path-mode">è§£é‡Š fsPromises.chmod(path, mode)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-4">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-chown-path-uid-gid">fsPromises.chown(path, uid, gid)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-copyfile-src-dest-mode">fsPromises.copyFile(src, dest[, mode])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£å‡½æ•°å‚æ•°">ç†è§£å‡½æ•°å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‡½æ•°ä½¿ç”¨">å‡½æ•°ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-1">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-cp-src-dest-options">fsPromises.cp(src, dest[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-3">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®è·µä¾‹å­">å®è·µä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-lchmod-path-mode">fsPromises.lchmod(path, mode)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸¾ä¸ªä¾‹å­">ä¸¾ä¸ªä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-2">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-lchown-path-uid-gid">fsPromises.lchown(path, uid, gid)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-fspromises-æ˜¯ä»€ä¹ˆ">1. fsPromises æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-lchown-æ˜¯ä»€ä¹ˆ">2. lchown æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-5">å®é™…è¿ç”¨ç¤ºä¾‹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-3">æ³¨æ„äº‹é¡¹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-lutimes-path-atime-mtime">fsPromises.lutimes(path, atime, mtime)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-4">å‚æ•°è§£é‡Šï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨æ¡ˆä¾‹">ä½¿ç”¨æ¡ˆä¾‹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-4">æ³¨æ„äº‹é¡¹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-link-existingpath-newpath">fsPromises.link(existingPath, newPath)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ–‡ä»¶ç³»ç»Ÿ">æ–‡ä»¶ç³»ç»Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¡¬é“¾æ¥">ç¡¬é“¾æ¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-å’Œ-promise">Node.js å’Œ Promise</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-link-existingpath-newpath-1">fsPromises.link(existingPath, newPath)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-lstat-path-options">fsPromises.lstat(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-5">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-1">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-mkdir-path-options">fsPromises.mkdir(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ¦‚å¿µè§£é‡Š">æ¦‚å¿µè§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#é€‰é¡¹">é€‰é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-2">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-2">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-mkdtemp-prefix-options">fsPromises.mkdtemp(prefix[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬è§£é‡Š">åŸºæœ¬è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-6">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-open-path-flags-mode">fsPromises.open(path, flags[, mode])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-4">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#flags-çš„ä¸€äº›å¸¸è§å€¼">Flags çš„ä¸€äº›å¸¸è§å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-7">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-2">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-opendir-path-options">fsPromises.opendir(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç®€ä»‹">ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨æ–¹æ³•">ä½¿ç”¨æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯´æ˜-1">å‚æ•°è¯´æ˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-3">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-readdir-path-options">fsPromises.readdir(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯¦è§£-2">å‚æ•°è¯¦è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¸¾ä¾‹">å®é™…è¿ç”¨ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-4">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-readfile-path-options">fsPromises.readFile(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬ç”¨æ³•">åŸºæœ¬ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯¦è§£-3">å‚æ•°è¯¦è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-1">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-readlink-path-options">fsPromises.readlink(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-ä½¿ç”¨é»˜è®¤ç¼–ç -utf-8-è¯»å–ç¬¦å·é“¾æ¥">ç¤ºä¾‹ 1ï¼šä½¿ç”¨é»˜è®¤ç¼–ç ï¼ˆUTF-8ï¼‰è¯»å–ç¬¦å·é“¾æ¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-ä½¿ç”¨-buffer-ç¼–ç è¯»å–ç¬¦å·é“¾æ¥">ç¤ºä¾‹ 2ï¼šä½¿ç”¨ Buffer ç¼–ç è¯»å–ç¬¦å·é“¾æ¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-realpath-path-options">fsPromises.realpath(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°-2">å‚æ•°ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼-5">è¿”å›å€¼ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-8">å®é™…è¿ç”¨ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-rename-oldpath-newpath">fsPromises.rename(oldPath, newPath)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯´æ˜-2">å‚æ•°è¯´æ˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ–¹æ³•è¿”å›å€¼">æ–¹æ³•è¿”å›å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­-1">ä½¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-5">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-rmdir-path-options">fsPromises.rmdir(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-rmdir-path-options-1">fsPromises.rmdir(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ç¤ºä¾‹">ä½¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-6">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-rm-path-options">fsPromises.rm(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-6">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-fspromises-rm">ä½¿ç”¨ fsPromises.rm</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-9">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-stat-path-options">fsPromises.stat(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-1">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°-3">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼-6">è¿”å›å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-3">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-statfs-path-options">fsPromises.statfs(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-4">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-symlink-target-path-type">fsPromises.symlink(target, path[, type])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯ç¬¦å·é“¾æ¥">ä»€ä¹ˆæ˜¯ç¬¦å·é“¾æ¥ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-symlink-target-path-type-ç®€ä»‹">fsPromises.symlink(target, path[, type]) ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-1">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-7">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-truncate-path-len">fsPromises.truncate(path[, len])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-5">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-7">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-5">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-unlink-path">fsPromises.unlink(path)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-2">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç”¨æ³•">ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-10">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-utimes-path-atime-mtime">fsPromises.utimes(path, atime, mtime)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-æ›´æ–°æ–‡ä»¶æ—¶é—´æˆ³">ç¤ºä¾‹ 1ï¼šæ›´æ–°æ–‡ä»¶æ—¶é—´æˆ³</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-ä½¿ç”¨ç‰¹å®šçš„æ—¶é—´æˆ³">ç¤ºä¾‹ 2ï¼šä½¿ç”¨ç‰¹å®šçš„æ—¶é—´æˆ³</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-watch-filename-options">fsPromises.watch(filename[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨æ–¹æ³•-1">ä½¿ç”¨æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-8">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-11">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-writefile-file-data-options">fsPromises.writeFile(file, data[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-9">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­-2">ä½¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-2">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fspromises-constants">fsPromises.constants</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-ä½¿ç”¨-fspromises-writefile-å†™å…¥æ–‡ä»¶">1. ä½¿ç”¨ fsPromises.writeFile å†™å…¥æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-ä½¿ç”¨-fspromises-readfile-è¯»å–æ–‡ä»¶">2. ä½¿ç”¨ fsPromises.readFile è¯»å–æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-ä¿®æ”¹æ–‡ä»¶æƒé™">3. ä¿®æ”¹æ–‡ä»¶æƒé™</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#callback-api">Callback API</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#callback-api-1">Callback API</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-6">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-access-path-mode-callback">fs.access(path[, mode], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-10">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ¨¡å¼-mode">æ¨¡å¼ï¼ˆModeï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1">ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-3">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-appendfile-path-data-options-callback">fs.appendFile(path, data[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-11">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-12">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-7">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-chmod-path-mode-callback">fs.chmod(path, mode, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-chmod-path-mode-callback-1">fs.chmod(path, mode, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-6">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨">å®é™…è¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-chown-path-uid-gid-callback">fs.chown(path, uid, gid, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-fs-chown">ä»€ä¹ˆæ˜¯ fs.chown?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-7">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-8">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-close-fd-callback">fs.close(fd[, callback])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬ç†è§£">åŸºæœ¬ç†è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-close-fd-callback-è§£æ">fs.close(fd[, callback])è§£æ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-8">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-copyfile-src-dest-mode-callback">fs.copyFile(src, dest[, mode], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-12">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ç¤ºä¾‹-1">ä½¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨åœºæ™¯ç¤ºä¾‹">å®é™…åº”ç”¨åœºæ™¯ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-cp-src-dest-options-callback">fs.cp(src, dest[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-7">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯¦è§£-4">å‚æ•°è¯¦è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-3">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-createreadstream-path-options">fs.createReadStream(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-8">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°-4">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-13">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-createwritestream-path-options">fs.createWriteStream(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-fs-createwritestream">ä½¿ç”¨ fs.createWriteStream</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-exists-path-callback">fs.exists(path, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-exists">fs.exists</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-fs-access-æ›¿ä»£-fs-exists">ä½¿ç”¨ fs.access æ›¿ä»£ fs.exists</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-fchmod-fd-mode-callback">fs.fchmod(fd, mode, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å…³é”®æ¦‚å¿µ">å…³é”®æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-fchmod-fd-mode-callback-1">fs.fchmod(fd, mode, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-4">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-fchown-fd-uid-gid-callback">fs.fchown(fd, uid, gid, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-9">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-9">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-fdatasync-fd-callback">fs.fdatasync(fd, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å…³é”®ç‚¹è§£æ">å…³é”®ç‚¹è§£æ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-10">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-fstat-fd-options-callback">fs.fstat(fd[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‡½æ•°ç­¾å">å‡½æ•°ç­¾å</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ–‡ä»¶çŠ¶æ€å¯¹è±¡">æ–‡ä»¶çŠ¶æ€å¯¹è±¡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ç¤ºä¾‹-2">ä½¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-fsync-fd-callback">fs.fsync(fd, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€æ¦‚å¿µ-1">åŸºç¡€æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-fsync">fs.fsync()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¸¾ä¾‹">å®é™…åº”ç”¨ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-ftruncate-fd-len-callback">fs.ftruncate(fd[, len], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ¦‚å¿µè§£é‡Š-1">æ¦‚å¿µè§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯å’Œä¾‹å­">ä½¿ç”¨åœºæ™¯å’Œä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-futimes-fd-atime-mtime-callback">fs.futimes(fd, atime, mtime, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-lchmod-path-mode-callback">fs.lchmod(path, mode, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-lchmod-path-mode-callback-1">fs.lchmod(path, mode, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-2">å®ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-lchown-path-uid-gid-callback">fs.lchown(path, uid, gid, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-5">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-lutimes-path-atime-mtime-callback">fs.lutimes(path, atime, mtime, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-link-existingpath-newpath-callback">fs.link(existingPath, newPath, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-9">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-link-æ–¹æ³•">fs.link æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-2">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-10">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-lstat-path-options-callback">fs.lstat(path[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç®€ä»‹-1">ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-lstat-path-options-callback-1">fs.lstat(path[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨-1">å®é™…è¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-3">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-mkdir-path-options-callback">fs.mkdir(path[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-14">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­-3">ä½¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-4">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-mkdtemp-prefix-options-callback">fs.mkdtemp(prefix[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°-5">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1">ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-5">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-open-path-flags-mode-callback">fs.open(path[, flags[, mode]], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬è¯­æ³•-1">åŸºæœ¬è¯­æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-14">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-11">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-openasblob-path-options">fs.openAsBlob(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-blob">ä»€ä¹ˆæ˜¯ Blobï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-openasblob-çš„åŠŸèƒ½">fs.openAsBlob çš„åŠŸèƒ½</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-15">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-6">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-opendir-path-options-callback">fs.opendir(path[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-read-fd-buffer-offset-length-position-callback">fs.read(fd, buffer, offset, length, position, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‡½æ•°ç­¾å-1">å‡½æ•°ç­¾å</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-15">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-8">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-read-fd-options-callback">fs.read(fd[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-3">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-read-fd-buffer-options-callback">fs.read(fd, buffer[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-10">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-read-fd-buffer-options-callback-å‚æ•°è¯¦è§£">fs.read(fd, buffer[, options], callback) å‚æ•°è¯¦è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-11">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-9">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-readdir-path-options-callback">fs.readdir(path[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¯¦ç»†è§£é‡Š">è¯¦ç»†è§£é‡Šï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-6">å®é™…ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-readfile-path-options-callback">fs.readFile(path[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-16">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»£ç ç¤ºä¾‹-1">ä»£ç ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯æ–‡ä»¶æè¿°ç¬¦">ä»€ä¹ˆæ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åœ¨-node-js-ä¸­å¦‚ä½•ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦">åœ¨ Node.js ä¸­å¦‚ä½•ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-6">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŒæ­¥-vs-å¼‚æ­¥">åŒæ­¥ vs å¼‚æ­¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-7">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€§èƒ½æŠ€å·§">æ€§èƒ½æŠ€å·§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-readlink-path-options-callback">fs.readlink(path[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-11">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-readlink-è§£é‡Š">fs.readlink è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-7">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-readv-fd-buffers-position-callback">fs.readv(fd, buffers[, position], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-readv-å‡½æ•°çš„ä½œç”¨">fs.readv() å‡½æ•°çš„ä½œç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-5">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-7">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-realpath-path-options-callback">fs.realpath(path[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-3">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°-6">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-8">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-10">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-realpath-native-path-options-callback">fs.realpath.native(path[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-12">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯¦è§£-5">å‚æ•°è¯¦è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åº”ç”¨å®ä¾‹">åº”ç”¨å®ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯-1">ä½¿ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-12">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-rename-oldpath-newpath-callback">fs.rename(oldPath, newPath, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-é‡å‘½åæ–‡ä»¶">ç¤ºä¾‹ 1: é‡å‘½åæ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-ç§»åŠ¨æ–‡ä»¶">ç¤ºä¾‹ 2: ç§»åŠ¨æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-3-é”™è¯¯å¤„ç†">ç¤ºä¾‹ 3: é”™è¯¯å¤„ç†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-rmdir-path-options-callback">fs.rmdir(path[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-12">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-rm-path-options-callback">fs.rm(path[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-fs-rm">ä½¿ç”¨ fs.rm()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#é€‰é¡¹-options-2">é€‰é¡¹ options</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å›è°ƒ-callback">å›è°ƒ callback</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-8">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-stat-path-options-callback">fs.stat(path[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬ç”¨æ³•-1">åŸºæœ¬ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#stats-å¯¹è±¡">stats å¯¹è±¡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-13">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-11">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-statfs-path-options-callback">fs.statfs(path[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-symlink-target-path-type-callback">fs.symlink(target, path[, type], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-ä¸­çš„-fs-symlink-target-path-type-callback">Node.js ä¸­çš„ fs.symlink(target, path[, type], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£æ">å‚æ•°è§£æ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2">ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¸¾ä¾‹-1">å®é™…åº”ç”¨ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-truncate-path-len-callback">fs.truncate(path[, len], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-17">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨å®ä¾‹">ä½¿ç”¨å®ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„ç‚¹">æ³¨æ„ç‚¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-unlink-path-callback">fs.unlink(path, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-18">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-14">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-unwatchfile-filename-listener">fs.unwatchFile(filename[, listener])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-ä¸­çš„fs-unwatchfile-filename-listener">Node.js ä¸­çš„fs.unwatchFile(filename[, listener])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨åœºæ™¯-1">å®é™…åº”ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-utimes-path-atime-mtime-callback">fs.utimes(path, atime, mtime, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-4">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-watch-filename-options-listener">fs.watch(filename[, options][, listener])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-19">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­-4">ä½¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-14">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-å¼‚æ­¥ä¸åŒæ­¥">1. å¼‚æ­¥ä¸åŒæ­¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-é”™è¯¯å¤„ç†">2. é”™è¯¯å¤„ç†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-è·¯å¾„è€ƒè™‘">3. è·¯å¾„è€ƒè™‘</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-æ€§èƒ½è€ƒè™‘">4. æ€§èƒ½è€ƒè™‘</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-6">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#inodes-åŸºç¡€è§£é‡Š">Inodes åŸºç¡€è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-ä¸-inodes">Node.js ä¸ Inodes</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-8">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#filename-argument-1">Filename Argument</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-15">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-watchfile-filename-options-listener">fs.watchFile(filename[, options], listener)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯fs-watchfile">ä»€ä¹ˆæ˜¯fs.watchFile?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬ç”¨æ³•-3">åŸºæœ¬ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯¦è§£-6">å‚æ•°è¯¦è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-17">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-15">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-write-fd-buffer-offset-length-position-callback">fs.write(fd, buffer, offset[, length[, position]], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-å‘æ–‡ä»¶ä¸­å†™å…¥æ–‡æœ¬">ç¤ºä¾‹ 1: å‘æ–‡ä»¶ä¸­å†™å…¥æ–‡æœ¬</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-å¼‚æ­¥å†™å…¥å¤§é‡æ•°æ®">ç¤ºä¾‹ 2: å¼‚æ­¥å†™å…¥å¤§é‡æ•°æ®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-write-fd-buffer-options-callback">fs.write(fd, buffer[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-write-fd-string-position-encoding-callback">fs.write(fd, string[, position[, encoding]], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-7">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-writefile-file-data-options-callback">fs.writeFile(file, data[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-3">ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-writev-fd-buffers-position-callback">fs.writev(fd, buffers[, position], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-writev-fd-buffers-position-callback-1">fs.writev(fd, buffers[, position], callback)</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#synchronous-api">Synchronous API</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-è¯»å–æ–‡ä»¶å†…å®¹-readfilesync">1. è¯»å–æ–‡ä»¶å†…å®¹ï¼ˆreadFileSyncï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-å†™å…¥æ–‡ä»¶å†…å®¹-writefilesync">2. å†™å…¥æ–‡ä»¶å†…å®¹ï¼ˆwriteFileSyncï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨-existssync">3. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼ˆexistsSyncï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-accesssync-path-mode">fs.accessSync(path[, mode])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-appendfilesync-path-data-options">fs.appendFileSync(path, data[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-å‘æ–‡æœ¬æ–‡ä»¶è¿½åŠ å­—ç¬¦ä¸²">ç¤ºä¾‹ 1ï¼šå‘æ–‡æœ¬æ–‡ä»¶è¿½åŠ å­—ç¬¦ä¸²</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-ä½¿ç”¨é€‰é¡¹å‚æ•°æŒ‡å®šç¼–ç ">ç¤ºä¾‹ 2ï¼šä½¿ç”¨é€‰é¡¹å‚æ•°æŒ‡å®šç¼–ç </a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-chmodsync-path-mode">fs.chmodSync(path, mode)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-20">å‚æ•°è§£é‡Šï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æƒé™ç¤ºä¾‹">æƒé™ç¤ºä¾‹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-18">å®é™…è¿ç”¨ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-chownsync-path-uid-gid">fs.chownSync(path, uid, gid)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-19">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-closesync-fd">fs.closeSync(fd)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2">ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-copyfilesync-src-dest-mode">fs.copyFileSync(src, dest[, mode])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-13">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-21">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ç¤ºä¾‹-3">ä½¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-16">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-cpsync-src-dest-options">fs.cpSync(src, dest[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-14">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-16">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-existssync-path">fs.existsSync(path)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-fchmodsync-fd-mode">fs.fchmodSync(fd, mode)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°-7">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æƒé™æ¨¡å¼-mode">æƒé™æ¨¡å¼ï¼ˆmodeï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹ä»£ç ">å®ä¾‹ä»£ç </a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯-2">ä½¿ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-fchownsync-fd-uid-gid">fs.fchownSync(fd, uid, gid)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-æ”¹å˜æ–‡ä»¶æ‰€æœ‰è€…">ç¤ºä¾‹ 1ï¼šæ”¹å˜æ–‡ä»¶æ‰€æœ‰è€…</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-æ•è·æƒé™é”™è¯¯">ç¤ºä¾‹ 2ï¼šæ•è·æƒé™é”™è¯¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-fdatasyncsync-fd">fs.fdatasyncSync(fd)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€æ¦‚å¿µ-2">åŸºç¡€æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-fdatasyncsync-fd-1">fs.fdatasyncSync(fd)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-9">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-9">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-fstatsync-fd-options">fs.fstatSync(fd[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-fsyncsync-fd">fs.fsyncSync(fd)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°-8">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯-3">ä½¿ç”¨åœºæ™¯:</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-9">å®é™…ä¾‹å­:</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-ftruncatesync-fd-len">fs.ftruncateSync(fd[, len])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-22">å‚æ•°è§£é‡Šï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-4">ç¤ºä¾‹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-futimessync-fd-atime-mtime">fs.futimesSync(fd, atime, mtime)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-fs-futimessync-fd-atime-mtime">ä½¿ç”¨ fs.futimesSync(fd, atime, mtime)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-20">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-lchmodsync-path-mode">fs.lchmodSync(path, mode)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-fs-lchmodsync">ä»€ä¹ˆæ˜¯ fs.lchmodSyncï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-lchmodsyncçš„å·¥ä½œåŸç†">fs.lchmodSyncçš„å·¥ä½œåŸç†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-17">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-17">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-lchownsync-path-uid-gid">fs.lchownSync(path, uid, gid)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-10">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-lutimessync-path-atime-mtime">fs.lutimesSync(path, atime, mtime)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-lutimessync-path-atime-mtime-1">fs.lutimesSync(path, atime, mtime)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-linksync-existingpath-newpath">fs.linkSync(existingPath, newPath)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€æ¦‚å¿µ-3">åŸºç¡€æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-23">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯åŠä¾‹å­">ä½¿ç”¨åœºæ™¯åŠä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-18">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-lstatsync-path-options">fs.lstatSync(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-lstatsync-path-options-1">fs.lstatSync(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-mkdirsync-path-options">fs.mkdirSync(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-mkdirsync-path-options-å‚æ•°è§£é‡Š">fs.mkdirSync(path[, options]) å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨æ¡ˆä¾‹">å®é™…è¿ç”¨æ¡ˆä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-mkdtempsync-prefix-options">fs.mkdtempSync(prefix[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-15">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-19">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-10">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-opendirsync-path-options">fs.opendirSync(path[, options])</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#fs-opendirsync-ç®€ä»‹">fs.opendirSync() ç®€ä»‹</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-24">å‚æ•°è§£é‡Šï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼-7">è¿”å›å€¼ï¼š</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å®é™…è¿ç”¨ä¾‹å­-21">å®é™…è¿ç”¨ä¾‹å­</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-4">è§£é‡Šï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-opensync-path-flags-mode">fs.openSync(path[, flags[, mode]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-fs-opensync">ä»€ä¹ˆæ˜¯ fs.openSync()ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-25">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#flags-è§£é‡Š">Flags è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-10">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-readdirsync-path-options">fs.readdirSync(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-26">å‚æ•°è§£é‡Š:</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#options-å¯¹è±¡å¯èƒ½åŒ…å«çš„å±æ€§">options å¯¹è±¡å¯èƒ½åŒ…å«çš„å±æ€§:</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼-8">è¿”å›å€¼:</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­-5">ä½¿ç”¨ä¾‹å­:</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-readfilesync-path-options">fs.readFileSync(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-27">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼-9">è¿”å›å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-22">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-readlinksync-path-options">fs.readlinkSync(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-readlinksync-path-options-1">fs.readlinkSync(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-readsync-fd-buffer-offset-length-position">fs.readSync(fd, buffer, offset, length[, position])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‡½æ•°è§£é‡Š">å‡½æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨-2">å®é™…è¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£æ">è§£æ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-readsync-fd-buffer-options">fs.readSync(fd, buffer[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£æ-1">å‚æ•°è§£æ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬ç”¨æ³•-4">åŸºæœ¬ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-9">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-readvsync-fd-buffers-position">fs.readvSync(fd, buffers[, position])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-realpathsync-path-options">fs.realpathSync(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-5">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-12">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-realpathsync-native-path-options">fs.realpathSync.native(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-28">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬ç”¨æ³•-5">åŸºæœ¬ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-6">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-13">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-renamesync-oldpath-newpath">fs.renameSync(oldPath, newPath)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-æ›´æ”¹æ–‡ä»¶å">1. æ›´æ”¹æ–‡ä»¶å</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-ç§»åŠ¨æ–‡ä»¶åˆ°å¦ä¸€ä¸ªç›®å½•">2. ç§»åŠ¨æ–‡ä»¶åˆ°å¦ä¸€ä¸ªç›®å½•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-æ›´æ”¹ç›®å½•å">3. æ›´æ”¹ç›®å½•å</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-20">æ³¨æ„äº‹é¡¹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-rmdirsync-path-options">fs.rmdirSync(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-åˆ é™¤ç©ºç›®å½•">ç¤ºä¾‹ 1ï¼šåˆ é™¤ç©ºç›®å½•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-é€’å½’åˆ é™¤ç›®å½•åŠå…¶å†…å®¹">ç¤ºä¾‹ 2ï¼šé€’å½’åˆ é™¤ç›®å½•åŠå…¶å†…å®¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-rmsync-path-options">fs.rmSync(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-29">å‚æ•°è§£é‡Šï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-24">å®é™…è¿ç”¨ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æç¤º">æç¤ºï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-statsync-path-options">fs.statSync(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-statsync-path-options-1">fs.statSync(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-statfssync-path-options">fs.statfsSync(path[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£-fs-statfssync">ç†è§£ fs.statfsSync()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-25">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-14">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-symlinksync-target-path-type">fs.symlinkSync(target, path[, type])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-1-åˆ›å»ºæŒ‡å‘æ–‡ä»¶çš„ç¬¦å·é“¾æ¥">å®ä¾‹ 1ï¼šåˆ›å»ºæŒ‡å‘æ–‡ä»¶çš„ç¬¦å·é“¾æ¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-2-åˆ›å»ºæŒ‡å‘ç›®å½•çš„ç¬¦å·é“¾æ¥">å®ä¾‹ 2ï¼šåˆ›å»ºæŒ‡å‘ç›®å½•çš„ç¬¦å·é“¾æ¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-21">æ³¨æ„äº‹é¡¹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-truncatesync-path-len">fs.truncateSync(path[, len])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-16">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨fs-truncatesync">ä½¿ç”¨fs.truncateSync</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-22">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-unlinksync-path">fs.unlinkSync(path)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-unlinksync-path-1">fs.unlinkSync(path)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-utimessync-path-atime-mtime">fs.utimesSync(path, atime, mtime)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯´æ˜-3">å‚æ•°è¯´æ˜:</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-20">å®é™…è¿ç”¨ç¤ºä¾‹:</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-writefilesync-file-data-options">fs.writeFileSync(file, data[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-å†™å…¥æ–‡æœ¬åˆ°æ–‡ä»¶">ä¾‹å­ 1ï¼šå†™å…¥æ–‡æœ¬åˆ°æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-ä½¿ç”¨é€‰é¡¹å†™å…¥æ–‡ä»¶">ä¾‹å­ 2ï¼šä½¿ç”¨é€‰é¡¹å†™å…¥æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-3-å†™å…¥-json-æ•°æ®åˆ°æ–‡ä»¶">ä¾‹å­ 3ï¼šå†™å…¥ JSON æ•°æ®åˆ°æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-writesync-fd-buffer-offset-length-position">fs.writeSync(fd, buffer, offset[, length[, position]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-çš„fs-writesyncæ–¹æ³•ç®€ä»‹">Node.js çš„fs.writeSyncæ–¹æ³•ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£æ-2">å‚æ•°è§£æ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯å’Œä¾‹å­-1">ä½¿ç”¨åœºæ™¯å’Œä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-writesync-fd-buffer-options">fs.writeSync(fd, buffer[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-31">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­-6">ä½¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨åœºæ™¯-2">å®é™…åº”ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-writesync-fd-string-position-encoding">fs.writeSync(fd, string[, position[, encoding]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-writesync-ç®€ä»‹">fs.writeSync ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-32">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨å®ä¾‹-1">ä½¿ç”¨å®ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-15">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-writevsync-fd-buffers-position">fs.writevSync(fd, buffers[, position])</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#common-objects">Common Objects</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¸¸è§å¯¹è±¡ç¤ºä¾‹">å¸¸è§å¯¹è±¡ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-4">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#class-fs-dir">Class: fs.Dir</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£fs-dir">ç†è§£fs.Dir</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åˆ›å»ºfs-dirå®ä¾‹">åˆ›å»ºfs.Dirå®ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-dirçš„æ ¸å¿ƒæ–¹æ³•">fs.Dirçš„æ ¸å¿ƒæ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-7">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯dir-close">ä»€ä¹ˆæ˜¯dir.close()ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•å·¥ä½œ">å¦‚ä½•å·¥ä½œï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-8">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-11">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dir-close-callback-1">dir.close(callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-17">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-dir-closesync">ä½¿ç”¨ dir.closeSync()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-21">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-16">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸¾ä¾‹">ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-dir-readsync">å¦‚ä½•ä½¿ç”¨ dir.readSync()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-5">ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨åœºæ™¯-3">å®é™…åº”ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dir-symbol-asynciterator">dir[Symbol.asyncIterator]()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#class-fs-dirent">Class: fs.Dirent</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-fs-dirent">ä»€ä¹ˆæ˜¯ fs.Dirent?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-dirent-çš„é‡è¦æ–¹æ³•">fs.Dirent çš„é‡è¦æ–¹æ³•ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®è·µä¾‹å­-1">å®è·µä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-26">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dirent-ischaracterdevice-1">dirent.isCharacterDevice()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£-fs-dirent-ç±»">ç†è§£ fs.Dirent ç±»</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#isdirectory-æ–¹æ³•">isDirectory() æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-22">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-9">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dirent-isfile-1">dirent.isFile()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨-3">å®é™…è¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-node-js-1">ä»€ä¹ˆæ˜¯ Node.jsï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ–‡ä»¶ç³»ç»Ÿ-fs-æ¨¡å—-1">æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dirent-å¯¹è±¡">Dirent å¯¹è±¡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dirent-issocket-æ–¹æ³•">dirent.isSocket() æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-11">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dirent-nameçš„ä½œç”¨">dirent.nameçš„ä½œç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-12">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#class-fs-fswatcher">Class: fs.FSWatcher</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-18">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-23">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-23">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-1-ç›‘å¬å•ä¸ªæ–‡ä»¶çš„å˜åŒ–">å®ä¾‹ 1: ç›‘å¬å•ä¸ªæ–‡ä»¶çš„å˜åŒ–</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-2-ç›‘å¬æ•´ä¸ªç›®å½•çš„å˜åŠ¨">å®ä¾‹ 2: ç›‘å¬æ•´ä¸ªç›®å½•çš„å˜åŠ¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-24">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-close-äº‹ä»¶">ä»€ä¹ˆæ˜¯ &#39;close&#39; äº‹ä»¶ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆ-close-äº‹ä»¶é‡è¦">ä¸ºä»€ä¹ˆ &#39;close&#39; äº‹ä»¶é‡è¦ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-24">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-17">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-error-1">[Event: &#39;error&#39;]</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-18">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯-4">ä½¿ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-11">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#äº‹ä»¶å¾ªç¯å’Œç›‘è§†å™¨">äº‹ä»¶å¾ªç¯å’Œç›‘è§†å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#watcher-ref-1">watcher.ref()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-28">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-ç®€ä»‹">1. ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-watcher-unref-æ–¹æ³•">2. watcher.unref() æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-å®é™…åº”ç”¨ç¤ºä¾‹">3. å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-5">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#class-fs-statwatcher">Class: fs.StatWatcher</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-fs-statwatcher">ä»€ä¹ˆæ˜¯ fs.StatWatcher?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-fs-statwatcher">å¦‚ä½•ä½¿ç”¨ fs.StatWatcher?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-10">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#watcher-ref-3">watcher.ref()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ–‡ä»¶ç›‘è§†å™¨-file-watchers">æ–‡ä»¶ç›‘è§†å™¨(File Watchers)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#watcher-unref-2">watcher.unref()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-10">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#class-fs-readstream">Class: fs.ReadStream</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯fs-readstream">ä»€ä¹ˆæ˜¯fs.ReadStream?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•åˆ›å»ºä¸€ä¸ªfs-readstream">å¦‚ä½•åˆ›å»ºä¸€ä¸ªfs.ReadStream?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-29">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-6">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æµ-streams-ç®€ä»‹">æµï¼ˆStreamsï¼‰ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-close-3">Event: &#39;close&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-12">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#äº‹ä»¶-open">äº‹ä»¶: &#39;open&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç®€å•ç†è§£">ç®€å•ç†è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-31">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-19">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-1-è¯»å–æ–‡ä»¶å†…å®¹">å®ä¾‹ 1ï¼šè¯»å–æ–‡ä»¶å†…å®¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-2-ç›‘æ§ä¸‹è½½è¿›åº¦">å®ä¾‹ 2ï¼šç›‘æ§ä¸‹è½½è¿›åº¦</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-readstream-path">è§£é‡Š readStream.path</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-32">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-20">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#readstream">readStream</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#readstream-pending-å±æ€§">readStream.pending å±æ€§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#class-fs-stats">Class: fs.Stats</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸»è¦å±æ€§">ä¸»è¦å±æ€§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-25">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-stats-isblockdevice">ä»€ä¹ˆæ˜¯ stats.isBlockDevice()?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹è§£é‡Š">ç¤ºä¾‹è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨åœºæ™¯-4">å®é™…åº”ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-stats-ischaracterdevice">ä½¿ç”¨ stats.isCharacterDevice()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨åœºæ™¯-5">å®é™…åº”ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#stats-isdirectory-1">stats.isDirectory()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#stats-isfifo-1">stats.isFIFO()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-26">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#stats-isfile-1">stats.isFile()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¸¾ä¾‹-2">å®é™…åº”ç”¨ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯stats-issocket">ä»€ä¹ˆæ˜¯stats.isSocket()?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ç¤ºä¾‹-5">ä½¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯ç¬¦å·é“¾æ¥-1">ä»€ä¹ˆæ˜¯ç¬¦å·é“¾æ¥ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#stats-issymboliclink-æ–¹æ³•">stats.isSymbolicLink() æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-6">ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-34">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ–‡ä»¶ç³»ç»Ÿ-file-system-1">æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-stats-å¯¹è±¡">fs.Stats å¯¹è±¡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#rdev-å±æ€§">rdev å±æ€§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-27">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#stats-size-1">stats.size</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨-4">å®é™…è¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-12">å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-13">å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯è®¿é—®æ—¶é—´-access-time">ä»€ä¹ˆæ˜¯è®¿é—®æ—¶é—´ï¼ˆAccess Timeï¼‰ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#stats-atimems-ç®€ä»‹">stats.atimeMs ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-stats-atimems">å¦‚ä½•ä½¿ç”¨ stats.atimeMs</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-25">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-stats-mtimems">ä»€ä¹ˆæ˜¯ stats.mtimeMsï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆmtimemsé‡è¦">ä¸ºä»€ä¹ˆmtimeMsé‡è¦ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•åœ¨-node-js-ä¸­ä½¿ç”¨mtimems">å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨mtimeMs?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-stats-ctimems">è§£é‡Š stats.ctimeMs</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-14">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-35">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹ä»£ç -6">ç¤ºä¾‹ä»£ç ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»£ç ä¾‹å­">ä»£ç ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-stats-mtimens">è§£é‡Š stats.mtimeNs</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯-6">ä½¿ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è¯­">ç»“è¯­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#stats-ctimens-1">stats.ctimeNs</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯ç¤ºä¾‹">ä½¿ç”¨åœºæ™¯ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-5">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-36">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹ä»£ç -7">ç¤ºä¾‹ä»£ç </a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯stats-atime">ä»€ä¹ˆæ˜¯stats.atime</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¸¾ä¾‹-2">å®é™…è¿ç”¨ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-26">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-stats-mtime">ä»€ä¹ˆæ˜¯ stats.mtimeï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆ-stats-mtime-é‡è¦">ä¸ºä»€ä¹ˆ stats.mtime é‡è¦ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-14">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-28">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#stats-birthtime-1">stats.birthtime</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-29">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#class-fs-statfs">Class: fs.StatFs</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-fs-statfs">ä½¿ç”¨ fs.StatFsï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-38">å®é™…è¿ç”¨ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#statfs-bavailçš„å«ä¹‰">statfs.bavailçš„å«ä¹‰ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆbavailé‡è¦">ä¸ºä»€ä¹ˆbavailé‡è¦ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-39">å®é™…è¿ç”¨ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-40">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€æ¦‚å¿µ-4">åŸºç¡€æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#statfs-blocks-1">statfs.blocks</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨åœºæ™¯-6">å®é™…åº”ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#statfs-bsize-1">statfs.bsize</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-15">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-21">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-41">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-6">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-15">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€æ¦‚å¿µ-5">åŸºç¡€æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#statfs-type-è¯¦è§£">statfs.type è¯¦è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-30">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#class-fs-writestream">Class: fs.WriteStream</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-fs-writestream">ä»€ä¹ˆæ˜¯ fs.WriteStreamï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-writestream-çš„å·¥ä½œåŸç†">fs.WriteStream çš„å·¥ä½œåŸç†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-fs-writestream">å¦‚ä½•ä½¿ç”¨ fs.WriteStream</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-13">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-12">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-close-è¯¦è§£">Event: &#39;close&#39; è¯¦è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-11">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆè¦ç”¨event-open">ä¸ºä»€ä¹ˆè¦ç”¨Event: &#39;open&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-42">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-7">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€æ¦‚å¿µ-6">åŸºç¡€æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-ready-çš„ç†è§£">Event: &#39;ready&#39; çš„ç†è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-31">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„ç‚¹-1">æ³¨æ„ç‚¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#é€šä¿—è§£é‡Š">é€šä¿—è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-43">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-13">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-19">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#writestream-close-callback-æ–¹æ³•">writeStream.close([callback]) æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-32">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-14">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-å‘æ–‡ä»¶å†™å…¥æ–‡æœ¬">ä¾‹å­ 1ï¼šå‘æ–‡ä»¶å†™å…¥æ–‡æœ¬</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-å°†æ—¥å¿—ä¿¡æ¯å†™å…¥æ—¥å¿—æ–‡ä»¶">ä¾‹å­ 2ï¼šå°†æ—¥å¿—ä¿¡æ¯å†™å…¥æ—¥å¿—æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£-writestream-pending">ç†è§£ writeStream.pending</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-33">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-22">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fs-constants">fs.constants</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¸¸è§çš„-fs-å¸¸é‡">å¸¸è§çš„ FS å¸¸é‡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-44">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¸¸è§çš„æ–‡ä»¶è®¿é—®å¸¸é‡">å¸¸è§çš„æ–‡ä»¶è®¿é—®å¸¸é‡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-16">å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-15">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ–‡ä»¶æ‹·è´å¸¸é‡">æ–‡ä»¶æ‹·è´å¸¸é‡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-16">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¸¸ç”¨çš„æ–‡ä»¶æ‰“å¼€å¸¸é‡">å¸¸ç”¨çš„æ–‡ä»¶æ‰“å¼€å¸¸é‡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-34">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-1-æ£€æŸ¥æ–‡ä»¶ç±»å‹">å®ä¾‹ 1: æ£€æŸ¥æ–‡ä»¶ç±»å‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-2-åˆ›å»ºç‰¹å®šç±»å‹çš„æ–‡ä»¶">å®ä¾‹ 2: åˆ›å»ºç‰¹å®šç±»å‹çš„æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-3-æƒé™ç®¡ç†">å®ä¾‹ 3: æƒé™ç®¡ç†</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#notes">Notes</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¸¸è§çš„fsæ¨¡å—åŠŸèƒ½">å¸¸è§çš„fsæ¨¡å—åŠŸèƒ½ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-27">æ³¨æ„äº‹é¡¹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ordering-of-callback-and-promise-based-operations">Ordering of callback and promise-based operations</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ‰§è¡Œé¡ºåº">æ‰§è¡Œé¡ºåº</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-45">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦">ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#file-paths">File paths</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»å¯¹è·¯å¾„">ç»å¯¹è·¯å¾„</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç›¸å¯¹è·¯å¾„">ç›¸å¯¹è·¯å¾„</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-46">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-4">ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-16">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¹³å°ç‰¹å®šè€ƒé‡-platform-specific-considerations">å¹³å°ç‰¹å®šè€ƒé‡ (Platform-specific considerations)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-47">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-è¯»å–æ–‡ä»¶-1">ç¤ºä¾‹ 1ï¼šè¯»å–æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-å†™å…¥æ–‡ä»¶-1">ç¤ºä¾‹ 2ï¼šå†™å…¥æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-3-æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨">ç¤ºä¾‹ 3ï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-per-drive-working-directories">ä»€ä¹ˆæ˜¯â€œPer-drive working directoriesâ€ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-ä¸­è¿™ä¸ªç‰¹æ€§çš„å®é™…åº”ç”¨">Node.js ä¸­è¿™ä¸ªç‰¹æ€§çš„å®é™…åº”ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#file-descriptors-1">File descriptors</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€æ¦‚å¿µ-7">åŸºç¡€æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-35">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-8">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#threadpool-usage">Threadpool usage</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-è¯»å–æ–‡ä»¶-3">ç¤ºä¾‹ 1ï¼šè¯»å–æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-å†™å…¥æ–‡ä»¶-3">ç¤ºä¾‹ 2ï¼šå†™å…¥æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-3-è®¡ç®—å¯†é›†å‹ä»»åŠ¡">ç¤ºä¾‹ 3ï¼šè®¡ç®—å¯†é›†å‹ä»»åŠ¡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#file-system-flags">File system flags</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-åˆ›å»ºæˆ–è¿½åŠ ä¸€æ¡æ—¥å¿—">ç¤ºä¾‹ 1: åˆ›å»ºæˆ–è¿½åŠ ä¸€æ¡æ—¥å¿—</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-è¯»å–ç„¶åæ›´æ–°æ–‡ä»¶">ç¤ºä¾‹ 2: è¯»å–ç„¶åæ›´æ–°æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-23">æ€»ç»“ï¼š</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="file-system" tabindex="-1"><a class="header-anchor" href="#file-system"><span><a href="https://nodejs.org/docs/latest/api/fs.html#file-system" target="_blank" rel="noopener noreferrer">File system</a></span></a></h1><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ï¼Œä»è€Œå¯ä»¥æ„å»ºå¿«é€Ÿã€å¯æ‰©å±•çš„ç½‘ç»œåº”ç”¨ç¨‹åºã€‚Node.js çš„ <code>fs</code>ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰æ¨¡å—æ˜¯ä¸€ç»„å…è®¸ä½ ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº’åŠ¨çš„ APIã€‚</p><p>ä¸‹é¢ï¼Œæˆ‘å°†ä»‹ç» Node.js æ–‡ä»¶ç³»ç»Ÿçš„å‡ ä¸ªå…³é”®æ¦‚å¿µå’Œç”¨æ³•ç¤ºä¾‹ï¼š</p><h3 id="_1-è¯»å–æ–‡ä»¶å†…å®¹" tabindex="-1"><a class="header-anchor" href="#_1-è¯»å–æ–‡ä»¶å†…å®¹"><span>1. è¯»å–æ–‡ä»¶å†…å®¹</span></a></h3><p>é€šè¿‡ <code>fs.readFile</code> æ–¹æ³•ï¼Œä½ å¯ä»¥å¼‚æ­¥åœ°è¯»å–æ–‡ä»¶çš„å†…å®¹ã€‚è¿™æ„å‘³ç€å½“ Node.js æ‰§è¡Œæ­¤æ“ä½œæ—¶ï¼Œå®ƒä¸ä¼šé˜»å¡å…¶ä»–ä»£ç çš„æ‰§è¡Œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥è¯»å–æ–‡æœ¬æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–æ–‡ä»¶å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡ºæ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-å†™å…¥æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_2-å†™å…¥æ–‡ä»¶"><span>2. å†™å…¥æ–‡ä»¶</span></a></h3><p>ä½¿ç”¨ <code>fs.writeFile</code> æ–¹æ³•ï¼Œä½ å¯ä»¥å°†æ•°æ®å†™å…¥æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼ŒNode.js ä¼šåˆ›å»ºè¯¥æ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥å°†æ•°æ®å†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºå®ƒ</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello Node.js!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å†™å…¥æ–‡ä»¶å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²è¢«ä¿å­˜</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-è¿½åŠ å†…å®¹åˆ°æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_3-è¿½åŠ å†…å®¹åˆ°æ–‡ä»¶"><span>3. è¿½åŠ å†…å®¹åˆ°æ–‡ä»¶</span></a></h3><p>å¦‚æœä½ æƒ³å‘ç°æœ‰æ–‡ä»¶æ·»åŠ å†…å®¹ï¼Œè€Œä¸æ˜¯è¦†ç›–åŸæœ‰å†…å®¹ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>fs.appendFile</code> æ–¹æ³•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥è¿½åŠ æ•°æ®åˆ°æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºå®ƒ</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">appendFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#EBCB8B;">\n</span><span style="color:#A3BE8C;">è¿™æ˜¯æ–°æ·»åŠ çš„è¡Œ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿½åŠ æ–‡ä»¶å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å†…å®¹å·²è¢«è¿½åŠ åˆ°æ–‡ä»¶</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨" tabindex="-1"><a class="header-anchor" href="#_4-æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨"><span>4. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></a></h3><p>ä½¿ç”¨ <code>fs.existsSync</code> æ–¹æ³•ï¼Œä½ å¯ä»¥åŒæ­¥åœ°æ£€æŸ¥æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åŒæ­¥æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></span>
<span class="line"><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">existsSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å­˜åœ¨</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶ä¸å­˜åœ¨</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-åˆ›å»ºå’Œåˆ é™¤ç›®å½•" tabindex="-1"><a class="header-anchor" href="#_5-åˆ›å»ºå’Œåˆ é™¤ç›®å½•"><span>5. åˆ›å»ºå’Œåˆ é™¤ç›®å½•</span></a></h3><p>ä½ å¯ä»¥ä½¿ç”¨ <code>fs.mkdir</code> å’Œ <code>fs.rmdir</code> æ–¹æ³•æ¥åˆ›å»ºå’Œåˆ é™¤ç›®å½•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">mkdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/new-directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">åˆ›å»ºç›®å½•å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•å·²åˆ›å»º</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥åˆ é™¤ä¸€ä¸ªç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rmdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/new-directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">åˆ é™¤ç›®å½•å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•å·²åˆ é™¤</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šåªæ˜¯ <code>fs</code> æ¨¡å—æä¾›çš„ä¸€å°éƒ¨åˆ†åŠŸèƒ½ã€‚Node.js <code>fs</code> æ¨¡å—éå¸¸å¼ºå¤§ï¼Œæä¾›äº†è®¸å¤šå…¶ä»–æ–¹æ³•æ¥æ‰§è¡Œæ–‡ä»¶æ“ä½œï¼Œä¾‹å¦‚è¯»å–ç›®å½•å†…å®¹ã€ç›‘è§†æ–‡ä»¶å˜åŒ–ã€è®¾ç½®æ–‡ä»¶æƒé™ç­‰ã€‚åœ¨ç¼–å†™ Node.js åº”ç”¨ç¨‹åºæ—¶ï¼Œç†Ÿæ‚‰è¿™ä¸ªæ¨¡å—å¯¹äºå¤„ç†æ–‡ä»¶å’Œç›®å½•è‡³å…³é‡è¦ã€‚</p><h2 id="promise-example" tabindex="-1"><a class="header-anchor" href="#promise-example"><span><a href="https://nodejs.org/docs/latest/api/fs.html#promise-example" target="_blank" rel="noopener noreferrer">Promise example</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªå¯ä»¥è®©ä½ ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç çš„å¹³å°ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ä¸ªå†…ç½®çš„æ¨¡å—å«åš <code>fs</code>ï¼ˆä»£è¡¨æ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œå’Œæ–‡ä»¶ç›¸å…³çš„æ“ä½œï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶ã€å†™å…¥æ–‡ä»¶ã€ä¿®æ”¹æ–‡ä»¶åç­‰ã€‚</p><p>åœ¨ Node.js çš„æ–°ç‰ˆæœ¬ä¸­ï¼Œ<code>fs</code> æ¨¡å—æä¾›äº†ä¸€å¥—åŸºäº Promise çš„ APIã€‚Promise æ˜¯ä¸€ä¸ªè¡¨ç¤ºå¼‚æ­¥æ“ä½œæœ€ç»ˆå®Œæˆæˆ–å¤±è´¥çš„å¯¹è±¡ã€‚ä½¿ç”¨ Promise å¯ä»¥ç”¨æ›´åŠ ç®€æ´å’Œè¿è´¯çš„æ–¹å¼æ¥å¤„ç†å¼‚æ­¥æ“ä½œï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„å›è°ƒå‡½æ•°æ–¹æ³•ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨äº† <code>fs</code> æ¨¡å—ä¸­çš„åŸºäº Promise çš„ API çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> example</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // è¯»å–å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶&#39;input.txt&#39;çš„å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">input.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å°†ä¸€äº›å†…å®¹å†™å…¥åˆ°&#39;output.txt&#39;æ–‡ä»¶ä¸­</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">output.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯ä¸€äº›ç¤ºä¾‹æ–‡æœ¬</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å†™å…¥æˆåŠŸ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // é‡å‘½åæ–‡ä»¶&#39;output.txt&#39;ä¸º&#39;renamed.txt&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rename</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">output.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">renamed.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶é‡å‘½åæˆåŠŸ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // åˆ é™¤æ–‡ä»¶&#39;renamed.txt&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unlink</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">renamed.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶åˆ é™¤æˆåŠŸ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‡ºç°é”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰§è¡Œä¸Šé¢å®šä¹‰çš„ async å‡½æ•°</span></span>
<span class="line"><span style="color:#88C0D0;">example</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† <code>fs.promises</code> å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†è¿”å› Promise çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œæ–¹æ³•ã€‚ç„¶åæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª <code>async</code> å‡½æ•° <code>example</code>ï¼Œè¿™é‡Œ <code>async</code> å…³é”®å­—å…è®¸æˆ‘ä»¬åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨ <code>await</code> å…³é”®å­—ã€‚<code>await</code> å…³é”®å­—ç”¨äºç­‰å¾…ä¸€ä¸ª Promise å®Œæˆï¼Œå¹¶ä¸”åªèƒ½åœ¨ <code>async</code> å‡½æ•°å†…éƒ¨ä½¿ç”¨ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œåœ¨ <code>example</code> å‡½æ•°ä½“å†…ï¼Œæˆ‘ä»¬æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li>ä½¿ç”¨ <code>await fs.readFile()</code> æ–¹æ³•è¯»å–æ–‡ä»¶ã€‚è¿™ä¼šæš‚åœå‡½æ•°æ‰§è¡Œï¼Œç›´åˆ°æ–‡ä»¶è¢«è¯»å–å®Œæ¯•å¹¶è¿”å›å†…å®¹ã€‚</li><li>æ‰“å°è¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ã€‚</li><li>ä½¿ç”¨ <code>await fs.writeFile()</code> æ–¹æ³•å‘æ–‡ä»¶ä¸­å†™å…¥æ–‡æœ¬ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºè¯¥æ–‡ä»¶ï¼›å¦‚æœå­˜åœ¨ï¼Œåˆ™è¦†ç›–å…¶å†…å®¹ã€‚</li><li>è¾“å‡ºæç¤ºï¼Œè¡¨æ˜æ–‡ä»¶å·²æˆåŠŸå†™å…¥ã€‚</li><li>ä½¿ç”¨ <code>await fs.rename()</code> æ–¹æ³•å°†æ–‡ä»¶é‡å‘½åã€‚</li><li>è¾“å‡ºæç¤ºï¼Œè¡¨æ˜æ–‡ä»¶é‡å‘½åæˆåŠŸã€‚</li><li>ä½¿ç”¨ <code>await fs.unlink()</code> æ–¹æ³•åˆ é™¤æ–‡ä»¶ã€‚</li><li>è¾“å‡ºæç¤ºï¼Œè¡¨æ˜æ–‡ä»¶åˆ é™¤æˆåŠŸã€‚</li></ol><p>å¦‚æœåœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­å‘ç”Ÿä»»ä½•é”™è¯¯ï¼Œ<code>catch</code> è¯­å¥æ•è·è¿™ä¸ªé”™è¯¯ï¼Œå¹¶ä¸”æ‰“å°å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬å®é™…è°ƒç”¨ <code>example()</code> å‡½æ•°æ¥æ‰§è¡Œè¿™äº›å¼‚æ­¥æ“ä½œã€‚</p><p>è¿™ç§åŸºäº Promise çš„é£æ ¼ä½¿å¾—å¼‚æ­¥ä»£ç çœ‹èµ·æ¥å’ŒåŒæ­¥ä»£ç ç›¸ä¼¼ï¼Œæ›´å®¹æ˜“ç†è§£å’Œç®¡ç†ã€‚</p><h2 id="callback-example" tabindex="-1"><a class="header-anchor" href="#callback-example"><span><a href="https://nodejs.org/docs/latest/api/fs.html#callback-example" target="_blank" rel="noopener noreferrer">Callback example</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 JavaScript å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒè®©ä½ èƒ½å¤Ÿåœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptï¼Œæ‰§è¡Œå„ç§åç«¯ä»»åŠ¡ã€‚Node.js ä½¿ç”¨äº†éé˜»å¡å¼ I/O å’Œäº‹ä»¶é©±åŠ¨æ¶æ„ï¼Œè¿™ä½¿å¾—å®ƒè½»é‡ä¸”é«˜æ•ˆã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œå›è°ƒï¼ˆCallbackï¼‰æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„ç¼–ç¨‹æ¨¡å¼ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¼‚æ­¥æ“ä½œæ—¶ã€‚ä¾‹å¦‚ï¼Œå½“ä½ è¯»å–æ–‡ä»¶ã€æŸ¥è¯¢æ•°æ®åº“æˆ–å‘é€ HTTP è¯·æ±‚æ—¶ï¼Œä½ é€šå¸¸ä¸ä¼šç«‹åˆ»å¾—åˆ°ç»“æœã€‚ç³»ç»Ÿä¼šç»§ç»­æ‰§è¡Œå…¶ä»–ä»£ç ï¼Œå¹¶åœ¨æ“ä½œå®Œæˆæ—¶é€šè¿‡å›è°ƒå‡½æ•°é€šçŸ¥ä½ ã€‚</p><p>ç°åœ¨ï¼Œæ¥çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ã€‚è¿™é‡Œå°†ä½¿ç”¨ Node.js çš„ <code>fs</code> æ¨¡å—æ¥æ¼”ç¤ºå¦‚ä½•è¯»å–æ–‡ä»¶å†…å®¹ã€‚<code>fs</code> æ¨¡å—æ˜¯ Node.js æ ¸å¿ƒåº“çš„ä¸€éƒ¨åˆ†ï¼Œæä¾›äº†æ–‡ä»¶ç³»ç»Ÿçš„æ“ä½œæ¥å£ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å¼•å…¥æ–‡ä»¶ç³»ç»Ÿæ¨¡å—</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®šä¹‰ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œç”¨äºå¤„ç† readFile æ–¹æ³•å®Œæˆåçš„ç»“æœ</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> callback</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–æ–‡ä»¶å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#616E88;">  // å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œæ‰“å°å‡ºæ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å†…å®¹:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ readFile æ–¹æ³•å¼‚æ­¥åœ°è¯»å–æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#616E88;">// ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#616E88;">// ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ–‡ä»¶ç¼–ç </span></span>
<span class="line"><span style="color:#616E88;">// ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æˆ‘ä»¬åˆšæ‰å®šä¹‰çš„å›è°ƒå‡½æ•°</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> callback</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ol><li>æˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† <code>fs</code> æ¨¡å—ã€‚</li><li>ç„¶åæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå« <code>callback</code> çš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š<code>err</code> å’Œ <code>data</code>ã€‚å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œ<code>err</code> ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼›å¦‚æœæˆåŠŸè¯»å–æ–‡ä»¶ï¼Œ<code>data</code> åˆ™åŒ…å«æ–‡ä»¶å†…å®¹ã€‚</li><li>æ¥ç€æˆ‘ä»¬è°ƒç”¨ <code>fs.readFile</code> æ–¹æ³•è¿›è¡Œå¼‚æ­¥æ–‡ä»¶è¯»å–ã€‚æˆ‘ä»¬ä¼ é€’äº†æ–‡ä»¶è·¯å¾„ï¼Œæ–‡ä»¶ç¼–ç ï¼ˆè¿™é‡Œæ˜¯ <code>utf8</code>ï¼Œæ„å‘³ç€æ–‡ä»¶å†…å®¹å°†è¢«è§£é‡Šä¸º UTF-8 æ–‡æœ¬ï¼‰ï¼Œä»¥åŠæˆ‘ä»¬çš„ <code>callback</code> å‡½æ•°ä½œä¸ºå‚æ•°ã€‚</li><li>å½“ <code>readFile</code> å®Œæˆæ—¶ï¼ˆæ— è®ºæˆåŠŸæˆ–å¤±è´¥ï¼‰ï¼Œå®ƒéƒ½ä¼šè°ƒç”¨ <code>callback</code> å‡½æ•°ã€‚å¦‚æœè¯»å–è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ï¼Œæ¯”å¦‚æ–‡ä»¶ä¸å­˜åœ¨æˆ–è€…æ²¡æœ‰è¯»å–æƒé™ï¼Œ<code>err</code> å‚æ•°å°±ä¼šåŒ…å«ä¸€ä¸ªé”™è¯¯å¯¹è±¡ã€‚å¦åˆ™ï¼Œ<code>err</code> å°†ä¸º <code>null</code>ï¼Œè€Œ <code>data</code> å‚æ•°å°†åŒ…å«æ–‡ä»¶çš„å†…å®¹ã€‚</li></ol><p>ä½¿ç”¨å›è°ƒæ–¹å¼çš„ç¼ºç‚¹æ˜¯éšç€é€»è¾‘å¤æ‚åº¦ä¸Šå‡ï¼Œä»£ç å¯èƒ½ä¼šé™·å…¥â€œå›è°ƒåœ°ç‹±â€ï¼Œå³å¤§é‡åµŒå¥—çš„å›è°ƒå‡½æ•°ï¼Œä½¿å¾—ä»£ç éš¾ä»¥é˜…è¯»å’Œç»´æŠ¤ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç°ä»£ JavaScript æä¾›äº† <code>Promise</code> å’Œ <code>async/await</code> è¯­æ³•ã€‚ä½†æ˜¯æŒæ¡åŸºç¡€çš„å›è°ƒæ¨¡å¼ä¾ç„¶å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒå¸®åŠ©æˆ‘ä»¬ç†è§£ Node.js çš„åº•å±‚å·¥ä½œæœºåˆ¶ã€‚</p><h2 id="synchronous-example" tabindex="-1"><a class="header-anchor" href="#synchronous-example"><span><a href="https://nodejs.org/docs/latest/api/fs.html#synchronous-example" target="_blank" rel="noopener noreferrer">Synchronous example</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œèƒ½è®©ä½ ç”¨ JavaScript å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚å®ƒæœ‰ä¸€ä¸ªå¼ºå¤§çš„æ ‡å‡†åº“ï¼Œå…¶ä¸­ <code>fs</code> (æ–‡ä»¶ç³»ç»Ÿ) æ¨¡å—æ˜¯ç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„ï¼Œæ¯”å¦‚è¯»å†™æ–‡ä»¶ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œä½ å¯ä»¥åŒæ­¥ï¼ˆsynchronouslyï¼‰æˆ–å¼‚æ­¥ï¼ˆasynchronouslyï¼‰åœ°ä½¿ç”¨ <code>fs</code> æ¨¡å—ã€‚å½“ä½ åŒæ­¥åœ°è°ƒç”¨å‡½æ•°æ—¶ï¼Œä»£ç ä¼šåœä¸‹æ¥ç­‰å¾…æ“ä½œå®Œæˆï¼Œç„¶åæ‰ç»§ç»­æ‰§è¡Œä¸‹ä¸€è¡Œä»£ç ã€‚è¿™ç§æ–¹å¼å¾ˆç›´è§‚ï¼Œä½†å¯èƒ½å¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå› ä¸ºå®ƒé˜»å¡äº†äº‹ä»¶å¾ªç¯ï¼Œä½¿å¾— Node.js ä¸èƒ½åŒæ—¶å¤„ç†å…¶ä»–äº‹æƒ…ã€‚ä¸è¿‡ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¾‹å¦‚è„šæœ¬å¯åŠ¨æ—¶è¿›è¡Œåˆå§‹åŒ–é…ç½®ï¼ŒåŒæ­¥æ“ä½œæ˜¯å¯æ¥å—çš„ã€‚</p><p>è¿™é‡Œæˆ‘å°†ä¸¾ä¾‹è¯´æ˜å¦‚ä½•åœ¨ Node.js v21.7.1 ä¸­åŒæ­¥åœ°è¯»å–å’Œå†™å…¥æ–‡ä»¶ã€‚</p><h3 id="åŒæ­¥è¯»å–æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#åŒæ­¥è¯»å–æ–‡ä»¶"><span>åŒæ­¥è¯»å–æ–‡ä»¶</span></a></h3><p>å‡è®¾æˆ‘ä»¬æƒ³è¯»å–ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡ä»¶ï¼Œå¹¶è¾“å‡ºå…¶å†…å®¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // åŒæ­¥è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf-8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // è¾“å‡ºæ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">  // å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œä¾‹å¦‚æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">An error occurred:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é¦–å…ˆå¼•å…¥äº† <code>fs</code> æ¨¡å—ã€‚ç„¶åä½¿ç”¨ <code>readFileSync</code> å‡½æ•°åŒæ­¥åœ°è¯»å–æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶è¯»å–æˆåŠŸï¼Œå®ƒçš„å†…å®¹ä¼šè¢«å­˜å‚¨åœ¨å˜é‡ <code>data</code> ä¸­ï¼Œå¹¶éšåè¾“å‡ºåˆ°æ§åˆ¶å°ã€‚å¦‚æœè¯»å–è¿‡ç¨‹ä¸­å‡ºç°ä»»ä½•é”™è¯¯ï¼ˆå¦‚æ–‡ä»¶ä¸å­˜åœ¨ï¼‰ï¼Œåˆ™æ•è·å¼‚å¸¸å¹¶æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="åŒæ­¥å†™å…¥æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#åŒæ­¥å†™å…¥æ–‡ä»¶"><span>åŒæ­¥å†™å…¥æ–‡ä»¶</span></a></h3><p>ç°åœ¨ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦åŒæ­¥åœ°å†™å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> contentToWrite</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, Node.js!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // åŒæ­¥å†™å…¥å†…å®¹åˆ°æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">output.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> contentToWrite</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // è¾“å‡ºæç¤ºä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File written successfully</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">  // å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œä¾‹å¦‚æ²¡æœ‰å†™æƒé™ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">An error occurred:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šè¿°ä»£ç ä¼šåˆ›å»ºï¼ˆæˆ–è¦†ç›–ï¼‰ä¸€ä¸ªåä¸º <code>output.txt</code> çš„æ–‡ä»¶ï¼Œå¹¶å‘å…¶ä¸­å†™å…¥ <code>&#39;Hello, Node.js!&#39;</code> å­—ç¬¦ä¸²ã€‚ä½¿ç”¨ <code>writeFileSync</code> æ–¹æ³•ï¼Œå¯ä»¥ç¡®ä¿åœ¨æ§åˆ¶å°æ‰“å° &quot;File written successfully&quot; ä¹‹å‰ï¼Œæ–‡ä»¶å·²ç»è¢«æ­£ç¡®å†™å…¥ã€‚å¦‚æœå†™å…¥è¿‡ç¨‹ä¸­é‡åˆ°é”™è¯¯ï¼Œåˆ™ä¼šæ•è·å¹¶æ‰“å°å‡ºé”™ä¿¡æ¯ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹"><span>æ³¨æ„äº‹é¡¹</span></a></h3><p>è™½ç„¶åŒæ­¥æ“ä½œåœ¨æŸäº›åœºæ™¯ä¸‹ç®€å•æ˜“ç”¨ï¼Œä½†åœ¨å¤„ç†é•¿æ—¶é—´è¿è¡Œçš„æ–‡ä»¶æ“ä½œæˆ–åœ¨é«˜æµé‡çš„æœåŠ¡ä¸­æ—¶ï¼Œåº”å°½é‡ä½¿ç”¨å¼‚æ­¥æ“ä½œä»¥é¿å…é˜»å¡ Node.js çš„äº‹ä»¶å¾ªç¯ã€‚è¿™æ ·å¯ä»¥æ›´å……åˆ†åœ°å‘æŒ¥ Node.js éé˜»å¡ I/O çš„ä¼˜åŠ¿ï¼Œæé«˜ç¨‹åºçš„æ€§èƒ½å’Œå“åº”é€Ÿåº¦ã€‚</p><h2 id="promises-api" tabindex="-1"><a class="header-anchor" href="#promises-api"><span><a href="https://nodejs.org/docs/latest/api/fs.html#promises-api" target="_blank" rel="noopener noreferrer">Promises API</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©ä½ å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚Node.js æä¾›äº†å¾ˆå¤šæ¨¡å—ï¼Œå…¶ä¸­ <code>fs</code>ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰æ¨¡å—æ˜¯ç”¨æ¥åœ¨ Node.js ä¸­è¯»å†™æ–‡ä»¶çš„ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œé€šå¸¸æœ‰ä¸¤ç§æ–¹å¼æ¥å¤„ç†å¼‚æ­¥æ“ä½œï¼šå›è°ƒï¼ˆcallbacksï¼‰å’Œ Promisesã€‚Promises æä¾›äº†ä¸€ç§æ›´å¥½çš„å¼‚æ­¥ç¼–ç¨‹ä½“éªŒï¼Œå› ä¸ºå®ƒä»¬å‡å°‘äº†æ‰€è°“çš„ &quot;å›è°ƒåœ°ç‹±&quot;ï¼ˆåµŒå¥—çš„å›è°ƒå‡½æ•°ï¼‰ï¼Œå¹¶ä¸”å®ƒä»¬ä½¿å¾—é“¾å¼æ“ä½œæ›´åŠ ç®€æ´æ¸…æ™°ã€‚</p><p>ä» Node.js v10 å¼€å§‹ï¼Œ<code>fs</code> æ¨¡å—æä¾›äº†ä¸€ä¸ªåŸºäº Promise çš„ APIï¼Œå¯ä»¥ä½¿ç”¨ <code>fs.promises</code> è®¿é—®ã€‚è¿™æ„å‘³ç€æ‰€æœ‰åŸæœ¬åŸºäºå›è°ƒçš„ fs æ–¹æ³•ç°åœ¨éƒ½æœ‰åŸºäº Promise çš„ç‰ˆæœ¬ï¼Œè¿™æ ·ä½ å°±å¯ä»¥ä½¿ç”¨ <code>async/await</code> æˆ–è€… <code>.then/.catch</code> é“¾å¼è°ƒç”¨äº†ã€‚</p><h3 id="å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹"><span>å®ä¾‹</span></a></h3><h4 id="è¯»å–æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#è¯»å–æ–‡ä»¶"><span>è¯»å–æ–‡ä»¶</span></a></h4><p><strong>ä¼ ç»Ÿçš„å›è°ƒæ–¹å¼</strong>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/my/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">An error occurred:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä½¿ç”¨ Promises API</strong>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readFile</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/my/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">An error occurred:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ–è€…ä½¿ç”¨ <code>.then/.catch</code>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/my/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">then</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#D8DEE9;"> console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">))</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#D8DEE9;"> console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">An error occurred:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å†™å…¥æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#å†™å…¥æ–‡ä»¶"><span>å†™å…¥æ–‡ä»¶</span></a></h4><p><strong>ä¼ ç»Ÿçš„å›è°ƒæ–¹å¼</strong>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/my/newfile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">New file content</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">An error occurred:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File written successfully</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä½¿ç”¨ Promises API</strong>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> writeFile</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/my/newfile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">New file content</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File written successfully</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">An error occurred:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="åˆ é™¤æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#åˆ é™¤æ–‡ä»¶"><span>åˆ é™¤æ–‡ä»¶</span></a></h4><p><strong>ä¼ ç»Ÿçš„å›è°ƒæ–¹å¼</strong>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unlink</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/my/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">An error occurred:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File deleted successfully</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä½¿ç”¨ Promises API</strong>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> deleteFile</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unlink</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/my/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File deleted successfully</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">An error occurred:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">deleteFile</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ³¨æ„äº‹é¡¹-1" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-1"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>å½“ä½¿ç”¨ <code>async/await</code> æ—¶ï¼Œä»»ä½• <code>await</code> åè·Ÿçš„è¡¨è¾¾å¼éƒ½ä¼šç­‰å¾… Promise å®Œæˆï¼Œå¹¶è¿”å›è§£å†³ï¼ˆresolvedï¼‰å€¼ã€‚</li><li>åœ¨ <code>async</code> å‡½æ•°ä¸­ï¼Œé”™è¯¯é€šå¸¸æ˜¯é€šè¿‡ <code>try/catch</code> å—æ¥æ•è·çš„ï¼Œè¿™ä¸åŒæ­¥ä»£ç ä¸­çš„é”™è¯¯å¤„ç†ç›¸ä¼¼ã€‚</li><li>å½“ä½¿ç”¨ <code>.then/.catch</code> æ—¶ï¼Œ<code>.then</code> æ¥æ”¶åˆ°çš„æ˜¯ä¸Šä¸€ä¸ª <code>.then</code> è¿”å›çš„ Promise è§£å†³ä¹‹åçš„ç»“æœï¼Œè€Œ <code>.catch</code> ç”¨äºæ•è·å‰é¢ä»»ä½•ä¸€ä¸ª Promise çš„æ‹’ç»ï¼ˆrejectï¼‰çŠ¶æ€ã€‚</li></ul><p>æ€»çš„æ¥è¯´ï¼Œä½¿ç”¨ Promise API å¯ä»¥è®©å¼‚æ­¥ä»£ç æ›´å®¹æ˜“é˜…è¯»å’Œç»´æŠ¤ï¼Œå°¤å…¶æ˜¯å½“ä½ åœ¨è¿›è¡Œå¤æ‚çš„æ–‡ä»¶æ“ä½œæ—¶ã€‚</p><h3 id="class-filehandle" tabindex="-1"><a class="header-anchor" href="#class-filehandle"><span><a href="https://nodejs.org/docs/latest/api/fs.html#class-filehandle" target="_blank" rel="noopener noreferrer">Class: FileHandle</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒå…è®¸ä½ ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ä¸ªæ¨¡å—å«åš <code>fs</code> (æ–‡ä»¶ç³»ç»Ÿ)ï¼Œç”¨æ¥è¿›è¡Œæ–‡ä»¶æ“ä½œã€‚<code>FileHandle</code> æ˜¯ <code>fs</code> æ¨¡å—å½“ä¸­çš„ä¸€ä¸ªç±»ï¼Œå®ƒæ˜¯å¯¹æ‰“å¼€çš„æ–‡ä»¶çš„æŠ½è±¡è¡¨ç¤ºã€‚</p><p>å½“ä½ åœ¨ Node.js ä¸­æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œé€šå¸¸ä¼šé€šè¿‡ <code>fs.open()</code> å‡½æ•°æ¥å®Œæˆï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ª <code>FileHandle</code> çš„å®ä¾‹ã€‚è¿™ä¸ªå®ä¾‹æä¾›äº†å¤šç§æ–¹æ³•æ¥å¯¹æ–‡ä»¶è¿›è¡Œè¯»å–ã€å†™å…¥ã€å…³é—­ç­‰æ“ä½œã€‚</p><p>ä¸‹é¢ä¸¾å‡ ä¸ªå®ä¾‹æ¥è¯´æ˜ <code>FileHandle</code> çš„ä½¿ç”¨ï¼š</p><h3 id="ä¾‹å­-1-è¯»å–æ–‡ä»¶å†…å®¹" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-è¯»å–æ–‡ä»¶å†…å®¹"><span>ä¾‹å­ 1ï¼šè¯»å–æ–‡ä»¶å†…å®¹</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å¯¼å…¥promiseé£æ ¼çš„fsæ¨¡å—</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readFileContents</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> null;</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å¹¶è·å– FileHandle å®ä¾‹</span></span>
<span class="line"><span style="color:#D8DEE9;">    filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // è¯»å–æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">{</span><span style="color:#88C0D0;"> encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf-8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // ç¡®ä¿åœ¨ç»“æŸå‰å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">filehandle</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">      await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨å‡½æ•°ï¼Œç”¨å®é™…è·¯å¾„æ›¿æ¢ &#39;path/to/your/file.txt&#39;</span></span>
<span class="line"><span style="color:#88C0D0;">readFileContents</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path/to/your/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä¾‹å­-2-å‘æ–‡ä»¶å†™å…¥å†…å®¹" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-å‘æ–‡ä»¶å†™å…¥å†…å®¹"><span>ä¾‹å­ 2ï¼šå‘æ–‡ä»¶å†™å…¥å†…å®¹</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å¯¼å…¥promiseé£æ ¼çš„fsæ¨¡å—</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> writeFileContents</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> content</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> null;</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // ä½¿ç”¨ &#39;w&#39; æ ‡å¿—æ‰“å¼€æ–‡ä»¶ä»¥ä¾¿å†™å…¥, å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»º</span></span>
<span class="line"><span style="color:#D8DEE9;">    filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å‘æ–‡ä»¶å†™å…¥å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">content</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Write complete.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // ç¡®ä¿åœ¨ç»“æŸå‰å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">filehandle</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">      await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨å‡½æ•°</span></span>
<span class="line"><span style="color:#88C0D0;">writeFileContents</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path/to/your/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">This is some new content!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä¾‹å­-3-å…³é—­æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-3-å…³é—­æ–‡ä»¶"><span>ä¾‹å­ 3ï¼šå…³é—­æ–‡ä»¶</span></a></h3><p>æ¯æ¬¡ä½¿ç”¨å®Œ <code>FileHandle</code> åï¼Œéƒ½åº”è¯¥å…³é—­æ–‡ä»¶ä»¥é‡Šæ”¾èµ„æºã€‚è™½ç„¶ Node.js æœ‰è‡ªåŠ¨åƒåœ¾å›æ”¶æœºåˆ¶æ¥å…³é—­æœªè¢«å¼•ç”¨çš„æ–‡ä»¶ï¼Œä½†æœ€å¥½æ‰‹åŠ¨å…³é—­å®ƒä»¬ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> openAndCloseFile</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å¯¹æ–‡ä»¶è¿›è¡Œä¸€äº›æ“ä½œ</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // æ˜¾å¼åœ°å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">openAndCloseFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path/to/your/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼Œåœ¨æ‰€æœ‰ä¾‹å­ä¸­ï¼Œæˆ‘éƒ½ä½¿ç”¨äº† <code>fs/promises</code> æ¨¡å—ï¼Œè¿™æ ·å¯ä»¥è®©æˆ‘ä»¬ä½¿ç”¨ <code>async</code> å’Œ <code>await</code> æ¥å¤„ç†å¼‚æ­¥æ“ä½œï¼Œä½¿ä»£ç æ›´æ˜“äºé˜…è¯»å’Œç»´æŠ¤ã€‚ <code>fs</code> æ¨¡å—è¿˜æœ‰ä¸€ä¸ªåŸºäºå›è°ƒçš„æ—§ APIï¼Œä½†æ˜¯æ¨èä½¿ç”¨ promises é£æ ¼çš„ APIï¼Œå› ä¸ºå®ƒå¯ä»¥é¿å…å›è°ƒåœ°ç‹±ï¼Œå¹¶æ”¯æŒåŒæ­¥çš„é”™è¯¯å¤„ç†æ–¹å¼ã€‚</p><h4 id="event-close" tabindex="-1"><a class="header-anchor" href="#event-close"><span><a href="https://nodejs.org/docs/latest/api/fs.html#event-close" target="_blank" rel="noopener noreferrer">Event: &#39;close&#39;</a></span></a></h4><p>Node.js çš„ <code>fs</code> æ¨¡å—æ˜¯ç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ï¼Œå®ƒæä¾›äº†å„ç§å·¥å…·æ¥å¸®åŠ©ä½ è¯»å†™æ–‡ä»¶ã€ç›‘å¬æ–‡ä»¶äº‹ä»¶ç­‰ã€‚åœ¨ Node.js ä¸­ï¼Œè®¸å¤šæ“ä½œéƒ½æ˜¯åŸºäºäº‹ä»¶çš„ï¼Œè¿™æ„å‘³ç€å½“æŸä¸ªåŠ¨ä½œå®Œæˆæˆ–è€…å‘ç”Ÿç‰¹å®šäº‹ä»¶æ—¶ï¼Œä¼šè§¦å‘ç›¸åº”çš„å›è°ƒå‡½æ•°ã€‚</p><p>ç°åœ¨æˆ‘ä»¬æ¥è°ˆè°ˆ <code>Event: &#39;close&#39;</code>ï¼Œè¿™æ˜¯ <code>fs</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªäº‹ä»¶ã€‚å½“ä½¿ç”¨å¯è¯»æˆ–å¯å†™æµï¼ˆstreamsï¼‰å¤„ç†æ–‡ä»¶æ—¶ï¼Œæµåœ¨å…³é—­åä¼šå‘å‡º <code>&#39;close&#39;</code> äº‹ä»¶ã€‚ç®€å•æ¥è¯´ï¼Œä¸€æ—¦æµç»“æŸäº†æ•°æ®çš„è¯»å–æˆ–å†™å…¥ï¼Œå¹¶ä¸”é‡Šæ”¾äº†èµ„æºï¼ˆæ¯”å¦‚å…³é—­äº†æ–‡ä»¶æè¿°ç¬¦ï¼‰ï¼Œå°±ä¼šå‘å‡º <code>&#39;close&#39;</code> äº‹ä»¶ã€‚</p><p>ä¸ºä»€ä¹ˆéœ€è¦ <code>&#39;close&#39;</code> äº‹ä»¶ï¼Ÿå› ä¸ºåœ¨å¤„ç†æ–‡ä»¶å’Œæµæ—¶ï¼ŒçŸ¥é“ä½•æ—¶ä¸€ä¸ªæµç»“æŸæ˜¯å¾ˆé‡è¦çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æ­£åœ¨å†™å…¥ä¸€ä¸ªå¤§æ–‡ä»¶ï¼Œä½ å¯èƒ½æƒ³è¦åœ¨å†™å…¥å®Œæ¯•åé€šçŸ¥ç”¨æˆ·ï¼Œæˆ–è€…å¼€å§‹è¿›è¡Œä¸‹ä¸€æ­¥çš„æ“ä½œï¼Œæ­¤æ—¶é€šè¿‡ç›‘å¬ <code>&#39;close&#39;</code> äº‹ä»¶å¯ä»¥å®ç°è¿™ä¸€éœ€æ±‚ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬çœ‹å‡ ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><h3 id="ç¤ºä¾‹-1-è¯»å–æ–‡ä»¶æµå¹¶ç›‘å¬å…³é—­äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-è¯»å–æ–‡ä»¶æµå¹¶ç›‘å¬å…³é—­äº‹ä»¶"><span>ç¤ºä¾‹ 1ï¼šè¯»å–æ–‡ä»¶æµå¹¶ç›‘å¬å…³é—­äº‹ä»¶</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªå¯è¯»æµ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> readStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘å¬ &#39;close&#39; äº‹ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">close</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–æµå·²ç»å…³é—­</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼€å§‹è¯»å–æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">resume</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // resume()æ–¹æ³•ç”¨æ¥ç¡®ä¿æµä¼šå¼€å§‹è§¦å‘ &#39;data&#39; äº‹ä»¶</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡ä»¶çš„å¯è¯»æµï¼Œå¹¶ç›‘å¬äº†å®ƒçš„ <code>&#39;close&#39;</code> äº‹ä»¶ã€‚ä¸€æ—¦æ–‡ä»¶å†…å®¹è¯»å–å®Œæ¯•å¹¶ä¸”æµè¢«å…³é—­ï¼Œå°±ä¼šæ‰“å°å‡º <code>&#39;è¯»å–æµå·²ç»å…³é—­&#39;</code>ã€‚</p><h3 id="ç¤ºä¾‹-2-å†™å…¥æ–‡ä»¶æµå¹¶ç›‘å¬å…³é—­äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å†™å…¥æ–‡ä»¶æµå¹¶ç›‘å¬å…³é—­äº‹ä»¶"><span>ç¤ºä¾‹ 2ï¼šå†™å…¥æ–‡ä»¶æµå¹¶ç›‘å¬å…³é—­äº‹ä»¶</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªå¯å†™æµ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> writeStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">output.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å†™å…¥ä¸€äº›æ•°æ®åˆ°æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello, World!</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ ‡è®°æ–‡ä»¶æœ«å°¾</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘å¬ &#39;close&#39; äº‹ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">close</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å†™å…¥æµå·²ç»å…³é—­</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸º <code>output.txt</code> çš„æ–‡ä»¶çš„å¯å†™æµã€‚ç„¶åå‘æ–‡ä»¶ä¸­å†™å…¥äº†ä¸€äº›æ•°æ®ï¼Œæ¥ç€è°ƒç”¨äº† <code>end()</code> æ–¹æ³•è¡¨ç¤ºæ²¡æœ‰æ›´å¤šçš„æ•°æ®è¦å†™å…¥äº†ã€‚æœ€åï¼Œæˆ‘ä»¬ç›‘å¬äº† <code>&#39;close&#39;</code> äº‹ä»¶ï¼Œä¸€æ—¦æ‰€æœ‰æ•°æ®éƒ½å†™å…¥å®Œæ¯•å¹¶ä¸”æµå…³é—­ï¼Œå°±ä¼šæ‰“å°å‡º <code>&#39;å†™å…¥æµå·²ç»å…³é—­&#39;</code> çš„æç¤ºã€‚</p><p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œç†è§£å’Œåˆç†åˆ©ç”¨ <code>&#39;close&#39;</code> äº‹ä»¶å¯¹äºç®¡ç†èµ„æºå’Œæµç¨‹æ§åˆ¶å¾ˆæœ‰å¸®åŠ©ã€‚ä¸Šè¿°ç¤ºä¾‹å±•ç¤ºäº†æ€æ ·åœ¨æµå…³é—­åæ‰§è¡Œä¸€äº›æ¸…ç†æˆ–è€…è·Ÿè¿›çš„åŠ¨ä½œã€‚</p><h4 id="filehandle-appendfile-data-options" tabindex="-1"><a class="header-anchor" href="#filehandle-appendfile-data-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandleappendfiledata-options" target="_blank" rel="noopener noreferrer">filehandle.appendFile(data[, options])</a></span></a></h4><p>Node.js æä¾›äº†ä¸€ä¸ªå†…ç½®çš„ <code>fs</code> æ¨¡å—ï¼Œç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚åœ¨ Node.js ä¸­ä»¥å¼‚æ­¥æ–¹å¼æ“ä½œæ–‡ä»¶æ˜¯éå¸¸å¸¸è§çš„ï¼Œè¿™æ„å‘³ç€ä»£ç æ‰§è¡Œä¸ä¼šåœæ­¢ç­‰å¾…æ–‡ä»¶æ“ä½œå®Œæˆï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œä¸‹å»ï¼Œå¹¶ä¸”åœ¨æ–‡ä»¶æ“ä½œç»“æŸæ—¶é€šè¿‡å›è°ƒå‡½æ•°å¾—åˆ°é€šçŸ¥ã€‚</p><p>åœ¨ <code>fs</code> æ¨¡å—ä¸­ï¼Œ<code>filehandle.appendFile(data[, options])</code> æ˜¯ä¸€ä¸ªç”¨æ¥å‘æ–‡ä»¶å°¾éƒ¨è¿½åŠ æ•°æ®çš„æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•å±äº <code>fsPromises</code> API çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå½“æ“ä½œå®Œæˆæˆ–å‡ºç°é”™è¯¯æ—¶ï¼ŒPromise è¢«è§£å†³ï¼ˆresolvedï¼‰æˆ–æ‹’ç»ï¼ˆrejectedï¼‰ã€‚</p><p>è®©æˆ‘ä»¬è¯¦ç»†äº†è§£ä¸€ä¸‹ <code>filehandle.appendFile(data[, options])</code> æ–¹æ³•ï¼š</p><ul><li><strong>filehandle</strong>: è¿™æ˜¯ä¸€ä¸ªæ‰“å¼€æ–‡ä»¶çš„æ–‡ä»¶å¥æŸ„å¯¹è±¡ã€‚ä½ é¦–å…ˆéœ€è¦ä½¿ç”¨ <code>fsPromises.open()</code> æ–¹æ³•æ¥å¼‚æ­¥æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å¹¶è·å–åˆ°è¿™ä¸ª <code>filehandle</code>ã€‚</li><li><strong>data</strong>: è¿™ä¸ªå‚æ•°æ˜¯ä½ æƒ³è¦è¿½åŠ åˆ°æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…ä¸€ä¸ª Bufferï¼ˆå³äºŒè¿›åˆ¶æ•°æ®ï¼‰ã€‚</li><li><strong>options (å¯é€‰)</strong>: è¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒå…è®¸ä½ æŒ‡å®šå¦‚ä½•å†™å…¥æ•°æ®ï¼Œæ¯”å¦‚ç¼–ç æ ¼å¼ï¼Œé»˜è®¤æ˜¯ <code>&#39;utf8&#39;</code>ã€‚</li></ul><h3 id="ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­"><span>ä¾‹å­</span></a></h3><h4 id="ä¾‹å­-1-è¿½åŠ æ–‡æœ¬å­—ç¬¦ä¸²åˆ°æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-è¿½åŠ æ–‡æœ¬å­—ç¬¦ä¸²åˆ°æ–‡ä»¶"><span>ä¾‹å­ 1ï¼šè¿½åŠ æ–‡æœ¬å­—ç¬¦ä¸²åˆ°æ–‡ä»¶</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> appendToFile</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filename</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> content</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // æ‰“å¼€æ–‡ä»¶è·å–æ–‡ä»¶å¥æŸ„</span></span>
<span class="line"><span style="color:#D8DEE9;">    filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filename</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // å‘æ–‡ä»¶è¿½åŠ å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">appendFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">content</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Content appended to file successfully!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // å¦‚æœæœ‰ä»»ä½•é”™è¯¯å‘ç”Ÿï¼Œä¼šè¢«æ•è·å¹¶æ‰“å°å‡ºæ¥</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error appending to file:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">filehandle</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">      // æœ€åç¡®ä¿æ–‡ä»¶è¢«æ­£ç¡®å…³é—­</span></span>
<span class="line"><span style="color:#81A1C1;">      await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨è¯¥å‡½æ•°å°†æ–‡æœ¬è¿½åŠ åˆ° &#39;notes.txt&#39; æ–‡ä»¶</span></span>
<span class="line"><span style="color:#88C0D0;">appendToFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">notes.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, this is new text added to the file.</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ª <code>appendToFile</code> å‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªæ˜¯æ–‡ä»¶åï¼Œå¦ä¸€ä¸ªæ˜¯è¦è¿½åŠ çš„å†…å®¹ã€‚å‡½æ•°ä½¿ç”¨äº† async/await è¯­æ³•ï¼Œä½¿å…¶å¼‚æ­¥æ‰§è¡Œæ›´ç›´è§‚ã€‚é¦–å…ˆä½¿ç”¨ <code>fs.open()</code> æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶è®¾ç½®æ¨¡å¼ä¸º <code>&#39;a&#39;</code>ï¼ˆä»£è¡¨è¿½åŠ ï¼‰ã€‚ç„¶åè°ƒç”¨ <code>filehandle.appendFile()</code> å°†å†…å®¹è¿½åŠ åˆ°æ–‡ä»¶ä¸­ã€‚æœ€åï¼Œæ— è®ºæˆåŠŸä¸å¦ï¼Œéƒ½å°è¯•å…³é—­æ–‡ä»¶å¥æŸ„ã€‚</p><h4 id="ä¾‹å­-2-è¿½åŠ -buffer-æ•°æ®åˆ°æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-è¿½åŠ -buffer-æ•°æ®åˆ°æ–‡ä»¶"><span>ä¾‹å­ 2ï¼šè¿½åŠ  Buffer æ•°æ®åˆ°æ–‡ä»¶</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> appendBufferToFile</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filename</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filename</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">appendFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffer</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Buffer appended to file successfully!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error appending buffer to file:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">filehandle</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">      await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ª Buffer å¹¶å°†å…¶è¿½åŠ åˆ° &#39;binarydata.bin&#39; æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">([</span><span style="color:#B48EAD;">0x48</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0x65</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0x6c</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0x6c</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0x6f</span><span style="color:#D8DEE9FF;">])</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // Buffer åŒ…å« ASCII å­—ç¬¦ &quot;Hello&quot;</span></span>
<span class="line"><span style="color:#88C0D0;">appendBufferToFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">binarydata.bin</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«æ–‡æœ¬ &quot;Hello&quot;ï¼ˆä»¥ ASCII ç è¡¨ç¤ºï¼‰çš„ Bufferï¼Œå¹¶ä½¿ç”¨ <code>appendBufferToFile</code> å‡½æ•°å°†å…¶è¿½åŠ åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚è¿‡ç¨‹ç±»ä¼¼äºç¬¬ä¸€ä¸ªä¾‹å­ï¼Œé™¤äº†ä¼ é€’ç»™ <code>filehandle.appendFile</code> çš„æ˜¯ä¸€ä¸ª Buffer è€Œä¸æ˜¯å­—ç¬¦ä¸²ã€‚</p><p>æ³¨æ„ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½éœ€è¦å¤„ç†å„ç§é”™è¯¯æƒ…å†µï¼Œä¾‹å¦‚æ–‡ä»¶ä¸å­˜åœ¨ã€æ²¡æœ‰å†™å…¥æƒé™ç­‰ã€‚ä¸Šè¿°ä¾‹å­ç®€åŒ–äº†é”™è¯¯å¤„ç†ï¼Œä»…é€šè¿‡ <code>console.error</code> æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚åœ¨çœŸæ­£çš„ç¨‹åºä¸­ï¼Œä½ å¯èƒ½éœ€è¦å¯¹é”™è¯¯è¿›è¡Œæ›´ç»†è‡´çš„æ£€æŸ¥å’Œå¤„ç†ã€‚</p><h4 id="filehandle-chmod-mode" tabindex="-1"><a class="header-anchor" href="#filehandle-chmod-mode"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandlechmodmode" target="_blank" rel="noopener noreferrer">filehandle.chmod(mode)</a></span></a></h4><p><code>filehandle.chmod(mode)</code> æ˜¯ä¸€ä¸ª Node.js çš„æ–‡ä»¶ç³»ç»Ÿ(fs)æ¨¡å—ä¸­çš„æ–¹æ³•ï¼Œå®ƒç”¨äºæ›´æ”¹ä¸€ä¸ªå·²æ‰“å¼€æ–‡ä»¶çš„æƒé™ã€‚åœ¨ Unix-like ç³»ç»Ÿä¸­ï¼ˆæ¯”å¦‚ Linux æˆ– macOSï¼‰ï¼Œæ–‡ä»¶æƒé™å†³å®šäº†è°å¯ä»¥è¯»å–ã€å†™å…¥æˆ–æ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ã€‚</p><p>å‚æ•° <code>mode</code> è¡¨ç¤ºæ–‡ä»¶æ–°çš„æƒé™è®¾ç½®ã€‚è¿™æ˜¯ä¸€ä¸ªæ•´æ•°å€¼ï¼Œé€šå¸¸ä½¿ç”¨å…«è¿›åˆ¶æ•°è¡¨ç¤ºï¼ˆä¾‹å¦‚ï¼š<code>0o755</code>ï¼‰ã€‚ä¸åŒçš„æ•°å­—ä»£è¡¨ä¸åŒçš„æƒé™ï¼š</p><ul><li>ç¬¬ä¸€ä¸ªæ•°å­—ä»£è¡¨æ‰€æœ‰è€…(owner)çš„æƒé™ã€‚</li><li>ç¬¬äºŒä¸ªæ•°å­—ä»£è¡¨æ‰€å±ç»„(group)çš„æˆå‘˜çš„æƒé™ã€‚</li><li>ç¬¬ä¸‰ä¸ªæ•°å­—ä»£è¡¨å…¶ä»–äºº(others)çš„æƒé™ã€‚</li></ul><p>æ¯ä¸€ä¸ªä½ç½®ä¸Šçš„æ•°å­—éƒ½æ˜¯ä»¥ä¸‹æƒé™å€¼çš„å’Œï¼š</p><ul><li>4: å¯è¯»ï¼ˆReadï¼‰</li><li>2: å¯å†™ï¼ˆWriteï¼‰</li><li>1: å¯æ‰§è¡Œï¼ˆExecuteï¼‰</li></ul><p>æ¥ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä½ æƒ³è¦è®¾ç½®ä¸€ä¸ªæ–‡ä»¶ä½¿å¾—ï¼š</p><ul><li>æ‰€æœ‰è€…æ‹¥æœ‰è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ï¼ˆrwx = 4 + 2 + 1 = 7ï¼‰ï¼Œ</li><li>ç»„æˆå‘˜æœ‰è¯»å’Œæ‰§è¡Œæƒé™ï¼ˆrx = 4 + 1 = 5ï¼‰ï¼Œ</li><li>å…¶ä»–äººåªæœ‰è¯»æƒé™ï¼ˆr = 4ï¼‰ã€‚</li></ul><p>é‚£ä¹ˆï¼Œä½ éœ€è¦å°† <code>mode</code> è®¾ç½®ä¸º <code>0o755</code>ã€‚</p><p>å…·ä½“åˆ° <code>filehandle.chmod(mode)</code> æ–¹æ³•ï¼Œå®ƒæ˜¯æ“ä½œä¸€ä¸ªé€šè¿‡ <code>fs.promises.open()</code> æ‰“å¼€çš„æ–‡ä»¶å¥æŸ„ï¼ˆFileHandleï¼‰ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨ <code>filehandle.chmod(mode)</code> çš„æ­¥éª¤ï¼š</p><ol><li>é¦–å…ˆï¼Œä½¿ç”¨ <code>fs.promises.open()</code> æ‰“å¼€æ–‡ä»¶ä»¥è·å–æ–‡ä»¶å¥æŸ„ã€‚</li><li>ç„¶åï¼Œè°ƒç”¨è¯¥æ–‡ä»¶å¥æŸ„çš„ <code>.chmod()</code> æ–¹æ³•æ¥æ›´æ”¹æƒé™ã€‚</li><li>æœ€åï¼Œå…³é—­æ–‡ä»¶å¥æŸ„ã€‚</li></ol><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®é™…çš„ä»£ç ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> changeFilePermissions</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> mode</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // Step 1: æ‰“å¼€æ–‡ä»¶è·å–æ–‡ä»¶å¥æŸ„</span></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // Step 2: æ›´æ”¹æ–‡ä»¶æƒé™</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">chmod</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">mode</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">      `</span><span style="color:#A3BE8C;">Permissions for </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filePath</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> have been changed to </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">mode</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">8</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    )</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // å¦‚æœå‡ºç°é”™è¯¯ï¼Œä¼šè¿›å…¥è¿™é‡Œ</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Error changing permissions: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">err</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // Step 3: å…³é—­æ–‡ä»¶å¥æŸ„</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">filehandle</span><span style="color:#81A1C1;"> !==</span><span style="color:#81A1C1;"> undefined</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">      await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨å‡½æ•°æ¥æ›´æ”¹æŸä¸ªæ–‡ä»¶çš„æƒé™</span></span>
<span class="line"><span style="color:#88C0D0;">changeFilePermissions</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/your/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0o755</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼Œæ–‡ä»¶è·¯å¾„ <code>/path/to/your/file.txt</code> åº”å½“æ›¿æ¢ä¸ºä½ æƒ³è¦æ›´æ”¹æƒé™çš„å®é™…æ–‡ä»¶è·¯å¾„ã€‚ä»¥ä¸Šä»£ç æ‰§è¡Œåï¼Œå¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œè¯¥æ–‡ä»¶çš„æƒé™å°±ä¼šè¢«æ›´æ”¹ä¸º <code>0o755</code>ï¼Œå³æ‰€æœ‰è€…å¯ä»¥è¯»å†™æ‰§è¡Œï¼Œç»„æˆå‘˜å¯ä»¥è¯»æ‰§è¡Œï¼Œå…¶ä»–äººå¯ä»¥è¯»ã€‚</p><h4 id="event-bubbles" tabindex="-1"><a class="header-anchor" href="#event-bubbles"><span><a href="https://nodejs.org/docs/latest/api/events.html#eventbubbles" target="_blank" rel="noopener noreferrer">event.bubbles</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒã€‚å®ƒè®©ä½ å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptï¼Œä»è€Œæ„å»ºå„ç§æœåŠ¡å™¨å’Œå‘½ä»¤è¡Œå·¥å…·ã€‚</p><p>åœ¨ Node.js çš„ <code>events</code> æ¨¡å—ä¸­ï¼Œæœ‰å¾ˆå¤šç”¨äºå¤„ç†äº‹ä»¶çš„åŠŸèƒ½ã€‚äº‹ä»¶æ˜¯ç¼–ç¨‹ä¸­çš„ä¸€ç§æ¨¡å¼ï¼ŒæŸäº›äº‹æƒ…ï¼ˆå¦‚ç”¨æˆ·ç‚¹å‡»æŒ‰é’®ã€æ¥æ”¶ç½‘ç»œè¯·æ±‚ç­‰ï¼‰å‘ç”Ÿæ—¶ï¼Œä¼šè§¦å‘ä»£ç æ‰§è¡Œã€‚åœ¨ Web æµè§ˆå™¨ä¸­ï¼Œæˆ‘ä»¬ç†Ÿæ‚‰â€œå†’æ³¡â€è¿™ä¸ªæ¦‚å¿µï¼Œå³å½“ä¸€ä¸ªå…ƒç´ ä¸Šçš„äº‹ä»¶è¢«è§¦å‘åï¼Œè¿™ä¸ªäº‹ä»¶ä¼šæ²¿ç€ DOM æ ‘å‘ä¸Šä¼ æ’­ã€‚</p><p>ä½†æ˜¯ï¼Œåœ¨ Node.js çš„ <code>events</code> æ¨¡å—æ–‡æ¡£çš„ <code>event.bubbles</code> éƒ¨åˆ†ï¼Œå¹¶æ²¡æœ‰æåˆ° <code>event.bubbles</code> è¿™ä¸ªå±æ€§æˆ–æ–¹æ³•ã€‚è¿™æ˜¯å› ä¸ºï¼Œæˆªè‡³æˆ‘çŸ¥è¯†æ›´æ–°çš„æ—¶é—´ç‚¹ï¼ˆ2023 å¹´ï¼‰ï¼ŒNode.js ä¸­çš„äº‹ä»¶å¹¶ä¸æ”¯æŒåƒæµè§ˆå™¨ DOM äº‹ä»¶é‚£æ ·çš„å†’æ³¡æœºåˆ¶ã€‚</p><p>å¯èƒ½ä½ çœ‹åˆ°çš„ <code>event.bubbles</code> æ˜¯æŸä¸ªç‰¹å®šçš„ç¬¬ä¸‰æ–¹åº“æˆ–è€…æ–°ç‰ˆæœ¬çš„ Node.js æä¾›çš„ç‰¹æ€§ï¼Œä½†åœ¨æ ‡å‡†çš„ Node.js API æ–‡æ¡£ä¸­ï¼Œé€šå¸¸ä¸ä¼šæœ‰è¿™é¡¹åŠŸèƒ½ã€‚</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼ŒNode.js ä¸­çš„äº‹ä»¶æ˜¯é€šè¿‡ <code>EventEmitter</code> ç±»æ¥å¤„ç†çš„ã€‚æ¯ä¸ªèƒ½äº§ç”Ÿäº‹ä»¶çš„å¯¹è±¡éƒ½æ˜¯ <code>EventEmitter</code> çš„å®ä¾‹ã€‚è¿™äº›å¯¹è±¡èƒ½å¤Ÿå‘å°„ï¼ˆemitï¼‰äº‹ä»¶åå­—ï¼Œå¹¶ä¸”ä¼ é€’æ•°æ®ç»™ç›‘å¬è¿™äº›äº‹ä»¶çš„å¤„ç†å‡½æ•°ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªåœ¨ Node.js ä¸­ä½¿ç”¨äº‹ä»¶çš„ç®€å•ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> EventEmitter</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">events</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªç±»ç»§æ‰¿è‡ª EventEmitter</span></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> MyEmitter</span><span style="color:#81A1C1;"> extends</span><span style="color:#8FBCBB;font-weight:bold;"> EventEmitter</span><span style="color:#ECEFF4;"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆå§‹åŒ–å¯¹è±¡</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> myEmitter</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> MyEmitter</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘å¬äº‹ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">myEmitter</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">event</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ä¸€ä¸ªäº‹ä»¶è¢«è§¦å‘äº†ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è§¦å‘äº‹ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">myEmitter</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">emit</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">event</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸º <code>MyEmitter</code> çš„æ–°ç±»ï¼Œè¯¥ç±»ç»§æ‰¿äº† <code>EventEmitter</code> çš„åŠŸèƒ½ã€‚ç„¶åæˆ‘ä»¬åˆ›å»ºäº† <code>myEmitter</code> çš„ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶ç»™å®ƒæ³¨å†Œäº†ä¸€ä¸ªç›‘å¬å™¨ï¼Œç›‘å¬åä¸º &#39;event&#39; çš„äº‹ä»¶ã€‚æœ€åï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨ <code>.emit()</code> æ–¹æ³•è§¦å‘äº† &#39;event&#39; äº‹ä»¶ï¼Œè¿™å¯¼è‡´æˆ‘ä»¬ä¹‹å‰æ³¨å†Œçš„ç›‘å¬å™¨è¢«è°ƒç”¨ï¼Œæ‰“å°å‡ºä¿¡æ¯ &quot;ä¸€ä¸ªäº‹ä»¶è¢«è§¦å‘äº†ï¼&quot;ã€‚</p><p>è®°ä½ï¼ŒNode.js çš„æ ¸å¿ƒç‰¹ç‚¹ä¹‹ä¸€å°±æ˜¯éé˜»å¡ I/Oï¼Œäº‹ä»¶é©±åŠ¨çš„æ¶æ„éå¸¸é€‚åˆå¤„ç†å¤§é‡çš„å¹¶å‘è¿æ¥ï¼Œè¿™ä½¿å¾— Node.js æˆä¸ºæ„å»ºé«˜æ•ˆã€å¯ä¼¸ç¼©çš„ç½‘ç»œåº”ç”¨ç¨‹åºçš„ç†æƒ³é€‰æ‹©ã€‚</p><h4 id="filehandle-chown-uid-gid" tabindex="-1"><a class="header-anchor" href="#filehandle-chown-uid-gid"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandlechownuid-gid" target="_blank" rel="noopener noreferrer">filehandle.chown(uid, gid)</a></span></a></h4><p>å½“ç„¶ï¼Œæˆ‘ä¼šå°½åŠ›è§£é‡Šå¾—é€šä¿—æ˜“æ‡‚ã€‚Node.js æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ ä½¿ç”¨ JavaScript ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚åœ¨è¿™ä¸ªç¯å¢ƒä¸­ï¼Œ<code>filehandle.chown(uid, gid)</code>æ˜¯ä¸€ä¸ªæ¯”è¾ƒä¸“ä¸šçš„åŠŸèƒ½ï¼Œä¸»è¦ç”¨äºæ”¹å˜æ–‡ä»¶çš„æ‰€æœ‰æƒã€‚ä¸ºäº†ç†è§£è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ä¸€ä¸‹å‡ ä¸ªæ¦‚å¿µï¼š</p><ol><li><p><strong>Filehandle</strong>ï¼šåœ¨ Node.js ä¸­ï¼Œå½“ä½ æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œè¯»å†™æ“ä½œæ—¶ï¼Œç³»ç»Ÿä¼šç»™ä½ ä¸€ä¸ªâ€œå¥æŸ„â€ï¼ˆfilehandleï¼‰ï¼Œå¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªé’¥åŒ™ä¸²ï¼Œé€šè¿‡å®ƒå¯ä»¥å¯¹æ–‡ä»¶æ‰§è¡Œå„ç§æ“ä½œã€‚</p></li><li><p><strong>UIDï¼ˆUser Identifierï¼‰</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œä»£è¡¨ Linux æˆ– Unix ç³»ç»Ÿä¸­çš„ç”¨æˆ·ã€‚æ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ UIDã€‚</p></li><li><p><strong>GIDï¼ˆGroup Identifierï¼‰</strong>ï¼šè¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ•°å­—ï¼Œä»£è¡¨ç”¨æˆ·ç»„ã€‚åœ¨ Linux æˆ– Unix ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½å±äºè‡³å°‘ä¸€ä¸ªç»„ã€‚</p></li></ol><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬è°ˆè°ˆ<code>filehandle.chown(uid, gid)</code>çš„å…·ä½“ä½œç”¨ã€‚ç®€å•æ¥è¯´ï¼Œè¿™ä¸ªæ–¹æ³•å…è®¸ä½ æ”¹å˜ä¸€ä¸ªæ–‡ä»¶çš„æ‰€æœ‰è€…å’Œæ‰€å±ç¾¤ç»„ã€‚è¿™é‡Œçš„<code>uid</code>ä»£è¡¨æ–°çš„ç”¨æˆ·æ ‡è¯†ç¬¦ï¼Œè€Œ<code>gid</code>ä»£è¡¨æ–°çš„ç»„æ ‡è¯†ç¬¦ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œè¿™ä¸ªåº”ç”¨ç”Ÿæˆäº†ä¸€äº›æŠ¥å‘Šæ–‡ä»¶ï¼Œä½ å¸Œæœ›è¿™äº›æ–‡ä»¶ä»…èƒ½è¢«ç‰¹å®šçš„ç”¨æˆ·ç»„è®¿é—®ã€‚ä¾‹å¦‚ï¼Œåªæœ‰è´¢åŠ¡éƒ¨é—¨çš„å‘˜å·¥èƒ½å¤Ÿè®¿é—®åˆ°è¿™äº›è´¢åŠ¡æŠ¥å‘Šã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦çŸ¥é“è´¢åŠ¡éƒ¨é—¨ç”¨æˆ·ç»„çš„ GID å’Œéœ€è¦è·å–æ–‡ä»¶æƒé™çš„ç”¨æˆ·çš„ UIDã€‚ç„¶åï¼Œä½ å¯ä»¥ä½¿ç”¨<code>filehandle.chown(uid, gid)</code>æ–¹æ³•æ¥æ”¹å˜æ–‡ä»¶çš„æ‰€æœ‰æƒï¼Œä½¿ä¹‹ç¬¦åˆä½ çš„éœ€æ±‚ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> changeOwnership</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> uid</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> gid</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ‰“å¼€æ–‡ä»¶ä»¥ä¾¿è¯»å†™</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">chown</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">uid</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> gid</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ”¹å˜æ–‡ä»¶çš„æ‰€æœ‰æƒ</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å®Œæˆæ“ä½œåå…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/your/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> financialDeptUid</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 1002</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å‡è®¾è´¢åŠ¡éƒ¨é—¨ç”¨æˆ·çš„UIDæ˜¯1002</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> financialDeptGid</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 2002</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å‡è®¾è´¢åŠ¡éƒ¨é—¨çš„GIDæ˜¯2002</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">changeOwnership</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> financialDeptUid</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> financialDeptGid</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">then</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#D8DEE9;"> console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶æ‰€æœ‰æƒå·²æ›´æ”¹</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">))</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#D8DEE9;"> console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ›´æ”¹æ‰€æœ‰æƒæ—¶å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨<code>fs.open()</code>æ–¹æ³•æ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶è·å¾—äº†ä¸€ä¸ª<code>filehandle</code>ã€‚ç„¶åï¼Œæˆ‘ä»¬è°ƒç”¨<code>filehandle.chown(uid, gid)</code>æ–¹æ³•å°†æ–‡ä»¶çš„æ‰€æœ‰è€…æ›´æ”¹ä¸ºæŒ‡å®šçš„ç”¨æˆ·å’Œç¾¤ç»„ã€‚æœ€åï¼Œæˆ‘ä»¬å…³é—­äº†<code>filehandle</code>ã€‚</p><p>è¯·æ³¨æ„ï¼Œæ”¹å˜æ–‡ä»¶çš„æ‰€æœ‰æƒæ˜¯ä¸€ä¸ªæ•æ„Ÿæ“ä½œï¼Œé€šå¸¸éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½æ‰§è¡Œã€‚æ­¤å¤–ï¼Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œè¿™ä¸ªåŠŸèƒ½å¯èƒ½ä¸æŒ‰é¢„æœŸå·¥ä½œï¼Œå› ä¸º Windows çš„æƒé™ç®¡ç†æœºåˆ¶ä¸ Unix/Linux ä¸åŒã€‚</p><p>å¸Œæœ›è¿™ä¸ªè§£é‡Šå’Œä¾‹å­èƒ½å¸®åŠ©ä½ ç†è§£<code>filehandle.chown(uid, gid)</code>çš„ä½œç”¨ï¼</p><h4 id="filehandle-close" tabindex="-1"><a class="header-anchor" href="#filehandle-close"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandleclose" target="_blank" rel="noopener noreferrer">filehandle.close()</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome çš„ V8 JavaScript å¼•æ“çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒã€‚å®ƒä½¿å¾—å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™åç«¯ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ä¸ªå†…ç½®çš„ <code>fs</code> (æ–‡ä»¶ç³»ç»Ÿ) æ¨¡å—ï¼Œç”¨äºæ‰§è¡Œæ–‡ä»¶æ“ä½œï¼Œæ¯”å¦‚è¯»å–ã€å†™å…¥å’Œä¿®æ”¹æ–‡ä»¶ã€‚</p><p>åœ¨ <code>fs</code> æ¨¡å—ä¸­ï¼Œæœ‰ä¸€éƒ¨åˆ†æ˜¯ä¸“é—¨å¤„ç†æ–‡ä»¶æ“ä½œçš„ Promises APIã€‚è¿™ä¸ª API å…è®¸ä½ ä½¿ç”¨å¼‚æ­¥çš„æ–¹å¼æ¥å¤„ç†æ–‡ä»¶ï¼Œä¸ä¼šé˜»å¡ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ã€‚åœ¨è¿™ä¸ªå¼‚æ­¥æ¨¡å¼ä¸‹ï¼Œå½“ä½ æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œæ“ä½œæ—¶ï¼Œä¼šå¾—åˆ°ä¸€ä¸ª <code>FileHandle</code> å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡ä»£è¡¨äº†ä¸æ‰“å¼€çš„æ–‡ä»¶çš„ä¸€ä¸ªæ´»è·ƒçš„å¼•ç”¨ï¼Œå¯ä»¥ç”¨æ¥è¿›ä¸€æ­¥æ“ä½œè¯¥æ–‡ä»¶ï¼Œæ¯”å¦‚è¯»å–æ•°æ®æˆ–å†™å…¥æ•°æ®ã€‚</p><p><code>filehandle.close()</code> æ–¹æ³•å°±æ˜¯ç”¨æ¥å…³é—­ä¸€ä¸ªå·²ç»æ‰“å¼€çš„æ–‡ä»¶çš„æ–¹æ³•ã€‚å½“ä½ å®Œæˆäº†æ–‡ä»¶æ“ä½œä¹‹åï¼Œåº”è¯¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ¥å…³é—­æ–‡ä»¶ï¼Œé‡Šæ”¾æ“ä½œç³»ç»Ÿèµ„æºã€‚è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª Promiseï¼Œåœ¨æ–‡ä»¶æˆåŠŸå…³é—­æ—¶è§£å†³ã€‚</p><p>ç°åœ¨ä¸¾ä¸€ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js ç¨‹åºï¼Œè¿™ä¸ªç¨‹åºéœ€è¦ä»ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­è¯»å–æ•°æ®ï¼Œç„¶åå…³é—­è¿™ä¸ªæ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å¼•å…¥ &#39;fs&#39; æ¨¡å—çš„ promises æ¥å£</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readAndCloseFile</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> null;</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // æ‰“å¼€æ–‡ä»¶è·å– FileHandle</span></span>
<span class="line"><span style="color:#D8DEE9;">    filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // è¯»å–æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">{</span><span style="color:#88C0D0;"> encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf-8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // è¾“å‡ºæ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // å¦‚æœå‡ºç°é”™è¯¯ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error reading file:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // ä¸ç®¡æ˜¯å¦å‡ºç°é”™è¯¯ï¼Œæœ€åéƒ½å°è¯•å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">filehandle</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">      await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨å‡½æ•°ï¼Œä¼ å…¥è¦è¯»å–çš„æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#88C0D0;">readAndCloseFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>readAndCloseFile</code> çš„å¼‚æ­¥å‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ä½œä¸ºå‚æ•°ã€‚å‡½æ•°å†…éƒ¨é¦–å…ˆå°è¯•ä½¿ç”¨ <code>fs.open()</code> æ–¹æ³•æ‰“å¼€æŒ‡å®šçš„æ–‡ä»¶ï¼Œå¹¶è¿”å›ä¸€ä¸ª <code>FileHandle</code> å¯¹è±¡ã€‚ç„¶åï¼Œä½¿ç”¨ <code>filehandle.readFile()</code> æ–¹æ³•è¯»å–æ–‡ä»¶å†…å®¹ï¼Œå¹¶ä»¥å­—ç¬¦ä¸²å½¢å¼è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚</p><p>ä¸è®ºæ–‡ä»¶æ“ä½œæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼ˆæ¯”å¦‚æ–‡ä»¶ä¸å­˜åœ¨æˆ–æ²¡æœ‰æƒé™ï¼‰ï¼Œæœ€åéƒ½ä¼šæ‰§è¡Œ <code>finally</code> å—é‡Œçš„ä»£ç ã€‚å¦‚æœ <code>filehandle</code> å˜é‡è¢«æˆåŠŸèµ‹å€¼ï¼ˆå³æ–‡ä»¶è¢«æˆåŠŸæ‰“å¼€ï¼‰ï¼Œå°†è°ƒç”¨ <code>filehandle.close()</code> æ–¹æ³•æ¥å…³é—­æ–‡ä»¶ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿æ‰€æœ‰çš„èµ„æºéƒ½è¢«é€‚å½“é‡Šæ”¾ï¼Œé¿å…äº†èµ„æºæ³„æ¼çš„é—®é¢˜ã€‚</p><p>è®°ä½ï¼Œå½“å’Œæ–‡ä»¶æ“ä½œæ‰“äº¤é“çš„æ—¶å€™ï¼Œå§‹ç»ˆç¡®ä¿æ‰“å¼€çš„æ–‡ä»¶è¢«å…³é—­æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„è‰¯å¥½ç¼–ç¨‹ä¹ æƒ¯ã€‚</p><h4 id="filehandle-createreadstream-options" tabindex="-1"><a class="header-anchor" href="#filehandle-createreadstream-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandlecreatereadstreamoptions" target="_blank" rel="noopener noreferrer">filehandle.createReadStream([options])</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªè®© JavaScript è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¹³å°ï¼Œéå¸¸é€‚åˆç”¨æ¥å¼€å‘éœ€è¦å¤„ç†å¤§é‡è¾“å…¥è¾“å‡ºæ“ä½œï¼ˆä¾‹å¦‚æ–‡ä»¶æ“ä½œå’Œç½‘ç»œè¯·æ±‚ï¼‰çš„åº”ç”¨ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>fs</code>æ¨¡å—æ˜¯ç”¨æ¥è¿›è¡Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„ï¼Œæ¯”å¦‚è¯»å†™æ–‡ä»¶ã€åˆ›å»ºç›®å½•ç­‰ã€‚è€Œ<code>filehandle.createReadStream([options])</code>æ–¹æ³•æ˜¯<code>fs</code>æ¨¡å—æä¾›çš„ä¸€ç§æ–¹å¼ï¼Œç”¨äºä»æ–‡ä»¶ä¸­å¼‚æ­¥åœ°è¯»å–æ•°æ®æµã€‚</p><h3 id="ç†è§£-createreadstream" tabindex="-1"><a class="header-anchor" href="#ç†è§£-createreadstream"><span>ç†è§£ <code>createReadStream</code></span></a></h3><p>ç®€å•æ¥è¯´ï¼Œ<code>createReadStream</code> æ–¹æ³•å…è®¸ä½ ä»¥æµçš„å½¢å¼è¯»å–æ–‡ä»¶çš„å†…å®¹ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§å°†æ•´ä¸ªæ–‡ä»¶å†…å®¹åŠ è½½åˆ°å†…å­˜ä¸­ã€‚è¿™å¯¹äºå¤„ç†å¤§å‹æ–‡ä»¶ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå¯ä»¥å‡å°‘å†…å­˜ä½¿ç”¨ï¼Œæé«˜åº”ç”¨æ€§èƒ½ã€‚</p><p>å½“ä½ è°ƒç”¨<code>filehandle.createReadStream()</code>æ—¶ï¼Œå®é™…ä¸Šä½ æ˜¯åˆ›å»ºäº†ä¸€ä¸ªå¯è¯»æµå¯¹è±¡ã€‚ä½ å¯ä»¥ç›‘å¬è¿™ä¸ªæµçš„äº‹ä»¶ï¼Œæ¯”å¦‚ï¼š</p><ul><li><code>data</code>ï¼šå½“æœ‰æ•°æ®å¯è¯»æ—¶è§¦å‘ã€‚</li><li><code>end</code>ï¼šå½“æ²¡æœ‰æ›´å¤šçš„æ•°æ®å¯è¯»æ—¶è§¦å‘ã€‚</li><li><code>error</code>ï¼šå½“åœ¨è¯»å–è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯æ—¶è§¦å‘ã€‚</li></ul><h3 id="é€‰é¡¹-options" tabindex="-1"><a class="header-anchor" href="#é€‰é¡¹-options"><span>é€‰é¡¹ (<code>options</code>)</span></a></h3><p>å½“ä½ åˆ›å»ºä¸€ä¸ªå¯è¯»æµæ—¶ï¼Œå¯ä»¥é€šè¿‡ä¼ é€’ä¸€ä¸ªé€‰é¡¹å¯¹è±¡æ¥å®šåˆ¶å…¶è¡Œä¸ºã€‚è¿™äº›é€‰é¡¹åŒ…æ‹¬ï¼š</p><ul><li><code>encoding</code>ï¼šè®¾ç½®è¯»å–çš„æ•°æ®ç¼–ç ç±»å‹ã€‚</li><li><code>highWaterMark</code>ï¼šæ§åˆ¶å†…éƒ¨ç¼“å†²åŒºæœ€å¤§é•¿åº¦çš„å­—èŠ‚ã€‚</li><li><code>start</code> å’Œ <code>end</code>ï¼šè®¾ç½®è¯»å–æ–‡ä»¶çš„èµ·å§‹ä½ç½®å’Œç»“æŸä½ç½®ï¼Œè¿™æ ·å°±å¯ä»¥è¯»å–æ–‡ä»¶çš„æŒ‡å®šéƒ¨åˆ†ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><h4 id="è¯»å–æ•´ä¸ªæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#è¯»å–æ•´ä¸ªæ–‡ä»¶"><span>è¯»å–æ•´ä¸ªæ–‡ä»¶</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º<code>example.txt</code>çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶ä¸”æƒ³è¦è¯»å–å¹¶æ‰“å°å‡ºå®ƒçš„å†…å®¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readFromFile</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> stream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  stream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">data</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  stream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">end</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶è¯»å–å®Œæˆ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  stream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">error</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶è¯»å–å‡ºé”™</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">readFromFile</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="è¯»å–æ–‡ä»¶çš„æŒ‡å®šéƒ¨åˆ†" tabindex="-1"><a class="header-anchor" href="#è¯»å–æ–‡ä»¶çš„æŒ‡å®šéƒ¨åˆ†"><span>è¯»å–æ–‡ä»¶çš„æŒ‡å®šéƒ¨åˆ†</span></a></h4><p>å¦‚æœä½ åªå¯¹<code>example.txt</code>æ–‡ä»¶çš„ä¸€éƒ¨åˆ†æ„Ÿå…´è¶£ï¼Œæ¯”å¦‚ä»ç¬¬ 10 ä¸ªå­—èŠ‚åˆ°ç¬¬ 20 ä¸ªå­—èŠ‚ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readPartOfFile</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> stream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">{</span><span style="color:#88C0D0;"> start</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 9</span><span style="color:#ECEFF4;">,</span><span style="color:#88C0D0;"> end</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 19</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  stream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">data</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å…¶ä»–äº‹ä»¶ç›‘å¬å™¨...</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">readPartOfFile</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>filehandle.createReadStream([options])</code>æ–¹æ³•æ¥è¯»å–æ–‡ä»¶çš„å…¨éƒ¨æˆ–éƒ¨åˆ†å†…å®¹ã€‚é€šè¿‡æµå¼å¤„ç†ï¼Œå³ä½¿æ˜¯å¤„ç†éå¸¸å¤§çš„æ–‡ä»¶ï¼Œå†…å­˜çš„ä½¿ç”¨ä¹Ÿèƒ½ä¿æŒåœ¨è¾ƒä½çš„æ°´å¹³ã€‚</p><h4 id="filehandle-createwritestream-options" tabindex="-1"><a class="header-anchor" href="#filehandle-createwritestream-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandlecreatewritestreamoptions" target="_blank" rel="noopener noreferrer">filehandle.createWriteStream([options])</a></span></a></h4><p>å½“ç„¶ï¼Œæˆ‘å°†å°½åŠ›ä»¥é€šä¿—æ˜“æ‡‚çš„æ–¹å¼è§£é‡Š <code>filehandle.createWriteStream([options])</code> åœ¨ Node.js v21.7.1 ä¸­çš„ç”¨æ³•å’Œåº”ç”¨åœºæ™¯ã€‚</p><h3 id="åŸºç¡€è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€è§£é‡Š"><span>åŸºç¡€è§£é‡Š</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æä¾›äº†ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„åŠŸèƒ½ã€‚<code>filehandle.createWriteStream([options])</code> æ˜¯ <code>fs/promises</code> API çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå…è®¸ä½ ä¸ºä¸€ä¸ªç‰¹å®šçš„æ–‡ä»¶åˆ›å»ºä¸€ä¸ªå¯å†™æµï¼ˆwrite streamï¼‰ã€‚å¯å†™æµæ˜¯ä¸€ç§ç”¨äºè¿ç»­å†™å…¥æ•°æ®åˆ°æ–‡ä»¶çš„å·¥å…·ï¼Œéå¸¸é€‚åˆå¤„ç†å¤§æ–‡ä»¶æˆ–å®æ—¶æ•°æ®ï¼Œå› ä¸ºä½ ä¸éœ€è¦ä¸€æ¬¡æ€§å°†æ‰€æœ‰æ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­ã€‚</p><h3 id="å‚æ•°è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>filehandle</code>: æ˜¯ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶çš„å¥æŸ„ï¼Œè¿™ä¸ªå¥æŸ„æ˜¯é€šè¿‡è°ƒç”¨ <code>fsPromises.open()</code> è·å¾—çš„ã€‚å®ƒä»£è¡¨äº†ä¸€ä¸ªå·²ç»æ‰“å¼€çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå¥æŸ„å¯¹æ–‡ä»¶è¿›è¡Œæ“ä½œã€‚</li><li><code>[options]</code>: æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…è®¸ä½ å®šåˆ¶å¯å†™æµçš„è¡Œä¸ºã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥è®¾ç½®ç¼–ç ç±»å‹ã€å†³å®šå†™å…¥æ—¶æ˜¯å¦è‡ªåŠ¨å…³é—­æ–‡ä»¶ç­‰ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-1"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p><strong>ä¾‹å­ 1ï¼šå‘æ–‡ä»¶ä¸­è¿½åŠ æ–‡æœ¬</strong></p><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªæ—¥å¿—ç³»ç»Ÿï¼Œæ¯å½“ç”¨æˆ·æ‰§è¡ŒæŸé¡¹æ“ä½œæ—¶ï¼Œä½ æƒ³åœ¨æ—¥å¿—æ–‡ä»¶ä¸­è®°å½•ä¸‹æ¥ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> appendLog</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">message</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æ‰“å¼€æ–‡ä»¶ï¼ˆå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºï¼‰</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">log.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // åˆ›å»ºå¯å†™æµ</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> stream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å†™å…¥æ¶ˆæ¯åˆ°æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">  stream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#81A1C1;">new</span><span style="color:#88C0D0;"> Date</span><span style="color:#ECEFF4;">().</span><span style="color:#88C0D0;">toISOString</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">}</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å…³é—­æµ</span></span>
<span class="line"><span style="color:#D8DEE9;">  stream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å…³é—­æ–‡ä»¶å¥æŸ„</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">appendLog</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç”¨æˆ·ç™»å½•ç³»ç»Ÿã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä¾‹å­ 2ï¼šé€è¡Œå†™å…¥å¤§é‡æ•°æ®åˆ°æ–‡ä»¶</strong></p><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåº”ç”¨éœ€è¦ç”Ÿæˆä¸€ä¸ªåŒ…å«ç™¾ä¸‡æ¡è®°å½•çš„å¤§å‹ CSV æ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> generateLargeCSV</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filename</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æ‰“å¼€æ–‡ä»¶ç”¨äºå†™å…¥</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filename</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // åˆ›å»ºå¯å†™æµ</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> stream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å†™å…¥ CSV å¤´éƒ¨</span></span>
<span class="line"><span style="color:#D8DEE9;">  stream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">id,name,age</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å¾ªç¯éå†æ•°æ®å¹¶é€è¡Œå†™å…¥</span></span>
<span class="line"><span style="color:#81A1C1;">  for</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> item</span><span style="color:#81A1C1;"> of</span><span style="color:#D8DEE9;"> data</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    stream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">item</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">id</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">,</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">item</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">,</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">item</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">age</span><span style="color:#81A1C1;">}</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å…³é—­æµ</span></span>
<span class="line"><span style="color:#D8DEE9;">  stream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å…³é—­æ–‡ä»¶å¥æŸ„</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æ­¤å¤„æœ‰ä¸€ä¸ªå·¨å¤§çš„æ•°æ®æ•°ç»„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> largeData</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#81A1C1;">...</span><span style="color:#88C0D0;">Array</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">1000000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">keys</span><span style="color:#D8DEE9FF;">()]</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">map</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  (</span><span style="color:#D8DEE9;">id</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> &gt;</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    id</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#88C0D0;">    name</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> `</span><span style="color:#A3BE8C;">User</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">id</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#88C0D0;">    age</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9;"> Math</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">floor</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">Math</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">random</span><span style="color:#D8DEE9FF;">() </span><span style="color:#81A1C1;">*</span><span style="color:#B48EAD;"> 100</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">))</span></span>
<span class="line"><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">generateLargeCSV</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">huge_dataset.csv</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> largeData</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç»“è®º" tabindex="-1"><a class="header-anchor" href="#ç»“è®º"><span>ç»“è®º</span></a></h3><p>ä½¿ç”¨ <code>filehandle.createWriteStream([options])</code> å¯ä»¥æœ‰æ•ˆåœ°å¤„ç†æ–‡ä»¶å†™å…¥æ“ä½œï¼Œæ— è®ºæ˜¯è¿½åŠ å°‘é‡æ•°æ®è¿˜æ˜¯ç”Ÿæˆå¤§å‹æ–‡ä»¶ã€‚å®ƒæä¾›äº†çµæ´»çš„æ–¹æ³•æ¥æ§åˆ¶æ•°æ®å¦‚ä½•è¢«å†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œä½¿å¾—ç®¡ç†å¤§é‡æ•°æ®æˆ–å®æ—¶æ•°æ®å˜å¾—ç®€å•é«˜æ•ˆã€‚</p><h4 id="filehandle-datasync" tabindex="-1"><a class="header-anchor" href="#filehandle-datasync"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandledatasync" target="_blank" rel="noopener noreferrer">filehandle.datasync()</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸æ‚¨åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚å…¶ä¸­ï¼Œ<code>filehandle.datasync()</code>æ˜¯ä¸€ä¸ªä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„åŠŸèƒ½ç‚¹ï¼Œå±äº Node.js çš„ File System æ¨¡å—ï¼ˆé€šå¸¸ç®€ç§°ä¸º<code>fs</code>æ¨¡å—ï¼‰ã€‚è¦ç†è§£<code>filehandle.datasync()</code>ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç†è§£ä¸€äº›åŸºç¡€æ¦‚å¿µã€‚</p><h3 id="åŸºç¡€æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æ¦‚å¿µ"><span>åŸºç¡€æ¦‚å¿µ</span></a></h3><ol><li><p><strong>æ–‡ä»¶å¥æŸ„ï¼ˆFile Handleï¼‰</strong>ï¼šå½“ä½ åœ¨ç¨‹åºä¸­æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šåˆ›å»ºä¸€ä¸ªæ‰€è°“çš„â€œæ–‡ä»¶å¥æŸ„â€ã€‚è¿™ä¸ªå¥æŸ„å¯ä»¥è¢«è§†ä¸ºä¸€ä¸ªæŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œé€šè¿‡å®ƒå¯ä»¥è¯»å–ã€å†™å…¥æˆ–ä¿®æ”¹æ–‡ä»¶ã€‚</p></li><li><p><strong>æ•°æ®åŒæ­¥ï¼ˆData Synchronizationï¼‰</strong>ï¼šåœ¨å¤„ç†æ–‡ä»¶æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¯èƒ½ä¼šå°†æ•°æ®ç¼“å­˜åˆ°å†…å­˜ä¸­ï¼Œè€Œä¸æ˜¯ç›´æ¥å†™å…¥ç£ç›˜ã€‚è¿™æ ·åšå¯ä»¥æé«˜æ€§èƒ½ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚æœä¸å°†å†…å­˜ä¸­çš„æ›´æ”¹å³æ—¶æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œåœ¨å‘ç”Ÿæ•…éšœæ—¶å¯èƒ½ä¼šä¸¢å¤±æ•°æ®ã€‚å› æ­¤ï¼Œæ•°æ®åŒæ­¥å˜å¾—éå¸¸é‡è¦ï¼Œå®ƒç¡®ä¿äº†å†…å­˜ä¸­çš„æ›´æ”¹èƒ½è¢«å®‰å…¨åœ°å†™å…¥åˆ°ç£ç›˜ã€‚</p></li></ol><h3 id="filehandle-datasync-1" tabindex="-1"><a class="header-anchor" href="#filehandle-datasync-1"><span><code>filehandle.datasync()</code></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>filehandle.datasync()</code>æ˜¯ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ï¼Œç”¨äºç¡®ä¿ç”±æ–‡ä»¶å¥æŸ„å¼•ç”¨çš„æ–‡ä»¶çš„å†…å­˜ä¸­å·²ä¿®æ”¹çš„æ•°æ®è¢«åŒæ­¥åˆ°ç£ç›˜ä¸Šï¼Œä½†ä¸å½±å“æ–‡ä»¶çš„å…ƒæ•°æ®ï¼ˆå¦‚æœ€åè®¿é—®æ—¶é—´å’Œä¿®æ”¹æ—¶é—´ç­‰ï¼‰ã€‚ç®€å•æ¥è¯´ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ä¸ºäº†ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§ã€‚</p><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>è€ƒè™‘è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™ï¼Œè¯¥ç½‘ç«™å…è®¸ç”¨æˆ·ç¼–è¾‘åœ¨çº¿æ–‡æ¡£ã€‚æ¯å½“ç”¨æˆ·å®Œæˆç¼–è¾‘ï¼Œä½ éƒ½å¸Œæœ›èƒ½å¤Ÿå³æ—¶å°†æ›´æ”¹ä¿å­˜åˆ°æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ä¸­ã€‚è¿™é‡Œå°±å¯ä»¥ä½¿ç”¨<code>filehandle.datasync()</code>æ¥ç¡®ä¿ç”¨æˆ·çš„æ›´æ”¹è¢«å®‰å…¨åœ°åŒæ­¥åˆ°ç£ç›˜ä¸Šã€‚</p><h4 id="ä»£ç ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä»£ç ç¤ºä¾‹"><span>ä»£ç ç¤ºä¾‹</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> saveToFile</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">fileHandle</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // å†™å…¥æ•°æ®åˆ°æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨datasyncç¡®ä¿æ•°æ®å·²ç»åŒæ­¥åˆ°ç£ç›˜</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">datasync</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å‡è®¾&quot;data&quot;åŒ…å«äº†ç”¨æˆ·çš„ç¼–è¾‘å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">ç”¨æˆ·çš„ç¼–è¾‘å†…å®¹...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#88C0D0;"> saveToFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fileHandle</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ•°æ®æˆåŠŸåŒæ­¥åˆ°ç£ç›˜ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // æœ€åè®°å¾—å…³é—­æ–‡ä»¶å¥æŸ„</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‡ºé”™äº†:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">main</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆæ‰“å¼€äº†ä¸€ä¸ªåä¸º<code>example.txt</code>çš„æ–‡ä»¶ï¼Œå¹¶è·å–äº†å…¶æ–‡ä»¶å¥æŸ„ã€‚ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª<code>saveToFile</code>å‡½æ•°ï¼Œç”¨äºå†™å…¥æ•°æ®å¹¶é€šè¿‡<code>filehandle.datasync()</code>ç¡®ä¿è¿™äº›æ•°æ®è¢«åŒæ­¥åˆ°ç£ç›˜ã€‚æœ€åï¼Œæˆ‘ä»¬é€šè¿‡<code>fileHandle.close()</code>å…³é—­æ–‡ä»¶å¥æŸ„ä»¥é‡Šæ”¾èµ„æºã€‚</p><h3 id="å°ç»“" tabindex="-1"><a class="header-anchor" href="#å°ç»“"><span>å°ç»“</span></a></h3><p><code>filehandle.datasync()</code>æ˜¯ Node.js ä¸­ä¸€ä¸ªéå¸¸å®ç”¨çš„æ–¹æ³•ï¼Œç‰¹åˆ«æ˜¯åœ¨é‚£äº›éœ€è¦ç¡®ä¿æ•°æ®å®Œæ•´æ€§å’Œä¸€è‡´æ€§çš„åº”ç”¨ä¸­ã€‚é€šè¿‡å¼‚æ­¥çš„æ–¹å¼å·¥ä½œï¼Œå®ƒæœ‰åŠ©äºæé«˜åº”ç”¨çš„æ€§èƒ½ï¼ŒåŒæ—¶ä¿è¯äº†æ•°æ®çš„å®‰å…¨æ€§ã€‚</p><h4 id="filehandle-fd" tabindex="-1"><a class="header-anchor" href="#filehandle-fd"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandlefd" target="_blank" rel="noopener noreferrer">filehandle.fd</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 JavaScript å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå…è®¸åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œ JavaScript ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ä¸ªéå¸¸æ ¸å¿ƒçš„æ¨¡å—å«åš File Systemï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œå®ƒæä¾› API æ¥ä»¥ç±»ä¼¼ POSIXï¼ˆå¯ç§»æ¤æ“ä½œç³»ç»Ÿæ¥å£ï¼‰çš„æ–¹å¼ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’ã€‚</p><p>åœ¨ Node.js çš„æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ä¸­ï¼Œ<code>filehandle.fd</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå…¶ä¸­ <code>filehandle</code> æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»£è¡¨ç€å¯¹æ–‡ä»¶çš„å¼•ç”¨æˆ–è€…å¥æŸ„(handle)ã€‚è¿™ä¸ªå¥æŸ„å¯ä»¥ç”¨äºè¯»å–ã€å†™å…¥æˆ–å…³é—­æ–‡ä»¶ç­‰æ“ä½œã€‚è€Œ <code>.fd</code> å°±æ˜¯è¿™ä¸ªæ–‡ä»¶å¥æŸ„æ‰€å¯¹åº”çš„åº•å±‚æ–‡ä»¶æè¿°ç¬¦(file descriptor)ã€‚æ–‡ä»¶æè¿°ç¬¦æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ï¼Œå®ƒæ˜¯æ“ä½œç³»ç»Ÿåˆ†é…ç»™æ‰“å¼€çš„æ–‡ä»¶æ‰€ç”¨çš„ç´¢å¼•ï¼Œé€šè¿‡å®ƒå¯ä»¥è¿›è¡Œè¯¸å¦‚è¯»å†™æ–‡ä»¶ä¹‹ç±»çš„æ“ä½œã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-1"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œéœ€è¦ä»ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­è¯»å–æ•°æ®ï¼Œå¤„ç†è¿™äº›æ•°æ®åå†ä¿å­˜åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚ä½¿ç”¨ Node.js çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—çš„å¼‚æ­¥æ“ä½œï¼Œä½ å¯èƒ½ä¼šè¿™æ ·åšï¼š</p><h4 id="_1-æ‰“å¼€æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_1-æ‰“å¼€æ–‡ä»¶"><span>1. æ‰“å¼€æ–‡ä»¶</span></a></h4><p>é¦–å…ˆï¼Œä½ éœ€è¦æ‰“å¼€æ–‡ä»¶ä»¥è·å–æ–‡ä»¶å¥æŸ„ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> openFile</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">log.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²æ‰“å¼€ï¼Œå…¶æ–‡ä»¶æè¿°ç¬¦ä¸ºï¼š</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">fd</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // ä½¿ç”¨ fileHandle è¿›è¡Œå…¶ä»–æ“ä½œï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ‰“å¼€æ–‡ä»¶æ—¶å‡ºé”™ï¼š</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">error</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">openFile</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>fs.open()</code> æ–¹æ³•æ¥æ‰“å¼€åä¸º <code>&#39;log.txt&#39;</code> çš„æ–‡ä»¶ï¼Œå¹¶æŒ‡å®šäº† <code>&#39;r&#39;</code> å‚æ•°è¡¨ç¤ºä»¥è¯»å–æ¨¡å¼æ‰“å¼€ã€‚å¦‚æœæ–‡ä»¶æˆåŠŸæ‰“å¼€ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>fileHandle.fd</code> è·å¾—è¯¥æ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ã€‚</p><h4 id="_2-ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦" tabindex="-1"><a class="header-anchor" href="#_2-ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦"><span>2. ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦</span></a></h4><p>è·å–åˆ°æ–‡ä»¶æè¿°ç¬¦åï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥è¿›è¡Œæ›´åº•å±‚çš„æ–‡ä»¶æ“ä½œã€‚ä¸è¿‡ï¼Œåœ¨ Node.js ä¸­é€šå¸¸ä¸ç›´æ¥ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦è¿›è¡Œæ“ä½œï¼Œå› ä¸º Node.js æä¾›äº†æ›´é«˜çº§çš„ã€æ›´æ˜“äºä½¿ç”¨çš„ APIï¼Œä¾‹å¦‚ä¸Šé¢ç¤ºä¾‹ä¸­çš„ <code>fs.open()</code>ã€‚ä½†çŸ¥é“ <code>.fd</code> å±æ€§å­˜åœ¨å’Œå®ƒä»£è¡¨ä»€ä¹ˆåœ¨æŸäº›æƒ…å†µä¸‹æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ï¼Œå°¤å…¶æ˜¯å½“ä½ éœ€è¦ä¸ Node.js çš„åº•å±‚ç³»ç»Ÿäº¤äº’æˆ–è€…è°ƒè¯•é—®é¢˜çš„æ—¶å€™ã€‚</p><h4 id="_3-å…³é—­æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_3-å…³é—­æ–‡ä»¶"><span>3. å…³é—­æ–‡ä»¶</span></a></h4><p>æ“ä½œå®Œæˆåï¼Œåˆ«å¿˜äº†å…³é—­æ–‡ä»¶ï¼Œé‡Šæ”¾èµ„æºã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> closeFile</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">fileHandle</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²å…³é—­</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">å…³é—­æ–‡ä»¶æ—¶å‡ºé”™ï¼š</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">error</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æˆ‘ä»¬å·²ç»æœ‰äº† fileHandle</span></span>
<span class="line"><span style="color:#616E88;">// closeFile(fileHandle);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬å‡è®¾å·²ç»é€šè¿‡ä¹‹å‰çš„æ–¹æ³•è·å–äº† <code>fileHandle</code>ï¼Œç„¶åä½¿ç”¨ <code>fileHandle.close()</code> æ¥å…³é—­æ–‡ä»¶ã€‚è¿™æ˜¯ç¡®ä¿ä½ çš„ Node.js åº”ç”¨ç®¡ç†èµ„æºå¾—å½“ï¼Œé¿å…èµ„æºæ³„æ¼ã€‚</p><p>æ€»è€Œè¨€ä¹‹ï¼Œ<code>filehandle.fd</code> åœ¨ Node.js çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œä¸­æ‰®æ¼”ç€è¿æ¥ä½ çš„ä»£ç å’Œæ“ä½œç³»ç»Ÿåº•å±‚æ–‡ä»¶ç³»ç»Ÿçš„æ¡¥æ¢è§’è‰²ã€‚è™½ç„¶åœ¨æ—¥å¸¸ä½¿ç”¨ä¸­ï¼Œä½ å¯èƒ½ä¸ä¼šç›´æ¥ä¸æ–‡ä»¶æè¿°ç¬¦æ‰“äº¤é“ï¼Œä½†äº†è§£å®ƒçš„å­˜åœ¨ä»¥åŠå¦‚ä½•é€šè¿‡æ–‡ä»¶å¥æŸ„ä¸ä¹‹äº¤äº’ï¼Œå¯¹äºç†è§£ Node.js å¦‚ä½•å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ˜¯éå¸¸æœ‰ç”¨çš„ã€‚</p><h4 id="filehandle-read-buffer-offset-length-position" tabindex="-1"><a class="header-anchor" href="#filehandle-read-buffer-offset-length-position"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandlereadbuffer-offset-length-position" target="_blank" rel="noopener noreferrer">filehandle.read(buffer, offset, length, position)</a></span></a></h4><p>ç†è§£ <code>filehandle.read(buffer, offset, length, position)</code> è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆææ¸…æ¥šå®ƒæ‰€å±çš„ä¸Šä¸‹æ–‡â€”â€”Node.js ä¸­çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰ï¼Œä»¥åŠå®ƒæ“ä½œæ–‡ä»¶çš„ä¸€äº›åŸºæœ¬æ¦‚å¿µã€‚</p><h3 id="æ–‡ä»¶ç³»ç»Ÿ-file-system" tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶ç³»ç»Ÿ-file-system"><span>æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œæ–‡ä»¶ç³»ç»Ÿæ¨¡å—å…è®¸ä½ ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚æ— è®ºæ˜¯è¯»å–æ–‡ä»¶ã€å†™å…¥æ–‡ä»¶ã€è¿˜æ˜¯æ›´å¤æ‚çš„æ–‡ä»¶æ“ä½œï¼ŒNode.js éƒ½æä¾›äº†ç›¸åº”çš„ API æ¥æ”¯æŒè¿™äº›æ“ä½œã€‚è¿™äº›æ“ä½œå¯ä»¥æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¼‚æ­¥çš„ã€‚<code>filehandle.read</code> æ–¹æ³•å°±æ˜¯å…¶ä¸­çš„ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ï¼Œä¸“é—¨ç”¨äºä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®ã€‚</p><h3 id="buffer" tabindex="-1"><a class="header-anchor" href="#buffer"><span>Buffer</span></a></h3><p>åœ¨æ·±å…¥ <code>filehandle.read</code> æ–¹æ³•ä¹‹å‰ï¼Œæœ‰ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µéœ€è¦äº†è§£â€”â€”<code>Buffer</code>ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code> ç±»æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨äºç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚å½“ä½ è¯»å–æ–‡ä»¶å†…å®¹æ—¶ï¼Œä½ å®é™…ä¸Šæ˜¯åœ¨å°†æ–‡ä»¶çš„å†…å®¹è¯»å…¥åˆ° Buffer ä¸­ï¼Œç„¶åå†è¿›è¡Œç›¸åº”çš„å¤„ç†æˆ–è§£æã€‚</p><h3 id="ç°åœ¨æ¥çœ‹-filehandle-read-buffer-offset-length-position" tabindex="-1"><a class="header-anchor" href="#ç°åœ¨æ¥çœ‹-filehandle-read-buffer-offset-length-position"><span>ç°åœ¨æ¥çœ‹ <code>filehandle.read(buffer, offset, length, position)</code></span></a></h3><p>è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¥ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®çš„ã€‚å…¶å‚æ•°å«ä¹‰å¦‚ä¸‹ï¼š</p><ol><li><strong>buffer</strong>ï¼šä¸€ä¸ª Buffer æˆ– Uint8Arrayï¼Œç”¨äºå°†æ–‡ä»¶è¯»å–çš„æ•°æ®å­˜å…¥ã€‚</li><li><strong>offset</strong>ï¼šæ˜¯ buffer çš„åç§»é‡ï¼Œå‘Šè¯‰å‡½æ•°ä» buffer çš„å“ªé‡Œå¼€å§‹å¡«å……æ•°æ®ã€‚</li><li><strong>length</strong>ï¼šæ˜¯ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šè¦è¯»å–çš„å­—èŠ‚æ•°ã€‚</li><li><strong>position</strong>ï¼šæŒ‡å®šä»æ–‡ä»¶ä¸­çš„å“ªä¸ªä½ç½®å¼€å§‹è¯»å–æ•°æ®ã€‚å¦‚æœ <code>position</code> ä¸º <code>null</code>ï¼Œæ•°æ®å°†ä¼šä»å½“å‰æ–‡ä»¶æŒ‡é’ˆçš„ä½ç½®å¼€å§‹è¯»å–ã€‚</li></ol><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º &quot;example.txt&quot; çš„æ–‡ä»¶ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>Hello Node.js!</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æˆ‘ä»¬æƒ³è¦è¯»å–æ–‡ä»¶ä¸­çš„ &quot;Node.js&quot; éƒ¨åˆ†ã€‚é¦–å…ˆï¼Œç¡®ä¿ä½ å·²ç»é€šè¿‡ <code>fsPromises.open</code> æ‰“å¼€äº†è¯¥æ–‡ä»¶å¹¶è·å¾—äº† <code>filehandle</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readFileSegment</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">    fileHandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">7</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º7çš„bufferã€‚</span></span>
<span class="line"><span style="color:#616E88;">    // ä»æ–‡ä»¶çš„ç¬¬6ä¸ªå­—èŠ‚ä½ç½®å¼€å§‹è¯»å–7ä¸ªå­—èŠ‚çš„æ•°æ®</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 7</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 6</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å°†bufferè½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå¹¶æ‰“å°</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">fileHandle</span><span style="color:#81A1C1;"> !==</span><span style="color:#81A1C1;"> undefined</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åˆ«å¿˜äº†å…³é—­æ–‡ä»¶ï¼</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">readFileSegment</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šä»£ç æ®µå®ç°äº†ä»€ä¹ˆå‘¢ï¼Ÿå®ƒæ‰“å¼€äº† &quot;example.txt&quot; æ–‡ä»¶ï¼Œç„¶åå‡†å¤‡ä»æ–‡ä»¶çš„ç¬¬ 6 ä¸ªå­—èŠ‚ä½ç½®ï¼ˆæ³¨æ„ï¼Œè®¡æ•°æ˜¯ä» 0 å¼€å§‹çš„ï¼‰è¯»å– 7 ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œå³ &quot;Node.js&quot;ï¼Œå¹¶å°†è¿™éƒ¨åˆ†å†…å®¹è¯»å…¥åˆ°æˆ‘ä»¬åˆ›å»ºçš„ buffer ä¸­ã€‚æœ€åï¼Œæˆ‘ä»¬å°† buffer çš„å†…å®¹è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå¹¶æ‰“å°å‡ºæ¥ï¼Œè¾“å‡ºåº”è¯¥æ˜¯ &quot;Node.js&quot;ã€‚</p><p>è¿™å°±æ˜¯ <code>filehandle.read(buffer, offset, length, position)</code> æ–¹æ³•çš„åŸºæœ¬ç”¨æ³•ï¼Œå¯ä»¥å¸®åŠ©ä½ ä»æ–‡ä»¶ä¸­è¯»å–ç‰¹å®šçš„æ•°æ®æ®µã€‚</p><h4 id="filehandle-read-options" tabindex="-1"><a class="header-anchor" href="#filehandle-read-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandlereadoptions" target="_blank" rel="noopener noreferrer">filehandle.read([options])</a></span></a></h4><p>äº†è§£ <code>filehandle.read([options])</code> æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦çŸ¥é“ Node.js ä¸­çš„ <code>FileHandle</code> å¯¹è±¡æ˜¯ä»€ä¹ˆã€‚ç®€å•æ¥è¯´ï¼Œå½“ä½ åœ¨ Node.js ä¸­æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ª <code>FileHandle</code> å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡æä¾›äº†å¾ˆå¤šæ–¹æ³•æ¥æ“ä½œè¿™ä¸ªæ–‡ä»¶ï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶å†…å®¹ã€å†™å…¥æ•°æ®ã€å…³é—­æ–‡ä»¶ç­‰ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ·±å…¥åˆ° <code>filehandle.read([options])</code> æ–¹æ³•ä¸­ã€‚è¿™ä¸ªæ–¹æ³•ç”¨äºå¼‚æ­¥åœ°ï¼ˆéé˜»å¡åœ°ï¼‰ä»ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶ä¸­è¯»å–æ•°æ®ã€‚</p><h3 id="å‚æ•°" tabindex="-1"><a class="header-anchor" href="#å‚æ•°"><span>å‚æ•°</span></a></h3><ul><li><code>options</code>ï¼ˆå¯é€‰ï¼‰: è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥å®šåˆ¶è¯»å–æ“ä½œçš„ä¸€äº›ç»†èŠ‚ã€‚å®ƒåŒ…å«ä»¥ä¸‹å‡ ä¸ªå¯é€‰é”®å€¼ï¼š <ul><li><code>buffer</code>ï¼šä¸€ä¸ª <code>Buffer</code> æˆ–è€… <code>TypedArray</code>ï¼Œç”¨äºå°†è¯»å–çš„æ•°æ®æ”¾å…¥ã€‚å¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Buffer</code>ã€‚</li><li><code>offset</code>ï¼šä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºåœ¨ <code>buffer</code> é‡Œå¼€å§‹å¡«å……æ•°æ®çš„èµ·å§‹ä½ç½®ã€‚é»˜è®¤å€¼ä¸º <code>0</code>ã€‚</li><li><code>length</code>ï¼šä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºè¦ä»æ–‡ä»¶ä¸­è¯»å–çš„å­—èŠ‚æ•°ã€‚é»˜è®¤å€¼ä¸º <code>buffer.length - offset</code>ã€‚</li><li><code>position</code>ï¼šä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºä»æ–‡ä»¶çš„å“ªä¸ªä½ç½®å¼€å§‹è¯»å–æ•°æ®ã€‚å¦‚æœè®¾ä¸º <code>null</code>ï¼Œåˆ™ä»å½“å‰æ–‡ä»¶æŒ‡é’ˆçš„ä½ç½®å¼€å§‹è¯»å–ã€‚å¦åˆ™ï¼Œæ–‡ä»¶æŒ‡é’ˆä¼šç§»åŠ¨åˆ°æŒ‡å®šçš„ä½ç½®ã€‚</li></ul></li></ul><h3 id="è¿”å›å€¼" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼"><span>è¿”å›å€¼</span></a></h3><p>è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª <code>Promise</code> å¯¹è±¡ã€‚è¿™ä¸ª <code>Promise</code> è¢«è§£ææ—¶ï¼Œä¼šå¸¦æœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«ä¸¤ä¸ªå±æ€§ï¼š</p><ul><li><code>bytesRead</code>ï¼šä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºå®é™…è¯»å–åˆ°çš„å­—èŠ‚æ•°ã€‚</li><li><code>buffer</code>ï¼šä¸€ä¸ª <code>Buffer</code> æˆ– <code>TypedArray</code>ï¼Œå®ƒåŒ…å«äº†ä»æ–‡ä»¶ä¸­è¯»å–çš„æ•°æ®ã€‚</li></ul><h3 id="å®ä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-1"><span>å®ä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ <code>example.txt</code>ï¼Œé‡Œé¢çš„å†…å®¹æ˜¯ &quot;Hello, Node.js!&quot;ï¼Œæˆ‘ä»¬æƒ³è¦è¯»å–è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼š</p><ol><li><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ Node.js çš„ <code>fs.promises.open()</code> æ–¹æ³•æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œä»¥è·å¾—ä¸€ä¸ª <code>FileHandle</code> å¯¹è±¡ã€‚</p></li><li><p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨è¿™ä¸ª <code>FileHandle</code> å¯¹è±¡ä¸Šçš„ <code>read()</code> æ–¹æ³•æ¥è¯»å–æ–‡ä»¶å†…å®¹ã€‚</p></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readFileContent</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">    fileHandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">1024</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åˆ›å»ºä¸€ä¸ªè¶³å¤Ÿå¤§çš„ç¼“å†²åŒº</span></span>
<span class="line"><span style="color:#616E88;">    // ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> buffer</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">{</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ˜¾ç¤ºè¯»å–åˆ°çš„å†…å®¹</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error reading the file:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">fileHandle</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">      await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æœ€åï¼Œåˆ«å¿˜äº†å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">readFileContent</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è°ƒç”¨å‡½æ•°</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æ­¤ä»£ç ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆæ‰“å¼€æ–‡ä»¶ <code>example.txt</code>ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªå¤§å°ä¸º 1024 å­—èŠ‚çš„ <code>Buffer</code> æ¥å­˜å‚¨è¯»å–åˆ°çš„æ•°æ®ã€‚é€šè¿‡è°ƒç”¨ <code>fileHandle.read()</code> æ–¹æ³•å¹¶ä¼ é€’è¿™ä¸ª <code>Buffer</code>ï¼Œæˆ‘ä»¬ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®ã€‚æœ€åï¼Œæˆ‘ä»¬æŠŠè¯»å–åˆ°çš„æ•°æ®ï¼ˆå­˜åœ¨ <code>data</code> ä¸­ï¼‰è½¬æ¢æˆ UTF-8 æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå¹¶æ‰“å°å‡ºæ¥ã€‚ä¸è¦å¿˜äº†åœ¨æ“ä½œå®Œæˆåå…³é—­æ–‡ä»¶ï¼Œä»¥é‡Šæ”¾ç³»ç»Ÿèµ„æºã€‚</p><h4 id="filehandle-read-buffer-options" tabindex="-1"><a class="header-anchor" href="#filehandle-read-buffer-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandlereadbuffer-options" target="_blank" rel="noopener noreferrer">filehandle.read(buffer[, options])</a></span></a></h4><p>åœ¨ Node.js ä¸­ï¼Œ<code>filehandle.read(buffer[, options])</code> æ˜¯ä¸€ä¸ªç”¨äºä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®çš„æ–¹æ³•ã€‚ä¸ºäº†è®©è¿™ä¸ªè§£é‡Šæ›´å®¹æ˜“ç†è§£ï¼Œæˆ‘ä»¬å°†é€šè¿‡æ­¥éª¤å’Œä¾‹å­æ¥è¯¦ç»†ä»‹ç»å®ƒã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><ol><li><p><strong>FileHandle</strong>: å½“ä½ åœ¨ Node.js ä¸­æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼ˆæ¯”å¦‚ä½¿ç”¨ <code>fsPromises.open()</code> æ–¹æ³•ï¼‰ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ª <code>FileHandle</code> å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡æä¾›äº†å¤šç§ä¸æ–‡ä»¶äº¤äº’çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬è¯»å–ã€å†™å…¥ç­‰ã€‚</p></li><li><p><strong>Buffer</strong>: åœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code> æ˜¯ä¸€ç§ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„æ–¹å¼ã€‚ç®€å•åœ°è¯´ï¼Œå®ƒå°±åƒæ˜¯ä¸€ä¸ªä¸´æ—¶å­˜æ”¾æ–‡ä»¶æ•°æ®çš„å®¹å™¨ï¼Œå¯ä»¥è®©ä½ æ“ä½œè¿™äº›æ•°æ®ï¼Œä¾‹å¦‚è¯»å–æˆ–ä¿®æ”¹æ–‡ä»¶å†…å®¹ã€‚</p></li><li><p><strong>Options</strong>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…è®¸ä½ è‡ªå®šä¹‰è¯»å–æ“ä½œçš„å…·ä½“è¡Œä¸ºï¼Œæ¯”å¦‚ä»æ–‡ä»¶çš„å“ªä¸ªéƒ¨åˆ†å¼€å§‹è¯»å–æ•°æ®ï¼Œä»¥åŠä¸€æ¬¡è¦è¯»å–å¤šå°‘å­—èŠ‚çš„æ•°æ®ã€‚</p></li></ol><h3 id="filehandle-read-buffer-options-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#filehandle-read-buffer-options-æ–¹æ³•"><span><code>filehandle.read(buffer[, options])</code> æ–¹æ³•</span></a></h3><p>å½“ä½ è°ƒç”¨ <code>filehandle.read(buffer, options)</code> æ–¹æ³•æ—¶ï¼Œä½ æ­£åœ¨å‘Šè¯‰ Node.jsï¼š<em>â€œè¯·ä»è¿™ä¸ªæ–‡ä»¶ä¸­è¯»å–æ•°æ®ï¼Œç„¶åå°†è¿™äº›æ•°æ®æ”¾å…¥æˆ‘æä¾›çš„ buffer ä¸­ã€‚â€</em></p><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><strong>buffer</strong>ï¼šè¿™æ˜¯ä½ å‡†å¤‡å¥½æ¥æ”¶æ•°æ®çš„ Buffer å®ä¾‹ã€‚ä½ éœ€è¦é¢„å…ˆåˆ›å»ºå®ƒï¼Œå¹¶å†³å®šå…¶å¤§å°ã€‚</li><li><strong>options</strong>ï¼ˆå¯é€‰ï¼‰ï¼š <ul><li><code>position</code>ï¼šæŒ‡å®šä»æ–‡ä»¶ä¸­å“ªä¸ªä½ç½®å¼€å§‹è¯»å–æ•°æ®ã€‚å¦‚æœè®¾ç½®ä¸º <code>null</code>ï¼Œå°†ä»å½“å‰æ–‡ä»¶è¯»å–ä½ç½®å¼€å§‹è¯»å–ã€‚</li><li><code>length</code>ï¼šæŒ‡å®šè¦è¯»å–çš„å­—èŠ‚æ•°ã€‚</li><li><code>offset</code>ï¼šæŒ‡å®šä» buffer çš„ä»€ä¹ˆä½ç½®å¼€å§‹å¡«å……æ•°æ®ã€‚</li></ul></li></ul><h3 id="ä½¿ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­"><span>ä½¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬æƒ³è¯»å–æ–‡ä»¶çš„å‰ 10 ä¸ªå­—èŠ‚çš„æ•°æ®ã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦å¼•å…¥å¿…è¦çš„æ¨¡å—å¹¶æ‰“å¼€æ–‡ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readFile</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æ‰“å¼€æ–‡ä»¶è·å– FileHandle</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // åˆ›å»ºä¸€ä¸ªè¶³å¤Ÿå¤§çš„ Buffer æ¥å­˜å‚¨å³å°†è¯»å–çš„æ•°æ®</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">10</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åˆ†é…ä¸€ä¸ªé•¿åº¦ä¸º10å­—èŠ‚çš„ Buffer</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // ä½¿ç”¨ filehandle.read è¯»å–æ•°æ®</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> buffer</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9;"> readBuffer</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#88C0D0;">      buffer</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#88C0D0;">      length</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 10</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#88C0D0;">      position</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#616E88;"> // ä»æ–‡ä»¶çš„å¼€å¤´å¼€å§‹</span></span>
<span class="line"><span style="color:#88C0D0;">      offset</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // è¾“å‡ºè¯»å–çš„æ•°æ®</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">readBuffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">()</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡ <code>fs.open</code> æ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶å¹¶è·å¾—äº†ä¸€ä¸ª <code>FileHandle</code>ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª 10 å­—èŠ‚å¤§å°çš„ <code>Buffer</code> æ¥æ¥æ”¶ä»æ–‡ä»¶ä¸­è¯»å–çš„æ•°æ®ã€‚æ¥ç€ï¼Œæˆ‘ä»¬è°ƒç”¨äº† <code>filehandle.read()</code> æ–¹æ³•ä»¥ä»æ–‡ä»¶çš„å¼€å§‹ä½ç½®è¯»å– 10 å­—èŠ‚çš„æ•°æ®ã€‚æœ€åï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨ <code>filehandle.close()</code> æ¥å…³é—­æ–‡ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å®è·µï¼Œä»¥é¿å…èµ„æºæ³„æ¼ã€‚</p><p>è¿™å°±æ˜¯ <code>filehandle.read(buffer[, options])</code> æ–¹æ³•çš„åŸºæœ¬ç”¨æ³•ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥çµæ´»åœ°è¯»å–æ–‡ä»¶ä¸­çš„ä»»ä½•éƒ¨åˆ†ï¼Œæ ¹æ®éœ€è¦å¤„ç†æ•°æ®ã€‚</p><h4 id="filehandle-readablewebstream-options" tabindex="-1"><a class="header-anchor" href="#filehandle-readablewebstream-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandlereadablewebstreamoptions" target="_blank" rel="noopener noreferrer">filehandle.readableWebStream([options])</a></span></a></h4><p>å½“ç„¶ï¼Œè®©æˆ‘ä»¬æ¥è¯¦ç»†æ¢è®¨ä¸€ä¸‹ Node.js ä¸­çš„ <code>filehandle.readableWebStream([options])</code> è¿™ä¸ªæ–¹æ³•ã€‚</p><p>é¦–å…ˆï¼Œäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ <code>FileHandle</code>ã€‚åœ¨ Node.js ä¸­ï¼Œå½“ä½ æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™æ“ä½œæ—¶ï¼Œç³»ç»Ÿä¼šè¿”å›ä¸€ä¸ª <code>FileHandle</code> å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡æä¾›äº†å¾ˆå¤šç”¨äºæ–‡ä»¶æ“ä½œçš„æ–¹æ³•ï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶ã€å†™å…¥æ•°æ®ã€å…³é—­æ–‡ä»¶ç­‰ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬ä¸“æ³¨äº <code>readableWebStream</code> æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ Node.js ç‰ˆæœ¬ 15.0.0 ä¸­å¼•å…¥çš„ï¼Œä¸ºäº†ä¸ Web Streams API å…¼å®¹ã€‚Web Streams æ˜¯ä¸€ç§å¤„ç†æµå¼æ•°æ®çš„æ ‡å‡† APIï¼Œå¯ä»¥ä»¥æ›´åŠ é«˜æ•ˆå’Œä¼˜é›…çš„æ–¹å¼å¤„ç†å¤§é‡æ•°æ®ï¼Œä¾‹å¦‚ä»æ–‡ä»¶ä¸­è¯»å–æˆ–è€…å‘ç½‘ç»œå‘é€æ•°æ®ã€‚</p><p>æ–¹æ³• <code>filehandle.readableWebStream([options])</code> çš„ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ªå¯è¯»çš„ Web æµï¼ˆReadable Streamï¼‰ï¼Œä½¿å¾—ä½ èƒ½å¤Ÿä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®ï¼Œå¹¶å°†å®ƒä»¬ä»¥æµçš„å½¢å¼å¤„ç†ã€‚å®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªç¬¦åˆ Web Streams API è§„èŒƒçš„ <code>ReadableStream</code> å¯¹è±¡ã€‚</p><p>ä¸‹é¢æ˜¯ <code>readableWebStream</code> æ–¹æ³•çš„åŸºæœ¬ç”¨æ³•ï¼š</p><ol><li>é¦–å…ˆï¼Œä½ éœ€è¦ä½¿ç”¨ <code>fsPromises.open()</code> æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶è·å¾— <code>FileHandle</code>ã€‚</li><li>ç„¶åï¼Œè°ƒç”¨ <code>filehandle.readableWebStream([options])</code> æ¥å¾—åˆ°ä¸€ä¸ª Web Streamã€‚</li></ol><p>è®©æˆ‘ä»¬ä¸¾ä¸€ä¸ªå®é™…çš„ä¾‹å­æ¥è¯´æ˜è¿™æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readFromFile</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æ‰“å¼€æ–‡ä»¶è·å– FileHandle</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // ä½¿ç”¨ readableWebStream æ–¹æ³•åˆ›å»ºå¯è¯»çš„ Web æµ</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> readableWebStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readableWebStream</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // ä½¿ç”¨è¿™ä¸ªæµå»å¤„ç†æ•°æ®</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> reader</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> readableWebStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getReader</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    let</span><span style="color:#D8DEE9;"> result</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    while</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">true</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">      // è¯»å–æ•°æ®å—</span></span>
<span class="line"><span style="color:#81A1C1;">      const</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> done</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> value</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> reader</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">done</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">break;</span><span style="color:#616E88;"> // å¦‚æœå·²å®Œæˆï¼Œåˆ™é€€å‡ºå¾ªç¯</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">      // åšä¸€äº›å¤„ç†ï¼Œä¾‹å¦‚ç´¯è®¡æ•°æ®æˆ–è¾“å‡º</span></span>
<span class="line"><span style="color:#D8DEE9;">      result</span><span style="color:#81A1C1;"> +=</span><span style="color:#D8DEE9;"> value</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">result</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡ºæ•´ä¸ªæ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // å®Œæˆåå…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡å®šæœ‰ä¸€ä¸ªå«åš &#39;example.txt&#39; çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#88C0D0;">readFromFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼š</p><ul><li>æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° <code>readFromFile</code>ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ã€‚</li><li>ä½¿ç”¨ <code>fs.open</code> æ‰“å¼€æ–‡ä»¶ï¼Œè¿™ä¼šè¿”å›ä¸€ä¸ª <code>FileHandle</code>ã€‚</li><li>æ¥ç€è°ƒç”¨ <code>filehandle.readableWebStream()</code> ä»¥è·å–ä¸€ä¸ªå¯è¯»çš„ Web æµã€‚</li><li>ç„¶åæˆ‘ä»¬é€šè¿‡ <code>getReader()</code> æ–¹æ³•è·å–ä¸€ä¸ª readerï¼Œç”¨æ¥ä»æµä¸­æŒ‰å—ï¼ˆchunksï¼‰è¯»å–æ•°æ®ã€‚</li><li>åœ¨ä¸€ä¸ªå¾ªç¯ä¸­ï¼Œæˆ‘ä»¬è¿ç»­è°ƒç”¨ <code>reader.read()</code> ç›´åˆ°æ–‡ä»¶ç»“æŸï¼ˆå³ <code>done</code> ä¸º <code>true</code>ï¼‰ã€‚</li><li>æˆ‘ä»¬å°†è¯»å–çš„æ¯ä¸ªæ•°æ®å—ç´¯åŠ åˆ° <code>result</code> å˜é‡ä¸­ã€‚</li><li>æœ€åï¼Œå½“æˆ‘ä»¬è¯»å–å®Œæ‰€æœ‰æ•°æ®åï¼Œæˆ‘ä»¬è¾“å‡ºç»“æœå¹¶ç¡®ä¿ä½¿ç”¨ <code>fileHandle.close()</code> å…³é—­æ–‡ä»¶ã€‚</li></ul><p><code>[options]</code> å‚æ•°å…è®¸ä½ æŒ‡å®šä¸€äº›é¢å¤–çš„é…ç½®ï¼Œæ¯”å¦‚æµçš„é«˜æ°´ä½çº¿ï¼ˆhigh water markï¼‰ï¼Œæ¥æ§åˆ¶å†…å­˜ä¸­å¯ä»¥ç¼“å†²å¤šå°‘æ•°æ®ã€‚å¦‚æœä½ ä¸ä¼ é€’ä»»ä½•é€‰é¡¹ï¼Œé»˜è®¤çš„é…ç½®å°†ä¼šè¢«ä½¿ç”¨ã€‚</p><p>é€šè¿‡ä»¥ä¸Šçš„è§£é‡Šå’Œç¤ºä¾‹ï¼Œå¸Œæœ›ä½ å¯¹ <code>filehandle.readableWebStream([options])</code> æœ‰äº†æ¸…æ™°çš„ç†è§£ã€‚è¿™ä¸ªæ–¹æ³•èƒ½å¤Ÿè®©ä½ æ–¹ä¾¿åœ°å°† Node.js ä¸­çš„æ–‡ä»¶æ“ä½œä¸ Web Streams API ç»“åˆèµ·æ¥ï¼Œè¿›è¡Œé«˜æ•ˆçš„æ•°æ®æµå¤„ç†ã€‚</p><h4 id="filehandle-readfile-options" tabindex="-1"><a class="header-anchor" href="#filehandle-readfile-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandlereadfileoptions" target="_blank" rel="noopener noreferrer">filehandle.readFile(options)</a></span></a></h4><p><code>filehandle.readFile(options)</code> æ˜¯ Node.js ä¸­ä¸€ä¸ªç”¨äºè¯»å–æ–‡ä»¶å†…å®¹çš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å±äº <code>fs.promises</code> APIï¼Œå³æ–‡ä»¶ç³»ç»Ÿçš„ Promise ç‰ˆæœ¬ã€‚åœ¨ Node.js ä¸­ï¼Œå¯ä»¥ä½¿ç”¨å›è°ƒå‡½æ•°ã€åŒæ­¥æ–¹æ³•ã€æˆ–è€…æ˜¯åŸºäº Promise çš„å¼‚æ­¥æ–¹æ³•æ¥æ“ä½œæ–‡ä»¶ã€‚è€Œ <code>filehandle.readFile(options)</code> å°±æ˜¯åè€…çš„ä¸€ç§ï¼Œå®ƒè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œä¸€æ—¦æ–‡ä»¶è¯»å–å®Œæˆå°±ä¼šè§£å†³ï¼ˆfulfilledï¼‰ã€‚</p><p>è®©æˆ‘ä»¬è¯¦ç»†çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ <code>filehandle.readFile(options)</code>ï¼š</p><p>é¦–å…ˆï¼Œä½ éœ€è¦æœ‰ä¸€ä¸ªæ–‡ä»¶å¥æŸ„ï¼ˆ<code>FileHandle</code>ï¼‰ï¼Œè¿™é€šå¸¸æ˜¯é€šè¿‡æ‰“å¼€æ–‡ä»¶è·å¾—çš„ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ <code>fsPromises.open()</code> æ–¹æ³•ã€‚å½“ä½ æ‹¥æœ‰äº†ä¸€ä¸ªæ–‡ä»¶å¥æŸ„ä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨å®ƒæ¥è¯»å–æ–‡ä»¶çš„å†…å®¹ã€‚</p><h3 id="é€‰é¡¹-options-1" tabindex="-1"><a class="header-anchor" href="#é€‰é¡¹-options-1"><span>é€‰é¡¹ (<code>options</code>)</span></a></h3><ul><li><code>encoding</code>: æŒ‡å®šæ–‡ä»¶å†…å®¹çš„å­—ç¬¦ç¼–ç ï¼Œæ¯”å¦‚ <code>&#39;utf8&#39;</code>ã€‚</li><li><code>signal</code>: ä¸€ä¸ª <code>AbortSignal</code> å¯¹è±¡ï¼Œå…è®¸ä½ ä¸­æ­¢è¯»å–æ“ä½œã€‚</li></ul><h3 id="ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹"><span>ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶å«åš <code>example.txt</code>ï¼Œé‡Œé¢æœ‰ä¸€äº›æ–‡æœ¬å†…å®¹ï¼Œä½ æƒ³è¦è¯»å–è¿™ä¸ªæ–‡ä»¶å¹¶è¾“å‡ºå†…å®¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è¿™æ˜¯ä¸€ä¸ªè‡ªæ‰§è¡Œçš„ async å‡½æ•°</span></span>
<span class="line"><span style="color:#D8DEE9FF;">(</span><span style="color:#81A1C1;">async</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // æ‰“å¼€æ–‡ä»¶è·å– filehandle</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">      // è¯»å–æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">      const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">{</span><span style="color:#88C0D0;"> encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡ºæ–‡ä»¶å†…å®¹åˆ°æ§åˆ¶å°</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">      // æœ€åä¸è¦å¿˜äº†å…³é—­æ–‡ä»¶å¥æŸ„</span></span>
<span class="line"><span style="color:#81A1C1;">      await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // å¦‚æœå‡ºç°é”™è¯¯ï¼Œæ¯”å¦‚æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¼šè¿›å…¥è¿™é‡Œ</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error reading file:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† Node.js çš„<code>fs.promises</code>æ¨¡å—ï¼Œç„¶åå®šä¹‰äº†ä¸€ä¸ªè‡ªæ‰§è¡Œçš„å¼‚æ­¥å‡½æ•°ã€‚åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå°è¯•å¼‚æ­¥æ‰“å¼€ <code>example.txt</code> æ–‡ä»¶ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›ä¸€ä¸ª <code>FileHandle</code> å¯¹è±¡ã€‚éšåï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>filehandle.readFile({ encoding: &#39;utf8&#39; })</code> æ¥è¯»å–æ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶æŒ‡å®šç¼–ç ä¸º <code>&#39;utf8&#39;</code>ï¼Œè¿™æ ·è¯»å–å‡ºæ¥çš„æ•°æ®å°±æ˜¯å­—ç¬¦ä¸²æ ¼å¼ã€‚è¯»å–æˆåŠŸåï¼Œæˆ‘ä»¬å°†å†…å®¹è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚æ— è®ºè¯»å–æ“ä½œæ˜¯å¦æˆåŠŸï¼Œæˆ‘ä»¬éƒ½ä¼šåœ¨ <code>finally</code> å—ä¸­å°è¯•å…³é—­æ–‡ä»¶å¥æŸ„ï¼Œä»¥ç¡®ä¿ä¸ä¼šæœ‰èµ„æºæ³„æ¼ã€‚å¦‚æœè¿‡ç¨‹ä¸­é‡åˆ°ä»»ä½•é”™è¯¯ï¼Œæ¯”å¦‚æ–‡ä»¶æ‰¾ä¸åˆ°ã€æƒé™é—®é¢˜ç­‰ï¼Œéƒ½ä¼šè¢«æ•è·å¹¶æ‰“å°å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>filehandle.readFile(options)</code> æä¾›äº†ä¸€ç§åŸºäº Promise çš„æ–¹å¼æ¥å¼‚æ­¥è¯»å–æ–‡ä»¶çš„å†…å®¹ï¼Œä½¿å¾—ä»£ç æ›´åŠ ç®€æ´å’Œæ˜“äºç®¡ç†å¼‚æ­¥æ“ä½œã€‚</p><h4 id="filehandle-readlines-options" tabindex="-1"><a class="header-anchor" href="#filehandle-readlines-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandlereadlinesoptions" target="_blank" rel="noopener noreferrer">filehandle.readLines([options])</a></span></a></h4><p>å½“ä½ å¼€å§‹ä½¿ç”¨ Node.jsï¼Œä¸€ä¸ªå¸¸è§ä»»åŠ¡å¯èƒ½æ˜¯è¯»å–æ–‡ä»¶ä¸­çš„å†…å®¹ã€‚åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œå¼•å…¥äº†<code>filehandle.readLines([options])</code>è¿™ä¸ªæ–¹æ³•ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªéå¸¸ä¾¿æ·çš„æ–¹å¼æ¥æŒ‰è¡Œè¯»å–æ–‡ä»¶çš„å†…å®¹ã€‚æˆ‘ä»¬æ¥è¯¦ç»†è§£æä¸€ä¸‹è¿™ä¸ªæ–¹æ³•ï¼Œå¹¶é€šè¿‡å‡ ä¸ªå®é™…çš„ä¾‹å­æ¥å±•ç¤ºå®ƒçš„ç”¨æ³•ã€‚</p><h3 id="è§£æ-filehandle-readlines-options" tabindex="-1"><a class="header-anchor" href="#è§£æ-filehandle-readlines-options"><span>è§£æ <code>filehandle.readLines([options])</code></span></a></h3><p>é¦–å…ˆï¼Œ<code>filehandle</code>æ˜¯ä»€ä¹ˆï¼Ÿåœ¨ Node.js ä¸­ï¼Œå½“ä½ æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œè¯»å†™æ“ä½œæ—¶ï¼Œä½ ä¼šè·å¾—ä¸€ä¸ª<code>FileHandle</code>å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡ä»£è¡¨äº†å¯¹é‚£ä¸ªç‰¹å®šæ–‡ä»¶çš„å¼•ç”¨ï¼Œä½ å¯ä»¥é€šè¿‡å®ƒæ¥è¿›è¡Œå„ç§æ–‡ä»¶æ“ä½œï¼Œå¦‚è¯»å–ã€å†™å…¥ç­‰ã€‚</p><p><code>readLines([options])</code>æ–¹æ³•æ˜¯<code>FileHandle</code>å¯¹è±¡ä¸Šçš„ä¸€ä¸ªæ–°æ–¹æ³•ï¼Œå¯ä»¥è®©ä½ æ›´æ–¹ä¾¿åœ°é€è¡Œè¯»å–æ–‡ä»¶å†…å®¹ã€‚ä¹‹å‰ï¼Œä½ å¯èƒ½éœ€è¦ç”¨åˆ°æµ(Streams)æˆ–æ˜¯é€ä¸ªå­—èŠ‚è¯»å–ç„¶åè‡ªå·±åˆ†å‰²è¡Œï¼Œè¿™æ ·æ¯”è¾ƒå¤æ‚ä¸”å®¹æ˜“å‡ºé”™ã€‚ç°åœ¨æœ‰äº†<code>readLines</code>ï¼Œè¿™ä¸ªè¿‡ç¨‹ç®€åŒ–äº†å¾ˆå¤šã€‚</p><h4 id="å‚æ•°-1" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-1"><span>å‚æ•°</span></a></h4><ul><li><code>options</code>ï¼ˆå¯é€‰ï¼‰ï¼šæ­¤å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥å®šåˆ¶è¯»å–è¡Œçš„è¡Œä¸ºã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥æŒ‡å®šä¸€ä¸ªå­—ç¬¦ç¼–ç ï¼ˆå¦‚<code>utf8</code>ï¼‰æ¥æ­£ç¡®è§£ç æ–‡ä»¶å†…å®¹ã€‚å¦‚æœä¸æä¾›ï¼Œå°†ä½¿ç”¨é»˜è®¤ç¼–ç ï¼ˆé€šå¸¸æ˜¯<code>utf8</code>ï¼‰ã€‚</li></ul><h4 id="è¿”å›å€¼-1" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-1"><span>è¿”å›å€¼</span></a></h4><p><code>readLines</code>æ–¹æ³•è¿”å›ä¸€ä¸ªå¼‚æ­¥è¿­ä»£å™¨ï¼ˆAsync Iteratorï¼‰ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨<code>for await...of</code>å¾ªç¯æ¥éå†æ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-2"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªå«åš<code>example.txt</code>çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>Hello, World!</span></span>
<span class="line"><span>Welcome to Node.js.</span></span>
<span class="line"><span>This is a new line.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ æƒ³è¦æŒ‰è¡Œè¯»å–è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚</p><h4 id="ä¾‹å­-1-åŸºæœ¬ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-åŸºæœ¬ç”¨æ³•"><span>ä¾‹å­ 1ï¼šåŸºæœ¬ç”¨æ³•</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readLinesExample</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æ‰“å¼€æ–‡ä»¶ä»¥è·å–FileHandleå¯¹è±¡</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // é€è¡Œè¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">    for</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> line</span><span style="color:#81A1C1;"> of</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readLines</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">line</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // ä¸è¦å¿˜è®°å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">readLinesExample</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>readLines()</code>åŸºæœ¬æ–¹æ³•æ¥è¯»å–æ–‡ä»¶<code>example.txt</code>ä¸­çš„æ¯ä¸€è¡Œå¹¶æ‰“å°å‡ºæ¥ã€‚</p><h4 id="ä¾‹å­-2-ä½¿ç”¨optionså®šåˆ¶è¡Œä¸º" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ä½¿ç”¨optionså®šåˆ¶è¡Œä¸º"><span>ä¾‹å­ 2ï¼šä½¿ç”¨<code>options</code>å®šåˆ¶è¡Œä¸º</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readLinesWithEncoding</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // ä½¿ç”¨utf8ç¼–ç è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">    for</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> line</span><span style="color:#81A1C1;"> of</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readLines</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">{</span><span style="color:#88C0D0;"> encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">line</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">readLinesWithEncoding</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­ä¸ç¬¬ä¸€ä¸ªç±»ä¼¼ï¼Œä½†æ˜¯æˆ‘ä»¬æ˜ç¡®æŒ‡å®šäº†ä½¿ç”¨<code>utf8</code>ç¼–ç æ¥è¯»å–æ–‡ä»¶ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™æ˜¯é»˜è®¤è¡Œä¸ºï¼Œä½†æ˜¯ä½ ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦æŒ‡å®šå…¶ä»–ç±»å‹çš„ç¼–ç ã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œ<code>filehandle.readLines([options])</code>æ˜¯ä¸€ä¸ªå¼ºå¤§è€Œæ–¹ä¾¿çš„æ–°åŠŸèƒ½ï¼Œä½¿å¾—æŒ‰è¡Œè¯»å–æ–‡ä»¶å†…å®¹å˜å¾—ç®€å•å’Œç›´æ¥ã€‚é€šè¿‡å¼‚æ­¥è¿­ä»£å™¨ï¼Œä½ å¯ä»¥è½»æ¾åœ°å¤„ç†å¤§æ–‡ä»¶ï¼Œè€Œä¸å¿…æ‹…å¿ƒå†…å­˜é—®é¢˜æˆ–å¤æ‚çš„é€»è¾‘ã€‚</p><h4 id="filehandle-readv-buffers-position" tabindex="-1"><a class="header-anchor" href="#filehandle-readv-buffers-position"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandlereadvbuffers-position" target="_blank" rel="noopener noreferrer">filehandle.readv(buffers[, position])</a></span></a></h4><p>Node.js ä¸­çš„ <code>filehandle.readv(buffers[, position])</code> æ–¹æ³•æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„åŠŸèƒ½ï¼Œç‰¹åˆ«æ˜¯åœ¨ä½ éœ€è¦ä»æ–‡ä»¶ä¸­é«˜æ•ˆåœ°è¯»å–å¤šä¸ªæ•°æ®ç‰‡æ®µæ—¶ã€‚è¿™ä¸ªæ–¹æ³•å±äº Node.js çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œè€Œå…·ä½“æ¥è¯´ï¼Œå®ƒæ˜¯ FileHandle å¯¹è±¡çš„æ–¹æ³•ä¹‹ä¸€ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ·±å…¥äº†è§£å¹¶é€šè¿‡ä¾‹å­å­¦ä¹ å¦‚ä½•ä½¿ç”¨å®ƒã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-1" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-1"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>é¦–å…ˆï¼Œ<code>FileHandle</code> æ˜¯ä»£è¡¨æ‰“å¼€çš„æ–‡ä»¶çš„å¼•ç”¨ï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ <code>fsPromises.open()</code> æ–¹æ³•è·å¾—å®ƒã€‚ä¸€æ—¦ä½ æœ‰äº†æ–‡ä»¶çš„ <code>FileHandle</code>ï¼Œå°±å¯ä»¥å¯¹æ–‡ä»¶æ‰§è¡Œå„ç§æ“ä½œï¼ŒåŒ…æ‹¬è¯»å–å’Œå†™å…¥ã€‚</p><p><code>readv</code> æ–¹æ³•å…è®¸ä½ ä»æ–‡ä»¶ä¸­åŒæ—¶è¯»å–å¤šä¸ªæ•°æ®ç‰‡æ®µåˆ°ä¸€ä¸ªæˆ–å¤šä¸ªç»™å®šçš„ <code>Buffer</code> æˆ– <code>TypedArray</code> å¯¹è±¡ä¸­ã€‚è¿™ä¸ä¼ ç»Ÿçš„é€ä¸ªè¯»å–ä¸åŒï¼Œ<code>readv</code> å¯ä»¥å‡å°‘ç³»ç»Ÿè°ƒç”¨çš„æ¬¡æ•°ï¼Œæé«˜è¯»å–æ•ˆç‡ï¼Œç‰¹åˆ«æ˜¯å½“ä½ éœ€è¦ä»æ–‡ä»¶çš„ä¸åŒéƒ¨åˆ†è¯»å–æ•°æ®æ—¶ã€‚</p><h3 id="å‚æ•°è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯¦è§£"><span>å‚æ•°è¯¦è§£</span></a></h3><ul><li><code>buffers</code>: è¿™æ˜¯ä¸€ä¸ª <code>Buffer</code> æˆ– <code>TypedArray</code> å¯¹è±¡çš„æ•°ç»„ï¼Œç”¨äºå­˜å‚¨ä»æ–‡ä»¶ä¸­è¯»å–çš„æ•°æ®ã€‚</li><li><code>position</code>: ï¼ˆå¯é€‰ï¼‰è¿™æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºä»æ–‡ä»¶çš„å“ªä¸ªä½ç½®å¼€å§‹è¯»å–ã€‚å¦‚æœçœç•¥æ­¤å‚æ•°ï¼Œå°†ä»æ–‡ä»¶çš„å½“å‰ä½ç½®å¼€å§‹è¯»å–ã€‚</li></ul><h3 id="è¿”å›å€¼-2" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-2"><span>è¿”å›å€¼</span></a></h3><p><code>readv</code> æ–¹æ³•è¿”å›ä¸€ä¸ª Promiseï¼Œå®ƒè§£æä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸¤ä¸ªå±æ€§ï¼š<code>bytesRead</code> å’Œ <code>buffers</code>ã€‚<code>bytesRead</code> è¡¨ç¤ºå®é™…è¯»å–çš„å­—èŠ‚æ•°ï¼Œ<code>buffers</code> æ˜¯åŒ…å«è¯»å–æ•°æ®çš„ç¼“å†²åŒºæ•°ç»„ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-1"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–‡ä»¶ <code>example.txt</code>ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>Hello Node.js!</span></span>
<span class="line"><span>Welcome to the world of Node.js.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬æƒ³è¦åˆ†åˆ«è¯»å– &quot;Hello Node.js!&quot; å’Œ &quot;Welcome to the world of Node.js.&quot; è¿™ä¸¤æ®µæ–‡æœ¬åˆ°ä¸åŒçš„ç¼“å†²åŒºä¸­ã€‚ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨ <code>filehandle.readv()</code> æ–¹æ³•å®ç°çš„æ­¥éª¤ï¼š</p><ol><li><p><strong>æ‰“å¼€æ–‡ä»¶</strong>ï¼šé¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>fsPromises.open()</code> æ‰“å¼€æ–‡ä»¶ï¼Œè·å– <code>FileHandle</code>ã€‚</p></li><li><p><strong>å‡†å¤‡ç¼“å†²åŒº</strong>ï¼šç„¶åï¼Œåˆ›å»ºä¸¤ä¸ª <code>Buffer</code> å¯¹è±¡ï¼Œå‡†å¤‡æ¥æ”¶æ•°æ®ã€‚</p></li><li><p><strong>è¯»å–æ•°æ®</strong>ï¼šä½¿ç”¨ <code>filehandle.readv()</code> è¯»å–æ–‡ä»¶ä¸­çš„æ•°æ®åˆ°å‡†å¤‡å¥½çš„ç¼“å†²åŒºã€‚</p></li><li><p><strong>å¤„ç†æ•°æ®</strong>ï¼šæœ€åï¼Œå¤„ç†æˆ–è¾“å‡ºè¯»å–åˆ°çš„æ•°æ®ã€‚</p></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readFromFile</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // åˆ›å»ºä¸¤ä¸ªç¼“å†²åŒº</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> buffer1</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">13</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åˆ†é…è¶³å¤Ÿçš„ç©ºé—´æ¥å­˜æ”¾ &quot;Hello Node.js!&quot;</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> buffer2</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">30</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åˆ†é…è¶³å¤Ÿçš„ç©ºé—´æ¥å­˜æ”¾ &quot;Welcome to the world of Node.js.&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readv</span><span style="color:#D8DEE9FF;">([</span><span style="color:#D8DEE9;">buffer1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer2</span><span style="color:#D8DEE9FF;">]</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffer1</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: Hello Node.js!</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffer2</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: Welcome to the world of Node.js.</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">readFromFile</span><span style="color:#D8DEE9FF;">()</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆæ‰“å¼€äº†åä¸º <code>example.txt</code> çš„æ–‡ä»¶ï¼Œå¹¶ä¸ºè¦è¯»å–çš„ä¸¤æ®µæ–‡æœ¬åˆ†åˆ«å‡†å¤‡äº†ä¸¤ä¸ªç¼“å†²åŒºã€‚é€šè¿‡è°ƒç”¨ <code>filehandle.readv()</code> å¹¶ä¼ é€’ç¼“å†²åŒºï¼Œæˆ‘ä»¬èƒ½å¤Ÿé«˜æ•ˆåœ°ä¸€æ¬¡æ€§è¯»å–è¿™ä¸¤æ®µæ–‡æœ¬ã€‚æœ€åï¼Œæˆ‘ä»¬æŠŠè¿™äº›ç¼“å†²åŒºè½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œè¾“å‡ºç»“æœã€‚</p><p>å¸Œæœ›è¿™ä¸ªä¾‹å­èƒ½å¸®åŠ©ä½ ç†è§£å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨ <code>filehandle.readv(buffers[, position])</code> æ–¹æ³•ã€‚</p><h4 id="filehandle-stat-options" tabindex="-1"><a class="header-anchor" href="#filehandle-stat-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandlestatoptions" target="_blank" rel="noopener noreferrer">filehandle.stat([options])</a></span></a></h4><p>å½“æˆ‘ä»¬è°ˆè®º <code>filehandle.stat([options])</code> åœ¨ Node.js ä¸­ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨è®¨è®ºå¦‚ä½•è·å–ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ã€‚è¿™åœ¨ç¼–ç¨‹ä¸­æ˜¯ä¸€é¡¹éå¸¸åŸºç¡€ä¸”å¸¸ç”¨çš„æ“ä½œï¼Œå› ä¸ºå®ƒå…è®¸ä½ æ£€æŸ¥æ–‡ä»¶çš„å±æ€§ï¼Œä¾‹å¦‚å¤§å°ã€åˆ›å»ºæ—¶é—´ä»¥åŠæœ€åä¿®æ”¹æ—¶é—´ç­‰ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-2" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-2"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>é¦–å…ˆè§£é‡Šå‡ ä¸ªå…³é”®ç‚¹ï¼š</p><ul><li><strong>Node.js</strong>ï¼šæ˜¯ä¸€ä¸ªå¼€æºä¸”è·¨å¹³å°çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚</li><li><strong>FileHandle</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªè¡¨ç¤ºæ‰“å¼€çš„æ–‡ä»¶çš„å¯¹è±¡ï¼Œåœ¨ Node.js çš„<code>fs/promises</code>API ä¸­ä½¿ç”¨ã€‚æ¯å½“ä½ é€šè¿‡<code>fs.promises.open()</code>æ–¹æ³•æ‰“å¼€æ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šè¿”å›è¿™æ ·ä¸€ä¸ª FileHandle å¯¹è±¡ã€‚</li><li><strong>stat</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œé€šè¿‡å®ƒå¯ä»¥è·å–å…³äºæ–‡ä»¶æˆ–ç›®å½•çš„ç»Ÿè®¡ä¿¡æ¯ã€‚æ¯”å¦‚æ–‡ä»¶çš„å¤§å°(size)ã€åˆ›å»ºæ—¶é—´(birthtime)ã€æœ€åè®¿é—®æ—¶é—´(atime)ã€æœ€åä¿®æ”¹æ—¶é—´(mtime)ç­‰ã€‚</li></ul><h3 id="ä½¿ç”¨filehandle-stat-options" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨filehandle-stat-options"><span>ä½¿ç”¨<code>filehandle.stat([options])</code></span></a></h3><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>filehandle.stat([options])</code>æ–¹æ³•å…è®¸ä½ è·å–å·²æ‰“å¼€æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯å¼‚æ­¥çš„ï¼Œæ„å‘³ç€å®ƒä¼šåœ¨å®Œæˆæ“ä½œåé€šè¿‡ Promise æ¥æä¾›ç»“æœï¼Œä¸ä¼šé˜»å¡ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ã€‚</p><h4 id="ç¤ºä¾‹ä»£ç " tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç "><span>ç¤ºä¾‹ä»£ç </span></a></h4><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•ä¾‹å­ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>filehandle.stat([options])</code>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> fileInfo</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åˆ«å¿˜äº†å…³é—­æ–‡ä»¶å¥æŸ„</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è·å–æ–‡ä»¶ä¿¡æ¯å¤±è´¥:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">fileInfo</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å°†&#39;./example.txt&#39;æ›¿æ¢æˆä½ æƒ³æ£€æŸ¥çš„æ–‡ä»¶è·¯å¾„</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç åšäº†ä»€ä¹ˆå‘¢ï¼Ÿ</p><ol><li>é¦–å…ˆï¼Œé€šè¿‡<code>fs.promises.open()</code>å‡½æ•°æ‰“å¼€æŒ‡å®šçš„æ–‡ä»¶ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ª FileHandle å¯¹è±¡ã€‚</li><li>ç„¶åï¼Œä½¿ç”¨<code>fileHandle.stat()</code>æ–¹æ³•è·å–æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯ã€‚</li><li>æ‰“å°å‡ºè¯¥ä¿¡æ¯ã€‚</li><li>æœ€åï¼Œåˆ«å¿˜äº†å…³é—­æ–‡ä»¶ï¼Œé¿å…èµ„æºæ³„éœ²ã€‚</li></ol><h3 id="å®é™…åº”ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨åœºæ™¯"><span>å®é™…åº”ç”¨åœºæ™¯</span></a></h3><ul><li><strong>åˆ¤æ–­æ–‡ä»¶å¤§å°</strong>ï¼šåœ¨ä¸Šä¼ æ–‡ä»¶ä¹‹å‰ï¼Œä½ å¯èƒ½éœ€è¦æ£€æŸ¥æ–‡ä»¶çš„å¤§å°ï¼Œä»¥ç¡®ä¿å®ƒä¸è¶…è¿‡é™åˆ¶ã€‚</li><li><strong>ç¼“å­˜æœºåˆ¶</strong>ï¼šé€šè¿‡æ¯”è¾ƒæ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´ï¼Œç¡®å®šæ˜¯å¦éœ€è¦æ›´æ–°ç¼“å­˜ä¸­çš„æ•°æ®ã€‚</li><li><strong>æƒé™ç®¡ç†</strong>ï¼šæ£€æŸ¥æ–‡ä»¶çš„æ¨¡å¼ï¼ˆmodeï¼‰ï¼Œå†³å®šç”¨æˆ·æ˜¯å¦æœ‰æƒé™è¿›è¡Œè¯»å†™æ“ä½œã€‚</li></ul><p>æ€»ç»“æ¥è¯´ï¼Œ<code>filehandle.stat([options])</code> æ˜¯ä¸€ç§é«˜æ•ˆåœ°è·å–æ–‡ä»¶ç›¸å…³ä¿¡æ¯çš„æ–¹æ³•ï¼Œå¯¹äºæ–‡ä»¶ç³»ç»Ÿçš„æ“ä½œè‡³å…³é‡è¦ã€‚å¸Œæœ›è¿™ä¸ªè§£é‡Šå’Œç¤ºä¾‹èƒ½å¤Ÿå¸®åŠ©ä½ ç†è§£å®ƒçš„ä½œç”¨ã€‚</p><h4 id="filehandle-sync" tabindex="-1"><a class="header-anchor" href="#filehandle-sync"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandlesync" target="_blank" rel="noopener noreferrer">filehandle.sync()</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome çš„ V8 JavaScript å¼•æ“è¿è¡Œçš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒä½¿å¾—å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ï¼Œè¿›è¡Œç½‘ç»œæ“ä½œã€æ–‡ä»¶ç³»ç»Ÿæ“ä½œç­‰ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>filehandle.sync()</code> æ˜¯ä¸€ä¸ªä¸æ–‡ä»¶æ“ä½œç›¸å…³çš„æ–¹æ³•ï¼Œå®ƒå±äº <code>fs</code> (æ–‡ä»¶ç³»ç»Ÿ) æ¨¡å—ã€‚è¿™ä¸ªæ–¹æ³•ç”¨äºåŒæ­¥ç£ç›˜ç¼“å­˜ä¸­ä¸æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ç›¸å…³çš„æ‰€æœ‰æ•°æ®ã€‚ç®€å•æ¥è¯´ï¼Œå½“ä½ å¯¹ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œäº†å†™å…¥æ“ä½œä¹‹åï¼Œè¿™äº›å˜æ›´å¯èƒ½ä¼šè¢«å…ˆå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå¹¶ä¸æ˜¯ç«‹å³å†™å…¥ç£ç›˜ã€‚<code>filehandle.sync()</code> æ–¹æ³•å°±æ˜¯ç¡®ä¿è¿™äº›æš‚å­˜åœ¨å†…å­˜ä¸­çš„æ•°æ®è¢«åŒæ­¥åˆ°ç£ç›˜ä¸Šï¼Œä»¥æ­¤æ¥é˜²æ­¢æ•°æ®ä¸¢å¤±ã€‚</p><p>åœ¨å¤šæ•°æƒ…å†µä¸‹ï¼Œæ–‡ä»¶çš„å†™å…¥æ“ä½œæ˜¯å¼‚æ­¥çš„ï¼ŒNode.js ä¼šè‡ªåŠ¨å¤„ç†æ•°æ®çš„åŒæ­¥å·¥ä½œã€‚ä½†æ˜¯ï¼Œåœ¨æŸäº›éœ€è¦ç¡®ä¿æ•°æ®å®Œæ•´æ€§çš„åº”ç”¨åœºæ™¯ä¸‹ï¼Œæ¯”å¦‚æ•°æ®åº“çš„äº‹åŠ¡å¤„ç†ï¼Œå¯èƒ½ä¼šæ‰‹åŠ¨è°ƒç”¨ <code>filehandle.sync()</code> æ¥ç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§å’Œå®‰å…¨æ€§ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>filehandle.sync()</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> writeDataToFile</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filename</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æ‰“å¼€æ–‡ä»¶è·å– FileHandle</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filename</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // å†™å…¥æ•°æ®åˆ°æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // ä½¿ç”¨ sync() ç¡®ä¿æ•°æ®å·²ç»åŒæ­¥åˆ°ç£ç›˜</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">sync</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // ä¸ç®¡æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½å°è¯•å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨å‡½æ•°ï¼Œå†™å…¥æ•°æ®åˆ° &#39;example.txt&#39;</span></span>
<span class="line"><span style="color:#88C0D0;">writeDataToFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯ä¸€äº›é‡è¦çš„æ•°æ®ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">then</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#D8DEE9;"> console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ•°æ®å·²å†™å…¥å¹¶åŒæ­¥åˆ°ç£ç›˜</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">))</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">error</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#D8DEE9;"> console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‡ºç°é”™è¯¯ï¼š</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆæ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶ï¼ˆå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»ºï¼‰ï¼Œç„¶åç”¨ <code>writeFile()</code> æ–¹æ³•å†™å…¥äº†ä¸€äº›æ•°æ®ã€‚ç´§æ¥ç€æˆ‘ä»¬è°ƒç”¨äº† <code>filehandle.sync()</code> æ–¹æ³•ï¼Œè¿™ä¸ªè°ƒç”¨å°†æŒ‡ç¤º Node.js å°†æ‰€æœ‰çš„æ•°æ®ä»å†…å­˜ä¸­åŒæ­¥åˆ°ç¡¬ç›˜ä¸Šã€‚æœ€åï¼Œæˆ‘ä»¬é€šè¿‡ <code>filehandle.close()</code> æ–¹æ³•å…³é—­äº†æ–‡ä»¶ï¼Œä»¥é‡Šæ”¾ç³»ç»Ÿèµ„æºã€‚</p><h4 id="filehandle-truncate-len" tabindex="-1"><a class="header-anchor" href="#filehandle-truncate-len"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandletruncatelen" target="_blank" rel="noopener noreferrer">filehandle.truncate(len)</a></span></a></h4><p>å½“ç„¶ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥æ­¥ç†è§£ <code>filehandle.truncate(len)</code> è¿™ä¸ªæ–¹æ³•ã€‚</p><p><strong>Node.js ä¸­çš„ FileHandle:</strong><br> åœ¨ Node.js ä¸­ï¼Œæ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼ˆé€šå¸¸ç§°ä¸º <code>fs</code>ï¼‰å…è®¸ä½ ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚åœ¨è¿™ä¸ªæ¨¡å—é‡Œï¼Œ<code>FileHandle</code> æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»£è¡¨äº†æ‰“å¼€çš„æ–‡ä»¶çš„å¼•ç”¨ã€‚ä½ å¯ä»¥é€šè¿‡è°ƒç”¨ <code>fsPromises.open()</code> æ–¹æ³•æ¥è·å¾—ä¸€ä¸ª <code>FileHandle</code> å¯¹è±¡ã€‚</p><p><strong>Truncate æ–¹æ³•:</strong><br><code>truncate</code> è¿™ä¸ªå•è¯åœ¨è‹±è¯­ä¸­æ„å‘³ç€â€œç¼©çŸ­â€æˆ–â€œåˆ‡æ–­â€ã€‚åœ¨ç¼–ç¨‹ä¸­ï¼Œç‰¹åˆ«æ˜¯å½“å¤„ç†æ–‡ä»¶æ—¶ï¼Œ<code>truncate</code> æŒ‡çš„æ˜¯å‡å°‘æ–‡ä»¶çš„å¤§å°ï¼Œå¦‚æœéœ€è¦çš„è¯ï¼Œä¹Ÿå¯ä»¥å°†æ–‡ä»¶å¤§å°å¢åŠ åˆ°æŒ‡å®šé•¿åº¦ã€‚</p><p><code>filehandle.truncate(len)</code> æ–¹æ³•å…·ä½“æ˜¯ç”¨æ¥è®¾ç½®ä¸€ä¸ªå·²ç»æ‰“å¼€çš„æ–‡ä»¶çš„å¤§å°ã€‚<code>len</code> å‚æ•°å°±æ˜¯ä½ æƒ³è¦è®¾ç½®æ–‡ä»¶çš„æ–°çš„å­—èŠ‚å¤§å°ã€‚å¦‚æœä½ è®¾å®šçš„ <code>len</code> å‚æ•°æ¯”æ–‡ä»¶å½“å‰çš„å¤§å°å°ï¼Œé‚£ä¹ˆæ–‡ä»¶ä¼šè¢«æˆªæ–­ï¼ˆå³å‰©ä¸‹çš„å†…å®¹ä¼šè¢«åˆ é™¤ï¼‰ã€‚å¦‚æœ <code>len</code> æ¯”æ–‡ä»¶çš„å½“å‰å¤§å°å¤§ï¼Œé‚£ä¹ˆæ–‡ä»¶å°†ä¼šæ‰©å±•åˆ°é‚£ä¸ªå¤§å°ï¼Œå¹¶ä¸”æ–°å¢çš„éƒ¨åˆ†é€šå¸¸ä¼šç”¨ç©ºå­—èŠ‚ï¼ˆ0ï¼‰å¡«å……ã€‚</p><p><strong>å‚æ•°:</strong></p><ul><li><code>len</code>: è¿™æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå®šä¹‰äº†æ–‡ä»¶åº”è¯¥è¢«æˆªæ–­æˆ–æ‰©å±•åçš„æ–°çš„é•¿åº¦ã€‚</li></ul><p>ç°åœ¨è®©æˆ‘ä»¬é€šè¿‡ä¾‹å­æ¥çœ‹çœ‹å¦‚ä½•åœ¨å®é™…æƒ…å†µä¸­ä½¿ç”¨ <code>filehandle.truncate(len)</code>ã€‚</p><p><strong>ä¾‹å­ 1 - æˆªæ–­æ–‡ä»¶:</strong><br> å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå«åš <code>example.txt</code> çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå®ƒçš„å†…å®¹å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>Hello, this is a text file with some example content.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æˆ‘ä»¬æƒ³è¦æˆªæ–­è¿™ä¸ªæ–‡ä»¶ï¼Œåªä¿ç•™å¼€å§‹çš„ <code>5</code> ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬å¸Œæœ›æ–‡ä»¶æœ€ååªåŒ…å« &quot;Hello&quot;ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å†™ä¸‹é¢çš„ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> truncateFile</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> length</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ‰“å¼€æ–‡ä»¶ç”¨äºè¯»å†™</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">truncate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">length</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å°†æ–‡ä»¶æˆªæ–­åˆ°æŒ‡å®šçš„é•¿åº¦</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å…³é—­æ–‡ä»¶å¥æŸ„é‡Šæ”¾èµ„æº</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">truncateFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 5</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">then</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File has been truncated.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">An error occurred:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œè¿™æ®µä»£ç åï¼Œ<code>example.txt</code> æ–‡ä»¶ä¸­çš„å†…å®¹å°†å˜ä¸ºï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>Hello</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>ä¾‹å­ 2 - æ‰©å±•æ–‡ä»¶:</strong><br> ç°åœ¨ï¼Œå‡è®¾æˆ‘ä»¬æƒ³å°†ç›¸åŒçš„æ–‡ä»¶ <code>example.txt</code> æ‰©å±•åˆ° <code>20</code> ä¸ªå­—èŠ‚ã€‚åŸå§‹æ–‡ä»¶ <code>example.txt</code> åªæœ‰ <code>5</code> ä¸ªå­—èŠ‚ï¼ˆ&quot;Hello&quot;ï¼‰ï¼Œæ‰€ä»¥å®ƒä¼šè¢«æ‰©å±•ï¼Œæ–°å¢çš„éƒ¨åˆ†ä¼šç”¨ç©ºå­—èŠ‚ï¼ˆ0ï¼‰å¡«å……ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç›¸åŒçš„ <code>truncateFile</code> å‡½æ•°ï¼Œä½†æ”¹å˜é•¿åº¦å‚æ•°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">truncateFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 20</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">then</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File has been extended.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">An error occurred:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œè¿™ä¸ªæ“ä½œåï¼Œæ–‡ä»¶çš„å†…å®¹å¯èƒ½çœ‹èµ·æ¥åƒä¹±ç æˆ–è€…ç©ºç™½ï¼Œå› ä¸ºå¤šå‡ºæ¥çš„å­—èŠ‚éƒ½æ˜¯ç©ºå­—èŠ‚ã€‚åœ¨ä¸€äº›æ–‡æœ¬ç¼–è¾‘å™¨ä¸­ï¼Œè¿™äº›ç©ºç™½å¯èƒ½ä¼šæ˜¾ç¤ºä¸º NULL å­—ç¬¦æˆ–è€…ä¸æ˜¾ç¤ºã€‚</p><p>åœ¨ä½¿ç”¨ <code>truncate</code> æ–¹æ³•æ—¶ï¼Œè®°ä½æ€»æ˜¯è¦æ£€æŸ¥ä½ æ˜¯å¦æ‹¥æœ‰å¯¹æ–‡ä»¶çš„æ­£ç¡®æƒé™ï¼Œå¹¶ç¡®ä¿åœ¨æ“ä½œå®Œæˆåå…³é—­ <code>FileHandle</code>ã€‚è¿™æ ·å¯ä»¥é¿å…èµ„æºæ³„æ¼å’Œå…¶ä»–æ½œåœ¨çš„æ–‡ä»¶ç³»ç»Ÿé—®é¢˜ã€‚</p><h4 id="filehandle-utimes-atime-mtime" tabindex="-1"><a class="header-anchor" href="#filehandle-utimes-atime-mtime"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandleutimesatime-mtime" target="_blank" rel="noopener noreferrer">filehandle.utimes(atime, mtime)</a></span></a></h4><p>äº†è§£ <code>filehandle.utimes(atime, mtime)</code> è¿™ä¸ªåŠŸèƒ½ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ˜ç™½å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p><ol><li><strong>Node.js</strong>: æ˜¯ä¸€ä¸ªè®© JavaScript è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¹³å°ï¼Œå®ƒä½¿å¾—ç”¨ JavaScript ç¼–å†™åç«¯ä»£ç æˆä¸ºå¯èƒ½ã€‚</li><li><strong>File System (fs) æ¨¡å—</strong>: Node.js ä¸­çš„ <code>fs</code> æ¨¡å—è´Ÿè´£ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥åˆ›å»ºã€è¯»å–ã€ä¿®æ”¹ã€åˆ é™¤æ–‡ä»¶ç­‰ã€‚</li><li><strong>FileHandle</strong>: å½“ä½ åœ¨ Node.js ä¸­æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ª FileHandle å¯¹è±¡ï¼Œè¿™æ˜¯å¯¹æ‰“å¼€çš„æ–‡ä»¶çš„å¼•ç”¨ï¼Œé€šè¿‡å®ƒå¯ä»¥å¯¹æ–‡ä»¶è¿›è¡Œå„ç§æ“ä½œã€‚</li></ol><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ·±å…¥ç†è§£ <code>filehandle.utimes(atime, mtime)</code>ï¼š</p><ul><li><strong>ä½œç”¨</strong>ï¼šè¿™ä¸ªæ–¹æ³•å…è®¸ä½ æ”¹å˜ä¸€ä¸ªæ–‡ä»¶çš„è®¿é—®ï¼ˆatimeï¼‰å’Œä¿®æ”¹ï¼ˆmtimeï¼‰æ—¶é—´æˆ³ã€‚ <ul><li><code>atime</code>ï¼ˆAccess Timeï¼‰ï¼šæŒ‡çš„æ˜¯æ–‡ä»¶æœ€åè¢«è®¿é—®çš„æ—¶é—´ã€‚</li><li><code>mtime</code>ï¼ˆModified Timeï¼‰ï¼šæŒ‡çš„æ˜¯æ–‡ä»¶å†…å®¹æœ€åè¢«ä¿®æ”¹çš„æ—¶é—´ã€‚</li></ul></li></ul><h3 id="å‚æ•°è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯´æ˜"><span>å‚æ•°è¯´æ˜</span></a></h3><ul><li><code>atime</code>: æ–°çš„è®¿é—®æ—¶é—´ã€‚å¯ä»¥æ˜¯ä»£è¡¨æ¯«ç§’æ•°çš„æ•°å­—æˆ–è€…æ˜¯ <code>Date</code> å¯¹è±¡ã€‚</li><li><code>mtime</code>: æ–°çš„ä¿®æ”¹æ—¶é—´ã€‚åŒæ ·å¯ä»¥æ˜¯ä»£è¡¨æ¯«ç§’æ•°çš„æ•°å­—æˆ–è€…æ˜¯ <code>Date</code> å¯¹è±¡ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-1"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåšå®¢ç³»ç»Ÿï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåŠŸèƒ½æ˜¯æ›´æ–°æ–‡ç« ã€‚æ¯å½“ä¸€ç¯‡æ–‡ç« è¢«ç¼–è¾‘åï¼Œé™¤äº†å†…å®¹æ›´æ–°å¤–ï¼Œä½ ä¹Ÿæƒ³æ›´æ–°è¯¥æ–‡ç« æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´æˆ³ï¼Œä»¥ä¾¿è·Ÿè¸ªæœ€åç¼–è¾‘æ—¶é—´ã€‚æ­¤æ—¶ï¼Œ<code>filehandle.utimes(atime, mtime)</code> å°±éå¸¸æœ‰ç”¨äº†ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> updateArticleTimestamp</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">articlePath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">articlePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // ä»¥è¯»å†™æ–¹å¼æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> now</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è·å–å½“å‰æ—¶é—´</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">utimes</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">now</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> now</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ›´æ–°æ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´ä¸ºå½“å‰æ—¶é—´</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å…³é—­æ–‡ä»¶å¥æŸ„é‡Šæ”¾èµ„æº</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æˆåŠŸæ›´æ–°æ–‡ç« æ—¶é—´æˆ³: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">articlePath</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ›´æ–°æ–‡ç« æ—¶é—´æˆ³å¤±è´¥: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">error</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º &quot;example-article.txt&quot; çš„æ–‡ç« æ–‡ä»¶</span></span>
<span class="line"><span style="color:#88C0D0;">updateArticleTimestamp</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example-article.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡ <code>fs.open</code> æ‰“å¼€æ–‡ä»¶è·å– <code>FileHandle</code>ã€‚ç„¶åï¼Œä½¿ç”¨ <code>filehandle.utimes</code> æ–¹æ³•æ›´æ–°æ–‡ä»¶çš„è®¿é—®æ—¶é—´å’Œä¿®æ”¹æ—¶é—´ä¸ºå½“å‰æ—¶é—´ã€‚æ“ä½œå®Œæˆåï¼Œæˆ‘ä»¬å…³é—­æ–‡ä»¶ä»¥é‡Šæ”¾èµ„æºã€‚</p><p>é€šè¿‡ä¸Šè¿°è¿‡ç¨‹ï¼Œä¸€ä¸ªå®é™…çš„æ–‡ä»¶ä¿®æ”¹æ—¶é—´æˆ³æ›´æ–°ä»»åŠ¡å°±è¢«ç®€æ´åœ°æ‰§è¡Œäº†ï¼Œè¿™åœ¨å¤„ç†æ–‡ä»¶å…ƒæ•°æ®æ—¶éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚åœ¨å¤‡ä»½ç³»ç»Ÿã€æ–‡ä»¶åŒæ­¥æœåŠ¡æˆ–ä»»ä½•éœ€è¦è®°å½•æ–‡ä»¶çŠ¶æ€å˜æ›´çš„åœºæ™¯ä¸­ã€‚</p><h4 id="filehandle-write-buffer-offset-length-position" tabindex="-1"><a class="header-anchor" href="#filehandle-write-buffer-offset-length-position"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandlewritebuffer-offset-length-position" target="_blank" rel="noopener noreferrer">filehandle.write(buffer, offset[, length[, position]])</a></span></a></h4><p>Node.js ä¸­çš„ <code>filehandle.write</code> æ–¹æ³•æ˜¯ç”¨äºå‘æ–‡ä»¶ä¸­å†™å…¥æ•°æ®çš„å‡½æ•°ã€‚åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥æ¥å—å‡ ä¸ªå‚æ•°æ¥æ§åˆ¶å¦‚ä½•å°†æ•°æ®å†™å…¥åˆ°æ–‡ä»¶ã€‚</p><p>ç°åœ¨æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥è§£é‡Šæ¯ä¸ªå‚æ•°ï¼š</p><ol><li><p><strong>buffer</strong>: è¿™æ˜¯ä¸€ä¸ªåŒ…å«äº†ä½ æƒ³è¦å†™å…¥æ–‡ä»¶çš„æ•°æ®çš„ Buffer å¯¹è±¡æˆ–è€… Uint8Arrayã€‚ç®€å•æ¥è¯´ï¼ŒBuffer å°±æ˜¯å†…å­˜ä¸­çš„ä¸€å—åŒºåŸŸï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥å­˜å‚¨å’Œæ“ä½œäºŒè¿›åˆ¶æ•°æ®ã€‚</p></li><li><p><strong>offset</strong>: è¿™æ˜¯æŒ‡å®šä» buffer ä¸­å“ªä¸ªä½ç½®å¼€å§‹å†™çš„åç§»é‡ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ offset æ˜¯ 10ï¼Œé‚£ä¹ˆå†™å…¥æ“ä½œä¼šä» buffer çš„ç¬¬ 11 ä¸ªå­—èŠ‚å¼€å§‹ã€‚</p></li><li><p><strong>length</strong> (å¯é€‰): è¿™ä¸ªå‚æ•°ç”¨äºæŒ‡å®šè¦å†™å…¥å¤šå°‘å­—èŠ‚çš„æ•°æ®ã€‚å¦‚æœä½ ä¸æä¾›è¿™ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆé»˜è®¤æƒ…å†µä¸‹ä¼šå†™å…¥ä» offset å¼€å§‹åˆ° buffer ç»“æŸçš„æ‰€æœ‰æ•°æ®ã€‚</p></li><li><p><strong>position</strong> (å¯é€‰): è¿™ä¸ªå‚æ•°ç”¨äºæŒ‡å®šåœ¨æ–‡ä»¶ä¸­å¼€å§‹å†™å…¥æ•°æ®çš„ä½ç½®ã€‚å¦‚æœè®¾ç½®ä¸º nullï¼Œæ•°æ®ä¼šè¢«å†™å…¥åˆ°å½“å‰æ–‡ä»¶æŒ‡é’ˆçš„ä½ç½®ã€‚å¦åˆ™ï¼Œä½ å¯ä»¥æŒ‡å®šä¸€ä¸ªå…·ä½“çš„æ•°å­—æ¥è¡¨ç¤ºåœ¨æ–‡ä»¶ä¸­çš„åç§»é‡ã€‚</p></li></ol><p>è®©æˆ‘ä»¬é€šè¿‡å®ä¾‹çœ‹çœ‹ <code>filehandle.write</code> çš„ä½¿ç”¨ï¼š</p><p>å‡è®¾ä½ æœ‰ä¸€æ®µæ–‡æœ¬ä¿¡æ¯ï¼Œä½ æƒ³å°†å®ƒä¿å­˜åˆ°ç¡¬ç›˜ä¸Šçš„ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚é¦–å…ˆï¼Œä½ éœ€è¦æ‰“å¼€è¿™ä¸ªæ–‡ä»¶è·å–åˆ° filehandleï¼ˆæ–‡ä»¶å¥æŸ„ï¼‰ï¼Œç„¶åæ‰èƒ½è¿›è¡Œå†™æ“ä½œã€‚ä»¥ä¸‹æ˜¯å¯èƒ½çš„æ­¥éª¤ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å¼•å…¥ fs æ¨¡å—å¹¶ä½¿ç”¨ promises æ¥å£</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> writeToFile</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // æ‰“å¼€æ–‡ä»¶ï¼Œè·å– filehandle</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // åˆ›å»º Bufferï¼Œå…¶ä¸­ &quot;Hello World&quot; æ˜¯ä½ æƒ³å†™å…¥æ–‡ä»¶çš„æ–‡æœ¬</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello, World!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf-8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // è°ƒç”¨ write æ–¹æ³•å†™å…¥æ•°æ®</span></span>
<span class="line"><span style="color:#616E88;">    // æ­¤ä¾‹ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ offset, length å’Œ position å‚æ•°ï¼Œæ‰€ä»¥å®ƒä¼šä» Buffer çš„èµ·å§‹ä½ç½®å†™å…¥å…¨éƒ¨å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // æœ€åå…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error writing to file:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">writeToFile</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è°ƒç”¨è¯¥å¼‚æ­¥å‡½æ•°</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•å°†æ–‡æœ¬ &quot;Hello, World!&quot; å†™å…¥åˆ°åä¸º &#39;example.txt&#39; çš„æ–‡ä»¶ä¸­ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>async/await</code> è¯­æ³•ï¼Œå› ä¸ºæ–‡ä»¶æ“ä½œé€šå¸¸æ˜¯å¼‚æ­¥çš„ï¼Œå¹¶ä¸”æˆ‘ä»¬å¸Œæœ›ä»£ç æ˜¯æ˜“äºé˜…è¯»çš„ã€‚</p><p>å¦‚æœä½ æƒ³è¦åœ¨æ–‡ä»¶ä¸­çš„ç‰¹å®šä½ç½®å†™å…¥æ•°æ®ï¼Œæ¯”å¦‚è¯´ä»æ–‡ä»¶ç¬¬ 10 ä¸ªå­—èŠ‚çš„ä½ç½®å¼€å§‹ï¼Œä½ å¯ä»¥è¿™æ ·è°ƒç”¨ <code>filehandle.write</code> æ–¹æ³•:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// ...</span></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾ filehandle å·²ç»é€šè¿‡ fs.open è·å–åˆ°äº†</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> offset</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // ä» Buffer çš„å¼€å§‹ä½ç½®å†™å…¥</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> length</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">length</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å†™å…¥å…¨éƒ¨æ•°æ®</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> position</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 10</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åœ¨æ–‡ä»¶çš„ç¬¬ 10 ä¸ªå­—èŠ‚å¤„å¼€å§‹å†™å…¥</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> offset</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> length</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> position</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è®°ä½ï¼Œå¯¹æ–‡ä»¶çš„è¯»å†™æ“ä½œå¯èƒ½ä¼šå¼•å‘é”™è¯¯ï¼Œå¦‚æ–‡ä»¶ä¸å­˜åœ¨ã€æ— æƒé™ç­‰ï¼Œæ‰€ä»¥æ€»æ˜¯ç”¨ <code>try...catch</code> å—æˆ–è€…ç›¸åº”çš„é”™è¯¯å¤„ç†é€»è¾‘æ¥ç¡®ä¿ç¨‹åºçš„å¥å£®æ€§ã€‚</p><h4 id="filehandle-write-buffer-options" tabindex="-1"><a class="header-anchor" href="#filehandle-write-buffer-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandlewritebuffer-options" target="_blank" rel="noopener noreferrer">filehandle.write(buffer[, options])</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰å¾ˆå¤šå†…ç½®æ¨¡å—ï¼Œå…¶ä¸­ <code>fs</code> æ¨¡å—ç”¨äºå¤„ç†æ–‡ä»¶ç³»ç»Ÿç›¸å…³çš„æ“ä½œï¼Œæ¯”å¦‚è¯»å†™æ–‡ä»¶ã€‚</p><p>åœ¨ä½ æåˆ°çš„ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>filehandle.write(buffer[, options])</code> æ˜¯ <code>fs</code> æ¨¡å—ä¸­ç”¨äºå°†æ•°æ®å†™å…¥æ–‡ä»¶çš„ä¸€ä¸ªæ–¹æ³•ã€‚å½“ä½ æ‰“å¼€ï¼ˆæˆ–åˆ›å»ºï¼‰ä¸€ä¸ªæ–‡ä»¶ä»¥ä¾›å†™å…¥æ—¶ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªç§°ä¸º <code>FileHandle</code> çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä»£è¡¨äº†é‚£ä¸ªè¢«æ‰“å¼€çš„æ–‡ä»¶ï¼Œä½ å¯ä»¥é€šè¿‡è¿™ä¸ªå¯¹è±¡æ¥å¯¹æ–‡ä»¶è¿›è¡Œå…·ä½“çš„æ“ä½œï¼Œä¾‹å¦‚å†™å…¥æ•°æ®ã€‚</p><h3 id="å‚æ•°è§£é‡Š-1" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-1"><span>å‚æ•°è§£é‡Šï¼š</span></a></h3><ul><li><code>buffer</code>: è¿™æ˜¯ä½ æƒ³è¦å†™å…¥æ–‡ä»¶çš„æ•°æ®ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ª <code>Buffer</code> æˆ– <code>Uint8Array</code> ç±»å‹çš„å¯¹è±¡ï¼Œè¿™äº›ç±»å‹åŸºæœ¬ä¸Šè¡¨ç¤ºä¸€æ®µäºŒè¿›åˆ¶æ•°æ®ã€‚</li><li><code>options</code> (å¯é€‰): è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå…è®¸ä½ å®šåˆ¶ä¸€äº›å†™å…¥çš„ç»†èŠ‚ï¼Œæ¯”å¦‚ï¼š <ul><li><code>encoding</code>: æ•°æ®çš„å­—ç¬¦ç¼–ç ï¼Œé»˜è®¤æ˜¯ <code>&#39;utf8&#39;</code>ã€‚</li><li><code>mode</code>: æ–‡ä»¶çš„æƒé™ï¼Œé»˜è®¤æ˜¯ <code>0o666</code>ã€‚</li><li><code>flag</code>: æ–‡ä»¶çš„æ‰“å¼€æ–¹å¼ï¼Œé»˜è®¤æ˜¯ <code>&#39;a&#39;</code> ï¼ˆè¿½åŠ ï¼‰ã€‚<code>&#39;w&#39;</code> ä¸ºè¦†ç›–åŸå†…å®¹å†™å…¥ï¼Œ<code>&#39;a&#39;</code> ä¸ºä¿ç•™åŸå†…å®¹å¹¶è¿½åŠ å†™å…¥ã€‚</li></ul></li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-3"><span>å®é™…è¿ç”¨ä¾‹å­ï¼š</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä»»åŠ¡ï¼šå‘ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡æœ¬æ–‡ä»¶ä¸­å†™å…¥æ•°æ® &quot;Hello, Node.js!&quot;ã€‚</p><h4 id="ç¤ºä¾‹æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹æ­¥éª¤"><span>ç¤ºä¾‹æ­¥éª¤ï¼š</span></a></h4><ol><li><p><strong>æ‰“å¼€æ–‡ä»¶</strong>ï¼šé¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ‰“å¼€ï¼ˆæˆ–åˆ›å»ºï¼‰æ–‡ä»¶å¹¶è·å– <code>FileHandle</code> å¯¹è±¡ã€‚</p></li><li><p><strong>å†™å…¥æ•°æ®</strong>ï¼šç„¶åï¼Œä½¿ç”¨ <code>filehandle.write(buffer[, options])</code> å°†æ•°æ®å†™å…¥æ–‡ä»¶ã€‚</p></li><li><p><strong>å…³é—­æ–‡ä»¶</strong>ï¼šæœ€åï¼Œè®°å¾—å…³é—­æ‰“å¼€çš„æ–‡ä»¶ä»¥é‡Šæ”¾èµ„æºã€‚</p></li></ol><h4 id="ç¤ºä¾‹ä»£ç -1" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç -1"><span>ç¤ºä¾‹ä»£ç ï¼š</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å¼•å…¥ fs æ¨¡å—å¹¶ä½¿ç”¨ promises æ¥å£</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> writeFile</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    fileHandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ‰“å¼€æ–‡ä»¶ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»º</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello, Node.js!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åˆ›å»ºåŒ…å«æ•°æ®çš„ Buffer</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å†™å…¥æ•°æ®</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Data written to file successfully.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Got an error trying to write to a file: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">fileHandle</span><span style="color:#81A1C1;"> !==</span><span style="color:#81A1C1;"> undefined</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">      await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // ç¡®ä¿æ–‡ä»¶è¢«å…³é—­</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨ <code>fs.promises.open()</code> æ–¹æ³•æ‰“å¼€ï¼ˆæˆ–åˆ›å»ºï¼‰<code>example.txt</code> æ–‡ä»¶ï¼Œè¿™å°†è¿”å›ä¸€ä¸ª <code>FileHandle</code> å¯¹è±¡ã€‚æ¥ç€ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>Buffer.from()</code> åˆ›å»ºä¸€ä¸ªåŒ…å«æˆ‘ä»¬æƒ³è¦å†™å…¥çš„æ•°æ®çš„ <code>Buffer</code> å¯¹è±¡ã€‚ç„¶åï¼Œé€šè¿‡ <code>fileHandle.write(data)</code> æ–¹æ³•å°†è¿™äº›æ•°æ®å†™å…¥æ–‡ä»¶ã€‚æœ€åï¼Œä¸è¦å¿˜è®°è°ƒç”¨ <code>fileHandle.close()</code> æ¥å…³é—­æ–‡ä»¶ï¼Œè¿™æ˜¯éå¸¸é‡è¦çš„ä¸€æ­¥ï¼Œä»¥ç¡®ä¿æ‰€æœ‰èµ„æºéƒ½è¢«æ­£ç¡®é‡Šæ”¾ã€‚</p><h4 id="filehandle-write-string-position-encoding" tabindex="-1"><a class="header-anchor" href="#filehandle-write-string-position-encoding"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandlewritestring-position-encoding" target="_blank" rel="noopener noreferrer">filehandle.write(string[, position[, encoding]])</a></span></a></h4><p>å½“ä½ ä½¿ç”¨ Node.js å·¥ä½œæ—¶ï¼Œå¾ˆå¤šæ—¶å€™éœ€è¦ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº‘ã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½æƒ³è¦åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå‘æ–‡ä»¶ä¸­å†™å…¥æ•°æ®ï¼Œæˆ–è€…ä¿®æ”¹ç°æœ‰æ–‡ä»¶ä¸­çš„å†…å®¹ã€‚åœ¨ Node.js ä¸­ï¼Œè¿™äº›æ“ä½œå¯ä»¥é€šè¿‡<code>fs</code>æ¨¡å—ï¼ˆæ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼‰æ¥å®ç°ï¼Œè€Œä¸” Node.js ä¸ºäº†æ”¯æŒå¼‚æ­¥æ“ä½œï¼Œæä¾›äº†åŸºäº Promise çš„ APIã€‚å…¶ä¸­ï¼Œ<code>filehandle.write(string[, position[, encoding]])</code>æ˜¯ä¸€ä¸ªéå¸¸é‡è¦ä¸”å®ç”¨çš„æ–¹æ³•ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ·±å…¥äº†è§£å®ƒã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-3" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-3"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>é¦–å…ˆï¼Œ<code>filehandle.write()</code>æ–¹æ³•æ˜¯åŸºäº<code>fsPromises</code> API çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå…è®¸ä½ å¼‚æ­¥åœ°å†™å…¥æ•°æ®åˆ°æ–‡ä»¶ä¸­ã€‚åœ¨ä½ èƒ½ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œä½ éœ€è¦æœ‰ä¸€ä¸ªæ–‡ä»¶å¥æŸ„(<code>filehandle</code>)ï¼Œè¿™ä¸ªå¥æŸ„æ˜¯é€šè¿‡æ‰“å¼€æ–‡ä»¶è·å¾—çš„ï¼Œé€šå¸¸ä½¿ç”¨<code>fsPromises.open()</code>æ–¹æ³•ã€‚</p><h3 id="å‚æ•°è¯¦è§£-1" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯¦è§£-1"><span>å‚æ•°è¯¦è§£</span></a></h3><ul><li><strong>string</strong>: è¦å†™å…¥æ–‡ä»¶çš„æ•°æ®ã€‚</li><li><strong>position</strong>: ï¼ˆå¯é€‰ï¼‰è¿™æ˜¯æŒ‡å®šä»æ–‡ä»¶çš„å“ªä¸ªä½ç½®å¼€å§‹å†™å…¥çš„åç§»é‡ã€‚å¦‚æœæœªæŒ‡å®šï¼Œæˆ–è€…è®¾ç½®ä¸º nullï¼Œæ•°æ®å°†ä¼šè¢«å†™å…¥å½“å‰æ–‡ä»¶çš„æœ«å°¾ã€‚</li><li><strong>encoding</strong>: ï¼ˆå¯é€‰ï¼‰å®šä¹‰æ–‡ä»¶ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œå¦‚<code>&#39;utf8&#39;</code>ï¼Œ<code>&#39;ascii&#39;</code>ç­‰ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œé»˜è®¤ä¸º<code>&#39;utf8&#39;</code>ã€‚</li></ul><h3 id="è¿”å›å€¼-3" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-3"><span>è¿”å›å€¼</span></a></h3><p>è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè§£æä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸¤ä¸ªå±æ€§ï¼š<code>bytesWritten</code>ï¼ˆå†™å…¥çš„å­—èŠ‚æ•°ï¼‰ï¼Œå’Œ<code>buffer</code>ï¼ˆå†™å…¥çš„å†…å®¹ï¼‰ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-2"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>æ¥çœ‹å‡ ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£ã€‚</p><h4 id="ç¤ºä¾‹-1-å‘æ–‡ä»¶å†™å…¥æ–‡æœ¬" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-å‘æ–‡ä»¶å†™å…¥æ–‡æœ¬"><span>ç¤ºä¾‹ 1: å‘æ–‡ä»¶å†™å…¥æ–‡æœ¬</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨æ„å»ºä¸€ä¸ªæ—¥å¿—ç³»ç»Ÿï¼Œéœ€è¦å°†æ—¥å¿—ä¿¡æ¯å†™å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> addLog</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">message</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./log.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">}</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">addLog</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯ä¸€æ¡æ–°çš„æ—¥å¿—ä¿¡æ¯ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆæ‰“å¼€ï¼ˆæˆ–åˆ›å»ºï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼‰<code>log.txt</code>æ–‡ä»¶ï¼Œç„¶åå‘å…¶è¿½åŠ ä¸€è¡Œæ–°çš„æ—¥å¿—ä¿¡æ¯ï¼Œæœ€åå…³é—­æ–‡ä»¶æ¥å®Œæˆæ“ä½œã€‚</p><h4 id="ç¤ºä¾‹-2-æŒ‡å®šä½ç½®å†™å…¥æ•°æ®" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æŒ‡å®šä½ç½®å†™å…¥æ•°æ®"><span>ç¤ºä¾‹ 2: æŒ‡å®šä½ç½®å†™å…¥æ•°æ®</span></a></h4><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ªä»»åŠ¡æ˜¯æ›´æ–°ä¸€ä¸ªå­˜å‚¨é…ç½®ä¿¡æ¯çš„æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶çš„ç‰¹å®šä½ç½®å†™å…¥æˆ–ä¿®æ”¹æ•°æ®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> updateConfig</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">newConfig</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> position</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./config.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ‰“å¼€æ–‡ä»¶ç”¨äºè¯»å†™</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">newConfig</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> position</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">updateConfig</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">mode=dark</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 10</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬å‡è®¾<code>config.txt</code>å·²ç»å­˜åœ¨ï¼Œæˆ‘ä»¬æ ¹æ®ä¼ å…¥çš„ä½ç½®å‚æ•°<code>position</code>ï¼Œåœ¨æŒ‡å®šä½ç½®æ›´æ–°æ–‡ä»¶å†…å®¹ï¼Œç„¶åå…³é—­æ–‡ä»¶ã€‚</p><p>é€šè¿‡ä»¥ä¸Šç¤ºä¾‹ï¼Œä½ å¯ä»¥çœ‹å‡º<code>filehandle.write()</code>æ˜¯å¦‚ä½•åœ¨å®é™…æƒ…å¢ƒä¸­è¢«åº”ç”¨çš„ï¼Œæ— è®ºæ˜¯è¿½åŠ æ–°å†…å®¹è¿˜æ˜¯åœ¨æŒ‡å®šä½ç½®æ›´æ–°æ–‡ä»¶å†…å®¹ï¼Œå®ƒéƒ½æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ã€‚</p><h4 id="filehandle-writefile-data-options" tabindex="-1"><a class="header-anchor" href="#filehandle-writefile-data-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandlewritefiledata-options" target="_blank" rel="noopener noreferrer">filehandle.writeFile(data, options)</a></span></a></h4><p><code>filehandle.writeFile(data, options)</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå±äº File System (fs) æ¨¡å—çš„ <code>Promise</code> åŸºç¡€çš„ APIã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ å¾€ä¸€ä¸ªæŒ‡å®šçš„æ–‡ä»¶ä¸­å†™å…¥æ•°æ®ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼ŒNode.js ä¼šåˆ›å»ºè¿™ä¸ªæ–‡ä»¶ï¼ˆé™¤éå¦æœ‰æŒ‡å®šï¼‰ã€‚å¦‚æœæ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œæ­¤æ–¹æ³•é»˜è®¤ä¼šè¦†ç›–æ—§çš„å†…å®¹ã€‚</p><h3 id="å‚æ•°è§£é‡Š-2" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-2"><span>å‚æ•°è§£é‡Š</span></a></h3><ol><li><p><strong>data</strong>: è¿™ä»£è¡¨ä½ æƒ³è¦å†™å…¥æ–‡ä»¶çš„æ•°æ®ã€‚å®ƒå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€ä¸€ä¸ª Buffer å¯¹è±¡ï¼Œæˆ–è€…ä»»ä½•èƒ½è¢« <code>.toString()</code> è½¬æ¢æˆå­—ç¬¦ä¸²çš„å¯¹è±¡ã€‚</p></li><li><p><strong>options</strong> (å¯é€‰): è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥ç²¾ç»†æ§åˆ¶å¦‚ä½•å†™å…¥æ–‡ä»¶ã€‚å®ƒåŒ…å«å‡ ä¸ªå±æ€§ï¼Œå¦‚ <code>encoding</code>ï¼ˆé»˜è®¤ä¸º &#39;utf8&#39;ï¼‰ï¼Œ<code>mode</code>ï¼ˆæ–‡ä»¶ç³»ç»Ÿæƒé™ï¼Œé»˜è®¤ä¸º 0o666ï¼‰ï¼Œå’Œ <code>flag</code>ï¼ˆå†³å®šå†™å…¥è¡Œä¸ºçš„æ ‡è¯†ï¼Œé»˜è®¤ä¸º &#39;w&#39;ï¼Œä»£è¡¨â€œå†™æ¨¡å¼â€ï¼‰ã€‚</p></li></ol><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-2"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™åç«¯ï¼Œéœ€è¦ä¿å­˜ç”¨æˆ·æäº¤çš„ä¿¡æ¯åˆ°ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­ã€‚</p><h4 id="ç¤ºä¾‹-1-å†™å…¥ç®€å•æ–‡æœ¬" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-å†™å…¥ç®€å•æ–‡æœ¬"><span>ç¤ºä¾‹ 1: å†™å…¥ç®€å•æ–‡æœ¬</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> saveUserInput</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">input</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">user-input.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">input</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾ç”¨æˆ·è¾“å…¥äº† &quot;Hello, world!&quot;</span></span>
<span class="line"><span style="color:#88C0D0;">saveUserInput</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello, world!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆæ‰“å¼€ï¼ˆæˆ–åˆ›å»ºï¼‰ä¸€ä¸ªæ–‡ä»¶åä¸º <code>user-input.txt</code> çš„æ–‡ä»¶ã€‚ç„¶åä½¿ç”¨ <code>writeFile</code> æ–¹æ³•å°†ç”¨æˆ·çš„è¾“å…¥ <code>&quot;Hello, world!&quot;</code> å†™å…¥æ–‡ä»¶ã€‚æœ€åå…³é—­æ–‡ä»¶å¥æŸ„ä»¥é‡Šæ”¾èµ„æºã€‚</p><h4 id="ç¤ºä¾‹-2-ä½¿ç”¨é€‰é¡¹å†™å…¥-json-æ•°æ®" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨é€‰é¡¹å†™å…¥-json-æ•°æ®"><span>ç¤ºä¾‹ 2: ä½¿ç”¨é€‰é¡¹å†™å…¥ JSON æ•°æ®</span></a></h4><p>å‡è®¾æˆ‘ä»¬ç°åœ¨è¦ä¿å­˜ç”¨æˆ·ä¿¡æ¯çš„ JSON å¯¹è±¡ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> saveUserInfo</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">userInfo</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">user-info.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // å°†å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ ¼å¼å¹¶å†™å…¥æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">JSON</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stringify</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">userInfo</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªç”¨æˆ·ä¿¡æ¯å¯¹è±¡</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> userInfo</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">  name</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Alice</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#88C0D0;">  age</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 30</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">saveUserInfo</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">userInfo</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ç”¨æˆ·ä¿¡æ¯çš„å¯¹è±¡è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²ï¼Œå¹¶åˆ©ç”¨ <code>writeFile</code> æ–¹æ³•çš„ <code>{ encoding: &#39;utf8&#39; }</code> é€‰é¡¹ç¡®ä¿æ­£ç¡®åœ°ä»¥ UTF-8 ç¼–ç å†™å…¥æ–‡ä»¶ã€‚</p><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>filehandle.writeFile(data, options)</code> æ˜¯å¦‚ä½•åœ¨å®é™…ä¸­åº”ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†æ–‡ä»¶å†™å…¥æ“ä½œæ—¶çš„ä¾¿åˆ©æ€§å’Œçµæ´»æ€§ã€‚ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼ŒNode.js åº”ç”¨å¯ä»¥è½»æ¾åœ°ä¿å­˜å’Œç®¡ç†æ•°æ®ï¼Œæ— è®ºæ˜¯çº¯æ–‡æœ¬è¿˜æ˜¯å¤æ‚çš„å¯¹è±¡ç»“æ„ã€‚</p><h4 id="filehandle-writev-buffers-position" tabindex="-1"><a class="header-anchor" href="#filehandle-writev-buffers-position"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filehandlewritevbuffers-position" target="_blank" rel="noopener noreferrer">filehandle.writev(buffers[, position])</a></span></a></h4><p>å¥½çš„ï¼Œæˆ‘æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹ Node.js ä¸­<code>filehandle.writev(buffers[, position])</code>è¿™ä¸ªæ–¹æ³•æ˜¯ä»€ä¹ˆä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>filehandle</code>æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒä»£è¡¨äº†ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶ã€‚è¿™ä¸ªå¯¹è±¡æä¾›äº†å¤šç§è¿›è¡Œæ–‡ä»¶æ“ä½œçš„æ–¹æ³•ï¼Œå…¶ä¸­<code>writev</code>å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚</p><p><code>writev</code>æ–¹æ³•ç”¨äºå°†å¤šä¸ª<code>Buffer</code>æˆ–<code>Uint8Array</code>å¯¹è±¡ï¼ˆç»Ÿç§°ä¸ºâ€œç¼“å†²åŒºâ€ï¼‰å†™å…¥åˆ°æ–‡ä»¶ä¸­ã€‚è¿™äº›ç¼“å†²åŒºä¼šè¢«é›†åˆæˆä¸€ä¸ªæ•°ç»„ï¼Œå³æ–¹æ³•åä¸­çš„<code>buffers</code>å‚æ•°ã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>buffers</code>: è¿™æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢åŒ…å«äº†è¦å†™å…¥æ–‡ä»¶çš„ Buffer æˆ– Uint8Array å¯¹è±¡ã€‚</li><li><code>position</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºå¼€å§‹å†™å…¥æ–‡ä»¶çš„ä½ç½®ã€‚å¦‚æœçœç•¥è¿™ä¸ªå‚æ•°æˆ–è€…ä¼ å…¥ nullï¼Œé‚£ä¹ˆæ•°æ®ä¼šè¢«å†™å…¥åˆ°å½“å‰æ–‡ä»¶æŒ‡é’ˆæ‰€åœ¨çš„ä½ç½®ã€‚</li></ul><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡å‡ ä¸ªä¾‹å­æ¥çœ‹çœ‹å¦‚ä½•å®é™…åº”ç”¨<code>writev</code>ï¼š</p><h3 id="ç¤ºä¾‹-1-å‘æ–‡ä»¶å†™å…¥å¤šä¸ªæ–‡æœ¬ç‰‡æ®µ" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-å‘æ–‡ä»¶å†™å…¥å¤šä¸ªæ–‡æœ¬ç‰‡æ®µ"><span>ç¤ºä¾‹ 1ï¼šå‘æ–‡ä»¶å†™å…¥å¤šä¸ªæ–‡æœ¬ç‰‡æ®µ</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> writeMultipleBuffersToFile</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">file</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æ‰“å¼€æ–‡ä»¶å‡†å¤‡å†™å…¥</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">file</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // åˆ›å»ºå¤šä¸ªBufferï¼Œæ¯ä¸ªéƒ½åŒ…å«ä¸€æ®µæ–‡æœ¬</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> buffer1</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> buffer2</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">World </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> buffer3</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å°†è¿™äº›bufferä½œä¸ºæ•°ç»„ä¼ ç»™writevå†™å…¥åˆ°æ–‡ä»¶ä¸­</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writev</span><span style="color:#D8DEE9FF;">([</span><span style="color:#D8DEE9;">buffer1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer2</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer3</span><span style="color:#D8DEE9FF;">])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Data written successfully.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // æœ€åä¸è¦å¿˜è®°å…³é—­æ–‡ä»¶ï¼</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ä¸Šé¢çš„å‡½æ•°å†™å…¥æ•°æ®åˆ°&#39;test.txt&#39;æ–‡ä»¶ä¸­</span></span>
<span class="line"><span style="color:#88C0D0;">writeMultipleBuffersToFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">test.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆæ‰“å¼€ä¸€ä¸ªå«åš<code>test.txt</code>çš„æ–‡ä»¶ï¼Œç„¶ååˆ›å»ºä¸‰ä¸ª Bufferï¼Œåˆ†åˆ«åŒ…å«äº†å­—ç¬¦ä¸²<code>&#39;Hello &#39;</code>, <code>&#39;World &#39;</code>å’Œ<code>&#39;!&#39;</code>ã€‚é€šè¿‡<code>writev</code>æ–¹æ³•ï¼Œè¿™ä¸‰ä¸ªç¼“å†²åŒºå†…çš„æ•°æ®ä¼šè¢«é¡ºåºå†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œæœ€ç»ˆ<code>test.txt</code>æ–‡ä»¶çš„å†…å®¹å°†ä¼šæ˜¯<code>Hello World !</code>ã€‚</p><h3 id="ç¤ºä¾‹-2-æŒ‡å®šæ–‡ä»¶ä½ç½®å†™å…¥æ•°æ®" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æŒ‡å®šæ–‡ä»¶ä½ç½®å†™å…¥æ•°æ®"><span>ç¤ºä¾‹ 2ï¼šæŒ‡å®šæ–‡ä»¶ä½ç½®å†™å…¥æ•°æ®</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> writeBuffersToPosition</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">file</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">file</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // &#39;r+&#39;è¡¨ç¤ºè¯»å†™æ¨¡å¼æ‰“å¼€</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> buffers</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#D8DEE9;">Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">123</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">456</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)]</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å‡è®¾æˆ‘ä»¬æƒ³è¦ä»æ–‡ä»¶çš„ç¬¬10ä¸ªå­—èŠ‚å¤„å¼€å§‹å†™å…¥</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writev</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffers</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 10</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Data written to specific position successfully.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> filehandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">writeBuffersToPosition</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">test.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ‰“å¼€äº†ä¸€ä¸ªåä¸º<code>test.txt</code>çš„æ–‡ä»¶ï¼Œå¹¶ä¸”æƒ³å¾€ç¬¬ 10 ä¸ªå­—èŠ‚çš„ä½ç½®å†™å…¥ä¸¤ä¸ªç¼“å†²åŒº<code>[&#39;123&#39;, &#39;456&#39;]</code>çš„æ•°æ®ã€‚å¦‚æœæ–‡ä»¶åŸæ¥çš„å†…å®¹æ˜¯<code>&#39;Starting text in the file&#39;</code>ï¼Œæ‰§è¡Œå®Œæ¯•åï¼Œæ–‡ä»¶çš„å†…å®¹å°†å˜æˆ<code>&#39;Starting te123456 the file&#39;</code>ï¼Œå› ä¸ºæˆ‘ä»¬æŠŠ<code>&#39;123456&#39;</code>å†™å…¥åˆ°äº†ç¬¬ 10 ä¸ªä½ç½®ã€‚</p><p>é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œ<code>writev</code>æ–¹æ³•å¯ä»¥éå¸¸æœ‰æ•ˆåœ°å°†å¤šå—æ•°æ®èšåˆå†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œè¿™åœ¨å¤„ç†éœ€è¦å†™å…¥å¤šä¸ªç‹¬ç«‹æ•°æ®å—åˆ°åŒä¸€ä¸ªæ–‡ä»¶æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚</p><h4 id="filehandlesymbol-asyncdispose-https-nodejs-org-docs-latest-api-fs-html-filehandlesymbolasyncdispose" tabindex="-1"><a class="header-anchor" href="#filehandlesymbol-asyncdispose-https-nodejs-org-docs-latest-api-fs-html-filehandlesymbolasyncdispose"><span>[filehandle<a href="">Symbol.asyncDispose</a>](<a href="https://nodejs.org/docs/latest/api/fs.html#filehandlesymbolasyncdispose" target="_blank" rel="noopener noreferrer">https://nodejs.org/docs/latest/api/fs.html#filehandlesymbolasyncdispose</a>)</span></a></h4><p>Node.js ä¸­çš„ <code>filehandle[Symbol.asyncDispose]()</code> æ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°å¼•å…¥çš„æ–¹æ³•ï¼Œå®ƒæä¾›äº†ä¸€ç§æ›´ç°ä»£ä¸”ç¬¦åˆå¼‚æ­¥ç¼–ç¨‹é£æ ¼çš„æ–¹å¼æ¥ç¡®ä¿æ–‡ä»¶å¥æŸ„è¢«æ­£ç¡®å…³é—­ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯ä¸“é—¨ä¸ºå¤„ç†æ–‡ä»¶æ“ä½œä¸­çš„èµ„æºç®¡ç†è€Œè®¾è®¡çš„ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç†è§£å‡ ä¸ªå…³é”®æ¦‚å¿µï¼š</p><ol><li><p><strong>File Handleï¼ˆæ–‡ä»¶å¥æŸ„ï¼‰</strong>ï¼šå½“ä½ åœ¨æ“ä½œç³»ç»Ÿä¸­æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼ˆæ¯”å¦‚è¯»å–æˆ–å†™å…¥æ•°æ®ï¼‰ï¼Œæ“ä½œç³»ç»Ÿä¼šåˆ›å»ºä¸€ä¸ªâ€œæ–‡ä»¶å¥æŸ„â€ï¼Œè¿™ä¸ªå¥æŸ„å¯ä»¥çœ‹ä½œæ˜¯è¯¥æ–‡ä»¶çš„ä¸€ä¸ªä»£è¡¨æˆ–å¼•ç”¨ï¼Œé€šè¿‡å®ƒå¯ä»¥è¿›è¡Œå„ç§æ–‡ä»¶æ“ä½œã€‚</p></li><li><p><strong>Async/Awaitï¼ˆå¼‚æ­¥/ç­‰å¾…ï¼‰</strong>ï¼šåœ¨ JavaScript å’Œ Node.js ä¸­ï¼Œå¼‚æ­¥ç¼–ç¨‹æ˜¯ä¸€ç§å¤„ç†é•¿æ—¶é—´è¿è¡Œçš„æ“ä½œï¼ˆä¾‹å¦‚æ–‡ä»¶ I/Oï¼‰è€Œä¸é˜»å¡ç¨‹åºæ‰§è¡Œçš„æ–¹æ³•ã€‚<code>async</code>å’Œ<code>await</code>æ˜¯ä½¿å¼‚æ­¥ä»£ç çœ‹èµ·æ¥å’ŒåŒæ­¥ä»£ç ç±»ä¼¼çš„è¯­æ³•ç³–ã€‚</p></li><li><p><strong>Symbol.asyncDispose</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å†…ç½®ç¬¦å·ï¼Œç”¨äºå®šä¹‰ä¸€ä¸ªå¼‚æ­¥æ¸…ç†æˆ–å¤„ç½®èµ„æºçš„æ–¹æ³•ã€‚åœ¨è¿™ä¸ªä¸Šä¸‹æ–‡ä¸­ï¼Œå®ƒä¸æ–‡ä»¶å¥æŸ„ä¸€èµ·ä½¿ç”¨ï¼Œä»¥ç¡®ä¿æ–‡ä»¶åœ¨ä¸å†éœ€è¦æ—¶å¯ä»¥è¢«æ­£ç¡®ä¸”å®‰å…¨åœ°å…³é—­ã€‚</p></li></ol><p>ä¸‹é¢é€šè¿‡ä¸€ä¸ªå®é™…çš„ä¾‹å­æ¥è¯´æ˜<code>filehandle[Symbol.asyncDispose]()</code>çš„ä½¿ç”¨åœºæ™¯å’Œå¥½å¤„ï¼š</p><h3 id="å®é™…ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œè¿™ä¸ªåº”ç”¨éœ€è¦ä»ä¸€ä¸ªå¤§æ–‡ä»¶ä¸­è¯»å–æ•°æ®ã€‚åœ¨å¤„ç†æ–‡ä»¶æ—¶ï¼Œæœ€é‡è¦çš„ä¸€ç‚¹æ˜¯è¦ç¡®ä¿æ–‡ä»¶åœ¨ä½¿ç”¨å®Œæ¯•åè¢«æ­£ç¡®å…³é—­ï¼Œæ— è®ºæ˜¯æˆåŠŸå®Œæˆè¯»å–æ“ä½œè¿˜æ˜¯åœ¨è¯»å–è¿‡ç¨‹ä¸­é‡åˆ°é”™è¯¯ã€‚è¿™æ ·å¯ä»¥é¿å…èµ„æºæ³„éœ²ï¼Œå³ä¸å¿…è¦åœ°å ç”¨ç³»ç»Ÿèµ„æºã€‚</p><p>åœ¨ Node.js v21.7.1 ä¹‹å‰ï¼Œä½ å¯èƒ½ä¼šè¿™æ ·å†™ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readFileAndProcess</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // è¯»å–å¹¶å¤„ç†æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">{</span><span style="color:#88C0D0;"> encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // ä¸ç®¡æœ‰æ²¡æœ‰å¼‚å¸¸å‡ºç°ï¼Œéƒ½ç¡®ä¿æ–‡ä»¶è¢«å…³é—­</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ç§æ–¹å¼è™½ç„¶èƒ½å¤Ÿç¡®ä¿æ–‡ä»¶æœ€ç»ˆè¢«å…³é—­ï¼Œä½†éœ€è¦æ˜ç¡®è°ƒç”¨<code>close</code>æ–¹æ³•ã€‚è€Œä½¿ç”¨<code>filehandle[Symbol.asyncDispose]()</code>ä¹‹åï¼Œä»£ç å¯ä»¥å˜å¾—æ›´åŠ ç®€æ´ï¼ŒNode.js æä¾›çš„è‡ªåŠ¨èµ„æºç®¡ç†æœºåˆ¶å¯ä»¥å¸®åŠ©è‡ªåŠ¨å¤„ç†è¿™äº›äº‹æƒ…ï¼Œå°½ç®¡æˆªè‡³æˆ‘çŸ¥è¯†æ›´æ–°æ—¶ï¼ˆ2023 å¹´ï¼‰ï¼Œè¿™ä¸ª API åœ¨ Node.js æ–‡æ¡£ä¸­å¹¶æœªæ‰¾åˆ°å…·ä½“çš„ä½¿ç”¨ç¤ºä¾‹ï¼Œä½†å…¶è®¾è®¡ç›®æ ‡æ˜¯åˆ©ç”¨ JavaScript çš„å¼‚æ­¥è¿­ä»£å™¨æˆ–å…¶ä»–å¼‚æ­¥èµ„æºç®¡ç†ç‰¹æ€§ï¼Œä½¿å¾—èµ„æºæ¸…ç†é€»è¾‘è‡ªåŠ¨åŒ–ï¼Œå‡å°‘æ‰‹åŠ¨å…³é—­èµ„æºçš„éœ€è¦ã€‚</p><h3 id="ç»“è®º-1" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-1"><span>ç»“è®º</span></a></h3><p>æ€»è€Œè¨€ä¹‹ï¼Œ<code>filehandle[Symbol.asyncDispose]()</code>æ–¹æ³•çš„å¼•å…¥æ˜¯ä¸ºäº†è®© Node.js ä¸­çš„èµ„æºç®¡ç†æ›´åŠ ç°ä»£åŒ–ã€è‡ªåŠ¨åŒ–ï¼Œå‡å°‘å¼€å‘è€…åœ¨å¤„ç†æ–‡ä»¶ç­‰èµ„æºæ—¶éœ€è¦æ‰‹åŠ¨é‡Šæ”¾çš„è´Ÿæ‹…ã€‚éšç€ Node.js å’Œ JavaScript è¯­è¨€æœ¬èº«çš„ä¸æ–­è¿›åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥æœŸå¾…æ›´å¤šæ­¤ç±»ä¾¿åˆ©çš„ç‰¹æ€§å¸®åŠ©ç®€åŒ–å¼‚æ­¥ç¼–ç¨‹æ¨¡å¼ã€‚</p><h3 id="fspromises-access-path-mode" tabindex="-1"><a class="header-anchor" href="#fspromises-access-path-mode"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisesaccesspath-mode" target="_blank" rel="noopener noreferrer">fsPromises.access(path[, mode])</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œè®©å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ç¨‹åºã€‚<code>fsPromises.access()</code> æ–¹æ³•åˆ™æ˜¯ Node.js ä¸ºæ“ä½œæ–‡ä»¶ç³»ç»Ÿæä¾›çš„ä¸€ä¸ªå·¥å…·ï¼Œå±äº <code>fs/promises</code> æ¨¡å—ï¼Œè¿™é‡Œçš„ <code>fs</code> ä»£è¡¨â€œæ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰â€ï¼Œè€Œ <code>promises</code> æŒ‡çš„æ˜¯è¿™ä¸ª API è¿”å›çš„æ˜¯ Promise å¯¹è±¡ï¼Œé€‚ç”¨äºå¼‚æ­¥æ“ä½œã€‚</p><h3 id="fspromises-access-path-mode-1" tabindex="-1"><a class="header-anchor" href="#fspromises-access-path-mode-1"><span>fsPromises.access(path[, mode])</span></a></h3><p><code>fsPromises.access()</code> æ–¹æ³•ç”¨æ¥æ£€æŸ¥å½“å‰è¿è¡Œè„šæœ¬çš„ç”¨æˆ·å¯¹æŒ‡å®šè·¯å¾„ï¼ˆæ–‡ä»¶æˆ–ç›®å½•ï¼‰çš„è®¿é—®æƒé™ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒå¯ä»¥å‘Šè¯‰ä½ æ˜¯å¦æœ‰æƒè¯»å–ã€å†™å…¥æˆ–æ‰§è¡Œç»™å®šçš„æ–‡ä»¶æˆ–ç›®å½•ã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>path</code>ï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¦æ£€æŸ¥çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><code>mode</code>ï¼šæ•´æ•°ï¼Œå¯é€‰å‚æ•°ï¼ŒæŒ‡å®šè¦æ£€æŸ¥çš„æƒé™ç±»å‹ã€‚ä¸åŒçš„å€¼ä»£è¡¨ä¸åŒçš„æƒé™éœ€æ±‚ï¼Œä¾‹å¦‚ <code>fs.constants.F_OK</code>ï¼ˆæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼‰ï¼Œ<code>fs.constants.R_OK</code>ï¼ˆæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯è¯»ï¼‰ï¼Œ<code>fs.constants.W_OK</code>ï¼ˆæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯å†™ï¼‰ï¼Œä»¥åŠ <code>fs.constants.X_OK</code>ï¼ˆæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œï¼‰ã€‚å¦‚æœçœç•¥æ­¤å‚æ•°ï¼Œé»˜è®¤ä¸º <code>fs.constants.F_OK</code>ã€‚</li></ul><p>è¿”å›å€¼ï¼š</p><ul><li>è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚å¦‚æœè®¿é—®æƒé™æ£€æŸ¥é€šè¿‡ï¼ŒPromise å°†ä¼šè¢«è§£å†³ï¼ˆresolveï¼‰ä¸”ä¸å¸¦ä»»ä½•å€¼ï¼›å¦‚æœæ£€æŸ¥å¤±è´¥ï¼ŒPromise è¢«æ‹’ç»ï¼ˆrejectï¼‰ï¼Œå¹¶è¿”å›ä¸€ä¸ª Errorã€‚</li></ul><h4 id="å®é™…è¿ç”¨ç¤ºä¾‹-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-3"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h4><ol><li><strong>æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</strong></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> checkFileExists</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">access</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">F_OK</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å­˜åœ¨</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶ä¸å­˜åœ¨</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">checkFileExists</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ›¿æ¢ &#39;./example.txt&#39; ä¸ºå®é™…æ–‡ä»¶è·¯å¾„</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯è¯»</strong></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> checkFileReadable</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">access</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">R_OK</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å¯è¯»</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶ä¸å¯è¯»</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">checkFileReadable</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åŒæ ·ï¼Œæ›¿æ¢ä¸ºå®é™…çš„æ–‡ä»¶è·¯å¾„</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯å†™</strong></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> checkFileWritable</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">access</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">W_OK</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å¯å†™</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶ä¸å¯å†™</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">checkFileWritable</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ›¿æ¢æˆä½ æƒ³æ£€æŸ¥çš„æ–‡ä»¶è·¯å¾„</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>fsPromises.access()</code> æ˜¯å¦‚ä½•åœ¨å®é™…åº”ç”¨ä¸­è¿›è¡Œæ–‡ä»¶è®¿é—®æƒé™æ£€æŸ¥çš„ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ åœ¨å°è¯•è¯»å–ã€å†™å…¥æˆ–æ‰§è¡Œæ–‡ä»¶ä¹‹å‰ç¡®è®¤æ˜¯å¦æœ‰æƒé™ï¼Œä»è€Œé¿å…åœ¨å®é™…æ“ä½œæ—¶äº§ç”Ÿé”™è¯¯ã€‚</p><h3 id="fspromises-appendfile-path-data-options" tabindex="-1"><a class="header-anchor" href="#fspromises-appendfile-path-data-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisesappendfilepath-data-options" target="_blank" rel="noopener noreferrer">fsPromises.appendFile(path, data[, options])</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æ˜¯ç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ä¸€ä¸ªå†…ç½®æ¨¡å—ã€‚è¿™ä¸ªæ¨¡å—æä¾›äº†ä¸€å¥—ç”¨äºæ–‡ä»¶æ“ä½œçš„ APIï¼Œæ¯”å¦‚è¯»å–ã€å†™å…¥ã€åˆ é™¤æ–‡ä»¶ç­‰ã€‚è€Œ <code>fsPromises</code> æ˜¯ <code>fs</code> æ¨¡å—çš„ Promise ç‰ˆæœ¬ï¼Œå®ƒæä¾›äº†è¿”å› promise çš„æ–¹æ³•ï¼Œä½¿å¾—ä½ å¯ä»¥ä½¿ç”¨ async/await æ¥å¤„ç†å¼‚æ­¥æ–‡ä»¶æ“ä½œï¼Œè€Œä¸éœ€è¦ä¾èµ–å›è°ƒå‡½æ•°ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘å°†è¯¦ç»†è§£é‡Š <code>fsPromises.appendFile</code> æ–¹æ³•ï¼Œå¹¶ç»™å‡ºä¸€äº›å®é™…çš„è¿ç”¨ä¾‹å­ã€‚</p><h3 id="fspromises-appendfile-path-data-options-1" tabindex="-1"><a class="header-anchor" href="#fspromises-appendfile-path-data-options-1"><span><code>fsPromises.appendFile(path, data[, options])</code></span></a></h3><ul><li><p><strong>åŠŸèƒ½</strong>ï¼šè¿™ä¸ªæ–¹æ³•ç”¨äºå¼‚æ­¥åœ°è¿½åŠ æ•°æ®åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºè¯¥æ–‡ä»¶ã€‚</p></li><li><p><strong>å‚æ•°</strong>ï¼š</p><ul><li><code>path</code>ï¼šä¸€ä¸ªå­—ç¬¦ä¸²æˆ– <code>Buffer</code> æˆ– <code>URL</code>ï¼Œè¡¨ç¤ºè¦è¿½åŠ å†…å®¹çš„æ–‡ä»¶è·¯å¾„ã€‚</li><li><code>data</code>ï¼šä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…ä¸€ä¸ª <code>Buffer</code>ï¼Œè¡¨ç¤ºè¦è¿½åŠ åˆ°æ–‡ä»¶çš„å†…å®¹ã€‚</li><li><code>options</code>ï¼ˆå¯é€‰ï¼‰ï¼šä¸€ä¸ªå¯¹è±¡æˆ–å­—ç¬¦ä¸²ï¼Œç”¨æ¥æŒ‡å®šæ–‡ä»¶çš„ç¼–ç å’Œæ¨¡å¼ï¼ˆä¾‹å¦‚ <code>mode</code>ï¼‰ï¼Œä»¥åŠæ ‡å¿—ï¼ˆä¾‹å¦‚ <code>flag</code>ï¼‰ã€‚å¦‚æœ <code>options</code> æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™å®ƒæŒ‡å®šå­—ç¬¦ç¼–ç ã€‚</li></ul></li><li><p><strong>è¿”å›å€¼</strong>ï¼šä¸€ä¸ª <code>Promise</code>ï¼Œå½“æ–‡ä»¶è¿½åŠ æ“ä½œå®Œæˆæ—¶ï¼Œè¿™ä¸ª Promise ä¼šè¢«è§£å†³ï¼ˆresolvedï¼‰ã€‚</p></li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-4"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªæ—¥è®°åº”ç”¨ï¼Œç”¨æˆ·æ¯æ¬¡è¾“å…¥ä¸€æ®µæ–‡å­—ï¼Œä½ å°±éœ€è¦å°†è¿™æ®µæ–‡å­—è¿½åŠ åˆ°ä»–ä»¬çš„æ—¥è®°æ–‡ä»¶ä¸­ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>fsPromises.appendFile</code> æ–¹æ³•æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚</p><h4 id="ç¤ºä¾‹ä»£ç -2" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç -2"><span>ç¤ºä¾‹ä»£ç ï¼š</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./userDiary.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ—¥è®°æ–‡ä»¶çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> entry</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">2023-04-01: ä»Šå¤©å¤©æ°”çœŸå¥½ã€‚</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // ç”¨æˆ·è¾“å…¥çš„æ—¥è®°å†…å®¹</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> appendDiaryEntry</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> content</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">appendFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> content</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ—¥è®°å†…å®¹è¿½åŠ æˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ— æ³•è¿½åŠ å†…å®¹åˆ°æ—¥è®°æ–‡ä»¶:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">appendDiaryEntry</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> entry</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ol><li>æˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† <code>fs</code> æ¨¡å—çš„ promises APIã€‚</li><li>å®šä¹‰äº†æ—¥è®°æ–‡ä»¶çš„è·¯å¾„å’Œç”¨æˆ·çš„æ—¥è®°æ¡ç›®ã€‚</li><li>å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° <code>appendDiaryEntry</code>ï¼Œè¯¥å‡½æ•°ä½¿ç”¨ <code>fsPromises.appendFile</code> æ–¹æ³•æ¥è¿½åŠ å†…å®¹åˆ°æ—¥è®°æ–‡ä»¶ä¸­ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œæ§åˆ¶å°ä¼šè¾“å‡ºæˆåŠŸæ¶ˆæ¯ï¼›å¦‚æœå¤±è´¥ï¼Œä¼šæ•è·é”™è¯¯å¹¶è¾“å‡ºã€‚</li></ol><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨ Node.js åº”ç”¨ä¸­å®ç°æ–‡ä»¶çš„è¿½åŠ å†™å…¥æ“ä½œï¼Œè¿™å¯¹äºéœ€è¦è®°å½•æ—¥å¿—ã€ç”¨æˆ·æ•°æ®æˆ–å…¶ä»–å½¢å¼é€æ¸å¢é•¿æ–‡ä»¶çš„åº”ç”¨ç‰¹åˆ«æœ‰ç”¨ã€‚</p><h3 id="fspromises-chmod-path-mode" tabindex="-1"><a class="header-anchor" href="#fspromises-chmod-path-mode"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromiseschmodpath-mode" target="_blank" rel="noopener noreferrer">fsPromises.chmod(path, mode)</a></span></a></h3><p>å½“ä½ å¼€å§‹ä½¿ç”¨ Node.js å¼€å‘åº”ç”¨ç¨‹åºæ—¶ï¼Œä½ ä¼šå‘ç°å®ƒæä¾›äº†ä¸€ç³»åˆ—çš„ API æ¥å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ“ä½œã€‚è¿™å…¶ä¸­ï¼Œ<code>fsPromises.chmod(path, mode)</code>æ˜¯ä¸€ä¸ªåœ¨ Node.js ä¸­éå¸¸æœ‰ç”¨çš„å‡½æ•°ï¼Œå®ƒå…è®¸ä½ æ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ã€‚åœ¨ Unix-likeï¼ˆç±» Unixï¼‰æ“ä½œç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶æˆ–ç›®å½•éƒ½æœ‰ä¸ä¹‹ç›¸å…³è”çš„æƒé™è®¾ç½®ï¼Œå†³å®šäº†è°å¯ä»¥è¯»ã€å†™æˆ–æ‰§è¡Œè¯¥æ–‡ä»¶ã€‚</p><h3 id="è§£é‡Š-fspromises-chmod-path-mode" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-fspromises-chmod-path-mode"><span>è§£é‡Š <code>fsPromises.chmod(path, mode)</code></span></a></h3><ul><li><strong>path</strong>: è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼ŒæŒ‡å®šäº†è¦æ›´æ”¹æƒé™çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><strong>mode</strong>: è¿™æ˜¯ä¸€ä¸ªæ•´æ•°å‚æ•°ï¼ŒæŒ‡å®šäº†æ–‡ä»¶æˆ–ç›®å½•çš„æ–°æƒé™ã€‚é€šå¸¸ï¼Œè¿™ä¸ªæƒé™å€¼æ˜¯å…«è¿›åˆ¶ï¼ˆä»¥ 0 å¼€å¤´çš„æ•°å­—ï¼‰è¡¨ç¤ºçš„ï¼Œæ¯”å¦‚ <code>0o755</code>ã€‚</li></ul><p>æƒé™æ¨¡å¼<code>mode</code>çš„æ„æˆåŸºäºä¸‰ç»„æƒé™ï¼š<strong>æ‰€æœ‰è€…(owner)</strong>ã€<strong>ç»„(group)</strong> å’Œ <strong>å…¶ä»–(other)</strong> çš„æƒé™ã€‚æ¯ç»„åŒ…å«ä¸‰ä¸ªæƒé™ï¼šè¯»ï¼ˆrï¼‰ã€å†™ï¼ˆwï¼‰å’Œæ‰§è¡Œï¼ˆxï¼‰ã€‚ä¸¾ä¾‹æ¥è¯´ï¼š</p><ul><li><strong>7</strong> (äºŒè¿›åˆ¶ 111) ä»£è¡¨è¯»ã€å†™ã€æ‰§è¡Œï¼ˆrwxï¼‰</li><li><strong>6</strong> (äºŒè¿›åˆ¶ 110) ä»£è¡¨è¯»ã€å†™ï¼ˆrw-ï¼‰</li><li><strong>5</strong> (äºŒè¿›åˆ¶ 101) ä»£è¡¨è¯»ã€æ‰§è¡Œï¼ˆr-xï¼‰</li><li><strong>4</strong> (äºŒè¿›åˆ¶ 100) ä»£è¡¨åªè¯»ï¼ˆr--ï¼‰</li></ul><p><code>fsPromises</code>æ˜¯ Node.js ä¸­<code>fs</code>æ¨¡å—çš„ Promise ç‰ˆæœ¬ã€‚å®ƒå…è®¸ä½ ä»¥å¼‚æ­¥æ–¹å¼ä½¿ç”¨ Promise API æ¥å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼Œè€Œä¸æ˜¯ä½¿ç”¨ä¼ ç»Ÿçš„å›è°ƒå‡½æ•°ã€‚è¿™ä½¿å¾—ä»£ç æ›´åŠ ç®€æ´å’Œæ˜“äºç†è§£ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-4"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º<code>example.txt</code>çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬æƒ³è¦æ›´æ”¹å…¶æƒé™ï¼Œä½¿å¾—æ‰€æœ‰è€…å¯ä»¥è¯»ã€å†™å’Œæ‰§è¡Œï¼Œè€Œç»„æˆå‘˜å’Œå…¶ä»–ç”¨æˆ·åªèƒ½è¯»å’Œæ‰§è¡Œã€‚</p><ol><li><strong>å¼•å…¥æ‰€éœ€æ¨¡å—</strong>:</li></ol><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥<code>fs/promises</code>æ¨¡å—ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½ä½¿ç”¨<code>chmod</code>å‡½æ•°ã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li><strong>æ›´æ”¹æ–‡ä»¶æƒé™</strong>:</li></ol><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<code>fsPromises.chmod</code>æ¥æ›´æ”¹<code>example.txt</code>çš„æƒé™ã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> changeFilePermissions</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">chmod</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0o755</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Permissions changed successfully.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error changing permissions:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨å‡½æ•°</span></span>
<span class="line"><span style="color:#88C0D0;">changeFilePermissions</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•°<code>changeFilePermissions</code>ï¼Œå®ƒå°è¯•å°†<code>example.txt</code>çš„æƒé™æ›´æ”¹ä¸º<code>0o755</code>ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œå®ƒå°†æ‰“å°ä¸€æ¡æ¶ˆæ¯è¡¨ç¤ºæƒé™å·²ç»æˆåŠŸæ›´æ”¹ï¼›å¦‚æœå‡ºç°é”™è¯¯ï¼Œå®ƒå°†æ•è·é”™è¯¯å¹¶æ‰“å°å‡ºæ¥ã€‚</p><h3 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡ä½¿ç”¨<code>fsPromises.chmod(path, mode)</code>ï¼Œä½ å¯ä»¥æ–¹ä¾¿åœ°æ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ï¼Œä»è€Œæ§åˆ¶ä¸åŒç”¨æˆ·å¯¹æ–‡ä»¶çš„è®¿é—®çº§åˆ«ã€‚è¿™åœ¨ç®¡ç† Web æœåŠ¡å™¨æˆ–ä»»ä½•éœ€è¦ç»†ç²’åº¦è®¿é—®æ§åˆ¶çš„åº”ç”¨ä¸­å°¤å…¶æœ‰ç”¨ã€‚è®°ä½ï¼Œåˆç†è®¾ç½®æ–‡ä»¶æƒé™æ˜¯ä¿æŠ¤ç³»ç»Ÿå®‰å…¨çš„é‡è¦ä¸€ç¯ã€‚</p><h3 id="fspromises-chown-path-uid-gid" tabindex="-1"><a class="header-anchor" href="#fspromises-chown-path-uid-gid"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromiseschownpath-uid-gid" target="_blank" rel="noopener noreferrer">fsPromises.chown(path, uid, gid)</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“è¿è¡Œçš„ JavaScript ç¯å¢ƒï¼Œå®ƒä½¿å¾—å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚Node.js æä¾›äº†å¾ˆå¤šæ¨¡å—ï¼ˆmodulesï¼‰ï¼Œå…¶ä¸­ <code>fs</code> æ¨¡å—æ˜¯ç”¨æ¥è¿›è¡Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„ï¼Œå¦‚è¯»å†™æ–‡ä»¶ã€æ›´æ”¹æ–‡ä»¶æƒé™ç­‰ã€‚</p><p>åœ¨ <code>fs</code> æ¨¡å—ä¸­ï¼Œæœ‰ä¸€ä¸ª <code>fsPromises</code> çš„æ¥å£ï¼Œè¿™ä¸ªæ¥å£æä¾›äº†è¿”å› promise å¯¹è±¡çš„æ–¹æ³•ï¼Œä»¥ä¾¿å¯ä»¥ä½¿ç”¨ async/await æ¥å¤„ç†å¼‚æ­¥æ“ä½œã€‚<code>fsPromises.chown(path, uid, gid)</code> æ˜¯è¿™äº›æ–¹æ³•ä¹‹ä¸€ï¼Œç”¨äºæ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰è€…ã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>path</code>: è¦æ›´æ”¹æ‰€æœ‰è€…çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><code>uid</code>: ç”¨æˆ· ID, åœ¨ UNIX ç³»ç»Ÿä¸­ï¼Œè¿™ä»£è¡¨äº†æ–‡ä»¶æˆ–ç›®å½•çš„æ–°æ‹¥æœ‰è€…çš„æ•°å­—æ ‡è¯†ã€‚</li><li><code>gid</code>: ç»„ ID, åŒæ ·åœ¨ UNIX ç³»ç»Ÿä¸­ï¼Œè¿™ä»£è¡¨äº†æ–‡ä»¶æˆ–ç›®å½•å½’å±çš„æ–°ç»„çš„æ•°å­—æ ‡è¯†ã€‚</li></ul><p>ä¸‹é¢é€šè¿‡å‡ ä¸ªå®é™…çš„ä¾‹å­æ¥è§£é‡Šå¦‚ä½•ä½¿ç”¨ <code>fsPromises.chown</code>ï¼š</p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º &quot;example.txt&quot; çš„æ–‡ä»¶ï¼Œå¹¶ä¸”æˆ‘ä»¬æƒ³æŠŠè¿™ä¸ªæ–‡ä»¶çš„æ‰€æœ‰è€…æ”¹ä¸ºç”¨æˆ· ID ä¸º 1000 çš„ç”¨æˆ·ï¼Œç»„ ID ä¸º 2000 çš„ç»„ã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦ç¡®ä¿ä½ åœ¨ Node.js v21.7.1 æˆ–æ›´é«˜ç‰ˆæœ¬çš„ç¯å¢ƒä¸‹å·¥ä½œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> changeOwner</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> userId</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> groupId</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">chown</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> userId</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> groupId</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ‰€æœ‰æƒå·²æ›´æ”¹ä¸ºç”¨æˆ·IDï¼š</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">userId</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> å’Œç»„ID: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">groupId</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ›´æ”¹æ‰€æœ‰æƒæ—¶å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨å‡½æ•°æ›´æ”¹ &#39;example.txt&#39; æ–‡ä»¶çš„æ‰€æœ‰æƒ</span></span>
<span class="line"><span style="color:#88C0D0;">changeOwner</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1000</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 2000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª <code>changeOwner</code> å‡½æ•°ï¼Œå®ƒæ¥å—æ–‡ä»¶è·¯å¾„ã€ç”¨æˆ· ID å’Œç»„ ID ä½œä¸ºå‚æ•°ã€‚æˆ‘ä»¬ä½¿ç”¨ <code>await</code> å…³é”®å­—æ¥ç­‰å¾… <code>fsPromises.chown</code> æ–¹æ³•çš„æ‰§è¡Œç»“æœï¼Œå¦‚æœæ›´æ”¹æˆåŠŸï¼Œåˆ™ä¼šæ‰“å°ä¸€æ¡æ¶ˆæ¯ï¼Œå¦‚æœå‡ºç°é”™è¯¯ï¼Œå°†æ•è·å¼‚å¸¸å¹¶æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚</p><p>è¯·æ³¨æ„ï¼Œæ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰è€…æ˜¯ä¸€ä¸ªæ•æ„Ÿæ“ä½œï¼Œé€šå¸¸éœ€è¦ç®¡ç†å‘˜æƒé™ã€‚å¦‚æœä½ å°è¯•è¿è¡Œè¿™æ®µä»£ç æ²¡æœ‰ç›¸åº”æƒé™ï¼Œå¯èƒ½ä¼šé‡åˆ°é”™è¯¯ã€‚</p><p>æ­¤å¤–ï¼Œä¸åŒçš„æ“ä½œç³»ç»Ÿå¯èƒ½å¯¹ç”¨æˆ· ID å’Œç»„ ID æœ‰ä¸åŒçš„æŒ‡å®šæ–¹å¼ã€‚åœ¨é UNIX ç³»ç»Ÿï¼ˆå¦‚ Windowsï¼‰ä¸Šï¼Œè¿™äº›æ¦‚å¿µå¯èƒ½ä¸é€‚ç”¨ï¼Œå› æ­¤è¯¥åŠŸèƒ½å¯èƒ½ä¸èµ·ä½œç”¨æˆ–æœ‰ä¸åŒçš„è¡Œä¸ºã€‚</p><h3 id="fspromises-copyfile-src-dest-mode" tabindex="-1"><a class="header-anchor" href="#fspromises-copyfile-src-dest-mode"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisescopyfilesrc-dest-mode" target="_blank" rel="noopener noreferrer">fsPromises.copyFile(src, dest[, mode])</a></span></a></h3><p>Node.js ä¸­çš„ <code>fsPromises.copyFile(src, dest[, mode])</code> æ–¹æ³•æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„åŠŸèƒ½ï¼Œå®ƒå±äº Node.js çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰æ¨¡å—ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ ä»¥å¼‚æ­¥çš„æ–¹å¼å¤åˆ¶æ–‡ä»¶ï¼Œæ„å‘³ç€åœ¨æ‰§è¡Œæ–‡ä»¶å¤åˆ¶æ“ä½œæ—¶ï¼Œä½ çš„ç¨‹åºå¯ä»¥ç»§ç»­è¿›è¡Œå…¶ä»–ä»»åŠ¡ï¼Œè€Œä¸éœ€è¦ç­‰å¾…å¤åˆ¶è¿‡ç¨‹å®Œæˆã€‚ç°åœ¨ï¼Œæˆ‘å°†è¯¦ç»†è§£é‡Šè¿™ä¸ªæ–¹æ³•ï¼Œå¹¶ç»™å‡ºä¸€äº›å®é™…çš„ä½¿ç”¨ä¾‹å­ã€‚</p><h3 id="ç†è§£å‡½æ•°å‚æ•°" tabindex="-1"><a class="header-anchor" href="#ç†è§£å‡½æ•°å‚æ•°"><span>ç†è§£å‡½æ•°å‚æ•°</span></a></h3><ul><li><strong>src (source)</strong>: æºæ–‡ä»¶è·¯å¾„ï¼Œå³ä½ æƒ³è¦å¤åˆ¶çš„æ–‡ä»¶ã€‚</li><li><strong>dest (destination)</strong>: ç›®æ ‡æ–‡ä»¶è·¯å¾„ï¼Œå³æ–‡ä»¶å¤åˆ¶åçš„æ–°ä½ç½®å’Œåç§°ã€‚</li><li><strong>mode (optional)</strong>: å¯é€‰å‚æ•°ï¼Œç”¨äºæŒ‡å®šå¤åˆ¶æ“ä½œçš„è¡Œä¸ºæ¨¡å¼ã€‚å®ƒå†³å®šäº†åœ¨ç‰¹å®šæƒ…å†µä¸‹å¦‚ä½•å¤„ç†æ–‡ä»¶å¤åˆ¶ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥è®¾ç½®å®ƒæ¥è¦†ç›–ç›®æ ‡ä½ç½®çš„ç°æœ‰æ–‡ä»¶æˆ–é˜²æ­¢è¦†ç›–ã€‚</li></ul><h3 id="å‡½æ•°ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#å‡½æ•°ä½¿ç”¨"><span>å‡½æ•°ä½¿ç”¨</span></a></h3><p>åœ¨ä½¿ç”¨ <code>fsPromises.copyFile()</code> ä¹‹å‰ï¼Œä½ éœ€è¦å¯¼å…¥ <code>fs</code> æ¨¡å—ï¼Œå¹¶ä¸”ä½¿ç”¨è¯¥æ¨¡å—çš„ promises APIï¼Œä»¥ä¾¿èƒ½å¤Ÿä½¿ç”¨åŸºäº Promise çš„æ–¹æ³•ï¼Œè¿™å°†ä½¿å¼‚æ­¥ä»£ç çš„ç¼–å†™æ›´åŠ æ–¹ä¾¿å’Œæ˜“äºç®¡ç†ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å¯¼å…¥ fs æ¨¡å—çš„ promises API</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-1-åŸºæœ¬çš„æ–‡ä»¶å¤åˆ¶æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åŸºæœ¬çš„æ–‡ä»¶å¤åˆ¶æ“ä½œ"><span>ç¤ºä¾‹ 1ï¼šåŸºæœ¬çš„æ–‡ä»¶å¤åˆ¶æ“ä½œ</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬æƒ³å°†å…¶å¤åˆ¶åˆ°å½“å‰ç›®å½•ä¸‹çš„æ–°æ–‡ä»¶ <code>copy_of_example.txt</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> copyFile</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">copyFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">copy_of_example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å¤åˆ¶æˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å¤åˆ¶æ–‡ä»¶è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">copyFile</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•å¼‚æ­¥åœ°å¤åˆ¶æ–‡ä»¶ï¼Œå¹¶é€šè¿‡ <code>try...catch</code> ç»“æ„å¤„ç†å¯èƒ½å‘ç”Ÿçš„é”™è¯¯ã€‚</p><h4 id="ç¤ºä¾‹-2-ä½¿ç”¨-mode-å‚æ•°" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨-mode-å‚æ•°"><span>ç¤ºä¾‹ 2ï¼šä½¿ç”¨ <code>mode</code> å‚æ•°</span></a></h4><p>å¦‚æœä½ æƒ³è¦åœ¨å¤åˆ¶æ–‡ä»¶æ—¶ç¡®ä¿ä¸è¦†ç›–å·²å­˜åœ¨çš„æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>mode</code> å‚æ•°ã€‚è™½ç„¶åœ¨ Node.js v21.7.1 çš„å®˜æ–¹æ–‡æ¡£ä¸­å¯èƒ½æ²¡æœ‰ç›´æ¥æä¾›å¦‚ä½•è®¾ç½® <code>mode</code> æ¥é˜²æ­¢è¦†ç›–ï¼Œä½†é€šå¸¸åœ¨ç±»ä¼¼åœºæ™¯ä¸­ï¼Œäººä»¬ä¼šä½¿ç”¨æ–‡ä»¶çš„è¯»å†™æƒé™æ¥æ§åˆ¶è¿™ç§è¡Œä¸ºã€‚å¯¹äºæ­¤ç§é«˜çº§ç”¨æ³•ï¼Œè¯·å‚è€ƒæœ€æ–°çš„å®˜æ–¹æ–‡æ¡£ï¼Œå› ä¸ºå¯ç”¨çš„ <code>mode</code> å¸¸é‡å’Œè¡Œä¸ºå¯èƒ½ä¼šéšç‰ˆæœ¬æ›´æ–°è€Œå˜åŒ–ã€‚</p><h3 id="æ€»ç»“-1" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-1"><span>æ€»ç»“</span></a></h3><p><code>fsPromises.copyFile(src, dest[, mode])</code> æä¾›äº†ä¸€ä¸ªç®€å•è€Œå¼ºå¤§çš„å¼‚æ­¥æ¥å£æ¥å¤åˆ¶æ–‡ä»¶ï¼Œä½¿å¾—åœ¨è¿›è¡Œ IO å¯†é›†å‹æ“ä½œæ—¶ï¼Œä½ çš„ç¨‹åºä»ç„¶ä¿æŒå“åº”ã€‚é€šè¿‡æœ‰æ•ˆåœ°åˆ©ç”¨ JavaScript çš„å¼‚æ­¥ç‰¹æ€§å’Œ Promiseï¼Œä½ å¯ä»¥è½»æ¾åœ°åœ¨ä½ çš„åº”ç”¨ä¸­æ•´åˆæ–‡ä»¶å¤åˆ¶åŠŸèƒ½ï¼Œæ— è®ºæ˜¯åœ¨ç®€å•çš„è„šæœ¬ä¸­è¿˜æ˜¯åœ¨æ›´å¤æ‚çš„åº”ç”¨ç¨‹åºä¸­ã€‚</p><h3 id="fspromises-cp-src-dest-options" tabindex="-1"><a class="header-anchor" href="#fspromises-cp-src-dest-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisescpsrc-dest-options" target="_blank" rel="noopener noreferrer">fsPromises.cp(src, dest[, options])</a></span></a></h3><p>å½“ç„¶ã€‚Node.js æ˜¯ä¸€ä¸ªè¿è¡ŒäºæœåŠ¡å™¨ç«¯çš„ JavaScript ç¯å¢ƒï¼Œåˆ©ç”¨äº‹ä»¶é©±åŠ¨ã€éé˜»å¡å¼ I/Oï¼ˆè¾“å…¥/è¾“å‡ºï¼‰ç­‰ç‰¹æ€§ï¼Œä½¿å…¶éå¸¸é€‚åˆå¼€å‘æ•°æ®å¯†é›†å‹çš„å®æ—¶åº”ç”¨ç¨‹åºã€‚<code>fsPromises.cp(src, dest[, options])</code> å‡½æ•°æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒå…è®¸ä½ ä»¥å¼‚æ­¥ï¼ˆPromise å½¢å¼ï¼‰çš„æ–¹å¼å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨ä¸é˜»å¡ä¸»çº¿ç¨‹çš„æƒ…å†µä¸‹æ‰§è¡Œå¤åˆ¶æ“ä½œï¼Œå¹¶ä¸”èƒ½å¤Ÿä½¿ç”¨ <code>then/catch</code> æˆ–è€… <code>async/await</code> è¯­æ³•æ¥å¤„ç†æˆåŠŸæˆ–å¤±è´¥çš„ç»“æœã€‚</p><h3 id="å‚æ•°è§£é‡Š-3" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-3"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><strong>src</strong>: æºè·¯å¾„ï¼Œä½ æƒ³è¦å¤åˆ¶çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><strong>dest</strong>: ç›®æ ‡è·¯å¾„ï¼Œä½ å¸Œæœ›å°†æ–‡ä»¶æˆ–ç›®å½•å¤åˆ¶åˆ°çš„æ–°ä½ç½®ã€‚</li><li><strong>options</strong>: æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…è®¸é¢å¤–é…ç½®å¤åˆ¶æ“ä½œã€‚ä¾‹å¦‚ï¼š <ul><li><code>dereference</code>: å¸ƒå°”å€¼ï¼Œé»˜è®¤ä¸º <code>false</code>ã€‚å½“è®¾ç½®ä¸º <code>true</code> æ—¶ï¼Œä¼šå–æ¶ˆå¯¹ç¬¦å·é“¾æ¥çš„å¼•ç”¨ï¼Œå³å¤åˆ¶é“¾æ¥æ‰€æŒ‡å‘çš„å®é™…æ–‡ä»¶ã€‚</li><li><code>errorOnExist</code>: å¸ƒå°”å€¼ï¼Œé»˜è®¤ä¸º <code>false</code>ã€‚å¦‚æœè®¾ç½®ä¸º <code>true</code> å¹¶ä¸”ç›®æ ‡è·¯å¾„å·²å­˜åœ¨ï¼Œå¤åˆ¶æ“ä½œä¼šæŠ›å‡ºé”™è¯¯ã€‚</li><li><code>preserveTimestamps</code>: å¸ƒå°”å€¼ï¼Œé»˜è®¤ä¸º <code>false</code>ã€‚å¦‚æœè®¾ç½®ä¸º <code>true</code>ï¼Œå°†ä¼šä¿ç•™åŸæ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´å’Œè®¿é—®æ—¶é—´ã€‚</li><li><code>recursive</code>: å¸ƒå°”å€¼ï¼Œé»˜è®¤ä¸º <code>false</code>ã€‚å¦‚æœæºè·¯å¾„æ˜¯ç›®å½•ï¼Œéœ€è¦å°†æ­¤é€‰é¡¹è®¾ç½®ä¸º <code>true</code> æ¥ç¡®ä¿ç›®å½•åŠå…¶å†…å®¹è¢«é€’å½’å¤åˆ¶ã€‚</li></ul></li></ul><h3 id="å®è·µä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®è·µä¾‹å­"><span>å®è·µä¾‹å­</span></a></h3><h4 id="å¤åˆ¶æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#å¤åˆ¶æ–‡ä»¶"><span>å¤åˆ¶æ–‡ä»¶</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º &quot;source.txt&quot; çš„æ–‡ä»¶ï¼Œä½ æƒ³è¦å°†å…¶å¤åˆ¶åˆ°åŒä¸€ç›®å½•ä¸‹ï¼Œæ–°æ–‡ä»¶å‘½åä¸º &quot;copy_of_source.txt&quot;ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> copyFile</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">cp</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">source.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">copy_of_source.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å¤åˆ¶æˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å¤åˆ¶è¿‡ç¨‹ä¸­å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">copyFile</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="é€’å½’å¤åˆ¶ç›®å½•" tabindex="-1"><a class="header-anchor" href="#é€’å½’å¤åˆ¶ç›®å½•"><span>é€’å½’å¤åˆ¶ç›®å½•</span></a></h4><p>å¦‚æœä½ æƒ³å¤åˆ¶æ•´ä¸ªç›®å½•åŠå…¶å†…å®¹ï¼Œä½ éœ€è¦å°† <code>recursive</code> é€‰é¡¹è®¾ä¸º <code>true</code>ã€‚</p><p>å‡è®¾æœ‰ä¸€ä¸ªåä¸º &quot;sourceDir&quot; çš„ç›®å½•ï¼Œä½ æƒ³å°†å…¶å®Œæ•´åœ°å¤åˆ¶åˆ°åä¸º &quot;copyOfSourceDir&quot; çš„æ–°ç›®å½•ä¸­ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> copyDirectory</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">cp</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">sourceDir</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">copyOfSourceDir</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> recursive</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•å¤åˆ¶æˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å¤åˆ¶è¿‡ç¨‹ä¸­å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">copyDirectory</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä¸Šè¿°ç¤ºä¾‹ï¼Œä½ å¯ä»¥è§åˆ° <code>fsPromises.cp()</code> æ–¹æ³•å¦‚ä½•åœ¨å®é™…åº”ç”¨ä¸­è¢«ç”¨äºå¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•ã€‚è¿™ç§åŸºäº Promise çš„æ–¹æ³•è®©æˆ‘ä»¬èƒ½å¤Ÿç”¨æ›´æ¸…æ™°ã€ç›´è§‚çš„æ–¹å¼å¤„ç†å¼‚æ­¥æ“ä½œï¼ŒåŒæ—¶é€šè¿‡æ•è·å¼‚å¸¸æ¥å¤„ç†é”™è¯¯ï¼Œç¡®ä¿ä»£ç çš„å¥å£®æ€§ã€‚</p><h3 id="fspromises-lchmod-path-mode" tabindex="-1"><a class="header-anchor" href="#fspromises-lchmod-path-mode"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromiseslchmodpath-mode" target="_blank" rel="noopener noreferrer">fsPromises.lchmod(path, mode)</a></span></a></h3><p><code>fsPromises.lchmod(path, mode)</code> æ˜¯ <code>Node.js</code> ä¸­çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå±äºæ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code> æ¨¡å—ï¼‰ä¸­çš„ <code>Promises</code> API çš„ä¸€éƒ¨åˆ†ã€‚åœ¨è§£é‡Šè¿™ä¸ªåŠŸèƒ½ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆæ¥ç®€å•äº†è§£ä¸‹å‡ ä¸ªå…³é”®æ¦‚å¿µï¼š</p><ol><li><p><strong><code>fs</code> æ¨¡å—</strong>ï¼šè¿™æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚å®ƒå¯ä»¥å¸®åŠ©ä½ åˆ›å»ºã€è¯»å–ã€å†™å…¥å’Œåˆ é™¤æ–‡ä»¶ç­‰ã€‚</p></li><li><p><strong>Promises API</strong>ï¼šPromise æ˜¯ä¸€ä¸ªä»£è¡¨å¼‚æ­¥æ“ä½œæœ€ç»ˆå®Œæˆæˆ–å¤±è´¥çš„å¯¹è±¡ã€‚åœ¨ <code>fs</code> æ¨¡å—ä¸­ï¼Œ<code>Promises API</code> æä¾›äº†ä¸€ç§æ›´ç°ä»£ä¸”æ›´æ˜“äºä½¿ç”¨çš„æ–¹å¼æ¥å¤„ç†å¼‚æ­¥æ“ä½œï¼Œç›¸æ¯”ä¼ ç»Ÿçš„å›è°ƒå‡½æ•°æ–¹æ³•ã€‚</p></li><li><p><strong><code>lchmod</code> åŠŸèƒ½</strong>ï¼šè¿™ä¸ªåŠŸèƒ½ç”¨äºæ”¹å˜ä¸€ä¸ªé“¾æ¥æ–‡ä»¶æœ¬èº«çš„æƒé™ï¼Œè€Œä¸æ˜¯å®ƒæŒ‡å‘çš„ç›®æ ‡æ–‡ä»¶çš„æƒé™ã€‚<code>path</code> å‚æ•°æŒ‡çš„æ˜¯é“¾æ¥æ–‡ä»¶çš„è·¯å¾„ï¼Œ<code>mode</code> å‚æ•°åˆ™æŒ‡å®šäº†æ–‡ä»¶çš„æ–°æƒé™ã€‚</p></li></ol><p>ç„¶è€Œï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ<code>lchmod</code> åœ¨å¾ˆå¤šç³»ç»Ÿä¸Šå¹¶ä¸æ”¯æŒï¼Œç‰¹åˆ«æ˜¯åœ¨ Windows ç³»ç»Ÿä¸Šï¼Œå› ä¸ºé“¾æ¥æ–‡ä»¶çš„æƒé™é€šå¸¸ä¸å®ƒä»¬æ‰€æŒ‡å‘çš„ç›®æ ‡æ–‡ä»¶ç›¸å…³ï¼Œå¹¶ä¸éœ€è¦ç‹¬ç«‹è®¾ç½®ã€‚</p><h3 id="ä¸¾ä¸ªä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä¸¾ä¸ªä¾‹å­"><span>ä¸¾ä¸ªä¾‹å­</span></a></h3><p>å‡è®¾åœ¨ä¸€ä¸ªæ”¯æŒ <code>lchmod</code> åŠŸèƒ½çš„ç³»ç»Ÿä¸­ï¼Œä½ æœ‰ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼ˆä¹Ÿå°±æ˜¯æŒ‡å‘å¦ä¸€ä¸ªæ–‡ä»¶çš„å¿«æ·æ–¹å¼ï¼‰ï¼Œå¹¶ä¸”å‡ºäºæŸç§åŸå› ï¼Œä½ æƒ³æ”¹å˜è¿™ä¸ªé“¾æ¥è‡ªå·±çš„æƒé™ï¼Œè€Œä¸å½±å“å®é™…çš„ç›®æ ‡æ–‡ä»¶ã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦å¼•å…¥ <code>fs</code> æ¨¡å—ä¸­çš„ <code>Promises API</code>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ¥ç€ï¼Œä½¿ç”¨ <code>fsPromises.lchmod</code> æ¥æ”¹å˜ç¬¦å·é“¾æ¥çš„æƒé™ã€‚æ¯”å¦‚ï¼Œä½ æƒ³è®©è¿™ä¸ªé“¾æ¥å¯¹æ‰€æœ‰ç”¨æˆ·éƒ½æ˜¯å¯æ‰§è¡Œçš„ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/your/symlink</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // ç¬¦å·é“¾æ¥çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> mode</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0o777</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ‰€æœ‰ç”¨æˆ·éƒ½æœ‰è¯»ã€å†™å’Œæ‰§è¡Œæƒé™</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">lchmod</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> mode</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">then</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Symlink permissions changed successfully</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error changing symlink permissions:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆæŒ‡å®šäº†ç¬¦å·é“¾æ¥çš„è·¯å¾„å’Œæˆ‘ä»¬æƒ³è¦è®¾ç½®çš„æ–°æƒé™æ¨¡å¼ï¼ˆ<code>0o777</code> è¡¨ç¤ºæ‰€æœ‰ç”¨æˆ·éƒ½æœ‰è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ï¼‰ã€‚ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨ <code>fs.lchmod</code> å¹¶ä¼ å…¥è¿™äº›å‚æ•°æ¥å°è¯•æ”¹å˜æƒé™ã€‚å¦‚æœæƒé™æ›´æ”¹æˆåŠŸï¼Œä¼šæ‰“å°å‡ºæˆåŠŸçš„æ¶ˆæ¯ï¼›å¦‚æœå‡ºé”™ï¼Œåˆ™ä¼šæ•è·é”™è¯¯å¹¶æ‰“å°ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-2" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-2"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>å®é™…å¼€å‘ä¸­ä½¿ç”¨ <code>fsPromises.lchmod</code> çš„æƒ…å†µæ¯”è¾ƒç½•è§ï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒçš„æ”¯æŒæ€§é—®é¢˜ä»¥åŠä¿®æ”¹é“¾æ¥æ–‡ä»¶æƒé™çš„éœ€æ±‚ä¸å¤šã€‚</li><li>å¦‚æœä½ æ­£åœ¨ç¼–å†™è·¨å¹³å°çš„ Node.js åº”ç”¨ï¼Œå»ºè®®è°¨æ…ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ–è€…æ ¹æ®è¿è¡Œç¯å¢ƒè¿›è¡Œæ¡ä»¶æ£€æŸ¥ã€‚</li></ul><p>å¸Œæœ›è¿™èƒ½å¤Ÿå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ <code>fsPromises.lchmod</code> çš„ä½œç”¨å’Œå¦‚ä½•ä½¿ç”¨å®ƒï¼</p><h3 id="fspromises-lchown-path-uid-gid" tabindex="-1"><a class="header-anchor" href="#fspromises-lchown-path-uid-gid"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromiseslchownpath-uid-gid" target="_blank" rel="noopener noreferrer">fsPromises.lchown(path, uid, gid)</a></span></a></h3><p>å¾ˆå¥½ï¼Œæˆ‘ä»¬æ¥ä¸€æ­¥æ­¥è§£é‡Š <code>fsPromises.lchown(path, uid, gid)</code> è¿™ä¸ªåŠŸèƒ½åœ¨ Node.js ä¸­çš„ä½œç”¨å’Œå¦‚ä½•ä½¿ç”¨å®ƒï¼Œä»¥åŠä¸ºä»€ä¹ˆå®ƒæ˜¯æœ‰ç”¨çš„ã€‚</p><h3 id="_1-fspromises-æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#_1-fspromises-æ˜¯ä»€ä¹ˆ"><span>1. fsPromises æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code>æ¨¡å—æä¾›äº†ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„ APIã€‚è¿™ä¸ªæ¨¡å—åŒ…å«ä¸€ç³»åˆ—çš„æ–¹æ³•ç”¨äºæ–‡ä»¶çš„åˆ›å»ºã€è¯»å–ã€å†™å…¥ã€åˆ é™¤ç­‰æ“ä½œã€‚<code>fs</code>æ¨¡å—æœ‰ä¸¤ç§å½¢å¼çš„ APIï¼šåŸºäºå›è°ƒçš„ä¼ ç»Ÿ API å’Œè¿”å›<code>Promise</code>çš„ APIï¼ˆæ ‡è®°ä¸º<code>fsPromises</code>ï¼‰ã€‚ä½¿ç”¨<code>fsPromises</code>å¯ä»¥è®©æˆ‘ä»¬ä½¿ç”¨<code>async/await</code>è¯­æ³•ï¼Œè¿™ä½¿å¾—å¼‚æ­¥ä»£ç æ›´å®¹æ˜“å†™å’Œç†è§£ã€‚</p><h3 id="_2-lchown-æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#_2-lchown-æ˜¯ä»€ä¹ˆ"><span>2. lchown æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h3><p><code>lchown</code>æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºæ”¹å˜ä¸€ä¸ªç¬¦å·é“¾æ¥æœ¬èº«çš„æ‰€æœ‰æƒï¼Œè€Œä¸æ˜¯å®ƒæŒ‡å‘çš„æ–‡ä»¶ã€‚åœ¨ Unix-like ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªæ‰€æœ‰è€…å’Œä¸€ä¸ªæ‰€å±ç¾¤ç»„ã€‚ä½¿ç”¨<code>lchown</code>æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹æ–‡ä»¶æˆ–ç¬¦å·é“¾æ¥çš„ç”¨æˆ· IDï¼ˆuidï¼‰å’Œç»„ IDï¼ˆgidï¼‰ã€‚ä½†è¯·æ³¨æ„ï¼Œé€šå¸¸åªæœ‰ç³»ç»Ÿç®¡ç†å‘˜ï¼ˆroot ç”¨æˆ·ï¼‰æœ‰æƒé™æ‰§è¡Œè¿™é¡¹æ“ä½œã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-5" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-5"><span>å®é™…è¿ç”¨ç¤ºä¾‹ï¼š</span></a></h3><p>è®¾æƒ³ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œå…¶ä¸­éœ€è¦æ”¹å˜æŸäº›æ–‡ä»¶çš„æ‰€æœ‰æƒã€‚è¿™å¯èƒ½æ˜¯å› ä¸ºä½ çš„åº”ç”¨æœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨ï¼Œå¹¶ä¸”ä½ éœ€è¦å°†è¿™äº›æ–‡ä»¶çš„æ‰€æœ‰æƒæ›´æ”¹ä¸ºæœåŠ¡å™¨ä¸Šè¿è¡Œè¯¥æœåŠ¡çš„ç‰¹å®šç”¨æˆ·æˆ–ç»„ã€‚</p><h4 id="ç¤ºä¾‹ä»£ç -3" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç -3"><span>ç¤ºä¾‹ä»£ç ï¼š</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç¬¦å·é“¾æ¥<code>link-to-file.txt</code>ï¼Œæˆ‘ä»¬æƒ³æŠŠå®ƒçš„æ‰€æœ‰è€…æ”¹æˆ UID 1000 å’Œ GID 1000ã€‚</p><p>é¦–å…ˆï¼Œç¡®ä¿ä½ å·²ç»å¯¼å…¥äº†<code>fs</code>æ¨¡å—çš„<code>promises</code> API:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç„¶åï¼Œä½ å¯ä»¥ä½¿ç”¨<code>lchown</code>æ–¹æ³•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> changeLinkOwnership</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">lchown</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path/to/link-to-file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1000</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ‰€æœ‰æƒæ›´æ”¹æˆåŠŸ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ›´æ”¹æ‰€æœ‰æƒæ—¶å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">changeLinkOwnership</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>path/to/link-to-file.txt</code>æ˜¯ä½ æƒ³è¦æ›´æ”¹æ‰€æœ‰æƒçš„ç¬¦å·é“¾æ¥çš„è·¯å¾„ã€‚<code>1000</code>æ˜¯æ–°çš„ç”¨æˆ· ID å’Œç»„ IDã€‚è¿™æ®µä»£ç é¦–å…ˆå°è¯•æ›´æ”¹ç¬¦å·é“¾æ¥çš„æ‰€æœ‰æƒï¼Œå¦‚æœæˆåŠŸï¼Œä¼šæ‰“å°å‡ºâ€œæ‰€æœ‰æƒæ›´æ”¹æˆåŠŸâ€ã€‚å¦‚æœæ“ä½œå¤±è´¥ï¼ˆæ¯”å¦‚ç”±äºæƒé™é—®é¢˜ï¼‰ï¼Œå®ƒä¼šæ•è·é”™è¯¯å¹¶æ‰“å°å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-3" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-3"><span>æ³¨æ„äº‹é¡¹ï¼š</span></a></h3><ul><li>è¿è¡Œéœ€è¦æ›´æ”¹æ–‡ä»¶æ‰€æœ‰æƒçš„ Node.js ä»£ç æ—¶ï¼Œä½ å¯èƒ½éœ€è¦ç®¡ç†å‘˜æƒé™ï¼ˆæ¯”å¦‚ä½¿ç”¨<code>sudo</code>åœ¨ Linux ä¸Šè¿è¡Œï¼‰ï¼Œå› ä¸ºè¿™é€šå¸¸æ¶‰åŠåˆ°æ–‡ä»¶ç³»ç»Ÿçº§åˆ«çš„æ•æ„Ÿæ“ä½œã€‚</li><li><code>lchown</code>æ–¹æ³•ä¸“é—¨ç”¨äºç¬¦å·é“¾æ¥ï¼Œå¦‚æœä½ éœ€è¦æ›´æ”¹æ™®é€šæ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰æƒï¼Œè¯·ä½¿ç”¨<code>chown</code>æˆ–<code>fchown</code>ã€‚</li></ul><p>é€šè¿‡ä½¿ç”¨<code>fsPromises.lchown</code>ï¼Œä½ çš„ Node.js åº”ç”¨èƒ½å¤Ÿä»¥æ›´ç°ä»£å’Œæ¸…æ™°çš„æ–¹å¼å¤„ç†æ–‡ä»¶æ‰€æœ‰æƒæ›´æ”¹çš„éœ€æ±‚ï¼ŒåŒæ—¶åˆ©ç”¨<code>async/await</code>ç®€åŒ–å¼‚æ­¥æ“ä½œçš„å¤„ç†ã€‚</p><h3 id="fspromises-lutimes-path-atime-mtime" tabindex="-1"><a class="header-anchor" href="#fspromises-lutimes-path-atime-mtime"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromiseslutimespath-atime-mtime" target="_blank" rel="noopener noreferrer">fsPromises.lutimes(path, atime, mtime)</a></span></a></h3><p><code>fsPromises.lutimes(path, atime, mtime)</code> æ˜¯ä¸€ä¸ªåœ¨ Node.js ç‰ˆæœ¬ 21.7.1 ä¸­å¯ç”¨çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œæ–¹æ³•ï¼Œå®ƒå±äº <code>fs/promises</code> æ¨¡å—ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ å¼‚æ­¥åœ°æ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æ—¶é—´ï¼ˆatimeï¼‰å’Œä¿®æ”¹æ—¶é—´ï¼ˆmtimeï¼‰ï¼Œè€Œä¸ä¼šæ›´æ”¹æ–‡ä»¶å†…å®¹ã€‚</p><h3 id="å‚æ•°è§£é‡Š-4" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-4"><span>å‚æ•°è§£é‡Šï¼š</span></a></h3><ul><li><strong>path</strong>: è¿™æ˜¯ä½ æƒ³è¦æ›´æ”¹æ—¶é—´å±æ€§çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><strong>atime</strong>: è®¿é—®æ—¶é—´ï¼Œä»£è¡¨äº†æ–‡ä»¶è¢«æœ€åä¸€æ¬¡è®¿é—®çš„æ—¶é—´ç‚¹ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªè¡¨ç¤ºæ—¶é—´çš„æ•°å­—ï¼ˆUnix æ—¶é—´æˆ³ï¼Œå³è‡ª 1970 å¹´ 1 æœˆ 1 æ—¥ä»¥æ¥çš„æ¯«ç§’æ•°ï¼‰æˆ–è€…æ˜¯ä¸€ä¸ª Date å¯¹è±¡ã€‚</li><li><strong>mtime</strong>: ä¿®æ”¹æ—¶é—´ï¼Œè¡¨ç¤ºæ–‡ä»¶å†…å®¹æœ€åè¢«ä¿®æ”¹çš„æ—¶é—´ç‚¹ï¼Œæ ¼å¼ä¸ atime ç›¸åŒã€‚</li></ul><h3 id="ä½¿ç”¨æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æ¡ˆä¾‹"><span>ä½¿ç”¨æ¡ˆä¾‹ï¼š</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªé¡¹ç›®ï¼Œéœ€è¦å¯¹æ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´è¿›è¡Œç®¡ç†ï¼Œæ¯”å¦‚åœ¨ä¸€ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬ä¸­æ ¹æ®æ–‡ä»¶çš„è®¿é—®æˆ–ä¿®æ”¹æ—¶é—´æ‰§è¡Œç‰¹å®šä»»åŠ¡ã€‚ä½¿ç”¨ <code>fsPromises.lutimes</code> å¯ä»¥è®©ä½ è½»æ¾å®ç°è¿™äº›éœ€æ±‚ã€‚</p><h4 id="ç¤ºä¾‹-1-æ›´æ–°æ–‡ä»¶æ—¶é—´" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æ›´æ–°æ–‡ä»¶æ—¶é—´"><span>ç¤ºä¾‹ 1: æ›´æ–°æ–‡ä»¶æ—¶é—´</span></a></h4><p>è€ƒè™‘è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼Œä½ æ­£åœ¨æ„å»ºä¸€ä¸ªç½‘ç«™ï¼Œéœ€è¦æ›´æ–°æŸä¸ªæ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´ä»¥åæ˜ æœ€æ–°çŠ¶æ€ï¼Œä½†ä¸æƒ³æ”¹å˜æ–‡ä»¶çš„å†…å®¹ã€‚ä¸‹é¢çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>fsPromises.lutimes</code> æ¥å®ç°è¿™ä¸€ç‚¹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å¼•å…¥ fs promises API</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> updateFileTimes</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // è·å–å½“å‰æ—¶é—´</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> now</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // æ›´æ–°æ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´ä¸ºå½“å‰æ—¶é—´</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">lutimes</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> now</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> now</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶æ—¶é—´æ›´æ–°æˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ›´æ–°æ–‡ä»¶æ—¶é—´æ—¶å‡ºé”™ï¼š</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨å‡½æ•°</span></span>
<span class="line"><span style="color:#88C0D0;">updateFileTimes</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-è®¾ç½®æŒ‡å®šçš„è®¿é—®-ä¿®æ”¹æ—¶é—´" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-è®¾ç½®æŒ‡å®šçš„è®¿é—®-ä¿®æ”¹æ—¶é—´"><span>ç¤ºä¾‹ 2: è®¾ç½®æŒ‡å®šçš„è®¿é—®/ä¿®æ”¹æ—¶é—´</span></a></h4><p>å¦‚æœä½ çš„åº”ç”¨ç¨‹åºéœ€è¦å°†æ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´è®¾ç½®ä¸ºç‰¹å®šçš„å€¼ï¼ˆä¾‹å¦‚ï¼Œå°†æ–‡ä»¶çš„æ—¶é—´å›æº¯åˆ°è¿‡å»æˆ–è®¾ç½®æœªæ¥çš„æŸä¸ªæ—¶é—´ç‚¹ï¼‰ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ–¹å¼æ“ä½œï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å¼•å…¥ fs promises API</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> setSpecificFileTimes</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // è®¾å®šç‰¹å®šçš„æ—¶é—´</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> specificTime</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">2023-01-01T00:00:00Z</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // å°†æ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´è®¾ç½®ä¸º2023å¹´1æœˆ1æ—¥</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">lutimes</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> specificTime</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> specificTime</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶æ—¶é—´è®¾ç½®æˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è®¾ç½®æ–‡ä»¶æ—¶é—´æ—¶å‡ºé”™ï¼š</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨å‡½æ•°</span></span>
<span class="line"><span style="color:#88C0D0;">setSpecificFileTimes</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ³¨æ„äº‹é¡¹-4" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-4"><span>æ³¨æ„äº‹é¡¹ï¼š</span></a></h3><ul><li>ä½¿ç”¨ <code>fsPromises.lutimes</code> æ—¶ï¼Œç¡®ä¿ä¼ é€’ç»™ <code>atime</code> å’Œ <code>mtime</code> çš„æ˜¯æœ‰æ•ˆçš„æ—¥æœŸå€¼ï¼›</li><li>å¦‚æœæ–‡ä»¶è·¯å¾„ä¸å­˜åœ¨ï¼Œæ“ä½œä¼šå¤±è´¥ï¼ŒæŠ›å‡ºé”™è¯¯ï¼›</li><li><code>fsPromises.lutimes</code> è¿”å›ä¸€ä¸ª Promiseï¼Œå› æ­¤ä½ éœ€è¦ä½¿ç”¨ <code>await</code> å…³é”®å­—ç­‰å¾…æ“ä½œå®Œæˆï¼Œæˆ–è€…ä½¿ç”¨ <code>.then().catch()</code> æ–¹æ³•å¤„ç†æˆåŠŸå’Œå¤±è´¥çš„æƒ…å†µã€‚</li></ul><h3 id="fspromises-link-existingpath-newpath" tabindex="-1"><a class="header-anchor" href="#fspromises-link-existingpath-newpath"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromiseslinkexistingpath-newpath" target="_blank" rel="noopener noreferrer">fsPromises.link(existingPath, newPath)</a></span></a></h3><p>Node.js ä¸­çš„ <code>fsPromises.link(existingPath, newPath)</code> æ–¹æ³•æ˜¯ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„ç¡¬é“¾æ¥(hard link)ã€‚åœ¨è¯¦ç»†è§£é‡Šè¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£å‡ ä¸ªæ¦‚å¿µï¼šæ–‡ä»¶ç³»ç»Ÿã€ç¡¬é“¾æ¥ä»¥åŠ Node.js çš„ Promiseã€‚</p><h3 id="æ–‡ä»¶ç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶ç³»ç»Ÿ"><span>æ–‡ä»¶ç³»ç»Ÿ</span></a></h3><p>æ–‡ä»¶ç³»ç»Ÿè´Ÿè´£ç®¡ç†æ•°æ®çš„å­˜å‚¨å’Œè®¿é—®ã€‚å®ƒå…è®¸ä½ åˆ›å»ºã€è¯»å–ã€ä¿®æ”¹æ–‡ä»¶ç­‰ã€‚åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶ä¸ä»…ä»…æ˜¯ä¸€ä¸²æ•°æ®ï¼Œè¿˜åŒ…æ‹¬äº†æ–‡ä»¶çš„å…ƒæ•°æ®ï¼ˆæ¯”å¦‚ï¼šæ–‡ä»¶åã€åˆ›å»ºæ—¶é—´ç­‰ï¼‰ã€‚</p><h3 id="ç¡¬é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#ç¡¬é“¾æ¥"><span>ç¡¬é“¾æ¥</span></a></h3><p>ç¡¬é“¾æ¥æ˜¯æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€ä¸ªæ¦‚å¿µã€‚å½“ä½ åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œå®é™…ä¸Šæ˜¯åœ¨ç£ç›˜ä¸Šåˆ†é…äº†ä¸€å—ç©ºé—´æ¥å­˜å‚¨æ–‡ä»¶çš„æ•°æ®ï¼Œå¹¶åœ¨æ–‡ä»¶ç›®å½•ä¸­åˆ›å»ºäº†ä¸€ä¸ªæŒ‡å‘è¯¥æ•°æ®åŒºåŸŸçš„å¼•ç”¨ï¼ˆä¹Ÿå°±æ˜¯æ–‡ä»¶åï¼‰ã€‚è€Œç¡¬é“¾æ¥ï¼Œå°±æ˜¯ä¸ºåŒä¸€å—ç£ç›˜ç©ºé—´ï¼ˆå³åŒä¸€ä¸ªæ–‡ä»¶çš„æ•°æ®ï¼‰åˆ›å»ºå¦ä¸€ä¸ªå¼•ç”¨ï¼ˆæˆ–ç§°ä¸ºå…¥å£ï¼‰ã€‚è¿™æ„å‘³ç€ï¼Œé€šè¿‡ä»»ä½•ä¸€ä¸ªå¼•ç”¨å¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œä¿®æ”¹ï¼Œéƒ½ä¼šåæ˜ åœ¨æ‰€æœ‰å¼•ç”¨ä¸Šã€‚åˆ é™¤ä¸€ä¸ªç¡¬é“¾æ¥å¹¶ä¸ä¼šåˆ é™¤æ–‡ä»¶çš„æ•°æ®ï¼Œåªæœ‰å½“æœ€åä¸€ä¸ªå¼•ç”¨è¢«åˆ é™¤æ—¶ï¼Œæ–‡ä»¶çš„æ•°æ®æ‰ä¼šè¢«çœŸæ­£åœ°åˆ é™¤ã€‚</p><h3 id="node-js-å’Œ-promise" tabindex="-1"><a class="header-anchor" href="#node-js-å’Œ-promise"><span>Node.js å’Œ Promise</span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 JavaScript å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œèƒ½å¤Ÿè®©å¼€å‘è€…ä½¿ç”¨ JavaScript ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚è€Œ Promise æ˜¯ JavaScript ä¸­ç”¨äºå¼‚æ­¥ç¼–ç¨‹çš„ä¸€ä¸ªç‰¹æ€§ã€‚<code>Promise</code> ä»£è¡¨äº†ä¸€ä¸ªå°†è¦å®Œæˆï¼ˆæˆ–å¤±è´¥ï¼‰çš„æ“ä½œåŠå…¶ç»“æœå€¼ã€‚</p><h3 id="fspromises-link-existingpath-newpath-1" tabindex="-1"><a class="header-anchor" href="#fspromises-link-existingpath-newpath-1"><span>fsPromises.link(existingPath, newPath)</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>fsPromises.link</code> æ–¹æ³•å±äº <code>fs/promises</code> æ¨¡å—ï¼Œå®ƒè¿”å›ä¸€ä¸ª <code>Promise</code> å¯¹è±¡ï¼Œç”¨äºæ— é˜»å¡åœ°ï¼ˆå¼‚æ­¥åœ°ï¼‰åˆ›å»ºä¸€ä¸ªæ–°çš„ç¡¬é“¾æ¥ã€‚</p><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>existingPath</code>: å·²å­˜åœ¨çš„æ–‡ä»¶çš„è·¯å¾„ã€‚</li><li><code>newPath</code>: è¦åˆ›å»ºçš„ç¡¬é“¾æ¥çš„è·¯å¾„ã€‚</li></ul><h4 id="å®é™…è¿ç”¨ç¤ºä¾‹-6" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-6"><span>å®é™…è¿ç”¨ç¤ºä¾‹ï¼š</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶å« <code>app.log</code>ï¼Œç°åœ¨æƒ³åœ¨å¦ä¸€ä¸ªç›®å½•ä¸‹åˆ›å»ºè¿™ä¸ªæ—¥å¿—æ–‡ä»¶çš„ç¡¬é“¾æ¥ï¼Œè®©è¿™ä¸¤ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶æŒ‡å‘åŒä¸€ä¸ªæ•°æ®ï¼Œè¿™æ ·æ— è®ºåœ¨å“ªä¸ªç›®å½•ä¸‹æ›´æ–°æ—¥å¿—æ–‡ä»¶ï¼Œå˜åŒ–éƒ½ä¼šåŒæ­¥ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> createHardLink</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">link</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./logs/app.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./backup_logs/app.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç¡¬é“¾æ¥åˆ›å»ºæˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">åˆ›å»ºç¡¬é“¾æ¥å¤±è´¥ï¼š</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">createHardLink</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°è¯•å°† <code>./logs/app.log</code> æ–‡ä»¶åˆ›å»ºä¸€ä¸ªç¡¬é“¾æ¥åˆ° <code>./backup_logs/app.log</code>ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œæ§åˆ¶å°å°†è¾“å‡ºâ€œç¡¬é“¾æ¥åˆ›å»ºæˆåŠŸï¼â€ï¼›å¦‚æœå¤±è´¥ï¼Œåˆ™ä¼šæ•è·åˆ°å¼‚å¸¸å¹¶æ‰“å°å‡ºé”™ä¿¡æ¯ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬åˆ©ç”¨ Node.js çš„ <code>fsPromises.link</code> æ–¹æ³•ä»¥å¼‚æ­¥çš„å½¢å¼é«˜æ•ˆåœ°ç®¡ç†æ–‡ä»¶ï¼Œè¿™å¯¹äºéœ€è¦å¤šä¸ªå¼•ç”¨ç‚¹æŒ‡å‘åŒä¸€æ•°æ®æ–‡ä»¶çš„åœºæ™¯éå¸¸æœ‰ç”¨ï¼Œå¦‚æ—¥å¿—å¤‡ä»½ã€æ•°æ®åŒæ­¥ç­‰æƒ…å†µã€‚</p><h3 id="fspromises-lstat-path-options" tabindex="-1"><a class="header-anchor" href="#fspromises-lstat-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromiseslstatpath-options" target="_blank" rel="noopener noreferrer">fsPromises.lstat(path[, options])</a></span></a></h3><p>Node.js ä¸­çš„<code>fsPromises.lstat()</code>å‡½æ•°æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„å·¥å…·ï¼Œå°¤å…¶æ˜¯å½“ä½ åœ¨å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ—¶ã€‚è¿™ä¸ªå‡½æ•°å±äº<code>fs</code>æ¨¡å—çš„<code>Promises</code>æ¥å£ï¼Œè®©ä½ èƒ½å¤Ÿå¼‚æ­¥åœ°è·å–æ–‡ä»¶æˆ–ç›®å½•çš„çŠ¶æ€ä¿¡æ¯ï¼Œè€Œä¸ä¼šé˜»å¡ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ã€‚è®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥è§£æå®ƒã€‚</p><h3 id="è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š"><span>è§£é‡Š</span></a></h3><p>é¦–å…ˆï¼Œ<code>fs</code>æ¨¡å—æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œä¸“é—¨ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚åœ¨è¿™ä¸ªæ¨¡å—ä¸­ï¼Œ<code>lstat()</code>å‡½æ•°å¯ä»¥è®©ä½ è·å–æ–‡ä»¶æˆ–è€…ç›®å½•çš„å…ƒæ•°æ®ï¼ˆmetadataï¼‰ï¼Œæ¯”å¦‚æ–‡ä»¶çš„å¤§å°ã€åˆ›å»ºæ—¶é—´ç­‰ã€‚è€Œ<code>fsPromises.lstat()</code>åˆ™æ˜¯è¿™ä¸ªå‡½æ•°åŸºäº Promise çš„ç‰ˆæœ¬ï¼Œä½¿å¾—ä½ å¯ä»¥ä½¿ç”¨æ›´ç°ä»£çš„å¼‚æ­¥å¤„ç†æ–¹å¼ï¼Œå¦‚ async/awaitã€‚</p><h4 id="å‚æ•°è§£é‡Š-5" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-5"><span>å‚æ•°è§£é‡Š</span></a></h4><ul><li><strong>path</strong>: è¿™æ˜¯ä½ æƒ³è¦è·å–çŠ¶æ€çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><strong>options</strong>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…è®¸ä½ å®šåˆ¶ä¸€äº›è¡Œä¸ºï¼Œä¾‹å¦‚æŒ‡å®šè¿”å›çš„æ—¶é—´æˆ³çš„æ ¼å¼ã€‚</li></ul><h4 id="è¿”å›å€¼-4" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-4"><span>è¿”å›å€¼</span></a></h4><p><code>fsPromises.lstat()</code>å‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚å½“è¿™ä¸ª Promise è¢«è§£å†³æ—¶ï¼Œå®ƒä¼šå¸¦ç€ä¸€ä¸ª<code>fs.Stats</code>å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åŒ…å«äº†å…³äºæ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-5"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="_1-è·å–æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_1-è·å–æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯"><span>1. è·å–æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦æ£€æŸ¥æŸä¸ªæ–‡ä»¶æ˜¯å¦å­˜åœ¨ä»¥åŠè·å–è¯¥æ–‡ä»¶çš„å¤§å°ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> getFileStats</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">lstat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶å¤§å°: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">size</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> bytes</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">åˆ›å»ºæ—¶é—´: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ctime</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // å¯ä»¥æ ¹æ®statså¯¹è±¡æä¾›çš„æ–¹æ³•åˆ¤æ–­æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•ç­‰</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFile</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filePath</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> æ˜¯ä¸€ä¸ªæ–‡ä»¶</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#81A1C1;"> else</span><span style="color:#81A1C1;"> if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isDirectory</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filePath</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> æ˜¯ä¸€ä¸ªç›®å½•</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è·å–æ–‡ä»¶çŠ¶æ€å¤±è´¥:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="color:#88C0D0;">getFileStats</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-æ£€æŸ¥è·¯å¾„æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•" tabindex="-1"><a class="header-anchor" href="#_2-æ£€æŸ¥è·¯å¾„æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•"><span>2. æ£€æŸ¥è·¯å¾„æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•</span></a></h4><p>åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œä½ å¯èƒ½éœ€è¦åŒºåˆ†ä¸€ä¸ªè·¯å¾„æ˜¯æŒ‡å‘æ–‡ä»¶è¿˜æ˜¯ç›®å½•ï¼Œå› ä¸ºä½ å¯¹å®ƒä»¬çš„æ“ä½œå¯èƒ½å®Œå…¨ä¸åŒã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> checkPathType</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">lstat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isDirectory</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">path</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> æ˜¯ä¸€ä¸ªç›®å½•</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#81A1C1;"> else</span><span style="color:#81A1C1;"> if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFile</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">path</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> æ˜¯ä¸€ä¸ªæ–‡ä»¶</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ£€æŸ¥è·¯å¾„å¤±è´¥:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="color:#88C0D0;">checkPathType</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./somePath</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å°ç»“-1" tabindex="-1"><a class="header-anchor" href="#å°ç»“-1"><span>å°ç»“</span></a></h3><p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ°<code>fsPromises.lstat()</code>æ˜¯å¦‚ä½•å¸®åŠ©æˆ‘ä»¬å¼‚æ­¥åœ°è·å–æ–‡ä»¶æˆ–ç›®å½•çš„çŠ¶æ€ä¿¡æ¯ï¼Œè€Œä¸ä¼šå¯¼è‡´æ•´ä¸ªç¨‹åºè¢«é˜»å¡ã€‚è¿™ç§æ–¹å¼å¯¹äºå¼€å‘é«˜æ•ˆã€å“åº”å¿«é€Ÿçš„ Node.js åº”ç”¨è‡³å…³é‡è¦ã€‚è€Œä¸”ï¼Œä½¿ç”¨ Promise åŸºäºçš„ APIï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°å°†è¿™äº›æ“ä½œèå…¥åˆ°ç°ä»£ JavaScript çš„å¼‚æ­¥é€»è¾‘ä¸­ï¼Œå¦‚ async/await ä¸­ï¼Œè®©ä»£ç æ›´åŠ æ¸…æ™°å’Œç®€æ´ã€‚</p><h3 id="fspromises-mkdir-path-options" tabindex="-1"><a class="header-anchor" href="#fspromises-mkdir-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisesmkdirpath-options" target="_blank" rel="noopener noreferrer">fsPromises.mkdir(path[, options])</a></span></a></h3><p>å½“æˆ‘ä»¬è°ˆåˆ° Node.js ä¸­çš„<code>fsPromises.mkdir(path[, options])</code>å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨è®¨è®ºæ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰ä¸­åˆ›å»ºæ–°ç›®å½•çš„åŠŸèƒ½ã€‚è¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªåŸºäº Promise çš„æ“ä½œï¼Œæ„å‘³ç€å®ƒæ”¯æŒå¼‚æ­¥æ‰§è¡Œï¼Œä»è€Œä¸ä¼šé˜»å¡ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ã€‚ç°åœ¨ï¼Œæˆ‘å°†é€šè¿‡ä¸€äº›æ¦‚å¿µè§£é‡Šå’Œå®ä¾‹æ¥è¯¦ç»†è§£é‡Šè¿™ä¸ªå‡½æ•°ã€‚</p><h3 id="æ¦‚å¿µè§£é‡Š" tabindex="-1"><a class="header-anchor" href="#æ¦‚å¿µè§£é‡Š"><span>æ¦‚å¿µè§£é‡Š</span></a></h3><ol><li><strong>Node.js</strong>ï¼šä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå¯ä»¥è®©ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚</li><li><strong>fsPromises</strong>ï¼š&#39;fs&#39;æ¨¡å—çš„ Promise ç‰ˆæœ¬ã€‚åœ¨ Node.js ä¸­ï¼Œ&#39;fs&#39;ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰æ¨¡å—æ˜¯ç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ã€‚&#39;fsPromises&#39;æä¾›äº†åŸºäº Promise çš„ APIï¼Œä½¿å¾—å¤„ç†å¼‚æ­¥æ–‡ä»¶æ“ä½œå˜å¾—æ›´åŠ ç®€æ´ã€‚</li><li><strong>mkdir</strong>ï¼šè¿™æ˜¯&#39;make directory&#39;çš„ç¼©å†™ï¼Œæ„å³â€œåˆ›å»ºç›®å½•â€ã€‚</li><li><strong>path</strong>ï¼šè¿™æ˜¯ä½ æƒ³è¦åˆ›å»ºçš„ç›®å½•çš„è·¯å¾„ã€‚å®ƒå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ä¹Ÿå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ã€‚</li><li><strong>options</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œæä¾›å¯¹å¦‚ä½•åˆ›å»ºç›®å½•çš„æ›´å¤šæ§åˆ¶ã€‚</li></ol><h3 id="é€‰é¡¹" tabindex="-1"><a class="header-anchor" href="#é€‰é¡¹"><span>é€‰é¡¹</span></a></h3><ul><li><strong>recursive</strong>ï¼šå¦‚æœè®¾ç½®ä¸º<code>true</code>ï¼Œåˆ™ä¼šé€’å½’åœ°åˆ›å»ºæ‰€æœ‰å¿…éœ€çš„çˆ¶ç›®å½•ã€‚é»˜è®¤å€¼ä¸º<code>false</code>ã€‚</li><li><strong>mode</strong>ï¼šè®¾ç½®ç›®å½•çš„æƒé™ã€‚åœ¨ Unix ç³»ç»Ÿä¸Šï¼Œå®ƒæ˜¯ä»¥å…«è¿›åˆ¶æ•°è¡¨ç¤ºçš„ï¼ˆä¾‹å¦‚ 0o777ï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“å‰è¿›ç¨‹çš„æ¨¡å¼è¢«ç”¨ä½œæ©ç ï¼ˆumaskï¼‰ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-2"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œéœ€è¦æ ¹æ®ç”¨æˆ·è¾“å…¥åŠ¨æ€åˆ›å»ºç›®å½•ç»“æ„ï¼Œæ¯”å¦‚ä¸€ä¸ªç”¨æˆ·ä¸“å±çš„æ•°æ®å­˜å‚¨ç›®å½•ã€‚</p><h4 id="ç¤ºä¾‹-1-åˆ›å»ºå•ä¸ªç›®å½•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åˆ›å»ºå•ä¸ªç›®å½•"><span>ç¤ºä¾‹ 1ï¼šåˆ›å»ºå•ä¸ªç›®å½•</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å¼•å…¥fsæ¨¡å—ä¸­çš„promisesæ¥å£</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> createDirectory</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">mkdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Directory created at </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error creating directory:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨å‡½æ•°ï¼Œå°è¯•åˆ›å»ºä¸€ä¸ªåä¸º &#39;userData&#39; çš„æ–°ç›®å½•</span></span>
<span class="line"><span style="color:#88C0D0;">createDirectory</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./userData</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å°è¯•åœ¨å½“å‰å·¥ä½œç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸º<code>userData</code>çš„æ–°ç›®å½•ã€‚å¦‚æœè¯¥ç›®å½•å·²å­˜åœ¨ï¼Œåˆ™ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p><h4 id="ç¤ºä¾‹-2-é€’å½’åˆ›å»ºå¤šçº§ç›®å½•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-é€’å½’åˆ›å»ºå¤šçº§ç›®å½•"><span>ç¤ºä¾‹ 2ï¼šé€’å½’åˆ›å»ºå¤šçº§ç›®å½•</span></a></h4><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦åˆ›å»ºå¤šçº§ç›®å½•ç»“æ„ï¼Œä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬å¸Œæœ›æŒ‰å¹´ä»½å’Œæœˆä»½ç»„ç»‡ç”¨æˆ·æ•°æ®æ—¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å¼•å…¥fsæ¨¡å—ä¸­çš„promisesæ¥å£</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> createNestedDirectory</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">mkdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> recursive</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Directory created at </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error creating directory:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨å‡½æ•°ï¼Œåˆ›å»ºä¸€ä¸ªå¤šçº§ç›®å½•ç»“æ„ï¼Œæ¯”å¦‚ &#39;userData/2023/March&#39;</span></span>
<span class="line"><span style="color:#88C0D0;">createNestedDirectory</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./userData/2023/March</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå³ä½¿<code>userData</code>å’Œ<code>2023</code>ç›®å½•åŸæœ¬ä¸å­˜åœ¨ï¼Œè®¾ç½®<code>recursive: true</code>ä¹Ÿä¼šç¡®ä¿æ•´ä¸ªè·¯å¾„é“¾éƒ½è¢«åˆ›å»ºã€‚</p><h3 id="æ€»ç»“-2" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-2"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡ä¸Šè¿°ç¤ºä¾‹ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä½•ä½¿ç”¨<code>fsPromises.mkdir</code>æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªç›®å½•ï¼Œå¹¶ä¸”äº†è§£äº†å¦‚ä½•é€šè¿‡<code>options</code>å¯¹è±¡æ¥è°ƒæ•´å…¶è¡Œä¸ºï¼ˆå¦‚é€’å½’åˆ›å»ºç›®å½•ï¼‰ã€‚è¿™ç§åŸºäº Promise çš„ API ç›¸è¾ƒäºä¼ ç»Ÿå›è°ƒæ–¹å¼æ›´åŠ æ˜“äºç®¡ç†ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤æ‚çš„å¼‚æ­¥æµç¨‹æ—¶ã€‚</p><h3 id="fspromises-mkdtemp-prefix-options" tabindex="-1"><a class="header-anchor" href="#fspromises-mkdtemp-prefix-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisesmkdtempprefix-options" target="_blank" rel="noopener noreferrer">fsPromises.mkdtemp(prefix[, options])</a></span></a></h3><p>å½“ç„¶ï¼Œè®©æˆ‘æ¥è§£é‡Šä¸€ä¸‹ <code>fsPromises.mkdtemp(prefix[, options])</code> è¿™ä¸ªæ–¹æ³•åœ¨ Node.js ä¸­çš„ç”¨é€”å’Œå·¥ä½œæ–¹å¼ï¼Œä»¥åŠå¦‚ä½•åœ¨å®è·µä¸­åº”ç”¨å®ƒã€‚</p><h3 id="åŸºæœ¬è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬è§£é‡Š"><span>åŸºæœ¬è§£é‡Š</span></a></h3><p>é¦–å…ˆï¼Œ<code>fsPromises.mkdtemp</code> æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿæ¨¡å—çš„ä¸€éƒ¨åˆ†ã€‚è¿™ä¸ªå‡½æ•°ç”¨äºå¼‚æ­¥åœ°åˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„ä¸´æ—¶ç›®å½•ã€‚å½“ä½ çš„ç¨‹åºéœ€è¦å¤„ç†ä¸´æ—¶æ–‡ä»¶æ—¶ï¼Œè¿™éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚è¿›è¡Œä¸´æ—¶æ•°æ®å­˜å‚¨æˆ–è€…å½“ä½ åœ¨æ‰§è¡Œä¸€äº›åªéœ€çŸ­æš‚ä¿å­˜æ–‡ä»¶çš„æ“ä½œã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>prefix</code>ï¼šè¿™æ˜¯ä½ åˆ›å»ºçš„ä¸´æ—¶ç›®å½•åçš„å‰ç¼€ã€‚Node.js ä¼šåœ¨è¿™ä¸ªå‰ç¼€åé¢æ·»åŠ éšæœºå­—ç¬¦æ¥ç¡®ä¿ç›®å½•åçš„å”¯ä¸€æ€§ã€‚</li><li><code>options</code>ï¼ˆå¯é€‰ï¼‰ï¼šå¯ä»¥ç”¨æ¥æŒ‡å®šå­—ç¬¦ç¼–ç ï¼Œå¹¶ä¸”è¿˜å¯ä»¥æŒ‡å®šä¸´æ—¶ç›®å½•çš„æ ¹ç›®å½•ã€‚</li></ul><p>è¿”å›å€¼ï¼šè¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ª <code>Promise</code>ï¼Œè¿™æ„å‘³ç€å®ƒæ˜¯åŸºäº Promise çš„å¼‚æ­¥æ“ä½œã€‚ä¸€æ—¦ç›®å½•è¢«æˆåŠŸåˆ›å»ºï¼Œpromise å°†ä¼šè§£å†³ä¸ºä¸€ä¸ªåŒ…å«æ–°å»ºä¸´æ—¶ç›®å½•å®Œæ•´è·¯å¾„çš„å­—ç¬¦ä¸²ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-6" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-6"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p><strong>1. åˆ›å»ºä¸€ä¸ªä¸´æ—¶ç›®å½•</strong></p><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦ä¸´æ—¶å­˜å‚¨ä¸Šä¼ çš„æ–‡ä»¶ï¼Œå¤„ç†å®Œæ¯•åå†åˆ é™¤å®ƒä»¬ã€‚<code>fsPromises.mkdtemp</code> å¯ä»¥å¸®åŠ©ä½ è½»æ¾åˆ›å»ºè¿™æ ·ä¸€ä¸ªä¸´æ—¶ç›®å½•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> os</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">os</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> createTempDirectory</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // ä½¿ç”¨ os.tmpdir() è·å–ç³»ç»Ÿé»˜è®¤çš„ä¸´æ—¶æ–‡ä»¶å¤¹ï¼Œä½œä¸ºæˆ‘ä»¬ä¸´æ—¶ç›®å½•çš„æ ¹ç›®å½•</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> tempDirPrefix</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">os</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">tmpdir</span><span style="color:#D8DEE9FF;">()</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">myApp-</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // åˆ›å»ºä¸´æ—¶ç›®å½•ï¼Œ&#39;myApp-&#39; æ˜¯å‰ç¼€</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> tempDir</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">mkdtemp</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">tempDirPrefix</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">ä¸´æ—¶ç›®å½•å·²åˆ›å»ºåœ¨: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">tempDir</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // åœ¨è¿™é‡Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªä¸´æ—¶ç›®å½•æ¥å­˜å‚¨ä¸€äº›æ–‡ä»¶</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">åˆ›å»ºä¸´æ—¶ç›®å½•å¤±è´¥:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">createTempDirectory</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é¦–å…ˆå¯¼å…¥äº†å¿…è¦çš„ Node.js å†…ç½®æ¨¡å—ï¼š<code>fs</code> (ä½¿ç”¨å…¶ promises API)ï¼Œ<code>os</code> å’Œ <code>path</code>ã€‚å®ƒå®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° <code>createTempDirectory</code>ï¼Œè¿™ä¸ªå‡½æ•°åˆ›å»ºä¸€ä¸ªä½äºç³»ç»Ÿé»˜è®¤ä¸´æ—¶æ–‡ä»¶å¤¹ä¸­ã€å‰ç¼€ä¸º <code>&#39;myApp-&#39;</code> çš„ä¸´æ—¶ç›®å½•ã€‚é€šè¿‡æ—¥å¿—è¾“å‡ºï¼Œä½ å¯ä»¥çœ‹åˆ°è¿™ä¸ªä¸´æ—¶ç›®å½•çš„å®Œæ•´è·¯å¾„ï¼Œä¹‹åå¯ä»¥åœ¨æ­¤ç›®å½•ä¸­è¿›è¡Œæ–‡ä»¶æ“ä½œã€‚</p><p><strong>æ³¨æ„ï¼š</strong> åˆ›å»ºä¸´æ—¶ç›®å½•åï¼Œè®°å¾—åœ¨ä¸å†éœ€è¦æ—¶åˆ é™¤å®ƒï¼Œä»¥å…åœ¨ç£ç›˜ä¸Šç•™ä¸‹æ— ç”¨çš„æ•°æ®ã€‚ç”±äºè¿™é‡Œä½¿ç”¨äº†å¼‚æ­¥å‡½æ•°ï¼Œæ‰€ä»¥é”™è¯¯å¤„ç†æ˜¯é€šè¿‡ <code>try...catch</code> ç»“æ„æ¥å®ç°çš„ã€‚</p><p>é€šè¿‡ä¸Šè¿°ç¤ºä¾‹ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>fsPromises.mkdtemp</code> æä¾›äº†ä¸€ç§ç®€å•è€Œå¼ºå¤§çš„æ–¹æ³•æ¥å¤„ç†ä¸´æ—¶æ–‡ä»¶å’Œç›®å½•ï¼Œè¿™åœ¨è®¸å¤šå®é™…åº”ç”¨åœºæ™¯ä¸­éƒ½éå¸¸æœ‰ç”¨ã€‚</p><h3 id="fspromises-open-path-flags-mode" tabindex="-1"><a class="header-anchor" href="#fspromises-open-path-flags-mode"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisesopenpath-flags-mode" target="_blank" rel="noopener noreferrer">fsPromises.open(path, flags[, mode])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­çš„ <code>fsPromises.open(path, flags[, mode])</code> æ–¹æ³•ï¼Œå¹¶é€šè¿‡å‡ ä¸ªå®ä¾‹å¸®åŠ©ä½ ç†è§£å…¶ç”¨é€”ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-4" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-4"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>é¦–å…ˆï¼Œ<code>fsPromises.open()</code> æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œä¸“é—¨ç”¨äºå¼‚æ­¥æ‰“å¼€æ–‡ä»¶ã€‚è¿™é‡Œçš„ <code>fsPromises</code> æ˜¯ <code>fs</code> æ¨¡å—ï¼ˆNode.js çš„æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼‰çš„ Promise ç‰ˆæœ¬ï¼Œå®ƒæä¾›äº†åŸºäº Promise çš„ APIï¼Œä½¿å¾—ä½¿ç”¨ async/await æ¥å¤„ç†æ–‡ä»¶æ“ä½œå˜å¾—æ›´åŠ ç®€å•å’Œç›´è§‚ã€‚</p><ul><li><strong>path</strong>: è¿™æ˜¯ä½ æƒ³è¦æ‰“å¼€çš„æ–‡ä»¶çš„è·¯å¾„ã€‚</li><li><strong>flags</strong>: è¿™å‘Šè¯‰ Node.js ä½ æ‰“ç®—å¦‚ä½•ä½¿ç”¨è¯¥æ–‡ä»¶ã€‚æ¯”å¦‚ï¼Œæ˜¯å¦æ˜¯åªè¯»çš„ã€æ˜¯å¦è¦å†™å…¥æ•°æ®ã€æ˜¯å¦åœ¨å†™å…¥æ—¶åˆ›å»ºæ–°æ–‡ä»¶ç­‰ã€‚</li><li><strong>mode</strong> (å¯é€‰): è¿™æ˜¯è®¾ç½®æ–‡ä»¶æ¨¡å¼ï¼ˆæƒé™å’Œç²˜æ»ä½ï¼‰ï¼Œä½†åªåœ¨æ–‡ä»¶è¢«åˆ›å»ºæ—¶æœ‰æ•ˆã€‚è¿™é€šå¸¸ç”¨äºè®¾ç½®æ–‡ä»¶çš„è¯»å†™æ‰§è¡Œæƒé™ã€‚</li></ul><h3 id="flags-çš„ä¸€äº›å¸¸è§å€¼" tabindex="-1"><a class="header-anchor" href="#flags-çš„ä¸€äº›å¸¸è§å€¼"><span>Flags çš„ä¸€äº›å¸¸è§å€¼</span></a></h3><ul><li><code>&#39;r&#39;</code>: æ‰“å¼€æ–‡ä»¶ç”¨äºè¯»å–ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™å‡ºç°å¼‚å¸¸ã€‚</li><li><code>&#39;w&#39;</code>: æ‰“å¼€æ–‡ä»¶ç”¨äºå†™å…¥ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºæ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶å­˜åœ¨åˆ™æˆªæ–­æ–‡ä»¶ã€‚</li><li><code>&#39;a&#39;</code>: æ‰“å¼€æ–‡ä»¶ç”¨äºè¿½åŠ ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºè¯¥æ–‡ä»¶ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-7" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-7"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="_1-è¯»å–æ–‡ä»¶å†…å®¹-1" tabindex="-1"><a class="header-anchor" href="#_1-è¯»å–æ–‡ä»¶å†…å®¹-1"><span>1. è¯»å–æ–‡ä»¶å†…å®¹</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡ä»¶ï¼Œä½ æƒ³è¦è¯»å–å®ƒçš„å†…å®¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readFileContent</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> content</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">{</span><span style="color:#88C0D0;"> encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">content</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">readFileContent</span><span style="color:#D8DEE9FF;">()</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é¦–å…ˆæ‰“å¼€ <code>example.txt</code> æ–‡ä»¶ç”¨äºè¯»å–ï¼Œç„¶åè¯»å–å…¶å†…å®¹å¹¶æ‰“å°å‡ºæ¥ï¼Œä¹‹åå…³é—­æ–‡ä»¶ã€‚</p><h4 id="_2-å‘æ–‡ä»¶ä¸­å†™å…¥å†…å®¹" tabindex="-1"><a class="header-anchor" href="#_2-å‘æ–‡ä»¶ä¸­å†™å…¥å†…å®¹"><span>2. å‘æ–‡ä»¶ä¸­å†™å…¥å†…å®¹</span></a></h4><p>ç°åœ¨ï¼Œå¦‚æœä½ æƒ³å‘ä¸€ä¸ªæ–‡ä»¶ä¸­å†™å…¥ä¸€äº›å†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> writeFileContent</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello, world!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">writeFileContent</span><span style="color:#D8DEE9FF;">()</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œæˆ‘ä»¬æ‰“å¼€ <code>example.txt</code> æ–‡ä»¶ç”¨äºå†™å…¥ï¼ˆå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºå®ƒï¼‰ã€‚æˆ‘ä»¬å‘æ–‡ä»¶ä¸­å†™å…¥ &quot;Hello, world!&quot; å­—ç¬¦ä¸²ï¼Œç„¶åå…³é—­æ–‡ä»¶ã€‚</p><h4 id="_3-è¿½åŠ å†…å®¹åˆ°æ–‡ä»¶-1" tabindex="-1"><a class="header-anchor" href="#_3-è¿½åŠ å†…å®¹åˆ°æ–‡ä»¶-1"><span>3. è¿½åŠ å†…å®¹åˆ°æ–‡ä»¶</span></a></h4><p>å¦‚æœä½ æƒ³åœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ å†…å®¹è€Œä¸æ˜¯è¦†ç›–åŸæœ‰å†…å®¹ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> appendFileContent</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">appendFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;"> Adding more content.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> fileHandle</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">appendFileContent</span><span style="color:#D8DEE9FF;">()</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šæ‰“å¼€ <code>example.txt</code> æ–‡ä»¶å¹¶åœ¨å…¶æœ«å°¾è¿½åŠ æ–‡æœ¬ &quot; Adding more content.&quot;ã€‚</p><h3 id="ç»“è®º-2" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-2"><span>ç»“è®º</span></a></h3><p><code>fsPromises.open()</code> æ–¹æ³•æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªå¼ºå¤§å·¥å…·ï¼Œç”¨äºä»¥å„ç§æ¨¡å¼ï¼ˆå¦‚è¯»å–ã€å†™å…¥ã€è¿½åŠ ç­‰ï¼‰æ‰“å¼€æ–‡ä»¶ã€‚é€šè¿‡ç»“åˆä½¿ç”¨å…¶ä»– <code>fsPromises</code> æ–¹æ³•ï¼Œä½ å¯ä»¥è½»æ¾åœ°å®ç°å¯¹æ–‡ä»¶çš„è¯»å†™æ“ä½œã€‚è®°ä½ï¼Œåœ¨æ“ä½œç»“æŸåå…³é—­æ–‡ä»¶æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œä»¥é¿å…èµ„æºæ³„éœ²ã€‚</p><h3 id="fspromises-opendir-path-options" tabindex="-1"><a class="header-anchor" href="#fspromises-opendir-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisesopendirpath-options" target="_blank" rel="noopener noreferrer">fsPromises.opendir(path[, options])</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript ç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨ JavaScript æ¥åšå¾ˆå¤šäº‹æƒ…ï¼Œæ¯”å¦‚è¯»å†™æ–‡ä»¶ã€æ“ä½œæ•°æ®åº“ç­‰ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬æ¥è°ˆè°ˆ Node.js ä¸­çš„ä¸€ä¸ªç‰¹å®šåŠŸèƒ½ï¼š<code>fsPromises.opendir(path[, options])</code>ã€‚</p><h3 id="ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#ç®€ä»‹"><span>ç®€ä»‹</span></a></h3><p><code>fsPromises.opendir</code>æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæä¾›äº†ä¸€ç§å¼‚æ­¥æ–¹å¼æ¥æ‰“å¼€ä¸€ä¸ªç›®å½•ã€‚ä¸ä¼ ç»Ÿçš„å›è°ƒæ–¹å¼ä¸åŒï¼Œå®ƒè¿”å›ä¸€ä¸ª promiseï¼Œè¿™ä½¿å¾—ä½ å¯ä»¥ä½¿ç”¨æ›´ç°ä»£çš„å¼‚æ­¥å¤„ç†æ–¹æ³•ï¼Œå¦‚ async/awaitï¼Œæ¥å¤„ç†ç»“æœã€‚è¿™ä¸ªå‡½æ•°å±äº <code>fs/promises</code> APIï¼Œæ˜¯ Node.js å¯¹åŸå§‹<code>fs</code> (æ–‡ä»¶ç³»ç»Ÿ) æ¨¡å—çš„æ‰©å±•ï¼Œä¸“é—¨ç”¨äºæ”¯æŒåŸºäº Promise çš„æ¥å£ã€‚</p><h3 id="ä½¿ç”¨æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•"><span>ä½¿ç”¨æ–¹æ³•</span></a></h3><p>è¦ä½¿ç”¨<code>fsPromises.opendir</code>ï¼Œé¦–å…ˆéœ€è¦å¯¼å…¥<code>fs/promises</code>æ¨¡å—ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> fs</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æˆ–è€…ï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯ CommonJS æ¨¡å—ç³»ç»Ÿï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç„¶åï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è°ƒç”¨<code>opendir</code>å‡½æ•°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> listDirectoryContents</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> dir</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">opendir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  for</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#81A1C1;"> of</span><span style="color:#D8DEE9;"> dir</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>listDirectoryContents</code>æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œå®ƒå°è¯•æ‰“å¼€ç”±<code>directoryPath</code>å‚æ•°æŒ‡å®šçš„ç›®å½•ã€‚ä¸€æ—¦ç›®å½•è¢«æˆåŠŸæ‰“å¼€ï¼Œä½ å¯ä»¥éå†ç›®å½•ä¸­çš„æ¯ä¸€é¡¹ï¼ˆæ–‡ä»¶æˆ–å­ç›®å½•ï¼‰ï¼Œå¹¶æ‰“å°å‡ºå…¶åç§°ã€‚</p><h3 id="å‚æ•°è¯´æ˜-1" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯´æ˜-1"><span>å‚æ•°è¯´æ˜</span></a></h3><ul><li><strong>path</strong>: è¿™æ˜¯ä½ æƒ³è¦æ‰“å¼€çš„ç›®å½•çš„è·¯å¾„ã€‚</li><li><strong>options</strong>: å¯é€‰å‚æ•°ï¼Œå…è®¸ä½ æŒ‡å®šä¸€äº›æ‰“å¼€ç›®å½•æ—¶çš„é€‰é¡¹ã€‚è™½ç„¶åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­å¯èƒ½æ²¡æœ‰è¯¦ç»†åˆ—å‡ºæ‰€æœ‰é€‰é¡¹ï¼Œä½†é€šå¸¸åŒ…æ‹¬è®¾ç½®ç¼–ç ç±»å‹ç­‰ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><h4 id="_1-åˆ—å‡ºç›®å½•å†…å®¹" tabindex="-1"><a class="header-anchor" href="#_1-åˆ—å‡ºç›®å½•å†…å®¹"><span>1. åˆ—å‡ºç›®å½•å†…å®¹</span></a></h4><p>æœ€ç›´æ¥çš„ç”¨é€”å°±æ˜¯åˆ—å‡ºä¸€ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•ã€‚æ¯”å¦‚ï¼Œä½ æ­£åœ¨æ„å»ºä¸€ä¸ªæ–‡ä»¶æµè§ˆå™¨æˆ–è€…éœ€è¦åˆ†ææŸä¸ªç›®å½•çš„ç»“æ„ï¼Œ<code>fsPromises.opendir</code>ä¼šéå¸¸æœ‰ç”¨ã€‚</p><h4 id="_2-æœç´¢ç‰¹å®šæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_2-æœç´¢ç‰¹å®šæ–‡ä»¶"><span>2. æœç´¢ç‰¹å®šæ–‡ä»¶</span></a></h4><p>å‡è®¾ä½ éœ€è¦åœ¨ä¸€ä¸ªå¤§å‹é¡¹ç›®ä¸­æŸ¥æ‰¾æ‰€æœ‰çš„ JavaScript æ–‡ä»¶ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>fsPromises.opendir</code>æ¥éå†é¡¹ç›®çš„ç›®å½•ç»“æ„ï¼Œæ£€æŸ¥æ¯ä¸ªæ–‡ä»¶çš„æ‰©å±•åæ˜¯å¦ä¸º<code>.js</code>ï¼Œå¹¶æ”¶é›†è¿™äº›æ–‡ä»¶çš„è·¯å¾„ã€‚</p><h4 id="_3-è‡ªåŠ¨åŒ–æ¸…ç†ä»»åŠ¡" tabindex="-1"><a class="header-anchor" href="#_3-è‡ªåŠ¨åŒ–æ¸…ç†ä»»åŠ¡"><span>3. è‡ªåŠ¨åŒ–æ¸…ç†ä»»åŠ¡</span></a></h4><p>åœ¨è‡ªåŠ¨åŒ–è„šæœ¬ä¸­ï¼Œä½ å¯èƒ½éœ€è¦åˆ é™¤è¿‡æ—¶çš„æ—¥å¿—æ–‡ä»¶æˆ–ä¸´æ—¶æ–‡ä»¶ã€‚ä½¿ç”¨<code>fsPromises.opendir</code>å¯ä»¥å¸®åŠ©ä½ éå†ç‰¹å®šç›®å½•ï¼Œæ£€æŸ¥æ–‡ä»¶çš„åˆ›å»ºæˆ–ä¿®æ”¹æ—¥æœŸï¼Œå¹¶æ ¹æ®éœ€è¦åˆ é™¤æ—§æ–‡ä»¶ã€‚</p><h3 id="æ€»ç»“-3" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-3"><span>æ€»ç»“</span></a></h3><p><code>fsPromises.opendir</code>æ˜¯ Node.js ä¸­å¤„ç†ç›®å½•çš„å¼ºå¤§å·¥å…·ï¼Œå®ƒä»¥ç°ä»£çš„ Promise æ¥å£ç®€åŒ–äº†å¼‚æ­¥æ–‡ä»¶ç³»ç»Ÿæ“ä½œã€‚æ— è®ºæ˜¯è¿›è¡Œæ–‡ä»¶ç®¡ç†ã€æ•°æ®æ•´ç†è¿˜æ˜¯è‡ªåŠ¨åŒ–ä»»åŠ¡ï¼Œå®ƒéƒ½èƒ½æä¾›çµæ´»è€Œæœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚</p><h3 id="fspromises-readdir-path-options" tabindex="-1"><a class="header-anchor" href="#fspromises-readdir-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisesreaddirpath-options" target="_blank" rel="noopener noreferrer">fsPromises.readdir(path[, options])</a></span></a></h3><p>Node.js ä¸­çš„ <code>fsPromises.readdir(path[, options])</code> æ–¹æ³•æ˜¯ä¸€ä¸ªéé˜»å¡ï¼ˆå¼‚æ­¥ï¼‰æ–¹å¼ï¼Œç”¨äºè¯»å–ç»™å®šæ–‡ä»¶å¤¹ï¼ˆç›®å½•ï¼‰çš„å†…å®¹ã€‚è¿™æ„å‘³ç€å®ƒä¸ä¼šæš‚åœç¨‹åºçš„æ‰§è¡Œå»ç­‰å¾…æ“ä½œå®Œæˆï¼Œè€Œæ˜¯åœ¨æ“ä½œå®Œæˆåé€šè¿‡ Promises æ¥å¤„ç†ç»“æœã€‚è¿™ç§æ–¹æ³•éå¸¸é€‚åˆäºå¤„ç† I/O å¯†é›†å‹ä»»åŠ¡ï¼Œå¦‚æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸æ¯” CPU å¯†é›†å‹ä»»åŠ¡èŠ±è´¹æ›´å¤šæ—¶é—´ã€‚</p><h3 id="å‚æ•°è¯¦è§£-2" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯¦è§£-2"><span>å‚æ•°è¯¦è§£</span></a></h3><ul><li><code>path</code>: è¿™æ˜¯ä½ æƒ³è¦è¯»å–çš„ç›®å½•çš„è·¯å¾„ï¼Œå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ã€‚</li><li><code>options</code>: æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…è®¸ä½ å®šåˆ¶å‡½æ•°çš„è¡Œä¸ºã€‚æœ€å¸¸ç”¨çš„é€‰é¡¹åŒ…æ‹¬ï¼š <ul><li><code>encoding</code>: æŒ‡å®šå­—ç¬¦ç¼–ç ï¼Œé»˜è®¤æ˜¯ <code>&#39;utf8&#39;</code>ï¼Œè¿”å›æ–‡ä»¶åå­—ç¬¦ä¸²ï¼›å¦‚æœè®¾ç½®ä¸º <code>&#39;buffer&#39;</code>ï¼Œåˆ™è¿”å› Buffer å¯¹è±¡çš„æ–‡ä»¶åæ•°ç»„ã€‚</li><li><code>withFileTypes</code>: å¦‚æœè®¾ç½®ä¸º <code>true</code>ï¼Œæ–¹æ³•å°†è¿”å› <code>fs.Dirent</code> å¯¹è±¡æ•°ç»„ï¼Œè€Œä¸ä»…ä»…æ˜¯æ–‡ä»¶åæ•°ç»„ã€‚è¿™äº›å¯¹è±¡æä¾›å…³äºæ¯ä¸ªæ–‡ä»¶/ç›®å½•çš„é¢å¤–ä¿¡æ¯ï¼Œä¾‹å¦‚å®ƒæ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•(<code>dirent.isFile()</code>, <code>dirent.isDirectory()</code> ç­‰æ–¹æ³•)ã€‚</li></ul></li></ul><h3 id="å®é™…è¿ç”¨ä¸¾ä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¸¾ä¾‹"><span>å®é™…è¿ç”¨ä¸¾ä¾‹</span></a></h3><h4 id="_1-åŸºç¡€ä½¿ç”¨-è¯»å–ç›®å½•å†…å®¹" tabindex="-1"><a class="header-anchor" href="#_1-åŸºç¡€ä½¿ç”¨-è¯»å–ç›®å½•å†…å®¹"><span>1. åŸºç¡€ä½¿ç”¨ï¼šè¯»å–ç›®å½•å†…å®¹</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç›®å½• <code>/photos</code>ï¼Œé‡Œé¢å­˜æ”¾äº†å¤šä¸ªå›¾ç‰‡æ–‡ä»¶ï¼Œæˆ‘ä»¬æƒ³è¦è·å–è¿™ä¸ªç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶çš„åç§°åˆ—è¡¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> listFilesInDirectory</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> files</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•å†…å®¹ï¼š</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> files</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–ç›®å½•æ—¶å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">listFilesInDirectory</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./photos</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-ä½¿ç”¨-withfiletypes-åŒºåˆ†æ–‡ä»¶å’Œç›®å½•" tabindex="-1"><a class="header-anchor" href="#_2-ä½¿ç”¨-withfiletypes-åŒºåˆ†æ–‡ä»¶å’Œç›®å½•"><span>2. ä½¿ç”¨ <code>withFileTypes</code>ï¼šåŒºåˆ†æ–‡ä»¶å’Œç›®å½•</span></a></h4><p>å‡è®¾æˆ‘ä»¬ä¸ä»…æƒ³çŸ¥é“ <code>/projects</code> ç›®å½•ä¸‹æœ‰å“ªäº›å†…å®¹ï¼Œè¿˜æƒ³åŒºåˆ†å“ªäº›æ˜¯æ–‡ä»¶å¤¹ï¼Œå“ªäº›æ˜¯æ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> listFilesAndDirectories</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> items</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> withFileTypes</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    items</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forEach</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">item</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">item</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isDirectory</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">item</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> æ˜¯ä¸€ä¸ªç›®å½•</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span><span style="color:#81A1C1;"> else</span><span style="color:#81A1C1;"> if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">item</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFile</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">item</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> æ˜¯ä¸€ä¸ªæ–‡ä»¶</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–ç›®å½•æ—¶å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">listFilesAndDirectories</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./projects</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å°† <code>withFileTypes</code> è®¾ç½®ä¸º <code>true</code>ï¼Œå¯ä»¥ç›´æ¥å¾—åˆ°å…³äºæ¯ä¸ªé¡¹ç›®æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•çš„ä¿¡æ¯ï¼Œå¹¶æ®æ­¤æ‰“å°ä¸åŒçš„æ¶ˆæ¯ã€‚</p><h3 id="æ€»ç»“-4" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-4"><span>æ€»ç»“</span></a></h3><p><code>fsPromises.readdir</code> æ–¹æ³•æä¾›äº†ä¸€ç§çµæ´»ã€é«˜æ•ˆåœ°è¯»å–ç›®å½•å†…å®¹çš„æ–¹å¼ã€‚å®ƒåˆ©ç”¨ Node.js çš„å¼‚æ­¥ç‰¹æ€§ï¼Œèƒ½å¤Ÿåœ¨ä¸é˜»å¡ç¨‹åºè¿è¡Œçš„åŒæ—¶è¿›è¡Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼Œéå¸¸é€‚ç”¨äºéœ€è¦å¤„ç†å¤§é‡æ–‡ä»¶æ“ä½œçš„åœºæ™¯ã€‚é€šè¿‡çµæ´»ä½¿ç”¨ <code>options</code> å‚æ•°ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦è·å¾—ä¸åŒæ ¼å¼çš„è¾“å‡ºï¼Œä½¿å…¶æ›´è´´åˆä½ çš„åº”ç”¨éœ€æ±‚ã€‚</p><h3 id="fspromises-readfile-path-options" tabindex="-1"><a class="header-anchor" href="#fspromises-readfile-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisesreadfilepath-options" target="_blank" rel="noopener noreferrer">fsPromises.readFile(path[, options])</a></span></a></h3><p>å½“ä½ å¼€å§‹å­¦ä¹  Node.js æ—¶ï¼Œäº†è§£å¦‚ä½•å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç¯èŠ‚ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>fs</code>æ¨¡å—æ˜¯ç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„ä¸€ç§æ–¹å¼ã€‚<code>fsPromises.readFile</code>å‡½æ•°æ˜¯<code>fs</code>æ¨¡å—æä¾›çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨äºå¼‚æ­¥åœ°è¯»å–æ–‡ä»¶çš„å†…å®¹ï¼Œè€Œä¸”è¿”å›ä¸€ä¸ª Promiseï¼Œè®©ä½ å¯ä»¥ç”¨æ›´ç°ä»£çš„æ–¹å¼ï¼ˆæ¯”å¦‚ async/awaitï¼‰æ¥å¤„ç†å¼‚æ­¥æ“ä½œï¼Œé¿å…äº†ä¼ ç»Ÿå›è°ƒå‡½æ•°å¯èƒ½å¯¼è‡´çš„&quot;å›è°ƒåœ°ç‹±&quot;é—®é¢˜ã€‚</p><h3 id="åŸºæœ¬ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç”¨æ³•"><span>åŸºæœ¬ç”¨æ³•</span></a></h3><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>fsPromises.readFile</code>å‡½æ•°çš„åŸºæœ¬ä½¿ç”¨æ–¹å¼æ˜¯ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readFile</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–æ–‡ä»¶å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥<code>fs/promises</code>æ¨¡å—ï¼Œç„¶åå®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•°<code>readFile</code>ã€‚åœ¨è¿™ä¸ªå‡½æ•°å†…éƒ¨ï¼Œä½¿ç”¨<code>await</code>å…³é”®å­—æ¥ç­‰å¾…<code>fs.readFile</code>æ–¹æ³•è¯»å–æ–‡ä»¶å®Œæˆã€‚<code>fs.readFile</code>æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šæ–‡ä»¶è·¯å¾„å’Œé€‰é¡¹ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŒ‡å®šäº†æ–‡ä»¶çš„è·¯å¾„<code>&#39;example.txt&#39;</code>å’Œç¼–ç <code>&#39;utf8&#39;</code>ï¼Œè¿™æ ·è¯»å–çš„ç»“æœå°±æ˜¯æ–‡ä»¶çš„æ–‡æœ¬å†…å®¹ã€‚å¦‚æœè¯»å–æˆåŠŸï¼Œæˆ‘ä»¬å°†è¾“å‡ºæ–‡ä»¶å†…å®¹ï¼›å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œæˆ‘ä»¬å°†æ•è·è¿™ä¸ªé”™è¯¯å¹¶æ‰“å°å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="å‚æ•°è¯¦è§£-3" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯¦è§£-3"><span>å‚æ•°è¯¦è§£</span></a></h3><ul><li><strong>path</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºä½ æƒ³è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚</li><li><strong>options</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…ä¸€ä¸ªå¯¹è±¡ã€‚å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™è¢«è§†ä¸ºæ–‡ä»¶çš„å­—ç¬¦ç¼–ç ï¼Œå¦‚<code>&#39;utf8&#39;</code>ã€‚å¦‚æœæ˜¯å¯¹è±¡ï¼Œä½ å¯ä»¥æŒ‡å®šå¤šç§é€‰é¡¹ï¼Œæ¯”å¦‚ç¼–ç ç±»å‹ã€‚æœ€å¸¸ç”¨çš„æ˜¯<code>{ encoding: &#39;utf8&#39; }</code>ï¼Œè¿™æ ·è¿”å›çš„æ•°æ®æ˜¯å­—ç¬¦ä¸²å½¢å¼çš„æ–‡ä»¶å†…å®¹ã€‚å¦‚æœä¸æŒ‡å®šç¼–ç ï¼Œåˆ™è¿”å›çš„æ•°æ®æ˜¯åŸå§‹çš„äºŒè¿›åˆ¶ Bufferã€‚</li></ul><h3 id="å®é™…åº”ç”¨ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-1"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><h4 id="è¯»å–é…ç½®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#è¯»å–é…ç½®æ–‡ä»¶"><span>è¯»å–é…ç½®æ–‡ä»¶</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œéœ€è¦ä»ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼ˆæ¯”å¦‚<code>config.json</code>ï¼‰ä¸­è¯»å–é…ç½®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readConfig</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> configText</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> config</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> JSON</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parse</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">configText</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">é…ç½®ä¿¡æ¯ï¼š</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> config</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–é…ç½®æ–‡ä»¶å¤±è´¥:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">readConfig</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ—¥å¿—æ–‡ä»¶åˆ†æ" tabindex="-1"><a class="header-anchor" href="#æ—¥å¿—æ–‡ä»¶åˆ†æ"><span>æ—¥å¿—æ–‡ä»¶åˆ†æ</span></a></h4><p>ä½ å¯èƒ½åœ¨å¼€å‘ä¸­éœ€è¦åˆ†ææ—¥å¿—æ–‡ä»¶æ¥æŸ¥æ‰¾ç‰¹å®šçš„ä¿¡æ¯æˆ–é”™è¯¯ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> analyzeLog</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> log</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">server.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // é€šè¿‡ç®€å•çš„æ–‡æœ¬åˆ†æã€æ­£åˆ™è¡¨è¾¾å¼ç­‰æ¥å¤„ç†logå˜é‡ä¸­çš„æ—¥å¿—å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">log</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–æ—¥å¿—æ–‡ä»¶å¤±è´¥:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">analyzeLog</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™äº›ä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>fsPromises.readFile</code>æ¥è¯»å–æ–‡æœ¬å†…å®¹ï¼Œå¹¶æ ¹æ®éœ€è¦è¿›è¡Œå¤„ç†ã€‚ç”±äºå®ƒè¿”å› Promiseï¼Œå› æ­¤éå¸¸é€‚åˆç”¨åœ¨ç°ä»£çš„å¼‚æ­¥ç¼–ç¨‹æ¨¡å¼ä¸­ï¼Œç‰¹åˆ«æ˜¯é…åˆ async/await ä½¿ç”¨ï¼Œå¤§å¤§ç®€åŒ–äº†ä»£ç ç»“æ„ã€‚</p><h3 id="fspromises-readlink-path-options" tabindex="-1"><a class="header-anchor" href="#fspromises-readlink-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisesreadlinkpath-options" target="_blank" rel="noopener noreferrer">fsPromises.readlink(path[, options])</a></span></a></h3><p>å¥½çš„ï¼ŒNode.js ä¸­çš„<code>fsPromises.readlink(path[, options])</code>æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå¼‚æ­¥åœ°è¯»å–ç¬¦å·é“¾æ¥çš„å€¼ã€‚åœ¨ Unix-like æ“ä½œç³»ç»Ÿä¸­ï¼Œç¬¦å·é“¾æ¥æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ–‡ä»¶ï¼Œå®ƒåŒ…å«å¯¹å¦ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„å¼•ç”¨è·¯å¾„ã€‚</p><p>è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå½“è¯»å–æ“ä½œå®Œæˆæ—¶ï¼Œè¿™ä¸ª Promise ä¼šè§£å†³ï¼ˆresolveï¼‰ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…ä¸€ä¸ª Buffer(å–å†³äºä¼ å…¥çš„ options)ï¼Œè¯¥å­—ç¬¦ä¸²æˆ– Buffer åŒ…å«äº†ç¬¦å·é“¾æ¥æ‰€æŒ‡å‘çš„å®é™…è·¯å¾„ã€‚</p><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>path</code>: è¿™æ˜¯ä½ æƒ³è¦è¯»å–çš„ç¬¦å·é“¾æ¥çš„è·¯å¾„ã€‚</li><li><code>options</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå¯ä»¥æ§åˆ¶è¿”å›å€¼çš„æ ¼å¼ã€‚å¦‚æœ<code>options</code>æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆå®ƒè¡¨ç¤ºå­—ç¬¦ç¼–ç ï¼Œä¾‹å¦‚&#39;utf8&#39;ã€‚å¦‚æœ<code>options</code>æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆä½ å¯ä»¥è®¾ç½®<code>encoding</code>å±æ€§æŒ‡å®šå­—ç¬¦ç¼–ç ã€‚</li></ul><p>ç°åœ¨æ¥çœ‹å‡ ä¸ªä¾‹å­ï¼š</p><h3 id="ç¤ºä¾‹-1-ä½¿ç”¨é»˜è®¤ç¼–ç -utf-8-è¯»å–ç¬¦å·é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ä½¿ç”¨é»˜è®¤ç¼–ç -utf-8-è¯»å–ç¬¦å·é“¾æ¥"><span>ç¤ºä¾‹ 1ï¼šä½¿ç”¨é»˜è®¤ç¼–ç ï¼ˆUTF-8ï¼‰è¯»å–ç¬¦å·é“¾æ¥</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readSymlink</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // å‡è®¾ `/tmp/mylink` æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼ŒæŒ‡å‘ `/path/to/original`</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> linkString</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readlink</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/tmp/mylink</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">linkString</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: /path/to/original</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–ç¬¦å·é“¾æ¥å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">readSymlink</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å‡è®¾<code>/tmp/mylink</code>æ˜¯ä¸€ä¸ªæŒ‡å‘<code>/path/to/original</code>çš„ç¬¦å·é“¾æ¥ã€‚é€šè¿‡è°ƒç”¨<code>fs.readlink()</code>å¹¶ç­‰å¾…è¿”å›çš„ promise è§£å†³ï¼Œæˆ‘ä»¬å¯ä»¥æ‰“å°å‡ºç¬¦å·é“¾æ¥æŒ‡å‘çš„å®é™…è·¯å¾„ã€‚</p><h3 id="ç¤ºä¾‹-2-ä½¿ç”¨-buffer-ç¼–ç è¯»å–ç¬¦å·é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨-buffer-ç¼–ç è¯»å–ç¬¦å·é“¾æ¥"><span>ç¤ºä¾‹ 2ï¼šä½¿ç”¨ Buffer ç¼–ç è¯»å–ç¬¦å·é“¾æ¥</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readSymlink</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // è®¾ç½®optionsä½¿å¾—è¿”å›å€¼ä¸ºBufferå¯¹è±¡</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> linkBuffer</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readlink</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/tmp/mylink</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">buffer</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">linkBuffer</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: `&lt;`Buffer 2f 70 61 74 68 2f 74 6f 2f 6f 72 69 67 69 6e 61 6c&gt;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">linkBuffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å°†Bufferè½¬æ¢ä¸ºå­—ç¬¦ä¸²è¾“å‡º: /path/to/original</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–ç¬¦å·é“¾æ¥å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">readSymlink</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†<code>options</code>è®¾ç½®ä¸ºä¸€ä¸ªåŒ…å«<code>{ encoding: &#39;buffer&#39; }</code>çš„å¯¹è±¡ï¼Œè¿™æ ·è¿”å›çš„ç»“æœå°±æ˜¯ä¸€ä¸ª Buffer å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†ç¬¦å·é“¾æ¥è·¯å¾„çš„å­—èŠ‚è¡¨ç¤ºã€‚ç„¶åæˆ‘ä»¬å¯ä»¥ç”¨<code>toString()</code>æ–¹æ³•æŠŠè¿™ä¸ª Buffer è½¬æ¢æˆå­—ç¬¦ä¸²å½¢å¼ã€‚</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œé»˜è®¤çš„ UTF-8 ç¼–ç å°±è¶³å¤Ÿäº†ï¼Œä½†æ˜¯å¦‚æœæœ‰ç‰¹æ®Šéœ€æ±‚éœ€è¦å¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼Œé‚£ä¹ˆ Buffer æ–¹å¼å°±å¾ˆæœ‰ç”¨ã€‚</p><p>è®°ä½ï¼Œå› ä¸ºè¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ª Promiseï¼Œæ‰€ä»¥ä½ éœ€è¦ä½¿ç”¨<code>await</code>å…³é”®å­—æ¥ç­‰å¾… Promise è§£å†³ï¼Œå¹¶ä¸”è¿™ä¸ª<code>await</code>å¿…é¡»åœ¨ä¸€ä¸ª async å‡½æ•°ä¸­ä½¿ç”¨ã€‚æˆ–è€…ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨<code>.then()</code>å’Œ<code>.catch()</code>æ–¹æ³•æ¥å¤„ç†è§£å†³ï¼ˆæˆ–æ‹’ç»ï¼‰çš„ Promiseã€‚</p><h3 id="fspromises-realpath-path-options" tabindex="-1"><a class="header-anchor" href="#fspromises-realpath-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisesrealpathpath-options" target="_blank" rel="noopener noreferrer">fsPromises.realpath(path[, options])</a></span></a></h3><p>Node.js ä¸­çš„<code>fsPromises.realpath(path[, options])</code>æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œç”¨äºå°†ä¸€ä¸ªè·¯å¾„è§£æä¸ºä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚è¿™æ„å‘³ç€å®ƒä¼šæ‰¾å‡ºä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„ç¡®åˆ‡ä½ç½®ï¼Œæ— è®ºè¾“å…¥çš„è·¯å¾„æ˜¯ç›¸å¯¹çš„è¿˜æ˜¯åŒ…å«ç¬¦å·é“¾æ¥ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>fsPromises</code>å¯¹è±¡æä¾›äº†åŸºäº Promise çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œæ–¹æ³•ã€‚ä½¿ç”¨è¿™äº›æ–¹æ³•æ—¶ï¼Œä½ ä¸éœ€è¦å›è°ƒå‡½æ•°ï¼Œå› ä¸ºå®ƒä»¬è¿”å›çš„æ˜¯ Promise å¯¹è±¡ï¼Œè¿™ä½¿å¾—å¯ä»¥ä½¿ç”¨<code>async</code>å’Œ<code>await</code>è¯­æ³•æ¥ç¼–å†™æ›´ç®€æ´ã€æ˜“è¯»çš„å¼‚æ­¥ä»£ç ã€‚</p><h3 id="å‚æ•°-2" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-2"><span>å‚æ•°ï¼š</span></a></h3><ul><li><code>path</code>ï¼šè¦è§£æçš„æ–‡ä»¶è·¯å¾„ã€‚</li><li><code>options</code>ï¼ˆå¯é€‰ï¼‰ï¼šä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥æŒ‡å®šä¸€äº›é€‰é¡¹ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²ç¼–ç ç­‰ã€‚</li></ul><h3 id="è¿”å›å€¼-5" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-5"><span>è¿”å›å€¼ï¼š</span></a></h3><ul><li>è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè§£ææˆåŠŸæ—¶ï¼ŒPromise è¢«è§£å†³ï¼ˆfulfilledï¼‰å¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå³æ–‡ä»¶æˆ–ç›®å½•çš„ç»å¯¹è·¯å¾„ï¼›å¦‚æœå‡ºé”™ï¼ŒPromise è¢«æ‹’ç»ï¼ˆrejectedï¼‰å¹¶è¿”å›é”™è¯¯ä¿¡æ¯ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-8" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-8"><span>å®é™…è¿ç”¨ä¾‹å­ï¼š</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹ç›®å½•ç»“æ„ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>/myproject</span></span>
<span class="line"><span>  /app.js</span></span>
<span class="line"><span>  /tmp</span></span>
<span class="line"><span>    /link -&gt; /myproject/app.js (ç¬¦å·é“¾æ¥)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨<code>/myproject/tmp</code>ç›®å½•ä¸‹æœ‰ä¸€ä¸ªåä¸º<code>link</code>çš„ç¬¦å·é“¾æ¥ï¼Œå®ƒæŒ‡å‘åŒä¸€ç›®å½•ä¸‹çš„<code>app.js</code>æ–‡ä»¶ã€‚</p><p>ç°åœ¨æˆ‘ä»¬æƒ³è·å–<code>link</code>çš„å®é™…ï¼ˆç»å¯¹ï¼‰è·¯å¾„ã€‚ä»¥ä¸‹æ˜¯æ€æ ·ä½¿ç”¨<code>fsPromises.realpath</code>å‡½æ•°æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡çš„ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> getRealPath</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // å‡è®¾æˆ‘ä»¬çŸ¥é“ç¬¦å·é“¾æ¥ &#39;link&#39; åœ¨ &#39;/myproject/tmp&#39; ç›®å½•ä¸‹</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> symlinkPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/myproject/tmp/link</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // ä½¿ç”¨ realpath å‡½æ•°æ¥è§£æå®ƒçš„ç»å¯¹è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> absolutePath</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">realpath</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">symlinkPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">The real path of the symlink is: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">absolutePath</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">An error occurred: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">error</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨ä¸Šé¢å®šä¹‰çš„å‡½æ•°</span></span>
<span class="line"><span style="color:#88C0D0;">getRealPath</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œä¸Šè¿°ä»£ç åï¼Œæ§åˆ¶å°ä¼šè¾“å‡ºï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>The real path of the symlink is: /myproject/app.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™è¡¨ç¤º<code>fsPromises.realpath</code>æˆåŠŸåœ°å°†ç¬¦å·é“¾æ¥<code>link</code>è§£ææˆäº†å®ƒæ‰€æŒ‡å‘çš„ç»å¯¹è·¯å¾„<code>/myproject/app.js</code>ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>fsPromises.realpath</code>æ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„å‡½æ•°ï¼Œç‰¹åˆ«å½“ä½ åœ¨å¤„ç†å¤æ‚çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå…¶ä¸­åŒ…å«äº†å¾ˆå¤šç›¸å¯¹è·¯å¾„å’Œç¬¦å·é“¾æ¥ï¼Œå¹¶ä¸”éœ€è¦æ‰¾å‡ºçœŸå®çš„æ–‡ä»¶è·¯å¾„æ—¶ã€‚é€šè¿‡ä½¿ç”¨å®ƒï¼Œä½ å¯ä»¥ç¡®ä¿ä½ çš„ Node.js åº”ç”¨èƒ½å¤Ÿæ­£ç¡®åœ°è®¿é—®å’Œæ“ä½œæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶å’Œç›®å½•ã€‚</p><h3 id="fspromises-rename-oldpath-newpath" tabindex="-1"><a class="header-anchor" href="#fspromises-rename-oldpath-newpath"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisesrenameoldpath-newpath" target="_blank" rel="noopener noreferrer">fsPromises.rename(oldPath, newPath)</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥ä¸€æ­¥ä¸€æ­¥äº†è§£ <code>fsPromises.rename(oldPath, newPath)</code> è¿™ä¸ªå‡½æ•°åœ¨ Node.js ä¸­çš„ä½œç”¨å’Œå¦‚ä½•ä½¿ç”¨å®ƒã€‚</p><p>é¦–å…ˆï¼Œ<code>fsPromises</code> æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰æ¨¡å—ä¸­æä¾›çš„ä¸€ä¸ªæ¥å£ï¼Œå®ƒå…è®¸ä½ ä»¥ promise çš„å½¢å¼å¯¹æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œæ“ä½œã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨ <code>.then()</code>, <code>.catch()</code> æˆ–è€… async/await è¯­æ³•æ¥å¤„ç†å¼‚æ­¥æ–‡ä»¶æ“ä½œï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„å›è°ƒå‡½æ•°æ–¹å¼ã€‚</p><p><code>fsPromises.rename(oldPath, newPath)</code> æ˜¯ <code>fsPromises</code> æ¥å£ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨äºå°†æ–‡ä»¶æˆ–ç›®å½•ä» <code>oldPath</code>ï¼ˆæ—§è·¯å¾„ï¼‰ç§»åŠ¨åˆ° <code>newPath</code>ï¼ˆæ–°è·¯å¾„ï¼‰ã€‚å½“ä½ æƒ³è¦æ”¹å˜ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„åç§°æˆ–ä½ç½®æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•å°±éå¸¸æœ‰ç”¨ã€‚</p><h3 id="å‚æ•°è¯´æ˜-2" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯´æ˜-2"><span>å‚æ•°è¯´æ˜</span></a></h3><ul><li><code>oldPath</code>: è¦é‡å‘½åæˆ–ç§»åŠ¨çš„æ–‡ä»¶æˆ–ç›®å½•çš„å½“å‰è·¯å¾„ã€‚</li><li><code>newPath</code>: æ–‡ä»¶æˆ–ç›®å½•çš„æ–°è·¯å¾„æˆ–æ–°åç§°ã€‚</li></ul><h3 id="æ–¹æ³•è¿”å›å€¼" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•è¿”å›å€¼"><span>æ–¹æ³•è¿”å›å€¼</span></a></h3><p><code>fsPromises.rename(oldPath, newPath)</code> è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œè¯¥ promise å°†ä¼šè¢«è§£å†³ï¼ˆresolvedï¼‰ï¼Œå¹¶ä¸”ä¸å¸¦ä»»ä½•å€¼ï¼›å¦‚æœæ“ä½œå¤±è´¥ï¼Œpromise å°†ä¼šè¢«æ‹’ç»ï¼ˆrejectedï¼‰ï¼Œå¹¶å¸¦æœ‰é”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="ä½¿ç”¨ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­-1"><span>ä½¿ç”¨ä¾‹å­</span></a></h3><h4 id="ä¾‹å­-1-é‡å‘½åæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-é‡å‘½åæ–‡ä»¶"><span>ä¾‹å­ 1: é‡å‘½åæ–‡ä»¶</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º <code>oldname.txt</code> çš„æ–‡ä»¶ï¼Œç°åœ¨æƒ³æŠŠå®ƒé‡å‘½åä¸º <code>newname.txt</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> renameFile</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rename</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">oldname.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">newname.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶é‡å‘½åæˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">é‡å‘½åå¤±è´¥ï¼š</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">renameFile</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å¯¼å…¥ Node.js çš„ <code>fs.promises</code> æ¨¡å—ï¼Œå¹¶å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° <code>renameFile</code> æ¥é‡å‘½åæ–‡ä»¶ã€‚<code>await</code> å…³é”®å­—ç”¨äºç­‰å¾… <code>fs.rename()</code> æ“ä½œå®Œæˆã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œä¼šæ‰“å°å‡ºæˆåŠŸæ¶ˆæ¯ï¼›å¦‚æœå¤±è´¥ï¼Œåˆ™ä¼šæ•è·é”™è¯¯å¹¶æ‰“å°å‡ºæ¥ã€‚</p><h4 id="ä¾‹å­-2-ç§»åŠ¨ç›®å½•" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ç§»åŠ¨ç›®å½•"><span>ä¾‹å­ 2: ç§»åŠ¨ç›®å½•</span></a></h4><p>å¦‚æœä½ æƒ³å°†ä¸€ä¸ªç›®å½•ä»ä¸€ä¸ªä½ç½®ç§»åŠ¨åˆ°å¦ä¸€ä¸ªä½ç½®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>fsPromises.rename</code> æ–¹æ³•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> moveDirectory</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rename</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/oldDir</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/newDir</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•ç§»åŠ¨æˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•ç§»åŠ¨å¤±è´¥ï¼š</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">moveDirectory</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°è¯•å°† <code>/path/to/oldDir</code> ç›®å½•ç§»åŠ¨åˆ° <code>/path/to/newDir</code>ã€‚è¿‡ç¨‹ä¸é‡å‘½åæ–‡ä»¶ç±»ä¼¼ï¼Œåªæ˜¯è¿™é‡Œæ“ä½œçš„æ˜¯ç›®å½•ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-5" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-5"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>å½“ä½ ä½¿ç”¨ <code>fsPromises.rename</code> æ–¹æ³•æ—¶ï¼Œå¦‚æœ <code>newPath</code> å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆå®ƒå°†ä¼šè¢«è¦†ç›–ã€‚</li><li>è¿™ä¸ªæ“ä½œå¯èƒ½ä¸ä¼šè·¨ä¸åŒçš„ç‰©ç†è®¾å¤‡å·¥ä½œã€‚</li><li>å¦‚æœä½ åœ¨æ“ä½œè¿‡ç¨‹ä¸­é‡åˆ°æƒé™é—®é¢˜æˆ–å…¶ä»–æ–‡ä»¶ç³»ç»Ÿé™åˆ¶ï¼Œå¯èƒ½ä¼šå¼•å‘é”™è¯¯ã€‚</li></ul><p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œä½ åº”è¯¥èƒ½å¤Ÿç†è§£ <code>fsPromises.rename</code> æ–¹æ³•åœ¨ Node.js ä¸­æ˜¯å¦‚ä½•ä½¿ç”¨çš„ï¼Œä»¥åŠå®ƒåœ¨å®é™…ç¼–ç¨‹ä¸­å¯èƒ½çš„åº”ç”¨åœºæ™¯ã€‚</p><h3 id="fspromises-rmdir-path-options" tabindex="-1"><a class="header-anchor" href="#fspromises-rmdir-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisesrmdirpath-options" target="_blank" rel="noopener noreferrer">fsPromises.rmdir(path[, options])</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªè®© JavaScript è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¹³å°ï¼Œå®ƒå…è®¸å¼€å‘è€…ä½¿ç”¨ JavaScript æ¥ç¼–å†™åç«¯ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>fsPromises.rmdir()</code> æ˜¯ä¸€ä¸ªå¤„ç†æ–‡ä»¶ç³»ç»Ÿä¸­ç›®å½•çš„å‡½æ•°ï¼Œç‰¹åˆ«æ˜¯ç”¨äºåˆ é™¤ç›®å½•ã€‚è‡ª Node.js ç‰ˆæœ¬ 14.14.0 èµ·ï¼Œå»ºè®®ä½¿ç”¨ <code>fsPromises.rm()</code> æ›¿ä»£ <code>fsPromises.rmdir()</code> æ¥åˆ é™¤ç›®å½•ï¼Œå› ä¸º <code>rm()</code> æä¾›äº†æ›´ä¸°å¯Œçš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬é€’å½’åˆ é™¤ç›®å½•çš„èƒ½åŠ›ã€‚</p><h3 id="fspromises-rmdir-path-options-1" tabindex="-1"><a class="header-anchor" href="#fspromises-rmdir-path-options-1"><span>fsPromises.rmdir(path[, options])</span></a></h3><p><code>fsPromises.rmdir()</code> å‡½æ•°ä¸»è¦ç”¨äºåˆ é™¤ä¸€ä¸ªç©ºçš„ç›®å½•ã€‚è¿™ä¸ªå‡½æ•°åŸºäº Promise å®ç°ï¼Œæ„å‘³ç€å®ƒè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨ <code>.then()</code> å’Œ <code>.catch()</code> æ–¹æ³•æˆ–è€… async/await è¯­æ³•æ¥å¤„ç†å¼‚æ­¥æ“ä½œçš„æˆåŠŸæˆ–å¤±è´¥ç»“æœã€‚</p><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>path</code>ï¼šéœ€è¦è¢«åˆ é™¤çš„ç›®å½•çš„è·¯å¾„ã€‚</li><li><code>options</code>ï¼ˆå¯é€‰ï¼‰ï¼šä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œå¯ä»¥æŒ‡å®šä¸€äº›é¢å¤–çš„é€‰é¡¹ï¼Œä¸è¿‡åœ¨ Node.js v21.7.1 ç‰ˆæœ¬æ–‡æ¡£ä¸­å¹¶æ²¡æœ‰åˆ—å‡ºæ­¤å‡½æ•°æ”¯æŒçš„ä»»ä½•é€‰é¡¹ã€‚</li></ul><h3 id="ä½¿ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹"><span>ä½¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º <code>testFolder</code> çš„ç©ºç›®å½•ï¼Œæˆ‘ä»¬æƒ³è¦åˆ é™¤å®ƒã€‚</p><h4 id="ç¤ºä¾‹-1-ä½¿ç”¨-then-å’Œ-catch" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ä½¿ç”¨-then-å’Œ-catch"><span>ç¤ºä¾‹ 1ï¼šä½¿ç”¨ <code>.then()</code> å’Œ <code>.catch()</code></span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dirPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./testFolder</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rmdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirPath</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">then</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#D8DEE9;"> console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Directory deleted successfully</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">))</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">error</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#D8DEE9;"> console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error deleting directory:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ<code>fs.rmdir(dirPath)</code> å°è¯•åˆ é™¤ <code>dirPath</code> æŒ‡å‘çš„ç›®å½•ã€‚å¦‚æœç›®å½•æˆåŠŸåˆ é™¤ï¼Œ<code>.then()</code> éƒ¨åˆ†ä¼šæ‰§è¡Œï¼Œå¹¶æ‰“å°ä¸€æ¡æ¶ˆæ¯ <code>&quot;Directory deleted successfully&quot;</code>ã€‚å¦‚æœå‘ç”Ÿé”™è¯¯ï¼ˆä¾‹å¦‚ï¼Œç›®å½•ä¸å­˜åœ¨ï¼Œæˆ–ç›®å½•éç©ºï¼‰ï¼Œåˆ™ <code>.catch()</code> éƒ¨åˆ†ä¼šæ•è·é”™è¯¯ï¼Œå¹¶æ‰“å°å‡ºæ¥ã€‚</p><h4 id="ç¤ºä¾‹-2-ä½¿ç”¨-async-await" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨-async-await"><span>ç¤ºä¾‹ 2ï¼šä½¿ç”¨ async/await</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> deleteDirectory</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dirPath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rmdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Directory deleted successfully</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error deleting directory:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dirPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./testFolder</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#88C0D0;">deleteDirectory</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° <code>deleteDirectory</code>ï¼Œå®ƒå°è¯•åˆ é™¤æŒ‡å®šè·¯å¾„çš„ç›®å½•ã€‚é€šè¿‡ä½¿ç”¨ <code>await</code>ï¼Œæˆ‘ä»¬ç­‰å¾… <code>fs.rmdir(dirPath)</code> å®Œæˆã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œä¹‹åçš„ä»£ç ä¼šç»§ç»­æ‰§è¡Œï¼Œæ‰“å° <code>&quot;Directory deleted successfully&quot;</code>ã€‚å¦‚æœåœ¨å°è¯•åˆ é™¤ç›®å½•æ—¶å‘ç”Ÿé”™è¯¯ï¼Œåˆ™ä¼šæ•è·è¯¥é”™è¯¯ï¼Œå¹¶æ‰“å°ç›¸å…³ä¿¡æ¯ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-6" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-6"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li><code>fsPromises.rmdir()</code> åªèƒ½ç”¨äºåˆ é™¤ç©ºç›®å½•ã€‚å¦‚æœå°è¯•åˆ é™¤åŒ…å«æ–‡ä»¶æˆ–å…¶ä»–ç›®å½•çš„ç›®å½•ï¼Œæ“ä½œå°†å¤±è´¥ã€‚</li><li>å¯¹äºéœ€è¦é€’å½’åˆ é™¤ç›®å½•ï¼ˆåŒ…æ‹¬å…¶æ‰€æœ‰å†…å®¹ï¼‰çš„åœºæ™¯ï¼Œè¯·ä½¿ç”¨ <code>fsPromises.rm()</code> å¹¶è®¾ç½® <code>recursive</code> é€‰é¡¹ä¸º <code>true</code>ã€‚</li></ul><p>ä»¥ä¸Šå°±æ˜¯å¯¹ <code>fsPromises.rmdir()</code> å‡½æ•°çš„è§£é‡Šå’Œä½¿ç”¨ç¤ºä¾‹ã€‚å¸Œæœ›è¿™å¯¹ä½ äº†è§£å¦‚ä½•åœ¨ Node.js ä¸­å¤„ç†ç›®å½•åˆ é™¤æ“ä½œæœ‰æ‰€å¸®åŠ©ï¼</p><h3 id="fspromises-rm-path-options" tabindex="-1"><a class="header-anchor" href="#fspromises-rm-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisesrmpath-options" target="_blank" rel="noopener noreferrer">fsPromises.rm(path[, options])</a></span></a></h3><p><code>fsPromises.rm(path[, options])</code> æ˜¯ Node.js å†…ç½®çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>ï¼‰æ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œç”¨äºå¼‚æ­¥åœ°åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ã€‚</p><h3 id="å‚æ•°è§£é‡Š-6" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-6"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>path</code>: è¿™æ˜¯ä½ æƒ³è¦åˆ é™¤çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><code>options</code>: è¿™æ˜¯å¯é€‰å‚æ•°ï¼Œå®ƒå¯ä»¥åŒ…å«å‡ ä¸ªå±æ€§æ¥ä¿®æ”¹åˆ é™¤æ“ä½œçš„è¡Œä¸ºï¼š <ul><li><code>force</code>: é»˜è®¤ä¸º <code>false</code>ã€‚å¦‚æœè®¾ç½®ä¸º <code>true</code>ï¼Œå³ä½¿è·¯å¾„ä¸å­˜åœ¨ä¹Ÿä¸ä¼šæŠ¥é”™ã€‚</li><li><code>recursive</code>: é»˜è®¤ä¸º <code>false</code>ã€‚å¦‚æœè®¾ç½®ä¸º <code>true</code> å¹¶ä¸” <code>path</code> æ˜¯ä¸€ä¸ªç›®å½•ï¼Œé‚£ä¹ˆè¯¥æ–¹æ³•å°†é€’å½’åœ°åˆ é™¤ç›®å½•åŠå…¶å†…å®¹ã€‚å¦‚æœ <code>path</code> æ˜¯ä¸€ä¸ªéç©ºç›®å½•ï¼Œåˆ™å¿…é¡»è®¾ç½®è¯¥é€‰é¡¹æ‰èƒ½åˆ é™¤ç›®å½•ã€‚</li></ul></li></ul><h3 id="ä½¿ç”¨-fspromises-rm" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-fspromises-rm"><span>ä½¿ç”¨ <code>fsPromises.rm</code></span></a></h3><p>å½“è°ƒç”¨ <code>fsPromises.rm</code> æ–¹æ³•æ—¶ï¼Œå®ƒå°†å°è¯•åˆ é™¤æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚å¦‚æœæ“ä½œå¤±è´¥ï¼ˆä¾‹å¦‚ï¼Œæ–‡ä»¶æ— æ³•åˆ é™¤å› ä¸ºå®ƒä¸å­˜åœ¨æˆ–æ²¡æœ‰æƒé™ç­‰ï¼‰ï¼ŒPromise å°†è¢«æ‹’ç»ï¼Œå¹¶ä¸”é”™è¯¯ä¿¡æ¯ä¼šä¼ é€’åˆ° <code>.catch</code> æ–¹æ³•æˆ–è€… <code>try...catch</code> ç»“æ„ä¸­ç”¨ <code>await</code> å…³é”®å­—å¤„ç†è¯¥ Promise çš„å¼‚æ­¥å‡½æ•°ä¸­ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-9" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-9"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>ä¸‹é¢æˆ‘ä»¬å°†é€šè¿‡å‡ ä¸ªå®ä¾‹æ¥å±•ç¤ºå¦‚ä½•ä½¿ç”¨ <code>fsPromises.rm</code>ï¼š</p><h4 id="åˆ é™¤æ–‡ä»¶-1" tabindex="-1"><a class="header-anchor" href="#åˆ é™¤æ–‡ä»¶-1"><span>åˆ é™¤æ–‡ä»¶</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> deleteFile</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rm</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">The file at </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filePath</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> has been deleted</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Error while deleting the file: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">error</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨è¯¥å‡½æ•°åˆ é™¤ä¸€ä¸ªæ–‡ä»¶</span></span>
<span class="line"><span style="color:#88C0D0;">deleteFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/your/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="åˆ é™¤ç›®å½•" tabindex="-1"><a class="header-anchor" href="#åˆ é™¤ç›®å½•"><span>åˆ é™¤ç›®å½•</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> deleteDirectory</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // æ³¨æ„ï¼šè¦é€’å½’åœ°åˆ é™¤éç©ºç›®å½•ï¼Œéœ€è¦è®¾ç½® recursive ä¸º true</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rm</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> recursive</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">      `</span><span style="color:#A3BE8C;">The directory at </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> has been deleted along with its contents</span><span style="color:#ECEFF4;">`</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    )</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Error while deleting the directory: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">error</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨è¯¥å‡½æ•°åˆ é™¤ä¸€ä¸ªç›®å½•</span></span>
<span class="line"><span style="color:#88C0D0;">deleteDirectory</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/your/directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å¼ºåˆ¶åˆ é™¤-å¿½ç•¥ä¸å­˜åœ¨çš„è·¯å¾„" tabindex="-1"><a class="header-anchor" href="#å¼ºåˆ¶åˆ é™¤-å¿½ç•¥ä¸å­˜åœ¨çš„è·¯å¾„"><span>å¼ºåˆ¶åˆ é™¤ï¼ˆå¿½ç•¥ä¸å­˜åœ¨çš„è·¯å¾„ï¼‰</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> forceDelete</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // å³ä½¿æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¹Ÿä¸ä¼šæŠ¥é”™</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rm</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> force</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">      `</span><span style="color:#A3BE8C;">The file at </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filePath</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> has been deleted, or it was not present</span><span style="color:#ECEFF4;">`</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    )</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">      `</span><span style="color:#A3BE8C;">There was an error but we ignored it because force option is set</span><span style="color:#ECEFF4;">`</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    )</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨è¯¥å‡½æ•°å°è¯•åˆ é™¤ä¸€ä¸ªå¯èƒ½ä¸å­˜åœ¨çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#88C0D0;">forceDelete</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/that/may/not/exist/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™å°±æ˜¯ <code>fsPromises.rm</code> æ–¹æ³•çš„åŸºæœ¬ç”¨æ³•ã€‚è®°ä½ï¼Œå½“å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œæ“ä½œå¯èƒ½ä¼šå¤±è´¥ï¼Œæ‰€ä»¥å§‹ç»ˆè¦è€ƒè™‘å¼‚å¸¸å¤„ç†ä»¥ç¡®ä¿ä½ çš„ç¨‹åºèƒ½å¤Ÿä¼˜é›…åœ°å¤„ç†è¿™äº›é”™è¯¯æƒ…å†µã€‚</p><h3 id="fspromises-stat-path-options" tabindex="-1"><a class="header-anchor" href="#fspromises-stat-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisesstatpath-options" target="_blank" rel="noopener noreferrer">fsPromises.stat(path[, options])</a></span></a></h3><p>å½“ä½ å¼€å§‹ä½¿ç”¨ Node.js å¼€å‘é¡¹ç›®æ—¶ï¼Œå¤„ç†æ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€é¡¹åŸºæœ¬ä¸”é‡è¦çš„æŠ€èƒ½ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>fs</code>æ¨¡å—æä¾›äº†è¿™ä¸ªåŠŸèƒ½ï¼Œå®ƒå¯ä»¥è®©æˆ‘ä»¬è¯»å–ã€å†™å…¥æ–‡ä»¶ï¼Œä»¥åŠæ‰§è¡Œå…¶ä»–ä¸æ–‡ä»¶å’Œç›®å½•ç›¸å…³çš„æ“ä½œã€‚<code>fsPromises.stat()</code>æ–¹æ³•å°±æ˜¯<code>fs</code>æ¨¡å—çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŸºäº Promise çš„å‡½æ•°ï¼Œç”¨äºè·å–å…³äºæ–‡ä»¶æˆ–ç›®å½•çš„ä¿¡æ¯ã€‚</p><h3 id="è§£é‡Š-1" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-1"><span>è§£é‡Š</span></a></h3><p>ç®€å•æ¥è¯´ï¼Œ<code>fsPromises.stat(path[, options])</code>æ–¹æ³•å…è®¸ä½ å¼‚æ­¥åœ°è·å–æ–‡ä»¶æˆ–ç›®å½•çš„çŠ¶æ€ä¿¡æ¯ï¼Œè€Œä¸ä¼šé˜»å¡å…¶ä»–ä»£ç çš„æ‰§è¡Œã€‚è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª promiseï¼ˆæ‰¿è¯ºï¼‰ï¼Œè¿™æ„å‘³ç€å®ƒæœ€ç»ˆä¼šå®Œæˆå¹¶æä¾›ä¸€ä¸ªç»“æœâ€”â€”åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¯å…³äºæ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ã€‚å¦‚æœè¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ï¼ˆä¾‹å¦‚ï¼Œæ–‡ä»¶ä¸å­˜åœ¨ï¼‰ï¼Œpromise å°†ä¼šè¢«æ‹’ç»ï¼Œå¹¶è¿”å›é”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="å‚æ•°-3" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-3"><span>å‚æ•°</span></a></h3><ul><li><code>path</code>: è¿™æ˜¯ä½ æƒ³è¦è·å–ä¿¡æ¯çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><code>options</code>: ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…è®¸ä½ å®šåˆ¶æŸäº›è¡Œä¸ºï¼Œæ¯”å¦‚æŒ‡å®šæ˜¯å¦è·Ÿè¸ªç¬¦å·é“¾æ¥ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¸éœ€è¦ä½¿ç”¨è¿™ä¸ªé€‰é¡¹ã€‚</li></ul><h3 id="è¿”å›å€¼-6" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-6"><span>è¿”å›å€¼</span></a></h3><p>æˆåŠŸè°ƒç”¨åï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªåŒ…å«å¤šç§å±æ€§çš„å¯¹è±¡ï¼Œä¾‹å¦‚ï¼š</p><ul><li><code>size</code>ï¼šæ–‡ä»¶çš„å¤§å°ï¼ˆå­—èŠ‚æ•°ï¼‰ã€‚</li><li><code>isFile()</code>ï¼šå¦‚æœè·¯å¾„æŒ‡å‘ä¸€ä¸ªæ–‡ä»¶åˆ™è¿”å›<code>true</code>ã€‚</li><li><code>isDirectory()</code>ï¼šå¦‚æœè·¯å¾„æŒ‡å‘ä¸€ä¸ªç›®å½•åˆ™è¿”å›<code>true</code>ã€‚</li><li><code>mtime</code>ï¼šæ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-3"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º<code>example.txt</code>çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“è¿™ä¸ªæ–‡ä»¶çš„å¤§å°ï¼Œä»¥åŠå®ƒæ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•ï¼Œæˆ‘ä»¬è¿˜æƒ³çŸ¥é“å®ƒæœ€åè¢«ä¿®æ”¹çš„æ—¶é—´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> getFileStats</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶å¤§å°: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">size</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> å­—èŠ‚</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ˜¯æ–‡ä»¶: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFile</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ˜¯ç›®å½•: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isDirectory</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æœ€åä¿®æ”¹æ—¶é—´: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mtime</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è·å–æ–‡ä»¶çŠ¶æ€æ—¶å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">getFileStats</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº†<code>fs</code>æ¨¡å—çš„ promises APIã€‚ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•°<code>getFileStats</code>ï¼Œå®ƒå°è¯•ä½¿ç”¨<code>fs.stat()</code>è·å–<code>example.txt</code>æ–‡ä»¶çš„çŠ¶æ€ã€‚å¦‚æœæˆåŠŸï¼Œæˆ‘ä»¬å°±æ‰“å°å‡ºæ–‡ä»¶çš„å¤§å°ã€å®ƒæ˜¯å¦æ˜¯æ–‡ä»¶ã€æ˜¯å¦æ˜¯ç›®å½•ä»¥åŠæœ€åä¿®æ”¹æ—¶é—´ã€‚å¦‚æœè¿‡ç¨‹ä¸­é‡åˆ°ä»»ä½•é”™è¯¯ï¼ˆä¾‹å¦‚ï¼Œæ–‡ä»¶ä¸å­˜åœ¨ï¼‰ï¼Œé”™è¯¯ä¼šè¢«æ•è·å¹¶æ‰“å°å‡ºæ¥ã€‚</p><p>ä½¿ç”¨ Node.js çš„<code>fsPromises.stat()</code>æ–¹æ³•ï¼Œå¯ä»¥è®©ä½ åœ¨æ„å»ºåº”ç”¨ç¨‹åºæ—¶ï¼Œè½»æ¾åœ°æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿä¸­å…ƒç´ çš„çŠ¶æ€ï¼Œå¢å¼ºäº†åº”ç”¨çš„äº¤äº’æ€§å’Œçµæ´»æ€§ã€‚</p><h3 id="fspromises-statfs-path-options" tabindex="-1"><a class="header-anchor" href="#fspromises-statfs-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisesstatfspath-options" target="_blank" rel="noopener noreferrer">fsPromises.statfs(path[, options])</a></span></a></h3><p><code>fsPromises.statfs(path[, options])</code> æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼ˆ<code>fs</code>ï¼‰ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºè·å–æ–‡ä»¶ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª Promiseï¼Œå³å®ƒæ˜¯åŸºäº Promise çš„å¼‚æ­¥æ“ä½œï¼Œå¯ä»¥è®©ä½ åœ¨è·å–æ–‡ä»¶ç³»ç»Ÿä¿¡æ¯æ—¶ä¸é˜»å¡ç¨‹åºçš„å…¶å®ƒéƒ¨åˆ†ã€‚</p><p>å½“ä½ è°ƒç”¨ <code>fsPromises.statfs(path[, options])</code> æ—¶ï¼Œå®ƒä¼šè¯»å–æŒ‡å®šè·¯å¾„ <code>path</code> æ‰€åœ¨çš„æ–‡ä»¶ç³»ç»Ÿçš„çŠ¶æ€ã€‚è¿™é‡Œçš„â€œæ–‡ä»¶ç³»ç»Ÿâ€æŒ‡çš„æ˜¯å­˜å‚¨è®¾å¤‡ä¸Šç»„ç»‡å’Œç®¡ç†æ–‡ä»¶çš„æ–¹å¼ï¼Œä¾‹å¦‚ NTFSã€FAT32 æˆ–è€… ext4 ç­‰ã€‚</p><p><code>path</code> å‚æ•°åº”è¯¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºä½ è¦æŸ¥è¯¢çš„æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç‚¹æˆ–ä»»æ„ä½äºæ‰€æŸ¥æ–‡ä»¶ç³»ç»Ÿä¸Šçš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</p><p><code>options</code> å‚æ•°æ˜¯å¯é€‰çš„ï¼Œå…è®¸ä½ æŒ‡å®šä¸€äº›é…ç½®ã€‚</p><p>ä¸‹é¢æ˜¯è¿™ä¸ªå‡½æ•°å¯èƒ½è¿”å›çš„ç»Ÿè®¡ä¿¡æ¯çš„ä¾‹å­ï¼š</p><ul><li><code>type</code>: æ–‡ä»¶ç³»ç»Ÿç±»å‹ã€‚</li><li><code>bsize</code>: æ–‡ä»¶ç³»ç»Ÿå—çš„å¤§å°ã€‚</li><li><code>blocks</code>: æ€»è®¡çš„å—æ•°é‡ã€‚</li><li><code>bfree</code>: ç©ºé—²çš„å—æ•°é‡ã€‚</li><li><code>bavail</code>: éè¶…çº§ç”¨æˆ·å¯è·å–çš„ç©ºé—²å—æ•°é‡ã€‚</li><li><code>files</code>: æ–‡ä»¶èŠ‚ç‚¹æ€»æ•°ã€‚</li><li><code>ffree</code>: ç©ºé—²çš„æ–‡ä»¶èŠ‚ç‚¹æ•°é‡ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-4"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œéœ€è¦æ£€æµ‹ç£ç›˜ç©ºé—´æ˜¯å¦è¶³å¤Ÿè¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œï¼Œæˆ–è€…æƒ³å±•ç¤ºç»™ç”¨æˆ·ä»–ä»¬çš„å­˜å‚¨ç©ºé—´ä½¿ç”¨æƒ…å†µã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>fsPromises.statfs()</code> æ¥è·å–è¿™äº›ä¿¡æ¯ã€‚</p><p>ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨ <code>fsPromises.statfs</code> çš„ç®€å•ä»£ç ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> checkDiskSpace</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statfs</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—å‰©ä½™ç©ºé—´çš„ç™¾åˆ†æ¯”</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> freeSpacePercent</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">bfree</span><span style="color:#81A1C1;"> /</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">blocks</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">*</span><span style="color:#B48EAD;"> 100</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Free space: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">freeSpacePercent</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toFixed</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">%</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error getting file system stats:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨æ­¤åŠŸèƒ½æ¥æ£€æŸ¥æ ¹ç›®å½•çš„ç£ç›˜ç©ºé—´</span></span>
<span class="line"><span style="color:#88C0D0;">checkDiskSpace</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>checkDiskSpace</code> å‡½æ•°æ¥å—ä¸€ä¸ªè·¯å¾„å‚æ•°ï¼Œå¹¶ä½¿ç”¨ <code>await</code> å…³é”®å­—ç­‰å¾… <code>fsPromises.statfs</code> è¿”å›ç»Ÿè®¡ä¿¡æ¯ã€‚ç„¶åå®ƒæ‰“å°å‡ºæ‰€æœ‰çš„ç»Ÿè®¡æ•°æ®ä»¥åŠè®¡ç®—å¹¶æ‰“å°å‡ºå‰©ä½™ç©ºé—´çš„ç™¾åˆ†æ¯”ã€‚å¦‚æœåœ¨å°è¯•è·å–è¿™äº›ä¿¡æ¯æ—¶å‡ºç°é”™è¯¯ï¼Œå®ƒå°†æ•è·é”™è¯¯å¹¶æ‰“å°å‡ºæ¥ã€‚</p><p>è¯·æ³¨æ„ï¼Œç”±äº <code>fsPromises.statfs</code> ç›®å‰å¹¶ä¸æ˜¯æ‰€æœ‰ç‰ˆæœ¬çš„ Node.js éƒ½æœ‰æä¾›ï¼Œåœ¨ç¼–å†™å®é™…åº”ç”¨æ—¶åº”æ£€æŸ¥ Node.js æ–‡æ¡£ï¼Œç¡®ä¿ä½ ä½¿ç”¨çš„ç‰ˆæœ¬æ”¯æŒè¿™ä¸ª APIã€‚</p><h3 id="fspromises-symlink-target-path-type" tabindex="-1"><a class="header-anchor" href="#fspromises-symlink-target-path-type"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisessymlinktarget-path-type" target="_blank" rel="noopener noreferrer">fsPromises.symlink(target, path[, type])</a></span></a></h3><p>Node.js ä¸­çš„ <code>fsPromises.symlink(target, path[, type])</code> æ˜¯ä¸€ä¸ªç”¨äºåˆ›å»ºç¬¦å·é“¾æ¥ï¼ˆsymlinkï¼‰çš„å‡½æ•°ï¼Œå®ƒæ˜¯ fs æ¨¡å—ä¸­ promise ç‰ˆæœ¬çš„ä¸€éƒ¨åˆ†ã€‚è¦ç†è§£è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ˜ç™½ä»€ä¹ˆæ˜¯ç¬¦å·é“¾æ¥ä»¥åŠå®ƒåœ¨å®é™…ä¸­çš„åº”ç”¨ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯ç¬¦å·é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯ç¬¦å·é“¾æ¥"><span>ä»€ä¹ˆæ˜¯ç¬¦å·é“¾æ¥ï¼Ÿ</span></a></h3><p>ç¬¦å·é“¾æ¥ï¼Œä¹Ÿç§°è½¯é“¾æ¥ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ–‡ä»¶ï¼Œå…¶å†…å®¹æ˜¯æŒ‡å‘å¦ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚ä½ å¯ä»¥å°†ç¬¦å·é“¾æ¥æƒ³è±¡æˆå¿«æ·æ–¹å¼ï¼Œåœ¨ Windows ç³»ç»Ÿä¸Šæ›´å¸¸è§ã€‚å®ƒä»¬ä¸åŒ…å«å®é™…æ–‡ä»¶æ•°æ®ï¼Œä»…ä½œä¸ºæŒ‡å‘å…¶ä»–æ–‡ä»¶æˆ–ç›®å½•çš„å¼•ç”¨ã€‚</p><h3 id="fspromises-symlink-target-path-type-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#fspromises-symlink-target-path-type-ç®€ä»‹"><span><code>fsPromises.symlink(target, path[, type])</code> ç®€ä»‹</span></a></h3><p>è¿™ä¸ªå‡½æ•°å…è®¸ä½ ä»¥å¼‚æ­¥çš„æ–¹å¼åˆ›å»ºä¸€ä¸ªç¬¦å·é“¾æ¥ã€‚</p><ul><li><strong>target:</strong> è¿™æ˜¯ä½ æƒ³è¦åˆ›å»ºç¬¦å·é“¾æ¥æŒ‡å‘çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><strong>path:</strong> è¿™æ˜¯ä½ æƒ³è¦åˆ›å»ºçš„ç¬¦å·é“¾æ¥çš„è·¯å¾„ã€‚</li><li><strong>type:</strong> å¯é€‰å‚æ•°ï¼Œä¸»è¦åœ¨ Windows ç³»ç»Ÿä¸­ä½¿ç”¨ï¼ŒæŒ‡å®šé“¾æ¥çš„ç±»å‹ï¼Œé€šå¸¸æ˜¯ <code>&#39;file&#39;</code> æˆ– <code>&#39;dir&#39;</code>ã€‚åœ¨ Unix ç³»ç»Ÿä¸­ï¼Œè¯¥å‚æ•°è¢«å¿½ç•¥ã€‚</li></ul><h3 id="å®é™…ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-1"><span>å®é™…ä¾‹å­</span></a></h3><h4 id="_1-åˆ›å»ºæŒ‡å‘æ–‡ä»¶çš„ç¬¦å·é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#_1-åˆ›å»ºæŒ‡å‘æ–‡ä»¶çš„ç¬¦å·é“¾æ¥"><span>1. åˆ›å»ºæŒ‡å‘æ–‡ä»¶çš„ç¬¦å·é“¾æ¥</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º <code>original.txt</code> çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªæŒ‡å‘å®ƒçš„ç¬¦å·é“¾æ¥ <code>linkToFile.txt</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> createSymlink</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">symlink</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">original.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">linkToFile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç¬¦å·é“¾æ¥åˆ›å»ºæˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">åˆ›å»ºç¬¦å·é“¾æ¥æ—¶å‡ºé”™ï¼š</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">createSymlink</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ä½ å°è¯•é€šè¿‡ <code>linkToFile.txt</code> è®¿é—®æ—¶ï¼Œå®é™…ä¸Šä½ è®¿é—®çš„æ˜¯ <code>original.txt</code> çš„å†…å®¹ã€‚</p><h4 id="_2-åˆ›å»ºæŒ‡å‘ç›®å½•çš„ç¬¦å·é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#_2-åˆ›å»ºæŒ‡å‘ç›®å½•çš„ç¬¦å·é“¾æ¥"><span>2. åˆ›å»ºæŒ‡å‘ç›®å½•çš„ç¬¦å·é“¾æ¥</span></a></h4><p>å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º <code>originalFolder</code> çš„ç›®å½•ï¼Œå¹¶ä¸”æˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªæŒ‡å‘è¿™ä¸ªç›®å½•çš„ç¬¦å·é“¾æ¥ <code>linkToFolder</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> createDirectorySymlink</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">symlink</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">originalFolder</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">linkToFolder</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">dir</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åœ¨Windowsä¸Šæ˜¾å¼æŒ‡å®š&#39;type&#39;ä¸º&#39;dir&#39;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•çš„ç¬¦å·é“¾æ¥åˆ›å»ºæˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">åˆ›å»ºç›®å½•çš„ç¬¦å·é“¾æ¥æ—¶å‡ºé”™ï¼š</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">createDirectorySymlink</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ï¼Œæ— è®ºä½•æ—¶ä½ è®¿é—® <code>linkToFolder</code>ï¼Œå®é™…ä¸Šè®¿é—®çš„æ˜¯ <code>originalFolder</code> ç›®å½•ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-7" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-7"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>ç¬¦å·é“¾æ¥åˆ›å»ºåï¼Œå®ƒå°†ç»§ç»­æŒ‡å‘åŸå§‹ç›®æ ‡ï¼Œå³ä½¿åæ¥ç›®æ ‡è¢«ç§»åŠ¨æˆ–åˆ é™¤ã€‚å¦‚æœç›®æ ‡è¢«åˆ é™¤ï¼Œç¬¦å·é“¾æ¥å°†æˆä¸ºæ–­é“¾ï¼ŒæŒ‡å‘ä¸€ä¸ªä¸å­˜åœ¨çš„è·¯å¾„ã€‚</li><li>åœ¨æŸäº›æ“ä½œç³»ç»Ÿä¸Šï¼Œåˆ›å»ºæŒ‡å‘ç›®å½•çš„ç¬¦å·é“¾æ¥å¯èƒ½éœ€è¦ç®¡ç†å‘˜æƒé™æˆ–ç‰¹å®šçš„æƒé™è®¾ç½®ã€‚</li></ul><p>é€šè¿‡ä¸Šè¿°ä¾‹å­å’Œè§£é‡Šï¼Œå¸Œæœ›èƒ½å¸®åŠ©ä½ ç†è§£ Node.js ä¸­å¦‚ä½•ä½¿ç”¨ <code>fsPromises.symlink</code> å‡½æ•°åˆ›å»ºç¬¦å·é“¾æ¥ã€‚</p><h3 id="fspromises-truncate-path-len" tabindex="-1"><a class="header-anchor" href="#fspromises-truncate-path-len"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisestruncatepath-len" target="_blank" rel="noopener noreferrer">fsPromises.truncate(path[, len])</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­<code>fsPromises.truncate(path[, len])</code>çš„æ¦‚å¿µå’Œç”¨æ³•ï¼Œå°½é‡é€šä¿—æ˜“æ‡‚ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-5" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-5"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>fsPromises</code>å¯¹è±¡æ˜¯<code>fs</code> (æ–‡ä»¶ç³»ç»Ÿ) æ¨¡å—çš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œå®ƒæä¾›äº†åŸºäº Promise çš„ API æ¥å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ“ä½œã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨æ›´ç°ä»£çš„ã€å¼‚æ­¥çš„æ–¹å¼æ¥æ“ä½œæ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„å›è°ƒå‡½æ•°æ–¹æ³•ã€‚</p><p><code>fsPromises.truncate()</code>æ˜¯è¿™ä¸ªå¯¹è±¡ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨äºæ”¹å˜ä¸€ä¸ªæ–‡ä»¶çš„å¤§å°ã€‚å¦‚æœæ–‡ä»¶æ¯”æŒ‡å®šçš„é•¿åº¦é•¿ï¼Œé‚£ä¹ˆå¤šå‡ºæ¥çš„éƒ¨åˆ†å°†ä¼šè¢«æˆªæ‰ï¼›å¦‚æœæ–‡ä»¶æ¯”æŒ‡å®šçš„é•¿åº¦çŸ­ï¼Œåˆ™ä¼šåœ¨æ–‡ä»¶æœ«å°¾å¡«å……<code>\0</code>ï¼ˆå³ NULL å­—ç¬¦ï¼‰ï¼Œç›´åˆ°è¾¾åˆ°æŒ‡å®šçš„é•¿åº¦ã€‚</p><h3 id="å‚æ•°è§£é‡Š-7" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-7"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>path</code>: è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ– Bufferï¼Œè¡¨ç¤ºè¦è¢«æˆªå–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚</li><li><code>len</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œé»˜è®¤å€¼ä¸º 0ã€‚å®ƒè¡¨ç¤ºæ–‡ä»¶ä¿®æ”¹ååº”è¯¥ä¿ç•™çš„å­—èŠ‚é•¿åº¦ã€‚</li></ul><h3 id="å¦‚ä½•ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>é¦–å…ˆï¼Œç¡®ä¿ä½ åœ¨é¡¹ç›®ä¸­å·²ç»å¼•å…¥äº†<code>fs</code>æ¨¡å—ï¼Œå¹¶ä¸”ä½¿ç”¨<code>promises</code>å±æ€§è·å–åˆ°<code>fsPromises</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-1-æˆªæ–­æ–‡ä»¶è‡³ç‰¹å®šé•¿åº¦" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æˆªæ–­æ–‡ä»¶è‡³ç‰¹å®šé•¿åº¦"><span>ç¤ºä¾‹ 1ï¼šæˆªæ–­æ–‡ä»¶è‡³ç‰¹å®šé•¿åº¦</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º<code>example.txt</code>çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>Hello, world! This is a test file.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç°åœ¨ï¼Œæˆ‘ä»¬æƒ³å°†è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹æˆªæ–­åˆ°å‰ 5 ä¸ªå­—ç¬¦ï¼Œå‰©ä¸‹çš„å†…å®¹éƒ½åˆ é™¤ã€‚ä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> truncateExample</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">truncate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 5</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File truncated successfully.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error truncating file:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">truncateExample</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œè¿™æ®µä»£ç åï¼Œ<code>example.txt</code>ä¸­çš„å†…å®¹å°†å˜ä¸º<code>Hello</code>ã€‚</p><h4 id="ç¤ºä¾‹-2-æ‰©å±•æ–‡ä»¶é•¿åº¦" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æ‰©å±•æ–‡ä»¶é•¿åº¦"><span>ç¤ºä¾‹ 2ï¼šæ‰©å±•æ–‡ä»¶é•¿åº¦</span></a></h4><p>å‡è®¾åŒæ ·çš„<code>example.txt</code>æ–‡ä»¶ï¼Œç°åœ¨æˆ‘ä»¬æƒ³è®©å®ƒçš„å¤§å°å˜æˆ 25 ä¸ªå­—èŠ‚ã€‚ç”±äºåŸæ–‡ä»¶é•¿åº¦å°äº 25ï¼Œæ‰€ä»¥ä¼šåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ <code>\0</code>ç›´åˆ°æ–‡ä»¶çš„æ€»é•¿åº¦è¾¾åˆ° 25ã€‚ä½ å¯ä»¥è¿™æ ·å®ç°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> extendFile</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">truncate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 25</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File extended successfully.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error extending file:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">extendFile</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œä¸Šè¿°ä»£ç åï¼Œå¦‚æœä½ æŸ¥çœ‹<code>example.txt</code>çš„å†…å®¹ï¼Œå¯èƒ½æ— æ³•ç›´æ¥çœ‹åˆ°æ–°å¢åŠ çš„ NULL å­—ç¬¦ï¼Œä½†æ–‡ä»¶çš„å¤§å°ç¡®å®å˜æˆäº† 25 å­—èŠ‚ã€‚</p><h3 id="æ€»ç»“-5" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-5"><span>æ€»ç»“</span></a></h3><p><code>fsPromises.truncate()</code>æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„æ–¹æ³•ï¼Œç”¨äºæ›´æ”¹æ–‡ä»¶çš„å¤§å°ã€‚é€šè¿‡æˆªæ–­è¶…å‡ºçš„å†…å®¹æˆ–è€…åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ç©ºå­—ç¬¦ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°ç®¡ç†æ–‡ä»¶çš„å°ºå¯¸ã€‚åœ¨å¤„ç†æ—¥å¿—æ–‡ä»¶æˆ–å¯¹æ–‡ä»¶å¤§å°æœ‰ç‰¹æ®Šè¦æ±‚çš„åœºæ™¯ä¸‹å°¤å…¶æœ‰ç”¨ã€‚</p><h3 id="fspromises-unlink-path" tabindex="-1"><a class="header-anchor" href="#fspromises-unlink-path"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisesunlinkpath" target="_blank" rel="noopener noreferrer">fsPromises.unlink(path)</a></span></a></h3><p><code>fsPromises.unlink(path)</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºå¼‚æ­¥åœ°åˆ é™¤æ–‡ä»¶ã€‚è¿™ä¸ªæ–¹æ³•å±äº <code>fs/promises</code> æ¨¡å—ï¼Œè¯¥æ¨¡å—æä¾›äº†åŸºäº Promise çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œ APIã€‚åœ¨ Node.js ä¸­å¤„ç†æ–‡ä»¶å’Œç›®å½•æ—¶ï¼Œç»å¸¸ä¼šä½¿ç”¨åˆ°è¿™ä¸ªæ¨¡å—ã€‚</p><h3 id="è§£é‡Š-2" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-2"><span>è§£é‡Š</span></a></h3><ul><li><strong>å¼‚æ­¥æ“ä½œï¼š</strong> åœ¨ Node.js ä¸­ï¼Œå¼‚æ­¥æ“ä½œæŒ‡çš„æ˜¯åœ¨æ‰§è¡ŒæŸé¡¹æ“ä½œï¼ˆå¦‚æ–‡ä»¶è¯»å†™ï¼‰æ—¶ï¼Œä¸ä¼šé˜»å¡ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ã€‚ç¨‹åºä¼šç»§ç»­æ‰§è¡Œä¸‹å»ï¼Œä¸€æ—¦æ“ä½œå®Œæˆï¼Œé€šè¿‡å›è°ƒå‡½æ•°æˆ–è€… Promise æ¥å¤„ç†ç»“æœã€‚<code>fsPromises.unlink</code> è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œä½¿å¾—ä½ å¯ä»¥ä½¿ç”¨ <code>.then()</code> å’Œ <code>.catch()</code> æ–¹æ³•æ¥å¤„ç†æˆåŠŸæˆ–å¤±è´¥çš„æƒ…å†µã€‚</li><li><strong>Promiseï¼š</strong> æ˜¯ JavaScript ä¸­çš„ä¸€ä¸ªå¯¹è±¡ï¼Œä»£è¡¨äº†æŸä¸ªå¼‚æ­¥æ“ä½œçš„æœ€ç»ˆå®Œæˆ (æˆ–å¤±è´¥) åŠå…¶ç»“æœå€¼ã€‚ä½¿ç”¨ Promise å¯ä»¥æ›´ç®€æ´æ˜äº†åœ°è¿›è¡Œå¼‚æ­¥ç¼–ç¨‹ï¼Œé¿å…æ‰€è°“çš„â€œå›è°ƒåœ°ç‹±â€ã€‚</li></ul><h3 id="ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#ç”¨æ³•"><span>ç”¨æ³•</span></a></h3><p>å½“ä½ æƒ³è¦åˆ é™¤ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>fsPromises.unlink(path)</code> æ–¹æ³•ã€‚è¿™é‡Œçš„ <code>path</code> æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šäº†è¦åˆ é™¤æ–‡ä»¶çš„è·¯å¾„ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> deleteFile</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unlink</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Deleted file: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filePath</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Error deleting file: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filePath</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨å‡½æ•°ï¼Œå°è¯•åˆ é™¤ &quot;example.txt&quot;</span></span>
<span class="line"><span style="color:#88C0D0;">deleteFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨ä¾‹å­-10" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-10"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><strong>æ¸…ç†ä¸´æ—¶æ–‡ä»¶æˆ–æ—¥å¿—ï¼š</strong> åœ¨åº”ç”¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šç”Ÿæˆä¸€äº›ä¸´æ—¶æ–‡ä»¶æˆ–æ—¥å¿—æ–‡ä»¶ã€‚å®Œæˆç›¸å…³ä»»åŠ¡åï¼Œå¯ä»¥ä½¿ç”¨ <code>fsPromises.unlink</code> åˆ é™¤è¿™äº›ä¸å†éœ€è¦çš„æ–‡ä»¶ï¼Œä»¥èŠ‚çœå­˜å‚¨ç©ºé—´ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸´æ—¶æ—¥å¿—æ–‡ä»¶ temp-log.txt éœ€è¦è¢«æ¸…ç†</span></span>
<span class="line"><span style="color:#88C0D0;">deleteFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./temp-log.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ç®¡ç†ï¼š</strong> å¦‚æœä½ å¼€å‘äº†ä¸€ä¸ªå…è®¸ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶çš„ç½‘ç«™ï¼Œç”¨æˆ·å¯èƒ½å¸Œæœ›åˆ é™¤ä»–ä»¬ä¸Šä¼ çš„æ–‡ä»¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“ç”¨æˆ·è¯·æ±‚åˆ é™¤ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>fsPromises.unlink</code> æ¥ç§»é™¤æœåŠ¡å™¨ä¸Šçš„ç›¸åº”æ–‡ä»¶ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å‡è®¾ç”¨æˆ·å†³å®šåˆ é™¤ä»–ä»¬çš„å¤´åƒå›¾ç‰‡ avatar.jpg</span></span>
<span class="line"><span style="color:#88C0D0;">deleteFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./uploads/avatar.jpg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>è‡ªåŠ¨åŒ–æµ‹è¯•ä¸­çš„æ¸…ç†å·¥ä½œï¼š</strong> åœ¨è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•æ—¶ï¼Œæµ‹è¯•è„šæœ¬å¯èƒ½ä¼šåˆ›å»ºè®¸å¤šæµ‹è¯•æ–‡ä»¶ã€‚æµ‹è¯•å®Œæˆåï¼Œä½¿ç”¨ <code>fsPromises.unlink</code> åˆ é™¤è¿™äº›æ–‡ä»¶ï¼Œå¯ä»¥ä¿æŒæµ‹è¯•ç¯å¢ƒçš„æ•´æ´ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// æµ‹è¯•ç»“æŸï¼Œåˆ é™¤æµ‹è¯•ç”Ÿæˆçš„æ–‡ä»¶ test-output.txt</span></span>
<span class="line"><span style="color:#88C0D0;">deleteFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./test-output.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>fsPromises.unlink</code> åœ¨æ–‡ä»¶æ“ä½œä¸­çš„å®é™…åº”ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦åˆ é™¤æ–‡ä»¶æ—¶ã€‚å®ƒç®€å•ã€é«˜æ•ˆï¼Œå¹¶ä¸”èƒ½å¤Ÿå¾ˆå¥½åœ°é›†æˆè¿›åŸºäº Promise çš„å¼‚æ­¥ç¼–ç¨‹æ¨¡å¼ä¸­ã€‚</p><h3 id="fspromises-utimes-path-atime-mtime" tabindex="-1"><a class="header-anchor" href="#fspromises-utimes-path-atime-mtime"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisesutimespath-atime-mtime" target="_blank" rel="noopener noreferrer">fsPromises.utimes(path, atime, mtime)</a></span></a></h3><p>å½“ç„¶ï¼Œè®©æˆ‘ä»¬æ¥è°ˆè°ˆ Node.js ä¸­ <code>fsPromises.utimes</code> è¿™ä¸ªå‡½æ•°ã€‚</p><p>é¦–å…ˆï¼Œ<code>fsPromises</code> æŒ‡çš„æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼ˆFile System moduleï¼‰çš„ä¸€ä¸ªç‰¹æ®Šç‰ˆæœ¬ï¼Œå®ƒæä¾›äº†åŸºäº Promise çš„ APIã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨ <code>.then()</code> å’Œ <code>.catch()</code> æ–¹æ³•ï¼Œæˆ–è€…åœ¨å¼‚æ­¥å‡½æ•°ä¸­ä½¿ç”¨ <code>await</code> å…³é”®å­—æ¥å¤„ç†å¼‚æ­¥æ“ä½œã€‚è€Œ <code>utimes</code> å‡½æ•°åˆ™æ˜¯ç”¨æ¥æ›´æ–°æ–‡ä»¶çš„è®¿é—®æ—¶é—´ï¼ˆatimeï¼‰å’Œä¿®æ”¹æ—¶é—´ï¼ˆmtimeï¼‰ã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>path</code>: æŒ‡çš„æ˜¯è¦æ›´æ”¹å…¶æ—¶é—´æˆ³çš„æ–‡ä»¶çš„è·¯å¾„ã€‚</li><li><code>atime</code>: æŒ‡çš„æ˜¯æ–‡ä»¶çš„&quot;è®¿é—®æ—¶é—´&quot;ï¼Œè¡¨ç¤ºæœ€åä¸€æ¬¡è®¿é—®è¯¥æ–‡ä»¶çš„æ—¶é—´ã€‚</li><li><code>mtime</code>: æŒ‡çš„æ˜¯æ–‡ä»¶çš„&quot;ä¿®æ”¹æ—¶é—´&quot;ï¼Œè¡¨ç¤ºæœ€åä¸€æ¬¡ä¿®æ”¹è¯¥æ–‡ä»¶å†…å®¹çš„æ—¶é—´ã€‚</li></ul><p>è¿™äº›æ—¶é—´å€¼é€šå¸¸ç”±æ–‡ä»¶ç³»ç»Ÿè‡ªåŠ¨æ›´æ–°ï¼Œä½†æœ‰æ—¶å€™ä½ å¯èƒ½éœ€è¦æ‰‹åŠ¨è®¾ç½®æˆ–ä¿®æ”¹å®ƒä»¬ï¼Œæ¯”å¦‚ä¸ºäº†æµ‹è¯•ã€ä»¿ä½›æ–‡ä»¶åˆšè¢«è®¿é—®è¿‡æˆ–ä¿®æ”¹è¿‡ï¼Œåˆæˆ–è€…æ¢å¤æ–‡ä»¶çš„åŸå§‹æ—¶é—´æˆ³ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡å‡ ä¸ªä¾‹å­æ¥çœ‹çœ‹ <code>fsPromises.utimes</code> æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š</p><h3 id="ç¤ºä¾‹-1-æ›´æ–°æ–‡ä»¶æ—¶é—´æˆ³" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æ›´æ–°æ–‡ä»¶æ—¶é—´æˆ³"><span>ç¤ºä¾‹ 1ï¼šæ›´æ–°æ–‡ä»¶æ—¶é—´æˆ³</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> updateFileTimestamps</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // åˆ›å»ºä¸€ä¸ªæ–°çš„ Date å¯¹è±¡è¡¨ç¤ºå½“å‰æ—¶é—´</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> newTime</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // æ›´æ–°æ–‡ä»¶çš„è®¿é—®æ—¶é—´å’Œä¿®æ”¹æ—¶é—´ä¸ºå½“å‰æ—¶é—´</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">utimes</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> newTime</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> newTime</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Time stamps of </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filePath</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> updated successfully.</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error updating time stamps:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾ &#39;example.txt&#39; æ˜¯å­˜åœ¨çš„æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#88C0D0;">updateFileTimestamps</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° <code>updateFileTimestamps</code>ï¼Œå®ƒæ¥å—ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ <code>filePath</code> ä½œä¸ºå‚æ•°ï¼Œå¹¶ä¸”ä½¿ç”¨ <code>fsPromises.utimes</code> å‡½æ•°å°†è¯¥æ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´éƒ½è®¾ç½®ä¸ºå½“å‰æ—¶é—´ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œå°±ä¼šæ‰“å°ä¸€æ¡æˆåŠŸæ¶ˆæ¯ï¼›å¦‚æœå‡ºç°é”™è¯¯ï¼Œåˆ™ä¼šæ•è·å¹¶æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="ç¤ºä¾‹-2-ä½¿ç”¨ç‰¹å®šçš„æ—¶é—´æˆ³" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨ç‰¹å®šçš„æ—¶é—´æˆ³"><span>ç¤ºä¾‹ 2ï¼šä½¿ç”¨ç‰¹å®šçš„æ—¶é—´æˆ³</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> setFileTimestamps</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> accessTime</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> modifiedTime</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // è®¾ç½®æ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´ä¸ºç‰¹å®šçš„æ—¶é—´æˆ³</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">utimes</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> accessTime</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> modifiedTime</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">      `</span><span style="color:#A3BE8C;">Set the timestamps of </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filePath</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> to access time: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">accessTime</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">, modified time: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">modifiedTime</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    )</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Failed to set the timestamps:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨å­—ç¬¦ä¸²è¡¨ç¤ºç‰¹å®šçš„æ—¥æœŸå’Œæ—¶é—´</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> accessTimeString</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">2023-01-01T00:00:00.000Z</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // UTC æ—¶é—´æ ¼å¼</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> modifiedTimeString</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">2023-01-02T00:00:00.000Z</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å°†å­—ç¬¦ä¸²è½¬æ¢ä¸º Date å¯¹è±¡</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> accessTime</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">accessTimeString</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> modifiedTime</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">modifiedTimeString</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾ &#39;example.txt&#39; æ˜¯å­˜åœ¨çš„æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#88C0D0;">setFileTimestamps</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> accessTime</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> modifiedTime</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° <code>setFileTimestamps</code>ï¼Œå®ƒå…è®¸ä½ è®¾ç½®æ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´ä¸ºç‰¹å®šçš„æ—¶é—´æˆ³ã€‚è¿™é‡Œæˆ‘ä»¬ä¼ é€’äº†å­—ç¬¦ä¸²å½¢å¼çš„æ—¶é—´ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸º JavaScript çš„ Date å¯¹è±¡ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™äº› Date å¯¹è±¡ä½œä¸º <code>fsPromises.utimes</code> çš„å‚æ•°æ¥æ›´æ–°æ–‡ä»¶çš„æ—¶é—´æˆ³ã€‚æˆåŠŸæ‰§è¡Œåä¼šæ‰“å°ä¸€æ¡åŒ…å«æ‰€è®¾ç½®æ—¶é—´çš„æ¶ˆæ¯ï¼Œå¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œåˆ™ä¼šæ•è·å¹¶æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚</p><p>è¿™æ ·ï¼Œä½ å°±èƒ½ä½¿ç”¨ <code>fsPromises.utimes</code> æ¥æ›´æ–°æ–‡ä»¶çš„æ—¶é—´æˆ³äº†ã€‚è®°ä½ï¼Œè™½ç„¶æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨è®¾ç½®è¿™äº›æ—¶é—´æˆ³ï¼Œä½†åœ¨çœŸå®åœºæ™¯ä¸­åº”è¯¥æ…é‡ä½¿ç”¨ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸ç”¨äºè®°å½•æ–‡ä»¶çš„å®é™…ä½¿ç”¨æƒ…å†µã€‚</p><h3 id="fspromises-watch-filename-options" tabindex="-1"><a class="header-anchor" href="#fspromises-watch-filename-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromiseswatchfilename-options" target="_blank" rel="noopener noreferrer">fsPromises.watch(filename[, options])</a></span></a></h3><p><code>fsPromises.watch</code> æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ä¸­ä¸€ä¸ªç”¨äºç›‘è§†æ–‡ä»¶æˆ–ç›®å½•æ›´æ”¹çš„å‡½æ•°ã€‚å½“ä½ ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ—¶ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ª <code>AsyncIterator</code>ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥é€šè¿‡å¼‚æ­¥è¿­ä»£å™¨æ¥å£æ¥å¤„ç†æ–‡ä»¶æˆ–è€…ç›®å½•å‘ç”Ÿçš„å˜åŒ–ã€‚</p><h3 id="ä½¿ç”¨æ–¹æ³•-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-1"><span>ä½¿ç”¨æ–¹æ³•</span></a></h3><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œä½ å¯ä»¥è¿™æ ·ä½¿ç”¨ <code>fsPromises.watch</code> å‡½æ•°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> watchFile</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filename</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> asyncIterator</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fsPromises</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filename</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    for</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> event</span><span style="color:#81A1C1;"> of</span><span style="color:#D8DEE9;"> asyncIterator</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶å‘ç”Ÿäº†å˜åŒ–ï¼š</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">event</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">ç›‘è§†æ–‡ä»¶æ—¶å‡ºé”™: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">error</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">watchFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¼•å…¥äº† <code>fs/promises</code> æ¨¡å—ï¼Œå¹¶å®šä¹‰äº†ä¸€ä¸ª <code>watchFile</code> å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ¥æ”¶ä¸€ä¸ªå‚æ•° <code>filename</code>ï¼Œå³ä½ æƒ³è¦ç›‘è§†çš„æ–‡ä»¶åã€‚ç„¶åä½¿ç”¨ <code>fsPromises.watch</code> æ¥åˆ›å»ºä¸€ä¸ªå¼‚æ­¥è¿­ä»£å™¨ <code>asyncIterator</code>ã€‚ä½¿ç”¨ <code>for await...of</code> å¾ªç¯æ¥ç›‘å¬å¹¶æ‰“å°æ¯æ¬¡æ–‡ä»¶æˆ–ç›®å½•å˜åŒ–çš„äº‹ä»¶ã€‚</p><h3 id="å‚æ•°è§£é‡Š-8" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-8"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>filename</code>: è¿™æ˜¯éœ€è¦è¢«ç›‘è§†çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><code>options</code> (å¯é€‰): ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥åŒ…å«ä¸€äº›é…ç½®é¡¹æ¯”å¦‚ï¼š <ul><li><code>persistent</code>: è¡¨ç¤ºæ˜¯å¦åœ¨ç›‘æ§æœŸå†…ä¿æŒè¿›ç¨‹æ´»è·ƒï¼Œé»˜è®¤ä¸º <code>true</code>ã€‚</li><li><code>recursive</code>: æ˜¯å¦é€’å½’åœ°ç›‘æ§ç›®å½•ä¸‹çš„æ‰€æœ‰å­ç›®å½•ï¼Œé»˜è®¤åœ¨ Windows å’Œ macOS ä¸Šæ˜¯ <code>true</code>ï¼Œåœ¨å…¶ä»–å¹³å°æ˜¯ <code>false</code>ã€‚</li><li><code>encoding</code>: ç”¨äºæŒ‡å®šæ–‡ä»¶åçš„å­—ç¬¦ç¼–ç ï¼Œé»˜è®¤ä¸º <code>&#39;utf8&#39;</code>ã€‚</li></ul></li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-11" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-11"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="ç›‘è§†å•ä¸ªæ–‡ä»¶çš„å˜åŒ–" tabindex="-1"><a class="header-anchor" href="#ç›‘è§†å•ä¸ªæ–‡ä»¶çš„å˜åŒ–"><span>ç›‘è§†å•ä¸ªæ–‡ä»¶çš„å˜åŒ–</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// ç›‘å¬ &#39;config.json&#39; æ–‡ä»¶çš„å˜åŒ–</span></span>
<span class="line"><span style="color:#88C0D0;">watchFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœ <code>config.json</code> å‘ç”Ÿä»»ä½•å†™å…¥æ“ä½œï¼Œä¾‹å¦‚å†…å®¹çš„å˜åŒ–ã€æ–‡ä»¶è¢«åˆ é™¤æˆ–é‡å‘½åï¼Œ<code>watchFile</code> å‡½æ•°å°†ä¼šæ‰“å°å‡ºç›¸å…³çš„äº‹ä»¶ä¿¡æ¯ã€‚</p><h4 id="ç›‘è§†æ•´ä¸ªç›®å½•çš„å˜åŒ–" tabindex="-1"><a class="header-anchor" href="#ç›‘è§†æ•´ä¸ªç›®å½•çš„å˜åŒ–"><span>ç›‘è§†æ•´ä¸ªç›®å½•çš„å˜åŒ–</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// ç›‘å¬æ•´ä¸ª &#39;logs&#39; ç›®å½•çš„å˜åŒ–ï¼ˆåŒ…æ‹¬å­ç›®å½•ï¼‰</span></span>
<span class="line"><span style="color:#88C0D0;">watchFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">logs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™é‡Œï¼Œå¦‚æœ <code>logs</code> ç›®å½•å†…çš„ä»»ä½•æ–‡ä»¶å‘ç”Ÿäº†å˜åŒ–ï¼Œæˆ–è€…æœ‰æ–°æ–‡ä»¶è¢«æ·»åŠ åˆ°ç›®å½•ä¸­ï¼Œéƒ½å°†è§¦å‘æ‰“å°äº‹ä»¶ä¿¡æ¯ã€‚</p><p>æ³¨æ„ï¼Œå› ä¸º <code>fsPromises.watch</code> æ˜¯åŸºäºæ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿé€šçŸ¥æœºåˆ¶ï¼Œä¸åŒçš„å¹³å°å¯èƒ½ä¼šæœ‰ä¸åŒçš„é™åˆ¶å’Œè¡Œä¸ºã€‚è€Œä¸”ï¼Œå¯¹äºé«˜é¢‘ç‡çš„æ–‡ä»¶å˜åŒ–ï¼Œäº‹ä»¶é€šçŸ¥å¯èƒ½ä¼šåˆå¹¶ï¼Œä¸ä¼šä¸ºæ¯ä¸ªå˜æ›´éƒ½å‘é€å•ç‹¬çš„äº‹ä»¶ã€‚æ‰€ä»¥ï¼Œè¿™ä¸ª API ä¸é€‚åˆç”¨äºå®ç°é«˜ç²¾åº¦çš„æ–‡ä»¶ç›‘è§†ã€‚</p><h3 id="fspromises-writefile-file-data-options" tabindex="-1"><a class="header-anchor" href="#fspromises-writefile-file-data-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromiseswritefilefile-data-options" target="_blank" rel="noopener noreferrer">fsPromises.writeFile(file, data[, options])</a></span></a></h3><p>Node.js çš„<code>fsPromises.writeFile(file, data[, options])</code>æ–¹æ³•æ˜¯ä¸€ä¸ªç”¨äºå¼‚æ­¥æ–‡ä»¶å†™å…¥æ“ä½œçš„å‡½æ•°ï¼Œå®ƒæ¥è‡ªäº Node.js çš„æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼ˆ<code>fs</code>æ¨¡å—ï¼‰çš„<code>promises</code>æ¥å£ã€‚ç®€å•åœ°è¯´ï¼Œè¿™ä¸ªæ–¹æ³•å…è®¸ä½ å°†æ•°æ®å†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œå®ƒä¼šè¢«åˆ›å»ºã€‚</p><h3 id="å‚æ•°è§£é‡Š-9" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-9"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>file</code>: è¿™æ˜¯æŒ‡å®šè¦å†™å…¥æ•°æ®çš„æ–‡ä»¶çš„è·¯å¾„æˆ–è€…æ–‡ä»¶æè¿°ç¬¦ã€‚æ–‡ä»¶è·¯å¾„å¯ä»¥æ˜¯å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯ URL æˆ–è€… Buffer å¯¹è±¡ã€‚</li><li><code>data</code>: è¦å†™å…¥æ–‡ä»¶çš„æ•°æ®ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€Bufferã€æˆ–è€… TypedArrayã€‚</li><li><code>options</code> (å¯é€‰): ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨äºæŒ‡å®šå†™å…¥æ“ä½œçš„å…·ä½“è¡Œä¸ºã€‚å¸¸è§çš„é€‰é¡¹åŒ…æ‹¬ï¼š <ul><li><code>encoding</code>: å­—ç¬¦ç¼–ç ï¼Œé»˜è®¤æ˜¯<code>&#39;utf8&#39;</code>ã€‚</li><li><code>mode</code>: æ–‡ä»¶ç³»ç»Ÿæƒé™ï¼Œé»˜è®¤æ˜¯<code>0o666</code>ã€‚</li><li><code>flag</code>: æŒ‡å®šå¦‚ä½•æ“ä½œæ–‡ä»¶ï¼Œé»˜è®¤æ˜¯<code>&#39;w&#39;</code>ï¼Œè¡¨ç¤ºå†™å…¥æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶å·²å­˜åœ¨åˆ™è¦†ç›–ã€‚</li></ul></li></ul><h3 id="ä½¿ç”¨ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­-2"><span>ä½¿ç”¨ä¾‹å­</span></a></h3><h4 id="åŸºæœ¬ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç¤ºä¾‹"><span>åŸºæœ¬ç¤ºä¾‹</span></a></h4><p>æ¯”å¦‚ï¼Œå¦‚æœä½ æƒ³åœ¨ä½ çš„é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡æœ¬æ–‡ä»¶å¹¶å†™å…¥ä¸€äº›å†…å®¹ï¼Œä»£ç å¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> createAndWriteFile</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, this is some text!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">      encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File written successfully</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Failed to write file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">createAndWriteFile</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè½½å…¥äº† Node.js çš„<code>fs.promises</code>APIã€‚ç„¶åå®šä¹‰äº†ä¸€ä¸ª<code>async</code>å‡½æ•°<code>createAndWriteFile</code>ï¼Œåœ¨è¿™ä¸ªå‡½æ•°å†…ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>await</code>å…³é”®å­—è°ƒç”¨äº†<code>fsPromises.writeFile</code>æ–¹æ³•å†™å…¥æ•°æ®åˆ°<code>example.txt</code>æ–‡ä»¶ä¸­ã€‚å¦‚æœæ–‡ä»¶å†™å…¥æˆåŠŸï¼Œæ§åˆ¶å°ä¼šè¾“å‡ºä¸€æ¡æ¶ˆæ¯ç¡®è®¤ã€‚å¦‚æœæ“ä½œå¤±è´¥ï¼ˆä¾‹å¦‚ï¼Œç”±äºæƒé™é—®é¢˜ï¼‰ï¼Œé”™è¯¯ä¼šè¢«æ•è·å¹¶æ‰“å°å‡ºæ¥ã€‚</p><h4 id="å†™å…¥-json-æ•°æ®" tabindex="-1"><a class="header-anchor" href="#å†™å…¥-json-æ•°æ®"><span>å†™å…¥ JSON æ•°æ®</span></a></h4><p>å¦ä¸€ä¸ªå®é™…çš„ä¾‹å­å¯èƒ½æ˜¯ä½ æƒ³æŠŠä¸€äº›æ•°æ®ä¿å­˜ä¸º JSON æ ¼å¼ã€‚ä¸‹é¢çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•å°†ä¸€ä¸ª JavaScript å¯¹è±¡å†™å…¥åˆ°ä¸€ä¸ª JSON æ–‡ä»¶ä¸­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> saveDataToFile</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">    name</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Node.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#88C0D0;">    type</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Runtime Environment</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">data.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> JSON</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stringify</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">JSON data written successfully</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Failed to write JSON data</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">saveDataToFile</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªåŒ…å«ä¸€äº›æ•°æ®çš„å¯¹è±¡<code>data</code>ã€‚ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡<code>JSON.stringify(data)</code>å°†è¿™ä¸ªå¯¹è±¡è½¬æ¢æˆä¸€ä¸ª JSON å­—ç¬¦ä¸²ï¼Œæœ€åä½¿ç”¨<code>fsPromises.writeFile</code>æ–¹æ³•å°†è¿™ä¸ªå­—ç¬¦ä¸²å†™å…¥åˆ°<code>data.json</code>æ–‡ä»¶ä¸­ã€‚åŒæ ·åœ°ï¼Œä»»ä½•åœ¨å†™å…¥è¿‡ç¨‹ä¸­å‘ç”Ÿçš„é”™è¯¯éƒ½ä¼šè¢«æ•è·å¹¶æ‰“å°å‡ºæ¥ã€‚</p><h3 id="å°ç»“-2" tabindex="-1"><a class="header-anchor" href="#å°ç»“-2"><span>å°ç»“</span></a></h3><p>Node.js çš„<code>fsPromises.writeFile</code>æ–¹æ³•æä¾›äº†ä¸€ä¸ªå¼ºå¤§ä¸”ä¾¿åˆ©çš„æ–¹å¼æ¥è¿›è¡Œå¼‚æ­¥çš„æ–‡ä»¶å†™å…¥æ“ä½œã€‚é€šè¿‡ç¤ºä¾‹çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶åœ¨å®é™…åº”ç”¨ä¸­æ˜¯å¦‚ä½•ä½¿ç”¨çš„ï¼Œæ— è®ºæ˜¯å†™å…¥ç®€å•çš„æ–‡æœ¬æ•°æ®è¿˜æ˜¯å°†å¯¹è±¡ä»¥ JSON æ ¼å¼ä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚è¿™ä½¿å¾—å®ƒæˆä¸ºå¤„ç†æ–‡ä»¶å†™å…¥éœ€æ±‚æ—¶çš„ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚</p><h3 id="fspromises-constants" tabindex="-1"><a class="header-anchor" href="#fspromises-constants"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fspromisesconstants" target="_blank" rel="noopener noreferrer">fsPromises.constants</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript ç¯å¢ƒï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚å…¶ä¸­ï¼Œ<code>fsPromises</code> æ˜¯ Node.js æä¾›çš„ç”¨äºå¤„ç†æ–‡ä»¶ç³»ç»Ÿçš„æ¨¡å—ï¼Œè€Œ <code>fsPromises.constants</code> åˆ™æ˜¯è¯¥æ¨¡å—ä¸­åŒ…å«ä¸€ç³»åˆ—ä¸æ–‡ä»¶æ“ä½œç›¸å…³çš„å¸¸é‡ã€‚è¿™äº›å¸¸é‡ä¸»è¦ç”¨äº <code>fsPromises</code> æ¨¡å—çš„æ–¹æ³•ä¸­ï¼Œä»¥æŒ‡å®šä¸åŒçš„æ“ä½œæ–¹å¼æˆ–æƒé™ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œå½“ä½ æƒ³é€šè¿‡ç¼–ç¨‹æ–¹å¼åˆ›å»ºã€è¯»å–ã€å†™å…¥æˆ–ä¿®æ”¹æ–‡ä»¶æ—¶ï¼Œä½ å¯èƒ½ä¼šç”¨åˆ° <code>fsPromises</code> æ¨¡å—ã€‚ä½¿ç”¨è¿™ä¸ªæ¨¡å—çš„å¥½å¤„æ˜¯å®ƒåŸºäº Promiseï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨ async/await æ¥å¤„ç†å¼‚æ­¥æ“ä½œï¼Œä»è€Œè®©ä»£ç æ›´åŠ ç®€æ´å’Œæ˜“äºç†è§£ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘å°†ç»™ä½ å±•ç¤ºå‡ ä¸ªä½¿ç”¨ <code>fsPromises.constants</code> çš„å®é™…ä¾‹å­ï¼š</p><h3 id="_1-ä½¿ç”¨-fspromises-writefile-å†™å…¥æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_1-ä½¿ç”¨-fspromises-writefile-å†™å…¥æ–‡ä»¶"><span>1. ä½¿ç”¨ <code>fsPromises.writeFile</code> å†™å…¥æ–‡ä»¶</span></a></h3><p>å‡è®¾ä½ æƒ³åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼ˆå¦‚æœæ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œåˆ™è¦†ç›–ï¼‰ï¼Œå¹¶å‘å…¶ä¸­å†™å…¥ä¸€äº›å†…å®¹ï¼Œä½ å¯èƒ½ä¼šè¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> createAndWriteFile</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, World!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> flag</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File written successfully</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error writing file:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">createAndWriteFile</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œçš„ <code>{ flag: &#39;w&#39; }</code> æŒ‡å®šäº†æ–‡ä»¶çš„æ‰“å¼€æ–¹å¼ã€‚<code>&#39;w&#39;</code> è¡¨ç¤ºâ€œå†™å…¥æ¨¡å¼â€ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºè¯¥æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶å·²å­˜åœ¨åˆ™æ¸…ç©ºæ–‡ä»¶åå†å†™å…¥ã€‚è¿™é‡Œ <code>&#39;w&#39;</code> å®é™…ä¸Šå¯¹åº”çš„æ˜¯ <code>fsPromises.constants.O_WRONLY | fsPromises.constants.O_CREAT | fsPromises.constants.O_TRUNC</code>ï¼Œä½†é€šå¸¸ä½ åªéœ€è¦è®°ä½ <code>&#39;w&#39;</code> è¿™ç§ç®€å†™å³å¯ã€‚</p><h3 id="_2-ä½¿ç”¨-fspromises-readfile-è¯»å–æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_2-ä½¿ç”¨-fspromises-readfile-è¯»å–æ–‡ä»¶"><span>2. ä½¿ç”¨ <code>fsPromises.readFile</code> è¯»å–æ–‡ä»¶</span></a></h3><p>æ¥ä¸‹æ¥ï¼Œå¦‚æœä½ æƒ³è¯»å–åˆšæ‰åˆ›å»ºçš„æ–‡ä»¶å†…å®¹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readFile</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡ºæ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error reading file:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ç›´æ¥ä½¿ç”¨ <code>fsPromises.constants</code> ä¸­çš„å¸¸é‡ï¼Œä½†éœ€è¦çŸ¥é“çš„æ˜¯ï¼Œé»˜è®¤æƒ…å†µä¸‹ <code>fsPromises.readFile</code> ä¼šä»¥è¯»å–æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼Œè¿™ç›¸å½“äº <code>fsPromises.constants.O_RDONLY</code>ã€‚</p><h3 id="_3-ä¿®æ”¹æ–‡ä»¶æƒé™" tabindex="-1"><a class="header-anchor" href="#_3-ä¿®æ”¹æ–‡ä»¶æƒé™"><span>3. ä¿®æ”¹æ–‡ä»¶æƒé™</span></a></h3><p>å‡è®¾ä½ æƒ³æ”¹å˜æ–‡ä»¶çš„æƒé™ï¼Œä¾‹å¦‚è®©æ–‡ä»¶å˜ä¸ºâ€œåªå¯æ‰§è¡Œâ€ï¼ˆåŸºäºä½ çš„æ“ä½œç³»ç»Ÿå’Œæƒé™è®¾ç½®ï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>fsPromises.chmod</code> æ–¹æ³•ï¼Œå¹¶åˆ©ç”¨ <code>fsPromises.constants</code> ä¸­å®šä¹‰çš„æƒé™ä½ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> changeFilePermission</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // åªç»™æ‰€æœ‰è€…æ‰§è¡Œæƒé™</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">chmod</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">S_IXUSR</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File permission changed successfully</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error changing file permission:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">changeFilePermission</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œ <code>fs.constants.S_IXUSR</code> æ˜¯ <code>fsPromises.constants</code> ä¸­çš„ä¸€ä¸ªè¡¨ç¤ºâ€œæ‰€æœ‰è€…å…·æœ‰æ‰§è¡Œæƒé™â€çš„å¸¸é‡ã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œ<code>fsPromises.constants</code> åŒ…å«äº†ä¸€ç³»åˆ—æ–¹ä¾¿æˆ‘ä»¬åœ¨è¿›è¡Œæ–‡ä»¶æ“ä½œæ—¶æŒ‡å®šä¸åŒå‚æ•°çš„å¸¸é‡ï¼Œä¾‹å¦‚åœ¨æ‰“å¼€æ–‡ä»¶ã€è¯»å†™æ–‡ä»¶ã€ä¿®æ”¹æ–‡ä»¶æƒé™ç­‰æ“ä½œä¸­ï¼Œæˆ‘ä»¬éƒ½å¯èƒ½ä¼šç”¨åˆ°å®ƒä»¬ã€‚é€šè¿‡ä¸Šè¿°ä¾‹å­ï¼Œå¸Œæœ›ä½ èƒ½å¯¹å¦‚ä½•åœ¨å®é™…ç¼–ç¨‹ä¸­ä½¿ç”¨è¿™äº›å¸¸é‡æœ‰äº†åˆæ­¥çš„äº†è§£ã€‚</p><h2 id="callback-api" tabindex="-1"><a class="header-anchor" href="#callback-api"><span><a href="https://nodejs.org/docs/latest/api/fs.html#callback-api" target="_blank" rel="noopener noreferrer">Callback API</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªè®© JavaScript è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¹³å°ï¼Œå®ƒä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿä½¿ç”¨ JavaScript æ¥ç¼–å†™åç«¯ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ç§éå¸¸é‡è¦çš„æ¦‚å¿µå«åšâ€œéé˜»å¡ I/Oâ€æˆ–â€œå¼‚æ­¥ I/Oâ€ã€‚è¿™æ„å‘³ç€å½“ä½ æ‰§è¡Œä¸€ä¸ªæ“ä½œï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶ã€è¯·æ±‚ç½‘ç»œèµ„æºç­‰ï¼ŒNode.js ä¸ä¼šåœä¸‹æ¥ç­‰å¾…è¿™ä¸ªæ“ä½œå®Œæˆï¼Œè€Œæ˜¯ä¼šç»§ç»­æ‰§è¡Œä¸‹ä¸€è¡Œä»£ç ã€‚å½“æ“ä½œå®Œæˆæ—¶ï¼Œå®ƒä¼šé€šè¿‡å›è°ƒå‡½æ•°ï¼ˆCallbackï¼‰æ¥é€šçŸ¥ä½ ã€‚</p><h3 id="callback-api-1" tabindex="-1"><a class="header-anchor" href="#callback-api-1"><span>Callback API</span></a></h3><p>åœ¨ Node.js çš„æ ‡å‡†åº“ä¸­ï¼Œ<code>fs</code> æ¨¡å—æä¾›äº†ç”¨äºæ“ä½œæ–‡ä»¶ç³»ç»Ÿçš„åŠŸèƒ½ï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶ã€å†™å…¥æ–‡ä»¶ç­‰ã€‚åœ¨ v21.7.1 ä¸­ï¼Œè¿™äº›æ“ä½œå¤§å¤šéƒ½æ”¯æŒé€šè¿‡å›è°ƒå‡½æ•°æ¥å¤„ç†å¼‚æ­¥ç»“æœï¼Œè¿™å°±æ˜¯æ‰€è°“çš„â€œCallback APIâ€ã€‚</p><h4 id="ä»€ä¹ˆæ˜¯å›è°ƒå‡½æ•°" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯å›è°ƒå‡½æ•°"><span>ä»€ä¹ˆæ˜¯å›è°ƒå‡½æ•°ï¼Ÿ</span></a></h4><p>ç®€å•æ¥è¯´ï¼Œå›è°ƒå‡½æ•°æ˜¯ä½ ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°çš„å‡½æ•°ï¼Œå½“å¤–éƒ¨å‡½æ•°å®ŒæˆæŸä¸ªä»»åŠ¡åï¼Œå®ƒä¼šæ‰§è¡Œä½ ä¼ é€’ç»™å®ƒçš„é‚£ä¸ªå‡½æ•°ã€‚åœ¨å¼‚æ­¥æ“ä½œä¸­ï¼Œå›è°ƒå‡½æ•°é€šå¸¸ç”¨äºå¤„ç†æ“ä½œå®Œæˆåçš„ç»“æœï¼ˆæ¯”å¦‚æ•°æ®æˆ–è€…é”™è¯¯ä¿¡æ¯ï¼‰ã€‚</p><h4 id="å®é™…ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-2"><span>å®é™…ä¾‹å­</span></a></h4><h5 id="è¯»å–æ–‡ä»¶-1" tabindex="-1"><a class="header-anchor" href="#è¯»å–æ–‡ä»¶-1"><span>è¯»å–æ–‡ä»¶</span></a></h5><p>å‡è®¾æˆ‘ä»¬æƒ³è¦å¼‚æ­¥åœ°è¯»å–ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡ä»¶ï¼Œå¹¶åœ¨è¯»å–å®Œæˆåæ‰“å°å‡ºæ–‡ä»¶å†…å®¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fs.readFile æ–¹æ³•è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œæ¯”å¦‚æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#616E88;">  // å¦‚æœæˆåŠŸè¯»å–æ–‡ä»¶ï¼Œæ‰“å°æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>fs.readFile</code> æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ã€‚å®ƒæ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼šæ–‡ä»¶è·¯å¾„ã€å­—ç¬¦ç¼–ç ï¼ˆè¿™é‡Œæ˜¯ <code>&#39;utf8&#39;</code>ï¼‰ï¼Œä»¥åŠä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚å›è°ƒå‡½æ•°æœ¬èº«æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯å¯èƒ½å‘ç”Ÿçš„é”™è¯¯ <code>err</code>ï¼Œå¦ä¸€ä¸ªæ˜¯æ–‡ä»¶å†…å®¹ <code>data</code>ã€‚</p><h5 id="å†™å…¥æ–‡ä»¶-1" tabindex="-1"><a class="header-anchor" href="#å†™å…¥æ–‡ä»¶-1"><span>å†™å…¥æ–‡ä»¶</span></a></h5><p>ç°åœ¨ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦å¼‚æ­¥åœ°å°†ä¸€äº›å†…å®¹å†™å…¥åˆ° <code>output.txt</code> æ–‡ä»¶ä¸­ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fs.writeFile æ–¹æ³•å†™å…¥æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">output.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, world!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // å¦‚æœå†™å…¥è¿‡ç¨‹ä¸­å‡ºé”™ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#616E88;">  // å¦‚æœæˆåŠŸå†™å…¥ï¼Œæ‰“å°æˆåŠŸæ¶ˆæ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File has been written</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œ<code>fs.writeFile</code> å‡½æ•°ç”¨äºå¼‚æ­¥åœ°å°† <code>&#39;Hello, world!&#39;</code> å†™å…¥åˆ° <code>output.txt</code> æ–‡ä»¶ä¸­ã€‚å®ƒä¹Ÿéœ€è¦ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥å¤„ç†å†™å…¥æ“ä½œå®Œæˆåçš„çŠ¶æ€ï¼Œä½†è¿™æ¬¡å›è°ƒå‡½æ•°åªæ¥æ”¶ä¸€ä¸ªå‚æ•° <code>err</code>ï¼Œå› ä¸ºä½ é€šå¸¸ä¸éœ€è¦è¯»å–å†™å…¥æ“ä½œçš„ç»“æœã€‚</p><h3 id="æ€»ç»“-6" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-6"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡ä½¿ç”¨ Callback APIï¼ŒNode.js å…è®¸ä½ ä»¥ä¸€ç§éå µå¡ï¼ˆå¼‚æ­¥ï¼‰çš„æ–¹å¼æ‰§è¡Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼Œæé«˜äº†ä»£ç çš„æ‰§è¡Œæ•ˆç‡å’Œåº”ç”¨çš„å“åº”èƒ½åŠ›ã€‚é€šè¿‡æä¾›å›è°ƒå‡½æ•°ï¼Œä½ å¯ä»¥ä¼˜é›…åœ°å¤„ç†å¼‚æ­¥æ“ä½œçš„æˆåŠŸæˆ–å¤±è´¥æƒ…å†µã€‚</p><h3 id="fs-access-path-mode-callback" tabindex="-1"><a class="header-anchor" href="#fs-access-path-mode-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsaccesspath-mode-callback" target="_blank" rel="noopener noreferrer">fs.access(path[, mode], callback)</a></span></a></h3><p>ç†è§£ <code>fs.access(path[, mode], callback)</code> å‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦äº†è§£å®ƒå±äºä»€ä¹ˆä»¥åŠç”¨æ¥å¹²ä»€ä¹ˆã€‚<code>fs.access</code> æ˜¯ Node.js çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œè¿™ä¸ªæ¨¡å—æä¾›äº†å¾ˆå¤šä¸æ–‡ä»¶å’Œç›®å½•è¿›è¡Œäº¤äº’çš„æ–¹æ³•ã€‚<code>fs.access</code> å…·ä½“æ˜¯ç”¨æ¥æ£€æŸ¥å½“å‰è¿è¡Œçš„è¿›ç¨‹æ˜¯å¦æœ‰æƒé™è®¿é—®ç»™å®šçš„æ–‡ä»¶æˆ–ç›®å½•ã€‚</p><h3 id="å‚æ•°è§£é‡Š-10" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-10"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><strong>path</strong>: è¿™æ˜¯ä½ æƒ³è¦æ£€æŸ¥æƒé™çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><strong>mode</strong> (å¯é€‰): è¿™ä¸ªå‚æ•°æŒ‡å®šäº†è¦è¿›è¡Œçš„æ£€æŸ¥ç±»å‹ã€‚æ¯”å¦‚ï¼Œä½ æ˜¯æƒ³æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Ÿè¿˜æ˜¯æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯å†™ï¼Ÿç­‰ç­‰ã€‚å¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤æ˜¯æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚</li><li><strong>callback</strong>: è¿™æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå½“ <code>fs.access</code> å®Œæˆæ£€æŸ¥åä¼šè¢«è°ƒç”¨ã€‚å®ƒæœ‰ä¸€ä¸ªå‚æ•°ç”¨æ¥è¡¨ç¤ºå¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œè¯´æ˜æ‰€æ£€æŸ¥çš„æ“ä½œæ˜¯å…è®¸çš„ã€‚</li></ul><h3 id="æ¨¡å¼-mode" tabindex="-1"><a class="header-anchor" href="#æ¨¡å¼-mode"><span>æ¨¡å¼ï¼ˆModeï¼‰</span></a></h3><ul><li><code>fs.constants.F_OK</code>: æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚</li><li><code>fs.constants.R_OK</code>: æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯è¯»ã€‚</li><li><code>fs.constants.W_OK</code>: æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯å†™ã€‚</li><li><code>fs.constants.X_OK</code>: æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œã€‚ï¼ˆè¿™ä¸ªåœ¨ Windows ä¸ŠåŸºæœ¬ä¸èµ·ä½œç”¨ï¼Œå› ä¸º Windows çš„å¯æ‰§è¡Œæ€§æ˜¯é€šè¿‡æ–‡ä»¶æ‰©å±•ååˆ¤æ–­çš„ã€‚ï¼‰</li></ul><h3 id="ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1"><span>ä¾‹å­</span></a></h3><h4 id="ç¤ºä¾‹-1-æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨"><span>ç¤ºä¾‹ 1: æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">access</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">somefile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">F_OK</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶ä¸å­˜åœ¨</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å­˜åœ¨</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯å†™" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯å†™"><span>ç¤ºä¾‹ 2: æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯å†™</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">access</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">myfile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">W_OK</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ä¸èƒ½å†™å…¥æ–‡ä»¶</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å¯ä»¥å†™å…¥æ–‡ä»¶</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-3-åŒæ—¶æ£€æŸ¥å¤šç§æƒé™" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-åŒæ—¶æ£€æŸ¥å¤šç§æƒé™"><span>ç¤ºä¾‹ 3: åŒæ—¶æ£€æŸ¥å¤šç§æƒé™</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ä½æ“ä½œç¬¦ | æ¥ç»„åˆå¤šç§æ£€æŸ¥æ¨¡å¼</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">access</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">myfile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">R_OK</span><span style="color:#81A1C1;"> |</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">W_OK</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶ä¸å¯è¯»æˆ–ä¸å¯å†™</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å¯è¯»ä¸”å¯å†™</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å°ç»“-3" tabindex="-1"><a class="header-anchor" href="#å°ç»“-3"><span>å°ç»“</span></a></h3><p>ä½¿ç”¨ <code>fs.access</code> å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨å°è¯•æ‰§è¡ŒæŸäº›æ“ä½œï¼ˆå¦‚è¯»å–ã€å†™å…¥æ–‡ä»¶ï¼‰ä¹‹å‰ï¼Œæ£€æŸ¥æˆ‘ä»¬æ˜¯å¦æœ‰æƒé™å»åšè¿™äº›æ“ä½œã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œå› ä¸ºå®ƒå¯ä»¥è®©æˆ‘ä»¬é¿å…åœ¨ç¨‹åºä¸­é‡åˆ°æƒé™é”™è¯¯ç„¶åå´©æºƒã€‚è€Œä¸”é€šè¿‡å›è°ƒå‡½æ•°çš„ä½¿ç”¨ï¼ŒNode.js å¼ºè°ƒäº†å…¶å¼‚æ­¥éé˜»å¡çš„ç‰¹æ€§ï¼Œå³ä½¿è¿›è¡Œæ–‡ä»¶ç³»ç»Ÿçš„æ£€æŸ¥ä¹Ÿä¸ä¼šé˜»å¡ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ã€‚</p><h3 id="fs-appendfile-path-data-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-appendfile-path-data-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsappendfilepath-data-options-callback" target="_blank" rel="noopener noreferrer">fs.appendFile(path, data[, options], callback)</a></span></a></h3><p>Node.js çš„ <code>fs.appendFile</code> æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„å‡½æ•°ï¼Œå®ƒå±äº <code>fs</code> (æ–‡ä»¶ç³»ç»Ÿ) æ¨¡å—ã€‚è¿™ä¸ªå‡½æ•°çš„ä¸»è¦ä½œç”¨æ˜¯å‘æŒ‡å®šçš„æ–‡ä»¶ä¸­è¿½åŠ å†…å®¹ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆ Node.js ä¼šè‡ªåŠ¨åˆ›å»ºè¿™ä¸ªæ–‡ä»¶ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥è¯¦ç»†äº†è§£ <code>fs.appendFile</code> å‡½æ•°ã€‚</p><h3 id="å‚æ•°è§£é‡Š-11" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-11"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>path</code>: è¦è¿½åŠ å†…å®¹çš„æ–‡ä»¶è·¯å¾„ã€‚</li><li><code>data</code>: è¦è¿½åŠ åˆ°æ–‡ä»¶ä¸­çš„æ•°æ®ã€‚</li><li><code>options</code> (å¯é€‰): è®¾ç½®å­—ç¬¦ç¼–ç ï¼ˆä¾‹å¦‚ &#39;utf8&#39;ï¼‰å’Œæ¨¡å¼ï¼ˆä¾‹å¦‚ 0o666ï¼‰ï¼Œè¿˜å¯ä»¥è®¾ç½®æ ‡å¿—ï¼ˆä¾‹å¦‚ &#39;a&#39;ï¼‰ã€‚è¿™ä¸ªå‚æ•°ä¸æ˜¯å¿…éœ€çš„ï¼›å¦‚æœå¿½ç•¥ï¼ŒNode.js å°†ä½¿ç”¨é»˜è®¤å€¼ã€‚</li><li><code>callback</code>: å½“æ“ä½œå®Œæˆæˆ–å‘ç”Ÿé”™è¯¯æ—¶ï¼Œå°†è°ƒç”¨æ­¤å›è°ƒå‡½æ•°ã€‚å®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼š<code>err</code> å’Œ <code>written</code>ã€‚<code>err</code> æ˜¯é”™è¯¯å¯¹è±¡ï¼ˆå¦‚æœæ²¡æœ‰é”™è¯¯å‘ç”Ÿï¼Œåˆ™ä¸º <code>null</code>ï¼‰ï¼›<code>written</code> æ˜¯å†™å…¥çš„å­—èŠ‚æ•°ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-12" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-12"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="ä¾‹å­-1-å‘æ–‡ä»¶è¿½åŠ æ–‡æœ¬" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-å‘æ–‡ä»¶è¿½åŠ æ–‡æœ¬"><span>ä¾‹å­ 1: å‘æ–‡ä»¶è¿½åŠ æ–‡æœ¬</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨æ„å»ºä¸€ä¸ªæ—¥å¿—ç³»ç»Ÿï¼Œéœ€è¦å°†æ–°çš„æ—¥å¿—ä¿¡æ¯è¿½åŠ åˆ°å·²å­˜åœ¨çš„æ—¥å¿—æ–‡ä»¶ä¸­ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ—¥å¿—ä¿¡æ¯</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> newLogEntry</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">ç”¨æˆ·ç™»é™†æˆåŠŸ - </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">()</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toISOString</span><span style="color:#D8DEE9FF;">() </span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è¿½åŠ æ—¥å¿—ä¿¡æ¯åˆ° logs.txt æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">appendFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">logs.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> newLogEntry</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å¦‚æœå‘ç”Ÿé”™è¯¯ï¼ŒæŠ›å‡ºå¼‚å¸¸</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ—¥å¿—ä¿¡æ¯å·²è¢«è¿½åŠ åˆ°æ–‡ä»¶</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ¯æ¬¡æ‰§è¡Œéƒ½ä¼šåœ¨ <code>logs.txt</code> æ–‡ä»¶æœ«å°¾è¿½åŠ ä¸€ä¸ªæ–°çš„æ—¥å¿—æ¡ç›®ã€‚</p><h4 id="ä¾‹å­-2-ä½¿ç”¨-promise-å¼‚æ­¥å¤„ç†" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ä½¿ç”¨-promise-å¼‚æ­¥å¤„ç†"><span>ä¾‹å­ 2: ä½¿ç”¨ Promise å¼‚æ­¥å¤„ç†</span></a></h4><p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šä½¿ç”¨ <code>Promise</code> æˆ–è€… <code>async/await</code> æ¥å¤„ç†å¼‚æ­¥æ“ä½œï¼Œä»¥ç®€åŒ–ä»£ç ç»“æ„ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•å°† <code>fs.appendFile</code> æ–¹æ³•ä¸ <code>Promises</code> ç»“åˆä½¿ç”¨çš„ç¤ºä¾‹ï¼š</p><p>é¦–å…ˆï¼Œç¡®ä¿ä½ ä½¿ç”¨çš„ Node.js ç‰ˆæœ¬æ”¯æŒ <code>fs/promises</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> appendDataToFile</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filename</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">appendFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filename</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ•°æ®å·²è¢«è¿½åŠ åˆ°</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filename</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿½åŠ æ–‡ä»¶æ—¶å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨è¯¥å‡½æ•°</span></span>
<span class="line"><span style="color:#88C0D0;">appendDataToFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯è¿½åŠ çš„æ–‡æœ¬å†…å®¹ã€‚</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡å¼‚æ­¥å‡½æ•°<code>appendDataToFile</code>å°†æ•°æ®è¿½åŠ åˆ°æŒ‡å®šæ–‡ä»¶ä¸­ã€‚ä½¿ç”¨ <code>async/await</code> è®©ä»£ç çœ‹èµ·æ¥æ›´åƒæ˜¯åŒæ­¥ä»£ç ï¼Œä½†å®é™…ä¸Šå®ƒä»ç„¶æ˜¯éé˜»å¡çš„ã€‚</p><h3 id="æ€»ç»“-7" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-7"><span>æ€»ç»“</span></a></h3><p><code>fs.appendFile</code> æ˜¯ Node.js ä¸­ä¸€ä¸ªéå¸¸å®ç”¨çš„å‡½æ•°ï¼Œç‰¹åˆ«é€‚ç”¨äºéœ€è¦å‘æ–‡ä»¶è¿½åŠ æ•°æ®çš„åœºæ™¯ï¼Œæ¯”å¦‚æ—¥å¿—è®°å½•ã€æ•°æ®æ”¶é›†ç­‰ã€‚é€šè¿‡è¿™ä¸ªå‡½æ•°ï¼Œä½ å¯ä»¥è½»æ¾åœ°å°†æ•°æ®æ·»åŠ åˆ°æ–‡ä»¶çš„æœ«å°¾ï¼Œæ— è®ºæ˜¯åœ¨ç®€å•è„šæœ¬ä¸­ï¼Œè¿˜æ˜¯åœ¨å¤æ‚çš„åº”ç”¨ç¨‹åºä¸­ã€‚</p><h3 id="fs-chmod-path-mode-callback" tabindex="-1"><a class="header-anchor" href="#fs-chmod-path-mode-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fschmodpath-mode-callback" target="_blank" rel="noopener noreferrer">fs.chmod(path, mode, callback)</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©æˆ‘ä»¬å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚Node.js æä¾›äº†å¾ˆå¤šå†…ç½®æ¨¡å—ï¼Œä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿæ–¹ä¾¿åœ°è¿›è¡Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œã€ç½‘ç»œè¯·æ±‚ç­‰ã€‚<code>fs</code> æ¨¡å—å°±æ˜¯ Node.js ä¸­ç”¨äºæ“ä½œæ–‡ä»¶ç³»ç»Ÿçš„ä¸€ä¸ªé‡è¦æ¨¡å—ï¼Œå…¶ä¸­ <code>fs.chmod()</code> æ–¹æ³•æ˜¯ç”¨æ¥æ”¹å˜æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™çš„ã€‚</p><h3 id="fs-chmod-path-mode-callback-1" tabindex="-1"><a class="header-anchor" href="#fs-chmod-path-mode-callback-1"><span>fs.chmod(path, mode, callback)</span></a></h3><ul><li><strong>path</strong>ï¼šè¿™æ˜¯è¦ä¿®æ”¹æƒé™çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><strong>mode</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªè¡¨ç¤ºæ–‡ä»¶æƒé™çš„æ•°å­—æˆ–å­—ç¬¦ä¸²ã€‚åœ¨ Unix ç³»ç»Ÿä¸­ï¼Œè¿™é€šå¸¸æ˜¯ä¸€ä¸ªå…«è¿›åˆ¶æ•°ï¼ˆä¾‹å¦‚ <code>0o755</code>ï¼‰ï¼Œè¡¨ç¤ºä¸åŒç”¨æˆ·å¯¹æ–‡ä»¶çš„è¯»å†™æ‰§è¡Œæƒé™ã€‚</li><li><strong>callback</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªåœ¨ <code>chmod</code> æ“ä½œå®Œæˆåè¢«è°ƒç”¨çš„å‡½æ•°ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œé”™è¯¯å‚æ•°å°†ä¼šæ˜¯ <code>null</code> æˆ–è€… <code>undefined</code>ï¼›å¦‚æœæ“ä½œå¤±è´¥ï¼Œåˆ™ä¼šä¼ é€’ä¸€ä¸ªé”™è¯¯å¯¹è±¡ã€‚</li></ul><h4 id="å®é™…åº”ç”¨ç¤ºä¾‹-3" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-3"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h4><ol><li><strong>æ›´æ”¹æ–‡ä»¶æƒé™</strong></li></ol><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡ä»¶ï¼Œç°åœ¨ä½ æƒ³æ”¹å˜å®ƒçš„æƒé™ï¼Œè®©æ–‡ä»¶æ‰€æœ‰è€…æœ‰è¯»å†™æ‰§è¡Œçš„æƒé™ï¼Œè€Œå±äºåŒä¸€ç»„çš„å…¶ä»–ç”¨æˆ·å’Œå…¶ä»–æ‰€æœ‰ç”¨æˆ·åªæœ‰è¯»æƒé™ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è®¾ç½®æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// è®¾å®šæ–°æƒé™: æ‰€æœ‰è€…è¯»å†™æ‰§è¡Œ(7)ï¼Œç»„è¯»(4)ï¼Œå…¶ä»–è¯»(4)</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> newMode</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0o744</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">chmod</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> newMode</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">ä¿®æ”¹æ–‡ä»¶æƒé™å¤±è´¥: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶æƒé™ä¿®æ”¹æˆåŠŸ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>0o744</code> è¡¨ç¤ºæ‰€æœ‰è€…ï¼ˆownerï¼‰å¯ä»¥è¯»ã€å†™ã€æ‰§è¡Œï¼ˆ7ï¼‰ï¼Œç»„ï¼ˆgroupï¼‰æˆå‘˜å’Œå…¶ä»–äººï¼ˆothersï¼‰åªèƒ½è¯»ï¼ˆ4ï¼‰ã€‚</p><ol start="2"><li><strong>æå‡å®‰å…¨æ€§</strong></li></ol><p>è€ƒè™‘ä¸€ä¸ªåœºæ™¯ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª web åº”ç”¨ï¼Œå¹¶ä¸”ç”Ÿæˆäº†åŒ…å«æ•æ„Ÿä¿¡æ¯çš„æ—¥å¿—æ–‡ä»¶ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªæ–‡ä»¶å¯èƒ½å¯¹æ‰€æœ‰ç”¨æˆ·éƒ½æ˜¯å¯è¯»çš„ã€‚å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œä½ å¯èƒ½å¸Œæœ›ä»…é™åº”ç”¨æœ¬èº«èƒ½å¤Ÿè®¿é—®è¯¥æ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> logFilePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">sensitive.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// åªæœ‰æ‰€æœ‰è€…å¯ä»¥è¯»å†™(6)ï¼Œå…¶ä»–äººæ²¡æœ‰ä»»ä½•æƒé™(0)</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> secureMode</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0o600</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">chmod</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">logFilePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> secureMode</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ— æ³•è®¾ç½®æ—¥å¿—æ–‡ä»¶çš„å®‰å…¨æƒé™: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ—¥å¿—æ–‡ä»¶çš„æƒé™å·²æˆåŠŸæ›´æ–°ï¼Œå¢å¼ºå®‰å…¨æ€§</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>0o600</code> è¡¨ç¤ºæ–‡ä»¶æ‰€æœ‰è€…æœ‰è¯»å†™æƒé™ï¼Œè€Œç»„æˆå‘˜å’Œå…¶ä»–äººæ²¡æœ‰ä»»ä½•æƒé™ã€‚è¿™æ ·å°±ç¡®ä¿äº†åªæœ‰æˆæƒçš„ç”¨æˆ·å¯ä»¥è®¿é—®è¿™äº›æ•æ„Ÿä¿¡æ¯ã€‚</p><p>é€šè¿‡ä½¿ç”¨ <code>fs.chmod()</code> æ–¹æ³•ï¼Œå¼€å‘è€…å¯ä»¥è½»æ¾åœ°ç®¡ç†æ–‡ä»¶å’Œç›®å½•çš„å®‰å…¨æ€§ï¼Œä»è€Œç¬¦åˆåº”ç”¨ç¨‹åºçš„éœ€æ±‚å’Œå®‰å…¨æ ‡å‡†ã€‚</p><h4 id="file-modes" tabindex="-1"><a class="header-anchor" href="#file-modes"><span><a href="https://nodejs.org/docs/latest/api/fs.html#file-modes" target="_blank" rel="noopener noreferrer">File modes</a></span></a></h4><p>åœ¨ Node.js ä¸­ï¼Œæ–‡ä»¶æ¨¡å¼ï¼ˆFile modesï¼‰ä¸»è¦æ¶‰åŠåˆ°äº†æ–‡ä»¶çš„æƒé™å’Œè¡Œä¸ºï¼Œå°¤å…¶æ˜¯å½“ä½ åœ¨ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿ(<code>fs</code>)æ¨¡å—æ“ä½œæ–‡ä»¶æˆ–ç›®å½•æ—¶ã€‚ç†è§£æ–‡ä»¶æ¨¡å¼å¯¹äºå®‰å…¨åœ°ç®¡ç†æ–‡ä»¶å’Œç›®å½•è‡³å…³é‡è¦ã€‚åœ¨ Node.js çš„<code>fs</code>æ¨¡å—æ–‡æ¡£ä¸­ï¼Œæåˆ°çš„æ–‡ä»¶æ¨¡å¼é€šå¸¸ä¸åˆ›å»ºã€è¯»å–ã€å†™å…¥æ–‡ä»¶æœ‰å…³ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-6" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-6"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>åœ¨ Unix-like ç³»ç»Ÿä¸­ï¼ˆåŒ…æ‹¬ Linux å’Œ MacOSï¼‰ï¼Œæ¯ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„æƒé™è¢«å®šä¹‰ä¸ºä¸‰ç»„å±æ€§ï¼šæ‰€æœ‰è€…ï¼ˆownerï¼‰ã€ç¾¤ç»„ï¼ˆgroupï¼‰ã€å…¶ä»–ï¼ˆothersï¼‰ã€‚è¿™äº›æƒé™å†³å®šäº†è°å¯ä»¥è¯»å–ï¼ˆrï¼‰ã€å†™å…¥ï¼ˆwï¼‰ã€æ‰§è¡Œï¼ˆxï¼‰æ–‡ä»¶æˆ–ç›®å½•ã€‚åœ¨ Windows ç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶æƒé™çš„å¤„ç†ç•¥æœ‰ä¸åŒï¼Œä½† Node.js å°½åŠ›åœ¨è¿™äº›å¹³å°ä¸ŠæŠ½è±¡å‡ºä¸€è‡´çš„æ¥å£ã€‚</p><p>æ–‡ä»¶æ¨¡å¼ï¼ˆModesï¼‰åœ¨ Node.js ä¸­ï¼Œç‰¹åˆ«æ˜¯é€šè¿‡<code>fs</code>æ¨¡å—åˆ›å»ºæˆ–æ“ä½œæ–‡ä»¶æ—¶ï¼Œé€šè¿‡æ•°å€¼æ¥æŒ‡å®šã€‚è¿™äº›æ•°å€¼é€šå¸¸ä»¥å…«è¿›åˆ¶å½¢å¼ç»™å‡ºï¼Œå¦‚<code>0o755</code>ï¼ˆåœ¨ ES6 ä¸­ï¼Œ<code>0o</code>å‰ç¼€è¡¨ç¤ºå…«è¿›åˆ¶æ•°ï¼‰ã€‚</p><ul><li><strong>è¯»ï¼ˆ4ï¼‰:</strong> æ–‡ä»¶å¯è¢«è¯»å–ã€‚</li><li><strong>å†™ï¼ˆ2ï¼‰:</strong> æ–‡ä»¶å†…å®¹å¯è¢«ä¿®æ”¹ã€‚</li><li><strong>æ‰§è¡Œï¼ˆ1ï¼‰:</strong> æ–‡ä»¶å¯è¢«ä½œä¸ºç¨‹åºè¿è¡Œã€‚</li></ul><p>å°†è¿™äº›æ•°å­—ç»„åˆèµ·æ¥ï¼Œå°±èƒ½å®šä¹‰å¤åˆæƒé™ã€‚ä¾‹å¦‚ï¼Œæƒé™æ¨¡å¼<code>0o755</code>è¡¨ç¤ºï¼š</p><ul><li>æ‰€æœ‰è€…æœ‰è¯»ã€å†™ã€æ‰§è¡Œæƒé™ï¼ˆ4+2+1=7ï¼‰ã€‚</li><li>ç¾¤ç»„æˆå‘˜æœ‰è¯»å’Œæ‰§è¡Œæƒé™ï¼ˆ4+1=5ï¼‰ã€‚</li><li>å…¶ä»–ç”¨æˆ·æœ‰è¯»å’Œæ‰§è¡Œæƒé™ï¼ˆ4+1=5ï¼‰ã€‚</li></ul><h3 id="å®é™…è¿ç”¨" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨"><span>å®é™…è¿ç”¨</span></a></h3><h4 id="åˆ›å»ºæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºæ–‡ä»¶"><span>åˆ›å»ºæ–‡ä»¶</span></a></h4><p>å½“ä½ ä½¿ç”¨<code>fs.writeFile</code>æˆ–<code>fs.writeFileSync</code>æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶æ—¶ï¼Œå¯ä»¥æŒ‡å®šæ–‡ä»¶æ¨¡å¼ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªå¯¹æ‰€æœ‰äººéƒ½å¯è¯»å†™çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, world!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> mode</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 0o666</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªåªæœ‰æ–‡ä»¶æ‰€æœ‰è€…å¯è¯»å†™ï¼Œå…¶ä»–äººæ— ä»»ä½•æƒé™çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example-private.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, only for me!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> mode</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 0o600</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="åˆ›å»ºç›®å½•" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºç›®å½•"><span>åˆ›å»ºç›®å½•</span></a></h4><p>ä½¿ç”¨<code>fs.mkdir</code>æˆ–<code>fs.mkdirSync</code>åˆ›å»ºç›®å½•æ—¶ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šæ¨¡å¼ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªå¯¹æ‰€æœ‰ç”¨æˆ·å¼€æ”¾çš„ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">mkdirSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">public-dir</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> mode</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 0o777</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªä»…é™æ‰€æœ‰è€…è®¿é—®çš„ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">mkdirSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">private-dir</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> mode</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 0o700</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•æƒé™" tabindex="-1"><a class="header-anchor" href="#æ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•æƒé™"><span>æ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•æƒé™</span></a></h4><p>å·²å­˜åœ¨çš„æ–‡ä»¶æˆ–ç›®å½•æƒé™å¯ä»¥é€šè¿‡<code>fs.chmod</code>æˆ–<code>fs.chmodSync</code>æ›´æ”¹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ›´æ”¹æ–‡ä»¶æƒé™ä¸ºæ‰€æœ‰è€…å¯è¯»å†™ï¼Œå…¶ä»–äººåªè¯»</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">chmodSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0o644</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ›´æ”¹ç›®å½•æƒé™ï¼Œä½¿å¾—æ‰€æœ‰è€…å¯å®Œå…¨è®¿é—®ï¼Œç¾¤ç»„å¯è¯»å’Œæ‰§è¡Œï¼Œå…¶ä»–äººæ— æƒé™</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">chmodSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">some-dir</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0o750</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™äº›æ“ä½œåœ¨ Web æœåŠ¡å™¨é…ç½®ã€è‡ªåŠ¨åŒ–è„šæœ¬ç¼–å†™ã€ç³»ç»Ÿç®¡ç†ç­‰æ–¹é¢éå¸¸å®ç”¨ã€‚æ­£ç¡®åœ°è®¾ç½®æ–‡ä»¶å’Œç›®å½•æƒé™å¯ä»¥ä¿æŠ¤æ•æ„Ÿæ•°æ®ä¸è¢«æœªæˆæƒè®¿é—®ï¼Œå¹¶ç¡®ä¿åº”ç”¨ç¨‹åºçš„æ­£å¸¸è¿è¡Œã€‚</p><p>ç†è§£å¹¶æ­£ç¡®åº”ç”¨æ–‡ä»¶æ¨¡å¼æ˜¯è¿›è¡Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œæ—¶çš„é‡è¦éƒ¨åˆ†ï¼Œèƒ½å¤Ÿå¸®åŠ©ä½ æ›´å¥½åœ°æ§åˆ¶åº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§å’Œæ•ˆèƒ½ã€‚</p><h3 id="fs-chown-path-uid-gid-callback" tabindex="-1"><a class="header-anchor" href="#fs-chown-path-uid-gid-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fschownpath-uid-gid-callback" target="_blank" rel="noopener noreferrer">fs.chown(path, uid, gid, callback)</a></span></a></h3><p>å½“ç„¶ï¼Œè®©æˆ‘ä¸ºä½ è¯¦ç»†è§£é‡Šä¸€ä¸‹ <code>fs.chown</code> æ–¹æ³•åœ¨ Node.jsï¼ˆä»¥ç‰ˆæœ¬ 21.7.1 ä¸ºä¾‹ï¼‰ä¸­çš„ç”¨æ³•å’Œå®ƒçš„å®é™…åº”ç”¨ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-fs-chown" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-fs-chown"><span>ä»€ä¹ˆæ˜¯ <code>fs.chown</code>?</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æä¾›äº†ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„åŠŸèƒ½ã€‚<code>fs.chown</code> æ˜¯è¿™ä¸ªæ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨äºæ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰è€…ã€‚è¿™ä¸ªæ“ä½œåœ¨ Linux å’Œ macOS ç³»ç»Ÿä¸­ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºè¿™äº›æ“ä½œç³»ç»Ÿå¯¹æ–‡ä»¶å’Œç›®å½•çš„è®¿é—®æƒé™æ§åˆ¶éå¸¸ä¸¥æ ¼ã€‚Windows ç³»ç»Ÿä¹Ÿæ”¯æŒç±»ä¼¼çš„æ¦‚å¿µï¼Œä½†å…¶å…·ä½“å®ç°å’Œå½±å“å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚</p><p>å‡½æ•°ç­¾åå¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">chown</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> uid</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> gid</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> callback</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å…¶ä¸­ï¼š</p><ul><li><code>path</code>ï¼šè¦æ›´æ”¹æ‰€æœ‰è€…çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><code>uid</code>ï¼šç”¨æˆ· IDï¼ˆUser IDï¼‰ï¼Œä½ å¸Œæœ›å°†æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰æƒè½¬ç§»åˆ°çš„ç”¨æˆ·çš„æ•°å­—æ ‡è¯†ç¬¦ã€‚</li><li><code>gid</code>ï¼šç»„ IDï¼ˆGroup IDï¼‰ï¼ŒåŒæ ·æ˜¯ä¸€ä¸ªæ•°å­—æ ‡è¯†ç¬¦ï¼Œä»£è¡¨æ–°çš„ç¾¤ç»„æ‰€æœ‰è€…ã€‚</li><li><code>callback</code>ï¼šå½“ <code>chown</code> æ“ä½œå®Œæˆåè¢«è°ƒç”¨çš„å‡½æ•°ã€‚å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œé”™è¯¯ä¿¡æ¯å°†ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™å®ƒã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-7" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-7"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œè¯¥ç¨‹åºéœ€è¦ä¿®æ”¹æ—¥å¿—æ–‡ä»¶çš„æ‰€æœ‰è€…ï¼Œä»¥ä¾¿å¦ä¸€ä¸ªç³»ç»Ÿç”¨æˆ·å¯ä»¥å¯¹å…¶è¿›è¡Œè¯»å†™æ“ä½œã€‚æˆ‘ä»¬å‡è®¾æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„æ˜¯ <code>/var/log/myapp.log</code>ï¼Œå¹¶ä¸”ä½ æƒ³æŠŠå®ƒçš„æ‰€æœ‰è€…æ”¹æˆç”¨æˆ· ID ä¸º <code>1001</code>ï¼Œç»„ ID ä¸º <code>1002</code> çš„ç”¨æˆ·ã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦å¼•å…¥ Node.js çš„ <code>fs</code> æ¨¡å—ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç„¶åï¼Œä½¿ç”¨ <code>fs.chown</code> æ–¹æ³•æ›´æ”¹æ–‡ä»¶æ‰€æœ‰è€…ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">chown</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/var/log/myapp.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1001</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1002</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Failed to change owner:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Owner changed successfully.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬æŒ‡å®šäº†æ–‡ä»¶è·¯å¾„ã€æ–°çš„ç”¨æˆ· ID å’Œç»„ IDã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œæ§åˆ¶å°å°†è¾“å‡ºâ€œOwner changed successfully.â€ï¼›å¦‚æœå¤±è´¥ï¼Œä¼šæ˜¾ç¤ºå‡ºé”™ä¿¡æ¯ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-8" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-8"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li><strong>æƒé™</strong>ï¼šè¿è¡Œä½¿ç”¨ <code>fs.chown</code> çš„è„šæœ¬çš„ç”¨æˆ·éœ€è¦æœ‰è¶³å¤Ÿçš„æƒé™å»ä¿®æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰è€…ã€‚é€šå¸¸ï¼Œè¿™æ„å‘³ç€ä½ éœ€è¦ä»¥ root ç”¨æˆ·æˆ–ç­‰æ•ˆæƒé™è¿è¡Œ Node.js è„šæœ¬ã€‚</li><li><strong>å¼‚æ­¥æ€§è´¨</strong>ï¼šè®°ä½ <code>fs.chown</code> æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œè¿™æ„å‘³ç€å®ƒä¸ä¼šç«‹å³æ›´æ”¹æ‰€æœ‰è€…ã€‚å®ƒçš„æ“ä½œå®Œæˆæ—¶ï¼Œå°†é€šè¿‡è°ƒç”¨æä¾›çš„å›è°ƒå‡½æ•°æ¥é€šçŸ¥ä½ ã€‚</li><li><strong>åŒæ­¥ç‰ˆæœ¬</strong>ï¼šå¦‚æœä½ éœ€è¦åŒæ­¥ç‰ˆæœ¬çš„ <code>fs.chown</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>fs.chownSync</code> æ–¹æ³•ã€‚æ³¨æ„ä½¿ç”¨åŒæ­¥æ–¹æ³•å°†é˜»å¡äº‹ä»¶å¾ªç¯ï¼Œç›´åˆ°æ“ä½œå®Œæˆã€‚</li></ul><p>é€šè¿‡ç†è§£å’Œä½¿ç”¨ <code>fs.chown</code>ï¼Œä½ å¯ä»¥åœ¨ Node.js åº”ç”¨ç¨‹åºä¸­æœ‰æ•ˆåœ°ç®¡ç†æ–‡ä»¶å’Œç›®å½•çš„æ‰€æœ‰æƒï¼Œä»è€Œä¸ºä½ çš„åº”ç”¨ç¨‹åºæä¾›æ›´é«˜çº§åˆ«çš„å®‰å…¨æ€§å’Œçµæ´»æ€§ã€‚</p><h3 id="fs-close-fd-callback" tabindex="-1"><a class="header-anchor" href="#fs-close-fd-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsclosefd-callback" target="_blank" rel="noopener noreferrer">fs.close(fd[, callback])</a></span></a></h3><p>äº†è§£ Node.js ä¸­çš„<code>fs.close(fd[, callback])</code>æ–¹æ³•ï¼Œæˆ‘ä»¬é¦–å…ˆè¦ç†è§£ä¸€äº›åŸºæœ¬æ¦‚å¿µã€‚åœ¨ Node.js ä¸­ï¼Œ<code>fs</code>æ¨¡å—æ˜¯ç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„ä¸€ä¸ªéå¸¸æ ¸å¿ƒçš„æ¨¡å—ã€‚å®ƒæä¾›äº†å¾ˆå¤šå‡½æ•°ï¼Œå…è®¸ä½ åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œæ–‡ä»¶æ“ä½œï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶å†…å®¹ã€å†™å…¥æ•°æ®åˆ°æ–‡ä»¶ã€åˆ é™¤æ–‡ä»¶ç­‰ã€‚å½“æˆ‘ä»¬è°ˆè®º<code>fs.close</code>è¿™ä¸ªå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨çš„æ˜¯å®ƒå¦‚ä½•å¸®åŠ©æˆ‘ä»¬â€œå…³é—­â€ä¸€ä¸ªä¹‹å‰æ‰“å¼€çš„æ–‡ä»¶ã€‚</p><h3 id="åŸºæœ¬ç†è§£" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç†è§£"><span>åŸºæœ¬ç†è§£</span></a></h3><ul><li><p><strong>æ–‡ä»¶æè¿°ç¬¦ï¼ˆfdï¼‰</strong>ï¼šå½“ä½ åœ¨ Node.js ä¸­æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œè¯»å†™æ“ä½œæ—¶ï¼Œç³»ç»Ÿä¼šä¸ºè¿™ä¸ªæ‰“å¼€çš„æ–‡ä»¶åˆ†é…ä¸€ä¸ªæ‰€è°“çš„â€œæ–‡ä»¶æè¿°ç¬¦â€ã€‚è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦æ˜¯ä¸€ä¸ªç®€å•çš„æ•°å­—ï¼Œä½†å®ƒä»£è¡¨ç€åº•å±‚æ“ä½œç³»ç»Ÿä¸­é‚£ä¸ªè¢«æ‰“å¼€æ–‡ä»¶çš„å¼•ç”¨ã€‚æ–‡ä»¶æè¿°ç¬¦å…è®¸æˆ‘ä»¬åç»­è¿›è¡Œå„ç§æ–‡ä»¶æ“ä½œï¼Œæ¯”å¦‚è¯»æˆ–å†™ã€‚</p></li><li><p><strong>ä¸ºä»€ä¹ˆè¦å…³é—­æ–‡ä»¶</strong>ï¼šæ‰“å¼€çš„æ–‡ä»¶ä¼šå ç”¨ç³»ç»Ÿèµ„æºï¼Œè€Œä¸”åœ¨ä¸€ä¸ªæ—¶é—´ç‚¹ä¸Šç³»ç»Ÿèƒ½æ‰“å¼€çš„æ–‡ä»¶æ•°é‡æ˜¯æœ‰é™çš„ã€‚å› æ­¤ï¼Œåœ¨å®Œæˆæ–‡ä»¶æ“ä½œåï¼Œé‡Šæ”¾è¿™äº›èµ„æºæ˜¯éå¸¸é‡è¦çš„ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦è°ƒç”¨<code>fs.close</code>æ¥å…³é—­æ–‡ä»¶å¹¶é‡Šæ”¾å¯¹åº”æ–‡ä»¶æè¿°ç¬¦çš„åŸå› ã€‚</p></li></ul><h3 id="fs-close-fd-callback-è§£æ" tabindex="-1"><a class="header-anchor" href="#fs-close-fd-callback-è§£æ"><span><code>fs.close(fd[, callback])</code>è§£æ</span></a></h3><ul><li><p><strong>å‚æ•°</strong>:</p><ul><li><code>fd</code>: è¿™æ˜¯æˆ‘ä»¬æƒ³è¦å…³é—­çš„æ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ã€‚</li><li><code>callback</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ã€‚å½“æ–‡ä»¶æˆåŠŸå…³é—­æˆ–å‘ç”Ÿé”™è¯¯æ—¶ï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚å®ƒéµå¾ª Node.js ä¸­å¸¸è§çš„é”™è¯¯ä¼˜å…ˆçš„å›è°ƒæ¨¡å¼ï¼Œæ„å³ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é”™è¯¯å¯¹è±¡ï¼ˆå¦‚æœæ“ä½œæˆåŠŸï¼Œåˆ™ä¸º<code>null</code>ï¼‰ï¼Œä»»ä½•å…¶ä»–åº”è¯¥ä¼ é€’ç»™å›è°ƒçš„å‚æ•°è·Ÿåœ¨é”™è¯¯å¯¹è±¡åé¢ã€‚</li></ul></li><li><p><strong>åŠŸèƒ½</strong>: ç®€å•æ¥è¯´ï¼Œ<code>fs.close</code>çš„ä½œç”¨å°±æ˜¯å…³é—­ä¹‹å‰é€šè¿‡<code>fs.open</code>æˆ–å…¶ä»–æ–¹å¼æ‰“å¼€çš„æ–‡ä»¶ï¼Œå¹¶ä¸”é‡Šæ”¾ç›¸åº”çš„æ–‡ä»¶æè¿°ç¬¦ã€‚</p></li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-8" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-8"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªéœ€æ±‚ï¼šå‘ä¸€ä¸ªæ–‡ä»¶å†™å…¥ä¸€äº›æ•°æ®ï¼Œç„¶åå®‰å…¨åœ°å…³é—­è¿™ä¸ªæ–‡ä»¶ã€‚ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨<code>fs.close</code>æ¥å®ç°è¿™ä¸ªæ“ä½œçš„ä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// é¦–å…ˆï¼Œæˆ‘ä»¬æ‰“å¼€æ–‡ä»¶å‡†å¤‡å†™å…¥ï¼ˆè¿™é‡Œç®€åŒ–äº†é”™è¯¯å¤„ç†ï¼‰</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/your/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å†™å…¥æ–‡ä»¶ï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼Œä¸è€ƒè™‘å†™å…¥é”™è¯¯ç­‰ï¼‰</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, world!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // ç°åœ¨æˆ‘ä»¬å®Œæˆäº†æ–‡ä»¶å†™æ“ä½œï¼Œæ¥ä¸‹æ¥å…³é—­å®ƒ</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File has been closed successfully.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨<code>fs.open</code>ä»¥å†™å…¥æ¨¡å¼æ‰“å¼€æ–‡ä»¶å¹¶è·å¾—æ–‡ä»¶æè¿°ç¬¦<code>fd</code>ã€‚æ¥ç€ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>fs.write</code>å‘æ–‡ä»¶ä¸­å†™å…¥&quot;Hello, world!&quot;å­—ç¬¦ä¸²ã€‚æœ€åï¼Œè°ƒç”¨<code>fs.close</code>å¹¶ä¼ å…¥<code>fd</code>æ¥å…³é—­æ–‡ä»¶ã€‚æ¯æ­¥éƒ½æœ‰é”™è¯¯æ£€æŸ¥ï¼Œç¡®ä¿æˆ‘ä»¬å¯ä»¥æ•æ‰åˆ°ä»»ä½•å¯èƒ½å‡ºç°çš„é—®é¢˜ã€‚</p><p>å¸Œæœ›è¿™ä¸ªè§£é‡Šå’Œä¾‹å­èƒ½å¤Ÿå¸®åŠ©ä½ ç†è§£<code>fs.close(fd[, callback])</code>åœ¨ Node.js ä¸­çš„ç”¨æ³•ï¼</p><h3 id="fs-copyfile-src-dest-mode-callback" tabindex="-1"><a class="header-anchor" href="#fs-copyfile-src-dest-mode-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fscopyfilesrc-dest-mode-callback" target="_blank" rel="noopener noreferrer">fs.copyFile(src, dest[, mode], callback)</a></span></a></h3><p>Node.js çš„ <code>fs.copyFile</code> å‡½å¼æ˜¯ä¸€ä¸ªç”¨äºå¤åˆ¶æ–‡ä»¶çš„å·¥å…·ï¼Œå®ƒå±äº Node.js çš„ File Systemï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰æ¨¡å—ã€‚è¿™ä¸ªå‡½æ•°è®©æˆ‘ä»¬å¯ä»¥åœ¨ä»£ç ä¸­è½»æ¾åœ°å¤åˆ¶æ–‡ä»¶ï¼Œè€Œä¸éœ€è¦æ‰‹åŠ¨è¯»å–æ–‡ä»¶å†…å®¹ç„¶åå†å†™å…¥æ–°æ–‡ä»¶ã€‚è¿™å¯¹äºè¿›è¡Œæ–‡ä»¶æ“ä½œçš„è„šæœ¬å’Œåº”ç”¨ç¨‹åºæ¥è¯´éå¸¸æœ‰ç”¨ã€‚</p><h3 id="å‚æ•°è§£é‡Š-12" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-12"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><strong>src (æºæ–‡ä»¶è·¯å¾„)</strong>: è¿™æ˜¯ä½ æƒ³è¦å¤åˆ¶çš„æ–‡ä»¶çš„è·¯å¾„ã€‚</li><li><strong>dest (ç›®æ ‡æ–‡ä»¶è·¯å¾„)</strong>: è¿™æ˜¯æ–‡ä»¶å¤åˆ¶åˆ°çš„æ–°ä½ç½®å’Œåç§°ã€‚</li><li><strong>mode (å¯é€‰)</strong>: è¿™æ˜¯ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šå¦‚ä½•å¤åˆ¶æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥æŒ‡å®šæ˜¯å¦è¦†ç›–ç›®æ ‡æ–‡ä»¶ã€‚æœ€å¸¸è§çš„æ¨¡å¼æ˜¯ <code>0</code> (é»˜è®¤å€¼) å’Œ <code>fs.constants.COPYFILE_EXCL</code>ï¼Œåè€…è¡¨ç¤ºå¦‚æœç›®æ ‡æ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™æ“ä½œå°†å¤±è´¥ã€‚</li><li><strong>callback</strong>: å½“å¤åˆ¶å®Œæˆæˆ–å‘ç”Ÿé”™è¯¯æ—¶ï¼Œä¼šè°ƒç”¨æ­¤å›è°ƒå‡½æ•°ã€‚å®ƒéµå¾ª Node.js ä¸­å¸¸è§çš„é”™è¯¯ä¼˜å…ˆçš„å›è°ƒé£æ ¼ï¼Œå³ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é”™è¯¯å¯¹è±¡ï¼ˆå¦‚æœæ“ä½œæˆåŠŸåˆ™ä¸º <code>null</code>ï¼‰ï¼Œå…¶ä½™å‚æ•°ç”¨äºä¼ é€’å‡½æ•°çš„ç»“æœã€‚</li></ul><h3 id="ä½¿ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹-1"><span>ä½¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º &quot;example.txt&quot; çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬æƒ³å°†å…¶å¤åˆ¶åˆ°åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œæ–°æ–‡ä»¶å‘½åä¸º &quot;copy_of_example.txt&quot;ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æºæ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> src</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// ç›®æ ‡æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dest</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">copy_of_example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">copyFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">src</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dest</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å¤åˆ¶æ–‡ä»¶æ—¶å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å¤åˆ¶æˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é¦–å…ˆé€šè¿‡ <code>require</code> å¼•å…¥ Node.js çš„ <code>fs</code> æ¨¡å—ã€‚ç„¶åå®šä¹‰äº†æºæ–‡ä»¶å’Œç›®æ ‡æ–‡ä»¶çš„è·¯å¾„ã€‚ä½¿ç”¨ <code>fs.copyFile</code> æ–¹æ³•å¤åˆ¶æ–‡ä»¶ï¼Œå¹¶æä¾›ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥å¤„ç†å¯èƒ½å‘ç”Ÿçš„é”™è¯¯æˆ–ç¡®è®¤å¤åˆ¶æˆåŠŸã€‚</p><h3 id="å®é™…åº”ç”¨åœºæ™¯ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨åœºæ™¯ç¤ºä¾‹"><span>å®é™…åº”ç”¨åœºæ™¯ç¤ºä¾‹</span></a></h3><ol><li><strong>å¤‡ä»½ç³»ç»Ÿ</strong>ï¼šåœ¨æ‰§è¡Œä¸€äº›å¯èƒ½ä¼šä¿®æ”¹å¤§é‡æ•°æ®æˆ–æ–‡ä»¶çš„æ“ä½œä¹‹å‰ï¼Œè‡ªåŠ¨åˆ›å»ºé‡è¦æ–‡ä»¶çš„å¤‡ä»½ã€‚</li><li><strong>é™æ€èµ„æºç®¡ç†</strong>ï¼šåœ¨å¼€å‘ç½‘ç«™æˆ–åº”ç”¨æ—¶ï¼Œå¯èƒ½éœ€è¦å°†å›¾ç‰‡ã€æ ·å¼è¡¨ã€è„šæœ¬ç­‰é™æ€èµ„æºä»æºç›®å½•å¤åˆ¶åˆ°å‘å¸ƒç›®å½•ã€‚</li><li><strong>æ•°æ®è¿ç§»</strong>ï¼šåœ¨æ›´æ–°è½¯ä»¶æˆ–ç³»ç»Ÿæ—¶ï¼Œå¯èƒ½éœ€è¦å°†ç”¨æˆ·æ•°æ®ä»æ—§ç‰ˆæœ¬çš„å­˜å‚¨ä½ç½®å¤åˆ¶åˆ°æ–°ç‰ˆæœ¬ä½¿ç”¨çš„ä½ç½®ã€‚</li></ol><p>é€šè¿‡è¿™æ ·çš„åŠŸèƒ½ï¼ŒNode.js æä¾›äº†ä¸€ä¸ªå¼ºå¤§è€Œç®€å•çš„æ–¹æ³•æ¥åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­å¤„ç†æ–‡ä»¶å¤åˆ¶ä»»åŠ¡ï¼Œæå¤§åœ°ç®€åŒ–äº†æ–‡ä»¶æ“ä½œç›¸å…³çš„å¼€å‘å·¥ä½œã€‚</p><h3 id="fs-cp-src-dest-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-cp-src-dest-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fscpsrc-dest-options-callback" target="_blank" rel="noopener noreferrer">fs.cp(src, dest[, options], callback)</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘å¾ˆä¹æ„å¸®åŠ©ä½ ç†è§£ Node.js ä¸­çš„ <code>fs.cp(src, dest[, options], callback)</code>ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-7" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-7"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æ˜¯ç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ã€‚å®ƒæä¾›äº†ä¸€ç³»åˆ—çš„æ–¹æ³•ç”¨äºæ“ä½œæ–‡ä»¶å’Œç›®å½•ã€‚å…¶ä¸­ï¼Œ<code>fs.cp(src, dest[, options], callback)</code> æ˜¯ä¸€ä¸ªç”¨äºå¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•çš„å‡½æ•°ã€‚</p><ul><li><strong>src</strong>: è¡¨ç¤ºæºè·¯å¾„ï¼Œå³ä½ æƒ³è¦å¤åˆ¶çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚</li><li><strong>dest</strong>: è¡¨ç¤ºç›®æ ‡è·¯å¾„ï¼Œå³ä½ æƒ³è¦å°†æ–‡ä»¶æˆ–ç›®å½•å¤åˆ¶åˆ°å“ªé‡Œã€‚</li><li><strong>options</strong>: ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…è®¸ä½ æŒ‡å®šé¢å¤–çš„è¡Œä¸ºï¼Œæ¯”å¦‚æ˜¯å¦é€’å½’å¤åˆ¶ç›®å½•ã€‚</li><li><strong>callback</strong>: å½“å¤åˆ¶å®Œæˆæˆ–å‡ºç°é”™è¯¯æ—¶ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚</li></ul><h3 id="å‚æ•°è¯¦è§£-4" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯¦è§£-4"><span>å‚æ•°è¯¦è§£</span></a></h3><ol><li><strong>src (æºè·¯å¾„)</strong>: è¿™æ˜¯ä½ æƒ³è¦å¤åˆ¶çš„å¯¹è±¡çš„è·¯å¾„ã€‚å®ƒå¯ä»¥æ˜¯ä¸€ä¸ªæ–‡ä»¶çš„è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªç›®å½•çš„è·¯å¾„ã€‚</li><li><strong>dest (ç›®æ ‡è·¯å¾„)</strong>: è¿™æ˜¯å¤åˆ¶çš„ç›®çš„åœ°è·¯å¾„ã€‚å¦‚æœæ˜¯æ–‡ä»¶å¤åˆ¶ï¼Œä½ éœ€è¦æä¾›åŒ…å«æ–°æ–‡ä»¶åçš„å®Œæ•´è·¯å¾„ã€‚å¦‚æœæ˜¯ç›®å½•ï¼Œåˆ™åªéœ€æä¾›ç›®å½•è·¯å¾„ã€‚</li><li><strong>options</strong>: è¿™ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ã€‚å®ƒå¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢åŒ…å«äº†ä¸€äº›æ§åˆ¶å¤åˆ¶è¡Œä¸ºçš„è®¾ç½®ã€‚æ¯”å¦‚ï¼š <ul><li>å¦‚æœè®¾ç½®äº† <code>{ recursive: true }</code>ï¼Œåˆ™ä¼šé€’å½’å¤åˆ¶ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•å’Œæ–‡ä»¶ã€‚è¿™å¯¹äºå¤åˆ¶æ•´ä¸ªç›®å½•ç»“æ„éå¸¸æœ‰ç”¨ã€‚</li><li><code>{ force: true }</code> å…è®¸è¦†ç›–ç›®æ ‡ä½ç½®çš„æ–‡ä»¶ã€‚</li></ul></li><li><strong>callback</strong>: è¿™æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå½“å¤åˆ¶æ“ä½œå®Œæˆæ—¶ï¼ŒNode.js å°†è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚å¦‚æœè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œé”™è¯¯ä¿¡æ¯ä¼šä½œä¸ºå›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥ï¼›å¦‚æœå¤åˆ¶æˆåŠŸï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¼šæ˜¯ <code>null</code>ã€‚</li></ol><h3 id="å®é™…ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-3"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹åœºæ™¯ï¼š</p><ol><li><strong>å¤åˆ¶å•ä¸ªæ–‡ä»¶</strong>ï¼šæˆ‘ä»¬æƒ³è¦å°† <code>example.txt</code> æ–‡ä»¶ä»ä¸€ä¸ªç›®å½•å¤åˆ¶åˆ°å¦ä¸€ä¸ªç›®å½•ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®šä¹‰æºæ–‡ä»¶å’Œç›®æ ‡æ–‡ä»¶çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> srcFile</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./source/example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> destFile</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./destination/exampleCopy.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨ fs.cp å¤åˆ¶æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">cp</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">srcFile</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> destFile</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²æˆåŠŸå¤åˆ¶ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>é€’å½’å¤åˆ¶ç›®å½•</strong>ï¼šæˆ‘ä»¬æƒ³è¦å¤åˆ¶æ•´ä¸ªç›®å½•åŠå…¶å­ç›®å½•åˆ°æ–°ä½ç½®ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®šä¹‰æºç›®å½•å’Œç›®æ ‡ç›®å½•çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> srcDir</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./sourceFolder</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> destDir</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./destinationFolder</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ options å‚æ•°è®¾ç½®é€’å½’å¤åˆ¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">cp</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">srcDir</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> destDir</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> recursive</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•å·²æˆåŠŸå¤åˆ¶ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä»¥ä¸Šä¸¤ä¸ªä¾‹å­ï¼Œä½ åº”è¯¥èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£ <code>fs.cp</code> å‡½æ•°æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒæ¥å¤åˆ¶æ–‡ä»¶å’Œç›®å½•ã€‚è¿™æ˜¯åœ¨å¼€å‘è¿‡ç¨‹ä¸­ç»å¸¸éœ€è¦è¿›è¡Œçš„æ“ä½œï¼Œç‰¹åˆ«æ˜¯å½“å¤„ç†å¤§é‡æ•°æ®æˆ–è€…éœ€è¦å¤‡ä»½æŸäº›å†…å®¹æ—¶ã€‚</p><h3 id="fs-createreadstream-path-options" tabindex="-1"><a class="header-anchor" href="#fs-createreadstream-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fscreatereadstreampath-options" target="_blank" rel="noopener noreferrer">fs.createReadStream(path[, options])</a></span></a></h3><p>å½“ä½ å¬åˆ° <code>fs.createReadStream</code> è¿™ä¸ªæœ¯è¯­æ—¶ï¼Œä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ç§åœ¨ Node.js ä¸­è¯»å–æ–‡ä»¶çš„æ–¹å¼ï¼Œè¿™é‡Œçš„ <code>fs</code> ä»£è¡¨æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰ï¼Œæ˜¯ Node.js æä¾›çš„ä¸€ä¸ªæ¨¡å—ï¼Œç”¨äºå¤„ç†æ–‡ä»¶æ“ä½œã€‚ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä½ å¯ä»¥ä»¥æµçš„å½¢å¼é€æ­¥è¯»å–å¤§å‹æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§å°†æ•´ä¸ªæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè¿™å¯¹äºå¤„ç†å¤§æ–‡ä»¶æˆ–æ•°æ®ä¼ è¾“å°¤å…¶æœ‰æ•ˆã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-8" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-8"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><ul><li><strong>æµï¼ˆStreamï¼‰</strong>ï¼šåœ¨ Node.js ä¸­ï¼Œæµæ˜¯ä¸€ç³»åˆ—æ•°æ®çš„ç§»åŠ¨é€šé“ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœä½ æœ‰ä¸€æ¯æ°´ï¼ˆå³æ•°æ®ï¼‰éœ€è¦å€’å…¥å¦ä¸€ä¸ªå®¹å™¨ä¸­ï¼Œæµå°±æ˜¯è¿æ¥ä¸¤ä¸ªå®¹å™¨çš„ç®¡é“ã€‚æµå¯ä»¥æ˜¯å¯è¯»çš„ã€å¯å†™çš„ï¼Œæˆ–è€…å³å¯è¯»åˆå¯å†™ã€‚</li><li><strong><code>fs.createReadStream</code></strong>ï¼šè¿™æ˜¯ä¸€ä¸ªåˆ›å»ºå¯è¯»æµçš„æ–¹æ³•ï¼Œç”¨äºä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®ã€‚</li></ul><h3 id="å‚æ•°-4" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-4"><span>å‚æ•°</span></a></h3><ul><li><strong>path</strong>ï¼šè¿™æ˜¯æ–‡ä»¶è·¯å¾„çš„å­—ç¬¦ä¸²ï¼ŒæŒ‡æ˜äº†ä½ æƒ³è¦è¯»å–çš„æ–‡ä»¶åœ¨å“ªé‡Œã€‚</li><li><strong>options</strong>ï¼ˆå¯é€‰ï¼‰ï¼šè¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå…è®¸ä½ å®šåˆ¶è¡Œä¸ºï¼Œæ¯”å¦‚æŒ‡å®šç¼–ç ç±»å‹ã€æŒ‡å®šæµå¼€å§‹å’Œç»“æŸçš„ä½ç½®ç­‰ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-13" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-13"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="ä¾‹å­-1-è¯»å–æ–‡æœ¬æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-è¯»å–æ–‡æœ¬æ–‡ä»¶"><span>ä¾‹å­ 1ï¼šè¯»å–æ–‡æœ¬æ–‡ä»¶</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º &quot;example.txt&quot; çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>Hello, Node.js!</span></span>
<span class="line"><span>Welcome to file streaming.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>createReadStream</code> æ¥è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªå¯è¯»æµ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> readStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘å¬ &#39;data&#39; äº‹ä»¶æ¥è¯»å–æ•°æ®å—</span></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">data</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> function</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">New data received:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">chunk</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘å¬ &#39;end&#39; äº‹ä»¶ï¼Œè¡¨ç¤ºæ–‡ä»¶è¯»å–å®Œæ¯•</span></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">end</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> function</span><span style="color:#ECEFF4;"> ()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File reading completed.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ–‡ä»¶çš„å†…å®¹è¢«åˆ†æˆå°å—è¯»å–ã€‚æ¯å½“è¯»å–åˆ°æ–°çš„æ•°æ®å—æ—¶ï¼Œéƒ½ä¼šè§¦å‘ <code>&#39;data&#39;</code> äº‹ä»¶ï¼Œå¹¶é€šè¿‡å›è°ƒå‡½æ•°è¾“å‡ºæ•°æ®å—å†…å®¹ã€‚å½“æ‰€æœ‰å†…å®¹è¯»å–å®Œæ¯•åï¼Œä¼šè§¦å‘ <code>&#39;end&#39;</code> äº‹ä»¶ã€‚</p><h4 id="ä¾‹å­-2-å¤åˆ¶æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-å¤åˆ¶æ–‡ä»¶"><span>ä¾‹å­ 2ï¼šå¤åˆ¶æ–‡ä»¶</span></a></h4><p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>fs.createReadStream</code> ç»“åˆ <code>fs.createWriteStream</code> æ¥å¤åˆ¶æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæƒ³è¦å¤åˆ¶ â€œsource.txtâ€ æ–‡ä»¶åˆ° â€œdestination.txtâ€ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºè¯»å–å’Œå†™å…¥æµ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> readStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">source.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> writeStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">destination.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å°†è¯»å–çš„æ•°æ®ç›´æ¥å†™å…¥ç›®æ ‡æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">pipe</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">writeStream</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">finish</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File copy completed.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œ<code>pipe()</code> æ–¹æ³•æ˜¯å…³é”®ï¼Œå®ƒå°†å¯è¯»æµå’Œå¯å†™æµè¿æ¥èµ·æ¥ï¼Œä½¿å¾—ä»æºæ–‡ä»¶è¯»å–çš„æ•°æ®å¯ä»¥ç›´æ¥å†™å…¥ç›®æ ‡æ–‡ä»¶ã€‚</p><p>é€šè¿‡ä»¥ä¸Šä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>fs.createReadStream</code> åœ¨å¤„ç†æ–‡ä»¶è¯»å–æ–¹é¢çš„çµæ´»æ€§å’Œæ•ˆç‡ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§å‹æ–‡ä»¶æ—¶ã€‚å¸Œæœ›è¿™äº›ä¾‹å­èƒ½å¤Ÿå¸®åŠ©ä½ ç†è§£å¹¶å¼€å§‹ä½¿ç”¨ Node.js çš„æ–‡ä»¶æµåŠŸèƒ½ã€‚</p><h3 id="fs-createwritestream-path-options" tabindex="-1"><a class="header-anchor" href="#fs-createwritestream-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fscreatewritestreampath-options" target="_blank" rel="noopener noreferrer">fs.createWriteStream(path[, options])</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©ä½ èƒ½å¤Ÿåœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚<code>fs</code> æ¨¡å—æ˜¯ Node.js çš„æ ¸å¿ƒæ¨¡å—ä¹‹ä¸€ï¼Œæä¾›äº†æ–‡ä»¶æ“ä½œçš„ APIã€‚<code>fs.createWriteStream</code> æ˜¯è¿™ä¸ªæ¨¡å—ä¸­ç”¨æ¥åˆ›å»ºä¸€ä¸ªå¯å†™æµï¼ˆwrite streamï¼‰çš„æ–¹æ³•ï¼Œå®ƒå…è®¸ä½ å°†æ•°æ®ä¸€ç‰‡æ®µä¸€ç‰‡æ®µåœ°å†™å…¥åˆ°æ–‡ä»¶ä¸­ã€‚</p><h3 id="ä½¿ç”¨-fs-createwritestream" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-fs-createwritestream"><span>ä½¿ç”¨ <code>fs.createWriteStream</code></span></a></h3><p>å½“æˆ‘ä»¬è¯´â€œæµï¼ˆstreamï¼‰â€ï¼Œæˆ‘ä»¬æŒ‡çš„æ˜¯æ•°æ®çš„ä¸€è¿ä¸²ä¼ è¾“ã€‚æƒ³è±¡æˆæ°´æµï¼Œä½ å¯ä»¥ä¸€æ»´ä¸€æ»´åœ°åŠ æ°´ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§å€’å…¥å…¨éƒ¨ã€‚åœ¨ç¼–ç¨‹ä¸­ï¼Œè¿™æ„å‘³ç€å¯ä»¥åˆ†æ‰¹æ¬¡åœ°å¤„ç†å¤§é‡æ•°æ®ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§åŠ è½½è¿›å†…å­˜ï¼Œä»è€Œæé«˜æ•ˆç‡å’Œæ€§èƒ½ã€‚</p><h4 id="åŸºæœ¬è¯­æ³•" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬è¯­æ³•"><span>åŸºæœ¬è¯­æ³•ï¼š</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> stream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">[</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> options</span><span style="color:#D8DEE9FF;">])</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>path</code>: æ˜¯ä½ æƒ³è¦åˆ›å»ºæ–‡ä»¶çš„ä½ç½®å’Œæ–‡ä»¶åã€‚</li><li><code>options</code>: æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…è®¸ä½ æŒ‡å®šå…³äºæµçš„å„ç§è®¾ç½®ï¼Œæ¯”å¦‚ç¼–ç ç±»å‹ç­‰ã€‚</li></ul><h4 id="ä¸¾ä¸ªä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#ä¸¾ä¸ªä¾‹å­-1"><span>ä¸¾ä¸ªä¾‹å­ï¼š</span></a></h4><p>å‡è®¾æˆ‘ä»¬æƒ³è¦ç”Ÿæˆä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œè®°å½•åº”ç”¨ç¨‹åºçš„è¿è¡Œæƒ…å†µã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>fs.createWriteStream</code> æ¥å®ç°è¿™ä¸ªéœ€æ±‚ã€‚</p><p><strong>æ­¥éª¤ 1ï¼š</strong> å¯¼å…¥ fs æ¨¡å—ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>æ­¥éª¤ 2ï¼š</strong> åˆ›å»ºä¸€ä¸ªå†™å…¥æµåˆ° &quot;application.log&quot; æ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> writeStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">application.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>æ­¥éª¤ 3ï¼š</strong> ä½¿ç”¨ <code>.write()</code> æ–¹æ³•å†™å…¥æ•°æ®åˆ°æ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯ç¬¬ä¸€è¡Œæ—¥å¿—</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯ç¬¬äºŒè¡Œæ—¥å¿—</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ­¥éª¤ 4ï¼š</strong> æœ€åï¼Œå½“ä½ å®Œæˆæ–‡ä»¶å†™å…¥æ—¶ï¼Œä½¿ç”¨ <code>.end()</code> æ–¹æ³•ç»“æŸæµã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>é€šè¿‡ä¸Šé¢çš„æ­¥éª¤ï¼Œæˆ‘ä»¬å°±æˆåŠŸåˆ›å»ºäº†ä¸€ä¸ªåä¸º &quot;application.log&quot; çš„æ–‡ä»¶ï¼Œå¹¶å‘å…¶ä¸­å†™å…¥äº†ä¸¤è¡Œæ—¥å¿—ä¿¡æ¯ã€‚é€šè¿‡é€æ­¥å†™å…¥æ•°æ®ï¼Œæˆ‘ä»¬æœ‰æ•ˆåœ°ç®¡ç†äº†å†…å­˜ä½¿ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶ã€‚</p><h4 id="é«˜çº§é€‰é¡¹" tabindex="-1"><a class="header-anchor" href="#é«˜çº§é€‰é¡¹"><span>é«˜çº§é€‰é¡¹ï¼š</span></a></h4><p>åœ¨ <code>fs.createWriteStream</code> ä¸­ä½¿ç”¨ <code>options</code> å‚æ•°å¯ä»¥è®©ä½ æœ‰æ›´å¤šçš„æ§åˆ¶æƒã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥è®¾å®šç¼–ç ç±»å‹ã€å†³å®šæ˜¯å¦åœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ å†…å®¹ç­‰ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> writeStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">application.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">  flags</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#616E88;"> // &#39;a&#39; è¡¨ç¤ºè¿½åŠ å†…å®¹ï¼›é»˜è®¤å€¼æ˜¯ &#39;w&#39;ï¼Œå³å†™å…¥æ–°å†…å®¹å‰æ¸…ç©ºæ–‡ä»¶</span></span>
<span class="line"><span style="color:#88C0D0;">  encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#616E88;"> // è®¾ç½®æ–‡ä»¶ç¼–ç </span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä½¿ç”¨è¿™äº›é«˜çº§é€‰é¡¹ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦çµæ´»åœ°å¤„ç†æ–‡ä»¶å†™å…¥æ“ä½œã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>fs.createWriteStream</code> æä¾›äº†ä¸€ç§é«˜æ•ˆçš„æ–¹å¼æ¥å¤„ç†æ–‡ä»¶å†™å…¥æ“ä½œï¼Œç‰¹åˆ«æ˜¯å½“ä½ éœ€è¦å¤„ç†å¤§é‡æ•°æ®æˆ–è€…å¸Œæœ›é€æ­¥å†™å…¥æ•°æ®æ—¶ã€‚æ— è®ºæ˜¯è®°å½•æ—¥å¿—ã€ç”ŸæˆæŠ¥è¡¨è¿˜æ˜¯å¤„ç†åª’ä½“æ–‡ä»¶ï¼Œè¿™éƒ½æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„å·¥å…·ã€‚</p><h3 id="fs-exists-path-callback" tabindex="-1"><a class="header-anchor" href="#fs-exists-path-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsexistspath-callback" target="_blank" rel="noopener noreferrer">fs.exists(path, callback)</a></span></a></h3><p>Node.js ä¸­çš„ <code>fs</code> æ¨¡å—æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„æ¨¡å—ï¼Œæ¯”å¦‚åˆ›å»ºã€è¯»å–ã€å†™å…¥æ–‡ä»¶ç­‰ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>fs.exists</code> æ˜¯è¿™ä¸ªæ¨¡å—ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒè¢«ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªç‰¹å®šè·¯å¾„çš„æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨ã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>fs.exists</code> å‡½æ•°å·²ç»ä¸æ¨èä½¿ç”¨ï¼ˆdeprecatedï¼‰ï¼Œå› ä¸ºå®ƒä¸æ”¯æŒ Promise APIï¼Œå¹¶ä¸”æœ‰ä¸€äº›é™·é˜±ï¼Œä¾‹å¦‚åœ¨ä½ æ£€æŸ¥å®Œä¸€ä¸ªæ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¹‹ååˆ°ä½ å®é™…è¿›è¡Œæ“ä½œä¹‹é—´çš„æ—¶é—´å·®å†…ï¼Œæ–‡ä»¶çš„çŠ¶æ€å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå¯¼è‡´æ½œåœ¨çš„ç«æ€æ¡ä»¶é—®é¢˜ã€‚ç›¸åï¼Œå®˜æ–¹æ¨èä½¿ç”¨ <code>fs.access</code> æˆ–è€… <code>fs.stat</code> æ¥ä»£æ›¿ <code>fs.exists</code>ã€‚</p><p>ä½†æ˜¯ä¸ºäº†å›ç­”ä½ çš„é—®é¢˜ï¼Œæˆ‘ä¼šè§£é‡Š <code>fs.exists</code> çš„ä½¿ç”¨æ–¹æ³•ï¼ŒåŒæ—¶ä¸¾ä¾‹è¯´æ˜æ€ä¹ˆç”¨ <code>fs.access</code> æ¥è¾¾åˆ°åŒæ ·çš„ç›®çš„ã€‚</p><h3 id="fs-exists" tabindex="-1"><a class="header-anchor" href="#fs-exists"><span><code>fs.exists</code></span></a></h3><p><code>fs.exists</code> å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š<code>path</code> å’Œ <code>callback</code>ã€‚</p><ul><li><code>path</code>ï¼šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¦æ£€æŸ¥æ˜¯å¦å­˜åœ¨çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><code>callback</code>ï¼šæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨å®Œæˆæ£€æŸ¥åè¢«è°ƒç”¨ã€‚è¿™ä¸ªå›è°ƒå‡½æ•°æœ‰ä¸€ä¸ªå‚æ•°ï¼Œå³å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨ã€‚</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><p>å‡è®¾æˆ‘ä»¬æƒ³æ£€æŸ¥å½“å‰ç›®å½•ä¸‹æœ‰æ²¡æœ‰ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">exists</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> function</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">exists</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">exists</span><span style="color:#81A1C1;"> ?</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å­˜åœ¨</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶ä¸å­˜åœ¨</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœ <code>example.txt</code> æ–‡ä»¶å­˜åœ¨ï¼Œæ§åˆ¶å°å°†æ‰“å° &quot;æ–‡ä»¶å­˜åœ¨&quot;ï¼›å¦‚æœä¸å­˜åœ¨ï¼Œå°†æ‰“å° &quot;æ–‡ä»¶ä¸å­˜åœ¨&quot;ã€‚</p><h3 id="ä½¿ç”¨-fs-access-æ›¿ä»£-fs-exists" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-fs-access-æ›¿ä»£-fs-exists"><span>ä½¿ç”¨ <code>fs.access</code> æ›¿ä»£ <code>fs.exists</code></span></a></h3><p>ç”±äº <code>fs.exists</code> ä¸å†æ¨èä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>fs.access</code> æ–¹æ³•æ¥æ£€æŸ¥æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨ã€‚<code>fs.access</code> é™¤äº†å¯ä»¥æ£€æŸ¥å­˜åœ¨æ€§ï¼Œè¿˜å¯ä»¥æ£€æŸ¥æˆ‘ä»¬å¯¹æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨äºæ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥è®¿é—®å®ƒ</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">access</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">__dirname</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">F_OK</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶ä¸å­˜åœ¨æˆ–æ— æ³•è®¿é—®</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å­˜åœ¨</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>fs.access</code> æ–¹æ³•ï¼Œå¹¶ä¼ é€’ <code>fs.constants.F_OK</code> å¸¸é‡ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°æ¥æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœå›è°ƒå‡½æ•°ä¸­çš„ <code>err</code> å‚æ•°ä¸º <code>null</code>ï¼Œè¯´æ˜æ–‡ä»¶å­˜åœ¨ä¸”å¯è®¿é—®ï¼›å¦‚æœ <code>err</code> ä¸ä¸º <code>null</code>ï¼Œè¯´æ˜æ–‡ä»¶ä¸å­˜åœ¨æˆ–è€…ä¸èƒ½è®¿é—®ã€‚</p><p>æ€»ç»“ï¼šè™½ç„¶ <code>fs.exists</code> å¯ä»¥ç”¨æ¥æ£€æŸ¥æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œä½†å·²ç»ä¸æ¨èä½¿ç”¨äº†ã€‚ä½ åº”è¯¥è€ƒè™‘ä½¿ç”¨ <code>fs.access</code> æˆ– <code>fs.stat</code> æ¥æ›¿ä»£å®ƒï¼Œåœ¨æ£€æŸ¥æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨çš„åŒæ—¶ï¼Œç¡®ä¿ä»£ç æ›´åŠ ç¨³å›ºå’Œç¬¦åˆæœ€æ–°çš„æ ‡å‡†ã€‚</p><h3 id="fs-fchmod-fd-mode-callback" tabindex="-1"><a class="header-anchor" href="#fs-fchmod-fd-mode-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsfchmodfd-mode-callback" target="_blank" rel="noopener noreferrer">fs.fchmod(fd, mode, callback)</a></span></a></h3><p>å½“æˆ‘ä»¬åœ¨è°ˆè®º Node.js ä¸­çš„ <code>fs.fchmod(fd, mode, callback)</code> å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šåœ¨è®¨è®ºå¦‚ä½•ä½¿ç”¨ Node.js ä¿®æ”¹æ–‡ä»¶çš„æƒé™ã€‚ä¸ºäº†ä½¿è¿™ä¸ªæ¦‚å¿µæ›´åŠ å®¹æ˜“ç†è§£ï¼Œè®©æˆ‘å…ˆè§£é‡Šä¸€ä¸‹è¿™é‡Œé¢æ¶‰åŠåˆ°çš„å‡ ä¸ªå…³é”®ç‚¹ï¼Œç„¶åä¸¾ä¸€äº›å®é™…åº”ç”¨çš„ä¾‹å­ã€‚</p><h3 id="å…³é”®æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#å…³é”®æ¦‚å¿µ"><span>å…³é”®æ¦‚å¿µ</span></a></h3><ol><li><p><strong>File System (fs) æ¨¡å—</strong>ï¼šNode.js æä¾›äº†ä¸€ä¸ªåä¸º <code>fs</code> çš„æ¨¡å—ï¼Œå®ƒåŒ…æ‹¬ä¸€ç³»åˆ—ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„å‡½æ•°ã€‚è¿™äº›å‡½æ•°å…è®¸ä½ åˆ›å»ºã€è¯»å–ã€å†™å…¥å’Œåˆ é™¤æ–‡ä»¶ï¼Œä»¥åŠæ›´æ”¹æ–‡ä»¶å±æ€§ç­‰ã€‚</p></li><li><p><strong>æ–‡ä»¶æè¿°ç¬¦ (fd)</strong>ï¼šæ–‡ä»¶æè¿°ç¬¦æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µã€‚å½“ä½ åœ¨æ“ä½œç³»ç»Ÿä¸­æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šä¸ºè¯¥æ–‡ä»¶åˆ†é…ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå³æ–‡ä»¶æè¿°ç¬¦ã€‚é€šè¿‡è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œä½ å¯ä»¥è¿›è¡Œè¯»å–ã€å†™å…¥æˆ–ä¿®æ”¹æ–‡ä»¶çš„æ“ä½œã€‚</p></li><li><p><strong>Modeï¼ˆæƒé™æ¨¡å¼ï¼‰</strong>ï¼šåœ¨ Unix å’Œç±» Unix ç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶æƒé™æ˜¯ç”±ä¸€ç»„æ•°å­—è¡¨ç¤ºçš„ã€‚è¿™äº›æ•°å­—å†³å®šäº†æ–‡ä»¶çš„æ‰€æœ‰è€…ã€æ‰€å±ç»„ä»¥åŠå…¶ä»–äººå¯¹æ–‡ä»¶çš„è®¿é—®æƒé™ã€‚ä¾‹å¦‚ï¼Œæ•°å­— <code>644</code> é€šå¸¸è¡¨ç¤ºæ–‡ä»¶æ‰€æœ‰è€…å¯ä»¥è¯»å†™è¯¥æ–‡ä»¶ï¼Œè€Œå…¶ä»–äººåªèƒ½è¯»å–ã€‚</p></li><li><p><strong>Callback å‡½æ•°</strong>ï¼šå›è°ƒå‡½æ•°æ˜¯ Node.js å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ä¸ªåŸºæœ¬æ¦‚å¿µã€‚<code>fs.fchmod</code> æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œè¿™æ„å‘³ç€ Node.js ä¸ä¼šåœä¸‹æ¥ç­‰å¾…è¿™ä¸ªæ“ä½œå®Œæˆï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ªä»£ç ã€‚å½“ <code>fs.fchmod</code> å®Œæˆæ“ä½œåï¼Œå®ƒå°†è°ƒç”¨ä½ æä¾›çš„å›è°ƒå‡½æ•°ï¼Œå¹¶ä¼ å…¥å¯èƒ½å‡ºç°çš„é”™è¯¯æˆ–æˆåŠŸçš„ä¿¡å·ã€‚</p></li></ol><h3 id="fs-fchmod-fd-mode-callback-1" tabindex="-1"><a class="header-anchor" href="#fs-fchmod-fd-mode-callback-1"><span>fs.fchmod(fd, mode, callback)</span></a></h3><ul><li><strong><code>fd</code></strong>ï¼šè¿™æ˜¯ä½ è¦æ›´æ”¹æƒé™çš„æ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ã€‚</li><li><strong><code>mode</code></strong>ï¼šè¿™æ˜¯ä¸€ä¸ªæ•°å­—ï¼ŒæŒ‡å®šæ–‡ä»¶æ–°çš„æƒé™è®¾ç½®ã€‚</li><li><strong><code>callback</code></strong>ï¼šå½“æ›´æ”¹æƒé™æ“ä½œå®Œæˆæ—¶ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œé”™è¯¯å‚æ•° (<code>err</code>) å°†ä¼šæ˜¯ <code>null</code>ï¼›å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œ<code>err</code> å°†åŒ…å«é”™è¯¯ä¿¡æ¯ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-4" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-4"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œä½ éœ€è¦åœ¨æŸä¸ªæ—¶åˆ»æ›´æ”¹ä¸€ä¸ªæ–‡ä»¶çš„æƒé™ï¼Œä»¥ç¡®ä¿åªæœ‰è¯¥æ–‡ä»¶çš„ä¸»äººå¯ä»¥è¯»å–å’Œå†™å…¥æ•°æ®ï¼Œè€Œå…¶ä»–äººåˆ™æ²¡æœ‰ä»»ä½•æƒé™ã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦æ‰“å¼€æˆ–åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶è·å–å…¶æ–‡ä»¶æè¿°ç¬¦ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // æˆ‘ä»¬ç°åœ¨æœ‰äº†æ–‡ä»¶çš„æè¿°ç¬¦ fd</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œä½¿ç”¨ <code>fs.fchmod</code> æ¥æ›´æ”¹æ–‡ä»¶æƒé™ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // æ”¹å˜æ–‡ä»¶æƒé™ä¸ºåªæœ‰æ‰€æœ‰è€…å¯ä»¥è¯»å†™</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">fchmod</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0o600</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶æƒé™æ›´æ”¹æˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>0o600</code> æ˜¯ mode å‚æ•°ï¼Œå®ƒè¡¨ç¤ºæ–‡ä»¶æ‰€æœ‰è€…å…·æœ‰è¯»å†™æƒé™ï¼Œè€Œå…¶ä»–äººæ²¡æœ‰ä»»ä½•æƒé™ã€‚é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œä½ å°±å¯ä»¥åœ¨ä½ çš„åº”ç”¨ä¸­çµæ´»åœ°æ§åˆ¶æ–‡ä»¶çš„å®‰å…¨æ€§ã€‚</p><h3 id="fs-fchown-fd-uid-gid-callback" tabindex="-1"><a class="header-anchor" href="#fs-fchown-fd-uid-gid-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsfchownfd-uid-gid-callback" target="_blank" rel="noopener noreferrer">fs.fchown(fd, uid, gid, callback)</a></span></a></h3><p>Node.js ä¸­çš„ <code>fs.fchown</code> æ–¹æ³•æ˜¯æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—ä¸­çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒç”¨äºå¼‚æ­¥åœ°æ”¹å˜ä¸€ä¸ªæ‰“å¼€æ–‡ä»¶çš„ç”¨æˆ·æ‰€æœ‰è€…å’Œç¾¤ç»„ã€‚è¦ç†è§£è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ˜ç™½å‡ ä¸ªæ¦‚å¿µï¼š</p><ul><li><strong>æ–‡ä»¶æè¿°ç¬¦ï¼ˆfdï¼‰</strong>ï¼šå½“åœ¨ Node.js ä¸­æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šæä¾›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œè¿™æ˜¯ä¸€ä¸ªå”¯ä¸€æ ‡è¯†æ‰“å¼€æ–‡ä»¶çš„éè´Ÿæ•´æ•°ã€‚ä½ å¯ä»¥é€šè¿‡æ–‡ä»¶æè¿°ç¬¦æ¥è¿›è¡Œè¯»å†™ç­‰æ“ä½œã€‚</li><li><strong>ç”¨æˆ· IDï¼ˆuidï¼‰</strong>ï¼šåœ¨ Unix-like ç³»ç»Ÿï¼ˆä¾‹å¦‚ Linux, macOSï¼‰ä¸­ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ç”¨æˆ· IDã€‚</li><li><strong>ç¾¤ç»„ IDï¼ˆgidï¼‰</strong>ï¼šé™¤äº†ç”¨æˆ· ID ä¹‹å¤–ï¼Œç³»ç»Ÿä¸Šçš„æ¯ä¸ªç”¨æˆ·è¿˜å¯ä»¥å±äºä¸€ä¸ªæˆ–å¤šä¸ªç¾¤ç»„ï¼Œæ¯ä¸ªç¾¤ç»„ä¹Ÿæœ‰å”¯ä¸€çš„ç¾¤ç»„ IDã€‚</li></ul><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ <code>fs.fchown</code> æ–¹æ³•çš„å®šä¹‰ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">fchown</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> uid</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> gid</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> callback</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>fd</code>ï¼šæ–‡ä»¶æè¿°ç¬¦ï¼ŒæŒ‡å‘ä½ æƒ³è¦ä¿®æ”¹æ‰€æœ‰æƒçš„æ–‡ä»¶ã€‚</li><li><code>uid</code>ï¼šç›®æ ‡ç”¨æˆ· IDï¼Œä½ æƒ³å°†æ–‡ä»¶çš„æ‰€æœ‰æƒæ›´æ”¹ä¸ºæ­¤ç”¨æˆ·ã€‚</li><li><code>gid</code>ï¼šç›®æ ‡ç¾¤ç»„ IDï¼Œä½ æƒ³å°†æ–‡ä»¶çš„ç¾¤ç»„æ‰€æœ‰æƒæ›´æ”¹ä¸ºæ­¤ç¾¤ç»„ã€‚</li><li><code>callback</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“æ“ä½œå®Œæˆåè¢«è°ƒç”¨ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œé”™è¯¯å‚æ•°ï¼ˆerrï¼‰å°†ä¼šæ˜¯ <code>null</code> æˆ– <code>undefined</code>ï¼›å¦‚æœå¤±è´¥ï¼Œåˆ™æ˜¯ä¸€ä¸ªé”™è¯¯å¯¹è±¡ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-9" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-9"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js åº”ç”¨ï¼Œéœ€è¦ä¿®æ”¹ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶çš„æ‰€æœ‰æƒï¼Œä»¥ä¾¿ç‰¹å®šçš„æœåŠ¡ç”¨æˆ·å¯ä»¥å¯¹å…¶è¿›è¡Œè¯»å†™æ“ä½œã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨ <code>fs.fchown</code> æ¥å®ç°è¿™ä¸€ç‚¹çš„ç¤ºä¾‹ï¼š</p><p>é¦–å…ˆï¼Œä½ éœ€è¦ä½¿ç”¨ <code>fs.open</code> æ–¹æ³•æ‰“å¼€æ–‡ä»¶å¹¶è·å–æ–‡ä»¶æè¿°ç¬¦ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶è·å–æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/your/file.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ— æ³•æ‰“å¼€æ–‡ä»¶</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å‡è®¾æ–°çš„ç”¨æˆ·IDæ˜¯ 1000ï¼Œç¾¤ç»„IDæ˜¯ 2000</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> newUid</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 1000</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> newGid</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 2000</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨ fs.fchown æ”¹å˜æ–‡ä»¶çš„æ‰€æœ‰è€…</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">fchown</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> newUid</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> newGid</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ— æ³•æ”¹å˜æ–‡ä»¶æ‰€æœ‰æƒ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶æ‰€æœ‰æƒå·²æˆåŠŸæ›´æ”¹</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // è®°å¾—å…³é—­æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å…³é—­æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡ <code>fs.open</code> æ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶è·å¾—äº†è¯¥æ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ã€‚ç„¶åï¼Œæˆ‘ä»¬è°ƒç”¨ <code>fs.fchown</code> å¹¶ä¼ å…¥æ–‡ä»¶æè¿°ç¬¦ã€æ–°çš„ç”¨æˆ· IDã€æ–°çš„ç¾¤ç»„ IDï¼Œä»¥åŠä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚å¦‚æœæ›´æ”¹æ‰€æœ‰æƒæˆåŠŸï¼Œæˆ‘ä»¬å°±ä¼šåœ¨æ§åˆ¶å°çœ‹åˆ°æˆåŠŸæ¶ˆæ¯ï¼›å¦åˆ™ï¼Œä¼šçœ‹åˆ°é”™è¯¯ä¿¡æ¯ã€‚æœ€åï¼Œä¸è¦å¿˜è®°ä½¿ç”¨ <code>fs.close</code> å…³é—­æ–‡ä»¶æè¿°ç¬¦ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-9" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-9"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€…å¯èƒ½éœ€è¦ç‰¹å®šçš„ç³»ç»Ÿæƒé™ã€‚åœ¨ Unix-like ç³»ç»Ÿä¸Šï¼Œé€šå¸¸åªæœ‰è¶…çº§ç”¨æˆ·ï¼ˆrootï¼‰æˆ–æ–‡ä»¶çš„å½“å‰æ‰€æœ‰è€…æ‰èƒ½æ›´æ”¹æ–‡ä»¶çš„æ‰€æœ‰æƒã€‚</li><li>è¿™ä¸ªæ–¹æ³•ä¸»è¦ç”¨åœ¨ Unix-like ç³»ç»Ÿä¸Šã€‚å¦‚æœä½ çš„åº”ç”¨è¿è¡Œåœ¨ Windows ä¸Šï¼Œè¿™ä¸ªæ–¹æ³•çš„è¡Œä¸ºå¯èƒ½ä¼šä¸é¢„æœŸä¸åŒï¼Œå› ä¸º Windows çš„æ–‡ä»¶æƒé™æ¨¡å‹ä¸ Unix-like ç³»ç»Ÿä¸åŒã€‚</li></ul><h3 id="fs-fdatasync-fd-callback" tabindex="-1"><a class="header-anchor" href="#fs-fdatasync-fd-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsfdatasyncfd-callback" target="_blank" rel="noopener noreferrer">fs.fdatasync(fd, callback)</a></span></a></h3><p>å½“æˆ‘ä»¬è°ˆè®º Node.js ä¸­çš„ <code>fs.fdatasync(fd, callback)</code> å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨è®¨è®ºä¸€ç§æ–¹å¼ï¼Œè¿™ç§æ–¹å¼å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç¡®ä¿æ–‡ä»¶ç³»ç»Ÿå·²ç»å°†æ‰€æœ‰ç­‰å¾…çš„å†™æ“ä½œåŒæ­¥åˆ°äº†ç¡¬ç›˜ä¸Šã€‚è¿™å¯¹äºéœ€è¦é«˜æ•°æ®å®Œæ•´æ€§å’Œå®‰å…¨æ€§çš„åº”ç”¨ç¨‹åºæ¥è¯´ç‰¹åˆ«é‡è¦ã€‚ä¸ºäº†ä½¿å®ƒæ›´æ˜“äºç†è§£ï¼Œè®©æˆ‘ä»¬å…ˆåˆ†è§£å…¶ä¸­çš„å‡ ä¸ªå…³é”®ç‚¹ï¼Œç„¶åé€šè¿‡å®é™…çš„ä¾‹å­æ¥å±•ç¤ºå…¶åœ¨ç°å®ä¸–ç•Œä¸­çš„åº”ç”¨ã€‚</p><h3 id="å…³é”®ç‚¹è§£æ" tabindex="-1"><a class="header-anchor" href="#å…³é”®ç‚¹è§£æ"><span>å…³é”®ç‚¹è§£æ</span></a></h3><ul><li><p><strong>Node.js</strong>: æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚</p></li><li><p><strong><code>fs</code> æ¨¡å—</strong>: <code>fs</code> ä»£è¡¨æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒæ˜¯ Node.js çš„ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œæä¾›äº†å¾ˆå¤šç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„æ–¹æ³•ã€‚</p></li><li><p><strong><code>fs.fdatasync(fd, callback)</code></strong>: è¿™æ˜¯ <code>fs</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œä¸»è¦ç”¨äºç¡®ä¿æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆ<code>fd</code>ï¼‰å¯¹åº”çš„æ–‡ä»¶çš„æ‰€æœ‰å†™å…¥æ“ä½œéƒ½å·²ç»åŒæ­¥åˆ°ç£ç›˜ã€‚</p><ul><li><p><code>fd</code>: æ–‡ä»¶æè¿°ç¬¦ï¼Œæ˜¯ä¸€ä¸ªå”¯ä¸€æ ‡è¯†æ‰“å¼€æ–‡ä»¶çš„æ•´æ•°ã€‚</p></li><li><p><code>callback</code>: ä¸€ä¸ªåœ¨æ“ä½œå®Œæˆæˆ–å‘ç”Ÿé”™è¯¯æ—¶è¢«è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚å¦‚æœæ“ä½œæˆåŠŸå®Œæˆï¼Œåˆ™ç¬¬ä¸€ä¸ªå‚æ•°ä¼šæ˜¯ <code>null</code> æˆ– <code>undefined</code>ï¼›å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œåˆ™ç¬¬ä¸€ä¸ªå‚æ•°ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ã€‚</p></li></ul></li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-10" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-10"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨æ„å»ºä¸€ä¸ªè´¢åŠ¡è½¯ä»¶ï¼Œè¯¥è½¯ä»¶å¤„ç†æ•æ„Ÿçš„äº¤æ˜“è®°å½•ã€‚æ¯ç¬”äº¤æ˜“éƒ½éœ€è¦è¢«è®°å½•åˆ°ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­ï¼Œè€Œä¸”ä½ éœ€è¦ç¡®ä¿è¿™äº›è®°å½•å³ä¾¿åœ¨å‘ç”Ÿçªç„¶æ–­ç”µçš„æƒ…å†µä¸‹ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚</p><h4 id="æ­¥éª¤-1-æ‰“å¼€æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-1-æ‰“å¼€æ–‡ä»¶"><span>æ­¥éª¤ 1: æ‰“å¼€æ–‡ä»¶</span></a></h4><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>fs.open</code> æ–¹æ³•æ‰“å¼€æˆ–åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶è·å–å®ƒçš„æ–‡ä»¶æè¿°ç¬¦ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€ï¼ˆæˆ–åˆ›å»ºï¼‰ä¸€ä¸ªåä¸º &#39;transaction.log&#39; çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">transaction.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // åœ¨æ­¤å¤„ï¼Œfd æ˜¯æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ­¥éª¤-2-å†™å…¥æ•°æ®" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-2-å†™å…¥æ•°æ®"><span>æ­¥éª¤ 2: å†™å…¥æ•°æ®</span></a></h4><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†äº¤æ˜“ä¿¡æ¯å†™å…¥æ–‡ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">ä¸€ç¬”äº¤æ˜“è®°å½•</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // æ•°æ®å·²å†™å…¥</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ­¥éª¤-3-ä½¿ç”¨-fs-fdatasync" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-3-ä½¿ç”¨-fs-fdatasync"><span>æ­¥éª¤ 3: ä½¿ç”¨ <code>fs.fdatasync</code></span></a></h4><p>æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>fs.fdatasync</code> ç¡®ä¿åˆšæ‰å†™å…¥çš„æ•°æ®å·²ç»åŒæ­¥åˆ°ç£ç›˜ä¸Šï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">fdatasync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">äº¤æ˜“è®°å½•å·²ç»åŒæ­¥åˆ°ç£ç›˜</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ­¥éª¤-4-å…³é—­æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-4-å…³é—­æ–‡ä»¶"><span>æ­¥éª¤ 4: å…³é—­æ–‡ä»¶</span></a></h4><p>æ“ä½œå®Œæˆåï¼Œä¸è¦å¿˜è®°å…³é—­æ–‡ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šå°±æ˜¯ä½¿ç”¨ <code>fs.fdatasync(fd, callback)</code> å‡½æ•°ç¡®ä¿æ•°æ®æ­£ç¡®åŒæ­¥åˆ°ç£ç›˜çš„ä¸€ä¸ªç®€å•ç¤ºä¾‹ã€‚è¿™æ ·çš„æ“ä½œå¯¹äºéœ€è¦ç»´æŠ¤æ•°æ®ä¸€è‡´æ€§å’Œå®Œæ•´æ€§çš„åº”ç”¨ç¨‹åºæ¥è¯´æ˜¯éå¸¸é‡è¦çš„ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†é‡è¦çš„è´¢åŠ¡æ•°æ®ã€ç”¨æˆ·æ•°æ®æˆ–å…¶ä»–æ•æ„Ÿä¿¡æ¯æ—¶ã€‚</p><h3 id="fs-fstat-fd-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-fstat-fd-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsfstatfd-options-callback" target="_blank" rel="noopener noreferrer">fs.fstat(fd[, options], callback)</a></span></a></h3><p>å½“æˆ‘ä»¬è°ˆè®º Node.js ä¸­çš„<code>fs.fstat()</code>å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨è®¨è®ºæ–‡ä»¶ç³»ç»Ÿï¼ˆFileSystemï¼‰æ¨¡å—ä¸‹çš„ä¸€ä¸ªåŠŸèƒ½ã€‚<code>fs</code>æ¨¡å—æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨å®ƒæ¥åˆ›å»ºã€è¯»å–ã€ä¿®æ”¹ã€åˆ é™¤æ–‡ä»¶ç­‰ã€‚</p><p>ç‰¹åˆ«åœ°ï¼Œ<code>fs.fstat()</code>å‡½æ•°ç”¨äºè·å–æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯ã€‚è¿™ä¸ä»…åŒ…æ‹¬åŸºæœ¬ä¿¡æ¯å¦‚æ–‡ä»¶å¤§å°ã€åˆ›å»ºæ—¶é—´ç­‰ï¼Œè¿˜åŒ…å«äº†æ¯”è¾ƒåº•å±‚çš„æ•°æ®ï¼Œä¾‹å¦‚æ–‡ä»¶æƒé™ã€‚</p><h3 id="å‡½æ•°ç­¾å" tabindex="-1"><a class="header-anchor" href="#å‡½æ•°ç­¾å"><span>å‡½æ•°ç­¾å</span></a></h3><p><code>fs.fstat(fd[, options], callback)</code></p><ul><li><code>fd</code>ï¼šè¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œç®€å•ç†è§£å°±æ˜¯ä¸€ä¸ªæŒ‡å‘æ‰“å¼€æ–‡ä»¶çš„å¼•ç”¨æˆ–è€…æ ‡è¯†ã€‚</li><li><code>options</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…è®¸ä½ å®šåˆ¶è¿”å›ä¿¡æ¯çš„å½¢å¼ï¼Œæ¯”å¦‚ä½ å¯ä»¥æŒ‡å®šè·å–çš„æ–‡ä»¶ä¿¡æ¯æ˜¯ä»¥å¤§å¯¹è±¡å½¢å¼è¿˜æ˜¯å°æ•´æ•°å½¢å¼ã€‚</li><li><code>callback</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨<code>fs.fstat()</code>æ“ä½œå®Œæˆåè¢«è°ƒç”¨ã€‚æ­¤å‡½æ•°åº”æœ‰ä¸¤ä¸ªå‚æ•°ï¼šé”™è¯¯ï¼ˆå¦‚æœæœ‰ï¼‰å’Œæ–‡ä»¶çŠ¶æ€å¯¹è±¡ã€‚</li></ul><h3 id="æ–‡ä»¶çŠ¶æ€å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶çŠ¶æ€å¯¹è±¡"><span>æ–‡ä»¶çŠ¶æ€å¯¹è±¡</span></a></h3><p>å½“è°ƒç”¨æˆåŠŸæ—¶ï¼Œæ–‡ä»¶çŠ¶æ€å¯¹è±¡ä¼šè¢«è¿”å›ï¼Œå…¶ä¸­åŒ…å«äº†å¾ˆå¤šå±æ€§ï¼Œæ¯”å¦‚ï¼š</p><ul><li><code>size</code>ï¼šæ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰</li><li><code>mtime</code>ï¼šæ–‡ä»¶æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´</li><li><code>ctime</code>ï¼šæ–‡ä»¶çŠ¶æ€æ”¹å˜æ—¶é—´ï¼ˆæ¯”å¦‚æƒé™æˆ–æ‰€æœ‰æƒæ”¹å˜ï¼‰</li><li>ç­‰ç­‰ã€‚</li></ul><h3 id="ä½¿ç”¨ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹-2"><span>ä½¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æƒ³è·å–æŸä¸ªæ–‡ä»¶çš„å¤§å°å’Œæœ€åä¿®æ”¹æ—¶é—´ï¼Œé¦–å…ˆä½ éœ€è¦æ‰“å¼€é‚£ä¸ªæ–‡ä»¶ä»¥è·å–æ–‡ä»¶æè¿°ç¬¦ï¼ˆfdï¼‰ã€‚ç„¶åä½ å¯ä»¥ä½¿ç”¨<code>fs.fstat()</code>æ¥è·å–æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å¼•å…¥fsæ¨¡å—</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/your/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // è·å–æ–‡ä»¶çŠ¶æ€</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">fstat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      return;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">File Size: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">size</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Last Modified: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mtime</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // åœ¨æ“ä½œå®Œæˆåï¼Œä¸è¦å¿˜è®°å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨<code>fs.open()</code>æ–¹æ³•æ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶è·å–åˆ°äº†æ–‡ä»¶çš„æè¿°ç¬¦<code>fd</code>ã€‚éšåï¼Œæˆ‘ä»¬å°†<code>fd</code>ä¼ ç»™<code>fs.fstat()</code>å‡½æ•°æ¥è·å–æ–‡ä»¶çš„çŠ¶æ€ã€‚ä¹‹åï¼Œæˆ‘ä»¬è¾“å‡ºäº†æ–‡ä»¶çš„å¤§å°å’Œæœ€åä¿®æ”¹æ—¶é—´ï¼Œå¹¶æœ€ç»ˆå…³é—­äº†æ–‡ä»¶ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œ<code>fs.fstat()</code>æˆä¸ºäº†ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå…è®¸ä½ åœ¨ Node.js ä¸­å¯¹æ–‡ä»¶æ‰§è¡Œæ›´æ·±å…¥çš„æŸ¥è¯¢å’Œæ“ä½œã€‚</p><h3 id="fs-fsync-fd-callback" tabindex="-1"><a class="header-anchor" href="#fs-fsync-fd-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsfsyncfd-callback" target="_blank" rel="noopener noreferrer">fs.fsync(fd, callback)</a></span></a></h3><p>ç†è§£ <code>fs.fsync(fd, callback)</code> æ–¹æ³•ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆåˆ†å‡ ä¸ªæ­¥éª¤æ¥è§£é‡Šç›¸å…³çš„æ¦‚å¿µã€‚</p><h3 id="åŸºç¡€æ¦‚å¿µ-1" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æ¦‚å¿µ-1"><span>åŸºç¡€æ¦‚å¿µ</span></a></h3><ol><li><p><strong>æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰</strong>ï¼šè¿™æ˜¯è®¡ç®—æœºç”¨æ¥å­˜å‚¨ã€è·å–å’Œç®¡ç†æ•°æ®æ–‡ä»¶çš„ä¸€ç§ç³»ç»Ÿã€‚ç®€å•åœ°è¯´ï¼Œå°±æ˜¯ç®¡ç†ä½ ç”µè„‘é‡Œæ‰€æœ‰æ•°æ®çš„æ–¹å¼ï¼Œæ¯”å¦‚æ–‡æ¡£ã€å›¾ç‰‡ç­‰ã€‚</p></li><li><p><strong>Node.js</strong>ï¼šå®ƒæ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚Node.js å…è®¸ä½ ä½¿ç”¨ JavaScript ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨ JavaScript æ„å»ºæ•´ä¸ªç½‘ç«™æˆ–åç«¯æœåŠ¡ã€‚</p></li><li><p><strong>å¼‚æ­¥ç¼–ç¨‹</strong>ï¼šåœ¨ Node.js ä¸­ï¼Œç»å¤§å¤šæ•°æ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå½“è¯»å†™æ–‡ä»¶æ—¶ï¼Œä½ å‘èµ·è¯·æ±‚åä¸éœ€è¦ç­‰å¾…æ–‡ä»¶å®Œå…¨è¯»å†™å®Œæ¯•ï¼Œä½ çš„ç¨‹åºå¯ä»¥ç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œè€Œè¯»å†™æ–‡ä»¶çš„æ“ä½œåœ¨èƒŒåå®Œæˆã€‚</p></li></ol><h3 id="fs-fsync" tabindex="-1"><a class="header-anchor" href="#fs-fsync"><span>fs.fsync()</span></a></h3><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ·±å…¥äº†è§£ <code>fs.fsync()</code> æ–¹æ³•ã€‚</p><ul><li><p><strong>åŠŸèƒ½</strong>ï¼š<code>fs.fsync()</code> æ–¹æ³•ä¸»è¦ç”¨äºå°†å†…å­˜ä¸­çš„æ–‡ä»¶æ•°æ®åŒæ­¥åˆ°ç£ç›˜ã€‚ç®€å•æ¥è¯´ï¼Œå½“ä½ å¯¹æ–‡ä»¶è¿›è¡Œä¿®æ”¹æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¯èƒ½ä¼šå‡ºäºæ€§èƒ½è€ƒè™‘ï¼Œå…ˆå°†è¿™äº›ä¿®æ”¹æš‚å­˜åˆ°å†…å­˜ä¸­ï¼Œè€Œä¸æ˜¯ç›´æ¥å†™å…¥ç¡¬ç›˜ã€‚ä½¿ç”¨ <code>fs.fsync()</code> å¯ä»¥ç¡®ä¿è¿™äº›æš‚å­˜åœ¨å†…å­˜ä¸­çš„æ•°æ®è¢«å®‰å…¨åœ°å†™å…¥ç¡¬ç›˜ã€‚</p></li><li><p><strong>å‚æ•°</strong>ï¼š</p><ul><li><code>fd</code>ï¼šæ–‡ä»¶æè¿°ç¬¦ï¼Œæ˜¯ä¸€ä¸ªå”¯ä¸€æ ‡è¯†æ‰“å¼€æ–‡ä»¶çš„æ•´æ•°ã€‚</li><li><code>callback</code>ï¼šå›è°ƒå‡½æ•°ï¼Œåœ¨åŒæ­¥æ“ä½œå®Œæˆåè°ƒç”¨ã€‚è¿™ä¸ªå‡½æ•°æœ‰ä¸€ä¸ªå‚æ•° <code>err</code>ï¼Œç”¨æ¥æŒ‡ç¤ºæ˜¯å¦æœ‰é”™è¯¯å‘ç”Ÿã€‚</li></ul></li></ul><h3 id="å®é™…åº”ç”¨ä¸¾ä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¸¾ä¾‹"><span>å®é™…åº”ç”¨ä¸¾ä¾‹</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªæ—¥è®°åº”ç”¨ï¼Œæ¯å½“ç”¨æˆ·è¾“å…¥ä¸€æ¡æ—¥è®°å¹¶ä¿å­˜æ—¶ï¼Œä½ éœ€è¦ç¡®ä¿è¿™æ¡æ—¥è®°å³ä½¿åœ¨å‘ç”Ÿçªç„¶æ–­ç”µç­‰æ„å¤–æƒ…å†µä¸‹ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚</p><p>ä»¥ä¸‹æ˜¯ä½¿ç”¨ <code>fs.fsync()</code> çš„ç®€åŒ–ä»£ç ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶å‡†å¤‡å†™å…¥</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/your/diary.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å‡è®¾å·²ç»é€šè¿‡æŸç§æ–¹å¼å†™å…¥äº†æ•°æ®</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ç¡®ä¿æ•°æ®ä»å†…å­˜åŒæ­¥åˆ°ç¡¬ç›˜</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">fsync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Data has been synced to disk.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å®Œæˆæ“ä½œåå…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ol><li>ä½¿ç”¨ <code>fs.open()</code> æ–¹æ³•æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶è·å–æ–‡ä»¶æè¿°ç¬¦ <code>fd</code>ã€‚</li><li>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½ä¼šåœ¨æ‰“å¼€æ–‡ä»¶åè¿›è¡Œä¸€ç³»åˆ—çš„è¯»å†™æ“ä½œã€‚</li><li>ä½¿ç”¨ <code>fs.fsync(fd, callback)</code> æ¥ç¡®ä¿æ‰€æœ‰æš‚å­˜äºå†…å­˜ä¸­çš„æ•°æ®éƒ½è¢«åŒæ­¥åˆ°ç£ç›˜ã€‚</li><li>æœ€åï¼Œä½¿ç”¨ <code>fs.close()</code> å…³é—­æ–‡ä»¶é‡Šæ”¾èµ„æºã€‚</li></ol><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥å¢å¼ºåº”ç”¨çš„æ•°æ®æŒä¹…æ€§å’Œç¨³å®šæ€§ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†é‡è¦æ•°æ®æ—¶ã€‚</p><p>å¸Œæœ›ä»¥ä¸Šè§£é‡Šå¯¹ä½ æœ‰å¸®åŠ©ï¼Œç¥ç¼–ç¨‹æ„‰å¿«ï¼</p><h3 id="fs-ftruncate-fd-len-callback" tabindex="-1"><a class="header-anchor" href="#fs-ftruncate-fd-len-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsftruncatefd-len-callback" target="_blank" rel="noopener noreferrer">fs.ftruncate(fd[, len], callback)</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥èŠèŠ Node.js ä¸­çš„ <code>fs.ftruncate(fd[, len], callback)</code> æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿï¼ˆç®€ç§° fsï¼‰æ¨¡å—æä¾›çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œç”¨äºæˆªæ–­æ–‡ä»¶ï¼Œå³æ”¹å˜æ–‡ä»¶çš„å¤§å°ã€‚</p><h3 id="æ¦‚å¿µè§£é‡Š-1" tabindex="-1"><a class="header-anchor" href="#æ¦‚å¿µè§£é‡Š-1"><span>æ¦‚å¿µè§£é‡Š</span></a></h3><ul><li><strong>fs (æ–‡ä»¶ç³»ç»Ÿ)</strong>: åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æä¾›äº†ä¸€ç³»åˆ—å¯¹æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œæ“ä½œçš„æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•å…è®¸ä½ åœ¨æœåŠ¡å™¨ä¸Šè¯»å–ã€å†™å…¥ã€åˆ é™¤æ–‡ä»¶ç­‰ã€‚</li><li><strong>ftruncate</strong>: <code>ftruncate</code> æ˜¯ truncateï¼ˆæˆªæ–­ï¼‰çš„ä¸€ä¸ªå½¢å¼ï¼Œå®ƒå…è®¸ä½ å°†ä¸€ä¸ªå·²æ‰“å¼€çš„æ–‡ä»¶ç¼©å‡æˆ–æ‰©å±•åˆ°æŒ‡å®šçš„å¤§å°ã€‚å¦‚æœæ–‡ä»¶è¢«æ‰©å±•ï¼Œæ–°å¢çš„éƒ¨åˆ†ä¼šä»¥ç©ºå­—èŠ‚å¡«å……ã€‚</li><li><strong>fd (file descriptor æ–‡ä»¶æè¿°ç¬¦)</strong>: å½“ä½ åœ¨ Node.js ä¸­æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œç³»ç»Ÿä¼šç»™è¿™ä¸ªæ–‡ä»¶åˆ†é…ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç§°ä¸ºâ€œæ–‡ä»¶æè¿°ç¬¦â€ã€‚ä½ å¯ä»¥é€šè¿‡è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦æ¥è¿›è¡Œåç»­çš„è¯»å†™ç­‰æ“ä½œã€‚</li><li><strong>len</strong>: è¿™æ˜¯ä½ å¸Œæœ›æ–‡ä»¶è¾¾åˆ°çš„æ–°çš„å¤§å°ï¼Œå•ä½æ˜¯å­—èŠ‚ã€‚å¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤ä¸º 0ã€‚</li><li><strong>callback</strong>: ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“ <code>ftruncate</code> æ“ä½œå®Œæˆåï¼Œè¿™ä¸ªå‡½æ•°å°†è¢«è°ƒç”¨ã€‚å®ƒé€šå¸¸æœ‰ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªé”™è¯¯å¯¹è±¡ï¼ˆå¦‚æœæ“ä½œæˆåŠŸï¼Œåˆ™ä¸º <code>null</code>ï¼‰å’Œä¸€ä¸ªç»“æœå€¼ã€‚</li></ul><h3 id="ä½¿ç”¨åœºæ™¯å’Œä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯å’Œä¾‹å­"><span>ä½¿ç”¨åœºæ™¯å’Œä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå…¶ä¸­åŒ…æ‹¬ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶è®°å½•ç”¨æˆ·çš„æ´»åŠ¨ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œè¿™ä¸ªæ—¥å¿—æ–‡ä»¶å¯èƒ½ä¼šå˜å¾—éå¸¸å¤§ï¼Œå½±å“åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚ä½ å¯èƒ½æƒ³è¦å®šæœŸæˆªæ–­è¿™ä¸ªæ–‡ä»¶ï¼Œåªä¿ç•™æœ€è¿‘çš„æ—¥å¿—è®°å½•ï¼Œç§»é™¤æ—§çš„å†…å®¹ã€‚è¿™å°±æ˜¯ <code>fs.ftruncate</code> å¯ä»¥æ´¾ä¸Šç”¨åœºçš„åœ°æ–¹ã€‚</p><h4 id="å®é™…ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-4"><span>å®é™…ä¾‹å­</span></a></h4><p>é¦–å…ˆï¼Œä½ éœ€è¦æ‰“å¼€æ–‡ä»¶ä»¥è·å–æ–‡ä»¶æè¿°ç¬¦ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">    throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // æˆªæ–­æ–‡ä»¶åˆ° 100 å­—èŠ‚</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">ftruncate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 100</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">      throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶æˆªæ–­æˆåŠŸ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">        throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å…³é—­æˆåŠŸ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ol><li>æˆ‘ä»¬ä½¿ç”¨ <code>fs.open</code> æ–¹æ³•ä»¥è¯»å†™æ¨¡å¼ (<code>&#39;r+&#39;</code>) æ‰“å¼€åä¸º <code>&#39;example.log&#39;</code> çš„æ–‡ä»¶ï¼Œå¹¶è·å¾—è¯¥æ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ <code>fd</code>ã€‚</li><li>ç„¶åï¼Œæˆ‘ä»¬è°ƒç”¨ <code>fs.ftruncate</code> å°†æ–‡ä»¶æˆªæ–­ä¸º 100 å­—èŠ‚ã€‚å¦‚æœåŸæ–‡ä»¶å¤§äº 100 å­—èŠ‚ï¼Œè¶…å‡ºçš„éƒ¨åˆ†å°†è¢«ç§»é™¤ï¼›å¦‚æœåŸæ–‡ä»¶å°äº 100 å­—èŠ‚ï¼Œåˆ™å°†ä»¥ç©ºå­—èŠ‚ï¼ˆ<code>\0</code>ï¼‰å¡«å……è‡³ 100 å­—èŠ‚ã€‚</li><li>åœ¨æ–‡ä»¶æˆªæ–­æ“ä½œå®Œæˆåï¼Œæˆ‘ä»¬é€šè¿‡å›è°ƒå‡½æ•°æ¥æ”¶æ“ä½œç»“æœã€‚å¦‚æœæ²¡æœ‰é”™è¯¯å‘ç”Ÿï¼Œæˆ‘ä»¬è¾“å‡º <code>&quot;æ–‡ä»¶æˆªæ–­æˆåŠŸ&quot;</code>ã€‚</li><li>æœ€åï¼Œä¸è¦å¿˜è®°ä½¿ç”¨ <code>fs.close</code> æ¥å…³é—­æ–‡ä»¶ï¼Œé‡Šæ”¾èµ„æºã€‚</li></ol><p>è¿™å°±æ˜¯ <code>fs.ftruncate</code> åœ¨å®è·µä¸­å¦‚ä½•ä½¿ç”¨çš„ä¸€ä¸ªç®€å•ç¤ºä¾‹ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥æœ‰æ•ˆç®¡ç†æ–‡ä»¶çš„å¤§å°ï¼Œé¿å…ç”±äºæ–‡ä»¶è¿‡å¤§è€Œå¯¼è‡´çš„æ€§èƒ½é—®é¢˜ã€‚</p><h3 id="fs-futimes-fd-atime-mtime-callback" tabindex="-1"><a class="header-anchor" href="#fs-futimes-fd-atime-mtime-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsfutimesfd-atime-mtime-callback" target="_blank" rel="noopener noreferrer">fs.futimes(fd, atime, mtime, callback)</a></span></a></h3><p><code>fs.futimes(fd, atime, mtime, callback)</code> æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>ï¼‰æ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºæ›´æ”¹æ–‡ä»¶çš„è®¿é—®æ—¶é—´ï¼ˆ<code>atime</code>ï¼‰å’Œä¿®æ”¹æ—¶é—´ï¼ˆ<code>mtime</code>ï¼‰ã€‚è¿™ä¸ªå‡½æ•°æ˜¯å¼‚æ­¥çš„ï¼Œæ„å‘³ç€å®ƒä¼šåœ¨åå°æ‰§è¡Œæ“ä½œï¼Œä¸ä¼šé˜»å¡ç¨‹åºå…¶ä»–éƒ¨åˆ†çš„æ‰§è¡Œã€‚</p><p>è¿™é‡Œæœ‰ä¸€äº›åŸºæœ¬æ¦‚å¿µéœ€è¦ç†è§£ï¼š</p><ol><li><p><strong>æ–‡ä»¶æè¿°ç¬¦ï¼ˆfdï¼‰</strong>ï¼šå½“ä½ åœ¨ Node.js ä¸­æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œç³»ç»Ÿä¼šä¸ºè¯¥æ–‡ä»¶åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œç§°ä¸ºæ–‡ä»¶æè¿°ç¬¦ã€‚å®ƒæ˜¯ä¸€ä¸ªæ•°å­—å€¼ï¼Œç”¨äºåœ¨åç»­æ“ä½œä¸­å¼•ç”¨è¯¥æ–‡ä»¶ã€‚</p></li><li><p><strong>è®¿é—®æ—¶é—´ï¼ˆ<code>atime</code>ï¼‰</strong>ï¼šæŒ‡çš„æ˜¯æ–‡ä»¶æœ€åè¢«è®¿é—®çš„æ—¶é—´ï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶å†…å®¹ã€‚</p></li><li><p><strong>ä¿®æ”¹æ—¶é—´ï¼ˆ<code>mtime</code>ï¼‰</strong>ï¼šæŒ‡çš„æ˜¯æ–‡ä»¶å†…å®¹æœ€åè¢«ä¿®æ”¹çš„æ—¶é—´ã€‚</p></li><li><p><strong>å›è°ƒå‡½æ•°ï¼ˆcallbackï¼‰</strong>ï¼šåœ¨å®Œæˆæ—¶é—´æ›´æ–°åè°ƒç”¨çš„å‡½æ•°ã€‚å¦‚æœè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œé”™è¯¯ä¿¡æ¯å°†ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥å›è°ƒå‡½æ•°ï¼›å¦‚æœæ“ä½œæˆåŠŸï¼Œç¬¬ä¸€ä¸ªå‚æ•°å°†ä¸º nullã€‚</p></li></ol><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼š</p><p>å‡è®¾ä½ å·²ç»æ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”ä½ æƒ³æ›´æ–°è¿™ä¸ªæ–‡ä»¶çš„è®¿é—®æ—¶é—´å’Œä¿®æ”¹æ—¶é—´ã€‚åœ¨ Node.js ä¸­ï¼Œä½ å¯èƒ½ä¼šè¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶è·å–æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // è·å–å½“å‰æ—¶é—´</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> now</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // æ›´æ”¹æ–‡ä»¶çš„è®¿é—®æ—¶é—´å’Œä¿®æ”¹æ—¶é—´ä¸ºå½“å‰æ—¶é—´</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">futimes</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> now</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> now</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶æ—¶é—´å·²æ›´æ–°ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç åšäº†ä»¥ä¸‹äº‹æƒ…ï¼š</p><ol><li><p>ä½¿ç”¨ <code>fs.open</code> æ‰“å¼€æ–‡ä»¶ <code>example.txt</code>ï¼Œå¦‚æœæ–‡ä»¶æ‰“å¼€æˆåŠŸï¼Œå®ƒä¼šæä¾›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ <code>fd</code>ã€‚</p></li><li><p>åˆ›å»ºä¸€ä¸ªè¡¨ç¤ºå½“å‰æ—¶é—´çš„ <code>Date</code> å¯¹è±¡ã€‚</p></li><li><p>è°ƒç”¨ <code>fs.futimes</code> æ–¹æ³•ï¼Œå°†æ–‡ä»¶çš„ <code>atime</code> å’Œ <code>mtime</code> éƒ½è®¾ç½®ä¸ºå½“å‰æ—¶é—´ã€‚</p></li><li><p>åœ¨æ›´æ–°å®Œæ—¶é—´åï¼Œé€šè¿‡å›è°ƒå‡½æ•°æ‰“å°å‡ºä¸€æ¡æ¶ˆæ¯â€œæ–‡ä»¶æ—¶é—´å·²æ›´æ–°ï¼â€ã€‚</p></li><li><p>æœ€åï¼Œä½¿ç”¨ <code>fs.close</code> å…³é—­æ‰“å¼€çš„æ–‡ä»¶ã€‚è¿™æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œå¯ä»¥é¿å…èµ„æºæ³„æ¼ã€‚</p></li></ol><p>è¯·æ³¨æ„ï¼Œå› ä¸ºæˆ‘ä»¬æ­£åœ¨æ“ä½œæ–‡ä»¶ç³»ç»Ÿï¼Œæ‰€ä»¥è¦å°å¿ƒå¤„ç†é”™è¯¯ã€‚æ¯æ¬¡è°ƒç”¨ <code>fs</code> æ¨¡å—çš„æ–¹æ³•æ—¶ï¼Œå¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œéƒ½åº”è¯¥æ£€æŸ¥é”™è¯¯å¯¹è±¡å¹¶é€‚å½“åœ°å¤„ç†å®ƒä»¬ã€‚åœ¨å®é™…ç”Ÿäº§ä»£ç ä¸­ï¼Œä½ å¯èƒ½è¿˜éœ€è¦è€ƒè™‘æ·»åŠ æ›´å¤šçš„é”™è¯¯å¤„ç†å’Œæ¸…ç†èµ„æºçš„é€»è¾‘ã€‚</p><h3 id="fs-lchmod-path-mode-callback" tabindex="-1"><a class="header-anchor" href="#fs-lchmod-path-mode-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fslchmodpath-mode-callback" target="_blank" rel="noopener noreferrer">fs.lchmod(path, mode, callback)</a></span></a></h3><p><code>fs.lchmod(path, mode, callback)</code> æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºæ›´æ”¹ä¸€ä¸ªæ–‡ä»¶çš„æƒé™æ¨¡å¼ã€‚è¿™ä¸ªå‡½æ•°æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œæ„å‘³ç€å®ƒä¸ä¼šç«‹åˆ»å®Œæˆæ“ä½œï¼Œè€Œæ˜¯åœ¨åå°å¤„ç†ï¼Œå¹¶åœ¨å®Œæˆæ—¶é€šè¿‡å›è°ƒå‡½æ•°è¿”å›ç»“æœã€‚</p><p>åœ¨è®²è§£ <code>fs.lchmod</code> ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p><ol><li><p><strong>æ–‡ä»¶æƒé™:</strong> åœ¨ Unix å’Œç±» Unix ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½æœ‰ç‰¹å®šçš„æƒé™ï¼Œå†³å®šäº†å“ªäº›ç”¨æˆ·å¯ä»¥è¯»å–ã€å†™å…¥æˆ–æ‰§è¡Œè¯¥æ–‡ä»¶ã€‚æƒé™é€šå¸¸ä»¥ä¸‰ç»„å­—ç¬¦è¡¨ç¤ºï¼Œä¾‹å¦‚ <code>rwxr-xr-x</code>ï¼Œåˆ†åˆ«ä»£è¡¨æ‰€æœ‰è€…ï¼ˆownerï¼‰ã€æ‰€å±ç»„ï¼ˆgroupï¼‰å’Œå…¶ä»–äººï¼ˆothersï¼‰çš„æƒé™ã€‚</p></li><li><p><strong>æƒé™æ¨¡å¼:</strong> æƒé™æ¨¡å¼æ˜¯ä¸€ä¸ªæ•°å€¼ï¼Œç”¨äºè®¾ç½®æ–‡ä»¶çš„æƒé™ã€‚å®ƒé€šå¸¸æ˜¯ 8 è¿›åˆ¶å½¢å¼ï¼Œä¾‹å¦‚ <code>0755</code>ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªæ•°å­—é€šå¸¸æ˜¯ 0ï¼Œåé¢ä¸‰ä¸ªæ•°å­—åˆ†åˆ«å¯¹åº”æ‰€æœ‰è€…ã€æ‰€å±ç»„å’Œå…¶ä»–äººçš„æƒé™ã€‚</p></li><li><p><strong>å›è°ƒå‡½æ•°:</strong> å›è°ƒå‡½æ•°æ˜¯ä¸€ä¸ªåœ¨å¼‚æ­¥æ“ä½œå®Œæˆæ—¶è¢«è°ƒç”¨çš„å‡½æ•°ã€‚å®ƒé€šå¸¸å…·æœ‰ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é”™è¯¯å¯¹è±¡ï¼ˆå¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼‰ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ“ä½œçš„ç»“æœã€‚</p></li></ol><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ <code>fs.lchmod</code> çš„å…·ä½“ä½¿ç”¨æ–¹æ³•å’Œå®ä¾‹ã€‚</p><h3 id="fs-lchmod-path-mode-callback-1" tabindex="-1"><a class="header-anchor" href="#fs-lchmod-path-mode-callback-1"><span>fs.lchmod(path, mode, callback)</span></a></h3><ul><li><code>path</code>: è¦æ›´æ”¹æƒé™çš„æ–‡ä»¶è·¯å¾„ã€‚</li><li><code>mode</code>: æ–°çš„æƒé™æ¨¡å¼ã€‚</li><li><code>callback</code>: å®Œæˆæƒé™æ›´æ”¹åå°†è¢«è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚</li></ul><p><strong>æ³¨æ„:</strong> <code>fs.lchmod</code> ä»…åœ¨ macOS å¹³å°ä¸Šæœ‰æ•ˆï¼Œå¹¶ä¸”ä»…é’ˆå¯¹ç¬¦å·é“¾æ¥æœ¬èº«ï¼Œè€Œä¸æ˜¯å®ƒä»¬æŒ‡å‘çš„ç›®æ ‡æ–‡ä»¶ã€‚åœ¨å…¶ä»–å¹³å°ä¸Šï¼Œå°è¯•ä½¿ç”¨ <code>fs.lchmod</code> å°†å¯¼è‡´å›è°ƒä¸­ä¼ å…¥ <code>ENOSYS</code> é”™è¯¯ï¼Œè¡¨ç¤ºç³»ç»Ÿä¸æ”¯æŒæ­¤æ“ä½œã€‚</p><h3 id="å®ä¾‹-2" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-2"><span>å®ä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡ä»¶ï¼Œå¹¶ä¸”æˆ‘ä»¬å¸Œæœ›æ›´æ”¹å…¶æƒé™ï¼Œä½¿å¾—æ‰€æœ‰è€…æ‹¥æœ‰è¯»å†™æƒé™ (<code>rw-</code>)ï¼Œå…¶ä»–äººæ²¡æœ‰ä»»ä½•æƒé™ (<code>---</code>)ã€‚</p><p>æˆ‘ä»¬æƒ³è¦è®¾ç½®çš„æƒé™æ¨¡å¼ä¸º <code>0600</code>ï¼Œå…¶ä¸­ï¼š</p><ul><li>ç¬¬ä¸€ä¸ª 6 è¡¨ç¤ºæ‰€æœ‰è€…æƒé™ä¸º <code>rw-</code>ã€‚ï¼ˆ4 + 2 = 6ï¼Œå…¶ä¸­ 4 è¡¨ç¤ºå¯è¯»ï¼Œ2 è¡¨ç¤ºå¯å†™ï¼‰</li><li>åé¢ä¸¤ä¸ª 0 è¡¨ç¤ºå…¶ä»–ç”¨æˆ·å’Œç»„æ— æƒé™ã€‚</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä¿®æ”¹æƒé™ä¸º rw-------</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">lchmod</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0o600</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">    return</span><span style="color:#D8DEE9;"> console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Permissions changed successfully!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥ <code>fs</code> æ¨¡å—ã€‚ç„¶åå®šä¹‰äº†æ–‡ä»¶è·¯å¾„ <code>filePath</code> å¹¶è°ƒç”¨ <code>fs.lchmod</code>ï¼Œè®¾ç½®æƒé™æ¨¡å¼ä¸º <code>0o600</code>ï¼ˆè¿™æ˜¯ 0600 çš„ 8 è¿›åˆ¶è¡¨ç¤ºï¼‰ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œå›è°ƒå‡½æ•°ä¼šæ‰“å° &quot;Permissions changed successfully!&quot;ï¼›å¦‚æœå‡ºé”™ï¼ˆæ¯”å¦‚åœ¨ä¸æ”¯æŒ lchmod çš„ç³»ç»Ÿä¸Šè¿è¡Œï¼‰ï¼Œå®ƒä¼šæ‰“å°é”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="fs-lchown-path-uid-gid-callback" tabindex="-1"><a class="header-anchor" href="#fs-lchown-path-uid-gid-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fslchownpath-uid-gid-callback" target="_blank" rel="noopener noreferrer">fs.lchown(path, uid, gid, callback)</a></span></a></h3><p>ç†è§£ <code>fs.lchown(path, uid, gid, callback)</code> éœ€è¦é¦–å…ˆçŸ¥é“ä¸€äº›åŸºç¡€æ¦‚å¿µã€‚åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶å’Œç›®å½•éƒ½æœ‰ä¸ä¹‹å…³è”çš„æƒé™å’Œæ‰€æœ‰è€…ä¿¡æ¯ã€‚è¿™é‡Œçš„ <code>uid</code>ï¼ˆUser IDï¼‰ä»£è¡¨ç”¨æˆ·æ ‡è¯†ç¬¦ï¼Œè€Œ <code>gid</code>ï¼ˆGroup IDï¼‰ä»£è¡¨ç»„æ ‡è¯†ç¬¦ã€‚ç®€å•æ¥è¯´ï¼Œè¿™äº› ID ç”¨äºç¡®å®šè°å¯ä»¥è®¿é—®æ–‡ä»¶ã€‚</p><p><code>fs.lchown</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæ›´æ”¹æ–‡ä»¶ç³»ç»Ÿä¸­ç¬¦å·é“¾æ¥æœ¬èº«çš„æ‰€æœ‰è€…ï¼Œè€Œä¸æ˜¯å®ƒæ‰€æŒ‡å‘çš„æ–‡ä»¶çš„æ‰€æœ‰è€…ã€‚ç¬¦å·é“¾æ¥å°±åƒæ˜¯å¯¹å¦ä¸€ä¸ªæ–‡ä»¶çš„å¼•ç”¨æˆ–å¿«æ·æ–¹å¼ã€‚è¿™ä¸ªå‡½æ•°æ˜¯å¼‚æ­¥çš„ï¼Œè¿™æ„å‘³ç€ Node.js ä¸ä¼šåœä¸‹æ¥ç­‰å¾…è¿™ä¸ªå‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œè€Œæ˜¯ç»§ç»­è¿è¡Œå…¶ä»–ä»£ç ï¼Œå½“ <code>fs.lchown</code> å®Œæˆæ—¶ï¼Œå®ƒä¼šè°ƒç”¨ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚</p><p>å‡½æ•°å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>path</code>ï¼šç¬¦å·é“¾æ¥çš„è·¯å¾„ã€‚</li><li><code>uid</code>ï¼šç”¨æˆ· IDï¼Œä½ æƒ³å°†è¯¥ç¬¦å·é“¾æ¥çš„æ‰€æœ‰è€…æ›´æ”¹ä¸ºæ­¤ç”¨æˆ·ã€‚</li><li><code>gid</code>ï¼šç»„ IDï¼Œä½ æƒ³å°†è¯¥ç¬¦å·é“¾æ¥çš„ç»„æ‰€æœ‰è€…æ›´æ”¹ä¸ºæ­¤ç»„ã€‚</li><li><code>callback</code>ï¼šå›è°ƒå‡½æ•°ï¼Œåœ¨ <code>fs.lchown</code> å®Œæˆæ—¶è¢«è°ƒç”¨ã€‚å¦‚æœå‡ºç°é”™è¯¯ï¼Œé”™è¯¯ä¿¡æ¯ä¼šä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ ç»™å›è°ƒã€‚</li></ul><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-5" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-5"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç¬¦å·é“¾æ¥ <code>link-to-file</code>ï¼Œæˆ‘ä»¬æƒ³æŠŠè¿™ä¸ªé“¾æ¥çš„æ‰€æœ‰æƒæ›´æ”¹ä¸ºç”¨æˆ· ID 1000 å’Œ ç»„ ID 1000ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./link-to-file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›®æ ‡ç”¨æˆ·IDå’Œç»„ID</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> uid</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 1000</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> gid</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 1000</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ›´æ”¹ç¬¦å·é“¾æ¥çš„æ‰€æœ‰è€…</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">lchown</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> uid</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> gid</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ›´æ”¹æ‰€æœ‰è€…å¤±è´¥</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ‰€æœ‰è€…æ›´æ”¹æˆåŠŸ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† <code>fs</code> æ¨¡å—ï¼Œç„¶åå®šä¹‰äº†å…³äºç¬¦å·é“¾æ¥çš„è·¯å¾„ã€ç”¨æˆ· ID å’Œç»„ IDã€‚æœ€åï¼Œæˆ‘ä»¬è°ƒç”¨ <code>fs.lchown</code> å¹¶ä¼ é€’äº†å¿…è¦çš„å‚æ•°ä»¥åŠä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚å¦‚æœè¿‡ç¨‹ä¸­æœ‰é”™è¯¯å‘ç”Ÿï¼ˆä¾‹å¦‚æŒ‡å®šçš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæˆ–è€…è¿è¡Œè¿™æ®µä»£ç çš„ç”¨æˆ·æ²¡æœ‰è¶³å¤Ÿçš„æƒé™æ¥æ›´æ”¹æ‰€æœ‰è€…ï¼‰ï¼Œé”™è¯¯ä¿¡æ¯ä¼šè¢«æ‰“å°åˆ°æ§åˆ¶å°ï¼›å¦‚æœä¿®æ”¹æˆåŠŸï¼Œä¼šåœ¨æ§åˆ¶å°æ˜¾ç¤ºâ€œæ‰€æœ‰è€…æ›´æ”¹æˆåŠŸâ€ã€‚</p><p>è¯·æ³¨æ„ï¼Œè¿™ä¸ªå‡½æ•°åœ¨æ—¥å¸¸å¼€å‘ä¸­çš„ç”¨é€”å¯èƒ½ä¸æ˜¯éå¸¸å¹¿æ³›ï¼Œå› ä¸ºç›´æ¥æ“ä½œæ–‡ä»¶æ‰€æœ‰æƒå±äºè¾ƒä¸ºåº•å±‚çš„æ“ä½œï¼Œä¸”é€šå¸¸éœ€è¦ç›¸åº”çš„æƒé™ã€‚ä½†åœ¨å¤„ç†ç‰¹å®šçš„ç³»ç»Ÿçº§ä»»åŠ¡æ—¶ï¼Œæ¯”å¦‚ç»´æŠ¤æˆ–æ›´æ–°æ–‡ä»¶çš„æƒé™å’Œæ‰€æœ‰æƒï¼Œè¿™ä¸ªåŠŸèƒ½å°±æ˜¾å¾—éå¸¸æœ‰ç”¨äº†ã€‚</p><h3 id="fs-lutimes-path-atime-mtime-callback" tabindex="-1"><a class="header-anchor" href="#fs-lutimes-path-atime-mtime-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fslutimespath-atime-mtime-callback" target="_blank" rel="noopener noreferrer">fs.lutimes(path, atime, mtime, callback)</a></span></a></h3><p>ç†è§£ <code>fs.lutimes(path, atime, mtime, callback)</code> è¿™ä¸ªå‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p><ol><li><strong>Node.js</strong>: æ˜¯ä¸€ä¸ªèƒ½è®© JavaScript è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¹³å°ã€‚å®ƒå…è®¸ä½ ä½¿ç”¨ JavaScript æ¥å†™åç«¯ä»£ç ï¼Œå³å¤„ç†æœåŠ¡å™¨é€»è¾‘ã€‚</li><li><strong>fs æ¨¡å—</strong>: åœ¨ Node.js ä¸­, <code>fs</code> æŒ‡çš„æ˜¯æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ã€‚è¿™ä¸ªæ¨¡å—æä¾›äº†å¾ˆå¤šå‡½æ•°ï¼Œç”¨äºå¯¹ç³»ç»Ÿæ–‡ä»¶åŠç›®å½•è¿›è¡Œæ“ä½œï¼Œæ¯”å¦‚è¯»å†™æ–‡ä»¶ã€åˆ›å»ºåˆ é™¤ç›®å½•ç­‰ã€‚</li><li><strong>lutimes å‡½æ•°</strong>ï¼šå±äº<code>fs</code>æ¨¡å—ï¼Œç”¨äºä¿®æ”¹æ–‡ä»¶æˆ–é“¾æ¥çš„è®¿é—®ï¼ˆatimeï¼‰å’Œä¿®æ”¹ï¼ˆmtimeï¼‰æ—¶é—´æˆ³ï¼Œä½†å®ƒä¸ä¼šè§£å¼•ç”¨ç¬¦å·é“¾æ¥ã€‚</li></ol><p>å¥½ï¼Œç°åœ¨æˆ‘ä»¬æ¥è¯¦ç»†è§£é‡Šä¸‹ <code>fs.lutimes(path, atime, mtime, callback)</code>:</p><ul><li><strong>path</strong>ï¼šè·¯å¾„å‚æ•°ï¼ŒæŒ‡å®šè¦ä¿®æ”¹æ—¶é—´æˆ³çš„æ–‡ä»¶æˆ–ç¬¦å·é“¾æ¥çš„è·¯å¾„ã€‚</li><li><strong>atime</strong>ï¼šè®¿é—®æ—¶é—´ï¼ˆAccess Timeï¼‰ï¼Œè¡¨ç¤ºæœ€åä¸€æ¬¡è®¿é—®æ–‡ä»¶çš„æ—¶é—´ã€‚åœ¨è¿™é‡Œï¼Œå®ƒæ˜¯ä¸€ä¸ªæ—¶é—´æˆ³æˆ–è€… Date å¯¹è±¡ã€‚</li><li><strong>mtime</strong>ï¼šä¿®æ”¹æ—¶é—´ï¼ˆModification Timeï¼‰ï¼Œè¡¨ç¤ºæœ€åä¸€æ¬¡ä¿®æ”¹æ–‡ä»¶å†…å®¹çš„æ—¶é—´ã€‚åŒæ ·ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ—¶é—´æˆ³æˆ–è€… Date å¯¹è±¡ã€‚</li><li><strong>callback</strong>ï¼šå›è°ƒå‡½æ•°ï¼Œåœ¨æ“ä½œå®Œæˆåè¢«è°ƒç”¨ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œé”™è¯¯å‚æ•°(err)ä¼šæ˜¯ nullï¼›å¦åˆ™ï¼Œå®ƒä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ã€‚</li></ul><h4 id="å®é™…ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-5"><span>å®é™…ä¾‹å­</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œè¯¥åº”ç”¨éœ€è¦æ›´æ–°æŸäº›é…ç½®æ–‡ä»¶æˆ–è„šæœ¬çš„æ—¶é—´æˆ³ï¼Œä½†ä½ ä¸æƒ³æ”¹å˜æ–‡ä»¶å†…å®¹ï¼Œä¹Ÿå¸Œæœ›ä¿æŒç¬¦å·é“¾æ¥çš„åŸå§‹æŒ‡å‘ä¸å˜ã€‚è¿™æ—¶ï¼Œ<code>fs.lutimes()</code>å°±æ´¾ä¸Šäº†ç”¨åœºã€‚</p><ol><li><strong>æ›´æ–°é…ç½®æ–‡ä»¶çš„æ—¶é—´æˆ³</strong></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾ &#39;./config.json&#39; æ˜¯ä¸€ä¸ªé…ç½®æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ–°çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´ï¼Œè®¾ç½®ä¸ºå½“å‰æ—¶é—´</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> now</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">lutimes</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> now</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> now</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è®¿é—®å’Œä¿®æ”¹æ—¶é—´æ›´æ–°æˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>ä¿æŒç¬¦å·é“¾æ¥çš„æ—¶é—´æˆ³æ›´æ–°ï¼Œè€Œä¸æ”¹å˜å…¶æŒ‡å‘çš„æ–‡ä»¶</strong></li></ol><p>å¦‚æœä½ æœ‰ä¸€ä¸ªç¬¦å·é“¾æ¥æŒ‡å‘å¦ä¸€ä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨<code>fs.lutimes</code>å¯ä»¥ç›´æ¥æ›´æ–°è¿™ä¸ªé“¾æ¥çš„æ—¶é—´æˆ³ï¼Œè€Œä¸å½±å“å®ƒæŒ‡å‘çš„å®é™…æ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾ &#39;./link-to-config&#39; æ˜¯æŒ‡å‘ &#39;./config.json&#39; çš„ç¬¦å·é“¾æ¥</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> linkPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./link-to-config</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> newTime</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">lutimes</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">linkPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> newTime</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> newTime</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç¬¦å·é“¾æ¥çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´æ›´æ–°æˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™ä¸¤ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥çœ‹å‡º<code>fs.lutimes()</code>éå¸¸é€‚åˆé‚£äº›éœ€è¦å•ç‹¬è°ƒæ•´æ–‡ä»¶æˆ–ç¬¦å·é“¾æ¥æ—¶é—´æˆ³çš„åœºæ™¯ï¼Œæ— è®ºæ˜¯å‡ºäºç®¡ç†éœ€è¦è¿˜æ˜¯ç®€å•åœ°ç¡®ä¿æ–‡ä»¶ç³»ç»Ÿçš„æ­£ç¡®æ€§ã€‚</p><h3 id="fs-link-existingpath-newpath-callback" tabindex="-1"><a class="header-anchor" href="#fs-link-existingpath-newpath-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fslinkexistingpath-newpath-callback" target="_blank" rel="noopener noreferrer">fs.link(existingPath, newPath, callback)</a></span></a></h3><p>å½“ç„¶ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥ç†è§£ <code>fs.link(existingPath, newPath, callback)</code> è¿™ä¸ªæ–¹æ³•æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä»¥åŠå®ƒåœ¨å®é™…ä¸­çš„åº”ç”¨ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-9" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-9"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><h4 id="ä»€ä¹ˆæ˜¯-node-js" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-node-js"><span>ä»€ä¹ˆæ˜¯ Node.jsï¼Ÿ</span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„ JavaScript ç¯å¢ƒã€‚å®ƒå…è®¸ä½ ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ç¨‹åºï¼Œä¾‹å¦‚åˆ›å»ºç½‘é¡µå†…å®¹ã€å¤„ç†æ–‡ä»¶ç³»ç»Ÿç­‰ã€‚</p><h4 id="æ–‡ä»¶ç³»ç»Ÿ-fs-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶ç³»ç»Ÿ-fs-æ¨¡å—"><span>æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—</span></a></h4><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æä¾›äº†ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„åŠŸèƒ½ã€‚è¿™åŒ…æ‹¬è¯»å–æ–‡ä»¶ã€å†™å…¥æ–‡ä»¶ã€æ›´æ”¹æ–‡ä»¶æƒé™ã€åˆ›å»ºé“¾æ¥ç­‰æ“ä½œã€‚</p><h3 id="fs-link-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#fs-link-æ–¹æ³•"><span>fs.link æ–¹æ³•</span></a></h3><p><code>fs.link</code> æ–¹æ³•ç”¨äºåˆ›å»ºç¡¬é“¾æ¥ã€‚ç¡¬é“¾æ¥æ˜¯æŒ‡å‘æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶ã€‚åˆ›å»ºç¡¬é“¾æ¥åï¼Œä½ ä¼šæœ‰ä¸¤ä¸ªå®Œå…¨ç›¸åŒçš„å…¥å£æŒ‡å‘åŒä¸€æ–‡ä»¶æ•°æ®ã€‚å¦‚æœä½ ä¿®æ”¹äº†é€šè¿‡ä»»æ„ä¸€ä¸ªé“¾æ¥è®¿é—®çš„æ–‡ä»¶å†…å®¹ï¼Œå¦ä¸€ä¸ªä¹Ÿä¼šæ˜¾ç¤ºå‡ºç›¸åŒçš„æ›´æ”¹ã€‚</p><h4 id="å‚æ•°è§£é‡Š-13" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-13"><span>å‚æ•°è§£é‡Š</span></a></h4><ul><li><code>existingPath</code>: å·²å­˜åœ¨æ–‡ä»¶çš„è·¯å¾„ã€‚</li><li><code>newPath</code>: å°†è¦åˆ›å»ºçš„æ–°é“¾æ¥çš„è·¯å¾„ã€‚</li><li><code>callback</code>: å®Œæˆæ“ä½œåè°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œé”™è¯¯å‚æ•° (<code>err</code>) ä¼šæ˜¯ <code>null</code>ï¼›å¦åˆ™ï¼Œå®ƒå°†åŒ…å«é”™è¯¯ä¿¡æ¯ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-2"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦ä¸ºå¯†é’¥æˆ–é…ç½®æ–‡ä»¶åˆ›å»ºä¸€ä¸ªå¤‡ä»½é“¾æ¥ï¼Œä¿éšœæ•°æ®å®‰å…¨ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>fs.link</code> æ–¹æ³•æ¥å®ç°è¿™ä¸ªéœ€æ±‚ã€‚</p><h4 id="ç¤ºä¾‹ä»£ç -4" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç -4"><span>ç¤ºä¾‹ä»£ç ï¼š</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è¦è¿æ¥çš„åŸå§‹æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> existingPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// æ–°é“¾æ¥çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> newPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./backup-config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨fs.linkåˆ›å»ºé“¾æ¥</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">link</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">existingPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> newPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å¦‚æœæœ‰é”™è¯¯ï¼ŒæŠ›å‡ºå¼‚å¸¸</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">é“¾æ¥åˆ›å»ºæˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šåˆ›å»ºä¸€ä¸ªåä¸º <code>backup-config.json</code> çš„ç¡¬é“¾æ¥ï¼Œè¯¥é“¾æ¥å’Œ <code>config.json</code> æŒ‡å‘ç›¸åŒçš„æ–‡ä»¶æ•°æ®ã€‚å¦‚æœ <code>config.json</code> æ–‡ä»¶è¢«æ›´æ–°ï¼Œæ‰“å¼€ <code>backup-config.json</code> ä¹Ÿä¼šçœ‹åˆ°ç›¸åŒçš„æ›´æ”¹ã€‚åä¹‹äº¦ç„¶ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-10" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-10"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>ç¡¬é“¾æ¥åªèƒ½ç”¨äºåŒä¸€æ–‡ä»¶ç³»ç»Ÿå†…çš„æ–‡ä»¶ï¼Œè€Œä¸èƒ½è·¨æ–‡ä»¶ç³»ç»Ÿæˆ–ç”¨äºç›®å½•ã€‚</li><li>åˆ›å»ºç¡¬é“¾æ¥ä¸ä¼šå ç”¨å¾ˆå¤šé¢å¤–ç©ºé—´ï¼Œå› ä¸ºé“¾æ¥å’ŒåŸå§‹æ–‡ä»¶å…±äº«ç›¸åŒçš„æ•°æ®ã€‚</li><li>å¦‚æœåˆ é™¤äº†åŸå§‹æ–‡ä»¶æˆ–ç¡¬é“¾æ¥ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼Œå¦ä¸€ä¸ªä»ç„¶å¯ä»¥è®¿é—®æ•°æ®ï¼Œç›´åˆ°æ‰€æœ‰é“¾æ¥éƒ½è¢«åˆ é™¤ä¸ºæ­¢ã€‚</li></ul><p>å¸Œæœ›è¿™å¯ä»¥å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ <code>fs.link</code> æ–¹æ³•åŠå…¶åº”ç”¨ï¼</p><h3 id="fs-lstat-path-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-lstat-path-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fslstatpath-options-callback" target="_blank" rel="noopener noreferrer">fs.lstat(path[, options], callback)</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘å¸®ä½ è¯¦ç»†äº†è§£ <code>fs.lstat()</code> å‡½æ•°åœ¨ Node.js ä¸­çš„ç”¨æ³•ã€‚</p><h3 id="ç®€ä»‹-1" tabindex="-1"><a class="header-anchor" href="#ç®€ä»‹-1"><span>ç®€ä»‹</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æ˜¯ä¸€ä¸ªç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„æ¨¡å—ã€‚å®ƒæä¾›äº†å¾ˆå¤šéå¸¸å®ç”¨çš„æ–¹æ³•æ¥åˆ›å»ºã€è®¿é—®å’Œæ“ä½œæ–‡ä»¶ç³»ç»Ÿã€‚<code>fs.lstat()</code> å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œå®ƒç”¨äºè·å–æ–‡ä»¶æˆ–ç›®å½•çš„çŠ¶æ€ä¿¡æ¯ã€‚</p><h3 id="fs-lstat-path-options-callback-1" tabindex="-1"><a class="header-anchor" href="#fs-lstat-path-options-callback-1"><span><code>fs.lstat(path[, options], callback)</code></span></a></h3><p>è¿™ä¸ªå‡½æ•°ä¸»è¦ç”¨äºè¯»å–æ–‡ä»¶æˆ–ç›®å½•çš„å…ƒæ•°æ®ï¼ˆmetadataï¼‰ï¼Œæ¯”å¦‚æ–‡ä»¶çš„å¤§å°ã€åˆ›å»ºæ—¶é—´ç­‰ã€‚ä½†æœ‰ä¸€ä¸ªç‰¹ç‚¹éœ€è¦æ³¨æ„ï¼Œå½“è·¯å¾„æŒ‡å‘ä¸€ä¸ªç¬¦å·é“¾æ¥æ—¶ï¼Œ<code>fs.lstat()</code> è¿”å›çš„æ˜¯è¯¥ç¬¦å·é“¾æ¥æœ¬èº«çš„ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å®ƒæ‰€æŒ‡å‘çš„æ–‡ä»¶æˆ–ç›®å½•çš„ä¿¡æ¯ã€‚</p><ul><li><strong>path</strong>: è¦æŸ¥çœ‹å…¶ç»Ÿè®¡ä¿¡æ¯çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><strong>options</strong>: ï¼ˆå¯é€‰ï¼‰ç”¨äºè°ƒæ•´å‡½æ•°è¡Œä¸ºçš„é€‰é¡¹ã€‚</li><li><strong>callback</strong>: å½“æ“ä½œå®Œæˆæˆ–å‘ç”Ÿé”™è¯¯æ—¶è¢«è°ƒç”¨çš„å‡½æ•°ã€‚å®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š<code>err</code>ï¼ˆé”™è¯¯ä¿¡æ¯ï¼‰å’Œ<code>stats</code>ï¼ˆæ–‡ä»¶/ç›®å½•çš„çŠ¶æ€ä¿¡æ¯ï¼‰ã€‚</li></ul><h3 id="å®é™…è¿ç”¨-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨-1"><span>å®é™…è¿ç”¨</span></a></h3><h4 id="ç¤ºä¾‹-1-è·å–æ–‡ä»¶çŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-è·å–æ–‡ä»¶çŠ¶æ€"><span>ç¤ºä¾‹ 1: è·å–æ–‡ä»¶çŠ¶æ€</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º &quot;example.txt&quot; çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬æƒ³è·å–è¿™ä¸ªæ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fs.lstat è·å–æ–‡ä»¶çŠ¶æ€</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">lstat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‡ºé”™äº†:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // è¾“å‡ºæ–‡ä»¶çŠ¶æ€ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶å¤§å°: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">size</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> å­—èŠ‚</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ˜¯å¦æ˜¯æ–‡ä»¶: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFile</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ˜¯å¦æ˜¯ç›®å½•: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isDirectory</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>fs.lstat()</code> æ¥è·å– &quot;example.txt&quot; æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯ï¼Œå¹¶æ‰“å°äº†ä¸€äº›åŸºæœ¬çš„å±æ€§ï¼Œæ¯”å¦‚æ–‡ä»¶å¤§å°ã€æ˜¯å¦æ˜¯æ–‡ä»¶ã€æ˜¯å¦æ˜¯ç›®å½•ç­‰ã€‚</p><h4 id="ç¤ºä¾‹-2-åˆ¤æ–­è·¯å¾„æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-åˆ¤æ–­è·¯å¾„æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•"><span>ç¤ºä¾‹ 2: åˆ¤æ–­è·¯å¾„æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•</span></a></h4><p>ç°åœ¨å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªè·¯å¾„ï¼Œä½†æˆ‘ä»¬ä¸ç¡®å®šå®ƒæ˜¯æŒ‡å‘ä¸€ä¸ªæ–‡ä»¶è¿˜æ˜¯ä¸€ä¸ªç›®å½•ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>fs.lstat()</code> æ¥åˆ¤æ–­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡å®šæˆ‘ä»¬è¦æ£€æŸ¥çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">some/path/to/check</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fs.lstat è·å–è·¯å¾„çŠ¶æ€</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">lstat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‡ºé”™äº†:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // æ ¹æ®çŠ¶æ€åˆ¤æ–­è¯¥è·¯å¾„æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFile</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">path</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> æ˜¯ä¸€ä¸ªæ–‡ä»¶</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#81A1C1;"> if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isDirectory</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">path</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> æ˜¯ä¸€ä¸ªç›®å½•</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡æŸ¥çœ‹ <code>stats</code> å¯¹è±¡ä¸Šçš„æ–¹æ³•ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåˆ¤æ–­å‡ºç»™å®šè·¯å¾„æ˜¯æ–‡ä»¶ã€ç›®å½•è¿˜æ˜¯å…¶ä»–ç±»å‹çš„å¯¹è±¡ã€‚</p><h3 id="ç»“è®º-3" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-3"><span>ç»“è®º</span></a></h3><p><code>fs.lstat()</code> æ˜¯ Node.js ä¸­ä¸€ä¸ªéå¸¸å®ç”¨çš„å‡½æ•°ï¼Œç‰¹åˆ«é€‚åˆåœ¨éœ€è¦è·å–æ–‡ä»¶ç³»ç»Ÿä¸­å„ç§å¯¹è±¡ï¼ˆæ–‡ä»¶ã€ç›®å½•ã€ç¬¦å·é“¾æ¥ç­‰ï¼‰çŠ¶æ€ä¿¡æ¯çš„åœºæ™¯ä¸‹ä½¿ç”¨ã€‚é€šè¿‡å®ƒè¿”å›çš„ <code>stats</code> å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œè¿›ä¸€æ­¥çš„æ“ä½œæˆ–è€…å†³ç­–ã€‚</p><h3 id="fs-mkdir-path-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-mkdir-path-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsmkdirpath-options-callback" target="_blank" rel="noopener noreferrer">fs.mkdir(path[, options], callback)</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptï¼Œä»è€Œè¿›è¡Œå„ç§åç«¯æ“ä½œã€‚<code>fs</code>æ¨¡å—æ˜¯ Node.js å†…ç½®çš„æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼Œæä¾›äº†ä¸€ç³»åˆ—ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ APIï¼Œæ¯”å¦‚è¯»å–ã€å†™å…¥æ–‡ä»¶ï¼Œåˆ›å»ºæˆ–åˆ é™¤ç›®å½•ç­‰ã€‚</p><p><code>fs.mkdir(path[, options], callback)</code>æ˜¯<code>fs</code>æ¨¡å—ä¸­ç”¨æ¥åˆ›å»ºæ–°ç›®å½•çš„æ–¹æ³•ã€‚ä¸‹é¢æˆ‘å°†ä¸ºä½ è¯¦ç»†è§£é‡Šè¿™ä¸ªæ–¹æ³•åŠå…¶åº”ç”¨ï¼š</p><h3 id="å‚æ•°è§£é‡Š-14" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-14"><span>å‚æ•°è§£é‡Š</span></a></h3><ol><li><strong>path</strong>: è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼ŒæŒ‡å®šè¦åˆ›å»ºçš„ç›®å½•çš„è·¯å¾„ã€‚</li><li><strong>options</strong> (å¯é€‰): å¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–ä¸€ä¸ªæ•°å­—ã€‚å¦‚æœæ˜¯å¯¹è±¡ï¼Œå¯ä»¥æœ‰ä»¥ä¸‹å±æ€§ï¼š <ul><li><code>recursive</code>: å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦é€’å½’åˆ›å»ºç›®å½•ã€‚å¦‚æœè®¾ç½®ä¸º<code>true</code>ï¼Œåˆ™ä¼šåˆ›å»ºæ‰€æœ‰ä¸å­˜åœ¨çš„çˆ¶ç›®å½•ã€‚é»˜è®¤ä¸º<code>false</code>ã€‚</li><li><code>mode</code>: è®¾ç½®ç›®å½•æƒé™ï¼Œé»˜è®¤æ˜¯<code>0o777</code>ï¼ˆå¯è¯»å†™æ‰§è¡Œï¼‰ã€‚</li></ul></li><li><strong>callback</strong>: å›è°ƒå‡½æ•°ï¼Œå½“<code>mkdir</code>æ“ä½œå®Œæˆæ—¶è¢«è°ƒç”¨ã€‚æ¥æ”¶ä¸€ä¸ªå‚æ•°<code>err</code>ï¼Œå¦‚æœæ“ä½œæˆåŠŸï¼Œ<code>err</code>å°†ä¸º<code>null</code>ï¼Œå¦åˆ™åŒ…å«é”™è¯¯ä¿¡æ¯ã€‚</li></ol><h3 id="ä½¿ç”¨ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­-3"><span>ä½¿ç”¨ä¾‹å­</span></a></h3><h4 id="åˆ›å»ºå•ä¸ªç›®å½•" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºå•ä¸ªç›®å½•"><span>åˆ›å»ºå•ä¸ªç›®å½•</span></a></h4><p>å‡è®¾æˆ‘ä»¬æƒ³åœ¨å½“å‰å·¥ä½œç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º&quot;newFolder&quot;çš„ç›®å½•ï¼š</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">mkdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">newFolder</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">    return</span><span style="color:#D8DEE9;"> console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•åˆ›å»ºæˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œæ²¡æœ‰ä½¿ç”¨<code>options</code>å‚æ•°ï¼Œå› æ­¤<code>mkdir</code>ä¼šå°è¯•åˆ›å»ºæŒ‡å®šçš„ç›®å½•ã€‚å¦‚æœè¯¥ç›®å½•å·²å­˜åœ¨ï¼Œå›è°ƒå‡½æ•°ä¸­çš„<code>err</code>å¯¹è±¡ä¼šè¯´æ˜é”™è¯¯åŸå› ã€‚</p><h4 id="é€’å½’åˆ›å»ºç›®å½•" tabindex="-1"><a class="header-anchor" href="#é€’å½’åˆ›å»ºç›®å½•"><span>é€’å½’åˆ›å»ºç›®å½•</span></a></h4><p>ç°åœ¨å‡è®¾æˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªè·¯å¾„è¾ƒæ·±çš„ç›®å½•ï¼Œä¾‹å¦‚<code>./a/b/c</code>ï¼Œå¹¶ä¸”æˆ‘ä»¬ä¸ç¡®å®š<code>a</code>å’Œ<code>b</code>ç›®å½•æ˜¯å¦å­˜åœ¨ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">mkdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./a/b/c</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> recursive</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">    return</span><span style="color:#D8DEE9;"> console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•åˆ›å»ºæˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡å°†<code>options</code>å¯¹è±¡ä¸­çš„<code>recursive</code>å±æ€§è®¾ç½®ä¸º<code>true</code>ï¼Œ<code>fs.mkdir</code>ä¼šè‡ªåŠ¨åˆ›å»ºæ‰€æœ‰å¿…éœ€çš„çˆ¶ç›®å½•ã€‚</p><h3 id="å°ç»“-4" tabindex="-1"><a class="header-anchor" href="#å°ç»“-4"><span>å°ç»“</span></a></h3><p><code>fs.mkdir</code>æ˜¯ Node.js ä¸­ä¸€ä¸ªéå¸¸å®ç”¨çš„æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºç›®å½•ã€‚é€šè¿‡é€’å½’é€‰é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åˆ›å»ºå¤šçº§ç›®å½•ç»“æ„ï¼Œè¿™åœ¨å¤„ç†é¡¹ç›®æ„å»ºè„šæœ¬æˆ–ç®¡ç†ä¸Šä¼ æ–‡ä»¶æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚è®°å¾—æ€»æ˜¯å¤„ç†å›è°ƒä¸­å¯èƒ½å‡ºç°çš„é”™è¯¯ï¼Œç¡®ä¿ç¨‹åºçš„å¥å£®æ€§ã€‚</p><h3 id="fs-mkdtemp-prefix-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-mkdtemp-prefix-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsmkdtempprefix-options-callback" target="_blank" rel="noopener noreferrer">fs.mkdtemp(prefix[, options], callback)</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ·±å…¥äº†è§£ä¸€ä¸‹ Node.js ä¸­çš„ <code>fs.mkdtemp</code> æ–¹æ³•ã€‚</p><p>ç®€å•æ¥è¯´ï¼Œ<code>fs.mkdtemp</code> æ˜¯ä¸€ä¸ªç”¨äºåœ¨ä½ çš„æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„ã€ä¸´æ—¶çš„ç›®å½•ï¼ˆæ–‡ä»¶å¤¹ï¼‰çš„æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ç‰¹åˆ«æœ‰ç”¨ï¼Œå½“ä½ éœ€è¦åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´æš‚æ—¶å­˜å‚¨æ–‡ä»¶ä½†åˆä¸æƒ³å†²çªæˆ–é‡å†™å·²å­˜åœ¨çš„ç›®å½•æ—¶ã€‚</p><h3 id="å‚æ•°-5" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-5"><span>å‚æ•°</span></a></h3><ul><li><strong>prefix</strong>ï¼šè¿™æ˜¯ä½ è¦åˆ›å»ºçš„ä¸´æ—¶ç›®å½•åçš„å‰ç¼€ã€‚Node.js ä¼šè‡ªåŠ¨ä¸ºä½ çš„ç›®å½•æ·»åŠ ä¸€äº›éšæœºç”Ÿæˆçš„å­—ç¬¦ï¼Œç¡®ä¿æ¯æ¬¡è°ƒç”¨éƒ½èƒ½åˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„ç›®å½•ã€‚</li><li><strong>options</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…è®¸ä½ æŒ‡å®šä¸€äº›é¢å¤–çš„é€‰é¡¹æ¯”å¦‚ç›®å½•çš„å­—ç¬¦ç¼–ç ã€‚</li><li><strong>callback</strong>ï¼šå®Œæˆç›®å½•åˆ›å»ºæ“ä½œåï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°è¢«è°ƒç”¨ï¼Œå®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼šé”™è¯¯å¯¹è±¡ï¼ˆå¦‚æœæœ‰é”™è¯¯å‘ç”Ÿçš„è¯ï¼‰å’Œåˆ›å»ºçš„ä¸´æ—¶ç›®å½•çš„è·¯å¾„ã€‚</li></ul><h3 id="ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1"><span>ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦å¤„ç†å¤§é‡çš„å›¾ç‰‡ï¼Œå¹¶ä¸”å¸Œæœ›åœ¨å¤„ç†ä¹‹å‰å…ˆå°†å®ƒä»¬ä¿å­˜åœ¨ä¸€ä¸ªä¸´æ—¶çš„åœ°æ–¹ã€‚è¿™æ ·å¯ä»¥é¿å…æä¹±åŸå§‹æ•°æ®ï¼Œå¹¶ç¡®ä¿æ¯ä¸€æ¬¡è¿è¡Œéƒ½æ˜¯ç‹¬ç«‹ä¸”å¹²å‡€çš„ç¯å¢ƒã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// prefix å‚æ•°æŒ‡å®šäº†ä¸´æ—¶ç›®å½•åçš„å‰ç¼€</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">mkdtemp</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">os</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">tmpdir</span><span style="color:#D8DEE9FF;">()</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">myApp-</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> directory</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // æ‰“å°æ–°åˆ›å»ºçš„ä¸´æ—¶ç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">ä¸´æ—¶ç›®å½•å·²æˆåŠŸåˆ›å»ºåœ¨</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">directory</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // ç°åœ¨ä½ å¯ä»¥åœ¨è¿™ä¸ªç›®å½•é‡Œåˆ›å»ºæˆ–ä¿®æ”¹æ–‡ä»¶äº†</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å‡è®¾è¿™é‡Œä½ ä¼šè¿›è¡Œä¸€äº›å¤„ç†ï¼Œæ¯”å¦‚ä¿å­˜ä¸Šä¼ çš„å›¾ç‰‡ç­‰</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ol><li>æˆ‘ä»¬ä½¿ç”¨äº† <code>os.tmpdir()</code> æ¥è·å–æ“ä½œç³»ç»Ÿé»˜è®¤çš„ä¸´æ—¶æ–‡ä»¶å­˜æ”¾è·¯å¾„ï¼Œç¡®ä¿æˆ‘ä»¬çš„åº”ç”¨åœ¨ä»»ä½•ç¯å¢ƒä¸‹éƒ½èƒ½æ­£å¸¸å·¥ä½œã€‚</li><li>é€šè¿‡ <code>path.join</code> æŠŠç³»ç»Ÿä¸´æ—¶ç›®å½•çš„è·¯å¾„å’Œæˆ‘ä»¬æŒ‡å®šçš„å‰ç¼€ <code>myApp-</code> ç»“åˆèµ·æ¥ï¼Œå½¢æˆå®Œæ•´çš„ç›®å½•å‰ç¼€è·¯å¾„ã€‚</li><li><code>fs.mkdtemp</code> åˆ›å»ºäº†ä¸€ä¸ªå…·æœ‰å”¯ä¸€åç¼€çš„ä¸´æ—¶ç›®å½•ï¼Œè¿™æ ·å³ä½¿å¤šä¸ªå®ä¾‹åŒæ—¶è¿è¡Œä¹Ÿä¸ä¼šç›¸äº’å½±å“ã€‚</li></ol><h3 id="å°ç»“-5" tabindex="-1"><a class="header-anchor" href="#å°ç»“-5"><span>å°ç»“</span></a></h3><p>é€šè¿‡ä½¿ç”¨ <code>fs.mkdtemp</code>ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨ä½ çš„åº”ç”¨ä¸­åˆ›å»ºä¸´æ—¶ç›®å½•ï¼Œè¿™å¯¹äºå¤„ç†ä¸´æ—¶æ•°æ®æˆ–è¿›è¡Œéš”ç¦»æµ‹è¯•éå¸¸æœ‰ç”¨ã€‚å®ƒçš„è‡ªåŠ¨åŒ–å’ŒéšæœºåŒ–ç‰¹æ€§ä¿è¯äº†åº”ç”¨çš„å¥å£®æ€§å’Œå®‰å…¨æ€§ã€‚</p><h3 id="fs-open-path-flags-mode-callback" tabindex="-1"><a class="header-anchor" href="#fs-open-path-flags-mode-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsopenpath-flags-mode-callback" target="_blank" rel="noopener noreferrer">fs.open(path[, flags[, mode]], callback)</a></span></a></h3><p>Node.js çš„ <code>fs.open</code> å‡½æ•°æ˜¯æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>ï¼‰æ¨¡å—ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ã€‚äº†è§£å’Œä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¯¹äºæ‰§è¡Œæ–‡ä»¶æ“ä½œï¼ˆå¦‚è¯»å†™æ•°æ®ï¼‰éå¸¸é‡è¦ã€‚ç°åœ¨ï¼Œæˆ‘ä¼šè¯¦ç»†ä¸¾ä¾‹è§£é‡Šè¿™ä¸ªå‡½æ•°çš„ä½¿ç”¨æ–¹æ³•ï¼ŒåŒ…æ‹¬å®ƒçš„å‚æ•°ä»¥åŠæ€æ ·åœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨ã€‚</p><h3 id="åŸºæœ¬è¯­æ³•-1" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬è¯­æ³•-1"><span>åŸºæœ¬è¯­æ³•</span></a></h3><p><code>fs.open(path[, flags[, mode]], callback)</code> å‡½æ•°çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p><ul><li><code>path</code>: è¦æ‰“å¼€çš„æ–‡ä»¶çš„è·¯å¾„ï¼ˆæ¯”å¦‚ <code>&#39;./test.txt&#39;</code>ï¼‰ã€‚</li><li><code>flags</code>: æ‰“å¼€æ–‡ä»¶æ—¶é‡‡å–çš„è¡ŒåŠ¨ï¼ˆä¾‹å¦‚ï¼Œè¯»å–ã€å†™å…¥ç­‰ï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œæ¯”å¦‚ <code>&#39;r&#39;</code> ä»£è¡¨åªè¯»ï¼Œ<code>&#39;w&#39;</code> ä»£è¡¨å†™å…¥ç­‰ã€‚</li><li><code>mode</code>: ï¼ˆå¯é€‰ï¼‰è®¾ç½®æ–‡ä»¶æ¨¡å¼ï¼ˆæƒé™å’Œç²˜æ»ä½ï¼‰ï¼Œä½†ä»…åœ¨åˆ›å»ºæ–‡ä»¶æ—¶æœ‰æ•ˆã€‚å®ƒæ˜¯ä¸€ä¸ªå…«è¿›åˆ¶æ•°ï¼ˆæ¯”å¦‚ <code>0o666</code> è¡¨ç¤ºå¯è¯»å†™ï¼‰ã€‚</li><li><code>callback</code>: å½“æ–‡ä»¶æ‰“å¼€å®Œæˆæˆ–å‡ºé”™æ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚å®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•°â€”â€”é”™è¯¯ <code>err</code> å’Œæ–‡ä»¶æè¿°ç¬¦ <code>fd</code>ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-14" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-14"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="_1-æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œè¯»å–" tabindex="-1"><a class="header-anchor" href="#_1-æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œè¯»å–"><span>1. æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œè¯»å–</span></a></h4><p>å‡è®¾ä½ æƒ³æ‰“å¼€ä¸€ä¸ªå« <code>example.txt</code> çš„æ–‡ä»¶æ¥è¯»å–å†…å®¹ï¼Œä½ å¯ä»¥è¿™ä¹ˆåšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ‰“å¼€æ–‡ä»¶æ—¶å‡ºé”™: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">err</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶æˆåŠŸæ‰“å¼€ï¼Œæ–‡ä»¶æè¿°ç¬¦ä¸º: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">fd</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // è¿›è¡Œå…¶ä»–æ“ä½œï¼Œä¾‹å¦‚è¯»å–æ–‡ä»¶...</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°è¯•ä»¥åªè¯»æ¨¡å¼ï¼ˆ<code>&#39;r&#39;</code>ï¼‰æ‰“å¼€ <code>example.txt</code> æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶æˆåŠŸæ‰“å¼€ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ <code>fd</code>ï¼Œç”¨äºåç»­çš„æ–‡ä»¶æ“ä½œï¼ˆå¦‚è¯»å–æˆ–å…³é—­æ–‡ä»¶ï¼‰ã€‚</p><h4 id="_2-åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_2-åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶"><span>2. åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶</span></a></h4><p>å¦‚æœä½ æƒ³åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¹¶å‡†å¤‡å†™å…¥æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„æ ‡å¿—ï¼Œå¦‚ <code>&#39;w&#39;</code> æˆ– <code>&#39;a&#39;</code>ï¼ˆè¿½åŠ ï¼‰ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">newfile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">åˆ›å»ºæ–‡ä»¶æ—¶å‡ºé”™: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">err</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶æˆåŠŸåˆ›å»ºï¼Œæ–‡ä»¶æè¿°ç¬¦ä¸º: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">fd</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // ç°åœ¨å¯ä»¥å†™å…¥æ•°æ®åˆ°æ–‡ä»¶...</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œå¦‚æœ <code>newfile.txt</code> æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå®ƒå°†è¢«åˆ›å»ºï¼›å¦‚æœå·²å­˜åœ¨ï¼Œåˆ™å…¶å†…å®¹ä¼šè¢«æ¸…ç©ºï¼ˆå› ä¸ºæˆ‘ä»¬ä½¿ç”¨äº† <code>&#39;w&#39;</code> æ ‡å¿—ï¼‰ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-11" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-11"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li><strong>å¼‚æ­¥æ“ä½œ</strong>ï¼šæ³¨æ„ <code>fs.open</code> æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ã€‚è¿™æ„å‘³ç€ç¨‹åºä¸ä¼šé˜»å¡ï¼ˆæš‚åœæ‰§è¡Œï¼‰ç­‰å¾… <code>fs.open</code> å®Œæˆï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œç›´åˆ° <code>fs.open</code> æ“ä½œå®Œæˆï¼Œç„¶åæ‰§è¡Œæä¾›ç»™å®ƒçš„å›è°ƒå‡½æ•°ã€‚</li><li><strong>æ–‡ä»¶æè¿°ç¬¦ï¼ˆ<code>fd</code>ï¼‰</strong>ï¼šä¸€æ—¦æ–‡ä»¶è¢«æˆåŠŸæ‰“å¼€ï¼Œä½ å°±å¯ä»¥åˆ©ç”¨æ–‡ä»¶æè¿°ç¬¦ï¼ˆ<code>fd</code>ï¼‰è¿›è¡Œå„ç§æ–‡ä»¶æ“ä½œï¼Œæ¯”å¦‚è¯»å–æˆ–å†™å…¥æ•°æ®ã€‚æ–‡ä»¶æè¿°ç¬¦æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œæ˜¯æ“ä½œç³»ç»Ÿåˆ†é…ç»™æ¯ä¸ªæ‰“å¼€çš„æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†ã€‚</li></ul><p>å¸Œæœ›ä»¥ä¸Šè§£é‡Šèƒ½å¸®åŠ©ä½ ç†è§£å¦‚ä½•ä½¿ç”¨ Node.js ä¸­çš„ <code>fs.open</code> å‡½æ•°æ¥æ‰§è¡Œæ–‡ä»¶æ“ä½œï¼</p><h3 id="fs-openasblob-path-options" tabindex="-1"><a class="header-anchor" href="#fs-openasblob-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsopenasblobpath-options" target="_blank" rel="noopener noreferrer">fs.openAsBlob(path[, options])</a></span></a></h3><p>å½“ä½ å¼€å§‹æ¢ç´¢ Node.js, å°¤å…¶æ˜¯å®ƒçš„æ–‡ä»¶ç³»ç»Ÿ (<code>fs</code>) æ¨¡å—æ—¶ï¼Œä¼šå‘ç°è¿™æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„å·¥å…·é›†ï¼Œç”¨äºå¤„ç†æ–‡ä»¶å’Œç›®å½•ã€‚åœ¨ Node.js v21.7.1 ä¸­å¼•å…¥äº†ä¸€ä¸ªæ–°çš„å‡½æ•° <code>fs.openAsBlob(path[, options])</code>ã€‚è¿™ä¸ªå‡½æ•°è®©ä½ èƒ½å¤Ÿä»¥ Blob å¯¹è±¡çš„å½¢å¼è¯»å–æ–‡ä»¶å†…å®¹ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä¼šé€šè¿‡ä¸€äº›åŸºæœ¬æ¦‚å¿µå’Œå®é™…ä¾‹å­æ¥è§£é‡Šè¿™ä¸ªå‡½æ•°ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-blob" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-blob"><span>ä»€ä¹ˆæ˜¯ Blobï¼Ÿ</span></a></h3><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç†è§£ä»€ä¹ˆæ˜¯ Blobã€‚Blobï¼ˆBinary Large Objectï¼‰é€šå¸¸ç”¨äºè¡¨ç¤ºå¤§é‡çš„äºŒè¿›åˆ¶æ•°æ®ã€‚åœ¨ Web å¼€å‘ä¸­ï¼ŒBlob å¸¸ç”¨äºå¤„ç†å›¾ç‰‡ã€éŸ³è§†é¢‘æ–‡ä»¶ç­‰åª’ä½“èµ„æºã€‚å¯¹äº Node.js è€Œè¨€ï¼Œå°†æ–‡ä»¶å†…å®¹ä½œä¸º Blob å¯¹è±¡æä¾›ï¼Œå¯ä»¥ç®€åŒ–æŸäº›ç±»å‹çš„æ•°æ®å¤„ç†å’Œäº¤æ¢ï¼Œç‰¹åˆ«æ˜¯åœ¨ Node.js åº”ç”¨ä¸æµè§ˆå™¨å®¢æˆ·ç«¯ä¹‹é—´ã€‚</p><h3 id="fs-openasblob-çš„åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#fs-openasblob-çš„åŠŸèƒ½"><span>fs.openAsBlob çš„åŠŸèƒ½</span></a></h3><p><code>fs.openAsBlob(path[, options])</code> å‡½æ•°å…è®¸ä½ å°†ä½äºæŒ‡å®šè·¯å¾„çš„æ–‡ä»¶æ‰“å¼€å¹¶è¯»å–ä¸ºä¸€ä¸ª Blob å¯¹è±¡ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ç›´æ¥å¤„ç†æ–‡ä»¶çš„äºŒè¿›åˆ¶å†…å®¹ï¼Œè€Œä¸éœ€è¦å…ˆå°†å…¶è¯»å–ä¸ºå­—ç¬¦ä¸²æˆ– Buffer ç­‰å…¶ä»–æ ¼å¼ã€‚</p><h3 id="å‚æ•°è§£é‡Š-15" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-15"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>path</code>ï¼šè¿™æ˜¯ä½ æƒ³è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚</li><li><code>options</code>ï¼ˆå¯é€‰ï¼‰ï¼šè¿™æ˜¯ä¸€ç»„é…ç½®é¡¹ï¼Œå¯ä»¥è®©ä½ æŒ‡å®šå¦‚ä½•æ‰“å¼€å’Œè¯»å–æ–‡ä»¶ï¼Œæ¯”å¦‚è®¾ç½®æ–‡ä»¶çš„ç¼–ç ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-6" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-6"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º &quot;example.png&quot; çš„å›¾åƒæ–‡ä»¶ï¼Œæˆ‘ä»¬æƒ³åœ¨ Node.js åº”ç”¨ä¸­è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶å°†å…¶å†…å®¹ä½œä¸º Blob å¯¹è±¡å¤„ç†ã€‚ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨ <code>fs.openAsBlob</code> æ¥å®ç°è¿™ä¸€ç‚¹çš„ç¤ºä¾‹ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readFileAsBlob</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> blob</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openAsBlob</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.png</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // åœ¨è¿™é‡Œï¼Œä½ å¯ä»¥å¯¹ blob è¿›è¡Œå¤„ç†</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">blob</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">size</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º Blob å¯¹è±¡çš„å¤§å°</span></span>
<span class="line"><span style="color:#616E88;">    // æ›´å¤šçš„ Blob å¤„ç†æ“ä½œ...</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–æ–‡ä»¶å¤±è´¥</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">readFileAsBlob</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä½¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯"><span>ä½¿ç”¨åœºæ™¯</span></a></h3><ol><li><p><strong>Web åº”ç”¨</strong>ï¼šå¦‚æœä½ æ­£åœ¨æ„å»ºä¸€ä¸ªéœ€è¦å¤„ç†ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶çš„ Web åº”ç”¨ï¼Œå¹¶ä¸”ä½¿ç”¨ Node.js ä½œä¸ºåç«¯ï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•å¯ä»¥å¸®åŠ©ä½ æ›´æ–¹ä¾¿åœ°æ¥æ”¶å’Œå¤„ç†è¿™äº›æ–‡ä»¶ã€‚</p></li><li><p><strong>æ•°æ®è½¬æ¢</strong>ï¼šå¦‚æœä½ çš„åº”ç”¨éœ€è¦å°†æ–‡ä»¶å†…å®¹è¯»å–å¹¶è½¬æ¢ä¸ºå…¶ä»–æ ¼å¼ï¼Œå¼€å§‹æ—¶å°†å…¶ä½œä¸º Blob å¯¹è±¡å¤„ç†å¯èƒ½æ›´åŠ é«˜æ•ˆã€‚</p></li><li><p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šå¯¹äºå¤§å‹äºŒè¿›åˆ¶æ–‡ä»¶çš„æ“ä½œï¼Œç›´æ¥å¤„ç†å…¶ Blob å½¢å¼å¯ä»¥å‡å°‘å†…å­˜æ¶ˆè€—å’Œæé«˜å¤„ç†é€Ÿåº¦ã€‚</p></li></ol><p>æ€»ä¹‹ï¼Œ<code>fs.openAsBlob</code> æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ä¸­çš„ä¸€ä¸ªå¼ºå¤§æ–°å·¥å…·ï¼Œå®ƒæ‰©å±•äº†ä½ å¤„ç†æ–‡ä»¶çš„èƒ½åŠ›ï¼Œå°¤å…¶æ˜¯åœ¨æ¶‰åŠåˆ°äºŒè¿›åˆ¶æ•°æ®æ—¶ã€‚é€šè¿‡å®é™…ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ°å®ƒå¦‚ä½•è¢«ç”¨äºç®€åŒ–æ–‡ä»¶çš„è¯»å–å’Œå¤„ç†è¿‡ç¨‹ã€‚éšç€ä½ å¯¹ Node.js çš„è¿›ä¸€æ­¥å­¦ä¹ ï¼Œä½ ä¼šå‘ç°æ›´å¤šæœ‰è¶£ä¸”æœ‰ç”¨çš„åŠŸèƒ½æ¥æ”¯æŒä½ çš„é¡¹ç›®å¼€å‘ã€‚</p><h3 id="fs-opendir-path-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-opendir-path-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsopendirpath-options-callback" target="_blank" rel="noopener noreferrer">fs.opendir(path[, options], callback)</a></span></a></h3><p>Node.js ä¸­çš„<code>fs.opendir(path[, options], callback)</code>æ–¹æ³•æ˜¯ç”¨æ¥å¼‚æ­¥åœ°æ‰“å¼€ä¸€ä¸ªç›®å½•çš„ã€‚æˆ‘ä¼šåˆ†å‡ ä¸ªéƒ¨åˆ†æ¥è§£é‡Šè¿™ä¸ªæ–¹æ³•ï¼Œä½¿ä½ èƒ½æ›´å®¹æ˜“ç†è§£ï¼š</p><ol><li><p><strong>åŸºæœ¬æ¦‚å¿µ</strong>ï¼š</p><ul><li><code>fs</code>ï¼šåœ¨ Node.js ä¸­ï¼Œ<code>fs</code>æ¨¡å—æ˜¯ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ï¼Œå®ƒæä¾›äº†è®¸å¤šéå¸¸æœ‰ç”¨çš„æ–¹æ³•æ¥è®¿é—®å’Œæ“ä½œæ–‡ä»¶ç³»ç»Ÿã€‚</li><li><code>opendir</code>ï¼šè¿™ä¸ªæ–¹æ³•å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œä¸“é—¨ç”¨æ¥æ‰“å¼€ä¸€ä¸ªç›®å½•ã€‚</li></ul></li><li><p><strong>å‚æ•°è§£é‡Š</strong>ï¼š</p><ul><li><code>path</code>: è¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»£è¡¨ä½ æƒ³è¦æ‰“å¼€çš„ç›®å½•çš„è·¯å¾„ã€‚</li><li><code>options</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…è®¸ä½ æŒ‡å®šä¸€äº›æ‰“å¼€ç›®å½•æ—¶çš„é€‰é¡¹ï¼Œæ¯”å¦‚å¯ä»¥è®¾ç½®å¦‚ä½•å¤„ç†ç¬¦å·é“¾æ¥ã€‚</li><li><code>callback</code>: è¿™æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨æ‰“å¼€ç›®å½•åå°†è¢«è°ƒç”¨ã€‚å®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªæ˜¯<code>err</code>ï¼Œå¦‚æœæ‰“å¼€ç›®å½•æ—¶å‘ç”Ÿé”™è¯¯ï¼Œè¿™é‡Œä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼›ç¬¬äºŒä¸ªæ˜¯<code>dir</code>ï¼Œè¿™æ˜¯ä¸€ä¸ª<code>Dir</code>å¯¹è±¡ï¼Œç”¨æ¥è¡¨ç¤ºå·²ç»æ‰“å¼€çš„ç›®å½•ï¼Œé€šè¿‡å®ƒä½ å¯ä»¥è¯»å–ç›®å½•ä¸­çš„å†…å®¹ç­‰ã€‚</li></ul></li><li><p><strong>å®é™…è¿ç”¨ä¾‹å­</strong>ï¼š</p><ul><li>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º<code>photos</code>çš„ç›®å½•ï¼Œæˆ‘ä»¬æƒ³è¦æ‰“å¼€è¿™ä¸ªç›®å½•å¹¶åˆ—å‡ºå…¶ä¸­çš„æ‰€æœ‰æ–‡ä»¶ã€‚</li></ul></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æŒ‡å®šè¦æ‰“å¼€çš„ç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./photos</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">opendir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dir</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ‰“å¼€ç›®å½•è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•æˆåŠŸæ‰“å¼€</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#88C0D0;">  readDirectory</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dir</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> readDirectory</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dir</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // è¯»å–ç›®å½•ä¸­çš„æ¯ä¸ªæ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">  dir</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–ç›®å½•è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      return;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">dirent</span><span style="color:#81A1C1;"> ===</span><span style="color:#81A1C1;"> null</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">      // æ‰€æœ‰æ–‡ä»¶éƒ½å·²è¯»å–å®Œæ¯•</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•è¯»å–å®Œæˆ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ‰¾åˆ°æ–‡ä»¶:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#88C0D0;">      readDirectory</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dir</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // ç»§ç»­è¯»å–ä¸‹ä¸€ä¸ªæ–‡ä»¶</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨<code>fs.opendir</code>æ‰“å¼€åä¸º<code>photos</code>çš„ç›®å½•ã€‚ä¸€æ—¦ç›®å½•è¢«æˆåŠŸæ‰“å¼€ï¼Œæˆ‘ä»¬å°±è°ƒç”¨<code>readDirectory</code>å‡½æ•°å¼€å§‹è¯»å–ç›®å½•ä¸­çš„å†…å®¹ã€‚å¯¹äºæ¯ä¸ªæ‰¾åˆ°çš„æ–‡ä»¶æˆ–å­ç›®å½•ï¼Œæˆ‘ä»¬æ‰“å°å‡ºå®ƒçš„åç§°ã€‚å½“æ²¡æœ‰æ›´å¤šçš„æ–‡ä»¶æˆ–å­ç›®å½•æ—¶ï¼ˆ<code>dirent === null</code>ï¼‰ï¼Œè¡¨ç¤ºæˆ‘ä»¬å·²ç»è¯»å–å®Œç›®å½•ä¸­çš„æ‰€æœ‰å†…å®¹ã€‚</p><p>è¿™æ ·ï¼Œä½ å°±å¯ä»¥åˆ©ç”¨<code>fs.opendir</code>æ–¹æ³•æ¥å¼‚æ­¥åœ°å¤„ç†å’Œéå†ç›®å½•ä¸­çš„æ–‡ä»¶ï¼Œè¿™å¯¹äºè¿›è¡Œæ–‡ä»¶ç®¡ç†ã€æ„å»ºå·¥å…·æˆ–ä»»ä½•éœ€è¦å¤„ç†å¤§é‡æ–‡ä»¶çš„åº”ç”¨ç¨‹åºæ¥è¯´éå¸¸æœ‰ç”¨ã€‚</p><h3 id="fs-read-fd-buffer-offset-length-position-callback" tabindex="-1"><a class="header-anchor" href="#fs-read-fd-buffer-offset-length-position-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsreadfd-buffer-offset-length-position-callback" target="_blank" rel="noopener noreferrer">fs.read(fd, buffer, offset, length, position, callback)</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥è§£æ <code>fs.read()</code> è¿™ä¸ªå‡½æ•°åœ¨ Node.js ä¸­çš„å·¥ä½œæœºåˆ¶å’Œä¸€äº›å®é™…åº”ç”¨åœºæ™¯ã€‚<code>fs</code> æ¨¡å—æ˜¯ Node.js çš„æ ¸å¿ƒæ¨¡å—ä¹‹ä¸€ï¼Œæä¾›äº†æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„åŠŸèƒ½ï¼Œå¦‚è¯»å–ã€å†™å…¥æ–‡ä»¶ç­‰ã€‚<code>fs.read()</code> æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ–¹æ³•ï¼Œç”¨äºä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®ã€‚</p><h3 id="å‡½æ•°ç­¾å-1" tabindex="-1"><a class="header-anchor" href="#å‡½æ•°ç­¾å-1"><span>å‡½æ•°ç­¾å</span></a></h3><p>é¦–å…ˆï¼Œç†è§£ <code>fs.read(fd, buffer, offset, length, position, callback)</code> è¿™ä¸ªå‡½æ•°çš„å‚æ•°æ˜¯å¾ˆé‡è¦çš„ï¼š</p><ul><li><strong>fd</strong>ï¼šè¿™æ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼ˆFile Descriptorï¼‰ï¼Œä¸€ä¸ªæŒ‡å‘è¢«æ‰“å¼€æ–‡ä»¶çš„å¼•ç”¨æˆ–è€…è¯´æ ‡è¯†ã€‚</li><li><strong>buffer</strong>ï¼šè¿™æ˜¯æ•°æ®å°†è¢«å†™å…¥çš„ç¼“å†²åŒºï¼ˆBufferï¼‰ã€‚ç®€å•æ¥è¯´ï¼Œç¼“å†²åŒºå°±æ˜¯å†…å­˜ä¸­é¢„ç•™çš„ä¸€ç‰‡ç©ºé—´ï¼Œç”¨æ¥ä¸´æ—¶å­˜æ”¾è¾“å…¥æˆ–è¾“å‡ºçš„æ•°æ®ã€‚</li><li><strong>offset</strong>ï¼šè¿™æ˜¯ç¼“å†²åŒºå¼€å§‹å†™å…¥çš„åç§»é‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»ç¼“å†²åŒºçš„å“ªä¸ªä½ç½®å¼€å§‹å­˜æ”¾æ–‡ä»¶è¯»å‡ºçš„æ•°æ®ã€‚</li><li><strong>length</strong>ï¼šè¿™æ˜¯è¦ä»æ–‡ä»¶ä¸­è¯»å–çš„å­—èŠ‚æ•°ã€‚</li><li><strong>position</strong>ï¼šè¿™æ˜¯æ–‡ä»¶ä¸­å¼€å§‹è¯»å–çš„ä½ç½®ã€‚å¦‚æœ <code>position</code> çš„å€¼ä¸º <code>null</code>ï¼Œåˆ™ä»å½“å‰æ–‡ä»¶æŒ‡é’ˆçš„ä½ç½®å¼€å§‹è¯»å–æ•°æ®ã€‚</li><li><strong>callback</strong>ï¼šè¿™æ˜¯å½“è¯»å–æ“ä½œå®Œæˆåè°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚å®ƒæœ‰ä¸‰ä¸ªå‚æ•°ï¼š<code>err</code>ï¼ˆé”™è¯¯ä¿¡æ¯ï¼‰ï¼Œ<code>bytesRead</code>ï¼ˆå®é™…è¯»å–çš„å­—èŠ‚æ•°ï¼‰ï¼Œå’Œ <code>buffer</code>ï¼ˆè¢«æ•°æ®å¡«å……çš„ç¼“å†²åŒºï¼‰ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-15" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-15"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ <code>example.txt</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>Hello, Node.js!</span></span>
<span class="line"><span>Welcome to file system operations.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬æƒ³è¦è¯»å–è¿™ä¸ªæ–‡ä»¶çš„å‰ 14 ä¸ªå­—èŠ‚ï¼ˆå³ &quot;Hello, Node.js&quot;ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">14</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º14çš„ç¼“å†²åŒº</span></span>
<span class="line"><span style="color:#616E88;">  // ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">length</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: Hello, Node.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>fs.open()</code> æ–¹æ³•æ‰“å¼€äº†æ–‡ä»¶ï¼Œå¹¶è·å–äº†æ–‡ä»¶çš„æè¿°ç¬¦ <code>fd</code>ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªè¶³å¤Ÿå¤§çš„ç¼“å†²åŒºæ¥å­˜æ”¾æˆ‘ä»¬æƒ³è¦è¯»å–çš„æ•°æ®é•¿åº¦ï¼ˆ14 ä¸ªå­—èŠ‚ï¼‰ã€‚æ¥ä¸‹æ¥ï¼Œé€šè¿‡ <code>fs.read()</code> ä»æ–‡ä»¶çš„å¼€å¤´ï¼ˆä½ç½® 0ï¼‰è¯»å– 14 ä¸ªå­—èŠ‚åˆ°æˆ‘ä»¬çš„ç¼“å†²åŒºã€‚æœ€åï¼Œæˆ‘ä»¬å°†ç¼“å†²åŒºä¸­çš„æ•°æ®è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶æ‰“å°å‡ºæ¥ã€‚</p><h3 id="æ€»ç»“-8" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-8"><span>æ€»ç»“</span></a></h3><p><code>fs.read()</code> æ–¹æ³•æ˜¯ Node.js æ–‡ä»¶æ“ä½œä¸­çš„ä½çº§æ–¹æ³•ï¼Œå®ƒå…è®¸ä½ ç²¾ç¡®æ§åˆ¶ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®çš„è¿‡ç¨‹ï¼ŒåŒ…æ‹¬èµ·å§‹ä½ç½®å’Œè¯»å–é•¿åº¦ã€‚è™½ç„¶åœ¨æ—¥å¸¸åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæ›´é¢‘ç¹åœ°ä½¿ç”¨æ›´é«˜å±‚æ¬¡çš„æ–¹æ³•ï¼ˆä¾‹å¦‚ <code>fs.readFile()</code>ï¼‰ï¼Œä½†äº†è§£ <code>fs.read()</code> å¦‚ä½•å·¥ä½œï¼Œèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ Node.js ä¸­çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œã€‚</p><h3 id="fs-read-fd-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-read-fd-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsreadfd-options-callback" target="_blank" rel="noopener noreferrer">fs.read(fd[, options], callback)</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘ä¼šå°½é‡ç®€å•æ˜äº†åœ°è§£é‡Šç»™ä½ ã€‚</p><p>é¦–å…ˆï¼ŒNode.js æ˜¯ä¸€ä¸ªå¯ä»¥è®©ä½ ä½¿ç”¨ JavaScript ç¼–å†™æœåŠ¡ç«¯ä»£ç çš„è¿è¡Œæ—¶ç¯å¢ƒã€‚å®ƒéå¸¸é€‚åˆå¤„ç†ç½‘ç»œæ“ä½œã€æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ“ä½œç­‰ã€‚åœ¨ Node.js ä¸­ï¼Œå¤§å¤šæ•°æ ¸å¿ƒæ¨¡å—æä¾›äº†å¼‚æ­¥ï¼ˆéé˜»å¡ï¼‰å’ŒåŒæ­¥ï¼ˆé˜»å¡ï¼‰ä¸¤ç§æ–¹å¼çš„ APIã€‚<code>fs</code> æ¨¡å—å°±æ˜¯ç”¨æ¥å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„ï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶ã€å†™å…¥æ–‡ä»¶ç­‰ã€‚</p><p>å¯¹äº <code>fs.read(fd[, options], callback)</code> è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬æ¥é€éƒ¨åˆ†ç†è§£ï¼š</p><ul><li><strong><code>fs</code></strong>ï¼šè¿™æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œä¸“é—¨ç”¨äºæ–‡ä»¶ç³»ç»Ÿæ“ä½œã€‚</li><li><strong><code>read</code></strong>ï¼šè¿™æ˜¯ <code>fs</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®ã€‚</li><li><strong><code>fd</code></strong>ï¼šè¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼ˆFile Descriptorï¼‰ï¼Œæ˜¯ä¸€ä¸ªéå¸¸åº•å±‚çš„è¡¨ç¤ºæ–‡ä»¶çš„æ–¹å¼ã€‚å½“ä½ æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å‡†å¤‡è¿›è¡Œè¯»å†™æ“ä½œæ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œä»¥åçš„æ‰€æœ‰æ“ä½œï¼ˆè¯»ã€å†™ï¼‰éƒ½é€šè¿‡è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦æ¥è¿›è¡Œã€‚</li><li><strong><code>options</code></strong>ï¼ˆå¯é€‰ï¼‰ï¼šè¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä½ å¯ä»¥é€šè¿‡å®ƒæ¥æŒ‡å®šä¸€äº›è¯»å–æ“ä½œçš„è¯¦ç»†å‚æ•°ï¼Œæ¯”å¦‚ä»æ–‡ä»¶çš„å“ªä¸ªä½ç½®å¼€å§‹è¯»ã€è¯»å–å¤šå°‘å­—èŠ‚çš„æ•°æ®ç­‰ã€‚</li><li><strong><code>callback</code></strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œåœ¨è¯»å–å®Œæˆåè¢«è°ƒç”¨ã€‚å®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªæ˜¯é”™è¯¯ä¿¡æ¯ï¼ˆå¦‚æœè¯»å–è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯çš„è¯ï¼‰ï¼Œç¬¬äºŒä¸ªæ˜¯è¯»å–åˆ°çš„æ•°æ®ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-3"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>Hello, Node.js!</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æˆ‘ä»¬æƒ³è¦ä½¿ç”¨ <code>fs.read</code> æ–¹æ³•è¯»å–è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç æ®µï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶è·å–æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å‡†å¤‡ä¸€ä¸ª buffer æ¥æ¥æ”¶è¯»å–åˆ°çš„æ•°æ®</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">1024</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨ fs.read è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">length</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> null</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> num</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // æ‰“å°è¯»å–åˆ°çš„æ•°æ®</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> num</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å®Œæˆåå…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨ <code>fs.open</code> æ–¹æ³•æ‰“å¼€ <code>example.txt</code> æ–‡ä»¶ï¼Œå¹¶è·å–åˆ°è¯¥æ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ <code>fd</code>ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª <code>Buffer</code> å¯¹è±¡ <code>buffer</code> ä½œä¸ºæ•°æ®æ¥æ”¶çš„å®¹å™¨ã€‚æ¥ç€ï¼Œè°ƒç”¨ <code>fs.read</code> æ–¹æ³•ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®åˆ° <code>buffer</code> ä¸­ã€‚æœ€åï¼Œæˆ‘ä»¬é€šè¿‡å›è°ƒå‡½æ•°å°†è¯»å–åˆ°çš„æ•°æ®è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶æ‰“å°å‡ºæ¥ï¼Œæœ€ååˆ«å¿˜äº†å…³é—­æ–‡ä»¶ã€‚</p><p>è¿™ä¸ªè¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ï¼Œæ„å‘³ç€ä»£ç çš„æ‰§è¡Œä¸ä¼šè¢«æš‚åœç­‰å¾…æ–‡ä»¶è¯»å–å®Œæˆï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç ã€‚å½“æ–‡ä»¶è¯»å–å®Œæˆåï¼Œæ‰ä¼šè°ƒç”¨å›è°ƒå‡½æ•°å¤„ç†è¯»å–åˆ°çš„æ•°æ®æˆ–è€…é”™è¯¯ã€‚è¿™æ ·å¯ä»¥æé«˜ç¨‹åºçš„æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç† I/O å¯†é›†å‹æ“ä½œæ—¶ã€‚</p><h3 id="fs-read-fd-buffer-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-read-fd-buffer-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsreadfd-buffer-options-callback" target="_blank" rel="noopener noreferrer">fs.read(fd, buffer[, options], callback)</a></span></a></h3><p>Node.js ä¸­çš„<code>fs.read</code>æ–¹æ³•æ˜¯ç”¨æ¥ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®ã€‚è¿™ä¸ªæ–¹æ³•å¾ˆæœ‰ç”¨ï¼Œå°¤å…¶æ˜¯å½“ä½ éœ€è¦æ›´ç»†ç²’åº¦çš„æ§åˆ¶æ–‡ä»¶è¯»å–è¿‡ç¨‹æ—¶ã€‚è®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥è¯¦ç»†è§£é‡Šè¿™ä¸ªæ–¹æ³•ï¼Œå¹¶é€šè¿‡å®é™…ä¾‹å­æ¥ç†è§£å…¶åº”ç”¨ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-10" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-10"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>åœ¨æ·±å…¥è§£é‡Šä¹‹å‰ï¼Œé¦–å…ˆéœ€è¦ç†è§£å‡ ä¸ªå…³é”®ç‚¹ï¼š</p><ol><li><strong>fd</strong>ï¼šæ–‡ä»¶æè¿°ç¬¦ï¼Œä¸€ä¸ªæŒ‡å‘å·²æ‰“å¼€æ–‡ä»¶çš„å¼•ç”¨ã€‚</li><li><strong>buffer</strong>ï¼šç¼“å†²åŒºï¼Œä¸€ä¸ªä¸´æ—¶å­˜å‚¨è¯»å–æ•°æ®çš„å®¹å™¨ã€‚</li><li><strong>options</strong>ï¼šé€‰é¡¹ï¼Œä¸€ä¸ªå¯¹è±¡ï¼Œå…è®¸ä½ æŒ‡å®šå¦‚ä½•è¯»å–æ–‡ä»¶ï¼ˆä¾‹å¦‚ï¼Œä»å“ªä¸ªä½ç½®å¼€å§‹è¯»å–ï¼‰ã€‚</li><li><strong>callback</strong>ï¼šå›è°ƒå‡½æ•°ï¼Œåœ¨è¯»å–æ“ä½œå®Œæˆåæ‰§è¡Œã€‚</li></ol><h3 id="fs-read-fd-buffer-options-callback-å‚æ•°è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#fs-read-fd-buffer-options-callback-å‚æ•°è¯¦è§£"><span><code>fs.read(fd, buffer[, options], callback)</code> å‚æ•°è¯¦è§£</span></a></h3><ul><li><strong>fd</strong>ï¼šå¿…éœ€ï¼ŒæŒ‡æ˜äº†è¦è¯»å–çš„æ–‡ä»¶çš„æ ‡è¯†ç¬¦ã€‚</li><li><strong>buffer</strong>ï¼šå¿…éœ€ï¼Œæ•°æ®è¯»å–åå­˜å‚¨çš„ç›®æ ‡ç¼“å†²åŒºã€‚</li><li><strong>options</strong>ï¼šå¯é€‰å‚æ•°ï¼ŒåŒ…å«ä¸‰ä¸ªå¯èƒ½çš„å±æ€§ï¼š <ul><li><strong>offset</strong>ï¼šç¼“å†²åŒºå†™å…¥çš„èµ·å§‹ç´¢å¼•ã€‚</li><li><strong>length</strong>ï¼šè¯»å–çš„å­—èŠ‚æ•°ã€‚</li><li><strong>position</strong>ï¼šæ–‡ä»¶è¯»å–çš„èµ·å§‹ä½ç½®ã€‚</li></ul></li><li><strong>callback</strong>ï¼šå½“è¯»å–æ“ä½œå®Œæˆæ—¶ï¼Œä¼šè¢«è°ƒç”¨çš„å‡½æ•°ï¼Œæ¥å—ä»¥ä¸‹å‚æ•°ï¼š <ul><li><strong>err</strong>ï¼šå¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œè¿™å°†æ˜¯ä¸€ä¸ªé”™è¯¯å¯¹è±¡ï¼›å¦åˆ™ä¸º nullã€‚</li><li><strong>bytesRead</strong>ï¼šå®é™…è¯»å–åˆ°çš„å­—èŠ‚æ•°ã€‚</li><li><strong>buffer</strong>ï¼šè¢«æ•°æ®å¡«å……çš„ç¼“å†²åŒºã€‚</li></ul></li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-11" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-11"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º<code>example.txt</code>çš„æ–‡æœ¬æ–‡ä»¶ï¼Œé‡Œé¢çš„å†…å®¹ä¸ºâ€œHello, Node.js!â€ï¼Œæˆ‘ä»¬æƒ³è¯»å–æ–‡ä»¶ä¸­çš„æ•°æ®ã€‚</p><h4 id="ç¤ºä¾‹-1-åŸºæœ¬è¯»å–" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åŸºæœ¬è¯»å–"><span>ç¤ºä¾‹ 1ï¼šåŸºæœ¬è¯»å–</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">14</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åˆ›å»ºä¸€ä¸ªè¶³å¤Ÿå¤§çš„ç¼“å†²åŒº</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">length</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> null</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: Hello, Node.js!</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨<code>fs.open</code>æ‰“å¼€æ–‡ä»¶ä»¥è·å–æ–‡ä»¶æè¿°ç¬¦ï¼ˆ<code>fd</code>ï¼‰ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè¶³å¤Ÿå¤§çš„ç¼“å†²åŒºæ¥å­˜å‚¨æ–‡ä»¶çš„å†…å®¹ã€‚ä½¿ç”¨<code>fs.read</code>è¯»å–æ–‡ä»¶å†…å®¹åˆ°ç¼“å†²åŒºï¼Œå¹¶åœ¨è¯»å–å®Œæˆåè¾“å‡ºå†…å®¹ã€‚æœ€åï¼Œä¸è¦å¿˜è®°å…³é—­æ–‡ä»¶ã€‚</p><h4 id="ç¤ºä¾‹-2-éƒ¨åˆ†è¯»å–" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-éƒ¨åˆ†è¯»å–"><span>ç¤ºä¾‹ 2ï¼šéƒ¨åˆ†è¯»å–</span></a></h4><p>å¦‚æœæˆ‘ä»¬åªå¯¹æ–‡ä»¶çš„ä¸€å°éƒ¨åˆ†æ„Ÿå…´è¶£ï¼Œæ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬åªæƒ³è¯»å–&quot;Hello&quot;ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">5</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åªéœ€è¦5ä¸ªå­—èŠ‚å¤§å°çš„ç¼“å†²åŒº</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä»…è¯»å–æ–‡ä»¶çš„å‰5ä¸ªå­—èŠ‚</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">length</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: Hello</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è®¾ç½®<code>buffer</code>çš„é•¿åº¦ä¸º 5ï¼Œå¹¶åœ¨<code>fs.read</code>ä¸­æŒ‡å®šè¯»å–çš„<code>length</code>ä¸º 5ï¼Œä»è€Œåªè¯»å–æ–‡ä»¶çš„å‰ 5 ä¸ªå­—èŠ‚ã€‚</p><h3 id="æ€»ç»“-9" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-9"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡ä¸Šè¿°ä»‹ç»å’Œç¤ºä¾‹ï¼Œä½ åº”è¯¥å¯¹<code>fs.read</code>æ–¹æ³•æœ‰äº†æ›´æ·±å…¥çš„äº†è§£ã€‚è¿™ç§æ–¹æ³•æä¾›äº†å¯¹æ–‡ä»¶è¯»å–è¿‡ç¨‹çš„ç»†ç²’åº¦æ§åˆ¶ï¼Œéå¸¸é€‚åˆéœ€è¦ç²¾ç¡®æ§åˆ¶ä»æ–‡ä»¶ä¸­è¯»å–ç‰¹å®šæ•°æ®çš„åœºæ™¯ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œè¿™èƒ½å¸®åŠ©ä½ ä¼˜åŒ–æ€§èƒ½å’Œå†…å­˜ä½¿ç”¨ï¼Œå°¤å…¶æ˜¯å¤„ç†å¤§æ–‡ä»¶æ—¶ã€‚</p><h3 id="fs-readdir-path-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-readdir-path-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsreaddirpath-options-callback" target="_blank" rel="noopener noreferrer">fs.readdir(path[, options], callback)</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code>æ¨¡å—æ˜¯ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ä¸€ä¸ªéå¸¸é‡è¦å’ŒåŸºæœ¬çš„æ¨¡å—ã€‚å…¶ä¸­ï¼Œ<code>fs.readdir()</code>å‡½æ•°æ˜¯è¿™ä¸ªæ¨¡å—æä¾›çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨äºè¯»å–ç›®å½•çš„å†…å®¹ï¼Œå³åˆ—å‡ºä¸€ä¸ªæ–‡ä»¶å¤¹å†…çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•åã€‚</p><h3 id="è¯¦ç»†è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#è¯¦ç»†è§£é‡Š"><span>è¯¦ç»†è§£é‡Šï¼š</span></a></h3><p><code>fs.readdir(path[, options], callback)</code>æ¥å—ä¸‰ä¸ªå‚æ•°ï¼š</p><ol><li><strong>path</strong>ï¼šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¦è¯»å–å†…å®¹çš„ç›®å½•è·¯å¾„ã€‚</li><li><strong>options</strong>ï¼ˆå¯é€‰ï¼‰ï¼šå¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–å­—ç¬¦ä¸²ï¼Œç”¨æ¥æŒ‡å®šå¦‚ä½•æ ¼å¼åŒ–è¿”å›çš„ç›®å½•é¡¹åç§°åˆ—è¡¨ã€‚å¦‚æœä¸ä¼ é€’è¿™ä¸ªå‚æ•°ï¼Œé»˜è®¤è¿”å›æ–‡ä»¶å’Œç›®å½•çš„ç®€å•åç§°æ•°ç»„ã€‚ <ul><li>å¦‚æœ<code>options</code>æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆå®ƒç­‰åŒäº<code>{ encoding: options }</code>ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ ä¼ å…¥<code>&#39;utf8&#39;</code>ï¼Œé‚£å°±æ˜¯æŒ‡å®šç¼–ç ä¸º UTF-8ã€‚</li><li><code>options</code>å¯¹è±¡å¯ä»¥æœ‰ä»¥ä¸‹å±æ€§ï¼š <ul><li><code>encoding</code>ï¼šæŒ‡å®šå­—ç¬¦ç¼–ç ï¼Œé»˜è®¤æ˜¯<code>&#39;utf8&#39;</code>ã€‚</li><li><code>withFileTypes</code>ï¼šå¦‚æœè®¾ç½®ä¸º<code>true</code>ï¼Œåˆ™ç»“æœå°†ä»¥<code>fs.Dirent</code>å¯¹è±¡æ•°ç»„å½¢å¼è¿”å›ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²æ•°ç»„ã€‚è¿™å…è®¸ä½ åŒºåˆ†ç›®å½•ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•ï¼Œè€Œä¸éœ€è¦å†æ¬¡è°ƒç”¨<code>fs.stat()</code>ã€‚</li></ul></li></ul></li><li><strong>callback</strong>ï¼šä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“<code>readdir</code>æ“ä½œå®Œæˆæ—¶è¢«è°ƒç”¨ï¼Œæ¥å—ä¸¤ä¸ªå‚æ•°ï¼š<code>error</code>å’Œ<code>files</code>ã€‚<code>error</code>æ˜¯åœ¨è¯»å–ç›®å½•è¿‡ç¨‹ä¸­é‡åˆ°çš„ä»»ä½•é”™è¯¯ï¼Œ<code>files</code>æ˜¯ä¸€ä¸ªåŒ…å«ç›®å½•ä¸­æ–‡ä»¶åçš„æ•°ç»„ï¼ˆå¦‚æœä½¿ç”¨äº†<code>withFileTypes</code>é€‰é¡¹ï¼Œåˆ™æ˜¯<code>fs.Dirent</code>å¯¹è±¡çš„æ•°ç»„ï¼‰ã€‚</li></ol><h3 id="å®é™…ä¾‹å­-6" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-6"><span>å®é™…ä¾‹å­ï¼š</span></a></h3><h4 id="_1-åŸºæœ¬ç¤ºä¾‹-åˆ—å‡ºç›®å½•å†…å®¹" tabindex="-1"><a class="header-anchor" href="#_1-åŸºæœ¬ç¤ºä¾‹-åˆ—å‡ºç›®å½•å†…å®¹"><span>1. åŸºæœ¬ç¤ºä¾‹ - åˆ—å‡ºç›®å½•å†…å®¹</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æŒ‡å®šè¦è¯»å–çš„ç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> directoryPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è¯»å–ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> files</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–ç›®å½•å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•å†…å®¹:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> files</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šåˆ—å‡ºå½“å‰ç›®å½•(<code>&#39;./&#39;</code>)ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•çš„åç§°ã€‚</p><h4 id="_2-ä½¿ç”¨withfiletypesé€‰é¡¹-åŒºåˆ†æ–‡ä»¶å’Œç›®å½•" tabindex="-1"><a class="header-anchor" href="#_2-ä½¿ç”¨withfiletypesé€‰é¡¹-åŒºåˆ†æ–‡ä»¶å’Œç›®å½•"><span>2. ä½¿ç”¨<code>withFileTypes</code>é€‰é¡¹ - åŒºåˆ†æ–‡ä»¶å’Œç›®å½•</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æŒ‡å®šè¦è¯»å–çš„ç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> directoryPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è¯»å–ç›®å½•ï¼Œå¹¶è·å–æ–‡ä»¶ç±»å‹ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> withFileTypes</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> files</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–ç›®å½•å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  files</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forEach</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">file</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">file</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isDirectory</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">file</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> æ˜¯ä¸€ä¸ªç›®å½•</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#81A1C1;"> else</span><span style="color:#81A1C1;"> if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">file</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFile</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">file</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> æ˜¯ä¸€ä¸ªæ–‡ä»¶</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¸ä»…åˆ—å‡ºäº†å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰é¡¹ç›®ï¼Œè€Œä¸”è¿˜é€šè¿‡æ£€æŸ¥æ¯ä¸ªé¡¹ç›®æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•æ¥æä¾›é¢å¤–çš„ä¿¡æ¯ã€‚</p><p>é€šè¿‡<code>fs.readdir()</code>æ–¹æ³•ï¼Œä½ å¯ä»¥å®ç°å¾ˆå¤šåŠŸèƒ½ï¼Œæ¯”å¦‚è‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬ã€æ–‡ä»¶ç®¡ç†å™¨ã€é™æ€æ–‡ä»¶æœåŠ¡å™¨ç­‰åº”ç”¨åœºæ™¯ï¼Œè¿™ä½¿å¾—å®ƒæˆä¸º Node.js å¼€å‘ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚</p><h3 id="fs-readfile-path-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-readfile-path-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsreadfilepath-options-callback" target="_blank" rel="noopener noreferrer">fs.readFile(path[, options], callback)</a></span></a></h3><p><code>fs.readFile</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå±äº <code>fs</code> æ¨¡å—ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ã€‚è¿™ä¸ªå‡½æ•°ç”¨äºå¼‚æ­¥åœ°è¯»å–æ–‡ä»¶çš„å†…å®¹ã€‚</p><p>ä¸‹é¢æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹ <code>fs.readFile</code> å‡½æ•°çš„å„ä¸ªéƒ¨åˆ†ï¼Œå¹¶ç»™å‡ºå®é™…è¿ç”¨çš„ä¾‹å­ã€‚</p><h3 id="å‚æ•°è§£é‡Š-16" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-16"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>path</code>: è¿™æ˜¯ä½ æƒ³è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚å®ƒå¯ä»¥æ˜¯å­—ç¬¦ä¸²ï¼ˆæ¯”å¦‚ <code>&#39;./file.txt&#39;</code>ï¼‰ï¼Œè¡¨ç¤ºæ–‡ä»¶çš„è·¯å¾„ï¼›æˆ–è€…æ˜¯ä¸€ä¸ª Buffer å¯¹è±¡ï¼Œä»£è¡¨äº†æ–‡ä»¶è·¯å¾„çš„äºŒè¿›åˆ¶æ•°æ®ã€‚</li><li><code>options</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå¯ä»¥æ§åˆ¶è¯»å–æ–‡ä»¶çš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥è®¾ç½®æ–‡ä»¶çš„å­—ç¬¦ç¼–ç ç±»å‹ï¼ˆæ¯”å¦‚ <code>utf8</code>ï¼‰ï¼Œè¿™æ ·è¯»å–çš„ç»“æœå°±ä¼šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²è€Œä¸æ˜¯äºŒè¿›åˆ¶æ•°æ®ã€‚</li><li><code>callback</code>: è¿™æ˜¯ä¸€ä¸ªåœ¨è¯»å–æ–‡ä»¶å®Œæˆåä¼šè¢«è°ƒç”¨çš„å‡½æ•°ã€‚å®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼šé”™è¯¯å¯¹è±¡ <code>err</code> å’Œæ–‡ä»¶å†…å®¹ <code>data</code>ã€‚å¦‚æœè¯»å–è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ï¼Œ<code>err</code> ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼›å¦‚æœè¯»å–æˆåŠŸï¼Œåˆ™ <code>err</code> ä¸º <code>null</code>ï¼Œ<code>data</code> åŒ…å«äº†æ–‡ä»¶çš„å†…å®¹ã€‚</li></ul><h3 id="ä»£ç ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#ä»£ç ç¤ºä¾‹-1"><span>ä»£ç ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>Hello, Node.js!</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æˆ‘ä»¬æƒ³è¦è¯»å–è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹å¹¶å°†å…¶æ‰“å°åˆ°æ§åˆ¶å°ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨ <code>fs.readFile</code> å®Œæˆè¿™ä¸ªä»»åŠ¡çš„ä»£ç ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å¼•å…¥ fs æ¨¡å—</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fs.readFile è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯å¹¶é€€å‡º</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error reading file:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#616E88;">  // æ‰“å°æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼š</p><ol><li>æˆ‘ä»¬é¦–å…ˆé€šè¿‡ <code>require</code> å¼•å…¥äº† <code>fs</code> æ¨¡å—ã€‚</li><li>ç„¶åï¼Œæˆ‘ä»¬è°ƒç”¨äº† <code>fs.readFile</code> å‡½æ•°ï¼Œä¼ é€’äº†æ–‡ä»¶è·¯å¾„ <code>&#39;example.txt&#39;</code>ï¼Œè®¾ç½®å­—ç¬¦ç¼–ç ä¸º <code>&#39;utf8&#39;</code>ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚</li><li>åœ¨å›è°ƒå‡½æ•°å†…ï¼Œå¦‚æœå‘ç”Ÿé”™è¯¯ï¼ˆ<code>err</code> ä¸ä¸º <code>null</code>ï¼‰ï¼Œæˆ‘ä»¬æ‰“å°é”™è¯¯ä¿¡æ¯å¹¶è¿”å›ï¼›å¦åˆ™ï¼Œæ‰“å°å‡ºæ–‡ä»¶å†…å®¹ï¼ˆ<code>data</code>ï¼‰ã€‚</li></ol><p>åªè¦è¿è¡Œè¿™æ®µä»£ç ï¼ŒNode.js å°±ä¼šè¯»å–å½“å‰ç›®å½•ä¸‹çš„ <code>example.txt</code> æ–‡ä»¶ï¼Œå¹¶åœ¨æ§åˆ¶å°è¾“å‡ºå…¶å†…å®¹ã€‚</p><p>è¿™ä¸ªå‡½æ•°éå¸¸é€‚åˆç”¨äºéœ€è¦ä»æ–‡ä»¶ä¸­è·å–å†…å®¹å¹¶è¿›è¡Œå¤„ç†çš„åœºæ™¯ï¼Œæ¯”å¦‚é…ç½®æ–‡ä»¶çš„è¯»å–ã€æ—¥å¿—æ–‡ä»¶çš„åˆ†æç­‰ã€‚ç”±äºå®ƒæ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œæ‰€ä»¥ä¸ä¼šé˜»å¡ç¨‹åºçš„å…¶ä»–æ“ä½œï¼Œè¿™åœ¨å¤„ç†å¤§æ–‡ä»¶æˆ–åœ¨é«˜æ€§èƒ½æœåŠ¡å™¨ä¸Šæ—¶å°¤å…¶é‡è¦ã€‚</p><h4 id="file-descriptors" tabindex="-1"><a class="header-anchor" href="#file-descriptors"><span><a href="https://nodejs.org/docs/latest/api/fs.html#file-descriptors" target="_blank" rel="noopener noreferrer">File descriptors</a></span></a></h4><p>å½“æˆ‘ä»¬è°ˆè®º Node.js ä¸­çš„â€œFile Descriptorsâ€ï¼ˆæ–‡ä»¶æè¿°ç¬¦ï¼‰æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨è®¨è®ºä¸€ä¸ªéå¸¸åº•å±‚çš„æ¦‚å¿µï¼Œå®ƒä¸æ“ä½œç³»ç»Ÿç´§å¯†ç›¸å…³ã€‚ä½†ä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä¼šå°½é‡ç®€åŒ–è¿™ä¸ªæ¦‚å¿µï¼Œå¹¶é€šè¿‡ä¸€äº›ä¾‹å­æ¥å¸®ä½ ç†è§£ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯æ–‡ä»¶æè¿°ç¬¦" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯æ–‡ä»¶æè¿°ç¬¦"><span>ä»€ä¹ˆæ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼Ÿ</span></a></h3><p>æ–‡ä»¶æè¿°ç¬¦æ˜¯æ“ä½œç³»ç»Ÿåˆ†é…ç»™æ‰“å¼€çš„æ–‡ä»¶æˆ–å…¶ä»–èµ„æºï¼ˆå¦‚å¥—æ¥å­—ã€ç®¡é“ç­‰ï¼‰çš„ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦ã€‚åœ¨å¤§å¤šæ•°ç±» Unix æ“ä½œç³»ç»Ÿï¼ˆåŒ…æ‹¬ Linux å’Œ macOSï¼‰ä¸­ï¼Œæ–‡ä»¶æè¿°ç¬¦é€šå¸¸è¡¨ç¤ºä¸ºéè´Ÿæ•´æ•°ã€‚ä¾‹å¦‚ï¼Œå½“ç¨‹åºæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œè¯¥ç¨‹åºå¯ä»¥é€šè¿‡è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦æ¥è¯»å†™æ–‡ä»¶ã€‚</p><p>æ–‡ä»¶æè¿°ç¬¦ä¸»è¦æœ‰ä¸‰ä¸ªåŸºæœ¬çš„ï¼š0ã€1 å’Œ 2ï¼Œåˆ†åˆ«ä»£è¡¨æ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰ã€æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰å’Œæ ‡å‡†é”™è¯¯ï¼ˆstderrï¼‰ã€‚è¿™æ„å‘³ç€å½“ä½ ä»é”®ç›˜è¾“å…¥æ•°æ®æ—¶ï¼Œä½ å®é™…ä¸Šæ˜¯å‘æ–‡ä»¶æè¿°ç¬¦ 0 å†™å…¥æ•°æ®ï¼›å½“ä½ çš„ç¨‹åºæ‰“å°ä¸œè¥¿åˆ°ç»ˆç«¯æ—¶ï¼Œå®ƒå®é™…ä¸Šæ˜¯å‘æ–‡ä»¶æè¿°ç¬¦ 1 å†™å…¥æ•°æ®ï¼›é”™è¯¯æ¶ˆæ¯åˆ™æ˜¯è¢«å†™å…¥åˆ°æ–‡ä»¶æè¿°ç¬¦ 2ã€‚</p><h3 id="åœ¨-node-js-ä¸­å¦‚ä½•ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦" tabindex="-1"><a class="header-anchor" href="#åœ¨-node-js-ä¸­å¦‚ä½•ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦"><span>åœ¨ Node.js ä¸­å¦‚ä½•ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦ï¼Ÿ</span></a></h3><p>Node.js æä¾›äº†ä¸€å¥—æ“ä½œæ–‡ä»¶çš„ APIï¼Œè¿™äº› API ç»å¤§éƒ¨åˆ†éƒ½ä½äº<code>fs</code>æ¨¡å—å†…ï¼ˆFile System æ¨¡å—ï¼‰ã€‚åœ¨ Node.js ä¸­å¤„ç†æ–‡ä»¶æ—¶ï¼Œå¾ˆå¤šæ–¹æ³•éƒ½æœ‰åŒæ­¥å’Œå¼‚æ­¥ä¸¤ç§å½¢å¼ã€‚å¼‚æ­¥ç‰ˆæœ¬å‡½æ•°é€šå¸¸éœ€è¦å›è°ƒå‡½æ•°ï¼Œè€ŒåŒæ­¥ç‰ˆæœ¬åˆ™ç›´æ¥è¿”å›ç»“æœæˆ–æŠ›å‡ºå¼‚å¸¸ã€‚</p><h4 id="å®é™…è¿ç”¨ä¾‹å­-16" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-16"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º<code>example.txt</code>çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬æƒ³è¦è¯»å–è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚</p><ol><li><strong>æ‰“å¼€æ–‡ä»¶</strong>ï¼š</li></ol><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ‰“å¼€æ–‡ä»¶ä»¥è·å–æ–‡ä»¶æè¿°ç¬¦ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶æè¿°ç¬¦ä¸º: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">fd</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // ç¡®ä¿åœ¨è¿™é‡Œä½¿ç”¨fdï¼ˆæ–‡ä»¶æè¿°ç¬¦ï¼‰è¿›è¡Œå…¶ä»–æ“ä½œï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œ<code>&#39;r&#39;</code>è¡¨ç¤ºä»¥è¯»å–æ¨¡å¼æ‰“å¼€æ–‡ä»¶ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œå›è°ƒå‡½æ•°å°†æ¥æ”¶åˆ°æ–‡ä»¶æè¿°ç¬¦<code>fd</code>ã€‚</p><ol start="2"><li><strong>ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦è¯»å–æ–‡ä»¶</strong>:</li></ol><p>è·å–æ–‡ä»¶æè¿°ç¬¦åï¼Œä½ å¯ä»¥åˆ©ç”¨å®ƒæ¥è¿›è¡Œè¯»å–æ“ä½œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å‡å®šfdæ˜¯ä»fs.openè·å–çš„æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">1024</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åˆ›å»ºä¸€ä¸ªBufferæ¥å­˜å‚¨è¯»å–çš„æ•°æ®</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">length</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> bytes</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // å¦‚æœè¯»å–æˆåŠŸï¼Œbytesè¡¨ç¤ºè¯»å–çš„å­—èŠ‚æ•°</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">è¯»å–äº†</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">bytes</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">å­—èŠ‚</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // åªè¾“å‡ºè¯»å–çš„å­—èŠ‚</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">bytes</span><span style="color:#81A1C1;"> &gt;</span><span style="color:#B48EAD;"> 0</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">slice</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> bytes</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#616E88;">  // å½“å®Œæˆæ‰€æœ‰æ“ä½œåï¼Œä¸è¦å¿˜è®°å…³é—­æ–‡ä»¶ï¼</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªç¼“å†²åŒº<code>buffer</code>æ¥æ¥æ”¶ä»æ–‡ä»¶ä¸­è¯»å–çš„æ•°æ®ã€‚<code>fs.read</code>æ–¹æ³•å…è®¸æˆ‘ä»¬æŒ‡å®šä»å“ªé‡Œå¼€å§‹è¯»å–æ•°æ®ï¼ˆåœ¨è¿™é‡Œæ˜¯æ–‡ä»¶çš„å¼€å§‹ä½ç½®ï¼‰ï¼Œè¦è¯»å–å¤šå°‘æ•°æ®ï¼ˆé€šè¿‡<code>buffer.length</code>æŒ‡å®šï¼‰ï¼Œä»¥åŠè¯»å–æ“ä½œå®Œæˆæ—¶è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚</p><h3 id="å°ç»“-6" tabindex="-1"><a class="header-anchor" href="#å°ç»“-6"><span>å°ç»“</span></a></h3><p>æ–‡ä»¶æè¿°ç¬¦æ˜¯æ“ä½œç³»ç»Ÿå±‚é¢å¯¹äºæ–‡ä»¶å’Œå…¶ä»–èµ„æºçš„æŠ½è±¡ï¼Œå®ƒåœ¨ Node.js ä¸­é€šè¿‡<code>fs</code>æ¨¡å—å¾—ä»¥å¹¿æ³›ä½¿ç”¨ã€‚é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ°å¦‚ä½•æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ¥è·å–å…¶æ–‡ä»¶æè¿°ç¬¦ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨è¿™ä¸ªæè¿°ç¬¦è¿›è¡Œè¯»å–æ“ä½œã€‚æŒæ¡äº†å¯¹æ–‡ä»¶æè¿°ç¬¦çš„ä½¿ç”¨ï¼Œå°±èƒ½æ›´çµæ´»åœ°æ“ä½œæ–‡ä»¶ç³»ç»Ÿï¼Œä¸ºé«˜çº§åº”ç”¨æ‰“ä¸‹åŸºç¡€ã€‚</p><h4 id="performance-considerations" tabindex="-1"><a class="header-anchor" href="#performance-considerations"><span><a href="https://nodejs.org/docs/latest/api/fs.html#performance-considerations" target="_blank" rel="noopener noreferrer">Performance Considerations</a></span></a></h4><p>ç†è§£ Node.js ä¸­çš„æ€§èƒ½è€ƒè™‘ç‰¹åˆ«æ˜¯åœ¨æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code> æ¨¡å—ï¼‰æ–¹é¢ï¼Œå¯¹ä»»ä½•å¼€å‘è€…æ¥è¯´éƒ½æ˜¯éå¸¸é‡è¦çš„ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬ææ¸…æ¥š Node.js æ˜¯ä»€ä¹ˆã€‚</p><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨å®ƒæ¥ç¼–å†™èƒ½å¤Ÿä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’ã€å¤„ç†ç½‘ç»œè¯·æ±‚ç­‰çš„æœåŠ¡å™¨ç¨‹åºã€‚</p><p>åœ¨ v21.7.1 çš„æ–‡æ¡£ä¸­æåˆ°çš„â€œæ€§èƒ½è€ƒè™‘â€ä¸»è¦å…³æ³¨çš„æ˜¯å¦‚ä½•æœ‰æ•ˆåœ°ä½¿ç”¨ <code>fs</code>ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰æ¨¡å—ï¼Œå› ä¸ºä¸å½“çš„ä½¿ç”¨å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°±è¯¦ç»†æ·±å…¥åœ°äº†è§£ä¸‹ã€‚</p><h3 id="åŒæ­¥-vs-å¼‚æ­¥" tabindex="-1"><a class="header-anchor" href="#åŒæ­¥-vs-å¼‚æ­¥"><span>åŒæ­¥ vs å¼‚æ­¥</span></a></h3><p>Node.js <code>fs</code> æ¨¡å—æä¾›äº†åŒæ­¥å’Œå¼‚æ­¥ä¸¤ç§æ“ä½œæ–¹å¼ã€‚åŒæ­¥æ“ä½œä¼šé˜»å¡ä»£ç æ‰§è¡Œï¼ˆå³ï¼Œåœ¨æ–‡ä»¶æ“ä½œå®Œæˆä¹‹å‰ï¼Œå…¶ä»–ä»£ç éƒ½ä¸ä¼šæ‰§è¡Œï¼‰ï¼Œè€Œå¼‚æ­¥æ“ä½œåˆ™ä¸ä¼šé˜»å¡ä»£ç æ‰§è¡Œã€‚</p><ul><li><p><strong>å¼‚æ­¥æ“ä½œ</strong>ï¼šæ›´æ¨èä½¿ç”¨å¼‚æ­¥ APIï¼Œå› ä¸ºå®ƒä»¬ä¸ä¼šé˜»å¡äº‹ä»¶å¾ªç¯ã€‚è¿™å¯¹äºä¿æŒåº”ç”¨çš„å“åº”é€Ÿåº¦æ˜¯è‡³å…³é‡è¦çš„ã€‚ä¾‹å¦‚, <code>fs.readFile()</code> å°±æ˜¯ä¸€ç§å¼‚æ­¥æ–¹æ³•ï¼Œå®ƒåœ¨è¯»å–æ–‡ä»¶å†…å®¹åï¼Œé€šè¿‡å›è°ƒå‡½æ•°è¿”å›æ•°æ®ã€‚</p></li><li><p><strong>åŒæ­¥æ“ä½œ</strong>ï¼šåœ¨æŸäº›ç‰¹å®šåœºæ™¯ä¸‹ï¼Œå¦‚åˆå§‹åŒ–é…ç½®æ—¶ï¼ŒåŒæ­¥æ“ä½œå¯èƒ½æ˜¯å¿…é¡»çš„ã€‚ä½†å®ƒä»¬åº”è¯¥è°¨æ…ä½¿ç”¨ï¼Œå› ä¸ºå®ƒä»¬ä¼šå½±å“åº”ç”¨æ€§èƒ½ã€‚ä¾‹å¦‚, <code>fs.readFileSync()</code> ä¼šåœ¨è¿”å›æ–‡ä»¶å†…å®¹å‰é˜»å¡ä»£ç çš„è¿›ä¸€æ­¥æ‰§è¡Œã€‚</p></li></ul><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-7" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-7"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><h4 id="å¼‚æ­¥è¯»å–æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#å¼‚æ­¥è¯»å–æ–‡ä»¶"><span>å¼‚æ­¥è¯»å–æ–‡ä»¶</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>fs.readFile</code> æ–¹æ³•ä»¥å¼‚æ­¥çš„æ–¹å¼è¯»å–æ–‡ä»¶ã€‚è¿™æ„å‘³ç€ç¨‹åºå¯ä»¥ç»§ç»­æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œè€Œä¸éœ€è¦ç­‰å¾…æ–‡ä»¶è¯»å–å®Œæˆã€‚</p><h4 id="åŒæ­¥è¯»å–æ–‡ä»¶-1" tabindex="-1"><a class="header-anchor" href="#åŒæ­¥è¯»å–æ–‡ä»¶-1"><span>åŒæ­¥è¯»å–æ–‡ä»¶</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åŒæ­¥è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å±•ç¤ºäº†å¦‚ä½•ä»¥åŒæ­¥æ–¹å¼è¯»å–æ–‡ä»¶ã€‚åœ¨æ–‡ä»¶è¯»å–å®Œæˆå¹¶å°†å†…å®¹å­˜å‚¨åœ¨ <code>data</code> å˜é‡ä¹‹å‰ï¼Œç¨‹åºä¼šæš‚åœæ‰§è¡Œã€‚å¦‚æœæ–‡ä»¶å¾ˆå¤§æˆ–è¯»å–è¿‡ç¨‹å¾ˆæ…¢ï¼Œè¿™å¯èƒ½ä¼šæ˜¾è‘—å½±å“ç¨‹åºçš„å“åº”é€Ÿåº¦ã€‚</p><h3 id="æ€§èƒ½æŠ€å·§" tabindex="-1"><a class="header-anchor" href="#æ€§èƒ½æŠ€å·§"><span>æ€§èƒ½æŠ€å·§</span></a></h3><ul><li>å°½å¯èƒ½ä½¿ç”¨å¼‚æ­¥ APIï¼Œé¿å…é˜»å¡äº‹ä»¶å¾ªç¯ã€‚</li><li>åœ¨è¯»å–å¤§æ–‡ä»¶æ—¶è€ƒè™‘ä½¿ç”¨æµï¼ˆStreamsï¼‰ï¼Œè¿™æ ·å¯ä»¥åˆ†å—è¯»å–æ–‡ä»¶ï¼Œå‡å°‘å†…å­˜å ç”¨ã€‚</li><li>å¯¹é¢‘ç¹è®¿é—®çš„æ–‡ä»¶ï¼Œè€ƒè™‘å®ç°ç¼“å­˜æœºåˆ¶ï¼Œä»¥å‡å°‘é‡å¤çš„æ–‡ä»¶è¯»å–æ“ä½œã€‚</li></ul><p>æ€»ä¹‹ï¼Œæ­£ç¡®åœ°ä½¿ç”¨ <code>fs</code> æ¨¡å—æ˜¯éå¸¸å…³é”®çš„ã€‚å¼‚æ­¥æ“ä½œã€åˆç†ä½¿ç”¨åŒæ­¥æ“ä½œã€åˆ©ç”¨æµæ¥å¤„ç†å¤§æ–‡ä»¶ã€å®ç°ç¼“å­˜ç­–ç•¥ç­‰éƒ½æ˜¯æé«˜åº”ç”¨æ€§èƒ½çš„æœ‰åŠ›æ‰‹æ®µã€‚</p><h3 id="fs-readlink-path-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-readlink-path-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsreadlinkpath-options-callback" target="_blank" rel="noopener noreferrer">fs.readlink(path[, options], callback)</a></span></a></h3><p>å½“æˆ‘ä»¬è°ˆè®º Node.js ä¸­çš„<code>fs.readlink</code>æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬å…¶å®æ˜¯åœ¨è®¨è®ºå¦‚ä½•è¯»å–ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿé“¾æ¥ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªç¬¦å·é“¾æ¥ï¼‰æ‰€æŒ‡å‘çš„åŸå§‹è·¯å¾„ã€‚è¿™åœ¨ç®¡ç†æ–‡ä»¶å’Œæ–‡ä»¶å¤¹æ—¶ç‰¹åˆ«æœ‰ç”¨ï¼Œå°¤å…¶æ˜¯å½“ä½ éœ€è¦å¤„ç†å¤æ‚çš„æ–‡ä»¶ç»“æ„æˆ–è€…ä»…ä»…æƒ³äº†è§£ä¸€ä¸ªé“¾æ¥æŒ‡å‘å“ªé‡Œã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-11" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-11"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>é¦–å…ˆï¼Œäº†è§£å‡ ä¸ªåŸºç¡€æ¦‚å¿µå¯¹ç†è§£<code>fs.readlink</code>æœ‰å¾ˆå¤§å¸®åŠ©ï¼š</p><ul><li><strong>æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰</strong>ï¼šè¿™æ˜¯æ“ä½œç³»ç»Ÿç”¨æ¥å­˜å‚¨ã€ç»„ç»‡å’Œç®¡ç†æ–‡ä»¶çš„æ–¹å¼ã€‚</li><li><strong>ç¬¦å·é“¾æ¥ï¼ˆSymbolic Linkï¼Œä¹Ÿç§°è½¯é“¾æ¥ï¼‰</strong>ï¼šè¿™æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ–‡ä»¶ï¼Œå…¶å†…å®¹ä¸ºå¦ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„å¼•ç”¨ã€‚å¯ä»¥çœ‹ä½œæ˜¯å¯¹å¦ä¸€ä¸ªæ–‡ä»¶çš„å¿«æ·æ–¹å¼ã€‚</li></ul><h3 id="fs-readlink-è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#fs-readlink-è§£é‡Š"><span><code>fs.readlink</code> è§£é‡Š</span></a></h3><p>Node.js çš„<code>fs</code>æ¨¡å—æä¾›äº†ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„ APIï¼Œå…¶ä¸­<code>readlink</code>å‡½æ•°ç”¨äºè¯»å–ç¬¦å·é“¾æ¥çš„å€¼â€”â€”å³ï¼Œå®ƒä¼šå‘Šè¯‰ä½ é“¾æ¥æŒ‡å‘å“ªä¸ªæ–‡ä»¶æˆ–ç›®å½•ã€‚</p><p><code>fs.readlink</code>çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readlink</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">[</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> options</span><span style="color:#D8DEE9FF;">]</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> callback</span><span style="color:#D8DEE9FF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>path</code>ï¼šè¿™æ˜¯ä½ æƒ³è¦è¯»å–çš„ç¬¦å·é“¾æ¥çš„è·¯å¾„ã€‚</li><li><code>options</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…è®¸ä½ æŒ‡å®šä¸€äº›é€‰é¡¹ï¼Œæ¯”å¦‚è¿”å›ç»“æœçš„æ ¼å¼ï¼ˆé»˜è®¤æ˜¯å­—ç¬¦ä¸²å½¢å¼ï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯ Buffer å¯¹è±¡ï¼‰ã€‚</li><li><code>callback</code>ï¼šå½“<code>readlink</code>æ“ä½œå®Œæˆåï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚å®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š<code>error</code>å’Œ<code>result</code>ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œ<code>error</code>ä¼šæ˜¯<code>null</code>ï¼Œè€Œ<code>result</code>å°†åŒ…å«é“¾æ¥æŒ‡å‘çš„è·¯å¾„ã€‚</li></ul><h3 id="å®é™…ä¾‹å­-7" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-7"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªæŒ‡å‘æŸä¸ªæ—¥å¿—æ–‡ä»¶çš„ç¬¦å·é“¾æ¥<code>log-link</code>ï¼Œä½ æƒ³æ‰¾å‡ºè¿™ä¸ªé“¾æ¥æŒ‡å‘çš„çœŸå®æ—¥å¿—æ–‡ä»¶è·¯å¾„ã€‚</p><ol><li><strong>åˆ›å»ºç¬¦å·é“¾æ¥å’Œç›®æ ‡æ–‡ä»¶</strong>ï¼ˆä¸ºäº†ç¤ºä¾‹ï¼Œå‡è®¾å·²ç»å­˜åœ¨ï¼‰</li></ol><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">ln</span><span style="color:#A3BE8C;"> -s</span><span style="color:#A3BE8C;"> /path/to/actual/log/file.log</span><span style="color:#A3BE8C;"> log-link</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li><strong>ä½¿ç”¨<code>fs.readlink</code>è¯»å–ç¬¦å·é“¾æ¥</strong></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨fs.readlinkè¯»å–ç¬¦å·é“¾æ¥æŒ‡å‘çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readlink</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">log-link</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> linkString</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–é“¾æ¥å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // è¾“å‡ºé“¾æ¥æŒ‡å‘çš„çœŸå®è·¯å¾„</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç¬¦å·é“¾æ¥æŒ‡å‘:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> linkString</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­ä¼šè¾“å‡º<code>log-link</code>ç¬¦å·é“¾æ¥æŒ‡å‘çš„å®é™…æ–‡ä»¶è·¯å¾„ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥æ–¹ä¾¿åœ°å¤„ç†å’Œè¿½è¸ªç¬¦å·é“¾æ¥ï¼Œæ— è®ºæ˜¯è¿›è¡Œç³»ç»Ÿç»´æŠ¤ã€æ•°æ®è¿ç§»è¿˜æ˜¯ç®€å•çš„å¥½å¥‡å¿ƒæ¢ç´¢ï¼Œ<code>fs.readlink</code>éƒ½èƒ½æ´¾ä¸Šç”¨åœºã€‚</p><h3 id="fs-readv-fd-buffers-position-callback" tabindex="-1"><a class="header-anchor" href="#fs-readv-fd-buffers-position-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsreadvfd-buffers-position-callback" target="_blank" rel="noopener noreferrer">fs.readv(fd, buffers[, position], callback)</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹ <code>fs.readv()</code> è¿™ä¸ªå‡½æ•°æ˜¯åšä»€ä¹ˆç”¨çš„ï¼Œå¹¶ä¸”ç»™ä½ å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ã€‚</p><h3 id="fs-readv-å‡½æ•°çš„ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#fs-readv-å‡½æ•°çš„ä½œç”¨"><span>fs.readv() å‡½æ•°çš„ä½œç”¨</span></a></h3><p><code>fs.readv()</code> æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿï¼ˆfs æ¨¡å—ï¼‰ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒå¯ä»¥è®©ä½ ä»æ–‡ä»¶æè¿°ç¬¦æŒ‡å®šçš„æ–‡ä»¶ä¸­è¯»å–æ•°æ®åˆ°ä¸€ä¸ªæ•°ç»„çš„å¤šä¸ª Buffer æˆ–è€… TypedArray å¯¹è±¡ä¸­ã€‚è¿™æ˜¯ä¸€ç§ç§°ä¸ºâ€œå‘é‡åŒ– I/Oâ€æˆ–è€…â€œæ•£å¸ƒ/èšé›† I/Oâ€çš„é«˜çº§æŠ€æœ¯ï¼Œå¯ä»¥æé«˜å¤„ç†å¤šä¸ªä¸è¿ç»­ç¼“å†²åŒºçš„æ•ˆç‡ã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>fd</code>: æ–‡ä»¶æè¿°ç¬¦ï¼Œè¿™æ˜¯ä¸€ä¸ªå”¯ä¸€æ ‡è¯†æ‰“å¼€æ–‡ä»¶çš„æ•°å­—ã€‚</li><li><code>buffers</code>: ä¸€ä¸ªç”± Buffer æˆ–è€… TypedArray å¯¹è±¡ç»„æˆçš„æ•°ç»„ï¼Œæ•°æ®å°†ä¼šè¢«è¯»å–åˆ°è¿™äº›å¯¹è±¡ä¸­ã€‚</li><li><code>position</code>: ä»æ–‡ä»¶å¼€å§‹çš„ä½ç½®è¿›è¡Œè¯»å–ï¼Œå¦‚æœè®¾ä¸º <code>null</code>ï¼Œåˆ™ä»å½“å‰ä½ç½®è¯»å–ã€‚</li><li><code>callback</code>: ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œåœ¨è¯»å–å®Œæˆåè¢«è°ƒç”¨ï¼Œå®ƒæœ‰é”™è¯¯ä¿¡æ¯ã€è¯»å–çš„å­—èŠ‚æ•°å’Œç¼“å†²åŒºæ•°ç»„ä½œä¸ºå‚æ•°ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-5"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><h4 id="ç¤ºä¾‹-1-è¯»å–æ–‡æœ¬æ–‡ä»¶çš„ä¸¤éƒ¨åˆ†åˆ°ä¸åŒçš„-buffers-ä¸­" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-è¯»å–æ–‡æœ¬æ–‡ä»¶çš„ä¸¤éƒ¨åˆ†åˆ°ä¸åŒçš„-buffers-ä¸­"><span>ç¤ºä¾‹ 1ï¼šè¯»å–æ–‡æœ¬æ–‡ä»¶çš„ä¸¤éƒ¨åˆ†åˆ°ä¸åŒçš„ buffers ä¸­</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ <code>example.txt</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>Hello Node.js!</span></span>
<span class="line"><span>Welcome to fs.readv tutorial.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨æˆ‘ä»¬æƒ³å°†ç¬¬ä¸€è¡Œè¯»å…¥ä¸€ä¸ª bufferï¼Œç¬¬äºŒè¡Œè¯»å…¥å¦ä¸€ä¸ª bufferã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // åˆ›å»ºä¸¤ä¸ªç¼“å†²åŒº</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> buffers</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> [</span></span>
<span class="line"><span style="color:#D8DEE9;">    Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">14</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span><span style="color:#616E88;"> // &quot;Hello Node.js!&quot; é•¿åº¦ä¸º 14</span></span>
<span class="line"><span style="color:#D8DEE9;">    Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">29</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span><span style="color:#616E88;"> // &quot;Welcome to fs.readv tutorial.&quot; é•¿åº¦ä¸º 29</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  ]</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨ fs.readv è¯»å–æ•°æ®åˆ° buffers</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readv</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffers</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffers</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // è¾“å‡ºè¯»å–åˆ°çš„æ•°æ®</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffers</span><span style="color:#D8DEE9FF;">[</span><span style="color:#B48EAD;">0</span><span style="color:#D8DEE9FF;">]</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // Hello Node.js!</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffers</span><span style="color:#D8DEE9FF;">[</span><span style="color:#B48EAD;">1</span><span style="color:#D8DEE9FF;">]</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // Welcome to fs.readv tutorial.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // è®°å¾—å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-è¯»å–å›¾åƒæ–‡ä»¶çš„å¤´éƒ¨ä¿¡æ¯å’Œæ•°æ®å—" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-è¯»å–å›¾åƒæ–‡ä»¶çš„å¤´éƒ¨ä¿¡æ¯å’Œæ•°æ®å—"><span>ç¤ºä¾‹ 2ï¼šè¯»å–å›¾åƒæ–‡ä»¶çš„å¤´éƒ¨ä¿¡æ¯å’Œæ•°æ®å—</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª PNG å›¾åƒæ–‡ä»¶ <code>image.png</code>ï¼Œæˆ‘ä»¬æƒ³åˆ†åˆ«è¯»å–å…¶å¤´éƒ¨ä¿¡æ¯å’Œç¬¬ä¸€ä¸ªæ•°æ®å—åˆ°ä¸åŒçš„ buffers ä¸­ã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">image.png</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å‡è®¾ PNG å¤´éƒ¨å¤§å°ä¸º 8 å­—èŠ‚ï¼Œç¬¬ä¸€ä¸ªæ•°æ®å—å¤§å°ä¸º 16 å­—èŠ‚</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> buffers</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> [</span></span>
<span class="line"><span style="color:#D8DEE9;">    Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">8</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span><span style="color:#616E88;"> // ç”¨äºå¤´éƒ¨ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">    Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">16</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span><span style="color:#616E88;"> // ç”¨äºç¬¬ä¸€ä¸ªæ•°æ®å—</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  ]</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨ fs.readv è¯»å– PNG å¤´ä¿¡æ¯å’Œç¬¬ä¸€ä¸ªæ•°æ®å—</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readv</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffers</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffers</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // æ­¤å¤„å¯ä»¥å¯¹ buffers ä¸­çš„æ•°æ®è¿›è¡Œç›¸åº”å¤„ç†</span></span>
<span class="line"><span style="color:#616E88;">    // ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å°ç»“-7" tabindex="-1"><a class="header-anchor" href="#å°ç»“-7"><span>å°ç»“</span></a></h3><p>ä½¿ç”¨ <code>fs.readv()</code> å¯ä»¥æ›´é«˜æ•ˆåœ°è¯»å–æ–‡ä»¶çš„ä¸åŒéƒ¨åˆ†åˆ°å¤šä¸ªç¼“å†²åŒºä¸­ã€‚ä¸Šé¢çš„ä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•è¯»å–æ–‡æœ¬æ–‡ä»¶å’Œå›¾åƒæ–‡ä»¶çš„ä¸åŒéƒ¨åˆ†ã€‚è¿™ä¸ªæ–¹æ³•é€šå¸¸ç”¨äºæ€§èƒ½è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ï¼Œä¾‹å¦‚ï¼Œéœ€è¦å¤„ç†å¤§å‹æ–‡ä»¶æˆ–äºŒè¿›åˆ¶æ–‡ä»¶æ—¶ã€‚é€šè¿‡ä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨åŒæ—¶è¯»å–å¤šä¸ªæ–‡ä»¶ç‰‡æ®µï¼Œå¯ä»¥å‡å°‘ç£ç›˜ IO çš„æ“ä½œæ¬¡æ•°ï¼Œä»è€Œæé«˜ç¨‹åºæ‰§è¡Œçš„æ•ˆç‡ã€‚</p><h3 id="fs-realpath-path-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-realpath-path-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsrealpathpath-options-callback" target="_blank" rel="noopener noreferrer">fs.realpath(path[, options], callback)</a></span></a></h3><p>å½“æˆ‘ä»¬è°ˆè®º Node.js ä¸­çš„<code>fs.realpath()</code>æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨è®¨è®ºæ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>æ¨¡å—ï¼‰ä¸­çš„ä¸€ä¸ªç‰¹å®šåŠŸèƒ½ï¼Œå®ƒç”¨äºå°†è·¯å¾„è§£æä¸ºç»å¯¹è·¯å¾„ã€‚è¿™æ„å‘³ç€å®ƒä¼šæŠŠç›¸å¯¹è·¯å¾„æˆ–è€…åŒ…å«ç¬¦å·é“¾æ¥ï¼ˆå³å¿«æ·æ–¹å¼ï¼‰çš„è·¯å¾„è½¬æ¢æˆå®é™…æŒ‡å‘çš„ç‰©ç†ä½ç½®çš„å®Œæ•´è·¯å¾„ã€‚</p><h3 id="è§£é‡Š-3" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-3"><span>è§£é‡Š</span></a></h3><p>åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ä½¿ç”¨çš„è·¯å¾„å¹¶ä¸ç›´æ¥æŒ‡å‘æ–‡ä»¶æˆ–ç›®å½•çš„çœŸå®ä½ç½®ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨äº†â€œ<code>.</code>â€ï¼ˆä»£è¡¨å½“å‰ç›®å½•ï¼‰æˆ–â€œ<code>..</code>â€ï¼ˆä»£è¡¨ä¸Šä¸€çº§ç›®å½•ï¼‰çš„ç›¸å¯¹è·¯å¾„ï¼Œæˆ–è€…åˆ›å»ºäº†æŒ‡å‘å¦ä¸€ä¸ªä½ç½®çš„ç¬¦å·é“¾æ¥ã€‚<code>fs.realpath()</code>å°±æ˜¯ç”¨æ¥è§£å†³è¿™ç±»é—®é¢˜ï¼Œç¡®ä¿æˆ‘ä»¬è·å¾—è·¯å¾„æ‰€ä»£è¡¨çš„çœŸå®ç‰©ç†åœ°å€ã€‚</p><h3 id="å‚æ•°-6" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-6"><span>å‚æ•°</span></a></h3><ul><li><code>path</code>: è¦è¢«è§£æçš„è·¯å¾„å­—ç¬¦ä¸²ã€‚</li><li><code>options</code>: ï¼ˆå¯é€‰ï¼‰ç”¨äºæ”¹å˜æ–¹æ³•è¡Œä¸ºçš„é€‰é¡¹å¯¹è±¡ã€‚å¯ä»¥åŒ…å«å¦‚ä¸‹å±æ€§ï¼š <ul><li><code>encoding</code>: æŒ‡å®šè¿”å›å€¼çš„å­—ç¬¦ç¼–ç ï¼Œé»˜è®¤ä¸º <code>&#39;utf8&#39;</code>ï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸º <code>&#39;buffer&#39;</code>è¿”å›ä¸€ä¸ª Buffer å¯¹è±¡ã€‚</li></ul></li><li><code>callback</code>: å½“è·¯å¾„è§£æå®Œæˆåè¢«è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š<code>err</code>ï¼ˆé”™è¯¯ä¿¡æ¯ï¼‰å’Œ<code>resolvedPath</code>ï¼ˆè§£æåçš„ç»å¯¹è·¯å¾„ï¼‰ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-8" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-8"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><ol><li><strong>ç®€å•è·¯å¾„è§£æ</strong>: å‡è®¾æˆ‘ä»¬éœ€è¦è·å–å½“å‰å·¥ä½œç›®å½•ä¸‹çš„æŸä¸ªæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾&#39;./somefile.txt&#39;ä½äºå½“å‰å·¥ä½œç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">realpath</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./somefile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> resolvedPath</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">The absolute path is: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">resolvedPath</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>è§£æåŒ…å«ç¬¦å·é“¾æ¥çš„è·¯å¾„</strong>: å¦‚æœä½ åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºäº†ç¬¦å·é“¾æ¥ï¼ˆç±»ä¼¼ Windows ä¸­çš„å¿«æ·æ–¹å¼ï¼‰ï¼Œå¹¶å¸Œæœ›çŸ¥é“è¿™ä¸ªé“¾æ¥æŒ‡å‘çš„çœŸå®æ–‡ä»¶ä½ç½®ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾&#39;symlinkToSomeFile&#39;æ˜¯æŒ‡å‘&#39;somefile.txt&#39;çš„ç¬¦å·é“¾æ¥</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">realpath</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">symlinkToSomeFile</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> resolvedPath</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">The real path of the symlink is: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">resolvedPath</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>ä½¿ç”¨ Promise å¤„ç†å¼‚æ­¥æ“ä½œ</strong>: ä» Node.js v10 å¼€å§‹ï¼Œå¤§å¤šæ•°<code>fs</code>æ¨¡å—çš„æ–¹æ³•éƒ½æä¾›äº†åŸºäº Promise çš„ç‰ˆæœ¬ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ›´ç°ä»£åŒ–åœ°å¤„ç†å¼‚æ­¥æ“ä½œï¼Œé¿å…å›è°ƒåœ°ç‹±ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> getRealPath</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> resolvedPath</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">realpath</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./somefile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">The absolute path is: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">resolvedPath</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">getRealPath</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ€»ç»“-10" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-10"><span>æ€»ç»“</span></a></h3><p>ç®€è€Œè¨€ä¹‹ï¼Œ<code>fs.realpath()</code>æ–¹æ³•åœ¨ Node.js ä¸­æ˜¯ç”¨æ¥å°†ä»»ä½•ç»™å®šçš„æ–‡ä»¶æˆ–ç›®å½•è·¯å¾„è§£æä¸ºè¯¥æ–‡ä»¶æˆ–ç›®å½•çš„ç»å¯¹è·¯å¾„ã€‚æ— è®ºä½ æ˜¯åœ¨å¤„ç†ç›¸å¯¹è·¯å¾„ã€ç»å¯¹è·¯å¾„è¿˜æ˜¯ç¬¦å·é“¾æ¥ï¼Œå®ƒéƒ½èƒ½å¸®åŠ©ä½ æ‰¾åˆ°æ–‡ä»¶ç³»ç»Ÿä¸­çš„çœŸå®è·¯å¾„ï¼Œä»è€Œåœ¨ç¨‹åºä¸­è¿›è¡Œæœ‰æ•ˆçš„æ–‡ä»¶æ“ä½œã€‚</p><h3 id="fs-realpath-native-path-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-realpath-native-path-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsrealpathnativepath-options-callback" target="_blank" rel="noopener noreferrer">fs.realpath.native(path[, options], callback)</a></span></a></h3><p>å½“ç„¶ï¼Œè®©æˆ‘æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹ <code>fs.realpath.native</code> è¿™ä¸ªå‡½æ•°ä»¥åŠå®ƒåœ¨ Node.js ä¸­çš„åº”ç”¨ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-12" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-12"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>é¦–å…ˆï¼Œ<code>fs</code> æ˜¯ Node.js çš„ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œå®ƒæä¾›äº†æ–‡ä»¶ç³»ç»Ÿç›¸å…³çš„æ“ä½œã€‚<code>fs</code> æ¨¡å—ä¸­çš„ <code>realpath.native</code> æ–¹æ³•æ˜¯ç”¨æ¥è§£ææ–‡ä»¶ç³»ç»Ÿä¸­çš„è·¯å¾„çš„ã€‚è¿™ä¸ªæ–¹æ³•åŸºæœ¬ä¸Šæ˜¯ç”¨æ¥å°†è·¯å¾„è½¬æ¢æˆç»å¯¹è·¯å¾„ï¼ŒåŒæ—¶ä½¿ç”¨åº•å±‚ç³»ç»Ÿè°ƒç”¨ä¼˜åŒ–æ€§èƒ½ã€‚</p><h3 id="å‚æ•°è¯¦è§£-5" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯¦è§£-5"><span>å‚æ•°è¯¦è§£</span></a></h3><ul><li><strong>path</strong>: è¿™æ˜¯ä½ æƒ³è¦è½¬æ¢ä¸ºç»å¯¹è·¯å¾„çš„åŸå§‹è·¯å¾„å­—ç¬¦ä¸²ã€‚</li><li><strong>options</strong>: ï¼ˆå¯é€‰å‚æ•°ï¼‰ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥æŒ‡å®šå­—ç¬¦ç¼–ç ç­‰é€‰é¡¹ã€‚ä¾‹å¦‚ï¼Œ<code>{encoding: &#39;utf8&#39;}</code>ã€‚</li><li><strong>callback</strong>: å›è°ƒå‡½æ•°ï¼Œå½“ <code>realpath.native</code> å®Œæˆè·¯å¾„è§£æåï¼Œä¼šè¢«è°ƒç”¨ã€‚å›è°ƒå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•° <code>(err, resolvedPath)</code>ã€‚å¦‚æœå‡ºç°é”™è¯¯ï¼Œ<code>err</code> ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼Œå¦åˆ™ <code>resolvedPath</code> å°†æ˜¯è½¬æ¢åçš„ç»å¯¹è·¯å¾„ã€‚</li></ul><h3 id="åº”ç”¨å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#åº”ç”¨å®ä¾‹"><span>åº”ç”¨å®ä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œä½ éœ€è¦è¯»å–ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œä½†æ˜¯ä¸ç¡®å®šè¯¥æ–‡ä»¶åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„ç»å¯¹ä½ç½®ã€‚ä½ å¯èƒ½çŸ¥é“ä¸€ä¸ªç›¸å¯¹äºå½“å‰æ‰§è¡Œè„šæœ¬çš„ç›¸å¯¹è·¯å¾„ï¼Œè€Œä½¿ç”¨ <code>fs.realpath.native</code> å¯ä»¥å¸®åŠ©ä½ æ‰¾åˆ°è¯¥æ–‡ä»¶çš„ç¡®åˆ‡ä½ç½®ã€‚</p><h4 id="ç¤ºä¾‹ä»£ç -5" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç -5"><span>ç¤ºä¾‹ä»£ç </span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç›¸å¯¹è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> relativePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./config/settings.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fs.realpath.native è½¬æ¢ä¸ºç»å¯¹è·¯å¾„</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">realpath</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">native</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">relativePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> resolvedPath</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ— æ³•è§£æè·¯å¾„:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">é…ç½®æ–‡ä»¶çš„ç»å¯¹è·¯å¾„æ˜¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> resolvedPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ç°åœ¨ä½ å¯ä»¥å®‰å…¨åœ°ä½¿ç”¨ç»å¯¹è·¯å¾„è¿›è¡Œå…¶ä»–æ–‡ä»¶æ“ä½œï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">resolvedPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–æ–‡ä»¶å¤±è´¥</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      return;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">é…ç½®æ–‡ä»¶å†…å®¹:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä½¿ç”¨åœºæ™¯-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯-1"><span>ä½¿ç”¨åœºæ™¯</span></a></h3><ol><li>å½“ä½ åœ¨å¤„ç†ç”¨æˆ·è¾“å…¥çš„è·¯å¾„æ—¶ï¼Œå°¤å…¶æ˜¯åœ¨æ„å»ºå‘½ä»¤è¡Œå·¥å…·æˆ–è€…éœ€è¦å¤„ç†å¤–éƒ¨æ–‡ä»¶é“¾æ¥çš„åº”ç”¨æ—¶ï¼Œç¡®å®šå‡†ç¡®çš„æ–‡ä»¶ä½ç½®éå¸¸é‡è¦ã€‚</li><li>åœ¨å¼€å‘è¿‡ç¨‹ä¸­ç»å¸¸éœ€è¦ç§»åŠ¨æ–‡ä»¶æˆ–ä¿®æ”¹ç›®å½•ç»“æ„ï¼Œä½¿ç”¨ç»å¯¹è·¯å¾„å¯ä»¥é™ä½ç›¸å…³æ”¹åŠ¨å¼•èµ·çš„é—®é¢˜ã€‚</li><li>åœ¨è¿›è¡Œå¤§å‹é¡¹ç›®å¼€å‘æ—¶ï¼Œé¡¹ç›®å†…å¯èƒ½å­˜åœ¨å¤šä¸ªæ¨¡å—åˆ†æ•£åœ¨ä¸åŒçš„ç›®å½•ä¸­ï¼Œä½¿ç”¨ç»å¯¹è·¯å¾„å¯ä»¥é¿å…æ¨¡å—å¼•ç”¨é”™ä¹±çš„é—®é¢˜ã€‚</li></ol><h3 id="æ³¨æ„äº‹é¡¹-12" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-12"><span>æ³¨æ„äº‹é¡¹</span></a></h3><p>ä½¿ç”¨ <code>fs.realpath.native</code> æ—¶ï¼Œéœ€è¦æ³¨æ„è·¯å¾„æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæä¾›çš„è·¯å¾„ä¸å­˜åœ¨ï¼Œä¼šè§¦å‘é”™è¯¯ã€‚æ­¤å¤–ï¼Œè€ƒè™‘åˆ°è·¨å¹³å°å…¼å®¹æ€§ï¼Œè·¯å¾„æ ¼å¼åº”æ ¹æ®è¿è¡Œå¹³å°é€‚å½“è°ƒæ•´ã€‚</p><p>å¸Œæœ›è¿™ä¸ªè§£é‡Šå¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼</p><h3 id="fs-rename-oldpath-newpath-callback" tabindex="-1"><a class="header-anchor" href="#fs-rename-oldpath-newpath-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsrenameoldpath-newpath-callback" target="_blank" rel="noopener noreferrer">fs.rename(oldPath, newPath, callback)</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘ä¼šå°½é‡è¯¦ç»†ä¸¾ä¾‹è®²è§£ <code>fs.rename</code> æ–¹æ³•çš„ç”¨æ³•ã€‚</p><p>Node.js çš„ <code>fs</code> æ¨¡å—æ˜¯ç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ä¸€ä¸ªæ¨¡å—ã€‚<code>fs</code> ä»£è¡¨ &quot;File System&quot;ã€‚ä½¿ç”¨è¿™ä¸ªæ¨¡å—ï¼Œä½ å¯ä»¥åœ¨ä½ çš„ Node.js åº”ç”¨ç¨‹åºä¸­åˆ›å»ºã€è¯»å–ã€æ›´æ–°å’Œåˆ é™¤æ–‡ä»¶ã€‚</p><p>å…¶ä¸­ï¼Œ<code>fs.rename</code> å‡½æ•°æ˜¯ç”¨æ¥é‡å‘½åæ–‡ä»¶æˆ–ç›®å½•çš„ã€‚åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rename</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">oldPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> newPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> callback</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><strong>oldPath</strong>: æ—§çš„æ–‡ä»¶/ç›®å½•è·¯å¾„ã€‚</li><li><strong>newPath</strong>: æ–°çš„æ–‡ä»¶/ç›®å½•è·¯å¾„ã€‚</li><li><strong>callback</strong>: æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå½“é‡å‘½åæ“ä½œå®Œæˆåè¢«è°ƒç”¨ï¼Œå¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œé”™è¯¯ä¿¡æ¯ä¼šä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™å›è°ƒå‡½æ•°ã€‚</li></ul><h3 id="ç¤ºä¾‹-1-é‡å‘½åæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-é‡å‘½åæ–‡ä»¶"><span>ç¤ºä¾‹ 1: é‡å‘½åæ–‡ä»¶</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º <code>oldFileName.txt</code> çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬æƒ³å°†å®ƒé‡å‘½åä¸º <code>newFileName.txt</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®šä¹‰æ—§æ–‡ä»¶åå’Œæ–°æ–‡ä»¶å</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> oldPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">oldFileName.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> newPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">newFileName.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fs.rename è¿›è¡Œæ–‡ä»¶é‡å‘½å</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rename</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">oldPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> newPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²è¢«æˆåŠŸé‡å‘½åã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç¤ºä¾‹-2-ç§»åŠ¨æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ç§»åŠ¨æ–‡ä»¶"><span>ç¤ºä¾‹ 2: ç§»åŠ¨æ–‡ä»¶</span></a></h3><p><code>fs.rename</code> ä¸ä»…å¯ä»¥é‡å‘½åæ–‡ä»¶ï¼Œè¿˜å¯ä»¥ç§»åŠ¨æ–‡ä»¶ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬æƒ³æŠŠ <code>example.txt</code> ä»å½“å‰ç›®å½•ç§»åŠ¨åˆ°å­ç›®å½• <code>newDirectory</code> ä¸‹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®šä¹‰å½“å‰æ–‡ä»¶è·¯å¾„å’Œç›®æ ‡æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> currentPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> targetPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">newDirectory/example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fs.rename è¿›è¡Œæ–‡ä»¶ç§»åŠ¨</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rename</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">currentPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> targetPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²è¢«æˆåŠŸç§»åŠ¨ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æ‰§è¡Œé‡å‘½åæˆ–ç§»åŠ¨æ–‡ä»¶æ“ä½œæ—¶ï¼Œç¡®ä¿ç›®æ ‡è·¯å¾„ä¸­çš„ç›®å½•å·²ç»å­˜åœ¨ï¼Œå¦åˆ™æ“ä½œä¼šå¤±è´¥ã€‚</p><h3 id="ç¤ºä¾‹-3-é”™è¯¯å¤„ç†" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-é”™è¯¯å¤„ç†"><span>ç¤ºä¾‹ 3: é”™è¯¯å¤„ç†</span></a></h3><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯¹æ½œåœ¨çš„é”™è¯¯è¿›è¡Œå¤„ç†æ˜¯å¾ˆé‡è¦çš„ã€‚è¿™é‡Œå±•ç¤ºäº†ä¸€ä¸ªå¸¦æœ‰åŸºæœ¬é”™è¯¯å¤„ç†çš„ä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> oldPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">nonExistentFile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> newPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">shouldNotAppear.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rename</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">oldPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> newPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // æ‰“å°é”™è¯¯æ¶ˆæ¯è‡³æ§åˆ¶å°</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">é‡å‘½åå¤±è´¥: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å¦‚æœçœ‹åˆ°è¿™æ¡æ¶ˆæ¯è¯´æ˜æœ‰é—®é¢˜ï¼Œå› ä¸ºæºæ–‡ä»¶ä¸å­˜åœ¨ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœæ—§æ–‡ä»¶ä¸å­˜åœ¨ï¼Œ<code>fs.rename</code> ä¼šè§¦å‘ä¸€ä¸ªé”™è¯¯ï¼Œè€Œé”™è¯¯å¤„ç†å›è°ƒä¼šæ•è·è¿™ä¸ªé”™è¯¯å¹¶æ‰“å°å‡ºç›¸åº”çš„é”™è¯¯ä¿¡æ¯ã€‚</p><p>é€šè¿‡ä»¥ä¸Šä¾‹å­ï¼Œä½ åº”è¯¥èƒ½å¤Ÿç†è§£ <code>fs.rename</code> çš„åŸºæœ¬ç”¨æ³•ä»¥åŠå¦‚ä½•åœ¨ä½ çš„ Node.js ç¨‹åºä¸­ä½¿ç”¨å®ƒæ¥é‡å‘½åæˆ–ç§»åŠ¨æ–‡ä»¶ã€‚</p><h3 id="fs-rmdir-path-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-rmdir-path-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsrmdirpath-options-callback" target="_blank" rel="noopener noreferrer">fs.rmdir(path[, options], callback)</a></span></a></h3><p>Node.js ä¸­çš„ <code>fs.rmdir()</code> æ–¹æ³•ç”¨äºåˆ é™¤ç›®å½•ã€‚è¿™ä¸ªæ–¹æ³•æ¥è‡ª Node.js çš„ File System æ¨¡å—ï¼Œå³æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼Œå®ƒå…è®¸ä½ ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’ï¼Œä¾‹å¦‚åˆ›å»ºã€è¯»å–ã€å†™å…¥å’Œåˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ã€‚</p><p>åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œ<code>fs.rmdir()</code> æ–¹æ³•çš„ä½¿ç”¨è¯­æ³•å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rmdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">[</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> options</span><span style="color:#D8DEE9FF;">]</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> callback</span><span style="color:#D8DEE9FF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>path</code>ï¼šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¦åˆ é™¤çš„ç›®å½•çš„è·¯å¾„ã€‚</li><li><code>options</code>ï¼šæ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…è®¸ä½ æŒ‡å®šé¢å¤–çš„é€‰é¡¹ã€‚åœ¨æ—§ç‰ˆæœ¬çš„ Node.js ä¸­ï¼Œè¿™é€šå¸¸åŒ…æ‹¬åƒ <code>recursive</code> è¿™æ ·çš„é€‰é¡¹ï¼Œç”¨äºæŒ‡å®šæ˜¯å¦åº”è¯¥é€’å½’åˆ é™¤ç›®å½•ï¼ˆå³åˆ é™¤ç›®å½•åŠå…¶æ‰€æœ‰å†…å®¹ï¼‰ã€‚ä¸è¿‡ï¼Œä» Node.js v14.14.0 å¼€å§‹ï¼Œæ¨èä½¿ç”¨ <code>fs.rm()</code> æ–¹æ³•æ¥é€’å½’åˆ é™¤ç›®å½•ã€‚</li><li><code>callback</code>ï¼šæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå½“ <code>rmdir</code> æ“ä½œå®Œæˆæ—¶è¢«è°ƒç”¨ã€‚æ­¤å›è°ƒå‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå³å¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œè¯¥é”™è¯¯å‚æ•°å°†ä¸º <code>null</code> æˆ– <code>undefined</code>ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-12" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-12"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-åˆ é™¤ä¸€ä¸ªç©ºç›®å½•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åˆ é™¤ä¸€ä¸ªç©ºç›®å½•"><span>ç¤ºä¾‹ 1ï¼šåˆ é™¤ä¸€ä¸ªç©ºç›®å½•</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º <code>exampleDir</code> çš„ç©ºç›®å½•ï¼Œæˆ‘ä»¬æƒ³é€šè¿‡ Node.js è„šæœ¬å°†å…¶åˆ é™¤ã€‚ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./exampleDir</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ é™¤ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rmdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">åˆ é™¤ç›®å½•å¤±è´¥: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">error</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•å·²æˆåŠŸåˆ é™¤</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç æ¼”ç¤ºäº†å¦‚ä½•åˆ é™¤ä¸€ä¸ªåä¸º <code>exampleDir</code> çš„ç›®å½•ã€‚å¦‚æœç›®å½•ä¸å­˜åœ¨æˆ–è€…åˆ é™¤è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œé”™è¯¯ä¿¡æ¯å°†ä¼šè¢«æ‰“å°åˆ°æ§åˆ¶å°ã€‚</p><p>è¯·æ³¨æ„ï¼Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œéšç€ Node.js ç‰ˆæœ¬çš„æ›´æ–°ï¼Œæ¨èä½¿ç”¨ <code>fs.rm(path[, options], callback)</code> æ¥ä»£æ›¿ <code>fs.rmdir</code> è¿›è¡Œç›®å½•çš„åˆ é™¤æ“ä½œï¼Œå°¤å…¶æ˜¯å½“éœ€è¦é€’å½’åˆ é™¤éç©ºç›®å½•æ—¶ã€‚<code>fs.rm()</code> æ–¹æ³•æä¾›äº†æ›´ä¸°å¯Œçš„é€‰é¡¹ï¼ŒåŒ…æ‹¬ä¸€ä¸ª <code>recursive</code> é€‰é¡¹ï¼Œå¯ä»¥ç›´æ¥åˆ é™¤éç©ºç›®å½•è€Œä¸éœ€è¦é¢å¤–çš„æ­¥éª¤ã€‚</p><h4 id="æ³¨æ„äº‹é¡¹-13" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-13"><span>æ³¨æ„äº‹é¡¹ï¼š</span></a></h4><ul><li>åœ¨ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿæ“ä½œæ—¶ï¼Œç¡®ä¿ä½ å¯¹è·¯å¾„æœ‰ä¸€ä¸ªæ˜ç¡®çš„ç†è§£ï¼Œé¿å…è¯¯åˆ é‡è¦æ–‡ä»¶æˆ–ç›®å½•ã€‚</li><li>ä» Node.js v14.14.0 å¼€å§‹ï¼Œæ¨èä½¿ç”¨ <code>fs.rm()</code> æˆ– <code>fs.rmSync()</code> æ¥åˆ é™¤ç›®å½•ï¼Œç‰¹åˆ«æ˜¯å½“ä½ éœ€è¦é€’å½’åˆ é™¤éç©ºç›®å½•æ—¶ã€‚</li></ul><h3 id="fs-rm-path-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-rm-path-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsrmpath-options-callback" target="_blank" rel="noopener noreferrer">fs.rm(path[, options], callback)</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æ˜¯ç”¨æ¥å’Œæ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„æ¨¡å—ã€‚å®ƒæä¾›äº†å¾ˆå¤šç”¨äºæ–‡ä»¶æ“ä½œçš„å‡½æ•°ã€‚<code>fs.rm()</code> æ˜¯å…¶ä¸­ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥åˆ é™¤æ–‡ä»¶æˆ–è€…ç›®å½•ã€‚</p><h3 id="ä½¿ç”¨-fs-rm" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-fs-rm"><span>ä½¿ç”¨ <code>fs.rm()</code></span></a></h3><p><code>fs.rm()</code> å‡½æ•°å¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ï¼š</p><ol><li><code>path</code>: è¿™ä¸ªå‚æ•°æŒ‡å®šäº†è¦åˆ é™¤çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><code>options</code>: (å¯é€‰) ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥æŒ‡å®šä¸€äº›é¢å¤–çš„é€‰é¡¹ã€‚</li><li><code>callback</code>: å½“åˆ é™¤æ“ä½œå®Œæˆåï¼Œä¼šè°ƒç”¨è¿™ä¸ªå›è°ƒå‡½æ•°ã€‚</li></ol><h3 id="é€‰é¡¹-options-2" tabindex="-1"><a class="header-anchor" href="#é€‰é¡¹-options-2"><span>é€‰é¡¹ <code>options</code></span></a></h3><p><code>options</code> å¯¹è±¡å¯ä»¥åŒ…å«ä»¥ä¸‹å±æ€§ï¼š</p><ul><li><code>force</code>: å¦‚æœè®¾ç½®ä¸º <code>true</code>ï¼Œåœ¨æ–‡ä»¶ä¸å­˜åœ¨çš„æƒ…å†µä¸‹ä¸ä¼šæŠ¥é”™ã€‚</li><li><code>recursive</code>: å¦‚æœè®¾ç½®ä¸º <code>true</code>ï¼Œå¹¶ä¸” <code>path</code> æ˜¯ä¸€ä¸ªç›®å½•ï¼Œè¿™å°†ä¼šé€’å½’åœ°åˆ é™¤ç›®å½•åŠå…¶å†…å®¹ã€‚</li></ul><h3 id="å›è°ƒ-callback" tabindex="-1"><a class="header-anchor" href="#å›è°ƒ-callback"><span>å›è°ƒ <code>callback</code></span></a></h3><p><code>callback</code> å‡½æ•°ä¼šåœ¨åˆ é™¤æ“ä½œå®Œæˆåè¢«è°ƒç”¨ï¼Œæ— è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥ã€‚å®ƒæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼š</p><ul><li><code>error</code>: å¦‚æœåˆ é™¤æ“ä½œå‡ºç°é”™è¯¯ï¼Œè¿™ä¸ªå‚æ•°ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼›å¦‚æœæˆåŠŸï¼Œåˆ™ä¸º <code>null</code>ã€‚</li></ul><h3 id="å®é™…ä¾‹å­-8" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-8"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹åœºæ™¯ï¼š</p><ol><li>åˆ é™¤ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡ä»¶ã€‚</li><li>é€’å½’åˆ é™¤ä¸€ä¸ªåä¸º <code>data</code> çš„ç›®å½•åŠå…¶æ‰€æœ‰å†…å®¹ã€‚</li></ol><p>å¯¹äºç¬¬ä¸€ä¸ªåœºæ™¯ï¼Œæˆ‘ä»¬çš„ä»£ç å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ é™¤æ–‡ä»¶ example.txt</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rm</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> force</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">åˆ é™¤æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">error</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶åˆ é™¤æˆåŠŸ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°è¯•åˆ é™¤ <code>example.txt</code> æ–‡ä»¶ï¼Œå¹¶é€šè¿‡ <code>force: true</code> é€‰é¡¹ç¡®ä¿å³ä½¿æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¹Ÿä¸ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p><p>å¯¹äºç¬¬äºŒä¸ªåœºæ™¯ï¼Œåˆ é™¤ä¸€ä¸ªç›®å½•çš„ä»£ç å¯èƒ½å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// é€’å½’åˆ é™¤ data ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rm</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">data</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> recursive</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;">,</span><span style="color:#88C0D0;"> force</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">åˆ é™¤ç›®å½•æ—¶å‘ç”Ÿé”™è¯¯: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">error</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•åˆ é™¤æˆåŠŸ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>{ recursive: true, force: true }</code>ï¼Œè¿™è¡¨ç¤ºå³ä½¿ <code>data</code> ç›®å½•ä¸å­˜åœ¨ï¼Œæˆ–è€…ç›®å½•å­˜åœ¨ä½†æ˜¯é‡Œé¢æœ‰å†…å®¹ï¼Œéƒ½èƒ½å¤Ÿè¢«åˆ é™¤è€Œä¸ä¼šäº§ç”Ÿé”™è¯¯ã€‚</p><blockquote><p><strong>æ³¨æ„</strong>ï¼šä½¿ç”¨ <code>fs.rm()</code> ç‰¹åˆ«æ˜¯å¸¦æœ‰ <code>recursive: true</code> é€‰é¡¹æ—¶éœ€è¦å°å¿ƒï¼Œå› ä¸ºå®ƒä¼šæ°¸ä¹…åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ï¼Œè€Œä¸ä¼šå°†å®ƒä»¬æ”¾å…¥å›æ”¶ç«™ã€‚å§‹ç»ˆç¡®ä¿ä½ çš„è·¯å¾„ï¼ˆ<code>path</code>ï¼‰æ˜¯æ­£ç¡®çš„ï¼Œä»¥é¿å…æ„å¤–åˆ é™¤é‡è¦æ–‡ä»¶ã€‚</p></blockquote><h3 id="fs-stat-path-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-stat-path-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsstatpath-options-callback" target="_blank" rel="noopener noreferrer">fs.stat(path[, options], callback)</a></span></a></h3><p>Node.js ä¸­çš„ <code>fs.stat</code> å‡½æ•°æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„å·¥å…·ï¼Œå®ƒå…è®¸ä½ è·å–å…³äºæ–‡ä»¶ç³»ç»Ÿä¸­æŸä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„çŠ¶æ€ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯åŒ…æ‹¬æ–‡ä»¶çš„å¤§å°ã€åˆ›å»ºå’Œä¿®æ”¹æ—¶é—´ç­‰è¯¦ç»†æ•°æ®ã€‚ç†è§£ <code>fs.stat</code> çš„ä½¿ç”¨å¯¹äºè¿›è¡Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œå°¤ä¸ºé‡è¦ã€‚</p><h3 id="åŸºæœ¬ç”¨æ³•-1" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç”¨æ³•-1"><span>åŸºæœ¬ç”¨æ³•</span></a></h3><p><code>fs.stat</code> å‡½æ•°çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">[</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> options</span><span style="color:#D8DEE9FF;">]</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> callback</span><span style="color:#D8DEE9FF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><strong>path</strong>: è¿™æ˜¯ä½ æƒ³è·å–ä¿¡æ¯çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><strong>options</strong>: å¯é€‰å‚æ•°ï¼Œå¯ä»¥ç”¨æ¥æŒ‡å®šä¸€äº›å‡½æ•°è¡Œä¸ºï¼Œæ¯”å¦‚æ˜¯å¦ä»¥å¤§æ•´æ•°ï¼ˆbigintï¼‰å½¢å¼è¿”å›æ–‡ä»¶ç³»ç»ŸçŠ¶æ€æ•°å€¼ã€‚</li><li><strong>callback</strong>: å½“ <code>fs.stat</code> å®Œæˆåï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚å®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªé”™è¯¯å¯¹è±¡ï¼ˆå¦‚æœå‘ç”Ÿé”™è¯¯çš„è¯ï¼‰å’Œä¸€ä¸ª <code>stats</code> å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº†æ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ã€‚</li></ul><h3 id="stats-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#stats-å¯¹è±¡"><span><code>stats</code> å¯¹è±¡</span></a></h3><p>å½“æ²¡æœ‰å‘ç”Ÿé”™è¯¯æ—¶ï¼Œ<code>callback</code> å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å°†æ˜¯ä¸€ä¸ª <code>stats</code> å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æä¾›äº†æ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†çŠ¶æ€ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š</p><ul><li><code>stats.isFile()</code>: å¦‚æœæ˜¯æ–‡ä»¶åˆ™è¿”å› <code>true</code>ã€‚</li><li><code>stats.isDirectory()</code>: å¦‚æœæ˜¯ç›®å½•åˆ™è¿”å› <code>true</code>ã€‚</li><li><code>stats.isSymbolicLink()</code>: å¦‚æœæ˜¯ç¬¦å·é“¾æ¥åˆ™è¿”å› <code>true</code>ã€‚ï¼ˆä½¿ç”¨ <code>fs.lstat()</code> æ—¶æ‰æœ‰æ•ˆï¼‰</li><li><code>stats.size</code>: æ–‡ä»¶çš„å¤§å°ï¼ˆå­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-13" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-13"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨å¹¶è·å–å…¶å¤§å°" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨å¹¶è·å–å…¶å¤§å°"><span>ç¤ºä¾‹ 1: æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨å¹¶è·å–å…¶å¤§å°</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶ä¸å­˜åœ¨</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶å¤§å°ï¼š</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">size</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> å­—èŠ‚</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ£€æŸ¥å½“å‰ç›®å½•ä¸‹çš„ <code>example.txt</code> æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æ‰“å°å…¶å¤§å°ã€‚</p><h4 id="ç¤ºä¾‹-2-åˆ¤æ–­è·¯å¾„æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•-1" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-åˆ¤æ–­è·¯å¾„æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•-1"><span>ç¤ºä¾‹ 2: åˆ¤æ–­è·¯å¾„æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./example</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è·¯å¾„ä¸å­˜åœ¨</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFile</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#81A1C1;"> if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isDirectory</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯ä¸€ä¸ªç›®å½•</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬åˆ¤æ–­åä¸º <code>example</code> çš„è·¯å¾„æ˜¯ä¸€ä¸ªæ–‡ä»¶è¿˜æ˜¯ç›®å½•ï¼Œå¹¶ç›¸åº”åœ°è¾“å‡ºç»“æœã€‚</p><h3 id="æ€»ç»“-11" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-11"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡ä¸Šè¿°ç¤ºä¾‹ï¼Œä½ åº”è¯¥å¯¹ <code>fs.stat</code> çš„ç”¨æ³•æœ‰äº†ä¸€ä¸ªåŸºæœ¬çš„ç†è§£ã€‚å®ƒæ˜¯ Node.js ä¸­å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ—¶ä¸å¯æˆ–ç¼ºçš„ä¸€ä¸ªå·¥å…·ã€‚æ— è®ºæ˜¯ç®€å•åœ°æ£€æŸ¥æ–‡ä»¶çš„å­˜åœ¨æ€§ï¼Œè¿˜æ˜¯è·å–æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼Œ<code>fs.stat</code> éƒ½èƒ½æ´¾ä¸Šç”¨åœºã€‚åœ¨ç¼–å†™æ¶‰åŠæ–‡ä»¶æ“ä½œçš„ Node.js åº”ç”¨æ—¶ï¼Œç†Ÿæ‚‰è¿™äº› API å°†éå¸¸æœ‰å¸®åŠ©ã€‚</p><h3 id="fs-statfs-path-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-statfs-path-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsstatfspath-options-callback" target="_blank" rel="noopener noreferrer">fs.statfs(path[, options], callback)</a></span></a></h3><p><code>fs.statfs(path[, options], callback)</code> æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼ˆ<code>fs</code>æ¨¡å—ï¼‰ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºè·å–æ–‡ä»¶ç³»ç»Ÿçš„çŠ¶æ€ä¿¡æ¯ã€‚è¿™ä¸ªå‡½æ•°ä¸æ˜¯æ ‡å‡† POSIX çš„ä¸€éƒ¨åˆ†ï¼Œä½†åœ¨æŸäº›å¹³å°ï¼ˆæ¯”å¦‚ Linuxï¼‰ä¸Šæä¾›äº†ç±»ä¼¼çš„åŠŸèƒ½ã€‚ç›´åˆ°æˆ‘çŸ¥è¯†æˆªè‡³æ—¥æœŸï¼ˆ2023 å¹´ 4 æœˆï¼‰ï¼ŒNode.js v21.7.1 è¿˜æ²¡æœ‰æ­£å¼å‘å¸ƒï¼Œè€Œä¸” <code>fs.statfs</code> å¹¶ä¸æ˜¯ Node.js æ ‡å‡†åº“çš„ä¸€éƒ¨åˆ†ã€‚å› æ­¤ï¼Œå‡å®šè¿™æ˜¯æœªæ¥ç‰ˆæœ¬æˆ–è€…éå®˜æ–¹çš„æ‰©å±•åŠŸèƒ½ï¼Œä¸‹é¢å°†ä»¥æ­¤ä¸ºåŸºç¡€è¿›è¡Œè§£é‡Šã€‚</p><p>å‡½æ•°çš„ç»„æˆï¼š</p><ul><li><code>path</code>: è¿™æ˜¯ä½ æƒ³è¦æ£€æŸ¥æ–‡ä»¶ç³»ç»ŸçŠ¶æ€çš„è·¯å¾„ï¼Œå¯ä»¥æ˜¯ä»»ä½•æŒ‚è½½ç‚¹ã€ç›®å½•æˆ–è€…æ–‡ä»¶æ‰€åœ¨çš„è·¯å¾„ã€‚</li><li><code>options</code>: å¯é€‰å‚æ•°ï¼Œé€šå¸¸ç”¨äºæŒ‡å®šå­—ç¬¦ç¼–ç ç­‰ã€‚</li><li><code>callback</code>: å½“è¯»å–æ–‡ä»¶ç³»ç»ŸçŠ¶æ€å®Œæˆæ—¶ä¼šè¢«è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚</li></ul><p><code>callback</code> å‡½æ•°é€šå¸¸æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š<code>err</code>å’Œ<code>stats</code>ã€‚å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œ<code>err</code>ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼›å¦åˆ™ï¼Œ<code>err</code>ä¸º nullã€‚<code>stats</code> å¯¹è±¡åŒ…å«äº†å¦‚ä¸‹ä¸€äº›æœ‰å…³æ–‡ä»¶ç³»ç»Ÿçš„ä¿¡æ¯ï¼š</p><ul><li><code>type</code>: æ–‡ä»¶ç³»ç»Ÿç±»å‹ã€‚</li><li><code>bsize</code>: æ–‡ä»¶ç³»ç»Ÿå—çš„å¤§å°ã€‚</li><li><code>blocks</code>: æ€»å…±çš„æ•°æ®å—æ•°é‡ã€‚</li><li><code>bfree</code>: ç©ºé—²çš„æ•°æ®å—æ•°é‡ã€‚</li><li><code>bavail</code>: éè¶…çº§ç”¨æˆ·å¯è·å–çš„ç©ºé—²æ•°æ®å—æ•°é‡ã€‚</li><li>... å…¶ä»–æ›´å¤šçš„å¯èƒ½çš„å±æ€§ï¼Œæ ¹æ®ä¸åŒçš„æ“ä½œç³»ç»Ÿå’Œæ–‡ä»¶ç³»ç»Ÿï¼Œå¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚</li></ul><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå¦‚ä½•ä½¿ç”¨ <code>fs.statfs</code> çš„ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾ä½ è¦æ£€æŸ¥æ ¹ç›®å½• &quot;/&quot; çš„æ–‡ä»¶ç³»ç»ŸçŠ¶æ€</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statfs</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è·å–æ–‡ä»¶ç³»ç»ŸçŠ¶æ€æ—¶å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶ç³»ç»Ÿç±»å‹:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">type</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å—å¤§å°:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">bsize</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ€»æ•°æ®å—:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">blocks</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç©ºé—²æ•°æ®å—:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">bfree</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // æ ¹æ®è·å–çš„ä¿¡æ¯ï¼Œä½ å¯ä»¥è®¡ç®—å‡ºæ–‡ä»¶ç³»ç»Ÿçš„æ€»ç©ºé—´å’Œå‰©ä½™ç©ºé—´ç­‰</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> totalSpace</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">blocks</span><span style="color:#81A1C1;"> *</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">bsize</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> freeSpace</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">bfree</span><span style="color:#81A1C1;"> *</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">bsize</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶ç³»ç»Ÿæ€»ç©ºé—´:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> totalSpace</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶ç³»ç»Ÿå‰©ä½™ç©ºé—´:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> freeSpace</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ï¼Œé¦–å…ˆæˆ‘ä»¬å¯¼å…¥äº† <code>fs</code> æ¨¡å—ã€‚ç„¶åä½¿ç”¨ <code>fs.statfs</code> æ–¹æ³•å»è·å–æ ¹ç›®å½• <code>/</code> çš„æ–‡ä»¶ç³»ç»ŸçŠ¶æ€ã€‚ä¸€æ—¦æ“ä½œå®Œæˆï¼Œä¼ é€’ç»™ <code>fs.statfs</code> çš„å›è°ƒå‡½æ•°å°±ä¼šè¢«æ‰§è¡Œï¼Œæˆ‘ä»¬åœ¨å›è°ƒå‡½æ•°ä¸­å¤„ç†å¯èƒ½å‡ºç°çš„é”™è¯¯å¹¶æ‰“å°æ–‡ä»¶ç³»ç»Ÿçš„ç›¸å…³ä¿¡æ¯ã€‚</p><p>é‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œå› ä¸ºè¿™ä¸ª API åœ¨ Node.js çš„ä¸»æµç‰ˆæœ¬ä¸­å¹¶ä¸å­˜åœ¨ï¼Œå¦‚æœä½ å°è¯•è¿è¡Œä¸Šè¿°ä»£ç ï¼Œå¾ˆå¯èƒ½ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯æç¤ºè¯´ <code>fs.statfs</code> ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚è‹¥è¦å®é™…åº”ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œä½ å¯èƒ½éœ€è¦ä¾èµ–ç‰¹å®šå¹³å°çš„æ‰©å±•æ¨¡å—æˆ–ç­‰å¾… Node.js æœªæ¥çš„æ›´æ–°ã€‚</p><h3 id="fs-symlink-target-path-type-callback" tabindex="-1"><a class="header-anchor" href="#fs-symlink-target-path-type-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fssymlinktarget-path-type-callback" target="_blank" rel="noopener noreferrer">fs.symlink(target, path[, type], callback)</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘ä¼šå°½åŠ›è§£é‡Šå¾—æ—¢é€šä¿—æ˜“æ‡‚åˆè¯¦ç»†ã€‚</p><h3 id="node-js-ä¸­çš„-fs-symlink-target-path-type-callback" tabindex="-1"><a class="header-anchor" href="#node-js-ä¸­çš„-fs-symlink-target-path-type-callback"><span>Node.js ä¸­çš„ <code>fs.symlink(target, path[, type], callback)</code></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æä¾›äº†ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„ APIã€‚è¿™åŒ…æ‹¬åˆ›å»ºã€è¯»å–ã€å†™å…¥å’Œåˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ï¼Œä»¥åŠæ›´é«˜çº§çš„æ“ä½œï¼Œæ¯”å¦‚åˆ›å»ºç¬¦å·é“¾æ¥ã€‚<code>fs.symlink</code> å‡½æ•°å°±æ˜¯ç”¨æ¥åˆ›å»ºä¸€ä¸ªç¬¦å·é“¾æ¥çš„ã€‚</p><p><strong>ä»€ä¹ˆæ˜¯ç¬¦å·é“¾æ¥ï¼Ÿ</strong></p><p>ç®€å•æ¥è¯´ï¼Œç¬¦å·é“¾æ¥ï¼ˆSymbolic Linkï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ–‡ä»¶ï¼Œå®ƒä½œä¸ºä¸€ä¸ªå¼•ç”¨æˆ–æŒ‡å‘å¦ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€æ¡æ·å¾„æˆ–å¿«æ·æ–¹å¼ï¼Œé€šè¿‡è¿™ä¸ªæ·å¾„å¯ä»¥è®¿é—®åˆ°å®ƒæŒ‡å‘çš„å®é™…æ–‡ä»¶æˆ–ç›®å½•ã€‚</p><h3 id="å‚æ•°è§£æ" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£æ"><span>å‚æ•°è§£æ</span></a></h3><ul><li><strong>target</strong>ï¼šè¿™æ˜¯ä½ æƒ³è¦åˆ›å»ºçš„ç¬¦å·é“¾æ¥æ‰€æŒ‡å‘çš„ç›®æ ‡æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><strong>path</strong>ï¼šè¿™æ˜¯ä½ æƒ³è¦åˆ›å»ºçš„ç¬¦å·é“¾æ¥çš„è·¯å¾„ã€‚</li><li><strong>type</strong>ï¼ˆå¯é€‰ï¼‰ï¼šå½“åœ¨ Windows ä¸Šåˆ›å»ºç¬¦å·é“¾æ¥æ—¶ï¼Œéœ€è¦æŒ‡å®šæ˜¯é“¾æ¥åˆ°æ–‡ä»¶è¿˜æ˜¯ç›®å½•ï¼ˆ&#39;file&#39; æˆ– &#39;dir&#39;ï¼‰ã€‚åœ¨ Unix-like ç³»ç»Ÿä¸Šï¼Œè¿™ä¸ªå‚æ•°è¢«å¿½ç•¥ã€‚</li><li><strong>callback</strong>ï¼šè¿™æ˜¯åœ¨å®Œæˆåˆ›å»ºç¬¦å·é“¾æ¥åè¢«è°ƒç”¨çš„å‡½æ•°ã€‚å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œå®ƒå°†æ¥æ”¶ä¸€ä¸ª Error å¯¹è±¡ä½œä¸ºå…¶ç¬¬ä¸€ä¸ªå‚æ•°ã€‚</li></ul><h3 id="ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2"><span>ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰å¦‚ä¸‹åœºæ™¯ï¼š</p><ol><li>ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªé¡¹ç›®ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå¸¸ç”¨çš„é…ç½®æ–‡ä»¶ä½äº <code>/path/to/common/config.json</code>ã€‚</li><li>ä½ å¸Œæœ›åœ¨é¡¹ç›®çš„å¤šä¸ªéƒ¨åˆ†ä¸­å¼•ç”¨è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œä½†ä¸æƒ³å¤åˆ¶ç²˜è´´æ–‡ä»¶åˆ°å„å¤„ï¼Œå¯ä»¥ä½¿ç”¨ç¬¦å·é“¾æ¥ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›®æ ‡æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> target</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/common/config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// ç¬¦å·é“¾æ¥çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./config-link.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºç¬¦å·é“¾æ¥</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">symlink</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">target</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">ç¬¦å·é“¾æ¥æˆåŠŸåˆ›å»ºï¼š</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">path</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> -&gt; </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">target</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å°†ä¼šåˆ›å»ºä¸€ä¸ªåä¸º <code>config-link.json</code> çš„ç¬¦å·é“¾æ¥ï¼ŒæŒ‡å‘ <code>/path/to/common/config.json</code>ã€‚æ— è®ºä½•æ—¶ä½ é€šè¿‡ <code>config-link.json</code> è®¿é—®æˆ–ä¿®æ”¹å†…å®¹ï¼Œå®é™…ä¸Šæ˜¯åœ¨è®¿é—®æˆ–ä¿®æ”¹ <code>/path/to/common/config.json</code>ã€‚</p><h3 id="å®é™…åº”ç”¨ä¸¾ä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¸¾ä¾‹-1"><span>å®é™…åº”ç”¨ä¸¾ä¾‹</span></a></h3><ol><li><p><strong>Web æœåŠ¡å™¨å…±äº«é™æ€èµ„æº</strong>ï¼šå¦‚æœä½ æœ‰å¤šä¸ª Web é¡¹ç›®éœ€è¦å…±äº«ç›¸åŒçš„é™æ€èµ„æºï¼ˆä¾‹å¦‚æ ·å¼è¡¨ã€è„šæœ¬åº“ç­‰ï¼‰ï¼Œå¯ä»¥æŠŠè¿™äº›èµ„æºæ”¾åœ¨ä¸€ä¸ªå…¬å…±ç›®å½•ä¸­ï¼Œç„¶ååœ¨å„ä¸ªé¡¹ç›®ä¸­é€šè¿‡ç¬¦å·é“¾æ¥æŒ‡å‘è¿™ä¸ªç›®å½•ã€‚</p></li><li><p><strong>å¼€å‘ç¯å¢ƒä¸­çš„å¿«é€Ÿåˆ‡æ¢</strong>ï¼šåœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½éœ€è¦é’ˆå¯¹ä¸åŒç‰ˆæœ¬çš„åº“æˆ–æ¡†æ¶è¿›è¡Œæµ‹è¯•ã€‚é€šè¿‡åˆ›å»ºæŒ‡å‘ä¸åŒç‰ˆæœ¬åº“çš„ç¬¦å·é“¾æ¥ï¼Œå¯ä»¥è½»æ¾åˆ‡æ¢ä¾èµ–ï¼Œè€Œæ— éœ€æ”¹å˜ä»£ç ä¸­çš„å¼•ç”¨è·¯å¾„ã€‚</p></li><li><p><strong>å¤‡ä»½å’ŒåŒæ­¥</strong>ï¼šåœ¨æ‰§è¡Œå¤‡ä»½æ“ä½œæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç¬¦å·é“¾æ¥æŒ‡å‘é‡è¦æ–‡ä»¶æˆ–ç›®å½•ï¼Œä»è€Œé¿å…å¤åˆ¶å¤§é‡æ•°æ®ã€‚åŒæ ·ï¼Œåœ¨å¤šè®¾å¤‡é—´åŒæ­¥æ–‡ä»¶æ—¶ï¼Œç¬¦å·é“¾æ¥ä¹Ÿèƒ½å‡å°‘æ•°æ®å¤åˆ¶çš„éœ€è¦ã€‚</p></li></ol><p>é€šè¿‡è¿™äº›ä¾‹å­å’Œè§£é‡Šï¼Œå¸Œæœ›ä½ å¯¹ <code>fs.symlink</code> æ–¹æ³•æœ‰äº†è¾ƒä¸ºæ¸…æ™°çš„ç†è§£ã€‚</p><h3 id="fs-truncate-path-len-callback" tabindex="-1"><a class="header-anchor" href="#fs-truncate-path-len-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fstruncatepath-len-callback" target="_blank" rel="noopener noreferrer">fs.truncate(path[, len], callback)</a></span></a></h3><p>Node.js ä¸­çš„ <code>fs.truncate()</code> æ–¹æ³•æ˜¯æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼Œç®€ç§° fsï¼‰æ¨¡å—ä¸­çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œç”¨äºè°ƒæ•´ï¼ˆå³æˆªæ–­ï¼‰ä¸€ä¸ªæ–‡ä»¶çš„å¤§å°ã€‚å¦‚æœä½ æƒ³æ”¹å˜ä¸€ä¸ªæ–‡ä»¶çš„é•¿åº¦ï¼Œè®©å®ƒå˜å¾—æ›´é•¿æˆ–è€…æ›´çŸ­ï¼Œè¿™ä¸ªæ–¹æ³•å°±éå¸¸æœ‰ç”¨äº†ã€‚è¿™ä¸ªæ“ä½œç›´æ¥ä¿®æ”¹æ–‡ä»¶æœ¬èº«ï¼Œè€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ã€‚</p><h3 id="å‚æ•°è§£é‡Š-17" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-17"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><strong>path</strong>: è¿™æ˜¯è¦è¢«æˆªæ–­çš„æ–‡ä»¶çš„è·¯å¾„ã€‚</li><li><strong>len</strong> (å¯é€‰): è¿™æ˜¯æ–‡ä»¶æˆªæ–­ååº”è¯¥ä¿ç•™çš„å­—èŠ‚é•¿åº¦ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®š <code>len</code> æˆ–è€… <code>len</code> å¤§äºæ–‡ä»¶åŸå§‹å¤§å°ï¼Œåˆ™æ–‡ä»¶ä¸ä¼šè¢«æ‰©å±•ã€‚é»˜è®¤å€¼ä¸º <code>0</code>ï¼Œæ„å‘³ç€æ–‡ä»¶ä¼šè¢«æ¸…ç©ºã€‚</li><li><strong>callback</strong>: å½“æˆªæ–­æ“ä½œå®Œæˆæˆ–å‡ºç°é”™è¯¯æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªå›è°ƒå‡½æ•°ã€‚å®ƒå¸¦æœ‰ä¸€ä¸ªå‚æ•° <code>err</code>ï¼Œåœ¨æ“ä½œæˆåŠŸæ—¶ä¸º <code>null</code>ï¼Œå¦‚æœå‡ºé”™åˆ™åŒ…å«é”™è¯¯ä¿¡æ¯ã€‚</li></ul><h3 id="ä½¿ç”¨å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨å®ä¾‹"><span>ä½¿ç”¨å®ä¾‹</span></a></h3><h4 id="å®ä¾‹-1-æ¸…ç©ºä¸€ä¸ªæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-1-æ¸…ç©ºä¸€ä¸ªæ–‡ä»¶"><span>å®ä¾‹ 1: æ¸…ç©ºä¸€ä¸ªæ–‡ä»¶</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º<code>example.txt</code>çš„æ–‡ä»¶ï¼Œé‡Œé¢æœ‰ä¸€äº›å†…å®¹ï¼Œä½†ç°åœ¨æˆ‘ä»¬æƒ³æ¸…ç©ºè¿™ä¸ªæ–‡ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">truncate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²æ¸…ç©º</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç å°†<code>example.txt</code>çš„å†…å®¹æ¸…ç©ºã€‚é€šè¿‡å°†<code>len</code>è®¾ç½®ä¸º<code>0</code>ï¼Œæ–‡ä»¶å¤§å°å˜ä¸º 0 å­—èŠ‚ï¼Œå³å®Œå…¨æ¸…ç©ºæ–‡ä»¶ã€‚</p><h4 id="å®ä¾‹-2-ç¼©å‡æ–‡ä»¶å¤§å°" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-2-ç¼©å‡æ–‡ä»¶å¤§å°"><span>å®ä¾‹ 2: ç¼©å‡æ–‡ä»¶å¤§å°</span></a></h4><p>ç°åœ¨ï¼Œå‡è®¾<code>example.txt</code>æ–‡ä»¶çš„å¤§å°æ˜¯ 1024 å­—èŠ‚ï¼Œä½†æˆ‘ä»¬å¸Œæœ›åªä¿ç•™å‰ 512 å­—èŠ‚ï¼Œå¯ä»¥åƒè¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">truncate</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 512</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å¤§å°å·²è°ƒæ•´ä¸º512å­—èŠ‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å°†<code>example.txt</code>çš„å¤§å°è°ƒæ•´ä¸º 512 å­—èŠ‚ï¼Œä¿ç•™å¼€å§‹çš„ 512 å­—èŠ‚ï¼Œå…¶ä½™éƒ¨åˆ†è¢«ç§»é™¤ã€‚</p><h3 id="æ³¨æ„ç‚¹" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„ç‚¹"><span>æ³¨æ„ç‚¹</span></a></h3><ul><li>åœ¨ä½¿ç”¨<code>fs.truncate()</code>æ–¹æ³•æ—¶ï¼Œéœ€è¦æ³¨æ„æ–‡ä»¶æƒé™é—®é¢˜ã€‚å¦‚æœ Node.js è¿›ç¨‹æ²¡æœ‰æƒé™ä¿®æ”¹ç›®æ ‡æ–‡ä»¶ï¼Œæ“ä½œå°†å¤±è´¥å¹¶è¿”å›é”™è¯¯ã€‚</li><li>å¦‚æœæä¾›çš„è·¯å¾„æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼Œå°†ç›´æ¥å¯¹é“¾æ¥çš„ç›®æ ‡æ–‡ä»¶è¿›è¡Œæ“ä½œã€‚</li><li>è¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œè¿™æ„å‘¸ç€ Node.js ä¸ä¼šåœä¸‹æ¥ç­‰å¾…æ“ä½œå®Œæˆï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œä¹‹åçš„ä»£ç ã€‚å½“æ“ä½œå®Œæˆæ—¶ï¼ŒæŒ‡å®šçš„å›è°ƒå‡½æ•°å°†è¢«è°ƒç”¨ã€‚</li></ul><p><code>fs.truncate()</code>æ˜¯å¤„ç†æ–‡ä»¶å¤§å°è°ƒæ•´çš„æœ‰æ•ˆå·¥å…·ï¼Œæ— è®ºæ˜¯æ¸…ç©ºæ–‡ä»¶ã€ç¼©å‡è¿˜æ˜¯è°ƒæ•´æ–‡ä»¶åˆ°ç‰¹å®šå¤§å°ï¼Œéƒ½èƒ½å¾ˆå¥½åœ°å®Œæˆä»»åŠ¡ã€‚ä½¿ç”¨æ—¶ï¼Œåªéœ€ç¡®ä¿æ­£ç¡®å¤„ç†å›è°ƒä¸­å¯èƒ½å‡ºç°çš„é”™è¯¯ï¼Œä»¥åŠè€ƒè™‘åˆ°æƒé™å’Œè·¯å¾„æœ‰æ•ˆæ€§çš„é—®é¢˜ã€‚</p><h3 id="fs-unlink-path-callback" tabindex="-1"><a class="header-anchor" href="#fs-unlink-path-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsunlinkpath-callback" target="_blank" rel="noopener noreferrer">fs.unlink(path, callback)</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨ JavaScript åšå¾ˆå¤šäº‹æƒ…ï¼Œè€Œä¸ä»…ä»…æ˜¯åœ¨ç½‘é¡µä¸Šæ·»åŠ äº¤äº’æ€§ã€‚Node.js æä¾›äº†å¾ˆå¤šæ¨¡å—ï¼Œè¿™äº›æ¨¡å—åŒ…å«äº†ä¸€ç³»åˆ—çš„å‡½æ•°å’Œå¯¹è±¡ï¼Œç”¨äºå¤„ç†ä¸åŒç±»å‹çš„ä»»åŠ¡ã€‚å…¶ä¸­<code>fs</code>æ¨¡å—æ˜¯ä¸“é—¨ç”¨æ¥æ“ä½œæ–‡ä»¶ç³»ç»Ÿçš„ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>fs.unlink(path, callback)</code>æ˜¯<code>fs</code>æ¨¡å—æä¾›çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå¼‚æ­¥åœ°åˆ é™¤æ–‡ä»¶ï¼Œè¿™é‡Œæ‰€è¯´çš„â€œå¼‚æ­¥â€æ„å‘³ç€å½“ Node.js æ‰§è¡Œè¿™ä¸ªæ“ä½œæ—¶ï¼Œå®ƒä¸ä¼šåœä¸‹æ¥ç­‰å¾…æ“ä½œå®Œæˆï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œä¹‹åçš„ä»£ç ï¼Œç›´åˆ°æ–‡ä»¶è¢«åˆ é™¤ï¼Œç„¶åæ‰§è¡Œå›è°ƒå‡½æ•°ã€‚</p><h3 id="å‚æ•°è§£é‡Š-18" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-18"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>path</code>: è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºä½ æƒ³è¦åˆ é™¤çš„æ–‡ä»¶çš„è·¯å¾„ã€‚</li><li><code>callback</code>: è¿™æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå½“<code>unlink</code>æ“ä½œå®Œæˆæ—¶ï¼ŒNode.js ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œè¿™ä¸ªå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°å°†ä¼šæ˜¯<code>null</code>æˆ–è€…<code>undefined</code>ï¼›å¦‚æœæ“ä½œå¤±è´¥ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å°†ä¼šæ˜¯ä¸€ä¸ª<code>Error</code>å¯¹è±¡ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-14" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-14"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º<code>example.txt</code>çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬æƒ³è¦åœ¨æˆ‘ä»¬çš„ Node.js åº”ç”¨ç¨‹åºä¸­åˆ é™¤å®ƒã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥<code>fs</code>æ¨¡å—ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç„¶åï¼Œä½¿ç”¨<code>unlink</code>å‡½æ•°åˆ é™¤æ–‡ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unlink</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶åˆ é™¤å¤±è´¥:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶åˆ é™¤æˆåŠŸ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°è¯•åˆ é™¤å½“å‰ç›®å½•ä¸‹çš„<code>example.txt</code>æ–‡ä»¶ã€‚æˆ‘ä»¬ä¼ é€’äº†æ–‡ä»¶è·¯å¾„å’Œä¸€ä¸ªå›è°ƒå‡½æ•°ç»™<code>unlink</code>æ–¹æ³•ã€‚å¦‚æœæ–‡ä»¶æˆåŠŸè¢«åˆ é™¤ï¼Œæ§åˆ¶å°å°†ä¼šè¾“å‡ºâ€œæ–‡ä»¶åˆ é™¤æˆåŠŸâ€ã€‚å¦‚æœåˆ é™¤è¿‡ç¨‹ä¸­å‡ºé”™ï¼ˆä¾‹å¦‚ï¼Œæ–‡ä»¶ä¸å­˜åœ¨ï¼‰ï¼Œé”™è¯¯ä¿¡æ¯å°†ä¼šè¢«æ‰“å°å‡ºæ¥ã€‚</p><p>è¿™ç§å¼‚æ­¥æ–¹å¼å¯¹äºä¸é˜»å¡ç¨‹åºæ‰§è¡Œæµç¨‹éå¸¸æœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§é‡æ–‡ä»¶æˆ–è€—æ—¶æ“ä½œæ—¶ï¼Œå¯ä»¥ä¿æŒåº”ç”¨ç¨‹åºçš„å“åº”æ€§ã€‚</p><h3 id="fs-unwatchfile-filename-listener" tabindex="-1"><a class="header-anchor" href="#fs-unwatchfile-filename-listener"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsunwatchfilefilename-listener" target="_blank" rel="noopener noreferrer">fs.unwatchFile(filename[, listener])</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘å¾ˆé«˜å…´ä¸ºä½ è§£é‡Šè¿™ä¸ªæ¦‚å¿µã€‚</p><h3 id="node-js-ä¸­çš„fs-unwatchfile-filename-listener" tabindex="-1"><a class="header-anchor" href="#node-js-ä¸­çš„fs-unwatchfile-filename-listener"><span>Node.js ä¸­çš„<code>fs.unwatchFile(filename[, listener])</code></span></a></h3><p>åœ¨äº†è§£<code>fs.unwatchFile</code>ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ˜ç¡®å‡ ä¸ªæ¦‚å¿µã€‚Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“è¿è¡Œçš„ JavaScript ç¯å¢ƒï¼Œå®ƒä½¿å¾— JavaScript å¯ä»¥è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯ã€‚Node.js æä¾›äº†éå¸¸ä¸°å¯Œçš„å†…ç½®æ¨¡å—ï¼Œå…¶ä¸­<code>fs</code>æ¨¡å—æ˜¯ç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ã€‚é€šè¿‡<code>fs</code>æ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥è¯»å†™æ–‡ä»¶ã€ç›‘å¬æ–‡ä»¶å˜åŒ–ç­‰ã€‚</p><h4 id="ç›‘å¬æ–‡ä»¶å˜åŒ–" tabindex="-1"><a class="header-anchor" href="#ç›‘å¬æ–‡ä»¶å˜åŒ–"><span>ç›‘å¬æ–‡ä»¶å˜åŒ–</span></a></h4><p>åœ¨ä¸€äº›åœºæ™¯ä¸‹ï¼Œæ¯”å¦‚å¼€å‘ä¸€ä¸ªç½‘ç«™æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å®æ—¶ç›‘æ§æŸä¸ªæ–‡ä»¶çš„å˜åŒ–ï¼Œä»¥ä¾¿å½“æ–‡ä»¶å†…å®¹æ›´æ–°æ—¶è‡ªåŠ¨é‡æ–°åŠ è½½ã€‚Node.js çš„<code>fs</code>æ¨¡å—å…è®¸æˆ‘ä»¬å¯¹æ–‡ä»¶æˆ–ç›®å½•è¿›è¡Œç›‘è§†ï¼Œå½“å®ƒä»¬å‘ç”Ÿæ”¹å˜æ—¶å¯ä»¥è§¦å‘å›è°ƒå‡½æ•°ã€‚</p><h4 id="ä½¿ç”¨fs-watchfileæ·»åŠ ç›‘å¬" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨fs-watchfileæ·»åŠ ç›‘å¬"><span>ä½¿ç”¨<code>fs.watchFile</code>æ·»åŠ ç›‘å¬</span></a></h4><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs.watchFile(filename[, options], listener)</code>æ–¹æ³•è¢«ç”¨äºæ·»åŠ å¯¹æŒ‡å®šæ–‡ä»¶çš„ç›‘å¬ã€‚æ¯å½“æ–‡ä»¶è¢«è®¿é—®æˆ–è€…ä¿®æ”¹æ—¶ï¼Œè®¾ç½®çš„<code>listener</code>å›è°ƒå‡½æ•°å°±ä¼šè¢«è°ƒç”¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘å¬æ–‡ä»¶å˜åŒ–</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watchFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">curr</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> prev</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²æ›´æ–°</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šè¿°ä»£ç åˆ›å»ºäº†å¯¹åä¸º<code>example.txt</code>æ–‡ä»¶çš„ç›‘è§†ï¼Œä»»ä½•å¯¹è¯¥æ–‡ä»¶çš„ä¿®æ”¹éƒ½ä¼šå¯¼è‡´æ§åˆ¶å°è¾“å‡º&quot;æ–‡ä»¶å·²æ›´æ–°&quot;ã€‚</p><h4 id="ä½¿ç”¨fs-unwatchfileç§»é™¤ç›‘å¬" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨fs-unwatchfileç§»é™¤ç›‘å¬"><span>ä½¿ç”¨<code>fs.unwatchFile</code>ç§»é™¤ç›‘å¬</span></a></h4><p>é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬ä¸å†éœ€è¦å¯¹æ–‡ä»¶è¿›è¡Œç›‘è§†ï¼Œæˆ–è€…å¸Œæœ›åœæ­¢ç‰¹å®šçš„ç›‘å¬å™¨æ—¶ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿè¿™å°±æ˜¯<code>fs.unwatchFile(filename[, listener])</code>çš„ç”¨æ­¦ä¹‹åœ°ã€‚</p><p><code>fs.unwatchFile</code>æ–¹æ³•ç”¨äºç§»é™¤ä¹‹å‰ä½¿ç”¨<code>fs.watchFile</code>è®¾ç½®çš„ç›‘å¬å™¨ã€‚å¦‚æœä½ åªæƒ³ç§»é™¤ç‰¹å®šçš„ç›‘å¬å™¨ï¼Œå¯ä»¥ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’è¯¥ç›‘å¬å™¨å‡½æ•°ï¼›å¦‚æœä¸æä¾›ç›‘å¬å™¨ï¼Œåˆ™ç§»é™¤æ‰€æœ‰å¯¹è¯¥æ–‡ä»¶çš„ç›‘å¬ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®šä¹‰ç›‘å¬å‡½æ•°</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> onChange</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">curr</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> prev</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²æ›´æ–°</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ·»åŠ æ–‡ä»¶ç›‘å¬</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watchFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> onChange</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç¨åç§»é™¤ç›‘å¬</span></span>
<span class="line"><span style="color:#88C0D0;">setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unwatchFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> onChange</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›‘å¬å·²ç§»é™¤</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 10000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // 10ç§’åç§»é™¤ç›‘å¬</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨<code>fs.watchFile</code>ä¸º<code>example.txt</code>æ–‡ä»¶æ·»åŠ äº†ä¸€ä¸ªç›‘å¬å™¨<code>onChange</code>ã€‚ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡<code>setTimeout</code>è®¾ç½®äº†ä¸€ä¸ªå®šæ—¶å™¨ï¼Œåœ¨ 10 ç§’åä½¿ç”¨<code>fs.unwatchFile</code>ç§»é™¤ä¹‹å‰æ·»åŠ çš„ç›‘å¬å™¨ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬ä¼ é€’äº†ç›¸åŒçš„<code>onChange</code>å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿™è¡¨ç¤ºæˆ‘ä»¬åªæƒ³ç§»é™¤è¿™ä¸ªç‰¹å®šçš„ç›‘å¬å™¨ã€‚å¦‚æœ<code>fs.unwatchFile</code>è¢«è°ƒç”¨æ—¶æ²¡æœ‰æä¾›ç›‘å¬å™¨ï¼Œåˆ™ä¼šç§»é™¤å¯¹è¯¥æ–‡ä»¶çš„æ‰€æœ‰ç›‘å¬ã€‚</p><h3 id="å®é™…åº”ç”¨åœºæ™¯-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨åœºæ™¯-1"><span>å®é™…åº”ç”¨åœºæ™¯</span></a></h3><ul><li><strong>å¼€å‘ç¯å¢ƒä¸­çš„çƒ­é‡è½½</strong>ï¼šåœ¨ Web å¼€å‘ä¸­ï¼Œå¼€å‘è€…ç»å¸¸éœ€è¦åœ¨æºä»£ç è¢«ä¿®æ”¹åè‡ªåŠ¨é‡æ–°åŠ è½½æœåŠ¡æˆ–é¡µé¢ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚ä½¿ç”¨æ–‡ä»¶ç›‘å¬æœºåˆ¶å¯ä»¥è½»æ¾å®ç°è¿™ä¸€åŠŸèƒ½ã€‚</li><li><strong>ç›‘æ§é…ç½®æ–‡ä»¶å˜åŒ–</strong>ï¼šæŸäº›åº”ç”¨ç¨‹åºä»é…ç½®æ–‡ä»¶ä¸­è¯»å–å¯åŠ¨å‚æ•°æˆ–å…¶ä»–é…ç½®ã€‚é€šè¿‡å¯¹é…ç½®æ–‡ä»¶æ·»åŠ ç›‘è§†ï¼Œåº”ç”¨å¯ä»¥åœ¨ä¸é‡å¯çš„æƒ…å†µä¸‹ï¼Œå®æ—¶å“åº”é…ç½®çš„å˜æ›´ã€‚</li></ul><p>ç†è§£äº†<code>fs.watchFile</code>å’Œ<code>fs.unwatchFile</code>çš„ä½¿ç”¨åŠå…¶èƒŒæ™¯ï¼Œå¯ä»¥å¸®åŠ©ä½ åœ¨å®é™…å¼€å‘ä¸­æ›´çµæ´»åœ°å¤„ç†æ–‡ä»¶å˜åŠ¨ç›¸å…³çš„éœ€æ±‚ã€‚</p><h3 id="fs-utimes-path-atime-mtime-callback" tabindex="-1"><a class="header-anchor" href="#fs-utimes-path-atime-mtime-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsutimespath-atime-mtime-callback" target="_blank" rel="noopener noreferrer">fs.utimes(path, atime, mtime, callback)</a></span></a></h3><p>ç†è§£ <code>fs.utimes()</code> å‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæŒæ¡å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p><ol><li><strong>Node.js</strong>: ä¸€ä¸ªå¯ä»¥è®©ä½ ç”¨ JavaScript ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç çš„ç¯å¢ƒã€‚ç®€å•æ¥è¯´ï¼Œå®ƒè®© JavaScript èƒ½åœ¨æµè§ˆå™¨å¤–è¿è¡Œã€‚</li><li><strong>fs æ¨¡å—</strong>: fs ä»£è¡¨æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒæ˜¯ Node.js å†…ç½®çš„ä¸€ä¸ªæ¨¡å—ï¼Œæä¾›äº†å¾ˆå¤šç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„æ–¹æ³•ï¼Œæ¯”å¦‚è¯»å†™æ–‡ä»¶ã€æ›´æ”¹æ–‡ä»¶æƒé™ç­‰ã€‚</li><li><strong>path</strong>: åœ¨è®¡ç®—æœºä¸­ï¼ŒæŒ‡çš„æ˜¯æ–‡ä»¶æˆ–ç›®å½•åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä½ç½®ã€‚</li><li><strong>atime (Access Time)</strong>: æŒ‡æ–‡ä»¶æœ€åè¢«è®¿é—®çš„æ—¶é—´ã€‚</li><li><strong>mtime (Modified Time)</strong>: æŒ‡æ–‡ä»¶å†…å®¹æœ€åè¢«ä¿®æ”¹çš„æ—¶é—´ã€‚</li></ol><p><code>fs.utimes()</code> æ˜¯ <code>fs</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæ›´æ”¹æ–‡ä»¶çš„è®¿é—®ï¼ˆatimeï¼‰å’Œä¿®æ”¹æ—¶é—´ï¼ˆmtimeï¼‰ã€‚è¿™å¯¹äºæŸäº›ç‰¹å®šåœºæ™¯ä¸‹ç®¡ç†æ–‡ä»¶éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚ç¼“å­˜ç­–ç•¥ã€æ–‡ä»¶åŒæ­¥æˆ–è€…ä»…ä»…æ˜¯è·Ÿè¸ªæ–‡ä»¶çš„ä½¿ç”¨æƒ…å†µã€‚</p><p>å‡½æ•°çš„ç­¾åå¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">utimes</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> atime</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> mtime</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> callback</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><strong>path</strong>ï¼šè¦ä¿®æ”¹æ—¶é—´çš„æ–‡ä»¶è·¯å¾„ã€‚</li><li><strong>atime</strong>ï¼šæ–°çš„è®¿é—®æ—¶é—´ï¼Œå¯ä»¥æ˜¯ Date å¯¹è±¡ã€è¡¨ç¤ºç§’çš„æ•°å€¼æˆ–ä»£è¡¨ Unix çºªå…ƒä»¥æ¥æ¯«ç§’æ•°çš„æ•°å€¼ã€‚</li><li><strong>mtime</strong>ï¼šæ–°çš„ä¿®æ”¹æ—¶é—´ï¼Œæ ¼å¼ä¸ atime ç›¸åŒã€‚</li><li><strong>callback</strong>ï¼šä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“<code>utimes</code>æ“ä½œå®Œæˆæˆ–å‘ç”Ÿé”™è¯¯æ—¶è¢«è°ƒç”¨ã€‚å¦‚æœæˆåŠŸï¼Œé”™è¯¯å‚æ•°ä¸º nullã€‚</li></ul><h3 id="å®é™…åº”ç”¨ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-4"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><h4 id="æ›´æ–°æ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´" tabindex="-1"><a class="header-anchor" href="#æ›´æ–°æ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´"><span>æ›´æ–°æ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œå…¶ä¸­åŒ…å«ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶ã€‚ä¸ºäº†ç»´æŠ¤è¿™äº›æ–‡ä»¶ï¼Œä½ å¯èƒ½æƒ³åœ¨ç”¨æˆ·æŸ¥çœ‹è¿™äº›æ–‡ä»¶åæ›´æ–°å…¶è®¿é—®æ—¶é—´ï¼Œæˆ–åœ¨æ–‡ä»¶å†…å®¹è¢«ç¼–è¾‘åæ›´æ–°å…¶ä¿®æ”¹æ—¶é—´ã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦å¯¼å…¥ fs æ¨¡å—ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç„¶åï¼Œå‡è®¾æœ‰ä¸€ä¸ªæ–‡ä»¶è·¯å¾„æ˜¯ <code>&#39;/path/to/your/file.txt&#39;</code>ï¼Œä½ æƒ³å°†å…¶è®¿é—®å’Œä¿®æ”¹æ—¶é—´éƒ½æ›´æ–°ä¸ºå½“å‰æ—¶é—´ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/your/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> now</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">utimes</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> now</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> now</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶è®¿é—®å’Œä¿®æ”¹æ—¶é—´å·²æ›´æ–°ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ<code>now</code> æ˜¯å½“å‰æ—¶é—´çš„ <code>Date</code> å¯¹è±¡ï¼ŒåŒæ—¶ä½œä¸º <code>atime</code> å’Œ <code>mtime</code> çš„å€¼ä¼ é€’ç»™ <code>fs.utimes()</code>ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œæ§åˆ¶å°ä¼šè¾“å‡ºâ€œæ–‡ä»¶è®¿é—®å’Œä¿®æ”¹æ—¶é—´å·²æ›´æ–°ï¼â€ã€‚å¦‚æœæœ‰ä»»ä½•é”™è¯¯å‘ç”Ÿï¼Œæ¯”å¦‚æ–‡ä»¶ä¸å­˜åœ¨ï¼Œé”™è¯¯ä¿¡æ¯ä¼šè¢«æ‰“å°åˆ°æ§åˆ¶å°ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥çµæ´»åœ°ç®¡ç†æ–‡ä»¶çš„æ—¶é—´å±æ€§ï¼Œæ»¡è¶³ä½ çš„åº”ç”¨éœ€æ±‚ã€‚</p><h3 id="fs-watch-filename-options-listener" tabindex="-1"><a class="header-anchor" href="#fs-watch-filename-options-listener"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fswatchfilename-options-listener" target="_blank" rel="noopener noreferrer">fs.watch(filename[, options][, listener])</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚<code>fs.watch()</code> æ–¹æ³•æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿ(<code>fs</code>)æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œè¿™ä¸ªæ–¹æ³•ç”¨äºç›‘å¬ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„å˜åŒ–ï¼ˆæ¯”å¦‚æ–‡ä»¶è¢«ä¿®æ”¹ã€åˆ é™¤ç­‰ï¼‰ã€‚</p><p>å½“ä½ ä½¿ç”¨ <code>fs.watch()</code> æ¥ç›‘å¬ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•æ—¶ï¼Œæ¯å½“æŒ‡å®šçš„æ–‡ä»¶æˆ–ç›®å½•å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šè§¦å‘å›è°ƒå‡½æ•°ï¼ˆå¦‚æœä½ æä¾›äº†å›è°ƒå‡½æ•°çš„è¯ï¼‰ã€‚è¿™å¯¹äºå¼€å‘éœ€è¦å®æ—¶å“åº”æ–‡ä»¶ç³»ç»Ÿå˜åŒ–çš„åº”ç”¨ç¨‹åºéå¸¸æœ‰ç”¨ï¼Œä¾‹å¦‚è‡ªåŠ¨ç¼–è¯‘ã€è‡ªåŠ¨æµ‹è¯•ã€æ–‡ä»¶åŒæ­¥å·¥å…·ç­‰ã€‚</p><h3 id="å‚æ•°è§£é‡Š-19" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-19"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>filename</code>: è¦ç›‘è§†çš„æ–‡ä»¶æˆ–ç›®å½•çš„åå­—ã€‚</li><li><code>options</code>: å¯é€‰å‚æ•°ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥è®¾ç½®ä¸€äº›é¢å¤–çš„é…ç½®ã€‚ <ul><li><code>persistent</code>: é»˜è®¤ä¸º <code>true</code>ï¼Œæ„å‘³ç€è¿›ç¨‹åº”è¯¥åœ¨ç›‘å¬æ—¶ä¿æŒæ´»åŠ¨çŠ¶æ€ã€‚</li><li><code>recursive</code>: å¯¹äºç›®å½•ï¼ŒæŒ‡å®šæ˜¯å¦åº”è¯¥é€’å½’åœ°ç›‘å¬å…¶å†…éƒ¨æ‰€æœ‰å­ç›®å½•çš„å˜åŒ–ã€‚æ³¨æ„ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰å¹³å°éƒ½æ”¯æŒæ­¤é€‰é¡¹ã€‚</li><li><code>encoding</code>: æŒ‡å®šç”¨äºä¼ é€’ç»™ç›‘å¬å™¨çš„æ–‡ä»¶åçš„å­—ç¬¦ç¼–ç ï¼Œé»˜è®¤ä¸º <code>&#39;utf8&#39;</code>ã€‚</li></ul></li><li><code>listener</code>: å½“æ–‡ä»¶æ›´æ”¹æ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š <ul><li><code>eventType</code>: è¡¨ç¤ºæ‰€å‘ç”Ÿçš„äº‹ä»¶ç±»å‹ï¼Œé€šå¸¸æ˜¯ <code>&#39;rename&#39;</code> æˆ– <code>&#39;change&#39;</code>ã€‚</li><li><code>filename</code>: å‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶çš„åç§°ã€‚</li></ul></li></ul><h3 id="ä½¿ç”¨ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­-4"><span>ä½¿ç”¨ä¾‹å­</span></a></h3><h4 id="åŸºæœ¬ç”¨æ³•-2" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç”¨æ³•-2"><span>åŸºæœ¬ç”¨æ³•</span></a></h4><p>ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•ç›‘å¬ä¸€ä¸ªæ–‡ä»¶çš„å˜åŒ–ï¼Œå¹¶æ‰“å°å‡ºå˜åŒ–çš„ç±»å‹ä»¥åŠå‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶åã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘å¬ &#39;example.txt&#39; æ–‡ä»¶çš„å˜åŒ–</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> filename</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶ </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filename</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> å‘ç”Ÿäº†å˜åŒ–ï¼Œå˜åŒ–ç±»å‹ä¸º </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">eventType</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä½ ä¿å­˜ä¸Šé¢çš„ä»£ç åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå¹¶è¿è¡Œå®ƒï¼Œç„¶åå»ä¿®æ”¹ã€é‡å‘½åæˆ–åˆ é™¤ <code>example.txt</code> æ–‡ä»¶ï¼Œä½ å°†åœ¨æ§åˆ¶å°çœ‹åˆ°ç›¸åº”çš„å˜åŒ–ä¿¡æ¯ã€‚</p><h4 id="ç›‘å¬ç›®å½•" tabindex="-1"><a class="header-anchor" href="#ç›‘å¬ç›®å½•"><span>ç›‘å¬ç›®å½•</span></a></h4><p>ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•é€’å½’åœ°ç›‘å¬ä¸€ä¸ªç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•çš„å˜åŒ–ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// é€’å½’åœ°ç›‘å¬ &#39;myDirectory&#39; ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">myDirectory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> recursive</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> filename</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">    `</span><span style="color:#A3BE8C;">åœ¨ç›®å½• myDirectory ä¸­ï¼Œæ–‡ä»¶ </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filename</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> å‘ç”Ÿäº†å˜åŒ–ï¼Œå˜åŒ–ç±»å‹ä¸º </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">eventType</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  )</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šç›‘å¬ <code>myDirectory</code> ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ä¸­æ–‡ä»¶çš„å˜åŒ–ï¼Œå½“ä»»ä½•ä¸€ä¸ªæ–‡ä»¶å‘ç”Ÿå˜åŒ–æ—¶ï¼Œéƒ½ä¼šè¾“å‡ºç›¸å…³ä¿¡æ¯ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-14" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-14"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>ä½¿ç”¨ <code>fs.watch()</code> æ—¶éœ€è¦æ³¨æ„ï¼Œå…¶åœ¨ä¸åŒå¹³å°ä¸Šçš„è¡¨ç°å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œå› ä¸ºå®ƒä¾èµ–äºåº•å±‚æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿäº‹ä»¶é€šçŸ¥æœºåˆ¶ã€‚</li><li>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šè§‚å¯Ÿåˆ°é‡å¤çš„äº‹ä»¶é€šçŸ¥ï¼Œç‰¹åˆ«æ˜¯åœ¨ä½¿ç”¨æŸäº›ç¼–è¾‘å™¨æˆ– IDE æ—¶ã€‚</li><li>ç›‘å¬å¤§é‡æ–‡ä»¶æˆ–ç›®å½•æ—¶ï¼Œè¯·è€ƒè™‘æ½œåœ¨çš„æ€§èƒ½å½±å“ã€‚</li></ul><p>é€šè¿‡åˆç†åˆ©ç”¨ <code>fs.watch()</code>ï¼Œä½ å¯ä»¥ä¸ºä½ çš„åº”ç”¨ç¨‹åºæ·»åŠ å¼ºå¤§çš„å®æ—¶æ–‡ä»¶ç³»ç»Ÿç›‘æ§åŠŸèƒ½ï¼Œä»è€Œå“åº”å„ç§æ–‡ä»¶ç³»ç»Ÿäº‹ä»¶ã€‚</p><h4 id="caveats" tabindex="-1"><a class="header-anchor" href="#caveats"><span><a href="https://nodejs.org/docs/latest/api/fs.html#caveats" target="_blank" rel="noopener noreferrer">Caveats</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ç”¨äºæ„å»ºæœåŠ¡å™¨å’Œå‘½ä»¤è¡Œå·¥å…·çš„å¹³å°ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>fs</code>æ¨¡å—æä¾›äº†ä¸æ–‡ä»¶ç³»ç»Ÿçš„äº¤äº’èƒ½åŠ›ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥åˆ›å»ºã€è¯»å–ã€ä¿®æ”¹ä»¥åŠåˆ é™¤æ–‡ä»¶ç­‰ã€‚ä¸è¿‡ï¼Œåœ¨ä½¿ç”¨<code>fs</code>æ¨¡å—æ—¶ï¼Œæœ‰å‡ ä¸ªæ³¨æ„äº‹é¡¹ï¼ˆCaveatsï¼‰éœ€è¦äº†è§£ã€‚</p><p>ç”±äº Node.js çš„æ–‡æ¡£å¯èƒ½ä¼šæ›´æ–°ï¼Œæˆ‘å°†åŸºäºå¯¹ Node.js åŠå…¶æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—çš„é€šç”¨ç†è§£ï¼Œè§£é‡Šä¸€äº›å¯èƒ½å­˜åœ¨çš„æ³¨æ„äº‹é¡¹ï¼Œå¹¶ç»™å‡ºå®é™…åº”ç”¨çš„ä¾‹å­ã€‚</p><h3 id="_1-å¼‚æ­¥ä¸åŒæ­¥" tabindex="-1"><a class="header-anchor" href="#_1-å¼‚æ­¥ä¸åŒæ­¥"><span>1. å¼‚æ­¥ä¸åŒæ­¥</span></a></h3><p>Node.js ä¸­çš„<code>fs</code>æ¨¡å—æä¾›äº†å¼‚æ­¥å’ŒåŒæ­¥ä¸¤ç§æ“ä½œæ–¹å¼ã€‚å¼‚æ­¥æ–¹æ³•ä¸ä¼šé˜»å¡ç¨‹åºçš„æ‰§è¡Œï¼Œè€ŒåŒæ­¥æ–¹æ³•åˆ™ä¼šã€‚åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©åˆé€‚çš„æ–¹æ³•ã€‚</p><ul><li><strong>å¼‚æ­¥æ“ä½œç¤ºä¾‹</strong>ï¼šå‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™ï¼Œéœ€è¦ä»æ–‡ä»¶ä¸­è¯»å–å†…å®¹æ˜¾ç¤ºç»™ç”¨æˆ·ã€‚ä½¿ç”¨å¼‚æ­¥æ–¹æ³•è¯»å–æ–‡ä»¶ï¼Œå¯ä»¥é¿å…æœåŠ¡å™¨åœ¨ç­‰å¾…æ–‡ä»¶è¯»å–å®Œæˆæ—¶æ— æ³•å“åº”å…¶ä»–ç”¨æˆ·çš„è¯·æ±‚ã€‚</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>åŒæ­¥æ“ä½œç¤ºä¾‹</strong>ï¼šå¦‚æœä½ æ­£åœ¨å†™ä¸€ä¸ªç®€å•çš„è„šæœ¬æ‰§è¡Œä¸€æ¬¡æ€§ä»»åŠ¡ï¼Œå¦‚é…ç½®ç¯å¢ƒæ—¶ï¼Œä½¿ç”¨åŒæ­¥æ–¹æ³•å¯ä»¥è®©ä»£ç æ›´å®¹æ˜“ç†è§£å’Œæ§åˆ¶æµç¨‹ã€‚</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-é”™è¯¯å¤„ç†" tabindex="-1"><a class="header-anchor" href="#_2-é”™è¯¯å¤„ç†"><span>2. é”™è¯¯å¤„ç†</span></a></h3><p>é”™è¯¯å¤„ç†æ˜¯æ–‡ä»¶æ“ä½œä¸­æä¸ºé‡è¦çš„éƒ¨åˆ†ã€‚åœ¨å¼‚æ­¥æ–¹æ³•ä¸­ï¼Œé”™è¯¯é€šå¸¸ä½œä¸ºå›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°è¿”å›ï¼›è€Œåœ¨åŒæ­¥æ–¹æ³•ä¸­ï¼Œåˆ™é€šè¿‡æŠ›å‡ºå¼‚å¸¸çš„æ–¹å¼å¤„ç†ã€‚</p><h3 id="_3-è·¯å¾„è€ƒè™‘" tabindex="-1"><a class="header-anchor" href="#_3-è·¯å¾„è€ƒè™‘"><span>3. è·¯å¾„è€ƒè™‘</span></a></h3><p>åœ¨ä½¿ç”¨<code>fs</code>æ¨¡å—è¿›è¡Œæ–‡ä»¶æ“ä½œæ—¶ï¼Œè·¯å¾„çš„å¤„ç†æ˜¯ä¸€ä¸ªéœ€è¦æ³¨æ„çš„é—®é¢˜ã€‚ç›¸å¯¹è·¯å¾„åœ¨ä¸åŒçš„è¿è¡Œç¯å¢ƒä¸‹å¯èƒ½ä¼šå¼•èµ·æ··æ·†ï¼Œå› æ­¤æ¨èä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿è·¯å¾„çš„å‡†ç¡®æ€§ã€‚Node.js ä¸­çš„<code>path</code>æ¨¡å—æä¾›äº†å¾ˆå¥½çš„å·¥å…·æ¥å¤„ç†è·¯å¾„ç›¸å…³é—®é¢˜ã€‚</p><h3 id="_4-æ€§èƒ½è€ƒè™‘" tabindex="-1"><a class="header-anchor" href="#_4-æ€§èƒ½è€ƒè™‘"><span>4. æ€§èƒ½è€ƒè™‘</span></a></h3><p>åœ¨å¤„ç†å¤§å‹æ–‡ä»¶æˆ–é«˜é¢‘ç‡çš„æ–‡ä»¶æ“ä½œæ—¶ï¼Œæ€§èƒ½æˆä¸ºéœ€è¦è€ƒé‡çš„å¦ä¸€ä¸ªå› ç´ ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨æµï¼ˆStreamsï¼‰æ¥å¤„ç†å¤§å‹æ–‡ä»¶ï¼Œå¯ä»¥è¾ƒå°åœ°å ç”¨å†…å­˜ï¼Œå› ä¸ºå®ƒä»¬å…è®¸æ•°æ®è¢«åˆ†å—å¤„ç†ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-6" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-6"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><ul><li><p><strong>Web æœåŠ¡å™¨æ—¥å¿—è®°å½•</strong>ï¼šå¯ä»¥ä½¿ç”¨<code>fs</code>æ¨¡å—çš„å¼‚æ­¥æ–¹æ³•è®°å½•æ¯ä¸ªè¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œè€Œä¸ä¼šå½±å“åˆ°æœåŠ¡å™¨å¯¹è¯·æ±‚çš„å¤„ç†é€Ÿåº¦ã€‚</p></li><li><p><strong>é…ç½®æ–‡ä»¶è¯»å–</strong>ï¼šåœ¨åº”ç”¨å¯åŠ¨æ—¶ï¼Œå¯ä»¥ä½¿ç”¨<code>fs</code>æ¨¡å—çš„åŒæ­¥æ–¹æ³•è¯»å–é…ç½®æ–‡ä»¶ï¼Œè¿™æ ·åœ¨ç¨‹åºç»§ç»­æ‰§è¡Œä¹‹å‰å°±èƒ½ç¡®ä¿æ‰€æœ‰å¿…è¦çš„é…ç½®å·²ç»åŠ è½½å®Œæˆã€‚</p></li><li><p><strong>å¤§æ–‡ä»¶å¤„ç†</strong>ï¼šå¤„ç†å¤§å‹æ—¥å¿—æ–‡ä»¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨<code>fs</code>æ¨¡å—çš„æµå¼æ¥å£(<code>fs.createReadStream</code>)é€è¡Œè¯»å–æ–‡ä»¶å†…å®¹ï¼Œä»¥å‡å°‘å†…å­˜çš„æ¶ˆè€—ã€‚</p></li></ul><p>é€šè¿‡åˆç†åœ°åˆ©ç”¨<code>fs</code>æ¨¡å—æä¾›çš„åŠŸèƒ½ï¼Œä»¥åŠæ³¨æ„ä¸Šè¿°çš„å‡ ç‚¹ï¼Œä½ å¯ä»¥æœ‰æ•ˆåœ°ç®¡ç†å’Œæ“çºµæ–‡ä»¶ç³»ç»Ÿï¼Œè®©ä½ çš„ Node.js åº”ç”¨æ›´åŠ å¥å£®å’Œé«˜æ•ˆã€‚</p><h5 id="availability" tabindex="-1"><a class="header-anchor" href="#availability"><span><a href="https://nodejs.org/docs/latest/api/fs.html#availability" target="_blank" rel="noopener noreferrer">Availability</a></span></a></h5><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨ JavaScript æ¥ç¼–å†™åç«¯ä»£ç ï¼Œå°±åƒä½ é€šå¸¸åœ¨æµè§ˆå™¨ä¸­åšçš„é‚£æ ·ã€‚Node.js çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§æ˜¯å®ƒçš„éé˜»å¡ I/O æ¨¡å‹ï¼Œè¿™ä½¿å¾—å®ƒç‰¹åˆ«é€‚åˆå¤„ç†å¤§é‡å¹¶å‘è¿æ¥ï¼Œè¿™åœ¨æ„å»ºé«˜æ€§èƒ½æœåŠ¡å™¨æˆ–å®æ—¶æ•°æ®å¤„ç†åº”ç”¨æ—¶éå¸¸æœ‰ç”¨ã€‚</p><p>åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­æåˆ°çš„ &quot;Availability&quot; é€šå¸¸æŒ‡çš„æ˜¯æŸä¸ªç‰¹å®šåŠŸèƒ½æˆ– API åœ¨ä¸åŒç‰ˆæœ¬å’Œå¹³å°ä¸Šçš„å¯ç”¨æ€§ã€‚ç”±äº Node.js ä¸æ–­æ›´æ–°è¿­ä»£ï¼Œå¼•å…¥æ–°çš„ç‰¹æ€§åŒæ—¶ä¹Ÿå¯èƒ½ä¼šåºŸå¼ƒä¸€äº›æ—§çš„ï¼Œäº†è§£å„ä¸ª API çš„å¯ç”¨æ€§å¯¹äºå¼€å‘è€…æ¥è¯´éå¸¸é‡è¦ï¼Œä»¥ç¡®ä¿ä»–ä»¬ç¼–å†™çš„ä»£ç èƒ½å¤Ÿè·¨å¹³å°ã€è·¨ç‰ˆæœ¬åœ°æ­£å¸¸å·¥ä½œã€‚</p><p>ä»¥ <code>fs</code> (æ–‡ä»¶ç³»ç»Ÿ) æ¨¡å—ä¸ºä¾‹ï¼Œå®ƒæ˜¯ Node.js ä¸­ç”¨äºæ–‡ä»¶æ“ä½œçš„æ ¸å¿ƒæ¨¡å—ï¼Œæä¾›äº†åˆ›å»ºã€è¯»å–ã€å†™å…¥ã€åˆ é™¤æ–‡ä»¶ç­‰åŠŸèƒ½ã€‚å½“è®¨è®º <code>fs</code> æ¨¡å—çš„ &quot;Availability&quot; æ—¶ï¼Œæˆ‘ä»¬å…³æ³¨çš„æ˜¯å“ªäº›å‡½æ•°å¯ç”¨ã€å®ƒä»¬åœ¨ä»€ä¹ˆç‰ˆæœ¬è¢«åŠ å…¥æˆ–å¯èƒ½åœ¨å°†æ¥çš„ç‰ˆæœ¬ä¸­è¢«å¼ƒç”¨ã€‚</p><p><strong>å®é™…è¿ç”¨çš„ä¾‹å­:</strong></p><ol><li><p><strong>æ–‡ä»¶è¯»å†™:</strong> å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåšå®¢ç³»ç»Ÿï¼Œä½ å¯èƒ½éœ€è¦ç”¨åˆ° <code>fs</code> æ¨¡å—æ¥ä¿å­˜æ–‡ç« åˆ°æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚ä½¿ç”¨ <code>fs.writeFile</code> æ–¹æ³•å¯ä»¥è½»æ¾åœ°å°†å†…å®¹å†™å…¥æ–‡ä»¶ï¼Œè€Œ <code>fs.readFile</code> æ–¹æ³•åˆ™ç”¨äºè¯»å–æ–‡ä»¶å†…å®¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å†™å…¥æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">è¿™é‡Œæ˜¯æ–‡ç« å†…å®¹</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ç« å·²ä¿å­˜ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>ç›‘æ§æ–‡ä»¶å˜åŒ–:</strong> å¦‚æœä½ å¸Œæœ›åœ¨æ–‡ä»¶è¢«ä¿®æ”¹æ—¶å³æ—¶å¾—åˆ°é€šçŸ¥ï¼ˆä¾‹å¦‚ï¼Œè‡ªåŠ¨é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>fs.watch</code> æ–¹æ³•ç›‘å¬æ–‡ä»¶æˆ–ç›®å½•çš„å˜åŒ–ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> filename</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶å‘ç”Ÿæ”¹å˜: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filename</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">, ç±»å‹: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">eventType</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>éå†ç›®å½•:</strong> åœ¨å¼€å‘ä¸€ä¸ªæ–‡ä»¶ç®¡ç†å™¨æˆ–éœ€è¦å¤„ç†å¤§é‡æ–‡ä»¶çš„ä»»åŠ¡æ—¶ï¼Œåˆ—å‡ºç›®å½•ä¸­çš„æ–‡ä»¶æ˜¯å¾ˆå¸¸è§çš„éœ€æ±‚ã€‚<code>fs.readdir</code> æ–¹æ³•å…è®¸ä½ è¯»å–ç›®å½•ä¸­çš„æ–‡ä»¶åˆ—è¡¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> files</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  files</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forEach</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">file</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">file</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>æ€»ä¹‹ï¼Œäº†è§£ Node.js å„ä¸ªç‰ˆæœ¬çš„ &quot;Availability&quot; å¯¹äºå¼€å‘å¥å£®ã€å…¼å®¹ä¸”æŒä¹…çš„åº”ç”¨è‡³å…³é‡è¦ã€‚éšç€ Node.js çš„å¿«é€Ÿå‘å±•ï¼Œä¿æŒå¯¹æ–‡æ¡£çš„å…³æ³¨å’Œå­¦ä¹ æœ€æ–°çš„åŠŸèƒ½ç‰¹æ€§æ˜¯æ¯ä¸ª Node.js å¼€å‘è€…çš„å¿…ä¿®è¯¾ã€‚</p><h5 id="inodes" tabindex="-1"><a class="header-anchor" href="#inodes"><span><a href="https://nodejs.org/docs/latest/api/fs.html#inodes" target="_blank" rel="noopener noreferrer">Inodes</a></span></a></h5><p>Node.js æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ JavaScript è¿è¡Œæ—¶ï¼Œä½¿å¾— JavaScript å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œã€‚å…¶ä¸­ï¼Œ<code>fs</code> æ¨¡å—æä¾›äº†ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº‘çš„åŠŸèƒ½ï¼Œè¿™å¯¹äºè¯»å–ã€å†™å…¥ã€ä¿®æ”¹æ–‡ä»¶ç­‰æ“ä½œéå¸¸æœ‰ç”¨ã€‚ä½†å…ˆçº æ­£ä¸€ä¸ªå°è¯¯ä¼šï¼šNode.js çš„æ–‡æ¡£é‡Œæåˆ°çš„ &quot;inodes&quot; å¹¶ä¸æ˜¯ç‰¹æŒ‡ Node.js v21.7.1 ç‰ˆæœ¬çš„æ–°åŠŸèƒ½ï¼Œè€Œæ˜¯ä¸€ä¸ªæ›´å¹¿æ³›çš„è®¡ç®—æœºæ–‡ä»¶ç³»ç»Ÿçš„æ¦‚å¿µã€‚</p><h3 id="inodes-åŸºç¡€è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#inodes-åŸºç¡€è§£é‡Š"><span>Inodes åŸºç¡€è§£é‡Š</span></a></h3><p>åœ¨ UNIX-like ç³»ç»Ÿä¸­ï¼ˆLinuxã€macOS ç­‰ï¼‰ï¼Œinode æ˜¯æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€ä¸ªæå…¶é‡è¦çš„æ¦‚å¿µã€‚ä¸€ä¸ª inode åŒ…å«äº†å…³äºæ–‡ä»¶ç³»ç»Ÿä¸­æŸä¸ªæ–‡ä»¶çš„å…ƒæ•°æ®(metadata)ï¼Œä½†ä¸åŒ…å«æ–‡ä»¶åæˆ–è€…æ–‡ä»¶æ•°æ®ã€‚å…ƒæ•°æ®åŒ…æ‹¬æ–‡ä»¶çš„æƒé™ï¼ˆè°å¯ä»¥è¯»/å†™/æ‰§è¡Œï¼‰ã€æ‰€æœ‰è€…ä¿¡æ¯ã€æ–‡ä»¶å¤§å°ã€åˆ›å»ºå’Œä¿®æ”¹æ—¶é—´ç­‰ã€‚æ¯ä¸ªæ–‡ä»¶éƒ½å”¯ä¸€å¯¹åº”ä¸€ä¸ª inodeï¼Œé€šè¿‡ inode å¯ä»¥è®¿é—®åˆ°å­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„æ–‡ä»¶æ•°æ®ã€‚</p><h3 id="node-js-ä¸-inodes" tabindex="-1"><a class="header-anchor" href="#node-js-ä¸-inodes"><span>Node.js ä¸ Inodes</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œä½ å¯èƒ½ç›´æ¥ä¸æ–‡ä»¶åæ‰“äº¤é“ï¼Œè€Œä¸æ˜¯ inode ç¼–å·ã€‚ç„¶è€Œï¼Œç†è§£ inode çš„æ¦‚å¿µå¯¹äºé«˜çº§æ–‡ä»¶æ“ä½œç›¸å½“é‡è¦ï¼Œæ¯”å¦‚æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€æƒé™ç®¡ç†ã€é“¾æ¥æ–‡ä»¶ç­‰ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€äº›ä½¿ç”¨ Node.js å¯¹æ–‡ä»¶è¿›è¡Œæ“ä½œçš„ä¾‹å­ï¼Œè¿™äº›æ“ä½œèƒŒåéƒ½ä¸ inode ç›¸å…³è”ï¼š</p><h4 id="_1-è¯»å–æ–‡ä»¶çš„å…ƒæ•°æ®" tabindex="-1"><a class="header-anchor" href="#_1-è¯»å–æ–‡ä»¶çš„å…ƒæ•°æ®"><span>1. è¯»å–æ–‡ä»¶çš„å…ƒæ•°æ®</span></a></h4><p>Node.js æä¾›äº† <code>fs.stat()</code> æ–¹æ³•æ¥å¼‚æ­¥è·å–æ–‡ä»¶çš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å®é™…ä¸Šæ˜¯ä» inode ä¸­è·å–çš„ã€‚ä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥è¯»å–æ–‡ä»¶å…ƒæ•°æ®</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œçš„ <code>stats</code> å¯¹è±¡åŒ…å«äº†æ–‡ä»¶çš„å¤§å°ã€åˆ›å»ºå’Œä¿®æ”¹æ—¶é—´ç­‰ä¿¡æ¯ã€‚</p><h4 id="_2-åˆ›å»ºç¡¬é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#_2-åˆ›å»ºç¡¬é“¾æ¥"><span>2. åˆ›å»ºç¡¬é“¾æ¥</span></a></h4><p>ç¡¬é“¾æ¥æŒ‡å‘æ–‡ä»¶ç³»ç»Ÿä¸­çš„åŒä¸€ inodeã€‚åˆ›å»ºç¡¬é“¾æ¥æ„å‘³ç€ä¸¤ä¸ªæ–‡ä»¶åæŒ‡å‘åŒä¸€ä¸ªæ–‡ä»¶ã€‚Node.js é€šè¿‡ <code>fs.link()</code> æ–¹æ³•æ”¯æŒè¿™ä¸€æ“ä½œï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªç¡¬é“¾æ¥</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">link</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/original</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/link</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç¡¬é“¾æ¥åˆ›å»ºæˆåŠŸ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œ <code>/path/to/original</code> å’Œ <code>/path/to/link</code> éƒ½æŒ‡å‘åŒä¸€ä¸ªæ–‡ä»¶å†…å®¹å’Œ inodeï¼Œä½†å®ƒä»¬æœ‰ä¸åŒçš„æ–‡ä»¶åã€‚</p><h4 id="_3-æŸ¥çœ‹æ–‡ä»¶æƒé™" tabindex="-1"><a class="header-anchor" href="#_3-æŸ¥çœ‹æ–‡ä»¶æƒé™"><span>3. æŸ¥çœ‹æ–‡ä»¶æƒé™</span></a></h4><p>é€šè¿‡è¯»å– inode çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥æ–‡ä»¶çš„æƒé™ï¼Œè¿™å¯¹äºå®‰å…¨ç›¸å…³çš„æ“ä½œéå¸¸é‡è¦ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶æƒé™: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mode</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å°ç»“-8" tabindex="-1"><a class="header-anchor" href="#å°ç»“-8"><span>å°ç»“</span></a></h3><p>å°½ç®¡åœ¨ä½¿ç”¨ Node.js æ—¶ï¼Œä½ å¯èƒ½ä¸ä¼šç›´æ¥ä¸ inodes æ‰“äº¤é“ï¼Œä½†äº†è§£å®ƒä»¬çš„å­˜åœ¨å’Œå®ƒä»¬åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä½œç”¨æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ï¼Œç‰¹åˆ«æ˜¯å½“ä½ éœ€è¦è¿›è¡Œæ–‡ä»¶çº§åˆ«çš„æ“ä½œï¼Œå¦‚æƒé™ç®¡ç†ã€é“¾æ¥ã€æ–‡ä»¶çŠ¶æ€æ£€æŸ¥ç­‰ã€‚ä»¥ä¸Šç»™å‡ºçš„ä¾‹å­å±•ç¤ºäº† Node.js å¦‚ä½•é—´æ¥åˆ©ç”¨ inode çš„æ¦‚å¿µæ¥å¯¹æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œæ“ä½œã€‚</p><h5 id="filename-argument" tabindex="-1"><a class="header-anchor" href="#filename-argument"><span><a href="https://nodejs.org/docs/latest/api/fs.html#filename-argument" target="_blank" rel="noopener noreferrer">Filename argument</a></span></a></h5><p>åœ¨ Node.js çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>ï¼‰æ¨¡å—ä¸­ï¼Œè®¸å¤šå‡½æ•°éƒ½ä¼šè¦æ±‚ä½ æä¾›ä¸€ä¸ª <code>filename</code> å‚æ•°ã€‚è¿™ä¸ªå‚æ•°æŒ‡å®šäº†ä½ å¸Œæœ›æ“ä½œçš„æ–‡ä»¶çš„åç§°å’Œä½ç½®ã€‚ä¾‹å¦‚ï¼Œå½“ä½ æƒ³è¦è¯»å–ã€å†™å…¥æˆ–è€…æ£€æŸ¥ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œå°±éœ€è¦é€šè¿‡è¿™ä¸ªå‚æ•°å‘Šè¯‰ Node.js å…·ä½“æ˜¯å“ªä¸ªæ–‡ä»¶ã€‚</p><h3 id="filename-argument-1" tabindex="-1"><a class="header-anchor" href="#filename-argument-1"><span>Filename Argument</span></a></h3><p><code>filename</code> å‚æ•°é€šå¸¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ–‡ä»¶çš„è·¯å¾„ã€‚è·¯å¾„å¯ä»¥æ˜¯ç»å¯¹çš„ä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹çš„ã€‚</p><ul><li><strong>ç»å¯¹è·¯å¾„</strong>ï¼šæè¿°äº†ä»ç³»ç»Ÿæ ¹ç›®å½•åˆ°æ–‡ä»¶æ‰€åœ¨ä½ç½®çš„å®Œæ•´è·¯å¾„ã€‚æ¯”å¦‚ <code>/home/user/documents/file.txt</code> åœ¨ Unix-like ç³»ç»Ÿä¸­ï¼Œæˆ– <code>C:\Users\user\documents\file.txt</code> åœ¨ Windows ç³»ç»Ÿä¸­ã€‚</li><li><strong>ç›¸å¯¹è·¯å¾„</strong>ï¼šç›¸å¯¹äºå½“å‰å·¥ä½œç›®å½•çš„è·¯å¾„ã€‚å¦‚æœä½ çš„ Node.js ç¨‹åºçš„å½“å‰å·¥ä½œç›®å½•æ˜¯ <code>/home/user</code>ï¼Œé‚£ä¹ˆç›¸å¯¹è·¯å¾„ <code>documents/file.txt</code> ä¼šæŒ‡å‘ <code>/home/user/documents/file.txt</code>ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-15" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-15"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æœ‰ä»¥ä¸‹å‡ ä¸ªç¤ºä¾‹ï¼š</p><ol><li><p><strong>è¯»å–æ–‡ä»¶å†…å®¹</strong>ï¼š<br> å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡ä»¶ï¼Œé‡Œé¢å­˜å‚¨äº†ä¸€äº›æ–‡æœ¬æ•°æ®ï¼Œæˆ‘ä»¬æƒ³è¦è¯»å–å®ƒçš„å†…å®¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error reading the file:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File content:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œ<code>readFile</code> å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•° <code>&#39;example.txt&#39;</code> å°±æ˜¯ <code>filename</code> å‚æ•°ï¼Œå®ƒæŒ‡å®šäº†æˆ‘ä»¬æƒ³è¦è¯»å–çš„æ–‡ä»¶ã€‚</p></li><li><p><strong>å†™å…¥æ–‡ä»¶</strong>ï¼š<br> å¦‚æœæˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶æˆ–è€…è¦†ç›–ä¸€ä¸ªç°æœ‰æ–‡ä»¶çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>writeFile</code> æ–¹æ³•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> content</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, this is some text to save!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">newfile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> content</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error writing the file:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File has been written</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>writeFile</code> æ–¹æ³•çš„ <code>filename</code> å‚æ•°å°±æ˜¯ <code>&#39;newfile.txt&#39;</code>ï¼Œå®ƒå‘Šè¯‰ Node.js æˆ‘ä»¬æƒ³è¦å†™å…¥çš„æ–‡ä»¶åã€‚</p></li><li><p><strong>æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</strong>ï¼š<br> ä½¿ç”¨ <code>fs</code> æ¨¡å—çš„ <code>exists</code> æ–¹æ³•å¯ä»¥æ£€æŸ¥ä¸€ä¸ªæ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">exists</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">somefile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">exists</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Does file exist? </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">exists</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œ <code>&#39;somefile.txt&#39;</code> æ˜¯æˆ‘ä»¬ä¼ ç»™ <code>exists</code> æ–¹æ³•çš„ <code>filename</code> å‚æ•°ï¼Œç”¨äºæŒ‡å‡ºæˆ‘ä»¬æƒ³è¦æ£€æŸ¥çš„æ–‡ä»¶ã€‚</p></li></ol><p>æ³¨æ„ï¼Œåœ¨ Node.js ä¸­ï¼Œå¼‚æ­¥å‡½æ•°é€šå¸¸ä¼šé‡‡ç”¨å›è°ƒå‡½æ•°ä½œä¸ºæœ€åä¸€ä¸ªå‚æ•°ï¼ˆå¦‚ä¸Šé¢çš„ <code>(err, data)</code> æˆ– <code>(err)</code>ï¼‰ã€‚è¿™äº›å‡½æ•°æ‰§è¡Œåä¸ä¼šç«‹å³è¿”å›ç»“æœï¼Œè€Œæ˜¯åœ¨æ“ä½œå®Œæˆåé€šè¿‡å›è°ƒå‡½æ•°è¿”å›ç»“æœæˆ–é”™è¯¯ã€‚</p><p>ä»¥ä¸Šä¾¿æ˜¯ <code>filename</code> å‚æ•°åœ¨ Node.js æ–‡ä»¶ç³»ç»Ÿæ“ä½œä¸­çš„åŸºæœ¬ç”¨æ³•å’Œä¸€äº›ç®€å•å®é™…åº”ç”¨çš„ä¾‹å­ã€‚</p><h3 id="fs-watchfile-filename-options-listener" tabindex="-1"><a class="header-anchor" href="#fs-watchfile-filename-options-listener"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fswatchfilefilename-options-listener" target="_blank" rel="noopener noreferrer">fs.watchFile(filename[, options], listener)</a></span></a></h3><p>å½“ä½ ä½¿ç”¨ Node.js å·¥ä½œæ—¶ï¼Œå¾ˆå¤šæ—¶å€™éœ€è¦å¯¹æ–‡ä»¶æˆ–ç›®å½•çš„å˜åŒ–åšå‡ºå³æ—¶å“åº”ã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½æƒ³åœ¨ä¸€ä¸ªæ–‡ä»¶è¢«ä¿®æ”¹åè‡ªåŠ¨æ‰§è¡Œä¸€äº›ä»»åŠ¡ï¼Œè¿™å°±æ˜¯<code>fs.watchFile</code>åŠŸèƒ½æ´¾ä¸Šç”¨åœºçš„åœ°æ–¹ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯fs-watchfile" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯fs-watchfile"><span>ä»€ä¹ˆæ˜¯<code>fs.watchFile</code>?</span></a></h3><p><code>fs.watchFile</code>æ˜¯ Node.js ä¸­<code>fs</code>ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰æ¨¡å—æä¾›çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒå…è®¸ä½ ç›‘å¬æ–‡ä»¶çš„å˜åŒ–ã€‚æ¯å½“æŒ‡å®šçš„æ–‡ä»¶ä¿®æ”¹æ—¶é—´æˆ³å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•éƒ½ä¼šè¢«è§¦å‘ã€‚å®ƒéå¸¸é€‚åˆäºéœ€è¦å¯¹æ–‡ä»¶æ›´æ–°è¿›è¡Œå®æ—¶åé¦ˆçš„åœºæ™¯ã€‚</p><h3 id="åŸºæœ¬ç”¨æ³•-3" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç”¨æ³•-3"><span>åŸºæœ¬ç”¨æ³•</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// filenameæ˜¯ä½ æƒ³è¦ç›‘æ§çš„æ–‡ä»¶çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filename</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/the/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// listenerå‡½æ•°æ˜¯æ¯æ¬¡æ–‡ä»¶æ›´æ–°æ—¶è¦è°ƒç”¨çš„å›è°ƒå‡½æ•°</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> listener</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">curr</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> prev</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²æ›´æ–°ï¼Œåœ¨</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">curr</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mtime</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">æ—¶é—´</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // è¿™é‡Œå¯ä»¥æ ¹æ®éœ€æ±‚ç¼–å†™ä»£ç ï¼Œæ¯”å¦‚å¤„ç†æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨fs.watchFileå¼€å§‹ç›‘å¬æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watchFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filename</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> listener</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº†<code>fs</code>æ¨¡å—ã€‚ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰äº†æˆ‘ä»¬æƒ³è¦ç›‘å¬çš„æ–‡ä»¶çš„è·¯å¾„å’Œä¸€ä¸ªå½“æ–‡ä»¶æ”¹å˜æ—¶ä¼šè¢«è°ƒç”¨çš„ listener å‡½æ•°ã€‚æœ€åï¼Œæˆ‘ä»¬é€šè¿‡<code>fs.watchFile</code>å¼€å§‹ç›‘å¬æ–‡ä»¶çš„å˜åŒ–ã€‚</p><h3 id="å‚æ•°è¯¦è§£-6" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯¦è§£-6"><span>å‚æ•°è¯¦è§£</span></a></h3><ul><li><code>filename</code>: å¿…é¡»å‚æ•°ï¼Œè¡¨ç¤ºä½ æƒ³è¦ç›‘å¬çš„æ–‡ä»¶è·¯å¾„ã€‚</li><li><code>options</code>: å¯é€‰å‚æ•°ï¼Œå¯¹è±¡å½¢å¼ï¼ŒåŒ…æ‹¬ï¼š <ul><li><code>persistent</code>: è¡¨ç¤ºæ˜¯å¦åº”è¯¥åœ¨ç›‘å¬æœŸé—´ä¿æŒç¨‹åºå¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œé»˜è®¤ä¸º<code>true</code>ã€‚</li><li><code>interval</code>: è¡¨ç¤ºè½®è¯¢æ£€æŸ¥æ–‡ä»¶å˜æ›´çš„æ—¶é—´é—´éš”ï¼Œå•ä½ä¸ºæ¯«ç§’ï¼Œé»˜è®¤ä¸º 5007msã€‚</li></ul></li><li><code>listener</code>: å¿…é¡»å‚æ•°ï¼Œæ¯å½“æ–‡ä»¶å˜åŒ–æ—¶æ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚è¯¥å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°<code>curr</code>å’Œ<code>prev</code>ï¼Œåˆ†åˆ«ä»£è¡¨å˜åŒ–åå’Œå˜åŒ–å‰çš„æ–‡ä»¶çŠ¶æ€ä¿¡æ¯ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-17" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-17"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>è‡ªåŠ¨å¤‡ä»½</strong>: ä½ å¯ä»¥ä½¿ç”¨<code>fs.watchFile</code>æ¥ç›‘å¬ä¸€ä¸ªé‡è¦æ–‡ä»¶çš„å˜åŒ–ï¼Œä¸€æ—¦æ£€æµ‹åˆ°å˜åŒ–ï¼Œç«‹åˆ»åˆ›å»ºè¯¥æ–‡ä»¶çš„å¤‡ä»½ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watchFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filename</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">curr</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> prev</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> backupFilename</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> `</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filename</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">.</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">Date</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">now</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">.bak</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">copyFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filename</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> backupFilename</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å¤‡ä»½å·²åˆ›å»º</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>è‡ªåŠ¨é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶</strong>: å¦‚æœä½ çš„åº”ç”¨ç¨‹åºæœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œä½ å¯ä»¥ç›‘å¬è¿™ä¸ªæ–‡ä»¶çš„å˜åŒ–ï¼Œåœ¨æ–‡ä»¶æ›´æ–°æ—¶è‡ªåŠ¨é‡æ–°åŠ è½½é…ç½®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> appConfig</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watchFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">curr</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> prev</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  delete</span><span style="color:#D8DEE9;"> require</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">cache</span><span style="color:#D8DEE9FF;">[</span><span style="color:#D8DEE9;">require</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">resolve</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)]</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  appConfig</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">é…ç½®å·²æ›´æ–°</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> appConfig</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>ç½‘ç«™è‡ªåŠ¨éƒ¨ç½²</strong>: å¦‚æœä½ ç®¡ç†ç€ä¸€ä¸ªé™æ€ç½‘ç«™ï¼Œå¹¶ä¸”æƒ³è¦åœ¨å†…å®¹æ›´æ–°æ—¶è‡ªåŠ¨éƒ¨ç½²ï¼Œå¯ä»¥åˆ©ç”¨<code>fs.watchFile</code>ç›‘æ§æ„å»ºè¾“å‡ºç›®å½•ï¼Œä¸€æ—¦æ£€æµ‹åˆ°å˜åŒ–ï¼Œè‡ªåŠ¨æ‰§è¡Œéƒ¨ç½²è„šæœ¬ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watchFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/build/directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">curr</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> prev</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æ‰§è¡Œéƒ¨ç½²è„šæœ¬ï¼Œæ¯”å¦‚è°ƒç”¨shellå‘½ä»¤ç­‰</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="æ³¨æ„äº‹é¡¹-15" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-15"><span>æ³¨æ„äº‹é¡¹</span></a></h3><p>è™½ç„¶<code>fs.watchFile</code>å¾ˆæœ‰ç”¨ï¼Œä½†å®ƒå¹¶ä¸é€‚åˆæ‰€æœ‰æƒ…å†µã€‚ç”±äºå®ƒåŸºäºè½®è¯¢ï¼ˆå®šæ—¶æ£€æŸ¥ï¼‰ï¼Œå¯èƒ½ä¼šåœ¨é«˜é¢‘æ›´æ–°çš„æ–‡ä»¶ä¸Šå¼•èµ·æ€§èƒ½é—®é¢˜ã€‚å¦‚æœéœ€è¦ç›‘å¬å¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•å˜åŒ–ï¼Œå¯èƒ½ä¼šè€ƒè™‘ä½¿ç”¨æ›´é«˜æ•ˆçš„<code>fs.watch</code>æ–¹æ³•æˆ–ç¬¬ä¸‰æ–¹åº“ã€‚</p><p>æ€»ä¹‹ï¼Œ<code>fs.watchFile</code>æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹å¼æ¥ç›‘å¬æ–‡ä»¶å˜åŒ–ï¼Œå¹¶æ‰§è¡Œç›¸å…³æ“ä½œï¼Œéå¸¸é€‚åˆå¼€å‘ä¸­çš„è‡ªåŠ¨åŒ–ä»»åŠ¡ã€‚</p><h3 id="fs-write-fd-buffer-offset-length-position-callback" tabindex="-1"><a class="header-anchor" href="#fs-write-fd-buffer-offset-length-position-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fswritefd-buffer-offset-length-position-callback" target="_blank" rel="noopener noreferrer">fs.write(fd, buffer, offset[, length[, position]], callback)</a></span></a></h3><p>å½“ç„¶ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥åœ°ç†è§£è¿™ä¸ª <code>fs.write</code> å‡½æ•°ï¼Œå®ƒæ¥è‡ªäº Node.js çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆFileSystem, ç®€ç§° fsï¼‰æ¨¡å—ã€‚è¿™ä¸ªå‡½æ•°çš„ç”¨é€”æ˜¯å°†æ•°æ®å†™å…¥åˆ°æ–‡ä»¶ä¸­ã€‚å¦‚æœä½ æƒ³æŠŠæŸäº›ä¿¡æ¯ä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œæ¯”å¦‚ç”¨æˆ·çš„æ•°æ®ã€åº”ç”¨çš„æ—¥å¿—ç­‰ï¼Œè¿™ä¸ªå‡½æ•°å°±éå¸¸æœ‰ç”¨äº†ã€‚</p><p>ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç†Ÿæ‚‰å®ƒçš„å‚æ•°ï¼š</p><ol><li><strong>fd</strong>ï¼šæ–‡ä»¶æè¿°ç¬¦ï¼Œä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å‘è¢«æ‰“å¼€æ–‡ä»¶çš„å¼•ç”¨ã€‚ä½ å¯ä»¥é€šè¿‡ <code>fs.open</code> å‡½æ•°è·å¾—è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚</li><li><strong>buffer</strong>ï¼šä¸€ä¸ª Buffer æˆ– Uint8Array å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº†è¦å†™å…¥æ–‡ä»¶çš„æ•°æ®ã€‚</li><li><strong>offset</strong>ï¼šä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šä» buffer ä¸­å¼€å§‹è¯»å–æ•°æ®çš„ä½ç½®çš„åç§»é‡ã€‚å¦‚æœä½ æƒ³ä» buffer çš„èµ·å§‹ä½ç½®å¼€å§‹å†™å…¥ï¼Œå°±è®¾ç½®ä¸º 0ã€‚</li><li><strong>length</strong>ï¼šä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šè¦å†™å…¥çš„å­—èŠ‚æ•°ã€‚å¦‚æœä½ æƒ³å†™å…¥ buffer ä¸­æ‰€æœ‰çš„æ•°æ®ï¼Œå¯ä»¥çœç•¥è¿™ä¸ªå‚æ•°æˆ–è®¾ä¸º undefinedã€‚</li><li><strong>position</strong>ï¼šä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šåœ¨æ–‡ä»¶ä¸­å¼€å§‹å†™å…¥æ•°æ®çš„ä½ç½®çš„åç§»é‡ã€‚å¦‚æœè®¾ç½®ä¸º nullï¼Œæ•°æ®ä¼šè¢«å†™å…¥å½“å‰çš„æ–‡ä»¶ä½ç½®ã€‚</li><li><strong>callback</strong>ï¼šå½“å†™å…¥æ“ä½œå®Œæˆæˆ–å‘ç”Ÿé”™è¯¯æ—¶ï¼ŒNode.js ä¼šè°ƒç”¨è¿™ä¸ªå›è°ƒå‡½æ•°ã€‚å®ƒå…·æœ‰ä¸¤ä¸ªå‚æ•°ï¼š<code>err</code> å’Œ <code>bytesWritten</code>ã€‚<code>err</code> æ˜¯ä¸€ä¸ªé”™è¯¯å¯¹è±¡ï¼Œå¦‚æœå†™å…¥æˆåŠŸåˆ™ä¸º nullï¼›<code>bytesWritten</code> æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºå®é™…å†™å…¥çš„å­—èŠ‚æ•°ã€‚</li></ol><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªå®é™…çš„ä¾‹å­æ¥åŠ æ·±ç†è§£ã€‚</p><h3 id="ç¤ºä¾‹-1-å‘æ–‡ä»¶ä¸­å†™å…¥æ–‡æœ¬" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-å‘æ–‡ä»¶ä¸­å†™å…¥æ–‡æœ¬"><span>ç¤ºä¾‹ 1: å‘æ–‡ä»¶ä¸­å†™å…¥æ–‡æœ¬</span></a></h3><p>å‡è®¾æˆ‘ä»¬æƒ³å†™å…¥ä¸€äº›æ–‡æœ¬åˆ° <code>example.txt</code> æ–‡ä»¶ä¸­ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ‰“å¼€æ–‡ä»¶ä»¥è·å–æ–‡ä»¶æè¿°ç¬¦ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // åˆ›å»ºä¸€ä¸ª Buffer ç”¨æ¥å­˜æ”¾è¦å†™å…¥çš„æ•°æ®</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello, Node.js!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å†™å…¥æ•°æ®</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">length</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> null</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> bytesWritten</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">bytesWritten</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> å­—èŠ‚è¢«å†™å…¥</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨ <code>fs.open</code> æ‰“å¼€æ–‡ä»¶ï¼ˆå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼‰ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªåŒ…å«æ–‡æœ¬ &quot;Hello, Node.js!&quot; çš„ Bufferã€‚ä¹‹åï¼Œæˆ‘ä»¬ç”¨ <code>fs.write</code> å°†è¿™æ®µæ–‡æœ¬å†™å…¥æ–‡ä»¶ï¼Œå¹¶åœ¨å†™å…¥å®Œæˆåå…³é—­æ–‡ä»¶ã€‚</p><h3 id="ç¤ºä¾‹-2-å¼‚æ­¥å†™å…¥å¤§é‡æ•°æ®" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å¼‚æ­¥å†™å…¥å¤§é‡æ•°æ®"><span>ç¤ºä¾‹ 2: å¼‚æ­¥å†™å…¥å¤§é‡æ•°æ®</span></a></h3><p>å¦‚æœä½ éœ€è¦å†™å…¥å¤§é‡æ•°æ®ï¼Œæœ€å¥½åˆ†æ‰¹æ¬¡è¿›è¡Œï¼Œé¿å…é˜»å¡ Node.js çš„äº‹ä»¶å¾ªç¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">__dirname</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">largeFile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">è¿™é‡Œæ˜¯ä¸€äº›é‡å¤çš„æ•°æ®ã€‚</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dataSize</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 20</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å‡è®¾æˆ‘ä»¬éœ€è¦å†™å…¥20æ¬¡</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥å†™å…¥æ•°æ®</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#88C0D0;"> writeData</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">i</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">i</span><span style="color:#81A1C1;"> &gt;=</span><span style="color:#D8DEE9;"> dataSize</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">      // æ•°æ®å·²å…¨éƒ¨å†™å…¥ï¼Œå…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">      return</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²å…³é—­</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    let</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">length</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> null</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å†™å…¥è¿‡ç¨‹ä¸­å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        return;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">ç¬¬ </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">i</span><span style="color:#81A1C1;"> +</span><span style="color:#B48EAD;"> 1</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> éƒ¨åˆ†æ•°æ®å·²å†™å…¥</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">      // é€’å½’è°ƒç”¨ï¼Œå†™å…¥ä¸‹ä¸€éƒ¨åˆ†æ•°æ®</span></span>
<span class="line"><span style="color:#88C0D0;">      writeData</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">i</span><span style="color:#81A1C1;"> +</span><span style="color:#B48EAD;"> 1</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å¼€å§‹å†™å…¥æ•°æ®</span></span>
<span class="line"><span style="color:#88C0D0;">  writeData</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">0</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡é€’å½’è°ƒç”¨ <code>writeData</code> å‡½æ•°æ¥åˆ†æ‰¹æ¬¡å¼‚æ­¥åœ°å†™å…¥å¤§é‡æ•°æ®ã€‚è¿™ç§æ–¹æ³•å¯ä»¥è®© Node.js çš„äº‹ä»¶å¾ªç¯ç»§ç»­å¤„ç†å…¶ä»–äº‹ä»¶ï¼Œä»è€Œæé«˜äº†åº”ç”¨çš„æ€§èƒ½å’Œå“åº”èƒ½åŠ›ã€‚</p><p>å¸Œæœ›è¿™äº›è§£é‡Šå’Œç¤ºä¾‹èƒ½å¤Ÿå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ <code>fs.write</code> åœ¨ Node.js ä¸­çš„åº”ç”¨ï¼</p><h3 id="fs-write-fd-buffer-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-write-fd-buffer-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fswritefd-buffer-options-callback" target="_blank" rel="noopener noreferrer">fs.write(fd, buffer[, options], callback)</a></span></a></h3><p><code>fs.write(fd, buffer[, options], callback)</code> æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªå·²æ‰“å¼€çš„æ–‡ä»¶ã€‚</p><p>è¿™ä¸ªå‡½æ•°çš„å‚æ•°è§£é‡Šå¦‚ä¸‹ï¼š</p><ol><li><p><code>fd</code>: è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œæ ‡è¯†ç€éœ€è¦è¢«å†™å…¥çš„æ–‡ä»¶ã€‚ä½ éœ€è¦å…ˆä½¿ç”¨ <code>fs.open()</code> æˆ–è€…ç±»ä¼¼çš„æ–¹æ³•æ¥æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶è·å–åˆ°è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚</p></li><li><p><code>buffer</code>: è¿™æ˜¯ä¸€ä¸ª Buffer æˆ–è€… Uint8Arrayï¼ŒåŒ…å«ç€è¦å†™å…¥æ–‡ä»¶çš„æ•°æ®ã€‚Buffer æ˜¯ Node.js ä¸­ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ä¸€ä¸ªç±»ã€‚</p></li><li><p><code>options</code> (å¯é€‰): è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæä¾›é¢å¤–çš„é…ç½®é€‰é¡¹ï¼Œæ¯”å¦‚ï¼š</p><ul><li><code>offset</code>: ä» buffer çš„å“ªä¸ªä½ç½®å¼€å§‹å†™å…¥æ•°æ®ï¼Œé»˜è®¤ä¸º 0ã€‚</li><li><code>length</code>: å†™å…¥å¤šå°‘å­—èŠ‚çš„æ•°æ®ï¼Œé»˜è®¤æ˜¯ buffer çš„é•¿åº¦å‡å» offsetã€‚</li><li><code>position</code>: åœ¨æ–‡ä»¶ä¸­å¼€å§‹å†™å…¥æ•°æ®çš„ä½ç½®ï¼Œé»˜è®¤ä¸ºå½“å‰çš„è¯»å†™ä½ç½®ã€‚</li></ul></li><li><p><code>callback</code>: å½“å†™æ“ä½œå®Œæˆåï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¢«è°ƒç”¨ï¼Œå®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼š</p><ul><li><code>err</code>: å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œè¿™é‡Œä¼šæ˜¯ä¸€ä¸ª Error å¯¹è±¡ï¼›å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œåˆ™ä¸º nullã€‚</li><li><code>bytesWritten</code>: è¡¨ç¤ºå®é™…å†™å…¥æ–‡ä»¶çš„å­—èŠ‚æ•°ã€‚</li><li><code>buffer</code>: å›è°ƒä¸­çš„ buffer å‚æ•°æ˜¯æŒ‡å‘å®é™…è¢«å†™å…¥æ•°æ®çš„ buffer æˆ– Uint8Arrayã€‚</li></ul></li></ol><p>ä¸‹é¢æˆ‘ä¼šä¸¾å‡ ä¸ªä¾‹å­è¯´æ˜å¦‚ä½•ä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼š</p><p><strong>ä¾‹å­ 1ï¼šå†™å…¥å­—ç¬¦ä¸²åˆ°æ–‡ä»¶</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // è¦å†™å…¥çš„æ–‡æœ¬è½¬æ¢æˆ Buffer</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello Node.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å†™å…¥ Buffer åˆ°æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">length</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> null</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> bytesWritten</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">bytesWritten</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> bytes written to file</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆæ‰“å¼€äº†ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡ä»¶ç”¨äºå†™å…¥ã€‚æˆ‘ä»¬å°†è¦å†™å…¥çš„å­—ç¬¦ä¸² <code>&quot;Hello Node.js&quot;</code> è½¬æ¢æˆä¸€ä¸ª Bufferï¼Œç„¶åä½¿ç”¨ <code>fs.write()</code> å‡½æ•°æŠŠå®ƒå†™å…¥åˆ°æ–‡ä»¶ä¸­ã€‚</p><p><strong>ä¾‹å­ 2ï¼šè¿½åŠ å†™å…¥æ•°æ®</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶ç”¨äºè¿½åŠ å†™å…¥</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Appending more text</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // æŠŠæ•°æ®è¿½åŠ åˆ°æ–‡ä»¶ä¸­</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> bytesWritten</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">bytesWritten</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> bytes written to file</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•è¿½åŠ æ–‡æœ¬åˆ°æ–‡ä»¶æœ«å°¾ã€‚æˆ‘ä»¬æ‰“å¼€æ–‡ä»¶æ—¶ä½¿ç”¨äº† <code>&#39;a&#39;</code> æ¨¡å¼ï¼Œè¿™è¡¨ç¤ºæˆ‘ä»¬è¦æŠŠæ•°æ®è¿½åŠ åˆ°æ–‡ä»¶ä¸­ã€‚</p><p>æ³¨æ„ï¼Œåœ¨æ¯æ¬¡å†™æ“ä½œä¹‹åï¼Œæˆ‘ä»¬éƒ½è¦è®°å¾—å…³é—­æ–‡ä»¶ï¼Œä»¥é¿å…èµ„æºæ³„éœ²ã€‚ ä½¿ç”¨ <code>fs.close()</code> æ–¹æ³•å¯ä»¥å®‰å…¨åœ°å…³é—­æ–‡ä»¶æè¿°ç¬¦ã€‚</p><h3 id="fs-write-fd-string-position-encoding-callback" tabindex="-1"><a class="header-anchor" href="#fs-write-fd-string-position-encoding-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fswritefd-string-position-encoding-callback" target="_blank" rel="noopener noreferrer">fs.write(fd, string[, position[, encoding]], callback)</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œä½¿å¾—ä½ å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚å®ƒæä¾›äº†ä¸€å¥—ä¸°å¯Œçš„åº“ï¼Œå…è®¸ä½ è¿›è¡Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œã€ç½‘ç»œè¯·æ±‚ç­‰ã€‚å…¶ä¸­ <code>fs</code> æ¨¡å—å°±æ˜¯ Node.js æä¾›ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„æ¨¡å—ä¹‹ä¸€ã€‚</p><p>å½“ä½ çœ‹åˆ° <code>fs.write(fd, string[, position[, encoding]], callback)</code>ï¼Œè¿™æ˜¯ <code>fs</code> æ¨¡å—çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†æ•°æ®å†™å…¥åˆ°æ–‡ä»¶ä¸­ã€‚è®©æˆ‘ä»¬ä¸€æ­¥æ­¥è§£é‡Šæ¯ä¸ªéƒ¨åˆ†ï¼š</p><ul><li><p><strong>fd</strong>ï¼šè¿™æ˜¯ &quot;file descriptor&quot; çš„ç¼©å†™ï¼Œæ–‡ä»¶æè¿°ç¬¦ã€‚å½“ä½ åœ¨æ“ä½œç³»ç»Ÿä¸­æ‰“å¼€æ–‡ä»¶æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå®ƒæ˜¯ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼Œä»£è¡¨è¿™ä¸ªè¢«æ‰“å¼€æ–‡ä»¶çš„å¼•ç”¨ã€‚åœ¨ Node.js ä¸­ï¼Œä½ é€šå¸¸ä¼šå…ˆä½¿ç”¨ <code>fs.open()</code> æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åä½¿ç”¨è¿”å›çš„æ–‡ä»¶æè¿°ç¬¦è¿›è¡Œè¯»å†™æ“ä½œã€‚</p></li><li><p><strong>string</strong>ï¼šè¿™æ˜¯ä½ æƒ³è¦å†™å…¥æ–‡ä»¶çš„æ•°æ®ã€‚å°½ç®¡å‚æ•°åå« <code>string</code>ï¼Œä½†å®é™…ä¸Šä½ å¯ä»¥ä¼ å…¥ä»»ä½•ç±»å‹çš„æ•°æ®ï¼›Node.js ä¼šå°è¯•å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚</p></li><li><p><strong>position</strong>ï¼ˆå¯é€‰ï¼‰ï¼šè¿™æŒ‡å®šäº†å¼€å§‹å†™å…¥æ–‡ä»¶çš„ä½ç½®ã€‚å¦‚æœæœªæŒ‡å®šæˆ–è€…ä¸º nullï¼Œæ•°æ®ä¼šè¢«å†™å…¥åˆ°å½“å‰æ–‡ä»¶æŒ‡é’ˆçš„ä½ç½®ï¼Œæ–‡ä»¶æŒ‡é’ˆéšç€å†™å…¥çš„å†…å®¹å‘åç§»åŠ¨ã€‚</p></li><li><p><strong>encoding</strong>ï¼ˆå¯é€‰ï¼‰ï¼šè¿™æ˜¯å­—ç¬¦ç¼–ç ï¼Œå†³å®šäº†å¦‚ä½•å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºåº•å±‚çš„å­—èŠ‚åºåˆ—ã€‚æ¯”å¦‚ <code>&#39;utf8&#39;</code>ã€<code>&#39;ascii&#39;</code> ç­‰ã€‚å¦‚æœæœªæŒ‡å®šï¼Œé»˜è®¤ä½¿ç”¨ <code>&#39;utf8&#39;</code> ç¼–ç ã€‚</p></li><li><p><strong>callback</strong>ï¼šå†™å…¥å®Œæˆæˆ–å‘ç”Ÿé”™è¯¯æ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚å®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªé”™è¯¯å¯¹è±¡å’Œå†™å…¥çš„å­—èŠ‚æ•°ã€‚</p></li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-7" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-7"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å»ºç«‹ä¸€ä¸ªæ—¥å¿—ç³»ç»Ÿï¼Œéœ€è¦å°†æ—¥å¿—ä¿¡æ¯å†™å…¥åˆ°æ–‡ä»¶ä¸­ã€‚</p><ol><li>é¦–å…ˆï¼Œä½ éœ€è¦æ‰“å¼€æˆ–åˆ›å»ºä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€ï¼ˆæˆ–åˆ›å»ºï¼‰ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">mylog.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å‡†å¤‡å†™å…¥çš„æ—¥å¿—ä¿¡æ¯</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> logEntry</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">User logged in at: </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">()</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toISOString</span><span style="color:#D8DEE9FF;">() </span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨ fs.write å†™å…¥æ—¥å¿—ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> logEntry</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> written</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> string</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Successfully wrote </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">written</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> bytes to file</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å®Œæˆåå…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é¦–å…ˆé€šè¿‡ <code>fs.open</code> æ‰“å¼€ï¼ˆæˆ–åˆ›å»ºï¼‰ä¸€ä¸ªåä¸º <code>mylog.txt</code> çš„æ–‡ä»¶ï¼Œå¹¶ä»¥è¿½åŠ æ¨¡å¼ (<code>&#39;a&#39;</code>) æ‰“å¼€ï¼Œè¿™æ ·æ–°çš„æ—¥å¿—ä¿¡æ¯å°±ä¸ä¼šè¦†ç›–æ—§çš„ä¿¡æ¯ã€‚æˆåŠŸæ‰“å¼€æ–‡ä»¶åï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ <code>fd</code>ã€‚</p><p>æ¥ç€ï¼Œæˆ‘ä»¬æ„é€ äº†ä¸€æ¡æ—¥å¿—ä¿¡æ¯ <code>logEntry</code>ï¼Œå¹¶ä½¿ç”¨ <code>fs.write</code> å°†è¿™æ¡ä¿¡æ¯å†™å…¥å‰é¢æ‰“å¼€çš„æ–‡ä»¶ã€‚åœ¨å†™å…¥å®Œæˆåï¼Œæˆ‘ä»¬æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯å‘ç”Ÿï¼Œç„¶åè¾“å‡ºå†™å…¥çš„å­—èŠ‚æ•°ã€‚æœ€åï¼Œè®°å¾—ä½¿ç”¨ <code>fs.close</code> å…³é—­æ–‡ä»¶ï¼Œé‡Šæ”¾èµ„æºã€‚</p><p>é€šè¿‡è¿™ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ°å¦‚ä½•ä½¿ç”¨ <code>fs.write</code> åœ¨ Node.js åº”ç”¨ç¨‹åºä¸­å¯¹æ–‡ä»¶è¿›è¡Œå†™å…¥æ“ä½œã€‚</p><h3 id="fs-writefile-file-data-options-callback" tabindex="-1"><a class="header-anchor" href="#fs-writefile-file-data-options-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fswritefilefile-data-options-callback" target="_blank" rel="noopener noreferrer">fs.writeFile(file, data[, options], callback)</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­ <code>fs.writeFile</code> è¿™ä¸ªå‡½æ•°ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ˜¯ &quot;filesystem&quot; çš„ç¼©å†™ï¼Œä»£è¡¨æ–‡ä»¶ç³»ç»Ÿã€‚Node.js æä¾›äº†ä¸€ä¸ªå†…ç½®æ¨¡å—å« <code>fs</code>ï¼Œè¿™ä¸ªæ¨¡å—ç»™ä½ æä¾›äº†å¾ˆå¤šæ–¹æ³•æ¥è·Ÿæ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’ï¼Œæ¯”å¦‚åˆ›å»ºã€è¯»å–ã€å†™å…¥å’Œåˆ é™¤æ–‡ä»¶ã€‚</p><p><code>fs.writeFile</code> æ˜¯è¿™ä¸ªæ¨¡å—ä¸­çš„ä¸€ä¸ªéå¸¸é‡è¦çš„æ–¹æ³•ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚å¦‚æœæ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆåŸå†…å®¹ä¼šè¢«æ–°å†…å®¹è¦†ç›–ï¼›å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼ŒNode.js ä¼šè‡ªåŠ¨åˆ›å»ºè¿™ä¸ªæ–‡ä»¶ã€‚</p><p>è¿™ä¸ªæ–¹æ³•æœ‰å››ä¸ªå‚æ•°ï¼š</p><ol><li><p><code>file</code>: æ–‡ä»¶çš„è·¯å¾„æˆ–è€…æ–‡ä»¶æè¿°ç¬¦ã€‚ä½ å¯ä»¥æä¾›ä¸€ä¸ªå­—ç¬¦ä¸²å½¢å¼çš„æ–‡ä»¶è·¯å¾„ï¼ˆå¦‚ <code>&#39;example.txt&#39;</code>ï¼‰ï¼Œä¹Ÿå¯ä»¥å…ˆä½¿ç”¨ <code>fs.open</code> æ‰“å¼€æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨è¿”å›çš„æ–‡ä»¶æè¿°ç¬¦ã€‚</p></li><li><p><code>data</code>: è¦å†™å…¥æ–‡ä»¶çš„å†…å®¹ã€‚è¿™ä¸ªå‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€ä¸€ä¸ª Buffer å¯¹è±¡æˆ–è€…ä¸€ä¸ª Uint8Arrayã€‚</p></li><li><p><code>options</code> (å¯é€‰): è¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ç€ä¸€äº›è®¾ç½®é¡¹ï¼Œæ¯”å¦‚æ–‡ä»¶ç¼–ç ç­‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç¼–ç æ˜¯ <code>&#39;utf8&#39;</code>ï¼Œå³æ™®é€šçš„æ–‡æœ¬æ–‡ä»¶ã€‚å…¶ä»–å¯é€‰é¡¹åŒ…æ‹¬ï¼š</p><ul><li><code>encoding</code>: é»˜è®¤ä¸º &#39;utf8&#39;ï¼Œè¡¨ç¤ºå­—ç¬¦ç¼–ç ã€‚</li><li><code>mode</code>: è®¾ç½®æ–‡ä»¶æƒé™ï¼Œé»˜è®¤æ˜¯ <code>0o666</code>ï¼Œè¡¨ç¤ºå¯è¯»å†™çš„æ–‡ä»¶ã€‚</li><li><code>flag</code>: æŒ‡å®šæ‰“å¼€æ–‡ä»¶æ—¶çš„è¡Œä¸ºï¼Œé»˜è®¤ä¸º <code>&#39;w&#39;</code>ï¼Œè¡¨ç¤ºå†™å…¥æ–‡ä»¶ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»ºã€‚</li></ul></li><li><p><code>callback</code>: å›è°ƒå‡½æ•°ï¼Œåœ¨å†™å…¥æ–‡ä»¶æ“ä½œå®Œæˆåè¢«è°ƒç”¨ã€‚è¿™ä¸ªå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯èƒ½å‡ºç°çš„é”™è¯¯å¯¹è±¡ï¼Œå¦‚æœæ²¡æœ‰å‘ç”Ÿé”™è¯¯ï¼Œåˆ™ä¸º <code>null</code>ï¼›ç¬¬äºŒä¸ªå‚æ•°æ²¡æœ‰ç‰¹åˆ«çš„å€¼ï¼Œé€šå¸¸ä¸ä½¿ç”¨ã€‚</p></li></ol><h3 id="ç¤ºä¾‹-3" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3"><span>ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªåä¸º &quot;greetings.txt&quot; çš„æ–‡ä»¶ï¼Œå¹¶ä¸”æˆ‘ä»¬å¸Œæœ›åœ¨å…¶ä¸­å†™å…¥æ–‡æœ¬ &quot;Hello, World!&quot;ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è¦å†™å…¥çš„æ•°æ®</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, World!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å†™å…¥æ•°æ®åˆ° greetings.txt æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">greetings.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> function</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œæ‰“å°é”™è¯¯åˆ°æ§åˆ¶å°</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">There was an error writing to the file:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // å¦‚æœæˆåŠŸäº†ï¼Œæ‰“å°æˆåŠŸæ¶ˆæ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File written successfully!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† <code>fs</code> æ¨¡å—ã€‚ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰äº†è¦å†™å…¥æ–‡ä»¶çš„æ•°æ®ã€‚æ¥ç€ï¼Œæˆ‘ä»¬è°ƒç”¨äº† <code>fs.writeFile</code> æ–¹æ³•ï¼Œå¹¶ä¼ å…¥äº†æ–‡ä»¶å <code>&quot;greetings.txt&quot;</code>ï¼Œæ•°æ® <code>&quot;Hello, World!&quot;</code> å’Œä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚å½“æ–‡ä»¶å†™å…¥æ“ä½œç»“æŸæ—¶ï¼ŒNode.js ä¼šè°ƒç”¨è¿™ä¸ªå›è°ƒå‡½æ•°ã€‚å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼ˆæ¯”å¦‚ç£ç›˜ç©ºé—´ä¸è¶³æˆ–è€…æ–‡ä»¶æ— æ³•åˆ›å»ºï¼‰ï¼Œé”™è¯¯å¯¹è±¡ä¼šä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™å›è°ƒå‡½æ•°ï¼›å¦åˆ™ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¼šæ˜¯ <code>null</code>ï¼Œè¡¨ç¤ºæˆåŠŸæ— è¯¯ã€‚åœ¨å›è°ƒå‡½æ•°é‡Œï¼Œæˆ‘ä»¬æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯ï¼Œå¹¶ç›¸åº”åœ°è¾“å‡ºä¿¡æ¯åˆ°æ§åˆ¶å°ã€‚</p><p>è¿™å°±æ˜¯ <code>fs.writeFile</code> æ–¹æ³•çš„åŸºæœ¬ç”¨æ³•ã€‚è®°ä½ï¼Œæ‰€æœ‰çš„ <code>fs</code> æ–¹æ³•éƒ½å¯ä»¥å®ç°åŒæ­¥æˆ–å¼‚æ­¥çš„æ“ä½œã€‚åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å¼‚æ­¥ç‰ˆæœ¬çš„ writeFileï¼Œå› ä¸ºå®ƒæ¥å—äº†ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚å¦‚æœä½ æƒ³è¦åŒæ­¥çš„æ–¹å¼å†™æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>fs.writeFileSync</code> æ–¹æ³•ï¼Œä½†è¯·æ³¨æ„ï¼ŒåŒæ­¥æ“ä½œä¼šé˜»å¡ç¨‹åºçš„è¿›ä¸€æ­¥æ‰§è¡Œç›´è‡³æ–‡ä»¶å†™å…¥å®Œæˆã€‚</p><h4 id="using-fs-writefile-with-file-descriptors" tabindex="-1"><a class="header-anchor" href="#using-fs-writefile-with-file-descriptors"><span><a href="https://nodejs.org/docs/latest/api/fs.html#using-fswritefile-with-file-descriptors" target="_blank" rel="noopener noreferrer">Using fs.writeFile() with file descriptors</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œ JavaScript ä»£ç ã€‚åœ¨ Node.js ä¸­æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„æ¨¡å—å«åš <code>fs</code>ï¼Œå³æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼Œè¯¥æ¨¡å—æä¾›äº†å¾ˆå¤šç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„æ–¹æ³•ã€‚</p><p>å…¶ä¸­ï¼Œ<code>fs.writeFile()</code> æ–¹æ³•æ˜¯ä¸€ä¸ªç”¨æ¥å¼‚æ­¥å†™å…¥æ•°æ®åˆ°æ–‡ä»¶ä¸­çš„å‡½æ•°ã€‚å¦‚æœæ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œåˆ™ä¼šè¢«æ›¿æ¢ã€‚è¿™ä¸ªæ–¹æ³•é€šå¸¸æœ‰ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼šç›´æ¥æŒ‡å®šæ–‡ä»¶è·¯å¾„æˆ–è€…ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦ï¼ˆfile descriptorï¼‰ã€‚</p><p>æ–‡ä»¶æè¿°ç¬¦æ˜¯ä¸€ä¸ªæ•´æ•°å€¼ï¼Œå®ƒæ˜¯å¯¹æ‰“å¼€çš„æ–‡ä»¶çš„å¼•ç”¨ï¼Œç±»ä¼¼ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘æ“ä½œç³»ç»Ÿå†…éƒ¨ä¸ºæ‰“å¼€çš„æ–‡ä»¶ç»´æŠ¤çš„ç»“æ„ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦å’Œ <code>fs.writeFile()</code> çš„ç¤ºä¾‹å¯èƒ½å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡†å¤‡å†™å…¥çš„æ•°æ®</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, World!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æŒ‡å®šæ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filepath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">__dirname</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">output.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// é¦–å…ˆéœ€è¦æ‰“å¼€æ–‡ä»¶ä»¥è·å–æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filepath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">openErr</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">openErr</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> openErr</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦å’Œ fs.writeFile() å†™å…¥æ•°æ®</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">writeErr</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">writeErr</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> writeErr</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Data written to file successfully.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å®Œæˆåéœ€è¦å…³é—­æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">closeErr</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">closeErr</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> closeErr</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File closed successfully.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šè¿°ä»£ç çš„å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š</p><ol><li>æˆ‘ä»¬å¯¼å…¥ <code>fs</code> æ¨¡å—ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿçš„åŠŸèƒ½ã€‚</li><li>æˆ‘ä»¬å‡†å¤‡ä¸€äº›æ•°æ® <code>&#39;Hello, World!&#39;</code>ï¼Œè¿™æ˜¯æˆ‘ä»¬æƒ³è¦å†™å…¥åˆ°æ–‡ä»¶ä¸­çš„å†…å®¹ã€‚</li><li>æˆ‘ä»¬å®šä¹‰æ–‡ä»¶è·¯å¾„ <code>output.txt</code>ï¼Œä½äºå½“å‰è„šæœ¬æ‰€åœ¨ç›®å½•ä¸­ã€‚</li><li>ä½¿ç”¨ <code>fs.open()</code> æ‰“å¼€æ–‡ä»¶ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ <code>&#39;w&#39;</code> æ¨¡å¼ï¼Œè¡¨ç¤ºâ€œå†™å…¥â€æ¨¡å¼ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºä¹‹ã€‚</li><li>å½“æ–‡ä»¶è¢«æˆåŠŸæ‰“å¼€åï¼Œ<code>fs.open()</code> çš„å›è°ƒå‡½æ•°ä¼šè¢«è°ƒç”¨ï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ <code>fd</code>ã€‚</li><li>æ¥ç€ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>fs.writeFile()</code> å’Œæä¾›çš„æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> æ¥å†™å…¥æ•°æ®ã€‚</li><li>å†™å…¥å®Œæˆåï¼Œæˆ‘ä»¬å†æ¬¡ä½¿ç”¨å›è°ƒå‡½æ•°æ¥ç¡®è®¤æ•°æ®æ˜¯å¦æˆåŠŸå†™å…¥ï¼Œå¹¶è¾“å‡ºä¸€æ¡æ¶ˆæ¯ã€‚</li><li>æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>fs.close()</code> æ¥å…³é—­æ–‡ä»¶æè¿°ç¬¦ï¼Œé‡Šæ”¾èµ„æºã€‚</li></ol><p>é€šè¿‡ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦ï¼Œä½ èƒ½å¤Ÿå¯¹åŒä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶è¿›è¡Œæ›´å¤šæ§åˆ¶ï¼Œä¾‹å¦‚å®ç°æ›´å¤æ‚çš„è¯»å†™æ“ä½œç­‰ã€‚ä½†æ˜¯å¯¹äºå¤§å¤šæ•°ç®€å•éœ€æ±‚ï¼Œç›´æ¥æä¾›æ–‡ä»¶è·¯å¾„ç»™ <code>fs.writeFile()</code> é€šå¸¸å°±è¶³å¤Ÿäº†ã€‚</p><h3 id="fs-writev-fd-buffers-position-callback" tabindex="-1"><a class="header-anchor" href="#fs-writev-fd-buffers-position-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fswritevfd-buffers-position-callback" target="_blank" rel="noopener noreferrer">fs.writev(fd, buffers[, position], callback)</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œæ—¶ï¼Œå®ƒä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿåœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚<code>fs</code> æ¨¡å—æ˜¯ Node.js çš„å†…ç½®æ¨¡å—ä¹‹ä¸€ï¼Œå®ƒæä¾›äº†å¯¹æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„åŠŸèƒ½ã€‚<code>fs.writev</code> æ˜¯ <code>fs</code> æ¨¡å—ä¸­ç”¨æ¥å†™å…¥æ•°æ®åˆ°æ–‡ä»¶çš„å‡½æ•°ã€‚</p><h3 id="fs-writev-fd-buffers-position-callback-1" tabindex="-1"><a class="header-anchor" href="#fs-writev-fd-buffers-position-callback-1"><span>fs.writev(fd, buffers[, position], callback)</span></a></h3><p>è®©æˆ‘ä»¬åˆ†è§£è¿™ä¸ªæ–¹æ³•çš„å„ä¸ªéƒ¨åˆ†ï¼š</p><ul><li><p><code>fd</code>: è¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œè¡¨æ˜è¦å†™å…¥çš„æ–‡ä»¶ã€‚æ–‡ä»¶æè¿°ç¬¦æ˜¯ä¸€ä¸ªå”¯ä¸€çš„æ•°å­—ï¼Œæ ‡è¯†æ‰“å¼€çš„æ–‡ä»¶ã€‚ä½ éœ€è¦å…ˆä½¿ç”¨ <code>fs.open</code> æ–¹æ³•æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å¹¶è·å–å…¶æ–‡ä»¶æè¿°ç¬¦ï¼Œç„¶åæ‰èƒ½å¾€é‡Œé¢å†™å…¥æ•°æ®ã€‚</p></li><li><p><code>buffers</code>: è¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†å¤šä¸ª <code>Buffer</code> æˆ– <code>Uint8Array</code> å¯¹è±¡ã€‚<code>Buffer</code> åœ¨ Node.js ä¸­æ˜¯ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ï¼Œè€Œ <code>Uint8Array</code> æ˜¯ä¸€ä¸ªè¡¨ç¤ºå›ºå®šé•¿åº¦çš„åŸå§‹äºŒè¿›åˆ¶æ•°æ®ç¼“å†²åŒºçš„æ•°ç»„ã€‚</p></li><li><p><code>position</code>: è¿™ä¸ªå¯é€‰å‚æ•°æŒ‡å®šäº†å¼€å§‹å†™å…¥æ–‡ä»¶çš„ä½ç½®ã€‚å¦‚æœçœç•¥è¯¥å‚æ•°ï¼Œå†™å…¥å°†ä¼šä»å½“å‰æ–‡ä»¶çš„æœ«å°¾å¼€å§‹ã€‚</p></li><li><p><code>callback</code>: å½“å†™å…¥å®Œæˆæˆ–å‘ç”Ÿé”™è¯¯æ—¶ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚å®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼š<code>err</code> å’Œ <code>written</code>ã€‚<code>err</code> æ˜¯é”™è¯¯å¯¹è±¡ï¼Œå¦‚æœå†™å…¥è¿‡ç¨‹ä¸­æ²¡æœ‰å‘ç”Ÿé”™è¯¯ï¼Œåˆ™ä¸º nullã€‚<code>written</code> è¡¨ç¤ºå®é™…å†™å…¥çš„ <code>Buffer</code> æ•°é‡ã€‚</p></li></ul><h4 id="å®é™…è¿ç”¨çš„ä¾‹å­-8" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-8"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h4><p>å‡è®¾ä½ æƒ³è¦å‘ä¸€ä¸ªå«åš &quot;example.txt&quot; çš„æ–‡ä»¶ä¸­å†™å…¥ä¸€äº›æ•°æ®ï¼Œå¹¶ä¸”æ¯æ®µæ•°æ®éƒ½å­˜å‚¨åœ¨ä¸åŒçš„ <code>Buffer</code> å¯¹è±¡ä¸­ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡†å¤‡æ•°æ®</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> buffer1</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> buffer2</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">World!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> buffer3</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;"> This is an example.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> buffersArray</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#D8DEE9;">buffer1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer2</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer3</span><span style="color:#D8DEE9FF;">]</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶å‡†å¤‡å†™å…¥</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">openErr</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">openErr</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> openErr</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨ fs.writev å†™å…¥æ•°æ®</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writev</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffersArray</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">writeErr</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> written</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffers</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">writeErr</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error writing the file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> writeErr</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      return;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Successfully wrote </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">written</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> buffers to the file.</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">closeErr</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">closeErr</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error closing the file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> closeErr</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œé¦–å…ˆå¯¼å…¥äº† <code>fs</code> æ¨¡å—ã€‚ç„¶ååˆ›å»ºäº†ä¸‰ä¸ªåŒ…å«æ–‡æœ¬æ•°æ®çš„ <code>Buffer</code> å¯¹è±¡ï¼Œå¹¶å°†è¿™äº›å¯¹è±¡æ”¾å…¥ä¸€ä¸ªæ•°ç»„ <code>buffersArray</code> ä¸­ã€‚ä½¿ç”¨ <code>fs.open</code> æ–¹æ³•æ‰“å¼€æ–‡ä»¶ï¼ˆå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºï¼‰ï¼Œè·å–æ–‡ä»¶æè¿°ç¬¦ <code>fd</code>ã€‚ç„¶åè°ƒç”¨ <code>fs.writev</code> æ–¹æ³•ï¼Œä¼ å…¥æ–‡ä»¶æè¿°ç¬¦ã€<code>Buffer</code> æ•°ç»„å’Œå›è°ƒå‡½æ•°ã€‚å½“å†™å…¥å®Œæˆæ—¶ï¼Œå›è°ƒå‡½æ•°ä¼šè¾“å‡ºå†™å…¥æˆåŠŸçš„æ¶ˆæ¯ï¼Œå¹¶å…³é—­æ–‡ä»¶ã€‚å¦‚æœåœ¨ä»»ä½•æ­¥éª¤ä¸­é‡åˆ°é”™è¯¯ï¼Œå°†æŠ›å‡ºå¼‚å¸¸æˆ–æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚</p><h2 id="synchronous-api" tabindex="-1"><a class="header-anchor" href="#synchronous-api"><span><a href="https://nodejs.org/docs/latest/api/fs.html#synchronous-api" target="_blank" rel="noopener noreferrer">Synchronous API</a></span></a></h2><p>Node.js ä¸­çš„ Synchronous APIï¼Œæˆ–è€…è¯´åŒæ­¥ APIï¼Œä¸»è¦æ˜¯æŒ‡åœ¨æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—ä¸­èƒ½å¤ŸåŒæ­¥æ‰§è¡Œçš„æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•æ‰§è¡Œæ—¶ä¼šé˜»å¡ Node.js çš„äº‹ä»¶å¾ªç¯ï¼Œç›´åˆ°æ“ä½œå®Œæˆã€‚è¿™æ„å‘³ç€åœ¨æ–‡ä»¶æ“ä½œæ²¡æœ‰ç»“æŸä¹‹å‰ï¼Œå…¶ä»–ä»£ç æˆ–è€…äº‹ä»¶å¤„ç†ä¸èƒ½æ‰§è¡Œã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨ fs æ¨¡å—ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦è¿›è¡Œæ–‡ä»¶è¯»å†™æ“ä½œã€‚Node.js æä¾›äº†åŒæ­¥å’Œå¼‚æ­¥ä¸¤ç§æ–¹å¼æ¥å¤„ç†è¿™äº›æ“ä½œã€‚åŒæ­¥æ–¹æ³•é€šå¸¸ä»¥ <code>Sync</code> ç»“å°¾ï¼Œæ¯”å¦‚ <code>readFileSync</code> æ˜¯åŒæ­¥è¯»å–æ–‡ä»¶çš„æ–¹æ³•ã€‚</p><p>è¿™é‡Œç»™ä½ ä¸¾å‡ ä¸ªå®ä¾‹ï¼Œè¯´æ˜åŒæ­¥ API åœ¨æ–‡ä»¶æ“ä½œä¸­æ˜¯å¦‚ä½•ä½¿ç”¨çš„ï¼š</p><h3 id="_1-è¯»å–æ–‡ä»¶å†…å®¹-readfilesync" tabindex="-1"><a class="header-anchor" href="#_1-è¯»å–æ–‡ä»¶å†…å®¹-readfilesync"><span>1. è¯»å–æ–‡ä»¶å†…å®¹ï¼ˆreadFileSyncï¼‰</span></a></h3><p>å½“æˆ‘ä»¬æƒ³è¦è¯»å–ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶ä¸”ä¸æƒ³è®©å…¶ä»–ä»»ä½•ä»£ç æ‰§è¡Œï¼Œç›´åˆ°æ–‡ä»¶å†…å®¹è¢«å®Œå…¨è¯»å–ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>readFileSync</code> æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¼šç›´æ¥è¿”å›æ–‡ä»¶çš„å†…å®¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åŒæ­¥åœ°è¯»å–æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">  encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#88C0D0;">  flag</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å°æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>readFileSync</code> ä¼šé˜»å¡ç¨‹åºæ‰§è¡Œï¼Œç›´åˆ°æ–‡ä»¶ <code>/path/to/file.txt</code> è¢«è¯»å–å®Œæ¯•ï¼Œå¹¶å°†å†…å®¹å­˜å…¥å˜é‡ <code>data</code>ã€‚ç„¶åæˆ‘ä»¬æŠŠå®ƒæ‰“å°å‡ºæ¥ã€‚</p><h3 id="_2-å†™å…¥æ–‡ä»¶å†…å®¹-writefilesync" tabindex="-1"><a class="header-anchor" href="#_2-å†™å…¥æ–‡ä»¶å†…å®¹-writefilesync"><span>2. å†™å…¥æ–‡ä»¶å†…å®¹ï¼ˆwriteFileSyncï¼‰</span></a></h3><p>å¦‚æœæˆ‘ä»¬æƒ³è¦å†™å…¥ä¸€äº›æ•°æ®åˆ°æ–‡ä»¶ä¸­ï¼Œå¹¶ç¡®ä¿åœ¨æ•°æ®å†™å…¥å®Œæˆä¹‹å‰ä¸è¿›è¡Œä»»ä½•å…¶ä»–æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>writeFileSync</code> æ–¹æ³•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è¦å†™å…¥çš„æ•°æ®</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> content</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, Node.js!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åŒæ­¥åœ°å°†å†…å®¹å†™å…¥æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> content</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å†™å…¥æˆåŠŸã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œ<code>writeFileSync</code> æ–¹æ³•ä¼šå°†å­—ç¬¦ä¸² <code>&#39;Hello, Node.js!&#39;</code> å†™å…¥åˆ°è·¯å¾„ä¸º <code>/path/to/file.txt</code> çš„æ–‡ä»¶ä¸­ã€‚è¯¥è¿‡ç¨‹æ˜¯åŒæ­¥çš„ï¼Œæ‰€ä»¥åªæœ‰åœ¨å†™å…¥æ“ä½œå®Œæˆåï¼Œ<code>console.log(&#39;æ–‡ä»¶å†™å…¥æˆåŠŸã€‚&#39;);</code> è¿™è¡Œä»£ç æ‰ä¼šæ‰§è¡Œã€‚</p><h3 id="_3-æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨-existssync" tabindex="-1"><a class="header-anchor" href="#_3-æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨-existssync"><span>3. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼ˆexistsSyncï¼‰</span></a></h3><p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦æ£€æŸ¥æŸä¸ªæ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œç„¶ååŸºäºè¿™ä¸ªä¿¡æ¯åšå‡ºå†³ç­–ã€‚<code>existsSync</code> æ–¹æ³•å…è®¸æˆ‘ä»¬åŒæ­¥åœ°æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></span>
<span class="line"><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">existsSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å­˜åœ¨ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶ä¸å­˜åœ¨ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œä¼šæ‰“å° &quot;æ–‡ä»¶å­˜åœ¨ã€‚&quot;ï¼›å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šæ˜¾ç¤º &quot;æ–‡ä»¶ä¸å­˜åœ¨ã€‚&quot;ã€‚</p><p>ä½¿ç”¨åŒæ­¥ API çš„å¥½å¤„æ˜¯ä»£ç æ˜“äºç†è§£å’Œç¼–å†™ï¼Œå› ä¸ºå®ƒä»¬éµå¾ªè‡ªä¸Šè€Œä¸‹çš„æ‰§è¡Œé¡ºåºã€‚ä½†åœ¨å¤„ç†å¤§å‹æ–‡ä»¶æˆ–è€…å¤šä¸ªæ–‡ä»¶æ“ä½œæ—¶ï¼Œå®ƒä»¬å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå› ä¸ºæ•´ä¸ªç¨‹åºä¼šç­‰å¾…æ¯ä¸ªæ–‡ä»¶æ“ä½œå®Œæˆåå†ç»§ç»­æ‰§è¡Œã€‚è¿™åœ¨é«˜å¹¶å‘æƒ…å†µä¸‹æ˜¯ä¸å¯å–çš„ï¼Œå› æ­¤å¯¹äºæœåŠ¡å™¨ç«¯åº”ç”¨ï¼ŒNode.js ç¤¾åŒºæ›´æ¨èä½¿ç”¨å¼‚æ­¥ API æ¥æé«˜æ•ˆç‡ã€‚</p><h3 id="fs-accesssync-path-mode" tabindex="-1"><a class="header-anchor" href="#fs-accesssync-path-mode"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsaccesssyncpath-mode" target="_blank" rel="noopener noreferrer">fs.accessSync(path[, mode])</a></span></a></h3><p><code>fs.accessSync(path[, mode])</code> æ˜¯ä¸€ä¸ª Node.js æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ä¸­çš„ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œç”¨äºæ£€æŸ¥å½“å‰è¿è¡Œ Node.js è¿›ç¨‹çš„ç”¨æˆ·æ˜¯å¦æœ‰æƒé™è®¿é—®ç»™å®šçš„<code>path</code>ã€‚è¿™ä¸ª<code>path</code>å¯ä»¥æ˜¯æ–‡ä»¶æˆ–ç›®å½•ã€‚å®ƒæ˜¯<code>fs.access()</code>æ–¹æ³•çš„åŒæ­¥ç‰ˆæœ¬ï¼Œæ„æ€æ˜¯å®ƒä¼šé˜»å¡ Node.js äº‹ä»¶å¾ªç¯ç›´åˆ°æ“ä½œå®Œæˆã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>path</code>ï¼šä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€… Bufferï¼Œä»£è¡¨äº†è¦è®¿é—®çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><code>mode</code>ï¼ˆå¯é€‰ï¼‰ï¼šä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šè¦è¿›è¡Œçš„è®¿é—®æ£€æŸ¥ç±»å‹ã€‚å¸¸è§çš„å€¼åŒ…æ‹¬ï¼š <ul><li><code>fs.constants.F_OK</code>ï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼ˆé»˜è®¤å€¼ï¼‰ã€‚</li><li><code>fs.constants.R_OK</code>ï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯è¯»ã€‚</li><li><code>fs.constants.W_OK</code>ï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯å†™ã€‚</li><li><code>fs.constants.X_OK</code>ï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œã€‚</li></ul></li></ul><p>å¦‚æœç”¨æˆ·æœ‰è®¿é—®æƒé™ï¼Œè¿™ä¸ªæ–¹æ³•ä»€ä¹ˆéƒ½ä¸è¿”å›ï¼›å¦‚æœæ²¡æœ‰è®¿é—®æƒé™ï¼Œåˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p><p>ä½¿ç”¨<code>fs.accessSync</code>çš„ä¾‹å­ï¼š</p><ol><li>æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">accessSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">F_OK</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å­˜åœ¨</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶ä¸å­˜åœ¨</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°è¯•è®¿é—®åä¸º<code>file.txt</code>çš„æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œå°†è¾“å‡ºâ€œæ–‡ä»¶å­˜åœ¨â€ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°†æ•è·åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œå¹¶è¾“å‡ºâ€œæ–‡ä»¶ä¸å­˜åœ¨â€ã€‚</p><ol start="2"><li>æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯è¯»å’Œå¯å†™ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯è¯»å’Œå¯å†™</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">accessSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">R_OK</span><span style="color:#81A1C1;"> |</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">W_OK</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å¯è¯»å†™</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ— æ³•è¯»å†™æ–‡ä»¶ï¼Œå¯èƒ½æ–‡ä»¶ä¸å­˜åœ¨æˆ–æƒé™ä¸å¤Ÿ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°è¯•æ£€æŸ¥æ–‡ä»¶<code>file.txt</code>æ˜¯å¦æ—¢å¯è¯»åˆå¯å†™ã€‚å¦‚æœå…·å¤‡è¯»å†™æƒé™åˆ™è¾“å‡ºâ€œæ–‡ä»¶å¯è¯»å†™â€ï¼Œå¦åˆ™æ•è·å¹¶è¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p><ol start="3"><li>æ£€æŸ¥ç›®å½•æ˜¯å¦å¯æ‰§è¡Œï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æ£€æŸ¥ç›®å½•æ˜¯å¦å¯æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">accessSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">my_directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">X_OK</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•å¯æ‰§è¡Œ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•ä¸å¯æ‰§è¡Œ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æ­¤ä¾‹ä¸­ï¼Œæˆ‘ä»¬æ£€æŸ¥åä¸º<code>my_directory</code>çš„ç›®å½•æ˜¯å¦å¯æ‰§è¡Œã€‚è¿™åœ¨æŸäº›æƒ…å†µä¸‹å¾ˆæœ‰ç”¨ï¼Œæ¯”å¦‚ä½ è¦æ£€æŸ¥ä¸€ä¸ªç›®å½•æ˜¯å¦å¯ä»¥ä½œä¸ºå‘½ä»¤æ¥æ‰§è¡Œã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå°½ç®¡<code>fs.accessSync()</code>å¯ä»¥å‘Šè¯‰ä½ å½“å‰ç”¨æˆ·æ˜¯å¦æœ‰æƒé™è®¿é—®æŸä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œä½†å®ƒé€šå¸¸ä¸æ˜¯æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨çš„æœ€ä½³æ–¹å¼ã€‚å› ä¸ºä»æ£€æŸ¥åˆ°å®é™…æ“ä½œä¹‹é—´æœ‰ä¸€ä¸ªæ—¶é—´çª—å£ï¼Œåœ¨è¿™ä¸ªæ—¶é—´çª—å£å†…ï¼Œæ–‡ä»¶çš„çŠ¶æ€å¯èƒ½å·²ç»æ”¹å˜ã€‚å¯¹äºæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨å¹¶è¿›è¡Œåç»­æ“ä½œï¼Œä¸€ç§æ›´å¥½çš„æ–¹å¼æ˜¯ç›´æ¥å°è¯•è¯»å–æˆ–å†™å…¥ï¼Œå¹¶å¤„ç†å¯èƒ½å‘ç”Ÿçš„é”™è¯¯ã€‚</p><h3 id="fs-appendfilesync-path-data-options" tabindex="-1"><a class="header-anchor" href="#fs-appendfilesync-path-data-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsappendfilesyncpath-data-options" target="_blank" rel="noopener noreferrer">fs.appendFileSync(path, data[, options])</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome çš„ V8 JavaScript å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒè®©å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚Node.js æä¾›äº†å¾ˆå¤šæ ¸å¿ƒæ¨¡å—ï¼Œå…¶ä¸­ <code>fs</code> æ¨¡å—å°±æ˜¯ç”¨æ¥è¿›è¡Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„ã€‚<code>fs.appendFileSync</code> æ˜¯ <code>fs</code> æ¨¡å—æä¾›çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨æ¥åŒæ­¥åœ°å°†æ•°æ®è¿½åŠ åˆ°æ–‡ä»¶çš„æœ«å°¾ã€‚</p><p>å¦‚æœä½ ä¹‹å‰æ²¡æœ‰å¬è¯´è¿‡åŒæ­¥ï¼ˆsynchronousï¼‰è¿™ä¸ªè¯ï¼Œç®€å•æ¥è¯´ï¼ŒåŒæ­¥æ“ä½œä¼šé˜»å¡ï¼ˆä¹Ÿå°±æ˜¯æš‚åœï¼‰ç¨‹åºçš„æ‰§è¡Œï¼Œç›´åˆ°æ“ä½œå®Œæˆã€‚è¿™å¯¹äºç¡®ä¿åœ¨ç»§ç»­æ‰§è¡Œå…¶ä»–ä»£ç ä¹‹å‰æ–‡ä»¶å·²è¢«æˆåŠŸä¿®æ”¹æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬ä¸€æ­¥æ­¥æ¥è¯¦ç»†è§£é‡Š <code>fs.appendFileSync</code>ï¼š</p><ol><li><code>path</code>: è¿™æ˜¯ä½ æƒ³è¦è¿½åŠ å†…å®¹çš„æ–‡ä»¶çš„è·¯å¾„ã€‚</li><li><code>data</code>: è¿™æ˜¯ä½ æƒ³è¦æ·»åŠ åˆ°æ–‡ä»¶æœ«å°¾çš„æ•°æ®ï¼Œå®ƒå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–è€…ä¸€ä¸ª Bufferï¼ˆäºŒè¿›åˆ¶æ•°æ®ï¼‰ã€‚</li><li><code>options</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå®ƒå…è®¸ä½ æŒ‡å®šä¸€äº›å†™å…¥æ–‡ä»¶æ—¶çš„é€‰é¡¹ï¼Œæ¯”å¦‚æ–‡ä»¶çš„ç¼–ç ã€‚</li></ol><p>ä¸¾å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><h3 id="ç¤ºä¾‹-1-å‘æ–‡æœ¬æ–‡ä»¶è¿½åŠ å­—ç¬¦ä¸²" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-å‘æ–‡æœ¬æ–‡ä»¶è¿½åŠ å­—ç¬¦ä¸²"><span>ç¤ºä¾‹ 1ï¼šå‘æ–‡æœ¬æ–‡ä»¶è¿½åŠ å­—ç¬¦ä¸²</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º <code>log.txt</code> çš„æ–‡ä»¶ï¼Œä½ æƒ³è¦åœ¨å®ƒçš„æœ«å°¾è¿½åŠ ä¸€è¡Œæ—¥å¿—ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ—¥å¿—ä¿¡æ¯</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> logMessage</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯æ–°å¢çš„æ—¥å¿—ã€‚</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // \n è¡¨ç¤ºæ¢è¡Œç¬¦</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åŒæ­¥åœ°è¿½åŠ æ—¥å¿—ä¿¡æ¯åˆ° log.txt æ–‡ä»¶çš„æœ«å°¾</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">appendFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">log.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> logMessage</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œä¸Šé¢çš„ä»£ç åï¼Œä½ çš„ <code>log.txt</code> æ–‡ä»¶æœ«å°¾å°†ä¼šå¢åŠ ä¸€è¡Œ &quot;è¿™æ˜¯æ–°å¢çš„æ—¥å¿—ã€‚&quot;ã€‚</p><h3 id="ç¤ºä¾‹-2-ä½¿ç”¨é€‰é¡¹å‚æ•°æŒ‡å®šç¼–ç " tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨é€‰é¡¹å‚æ•°æŒ‡å®šç¼–ç "><span>ç¤ºä¾‹ 2ï¼šä½¿ç”¨é€‰é¡¹å‚æ•°æŒ‡å®šç¼–ç </span></a></h3><p>å¦‚æœä½ æƒ³è¦æŒ‡å®šæ–‡ä»¶ç¼–ç ï¼Œå¯ä»¥åœ¨è°ƒç”¨ <code>appendFileSync</code> å‡½æ•°æ—¶ä¼ é€’ä¸€ä¸ªé€‰é¡¹å¯¹è±¡ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> logMessage</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯å¦ä¸€æ¡æ—¥å¿—ã€‚</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åœ¨è¿™é‡Œæˆ‘ä»¬é€šè¿‡ options å¯¹è±¡æŒ‡å®šäº†æ–‡ä»¶ç¼–ç ä¸º &#39;utf8&#39;</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">appendFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">log.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> logMessage</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå³ä½¿ä¸æŒ‡å®š <code>{ encoding: &#39;utf8&#39; }</code>ï¼Œç»“æœä¹Ÿä¼šæ˜¯ä¸€æ ·çš„ï¼Œå› ä¸º &#39;utf8&#39; æ˜¯ Node.js ä¸­é»˜è®¤çš„ç¼–ç æ–¹å¼ã€‚ä½†æ˜¯æ˜ç¡®æŒ‡å®šç¼–ç å¯ä»¥è®©ä»£ç æ›´æ¸…æ™°ï¼Œå¹¶ä¸”ä½ å¯ä»¥æ”¹å˜å®ƒæ¥æ»¡è¶³ç‰¹å®šçš„éœ€è¦ã€‚</p><p>è®°ä½ï¼Œç”±äºæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨åŒæ­¥ç‰ˆæœ¬çš„ <code>appendFileSync</code>ï¼Œæ‰€ä»¥æ¯æ¬¡è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œç¨‹åºéƒ½ä¼šç­‰å¾…ç›´åˆ°æ–‡ä»¶è¢«å†™å…¥å®Œæˆæ‰ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚å¦‚æœä½ è¦å¤„ç†å¤§é‡çš„è¿½åŠ æ“ä½œæˆ–è€…åœ¨é«˜æ€§èƒ½è¦æ±‚çš„åœºæ™¯ä¸‹ï¼Œå¯èƒ½éœ€è¦è€ƒè™‘ä½¿ç”¨å¼‚æ­¥ç‰ˆæœ¬ (<code>fs.appendFile</code>) æ¥é¿å…é˜»å¡äº‹ä»¶å¾ªç¯ã€‚</p><p>è¿™å°±æ˜¯ <code>fs.appendFileSync</code> å‡½æ•°çš„åŸºæœ¬ç”¨æ³•å’Œä¸€äº›å®é™…åº”ç”¨çš„ä¾‹å­ã€‚å¸Œæœ›è¿™æœ‰åŠ©äºä½ ç†è§£å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼</p><h3 id="fs-chmodsync-path-mode" tabindex="-1"><a class="header-anchor" href="#fs-chmodsync-path-mode"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fschmodsyncpath-mode" target="_blank" rel="noopener noreferrer">fs.chmodSync(path, mode)</a></span></a></h3><p><code>fs.chmodSync(path, mode)</code> æ˜¯ Node.js ä¸­æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºåŒæ­¥åœ°æ›´æ”¹æŒ‡å®šæ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ã€‚åœ¨ Node.js ä¸­ï¼Œ&quot;åŒæ­¥&quot;æ„å‘³ç€ä»£ç æ‰§è¡Œåˆ°è¿™ä¸ªå‡½æ•°æ—¶ä¼šåœä¸‹æ¥ï¼Œç›´åˆ°è¿™ä¸ªå‡½æ•°å®Œæˆå…¶ä»»åŠ¡åæ‰ä¼šç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç ã€‚</p><h3 id="å‚æ•°è§£é‡Š-20" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-20"><span>å‚æ•°è§£é‡Šï¼š</span></a></h3><ol><li><code>path</code>ï¼šè¡¨ç¤ºæ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„çš„å­—ç¬¦ä¸²ã€‚</li><li><code>mode</code>ï¼šä¸€ä¸ªä»£è¡¨æƒé™çš„æ•°å­—ã€‚åœ¨ Unix ç³»ç»Ÿä¸­ï¼Œè¿™é€šå¸¸æ˜¯ä¸€ä¸ªå…«è¿›åˆ¶æ•°ï¼Œè¡¨ç¤ºæ–‡ä»¶çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ã€‚</li></ol><p>Unix ç³»ç»Ÿçš„æƒé™åŒ…æ‹¬ä¸‰ç»„ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ul><li><strong>æ‰€æœ‰è€…æƒé™</strong>ï¼šæ–‡ä»¶çš„åˆ›å»ºè€…ã€‚</li><li><strong>ç¾¤ç»„æƒé™</strong>ï¼šæ–‡ä»¶æ‰€å±ç¾¤ç»„å†…çš„ç”¨æˆ·ã€‚</li><li><strong>å…¶ä»–ç”¨æˆ·æƒé™</strong>ï¼šæ—¢ä¸æ˜¯æ–‡ä»¶åˆ›å»ºè€…ä¹Ÿä¸æ˜¯ç¾¤ç»„å†…çš„å…¶ä»–ç”¨æˆ·ã€‚</li></ul><p>æ¯ç»„æƒé™å¯ä»¥è®¾ç½®ä¸‰ç§æƒé™ç±»å‹ï¼š</p><ul><li><strong>è¯»æƒé™ï¼ˆrï¼‰</strong>ï¼šå…è®¸è¯»å–æ–‡ä»¶å†…å®¹ã€‚</li><li><strong>å†™æƒé™ï¼ˆwï¼‰</strong>ï¼šå…è®¸ä¿®æ”¹æ–‡ä»¶å†…å®¹ã€‚</li><li><strong>æ‰§è¡Œæƒé™ï¼ˆxï¼‰</strong>ï¼šå…è®¸æ‰§è¡Œæ–‡ä»¶ï¼ˆå¦‚æœå®ƒæ˜¯å¯æ‰§è¡Œçš„ç¨‹åºï¼‰ã€‚</li></ul><p>æ¯ä¸ªæƒé™ç±»å‹å¯¹åº”ä¸€ä¸ªå€¼ï¼šè¯»ï¼ˆ4ï¼‰ã€å†™ï¼ˆ2ï¼‰ã€æ‰§è¡Œï¼ˆ1ï¼‰ã€‚å°†è¿™äº›å€¼åŠ èµ·æ¥å°±å¾—åˆ°äº†è¯¥ç»„çš„æ€»æƒé™ã€‚æ¯”å¦‚ï¼Œè¯»+å†™+æ‰§è¡Œ = 4 + 2 + 1 = 7ã€‚</p><h3 id="æƒé™ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#æƒé™ç¤ºä¾‹"><span>æƒé™ç¤ºä¾‹ï¼š</span></a></h3><ul><li><code>0o755</code>ï¼šè¡¨ç¤ºæ‰€æœ‰è€…æœ‰è¯»ã€å†™ã€æ‰§è¡Œæƒé™ï¼ˆ7ï¼‰ï¼Œç¾¤ç»„å’Œå…¶ä»–ç”¨æˆ·æœ‰è¯»å’Œæ‰§è¡Œæƒé™ï¼ˆ5ï¼‰ã€‚</li><li><code>0o644</code>ï¼šè¡¨ç¤ºæ‰€æœ‰è€…æœ‰è¯»ã€å†™æƒé™ï¼ˆ6ï¼‰ï¼Œç¾¤ç»„å’Œå…¶ä»–ç”¨æˆ·åªæœ‰è¯»æƒé™ï¼ˆ4ï¼‰ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-18" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-18"><span>å®é™…è¿ç”¨ä¾‹å­ï¼š</span></a></h3><ol><li>å‡è®¾ä½ æœ‰ä¸€ä¸ªå«åš <code>example.txt</code> çš„æ–‡ä»¶ï¼Œä½ æƒ³è¦è®¾ç½®è¿™ä¸ªæ–‡ä»¶ï¼Œä½¿å¾—æ–‡ä»¶æ‰€æœ‰è€…å¯ä»¥è¯»å†™ï¼Œè€Œå…¶ä»–äººåªèƒ½è¯»ã€‚ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è®¾ç½® example.txt æ–‡ä»¶æƒé™ä¸º &#39;644&#39;</span></span>
<span class="line"><span style="color:#616E88;">// æ‰€æœ‰è€…è¯»å†™ï¼ˆ6ï¼‰ï¼Œç¾¤ç»„å’Œå…¶ä»–ç”¨æˆ·åªè¯»ï¼ˆ4ï¼‰</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">chmodSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0o644</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶æƒé™å·²æ›´æ”¹ä¸º 644</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>å¦‚æœä½ éœ€è¦è®¾ç½®ä¸€ä¸ªåä¸º <code>script.sh</code> çš„è„šæœ¬æ–‡ä»¶ï¼Œä½¿å¾—æ¯ä¸ªäººéƒ½å¯ä»¥æ‰§è¡Œå®ƒï¼Œå¯ä»¥è¿™æ ·åšï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è®¾ç½® script.sh æ–‡ä»¶æƒé™ä¸º &#39;755&#39;</span></span>
<span class="line"><span style="color:#616E88;">// æ‰€æœ‰è€…è¯»å†™æ‰§è¡Œï¼ˆ7ï¼‰ï¼Œç¾¤ç»„å’Œå…¶ä»–ç”¨æˆ·è¯»æ‰§è¡Œï¼ˆ5ï¼‰</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">chmodSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">script.sh</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0o755</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è„šæœ¬æƒé™å·²æ›´æ”¹ä¸º 755</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼šå¦‚æœä½ åœ¨ Windows ç³»ç»Ÿä¸Šè¿è¡Œè¿™äº›ä»£ç ï¼Œæ–‡ä»¶æƒé™çš„æ¦‚å¿µå¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œå› ä¸º Windows å’Œ Unix-like ç³»ç»Ÿåœ¨æ–‡ä»¶æƒé™ç®¡ç†ä¸Šæœ‰æ‰€åŒºåˆ«ã€‚åœ¨ Windows ä¸Šï¼Œå°½ç®¡ Node.js æä¾›äº† <code>chmodSync</code> æ–¹æ³•ï¼Œä½†å…¶æ•ˆæœå¯èƒ½ä¸å¦‚åœ¨ç±» Unix ç³»ç»Ÿä¸Šæ˜æ˜¾æˆ–ä¸€è‡´ã€‚</p><p>åœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ­£ç¡®è®¾ç½®æ–‡ä»¶æƒé™æ˜¯éå¸¸é‡è¦çš„ï¼Œç‰¹åˆ«æ˜¯å½“ä½ åœ¨å¤„ç†æœåŠ¡å™¨å’Œå¤šç”¨æˆ·ç¯å¢ƒæ—¶ã€‚é”™è¯¯çš„æƒé™è®¾ç½®å¯èƒ½ä¼šå¯¼è‡´å®‰å…¨é—®é¢˜ï¼Œæ¯”å¦‚æ•æ„Ÿä¿¡æ¯æ³„éœ²æˆ–æœªæˆæƒçš„ä¿®æ”¹ã€‚</p><h3 id="fs-chownsync-path-uid-gid" tabindex="-1"><a class="header-anchor" href="#fs-chownsync-path-uid-gid"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fschownsyncpath-uid-gid" target="_blank" rel="noopener noreferrer">fs.chownSync(path, uid, gid)</a></span></a></h3><p>ç†è§£ <code>fs.chownSync(path, uid, gid)</code> æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£å‡ ä¸ªæ¦‚å¿µï¼š</p><ol><li><p><strong>Node.js</strong>: ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå¯ä»¥è®©ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚</p></li><li><p><strong>File System (<code>fs</code>) æ¨¡å—</strong>: åœ¨ Node.js ä¸­ï¼Œ<code>fs</code>æ¨¡å—æ˜¯ç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ä¸€éƒ¨åˆ†ã€‚å®ƒæä¾›äº†åˆ›å»ºã€è¯»å–ã€å†™å…¥ã€åˆ é™¤æ–‡ä»¶ç­‰åŠŸèƒ½ã€‚</p></li><li><p><strong>åŒæ­¥å‡½æ•°</strong>: åœ¨ Node.js ä¸­ï¼ŒåŒæ­¥å‡½æ•°æ„å‘³ç€ä»£ç æ‰§è¡Œæ—¶ä¼šæŒ‰é¡ºåºä¸€æ­¥æ¥ä¸€æ­¥åœ°è¿›è¡Œï¼Œç›´åˆ°å½“å‰æ“ä½œå®Œæˆåæ‰ä¼šæ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚</p></li><li><p><strong><code>chown</code></strong>: æ˜¯ UNIX å’Œç±» UNIX ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªå‘½ä»¤ï¼Œç”¨äºæ”¹å˜æ–‡ä»¶æˆ–ç›®å½•çš„æ‹¥æœ‰è€…ï¼ˆownerï¼‰å’Œæ‰€å±ç»„ï¼ˆgroupï¼‰ã€‚</p></li></ol><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¯¦ç»†è§£é‡Šä¸€ä¸‹ <code>fs.chownSync(path, uid, gid)</code>:</p><ul><li><code>path</code>: è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼ŒæŒ‡å®šäº†æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><code>uid</code>: ç”¨æˆ· IDï¼ˆUser IDï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šæ–°çš„æ–‡ä»¶æˆ–ç›®å½•æ‹¥æœ‰è€…çš„ç”¨æˆ·æ ‡è¯†ç¬¦ã€‚</li><li><code>gid</code>: ç»„ IDï¼ˆGroup IDï¼‰ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šæ–°çš„æ–‡ä»¶æˆ–ç›®å½•æ‰€å±ç»„çš„ç»„æ ‡è¯†ç¬¦ã€‚</li><li><code>fs.chownSync()</code> æ–¹æ³•: ç”¨äºåŒæ­¥åœ°æ›´æ”¹æŒ‡å®šæ–‡ä»¶æˆ–ç›®å½•çš„æ‹¥æœ‰è€…å’Œæ‰€å±ç»„ã€‚è¿™ä¸ªæ–¹æ³•ä¼šé˜»å¡ Node.js äº‹ä»¶å¾ªç¯ï¼Œç›´åˆ°æ“ä½œå®Œæˆã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-19" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-19"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œä½ æƒ³è¦æ›´æ”¹ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶çš„æ‹¥æœ‰è€…ï¼Œä»¥ä¾¿ç‰¹å®šçš„ç”¨æˆ·å’Œç»„å¯ä»¥è®¿é—®æˆ–ä¿®æ”¹å®ƒã€‚æ¯”å¦‚ï¼Œä½ æœ‰ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ä½äº <code>/var/log/myapp.log</code>ï¼Œå¹¶ä¸”ä½ æƒ³è¦å°†å…¶æ‹¥æœ‰è€…æ›´æ”¹ä¸ºç”¨æˆ· ID ä¸º <code>1001</code> å’Œç»„ ID ä¸º <code>2001</code> çš„ç”¨æˆ·å’Œç»„ã€‚</p><p>åœ¨ Node.js ä»£ç ä¸­ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // è·¯å¾„ï¼Œç”¨æˆ·IDï¼Œç»„ID</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">chownSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/var/log/myapp.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1001</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 2001</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶æ‹¥æœ‰è€…æ›´æ”¹æˆåŠŸ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">åœ¨æ›´æ”¹æ–‡ä»¶æ‹¥æœ‰è€…æ—¶å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† Node.js çš„<code>fs</code>æ¨¡å—ã€‚ç„¶åä½¿ç”¨<code>fs.chownSync()</code>æ–¹æ³•æ›´æ”¹æ–‡ä»¶çš„æ‹¥æœ‰è€…å’Œæ‰€å±ç»„ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œä¼šæ‰“å°â€œæ–‡ä»¶æ‹¥æœ‰è€…æ›´æ”¹æˆåŠŸâ€ã€‚å¦‚æœå‘ç”Ÿé”™è¯¯ï¼ˆæ¯”å¦‚æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæˆ–è€…è¿è¡Œè¿™æ®µä»£ç çš„ç”¨æˆ·æ²¡æœ‰è¶³å¤Ÿçš„æƒé™å»æ›´æ”¹æ–‡ä»¶çš„æ‹¥æœ‰è€…ï¼‰ï¼Œåˆ™ä¼šæ•è·å¼‚å¸¸å¹¶æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="fs-closesync-fd" tabindex="-1"><a class="header-anchor" href="#fs-closesync-fd"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsclosesyncfd" target="_blank" rel="noopener noreferrer">fs.closeSync(fd)</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome çš„ V8 JavaScript å¼•æ“æ„å»ºçš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚Node.js æä¾›äº†ä¸€å¥—æ ¸å¿ƒçš„åº“ï¼Œå…è®¸ä½ è¿›è¡Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œã€ç½‘ç»œè¯·æ±‚ç­‰åŠŸèƒ½ã€‚åœ¨è¿™äº›æ ¸å¿ƒåº“ä¸­ï¼Œ<code>fs</code> æ¨¡å—æä¾›äº†ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„æ¥å£ã€‚</p><p><code>fs.closeSync(fd)</code> æ˜¯ <code>fs</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºåŒæ­¥å…³é—­ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼ˆFile Descriptorï¼Œç®€ç§° fdï¼‰ã€‚&quot;åŒæ­¥&quot;æ„å‘³ç€å½“ä½ è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼ŒNode.js ä¼šåœä¸‹æ¥ç­‰å¾…æ–‡ä»¶å…³é—­å®Œæˆåæ‰ä¼šç»§ç»­æ‰§è¡Œä¹‹åçš„ä»£ç ã€‚å¦‚æœå…³é—­æ–‡ä»¶æ—¶å‡ºç°é”™è¯¯ï¼ŒNode.js å°†ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œä½ éœ€è¦ä½¿ç”¨ try-catch ç»“æ„æ¥æ•è·å’Œå¤„ç†è¿™äº›å¼‚å¸¸ã€‚</p><p>æ–‡ä»¶æè¿°ç¬¦æ˜¯ä¸€ä¸ªæ•°å­—æ ‡è¯†ï¼Œä»£è¡¨å¯¹æ“ä½œç³»ç»Ÿä¸­å·²æ‰“å¼€æ–‡ä»¶çš„å¼•ç”¨ã€‚åœ¨ Node.js ä¸­ï¼Œå¦‚æœä½ ä½¿ç”¨ <code>fs.open</code> æˆ– <code>fs.openSync</code> æ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œå°±ä¼šå¾—åˆ°ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚ä¹‹åè¿›è¡Œè¯»å†™æ“ä½œæ—¶ï¼Œä½ éœ€è¦ä½¿ç”¨è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦æ¥å‘Šè¯‰ Node.js ä½ æƒ³è¦æ“ä½œå“ªä¸ªæ–‡ä»¶ã€‚</p><h3 id="ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2"><span>ä¾‹å­ï¼š</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶ä¸”ä½ æƒ³è¦åœ¨ Node.js ä¸­æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œç„¶ååˆå®‰å…¨åœ°å…³é—­å®ƒã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨ <code>fs.closeSync(fd)</code> æ–¹æ³•æ¥å®ç°çš„ç¤ºä¾‹ä»£ç ã€‚</p><p><strong>æ‰“å¼€å¹¶å…³é—­æ–‡ä»¶çš„ä¾‹å­ï¼š</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æ‰“å¼€æ–‡ä»¶è·å–æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // &#39;r&#39; è¡¨ç¤ºä»¥åªè¯»æ–¹å¼æ‰“å¼€</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ... åœ¨è¿™é‡Œä½ å¯ä»¥æ‰§è¡Œå…¶ä»–æ–‡ä»¶æ“ä½œï¼Œä¾‹å¦‚è¯»å–æ–‡ä»¶å†…å®¹ ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦å®‰å…¨åœ°å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">  // å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œæ¯”å¦‚æ–‡ä»¶ä¸å­˜åœ¨æˆ–æ²¡æœ‰æƒé™ç­‰ï¼Œè¿™é‡Œä¼šæ•è·åˆ°</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">An error occurred:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† <code>fs</code> æ¨¡å—ã€‚æˆ‘ä»¬ä½¿ç”¨ <code>try-catch</code> ç»“æ„æ˜¯å› ä¸ºå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨æˆ–è€…æˆ‘ä»¬æ²¡æœ‰æƒé™å»æ‰“å¼€å®ƒï¼Œé‚£ä¹ˆ <code>fs.openSync</code> æ–¹æ³•å°†ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p><p>ç„¶åæˆ‘ä»¬ç”¨ <code>fs.openSync</code> æ–¹æ³•æ‰“å¼€ <code>example.txt</code> æ–‡ä»¶ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ <code>fd</code>ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>&#39;r&#39;</code> æ ‡å¿—æ¥ä»¥åªè¯»æ¨¡å¼æ‰“å¼€æ–‡ä»¶ã€‚</p><p>åœ¨æ–‡ä»¶æ“ä½œç»“æŸåï¼Œæˆ‘ä»¬é€šè¿‡ <code>fs.closeSync(fd)</code> æ¥å…³é—­æ–‡ä»¶æè¿°ç¬¦ï¼Œç¡®ä¿æ‰“å¼€çš„æ–‡ä»¶è¢«æ­£ç¡®å…³é—­ï¼Œè¿™æ ·å¯ä»¥é‡Šæ”¾ç³»ç»Ÿèµ„æºå¹¶é¿å…æ‰€è°“çš„æ–‡ä»¶æè¿°ç¬¦æ³„éœ²ï¼Œè¿™ç§æƒ…å†µå‘ç”Ÿåœ¨ç¨‹åºæ‰“å¼€äº†æ–‡ä»¶ä½†æœªå…³é—­ï¼Œé•¿æ­¤ä»¥å¾€å¯èƒ½è€—å°½ç³»ç»Ÿèµ„æºã€‚</p><p>æœ€åï¼Œå¦‚æœåœ¨æ‰“å¼€æˆ–å…³é—­æ–‡ä»¶è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯ï¼ˆä¾‹å¦‚æ–‡ä»¶æ‰¾ä¸åˆ°æˆ–æ²¡æœ‰è¯»å–æƒé™ï¼‰ï¼Œé”™è¯¯å°†ä¼šè¢« <code>catch</code> è¯­å¥æ•è·ï¼Œæˆ‘ä»¬åœ¨æ§åˆ¶å°ä¸­æ‰“å°å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="fs-copyfilesync-src-dest-mode" tabindex="-1"><a class="header-anchor" href="#fs-copyfilesync-src-dest-mode"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fscopyfilesyncsrc-dest-mode" target="_blank" rel="noopener noreferrer">fs.copyFileSync(src, dest[, mode])</a></span></a></h3><p>å½“ç„¶ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥äº†è§£<code>fs.copyFileSync(src, dest[, mode])</code>è¿™ä¸ªæ–¹æ³•åœ¨ Node.js ä¸­çš„ç”¨æ³•å’Œåº”ç”¨ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-13" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-13"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code>æ¨¡å—æ˜¯ä¸€ä¸ªç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„æ¨¡å—ã€‚å®ƒæä¾›äº†å¾ˆå¤šå®ç”¨çš„æ–¹æ³•æ¥åˆ›å»ºã€è¯»å–ã€å†™å…¥å’Œåˆ é™¤æ–‡ä»¶ç­‰ã€‚<code>fs.copyFileSync()</code>æ˜¯<code>fs</code>æ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºåŒæ­¥åœ°å°†ä¸€ä¸ªæ–‡ä»¶ä»æºè·¯å¾„å¤åˆ¶åˆ°ç›®æ ‡è·¯å¾„ã€‚</p><h3 id="å‚æ•°è§£é‡Š-21" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-21"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>src</code>: æºæ–‡ä»¶çš„è·¯å¾„ï¼ˆå¿…é¡»å‚æ•°ï¼‰ã€‚è¿™æ˜¯ä½ æƒ³è¦å¤åˆ¶çš„æ–‡ä»¶çš„å®Œæ•´è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„ã€‚</li><li><code>dest</code>: ç›®æ ‡æ–‡ä»¶çš„è·¯å¾„ï¼ˆå¿…é¡»å‚æ•°ï¼‰ã€‚è¿™æ˜¯æ–‡ä»¶å¤åˆ¶åˆ°çš„æ–°ä½ç½®çš„å®Œæ•´è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„ã€‚</li><li><code>mode</code> (å¯é€‰): ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šå¤åˆ¶æ“ä½œæ—¶çš„è¡Œä¸ºæ¨¡å¼ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªå‚æ•°è®¾ç½®ç›®æ ‡æ–‡ä»¶çš„æƒé™ã€‚</li></ul><h3 id="ä½¿ç”¨ç¤ºä¾‹-3" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹-3"><span>ä½¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œéœ€è¦å°†ä¸€äº›é…ç½®æ–‡ä»¶æˆ–èµ„æºä»ä¸€ä¸ªä½ç½®å¤åˆ¶åˆ°å¦ä¸€ä¸ªä½ç½®ä½œä¸ºåˆå§‹åŒ–è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ã€‚ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨<code>fs.copyFileSync()</code>æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼š</p><h4 id="ç¤ºä¾‹-1-åŸºç¡€ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åŸºç¡€ä½¿ç”¨"><span>ç¤ºä¾‹ 1: åŸºç¡€ä½¿ç”¨</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®šä¹‰æºæ–‡ä»¶è·¯å¾„å’Œç›®æ ‡æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> srcPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./config/sample-config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> destPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./build/config/sample-config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰§è¡Œå¤åˆ¶æ“ä½œ</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">copyFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">srcPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> destPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å¤åˆ¶æˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º<code>sample-config.json</code>çš„æ–‡ä»¶ä½äºé¡¹ç›®çš„<code>config</code>æ–‡ä»¶å¤¹ä¸­ã€‚æˆ‘ä»¬å¸Œæœ›å°†è¿™ä¸ªæ–‡ä»¶å¤åˆ¶åˆ°<code>build/config</code>ç›®å½•ä¸‹ã€‚<code>fs.copyFileSync(srcPath, destPath)</code>æ­£æ˜¯å®Œæˆè¿™ä¸ªä»»åŠ¡çš„ä»£ç è¡Œã€‚</p><h4 id="ç¤ºä¾‹-2-è®¾ç½®ç›®æ ‡æ–‡ä»¶çš„æƒé™" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-è®¾ç½®ç›®æ ‡æ–‡ä»¶çš„æƒé™"><span>ç¤ºä¾‹ 2: è®¾ç½®ç›®æ ‡æ–‡ä»¶çš„æƒé™</span></a></h4><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½è¿˜å¸Œæœ›è®¾ç½®ç›®æ ‡æ–‡ä»¶çš„æƒé™ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½æƒ³ç¡®ä¿ç›®æ ‡æ–‡ä»¶æ˜¯å¯è¯»ä¸”å¯å†™çš„ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®šä¹‰æºæ–‡ä»¶è·¯å¾„å’Œç›®æ ‡æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> srcPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./script.sh</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> destPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./build/script.sh</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æƒé™æ¨¡å¼ 0766 è¡¨ç¤ºæ‹¥æœ‰è€…å’Œç¾¤ç»„æˆå‘˜å¯ä»¥è¯»å†™æ‰§è¡Œï¼Œå…¶ä»–äººåªæœ‰è¯»å†™æƒé™</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">copyFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">srcPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> destPath</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0o766</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å¤åˆ¶å¹¶è®¾ç½®æƒé™æˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†<code>mode</code>å‚æ•°ï¼ˆ<code>0o766</code>ï¼‰æ¥åŒæ—¶å¤åˆ¶æ–‡ä»¶ï¼Œå¹¶è®¾ç½®ç›®æ ‡æ–‡ä»¶çš„æƒé™ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-16" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-16"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li><code>fs.copyFileSync()</code>æ˜¯ä¸€ä¸ªåŒæ­¥æ“ä½œï¼Œæ„å‘³ç€åœ¨å¤åˆ¶æ“ä½œå®Œæˆä¹‹å‰ï¼ŒNode.js è¿›ç¨‹ä¼šè¢«é˜»å¡ã€‚åœ¨å¤„ç†å¤§æ–‡ä»¶æˆ–é«˜é¢‘ç‡æ“ä½œæ—¶ï¼Œå¯èƒ½ä¼šå½±å“åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚</li><li>å¦‚æœç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œè¯¥æ–¹æ³•å°†ä¼šè¦†ç›–å®ƒï¼Œæ‰€ä»¥åœ¨æ‰§è¡Œå¤åˆ¶æ“ä½œå‰æœ€å¥½æ£€æŸ¥ç›®æ ‡è·¯å¾„æ˜¯å¦å·²è¢«å ç”¨ã€‚</li><li>è€ƒè™‘åˆ°é”™è¯¯å¤„ç†ï¼Œå°½ç®¡è¿™é‡Œæ²¡æœ‰å±•ç¤ºï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­ä½¿ç”¨ try-catch å—æ¥æ•è·å¹¶å¤„ç†å¯èƒ½å‡ºç°çš„å¼‚å¸¸æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚</li></ul><p>é€šè¿‡ä¸Šè¿°è¯¦ç»†ä»‹ç»å’Œç¤ºä¾‹ï¼Œå¸Œæœ›ä½ å¯¹<code>fs.copyFileSync()</code>æ–¹æ³•æœ‰äº†æ¸…æ™°çš„ç†è§£ï¼Œèƒ½å¤Ÿåœ¨ä½ çš„ Node.js é¡¹ç›®ä¸­æœ‰æ•ˆåœ°ä½¿ç”¨å®ƒã€‚</p><h3 id="fs-cpsync-src-dest-options" tabindex="-1"><a class="header-anchor" href="#fs-cpsync-src-dest-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fscpsyncsrc-dest-options" target="_blank" rel="noopener noreferrer">fs.cpSync(src, dest[, options])</a></span></a></h3><p>Node.js çš„ <code>fs.cpSync(src, dest[, options])</code> å‡½æ•°æ˜¯æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—ä¸­çš„ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œç”¨äºå°†ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•å¤åˆ¶åˆ°å¦ä¸€ä¸ªä½ç½®ã€‚è¿™ä¸ªå‡½æ•°åœ¨è‡ªåŠ¨åŒ–ä»»åŠ¡ã€æ•°æ®å¤‡ä»½ã€æˆ–è€…åœ¨å¼€å‘ä¸­éœ€è¦ç§»åŠ¨æ–‡ä»¶å’Œç›®å½•æ—¶éå¸¸æœ‰ç”¨ã€‚ä¸‹é¢æˆ‘ä¼šè§£é‡Šè¿™ä¸ªå‡½æ•°çš„å·¥ä½œåŸç†ï¼Œå¹¶é€šè¿‡å‡ ä¸ªå®ä¾‹æ¥å±•ç¤ºå®ƒçš„åº”ç”¨ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-14" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-14"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><ul><li><strong>åŒæ­¥æ“ä½œ</strong>ï¼šåœ¨æ‰§è¡ŒåŒæ­¥æ“ä½œæ—¶ï¼Œç¨‹åºä¼šç­‰å¾…è¿™ä¸ªæ“ä½œå®Œæˆåæ‰ç»§ç»­æ‰§è¡Œåç»­ä»£ç ã€‚è¿™ä¸å¼‚æ­¥æ“ä½œç›¸å¯¹ï¼Œå¼‚æ­¥æ“ä½œå…è®¸ä»£ç åœ¨ç­‰å¾…æ“ä½œå®Œæˆçš„åŒæ—¶ç»§ç»­æ‰§è¡Œã€‚</li><li><strong><code>src</code></strong>ï¼šæºè·¯å¾„ï¼Œå³ä½ æƒ³è¦å¤åˆ¶çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><strong><code>dest</code></strong>ï¼šç›®æ ‡è·¯å¾„ï¼Œå³å¤åˆ¶æ“ä½œå®Œæˆåæ–‡ä»¶æˆ–ç›®å½•çš„æ–°ä½ç½®ã€‚</li><li><strong><code>options</code></strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå®ƒå…è®¸ä½ å®šåˆ¶ä¸€äº›å¤åˆ¶æ“ä½œçš„è¡Œä¸ºï¼Œæ¯”å¦‚è¦†ç›–ç›®æ ‡ä½ç½®çš„æ–‡ä»¶ã€é€’å½’å¤åˆ¶ç›®å½•ç­‰ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-16" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-16"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="_1-å¤åˆ¶æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_1-å¤åˆ¶æ–‡ä»¶"><span>1. å¤åˆ¶æ–‡ä»¶</span></a></h4><p>å‡è®¾æˆ‘ä»¬æƒ³è¦å°†é¡¹ç›®ä¸­çš„é…ç½®æ–‡ä»¶ <code>config.json</code> å¤åˆ¶åˆ°ä¸€ä¸ªå¤‡ä»½ç›®å½• <code>backup</code> ä¸­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æºæ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> src</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // ç›®æ ‡æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> dest</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./backup/config_backup.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">cpSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">src</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dest</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å¤åˆ¶æˆåŠŸã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å¤åˆ¶æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šæŠŠå½“å‰ç›®å½•ä¸‹çš„ <code>config.json</code> æ–‡ä»¶å¤åˆ¶åˆ° <code>backup</code> ç›®å½•ä¸‹ï¼Œå¹¶ä¸”å‘½åä¸º <code>config_backup.json</code>ã€‚</p><h4 id="_2-å¤åˆ¶ç›®å½•" tabindex="-1"><a class="header-anchor" href="#_2-å¤åˆ¶ç›®å½•"><span>2. å¤åˆ¶ç›®å½•</span></a></h4><p>å¦‚æœæˆ‘ä»¬æƒ³è¦å¤åˆ¶æ•´ä¸ªç›®å½•åŠå…¶å†…å®¹ï¼ˆä¾‹å¦‚å°† <code>data</code> ç›®å½•å¤åˆ¶åˆ° <code>data_backup</code> ä¸­ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ <code>recursive</code> é€‰é¡¹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æºç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> src</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./data</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // ç›®æ ‡ç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> dest</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./data_backup</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">cpSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">src</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dest</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> recursive</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•å¤åˆ¶æˆåŠŸã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å¤åˆ¶ç›®å½•æ—¶å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>{ recursive: true }</code> é€‰é¡¹å‘Šè¯‰ <code>fs.cpSync</code> æ–¹æ³•é€’å½’åœ°å¤åˆ¶æ•´ä¸ªç›®å½•ç»“æ„ï¼ŒåŒ…æ‹¬æ‰€æœ‰å­ç›®å½•å’Œæ–‡ä»¶ã€‚</p><h4 id="_3-è¦†ç›–ç°æœ‰æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_3-è¦†ç›–ç°æœ‰æ–‡ä»¶"><span>3. è¦†ç›–ç°æœ‰æ–‡ä»¶</span></a></h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœç›®æ ‡è·¯å¾„å·²ç»å­˜åœ¨ä¸€ä¸ªåŒåæ–‡ä»¶ï¼Œ<code>fs.cpSync</code> ä¼šæŠ›å‡ºé”™è¯¯ã€‚ä½ å¯ä»¥é€šè¿‡è®¾ç½® <code>force</code> é€‰é¡¹ä¸º <code>true</code> æ¥è¦†ç›–è¿™ä¸ªæ–‡ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> src</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./log.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> dest</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./backup/log.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // è¦†ç›–ç›®æ ‡è·¯å¾„çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">cpSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">src</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dest</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> force</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å¤åˆ¶å¹¶è¦†ç›–æˆåŠŸã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å¤åˆ¶æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä»¥ä¸Šç¤ºä¾‹ï¼Œä½ åº”è¯¥å¯¹ <code>fs.cpSync</code> æ–¹æ³•å¦‚ä½•åœ¨ Node.js ä¸­è¢«ç”¨æ¥å¤åˆ¶æ–‡ä»¶å’Œç›®å½•æœ‰äº†åŸºæœ¬çš„ç†è§£ã€‚è¿™ä¸ªåŠŸèƒ½åœ¨å¤„ç†æ–‡ä»¶ç®¡ç†ä»»åŠ¡æ—¶éå¸¸å®ç”¨ï¼Œæ— è®ºæ˜¯åœ¨ç®€å•çš„è„šæœ¬è¿˜æ˜¯å¤§å‹åº”ç”¨ä¸­ã€‚</p><h3 id="fs-existssync-path" tabindex="-1"><a class="header-anchor" href="#fs-existssync-path"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsexistssyncpath" target="_blank" rel="noopener noreferrer">fs.existsSync(path)</a></span></a></h3><p><code>fs.existsSync(path)</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªåŒæ­¥æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼Œç”¨äºæ£€æŸ¥ç»™å®šçš„è·¯å¾„ï¼ˆæ–‡ä»¶æˆ–è€…ç›®å½•ï¼‰æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœè·¯å¾„å­˜åœ¨ï¼Œå®ƒä¼šè¿”å› <code>true</code>ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿”å› <code>false</code>ã€‚è¿™ä¸ªæ–¹æ³•å±äº <code>fs</code> æ¨¡å—ï¼Œå³æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼Œè¯¥æ¨¡å—æä¾›äº†å¾ˆå¤šæ“ä½œæ–‡ä»¶å’Œç›®å½•çš„æ–¹æ³•ã€‚</p><p>ä½¿ç”¨ <code>fs.existsSync(path)</code> çš„æ—¶å€™ï¼Œä½ éœ€è¦å…ˆå¯¼å…¥ <code>fs</code> æ¨¡å—ï¼Œå¹¶ä¸”å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªåŒæ­¥çš„æ“ä½œï¼Œæ‰€ä»¥å½“è°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶ï¼ŒNode.js ä¼šé˜»å¡å…¶ä»–ä»£ç çš„æ‰§è¡Œï¼Œç›´åˆ°è¿™ä¸ªæ£€æŸ¥å®Œæˆã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨ <code>fs.existsSync(path)</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// é¦–å…ˆï¼Œéœ€è¦å¼•å…¥fsæ¨¡å—</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æˆ‘ä»¬æƒ³è¦æ£€æŸ¥çš„æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/your/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fs.existsSync() æ¥æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></span>
<span class="line"><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">existsSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#D8DEE9FF;">)) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">  // å¦‚æœæ–‡ä»¶å­˜åœ¨</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å­˜åœ¨ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶ä¸å­˜åœ¨ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><ol><li>åœ¨è¯»å–æ–‡ä»¶ä¹‹å‰æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œä»¥é¿å…å‡ºç°é”™è¯¯ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">existsSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#D8DEE9FF;">)) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å¯¹ä¸èµ·ï¼Œæ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ— æ³•è¯»å–ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>åœ¨å†™å…¥æ–‡ä»¶ä¹‹å‰ç¡®è®¤ç›®æ ‡ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨å¯èƒ½éœ€è¦åˆ›å»ºå®ƒï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dirPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/your/directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">!</span><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">existsSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirPath</span><span style="color:#D8DEE9FF;">)) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">mkdirSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç°åœ¨å¯ä»¥å®‰å…¨åœ°å†™å…¥æ–‡ä»¶äº†</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">dirPath</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">/file.txt</span><span style="color:#ECEFF4;">`</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, World!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>åœ¨åˆ é™¤æ–‡ä»¶ä¹‹å‰æ£€æŸ¥å…¶æ˜¯å¦å­˜åœ¨ï¼Œä»¥é˜²æ­¢è§¦å‘ä¸å¿…è¦çš„å¼‚å¸¸ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">existsSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#D8DEE9FF;">)) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unlinkSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²ç»è¢«æˆåŠŸåˆ é™¤</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ é™¤ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼Œè™½ç„¶ <code>fs.existsSync()</code> æ˜¯ä¸€ä¸ªæ–¹ä¾¿çš„æ–¹æ³•ï¼Œä½†å®ƒå¹¶ä¸å»ºè®®åœ¨ç”Ÿäº§ä»£ç ä¸­ä½¿ç”¨ï¼Œå› ä¸ºå®ƒä¼šé€ æˆé˜»å¡æ€§èƒ½é—®é¢˜ã€‚æ›´å¥½çš„å®è·µæ˜¯ä½¿ç”¨å¼‚æ­¥çš„æ–¹å¼æ¥å¤„ç†æ–‡ä»¶å­˜åœ¨æ€§æ£€æŸ¥ã€‚</p><h3 id="fs-fchmodsync-fd-mode" tabindex="-1"><a class="header-anchor" href="#fs-fchmodsync-fd-mode"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsfchmodsyncfd-mode" target="_blank" rel="noopener noreferrer">fs.fchmodSync(fd, mode)</a></span></a></h3><p><code>fs.fchmodSync(fd, mode)</code> æ˜¯ä¸€ä¸ª Node.js æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼ˆ<code>fs</code>æ¨¡å—ï¼‰ä¸­çš„å‡½æ•°ï¼Œç”¨äºåŒæ­¥åœ°æ”¹å˜ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶çš„æƒé™ã€‚è¿™ä¸ªå‡½æ•°ä¸ä¼šè¿”å›ä»»ä½•å†…å®¹ï¼Œä½†å¦‚æœåœ¨å°è¯•æ›´æ”¹æ–‡ä»¶æƒé™æ—¶å‘ç”Ÿé”™è¯¯ï¼Œå®ƒä¼šæŠ›å‡ºé”™è¯¯ã€‚</p><p>åœ¨äº†è§£ <code>fs.fchmodSync(fd, mode)</code> ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£å‡ ä¸ªå…³é”®ç‚¹ï¼š</p><ol><li><p><strong>æ–‡ä»¶æè¿°ç¬¦ï¼ˆfdï¼‰</strong>ï¼šå½“ä½ åœ¨ Node.js ä¸­æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œç³»ç»Ÿä¼šç»™ä½ ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œè¿™å…¶å®æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œç”¨æ¥ä»£è¡¨é‚£ä¸ªæ‰“å¼€çš„æ–‡ä»¶ã€‚ä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦æ¥å¼•ç”¨å’Œæ“ä½œè¿™ä¸ªæ–‡ä»¶ã€‚</p></li><li><p><strong>æƒé™ï¼ˆmodeï¼‰</strong>ï¼šåœ¨ Unix å’Œç±» Unix ç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶æƒé™æ˜¯é€šè¿‡ä¸€ç»„ç‰¹å®šçš„è§„åˆ™æ¥æ§åˆ¶è°å¯ä»¥è¯»å–ã€å†™å…¥æˆ–æ‰§è¡Œè¯¥æ–‡ä»¶ã€‚æƒé™é€šå¸¸ä»¥å…«è¿›åˆ¶æ•°ï¼ˆåŸºæ•°ä¸º 8 çš„æ•°å­—ç³»ç»Ÿï¼‰è¡¨ç¤ºï¼Œä¾‹å¦‚ <code>0644</code>ã€‚</p></li></ol><p>ç°åœ¨è®©æˆ‘ä»¬æ¥æ·±å…¥äº†è§£ <code>fs.fchmodSync(fd, mode)</code> çš„ä½¿ç”¨æ–¹æ³•å’Œå‚æ•°ã€‚</p><h3 id="å‚æ•°-7" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-7"><span>å‚æ•°</span></a></h3><ul><li><strong>fd</strong>ï¼šæ–‡ä»¶æè¿°ç¬¦ï¼Œæ˜¯è¦æ›´æ”¹æƒé™çš„æ–‡ä»¶çš„å¼•ç”¨ã€‚</li><li><strong>mode</strong>ï¼šæƒé™æ¨¡å¼ï¼Œæ˜¯ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šæ–‡ä»¶åº”è¯¥æœ‰çš„æƒé™ã€‚</li></ul><h3 id="æƒé™æ¨¡å¼-mode" tabindex="-1"><a class="header-anchor" href="#æƒé™æ¨¡å¼-mode"><span>æƒé™æ¨¡å¼ï¼ˆmodeï¼‰</span></a></h3><p>æƒé™æ¨¡å¼ç”±ä¸‰ç»„æ•°å­—ç»„æˆï¼Œåˆ†åˆ«ä»£è¡¨æ–‡ä»¶æ‰€æœ‰è€…ã€åŒç”¨æˆ·ç»„çš„å…¶ä»–ç”¨æˆ·å’Œå…¶ä»–æ‰€æœ‰ç”¨æˆ·çš„æƒé™ã€‚</p><ul><li>ç¬¬ä¸€ä½ï¼ˆæ‰€æœ‰è€…æƒé™ï¼‰ï¼š4 ä»£è¡¨å¯è¯»ï¼ˆrï¼‰ï¼Œ2 ä»£è¡¨å¯å†™ï¼ˆwï¼‰ï¼Œ1 ä»£è¡¨å¯æ‰§è¡Œï¼ˆxï¼‰ã€‚</li><li>ç¬¬äºŒä½ï¼ˆç»„æƒé™ï¼‰ï¼šåŒä¸Šï¼ŒæŒ‰ä½è¡¨ç¤ºæƒé™ã€‚</li><li>ç¬¬ä¸‰ä½ï¼ˆå…¶ä»–ç”¨æˆ·æƒé™ï¼‰ï¼šåŒä¸Šï¼ŒæŒ‰ä½è¡¨ç¤ºæƒé™ã€‚</li></ul><p>ä¾‹å¦‚ï¼Œ<code>0644</code> è¡¨ç¤ºï¼š</p><ul><li>æ‰€æœ‰è€…å¯ä»¥è¯»å–å’Œå†™å…¥æ–‡ä»¶ï¼ˆ6 = 4+2ï¼‰ã€‚</li><li>åŒç»„çš„ç”¨æˆ·å¯ä»¥è¯»å–æ–‡ä»¶ï¼ˆ4ï¼‰ã€‚</li><li>å…¶ä»–ç”¨æˆ·ä¹Ÿå¯ä»¥è¯»å–æ–‡ä»¶ï¼ˆ4ï¼‰ã€‚</li></ul><h3 id="å®ä¾‹ä»£ç " tabindex="-1"><a class="header-anchor" href="#å®ä¾‹ä»£ç "><span>å®ä¾‹ä»£ç </span></a></h3><p>å‡è®¾æˆ‘ä»¬å·²ç»æœ‰ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶ï¼Œå¹¶ä¸”æˆ‘ä»¬çŸ¥é“å®ƒçš„æ–‡ä»¶æè¿°ç¬¦æ˜¯ <code>fd</code>ã€‚æˆ‘ä»¬æƒ³å°†è¿™ä¸ªæ–‡ä»¶çš„æƒé™è®¾ç½®ä¸ºæ‰€æœ‰è€…å¯è¯»å†™ï¼Œç»„å’Œå…¶ä»–äººåªèƒ½è¯»å–ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // å‡å®šæˆ‘ä»¬å·²ç»é€šè¿‡æŸç§æ–¹å¼è·å¾—æ–‡ä»¶æè¿°ç¬¦ fd</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">fchmodSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0o644</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ³¨æ„modeæ˜¯å…«è¿›åˆ¶æ•°ï¼Œæ‰€ä»¥å‰é¢æœ‰ä¸ª&quot;0o&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ›´æ”¹æ–‡ä»¶æƒé™æ—¶å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨äº† <code>fs.fchmodSync</code> æ–¹æ³•ï¼Œä¼ å…¥äº†æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> å’Œæˆ‘ä»¬å¸Œæœ›è®¾ç½®çš„æƒé™æ¨¡å¼ <code>0o644</code>ï¼ˆ<code>0o</code> è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå…«è¿›åˆ¶æ•°ï¼‰ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œæ–‡ä»¶çš„æƒé™å°±è¢«æ›´æ”¹äº†ï¼›å¦‚æœæ“ä½œå¤±è´¥ï¼ˆæ¯”å¦‚æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæˆ–è€…æˆ‘ä»¬æ²¡æœ‰è¶³å¤Ÿçš„æƒé™å»æ›´æ”¹è¿™ä¸ªæ–‡ä»¶çš„æƒé™ï¼‰ï¼Œç¨‹åºå°±ä¼šæ•è·åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œå¹¶æ‰“å°å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯-2" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯-2"><span>ä½¿ç”¨åœºæ™¯</span></a></h3><p>è¿™é¡¹åŠŸèƒ½é€šå¸¸ç”¨äºéœ€è¦æ”¹å˜æ–‡ä»¶æƒé™çš„åœºæ™¯ï¼Œä¾‹å¦‚ï¼š</p><ul><li>å½“ä½ åˆ›å»ºäº†ä¸€ä¸ªæ–°æ–‡ä»¶å¹¶éœ€è¦ç¡®ä¿å®ƒæœ‰æ­£ç¡®çš„å®‰å…¨æƒé™ã€‚</li><li>åœ¨ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨æ—¶ï¼Œå¯èƒ½éœ€è¦ä¿®æ”¹æ–‡ä»¶æƒé™ä»¥ç¡®ä¿å…¶ä»–æœåŠ¡å¯ä»¥æ­£ç¡®åœ°è¯»å–æˆ–æ‰§è¡Œè¿™äº›æ–‡ä»¶ã€‚</li><li>è‡ªåŠ¨åŒ–è„šæœ¬è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ ¹æ®éœ€æ±‚åŠ¨æ€è°ƒæ•´æ–‡ä»¶æƒé™ã€‚</li></ul><p>ä½¿ç”¨ <code>fs.fchmodSync()</code> å‡½æ•°æ—¶éœ€è¦æ ¼å¤–å°å¿ƒï¼Œå› ä¸ºå¦‚æœä½ é”™è¯¯åœ°è®¾ç½®äº†æ–‡ä»¶æƒé™ï¼Œå¯èƒ½ä¼šé€ æˆå®‰å…¨é—®é¢˜ï¼Œå¦‚æš´éœ²æ•æ„Ÿæ•°æ®æˆ–è€…ä½¿å¾—ä¸åº”è¯¥æ‰§è¡Œçš„æ–‡ä»¶å˜å¾—å¯æ‰§è¡Œã€‚</p><h3 id="fs-fchownsync-fd-uid-gid" tabindex="-1"><a class="header-anchor" href="#fs-fchownsync-fd-uid-gid"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsfchownsyncfd-uid-gid" target="_blank" rel="noopener noreferrer">fs.fchownSync(fd, uid, gid)</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘ä¼šå°½é‡è¯¦ç»†åœ°è§£é‡Šç»™ä½ å¬ã€‚</p><p><code>fs.fchownSync(fd, uid, gid)</code> æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼ˆ<code>fs</code> æ¨¡å—ï¼‰ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨äºåŒæ­¥åœ°æ”¹å˜ä¸€ä¸ªé€šè¿‡æ–‡ä»¶æè¿°ç¬¦ï¼ˆ<code>fd</code>ï¼‰æŒ‡å‘çš„æ–‡ä»¶çš„æ‰€æœ‰è€…ã€‚åœ¨ Unix-like ç³»ç»Ÿä¸­ï¼ˆä¾‹å¦‚ Linux æˆ– macOSï¼‰ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½æœ‰ä¸ä¹‹å…³è”çš„ç”¨æˆ·æ ‡è¯†ç¬¦ï¼ˆ<code>uid</code>ï¼‰å’Œç»„æ ‡è¯†ç¬¦ï¼ˆ<code>gid</code>ï¼‰ï¼Œåˆ†åˆ«ä»£è¡¨æ–‡ä»¶çš„æ‹¥æœ‰è€…å’Œæ‹¥æœ‰è€…æ‰€å±çš„ç»„ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ ä¿®æ”¹è¿™äº›å±æ€§ã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>fd</code>ï¼šæ–‡ä»¶æè¿°ç¬¦ï¼Œæ˜¯ä¸€ä¸ªæ•´æ•°å€¼ï¼Œç”¨æ¥å”¯ä¸€æ ‡è¯†æ‰“å¼€çš„æ–‡ä»¶ã€‚</li><li><code>uid</code>ï¼šUser IDï¼Œç”¨æˆ· IDï¼Œæ˜¯ä¸€ä¸ªæ•´æ•°å€¼ï¼Œè¡¨ç¤ºæ–°çš„æ–‡ä»¶æ‹¥æœ‰è€…çš„ç”¨æˆ·æ ‡è¯†ç¬¦ã€‚</li><li><code>gid</code>ï¼šGroup IDï¼Œç»„ IDï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ•´æ•°å€¼ï¼Œè¡¨ç¤ºæ–°çš„æ–‡ä»¶æ‹¥æœ‰è€…æ‰€åœ¨ç»„çš„ç»„æ ‡è¯†ç¬¦ã€‚</li></ul><p>ä½¿ç”¨ <code>fs.fchownSync</code> æ–¹æ³•éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå› ä¸ºå®ƒä¼šæ”¹å˜æ–‡ä»¶çš„æ‰€æœ‰æƒï¼Œé€šå¸¸éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½æ‰§è¡Œã€‚å¹¶ä¸”ï¼Œå¦‚æœä½ åœ¨ä¸æ”¯æŒæ–‡ä»¶æ‰€æœ‰æƒæ¦‚å¿µçš„æ–‡ä»¶ç³»ç»Ÿæˆ–æ“ä½œç³»ç»Ÿï¼ˆæ¯”å¦‚ Windowsï¼‰ä¸Šè¿è¡Œï¼Œè¿™ä¸ªæ–¹æ³•å¯èƒ½ä¸ä¼šæœ‰æ•ˆæˆ–è€…ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥çœ‹å‡ ä¸ªå®é™…çš„ä¾‹å­ã€‚</p><h3 id="ç¤ºä¾‹-1-æ”¹å˜æ–‡ä»¶æ‰€æœ‰è€…" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æ”¹å˜æ–‡ä»¶æ‰€æœ‰è€…"><span>ç¤ºä¾‹ 1ï¼šæ”¹å˜æ–‡ä»¶æ‰€æœ‰è€…</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªå«åš <code>example.txt</code> çš„æ–‡ä»¶ï¼Œå¹¶ä¸”ä½ æƒ³è¦å°†è¿™ä¸ªæ–‡ä»¶çš„æ‰€æœ‰è€…æ”¹å˜æˆç³»ç»Ÿä¸­çš„å¦ä¸€ä¸ªç”¨æˆ·ï¼Œå…¶ <code>uid</code> æ˜¯ <code>1001</code>ï¼Œ<code>gid</code> æ˜¯ <code>1002</code>ã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦è·å–è¿™ä¸ªæ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œç„¶åä½¿ç”¨ <code>fs.fchownSync</code> ä¿®æ”¹å®ƒçš„æ‰€æœ‰è€…ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æ‰“å¼€æ–‡ä»¶è·å–æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€…</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">fchownSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1001</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1002</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶æ‰€æœ‰æƒå·²ç»æ”¹å˜</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å…³é—­æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‡ºé”™äº†:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç”¨åˆ°äº† <code>openSync</code> æ–¹æ³•æ¥æ‰“å¼€æ–‡ä»¶å¹¶è·å–æ–‡ä»¶æè¿°ç¬¦ï¼Œç”¨ <code>closeSync</code> æ–¹æ³•æ¥å…³é—­æ–‡ä»¶æè¿°ç¬¦ã€‚<code>fchownSync</code> è¢«ç”¨äºæ”¹å˜æ‰€æœ‰æƒã€‚å¦‚æœè¿‡ç¨‹ä¸­å‘ç”Ÿä»»ä½•é”™è¯¯ï¼Œé”™è¯¯ä¼šè¢«æ•è·å¹¶è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚</p><h3 id="ç¤ºä¾‹-2-æ•è·æƒé™é”™è¯¯" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æ•è·æƒé™é”™è¯¯"><span>ç¤ºä¾‹ 2ï¼šæ•è·æƒé™é”™è¯¯</span></a></h3><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½æ²¡æœ‰è¶³å¤Ÿçš„æƒé™å»æ”¹å˜ä¸€ä¸ªæ–‡ä»¶çš„æ‰€æœ‰è€…ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>fs.fchownSync</code> ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚æˆ‘ä»¬å¯ä»¥æ•è·è¿™ä¸ªé”™è¯¯å¹¶åšé€‚å½“å¤„ç†ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // å‡è®¾ä½ å·²ç»æœ‰äº†æ–‡ä»¶æè¿°ç¬¦ fd</span></span>
<span class="line"><span style="color:#616E88;">  // å°è¯•å°†æ–‡ä»¶æ‰€æœ‰è€…ä¿®æ”¹ä¸º uid: 1001 å’Œ gid: 1002</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">fchownSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1001</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1002</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">code</span><span style="color:#81A1C1;"> ===</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">EPERM</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">é”™è¯¯ï¼šæ²¡æœ‰è¶³å¤Ÿçš„æƒé™æ¥ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰æƒ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‘ç”ŸæœªçŸ¥é”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç”¨ <code>try...catch</code> ç»“æ„æ¥æ•è·å¯èƒ½å‘ç”Ÿçš„é”™è¯¯ã€‚å¦‚æœé”™è¯¯ç æ˜¯ <code>&#39;EPERM&#39;</code>ï¼Œå°±è¯´æ˜æˆ‘ä»¬æ²¡æœ‰æƒé™è¿›è¡Œæ“ä½œã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>fs.fchownSync</code> æ˜¯ä¸€ä¸ªç”¨äºæ”¹å˜æ–‡ä»¶æ‰€æœ‰æƒçš„ Node.js æ–¹æ³•ã€‚å®ƒç›´æ¥ä½œç”¨äºæ–‡ä»¶æè¿°ç¬¦ï¼Œè€Œä¸”æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¼šé˜»å¡å…¶ä»–ä»£ç çš„æ‰§è¡Œç›´åˆ°æ“ä½œå®Œæˆã€‚è®°ä½å¤„ç†å¥½æƒé™é—®é¢˜å’Œé”™è¯¯æ•è·éå¸¸é‡è¦ï¼Œä»¥ç¡®ä¿ç¨‹åºçš„ç¨³å®šæ€§ã€‚</p><h3 id="fs-fdatasyncsync-fd" tabindex="-1"><a class="header-anchor" href="#fs-fdatasyncsync-fd"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsfdatasyncsyncfd" target="_blank" rel="noopener noreferrer">fs.fdatasyncSync(fd)</a></span></a></h3><p>Node.js ä¸­çš„<code>fs.fdatasyncSync(fd)</code>æ˜¯ä¸€ä¸ªä¸æ–‡ä»¶ç³»ç»Ÿç›¸å…³çš„åŒæ­¥æ“ä½œï¼Œå®ƒä¸»è¦ç”¨äºé«˜çº§ I/O æ“ä½œã€‚åœ¨æ·±å…¥äº†è§£è¿™ä¸ªå‡½æ•°ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆç†è§£ä¸€äº›åŸºç¡€æ¦‚å¿µã€‚</p><h3 id="åŸºç¡€æ¦‚å¿µ-2" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æ¦‚å¿µ-2"><span>åŸºç¡€æ¦‚å¿µ</span></a></h3><ol><li><strong>Node.js</strong>: ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚</li><li><strong>fs æ¨¡å—</strong>: fs ä»£è¡¨æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ APIï¼Œæ¯”å¦‚è¯»å†™æ–‡ä»¶ã€åˆ›å»ºç›®å½•ç­‰ã€‚</li><li><strong>åŒæ­¥ä¸å¼‚æ­¥</strong>: åœ¨ Node.js ä¸­ï¼Œå¤§å¤šæ•°æ–‡ä»¶ç³»ç»Ÿçš„æ“ä½œéƒ½æœ‰åŒæ­¥å’Œå¼‚æ­¥ä¸¤ç§å½¢å¼ã€‚åŒæ­¥æ“ä½œä¼šé˜»å¡ç¨‹åºçš„æ‰§è¡Œï¼Œç›´åˆ°æ“ä½œå®Œæˆï¼›è€Œå¼‚æ­¥æ“ä½œä¸ä¼šé˜»å¡ï¼Œé€šå¸¸éœ€è¦é€šè¿‡å›è°ƒå‡½æ•°ã€Promise æˆ– async/await æ¥å¤„ç†ç»“æœã€‚</li></ol><h3 id="fs-fdatasyncsync-fd-1" tabindex="-1"><a class="header-anchor" href="#fs-fdatasyncsync-fd-1"><span><code>fs.fdatasyncSync(fd)</code></span></a></h3><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬èšç„¦äº<code>fs.fdatasyncSync(fd)</code>ã€‚è¿™ä¸ªå‡½æ•°æ˜¯<code>fs</code>æ¨¡å—æä¾›çš„åŒæ­¥æ–¹æ³•ä¹‹ä¸€ï¼Œå…¶ä½œç”¨æ˜¯å°†ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆfdï¼‰å…³è”çš„æ‰€æœ‰å†™å…¥æ“ä½œå¼ºåˆ¶ä»å†…æ ¸ç¼“å†²åŒºåŒæ­¥åˆ°ç¡¬ç›˜ï¼Œä½†ä¸åŒ…æ‹¬æ›´æ–°æ–‡ä»¶çš„å…ƒæ•°æ®ï¼ˆæ¯”å¦‚æœ€åçš„è®¿é—®æ—¶é—´å’Œä¿®æ”¹æ—¶é—´ï¼‰ã€‚è¿™é€šå¸¸ç”¨äºç¡®ä¿é‡è¦æ•°æ®å³ä½¿åœ¨å‘ç”Ÿç³»ç»Ÿå´©æºƒæˆ–ç”µæºæ•…éšœæ—¶ä¹Ÿèƒ½è¢«å®‰å…¨åœ°ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šã€‚</p><ul><li><p><strong>å‚æ•°</strong>:</p><ul><li><code>fd</code>: æ–‡ä»¶æè¿°ç¬¦ï¼Œæ˜¯ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å‘å·²ç»æ‰“å¼€çš„æ–‡ä»¶çš„å¼•ç”¨ã€‚</li></ul></li><li><p><strong>è¿”å›å€¼</strong>: æ— ã€‚ç”±äºæ˜¯åŒæ­¥æ“ä½œï¼Œå¦‚æœå‡ºç°é”™è¯¯ä¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚</p></li></ul><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-9" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-9"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç®€å•çš„æ—¥å¿—è®°å½•ç³»ç»Ÿï¼Œéœ€è¦ç¡®ä¿æ¯æ¡æ—¥å¿—ä¿¡æ¯éƒ½è¢«å†™å…¥åˆ°ç¡¬ç›˜ä¸­ï¼Œä»¥ä¾¿åœ¨ç³»ç»Ÿå´©æºƒæ—¶å¯ä»¥æ¢å¤æ—¥å¿—ä¿¡æ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æ‰“å¼€æ–‡ä»¶å‡†å¤‡å†™å…¥ï¼Œ&#39;a&#39;æ¨¡å¼è¡¨ç¤ºè¿½åŠ å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">log.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å†™å…¥ä¸€äº›æ—¥å¿—ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">æ–°æ—¥å¿—é¡¹: ç³»ç»Ÿå¯åŠ¨</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨fs.fdatasyncSyncç¡®ä¿æ•°æ®è¢«åŒæ­¥åˆ°ç¡¬ç›˜</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">fdatasyncSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼š</p><ol><li>é¦–å…ˆä½¿ç”¨<code>fs.openSync()</code>æ–¹æ³•æ‰“å¼€ï¼ˆæˆ–åˆ›å»ºï¼‰ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶<code>log.txt</code>ï¼Œå¹¶å¾—åˆ°æ–‡ä»¶æè¿°ç¬¦<code>fd</code>ã€‚</li><li>æ¥ç€ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>fs.writeSync()</code>å°†æ–°çš„æ—¥å¿—ä¿¡æ¯å†™å…¥åˆ°æ–‡ä»¶ä¸­ã€‚</li><li>ç„¶åï¼Œé€šè¿‡<code>fs.fdatasyncSync(fd)</code>å¼ºåˆ¶å°†è¿™äº›å˜æ›´åŒæ­¥åˆ°ç¡¬ç›˜ï¼Œç¡®ä¿æ•°æ®çš„å®‰å…¨ã€‚</li><li>æœ€åï¼Œä½¿ç”¨<code>fs.closeSync(fd)</code>å…³é—­æ–‡ä»¶ã€‚</li></ol><p>è¿™æ ·ï¼Œå³ä½¿åœ¨å†™å…¥æ—¥å¿—åç³»ç»Ÿçªç„¶å´©æºƒæˆ–é‡å¯ï¼Œè¿™éƒ¨åˆ†æ—¥å¿—ä¿¡æ¯ä¹Ÿèƒ½å¾—åˆ°ä¿ç•™ï¼Œå› ä¸ºå®ƒå·²ç»è¢«åŒæ­¥åˆ°ç¡¬ç›˜äº†ã€‚</p><h3 id="å°ç»“-9" tabindex="-1"><a class="header-anchor" href="#å°ç»“-9"><span>å°ç»“</span></a></h3><p><code>fs.fdatasyncSync(fd)</code>æ˜¯ Node.js ä¸­ä¸€ä¸ªé‡è¦çš„åŒæ­¥æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼Œç‰¹åˆ«é€‚åˆäºé‚£äº›éœ€è¦ç¡®ä¿æ•°æ®å¯é æ€§å’Œå®Œæ•´æ€§çš„åœºæ™¯ï¼Œæ¯”å¦‚æ—¥å¿—è®°å½•ã€æ•°æ®åº“äº‹åŠ¡çš„æŒä¹…åŒ–ç­‰ã€‚é€šè¿‡ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œå¯ä»¥æœ‰æ•ˆåœ°å‡å°‘æ•°æ®ä¸¢å¤±çš„é£é™©ã€‚</p><h3 id="fs-fstatsync-fd-options" tabindex="-1"><a class="header-anchor" href="#fs-fstatsync-fd-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsfstatsyncfd-options" target="_blank" rel="noopener noreferrer">fs.fstatSync(fd[, options])</a></span></a></h3><p>Node.js ä¸­çš„ <code>fs</code> æ¨¡å—è´Ÿè´£æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼Œå¦‚è¯»å†™æ–‡ä»¶ã€è·å–æ–‡ä»¶ä¿¡æ¯ç­‰ã€‚<code>fs.fstatSync(fd[, options])</code> æ˜¯è¯¥æ¨¡å—ä¸­ç”¨äºåŒæ­¥è·å–æ–‡ä»¶çŠ¶æ€ä¿¡æ¯çš„å‡½æ•°ã€‚</p><p>å…ˆæ¥è§£é‡Šä¸€ä¸‹è¿™ä¸ªå‡½æ•°çš„ç»„æˆéƒ¨åˆ†ï¼š</p><ul><li><code>fs</code>ï¼šæ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿæ¨¡å—çš„ç¼©å†™ã€‚</li><li><code>fstatSync</code>ï¼šè¿™ä¸ªå‡½æ•°çš„åå­—ç”± &quot;fstat&quot; å’Œ &quot;Sync&quot; ç»„æˆã€‚&quot;fstat&quot; æ˜¯æŒ‡ä»ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆfile descriptorï¼‰è·å–æ–‡ä»¶çŠ¶æ€ï¼Œè€Œ &quot;Sync&quot; è¡¨ç¤ºè¿™ä¸ªæ“ä½œæ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œå³å‡½æ•°ä¼šé˜»å¡ç¨‹åºçš„æ‰§è¡Œç›´åˆ°å®ƒå®Œæˆæ“ä½œã€‚</li><li><code>fd</code>ï¼šæ˜¯æ–‡ä»¶æè¿°ç¬¦çš„ç¼©å†™ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œä»£è¡¨ç€å·²ç»æ‰“å¼€æ–‡ä»¶çš„å¼•ç”¨æ ‡è¯†ã€‚åœ¨ Unix-like ç³»ç»Ÿä¸­ï¼Œå½“ä½ æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œç³»ç»Ÿä¼šæä¾›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦æ¥ä»£è¡¨é‚£ä¸ªæ–‡ä»¶ã€‚</li><li><code>options</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå¯ä»¥ç”¨æ¥æ”¹å˜è¿”å›çš„æ–‡ä»¶çŠ¶æ€ä¿¡æ¯çš„æ ¼å¼ã€‚</li></ul><p>ç°åœ¨æˆ‘ä»¬å†è¯¦ç»†äº†è§£ä¸€ä¸‹ <code>fs.fstatSync(fd[, options])</code> å‡½æ•°ï¼š</p><p>è¿™ä¸ªå‡½æ•°ç”¨æ¥è·å–ä¸æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> ç›¸å…³è”çš„æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯ã€‚è¿™ä¸ªä¿¡æ¯åŒ…æ‹¬äº†å¾ˆå¤šæœ‰ç”¨çš„å±æ€§ï¼Œæ¯”å¦‚æ–‡ä»¶å¤§å°ã€åˆ›å»ºæ—¶é—´ã€ä¿®æ”¹æ—¶é—´ç­‰ã€‚</p><p><code>fs.fstatSync</code> è¿”å›ä¸€ä¸ª <code>fs.Stats</code> å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«å„ç§æ–‡ä»¶å±æ€§ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä¾‹å­ï¼š</p><ul><li><code>stats.isFile()</code>ï¼šå¦‚æœæ˜¯æ™®é€šæ–‡ä»¶åˆ™è¿”å› <code>true</code>ã€‚</li><li><code>stats.isDirectory()</code>ï¼šå¦‚æœæ˜¯ç›®å½•åˆ™è¿”å› <code>true</code>ã€‚</li><li><code>stats.size</code>ï¼šæ–‡ä»¶çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚</li></ul><p>ç”±äº <code>fstatSync</code> æ˜¯åŒæ­¥æ“ä½œï¼Œæ‰€ä»¥å®ƒä¼šç›´æ¥è¿”å›ç»“æœï¼Œä¸éœ€è¦ä½¿ç”¨å›è°ƒå‡½æ•°ã€‚</p><p>ä»¥ä¸‹æ˜¯ <code>fs.fstatSync(fd[, options])</code> å®é™…ä½¿ç”¨çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œè·å–å…¶æ–‡ä»¶æè¿°ç¬¦ (fd)</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // è·å–æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">fstatSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶å¤§å°: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">size</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">åˆ›å»ºæ—¶é—´: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">birthtime</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ˜¯å¦æ˜¯æ–‡ä»¶: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFile</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ˜¯å¦æ˜¯ç›®å½•: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isDirectory</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // å®Œæˆåï¼Œè¦å…³é—­æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡ <code>openSync</code> æ–¹æ³•æ‰“å¼€äº†ä¸€ä¸ªåä¸º &#39;example.txt&#39; çš„æ–‡ä»¶ï¼Œå¹¶è·å–å…¶æ–‡ä»¶æè¿°ç¬¦ <code>fd</code>ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>fstatSync</code> æ–¹æ³•æ¥è·å–è¿™ä¸ªæ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯å¹¶æ‰“å°å‡ºæ¥ã€‚æœ€åï¼Œåœ¨ <code>finally</code> å—ä¸­ï¼Œæˆ‘ä»¬ç¡®ä¿æ— è®ºå‘ç”Ÿä»€ä¹ˆæƒ…å†µéƒ½å…³é—­æ–‡ä»¶æè¿°ç¬¦ï¼Œä»¥é¿å…èµ„æºæ³„æ¼ã€‚</p><h3 id="fs-fsyncsync-fd" tabindex="-1"><a class="header-anchor" href="#fs-fsyncsync-fd"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsfsyncsyncfd" target="_blank" rel="noopener noreferrer">fs.fsyncSync(fd)</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘ä¼šç›´æ¥è¿›å…¥ä¸»é¢˜å¹¶è¯¦ç»†è§£é‡Š <code>fs.fsyncSync(fd)</code> è¿™ä¸ªå‡½æ•°ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æ˜¯ç”¨æ¥æ“ä½œæ–‡ä»¶ç³»ç»Ÿçš„ä¸€ä¸ªé‡è¦æ¨¡å—ã€‚å®ƒæä¾›äº†å¾ˆå¤šåŒæ­¥ï¼ˆé˜»å¡ï¼‰å’Œå¼‚æ­¥ï¼ˆéé˜»å¡ï¼‰çš„æ–¹æ³•æ¥è¯»å–ã€å†™å…¥å’Œå¤„ç†æ–‡ä»¶ã€‚</p><p><code>fs.fsyncSync(fd)</code> æ˜¯ <code>fs</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œç”¨äºå°†å†…å­˜ä¸­çš„æ–‡ä»¶æ•°æ®å’Œå…ƒä¿¡æ¯åˆ·æ–°åˆ°ç£ç›˜ã€‚è¿™é‡Œçš„ &quot;åŒæ­¥&quot; æ„å‘³ç€æ‰§è¡Œè¿™ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼ŒNode.js ä¼šåœä¸‹æ¥ç­‰å¾…è¿™ä¸ªæ“ä½œå®Œæˆåæ‰ä¼šæ‰§è¡Œåé¢çš„ä»£ç ï¼Œå³è¯¥æ–¹æ³•ä¼šé˜»å¡äº‹ä»¶å¾ªç¯ã€‚</p><h3 id="å‚æ•°-8" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-8"><span>å‚æ•°</span></a></h3><ul><li><code>fd</code>: è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œæ˜¯ä¸€ä¸ªæ•´æ•°å€¼ï¼Œä»£è¡¨äº†ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶ã€‚</li></ul><h3 id="ä½¿ç”¨åœºæ™¯-3" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯-3"><span>ä½¿ç”¨åœºæ™¯:</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œè¿™ä¸ªç¨‹åºéœ€è¦å‘æ–‡ä»¶ä¸­å†™å…¥æ•°æ®ã€‚å½“ä½ ä½¿ç”¨ <code>fs.writeFile</code> æˆ–è€… <code>fs.write</code> ç­‰æ–¹æ³•å†™å…¥æ–‡ä»¶æ—¶ï¼Œæ“ä½œç³»ç»Ÿé€šå¸¸ä¼šå‡ºäºæ€§èƒ½è€ƒè™‘è€Œä¸ä¼šç«‹å³æŠŠæ•°æ®å†™å…¥ç£ç›˜ã€‚ç›¸åï¼Œå®ƒä¼šå…ˆè¢«ä¿å­˜åˆ°ä¸€ä¸ªç¼“å†²åŒºé‡Œã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œè¿™æ ·åšå®Œå…¨æ²¡æœ‰é—®é¢˜ã€‚ä½†æ˜¯å¦‚æœä½ éœ€è¦ç¡®ä¿æ•°æ®å³ä½¿åœ¨å‘ç”Ÿæ–­ç”µæˆ–è€…ç³»ç»Ÿå´©æºƒçš„æƒ…å†µä¸‹ä¹Ÿä¸ä¼šä¸¢å¤±ï¼Œä½ å°±éœ€è¦ä½¿ç”¨ <code>fs.fsyncSync(fd)</code> æ¥ç¡®ä¿æ•°æ®çœŸæ­£å†™å…¥ç¡¬ç›˜ã€‚</p><h3 id="å®é™…ä¾‹å­-9" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-9"><span>å®é™…ä¾‹å­:</span></a></h3><ol><li><p>å®‰å…¨åœ°æ›´æ–°æ–‡ä»¶ï¼š<br> å‡è®¾ä½ æœ‰ä¸€ä¸ªä¿å­˜ç”¨æˆ·è®¾ç½®çš„é…ç½®æ–‡ä»¶ï¼Œå½“ç”¨æˆ·æ›´æ”¹äº†è®¾ç½®å¹¶å¸Œæœ›ä¿å­˜æ—¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶ç”¨äºè¯»å†™ï¼Œè¿”å›æ–‡ä»¶æè¿°ç¬¦fd</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ›´æ–°é…ç½®å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> configData</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> JSON</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stringify</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">{</span><span style="color:#88C0D0;"> setting1</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">value1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#88C0D0;"> setting2</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">value2</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å†™å…¥æ–°é…ç½®</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> configData</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fsyncSync ç¡®ä¿é…ç½®å·²ç»ä¿å­˜åˆ°ç£ç›˜</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">fsyncSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>é«˜å¯é æ€§æ—¥å¿—è®°å½•ï¼š<br> å¦‚æœä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªéœ€è¦è®°å½•å…³é”®æ“ä½œæ—¥å¿—çš„åº”ç”¨ï¼Œä½ å¯èƒ½éœ€è¦åœ¨æ¯æ¬¡å†™å…¥æ—¥å¿—åç¡®ä¿æ—¥å¿—å·²ç»è¢«æŒä¹…åŒ–ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ—¥å¿—æ–‡ä»¶å‡†å¤‡æ·»åŠ æ–°çš„æ—¥å¿—æ¡ç›®</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">app.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è®°å½•ä¸€æ¡æ–°æ—¥å¿—</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> logEntry</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">User logged in at </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">() </span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">appendFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> logEntry</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç¡®ä¿æ—¥å¿—æ¡ç›®å·²ç»å†™å…¥ç£ç›˜</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">fsyncSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>æ³¨æ„ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œé¢‘ç¹åœ°è°ƒç”¨ <code>fsyncSync</code> å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå› ä¸ºå®ƒæ˜¯é˜»å¡æ“ä½œï¼Œå¹¶ä¸”å¼ºåˆ¶ç£ç›˜å®Œæˆå†™å…¥ï¼Œå¯èƒ½ä¼šå¢åŠ ç£ç›˜ I/Oã€‚æ‰€ä»¥éœ€è¦æ ¹æ®å®é™…æƒ…å†µæƒè¡¡æ˜¯å¦éœ€è¦åœ¨æ¯æ¬¡å†™å…¥åéƒ½è°ƒç”¨ <code>fsyncSync</code>ã€‚</p><h3 id="fs-ftruncatesync-fd-len" tabindex="-1"><a class="header-anchor" href="#fs-ftruncatesync-fd-len"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsftruncatesyncfd-len" target="_blank" rel="noopener noreferrer">fs.ftruncateSync(fd[, len])</a></span></a></h3><p><code>fs.ftruncateSync(fd[, len])</code> æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿæ¨¡å— (<code>fs</code>) ä¸­çš„ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œç”¨æ¥æˆªæ–­æˆ–è€…è¯´æ˜¯ç¼©çŸ­ä¸€ä¸ªæ–‡ä»¶çš„é•¿åº¦ã€‚å¦‚æœæ–‡ä»¶åŸæ¥æ¯”æ–°æŒ‡å®šçš„é•¿åº¦é•¿ï¼Œé‚£ä¹ˆè¶…å‡ºçš„éƒ¨åˆ†å°†ä¼šè¢«ä¸¢å¼ƒï¼Œå³æ–‡ä»¶è¢«â€˜æˆªæ–­â€™äº†ï¼›å¦‚æœæ–‡ä»¶æ¯”æ–°æŒ‡å®šçš„é•¿åº¦çŸ­ï¼Œåˆ™é€šå¸¸ä¼šå¡«å……ç©ºå­—èŠ‚ï¼ˆå³ <code>\0</code> å­—ç¬¦ï¼‰è‡³æŒ‡å®šçš„é•¿åº¦ã€‚</p><p>è¿™é‡Œçš„ <code>fd</code> æ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼Œä¸€ä¸ªè¡¨ç¤ºæ‰“å¼€æ–‡ä»¶çš„æ•°å­—æ ‡è¯†ï¼Œè€Œå¯é€‰å‚æ•° <code>len</code> å°±æ˜¯ä½ å¸Œæœ›æ–‡ä»¶æ–°çš„é•¿åº¦ã€‚</p><p><code>fs.ftruncateSync</code> æ–¹æ³•æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œæ„å‘³ç€ Node.js å°†é˜»å¡å…¶ä»–ä»£ç è¿è¡Œç›´åˆ°è¿™ä¸ªæ“ä½œå®Œæˆã€‚åŒæ­¥çš„æ–¹æ³•åœ¨å¤„ç†å°æ–‡ä»¶æˆ–è€…ç¡®ä¿é¡ºåºæ‰§è¡Œæ—¶å¾ˆæœ‰ç”¨ï¼Œä½†å®ƒä»¬å¯èƒ½ä¼šå½±å“æ€§èƒ½ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†è€—æ—¶çš„æ–‡ä»¶æ“ä½œæ—¶ã€‚</p><h3 id="å‚æ•°è§£é‡Š-22" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-22"><span>å‚æ•°è§£é‡Šï¼š</span></a></h3><ul><li><code>fd</code>: æ–‡ä»¶æè¿°ç¬¦ï¼Œå¿…éœ€å‚æ•°ï¼Œå®ƒæ˜¯é€šè¿‡ <code>fs.openSync()</code> æ‰“å¼€æ–‡ä»¶å¾—åˆ°çš„ã€‚</li><li><code>len</code>: æ–‡ä»¶æœŸæœ›è¢«æˆªæ–­åçš„æ–°é•¿åº¦ï¼Œé»˜è®¤å€¼ä¸º <code>0</code>ã€‚</li></ul><h3 id="ç¤ºä¾‹-4" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-4"><span>ç¤ºä¾‹ï¼š</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º &#39;example.txt&#39; çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>Hello, this is a text file.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç°åœ¨æˆ‘ä»¬æƒ³è¦æˆªæ–­è¿™ä¸ªæ–‡ä»¶ï¼Œåªä¿ç•™å‰é¢çš„ <code>Hello,</code> éƒ¨åˆ†ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ‰“å¼€æ–‡ä»¶è·å–æ–‡ä»¶æè¿°ç¬¦ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œ <code>r+</code> è¡¨ç¤ºä»¥è¯»å†™æ¨¡å¼æ‰“å¼€æ–‡ä»¶ã€‚</p><p>ç„¶åï¼Œä½¿ç”¨ <code>fs.ftruncateSync</code> æ–¹æ³•æˆªæ–­æ–‡ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// æˆ‘ä»¬çŸ¥é“ &quot;Hello,&quot; å æ®äº† 6 ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼ å…¥ 6</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">ftruncateSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 6</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯¥æ–¹æ³•è°ƒç”¨åï¼Œ&#39;example.txt&#39; æ–‡ä»¶çš„å†…å®¹å°±å˜æˆäº†ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>Hello,</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æœ€åï¼Œä¸è¦å¿˜è®°å…³é—­æ–‡ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼šå› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯åŒæ­¥æ–¹æ³•ï¼Œæ¯æ­¥æ“ä½œéƒ½ä¼šç«‹å³æ‰§è¡Œå¹¶é˜»å¡åç»­ä»£ç ï¼Œç›´åˆ°æ“ä½œå®Œæˆã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸ºäº†é¿å…é˜»å¡äº‹ä»¶å¾ªç¯ï¼Œæˆ‘ä»¬æ›´å€¾å‘äºä½¿ç”¨å¼‚æ­¥æ–¹æ³•ï¼ˆæ²¡æœ‰ <code>Sync</code> åç¼€çš„æ–¹æ³•ï¼‰ï¼Œä¾‹å¦‚ <code>fs.ftruncate()</code>ï¼Œå®ƒéœ€è¦å›è°ƒå‡½æ•°æ¥å¤„ç†ç»“æœã€‚</p><p>åŒæ­¥æ–¹æ³•é€‚åˆç®€å•çš„è„šæœ¬æˆ–è€…åˆå§‹åŒ–è®¾ç½®ï¼Œå…¶ä¸­æ‰§è¡Œé¡ºåºå’Œä»£ç æ¸…æ™°æ˜“æ‡‚æ¯”æ‰§è¡Œæ•ˆç‡æ›´é‡è¦ã€‚ä½†åœ¨å¤„ç†å¤§å‹æ–‡ä»¶æˆ–åœ¨æœåŠ¡å™¨ç«¯ä»£ç ä¸­ï¼Œæ¨èä½¿ç”¨ç›¸åº”çš„å¼‚æ­¥ç‰ˆæœ¬ã€‚</p><h3 id="fs-futimessync-fd-atime-mtime" tabindex="-1"><a class="header-anchor" href="#fs-futimessync-fd-atime-mtime"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsfutimessyncfd-atime-mtime" target="_blank" rel="noopener noreferrer">fs.futimesSync(fd, atime, mtime)</a></span></a></h3><p>Node.js ä¸­çš„ <code>fs.futimesSync(fd, atime, mtime)</code> æ˜¯ä¸€ä¸ªç”¨äºä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿä¸­æ–‡ä»¶çš„è®¿é—®ï¼ˆatimeï¼‰å’Œä¿®æ”¹ï¼ˆmtimeï¼‰æ—¶é—´æˆ³çš„åŒæ­¥æ–¹æ³•ã€‚åœ¨æ·±å…¥äº†è§£è¿™ä¸ªå‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¦ç†è§£å‡ ä¸ªæ¦‚å¿µï¼š</p><ol><li><p><strong>åŒæ­¥ï¼ˆSynchronousï¼‰æ–¹æ³•</strong>ï¼šæ‰§è¡Œæ­¤ç§ç±»å‹çš„æ–¹æ³•æ—¶ï¼Œç¨‹åºä¼šç­‰å¾…è¯¥æ–¹æ³•å®Œæˆæ‰€æœ‰æ“ä½œåæ‰ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚ç›¸å¯¹çš„æ˜¯å¼‚æ­¥ï¼ˆAsynchronousï¼‰ï¼Œå¼‚æ­¥æ–¹æ³•å…è®¸ç¨‹åºåœ¨ç­‰å¾…è¿‡ç¨‹ä¸­æ‰§è¡Œå…¶ä»–ä»»åŠ¡ã€‚</p></li><li><p><strong>æ–‡ä»¶æè¿°ç¬¦ï¼ˆFile Descriptor, fdï¼‰</strong>ï¼šæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œç”¨äºä»£è¡¨ç¨‹åºä¸­æ‰“å¼€çš„æ–‡ä»¶ã€‚ä½ å¯ä»¥é€šè¿‡ Node.js çš„ <code>fs.open</code> æˆ– <code>fs.openSync</code> æ–¹æ³•è·å–å®ƒã€‚</p></li><li><p><strong>è®¿é—®æ—¶é—´ï¼ˆAccess Time, atimeï¼‰</strong>ï¼šæŒ‡çš„æ˜¯æ–‡ä»¶æœ€åè¢«è®¿é—®ï¼ˆæ¯”å¦‚è¯»å–ï¼‰çš„æ—¶é—´ã€‚</p></li><li><p><strong>ä¿®æ”¹æ—¶é—´ï¼ˆModification Time, mtimeï¼‰</strong>ï¼šæŒ‡çš„æ˜¯æ–‡ä»¶å†…å®¹æœ€åè¢«ä¿®æ”¹çš„æ—¶é—´ã€‚</p></li></ol><h3 id="ä½¿ç”¨-fs-futimessync-fd-atime-mtime" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-fs-futimessync-fd-atime-mtime"><span>ä½¿ç”¨ <code>fs.futimesSync(fd, atime, mtime)</code></span></a></h3><p>å½“ä½ ä½¿ç”¨ <code>fs.futimesSync</code> æ–¹æ³•æ—¶ï¼Œä½ éœ€è¦æä¾›ä¸‰ä¸ªä¸»è¦å‚æ•°ï¼š</p><ul><li><strong>fd</strong>ï¼šæ–‡ä»¶æè¿°ç¬¦ï¼Œæ ‡è¯†äº†ä½ æƒ³è¦ä¿®æ”¹æ—¶é—´æˆ³çš„ç‰¹å®šæ–‡ä»¶ã€‚</li><li><strong>atime</strong>ï¼šæ–°çš„è®¿é—®æ—¶é—´ã€‚å¯ä»¥æ˜¯ Unix æ—¶é—´æˆ³æ ¼å¼æˆ–è€…æ˜¯ JS <code>Date</code> å¯¹è±¡ã€‚</li><li><strong>mtime</strong>ï¼šæ–°çš„ä¿®æ”¹æ—¶é—´ï¼Œä¸ atime ç›¸åŒï¼Œæ¥å— Unix æ—¶é—´æˆ³æˆ– JS <code>Date</code> å¯¹è±¡ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-20" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-20"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œéœ€è¦æ›´æ–°æŸä¸ªæ—¥å¿—æ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´ï¼Œä»¥åæ˜ æœ€è¿‘ä¸€æ¬¡çš„æŸ¥çœ‹æˆ–ç¼–è¾‘æ“ä½œï¼Œè€Œæ— éœ€å®é™…ä¿®æ”¹æ–‡ä»¶å†…å®¹ã€‚è¿™åœ¨ä¸€äº›è‡ªåŠ¨åŒ–è„šæœ¬æˆ–å¤‡ä»½ç¨‹åºä¸­å¾ˆå¸¸è§ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½ä¾èµ–äºæ–‡ä»¶çš„æ—¶é—´æˆ³æ¥å†³å®šå“ªäº›æ–‡ä»¶éœ€è¦è¢«åŒæ­¥æˆ–å¤‡ä»½ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// é¦–å…ˆï¼Œæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶è·å–å®ƒçš„æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ³¨æ„ï¼š&#39;r+&#39; æ¨¡å¼è¡¨ç¤ºæ‰“å¼€æ–‡ä»¶ç”¨äºè¯»å†™</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç”¨å½“å‰æ—¶é—´ä½œä¸ºæ–°çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> now</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ›´æ–°æ–‡ä»¶æ—¶é—´æˆ³</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">futimesSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> now</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> now</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆç”¨ <code>fs.openSync</code> æ‰“å¼€äº†åä¸º &quot;example.txt&quot; çš„æ–‡ä»¶ï¼Œå¹¶è·å–å®ƒçš„æ–‡ä»¶æè¿°ç¬¦ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå½“å‰æ—¶é—´çš„ <code>Date</code> å¯¹è±¡ <code>now</code>ï¼Œå¹¶ç”¨å®ƒä½œä¸ºæ–°çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´è°ƒç”¨ <code>fs.futimesSync</code>ã€‚å®Œæˆåï¼Œä½¿ç”¨ <code>fs.closeSync</code> æ¥å…³é—­æ–‡ä»¶ã€‚</p><p>è¿™ç§æ“ä½œèƒ½å¤Ÿç¡®ä¿æ–‡ä»¶çš„æ—¶é—´æˆ³è¢«æ­£ç¡®åœ°æ›´æ–°ï¼Œè€Œä¸éœ€è¦æ”¹å˜æ–‡ä»¶æœ¬èº«çš„å†…å®¹ã€‚è¿™å¯¹äºç®¡ç†å’Œç»´æŠ¤æ–‡ä»¶å…ƒæ•°æ®åœ¨æŸäº›åº”ç”¨åœºæ™¯ä¸‹éå¸¸é‡è¦ã€‚</p><h3 id="fs-lchmodsync-path-mode" tabindex="-1"><a class="header-anchor" href="#fs-lchmodsync-path-mode"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fslchmodsyncpath-mode" target="_blank" rel="noopener noreferrer">fs.lchmodSync(path, mode)</a></span></a></h3><p>å½“ä½ å¼€å§‹ä½¿ç”¨ Node.js, ä½ ä¼šå‘ç°å®ƒæœ‰ä¸€ä¸ªéå¸¸å¼ºå¤§çš„æ¨¡å—å«åš<code>fs</code>ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰ã€‚è¿™ä¸ªæ¨¡å—æä¾›äº†ä¸€ç³»åˆ—ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„æ–¹æ³•ï¼Œæ¯”å¦‚åˆ›å»ºã€è¯»å–ã€å†™å…¥å’Œåˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ç­‰ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬è¦è®¨è®ºçš„æ˜¯<code>fs.lchmodSync</code>æ–¹æ³•ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-fs-lchmodsync" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-fs-lchmodsync"><span>ä»€ä¹ˆæ˜¯ <code>fs.lchmodSync</code>ï¼Ÿ</span></a></h3><p>é¦–å…ˆï¼Œ<code>fs.lchmodSync(path, mode)</code>æ˜¯<code>fs</code>æ¨¡å—ä¸­çš„ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œç”¨äºæ›´æ”¹ç¬¦å·é“¾æ¥ï¼ˆsymlinkï¼‰çš„æƒé™ã€‚åœ¨è§£é‡Šè¿™ä¸ªå‡½æ•°ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆç†è§£ä¸¤ä¸ªå…³é”®è¯ï¼šç¬¦å·é“¾æ¥å’Œæ¨¡å¼ï¼ˆmodeï¼‰ã€‚</p><ul><li><p><strong>ç¬¦å·é“¾æ¥ï¼ˆSymlinkï¼‰</strong>ï¼šç®€å•æ¥è¯´ï¼Œç¬¦å·é“¾æ¥å°±åƒæ˜¯å¿«æ·æ–¹å¼ã€‚åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªç¬¦å·é“¾æ¥æ˜¯ä¸€ä¸ªç‰¹æ®Šç±»å‹çš„æ–‡ä»¶ï¼Œå…¶å†…å®¹æ˜¯æŒ‡å‘å¦ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚é€šè¿‡ç¬¦å·é“¾æ¥ï¼Œä½ å¯ä»¥å¿«é€Ÿè®¿é—®æˆ–å¼•ç”¨å…¶ä»–ä½ç½®çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚</p></li><li><p><strong>æ¨¡å¼ï¼ˆModeï¼‰</strong>ï¼šåœ¨ Unix å’Œç±» Unix ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶å’Œç›®å½•éƒ½æœ‰ä¸€å¥—æƒé™ï¼Œå†³å®šè°å¯ä»¥è¯»å–ã€å†™å…¥æˆ–æ‰§è¡Œè¯¥æ–‡ä»¶ã€‚è¿™äº›æƒé™åˆ†ä¸ºä¸‰ç»„ï¼šæ–‡ä»¶æ‰€æœ‰è€…çš„æƒé™ã€æ–‡ä»¶æ‰€æœ‰è€…æ‰€åœ¨ç»„çš„æˆå‘˜çš„æƒé™å’Œå…¶ä»–æ‰€æœ‰äººçš„æƒé™ã€‚æ¨¡å¼ï¼ˆmodeï¼‰å°±æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œç”¨äºè®¾ç½®è¿™äº›æƒé™ã€‚</p></li></ul><h3 id="fs-lchmodsyncçš„å·¥ä½œåŸç†" tabindex="-1"><a class="header-anchor" href="#fs-lchmodsyncçš„å·¥ä½œåŸç†"><span><code>fs.lchmodSync</code>çš„å·¥ä½œåŸç†</span></a></h3><p><code>fs.lchmodSync(path, mode)</code>ç›´æ¥ä½œç”¨äºç¬¦å·é“¾æ¥æœ¬èº«ï¼Œè€Œä¸æ˜¯é“¾æ¥æŒ‡å‘çš„ç›®æ ‡ã€‚å½“ä½ è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œéœ€è¦æä¾›ä¸¤ä¸ªå‚æ•°ï¼š</p><ul><li><code>path</code>ï¼šç¬¦å·é“¾æ¥çš„è·¯å¾„ã€‚</li><li><code>mode</code>ï¼šå¸Œæœ›è®¾ç½®çš„æƒé™æ¨¡å¼ã€‚</li></ul><p>æ³¨æ„ï¼Œç”±äºè¿™æ˜¯ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œå®ƒä¼šé˜»å¡ Node.js äº‹ä»¶å¾ªç¯çš„ç»§ç»­æ‰§è¡Œï¼Œç›´åˆ°æ“ä½œå®Œæˆã€‚è¿™æ„å‘³ç€ï¼Œåœ¨<code>fs.lchmodSync</code>æ‰§è¡ŒæœŸé—´ï¼Œä½ çš„ç¨‹åºä¸ä¼šå¤„ç†ä»»ä½•å…¶ä»–ä»»åŠ¡ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-17" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-17"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªç¬¦å·é“¾æ¥<code>link-to-file.txt</code>ï¼Œå®ƒæŒ‡å‘ä¸€ä¸ªåä¸º<code>file.txt</code>çš„æ–‡ä»¶ã€‚å‡ºäºæŸç§åŸå› ï¼Œä½ æƒ³è¦æ›´æ”¹è¿™ä¸ªç¬¦å·é“¾æ¥çš„æƒé™ï¼Œä½¿å¾—æ‰€æœ‰ç”¨æˆ·éƒ½å¯ä»¥æ‰§è¡Œå®ƒï¼ˆè™½ç„¶å¯¹äºç¬¦å·é“¾æ¥æ¥è¯´ï¼Œæ‰§è¡Œæƒé™å¯èƒ½æ²¡æœ‰å¤ªå¤§æ„ä¹‰ï¼‰ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æ›´æ”¹ç¬¦å·é“¾æ¥çš„æƒé™ä¸ºå¯æ‰§è¡Œï¼ˆå¯¹äºæ‰€æœ‰ç”¨æˆ·ï¼‰</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">lchmodSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path/to/link-to-file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0o111</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Error changing permissions: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>0o111</code>æ˜¯ä¸€ä¸ªå…«è¿›åˆ¶æ•°ï¼Œä»£è¡¨è®¾ç½®æ‰§è¡Œæƒé™ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-17" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-17"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li><code>fs.lchmodSync</code>åªåœ¨æŸäº›å¹³å°ï¼ˆå¦‚ BSDï¼‰ä¸Šå¯ç”¨ï¼›åœ¨ä¸æ”¯æŒ<code>lchmod</code>çš„å¹³å°ï¼ˆä¾‹å¦‚ Linux å’Œ Windowsï¼‰ï¼Œå°è¯•è°ƒç”¨è¿™ä¸ªæ–¹æ³•å¯èƒ½ä¼šæŠ›å‡ºé”™è¯¯ã€‚å› æ­¤ï¼Œä½¿ç”¨å‰æœ€å¥½æ£€æŸ¥å¹³å°çš„å…¼å®¹æ€§ã€‚</li><li>ç”±äºè¿™ä¸ªæ–¹æ³•æ˜¯åŒæ­¥çš„ï¼Œå»ºè®®åœ¨æ€§èƒ½æ•æ„Ÿçš„åº”ç”¨ä¸­è°¨æ…ä½¿ç”¨ï¼Œä»¥é¿å…é˜»å¡äº‹ä»¶å¾ªç¯ã€‚åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œè€ƒè™‘ä½¿ç”¨å¼‚æ­¥ç‰ˆæœ¬<code>fs.lchmod</code>ã€‚</li></ul><p>å¸Œæœ›è¿™è§£é‡Šæ¸…æ¥šäº†<code>fs.lchmodSync</code>çš„ç”¨é€”å’Œå·¥ä½œåŸç†ï¼å¦‚æœä½ æœ‰ä»»ä½•å…¶ä»–é—®é¢˜ï¼Œéšæ—¶é—®æˆ‘ã€‚</p><h3 id="fs-lchownsync-path-uid-gid" tabindex="-1"><a class="header-anchor" href="#fs-lchownsync-path-uid-gid"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fslchownsyncpath-uid-gid" target="_blank" rel="noopener noreferrer">fs.lchownSync(path, uid, gid)</a></span></a></h3><p>åœ¨è§£é‡Š <code>fs.lchownSync(path, uid, gid)</code> è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£ä»¥ä¸‹å‡ ä¸ªæ¦‚å¿µï¼š</p><ol><li><p><strong>æ–‡ä»¶ç³»ç»Ÿï¼ˆFile systemï¼‰</strong>: è®¡ç®—æœºä¸­ç”¨æ¥ç®¡ç†å’Œå­˜å‚¨æ–‡ä»¶çš„ä¸€ç§ç³»ç»Ÿã€‚</p></li><li><p><strong>æƒé™ï¼ˆPermissionsï¼‰</strong>: åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œä¸ºäº†ä¿æŠ¤æ–‡ä»¶å®‰å…¨ï¼Œæ–‡ä»¶ä¼šæœ‰ä¸åŒçš„è®¿é—®æƒé™ï¼Œæ¯”å¦‚è¯»ï¼ˆreadï¼‰ã€å†™ï¼ˆwriteï¼‰ã€æ‰§è¡Œï¼ˆexecuteï¼‰ç­‰æƒé™ã€‚</p></li><li><p><strong>æ‰€æœ‰è€…ï¼ˆOwnerï¼‰</strong>: æ–‡ä»¶çš„æ‰€æœ‰è€…é€šå¸¸æŒ‡åˆ›å»ºæˆ–æ‹¥æœ‰è¯¥æ–‡ä»¶çš„ç”¨æˆ·ã€‚</p></li><li><p><strong>ç”¨æˆ· IDï¼ˆUser ID, UIDï¼‰</strong>: åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†å·ï¼Œç§°ä¸º UIDã€‚</p></li><li><p><strong>ç¾¤ç»„ IDï¼ˆGroup ID, GIDï¼‰</strong>: ç±»ä¼¼äºç”¨æˆ· IDï¼Œæ¯ä¸ªç¾¤ç»„ï¼ˆç”¨æˆ·ç»„ï¼‰ä¹Ÿæœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†å·ï¼Œç§°ä¸º GIDã€‚</p></li><li><p><strong>ç¬¦å·é“¾æ¥ï¼ˆSymbolic linkï¼‰</strong>: ç¬¦å·é“¾æ¥æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ–‡ä»¶ï¼Œå®ƒåŒ…å«å¯¹å¦ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„å¼•ç”¨ã€‚</p></li></ol><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ <code>fs.lchownSync(path, uid, gid)</code> è¿™ä¸ªæ–¹æ³•ã€‚è¿™æ˜¯ Node.js ä¸­æ–‡ä»¶ç³»ç»Ÿæ¨¡å—çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºåŒæ­¥åœ°æ›´æ”¹ç¬¦å·é“¾æ¥çš„æ‰€æœ‰è€…ã€‚è¿™é‡Œçš„â€œåŒæ­¥â€æ„å‘³ç€å½“ä½ è¿è¡Œè¿™ä¸ªæ–¹æ³•æ—¶ï¼Œç¨‹åºå°†è¢«é˜»å¡ï¼Œç›´åˆ°æ–¹æ³•å®Œæˆã€‚æ¢å¥è¯è¯´ï¼Œç¨‹åºä¼šåœ¨è¿™ä¸ªæ–¹æ³•æ‰§è¡Œå®Œä¹‹åæ‰ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>path</code>: ç¬¦å·é“¾æ¥æ–‡ä»¶çš„è·¯å¾„ã€‚</li><li><code>uid</code>: ç”¨æˆ· IDï¼Œä½ æƒ³è¦è®¾ç½®æˆä¸ºæ–°æ‰€æœ‰è€…çš„ç”¨æˆ·çš„ UIDã€‚</li><li><code>gid</code>: ç¾¤ç»„ IDï¼Œä½ æƒ³è¦è®¾ç½®æˆä¸ºæ–°ç¾¤ç»„æ‹¥æœ‰è€…çš„ç¾¤ç»„çš„ GIDã€‚</li></ul><p>ä½¿ç”¨<code>fs.lchownSync()</code>å¯ä»¥æ›´æ”¹æŸä¸ªç¬¦å·é“¾æ¥æ–‡ä»¶æœ¬èº«çš„æ‰€æœ‰è€…ï¼Œè€Œä¸æ”¹å˜å®ƒæ‰€æŒ‡å‘çš„æºæ–‡ä»¶çš„æ‰€æœ‰è€…ã€‚è¿™æ˜¯ä¸<code>fs.chownSync()</code>çš„åŒºåˆ«æ‰€åœ¨ï¼Œ<code>fs.chownSync()</code>ä¼šæ›´æ”¹ç¬¦å·é“¾æ¥æ‰€æŒ‡å‘çš„æºæ–‡ä»¶çš„æ‰€æœ‰è€…ã€‚</p><h3 id="å®é™…ä¾‹å­-10" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-10"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾æœ‰ä¸€ä¸ªåä¸º<code>my-link</code>çš„ç¬¦å·é“¾æ¥æ–‡ä»¶ï¼Œå®ƒæŒ‡å‘äº†å¦ä¸€ä¸ªæ–‡ä»¶<code>original-file.txt</code>ï¼Œä½ æƒ³è¦å°†è¿™ä¸ªç¬¦å·é“¾æ¥çš„æ‰€æœ‰è€…æ›´æ”¹ä¸º UID ä¸º 1000 çš„ç”¨æˆ·å’Œ GID ä¸º 2000 çš„ç¾¤ç»„ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // å°†ç¬¦å·é“¾æ¥ my-link çš„æ‰€æœ‰è€…æ›´æ”¹ä¸º UID ä¸º 1000 çš„ç”¨æˆ·ï¼ŒGID ä¸º 2000 çš„ç¾¤ç»„</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">lchownSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">my-link</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1000</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 2000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ‰€æœ‰æƒæ›´æ”¹æˆåŠŸ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‡ºé”™äº†:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† Node.js çš„<code>fs</code>æ¨¡å—ã€‚ä½¿ç”¨<code>fs.lchownSync()</code>æ–¹æ³•å°è¯•æ›´æ”¹<code>my-link</code>çš„æ‰€æœ‰æƒï¼Œå¹¶æ•è·å¯èƒ½å‘ç”Ÿçš„ä»»ä½•é”™è¯¯ã€‚å¦‚æœæ‰€æœ‰æƒæ›´æ”¹æˆåŠŸï¼Œåˆ™æ‰“å°å‡ºæˆåŠŸæ¶ˆæ¯ï¼›å¦‚æœå‡ºç°é”™è¯¯ï¼Œåˆ™æ‰“å°å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="fs-lutimessync-path-atime-mtime" tabindex="-1"><a class="header-anchor" href="#fs-lutimessync-path-atime-mtime"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fslutimessyncpath-atime-mtime" target="_blank" rel="noopener noreferrer">fs.lutimesSync(path, atime, mtime)</a></span></a></h3><p>å½“æˆ‘ä»¬è®¨è®º Node.js ä¸­çš„<code>fs.lutimesSync(path, atime, mtime)</code>æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šåœ¨è®¨è®ºæ–‡ä»¶ç³»ç»Ÿï¼ˆfilesystemï¼Œç®€ç§° fsï¼‰æ¨¡å—å†…çš„ä¸€ä¸ªç‰¹å®šåŠŸèƒ½ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ åŒæ­¥åœ°ï¼ˆå³ç«‹åˆ»å®Œæˆæ“ä½œè€Œä¸æ˜¯ç¨åé€šè¿‡å›è°ƒæˆ–è€… Promise æ¥å¤„ç†ç»“æœï¼‰ä¿®æ”¹æ–‡ä»¶æˆ–é“¾æ¥çš„è®¿é—®æ—¶é—´ï¼ˆ<code>atime</code>ï¼‰å’Œä¿®æ”¹æ—¶é—´ï¼ˆ<code>mtime</code>ï¼‰ã€‚è¿™é‡Œçš„â€œåŒæ­¥â€æ„å‘³ç€ä»£ç çš„æ‰§è¡Œå°†åœ¨è¿™é¡¹æ“ä½œå®Œæˆä¹‹åæ‰ä¼šç»§ç»­è¿›è¡Œã€‚</p><p>åœ¨æ·±å…¥æ¢è®¨ä¹‹å‰ï¼Œè®©æˆ‘ä»¬è§£é‡Šä¸€ä¸‹å‡ ä¸ªå…³é”®æ¦‚å¿µï¼š</p><ol><li><strong>æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰</strong>ï¼šè¿™æ˜¯è®¡ç®—æœºç”¨äºå­˜å‚¨å’Œç»„ç»‡æ–‡ä»¶çš„ç³»ç»Ÿã€‚Node.js é€šè¿‡å…¶<code>fs</code>æ¨¡å—æä¾›äº†ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„èƒ½åŠ›ã€‚</li><li><strong>è·¯å¾„ï¼ˆPathï¼‰</strong>ï¼šè¿™æ˜¯æŒ‡å‘è®¡ç®—æœºä¸Šæ–‡ä»¶æˆ–ç›®å½•çš„åœ°å€ã€‚ä¾‹å¦‚ï¼Œåœ¨ Windows ç³»ç»Ÿä¸­ï¼Œ<code>C:\Users\YourName\Documents\file.txt</code>æ˜¯ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ï¼›åœ¨ Unix/Linux ç³»ç»Ÿä¸­ï¼Œ<code>/home/yourname/documents/file.txt</code>æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</li><li><strong>è®¿é—®æ—¶é—´ï¼ˆAccess Time, <code>atime</code>ï¼‰</strong>ï¼šè¡¨ç¤ºæ–‡ä»¶æœ€åä¸€æ¬¡è¢«è®¿é—®ï¼ˆè¯»å–ï¼‰çš„æ—¶é—´ã€‚</li><li><strong>ä¿®æ”¹æ—¶é—´ï¼ˆModification Time, <code>mtime</code>ï¼‰</strong>ï¼šè¡¨ç¤ºæ–‡ä»¶å†…å®¹æœ€åä¸€æ¬¡è¢«ä¿®æ”¹çš„æ—¶é—´ã€‚</li></ol><h3 id="fs-lutimessync-path-atime-mtime-1" tabindex="-1"><a class="header-anchor" href="#fs-lutimessync-path-atime-mtime-1"><span>fs.lutimesSync(path, atime, mtime)</span></a></h3><p><code>fs.lutimesSync()</code>æ–¹æ³•å…è®¸ä½ æ›´æ”¹æ–‡ä»¶æˆ–ç¬¦å·é“¾æ¥çš„<code>atime</code>å’Œ<code>mtime</code>ã€‚å®ƒä»¥åŒæ­¥çš„æ–¹å¼å·¥ä½œï¼Œè¿™æ„å‘³ç€ç›´åˆ°è¿™ä¸ªæ“ä½œå®Œæˆåï¼Œç¨‹åºæ‰ä¼šç»§ç»­æ‰§è¡Œä¸‹å»ã€‚è¯¥æ–¹æ³•æ¥å—ä¸‰ä¸ªå‚æ•°ï¼š</p><ul><li><strong>path</strong>ï¼šè¦ä¿®æ”¹çš„æ–‡ä»¶æˆ–ç¬¦å·é“¾æ¥çš„è·¯å¾„ã€‚</li><li><strong>atime</strong>ï¼šæ–°çš„è®¿é—®æ—¶é—´ã€‚å¯ä»¥æ˜¯ Date çš„å®ä¾‹ã€è¡¨ç¤ºæ¯«ç§’æ•°çš„æ•°å­—ï¼Œæˆ–è¡¨ç¤ºç§’æ•°çš„æ•°å­—ã€‚</li><li><strong>mtime</strong>ï¼šæ–°çš„ä¿®æ”¹æ—¶é—´ã€‚æ ¼å¼ä¸<code>atime</code>ç›¸åŒã€‚</li></ul><h4 id="å®é™…è¿ç”¨ç¤ºä¾‹-18" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-18"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦åŸºäºæ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´æ¥æ‰§è¡ŒæŸäº›ä»»åŠ¡ï¼ˆæ¯”å¦‚å¤‡ä»½æœªè¿‘æœŸä¿®æ”¹çš„æ–‡ä»¶ï¼‰ã€‚åœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œä½ å¯èƒ½å¸Œæœ›æ‰‹åŠ¨è®¾ç½®æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´æ¥æµ‹è¯•ä½ çš„åº”ç”¨ã€‚</p><h5 id="ç¤ºä¾‹-1-æ›´æ–°è„šæœ¬æ—¥å¿—çš„ä¿®æ”¹æ—¶é—´" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æ›´æ–°è„šæœ¬æ—¥å¿—çš„ä¿®æ”¹æ—¶é—´"><span>ç¤ºä¾‹ 1ï¼šæ›´æ–°è„šæœ¬æ—¥å¿—çš„ä¿®æ”¹æ—¶é—´</span></a></h5><p>è€ƒè™‘ä»¥ä¸‹åœºæ™¯ï¼šä½ æœ‰ä¸€ä¸ªè„šæœ¬ï¼Œå®ƒæ¯å¤©è‡ªåŠ¨è¿è¡Œå¹¶è®°å½•å…¶æ´»åŠ¨åˆ°ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­ï¼Œæ¯”å¦‚<code>log.txt</code>ã€‚å‡ºäºæµ‹è¯•ç›®çš„ï¼Œä½ æƒ³å°†è¿™ä¸ªæ—¥å¿—æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´è®¾ç½®ä¸ºæ˜¨å¤©ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æŒ‡å®šæ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./log.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è·å–æ˜¨å¤©çš„æ—¥æœŸ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> yesterday</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">(</span><span style="color:#81A1C1;">new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">()</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getTime</span><span style="color:#D8DEE9FF;">() </span><span style="color:#81A1C1;">-</span><span style="color:#B48EAD;"> 24</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 60</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 60</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨lutimesSyncæ¥æ›´æ–°è®¿é—®æ—¶é—´å’Œä¿®æ”¹æ—¶é—´</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">lutimesSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> yesterday</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> yesterday</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">  `</span><span style="color:#A3BE8C;">Updated </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filePath</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> to have a modification and access time of yesterday.</span><span style="color:#ECEFF4;">`</span></span>
<span class="line"><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡æ‰§è¡Œè¿™æ®µä»£ç ï¼Œ<code>log.txt</code>æ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´éƒ½ä¼šè¢«æ›´æ–°ä¸ºæ˜¨å¤©çš„æ—¶é—´ã€‚è¿™å¯¹äºæµ‹è¯•ä¾èµ–äºæ–‡ä»¶æ—¥æœŸçš„è„šæœ¬éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºä½ å¯ä»¥æ¨¡æ‹Ÿæ–‡ä»¶æ˜¯åœ¨è¿‡å»è¢«ä¿®æ”¹çš„ã€‚</p><p>è®°ä½ï¼Œå½“ä½ ä½¿ç”¨<code>fs.lutimesSync()</code>æ–¹æ³•æ—¶ï¼Œå› ä¸ºå®ƒæ˜¯åŒæ­¥çš„ï¼Œå¦‚æœæ“ä½œå¤±è´¥ï¼ˆæ¯”å¦‚ï¼Œæ–‡ä»¶ä¸å­˜åœ¨ï¼‰ï¼Œå®ƒä¼šæŠ›å‡ºå¼‚å¸¸ã€‚å› æ­¤åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½éœ€è¦ä½¿ç”¨ try-catch è¯­å¥æ¥æ•è·è¿™äº›å¼‚å¸¸å¹¶ç›¸åº”åœ°å¤„ç†å®ƒä»¬ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯<code>fs.lutimesSync()</code>æ–¹æ³•çš„å·¥ä½œåŸç†åŠå…¶åº”ç”¨çš„ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚å¸Œæœ›è¿™å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼</p><h3 id="fs-linksync-existingpath-newpath" tabindex="-1"><a class="header-anchor" href="#fs-linksync-existingpath-newpath"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fslinksyncexistingpath-newpath" target="_blank" rel="noopener noreferrer">fs.linkSync(existingPath, newPath)</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘ä¼šç›´æ¥æ·±å…¥è§£é‡Š <code>fs.linkSync(existingPath, newPath)</code> è¿™ä¸ªå‡½æ•°ï¼Œå¹¶ç»™å‡ºä¸€äº›å®é™…åº”ç”¨çš„ä¾‹å­ã€‚</p><h3 id="åŸºç¡€æ¦‚å¿µ-3" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æ¦‚å¿µ-3"><span>åŸºç¡€æ¦‚å¿µ</span></a></h3><p>é¦–å…ˆï¼Œ<code>fs.linkSync()</code> æ˜¯ Node.js çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆfs æ¨¡å—ï¼‰ä¸­çš„ä¸€ä¸ªæ–¹æ³•ã€‚å®ƒç”¨äºåŒæ­¥åœ°åˆ›å»ºä¸€ä¸ªæ–°çš„ç¡¬é“¾æ¥ï¼ˆhard linkï¼‰ã€‚ç¡¬é“¾æ¥æ˜¯æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€ä¸ªæ¦‚å¿µï¼ŒæŒ‡å‘ç¡¬ç›˜ä¸Šçš„ç›¸åŒæ•°æ®å—ã€‚å¦‚æœä½ å¯¹åŸæ–‡ä»¶åˆ›å»ºäº†ä¸€ä¸ªç¡¬é“¾æ¥ï¼Œé‚£ä¹ˆè¿™ä¸ªé“¾æ¥å°±åƒæ˜¯åŸæ–‡ä»¶çš„ä¸€ä¸ªé•œåƒï¼›å®ƒä»¬å…±äº«åŒæ ·çš„æ•°æ®ï¼Œä½†æ‹¥æœ‰ä¸åŒçš„åå­—å’Œè·¯å¾„ã€‚ä¿®æ”¹ä»»ä½•ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œä¼šå½±å“åˆ°å¦å¤–ä¸€ä¸ªï¼Œå› ä¸ºå®ƒä»¬å®è´¨ä¸Šæ˜¯åŒä¸€ä¸ªæ–‡ä»¶ã€‚</p><h3 id="å‚æ•°è§£é‡Š-23" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-23"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>existingPath</code>: è¿™ä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œä»£è¡¨å·²å­˜åœ¨æ–‡ä»¶çš„è·¯å¾„ã€‚</li><li><code>newPath</code>: è¿™ä¸ªå‚æ•°ä¹Ÿæ˜¯å­—ç¬¦ä¸²ï¼Œä»£è¡¨ä½ æƒ³åˆ›å»ºçš„ç¡¬é“¾æ¥çš„è·¯å¾„ã€‚</li></ul><h3 id="ä½¿ç”¨åœºæ™¯åŠä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯åŠä¾‹å­"><span>ä½¿ç”¨åœºæ™¯åŠä¾‹å­</span></a></h3><p><strong>åœºæ™¯ 1ï¼šæ–‡ä»¶å¤‡ä»½</strong></p><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦å¯¹é‡è¦çš„æ–‡ä»¶è¿›è¡Œå¿«é€Ÿå¤‡ä»½ã€‚ä½¿ç”¨ç¡¬é“¾æ¥å¯ä»¥éå¸¸æœ‰æ•ˆï¼Œå› ä¸ºå®ƒå‡ ä¹ä¸å ç”¨é¢å¤–ç©ºé—´ï¼ŒåŒæ—¶åˆèƒ½ä¿è¯åœ¨åŸæ–‡ä»¶æŸåçš„æƒ…å†µä¸‹æœ‰ä¸€ä¸ªå®Œæ•´çš„å¤‡ä»½ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªé‡è¦æ–‡ä»¶ &quot;important.txt&quot; åœ¨ &quot;/documents&quot; ç›®å½•ä¸‹</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> existingPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/documents/important.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æˆ‘ä»¬æƒ³åœ¨ &quot;/backup&quot; ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªç¡¬é“¾æ¥</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> newPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/backup/important_backup.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºç¡¬é“¾æ¥</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">linkSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">existingPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> newPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç°åœ¨ &quot;/documents/important.txt&quot; å’Œ &quot;/backup/important_backup.txt&quot;</span></span>
<span class="line"><span style="color:#616E88;">// æ˜¯æŒ‡å‘åŒä¸€æ•°æ®çš„ä¸¤ä¸ªä¸åŒè·¯å¾„ï¼Œä¿®æ”¹ä»»æ„ä¸€ä¸ªéƒ½ä¼šå½±å“å¦ä¸€ä¸ªã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>åœºæ™¯ 2ï¼šç®¡ç†å¤šä¸ªé¡¹ç›®ä¸­çš„å…¬å…±æ–‡ä»¶</strong></p><p>å¦‚æœä½ ç®¡ç†ç€å¤šä¸ªé¡¹ç›®ï¼Œå®ƒä»¬ä¸­æœ‰ä¸€äº›å…±ç”¨çš„èµ„æºï¼ˆæ¯”å¦‚é…ç½®æ–‡ä»¶æˆ–è€…å…¬å…±åº“ï¼‰ï¼Œé€šè¿‡ç¡¬é“¾æ¥ï¼Œä½ å¯ä»¥ç¡®ä¿æ‰€æœ‰é¡¹ç›®éƒ½ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„è¿™äº›èµ„æºï¼Œè€Œæ— éœ€å¤åˆ¶ç²˜è´´æ–‡ä»¶åˆ°æ¯ä¸ªé¡¹ç›®ä¸­ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å…¬å…±åº“æ–‡ä»¶çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> existingPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/common/libs/myLib.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç¬¬ä¸€ä¸ªé¡¹ç›®éœ€è¦è¿™ä¸ªåº“çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> project1Path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/project1/libs/myLib.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä¸ºç¬¬ä¸€ä¸ªé¡¹ç›®åˆ›å»ºç¡¬é“¾æ¥</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">linkSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">existingPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> project1Path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç¬¬äºŒä¸ªé¡¹ç›®ä¹Ÿæ˜¯åŒç†</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> project2Path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/project2/libs/myLib.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">linkSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">existingPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> project2Path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç°åœ¨ myLib.js åº“åœ¨ä¸‰ä¸ªä½ç½®è¢«å…±äº«ï¼Œæ›´æ–°ä»»ä½•ä¸€ä¸ªå‰¯æœ¬ï¼Œå…¶ä»–çš„éƒ½ä¼šæ›´æ–°ã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ³¨æ„äº‹é¡¹-18" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-18"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>å¦‚æœ <code>newPath</code> å·²ç»å­˜åœ¨ï¼Œ<code>linkSync()</code> æ–¹æ³•å°†æŠ›å‡ºé”™è¯¯ã€‚</li><li>ç¡¬é“¾æ¥ä¸èƒ½è·¨æ–‡ä»¶ç³»ç»Ÿåˆ›å»ºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ ä¸èƒ½ä¸ºä½äºä¸€ä¸ªåˆ†åŒºä¸Šçš„æ–‡ä»¶åˆ›å»ºä¸€ä¸ªä½äºå¦ä¸€ä¸ªåˆ†åŒºä¸Šçš„ç¡¬é“¾æ¥ã€‚</li><li>ç¡¬é“¾æ¥ä»…é€‚ç”¨äºæ–‡ä»¶ï¼Œä¸èƒ½ç”¨äºç›®å½•ã€‚</li></ul><p>å¸Œæœ›è¿™äº›ä¿¡æ¯å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼</p><h3 id="fs-lstatsync-path-options" tabindex="-1"><a class="header-anchor" href="#fs-lstatsync-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fslstatsyncpath-options" target="_blank" rel="noopener noreferrer">fs.lstatSync(path[, options])</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„ JavaScript ç¯å¢ƒã€‚å®ƒè®© JavaScript èƒ½å¤Ÿè¿›è¡Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œã€ç½‘ç»œé€šè®¯ç­‰åç«¯åŠŸèƒ½ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æä¾›äº†ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„ APIã€‚å…¶ä¸­ï¼Œ<code>fs.lstatSync()</code> æ˜¯è¿™ä¸ªæ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ã€‚</p><h3 id="fs-lstatsync-path-options-1" tabindex="-1"><a class="header-anchor" href="#fs-lstatsync-path-options-1"><span>fs.lstatSync(path[, options])</span></a></h3><p><code>fs.lstatSync()</code> æ–¹æ³•ç”¨æ¥åŒæ­¥è·å–æ–‡ä»¶æˆ–ç›®å½•çš„çŠ¶æ€ä¿¡æ¯ã€‚å®ƒè¿”å›ä¸€ä¸ª <code>fs.Stats</code> å¯¹è±¡ï¼ŒåŒ…å«äº†æ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ¯”å¦‚åˆ›å»ºæ—¶é—´ã€ä¿®æ”¹æ—¶é—´ã€å¤§å°ç­‰ã€‚</p><ul><li><strong>path</strong>: è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼ŒæŒ‡å®šäº†ä½ æƒ³è¦è·å–ä¿¡æ¯çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><strong>options</strong>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå¯ä»¥ç”¨æ¥æ”¹å˜å‡½æ•°çš„è¡Œä¸ºæˆ–è®¾ç½®è¿”å›å€¼çš„æ ¼å¼ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥æŒ‡å®šæ˜¯å¦éœ€è¦å¤§æ•´æ•°ï¼ˆbigintï¼‰è¡¨ç¤ºæ–‡ä»¶å¤§å°ã€‚</li></ul><p>&quot;åŒæ­¥&quot;æ„å‘³ç€å½“ä½ è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼ŒJavaScript ä»£ç ä¼šåœä¸‹æ¥ç­‰å¾…ç›´åˆ°æ“ä½œå®Œæˆï¼Œå¹¶ä¸”ç«‹å³å¾—åˆ°ç»“æœã€‚è¿™ä¸&quot;å¼‚æ­¥&quot;ä¸åŒï¼Œåœ¨å¼‚æ­¥æ“ä½œä¸­ï¼Œä»£ç ä¼šç»§ç»­æ‰§è¡Œï¼Œè€Œæ“ä½œç»“æœä¼šåœ¨ç¨åé€šè¿‡å›è°ƒå‡½æ•°å¤„ç†ã€‚</p><p>å®é™…ä¸Šï¼Œ<code>fs.lstatSync()</code> å’Œ <code>fs.statSync()</code> å¾ˆç›¸ä¼¼ï¼Œä½†æœ‰ä¸€ä¸ªå…³é”®åŒºåˆ«ï¼šå¦‚æœè·¯å¾„æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼ˆsymbolic linkï¼‰ï¼Œ<code>fs.lstatSync()</code> è¿”å›çš„æ˜¯ç¬¦å·é“¾æ¥æœ¬èº«çš„çŠ¶æ€ï¼Œè€Œä¸æ˜¯å®ƒæ‰€æŒ‡å‘çš„æ–‡ä»¶æˆ–ç›®å½•çš„çŠ¶æ€ã€‚</p><h4 id="ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-3"><span>ä¾‹å­</span></a></h4><p>å‡è®¾ä½ æœ‰ä»¥ä¸‹æ–‡ä»¶ç»“æ„ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>/myproject</span></span>
<span class="line"><span>  /file.txt</span></span>
<span class="line"><span>  /linkToFile.txt (ç¬¦å·é“¾æ¥æŒ‡å‘ file.txt)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>è·å–æ™®é€šæ–‡ä»¶çš„çŠ¶æ€ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åŒæ­¥è·å– file.txt çš„çŠ¶æ€ä¿¡æ¯</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">lstatSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/myproject/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFile</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: trueï¼Œå› ä¸º file.txt æ˜¯ä¸€ä¸ªæ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">size</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: æ–‡ä»¶çš„å¤§å°ï¼ˆå­—èŠ‚ä¸ºå•ä½ï¼‰</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>è·å–ç¬¦å·é“¾æ¥çš„çŠ¶æ€ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åŒæ­¥è·å–ç¬¦å·é“¾æ¥ linkToFile.txt çš„çŠ¶æ€ä¿¡æ¯</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> linkStats</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">lstatSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/myproject/linkToFile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">linkStats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isSymbolicLink</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: trueï¼Œå› ä¸º linkToFile.txt æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">linkStats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">size</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: ç¬¦å·é“¾æ¥çš„å¤§å°ï¼Œè€Œä¸æ˜¯å®ƒæ‰€æŒ‡å‘çš„æ–‡ä»¶çš„å¤§å°</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼Œå¯¹äºå¤§å‹åº”ç”¨ç¨‹åºæˆ– I/O å¯†é›†å‹æ“ä½œï¼Œé€šå¸¸å»ºè®®ä½¿ç”¨å¼‚æ­¥ç‰ˆæœ¬çš„æ–‡ä»¶ç³»ç»Ÿæ–¹æ³•ï¼ˆå¦‚<code>fs.lstat()</code>ï¼‰ï¼Œä»¥é¿å…é˜»å¡äº‹ä»¶å¾ªç¯ã€‚ç„¶è€Œï¼Œåœ¨æŸäº›åœºæ™¯ï¼Œç‰¹åˆ«æ˜¯è„šæœ¬å’Œç®€å•çš„å‘½ä»¤è¡Œå·¥å…·ä¸­ï¼Œä½¿ç”¨åŒæ­¥æ–¹æ³•ç”±äºå…¶ç®€å•æ€§è€Œæ›´å—é’çã€‚</p><h3 id="fs-mkdirsync-path-options" tabindex="-1"><a class="header-anchor" href="#fs-mkdirsync-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsmkdirsyncpath-options" target="_blank" rel="noopener noreferrer">fs.mkdirSync(path[, options])</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªå¯ä»¥è®©ä½ ç”¨ JavaScript ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç çš„å¹³å°ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>fs</code>ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰æ¨¡å—æ˜¯ä¸€ä¸ªæä¾›æ–‡ä»¶æ“ä½œ API çš„æ ¸å¿ƒæ¨¡å—ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨ <code>fs</code> æ¨¡å—æ¥åˆ›å»ºã€è¯»å–ã€å†™å…¥å’Œåˆ é™¤æ–‡ä»¶ç­‰ã€‚</p><p><code>fs.mkdirSync()</code> æ˜¯ <code>fs</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒè¢«ç”¨äºåŒæ­¥åœ°åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•ã€‚å¦‚æœä½ ä¸ç†Ÿæ‚‰â€œåŒæ­¥â€çš„æ¦‚å¿µï¼Œè¿™é‡Œçš„â€œåŒæ­¥â€æŒ‡çš„æ˜¯ä»£ç ä¼šæŒ‰é¡ºåºä¸€æ­¥æ¥ä¸€æ­¥åœ°æ‰§è¡Œï¼Œç›´åˆ°å½“å‰æ“ä½œå®Œæˆåæ‰ä¼šè¿›è¡Œä¸‹ä¸€æ­¥ã€‚è¿™ä¸â€œå¼‚æ­¥â€ç›¸å¯¹ï¼Œå¼‚æ­¥æ“ä½œå…è®¸ä»£ç åœ¨ç­‰å¾…æŸäº›æ“ä½œå®Œæˆçš„åŒæ—¶ç»§ç»­æ‰§è¡Œå…¶ä»–ä»£ç ã€‚</p><h3 id="fs-mkdirsync-path-options-å‚æ•°è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#fs-mkdirsync-path-options-å‚æ•°è§£é‡Š"><span>fs.mkdirSync(path[, options]) å‚æ•°è§£é‡Š</span></a></h3><ul><li><p><code>path</code>: è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œè¡¨ç¤ºä½ æƒ³è¦åˆ›å»ºçš„ç›®å½•çš„è·¯å¾„ã€‚</p></li><li><p><code>options</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–è€…ä¸€ä¸ªæ•°å­—ã€‚å¦‚æœæ˜¯å¯¹è±¡ï¼Œä½ å¯ä»¥è®¾ç½®ä¸€äº›é¢å¤–çš„é€‰é¡¹ï¼Œå¦‚ <code>recursive</code> å’Œ <code>mode</code>ã€‚</p><ul><li><code>recursive</code>: è®¾ç½®ä¸º <code>true</code>ï¼Œåˆ™ä¼šé€’å½’åœ°åˆ›å»ºæ‰€æœ‰ä¸å­˜åœ¨çš„çˆ¶ç›®å½•ï¼›é»˜è®¤å€¼æ˜¯ <code>false</code>ã€‚</li><li><code>mode</code>: è®¾ç½®ç›®å½•çš„æƒé™ï¼Œé»˜è®¤æ˜¯ <code>0o777</code>ã€‚</li></ul></li></ul><h3 id="å®é™…è¿ç”¨æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨æ¡ˆä¾‹"><span>å®é™…è¿ç”¨æ¡ˆä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ªé¡¹ç›®ï¼Œéœ€è¦åœ¨åˆå§‹åŒ–æ—¶åˆ›å»ºä¸€ç³»åˆ—å­˜å‚¨æ•°æ®çš„ç›®å½•ã€‚</p><h4 id="åˆ›å»ºå•ä¸ªç›®å½•-1" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºå•ä¸ªç›®å½•-1"><span>åˆ›å»ºå•ä¸ªç›®å½•</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å¼•å…¥ fs æ¨¡å—</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®šä¹‰è¦åˆ›å»ºçš„ç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dirPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./data</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨ mkdirSync æ–¹æ³•åˆ›å»ºç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">mkdirSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•åˆ›å»ºæˆåŠŸ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">  // å¦‚æœæœ‰é”™è¯¯ï¼Œæ¯”å¦‚ç›®å½•å·²å­˜åœ¨ï¼Œåˆ™æ•è·å¼‚å¸¸</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•åˆ›å»ºå¤±è´¥:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å°è¯•åœ¨å½“å‰å·¥ä½œç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º <code>data</code> çš„æ–°ç›®å½•ã€‚</p><h4 id="é€’å½’åˆ›å»ºå¤šçº§ç›®å½•" tabindex="-1"><a class="header-anchor" href="#é€’å½’åˆ›å»ºå¤šçº§ç›®å½•"><span>é€’å½’åˆ›å»ºå¤šçº§ç›®å½•</span></a></h4><p>å¦‚æœæˆ‘ä»¬æƒ³ä¸€æ¬¡æ€§åˆ›å»ºå¤šçº§ç›®å½•ï¼Œä¾‹å¦‚åˆ›å»º <code>./data/users/photos/</code> ç›®å½•ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½® <code>recursive</code> é€‰é¡¹ä¸º <code>true</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> deepDirPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./data/users/photos/</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">mkdirSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">deepDirPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> recursive</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å¤šçº§ç›®å½•åˆ›å»ºæˆåŠŸ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å¤šçº§ç›®å½•åˆ›å»ºå¤±è´¥:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡å°† <code>recursive</code> è®¾ç½®ä¸º <code>true</code>ï¼Œ<code>fs.mkdirSync()</code> ä¼šè‡ªåŠ¨åˆ›å»ºæ‰€æœ‰å¿…éœ€çš„çˆ¶ç›®å½•ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œé€šè¿‡ä½¿ç”¨ <code>fs.mkdirSync()</code> æ–¹æ³•ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨ Node.js åº”ç”¨ä¸­åˆ›å»ºæ‰€éœ€çš„ç›®å½•ç»“æ„ï¼Œæ— è®ºæ˜¯ç®€å•è¿˜æ˜¯å¤æ‚çš„å±‚æ¬¡ç»“æ„ã€‚</p><h3 id="fs-mkdtempsync-prefix-options" tabindex="-1"><a class="header-anchor" href="#fs-mkdtempsync-prefix-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsmkdtempsyncprefix-options" target="_blank" rel="noopener noreferrer">fs.mkdtempSync(prefix[, options])</a></span></a></h3><p>Node.js çš„ <code>fs.mkdtempSync</code> æ–¹æ³•æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>ï¼‰æ¨¡å—çš„åŠŸèƒ½ï¼Œå®ƒä¸“é—¨ç”¨äºåˆ›å»ºä¸€ä¸ªä¸´æ—¶ç›®å½•ã€‚åœ¨ç¼–ç¨‹ä¸­ï¼Œç‰¹åˆ«æ˜¯å¤„ç†æ–‡ä»¶å’Œæ•°æ®æ—¶ï¼Œå¾€å¾€éœ€è¦ä¸€ä¸ªä¸´æ—¶çš„åœ°æ–¹æ¥å­˜å‚¨æ•°æ®æˆ–è€…æ–‡ä»¶ï¼Œè¿™æ ·åšå¯ä»¥é¿å…å¹²æ‰°æ­£å¼çš„æ–‡ä»¶ç»“æ„ï¼Œä¹Ÿä¾¿äºè¿›è¡Œä¸´æ—¶æ•°æ®çš„å¤„ç†å’Œæ¸…ç†ã€‚<code>fs.mkdtempSync</code> æ–¹æ³•å°±æ˜¯ç”¨æ¥æ»¡è¶³è¿™ä¸€éœ€æ±‚çš„ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-15" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-15"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><ul><li><strong>åŒæ­¥æ–¹æ³•</strong>ï¼š<code>fs.mkdtempSync</code> æ˜¯ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œæ„å‘³ç€å½“ä½ è°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶ï¼Œç¨‹åºä¼šåœç•™åœ¨é‚£é‡Œç›´åˆ°ç›®å½•è¢«åˆ›å»ºæˆåŠŸåæ‰ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç ã€‚è¿™ä¸å¼‚æ­¥æ‰§è¡Œï¼ˆå³ç«‹å³è¿”å›ï¼Œä¸ç­‰å¾…æ“ä½œå®Œæˆï¼‰ç›¸å¯¹ã€‚</li><li><strong><code>prefix</code> å‚æ•°</strong>ï¼šä½ éœ€è¦ä¸ºè¿™ä¸ªæ–¹æ³•æä¾›ä¸€ä¸ª <code>prefix</code>ï¼Œå®é™…ä¸Šå°±æ˜¯åˆ›å»ºçš„ä¸´æ—¶ç›®å½•åçš„å‰ç¼€ã€‚Node.js ä¼šåœ¨è¿™ä¸ªå‰ç¼€åé¢åŠ ä¸Šä¸€äº›éšæœºå­—ç¬¦ï¼Œä»¥ç¡®ä¿æ¯æ¬¡åˆ›å»ºçš„ç›®å½•åç§°éƒ½æ˜¯å”¯ä¸€çš„ã€‚</li><li><strong><code>options</code> å‚æ•°</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…è®¸ä½ æŒ‡å®šä¸€äº›é¢å¤–çš„é…ç½®ï¼Œæ¯”å¦‚ç›®å½•çš„ç¼–ç æ ¼å¼ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-19" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-19"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-åˆ›å»ºä¸€ä¸ªä¸´æ—¶ç›®å½•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åˆ›å»ºä¸€ä¸ªä¸´æ—¶ç›®å½•"><span>ç¤ºä¾‹ 1ï¼šåˆ›å»ºä¸€ä¸ªä¸´æ—¶ç›®å½•</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦ä¸´æ—¶å­˜å‚¨ä¸€äº›ç»è¿‡å¤„ç†çš„å›¾ç‰‡ï¼Œç„¶åå†å°†å®ƒä»¬ä¸Šä¼ åˆ°äº‘ç«¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªä¸´æ—¶ç›®å½•ï¼Œå‰ç¼€ä¸º &#39;processed-images-&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> tempDir</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">mkdtempSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">processed-images-</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">ä¸´æ—¶ç›®å½•å·²åˆ›å»ºåœ¨: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">tempDir</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åœ¨è¿™ä¹‹åï¼Œä½ å¯ä»¥åˆ©ç”¨ tempDir å˜é‡å¾—åˆ°çš„è·¯å¾„è¿›è¡Œå›¾ç‰‡å¤„ç†å’Œå­˜å‚¨</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>fs.mkdtempSync</code> ç”¨äºåˆ›å»ºä¸€ä¸ªå‰ç¼€ä¸º <code>processed-images-</code> çš„ä¸´æ—¶ç›®å½•ï¼Œå¹¶æ‰“å°å‡ºè¿™ä¸ªç›®å½•çš„ä½ç½®ã€‚ä¹‹åï¼Œä½ å¯ä»¥å°†å¤„ç†è¿‡çš„å›¾ç‰‡æš‚æ—¶å­˜å‚¨åœ¨è¿™ä¸ªç›®å½•ä¸­ã€‚</p><h4 id="ç¤ºä¾‹-2-ä½¿ç”¨ä¸´æ—¶ç›®å½•æ¥å­˜å‚¨åº”ç”¨çš„æ—¥å¿—æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨ä¸´æ—¶ç›®å½•æ¥å­˜å‚¨åº”ç”¨çš„æ—¥å¿—æ–‡ä»¶"><span>ç¤ºä¾‹ 2ï¼šä½¿ç”¨ä¸´æ—¶ç›®å½•æ¥å­˜å‚¨åº”ç”¨çš„æ—¥å¿—æ–‡ä»¶</span></a></h4><p>å¦‚æœä½ çš„åº”ç”¨ç”Ÿæˆäº†ä¸€äº›åªéœ€è¦çŸ­æš‚ä¿å­˜çš„æ—¥å¿—æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>fs.mkdtempSync</code> æ¥åˆ›å»ºä¸€ä¸ªå­˜æ”¾è¿™äº›æ—¥å¿—çš„ä¸´æ—¶ç›®å½•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªä¸´æ—¶ç›®å½•ï¼Œå‰ç¼€ä¸º &#39;app-logs-&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> logsDir</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">mkdtempSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">app-logs-</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥å¿—æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> logFilePath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">logsDir</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">latest.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç°åœ¨ä½ å¯ä»¥æŠŠæ—¥å¿—å†™å…¥åˆ° logFilePath æŒ‡å‘çš„æ–‡ä»¶é‡Œ</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">logFilePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯ä¸€æ¡æ—¥å¿—ä¿¡æ¯</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ—¥å¿—æ–‡ä»¶åˆ›å»ºåœ¨: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">logFilePath</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªç”¨äºå­˜å‚¨æ—¥å¿—æ–‡ä»¶çš„ä¸´æ—¶ç›®å½•ï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥å¿—æ–‡ä»¶ã€‚ä½¿ç”¨ <code>fs.writeFileSync</code> æ–¹æ³•å†™å…¥æ—¥å¿—ä¿¡æ¯ã€‚</p><h3 id="å°ç»“-10" tabindex="-1"><a class="header-anchor" href="#å°ç»“-10"><span>å°ç»“</span></a></h3><p>é€šè¿‡ <code>fs.mkdtempSync</code> æ–¹æ³•ï¼Œä½ å¯ä»¥å¾ˆæ–¹ä¾¿åœ°åˆ›å»ºä¸´æ—¶ç›®å½•ï¼Œç”¨äºå­˜å‚¨ä¸´æ—¶æ–‡ä»¶æˆ–æ•°æ®ã€‚è¿™å¯¹äºå¼€å‘ä¸­éœ€è¦ä¸´æ—¶å­˜å‚¨ç©ºé—´çš„åœºæ™¯éå¸¸æœ‰ç”¨ã€‚è®°å¾—ï¼Œç”±äºå®ƒæ˜¯ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œæ‰€ä»¥ä¼šé˜»å¡ç¨‹åºçš„æ‰§è¡Œï¼Œç›´åˆ°ç›®å½•åˆ›å»ºå®Œæˆã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¦‚æœæ“ä½œä¸æ¶‰åŠåˆ°å¤§é‡çš„åŒæ­¥ä»»åŠ¡æˆ–å¯¹æ€§èƒ½æ²¡æœ‰æé«˜è¦æ±‚ï¼Œä½¿ç”¨åŒæ­¥æ–¹æ³•æ˜¯å¯ä»¥æ¥å—çš„ã€‚ä½†åœ¨å¤„ç†é«˜æ€§èƒ½æˆ–å¤§å‹åº”ç”¨æ—¶ï¼Œå¯èƒ½éœ€è¦è€ƒè™‘ä½¿ç”¨å…¶å¼‚æ­¥ç‰ˆæœ¬ <code>fs.mkdtemp</code> æ¥é¿å…é˜»å¡ã€‚</p><h3 id="fs-opendirsync-path-options" tabindex="-1"><a class="header-anchor" href="#fs-opendirsync-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsopendirsyncpath-options" target="_blank" rel="noopener noreferrer">fs.opendirSync(path[, options])</a></span></a></h3><p>å½“ç„¶ï¼Œè®©æˆ‘æ¥è§£é‡Šä¸€ä¸‹ <code>fs.opendirSync(path[, options])</code> è¿™ä¸ªå‡½æ•°åœ¨ Node.js ä¸­çš„ç”¨æ³•å’Œæ„ä¹‰ã€‚è¿™æ˜¯ä¸€ä¸ªåŒæ­¥æ“ä½œï¼Œç”¨äºæ‰“å¼€ç›®å½•çš„ã€‚</p><h2 id="fs-opendirsync-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#fs-opendirsync-ç®€ä»‹"><span>fs.opendirSync() ç®€ä»‹</span></a></h2><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æä¾›äº†ä¸æ–‡ä»¶ç³»ç»Ÿç›¸å…³çš„åŠŸèƒ½ï¼Œå…¶ä¸­åŒ…æ‹¬åˆ›å»ºã€è¯»å–ã€å†™å…¥å’Œåˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ç­‰ã€‚<code>fs.opendirSync()</code> æ˜¯ <code>fs</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨äºåŒæ­¥åœ°æ‰“å¼€ä¸€ä¸ªç›®å½•æµä»¥è¿›è¡Œè¯»å–ã€‚</p><h3 id="å‚æ•°è§£é‡Š-24" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-24"><span>å‚æ•°è§£é‡Šï¼š</span></a></h3><ul><li><strong>path</strong>ï¼šè¿™æ˜¯ä½ æƒ³è¦æ‰“å¼€çš„ç›®å½•çš„è·¯å¾„ã€‚</li><li><strong>options</strong>ï¼ˆå¯é€‰ï¼‰ï¼šè¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥åŒ…å«ä¸åŒçš„é€‰é¡¹ï¼Œæ¯”å¦‚æŒ‡å®šç›®å½•æµçš„ç¼–ç ã€‚</li></ul><h3 id="è¿”å›å€¼-7" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-7"><span>è¿”å›å€¼ï¼š</span></a></h3><p>è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª <code>fs.Dir</code> å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä»£è¡¨äº†æ‰“å¼€çš„ç›®å½•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒæ¥è¯»å–ç›®å½•å†…çš„å†…å®¹ã€‚</p><h2 id="å®é™…è¿ç”¨ä¾‹å­-21" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-21"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h2><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç›®å½• <code>/photos</code>ï¼Œé‡Œé¢å­˜æ”¾äº†ä¸€äº›å›¾ç‰‡æ–‡ä»¶ï¼Œæˆ‘ä»¬å¸Œæœ›åˆ—å‡ºè¿™ä¸ªç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶åã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // åŒæ­¥æ‰“å¼€ &#39;/photos&#39; ç›®å½•</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> dir</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">opendirSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/photos</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  while</span><span style="color:#D8DEE9FF;"> ((</span><span style="color:#D8DEE9;">dirent</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> dir</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readSync</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#81A1C1;">!==</span><span style="color:#81A1C1;"> null</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // å¾ªç¯è¯»å–ç›®å½•ä¸­çš„æ¯ä¸€ä¸ªæ–‡ä»¶/ç›®å½•é¡¹</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡ºæ–‡ä»¶/ç›®å½•é¡¹çš„åç§°</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å¦‚æœé‡åˆ°é”™è¯¯ï¼Œè¾“å‡ºé”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">dir</span><span style="color:#D8DEE9FF;">) </span><span style="color:#D8DEE9;">dir</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æœ€åï¼Œç¡®ä¿å…³é—­ç›®å½•æµ</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è§£é‡Š-4" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-4"><span>è§£é‡Šï¼š</span></a></h3><ol><li>æˆ‘ä»¬é¦–å…ˆé€šè¿‡ <code>require(&#39;fs&#39;)</code> å¼•å…¥äº† Node.js çš„æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ã€‚</li><li>ä½¿ç”¨ <code>fs.opendirSync(&#39;/photos&#39;)</code> åŒæ­¥æ‰“å¼€åä¸º <code>/photos</code> çš„ç›®å½•ï¼Œå¹¶è¿”å›ä¸€ä¸ª <code>fs.Dir</code> å¯¹è±¡ç»™å˜é‡ <code>dir</code>ã€‚</li><li>æ¥ç€ï¼Œæˆ‘ä»¬è¿›å…¥ä¸€ä¸ªå¾ªç¯ï¼Œä½¿ç”¨ <code>dir.readSync()</code> åŒæ­¥è¯»å–ç›®å½•ä¸­çš„ä¸‹ä¸€ä¸ªç›®å½•é¡¹ã€‚ä¸€æ—¦è¯»å–å®Œæ‰€æœ‰ç›®å½•é¡¹ï¼Œ<code>readSync()</code> å°†è¿”å› <code>null</code>ï¼Œç»ˆæ­¢å¾ªç¯ã€‚</li><li>åœ¨å¾ªç¯ä½“å†…ï¼Œæˆ‘ä»¬è¾“å‡ºæ¯ä¸ªç›®å½•é¡¹çš„åç§°ï¼Œè¿™å¯ä»¥æ˜¯æ–‡ä»¶æˆ–è€…å¦ä¸€ä¸ªç›®å½•çš„åç§°ã€‚</li><li>å¦‚æœè¿‡ç¨‹ä¸­å‘ç”Ÿä»»ä½•é”™è¯¯ï¼Œæ¯”å¦‚æŒ‡å®šçš„è·¯å¾„ä¸å­˜åœ¨æˆ–æ²¡æœ‰è¯»å–æƒé™ï¼Œå°†é€šè¿‡ <code>catch</code> å—æ•è·é”™è¯¯å¹¶è¾“å‡ºã€‚</li><li>æœ€åï¼Œæ— è®ºæ“ä½œæˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œæˆ‘ä»¬éƒ½ä¼šåœ¨ <code>finally</code> å—ä¸­å…³é—­æ‰“å¼€çš„ç›®å½•ï¼Œä»¥é‡Šæ”¾èµ„æºã€‚</li></ol><p>ä½¿ç”¨ <code>fs.opendirSync</code> å’Œå…¶ä»–ç›¸å…³åŒæ­¥æ–¹æ³•æ—¶è¦å°å¿ƒï¼Œå› ä¸ºå®ƒä»¬ä¼šé˜»å¡ä¸»äº‹ä»¶å¾ªç¯ç›´åˆ°æ“ä½œå®Œæˆã€‚åœ¨å¤„ç†å¤§é‡æ–‡ä»¶æˆ–ç›®å½•æ—¶ï¼Œæœ€å¥½ä½¿ç”¨å¼‚æ­¥ç‰ˆæœ¬çš„æ–¹æ³•æ¥é¿å…å½±å“ç¨‹åºæ€§èƒ½ã€‚</p><h3 id="fs-opensync-path-flags-mode" tabindex="-1"><a class="header-anchor" href="#fs-opensync-path-flags-mode"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsopensyncpath-flags-mode" target="_blank" rel="noopener noreferrer">fs.openSync(path[, flags[, mode]])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥ç†è§£ <code>fs.openSync()</code> è¿™ä¸ªæ–¹æ³•åœ¨ Node.js ä¸­çš„ä½œç”¨å’Œä½¿ç”¨æ–¹å¼ï¼Œå°¤å…¶æ˜¯åœ¨ v21.7.1 ç‰ˆæœ¬ä¸­ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-fs-opensync" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-fs-opensync"><span>ä»€ä¹ˆæ˜¯ <code>fs.openSync()</code>ï¼Ÿ</span></a></h3><p>Node.js çš„ <code>fs</code> æ¨¡å—æä¾›äº†æ–‡ä»¶æ“ä½œçš„åŠŸèƒ½ã€‚<code>fs</code> ä»£è¡¨æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰ã€‚è¿™ä¸ªæ¨¡å—åŒ…æ‹¬å¾ˆå¤šç”¨äºæ–‡ä»¶è¯»å†™çš„æ–¹æ³•ï¼Œå…¶ä¸­ <code>openSync</code> æ˜¯ä¸€ä¸ªéå¸¸åŸºç¡€ä¸”é‡è¦çš„æ–¹æ³•ã€‚</p><p><code>fs.openSync()</code> æ–¹æ³•ç”¨äºåŒæ­¥æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ã€‚æ‰€è°“åŒæ­¥ï¼ŒæŒ‡çš„æ˜¯å½“æ‰§è¡Œè¿™ä¸ªæ–¹æ³•æ—¶ï¼ŒNode.js ä¼šåœä¸‹æ¥ç­‰å¾…æ–‡ä»¶æ‰“å¼€å®Œæˆåï¼Œå†ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚è¿™ä¸å¼‚æ­¥æ–¹æ³•ç›¸å¯¹ï¼Œå¼‚æ­¥æ–¹æ³•åœ¨å¤„ç†è¿‡ç¨‹ä¸­ä¸ä¼šé˜»å¡ç¨‹åºçš„è¿è¡Œã€‚</p><h3 id="å‚æ•°è§£é‡Š-25" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-25"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><strong>path</strong>: è¿™æ˜¯è¦æ‰“å¼€æ–‡ä»¶çš„è·¯å¾„ï¼Œå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ã€‚</li><li><strong>flags</strong>: æ‰“å¼€æ–‡ä»¶çš„æ–¹å¼ï¼Œæ¯”å¦‚æ˜¯å¦ä¸ºè¯»å†™ï¼Œæ˜¯å¦åˆ›å»ºæ–°æ–‡ä»¶ç­‰ã€‚</li><li><strong>mode</strong> (å¯é€‰): è®¾ç½®æ–‡ä»¶æ¨¡å¼ï¼ˆæƒé™å’Œç²˜æ»ä½ï¼‰ï¼Œä½†åªæœ‰åœ¨åˆ›å»ºæ–°æ–‡ä»¶æ—¶æ‰æœ‰æ•ˆã€‚</li></ul><h3 id="flags-è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#flags-è§£é‡Š"><span>Flags è§£é‡Š</span></a></h3><p><code>flags</code> å‚æ•°æ§åˆ¶ç€æ–‡ä»¶çš„æ‰“å¼€æ–¹å¼ï¼Œä¸€äº›å¸¸ç”¨çš„ flags åŒ…æ‹¬ï¼š</p><ul><li><code>&#39;r&#39;</code> - ä»¥è¯»å–æ¨¡å¼æ‰“å¼€æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</li><li><code>&#39;r+&#39;</code> - ä»¥è¯»å†™æ¨¡å¼æ‰“å¼€æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</li><li><code>&#39;w&#39;</code> - ä»¥å†™å…¥æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºå®ƒï¼Œå¦‚æœæ–‡ä»¶å­˜åœ¨åˆ™æˆªæ–­å®ƒã€‚</li><li><code>&#39;w+&#39;</code> - ä»¥è¯»å†™æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºå®ƒï¼Œå¦‚æœæ–‡ä»¶å­˜åœ¨åˆ™æˆªæ–­å®ƒã€‚</li><li><code>&#39;a&#39;</code> - ä»¥è¿½åŠ æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºå®ƒã€‚</li><li><code>&#39;a+&#39;</code> - ä»¥è¯»å–å’Œè¿½åŠ æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºå®ƒã€‚</li></ul><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-10" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-10"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç®€å•çš„æ—¥å¿—è®°å½•åº”ç”¨ï¼Œéœ€è¦å‘ä¸€ä¸ªæ–‡ä»¶ä¸­ä¸æ–­æ·»åŠ æ–°çš„æ—¥å¿—ä¿¡æ¯ã€‚</p><ol><li><p><strong>åˆ›å»ºå¹¶æ‰“å¼€ä¸€ä¸ªæ–°çš„æ—¥å¿—æ–‡ä»¶</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨ &#39;a&#39; flag æ‰“å¼€æˆ–åˆ›å»ºä¸€ä¸ªåä¸º &quot;log.txt&quot; çš„æ–‡ä»¶ç”¨äºè¿½åŠ å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">log.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">File opened with file descriptor: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">fd</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // æ¥ä¸‹æ¥å¯ä»¥åˆ©ç”¨ fs.writeSync() æˆ–å…¶ä»–æ–¹æ³•å‘æ–‡ä»¶ä¸­å†™å…¥å†…å®¹</span></span>
<span class="line"><span style="color:#616E88;">  // ç¡®ä¿æœ€åå…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>è¯»å–ç°æœ‰æ–‡ä»¶çš„å†…å®¹</strong></p><p>å¦‚æœä½ æƒ³åœ¨ç¨‹åºä¸­é¦–å…ˆè¯»å–ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œç„¶åå†å†³å®šæ˜¯å¦å†™å…¥æ–°çš„æ•°æ®ï¼Œä½ å¯èƒ½ä¼šè¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨ &#39;r+&#39; flag æ‰“å¼€ä¸€ä¸ªå·²å­˜åœ¨çš„æ–‡ä»¶ç”¨äºè¯»å†™</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">existingFile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">1024</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // è¯»å–æ–‡ä»¶å†…å®¹åˆ° buffer ä¸­</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">length</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> content</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">File Content: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">content</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // æ ¹æ®éœ€è¦ä¿®æ”¹æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#616E88;">  // æœ€ååˆ«å¿˜äº†å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>ä»¥ä¸Šä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>fs.openSync()</code> æ–¹æ³•è¿›è¡Œæ–‡ä»¶çš„åˆ›å»ºã€æ‰“å¼€å’Œå‡†å¤‡è¯»å†™æ“ä½œã€‚è¿™åªæ˜¯ <code>fs</code> æ¨¡å—æä¾›åŠŸèƒ½çš„ä¸€å°éƒ¨åˆ†ï¼Œä½†ç†è§£äº†è¿™äº›åŸºç¡€ä¹‹åï¼Œä½ å°±èƒ½æ›´å¥½åœ°æŒæ¡ Node.js å¤„ç†æ–‡ä»¶çš„èƒ½åŠ›äº†ã€‚</p><h3 id="fs-readdirsync-path-options" tabindex="-1"><a class="header-anchor" href="#fs-readdirsync-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsreaddirsyncpath-options" target="_blank" rel="noopener noreferrer">fs.readdirSync(path[, options])</a></span></a></h3><p>Node.js ä¸­çš„ <code>fs.readdirSync</code> å‡½æ•°æ˜¯æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>ï¼‰æ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨äºåŒæ­¥è¯»å–ç»™å®šç›®å½•çš„å†…å®¹ï¼Œè¿”å›è¯¥ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•çš„åç§°æ•°ç»„ã€‚è¿™ä¸ªæ“ä½œæ˜¯åŒæ­¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ–‡ä»¶è¯»å–æ“ä½œå®Œæˆä¹‹å‰ï¼Œç¨‹åºå°†ä¸ä¼šæ‰§è¡Œä»»ä½•åç»­ä»£ç ã€‚</p><h3 id="å‚æ•°è§£é‡Š-26" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-26"><span>å‚æ•°è§£é‡Š:</span></a></h3><ul><li><code>path</code>: è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼ŒæŒ‡å®šæƒ³è¦è¯»å–çš„ç›®å½•çš„è·¯å¾„ã€‚</li><li><code>options</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰çš„å¯¹è±¡å‚æ•°ï¼Œå…è®¸ä½ å®šåˆ¶å‡½æ•°çš„è¡Œä¸ºï¼Œæ¯”å¦‚é€‰æ‹©ç¼–ç æ–¹å¼æˆ–è€…å†³å®šè¿”å›å€¼åº”è¯¥åŒ…æ‹¬æ–‡ä»¶å®Œæ•´çš„è·¯å¾„è€Œä¸ä»…ä»…æ˜¯æ–‡ä»¶åã€‚</li></ul><h3 id="options-å¯¹è±¡å¯èƒ½åŒ…å«çš„å±æ€§" tabindex="-1"><a class="header-anchor" href="#options-å¯¹è±¡å¯èƒ½åŒ…å«çš„å±æ€§"><span><code>options</code> å¯¹è±¡å¯èƒ½åŒ…å«çš„å±æ€§:</span></a></h3><ul><li><code>encoding</code>: æŒ‡å®šç”¨äºæ–‡ä»¶åçš„å­—ç¬¦ç¼–ç ï¼Œé»˜è®¤å€¼æ˜¯ <code>&#39;utf8&#39;</code>ã€‚</li><li><code>withFileTypes</code>: å¦‚æœè®¾ç½®ä¸º <code>true</code>ï¼Œåˆ™è¿”å›å€¼ä¼šæ˜¯ä¸€ä¸ª <code>fs.Dirent</code> å¯¹è±¡æ•°ç»„è€Œä¸æ˜¯å­—ç¬¦ä¸²æ•°ç»„ã€‚è¿™äº›å¯¹è±¡åŒ…å«ç€æ¯ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„ä¿¡æ¯ï¼Œä¾‹å¦‚å®ƒä»¬æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•ã€‚</li></ul><h3 id="è¿”å›å€¼-8" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-8"><span>è¿”å›å€¼:</span></a></h3><p>è°ƒç”¨ <code>fs.readdirSync</code> ä¼šå¾—åˆ°ä¸€ä¸ªæ•°ç»„ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½® <code>withFileTypes</code> ä¸º <code>true</code>ï¼Œè¿™ä¸ªæ•°ç»„åŒ…å«çš„æ˜¯å­—ç¬¦ä¸²ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²ä»£è¡¨ç›®å½•ä¸­çš„ä¸€ä¸ªæ–‡ä»¶æˆ–å­ç›®å½•çš„åå­—ã€‚å¦‚æœè®¾ç½®äº† <code>withFileTypes</code> ä¸º <code>true</code>ï¼Œæ•°ç»„é‡Œåˆ™åŒ…å« <code>fs.Dirent</code> å¯¹è±¡ã€‚</p><h3 id="ä½¿ç”¨ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­-5"><span>ä½¿ç”¨ä¾‹å­:</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç›®å½• <code>/tmp/mydir</code>ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹æ–‡ä»¶å’Œç›®å½•ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>/tmp/mydir/</span></span>
<span class="line"><span>â”‚â”€â”€ file1.txt</span></span>
<span class="line"><span>â”‚â”€â”€ file2.js</span></span>
<span class="line"><span>â””â”€â”€ subdir1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="åŸºæœ¬ä½¿ç”¨-æ²¡æœ‰æä¾›-options" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ä½¿ç”¨-æ²¡æœ‰æä¾›-options"><span>åŸºæœ¬ä½¿ç”¨ (æ²¡æœ‰æä¾› options):</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åŒæ­¥è¯»å–ç›®å½•å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> files</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdirSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/tmp/mydir</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">files</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// è¾“å‡ºå¯èƒ½æ˜¯: [&#39;file1.txt&#39;, &#39;file2.js&#39;, &#39;subdir1&#39;]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç åˆ—å‡ºäº† <code>/tmp/mydir</code> ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•ã€‚</p><h4 id="ä½¿ç”¨-withfiletypes" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-withfiletypes"><span>ä½¿ç”¨ <code>withFileTypes</code>:</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ withFileTypes é€‰é¡¹åŒæ­¥è¯»å–ç›®å½•å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filesWithTypes</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdirSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/tmp/mydir</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> withFileTypes</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">filesWithTypes</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forEach</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFile</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">File: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#81A1C1;"> if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isDirectory</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Directory: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// è¾“å‡ºå¯èƒ½æ˜¯:</span></span>
<span class="line"><span style="color:#616E88;">// File: file1.txt</span></span>
<span class="line"><span style="color:#616E88;">// File: file2.js</span></span>
<span class="line"><span style="color:#616E88;">// Directory: subdir1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤æ—¶ï¼Œ<code>filesWithTypes</code> æ•°ç»„åŒ…å«çš„æ˜¯ <code>fs.Dirent</code> å¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥æ£€æŸ¥æ¯ä¸ªé¡¹æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•ã€‚</p><p>è¯·æ³¨æ„ï¼Œç”±äº <code>readdirSync</code> æ˜¯åŒæ­¥å‡½æ•°ï¼Œå®ƒåœ¨å¤„ç†å¤§å‹ç›®å½•æˆ–åœ¨æ€§èƒ½æ•æ„Ÿçš„åº”ç”¨ç¨‹åºä¸­æ—¶ï¼Œå¯èƒ½ä¼šé˜»å¡äº‹ä»¶å¾ªç¯ï¼Œå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œé€šå¸¸æ¨èä½¿ç”¨å¼‚æ­¥ç‰ˆæœ¬çš„ <code>fs.readdir</code>ã€‚</p><h3 id="fs-readfilesync-path-options" tabindex="-1"><a class="header-anchor" href="#fs-readfilesync-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsreadfilesyncpath-options" target="_blank" rel="noopener noreferrer">fs.readFileSync(path[, options])</a></span></a></h3><p><code>fs.readFileSync(path[, options])</code> æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼ˆç®€ç§° fs æ¨¡å—ï¼‰ä¸­çš„ä¸€ä¸ªæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ç”¨äºåŒæ­¥åœ°è¯»å–ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œæ„å‘³ç€ JavaScript ä»£ç ä¼šåœä¸‹æ¥ç­‰å¾…æ–‡ä»¶è¯»å–å®Œæˆåå†ç»§ç»­æ‰§è¡Œä¸‹ä¸€è¡Œä»£ç ã€‚è¿™ä¸ Node.js ä¸­è®¸å¤šå¼‚æ­¥æ–¹æ³•å½¢æˆå¯¹æ¯”ï¼Œå¼‚æ­¥æ–¹æ³•å…è®¸ä»£ç åœ¨æ–‡ä»¶è¯»å–æ—¶ç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡ã€‚</p><h3 id="å‚æ•°è§£é‡Š-27" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-27"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>path</code>: è¡¨ç¤ºè¦è¯»å–æ–‡ä»¶çš„è·¯å¾„ã€‚è¿™å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ª URL æˆ–è€… Buffer å¯¹è±¡ã€‚</li><li><code>options</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…è®¸ä½ æŒ‡å®šä¸€äº›è¯»å–æ–‡ä»¶æ—¶çš„é€‰é¡¹ï¼Œæ¯”å¦‚æ–‡ä»¶çš„ç¼–ç æ–¹å¼ç­‰ã€‚å¦‚æœä¸æŒ‡å®šï¼Œæ–‡ä»¶å†…å®¹å°†ä»¥ Buffer å¯¹è±¡çš„å½¢å¼è¿”å›ï¼ŒBuffer æ˜¯ Node.js ä¸­ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ç±»ã€‚</li></ul><h3 id="è¿”å›å€¼-9" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-9"><span>è¿”å›å€¼</span></a></h3><p>è¯¥æ–¹æ³•è¿”å›æ–‡ä»¶çš„å†…å®¹ã€‚æ ¹æ®æ˜¯å¦ä¼ å…¥ <code>options</code> å‚æ•°æˆ–å…¶å±æ€§å€¼ï¼Œè¿”å›å†…å®¹å¯èƒ½æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…ä¸€ä¸ª Buffer å¯¹è±¡ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-22" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-22"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="_1-è¯»å–æ–‡æœ¬æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_1-è¯»å–æ–‡æœ¬æ–‡ä»¶"><span>1. è¯»å–æ–‡æœ¬æ–‡ä»¶</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡æœ¬æ–‡ä»¶ï¼Œé‡Œé¢çš„å†…å®¹æ˜¯ <code>&quot;Hello, Node.js!&quot;</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä¸æŒ‡å®šç¼–ç ï¼Œè¿”å› Buffer å¯¹è±¡</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: `&lt;`Buffer 48 65 6c 6c 6f 2c 20 4e 6f 64 65 2e 6a 73 21&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æŒ‡å®šç¼–ç ï¼Œè¿”å›å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dataWithEncoding</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dataWithEncoding</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: Hello, Node.js!</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-è¯»å–-json-æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_2-è¯»å–-json-æ–‡ä»¶"><span>2. è¯»å– JSON æ–‡ä»¶</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ <code>config.json</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Node.js Guide</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1.0.0</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬å¯ä»¥åŒæ­¥è¯»å–å¹¶è§£æè¿™ä¸ª JSON æ–‡ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> rawData</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> config</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> JSON</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parse</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">rawData</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">config</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: Node.js Guide</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">config</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">version</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: 1.0.0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä½¿ç”¨æ³¨æ„äº‹é¡¹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æ³¨æ„äº‹é¡¹"><span>ä½¿ç”¨æ³¨æ„äº‹é¡¹</span></a></h4><p>è™½ç„¶ <code>fs.readFileSync()</code> åœ¨æŸäº›æƒ…å†µä¸‹å¾ˆæ–¹ä¾¿ï¼Œæ¯”å¦‚è¯»å–é…ç½®æ–‡ä»¶ç­‰è¾ƒå°çš„æ–‡ä»¶æˆ–è€…åœ¨ç¨‹åºå¯åŠ¨æ—¶åŠ è½½å¿…è¦çš„æ•°æ®ï¼Œä½†ä½¿ç”¨å®ƒè¿›è¡Œå¤§é‡æˆ–é¢‘ç¹çš„æ–‡ä»¶è¯»å–æ“ä½œä¼šé˜»å¡ JavaScript ä¸»çº¿ç¨‹ï¼Œå½±å“åº”ç”¨æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚åœ¨å¤„ç†å¤§å‹æ–‡ä»¶æˆ–é«˜å¹¶å‘åœºæ™¯æ—¶ï¼Œåº”è€ƒè™‘ä½¿ç”¨å¼‚æ­¥ç‰ˆæœ¬ <code>fs.readFile()</code> æˆ–åŸºäº Promise çš„ <code>fs.promises.readFile()</code>ã€‚</p><p>é€šè¿‡ä»¥ä¸Šçš„ä»‹ç»å’Œä¾‹å­ï¼Œå¸Œæœ›ä½ èƒ½ç†è§£ <code>fs.readFileSync</code> æ–¹æ³•åœ¨ Node.js ä¸­çš„ä½œç”¨å’Œå¦‚ä½•ä½¿ç”¨å®ƒã€‚</p><h3 id="fs-readlinksync-path-options" tabindex="-1"><a class="header-anchor" href="#fs-readlinksync-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsreadlinksyncpath-options" target="_blank" rel="noopener noreferrer">fs.readlinkSync(path[, options])</a></span></a></h3><p>äº†è§£ <code>fs.readlinkSync(path[, options])</code> æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£å‡ ä¸ªæ¦‚å¿µï¼š</p><ol><li><strong>æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰</strong>ï¼šç®€å•æ¥è¯´ï¼Œæ–‡ä»¶ç³»ç»Ÿæ˜¯ç®¡ç†å­˜å‚¨åœ¨ç£ç›˜æˆ–å…¶ä»–æŒä¹…æ€§å­˜å‚¨è®¾å¤‡ä¸Šçš„æ•°æ®ï¼ˆå¦‚æ–‡ä»¶å’Œç›®å½•ï¼‰çš„æ–¹å¼ã€‚</li><li><strong>Node.js</strong>ï¼šæ˜¯ä¸€ä¸ªè¿è¡ŒäºæœåŠ¡å™¨ç«¯çš„ JavaScript ç¯å¢ƒï¼Œå®ƒèƒ½è®©ä½ ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ç¨‹åºã€‚</li><li><strong>ç¬¦å·é“¾æ¥ï¼ˆSymbolic Linkï¼‰</strong>ï¼šä¹Ÿç§°è½¯é“¾æ¥ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ–‡ä»¶ï¼Œå…¶å†…å®¹æ˜¯æŒ‡å‘å¦ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚å¯ä»¥æƒ³è±¡æˆæ˜¯ä¸€ä¸ªå¿«æ·æ–¹å¼ï¼Œé€šè¿‡å®ƒå¯ä»¥è®¿é—®è¢«é“¾æ¥çš„åŸå§‹æ–‡ä»¶ã€‚</li></ol><h3 id="fs-readlinksync-path-options-1" tabindex="-1"><a class="header-anchor" href="#fs-readlinksync-path-options-1"><span>fs.readlinkSync(path[, options])</span></a></h3><p><code>fs.readlinkSync()</code> æ˜¯ Node.js ä¸­ <code>fs</code> æ¨¡å—æä¾›çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºåŒæ­¥åœ°è¯»å–ç¬¦å·é“¾æ¥çš„å€¼ã€‚æ¢å¥è¯è¯´ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šå‘Šè¯‰ä½ è¿™ä¸ªç¬¦å·é“¾æ¥æŒ‡å‘å“ªé‡Œã€‚</p><h4 id="å‚æ•°-9" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-9"><span>å‚æ•°</span></a></h4><ul><li><strong>path</strong>: è¿™ä¸ªå‚æ•°æŒ‡å®šè¦è¯»å–çš„ç¬¦å·é“¾æ¥çš„è·¯å¾„ã€‚</li><li><strong>options</strong> (å¯é€‰): è¿™ä¸ªå‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šå­—ç¬¦ç¼–ç ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªåŒ…å« <code>encoding</code> å±æ€§çš„å¯¹è±¡ã€‚å¦‚æœæä¾›äº† <code>encoding</code> é€‰é¡¹ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦åˆ™è¿”å›ä¸€ä¸ª Buffer å¯¹è±¡ã€‚</li></ul><h4 id="è¿”å›å€¼-10" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-10"><span>è¿”å›å€¼</span></a></h4><p>æ ¹æ®æ˜¯å¦ä¼ é€’äº† <code>encoding</code> é€‰é¡¹ï¼Œ<code>fs.readlinkSync()</code> è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–ä¸€ä¸ª Buffer å¯¹è±¡ã€‚è¿™ä¸ªå€¼è¡¨ç¤ºç¬¦å·é“¾æ¥æ‰€æŒ‡å‘çš„è·¯å¾„ã€‚</p><h4 id="å®é™…è¿ç”¨ä¾‹å­-23" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-23"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹åœºæ™¯ï¼šä½ æœ‰ä¸€ä¸ªåä¸º <code>project-link</code> çš„ç¬¦å·é“¾æ¥ï¼Œå®ƒæŒ‡å‘ä¸€ä¸ªåä¸º <code>project-v1</code> çš„ç›®å½•ã€‚æˆ‘ä»¬æƒ³é€šè¿‡ç¨‹åºè·å–è¿™ä¸ªç¬¦å·é“¾æ¥æŒ‡å‘çš„å®é™…è·¯å¾„ã€‚</p><h5 id="æ­¥éª¤-1-å¼•å…¥-fs-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-1-å¼•å…¥-fs-æ¨¡å—"><span>æ­¥éª¤ 1: å¼•å…¥ fs æ¨¡å—</span></a></h5><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ Node.js çš„ <code>fs</code> æ¨¡å—ï¼Œå› ä¸ºæˆ‘ä»¬å°†ä½¿ç”¨å…¶ä¸­çš„ <code>readlinkSync</code> æ–¹æ³•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h5 id="æ­¥éª¤-2-ä½¿ç”¨-readlinksync-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-2-ä½¿ç”¨-readlinksync-æ–¹æ³•"><span>æ­¥éª¤ 2: ä½¿ç”¨ readlinkSync æ–¹æ³•</span></a></h5><p>ç„¶åï¼Œæˆ‘ä»¬è°ƒç”¨ <code>readlinkSync</code> æ–¹æ³•ï¼Œå¹¶ä¸”ä¼ å…¥æˆ‘ä»¬æƒ³è¦è¯»å–çš„ç¬¦å·é“¾æ¥çš„è·¯å¾„ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> linkPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">project-link</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> realPath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readlinkSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">linkPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">The symbolic link points to: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">realPath</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error reading symbolic link:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œæ§åˆ¶å°å°†è¾“å‡º <code>project-link</code> ç¬¦å·é“¾æ¥æ‰€æŒ‡å‘çš„å®é™…è·¯å¾„ï¼ˆä¾‹å¦‚ï¼š<code>project-v1</code>ï¼‰ã€‚å¦‚æœå‡ºé”™ï¼ˆæ¯”å¦‚è¯´è·¯å¾„ä¸å­˜åœ¨ï¼‰ï¼Œåˆ™ä¼šæ•è·é”™è¯¯å¹¶è¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p><h4 id="æ³¨æ„äº‹é¡¹-19" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-19"><span>æ³¨æ„äº‹é¡¹</span></a></h4><ul><li>ä½¿ç”¨ <code>fs.readlinkSync()</code> æ–¹æ³•æ—¶ï¼Œå¦‚æœæŒ‡å®šçš„è·¯å¾„ä¸æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼Œå°†ä¼šæŠ›å‡ºé”™è¯¯ã€‚</li><li>ç”±äºè¿™æ˜¯ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œå®ƒä¼šé˜»å¡äº‹ä»¶å¾ªç¯ç›´åˆ°æ“ä½œå®Œæˆã€‚åœ¨å¤„ç†å¤§é‡ IO æ“ä½œæˆ–è€…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ¨èä½¿ç”¨å¼‚æ­¥ç‰ˆæœ¬ <code>fs.readlink()</code> ä»¥é¿å…é˜»å¡ã€‚</li></ul><p>é€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼Œä½ å¯ä»¥åœ¨ Node.js åº”ç”¨ä¸­è½»æ¾åœ°è¯»å–å’Œç®¡ç†æ–‡ä»¶ç³»ç»Ÿä¸­çš„ç¬¦å·é“¾æ¥ï¼Œæ— è®ºæ˜¯è¿›è¡Œé…ç½®ç®¡ç†ã€èµ„æºå®šä½è¿˜æ˜¯å…¶ä»–éœ€è¦åŠ¨æ€å¼•ç”¨æ–‡ä»¶è·¯å¾„çš„åœºæ™¯ã€‚</p><h3 id="fs-readsync-fd-buffer-offset-length-position" tabindex="-1"><a class="header-anchor" href="#fs-readsync-fd-buffer-offset-length-position"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsreadsyncfd-buffer-offset-length-position" target="_blank" rel="noopener noreferrer">fs.readSync(fd, buffer, offset, length[, position])</a></span></a></h3><p>Node.js çš„ <code>fs.readSync</code> æ–¹æ³•æ˜¯ç”¨äºåŒæ­¥è¯»å–æ–‡ä»¶å†…å®¹çš„å‡½æ•°ã€‚è®©æˆ‘åˆ†æ­¥éª¤è§£é‡Šè¿™ä¸ªå‡½æ•°ï¼Œç„¶åé€šè¿‡ä¸€äº›å®ç”¨çš„ä¾‹å­æ¥å±•ç¤ºå®ƒçš„ç”¨æ³•ã€‚</p><h3 id="å‡½æ•°è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#å‡½æ•°è§£é‡Š"><span>å‡½æ•°è§£é‡Š</span></a></h3><ul><li><strong><code>fd</code></strong>ï¼šè¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚åœ¨ Node.js ä¸­ï¼Œå½“ä½ æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼ˆæ¯”å¦‚ä½¿ç”¨ <code>fs.openSync()</code> æ–¹æ³•ï¼‰ï¼Œç³»ç»Ÿä¼šè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå®ƒæ˜¯ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œç”¨äºä»£è¡¨é‚£ä¸ªè¢«æ‰“å¼€çš„æ–‡ä»¶ã€‚</li><li><strong><code>buffer</code></strong>ï¼šè¿™æ˜¯ä¸€ä¸ª Buffer æˆ–è€… Uint8Array å¯¹è±¡ï¼Œåœ¨è¯»å–æ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶çš„å†…å®¹å°†ä¼šè¢«å†™å…¥åˆ°è¿™ä¸ª buffer ä¸­ã€‚</li><li><strong><code>offset</code></strong>ï¼šè¿™ä¸ªå‚æ•°æŒ‡å®šäº†ä» buffer çš„å“ªé‡Œå¼€å§‹å†™å…¥è¯»å–çš„æ•°æ®ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœ offset æ˜¯ 0ï¼Œé‚£ä¹ˆæ•°æ®ä¼šä» buffer çš„èµ·å§‹ä½ç½®å¼€å§‹å†™å…¥ã€‚</li><li><strong><code>length</code></strong>ï¼šè¿™è¡¨ç¤ºè¦ä»æ–‡ä»¶ä¸­è¯»å–å¤šå°‘å­—èŠ‚çš„æ•°æ®ã€‚</li><li><strong><code>position</code></strong>ï¼šè¿™ä¸ªå‚æ•°æŒ‡å®šäº†ä»æ–‡ä»¶çš„å“ªä¸ªä½ç½®å¼€å§‹è¯»å–æ•°æ®ã€‚å¦‚æœè®¾ç½®ä¸º nullï¼Œåˆ™ä»å½“å‰æ–‡ä»¶ä½ç½®å¼€å§‹è¯»å–ï¼Œå¹¶æ›´æ–°æ–‡ä»¶ä½ç½®ã€‚å¦‚æœæŒ‡å®šäº†ç‰¹å®šçš„ positionï¼Œåˆ™ä»è¯¥ä½ç½®è¯»å–ä½†ä¸æ”¹å˜æ–‡ä»¶ä½ç½®ã€‚</li></ul><h3 id="å®é™…è¿ç”¨-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨-2"><span>å®é™…è¿ç”¨</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ <code>example.txt</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>Hello, Node.js!</span></span>
<span class="line"><span>Welcome to file handling.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬æƒ³è¯»å–æ–‡ä»¶çš„å‰ 5 ä¸ªå­—èŠ‚ï¼ˆå³ <code>&quot;Hello&quot;</code>ï¼‰ã€‚ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨ <code>fs.readSync</code> æ¥å®ç°è¿™ä¸€ç›®æ ‡çš„ç¤ºä¾‹ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶è·å–æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªè¶³ä»¥å®¹çº³æˆ‘ä»¬æƒ³è¦è¯»å–çš„æ•°æ®é•¿åº¦çš„ buffer</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">5</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åˆ†é…ä¸€ä¸ª 5 å­—èŠ‚é•¿çš„ buffer</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fs.readSync è¯»å–æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">length</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å°† buffer è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶æ‰“å°ï¼Œé¢„æœŸè¾“å‡º &quot;Hello&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æœ€åï¼Œä¸è¦å¿˜è®°å…³é—­æ–‡ä»¶ï¼</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è§£æ" tabindex="-1"><a class="header-anchor" href="#è§£æ"><span>è§£æ</span></a></h3><ol><li>æˆ‘ä»¬é¦–å…ˆä½¿ç”¨ <code>fs.openSync</code> æ‰“å¼€æ–‡ä»¶ï¼Œå¾—åˆ°æ–‡ä»¶æè¿°ç¬¦ <code>fd</code>ã€‚</li><li>ç„¶ååˆ›å»ºä¸€ä¸ª <code>Buffer</code> å¯¹è±¡ <code>buffer</code>ï¼Œé•¿åº¦ä¸ºæˆ‘ä»¬æƒ³è¯»å–çš„å­—èŠ‚æ•°ï¼ˆè¿™é‡Œæ˜¯ 5 ä¸ªå­—èŠ‚ï¼‰ã€‚</li><li>æ¥ç€è°ƒç”¨ <code>fs.readSync()</code> å‡½æ•°ï¼Œä¼ å…¥æ–‡ä»¶æè¿°ç¬¦ã€bufferã€offsetï¼ˆå¼€å§‹å†™å…¥çš„ä½ç½®ï¼‰ã€lengthï¼ˆè¯»å–çš„é•¿åº¦ï¼‰ã€positionï¼ˆä»æ–‡ä»¶çš„å“ªä¸ªä½ç½®å¼€å§‹è¯»å–ï¼‰ã€‚</li><li><code>fs.readSync()</code> æ‰§è¡Œåï¼Œ<code>buffer</code> ä¸­å°±åŒ…å«äº†æ–‡ä»¶çš„å†…å®¹ã€‚<code>bytesRead</code> æ˜¯å®é™…è¯»å–çš„å­—èŠ‚æ•°ï¼Œå¯ä»¥ç”¨æ¥æ£€æŸ¥æ˜¯å¦è¯»å–å®Œæ¯•ã€‚</li><li>æˆ‘ä»¬ä½¿ç”¨ <code>buffer.toString()</code> å°† buffer ä¸­çš„å†…å®¹è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå¹¶æ‰“å°å‡ºæ¥ã€‚</li><li>æœ€åï¼Œä½¿ç”¨ <code>fs.closeSync(fd)</code> å…³é—­æ–‡ä»¶é‡Šæ”¾èµ„æºã€‚</li></ol><p>è¿™å°±æ˜¯ä½¿ç”¨ <code>fs.readSync</code> åœ¨ Node.js ä¸­åŒæ­¥è¯»å–æ–‡ä»¶å†…å®¹çš„åŸºæœ¬æ–¹å¼ã€‚å¸Œæœ›è¿™ä¸ªè§£é‡Šå’Œä¾‹å­èƒ½å¸®åŠ©ä½ ç†è§£å¦‚ä½•ä½¿ç”¨å®ƒã€‚</p><h3 id="fs-readsync-fd-buffer-options" tabindex="-1"><a class="header-anchor" href="#fs-readsync-fd-buffer-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsreadsyncfd-buffer-options" target="_blank" rel="noopener noreferrer">fs.readSync(fd, buffer[, options])</a></span></a></h3><p>Node.js ä¸­çš„<code>fs.readSync(fd, buffer[, options])</code>æ˜¯ä¸€ä¸ªç”¨äºåŒæ­¥è¯»å–æ–‡ä»¶å†…å®¹çš„å‡½æ•°ã€‚ä¸ºäº†æ·±å…¥ç†è§£è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å…ˆè¦é€ä¸€è§£æå®ƒçš„å‚æ•°å’Œå¦‚ä½•ä½¿ç”¨å®ƒï¼Œç„¶åä¸¾å‡ ä¸ªå®ä¾‹æ¥å±•ç¤ºå®ƒåœ¨å®é™…ä¸­çš„åº”ç”¨ã€‚</p><h3 id="å‚æ•°è§£æ-1" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£æ-1"><span>å‚æ•°è§£æ</span></a></h3><ol><li><strong>fd</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå®ƒæ˜¯ä¸€ä¸ªæŒ‡å‘å·²æ‰“å¼€æ–‡ä»¶çš„å¼•ç”¨ç¼–å·ã€‚åœ¨ Node.js ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡<code>fs.openSync()</code>ç­‰æ–¹æ³•è·å¾—è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚</li><li><strong>buffer</strong>ï¼šè¿™æ˜¯ä¸€ä¸ª Buffer æˆ–è€… TypedArray å¯¹è±¡ï¼Œå®ƒç”¨æ¥æ¥æ”¶ä»æ–‡ä»¶ä¸­è¯»å–çš„æ•°æ®ã€‚</li><li><strong>options</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…è®¸ä½ æŒ‡å®šè¯»å–æ“ä½œçš„ç»†èŠ‚ï¼Œå¦‚èµ·å§‹ä½ç½®ã€è¯»å–çš„å­—èŠ‚æ•°ä»¥åŠæ–‡ä»¶ä½¿ç”¨çš„ç¼–ç ã€‚æ­¤å‚æ•°åŒ…å«ä¸‰ä¸ªä¸»è¦å±æ€§ï¼š <ul><li><code>position</code>ï¼šæ–‡ä»¶ä¸­å¼€å§‹è¯»å–æ•°æ®çš„ä½ç½®ã€‚å¦‚æœè®¾ç½®ä¸º nullï¼Œå°†ä»å½“å‰æ–‡ä»¶ä½ç½®å¼€å§‹è¯»å–ã€‚</li><li><code>length</code>ï¼šè¦ä»æ–‡ä»¶ä¸­è¯»å–çš„å­—èŠ‚æ•°ã€‚</li><li><code>encoding</code>ï¼šè¯»å–åˆ°çš„æ•°æ®çš„ç¼–ç ã€‚å¦‚æœæœªæŒ‡å®šï¼Œè¿”å›çš„æ•°æ®å°†æ˜¯ Buffer å¯¹è±¡ã€‚</li></ul></li></ol><h3 id="åŸºæœ¬ç”¨æ³•-4" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç”¨æ³•-4"><span>åŸºæœ¬ç”¨æ³•</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">1024</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º1024å­—èŠ‚çš„Buffer</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åŒæ­¥è¯»å–æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> length</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 100</span><span style="color:#ECEFF4;">,</span><span style="color:#88C0D0;"> position</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-9" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-9"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><h4 id="ä¾‹å­-1-è¯»å–é…ç½®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-è¯»å–é…ç½®æ–‡ä»¶"><span>ä¾‹å­ 1ï¼šè¯»å–é…ç½®æ–‡ä»¶</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªç®€å•çš„æ–‡æœ¬é…ç½®æ–‡ä»¶<code>config.txt</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>maxConnections=5</span></span>
<span class="line"><span>timeout=100</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ å¯ä»¥ä½¿ç”¨<code>fs.readSync</code>æ¥è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶æå–å‡ºé…ç½®é¡¹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡†å¤‡Bufferå’Œæ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> configPath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">__dirname</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">config.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">configPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">1024</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è¯»å–é…ç½®æ–‡ä»¶çš„å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">length</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> content</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è§£æé…ç½®</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> configLines</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> content</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">split</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">filter</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">Boolean</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> config</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> {}</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">for</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> line</span><span style="color:#81A1C1;"> of</span><span style="color:#D8DEE9;"> configLines</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#ECEFF4;"> [</span><span style="color:#D8DEE9;">key</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> value</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> line</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">split</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">=</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  config</span><span style="color:#D8DEE9FF;">[</span><span style="color:#D8DEE9;">key</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">trim</span><span style="color:#D8DEE9FF;">()] </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9;"> value</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">trim</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">config</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è®°å¾—å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä¾‹å­-2-å¤‡ä»½å°å‹æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-å¤‡ä»½å°å‹æ–‡ä»¶"><span>ä¾‹å­ 2ï¼šå¤‡ä»½å°å‹æ–‡ä»¶</span></a></h4><p>å‡è®¾ä½ éœ€è¦å¤‡ä»½ä¸€å¼ å›¾ç‰‡ï¼Œè¿™å¯èƒ½æ„å‘³ç€ä»æºæ–‡ä»¶ä¸­è¯»å–æ‰€æœ‰å†…å®¹ï¼Œç„¶åå†™å…¥åˆ°æ–°æ–‡ä»¶ä¸­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€åŸå›¾ç‰‡å’Œå¤‡ä»½å›¾ç‰‡çš„æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> originalFd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">photo.jpg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> backupFd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">photo_backup.jpg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">1024</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> null;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">while</span><span style="color:#D8DEE9FF;"> (</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  (</span><span style="color:#D8DEE9;">bytesRead</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">originalFd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">length</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> null</span><span style="color:#D8DEE9FF;">)) </span><span style="color:#81A1C1;">&gt;</span><span style="color:#B48EAD;"> 0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">backupFd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å…³é—­ä¸¤ä¸ªæ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">originalFd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">backupFd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Backup complete.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™äº›ä¾‹å­ä¸­ï¼Œ<code>fs.readSync</code>è¢«ç”¨æ¥ä»æ–‡ä»¶ä¸­åŒæ­¥åœ°è¯»å–æ•°æ®ã€‚è¿™å¯¹äºå¤„ç†é…ç½®æ–‡ä»¶ã€è¿›è¡Œç®€å•çš„æ–‡ä»¶è½¬ç§»æˆ–å¤‡ä»½ç­‰ä»»åŠ¡ç‰¹åˆ«æœ‰ç”¨ã€‚ç„¶è€Œï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨å¤„ç†éå¸¸å¤§çš„æ–‡ä»¶æˆ–é«˜æ€§èƒ½è¦æ±‚çš„åº”ç”¨æ—¶ï¼Œè€ƒè™‘åˆ° Node.js çš„äº‹ä»¶é©±åŠ¨å’Œéé˜»å¡ I/O çš„ç‰¹ç‚¹ï¼Œå¼‚æ­¥ç‰ˆæœ¬<code>fs.read</code>æˆ–æµå¼å¤„ç†ï¼ˆå¦‚<code>fs.createReadStream</code>ï¼‰é€šå¸¸æ›´ä¸ºåˆé€‚ã€‚</p><h3 id="fs-readvsync-fd-buffers-position" tabindex="-1"><a class="header-anchor" href="#fs-readvsync-fd-buffers-position"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsreadvsyncfd-buffers-position" target="_blank" rel="noopener noreferrer">fs.readvSync(fd, buffers[, position])</a></span></a></h3><p>Node.js çš„ <code>fs.readvSync</code> å‡½æ•°æ˜¯æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—ä¸­çš„ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œå®ƒç”¨äºä»æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆfdï¼‰è¯»å–æ•°æ®åˆ°ä¸€ç»„ Buffer å¯¹è±¡ï¼ˆå³æ•°ç»„ä¸­çš„ buffersï¼‰ã€‚è¿™ä¸€ç»„ Buffer å°±åƒæ˜¯æ•°æ®å®¹å™¨ï¼Œå¯ä»¥å­˜å‚¨æ¥è‡ªæ–‡ä»¶çš„æ•°æ®ã€‚åŒæ­¥æ–¹æ³•æ„å‘³ç€ç¨‹åºä¼šåœ¨è¯»å–æ“ä½œå®Œæˆä¹‹å‰æš‚åœæ‰§è¡Œåç»­çš„ä»£ç ã€‚</p><p>è®©æˆ‘ä»¬è¯¦ç»†æ¢è®¨ä¸€ä¸‹ <code>fs.readvSync</code> æ–¹æ³•çš„å‚æ•°å’Œå…¶å®é™…åº”ç”¨ï¼š</p><ul><li><strong>fd</strong>ï¼šè¿™æ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼Œä¸€ä¸ªæ•°å­—ï¼Œä»£è¡¨äº†æ‰“å¼€çš„æ–‡ä»¶ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>fs.openSync()</code> æ–¹æ³•è·å¾—æ–‡ä»¶æè¿°ç¬¦ã€‚</li><li><strong>buffers</strong>ï¼šè¿™æ˜¯ä¸€ä¸ª Buffer æˆ–è€… TypedArray å¯¹è±¡çš„æ•°ç»„ï¼Œå®ƒä»¬ä¼šæŒ‰é¡ºåºè¢«å¡«å……æ•°æ®ã€‚æ¯ä¸ª Buffer æˆ– TypedArray å°†ä¼šå­˜å‚¨æ–‡ä»¶ä¸­çš„ä¸€éƒ¨åˆ†æ•°æ®ã€‚</li><li><strong>position</strong>ï¼šè¿™æ˜¯å¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºä»æ–‡ä»¶çš„å“ªä¸ªä½ç½®å¼€å§‹è¯»å–ã€‚å¦‚æœçœç•¥æ­¤å‚æ•°æˆ–è€…è®¾ç½®ä¸º nullï¼Œåˆ™ä»å½“å‰æ–‡ä»¶æŒ‡é’ˆçš„ä½ç½®è¯»å–ã€‚</li></ul><p>å…·ä½“ä¾‹å­ï¼š</p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«æ–‡æœ¬å†…å®¹çš„æ–‡ä»¶ &quot;example.txt&quot;ï¼Œå¹¶ä¸”æˆ‘ä»¬æƒ³è¦å°†æ–‡ä»¶çš„ä¸åŒéƒ¨åˆ†åˆ†åˆ«è¯»å–åˆ°ä¸¤ä¸ª Buffer ä¸­ã€‚</p><ol><li>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»º Buffer å¯¹è±¡ï¼Œå¹¶æ‰“å¼€æ–‡ä»¶è·å–æ–‡ä»¶æè¿°ç¬¦ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸¤ä¸ª Buffer å®ä¾‹ï¼Œæ¯ä¸ªå¤§å°ä¸º 10 å­—èŠ‚</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> buffer1</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">10</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> buffer2</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">10</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶è·å–æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨ <code>fs.readvSync</code> æ¥è¯»å–æ–‡ä»¶å†…å®¹åˆ° Buffer æ•°ç»„ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨ readvSync åŒæ­¥æ–¹å¼è¯»å–æ–‡ä»¶å†…å®¹åˆ° buffer1 å’Œ buffer2</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readvSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#D8DEE9;">buffer1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer2</span><span style="color:#D8DEE9FF;">])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // è¾“å‡º Buffer å†…å®¹åˆ°æ§åˆ¶å°</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffer1</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ˜¾ç¤º buffer1 ä¸­çš„å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffer2</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ˜¾ç¤º buffer2 ä¸­çš„å†…å®¹</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // ä¸è®ºæ“ä½œæˆåŠŸè¿˜æ˜¯å‡ºç°å¼‚å¸¸ï¼Œéƒ½ç¡®ä¿å…³é—­æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œå½“æˆ‘ä»¬è°ƒç”¨ <code>fs.readvSync</code> æ–¹æ³•æ—¶ï¼ŒNode.js ä¼šä» &quot;example.txt&quot; æ–‡ä»¶çš„èµ·å§‹ä½ç½®å¼€å§‹è¯»å–æ•°æ®ï¼Œé¦–å…ˆå¡«æ»¡ <code>buffer1</code>ï¼Œç„¶åæ˜¯ <code>buffer2</code>ã€‚æ¯ä¸ª Buffer éƒ½ä¼šè¢«å¡«æ»¡è‡³æœ€å¤§é•¿åº¦ï¼ˆåœ¨æœ¬ä¾‹ä¸­æ˜¯ 10 å­—èŠ‚ï¼‰ï¼Œé™¤éæ–‡ä»¶çš„å‰©ä½™æ•°æ®ä¸è¶³ä»¥å¡«æ»¡ Bufferï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒBuffer ä¼šåŒ…å«æ–‡ä»¶ç»“æŸä¹‹å‰çš„æ•°æ®ã€‚</p><p>æ³¨æ„ï¼Œåœ¨å¤„ç†æ–‡ä»¶æ—¶ï¼Œä¸€å®šè¦å°å¿ƒç¡®ä¿åœ¨æ“ä½œå®Œæˆåå…³é—­æ–‡ä»¶æè¿°ç¬¦ï¼ˆå³ä½¿åœ¨å‘ç”Ÿé”™è¯¯æ—¶ï¼‰ï¼Œè¿™æ ·å¯ä»¥é¿å…èµ„æºæ³„éœ²å’Œå…¶ä»–æ½œåœ¨é—®é¢˜ã€‚åœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>try...finally</code> ç»“æ„æ¥ä¿è¯æ–‡ä»¶æè¿°ç¬¦åœ¨æ“ä½œç»“æŸåè¢«å…³é—­ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>fs.readvSync</code> æ˜¯ Node.js ä¸­ç”¨äºä»æ–‡ä»¶åŒæ­¥è¯»å–æ•°æ®è‡³å¤šä¸ª Buffer å¯¹è±¡çš„æ–¹æ³•ï¼Œå®ƒå…è®¸ä½ å°†æ–‡ä»¶çš„æ•°æ®åˆ†å—è¯»å–å¹¶å­˜å‚¨äºå†…å­˜ä¸­ï¼Œè¿™å¯¹äºå¤„ç†å¤§å‹æ–‡ä»¶æˆ–è€…éœ€è¦å°†æ–‡ä»¶å†…å®¹è¯»å–åˆ°ç‰¹å®šæ•°æ®ç»“æ„ä¸­çš„åœºæ™¯ç‰¹åˆ«æœ‰ç”¨ã€‚</p><h3 id="fs-realpathsync-path-options" tabindex="-1"><a class="header-anchor" href="#fs-realpathsync-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsrealpathsyncpath-options" target="_blank" rel="noopener noreferrer">fs.realpathSync(path[, options])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥æ·±å…¥ç†è§£ <code>fs.realpathSync(path[, options])</code> è¿™ä¸ªæ–¹æ³•åœ¨ Node.js ä¸­çš„ä½œç”¨å’Œå®é™…åº”ç”¨åœºæ™¯ã€‚è¿™ä¸ªæ–¹æ³•å±äº Node.js çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>ï¼‰æ¨¡å—ï¼Œå®ƒè¢«ç”¨æ¥åŒæ­¥åœ°å°†ç›¸å¯¹è·¯å¾„æˆ–è€…é“¾æ¥ï¼ˆæ¯”å¦‚ç¬¦å·é“¾æ¥ï¼‰è½¬æ¢ä¸ºç»å¯¹è·¯å¾„ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ä¸€ç‚¹ç‚¹åˆ†è§£ä¸Šè¿°æè¿°ï¼š</p><ul><li><strong>åŒæ­¥</strong>ï¼šæŒ‡çš„æ˜¯ä»£ç ä¼šæŒ‰é¡ºåºæ‰§è¡Œï¼Œè°ƒç”¨æ­¤æ–¹æ³•æ—¶ï¼Œç¨‹åºä¼šç­‰å¾…å®ƒå®Œæˆåæ‰ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚</li><li><strong>ç›¸å¯¹è·¯å¾„</strong>ï¼šæ˜¯ç›¸å¯¹äºå½“å‰å·¥ä½œç›®å½•çš„è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„å·¥ä½œç›®å½•æ˜¯ <code>/Users/yourname/projects</code>ï¼Œé‚£ä¹ˆç›¸å¯¹è·¯å¾„ <code>./project1</code> å°†æŒ‡å‘ <code>/Users/yourname/projects/project1</code>ã€‚</li><li><strong>é“¾æ¥ï¼ˆç¬¦å·é“¾æ¥ï¼‰</strong>ï¼šå¯ä»¥æƒ³è±¡æˆæ˜¯ä¸€ä¸ªå¿«æ·æ–¹å¼ï¼Œå®ƒæ˜¯ä¸€ä¸ªæŒ‡å‘å¦ä¸€ä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„å¼•ç”¨ã€‚</li><li><strong>ç»å¯¹è·¯å¾„</strong>ï¼šæ˜¯ä»æ ¹ç›®å½•å¼€å§‹çš„å®Œæ•´è·¯å¾„ï¼Œä¸ç®¡ä½ ç°åœ¨å¤„äºæ–‡ä»¶ç³»ç»Ÿçš„å“ªä¸ªä½ç½®ï¼Œç»å¯¹è·¯å¾„æ€»æ˜¯æŒ‡å‘åŒä¸€ä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-5"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><h4 id="_1-è¯»å–æ–‡ä»¶å†…å®¹-2" tabindex="-1"><a class="header-anchor" href="#_1-è¯»å–æ–‡ä»¶å†…å®¹-2"><span>1. è¯»å–æ–‡ä»¶å†…å®¹</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œéœ€è¦è¯»å–ä¸€ä¸ªé…ç½®æ–‡ä»¶çš„å†…å®¹ã€‚è¿™ä¸ªé…ç½®æ–‡ä»¶ä½äºé¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ï¼Œä½†æ˜¯ä½ çš„ä»£ç è¿è¡Œåœ¨ä¸€ä¸ªåµŒå¥—çš„ç›®å½•ä¸­ã€‚è¿™æ—¶ä½¿ç”¨ <code>fs.realpathSync()</code> å¯ä»¥å¸®åŠ©ä½ å¾—åˆ°é…ç½®æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚</p><p>æ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>project/</span></span>
<span class="line"><span>â”‚</span></span>
<span class="line"><span>â”œâ”€â”€ config/</span></span>
<span class="line"><span>â”‚   â””â”€â”€ appConfig.json</span></span>
<span class="line"><span>â”‚</span></span>
<span class="line"><span>â””â”€â”€ src/</span></span>
<span class="line"><span>    â””â”€â”€ modules/</span></span>
<span class="line"><span>        â””â”€â”€ moduleA/</span></span>
<span class="line"><span>            â””â”€â”€ example.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>example.js</code> æ–‡ä»¶ä¸­çš„ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾ä½ ä¸ç¡®å®šå…·ä½“çš„ç»å¯¹è·¯å¾„ï¼ŒåªçŸ¥é“ç›¸å¯¹äºé¡¹ç›®æ ¹ç›®å½•çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> relativePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">../../../config/appConfig.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// Convert it to an absolute path</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> absolutePath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">realpathSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">relativePath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç°åœ¨ä½ å¯ä»¥å®‰å…¨åœ°ä½¿ç”¨ç»å¯¹è·¯å¾„æ¥è¯»å–æ–‡ä»¶å†…å®¹äº†</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> configContent</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">absolutePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">configContent</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•é€šè¿‡ <code>fs.realpathSync()</code> æ–¹æ³•å°†ç›¸å¯¹è·¯å¾„è½¬åŒ–ä¸ºç»å¯¹è·¯å¾„ï¼Œä»¥ä¾¿äºåœ¨ä¸åŒçš„å·¥ä½œç›®å½•ä¸‹å®‰å…¨åœ°è®¿é—®æ–‡ä»¶ã€‚</p><h4 id="_2-è§£æç¬¦å·é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#_2-è§£æç¬¦å·é“¾æ¥"><span>2. è§£æç¬¦å·é“¾æ¥</span></a></h4><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¼šä½¿ç”¨ç¬¦å·é“¾æ¥æ¥å¼•ç”¨æ–‡ä»¶æˆ–ç›®å½•ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦åˆ›å»ºå¤æ‚é¡¹ç›®ç»“æ„æ—¶ã€‚<code>fs.realpathSync()</code> åœ¨è¿™é‡Œä¹Ÿèƒ½æ´¾ä¸Šç”¨åœºï¼Œå› ä¸ºå®ƒèƒ½è§£æç¬¦å·é“¾æ¥ï¼Œå¹¶ç»™å‡ºæ‰€æŒ‡å‘çš„åŸå§‹æ–‡ä»¶æˆ–ç›®å½•çš„ç»å¯¹è·¯å¾„ã€‚</p><p>æ¯”å¦‚ï¼Œå‡è®¾ä½ æœ‰ä¸€ä¸ªæŒ‡å‘æ—¥å¿—æ–‡ä»¶å¤¹çš„ç¬¦å·é“¾æ¥ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>project/</span></span>
<span class="line"><span>â”‚</span></span>
<span class="line"><span>â”œâ”€â”€ data/</span></span>
<span class="line"><span>â”‚   â””â”€â”€ logs -&gt; /var/log/myapp/</span></span>
<span class="line"><span>â”‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ å¯ä»¥è¿™æ ·è·å–æ—¥å¿—æ–‡ä»¶å¤¹çš„å®é™…è·¯å¾„ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç¬¦å·é“¾æ¥çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> symlinkPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./data/logs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è·å–çœŸå®è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> actualPath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">realpathSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">symlinkPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">actualPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: /var/log/myapp</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå³ä½¿æ–‡ä»¶ç»“æ„å˜åŠ¨ï¼Œåªè¦ç¬¦å·é“¾æ¥æ˜¯æ­£ç¡®çš„ï¼Œä½ å°±èƒ½å‡†ç¡®åœ°è®¿é—®åˆ°éœ€è¦çš„èµ„æºã€‚</p><h3 id="æ€»ç»“-12" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-12"><span>æ€»ç»“</span></a></h3><p><code>fs.realpathSync(path[, options])</code> æ˜¯ Node.js ä¸­ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ–¹æ³•ï¼Œå®ƒèƒ½å°†ç›¸å¯¹è·¯å¾„æˆ–ç¬¦å·é“¾æ¥è§£ææˆç»å¯¹è·¯å¾„ã€‚è¿™åœ¨å¤„ç†å¤æ‚æ–‡ä»¶ç»“æ„ã€è·¨ç›®å½•è®¿é—®æ–‡ä»¶æˆ–è§£æé“¾æ¥æ—¶å°¤å…¶æœ‰ç”¨ï¼Œå¯ä»¥å¢å¼ºä»£ç çš„å¯ç§»æ¤æ€§å’Œå¥å£®æ€§ã€‚</p><h3 id="fs-realpathsync-native-path-options" tabindex="-1"><a class="header-anchor" href="#fs-realpathsync-native-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsrealpathsyncnativepath-options" target="_blank" rel="noopener noreferrer">fs.realpathSync.native(path[, options])</a></span></a></h3><p><code>fs.realpathSync.native</code>æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>ï¼‰æ¨¡å—åŠŸèƒ½ï¼Œå®ƒç”¨äºåŒæ­¥è§£æï¼ˆå³ç«‹å³å®Œæˆï¼Œä¸ç­‰å¾…å…¶ä»–æ“ä½œå®Œæˆï¼‰æä¾›çš„è·¯å¾„åˆ°å…¶ç»å¯¹è·¯å¾„ã€‚è¿™ä¸ªæ–¹æ³•çš„<code>.native</code>éƒ¨åˆ†æŒ‡çš„æ˜¯å®ƒä½¿ç”¨äº†åº•å±‚æ“ä½œç³»ç»Ÿçš„æœ¬æœºæ–¹æ³•æ¥è§£æè·¯å¾„ï¼Œè¿™é€šå¸¸æ„å‘³ç€æ›´å¥½çš„æ€§èƒ½å’Œæ›´å‡†ç¡®åœ°ç¬¦åˆæ“ä½œç³»ç»Ÿçš„é¢„æœŸè¡Œä¸ºã€‚</p><h3 id="å‚æ•°è§£é‡Š-28" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-28"><span>å‚æ•°è§£é‡Š</span></a></h3><ol><li><strong>path</strong>: è¿™æ˜¯ä½ å¸Œæœ›è½¬æ¢æˆç»å¯¹è·¯å¾„çš„ç›®æ ‡è·¯å¾„å­—ç¬¦ä¸²ã€‚</li><li><strong>options</strong>: å¯é€‰å‚æ•°ï¼Œå…è®¸ä½ æŒ‡å®šå¦‚ä½•å°†ç»“æœå­—ç¬¦ä¸²ç¼–ç ã€‚æ¯”å¦‚<code>{encoding: &#39;utf8&#39;}</code>ã€‚</li></ol><h3 id="åŸºæœ¬ç”¨æ³•-5" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç”¨æ³•-5"><span>åŸºæœ¬ç”¨æ³•</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾å½“å‰å·¥ä½œç›®å½•ä¸º/home/user/projectï¼Œå¹¶ä¸”å­˜åœ¨ä¸€ä¸ªç›¸å¯¹è·¯å¾„../otherProject</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> absolutePath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">realpathSync</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">native</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">../otherProject</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">absolutePath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// è¾“å‡ºå¯èƒ½æ˜¯ /home/user/otherProjectï¼Œå–å†³äºå…·ä½“çš„æ–‡ä»¶ç³»ç»Ÿç»“æ„</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ç»™<code>fs.realpathSync.native</code>æ–¹æ³•ä¼ é€’ä¸€ä¸ªç›¸å¯¹è·¯å¾„<code>../otherProject</code>ï¼Œå¾—åˆ°äº†è¿™ä¸ªè·¯å¾„çš„ç»å¯¹å½¢å¼ã€‚å¦‚æœä½ åœ¨ä¸åŒçš„ç›®å½•æ‰§è¡Œè¿™æ®µä»£ç ï¼Œè¾“å‡ºçš„ç»å¯¹è·¯å¾„ä¼šéšä¹‹æ”¹å˜ï¼Œå› ä¸ºå®ƒä¾èµ–äºå½“å‰çš„å·¥ä½œç›®å½•ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-6" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-6"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><h4 id="_1-è§£æç”¨æˆ·è¾“å…¥çš„è·¯å¾„" tabindex="-1"><a class="header-anchor" href="#_1-è§£æç”¨æˆ·è¾“å…¥çš„è·¯å¾„"><span>1. è§£æç”¨æˆ·è¾“å…¥çš„è·¯å¾„</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œéœ€è¦ç”¨æˆ·æä¾›ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚ç”¨æˆ·æœ‰å¯èƒ½æä¾›ç›¸å¯¹è·¯å¾„ï¼Œä½¿ç”¨<code>fs.realpathSync.native</code>å¯ä»¥å¸®åŠ©ä½ å¾—åˆ°è¿™ä¸ªè·¯å¾„çš„ç»å¯¹ç‰ˆæœ¬ï¼Œä½¿åç»­çš„æ–‡ä»¶æ“ä½œæ›´åŠ ç¨³å®šå¯é ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> pathInput</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> process</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">argv</span><span style="color:#D8DEE9FF;">[</span><span style="color:#B48EAD;">2</span><span style="color:#D8DEE9FF;">]</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // ç”¨æˆ·é€šè¿‡å‘½ä»¤è¡Œè¾“å…¥çš„è·¯å¾„</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> resolvedPath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">realpathSync</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">native</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">pathInput</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Resolved Path: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">resolvedPath</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error resolving the path:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-æ£€æŸ¥è½¯é“¾æ¥çš„å®é™…ä½ç½®" tabindex="-1"><a class="header-anchor" href="#_2-æ£€æŸ¥è½¯é“¾æ¥çš„å®é™…ä½ç½®"><span>2. æ£€æŸ¥è½¯é“¾æ¥çš„å®é™…ä½ç½®</span></a></h4><p>åœ¨ Unix-like ç³»ç»Ÿä¸­ï¼Œ&quot;è½¯é“¾æ¥&quot;æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ–‡ä»¶ï¼ŒæŒ‡å‘å¦ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•ã€‚ä½¿ç”¨<code>fs.realpathSync.native</code>å¯ä»¥æ‰¾å‡ºè½¯é“¾æ¥æŒ‡å‘çš„å®é™…ç‰©ç†ä½ç½®ï¼Œè¿™å¯¹äºè·Ÿè¸ªé…ç½®æ–‡ä»¶ã€æ—¥å¿—ç­‰å¾ˆæœ‰ç”¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾log-linkæ˜¯æŒ‡å‘/var/log/app.logçš„è½¯é“¾æ¥</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> realPath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">realpathSync</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">native</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/log-link</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">realPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// è¾“å‡ºå¯èƒ½æ˜¯ /var/log/app.log</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>fs.realpathSync.native</code>å¸®æˆ‘ä»¬æ‰¾å‡ºäº†è½¯é“¾æ¥<code>/path/to/log-link</code>çœŸæ­£æŒ‡å‘çš„æ–‡ä»¶è·¯å¾„ã€‚</p><h3 id="æ€»ç»“-13" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-13"><span>æ€»ç»“</span></a></h3><p>ä½¿ç”¨<code>fs.realpathSync.native</code>å¯ä»¥æ–¹ä¾¿åœ°å°†ä»»ä½•è·¯å¾„ï¼ˆæ— è®ºæ˜¯ç›¸å¯¹çš„è¿˜æ˜¯è½¯é“¾æ¥ï¼‰è§£æä¸ºå…¶ç»å¯¹å½¢å¼ã€‚è¿™åœ¨å¤„ç†æ–‡ä»¶å’Œç›®å½•æ—¶éå¸¸æœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯å½“ä½ éœ€è¦ç¡®ä¿è·¯å¾„çš„æœ‰æ•ˆæ€§å’Œå‡†ç¡®æ€§æ—¶ã€‚ç”±äºå®ƒæ˜¯åŒæ­¥çš„ï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°ä¼šç«‹å³è¿”å›ç»“æœï¼Œä½†ä¹Ÿæ„å‘¸ç€åœ¨æ‰§è¡Œå¤§é‡ I/O æ“ä½œæ—¶å¯èƒ½ä¼šé˜»å¡ä¸»çº¿ç¨‹ã€‚åœ¨æ€§èƒ½æ•æ„Ÿçš„åº”ç”¨ä¸­ï¼Œè¯·è€ƒè™‘ä½¿ç”¨å…¶å¼‚æ­¥ç‰ˆæœ¬<code>fs.realpath.native</code>ä»¥é¿å…æ½œåœ¨çš„æ€§èƒ½é—®é¢˜ã€‚</p><h3 id="fs-renamesync-oldpath-newpath" tabindex="-1"><a class="header-anchor" href="#fs-renamesync-oldpath-newpath"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsrenamesyncoldpath-newpath" target="_blank" rel="noopener noreferrer">fs.renameSync(oldPath, newPath)</a></span></a></h3><p>Node.js çš„<code>fs.renameSync(oldPath, newPath)</code>æ–¹æ³•ç”¨äºåŒæ­¥åœ°æ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„åç§°ã€‚è¿™æ„å‘³ç€å½“ä½ è°ƒç”¨è¿™ä¸ªæ–¹æ³•åï¼Œå®ƒä¼šç«‹å³æ‰§è¡Œé‡å‘½åæ“ä½œï¼Œå¹¶ä¸”åªæœ‰åœ¨æ“ä½œå®Œæˆåä»£ç æ‰ä¼šç»§ç»­æ‰§è¡Œã€‚ä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œä½ éœ€è¦æä¾›ä¸¤ä¸ªå‚æ•°ï¼š<code>oldPath</code>ï¼ˆæ—§è·¯å¾„/åç§°ï¼‰å’Œ<code>newPath</code>ï¼ˆæ–°è·¯å¾„/åç§°ï¼‰ã€‚è®©æˆ‘ä»¬é€šè¿‡å‡ ä¸ªä¾‹å­æ¥è¯¦ç»†äº†è§£å®ƒçš„åº”ç”¨ã€‚</p><h3 id="_1-æ›´æ”¹æ–‡ä»¶å" tabindex="-1"><a class="header-anchor" href="#_1-æ›´æ”¹æ–‡ä»¶å"><span>1. æ›´æ”¹æ–‡ä»¶å</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º<code>example.txt</code>çš„æ–‡æœ¬æ–‡ä»¶ï¼Œç°åœ¨ä½ æƒ³å°†å…¶åç§°æ›´æ”¹ä¸º<code>renamed_example.txt</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®šä¹‰åŸå§‹æ–‡ä»¶åå’Œæ–°æ–‡ä»¶å</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> oldPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> newPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./renamed_example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // å°è¯•é‡å‘½åæ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">renameSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">oldPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> newPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶é‡å‘½åæˆåŠŸã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">  // å¦‚æœè¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">é‡å‘½åè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-ç§»åŠ¨æ–‡ä»¶åˆ°å¦ä¸€ä¸ªç›®å½•" tabindex="-1"><a class="header-anchor" href="#_2-ç§»åŠ¨æ–‡ä»¶åˆ°å¦ä¸€ä¸ªç›®å½•"><span>2. ç§»åŠ¨æ–‡ä»¶åˆ°å¦ä¸€ä¸ªç›®å½•</span></a></h3><p><code>fs.renameSync</code>ä¸ä»…å¯ä»¥é‡å‘½åæ–‡ä»¶ï¼Œè¿˜å¯ä»¥å°†æ–‡ä»¶ä»ä¸€ä¸ªç›®å½•ç§»åŠ¨åˆ°å¦ä¸€ä¸ªç›®å½•ã€‚ä¾‹å¦‚ï¼Œä½ æƒ³å°†<code>renamed_example.txt</code>ä»å½“å‰ç›®å½•ç§»åŠ¨åˆ°åä¸º<code>new_folder</code>çš„ç›®å½•ä¸­ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®šä¹‰åŸå§‹ä½ç½®å’Œç›®æ ‡ä½ç½®</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> oldPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./renamed_example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> newPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./new_folder/renamed_example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // å°è¯•ç§»åŠ¨æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">renameSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">oldPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> newPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶ç§»åŠ¨æˆåŠŸã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">  // å¦‚æœè¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç§»åŠ¨æ–‡ä»¶è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-æ›´æ”¹ç›®å½•å" tabindex="-1"><a class="header-anchor" href="#_3-æ›´æ”¹ç›®å½•å"><span>3. æ›´æ”¹ç›®å½•å</span></a></h3><p><code>fs.renameSync</code>ä¹Ÿå¯ä»¥ç”¨æ¥æ›´æ”¹ç›®å½•çš„åç§°ã€‚æ¯”å¦‚ï¼Œæœ‰ä¸€ä¸ªåä¸º<code>old_folder</code>çš„ç›®å½•ï¼Œä½ æƒ³å°†å…¶åç§°æ›´æ”¹ä¸º<code>new_folder</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®šä¹‰åŸå§‹ç›®å½•åå’Œæ–°ç›®å½•å</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> oldPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./old_folder</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> newPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./new_folder</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // å°è¯•é‡å‘½åç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">renameSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">oldPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> newPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•é‡å‘½åæˆåŠŸã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">  // å¦‚æœè¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">é‡å‘½åç›®å½•è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ³¨æ„äº‹é¡¹-20" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-20"><span>æ³¨æ„äº‹é¡¹ï¼š</span></a></h3><ul><li>ç¡®ä¿åœ¨è°ƒç”¨<code>fs.renameSync</code>ä¹‹å‰ï¼Œ<code>newPath</code>æ‰€æŒ‡å‘çš„ä½ç½®ä¸å­˜åœ¨æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ“ä½œå¤±è´¥ã€‚</li><li>åœ¨ä½¿ç”¨<code>fs.renameSync</code>è¿›è¡Œæ–‡ä»¶æˆ–ç›®å½•æ“ä½œæ—¶ï¼Œç¡®ä¿ä½ æœ‰è¶³å¤Ÿçš„æƒé™æ¥å¯¹æŒ‡å®šçš„æ–‡ä»¶æˆ–ç›®å½•è¿›è¡Œæ›´æ”¹ã€‚</li><li>å› ä¸º<code>fs.renameSync</code>æ˜¯ä¸€ä¸ªåŒæ­¥æ“ä½œï¼Œå¦‚æœå¤„ç†å¤§é‡æ•°æ®æˆ–å¯¹æ€§èƒ½æœ‰è¾ƒé«˜è¦æ±‚çš„åœºæ™¯ä¸‹ï¼Œå¯èƒ½ä¼šé˜»å¡ä¸»çº¿ç¨‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å¼‚æ­¥ç‰ˆæœ¬<code>fs.rename</code>ã€‚</li></ul><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ åº”è¯¥å¯¹å¦‚ä½•ä½¿ç”¨<code>fs.renameSync</code>æœ‰äº†åŸºæœ¬çš„äº†è§£ï¼Œå®ƒæ˜¯ Node.js ä¸­éå¸¸å®ç”¨çš„ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿæ“ä½œæ–¹æ³•ã€‚</p><h3 id="fs-rmdirsync-path-options" tabindex="-1"><a class="header-anchor" href="#fs-rmdirsync-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsrmdirsyncpath-options" target="_blank" rel="noopener noreferrer">fs.rmdirSync(path[, options])</a></span></a></h3><p><code>fs.rmdirSync(path[, options])</code> æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼ˆfs æ¨¡å—ï¼‰ä¸­çš„ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œç”¨äºåˆ é™¤æŒ‡å®šçš„ç›®å½•ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œæ„å‘³ç€å½“ä½ è°ƒç”¨å®ƒæ—¶ï¼ŒNode.js ä¼šç«‹å³åˆ é™¤ç›®å½•ï¼Œå¹¶é˜»å¡å…¶ä»–ä»£ç çš„æ‰§è¡Œï¼Œç›´åˆ°è¯¥æ“ä½œå®Œæˆã€‚</p><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>path</code>: è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¦åˆ é™¤çš„ç›®å½•çš„è·¯å¾„ã€‚</li><li><code>options</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œç”¨äºæŒ‡å®šä¸€äº›é¢å¤–çš„é…ç½®é€‰é¡¹ã€‚åœ¨ Node.js v21.7.1 ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡è¿™ä¸ªå‚æ•°è®¾ç½® <code>recursive</code> å±æ€§ä¸º <code>true</code> æ¥æŒ‡ç¤ºéœ€è¦é€’å½’åˆ é™¤ç›®å½•åŠå…¶å†…å®¹ã€‚</li></ul><p>å¦‚æœåœ¨åˆ é™¤è¿‡ç¨‹ä¸­é‡åˆ°é”™è¯¯ï¼ˆä¾‹å¦‚ï¼Œç›®å½•ä¸å­˜åœ¨ï¼Œæˆ–è€…æ²¡æœ‰è¶³å¤Ÿçš„æƒé™å»åˆ é™¤ç›®å½•ï¼‰ï¼Œé‚£ä¹ˆ <code>fs.rmdirSync</code> æ–¹æ³•ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚</p><p>ä¸‹é¢ä¸¾å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><h3 id="ç¤ºä¾‹-1-åˆ é™¤ç©ºç›®å½•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åˆ é™¤ç©ºç›®å½•"><span>ç¤ºä¾‹ 1ï¼šåˆ é™¤ç©ºç›®å½•</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // å‡è®¾ &#39;./my-directory&#39; æ˜¯ä¸€ä¸ªç©ºç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rmdirSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./my-directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•å·²è¢«æˆåŠŸåˆ é™¤ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">åˆ é™¤ç›®å½•æ—¶å‘ç”Ÿé”™è¯¯ï¼š</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°è¯•åˆ é™¤å½“å‰å·¥ä½œç›®å½•ä¸‹çš„åä¸º <code>my-directory</code> çš„ç©ºç›®å½•ã€‚å¦‚æœç›®å½•åˆ é™¤æˆåŠŸï¼Œå°±ä¼šè¾“å‡ºæç¤ºä¿¡æ¯ã€‚å¦‚æœå‡ºç°ä»»ä½•é”™è¯¯ï¼Œæ¯”å¦‚ç›®å½•ä¸å­˜åœ¨ï¼Œå°±ä¼šæ•è·å¼‚å¸¸å¹¶è¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="ç¤ºä¾‹-2-é€’å½’åˆ é™¤ç›®å½•åŠå…¶å†…å®¹" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-é€’å½’åˆ é™¤ç›®å½•åŠå…¶å†…å®¹"><span>ç¤ºä¾‹ 2ï¼šé€’å½’åˆ é™¤ç›®å½•åŠå…¶å†…å®¹</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨ { recursive: true } é€‰é¡¹æ¥é€’å½’åˆ é™¤ &#39;my-directory&#39; ç›®å½•åŠå…¶æ‰€æœ‰å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rmdirSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./my-directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> recursive</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•åŠå…¶å†…å®¹å·²è¢«æˆåŠŸåˆ é™¤ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">åˆ é™¤ç›®å½•æ—¶å‘ç”Ÿé”™è¯¯ï¼š</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>{ recursive: true }</code> é€‰é¡¹æ¥åˆ é™¤åä¸º <code>my-directory</code> çš„ç›®å½•ä»¥åŠå®ƒé‡Œé¢çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•ã€‚å¦‚æœç›®å½•å’Œå…¶ä¸­çš„å†…å®¹éƒ½è¢«åˆ é™¤æˆåŠŸï¼Œåˆ™è¾“å‡ºç›¸åº”çš„æç¤ºä¿¡æ¯ï¼Œå¦åˆ™æ•è·å¼‚å¸¸å¹¶è¾“å‡ºé”™è¯¯ã€‚</p><p>è¯·æ³¨æ„ï¼Œä» Node.js v14.0.0 å¼€å§‹ï¼Œå»ºè®®ä½¿ç”¨ <code>fs.rmSync(path[, options])</code> æ¥æ›¿ä»£ <code>fs.rmdirSync(path[, options])</code> ï¼Œå› ä¸º <code>fs.rmSync</code> æä¾›äº†æ›´å¤šçš„é€‰é¡¹å’Œæ›´çµæ´»çš„è¡Œä¸ºï¼Œå°¤å…¶æ˜¯å½“æ¶‰åŠåˆ°åˆ é™¤éç©ºç›®å½•æ—¶ã€‚é€‰é¡¹ <code>{ recursive: true, force: true }</code> å¯ä»¥ç¡®ä¿ç›®å½•åŠå…¶å†…å®¹è¢«å¼ºåˆ¶åˆ é™¤ï¼Œå³ä½¿ç›®å½•ä¸ä¸ºç©ºä¹Ÿä¸€æ ·ã€‚</p><h3 id="fs-rmsync-path-options" tabindex="-1"><a class="header-anchor" href="#fs-rmsync-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsrmsyncpath-options" target="_blank" rel="noopener noreferrer">fs.rmSync(path[, options])</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs.rmSync(path[, options])</code>æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„å‡½æ•°ï¼Œå®ƒå±äº<code>fs</code>æ¨¡å—ï¼ˆå³æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼‰ã€‚è¿™ä¸ªå‡½æ•°çš„ä¸»è¦ä½œç”¨æ˜¯åŒæ­¥åœ°åˆ é™¤æŒ‡å®šçš„æ–‡ä»¶æˆ–ç›®å½•ã€‚&quot;åŒæ­¥&quot;æ„å‘³ç€å½“ä½ è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œç¨‹åºä¼šåœåœ¨é‚£é‡Œï¼Œç›´åˆ°æ–‡ä»¶æˆ–ç›®å½•è¢«åˆ é™¤åæ‰ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç ã€‚è¿™ä¸å¼‚æ­¥æ“ä½œä¸åŒï¼Œå¼‚æ­¥æ“ä½œä¼šç«‹å³ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç ï¼Œä¸ç­‰å¾…åˆ é™¤æ“ä½œå®Œæˆã€‚</p><h3 id="å‚æ•°è§£é‡Š-29" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-29"><span>å‚æ•°è§£é‡Šï¼š</span></a></h3><ul><li><strong>path</strong>: è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¦åˆ é™¤çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><strong>options</strong>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…è®¸ä½ å®šåˆ¶ä¸€äº›é¢å¤–çš„è¡Œä¸ºã€‚æ¯”å¦‚ï¼š <ul><li><code>recursive</code>: å½“è®¾ä¸º<code>true</code>æ—¶ï¼Œå¦‚æœè·¯å¾„æ˜¯ä¸€ä¸ªç›®å½•ï¼Œåˆ™ä¼šé€’å½’åœ°åˆ é™¤ç›®å½•å†…çš„æ‰€æœ‰å†…å®¹ã€‚é»˜è®¤ä¸º<code>false</code>ã€‚</li><li><code>force</code>: å¦‚æœè®¾ä¸º<code>true</code>ï¼Œåˆ™å³ä½¿è·¯å¾„ä¸å­˜åœ¨ä¹Ÿä¸ä¼šæŠ¥é”™ã€‚é»˜è®¤ä¸º<code>false</code>ã€‚</li><li><code>maxRetries</code>: å°è¯•åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•çš„æœ€å¤§æ¬¡æ•°ã€‚è¿™å¯¹å¤„ç†æ–‡ä»¶é”å®šæˆ–æš‚æ—¶æ— æ³•è®¿é—®çš„æƒ…å†µå¾ˆæœ‰ç”¨ã€‚</li><li><code>retryDelay</code>: å°è¯•åˆ é™¤ä¹‹é—´çš„å»¶è¿Ÿæ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚</li></ul></li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-24" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-24"><span>å®é™…è¿ç”¨ä¾‹å­ï¼š</span></a></h3><h4 id="_1-åˆ é™¤å•ä¸ªæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_1-åˆ é™¤å•ä¸ªæ–‡ä»¶"><span>1. åˆ é™¤å•ä¸ªæ–‡ä»¶</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º<code>example.txt</code>çš„æ–‡ä»¶ï¼Œä½ æƒ³åˆ é™¤å®ƒï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rmSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File removed successfully.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error removing the file:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœæ–‡ä»¶å­˜åœ¨ä¸”æˆåŠŸåˆ é™¤ï¼Œå°†ä¼šåœ¨æ§åˆ¶å°çœ‹åˆ°æ¶ˆæ¯â€œFile removed successfullyã€‚â€ï¼›å¦‚æœå‘ç”Ÿé”™è¯¯ï¼ˆæ¯”å¦‚æ–‡ä»¶ä¸å­˜åœ¨ï¼‰ï¼Œåˆ™ä¼šæ•è·åˆ°å¼‚å¸¸å¹¶æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚</p><h4 id="_2-é€’å½’åˆ é™¤ç›®å½•" tabindex="-1"><a class="header-anchor" href="#_2-é€’å½’åˆ é™¤ç›®å½•"><span>2. é€’å½’åˆ é™¤ç›®å½•</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªç›®å½•<code>data</code>ï¼Œé‡Œé¢åŒ…å«äº†å¤šä¸ªæ–‡ä»¶å’Œå­ç›®å½•ï¼Œä½ æƒ³ä¸€æ¬¡æ€§åˆ é™¤æ•´ä¸ªç›®å½•åŠå…¶å†…å®¹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rmSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">data</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> recursive</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Directory removed successfully.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error removing the directory:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è®¾ç½®<code>recursive</code>é€‰é¡¹ä¸º<code>true</code>ï¼Œå¯ä»¥ç¡®ä¿æ•´ä¸ªç›®å½•åŠå…¶å†…éƒ¨çš„æ‰€æœ‰å†…å®¹éƒ½è¢«åˆ é™¤ã€‚åŒæ ·ï¼ŒæˆåŠŸæˆ–å¤±è´¥çš„æ¶ˆæ¯ä¼šç›¸åº”æ˜¾ç¤ºã€‚</p><h3 id="æç¤º" tabindex="-1"><a class="header-anchor" href="#æç¤º"><span>æç¤ºï¼š</span></a></h3><ul><li>ä½¿ç”¨<code>fs.rmSync</code>è¿›è¡Œæ–‡ä»¶æˆ–ç›®å½•çš„åˆ é™¤æ“ä½œæ—¶ï¼Œè¯·è°¨æ…æ“ä½œï¼Œå› ä¸ºä¸€æ—¦åˆ é™¤ï¼Œæ•°æ®å°±æ— æ³•æ¢å¤äº†ã€‚</li><li>å¯¹äºæ¶‰åŠæ–‡ä»¶ç³»ç»Ÿçš„æ“ä½œï¼Œå»ºè®®ä½¿ç”¨<code>try...catch</code>æ¥å¤„ç†å¯èƒ½å‡ºç°çš„å¼‚å¸¸ï¼Œä»¥é¿å…ç¨‹åºå› ä¸ºæœªæ•è·çš„å¼‚å¸¸è€Œå´©æºƒã€‚</li></ul><p>é€šè¿‡ä¸Šé¢çš„ä»‹ç»å’Œä¾‹å­ï¼Œå¸Œæœ›ä½ å¯¹<code>fs.rmSync</code>æœ‰äº†æ›´æ¸…æ™°çš„ç†è§£ï¼</p><h3 id="fs-statsync-path-options" tabindex="-1"><a class="header-anchor" href="#fs-statsync-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsstatsyncpath-options" target="_blank" rel="noopener noreferrer">fs.statSync(path[, options])</a></span></a></h3><p>ç†è§£<code>fs.statSync(path[, options])</code>ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ˜ç™½å‡ ä¸ªå…³é”®æ¦‚å¿µï¼š</p><ol><li><strong>Node.js</strong>: ä¸€ä¸ªèƒ½è®© JavaScript è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¹³å°ï¼Œéå¸¸é€‚åˆç”¨æ¥å¼€å‘é«˜æ€§èƒ½çš„ç½‘ç»œåº”ç”¨ã€‚</li><li><strong>fs æ¨¡å—</strong>: åœ¨ Node.js ä¸­ï¼Œ<code>fs</code>ä»£è¡¨æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒæä¾›äº†æ“ä½œæ–‡ä»¶çš„ APIã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™äº› API æ¥è¯»å–ã€å†™å…¥æ–‡ä»¶ï¼Œä»¥åŠæ‰§è¡Œå…¶ä»–ä¸æ–‡ä»¶ç³»ç»Ÿç›¸å…³çš„æ“ä½œã€‚</li><li><strong>Synchronous(åŒæ­¥)</strong>: åœ¨æ‰§è¡ŒåŒæ­¥æ“ä½œæ—¶ï¼Œä»»åŠ¡æŒ‰é¡ºåºä¾æ¬¡è¿›è¡Œï¼Œæ¯ä¸ªä»»åŠ¡å¼€å§‹å‰å¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªä»»åŠ¡å®Œæˆã€‚</li></ol><h3 id="fs-statsync-path-options-1" tabindex="-1"><a class="header-anchor" href="#fs-statsync-path-options-1"><span>fs.statSync(path[, options])</span></a></h3><p><code>fs.statSync()</code>æ˜¯<code>fs</code>æ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºåŒæ­¥åœ°è·å–æ–‡ä»¶æˆ–ç›®å½•çš„çŠ¶æ€ä¿¡æ¯ã€‚å½“ä½ è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œç¨‹åºä¼šæš‚åœæ‰§è¡Œï¼Œç›´åˆ°æ–‡ä»¶çš„ä¿¡æ¯è¢«è¯»å–å®Œæ¯•ï¼Œç„¶åè¿”å›ä¸€ä¸ªåŒ…å«æ–‡ä»¶çŠ¶æ€çš„å¯¹è±¡ã€‚</p><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>path</code>: å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¦æŸ¥è¯¢çŠ¶æ€çš„æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚</li><li><code>options</code>: å¯é€‰å‚æ•°ï¼Œå…è®¸ä½ å®šåˆ¶æŸäº›æ“ä½œè¡Œä¸ºï¼Œå¦‚é‡‡ç”¨ä¸åŒçš„æ—¶é—´æ ¼å¼ç­‰ã€‚</li></ul><p>è¿”å›å€¼ï¼š</p><p>è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª<code>fs.Stats</code>å¯¹è±¡ï¼ŒåŒ…å«äº†è¯¸å¦‚æ–‡ä»¶å¤§å°ã€åˆ›å»ºæ—¶é—´ã€ä¿®æ”¹æ—¶é—´ç­‰å±æ€§ã€‚</p><p><strong>å®é™…è¿ç”¨ä¾‹å­ï¼š</strong></p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º<code>example.txt</code>çš„æ–‡ä»¶ï¼Œå¹¶æƒ³è·å–å…¶çŠ¶æ€ä¿¡æ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// åŠ è½½fsæ¨¡å—</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // è°ƒç”¨fs.statSync()æ–¹æ³•è·å–æ–‡ä»¶çŠ¶æ€</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // æ‰“å°æ–‡ä»¶çŠ¶æ€å¯¹è±¡</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨statså¯¹è±¡çš„å±æ€§</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶å¤§å°: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">size</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> bytes</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">åˆ›å»ºæ—¶é—´: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">birthtime</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æœ€åä¿®æ”¹æ—¶é—´: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mtime</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">  // å¤„ç†å¯èƒ½å‡ºç°çš„é”™è¯¯</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è·å–æ–‡ä»¶çŠ¶æ€å¤±è´¥:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåŠ è½½äº†<code>fs</code>æ¨¡å—ã€‚ç„¶åä½¿ç”¨<code>fs.statSync()</code>æ–¹æ³•è·å–äº†<code>example.txt</code>æ–‡ä»¶çš„çŠ¶æ€ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨å˜é‡<code>stats</code>ä¸­ã€‚è¯¥å¯¹è±¡åŒ…å«äº†æ–‡ä»¶çš„å„ç§çŠ¶æ€ä¿¡æ¯ï¼Œæ¯”å¦‚å¤§å°(<code>size</code>)ã€åˆ›å»ºæ—¶é—´(<code>birthtime</code>)å’Œæœ€åä¿®æ”¹æ—¶é—´(<code>mtime</code>)ç­‰ã€‚æˆ‘ä»¬é€šè¿‡æ‰“å°è¿™äº›å±æ€§æ¥æŸ¥çœ‹å®ƒä»¬çš„å€¼ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨æˆ–æœ‰å…¶ä»–é”™è¯¯å‘ç”Ÿï¼Œæˆ‘ä»¬é€šè¿‡<code>catch</code>æ•è·é”™è¯¯å¹¶æ‰“å°ã€‚</p><p>ä½¿ç”¨<code>fs.statSync()</code>çš„å¥½å¤„æ˜¯ä»£ç ç®€å•ã€ç›´è§‚ã€‚ä½†ç”±äºå®ƒæ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œæ‰€ä»¥å®ƒä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œç›´åˆ°æ–‡ä»¶çŠ¶æ€è¢«è¯»å–ã€‚åœ¨å¤„ç†å¤§å‹æ–‡ä»¶æˆ–åœ¨é«˜æ€§èƒ½è¦æ±‚çš„åº”ç”¨ä¸­ï¼Œè¿™å¯èƒ½æˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚å› æ­¤ï¼Œåœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæ¨èä½¿ç”¨å¼‚æ­¥ç‰ˆæœ¬<code>fs.stat()</code>ã€‚</p><h3 id="fs-statfssync-path-options" tabindex="-1"><a class="header-anchor" href="#fs-statfssync-path-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsstatfssyncpath-options" target="_blank" rel="noopener noreferrer">fs.statfsSync(path[, options])</a></span></a></h3><p>å½“ä½ å¬åˆ° &quot;Node.js&quot; è¿™ä¸ªåè¯æ—¶ï¼Œå¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªè®© JavaScript è·‘åœ¨æœåŠ¡å™¨ä¸Šçš„è¶…çº§å¼•æ“ã€‚è€Œåœ¨è¿™ä¸ªå¼•æ“ä¸­ï¼Œ<code>fs.statfsSync(path[, options])</code> æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å·¥å…·ï¼Œç”¨äºè·å–å…³äºæ–‡ä»¶ç³»ç»Ÿçš„ä¿¡æ¯ã€‚</p><p>åœ¨ç»†è¯´ <code>fs.statfsSync(path[, options])</code> ä¹‹å‰ï¼Œæˆ‘ä»¬å¾—å…ˆäº†è§£å®ƒæ‰€å±çš„ <code>fs</code> æ¨¡å—ã€‚<code>fs</code> ä»£è¡¨çš„æ˜¯ &quot;file system&quot;ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œå®ƒæä¾›äº†ä¸€å †å‡½æ•°ï¼Œè®©ä½ èƒ½å¤Ÿåœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œæ–‡ä»¶æ“ä½œï¼Œæ¯”å¦‚è¯»å†™æ–‡ä»¶ã€åˆ›å»ºç›®å½•ç­‰ç­‰ã€‚è€Œ <code>fs.statfsSync()</code> å‡½æ•°æ˜¯ç”¨æ¥è·å–æ–‡ä»¶ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯çš„ä¸€ç§æ–¹æ³•ã€‚</p><h3 id="ç†è§£-fs-statfssync" tabindex="-1"><a class="header-anchor" href="#ç†è§£-fs-statfssync"><span>ç†è§£ fs.statfsSync()</span></a></h3><p><code>fs.statfsSync()</code> æ˜¯ä¸€ä¸ªåŒæ­¥å‡½æ•°ï¼Œæ„å‘³ç€å½“ Node.js æ‰§è¡Œåˆ°è¿™ä¸ªå‡½æ•°æ—¶ï¼Œå®ƒä¼šåœä¸‹æ¥ç­‰å¾…è¿™ä¸ªå‡½æ•°æ‰§è¡Œå®Œæˆå¹¶è¿”å›ç»“æœï¼Œç„¶åæ‰ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚è¿™ä¸å¼‚æ­¥å‡½æ•°ä¸åŒï¼Œå¼‚æ­¥å‡½æ•°ä¼šç«‹å³è¿”å›ï¼Œå…è®¸ä»£ç ç»§ç»­æ‰§è¡Œï¼Œè€Œä¸å¿…ç­‰å¾…ã€‚</p><h4 id="å‚æ•°-10" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-10"><span>å‚æ•°</span></a></h4><ul><li><code>path</code>: è¡¨ç¤ºä½ æƒ³æŸ¥è¯¢çš„æ–‡ä»¶ç³»ç»Ÿæ‰€åœ¨è·¯å¾„çš„å­—ç¬¦ä¸²ã€‚</li><li><code>options</code>: å¯é€‰å‚æ•°ï¼Œå¦‚æœæŒ‡å®šï¼Œå®ƒå…è®¸ä½ å®šåˆ¶å‡½æ•°çš„è¡Œä¸ºï¼Œæ¯”å¦‚æŒ‡å®šå­—ç¬¦ç¼–ç ã€‚</li></ul><h4 id="è¿”å›å€¼-11" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-11"><span>è¿”å›å€¼</span></a></h4><p>å½“ä½ è°ƒç”¨ <code>fs.statfsSync()</code> å¹¶ä¼ å…¥ä¸€ä¸ªè·¯å¾„æ—¶ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†å¾ˆå¤šå…³äºè¯¥è·¯å¾„æ‰€åœ¨æ–‡ä»¶ç³»ç»Ÿçš„ä¿¡æ¯ï¼Œä¾‹å¦‚æ€»ç©ºé—´å¤§å°ã€å¯ç”¨ç©ºé—´ã€æ–‡ä»¶ç³»ç»Ÿç±»å‹ç­‰ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-25" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-25"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>è®©æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªä¾‹å­ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£å¦‚ä½•ä½¿ç”¨ <code>fs.statfsSync()</code>ã€‚</p><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦æ£€æŸ¥æœåŠ¡å™¨ä¸ŠæŸä¸ªç›®å½•çš„å¯ç”¨å­˜å‚¨ç©ºé—´ï¼Œä»¥ç¡®ä¿æœ‰è¶³å¤Ÿçš„ç©ºé—´å­˜å‚¨å³å°†ä¸Šä¼ çš„æ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æŒ‡å®šè¦æ£€æŸ¥çš„ç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/var/myapp/uploads</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fs.statfsSync è·å–æ–‡ä»¶ç³»ç»Ÿä¿¡æ¯</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statfsSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè½½å…¥ Node.js çš„ <code>fs</code> æ¨¡å—ï¼Œç„¶åå®šä¹‰ä¸€ä¸ªè·¯å¾„ <code>path</code>ï¼ŒæŒ‡å‘æˆ‘ä»¬æ„Ÿå…´è¶£çš„ç›®å½•ã€‚æ¥ç€ï¼Œæˆ‘ä»¬è°ƒç”¨ <code>fs.statfsSync(path)</code> æ¥è·å–è¯¥è·¯å¾„æ‰€åœ¨æ–‡ä»¶ç³»ç»Ÿçš„ç»Ÿè®¡ä¿¡æ¯ï¼Œå¹¶å°†è¿™äº›ä¿¡æ¯å­˜å‚¨åœ¨ <code>stats</code> å˜é‡ä¸­ã€‚æœ€åï¼Œæˆ‘ä»¬è¾“å‡ºè¿™ä¸ª <code>stats</code> å¯¹è±¡ï¼Œå®ƒä¼šåŒ…å«å¾ˆå¤šæœ‰ç”¨çš„ä¿¡æ¯ï¼Œæ¯”å¦‚æ–‡ä»¶ç³»ç»Ÿçš„æ€»ç©ºé—´ã€å¯ç”¨ç©ºé—´ç­‰ã€‚</p><p>è¿™æ ·ï¼Œä½ å°±å¯ä»¥åŸºäº <code>stats</code> ä¸­çš„ä¿¡æ¯æ¥å†³å®šæ˜¯å¦ç»§ç»­ä¸Šä¼ æ–‡ä»¶æˆ–è€…é‡‡å–å…¶ä»–æªæ–½ï¼Œæ¯”å¦‚æ¸…ç†ç©ºé—´æˆ–é€šçŸ¥ç”¨æˆ·ç©ºé—´ä¸è¶³ã€‚</p><h3 id="æ€»ç»“-14" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-14"><span>æ€»ç»“</span></a></h3><p>ç®€å•æ¥è¯´ï¼Œ<code>fs.statfsSync()</code> æ˜¯ä¸€ä¸ªå¾ˆå®ç”¨çš„å·¥å…·ï¼Œå®ƒèƒ½è®©ä½ åŒæ­¥åœ°è·å–æ–‡ä»¶ç³»ç»Ÿçš„è¯¦ç»†ç»Ÿè®¡ä¿¡æ¯ã€‚é€šè¿‡è¿™äº›ä¿¡æ¯ï¼Œä½ å¯ä»¥åšå‡ºæ›´æ˜æ™ºçš„å†³ç­–ï¼Œä¼˜åŒ–ä½ çš„åº”ç”¨æ€§èƒ½æˆ–ç”¨æˆ·ä½“éªŒã€‚è™½ç„¶è¿™é‡Œè®²çš„éƒ½æ˜¯åŒæ­¥ç‰ˆæœ¬ï¼Œä½†è¯·è®°ä½ï¼Œåœ¨å¤„ç†å¤§é‡æ•°æ®æˆ–åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå°½å¯èƒ½ä½¿ç”¨å¼‚æ­¥ç‰ˆæœ¬çš„å‡½æ•°ä»¥é¿å…é˜»å¡ä¸»çº¿ç¨‹ã€‚</p><h3 id="fs-symlinksync-target-path-type" tabindex="-1"><a class="header-anchor" href="#fs-symlinksync-target-path-type"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fssymlinksynctarget-path-type" target="_blank" rel="noopener noreferrer">fs.symlinkSync(target, path[, type])</a></span></a></h3><p>å½“æˆ‘ä»¬åœ¨è°ˆè®º Node.js ä¸­çš„<code>fs.symlinkSync(target, path[, type])</code>æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨è®¨è®ºå¦‚ä½•åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºä¸€ä¸ªç¬¦å·é“¾æ¥ï¼ˆä¹Ÿå°±æ˜¯å¿«æ·æ–¹å¼ï¼‰ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯<code>fs</code>æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œè€Œ<code>fs</code>ä»£è¡¨çš„æ˜¯æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰ã€‚ä½¿ç”¨<code>fs.symlinkSync</code>å¯ä»¥è®©ä½ åˆ›å»ºä¸€ä¸ªæŒ‡å‘å¦ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„å¼•ç”¨ã€‚</p><p>åœ¨æ·±å…¥äº†è§£ä¹‹å‰ï¼Œå…ˆæ¥ç®€å•ç†è§£å‡ ä¸ªæ¦‚å¿µï¼š</p><ul><li><strong>ç¬¦å·é“¾æ¥ï¼ˆSymlinkï¼‰</strong>ï¼šä¸€ä¸ªç‰¹æ®Šç±»å‹çš„æ–‡ä»¶ï¼Œå…¶å†…å®¹æ˜¯å¯¹å¦ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„å¼•ç”¨ã€‚ä½ å¯ä»¥å°†å®ƒæƒ³è±¡æˆä¸€ä¸ªå¿«æ·æ–¹å¼ï¼Œé€šè¿‡å®ƒå¯ä»¥ç›´æ¥è®¿é—®é“¾æ¥æ‰€æŒ‡å‘çš„åŸå§‹æ–‡ä»¶æˆ–ç›®å½•ã€‚</li><li><strong>ç›®æ ‡ï¼ˆTargetï¼‰</strong>ï¼šè¿™æ˜¯ç¬¦å·é“¾æ¥æ‰€æŒ‡å‘çš„åŸå§‹æ–‡ä»¶æˆ–ç›®å½•ã€‚</li><li><strong>è·¯å¾„ï¼ˆPathï¼‰</strong>ï¼šè¿™æ˜¯åˆ›å»ºçš„ç¬¦å·é“¾æ¥çš„ä½ç½®å’Œåç§°ã€‚</li><li><strong>ç±»å‹ï¼ˆTypeï¼‰</strong>ï¼šè¿™æ˜¯å¯é€‰å‚æ•°ï¼Œä¸»è¦ç”¨äº Windows ç³»ç»Ÿä¸­ï¼Œç”¨ä»¥æŒ‡å®šåˆ›å»ºçš„æ˜¯æŒ‡å‘æ–‡ä»¶çš„ç¬¦å·é“¾æ¥è¿˜æ˜¯æŒ‡å‘ç›®å½•çš„ã€‚</li></ul><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡ä¸€äº›ä¾‹å­æ¥çœ‹çœ‹<code>fs.symlinkSync</code>å¦‚ä½•åœ¨å®è·µä¸­ä½¿ç”¨ï¼š</p><h3 id="å®ä¾‹-1-åˆ›å»ºæŒ‡å‘æ–‡ä»¶çš„ç¬¦å·é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-1-åˆ›å»ºæŒ‡å‘æ–‡ä»¶çš„ç¬¦å·é“¾æ¥"><span>å®ä¾‹ 1ï¼šåˆ›å»ºæŒ‡å‘æ–‡ä»¶çš„ç¬¦å·é“¾æ¥</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º<code>report.txt</code>çš„æ–‡ä»¶ï¼Œä½äº<code>/user/data</code>ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬æƒ³åœ¨<code>/user/archive</code>ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªæŒ‡å‘<code>report.txt</code>çš„ç¬¦å·é“¾æ¥ã€‚è¿™æ ·ï¼Œå³ä½¿æˆ‘ä»¬åœ¨<code>archive</code>ç›®å½•æ“ä½œé“¾æ¥ï¼Œå®é™…ä¸Šå½±å“çš„æ˜¯<code>data</code>ç›®å½•ä¸‹çš„<code>report.txt</code>æ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›®æ ‡æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> target</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/user/data/report.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// ç¬¦å·é“¾æ¥çš„è·¯å¾„å’Œåç§°</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/user/archive/report-link.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºç¬¦å·é“¾æ¥</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">symlinkSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">target</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œä¸Šè¿°ä»£ç åï¼Œåœ¨<code>/user/archive</code>ç›®å½•ä¸­ä¼šå‡ºç°ä¸€ä¸ªåä¸º<code>report-link.txt</code>çš„ç¬¦å·é“¾æ¥ï¼Œè¯¥é“¾æ¥æŒ‡å‘<code>/user/data/report.txt</code>æ–‡ä»¶ã€‚</p><h3 id="å®ä¾‹-2-åˆ›å»ºæŒ‡å‘ç›®å½•çš„ç¬¦å·é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-2-åˆ›å»ºæŒ‡å‘ç›®å½•çš„ç¬¦å·é“¾æ¥"><span>å®ä¾‹ 2ï¼šåˆ›å»ºæŒ‡å‘ç›®å½•çš„ç¬¦å·é“¾æ¥</span></a></h3><p>å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º<code>logs</code>çš„ç›®å½•ï¼Œä½äº<code>/var/app</code>ä¸‹ï¼Œæˆ‘ä»¬æƒ³åœ¨ç”¨æˆ·çš„ä¸»ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªç¬¦å·é“¾æ¥æŒ‡å‘è¿™ä¸ª<code>logs</code>ç›®å½•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›®æ ‡ç›®å½•</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> target</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/var/app/logs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// ç¬¦å·é“¾æ¥çš„è·¯å¾„å’Œåç§°</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/home/user/logs-link</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºç¬¦å·é“¾æ¥</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">symlinkSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">target</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œä¸Šè¿°ä»£ç åï¼Œåœ¨<code>/home/user</code>ç›®å½•ä¸­ä¼šå‡ºç°ä¸€ä¸ªåä¸º<code>logs-link</code>çš„ç¬¦å·é“¾æ¥ï¼Œè¯¥é“¾æ¥æŒ‡å‘<code>/var/app/logs</code>ç›®å½•ã€‚è¿™æ ·ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡è‡ªå·±çš„ä¸»ç›®å½•ç›´æ¥è®¿é—®æ—¥å¿—ï¼Œè€Œä¸éœ€è¦å¯¼èˆªåˆ°åº”ç”¨ç¨‹åºçš„ç›®å½•ç»“æ„ä¸­å»ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-21" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-21"><span>æ³¨æ„äº‹é¡¹ï¼š</span></a></h3><ul><li>ä½¿ç”¨<code>fs.symlinkSync</code>æ—¶ï¼Œå¦‚æœè·¯å¾„æˆ–ç›®æ ‡ä¸­çš„ä»»ä½•ç›®å½•ä¸å­˜åœ¨ï¼Œæ“ä½œå°†å¤±è´¥ã€‚</li><li>å¦‚æœæŒ‡å®šçš„ç¬¦å·é“¾æ¥å·²ç»å­˜åœ¨ï¼Œå†æ¬¡å°è¯•åˆ›å»ºç›¸åŒçš„é“¾æ¥ä¹Ÿä¼šå¤±è´¥ã€‚</li><li>åœ¨ Windows ç³»ç»Ÿä¸Šåˆ›å»ºç¬¦å·é“¾æ¥å¯èƒ½éœ€è¦ç®¡ç†å‘˜æƒé™æˆ–ç‰¹å®šçš„ç­–ç•¥è®¾ç½®ï¼Œå› ä¸ºç¬¦å·é“¾æ¥å¯ä»¥è¢«ç”¨ä½œå®‰å…¨é—®é¢˜çš„æ”»å‡»å‘é‡ã€‚</li></ul><p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œä½ åº”è¯¥å¯¹å¦‚ä½•ä½¿ç”¨ Node.js çš„<code>fs.symlinkSync</code>æ–¹æ³•æœ‰äº†åŸºæœ¬çš„ç†è§£ã€‚è¿™ä¸ªåŠŸèƒ½åœ¨å®ç°æ–‡ä»¶ç»„ç»‡ã€å¿«é€Ÿè®¿é—®åŠç®¡ç†ç­‰æ–¹é¢éå¸¸æœ‰ç”¨ã€‚</p><h3 id="fs-truncatesync-path-len" tabindex="-1"><a class="header-anchor" href="#fs-truncatesync-path-len"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fstruncatesyncpath-len" target="_blank" rel="noopener noreferrer">fs.truncateSync(path[, len])</a></span></a></h3><p>å½“ä½ åœ¨å¤„ç†æ–‡ä»¶æ—¶ï¼Œæœ‰æ—¶å€™éœ€è¦ä¿®æ”¹æ–‡ä»¶çš„å¤§å°ã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½æƒ³è¦åˆ é™¤æ–‡ä»¶æœ«å°¾çš„ä¸€éƒ¨åˆ†æ•°æ®ï¼Œæˆ–è€…ç¡®ä¿ä¸€ä¸ªæ–‡ä»¶æ­£å¥½æ˜¯ç‰¹å®šçš„å¤§å°ã€‚è¿™å°±æ˜¯<code>fs.truncateSync(path[, len])</code>åœ¨ Node.js ä¸­çš„ç”¨é€”ã€‚å®ƒæ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>æ¨¡å—ï¼‰çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºåŒæ­¥åœ°æ›´æ”¹ä¸€ä¸ªæ–‡ä»¶çš„å¤§å°ã€‚è®©æˆ‘ä»¬æ·±å…¥äº†è§£å¹¶é€šè¿‡ä¸€äº›ä¾‹å­æ¥çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-16" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-16"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><ul><li><p><strong>åŒæ­¥æ“ä½œ</strong>ï¼šæŒ‡çš„æ˜¯ä»£ç å°†æŒ‰ç…§å®ƒä»¬å‡ºç°çš„é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚åœ¨<code>fs.truncateSync()</code>è°ƒç”¨å®Œæˆä¹‹å‰ï¼Œç¨‹åºä¸ä¼šç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç ã€‚è¿™ä¸å¼‚æ­¥æ“ä½œç›¸åï¼Œåœ¨å¼‚æ­¥æ“ä½œä¸­ï¼Œä»£ç å¯ä»¥åœ¨ç­‰å¾…æ“ä½œå®Œæˆçš„åŒæ—¶ç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡ã€‚</p></li><li><p><strong>è·¯å¾„ (<code>path</code>)</strong>ï¼šè¿™æ˜¯ä½ å¸Œæœ›æ›´æ”¹å¤§å°çš„æ–‡ä»¶çš„ä½ç½®å’Œåç§°ã€‚ä¾‹å¦‚ï¼Œ<code>&#39;/user/documents/myfile.txt&#39;</code>ã€‚</p></li><li><p><strong>é•¿åº¦ (<code>len</code>)</strong>ï¼šè¿™æ˜¯ä½ å¸Œæœ›æ–‡ä»¶æœ€ç»ˆæ‹¥æœ‰çš„å­—èŠ‚å¤§å°ã€‚å¦‚æœä½ ä¸æŒ‡å®šé•¿åº¦ï¼Œé»˜è®¤å€¼ä¸º<code>0</code>ï¼Œæ„å‘³ç€æ–‡ä»¶å°†è¢«æ¸…ç©ºã€‚</p></li></ul><h3 id="ä½¿ç”¨fs-truncatesync" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨fs-truncatesync"><span>ä½¿ç”¨<code>fs.truncateSync</code></span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º<code>log.txt</code>çš„æ—¥å¿—æ–‡ä»¶ï¼Œå®ƒéšæ—¶é—´ä¸æ–­å¢é•¿ã€‚ç°åœ¨ï¼Œç”±äºæŸäº›åŸå› ï¼Œä½ æƒ³è¦åˆ é™¤è¯¥æ–‡ä»¶çš„ä¸€åŠå†…å®¹ï¼Œæˆ–è€…ç¡®ä¿å®ƒä¸è¶…è¿‡ 1024 å­—èŠ‚ã€‚ä½¿ç”¨<code>fs.truncateSync</code>å¯ä»¥å¾ˆå®¹æ˜“åœ°åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><h4 id="ç¤ºä¾‹-1-æ¸…ç©ºæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æ¸…ç©ºæ–‡ä»¶"><span>ç¤ºä¾‹ 1ï¼šæ¸…ç©ºæ–‡ä»¶</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è·¯å¾„åˆ°æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./log.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ¸…ç©ºæ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">truncateSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ²¡æœ‰æŒ‡å®šé•¿åº¦å‚æ•°ï¼Œæ‰€ä»¥æ–‡ä»¶<code>log.txt</code>å°†è¢«æ¸…ç©ºã€‚</p><h4 id="ç¤ºä¾‹-2-è®¾ç½®æ–‡ä»¶å¤§å°ä¸º-1024-å­—èŠ‚" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-è®¾ç½®æ–‡ä»¶å¤§å°ä¸º-1024-å­—èŠ‚"><span>ç¤ºä¾‹ 2ï¼šè®¾ç½®æ–‡ä»¶å¤§å°ä¸º 1024 å­—èŠ‚</span></a></h4><p>å¦‚æœä½ æƒ³è¦ç¡®ä¿æ–‡ä»¶<code>log.txt</code>æ­£å¥½æ˜¯ 1024 å­—èŠ‚ï¼ˆå‡è®¾åŸæœ¬å¤§äºè¿™ä¸ªå¤§å°ï¼‰ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è·¯å¾„åˆ°æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./log.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å°†æ–‡ä»¶å¤§å°è®¾ç½®ä¸º1024å­—èŠ‚</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">truncateSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1024</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœåŸæ–‡ä»¶å°äº 1024 å­—èŠ‚ï¼Œè¿™ä¸ªæ“ä½œå°†å¡«å……æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ç©ºå­—èŠ‚ï¼‰ï¼Œç›´åˆ°è¾¾åˆ° 1024 å­—èŠ‚ã€‚å¦‚æœåŸæ–‡ä»¶å¤§äº 1024 å­—èŠ‚ï¼Œå®ƒå°†è¢«æˆªæ–­ï¼Œåªç•™ä¸‹å¼€å§‹çš„ 1024 å­—èŠ‚ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-22" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-22"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>ä½¿ç”¨åŒæ­¥ç‰ˆæœ¬çš„<code>fs</code>æ–¹æ³•ï¼ˆå¦‚<code>fs.truncateSync</code>ï¼‰ä¼šé˜»å¡ä½ çš„ç¨‹åºï¼Œç›´åˆ°æ“ä½œå®Œæˆã€‚è¿™åœ¨å¤„ç†å¤§å‹æ–‡ä»¶æˆ–åœ¨éœ€è¦é«˜å“åº”æ€§çš„åº”ç”¨ç¨‹åºä¸­å¯èƒ½ä¸æ˜¯æœ€ä½³é€‰æ‹©ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¼šè€ƒè™‘ä½¿ç”¨å®ƒçš„å¼‚æ­¥ç‰ˆæœ¬<code>fs.truncate()</code>ã€‚</li><li>ç¡®ä¿åœ¨è°ƒç”¨<code>fs.truncateSync()</code>ä¹‹å‰æœ‰è¶³å¤Ÿçš„æƒé™æ¥ä¿®æ”¹ç›®æ ‡æ–‡ä»¶ï¼Œå¦åˆ™ä¼šæŠ›å‡ºé”™è¯¯ã€‚</li></ul><p>é€šè¿‡åˆç†ä½¿ç”¨<code>fs.truncateSync</code>ï¼Œä½ å¯ä»¥æœ‰æ•ˆåœ°ç®¡ç†æ–‡ä»¶çš„å¤§å°ï¼Œæ— è®ºæ˜¯æ¸…é™¤æ—¥å¿—æ–‡ä»¶è¿˜æ˜¯ç¡®ä¿æ–‡ä»¶ç¬¦åˆç‰¹å®šçš„å¤§å°è¦æ±‚ã€‚</p><h3 id="fs-unlinksync-path" tabindex="-1"><a class="header-anchor" href="#fs-unlinksync-path"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsunlinksyncpath" target="_blank" rel="noopener noreferrer">fs.unlinkSync(path)</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„ JavaScript ç¯å¢ƒï¼Œå®ƒå…è®¸ä½ ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ç¨‹åºã€‚<code>fs</code> æ¨¡å—æ˜¯ Node.js çš„ä¸€éƒ¨åˆ†ï¼Œæä¾›äº†ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ–‡ä»¶çš„åˆ›å»ºã€è¯»å–ã€å†™å…¥ã€åˆ é™¤ç­‰æ“ä½œã€‚</p><h3 id="fs-unlinksync-path-1" tabindex="-1"><a class="header-anchor" href="#fs-unlinksync-path-1"><span>fs.unlinkSync(path)</span></a></h3><p><code>fs.unlinkSync(path)</code> æ˜¯ <code>fs</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºåŒæ­¥åœ°åˆ é™¤æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶ã€‚è¿™æ„å‘³ç€å½“ä½ è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼ŒNode.js ä¼šåœä¸‹æ¥ç­‰å¾…æ–‡ä»¶è¢«åˆ é™¤ï¼Œç„¶åå†ç»§ç»­æ‰§è¡Œä¹‹åçš„ä»£ç ã€‚è¿™ç§åŒæ­¥çš„æ–¹å¼åœ¨å¤„ç†å°‘é‡æ–‡ä»¶æ—¶å¾ˆæ–¹ä¾¿ï¼Œä½†åœ¨å¤„ç†å¤§é‡æ–‡ä»¶æˆ–éœ€è¦é«˜æ€§èƒ½çš„åº”ç”¨ä¸­å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºé˜»å¡ã€‚</p><h4 id="å‚æ•°è§£é‡Š-30" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-30"><span>å‚æ•°è§£é‡Šï¼š</span></a></h4><ul><li><strong>path</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¦åˆ é™¤çš„æ–‡ä»¶çš„è·¯å¾„ã€‚</li></ul><h4 id="ä½¿ç”¨ç¤ºä¾‹-4" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹-4"><span>ä½¿ç”¨ç¤ºä¾‹ï¼š</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º <code>example.txt</code> çš„æ–‡ä»¶ï¼Œä½äºä½ çš„é¡¹ç›®æ ¹ç›®å½•ï¼Œä½ æƒ³è¦åˆ é™¤è¿™ä¸ªæ–‡ä»¶ã€‚ä½ å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p><ol><li>é¦–å…ˆï¼Œç¡®ä¿ä½ çš„é¡¹ç›®ä¸­å·²ç»å®‰è£…å¹¶å¼•å…¥äº† <code>fs</code> æ¨¡å—ã€‚</li><li>ä½¿ç”¨ <code>fs.unlinkSync</code> æ–¹æ³•åˆ é™¤æ–‡ä»¶ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// åŠ è½½ fs æ¨¡å—</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // å°è¯•åŒæ­¥åˆ é™¤æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unlinkSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File deleted successfully</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">  // é”™è¯¯å¤„ç†</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error deleting file:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å®é™…è¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨åœºæ™¯"><span>å®é™…è¿ç”¨åœºæ™¯ï¼š</span></a></h4><ol><li><p><strong>æ¸…ç†ä¸´æ—¶æ–‡ä»¶</strong>ï¼šå‡è®¾ä½ çš„åº”ç”¨ç”Ÿæˆäº†ä¸€äº›ä¸´æ—¶æ–‡ä»¶ç”¨äºå¤„ç†ç”¨æˆ·è¯·æ±‚ï¼Œå¤„ç†å®Œæˆåä¸å†éœ€è¦è¿™äº›æ–‡ä»¶ã€‚ä½¿ç”¨ <code>fs.unlinkSync</code> å¯ä»¥åŠæ—¶åˆ é™¤è¿™äº›ä¸´æ—¶æ–‡ä»¶ï¼Œé¿å…å ç”¨è¿‡å¤šç£ç›˜ç©ºé—´ã€‚</p></li><li><p><strong>åº”ç”¨æ›´æ–°æ—¶åˆ é™¤æ—§æ–‡ä»¶</strong>ï¼šåœ¨è‡ªåŠ¨æ›´æ–°åº”ç”¨ç¨‹åºæ—¶ï¼Œå¯èƒ½éœ€è¦åˆ é™¤ä¸€äº›æ—§çš„ã€ä¸å†ä½¿ç”¨çš„æ–‡ä»¶ã€‚é€šè¿‡ <code>fs.unlinkSync</code> å¯ä»¥ç¡®ä¿åœ¨å®‰è£…æ–°ç‰ˆæœ¬ä¹‹å‰ï¼Œæ—§çš„æ–‡ä»¶è¢«æ¸…ç†æ‰ã€‚</p></li><li><p><strong>ç®¡ç†ä¸Šä¼ çš„æ–‡ä»¶</strong>ï¼šå¦‚æœä½ å¼€å‘äº†ä¸€ä¸ªå…è®¸ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶çš„ web åº”ç”¨ï¼Œå½“ç”¨æˆ·å†³å®šåˆ é™¤ä»–ä»¬ä¸Šä¼ çš„æŸä¸ªæ–‡ä»¶æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>fs.unlinkSync</code> æ¥æ‰§è¡Œè¿™ä¸ªæ“ä½œã€‚</p></li></ol><p>æ³¨æ„ï¼Œè™½ç„¶åœ¨æŸäº›æƒ…å†µä¸‹åŒæ­¥æ–¹æ³•å¾ˆæ–¹ä¾¿ï¼Œä½†åœ¨å¤„ç†è€—æ—¶è¾ƒé•¿çš„ I/O æ“ä½œæ—¶ï¼Œå»ºè®®ä½¿ç”¨å¼‚æ­¥æ–¹æ³•ï¼ˆå¦‚ <code>fs.unlink</code>ï¼‰ï¼Œè¿™æ ·å¯ä»¥é¿å…é˜»å¡ Node.js çš„äº‹ä»¶å¾ªç¯ã€‚</p><h3 id="fs-utimessync-path-atime-mtime" tabindex="-1"><a class="header-anchor" href="#fs-utimessync-path-atime-mtime"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsutimessyncpath-atime-mtime" target="_blank" rel="noopener noreferrer">fs.utimesSync(path, atime, mtime)</a></span></a></h3><p>Node.js ä¸­çš„<code>fs.utimesSync(path, atime, mtime)</code>æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„å‡½æ•°ï¼Œå®ƒå…è®¸ä½ ç›´æ¥ä¿®æ”¹æ–‡ä»¶çš„&quot;è®¿é—®æ—¶é—´&quot;(atime)å’Œ&quot;ä¿®æ”¹æ—¶é—´&quot;(mtime)ã€‚åœ¨æ·±å…¥è§£é‡Šä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦ç†è§£å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼š</p><ol><li><p><strong>æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰</strong>: è¿™æ˜¯æ“ä½œç³»ç»Ÿç”¨äºå­˜å‚¨ã€ç»„ç»‡ã€æ£€ç´¢æ•°æ®çš„æ–¹æ³•ã€‚æ¯ä¸ªæ–‡ä»¶é™¤äº†å†…å®¹ä»¥å¤–ï¼Œè¿˜æœ‰ä¸€äº›å…ƒæ•°æ®ï¼Œä¾‹å¦‚æ–‡ä»¶å¤§å°ã€åˆ›å»ºæ—¶é—´ã€æœ€åä¿®æ”¹æ—¶é—´ç­‰ã€‚</p></li><li><p><strong>è®¿é—®æ—¶é—´(atime)</strong>: è¿™æŒ‡çš„æ˜¯æ–‡ä»¶æœ€åè¢«è¯»å–æˆ–è®¿é—®çš„æ—¶é—´ã€‚ç®€å•æ¥è¯´ï¼Œæ¯å½“ä½ æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œä¸ç®¡æ˜¯ä¸ºäº†è¯»å–å†…å®¹è¿˜æ˜¯ä»…ä»…æŸ¥çœ‹ï¼Œç³»ç»Ÿå°±ä¼šæ›´æ–°è¿™ä¸ªæ—¶é—´æˆ³ã€‚</p></li><li><p><strong>ä¿®æ”¹æ—¶é—´(mtime)</strong>: ä¸ atime ç›¸å¯¹åº”ï¼Œmtime è®°å½•çš„æ˜¯æ–‡ä»¶å†…å®¹æœ€åä¸€æ¬¡è¢«ä¿®æ”¹çš„æ—¶é—´ã€‚æ¯”å¦‚ï¼Œä½ ç¼–è¾‘äº†ä¸€ä¸ªæ–‡æ¡£å¹¶ä¿å­˜ï¼Œè¿™ä¸ªæ–‡æ¡£çš„ mtime å°±ä¼šæ›´æ–°ã€‚</p></li></ol><p>ç°åœ¨è®©æˆ‘ä»¬æ·±å…¥<code>fs.utimesSync</code>å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å±äº Node.js çš„<code>fs</code>æ¨¡å—ï¼Œå…¶ä¸­<code>fs</code>ä»£è¡¨æ–‡ä»¶ç³»ç»Ÿã€‚è¯¥æ¨¡å—æä¾›äº†å„ç§ä¸æ–‡ä»¶æ“ä½œç›¸å…³çš„åŠŸèƒ½ï¼Œ<code>fs.utimesSync</code>å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚å…·ä½“åˆ°<code>fs.utimesSync(path, atime, mtime)</code>ï¼Œå®ƒåŒæ­¥åœ°æ›´æ”¹æŒ‡å®šæ–‡ä»¶çš„è®¿é—®æ—¶é—´å’Œä¿®æ”¹æ—¶é—´ã€‚è¿™é‡Œçš„â€œåŒæ­¥â€æ„å‘³ç€ä»£ç æ‰§è¡Œåˆ°è¿™ä¸€è¡Œæ—¶ï¼ŒNode.js ä¼šåœä¸‹æ¥ç­‰å¾…è¿™ä¸ªæ“ä½œå®Œæˆåå†ç»§ç»­æ‰§è¡Œä¹‹åçš„ä»£ç ã€‚è¿™ä¸å¼‚æ­¥æ“ä½œä¸åŒï¼Œåè€…åœ¨å¤„ç†é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡æ—¶ä¸ä¼šé˜»å¡ä»£ç çš„å…¶ä»–éƒ¨åˆ†ã€‚</p><h3 id="å‚æ•°è¯´æ˜-3" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯´æ˜-3"><span>å‚æ•°è¯´æ˜:</span></a></h3><ul><li><strong>path</strong>: è¦ä¿®æ”¹æ—¶é—´æˆ³çš„æ–‡ä»¶è·¯å¾„ã€‚</li><li><strong>atime</strong>: æ–°çš„è®¿é—®æ—¶é—´ã€‚å¯ä»¥æ˜¯è¡¨ç¤ºæ—¶é—´çš„å­—ç¬¦ä¸²ã€æ•°å­—ï¼ˆUnix æ—¶é—´æˆ³ï¼‰ï¼Œæˆ–è€…æ˜¯ Date å¯¹è±¡ã€‚</li><li><strong>mtime</strong>: æ–°çš„ä¿®æ”¹æ—¶é—´ï¼Œæ ¼å¼åŒ atimeã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-20" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-20"><span>å®é™…è¿ç”¨ç¤ºä¾‹:</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªè„šæœ¬ï¼Œè¿™ä¸ªè„šæœ¬éœ€è¦æ¨¡æ‹Ÿæ–‡ä»¶çš„è¯»å–æˆ–ä¿®æ”¹æ“ä½œä»¥æµ‹è¯•å¦ä¸€ä¸ªç¨‹åºå¦‚ä½•å“åº”æ–‡ä»¶æ—¶é—´æˆ³çš„å˜åŒ–ã€‚è¿™æ—¶å€™ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨<code>fs.utimesSync</code>æ¥æ‰‹åŠ¨è®¾ç½®è¿™äº›æ—¶é—´æˆ³ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// é¦–å…ˆï¼Œå¼•å…¥fsæ¨¡å—</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æˆ‘ä»¬è¦ä¿®æ”¹çš„æ–‡ä»¶è·¯å¾„ä¸º&#39;/path/to/file.txt&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è®¾ç½®æ–°çš„è®¿é—®æ—¶é—´å’Œä¿®æ”¹æ—¶é—´ï¼Œè¿™é‡Œæˆ‘ä»¬å°†å®ƒä»¬éƒ½è®¾ç½®ä¸ºå½“å‰æ—¶é—´</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> now</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä¿®æ”¹æ–‡ä»¶æ—¶é—´æˆ³</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">utimesSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> now</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> now</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">å·²æˆåŠŸæ›´æ–°æ–‡ä»¶æ—¶é—´æˆ³: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filePath</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é¦–å…ˆåŠ è½½äº† Node.js çš„<code>fs</code>æ¨¡å—ï¼Œç„¶åå®šä¹‰äº†æƒ³è¦æ“ä½œçš„æ–‡ä»¶è·¯å¾„ã€‚ä¹‹åï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª<code>Date</code>å¯¹è±¡ä»£è¡¨å½“å‰æ—¶é—´ï¼Œå¹¶å°†å…¶åŒæ—¶ä½œä¸ºæ–°çš„è®¿é—®æ—¶é—´å’Œä¿®æ”¹æ—¶é—´ä¼ é€’ç»™<code>fs.utimesSync</code>ã€‚å®Œæˆè¿™ä¸ªæ“ä½œåï¼ŒæŒ‡å®šæ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´æˆ³å°†è¢«æ›´æ–°ä¸ºå½“å‰æ—¶é—´ã€‚</p><p>ä½¿ç”¨<code>fs.utimesSync</code>å¯ä»¥åœ¨å„ç§åœºæ™¯ä¸‹éå¸¸æ–¹ä¾¿åœ°è¿›è¡Œæ–‡ä»¶æ—¶é—´æˆ³çš„ç®¡ç†å’Œæµ‹è¯•ï¼Œä»è€Œå¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°ç†è§£å’Œæ§åˆ¶æ–‡ä»¶çŠ¶æ€çš„å˜åŒ–ã€‚</p><h3 id="fs-writefilesync-file-data-options" tabindex="-1"><a class="header-anchor" href="#fs-writefilesync-file-data-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fswritefilesyncfile-data-options" target="_blank" rel="noopener noreferrer">fs.writeFileSync(file, data[, options])</a></span></a></h3><p>Node.js çš„ <code>fs.writeFileSync</code> æ–¹æ³•æ˜¯ä¸€ä¸ªç”¨æ¥å°†æ•°æ®å†™å…¥æ–‡ä»¶çš„åŒæ­¥æ“ä½œã€‚å¦‚æœä½ å¯¹ Node.js è¿˜ä¸å¤ªç†Ÿæ‚‰ï¼Œé‚£ä¹ˆå…ˆäº†è§£ä¸€ä¸‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªèƒ½è®©ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript çš„ç¯å¢ƒã€‚åŒæ­¥æ“ä½œæ„å‘³ç€ä»£ç ä¼šé˜»å¡ï¼ˆå³åœæ­¢æ‰§è¡Œï¼‰ç›´åˆ°å†™æ–‡ä»¶çš„æ“ä½œå®Œæˆã€‚</p><p>è®©æˆ‘ä»¬é€æ­¥æ¥è§£æä¸€ä¸‹ <code>fs.writeFileSync(file, data[, options])</code> è¿™ä¸ªæ–¹æ³•ï¼š</p><ol><li><strong>file</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€… Buffer æˆ– URLï¼Œè¡¨ç¤ºè¦å†™å…¥æ•°æ®çš„æ–‡ä»¶çš„è·¯å¾„ã€‚</li><li><strong>data</strong>ï¼šè¿™æ˜¯ä½ æƒ³è¦å†™å…¥æ–‡ä»¶çš„å†…å®¹ã€‚å®ƒå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ª Bufferï¼ˆå³äºŒè¿›åˆ¶æ•°æ®ï¼‰ã€‚</li><li><strong>options</strong>ï¼ˆå¯é€‰ï¼‰ï¼šè¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå…è®¸ä½ å®šåˆ¶åŒ–å¦‚ä½•å†™æ–‡ä»¶ï¼Œæ¯”å¦‚è®¾ç½®å­—ç¬¦ç¼–ç ç­‰ç­‰ã€‚</li></ol><p>ç°åœ¨ï¼Œæˆ‘ä¼šç»™ä½ ä¸¾å‡ ä¸ªå®é™…åº”ç”¨çš„ä¾‹å­ï¼š</p><h3 id="ä¾‹å­-1-å†™å…¥æ–‡æœ¬åˆ°æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-å†™å…¥æ–‡æœ¬åˆ°æ–‡ä»¶"><span>ä¾‹å­ 1ï¼šå†™å…¥æ–‡æœ¬åˆ°æ–‡ä»¶</span></a></h3><p>å‡è®¾ä½ æƒ³ä¿å­˜ä¸€äº›æ–‡æœ¬åˆ°ä¸€ä¸ªå«åš &quot;hello.txt&quot; çš„æ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥è¿™ä¹ˆåšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ–‡æœ¬æ•°æ®</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, world!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å°†æ–‡æœ¬å†™å…¥åˆ° hello.txt</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">hello.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å†™å…¥æˆåŠŸã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä¾‹å­-2-ä½¿ç”¨é€‰é¡¹å†™å…¥æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ä½¿ç”¨é€‰é¡¹å†™å…¥æ–‡ä»¶"><span>ä¾‹å­ 2ï¼šä½¿ç”¨é€‰é¡¹å†™å…¥æ–‡ä»¶</span></a></h3><p>å¦‚æœä½ æƒ³ä»¥ç‰¹å®šçš„å­—ç¬¦ç¼–ç ï¼ˆæ¯”å¦‚ UTF-8ï¼‰å†™å…¥æ–‡ä»¶ï¼Œå¹¶ä¸”è¦†ç›–åŸæœ‰å†…å®¹ï¼Œä½ å¯ä»¥è¿™æ ·ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ–‡æœ¬æ•°æ®</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯ä¸€æ®µæ–°çš„æ–‡æœ¬å†…å®¹ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å†™å…¥æ–‡ä»¶ï¼Œä½¿ç”¨ utf8 ç¼–ç </span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">somefile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#88C0D0;"> flag</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å†™å…¥æˆåŠŸã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œ <code>&#39;w&#39;</code> è¡¨ç¤ºå¦‚æœæ–‡ä»¶å­˜åœ¨åˆ™å†™å…¥å¹¶æ›¿æ¢å†…å®¹ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»ºæ–°æ–‡ä»¶ã€‚</p><h3 id="ä¾‹å­-3-å†™å…¥-json-æ•°æ®åˆ°æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-3-å†™å…¥-json-æ•°æ®åˆ°æ–‡ä»¶"><span>ä¾‹å­ 3ï¼šå†™å…¥ JSON æ•°æ®åˆ°æ–‡ä»¶</span></a></h3><p>å¦‚æœä½ å¤„ç†çš„æ˜¯å¯¹è±¡æˆ–æ•°ç»„ï¼Œå¹¶å¸Œæœ›å°†å…¶ä¿å­˜ä¸º JSON æ ¼å¼çš„æ–‡ä»¶ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä¸€ä¸ªJavaScriptå¯¹è±¡</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> person</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">  name</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">John</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#88C0D0;">  age</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 30</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#88C0D0;">  hobbies</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">reading</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">games</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">coding</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">]</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å°†å¯¹è±¡è½¬æ¢ä¸ºJSONæ ¼å¼çš„å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> JSON</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stringify</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">person</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> null</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 2</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // ä½¿ç”¨ä¸¤ä¸ªç©ºæ ¼è¿›è¡Œç¾åŒ–</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å†™å…¥åˆ° person.json æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">person.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">JSON æ–‡ä»¶å†™å…¥æˆåŠŸã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä»¥ä¸Šä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>fs.writeFileSync</code> æ–¹æ³•åœ¨æ–‡ä»¶æ“ä½œä¸­æ˜¯å¤šä¹ˆå¼ºå¤§å’Œçµæ´»ã€‚è®°ä½ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªåŒæ­¥æ“ä½œï¼Œæ‰€ä»¥åœ¨å¤§å‹åº”ç”¨æˆ–éœ€è¦é«˜æ€§èƒ½çš„åœºåˆä¸­ï¼Œå¯èƒ½ä¸å¤ªé€‚åˆé¢‘ç¹ä½¿ç”¨åŒæ­¥æ–¹æ³•ï¼Œä»¥é¿å…é˜»å¡ Node.js çš„äº‹ä»¶å¾ªç¯ã€‚</p><h3 id="fs-writesync-fd-buffer-offset-length-position" tabindex="-1"><a class="header-anchor" href="#fs-writesync-fd-buffer-offset-length-position"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fswritesyncfd-buffer-offset-length-position" target="_blank" rel="noopener noreferrer">fs.writeSync(fd, buffer, offset[, length[, position]])</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘ä¼šå°½åŠ›è®©è§£é‡Šå°½å¯èƒ½é€šä¿—æ˜“æ‡‚ã€‚</p><h3 id="node-js-çš„fs-writesyncæ–¹æ³•ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#node-js-çš„fs-writesyncæ–¹æ³•ç®€ä»‹"><span>Node.js çš„<code>fs.writeSync</code>æ–¹æ³•ç®€ä»‹</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code>æ¨¡å—æ˜¯ç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ã€‚è¿™ä¸ªæ¨¡å—æä¾›äº†å¾ˆå¤šå®ç”¨çš„æ–¹æ³•æ¥è¯»å–ã€å†™å…¥å’Œå¤„ç†æ–‡ä»¶ã€‚å…¶ä¸­<code>fs.writeSync</code>æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ–¹æ³•ï¼Œå®ƒç”¨äºåŒæ­¥åœ°å°†æ•°æ®å†™å…¥æ–‡ä»¶ã€‚</p><h3 id="å‚æ•°è§£æ-2" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£æ-2"><span>å‚æ•°è§£æ</span></a></h3><ul><li><strong>fd</strong>ï¼šæ–‡ä»¶æè¿°ç¬¦ï¼Œä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ‰“å¼€çš„æ–‡ä»¶ã€‚</li><li><strong>buffer</strong>ï¼šè¦å†™å…¥æ–‡ä»¶çš„æ•°æ®ï¼Œç±»å‹æ˜¯ Buffer æˆ– Uint8Arrayã€‚</li><li><strong>offset</strong>ï¼šåç§»é‡ï¼Œä» buffer çš„å“ªä¸ªä½ç½®å¼€å§‹å†™å…¥æ•°æ®ã€‚</li><li><strong>length</strong>ï¼šå¯é€‰å‚æ•°ï¼ŒæŒ‡å®šè¦å†™å…¥çš„å­—èŠ‚æ•°ã€‚</li><li><strong>position</strong>ï¼šå¯é€‰å‚æ•°ï¼ŒæŒ‡å®šä»æ–‡ä»¶çš„å“ªä¸ªä½ç½®å¼€å§‹å†™å…¥æ•°æ®ã€‚</li></ul><h3 id="ä½¿ç”¨åœºæ™¯å’Œä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯å’Œä¾‹å­-1"><span>ä½¿ç”¨åœºæ™¯å’Œä¾‹å­</span></a></h3><h4 id="åŸºæœ¬å†™å…¥æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬å†™å…¥æ“ä½œ"><span>åŸºæœ¬å†™å…¥æ“ä½œ</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦è®°å½•é”™è¯¯æ—¥å¿—åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚ä½¿ç”¨<code>fs.writeSync</code>å¯ä»¥æ–¹ä¾¿åœ°å®Œæˆè¿™é¡¹å·¥ä½œï¼š</p><ol><li><p>é¦–å…ˆï¼Œä½ éœ€è¦æ‰“å¼€ï¼ˆæˆ–åˆ›å»ºï¼‰ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶è·å–å®ƒçš„æ–‡ä»¶æè¿°ç¬¦ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./error.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ‰“å¼€æ–‡ä»¶å‡†å¤‡è¿½åŠ å†…å®¹</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ç„¶åï¼Œåˆ›å»ºä¸€ä¸ªåŒ…å«é”™è¯¯ä¿¡æ¯çš„ Buffer å¯¹è±¡ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> errorInfo</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Error: Something went wrong!</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">errorInfo</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ä½¿ç”¨<code>fs.writeSync</code>å†™å…¥é”™è¯¯ä¿¡æ¯ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">length</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> null</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>æœ€åï¼Œåˆ«å¿˜äº†å…³é—­æ–‡ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ol><p>è¿™é‡Œçš„<code>fs.writeSync</code>è°ƒç”¨ä¼šå°†<code>errorInfo</code>ä¸­çš„å­—ç¬¦ä¸²å†™å…¥åˆ°<code>error.log</code>æ–‡ä»¶çš„æœ«å°¾ã€‚æˆ‘ä»¬æŠŠæ•´ä¸ªå­—ç¬¦ä¸²è½¬æ¢æˆäº† Bufferï¼Œç„¶åä»è¿™ä¸ª Buffer çš„ç¬¬ 0 ä½å¼€å§‹å†™ï¼Œå†™å…¥é•¿åº¦ä¸º<code>buffer.length</code>çš„å…¨éƒ¨å†…å®¹ã€‚ç”±äºæŒ‡å®š<code>position</code>ä¸º<code>null</code>ï¼Œå®ƒä¼šä»å½“å‰æ–‡ä»¶å†…å®¹çš„æœ«å°¾å¼€å§‹å†™å…¥ã€‚</p><h4 id="æ³¨æ„" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„"><span>æ³¨æ„</span></a></h4><ul><li>åŒæ­¥æ„å‘³ç€åœ¨å†™å…¥æ“ä½œå®Œæˆä¹‹å‰ï¼Œä»£ç ä¸ä¼šç»§ç»­æ‰§è¡Œåˆ°ä¸‹ä¸€è¡Œã€‚è¿™å¯¹äºç¡®ä¿é¡ºåºæ­£ç¡®ç‰¹åˆ«æœ‰ç”¨ï¼Œä½†å¦‚æœæ“ä½œé¢‘ç¹æˆ–è€—æ—¶è¾ƒé•¿ï¼Œå¯èƒ½ä¼šé˜»å¡ç¨‹åºå…¶ä»–éƒ¨åˆ†çš„æ‰§è¡Œã€‚</li><li>å¯¹äºç®€å•çš„è„šæœ¬æˆ–è€…åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­éœ€è¦ç«‹å³å†™å…¥æ–‡ä»¶å¹¶ç¡®ä¿å†™å…¥æˆåŠŸçš„åœºæ™¯ï¼ŒåŒæ­¥æ–¹æ³•æ˜¯éå¸¸æ–¹ä¾¿çš„ã€‚ç„¶è€Œï¼Œåœ¨å¤„ç†å¤§å‹åº”ç”¨æˆ–è€…éœ€è¦é«˜æ€§èƒ½çš„åœºæ™¯ä¸­ï¼Œå»ºè®®ä½¿ç”¨å¼‚æ­¥æ–¹æ³•ä»¥é¿å…é˜»å¡äº‹ä»¶å¾ªç¯ã€‚</li></ul><p>é€šè¿‡è¿™ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ°<code>fs.writeSync</code>å¦‚ä½•åœ¨å…·ä½“çš„åº”ç”¨åœºæ™¯ä¸­è¢«ä½¿ç”¨æ¥åŒæ­¥åœ°å†™å…¥æ–‡ä»¶å†…å®¹ã€‚å¸Œæœ›è¿™æœ‰åŠ©äºä½ ç†è§£è¿™ä¸ªæ–¹æ³•çš„åŸºæœ¬ç”¨æ³•å’Œä¸€äº›å®é™…è¿ç”¨åœºæ™¯ã€‚</p><h3 id="fs-writesync-fd-buffer-options" tabindex="-1"><a class="header-anchor" href="#fs-writesync-fd-buffer-options"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fswritesyncfd-buffer-options" target="_blank" rel="noopener noreferrer">fs.writeSync(fd, buffer[, options])</a></span></a></h3><p>Node.js çš„ <code>fs.writeSync(fd, buffer[, options])</code> å‡½æ•°æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„å·¥å…·ï¼Œç”¨äºåœ¨ Node.js ä¸­è¿›è¡Œæ–‡ä»¶æ“ä½œã€‚è¿™ä¸ªå‡½æ•°å…è®¸ä½ åŒæ­¥åœ°å°†æ•°æ®å†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œå³ä»£ç ä¼šä¸€ç›´ç­‰å¾…ç›´åˆ°å†™å…¥æ“ä½œå®Œæˆæ‰ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç ã€‚è¿™ä¸å¼‚æ­¥æ“ä½œç›¸åï¼Œåè€…ä¸ä¼šé˜»å¡ä»£ç çš„æ‰§è¡Œã€‚</p><p>ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦é€ä¸€è§£æå®ƒçš„å‚æ•°å’Œä½¿ç”¨åœºæ™¯ï¼š</p><h3 id="å‚æ•°è§£é‡Š-31" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-31"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><p><strong>fd (File Descriptor æ–‡ä»¶æè¿°ç¬¦)</strong>: è¿™æ˜¯ä¸€ä¸ªæ•°å­—ï¼ŒæŒ‡å‘è¢«æ‰“å¼€æ–‡ä»¶çš„å¼•ç”¨ã€‚ä½ å¯ä»¥é€šè¿‡ <code>fs.openSync()</code> æ–¹æ³•è·å–ä¸€ä¸ªæ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ã€‚</p></li><li><p><strong>buffer</strong>: è¿™æ˜¯è¦å†™å…¥æ–‡ä»¶çš„æ•°æ®ã€‚åœ¨ Node.js ä¸­ï¼ŒBuffer æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ç±»ã€‚å½“ä½ æƒ³è¦å†™å…¥å­—ç¬¦ä¸²ä»¥å¤–çš„æ•°æ®æ—¶ï¼ˆæ¯”å¦‚å›¾ç‰‡æˆ–å…¶ä»–äºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ï¼ŒBuffer å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚</p></li><li><p><strong>options (å¯é€‰)</strong>: ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥ç²¾ç¡®æ§åˆ¶å†™å…¥æ“ä½œã€‚ä¸»è¦çš„å±æ€§åŒ…æ‹¬ï¼š</p><ul><li><code>offset</code>: æŒ‡å®šä»å“ªé‡Œå¼€å§‹å†™å…¥æ•°æ®åˆ° bufferã€‚</li><li><code>length</code>: æŒ‡å®šå†™å…¥å¤šå°‘å­—èŠ‚çš„æ•°æ®ã€‚</li><li><code>position</code>: æŒ‡å®šä»æ–‡ä»¶çš„ä»€ä¹ˆä½ç½®å¼€å§‹å†™å…¥æ•°æ®ã€‚</li></ul></li></ul><p>å¦‚æœ <code>options</code> æœªæŒ‡å®šæˆ–éƒ¨åˆ†å±æ€§æœªæŒ‡å®šï¼Œä¼šä½¿ç”¨é»˜è®¤å€¼ã€‚</p><h3 id="ä½¿ç”¨ä¾‹å­-6" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­-6"><span>ä½¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä»»åŠ¡ï¼šå‘ä¸€ä¸ªå« <code>example.txt</code> çš„æ–‡æœ¬æ–‡ä»¶ä¸­å†™å…¥ä¸€äº›å†…å®¹ã€‚</p><h4 id="æ­¥éª¤-1-æ‰“å¼€æ–‡ä»¶-1" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-1-æ‰“å¼€æ–‡ä»¶-1"><span>æ­¥éª¤ 1: æ‰“å¼€æ–‡ä»¶</span></a></h4><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ‰“å¼€æ–‡ä»¶å¹¶è·å–å®ƒçš„æ–‡ä»¶æè¿°ç¬¦ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶è·å–æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œ <code>&#39;w&#39;</code> è¡¨ç¤ºä»¥å†™å…¥æ¨¡å¼æ‰“å¼€æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œå°±åˆ›å»ºå®ƒã€‚</p><h4 id="æ­¥éª¤-2-å†™å…¥æ•°æ®-1" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-2-å†™å…¥æ•°æ®-1"><span>æ­¥éª¤ 2: å†™å…¥æ•°æ®</span></a></h4><p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å†™å…¥ä¸€äº›æ–‡æœ¬å†…å®¹æˆ–äºŒè¿›åˆ¶æ•°æ®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> content</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, Node.js!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æˆ‘ä»¬æƒ³è¦å†™å…¥çš„å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">content</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å°†å­—ç¬¦ä¸²è½¬æ¢æˆ Buffer</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åŒæ­¥å†™å…¥æ•°æ®åˆ°æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šå°† &quot;Hello, Node.js!&quot; å†™å…¥åˆ° <code>example.txt</code> æ–‡ä»¶ä¸­ã€‚</p><h4 id="æ­¥éª¤-3-å…³é—­æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-3-å…³é—­æ–‡ä»¶"><span>æ­¥éª¤ 3: å…³é—­æ–‡ä»¶</span></a></h4><p>æœ€åï¼Œåˆ«å¿˜äº†å…³é—­æ–‡ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å…³é—­æ–‡ä»¶æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œå¯ä»¥é¿å…èµ„æºæ³„æ¼ã€‚</p><h3 id="å®é™…åº”ç”¨åœºæ™¯-2" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨åœºæ™¯-2"><span>å®é™…åº”ç”¨åœºæ™¯</span></a></h3><ol><li><p><strong>æ—¥å¿—è®°å½•</strong>ï¼šå‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œéœ€è¦è®°å½•ç”¨æˆ·çš„è¯·æ±‚æ—¥å¿—ã€‚ç”±äºæ—¥å¿—çš„å†™å…¥é€šå¸¸ä¸å¸Œæœ›å½±å“ä¸»ç¨‹åºçš„è¿è¡Œï¼Œä½†ä½ åˆéœ€è¦ä¿è¯æ—¥å¿—èƒ½å¤Ÿå®‰å…¨å®Œæ•´åœ°å†™å…¥ï¼Œè¿™æ—¶å€™ <code>fs.writeSync()</code> å°±éå¸¸é€‚ç”¨ã€‚</p></li><li><p><strong>é…ç½®æ–‡ä»¶æ›´æ–°</strong>ï¼šå¦‚æœä½ çš„åº”ç”¨éœ€è¦ä¿®æ”¹æˆ–æ›´æ–°é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨ <code>fs.writeSync()</code> å¯ä»¥ç¡®ä¿åœ¨ç¨‹åºç»§ç»­æ‰§è¡Œå‰ï¼Œé…ç½®æ–‡ä»¶å·²è¢«æ­£ç¡®æ›´æ–°ã€‚</p></li><li><p><strong>æ•°æ®è¿ç§»å·¥å…·</strong>ï¼šå½“è®¾è®¡ä¸€ä¸ªéœ€è¦å°†æ•°æ®ä»ä¸€ä¸ªæ ¼å¼è½¬æ¢æˆå¦ä¸€ä¸ªæ ¼å¼çš„å·¥å…·æ—¶ï¼ˆä¾‹å¦‚ä» CSV è½¬æ¢åˆ° JSONï¼‰ï¼Œä½¿ç”¨ <code>fs.writeSync()</code> ç¡®ä¿æ¯ä¸€æ­¥çš„æ•°æ®è½¬æ¢éƒ½è¢«æ­£ç¡®ä¿å­˜ï¼Œæ˜¯å¾ˆå…³é”®çš„ã€‚</p></li></ol><p>æ€»çš„æ¥è¯´ï¼Œ<code>fs.writeSync()</code> åœ¨éœ€è¦ç¡®ä¿æ•°æ®å®Œæ•´æ€§å’Œé¡ºåºæ€§çš„åœºæ™¯ä¸‹éå¸¸æœ‰ç”¨ã€‚ç„¶è€Œï¼Œç”±äºå®ƒæ˜¯åŒæ­¥çš„ï¼Œå¯èƒ½ä¼šé˜»å¡äº‹ä»¶å¾ªç¯ï¼Œå› æ­¤å»ºè®®ä»…åœ¨å¯¹æ€§èƒ½å½±å“ä¸æ•æ„Ÿçš„åœºåˆä½¿ç”¨ã€‚</p><h3 id="fs-writesync-fd-string-position-encoding" tabindex="-1"><a class="header-anchor" href="#fs-writesync-fd-string-position-encoding"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fswritesyncfd-string-position-encoding" target="_blank" rel="noopener noreferrer">fs.writeSync(fd, string[, position[, encoding]])</a></span></a></h3><p>å½“ä½ å¼€å§‹ä½¿ç”¨ Node.jsï¼Œä½ ä¼šæ¥è§¦åˆ°è®¸å¤šå†…å»ºæ¨¡å—ï¼ˆbuilt-in modulesï¼‰ï¼Œè€Œ<code>fs</code>ï¼ˆfilesystemï¼‰æ¨¡å—æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚è¿™ä¸ªæ¨¡å—æä¾›äº†å¾ˆå¤šæ–¹æ³•æ¥ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’ï¼Œæ¯”å¦‚è¯»å–ã€å†™å…¥å’Œä¿®æ”¹æ–‡ä»¶ç­‰ã€‚æˆ‘ä»¬ä»Šå¤©è¦è¯¦ç»†ä»‹ç»çš„æ˜¯<code>fs.writeSync</code>æ–¹æ³•ã€‚</p><h3 id="fs-writesync-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#fs-writesync-ç®€ä»‹"><span>fs.writeSync ç®€ä»‹</span></a></h3><p><code>fs.writeSync</code>æ–¹æ³•æ˜¯ä¸€ä¸ªç”¨äºåŒæ­¥å†™å…¥æ•°æ®åˆ°æŒ‡å®šæ–‡ä»¶çš„å‡½æ•°ã€‚å®ƒæ˜¯<code>fs</code>æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥è®©ä½ åœ¨ä¸é˜»å¡ç¨‹åºå…¶å®ƒéƒ¨åˆ†æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œç›´æ¥å°†å†…å®¹å†™å…¥æ–‡ä»¶ä¸­ã€‚è¿™ç§åŒæ­¥æ“ä½œæ„å‘³ç€ï¼Œç›´åˆ°å†™å…¥å®Œæˆï¼Œä»£ç æ‰ä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚</p><h3 id="å‚æ•°è§£é‡Š-32" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-32"><span>å‚æ•°è§£é‡Š</span></a></h3><p>è¯¥æ–¹æ³•æ¥å—ä¸‹åˆ—å‚æ•°ï¼š</p><ol><li><strong>fd</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œä»£è¡¨äº†ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶ã€‚ä½ éœ€è¦å…ˆé€šè¿‡<code>fs.openSync()</code>æˆ–ç±»ä¼¼æ–¹æ³•è·å¾—æ–‡ä»¶æè¿°ç¬¦ã€‚</li><li><strong>string</strong>ï¼šè¿™æ˜¯è¦å†™å…¥æ–‡ä»¶çš„æ•°æ®ã€‚è™½ç„¶å‚æ•°åæ˜¯<code>string</code>ï¼Œä½†ä½ ä¹Ÿå¯ä»¥ä¼ å…¥ä¸€ä¸ª<code>Buffer</code>æˆ–<code>TypedArray</code>ã€‚</li><li><strong>position</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œä»£è¡¨ä»æ–‡ä»¶çš„å“ªä¸ªä½ç½®å¼€å§‹å†™å…¥æ•°æ®ã€‚å¦‚æœçœç•¥ï¼Œæ•°æ®ä¼šä»å½“å‰æ–‡ä»¶æŒ‡é’ˆçš„ä½ç½®å¼€å§‹å†™å…¥ã€‚</li><li><strong>encoding</strong>ï¼šè¿™ä¹Ÿæ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œç”¨äºæŒ‡å®š<code>string</code>çš„ç¼–ç æ ¼å¼ï¼Œæ¯”å¦‚<code>&#39;utf8&#39;</code>ã€‚å¦‚æœ<code>string</code>æ˜¯ä¸€ä¸ª<code>Buffer</code>æˆ–<code>TypedArray</code>ï¼Œåˆ™æ­¤å‚æ•°è¢«å¿½ç•¥ã€‚</li></ol><h3 id="ä½¿ç”¨å®ä¾‹-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨å®ä¾‹-1"><span>ä½¿ç”¨å®ä¾‹</span></a></h3><h4 id="å†™å…¥æ–‡æœ¬åˆ°æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#å†™å…¥æ–‡æœ¬åˆ°æ–‡ä»¶"><span>å†™å…¥æ–‡æœ¬åˆ°æ–‡ä»¶</span></a></h4><p>å‡è®¾ä½ æƒ³åˆ›å»ºä¸€ä¸ªç®€å•çš„æ–‡æœ¬æ–‡ä»¶ï¼Œè®°å½•ä¸€äº›æ—¥å¿—ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶ï¼Œè·å–æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">log.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è¦å†™å…¥çš„å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯ä¸€æ¡æ—¥å¿—ä¿¡æ¯</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åŒæ­¥å†™å…¥å­—ç¬¦ä¸²åˆ°æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å†å†™å…¥ä¸€æ¡è®°å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">data</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯å¦ä¸€æ¡æ—¥å¿—ä¿¡æ¯</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®Œæˆåï¼Œå…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡<code>fs.openSync()</code>æ–¹æ³•æ‰“å¼€ï¼ˆè‹¥ä¸å­˜åœ¨åˆ™åˆ›å»ºï¼‰ä¸€ä¸ªåä¸º<code>log.txt</code>çš„æ–‡ä»¶ï¼Œå¹¶ä¸”è·å–å®ƒçš„æ–‡ä»¶æè¿°ç¬¦ã€‚ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€æ¡æ—¥å¿—ä¿¡æ¯ï¼Œé€šè¿‡<code>fs.writeSync()</code>æ–¹æ³•å†™å…¥åˆ°æ–‡ä»¶ä¸­ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬è°ƒç”¨äº†ä¸¤æ¬¡<code>writeSync</code>ä»¥æ¼”ç¤ºè¿ç»­å†™å…¥ã€‚æœ€åï¼Œæˆ‘ä»¬é€šè¿‡<code>fs.closeSync()</code>å…³é—­æ–‡ä»¶ã€‚</p><h4 id="æŒ‡å®šä½ç½®å†™å…¥æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#æŒ‡å®šä½ç½®å†™å…¥æ–‡ä»¶"><span>æŒ‡å®šä½ç½®å†™å…¥æ–‡ä»¶</span></a></h4><p>å¦‚æœä½ æƒ³åœ¨æ–‡ä»¶çš„ç‰¹å®šä½ç½®å†™å…¥æ•°æ®ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶ï¼Œè·å–æ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è¦å†™å…¥çš„å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">XYZ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åŒæ­¥å†™å…¥å­—ç¬¦ä¸²åˆ°æ–‡ä»¶çš„èµ·å§‹ä½ç½®</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®Œæˆåï¼Œå…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆæ‰“å¼€äº†<code>example.txt</code>æ–‡ä»¶ï¼Œå¹¶ä¸”æŒ‡å®šäº†<code>&#39;r+&#39;</code>æ¨¡å¼ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬æ‰“ç®—è¯»å–å¹¶å†™å…¥æ–‡ä»¶ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†å­—ç¬¦ä¸²<code>&#39;XYZ&#39;</code>å†™å…¥æ–‡ä»¶çš„å¼€å¤´ï¼Œå› ä¸ºæˆ‘ä»¬å°†<code>position</code>å‚æ•°è®¾ç½®ä¸º<code>0</code>ã€‚æœ€åï¼Œæˆ‘ä»¬å…³é—­äº†æ–‡ä»¶ã€‚</p><h3 id="æ€»ç»“-15" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-15"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡<code>fs.writeSync</code>æ–¹æ³•ï¼ŒNode.js æä¾›äº†ä¸€ç§æ–¹ä¾¿çš„æ–¹å¼æ¥åŒæ­¥åœ°å‘æ–‡ä»¶ä¸­å†™å…¥æ•°æ®ã€‚è¿™åœ¨å¤„ç†æ–‡ä»¶æ—¶éå¸¸æœ‰ç”¨ï¼Œå°¤å…¶æ˜¯å½“ä½ éœ€è¦å³æ—¶æ›´æ–°æ–‡ä»¶å†…å®¹ï¼Œè€Œä¸å¸Œæœ›å¼•å…¥å¼‚æ­¥æ“ä½œå¤æ‚æ€§æ—¶ã€‚ä¸è¿‡ï¼Œè®°å¾—åœ¨æ“ä½œå®Œæ¯•åå…³é—­æ–‡ä»¶ï¼Œä»¥é¿å…èµ„æºæ³„éœ²ã€‚</p><h3 id="fs-writevsync-fd-buffers-position" tabindex="-1"><a class="header-anchor" href="#fs-writevsync-fd-buffers-position"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fswritevsyncfd-buffers-position" target="_blank" rel="noopener noreferrer">fs.writevSync(fd, buffers[, position])</a></span></a></h3><p>Node.js ä¸­çš„ <code>fs.writevSync</code> æ˜¯ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„å‡½æ•°ï¼Œå®ƒç”¨äºåŒæ­¥åœ°å°†å¤šä¸ª <code>Buffer</code> å¯¹è±¡å†™å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼ˆ<code>fd</code>ï¼‰æŒ‡å®šçš„æ–‡ä»¶ä¸­ã€‚åœ¨è¿™é‡Œï¼Œ&quot;åŒæ­¥&quot;æ„å‘³ç€ä»£ç å°†ä¼šé˜»å¡ï¼Œç›´åˆ°æ‰€æœ‰çš„æ•°æ®éƒ½è¢«å†™å…¥å®Œæˆï¼Œç¨‹åºæ‰ä¼šç»§ç»­æ‰§è¡Œåé¢çš„æ“ä½œã€‚ç°åœ¨æˆ‘ä¼šé€šè¿‡ç®€å•çš„ä¾‹å­æ¥è§£é‡Šè¿™ä¸ªå‡½æ•°æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç†è§£ä¸€ä¸‹æ¶‰åŠåˆ°çš„å‡ ä¸ªæ¦‚å¿µï¼š</p><ol><li><p><strong>æ–‡ä»¶æè¿°ç¬¦ï¼ˆfdï¼‰</strong>ï¼šå½“åœ¨æ“ä½œç³»ç»Ÿä¸­æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œç³»ç»Ÿä¼šä¸ºè¯¥æ–‡ä»¶åˆ†é…ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶æè¿°ç¬¦ã€‚è¿™ä¸ªæ ‡è¯†å¯ä»¥ç”¨æ¥è¯»å–æˆ–è€…å†™å…¥æ–‡ä»¶ã€‚</p></li><li><p><strong>Buffer</strong>ï¼šåœ¨ Node.js ä¸­ï¼ŒBuffer ç±»æ˜¯ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„ã€‚å¯ä»¥æƒ³è±¡æˆæ˜¯ä¸€ä¸ªå­˜æ”¾äºŒè¿›åˆ¶æ•°æ®çš„æ•°ç»„ã€‚</p></li><li><p><strong>position</strong>ï¼šè¿™ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œä»£è¡¨äº†å¼€å§‹å†™å…¥æ–‡ä»¶çš„ä½ç½®ã€‚å¦‚æœè®¾ç½®äº†è¿™ä¸ªå€¼ï¼Œå†™å…¥å°†ä»æ–‡ä»¶çš„æŒ‡å®šä½ç½®å¼€å§‹ï¼›å¦‚æœçœç•¥ï¼Œå†™å…¥å°†ä¼šä»å½“å‰æ–‡ä»¶çš„æœ«å°¾å¼€å§‹ã€‚</p></li></ol><p>ç°åœ¨ä¸¾ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼š</p><p>å‡è®¾ä½ éœ€è¦å‘ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­å†™å…¥ä¸¤æ®µæ–‡å­—ï¼Œä½†ä½ å¸Œæœ›ä»¥æ›´é«˜æ•ˆçš„æ–¹å¼è¿›è¡Œï¼Œå³ä¸€æ¬¡æ€§å†™å…¥è¿™ä¸¤æ®µæ–‡å­—ã€‚ä½¿ç”¨ <code>fs.writevSync</code> å¯ä»¥å¾ˆå¥½åœ°å®ç°è¿™ä¸ªç›®æ ‡ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸¤æ®µè¦å†™å…¥çš„æ–‡æœ¬</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> buffer1</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello, </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> buffer2</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">World!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// buffers æ•°ç»„åŒ…å«äº†è¦å†™å…¥çš„ Buffer å®ä¾‹</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> buffers</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> [</span><span style="color:#D8DEE9;">buffer1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer2</span><span style="color:#D8DEE9FF;">]</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶å‡†å¤‡å†™å…¥ï¼Œ&#39;w&#39; è¡¨ç¤ºå†™å…¥æ¨¡å¼</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">__dirname</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">openSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨ writevSync å‡½æ•°å†™å…¥ Buffer æ•°æ®</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writevSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffers</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å†™å…¥æ–‡ä»¶å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† Node.js çš„ <code>fs</code> æ¨¡å—å’Œ <code>path</code> æ¨¡å—ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ª Buffer å®ä¾‹ï¼Œåˆ†åˆ«åŒ…å«äº†æˆ‘ä»¬æƒ³è¦å†™å…¥æ–‡ä»¶çš„æ–‡å­—ã€‚</p><p>æ¥ç€ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>fs.openSync</code> æ–¹æ³•æ‰“å¼€æ–‡ä»¶ï¼ˆæˆ–è€…åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œå¦‚æœå®ƒè¿˜ä¸å­˜åœ¨çš„è¯ï¼‰ï¼Œå¹¶è·å¾—æ–‡ä»¶æè¿°ç¬¦ <code>fd</code>ã€‚</p><p>ä¹‹åï¼Œæˆ‘ä»¬è°ƒç”¨ <code>fs.writevSync</code> å‡½æ•°ï¼Œå¹¶ä¼ å…¥æ–‡ä»¶æè¿°ç¬¦ã€buffers æ•°ç»„ï¼ˆåŒ…å«æˆ‘ä»¬è¦å†™å…¥çš„ Buffer å¯¹è±¡ï¼‰ã€‚è¿™ä¸ªå‡½æ•°ä¼šåŒæ­¥åœ°å°†æ‰€æœ‰ Buffer ä¸­çš„æ•°æ®å†™å…¥åˆ°æ–‡ä»¶ä¸­ã€‚</p><p>æœ€åï¼Œä¸è¦å¿˜è®°å…³é—­æ–‡ä»¶æè¿°ç¬¦ï¼Œé¿å…èµ„æºæ³„éœ²ã€‚å¦‚æœåœ¨å†™å…¥è¿‡ç¨‹ä¸­æœ‰ä»»ä½•é”™è¯¯æŠ›å‡ºï¼Œæˆ‘ä»¬æ•æ‰è¿™ä¸ªé”™è¯¯å¹¶æ‰“å°åˆ°æ§åˆ¶å°ã€‚</p><p>æ‰§è¡Œå®Œè¿™æ®µä»£ç åï¼Œä½ åº”è¯¥èƒ½åœ¨ <code>example.txt</code> è¿™ä¸ªæ–‡ä»¶ä¸­çœ‹åˆ° &quot;Hello, World!&quot; è¿™æ®µæ–‡å­—ã€‚</p><p>ä½¿ç”¨ <code>fs.writevSync</code> çš„ä¸»è¦ä¼˜ç‚¹æ˜¯æå‡æ€§èƒ½ï¼Œå› ä¸ºå®ƒå‡å°‘äº†ç³»ç»Ÿè°ƒç”¨çš„æ¬¡æ•°ã€‚ç›¸æ¯”äºåˆ†åˆ«å¯¹æ¯ä¸ª Buffer è°ƒç”¨ <code>fs.writeSync</code>ï¼Œ<code>fs.writevSync</code> åªéœ€è¦è°ƒç”¨ä¸€æ¬¡å°±å¯ä»¥åŒæ—¶å†™å…¥å¤šä¸ª Bufferï¼Œè¿™æ ·åœ¨å¤„ç†å¤§é‡å°å†™å…¥æ“ä½œæ—¶èƒ½æ˜¾è‘—æå‡æ•ˆç‡ã€‚</p><h2 id="common-objects" tabindex="-1"><a class="header-anchor" href="#common-objects"><span><a href="https://nodejs.org/docs/latest/api/fs.html#common-objects" target="_blank" rel="noopener noreferrer">Common Objects</a></span></a></h2><p>åœ¨ Node.js ä¸­ï¼Œ&quot;Common Objects&quot;è¿™ä¸€æœ¯è¯­é€šå¸¸æŒ‡çš„æ˜¯åœ¨æŸä¸ªç‰¹å®š Node.js æ¨¡å— API æ–‡æ¡£ä¸­ç»å¸¸å‡ºç°æˆ–è¢«å¤šæ¬¡å¼•ç”¨çš„å¯¹è±¡ã€‚ä»¥æ–‡ä»¶ç³»ç»Ÿ(<code>fs</code>)æ¨¡å—ä¸ºä¾‹ï¼Œè¿™ä¸ªæ¨¡å—ä¸­ä¸€äº›å…¬å…±å¯¹è±¡å¯èƒ½åŒ…æ‹¬ç”¨äºè¡¨ç¤ºæ–‡ä»¶ä¿¡æ¯ã€è¯»å†™æµè®¾ç½®æˆ–é”™è¯¯å¤„ç†çš„å¯¹è±¡ã€‚</p><p>æˆªè‡³æˆ‘æœ€åçš„çŸ¥è¯†æ›´æ–°ï¼ˆ2023 å¹´å‰ï¼‰ï¼Œå…·ä½“åˆ° Node.js v21.7.1 ç‰ˆæœ¬çš„æ–‡æ¡£ï¼Œæˆ‘æ— æ³•ç›´æ¥æŸ¥çœ‹å½“ä¸‹ç‰ˆæœ¬çš„ç»†èŠ‚ã€‚ä½†æ˜¯ï¼Œæˆ‘å¯ä»¥æ ¹æ® Node.js å†å²ç‰ˆæœ¬ä¸­<code>fs</code>æ¨¡å—çš„å¸¸è§å¯¹è±¡ç»™ä½ ä¸€äº›åŸºæœ¬çš„æ¦‚å¿µå’Œä½¿ç”¨å®ä¾‹ã€‚è¯·æ³¨æ„ï¼Œéšç€ Node.js çš„æ›´æ–°è¿­ä»£ï¼Œä¸€äº› API å¯èƒ½å·²å‘ç”Ÿå˜åŒ–ã€‚</p><h3 id="å¸¸è§å¯¹è±¡ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å¸¸è§å¯¹è±¡ç¤ºä¾‹"><span>å¸¸è§å¯¹è±¡ç¤ºä¾‹</span></a></h3><p>ä»¥ä¸‹æ˜¯åœ¨ Node.js <code>fs</code>æ¨¡å—æ–‡æ¡£ä¸­å¯èƒ½é‡åˆ°çš„ä¸€äº›å¸¸ç”¨å¯¹è±¡å’Œå®ƒä»¬çš„åº”ç”¨å®ä¾‹ï¼š</p><h4 id="_1-stats-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_1-stats-å¯¹è±¡"><span>1. Stats å¯¹è±¡</span></a></h4><p><code>Stats</code>å¯¹è±¡æä¾›äº†å…³äºæ–‡ä»¶ç³»ç»Ÿå¯¹è±¡ï¼ˆå¦‚æ–‡ä»¶ã€ç›®å½•ï¼‰çš„ä¿¡æ¯ã€‚é€šè¿‡<code>fs.stat()</code>ã€<code>fs.statSync()</code>ã€æˆ–è€…ä¸ä¹‹ç›¸å…³çš„å‡½æ•°è°ƒç”¨å¯ä»¥è·å–åˆ°è¿™ä¸ªå¯¹è±¡ã€‚</p><p>å®ä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥è·å–æ–‡ä»¶çŠ¶æ€</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨statså¯¹è±¡</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶å¤§å°: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">size</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">å­—èŠ‚</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ˜¯æ–‡ä»¶: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFile</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ˜¯ç›®å½•: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isDirectory</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-readstream-å’Œ-writestream-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_2-readstream-å’Œ-writestream-å¯¹è±¡"><span>2. ReadStream å’Œ WriteStream å¯¹è±¡</span></a></h4><p>è¿™äº›å¯¹è±¡åˆ†åˆ«è¡¨ç¤ºå¯è¯»æµå’Œå¯å†™æµã€‚åœ¨<code>fs</code>æ¨¡å—ä¸­ï¼Œé€šè¿‡<code>fs.createReadStream()</code>å’Œ<code>fs.createWriteStream()</code>æ–¹æ³•åˆ›å»ºè¿™äº›æµï¼Œç”¨äºæ–‡ä»¶çš„è¯»å–å’Œå†™å…¥æ“ä½œã€‚</p><p>å®ä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªå¯è¯»æµ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> readStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">input.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªå¯å†™æµ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> writeStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">output.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å°†input.txtçš„å†…å®¹å¤åˆ¶åˆ°output.txt</span></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">pipe</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">writeStream</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å¤åˆ¶å®Œæˆ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-fswatcher-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_3-fswatcher-å¯¹è±¡"><span>3. FSWatcher å¯¹è±¡</span></a></h4><p>é€šè¿‡<code>fs.watch()</code>æ–¹æ³•è¿”å›ï¼Œç”¨äºç›‘è§†æ–‡ä»¶æˆ–ç›®å½•çš„å˜åŒ–ï¼ˆå¦‚æ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤äº‹ä»¶ï¼‰ã€‚</p><p>å®ä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘è§†&#39;example.txt&#39;æ–‡ä»¶çš„å˜åŒ–</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> watcher</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> filename</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">äº‹ä»¶ç±»å‹æ˜¯: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">eventType</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">filename</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">å˜æ›´çš„æ–‡ä»¶å: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filename</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶åä¸å¯ç”¨</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä¸€æ®µæ—¶é—´åå…³é—­æ–‡ä»¶ç›‘è§†å™¨</span></span>
<span class="line"><span style="color:#88C0D0;">setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  watcher</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 10000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç»“è®º-4" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-4"><span>ç»“è®º</span></a></h3><p>Node.js çš„<code>fs</code>æ¨¡å—æä¾›äº†å„ç§å¼ºå¤§çš„ API æ¥ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’ï¼Œå…¶ä¸­æ¶‰åŠçš„&quot;Common Objects&quot;æ˜¯ç†è§£å’Œä½¿ç”¨è¿™äº› API çš„å…³é”®ã€‚ä¸Šé¢åˆ—å‡ºçš„å‡ ä¸ªä¾‹å­åªæ˜¯å†°å±±ä¸€è§’ï¼Œå®é™…ä¸Š Node.js å’Œå…¶<code>fs</code>æ¨¡å—èƒ½åšçš„è¿œä¸æ­¢è¿™äº›ã€‚å»ºè®®æ·±å…¥é˜…è¯» Node.js å®˜æ–¹æ–‡æ¡£ï¼Œä»¥è·å¾—æœ€å…¨é¢ã€æœ€å‡†ç¡®çš„ä¿¡æ¯ã€‚</p><h3 id="class-fs-dir" tabindex="-1"><a class="header-anchor" href="#class-fs-dir"><span><a href="https://nodejs.org/docs/latest/api/fs.html#class-fsdir" target="_blank" rel="noopener noreferrer">Class: fs.Dir</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„ JavaScript è¿è¡Œæ—¶ï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œ JavaScript ä»£ç ã€‚Node.js æä¾›äº†å¾ˆå¤šæ¨¡å—ï¼Œå¸®åŠ©å¼€å‘è€…è½»æ¾åœ°å®Œæˆå„ç§ä»»åŠ¡ã€‚å…¶ä¸­ï¼Œ<code>fs</code>ï¼ˆFile Systemï¼‰æ¨¡å—å°±æ˜¯ç”¨äºæ“ä½œæ–‡ä»¶ç³»ç»Ÿçš„ã€‚åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>fs.Dir</code>æ˜¯<code>fs</code>æ¨¡å—ä¸‹çš„ä¸€ä¸ªç±»ï¼Œå®ƒè¡¨ç¤ºæ–‡ä»¶ç³»ç»Ÿç›®å½•çš„ä¸€ä¸ªæŠ½è±¡ã€‚</p><h3 id="ç†è§£fs-dir" tabindex="-1"><a class="header-anchor" href="#ç†è§£fs-dir"><span>ç†è§£<code>fs.Dir</code></span></a></h3><p>ç®€å•æ¥è¯´ï¼Œ<code>fs.Dir</code>å¯¹è±¡ç”¨äºè¡¨ç¤ºä¸€ä¸ªç›®å½•ï¼ˆä¹Ÿå°±æ˜¯æ–‡ä»¶å¤¹ï¼‰çš„å†…å®¹ã€‚å®ƒæä¾›æ–¹æ³•æ¥è¯»å–ç›®å½•ä¸­çš„å†…å®¹ï¼ˆæ¯”å¦‚æ–‡ä»¶å’Œå…¶ä»–ç›®å½•ï¼‰ï¼Œè¿™æ ·ä½ å¯ä»¥éå†æˆ–è€…å¤„ç†ç›®å½•ä¸­çš„é¡¹ç›®ã€‚</p><h3 id="åˆ›å»ºfs-dirå®ä¾‹" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºfs-dirå®ä¾‹"><span>åˆ›å»º<code>fs.Dir</code>å®ä¾‹</span></a></h3><p>é€šå¸¸ï¼Œä½ ä¸ä¼šç›´æ¥åˆ›å»º<code>fs.Dir</code>å®ä¾‹ã€‚å®ƒä»¬æ˜¯é€šè¿‡ä½¿ç”¨<code>fs.opendir</code>ã€<code>fs.opendirSync</code>æˆ–è€…<code>fs.promises.opendir</code>ç­‰å‡½æ•°é—´æ¥åˆ›å»ºçš„ã€‚è¿™äº›å‡½æ•°ç”¨äºæ‰“å¼€ä¸€ä¸ªç›®å½•ï¼Œå¹¶è¿”å›ä¸€ä¸ª<code>fs.Dir</code>å¯¹è±¡ï¼Œé€šè¿‡è¿™ä¸ªå¯¹è±¡å¯ä»¥æ“ä½œè¯¥ç›®å½•ã€‚</p><h3 id="fs-dirçš„æ ¸å¿ƒæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#fs-dirçš„æ ¸å¿ƒæ–¹æ³•"><span><code>fs.Dir</code>çš„æ ¸å¿ƒæ–¹æ³•</span></a></h3><ul><li><code>dir.read()</code>: å¼‚æ­¥åœ°è¯»å–ç›®å½•çš„ä¸‹ä¸€ä¸ªæ¡ç›®ï¼ˆå³æ–‡ä»¶æˆ–å­ç›®å½•ï¼‰ã€‚å¦‚æœè¯»å–æˆåŠŸï¼Œè¿”å›ä¸€ä¸ª<code>fs.Dirent</code>å¯¹è±¡ï¼Œå¦åˆ™è¿”å›<code>null</code>ã€‚</li><li><code>dir.readSync()</code>: åŒæ­¥ç‰ˆæœ¬çš„<code>dir.read()</code>ã€‚å®ƒç›´æ¥è¿”å›ä¸€ä¸ª<code>fs.Dirent</code>å¯¹è±¡æˆ–<code>null</code>ã€‚</li><li><code>dir.close()</code>: å¼‚æ­¥åœ°å…³é—­ç›®å½•ï¼Œé‡Šæ”¾åº•å±‚èµ„æºã€‚</li><li><code>dir.closeSync()</code>: åŒæ­¥ç‰ˆæœ¬çš„<code>dir.close()</code>ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ä¾‹å­-7" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-7"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æƒ³è¦åˆ—å‡ºä¸€ä¸ªç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> listDir</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> dir</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">opendir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ‰“å¼€ä¸€ä¸ªç›®å½•</span></span>
<span class="line"><span style="color:#81A1C1;">  for</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#81A1C1;"> of</span><span style="color:#D8DEE9;"> dir</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ‰“å°ç›®å½•ä¸­çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹å</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">listDir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./test-directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†<code>fs.promises.opendir</code>æ¥å¼‚æ­¥æ‰“å¼€ä¸€ä¸ªç›®å½•ã€‚ç„¶åï¼Œä½¿ç”¨<code>for await...of</code>å¾ªç¯æ¥è¿­ä»£<code>dir</code>å¯¹è±¡ï¼ˆè¿™é‡Œçš„<code>dir</code>å°±æ˜¯ä¸€ä¸ª<code>fs.Dir</code>å®ä¾‹ï¼‰ï¼Œæ¯æ¬¡è¿­ä»£å¯ä»¥è·å–ç›®å½•ä¸­çš„ä¸€ä¸ªé¡¹ï¼ˆ<code>fs.Dirent</code>å¯¹è±¡ï¼‰ï¼Œæˆ‘ä»¬æ‰“å°å‡ºäº†æ¯ä¸ªé¡¹çš„åç§°ã€‚</p><p>è¿™åªæ˜¯<code>fs.Dir</code>ç±»çš„ä¸€ä¸ªåŸºç¡€åº”ç”¨ç¤ºä¾‹ï¼Œä½†å®ƒå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Node.js å¤„ç†æ–‡ä»¶ç³»ç»Ÿä¸­çš„ç›®å½•ã€‚é€šè¿‡ç»“åˆå…¶ä»–<code>fs</code>æ¨¡å—æä¾›çš„åŠŸèƒ½ï¼Œä½ å¯ä»¥åˆ›å»ºæ›´å¤æ‚çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼Œæ¯”å¦‚é€’å½’éå†æ•´ä¸ªç›®å½•æ ‘ã€ç­›é€‰ç‰¹å®šç±»å‹çš„æ–‡ä»¶ç­‰ã€‚</p><h4 id="dir-close" tabindex="-1"><a class="header-anchor" href="#dir-close"><span><a href="https://nodejs.org/docs/latest/api/fs.html#dirclose" target="_blank" rel="noopener noreferrer">dir.close()</a></span></a></h4><p>å½“ä½ åœ¨ä½¿ç”¨ Node.js è¿›è¡Œç¼–ç¨‹æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°éœ€è¦è¯»å–æˆ–æ“ä½œæ–‡ä»¶ç³»ç»Ÿçš„æƒ…å½¢ã€‚è¿™é‡Œæˆ‘ä»¬æ¥è¯¦ç»†åœ°è§£é‡Šä¸€ä¸‹ Node.js ä¸­<code>dir.close()</code>æ–¹æ³•çš„ç”¨é€”ã€å·¥ä½œåŸç†ä»¥åŠå®ƒçš„ä¸€äº›å®é™…åº”ç”¨ä¾‹å­ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯dir-close" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯dir-close"><span>ä»€ä¹ˆæ˜¯<code>dir.close()</code>ï¼Ÿ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>dir.close()</code>æ˜¯ä¸€ä¸ªç”¨äºå…³é—­ç”±<code>fs.opendir()</code>ã€<code>fs.opendirSync()</code>æˆ–è€…<code>fsPromises.opendir()</code>æ‰“å¼€çš„ç›®å½•çš„æ–¹æ³•ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå½“ä½ æ‰“å¼€ä¸€ä¸ªç›®å½•ä»¥è¿›è¡Œè¯»å–æˆ–å…¶ä»–æ“ä½œåï¼Œå®Œæˆæ“ä½œæ—¶åº”è¯¥å…³é—­è¯¥ç›®å½•ã€‚è¿™æ ·åšå¯ä»¥é‡Šæ”¾ç³»ç»Ÿèµ„æºï¼Œé¿å…èµ„æºæ³„æ¼ï¼Œå¹¶ä¿è¯ç¨‹åºçš„å¥å£®æ€§å’Œæ•ˆç‡ã€‚</p><h3 id="å¦‚ä½•å·¥ä½œ" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•å·¥ä½œ"><span>å¦‚ä½•å·¥ä½œï¼Ÿ</span></a></h3><p>å½“ä½ è°ƒç”¨<code>fs.opendir()</code>æˆ–å…¶åŒæ­¥/å¼‚æ­¥å˜ä½“æ‰“å¼€ä¸€ä¸ªç›®å½•æ—¶ï¼ŒNode.js å°†è¿”å›ä¸€ä¸ª<code>Dir</code>å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡ä»£è¡¨äº†ä½ æ‰€æ‰“å¼€çš„ç›®å½•ï¼Œé€šè¿‡è¿™ä¸ªå¯¹è±¡ä½ å¯ä»¥è¿›è¡Œè¿›ä¸€æ­¥çš„æ“ä½œï¼Œæ¯”å¦‚è¯»å–ç›®å½•å†…å®¹ã€‚å®Œæˆå¯¹ç›®å½•çš„æ‰€æœ‰æ“ä½œåï¼Œä½ åº”è¯¥è°ƒç”¨<code>dir.close()</code>ï¼ˆå¯¹äºå¼‚æ­¥æ“ä½œå¯èƒ½æ˜¯<code>await dir.close()</code>ï¼‰æ¥å…³é—­è¿™ä¸ªç›®å½•ã€‚å¦‚æœä¸æ‰‹åŠ¨å…³é—­ï¼ŒNode.js ä¼šåœ¨åƒåœ¾å›æ”¶æ—¶è‡ªåŠ¨å…³é—­å®ƒï¼Œä½†æ˜¾å¼å…³é—­æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-8" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-8"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><h4 id="ä¾‹å­-1-åŒæ­¥æ–¹å¼æ‰“å¼€å’Œå…³é—­ç›®å½•" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-åŒæ­¥æ–¹å¼æ‰“å¼€å’Œå…³é—­ç›®å½•"><span>ä¾‹å­ 1ï¼šåŒæ­¥æ–¹å¼æ‰“å¼€å’Œå…³é—­ç›®å½•</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> dir</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">opendirSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  while</span><span style="color:#D8DEE9FF;"> ((</span><span style="color:#D8DEE9;">dirent</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> dir</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readSync</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#81A1C1;">!==</span><span style="color:#81A1C1;"> null</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å®Œæˆç›®å½•æ“ä½œåï¼Œå…³é—­ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">  dir</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>fs.opendirSync()</code>åŒæ­¥åœ°æ‰“å¼€ä¸€ä¸ªç›®å½•ï¼Œç„¶åä½¿ç”¨<code>dir.readSync()</code>è¯»å–ç›®å½•ä¸­çš„æ¯ä¸€é¡¹ï¼Œæ‰“å°å‡ºå®ƒä»¬çš„åç§°ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨<code>dir.closeSync()</code>æ¥å…³é—­è¿™ä¸ªç›®å½•ã€‚</p><h4 id="ä¾‹å­-2-å¼‚æ­¥æ–¹å¼æ‰“å¼€å’Œå…³é—­ç›®å½•" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-å¼‚æ­¥æ–¹å¼æ‰“å¼€å’Œå…³é—­ç›®å½•"><span>ä¾‹å­ 2ï¼šå¼‚æ­¥æ–¹å¼æ‰“å¼€å’Œå…³é—­ç›®å½•</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readAndCloseDir</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> dir</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">opendir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  for</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#81A1C1;"> of</span><span style="color:#D8DEE9;"> dir</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å®Œæˆç›®å½•æ“ä½œåï¼Œå…³é—­ç›®å½•</span></span>
<span class="line"><span style="color:#81A1C1;">  await</span><span style="color:#D8DEE9;"> dir</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">readAndCloseDir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨å¼‚æ­¥æ–¹å¼é€šè¿‡<code>fs.promises.opendir()</code>æ‰“å¼€ä¸€ä¸ªç›®å½•ï¼Œä½¿ç”¨<code>for-await-of</code>å¾ªç¯æ¥å¼‚æ­¥è¯»å–ç›®å½•ä¸­çš„æ¯ä¸€é¡¹ï¼Œæœ€åé€šè¿‡<code>await dir.close()</code>å…³é—­ç›®å½•ã€‚</p><h3 id="å°ç»“-11" tabindex="-1"><a class="header-anchor" href="#å°ç»“-11"><span>å°ç»“</span></a></h3><p>ä½¿ç”¨<code>dir.close()</code>æˆ–<code>dir.closeSync()</code>å…³é—­æ‰“å¼€çš„ç›®å½•æ˜¯ Node.js ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªé‡è¦è€ŒåŸºæœ¬çš„æ“ä½œã€‚å®ƒå¸®åŠ©æˆ‘ä»¬æœ‰æ•ˆç®¡ç†ç³»ç»Ÿèµ„æºï¼Œé˜²æ­¢èµ„æºæ³„éœ²ï¼Œå¹¶ç¡®ä¿ç¨‹åºèƒ½å¤Ÿé«˜æ•ˆç¨³å®šåœ°è¿è¡Œã€‚ä»¥ä¸Šä¾‹å­å±•ç¤ºäº†å¦‚ä½•åœ¨å®è·µä¸­åº”ç”¨è¿™äº›æ¦‚å¿µï¼Œæ— è®ºæ˜¯åœ¨åŒæ­¥è¿˜æ˜¯å¼‚æ­¥æ¨¡å¼ä¸‹ã€‚</p><h4 id="dir-close-callback" tabindex="-1"><a class="header-anchor" href="#dir-close-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#dirclosecallback" target="_blank" rel="noopener noreferrer">dir.close(callback)</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç çš„ç¯å¢ƒã€‚å®ƒè®©å¼€å‘è€…èƒ½ä½¿ç”¨ JavaScript æ¥ç¼–å†™åç«¯ä»£ç ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨åŒä¸€ç§è¯­è¨€ç¼–å†™å‰ç«¯å’Œåç«¯ä»£ç ï¼Œä½¿æ•´ä¸ªå¼€å‘è¿‡ç¨‹æ›´åŠ é«˜æ•ˆå’Œç»Ÿä¸€ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„æ ¸å¿ƒæ¨¡å—ï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶ã€åˆ›å»ºæ–‡ä»¶ã€ä¿®æ”¹æ–‡ä»¶ç­‰ã€‚è¿™ä¸ªæ¨¡å—æä¾›äº†ä¸¤ç§ä¸»è¦çš„æ–¹å¼æ¥å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼šå¼‚æ­¥ï¼ˆéé˜»å¡ï¼‰å’ŒåŒæ­¥ï¼ˆé˜»å¡ï¼‰ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨å¼‚æ­¥æ–¹æ³•ï¼Œå› ä¸ºå®ƒä»¬ä¸ä¼šé˜»å¡ Node.js äº‹ä»¶å¾ªç¯ï¼Œä»è€Œä½¿å¾—åº”ç”¨å¯ä»¥å¤„ç†æ›´å¤šçš„äº‹åŠ¡ã€‚</p><h3 id="dir-close-callback-1" tabindex="-1"><a class="header-anchor" href="#dir-close-callback-1"><span><code>dir.close(callback)</code></span></a></h3><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥å…·ä½“çœ‹çœ‹<code>dir.close(callback)</code>è¿™ä¸ªæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ç”¨äºå…³é—­ä¸€ä¸ªç”±<code>fs.opendir()</code>æˆ–<code>fs.opendirSync()</code>æ‰“å¼€çš„ç›®å½•çš„æ–‡ä»¶æè¿°ç¬¦ã€‚ç®€å•æ¥è¯´ï¼Œå½“ä½ å®Œæˆäº†å¯¹ç›®å½•çš„æ“ä½œï¼ˆå¦‚è¯»å–ç›®å½•ä¸­çš„æ–‡ä»¶ï¼‰ï¼Œä¸ºäº†é‡Šæ”¾èµ„æºï¼Œä½ éœ€è¦å…³é—­ç›®å½•ã€‚</p><h4 id="å‚æ•°è§£é‡Š-33" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-33"><span>å‚æ•°è§£é‡Š</span></a></h4><ul><li><code>callback</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå½“<code>dir.close()</code>æ“ä½œå®Œæˆæ—¶è¢«è°ƒç”¨ã€‚å¦‚æœå…³é—­æ“ä½œæˆåŠŸï¼Œå›è°ƒå‡½æ•°å°†ä¸ä¼šæ¥æ”¶ä»»ä½•å‚æ•°ï¼Œä½†å¦‚æœå¤±è´¥ï¼Œåˆ™ç¬¬ä¸€ä¸ªå‚æ•°ä¼šåŒ…å«ä¸€ä¸ªé”™è¯¯å¯¹è±¡ã€‚</li></ul><h4 id="ä¸¾ä¾‹è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#ä¸¾ä¾‹è¯´æ˜"><span>ä¸¾ä¾‹è¯´æ˜</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js åº”ç”¨ï¼Œéœ€è¦åˆ—å‡ºæŸä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œç„¶åå†å…³é—­è¯¥ç›®å½•ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨<code>dir.close(callback)</code>å®ç°è¿™ä¸€åŠŸèƒ½çš„ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€å½“å‰ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">opendir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">__dirname</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dir</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ‰“å¼€ç›®å½•æ—¶å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å¼‚æ­¥åœ°è¯»å–ç›®å½•ä¸­çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#88C0D0;"> readDirFiles</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    dir</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">error</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–ç›®å½•æ–‡ä»¶æ—¶å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        return;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">      // å¦‚æœdirentä¸ºnullï¼Œè¡¨ç¤ºå·²ç»è¯»å–å®Œæ‰€æœ‰æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">dirent</span><span style="color:#81A1C1;"> ===</span><span style="color:#81A1C1;"> null</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">        // å…³é—­ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">        dir</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">closeErr</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">          if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">closeErr</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">            console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å…³é—­ç›®å½•æ—¶å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> closeErr</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">            return;</span></span>
<span class="line"><span style="color:#ECEFF4;">          }</span></span>
<span class="line"><span style="color:#D8DEE9;">          console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›®å½•å·²å…³é—­</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        return;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">      // è¾“å‡ºæ–‡ä»¶å</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#88C0D0;">      readDirFiles</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // é€’å½’è¯»å–ä¸‹ä¸€ä¸ªæ–‡ä»¶</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">  readDirFiles</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•å¼‚æ­¥åœ°æ‰“å¼€ã€è¯»å–å¹¶æœ€ç»ˆå…³é—­ä¸€ä¸ªç›®å½•ã€‚é¦–å…ˆï¼Œä½¿ç”¨<code>fs.opendir()</code>å¼‚æ­¥æ‰“å¼€å½“å‰è„šæœ¬æ‰€åœ¨çš„ç›®å½•ã€‚ç„¶åï¼Œé€šè¿‡é€’å½’è°ƒç”¨<code>dir.read()</code>è¯»å–ç›®å½•å†…çš„æ¯ä¸ªæ–‡ä»¶ã€‚å½“å…¨éƒ¨æ–‡ä»¶éƒ½è¯»å–å®Œæ¯•ï¼ˆ<code>dir.read()</code>è¿”å› null æ—¶ï¼‰ï¼Œè°ƒç”¨<code>dir.close()</code>å…³é—­ç›®å½•ï¼Œå¹¶åœ¨å…³é—­æ“ä½œå®Œæˆåè¾“å‡º&quot;ç›®å½•å·²å…³é—­&quot;æ¶ˆæ¯ã€‚</p><p>è¿™ç§å¤„ç†æ–¹å¼ç¡®ä¿äº†å³ä½¿åœ¨å¤„ç†å¤§é‡æ–‡ä»¶çš„æƒ…å†µä¸‹ï¼Œåº”ç”¨ä¹Ÿä¸ä¼šé˜»å¡ï¼Œå…è®¸ Node.js ç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œå¦‚å“åº”ç”¨æˆ·è¯·æ±‚ã€‚</p><h4 id="dir-closesync" tabindex="-1"><a class="header-anchor" href="#dir-closesync"><span><a href="https://nodejs.org/docs/latest/api/fs.html#dirclosesync" target="_blank" rel="noopener noreferrer">dir.closeSync()</a></span></a></h4><p><code>dir.closeSync()</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºåŒæ­¥åœ°å…³é—­ä¸€ä¸ªç›®å½•çš„æ–‡ä»¶æè¿°ç¬¦ã€‚è¿™ä¸ªæ–¹æ³•å±äº <code>fs</code> æ¨¡å—ï¼ˆæ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼‰ï¼Œå®ƒå…è®¸ä½ ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’ï¼ŒåŒ…æ‹¬è¯»å–æ–‡ä»¶ã€å†™å…¥æ–‡ä»¶ã€æ“ä½œç›®å½•ç­‰ã€‚åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œè¿™ä¸ªæ–¹æ³•ä¾ç„¶æ˜¯æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„ä¸€éƒ¨åˆ†ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-17" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-17"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><h4 id="æ–‡ä»¶æè¿°ç¬¦" tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶æè¿°ç¬¦"><span>æ–‡ä»¶æè¿°ç¬¦</span></a></h4><ul><li>æ–‡ä»¶æè¿°ç¬¦æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œä»£è¡¨æ“ä½œç³»ç»Ÿä¸­æ‰“å¼€æ–‡ä»¶çš„å¼•ç”¨ã€‚å½“ä½ æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œä¹‹åä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªæè¿°ç¬¦æ¥è¯»å–æ–‡ä»¶ã€å†™å…¥æ–‡ä»¶æˆ–æ‰§è¡Œå…¶ä»–æ“ä½œã€‚</li></ul><h4 id="åŒæ­¥å’Œå¼‚æ­¥" tabindex="-1"><a class="header-anchor" href="#åŒæ­¥å’Œå¼‚æ­¥"><span>åŒæ­¥å’Œå¼‚æ­¥</span></a></h4><ul><li>åœ¨ Node.js ä¸­ï¼Œå¤§å¤šæ•°æ–‡ä»¶ç³»ç»Ÿçš„æ“ä½œéƒ½æœ‰ä¸¤ç§å½¢å¼ï¼šåŒæ­¥å’Œå¼‚æ­¥ã€‚å¼‚æ­¥æ–¹æ³•ä¸ä¼šé˜»å¡ç¨‹åºçš„æ‰§è¡Œï¼Œè€ŒåŒæ­¥æ–¹æ³•ä¼šã€‚<code>dir.closeSync()</code> å°±æ˜¯ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œè°ƒç”¨å®ƒä¼šç«‹å³å…³é—­ç›®å½•ï¼Œå¹¶ä¸”ç›´åˆ°æ“ä½œå®Œæˆæ‰ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç ã€‚</li></ul><h3 id="ä½¿ç”¨-dir-closesync" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-dir-closesync"><span>ä½¿ç”¨ <code>dir.closeSync()</code></span></a></h3><p>æƒ³è¦ä½¿ç”¨ <code>dir.closeSync()</code> æ–¹æ³•ï¼Œä½ é¦–å…ˆéœ€è¦æ‰“å¼€ä¸€ä¸ªç›®å½•ã€‚è¿™é€šå¸¸é€šè¿‡ <code>fs.opendirSync()</code> æ–¹æ³•å®Œæˆï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ª <code>Dir</code> å¯¹è±¡ï¼Œä¹‹åä½ å°±å¯ä»¥å¯¹è¿™ä¸ªå¯¹è±¡è°ƒç”¨ <code>closeSync()</code> æ–¹æ³•æ¥å…³é—­ç›®å½•ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åŒæ­¥åœ°æ‰“å¼€å½“å‰ç›®å½•</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dir</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">opendirSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰§è¡Œä¸€äº›æ“ä½œ...</span></span>
<span class="line"><span style="color:#616E88;">// æ¯”å¦‚éå†ç›®å½•ä¸­çš„æ–‡ä»¶</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æœ€åï¼ŒåŒæ­¥åœ°å…³é—­ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">dir</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-21" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-21"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="éå†ç›®å½•åˆ é™¤ç‰¹å®šæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#éå†ç›®å½•åˆ é™¤ç‰¹å®šæ–‡ä»¶"><span>éå†ç›®å½•åˆ é™¤ç‰¹å®šæ–‡ä»¶</span></a></h4><p>å‡è®¾ä½ æƒ³è¦éå†ä¸€ä¸ªç›®å½•ï¼Œå¹¶åˆ é™¤æ‰€æœ‰ <code>.tmp</code> ç»“å°¾çš„ä¸´æ—¶æ–‡ä»¶ã€‚ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨ <code>dir.closeSync()</code> æ¥å®ç°çš„ä¸€ä¸ªä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> dir</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">opendirSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./someDirectory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  while</span><span style="color:#D8DEE9FF;"> ((</span><span style="color:#D8DEE9;">dirent</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> dir</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readSync</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#81A1C1;">!==</span><span style="color:#81A1C1;"> null</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">endsWith</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">.tmp</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">      // åˆ é™¤ä»¥ .tmp ç»“å°¾çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">      fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unlinkSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./someDirectory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å®Œæˆæ“ä½œåå…³é—­ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">  dir</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">å‡ºé”™äº†: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">err</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é¦–å…ˆæ‰“å¼€äº†ä¸€ä¸ªåä¸º <code>someDirectory</code> çš„ç›®å½•ï¼Œç„¶åä½¿ç”¨ <code>while</code> å¾ªç¯éå†ç›®å½•ä¸­çš„æ¯ä¸€ä¸ªæ–‡ä»¶ï¼ˆæˆ–ç›®å½•ï¼‰ã€‚å¦‚æœä¸€ä¸ªæ–‡ä»¶çš„åç§°ä»¥ <code>.tmp</code> ç»“å°¾ï¼Œé‚£ä¹ˆå®ƒå°±è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œåº”è¯¥è¢«åˆ é™¤ã€‚å®Œæˆæ‰€æœ‰æ“ä½œåï¼Œä½¿ç”¨ <code>dir.closeSync()</code> æ–¹æ³•å…³é—­äº†ç›®å½•ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿é‡Šæ”¾èµ„æºï¼Œé¿å…èµ„æºæ³„éœ²ã€‚</p><h3 id="æ€»ç»“-16" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-16"><span>æ€»ç»“</span></a></h3><p><code>dir.closeSync()</code> æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿæ“ä½œä¸­çš„ä¸€ä¸ªé‡è¦æ–¹æ³•ï¼Œç”¨äºåŒæ­¥å…³é—­å·²æ‰“å¼€çš„ç›®å½•ã€‚åœ¨å¤„ç†æ–‡ä»¶å’Œç›®å½•æ—¶ï¼Œé€‚æ—¶åœ°å…³é—­ä¸å†éœ€è¦çš„ç›®å½•æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œæœ‰åŠ©äºä¼˜åŒ–èµ„æºä½¿ç”¨å’Œæé«˜åº”ç”¨æ€§èƒ½ã€‚</p><h4 id="dir-path" tabindex="-1"><a class="header-anchor" href="#dir-path"><span><a href="https://nodejs.org/docs/latest/api/fs.html#dirpath" target="_blank" rel="noopener noreferrer">dir.path</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªè®© JavaScript å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œçš„å¹³å°ã€‚å®ƒå…è®¸å¼€å‘è€…ä½¿ç”¨ JavaScript æ¥ç¼–å†™åç«¯ä»£ç ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨åŒä¸€ç§è¯­è¨€æ¥ç¼–å†™å‰ç«¯å’Œåç«¯ï¼Œæé«˜äº†å¼€å‘æ•ˆç‡ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code>æ¨¡å—æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„åº“ï¼Œæ¯”å¦‚è¯»å†™æ–‡ä»¶ã€éå†ç›®å½•ç­‰ã€‚è¿™ä¸ªæ¨¡å—æä¾›äº†å¾ˆå¤šå®ç”¨çš„åŠŸèƒ½æ¥å¸®åŠ©å¼€å‘è€…ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’ã€‚</p><p>å½“æˆ‘ä»¬è°ˆè®º <code>Dir.path</code> å±æ€§æ—¶ï¼Œæˆ‘ä»¬æŒ‡çš„æ˜¯ <code>fs.Dir</code> ç±»çš„ä¸€ä¸ªå±æ€§ã€‚ç®€å•æ¥è¯´ï¼Œå½“ä½ ä½¿ç”¨ <code>fs.opendir()</code> æˆ–è€…ç±»ä¼¼çš„æ–¹å¼æ‰“å¼€ä¸€ä¸ªç›®å½•ä»¥è¿›è¡Œæ“ä½œæ—¶ï¼ˆä¾‹å¦‚éå†ç›®å½•å†…çš„æ–‡ä»¶ï¼‰ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ª <code>Dir</code> ç±»çš„å®ä¾‹ã€‚è¿™ä¸ªå®ä¾‹çš„ <code>.path</code> å±æ€§å°±åŒ…å«äº†ä½ æ‰€æ‰“å¼€çš„ç›®å½•çš„è·¯å¾„ã€‚</p><h3 id="ä¸¾ä¾‹" tabindex="-1"><a class="header-anchor" href="#ä¸¾ä¾‹"><span>ä¸¾ä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç›®å½• <code>/photos</code> ï¼Œå¹¶ä¸”æˆ‘ä»¬æƒ³è¦åˆ—å‡ºè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Node.js çš„ <code>fs</code> æ¨¡å—æ¥åšåˆ°è¿™ä¸€ç‚¹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // ä½¿ç”¨ promises æ¥å£ï¼Œä½¿å¾—å¼‚æ­¥æ“ä½œæ›´åŠ æ–¹ä¾¿</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> listFiles</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> dir</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">opendir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ‰“å¼€ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Directory path: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">dir</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">path</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ‰“å°å‡ºç›®å½•è·¯å¾„</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  for</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#81A1C1;"> of</span><span style="color:#D8DEE9;"> dir</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // å¾ªç¯éå†ç›®å½•å†…çš„æ¯ä¸ªæ–‡ä»¶/ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ‰“å°å‡ºæ–‡ä»¶æˆ–ç›®å½•çš„åç§°</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">listFiles</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/photos</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è°ƒç”¨å‡½æ•°ï¼Œå¹¶å¤„ç†å¯èƒ½å‡ºç°çš„é”™è¯¯</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼š</p><ol><li>æˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† <code>fs</code> æ¨¡å—ï¼Œå¹¶é€‰æ‹©ä½¿ç”¨åŸºäº Promise çš„ APIï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ <code>async/await</code> è¯­æ³•æ¥ç®€åŒ–å¼‚æ­¥æ“ä½œã€‚</li><li>å®šä¹‰äº†ä¸€ä¸ª <code>listFiles</code> å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªç›®å½•è·¯å¾„ä½œä¸ºå‚æ•°ã€‚</li><li>åœ¨è¿™ä¸ªå‡½æ•°å†…éƒ¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>fs.opendir()</code> æ–¹æ³•å°è¯•æ‰“å¼€ç»™å®šè·¯å¾„çš„ç›®å½•ï¼Œè¿™å°†è¿”å›ä¸€ä¸ª <code>Dir</code> å¯¹è±¡ã€‚</li><li>æˆ‘ä»¬é€šè¿‡è®¿é—® <code>dir.path</code> æ¥è·å–å¹¶æ‰“å°å½“å‰æ‰“å¼€çš„ç›®å½•è·¯å¾„ã€‚</li><li>ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>for await...of</code> å¾ªç¯æ¥éå†ç›®å½•é‡Œçš„æ¯ä¸€é¡¹ï¼ˆæ— è®ºæ˜¯æ–‡ä»¶è¿˜æ˜¯å­ç›®å½•ï¼‰ï¼Œæ¯é¡¹éƒ½è¢«è¡¨ç¤ºä¸ºä¸€ä¸ª <code>Dirent</code> å¯¹è±¡ã€‚æˆ‘ä»¬æ‰“å°æ¯é¡¹çš„åå­—ï¼Œè¿™æ ·å°±èƒ½çœ‹åˆ°ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶å’Œå­ç›®å½•ã€‚</li></ol><p>é€šè¿‡è¿™ä¸ªç¤ºä¾‹ï¼Œä½ åº”è¯¥èƒ½å¤Ÿç†è§£ <code>Dir.path</code> çš„ç”¨é€”ï¼šå®ƒè®©ä½ çŸ¥é“ä½ å½“å‰æ­£åœ¨æ“ä½œçš„ç›®å½•çš„è·¯å¾„ã€‚è¿™åœ¨å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ—¶éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚éœ€è¦æ ¹æ®ç›®å½•è·¯å¾„æ¥æ„å»ºæ–‡ä»¶è·¯å¾„ï¼Œæˆ–è€…ä»…ä»…æ˜¯è¦åœ¨æ—¥å¿—ä¸­è®°å½•ä¿¡æ¯ã€‚</p><h4 id="dir-read" tabindex="-1"><a class="header-anchor" href="#dir-read"><span><a href="https://nodejs.org/docs/latest/api/fs.html#dirread" target="_blank" rel="noopener noreferrer">dir.read()</a></span></a></h4><p>å½“ç„¶ï¼Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­ <code>dir.read()</code> æ–¹æ³•çš„ä½œç”¨å’Œå¦‚ä½•ä½¿ç”¨å®ƒã€‚</p><p><code>dir.read()</code> æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œå±äº Node.js æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—ä¸­çš„ <code>Dir</code> ç±»ã€‚è¿™ä¸ªæ–¹æ³•ç”¨äºå¼‚æ­¥åœ°è¯»å–ä¸€ä¸ªç›®å½•é‡Œçš„å†…å®¹ã€‚æ¯æ¬¡è°ƒç”¨ <code>dir.read()</code> ä¼šè¿”å›ç›®å½•ä¸­ä¸‹ä¸€ä¸ªæ–‡ä»¶çš„ä¿¡æ¯ï¼Œå¦‚æœæ‰€æœ‰æ–‡ä»¶éƒ½è¯»å–å®Œæ¯•ï¼Œåˆ™è¿”å› <code>null</code>ã€‚</p><p>åœ¨ Node.js ä¸­æ“ä½œæ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„ä»»åŠ¡ï¼Œæ¯”å¦‚ä½ å¯èƒ½éœ€è¦éå†ä¸€ä¸ªæ–‡ä»¶å¤¹æ¥å¤„ç†å…¶ä¸­çš„æ–‡ä»¶ã€‚<code>dir.read()</code> å°±æ˜¯ä¸ºäº†è¿™ç§æƒ…å†µè®¾è®¡çš„ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥å±•ç¤ºå¦‚ä½•ä½¿ç”¨ <code>dir.read()</code>:</p><p>é¦–å…ˆï¼Œä½ éœ€è¦ç¡®ä¿å·²ç»å¯¼å…¥äº† <code>fs</code> æ¨¡å—ï¼Œå¹¶ä¸”ä½¿ç”¨äº† <code>fs.opendir</code> æ–¹æ³•æ¥æ‰“å¼€ä¸€ä¸ªç›®å½•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æˆ‘ä»¬è¦è¯»å–çš„ç›®å½•æ˜¯å½“å‰ç›®å½•</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> directoryPath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">__dirname</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">opendir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> async</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dir</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ‰“å¼€ç›®å½•å‘ç”Ÿé”™è¯¯</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨å¾ªç¯æ¥ä¸æ–­è¯»å–ç›®å½•å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">  for</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#81A1C1;"> of</span><span style="color:#D8DEE9;"> dir</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡ºç›®å½•é¡¹çš„åç§°</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº†å¿…éœ€çš„æ¨¡å— <code>fs</code> å’Œ <code>path</code>ã€‚ä½¿ç”¨ <code>fs.opendir</code> æ–¹æ³•å¼‚æ­¥åœ°æ‰“å¼€äº† <code>directoryPath</code> æŒ‡å®šçš„ç›®å½•ã€‚è¿™é‡Œçš„ <code>__dirname</code> æ˜¯ Node.js ä¸­ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œä»£è¡¨å½“å‰æ‰§è¡Œè„šæœ¬æ‰€åœ¨çš„ç›®å½•ã€‚</p><p>å›è°ƒå‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªé”™è¯¯å¯¹è±¡ <code>err</code> å’Œä¸€ä¸ª <code>dir</code> å¯¹è±¡ã€‚å¦‚æœæ²¡æœ‰å‘ç”Ÿé”™è¯¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹è¯»å–ç›®å½•ä¸­çš„å†…å®¹äº†ã€‚</p><p>ä¸ºäº†è¯»å–ç›®å½•ä¸­çš„æ¯ä¸€ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>for await...of</code> å¾ªç¯ã€‚æ¯æ¬¡å¾ªç¯ <code>dir.read()</code> è¢«è°ƒç”¨ï¼Œç›´åˆ°è¿”å› <code>null</code>ï¼Œè¡¨ç¤ºæ²¡æœ‰æ›´å¤šçš„æ–‡ä»¶ã€‚</p><p><code>dirent</code> æ˜¯ç›®å½•é¡¹çš„å®ä¾‹ï¼Œå®ƒçš„ <code>name</code> å±æ€§åŒ…å«äº†æ–‡ä»¶æˆ–å­ç›®å½•çš„åå­—ã€‚</p><p>ä½¿ç”¨ <code>dir.read()</code> çš„å¥½å¤„ä¹‹ä¸€æ˜¯å¯ä»¥æ§åˆ¶ä½•æ—¶è¯»å–ä¸‹ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™åœ¨ä½ éœ€è¦å¯¹æ¯ä¸ªæ–‡ä»¶è¿›è¡Œå¤æ‚å¤„ç†æ—¶éå¸¸æœ‰ç”¨ã€‚å½“ç„¶ï¼Œè¿˜æœ‰å…¶ä»–æ–¹å¼å¯ä»¥è¯»å–ç›®å½•ï¼Œä¾‹å¦‚ <code>fs.readdir</code> æˆ– <code>fs.readdirSync</code>ï¼Œä½†å®ƒä»¬è¿”å›æ‰€æœ‰æ–‡ä»¶çš„æ•°ç»„ï¼Œè€Œä¸æ˜¯é€ä¸ªæ–‡ä»¶å¤„ç†ã€‚</p><p>åªè¦è®°ä½ï¼ŒNode.js ä¸­å¾ˆå¤šæ“ä½œéƒ½æ˜¯åŸºäºå¼‚æ­¥çš„ï¼Œè¿™æ„å‘³ç€å®ƒä»¬ä¸ä¼šç«‹å³å®Œæˆï¼Œä»£ç ä¼šç»§ç»­æ‰§è¡Œï¼Œè€Œæ“ä½œåœ¨åå°å®Œæˆã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘ä»¬ä½¿ç”¨äº† <code>async</code> å…³é”®å­—å’Œ <code>await</code> å…³é”®å­—ï¼Œä»¥ä¾¿ä»¥åŒæ­¥çš„æ–¹å¼å†™å¼‚æ­¥ä»£ç ï¼Œè®©ä»£ç æ›´å®¹æ˜“ç†è§£å’Œç®¡ç†ã€‚</p><h4 id="dir-read-callback" tabindex="-1"><a class="header-anchor" href="#dir-read-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#dirreadcallback" target="_blank" rel="noopener noreferrer">dir.read(callback)</a></span></a></h4><p>åœ¨ Node.js ä¸­ï¼Œ<code>dir.read(callback)</code>æ˜¯ä¸€ä¸ªç”¨äºè¯»å–ç›®å½•çš„å†…å®¹çš„å‡½æ•°ã€‚è¿™é‡Œçš„<code>dir</code>æ˜¯æŒ‡ä»£æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€ä¸ªç›®å½•å¯¹è±¡ï¼Œè€Œ<code>read</code>åˆ™æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥é€ä¸ªè¯»å–ç›®å½•ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•çš„ä¿¡æ¯ã€‚</p><p>å½“ä½ è°ƒç”¨<code>dir.read(callback)</code>æ–¹æ³•æ—¶ï¼Œä½ éœ€è¦ä¼ é€’ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼ˆ<code>callback</code>ï¼‰ï¼Œè¿™ä¸ªå‡½æ•°ä¼šåœ¨è¯»å–æ“ä½œå®Œæˆåè¢«è°ƒç”¨ã€‚å›è°ƒå‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªé”™è¯¯å‚æ•°<code>err</code>ï¼Œç”¨äºè¡¨ç¤ºåœ¨è¯»å–è¿‡ç¨‹ä¸­æ˜¯å¦å‘ç”Ÿäº†é”™è¯¯ï¼›å¦ä¸€ä¸ªæ˜¯<code>dirent</code>ï¼Œå¦‚æœè¯»å–æˆåŠŸï¼Œå®ƒåŒ…å«äº†å½“å‰è¯»å–åˆ°çš„ç›®å½•é¡¹ï¼ˆä¾‹å¦‚æ–‡ä»¶æˆ–å­ç›®å½•ï¼‰çš„ä¿¡æ¯ã€‚</p><p>å¦‚æœç›®å½•ä¸­æ²¡æœ‰æ›´å¤šçš„æ–‡ä»¶å¯è¯»ï¼Œåˆ™<code>dirent</code>å€¼ä¸º<code>null</code>ï¼Œè¡¨æ˜å·²ç»åˆ°è¾¾ç›®å½•æœ«å°¾ã€‚</p><p>ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨<code>dir.read(callback)</code>çš„ä¸€ä¸ªåŸºæœ¬ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€å½“å‰ç›®å½•</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> directoryPath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">__dirname</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> directory</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">opendirSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ä¸€ä¸ªå¾ªç¯è¯»å–å¹¶è¾“å‡ºæ‰€æœ‰ç›®å½•é¡¹çš„åç§°</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> readNextDirent</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  directory</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error reading directory:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      return;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">dirent</span><span style="color:#81A1C1;"> ===</span><span style="color:#81A1C1;"> null</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">      // å·²ç»åˆ°è¾¾ç›®å½•æœ«å°¾ï¼Œå…³é—­ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">      directory</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Finished reading directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      return;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // è¾“å‡ºè¯»å–åˆ°çš„ç›®å½•é¡¹åç§°</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Found directory entry:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // ç»§ç»­è¯»å–ä¸‹ä¸€é¡¹</span></span>
<span class="line"><span style="color:#88C0D0;">    readNextDirent</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼€å§‹è¯»å–ç›®å½•å†…å®¹</span></span>
<span class="line"><span style="color:#88C0D0;">readNextDirent</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº†å¿…è¦çš„<code>fs</code>ï¼ˆæ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼‰å’Œ<code>path</code>ï¼ˆè·¯å¾„å¤„ç†æ¨¡å—ï¼‰ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨<code>fs.opendirSync()</code>åŒæ­¥æ–¹å¼æ‰“å¼€ä¸€ä¸ªç›®å½•ï¼Œå¹¶å°†è¿”å›çš„ç›®å½•å¯¹è±¡ä¿å­˜åœ¨å˜é‡<code>directory</code>ä¸­ã€‚</p><p>æ¥ç€æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸º<code>readNextDirent</code>çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°ä½¿ç”¨<code>dir.read()</code>å¼‚æ­¥è¯»å–ç›®å½•ä¸­çš„é¡¹ï¼Œå¹¶ä¸”åœ¨å®Œæˆä¸€æ¬¡è¯»å–åé€šè¿‡é€’å½’è°ƒç”¨è‡ªèº«ä»è€Œè¯»å–ä¸‹ä¸€ä¸ªé¡¹ã€‚æ¯å½“è¯»å–åˆ°ä¸€ä¸ªç›®å½•é¡¹ï¼Œæˆ‘ä»¬å°±æ‰“å°å‡ºå®ƒçš„åç§°ã€‚å½“è¯»å–å®Œæ‰€æœ‰é¡¹ï¼Œå³å½“<code>dirent</code>ä¸º<code>null</code>æ—¶ï¼Œæˆ‘ä»¬å…³é—­ç›®å½•å¹¶å‘ŠçŸ¥ç”¨æˆ·å·²ç»å®Œæˆé˜…è¯»ã€‚</p><p>è¯·æ³¨æ„ï¼Œè¿™ä¸ªç¤ºä¾‹ä½¿ç”¨äº†åŒæ­¥æ–¹æ³•<code>opendirSync</code>æ¥æ‰“å¼€ç›®å½•ï¼Œå¹¶åœ¨ä¹‹åä½¿ç”¨äº†å¼‚æ­¥æ–¹æ³•<code>read</code>æ¥è¯»å–ç›®å½•å†…å®¹ã€‚å®è·µä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šæ ¹æ®å…·ä½“æƒ…å†µé€‰æ‹©åŒæ­¥è¿˜æ˜¯å¼‚æ­¥çš„ APIã€‚é€šå¸¸å»ºè®®åœ¨æ€§èƒ½æ•æ„Ÿçš„åº”ç”¨ä¸­ä½¿ç”¨å¼‚æ­¥ APIï¼Œä»¥é¿å…é˜»å¡ä¸»çº¿ç¨‹ã€‚</p><h4 id="dir-readsync" tabindex="-1"><a class="header-anchor" href="#dir-readsync"><span><a href="https://nodejs.org/docs/latest/api/fs.html#dirreadsync" target="_blank" rel="noopener noreferrer">dir.readSync()</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œ JavaScriptã€‚<code>fs</code> æ¨¡å—æ˜¯ Node.js çš„æ ¸å¿ƒæ¨¡å—ä¹‹ä¸€ï¼Œæä¾›äº†æ–‡ä»¶ç³»ç»Ÿæ“ä½œåŠŸèƒ½ï¼Œæ¯”å¦‚è¯»å–ã€å†™å…¥æ–‡ä»¶ï¼Œä»¥åŠä¸ç›®å½•äº¤äº’ç­‰ã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>dir.readSync()</code> æ˜¯ <code>fs</code> æ¨¡å—ä¸‹ç”¨äºåŒæ­¥è¯»å–ç›®å½•å†…å®¹çš„æ–¹æ³•ã€‚è¿™æ„å‘³ç€å½“ä½ è°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶ï¼Œå®ƒä¼šé˜»å¡ï¼ˆå³æš‚åœï¼‰ç¨‹åºçš„æ‰§è¡Œï¼Œç›´åˆ°ç›®å½•è¯»å–å®Œæˆã€‚è¿™ä¸å¼‚æ­¥ç‰ˆæœ¬çš„ <code>dir.read()</code> ä¸åŒï¼Œåè€…åœ¨è¯»å–ç›®å½•æ—¶ä¸ä¼šé˜»æ­¢ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ç»§ç»­æ‰§è¡Œã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-dir-readsync" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-dir-readsync"><span>å¦‚ä½•ä½¿ç”¨ <code>dir.readSync()</code></span></a></h3><p>é¦–å…ˆï¼Œä½ éœ€è¦ä½¿ç”¨ <code>fs.opendirSync()</code> æ–¹æ³•æ‰“å¼€ä¸€ä¸ªç›®å½•ï¼Œè¿™å°†è¿”å›ä¸€ä¸ª <code>Dir</code> å¯¹è±¡ã€‚ç„¶åï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨è¯¥å¯¹è±¡çš„ <code>readSync()</code> æ–¹æ³•æ¥åŒæ­¥åœ°è¯»å–ç›®å½•å†…å®¹ã€‚</p><p>æ¯æ¬¡è°ƒç”¨ <code>readSync()</code> ä¼šè¿”å›ç›®å½•ä¸­çš„ä¸‹ä¸€ä¸ªæ¡ç›®ï¼ˆä¸€ä¸ª <code>Dirent</code> å¯¹è±¡ï¼‰ï¼Œå¦‚æœæ‰€æœ‰æ¡ç›®éƒ½å·²ç»è¢«è¯»å–ï¼Œåˆ™è¿”å› <code>null</code>ã€‚</p><h3 id="ç¤ºä¾‹-5" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-5"><span>ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º <code>example</code> çš„ç›®å½•ï¼Œé‡Œé¢åŒ…å«å‡ ä¸ªæ–‡ä»¶å’Œå­ç›®å½•ï¼Œæˆ‘ä»¬æƒ³è¦æ‰“å°å‡ºæ‰€æœ‰è¿™äº›æ–‡ä»¶å’Œç›®å½•çš„åç§°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åŒæ­¥æ‰“å¼€ç›®å½•</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dir</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">opendirSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">while</span><span style="color:#D8DEE9FF;"> ((</span><span style="color:#D8DEE9;">dirent</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> dir</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readSync</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#81A1C1;">!==</span><span style="color:#81A1C1;"> null</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">  // æ‰“å°ç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•åç§°</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å…³é—­ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">dir</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">closeSync</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>dir.readSync()</code> æ¥éå† <code>example</code> ç›®å½•ï¼Œå¹¶æ‰“å°å‡ºå…¶ä¸­çš„æ‰€æœ‰é¡¹ï¼ˆæ–‡ä»¶æˆ–ç›®å½•ï¼‰çš„åç§°ã€‚ä½¿ç”¨ <code>while</code> å¾ªç¯æŒç»­è°ƒç”¨ <code>readSync()</code> ç›´åˆ°å®ƒè¿”å› <code>null</code>ï¼Œè¡¨ç¤ºç›®å½•ä¸­æ²¡æœ‰æ›´å¤šçš„æ¡ç›®å¯ä»¥è¯»å–äº†ã€‚</p><h3 id="å®é™…åº”ç”¨åœºæ™¯-3" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨åœºæ™¯-3"><span>å®é™…åº”ç”¨åœºæ™¯</span></a></h3><ul><li><strong>æ‰¹é‡é‡å‘½å</strong>ï¼šå‡è®¾ä½ éœ€è¦å¯¹ä¸€ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰å›¾ç‰‡æ–‡ä»¶è¿›è¡Œé‡å‘½åï¼Œå¯ä»¥ä½¿ç”¨ <code>dir.readSync()</code> éå†ç›®å½•ï¼Œæ‰¾åˆ°æ‰€æœ‰å›¾ç‰‡æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨ <code>fs.renameSync()</code> æ–¹æ³•è¿›è¡Œé‡å‘½åã€‚</li><li><strong>æœç´¢æ–‡ä»¶</strong>ï¼šå¦‚æœä½ éœ€è¦åœ¨ä¸€ä¸ªå¤§å‹é¡¹ç›®ä¸­å¿«é€ŸæŸ¥æ‰¾ç‰¹å®šç±»å‹çš„æ–‡ä»¶ï¼ˆä¾‹å¦‚ï¼Œæ‰€æœ‰çš„ <code>.js</code> æ–‡ä»¶ï¼‰ï¼Œ<code>dir.readSync()</code> å¯ä»¥å¸®åŠ©ä½ åŒæ­¥åœ°éå†æ‰€æœ‰ç›®å½•ï¼Œå¹¶æ£€æŸ¥æ¯ä¸ªæ–‡ä»¶çš„æ‰©å±•åã€‚</li><li><strong>ç›®å½•æ¸…ç†</strong>ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½éœ€è¦åˆ é™¤ä¸€ä¸ªç›®å½•ä¸­çš„æ‰€æœ‰è¿‡æœŸæ–‡ä»¶æˆ–ä¸´æ—¶æ–‡ä»¶ã€‚ä½¿ç”¨ <code>dir.readSync()</code> å¯ä»¥éå†æ•´ä¸ªç›®å½•ï¼Œé…åˆæ–‡ä»¶å±æ€§åˆ¤æ–­å“ªäº›æ–‡ä»¶éœ€è¦è¢«åˆ é™¤ã€‚</li></ul><p>æ³¨æ„ï¼Œè™½ç„¶åŒæ­¥æ–¹æ³•å› å…¶é˜»å¡æ€§è´¨åœ¨å¤„ç†å¤§å‹ç›®å½•æˆ–åœ¨ I/O å¯†é›†å‹åº”ç”¨ä¸­æ•ˆç‡è¾ƒä½ï¼Œä½†åœ¨ç®€å•è„šæœ¬æˆ–è€…é‚£äº›å¯¹å®æ—¶æ€§è¦æ±‚ä¸é«˜çš„åœºæ™¯ä¸­ä¾ç„¶å¾ˆæœ‰ç”¨ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©ä½¿ç”¨åŒæ­¥è¿˜æ˜¯å¼‚æ­¥æ–¹æ³•ã€‚</p><h4 id="dirsymbol-asynciterator-https-nodejs-org-docs-latest-api-fs-html-dirsymbolasynciterator" tabindex="-1"><a class="header-anchor" href="#dirsymbol-asynciterator-https-nodejs-org-docs-latest-api-fs-html-dirsymbolasynciterator"><span>[dir<a href="">Symbol.asyncIterator</a>](<a href="https://nodejs.org/docs/latest/api/fs.html#dirsymbolasynciterator" target="_blank" rel="noopener noreferrer">https://nodejs.org/docs/latest/api/fs.html#dirsymbolasynciterator</a>)</span></a></h4><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥ä¸€æ­¥æ­¥è§£å¼€ <code>dir[Symbol.asyncIterator]()</code> çš„æ¦‚å¿µï¼Œå¹¶ä¸”é€šè¿‡å®é™…çš„ä¾‹å­æ¥ç†è§£å®ƒåœ¨ Node.js ä¸­çš„åº”ç”¨ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦äº†è§£å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p><ol><li><strong>Node.js</strong> æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œè®©ä½ å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚</li><li><strong>fs æ¨¡å—</strong>ï¼šNode.js çš„æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼Œæä¾›äº†ä¸€ç³»åˆ—ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„ APIã€‚</li><li><strong>å¼‚æ­¥è¿­ä»£å™¨ï¼ˆAsync Iteratorï¼‰</strong>ï¼šå®ƒæ˜¯ ES2018 å¼•å…¥çš„ç‰¹æ€§ï¼Œç”¨äºå¤„ç†å¼‚æ­¥æ“ä½œåºåˆ—ã€‚å½“ä½ æœ‰ä¸€ç³»åˆ—çš„æ•°æ®æˆ–è€…æ“ä½œéœ€è¦æŒ‰é¡ºåºå¼‚æ­¥å¤„ç†æ—¶ï¼ˆæ¯”å¦‚è¯»å–ä¸€ä¸ªæ–‡ä»¶å¤¹å†…æ‰€æœ‰æ–‡ä»¶çš„ä¿¡æ¯ï¼‰ï¼Œå¼‚æ­¥è¿­ä»£å™¨å°±éå¸¸æœ‰ç”¨ã€‚</li><li><strong>Symbol.asyncIterator</strong> æ˜¯ä¸€ä¸ªå†…å»ºçš„ Symbol å€¼ï¼Œå®ƒæŒ‡å®šäº†ä¸€ä¸ªå¯¹è±¡çš„é»˜è®¤å¼‚æ­¥è¿­ä»£å™¨ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡è®¾ç½®äº†è¿™ä¸ªå±æ€§ï¼Œå®ƒå°±å¯ä»¥è¢« <code>for...of</code> å¾ªç¯å¼‚æ­¥è¿­ä»£ã€‚</li></ol><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ <code>dir[Symbol.asyncIterator]()</code> åœ¨ Node.js ä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š</p><h3 id="dir-symbol-asynciterator" tabindex="-1"><a class="header-anchor" href="#dir-symbol-asynciterator"><span><code>dir[Symbol.asyncIterator]()</code></span></a></h3><p>è¿™ä¸ªæ–¹æ³•æ˜¯ <code>fs.Dir</code> ç±»çš„å®ä¾‹æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªå¼‚æ­¥è¿­ä»£å™¨ï¼Œå…è®¸ä½ éå†ç›®å½•å†…çš„æ‰€æœ‰æ¡ç›®ï¼ˆæ–‡ä»¶ã€å­ç›®å½•ç­‰ï¼‰ã€‚</p><p>è¿™é‡Œä¸¾ä¸€ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º &quot;photos&quot; çš„æ–‡ä»¶å¤¹ï¼Œé‡Œé¢å­˜å‚¨äº†å¾ˆå¤šç…§ç‰‡ï¼Œä½ æƒ³è¦ç¼–å†™ä¸€ä¸ªè„šæœ¬æ¥åˆ—å‡ºè¯¥æ–‡ä»¶å¤¹å†…çš„æ‰€æœ‰æ–‡ä»¶åã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦ä½¿ç”¨ Node.js çš„ <code>fs</code> æ¨¡å—ä¸­çš„ <code>opendir</code> æ–¹æ³•å¼‚æ­¥æ‰“å¼€è¿™ä¸ªç›®å½•ã€‚ç„¶åï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>dir[Symbol.asyncIterator]()</code> éå†ç›®å½•å†…çš„æ¯ä¸€é¡¹ã€‚</p><p>ä¸‹é¢æ˜¯å¦‚ä½•å®ç°çš„ä»£ç ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> listFilesInDirectory</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨ fs.opendir æ‰“å¼€ç›®å½•</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> dir</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">opendir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨å¼‚æ­¥è¿­ä»£å™¨éå†ç›®å½•å†…çš„æ¯ä¸€é¡¹</span></span>
<span class="line"><span style="color:#81A1C1;">  for</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#81A1C1;"> of</span><span style="color:#D8DEE9;"> dir</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">listFilesInDirectory</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./photos</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ul><li>æˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† <code>fs</code> æ¨¡å—ï¼Œå¹¶ä½¿ç”¨å…¶ <code>promises</code> API ä»¥æ”¯æŒå¼‚æ­¥æ“ä½œã€‚</li><li>å®šä¹‰äº†ä¸€ä¸ª <code>listFilesInDirectory</code> å¼‚æ­¥å‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªåŒ…å«ç›®æ ‡ç›®å½•è·¯å¾„çš„å‚æ•°ã€‚</li><li>ä½¿ç”¨ <code>fs.opendir</code> å¼‚æ­¥æ‰“å¼€ç›®æ ‡ç›®å½•ï¼Œå¹¶å¾—åˆ°ä¸€ä¸ª <code>Dir</code> å¯¹è±¡ã€‚</li><li>åˆ©ç”¨ <code>for await...of</code> è¯­æ³•å’Œ <code>dir[Symbol.asyncIterator]()</code> éå†ç›®å½•ä¸­çš„æ¯ä¸€ä¸ªæ¡ç›®ï¼ˆ<code>dirent</code>ï¼‰ï¼Œå¹¶æ‰“å°å‡ºæ¯ä¸€ä¸ªæ¡ç›®çš„åå­—ã€‚</li></ul><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥éå¸¸é«˜æ•ˆä¸”æ–¹ä¾¿åœ°å¤„ç†ç›®å½•ä¸­çš„æ–‡ä»¶ï¼Œæ— è®ºå®ƒä»¬æœ‰å¤šå°‘ï¼ŒåŒæ—¶ä¿æŒä»£ç çš„å¯è¯»æ€§å’Œç»´æŠ¤æ€§ã€‚</p><h3 id="class-fs-dirent" tabindex="-1"><a class="header-anchor" href="#class-fs-dirent"><span><a href="https://nodejs.org/docs/latest/api/fs.html#class-fsdirent" target="_blank" rel="noopener noreferrer">Class: fs.Dirent</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ·±å…¥äº†è§£ Node.js ä¸­çš„ <code>fs.Dirent</code> ç±»ï¼Œå¹¶é€šè¿‡ä¸€äº›ç®€å•æ˜“æ‡‚çš„ä¾‹å­æ¥è§£é‡Šå®ƒã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-fs-dirent" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-fs-dirent"><span>ä»€ä¹ˆæ˜¯ <code>fs.Dirent</code>?</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æä¾›äº†ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„åŠŸèƒ½ã€‚<code>fs.Dirent</code> æ˜¯ <code>fs</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªç±»ï¼Œå®ƒä»£è¡¨äº†æ–‡ä»¶ç³»ç»Ÿç›®å½•ä¸­çš„ä¸€ä¸ªæ¡ç›®ï¼ˆentryï¼‰ã€‚è¿™å¯ä»¥æ˜¯ä¸€ä¸ªæ–‡ä»¶ã€ä¸€ä¸ªå­ç›®å½•ã€æˆ–è€…æ˜¯å…¶ä»–ç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿå¯¹è±¡ï¼Œæ¯”å¦‚ç¬¦å·é“¾æ¥ã€‚</p><p>å½“ä½ ä½¿ç”¨ <code>fs.readdir()</code> æˆ– <code>fs.readdirSync()</code> å‡½æ•°ä»¥åŠ <code>{ withFileTypes: true }</code> é€‰é¡¹è¯»å–ç›®å½•å†…å®¹æ—¶ï¼Œè¿™äº›å‡½æ•°å°†è¿”å› <code>fs.Dirent</code> å¯¹è±¡çš„æ•°ç»„è€Œä¸æ˜¯å­—ç¬¦ä¸²æ•°ç»„ã€‚æ¯ä¸ª <code>fs.Dirent</code> å¯¹è±¡éƒ½åŒ…å«å…³äºç›®å½•ä¸­æ¯ä¸ªæ–‡ä»¶çš„ä¿¡æ¯ï¼Œæ¯”å¦‚å®ƒçš„åç§°å’Œå®ƒæ˜¯ä»€ä¹ˆç±»å‹çš„æ–‡ä»¶ã€‚</p><h3 id="fs-dirent-çš„é‡è¦æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#fs-dirent-çš„é‡è¦æ–¹æ³•"><span><code>fs.Dirent</code> çš„é‡è¦æ–¹æ³•ï¼š</span></a></h3><ul><li><code>dirent.isFile()</code>: åˆ¤æ–­ç›®å½•ä¸­çš„æ¡ç›®æ˜¯å¦ä¸ºæ–‡ä»¶ã€‚</li><li><code>dirent.isDirectory()</code>: åˆ¤æ–­ç›®å½•ä¸­çš„æ¡ç›®æ˜¯å¦ä¸ºç›®å½•ï¼ˆæ–‡ä»¶å¤¹ï¼‰ã€‚</li><li><code>dirent.isSymbolicLink()</code>: åˆ¤æ–­ç›®å½•ä¸­çš„æ¡ç›®æ˜¯å¦ä¸ºç¬¦å·é“¾æ¥ã€‚</li><li>... è¿˜æœ‰å…¶ä»–å‡ ä¸ªæ–¹æ³•ç”¨äºåˆ¤æ–­æ–‡ä»¶ç±»å‹ã€‚</li></ul><h3 id="å®è·µä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®è·µä¾‹å­-1"><span>å®è·µä¾‹å­</span></a></h3><p>è®©æˆ‘ä»¬é€šè¿‡ä¸€äº›ä¾‹å­æ¥çœ‹çœ‹å¦‚ä½•åœ¨å®é™…åº”ç”¨ä¸­ä½¿ç”¨ <code>fs.Dirent</code>ã€‚</p><h4 id="ä¾‹å­-1-åˆ—å‡ºä¸€ä¸ªç›®å½•ä¸­æ‰€æœ‰çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-åˆ—å‡ºä¸€ä¸ªç›®å½•ä¸­æ‰€æœ‰çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹"><span>ä¾‹å­ 1ï¼šåˆ—å‡ºä¸€ä¸ªç›®å½•ä¸­æ‰€æœ‰çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">//æ¥æºï¼šdoc.cherrychat.org è¯·å‹¿rwå“’å•†ç”¨doc.cherrychat.org</span></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æˆ‘ä»¬æƒ³è¦è¯»å–å½“å‰ç›®å½•ä¸‹çš„å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> directoryPath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">__dirname</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨å¼‚æ­¥æ–¹æ³•è¯»å–ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> withFileTypes</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> files</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ— æ³•è¯»å–ç›®å½•: </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    files</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forEach</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFile</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span><span style="color:#81A1C1;"> else</span><span style="color:#81A1C1;"> if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isDirectory</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">ç›®å½•: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä¾‹å­-2-æ‰¾å‡ºä¸€ä¸ªç›®å½•ä¸­æ‰€æœ‰çš„ç¬¦å·é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-æ‰¾å‡ºä¸€ä¸ªç›®å½•ä¸­æ‰€æœ‰çš„ç¬¦å·é“¾æ¥"><span>ä¾‹å­ 2ï¼šæ‰¾å‡ºä¸€ä¸ªç›®å½•ä¸­æ‰€æœ‰çš„ç¬¦å·é“¾æ¥</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> directoryPath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">__dirname</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å½“å‰ç›®å½•è·¯å¾„</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> withFileTypes</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dirents</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ— æ³•è¯»å–ç›®å½•</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> symlinks</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> dirents</span></span>
<span class="line"><span style="color:#ECEFF4;">    .</span><span style="color:#88C0D0;">filter</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isSymbolicLink</span><span style="color:#D8DEE9FF;">())</span></span>
<span class="line"><span style="color:#ECEFF4;">    .</span><span style="color:#88C0D0;">map</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç¬¦å·é“¾æ¥:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> symlinks</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä¸Šè¿°ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>fs.Dirent</code> åœ¨ç›®å½•è¯»å–æ“ä½œä¸­çš„åº”ç”¨ã€‚é€šè¿‡åˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ä¸åŒç±»å‹çš„æ–‡ä»¶æ‰§è¡Œä¸åŒçš„æ“ä½œï¼Œè¿™åœ¨å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ—¶éå¸¸æœ‰ç”¨ã€‚</p><h4 id="dirent-isblockdevice" tabindex="-1"><a class="header-anchor" href="#dirent-isblockdevice"><span><a href="https://nodejs.org/docs/latest/api/fs.html#direntisblockdevice" target="_blank" rel="noopener noreferrer">dirent.isBlockDevice()</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©å¼€å‘è€…å¯ä»¥ç”¨ JavaScript ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚åœ¨ä»‹ç» <code>dirent.isBlockDevice()</code> è¿™ä¸ªåŠŸèƒ½ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä¸€ä¸‹å‡ ä¸ªæ¦‚å¿µã€‚</p><ol><li><p><strong>æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰</strong>ï¼šè¿™æ˜¯æ“ä½œç³»ç»Ÿç”¨æ¥ç®¡ç†å­˜å‚¨åœ¨ç£ç›˜æˆ–å…¶ä»–æ°¸ä¹…æ€§å­˜å‚¨è®¾å¤‡ä¸Šçš„æ•°æ®çš„éƒ¨åˆ†ã€‚ç®€å•åœ°è¯´ï¼Œæ–‡ä»¶ç³»ç»Ÿè®©ä½ èƒ½åˆ›å»ºã€è¯»å–ã€ä¿®æ”¹æ–‡ä»¶å’Œç›®å½•ã€‚</p></li><li><p><strong><code>fs</code> æ¨¡å—</strong>ï¼šåœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æ˜¯æä¾›å¯¹æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œæ“ä½œçš„ API é›†åˆã€‚è¿™æ„å‘³ç€å¦‚æœä½ æƒ³åœ¨ Node.js åº”ç”¨ä¸­è¯»å–æˆ–ä¿®æ”¹æ–‡ä»¶ï¼Œä½ ä¼šç”¨åˆ° <code>fs</code> æ¨¡å—ã€‚</p></li><li><p><strong>Dirent</strong>ï¼šå½“ä½ ä½¿ç”¨ <code>fs</code> æ¨¡å—çš„æŸäº›å‡½æ•°ï¼ˆæ¯”å¦‚ <code>fs.readdir()</code> æˆ– <code>fs.readdirSync()</code> ï¼‰ä»¥åŠä¼ é€’ <code>{withFileTypes: true}</code> é€‰é¡¹æ¥è¯»å–ç›®å½•å†…å®¹æ—¶ï¼Œè¿”å›çš„ä¸ä»…ä»…æ˜¯æ–‡ä»¶åçš„æ•°ç»„ï¼Œè¿˜åŒ…æ‹¬ Dirent å¯¹è±¡çš„æ•°ç»„ã€‚è¿™äº› Dirent å¯¹è±¡ä»£è¡¨äº†ç›®å½•ä¸­çš„æ¯ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œæä¾›äº†è¿›ä¸€æ­¥çš„ä¿¡æ¯å’Œæ–¹æ³•ï¼Œæ¯”å¦‚æ£€æŸ¥ä¸€ä¸ªæ¡ç›®æ˜¯å¦æ˜¯æ–‡ä»¶ã€ç›®å½•è¿˜æ˜¯å…¶ä»–ç±»å‹çš„æ–¹æ³•ã€‚</p></li></ol><p>ç°åœ¨ï¼Œè®²è§£ <code>dirent.isBlockDevice()</code>ï¼š</p><ul><li><strong><code>dirent.isBlockDevice()</code> æ–¹æ³•</strong>ï¼šè¿™æ˜¯ Dirent å¯¹è±¡ä¸Šçš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨æ¥æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€ä¸ªæ¡ç›®ï¼ˆæ— è®ºæ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•ï¼‰æ˜¯å¦æ˜¯ä¸€ä¸ªå—è®¾å¤‡ã€‚å—è®¾å¤‡ï¼Œå¦‚ç¡¬ç›˜æˆ– USB é©±åŠ¨å™¨ï¼Œåœ¨æ•°æ®å­˜å‚¨ä¸è¯»å–è¿‡ç¨‹ä¸­ï¼Œæ•°æ®æ˜¯ä»¥å›ºå®šå¤§å°çš„å—ä¸ºå•ä½è¿›è¡Œå¤„ç†çš„ã€‚å¦‚æœä¸€ä¸ªæ¡ç›®æ˜¯å—è®¾å¤‡ï¼Œ<code>isBlockDevice()</code> è¿”å› trueï¼›å¦åˆ™è¿”å› falseã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-26" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-26"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><strong>åˆ¤æ–­ç‰¹å®šè·¯å¾„ä¸‹æ˜¯å¦å­˜åœ¨å—è®¾å¤‡</strong>ï¼š</li></ol><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œéœ€è¦æ£€æŸ¥ç³»ç»Ÿä¸­çš„æŸä¸ªç‰¹å®šè·¯å¾„ä¸‹æ˜¯å¦æœ‰ä»»ä½•å—è®¾å¤‡å­˜åœ¨ï¼Œå¯èƒ½æ˜¯ä¸ºäº†ç¡®ä¿å®‰å…¨åœ°è¿›è¡Œä¸€äº›ä½çº§åˆ«çš„ç£ç›˜æ“ä½œæˆ–å‡ºäºå…¶ä»–åŸå› ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç æ®µï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>dirent.isBlockDevice()</code> æ–¹æ³•æ¥å®ç°è¿™ä¸€ç‚¹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/dev</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åœ¨ç±»Unixç³»ç»Ÿä¸­ï¼Œè®¾å¤‡é€šå¸¸åœ¨ /dev ç›®å½•ä¸‹</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> withFileTypes</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dirents</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–ç›®å½•æ—¶å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> blockDevices</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> dirents</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">filter</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isBlockDevice</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#A3BE8C;">æ‰¾åˆ°çš„å—è®¾å¤‡:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9;">    blockDevices</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">map</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  )</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é¦–å…ˆå¯¼å…¥ <code>fs</code> æ¨¡å—ï¼Œç„¶åä½¿ç”¨ <code>fs.readdir()</code> å‡½æ•°ä»¥å¼‚æ­¥æ–¹å¼è¯»å– <code>/dev</code> ç›®å½•çš„å†…å®¹ï¼Œå¹¶å°† <code>{withFileTypes: true}</code> é€‰é¡¹ä¼ é€’ç»™å®ƒï¼Œä»¥ä¾¿è·å– Dirent å¯¹è±¡æ•°ç»„è€Œä¸ä»…ä»…æ˜¯æ–‡ä»¶åã€‚æ¥ç€ï¼Œå®ƒä½¿ç”¨ <code>filter()</code> æ–¹æ³•ç­›é€‰å‡ºæ‰€æœ‰æ˜¯å—è®¾å¤‡çš„æ¡ç›®ï¼Œå¹¶æœ€åæ‰“å°å‡ºè¿™äº›å—è®¾å¤‡çš„åç§°ã€‚</p><p>é€šè¿‡è¿™ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>dirent.isBlockDevice()</code> æ–¹æ³•å¦‚ä½•åœ¨å®è·µä¸­è¢«ç”¨æ¥è¯†åˆ«å’Œå¤„ç†æ–‡ä»¶ç³»ç»Ÿä¸­çš„å—è®¾å¤‡ã€‚è¿™å¯¹äºéœ€è¦ç›´æ¥ä¸ç³»ç»Ÿåº•å±‚ç¡¬ä»¶äº¤äº’çš„åº”ç”¨ç¨‹åºç‰¹åˆ«æœ‰ç”¨ã€‚</p><h4 id="dirent-ischaracterdevice" tabindex="-1"><a class="header-anchor" href="#dirent-ischaracterdevice"><span><a href="https://nodejs.org/docs/latest/api/fs.html#direntischaracterdevice" target="_blank" rel="noopener noreferrer">dirent.isCharacterDevice()</a></span></a></h4><p>åœ¨è§£é‡Š<code>dirent.isCharacterDevice()</code>ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£å‡ ä¸ªæ¦‚å¿µï¼š</p><ol><li><p><strong>Node.js</strong>: æ˜¯ä¸€ä¸ªä½¿ç”¨ JavaScript è¿è¡Œçš„å¹³å°ï¼Œå®ƒè®©ä½ å¯ä»¥åœ¨æœåŠ¡å™¨æˆ–è€…æœ¬åœ°ç”µè„‘ä¸Šè¿è¡Œ JavaScript ä»£ç ã€‚Node.js éå¸¸é€‚åˆå¤„ç†ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶ç³»ç»Ÿæ“ä½œç­‰ä»»åŠ¡ã€‚</p></li><li><p><strong>File System æ¨¡å—(fs)</strong>: Node.js æä¾›äº†ä¸€ä¸ªå†…ç½®æ¨¡å—å«åš<code>fs</code>ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œä½¿å¾—è¯»å†™æ–‡ä»¶å’Œå¤„ç†æ–‡ä»¶ç³»ç»Ÿå˜å¾—å¯èƒ½ã€‚è¿™ä¸ªæ¨¡å—å¯ä»¥æ‰§è¡Œå¾ˆå¤šæ“ä½œï¼Œæ¯”å¦‚åˆ›å»ºã€è¯»å–ã€åˆ é™¤æ–‡ä»¶ç­‰ã€‚</p></li><li><p><strong>Dirent</strong>: å½“ä½ åœ¨ Node.js ä¸­ä½¿ç”¨<code>fs</code>æ¨¡å—è¯»å–ç›®å½•å†…å®¹æ—¶ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨<code>fs.readdir</code>æˆ–<code>fs.readdirSync</code>æ–¹æ³•å¹¶è®¾ç½®<code>withFileTypes</code>é€‰é¡¹ä¸º<code>true</code>ï¼‰ï¼Œè¿”å›çš„ä¸å†æ˜¯ç®€å•çš„æ–‡ä»¶åæ•°ç»„ï¼Œè€Œæ˜¯ä¸€ä¸ªåŒ…å«<code>fs.Dirent</code>å¯¹è±¡çš„æ•°ç»„ã€‚æ¯ä¸ª<code>fs.Dirent</code>å¯¹è±¡ä»£è¡¨äº†ç›®å½•ä¸­çš„ä¸€ä¸ªæ–‡ä»¶æˆ–å­ç›®å½•ã€‚</p></li><li><p><strong>å­—ç¬¦è®¾å¤‡(Character Device)</strong>: åœ¨è®¡ç®—æœºä¸­ï¼Œè®¾å¤‡åˆ†ä¸ºä¸¤å¤§ç±»ï¼šå­—ç¬¦è®¾å¤‡å’Œå—è®¾å¤‡ã€‚å­—ç¬¦è®¾å¤‡æ˜¯æŒ‡æŒ‰å­—ç¬¦è¿›è¡Œæ•°æ®ä¼ è¾“çš„è®¾å¤‡ï¼Œä¾‹å¦‚é”®ç›˜ã€é¼ æ ‡å’Œä¸²å£è®¾å¤‡ã€‚ä¸æ­¤ç›¸åï¼Œå—è®¾å¤‡ï¼ˆå¦‚ç¡¬ç›˜ï¼‰æ˜¯ä»¥æ•°æ®å—ä¸ºå•ä½è¿›è¡Œæ•°æ®ä¼ è¾“çš„ã€‚</p></li></ol><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥è°ˆè°ˆ<code>dirent.isCharacterDevice()</code>æ–¹æ³•ã€‚</p><h3 id="dirent-ischaracterdevice-1" tabindex="-1"><a class="header-anchor" href="#dirent-ischaracterdevice-1"><span>dirent.isCharacterDevice()</span></a></h3><p><code>dirent.isCharacterDevice()</code>æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥è°ƒç”¨åœ¨<code>fs.Dirent</code>å¯¹è±¡ä¸Šã€‚è¿™ä¸ªæ–¹æ³•ç”¨æ¥æ£€æŸ¥ç›®å½•ä¸­çš„æŸä¸ªæ¡ç›®æ˜¯å¦æ˜¯å­—ç¬¦è®¾å¤‡ã€‚å¦‚æœè¢«æ£€æŸ¥çš„æ¡ç›®ç¡®å®æ˜¯å­—ç¬¦è®¾å¤‡ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šè¿”å›<code>true</code>ï¼›å¦åˆ™ï¼Œè¿”å›<code>false</code>ã€‚</p><h4 id="å®é™…è¿ç”¨ä¾‹å­-27" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-27"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œéœ€è¦åŒºåˆ†å¤„ç†ç›®å½•ä¸­çš„ä¸åŒç±»å‹çš„æ–‡ä»¶å’Œè®¾å¤‡ã€‚ç‰¹åˆ«åœ°ï¼Œä½ éœ€è¦æ‰¾å‡ºæ‰€æœ‰çš„å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œä»¥ä¾¿è¿›è¡Œç‰¹å®šçš„æ“ä½œï¼Œæ¯”å¦‚ç›‘æ§è¿™äº›è®¾å¤‡çš„çŠ¶æ€æˆ–è€…è¯»å–ä»è¿™äº›è®¾å¤‡ä¼ å…¥çš„æ•°æ®ã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦ä½¿ç”¨<code>fs</code>æ¨¡å—çš„<code>readdir</code>æˆ–<code>readdirSync</code>å‡½æ•°è¯»å–ç›®å½•ï¼Œå¹¶ç¡®ä¿è®¾ç½®<code>withFileTypes</code>ä¸º<code>true</code>æ¥è·å–<code>fs.Dirent</code>å¯¹è±¡ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä»¥åŒæ­¥æ–¹å¼è¯»å–å½“å‰ç›®å½•å†…çš„å†…å®¹ï¼Œè·å–fs.Direntå¯¹è±¡</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> files</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdirSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> withFileTypes</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// éå†ç›®å½•å†…çš„æ¡ç›®</span></span>
<span class="line"><span style="color:#D8DEE9;">files</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forEach</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isCharacterDevice</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // å¦‚æœæ¡ç›®æ˜¯å­—ç¬¦è®¾å¤‡ï¼Œåˆ™æ‰“å°å‡ºæ¥</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> is a character device</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éå†å½“å‰ç›®å½•(<code>.</code>)ä¸­çš„æ‰€æœ‰æ¡ç›®ã€‚å¯¹äºæ¯ä¸ªæ¡ç›®ï¼Œæˆ‘ä»¬æ£€æŸ¥å®ƒæ˜¯å¦æ˜¯å­—ç¬¦è®¾å¤‡ã€‚å¦‚æœæ˜¯ï¼Œæˆ‘ä»¬å°±è¾“å‡ºå®ƒçš„åå­—å’Œä¸€æ¡æ¶ˆæ¯è¯´æ˜å®ƒæ˜¯å­—ç¬¦è®¾å¤‡ã€‚</p><p>æ³¨æ„ï¼Œå¤§å¤šæ•°æ—¥å¸¸ä½¿ç”¨çš„æ–‡ä»¶ç³»ç»Ÿä¸­å­—ç¬¦è®¾å¤‡ä¸å¤šï¼Œå› æ­¤è¿™ä¸ªç¤ºä¾‹åœ¨æ™®é€šç›®å½•ä¸‹è¿è¡Œå¯èƒ½ä¸ä¼šè¾“å‡ºä»»ä½•ä¸œè¥¿ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ åœ¨ç‰¹å®šç¯å¢ƒä¸‹å·¥ä½œï¼Œæ¯”å¦‚ä¸ç¡¬ä»¶æˆ–ç‰¹æ®Šè®¾å¤‡æ–‡ä»¶äº¤äº’æ—¶ï¼Œè¿™ç§æ£€æµ‹å°±éå¸¸æœ‰ç”¨äº†ã€‚</p><h4 id="dirent-isdirectory" tabindex="-1"><a class="header-anchor" href="#dirent-isdirectory"><span><a href="https://nodejs.org/docs/latest/api/fs.html#direntisdirectory" target="_blank" rel="noopener noreferrer">dirent.isDirectory()</a></span></a></h4><p>å½“ä½ åœ¨ä½¿ç”¨ Node.js æ¥å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œæ¯”å¦‚è¯»å–ç›®å½•å†…å®¹æˆ–è€…æ£€æŸ¥æ–‡ä»¶çš„çŠ¶æ€ï¼Œä½ ä¼šé‡åˆ°ä¸€ä¸ªéå¸¸å®ç”¨çš„æ–¹æ³•å«åš<code>dirent.isDirectory()</code>ã€‚è¿™ä¸ªæ–¹æ³•å±äº<code>fs.Dirent</code>ç±»ï¼Œä¸»è¦ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿæ¡ç›®æ˜¯å¦æ˜¯ä¸€ä¸ªç›®å½•ã€‚</p><h3 id="ç†è§£-fs-dirent-ç±»" tabindex="-1"><a class="header-anchor" href="#ç†è§£-fs-dirent-ç±»"><span>ç†è§£ fs.Dirent ç±»</span></a></h3><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯<code>fs.Dirent</code>ç±»ã€‚åœ¨ Node.js ä¸­ï¼Œå½“ä½ ä½¿ç”¨<code>fs.readdir()</code>æˆ–<code>fs.readdirSync()</code>æ–¹æ³•ä»¥å¸¦æœ‰<code>{ withFileTypes: true }</code>é€‰é¡¹çš„æ–¹å¼è¯»å–ç›®å½•çš„å†…å®¹æ—¶ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°å°†è¿”å›ä¸€ä¸ª<code>fs.Dirent</code>å¯¹è±¡æ•°ç»„ã€‚æ¯ä¸ª<code>Dirent</code>å¯¹è±¡ä»£è¡¨äº†ç›®å½•ä¸­çš„ä¸€ä¸ªæ¡ç›®ï¼ˆå¯ä»¥æ˜¯æ–‡ä»¶ã€ç›®å½•ã€ç¬¦å·é“¾æ¥ç­‰ï¼‰ã€‚</p><h3 id="isdirectory-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#isdirectory-æ–¹æ³•"><span>isDirectory() æ–¹æ³•</span></a></h3><p><code>dirent.isDirectory()</code>æ˜¯<code>fs.Dirent</code>å¯¹è±¡æä¾›çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨æ¥æ£€æŸ¥è¯¥å¯¹è±¡æ˜¯å¦ä»£è¡¨ä¸€ä¸ªç›®å½•ã€‚å¦‚æœè¯¥å¯¹è±¡ä»£è¡¨ä¸€ä¸ªç›®å½•ï¼Œåˆ™è¯¥æ–¹æ³•è¿”å›<code>true</code>ï¼›å¦‚æœä¸æ˜¯ï¼Œåˆ™è¿”å›<code>false</code>ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-22" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-22"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>è®©æˆ‘ä»¬é€šè¿‡ä¸€äº›ä¾‹å­ï¼Œæ›´åŠ æ·±å…¥åœ°ç†è§£è¿™ä¸ªæ–¹æ³•çš„åº”ç”¨ã€‚</p><h4 id="ç¤ºä¾‹-1-åˆ—å‡ºä¸€ä¸ªç›®å½•ä¸­æ‰€æœ‰çš„å­ç›®å½•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åˆ—å‡ºä¸€ä¸ªç›®å½•ä¸­æ‰€æœ‰çš„å­ç›®å½•"><span>ç¤ºä¾‹ 1ï¼šåˆ—å‡ºä¸€ä¸ªç›®å½•ä¸­æ‰€æœ‰çš„å­ç›®å½•</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œéœ€è¦åˆ—å‡ºæŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰å­ç›®å½•ï¼Œè€Œå¿½ç•¥å…¶ä»–ç±»å‹çš„æ–‡ä»¶ï¼Œè¿™æ—¶<code>isDirectory()</code>æ–¹æ³•å°±æ˜¾å¾—éå¸¸æœ‰ç”¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æŒ‡å®šéœ€è¦åˆ—å‡ºå­ç›®å½•çš„ç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dirPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/some/directory/path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥è¯»å–ç›®å½•å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> withFileTypes</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dirents</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–ç›®å½•å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // éå†ç›®å½•æ¡ç›®ï¼Œç­›é€‰å‡ºç›®å½•ç±»å‹çš„æ¡ç›®ï¼Œå¹¶æ‰“å°å…¶åç§°</span></span>
<span class="line"><span style="color:#D8DEE9;">  dirents</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forEach</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isDirectory</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-é€’å½’éå†ç›®å½•ç»“æ„" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-é€’å½’éå†ç›®å½•ç»“æ„"><span>ç¤ºä¾‹ 2ï¼šé€’å½’éå†ç›®å½•ç»“æ„</span></a></h4><p>å¦‚æœä½ æƒ³é€’å½’éå†ä¸€ä¸ªç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•ï¼ŒåŒæ ·å¯ä»¥åˆ©ç”¨<code>isDirectory()</code>æ–¹æ³•æ¥åˆ¤æ–­å½“å‰å¤„ç†çš„æ¡ç›®æ˜¯å¦æ˜¯ç›®å½•ï¼Œä»è€Œå†³å®šæ˜¯å¦éœ€è¦è¿›ä¸€æ­¥é€’å½’éå†ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> listDir</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dirPath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> withFileTypes</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dirents</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–ç›®å½•å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      return;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    dirents</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forEach</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      const</span><span style="color:#D8DEE9;"> fullPath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fullPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isDirectory</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">        // å¦‚æœæ˜¯ç›®å½•ï¼Œåˆ™é€’å½’è°ƒç”¨listDir</span></span>
<span class="line"><span style="color:#88C0D0;">        listDir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fullPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨å‡½æ•°ï¼Œä»æŒ‡å®šç›®å½•å¼€å§‹é€’å½’éå†</span></span>
<span class="line"><span style="color:#88C0D0;">listDir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/some/start/directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä¸Šè¿°ç¤ºä¾‹ï¼Œä½ åº”è¯¥å¯¹<code>dirent.isDirectory()</code>æ–¹æ³•æœ‰äº†æ›´æ·±çš„ç†è§£å’Œå®é™…åº”ç”¨çš„è®¤è¯†ã€‚è¿™ç§æ–¹æ³•ä½¿å¾—æ£€æŸ¥ç›®å½•å’Œç®¡ç†æ–‡ä»¶ç³»ç»Ÿå˜å¾—ç®€å•é«˜æ•ˆã€‚</p><h4 id="dirent-isfifo" tabindex="-1"><a class="header-anchor" href="#dirent-isfifo"><span><a href="https://nodejs.org/docs/latest/api/fs.html#direntisfifo" target="_blank" rel="noopener noreferrer">dirent.isFIFO()</a></span></a></h4><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥äº†è§£ <code>dirent.isFIFO()</code> è¿™ä¸ªæ–¹æ³•åœ¨ Node.js ä¸­çš„ä½œç”¨å’Œåº”ç”¨åœºæ™¯ã€‚</p><p>é¦–å…ˆï¼Œ<code>dirent</code> æ˜¯æŒ‡ç›®å½•é¡¹ï¼ˆdirectory entryï¼‰çš„ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ç§å¯¹è±¡é€šå¸¸æ˜¯é€šè¿‡ä½¿ç”¨ Node.js çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>ï¼‰æ¨¡å—ä¸­ä¸€äº›æ–¹æ³•è·å¾—çš„ï¼Œæ¯”å¦‚ <code>fs.readdir()</code> æˆ– <code>fs.readdirSync()</code> æ–¹æ³•åœ¨ä½¿ç”¨ <code>{ withFileTypes: true }</code> é€‰é¡¹æ—¶ï¼Œä¼šè¿”å›ä¸€ä¸ªåŒ…å« <code>dirent</code> å¯¹è±¡çš„æ•°ç»„ï¼Œè€Œä¸æ˜¯ä»…ä»…æ˜¯æ–‡ä»¶åçš„æ•°ç»„ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ·±å…¥åˆ° <code>isFIFO()</code> æ–¹æ³•ã€‚FIFO æ˜¯ &quot;First In, First Out&quot;ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰çš„ç¼©å†™ï¼Œåœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œå®ƒæŒ‡çš„æ˜¯ä¸€ç§ç‰¹å®šç±»å‹çš„ç®¡é“é€šä¿¡æ–¹å¼ï¼Œé€šå¸¸ç”¨äºè¿›ç¨‹é—´çš„é€šä¿¡ï¼ˆIPCï¼‰ã€‚åœ¨ UNIX å’Œç±» UNIX ç³»ç»Ÿä¸­ï¼ŒFIFO ä¹Ÿè¢«ç§°ä½œå‘½åç®¡é“ï¼ˆnamed pipeï¼‰ï¼Œå®ƒæ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ–‡ä»¶ç±»å‹ï¼Œå…è®¸ä¸¤ä¸ªè¿›ç¨‹è¿›è¡ŒåŒå‘é€šä¿¡ã€‚</p><p>å› æ­¤ï¼Œ<code>dirent.isFIFO()</code> æ–¹æ³•æ˜¯ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªç›®å½•é¡¹æ˜¯å¦ä¸º FIFO ç±»å‹çš„æ–¹æ³•ã€‚å¦‚æœ <code>dirent</code> å¯¹è±¡ä»£è¡¨çš„æ˜¯ä¸€ä¸ª FIFO æ–‡ä»¶ï¼Œåˆ™ <code>dirent.isFIFO()</code> è¿”å› <code>true</code>ï¼Œå¦åˆ™è¿”å› <code>false</code>ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-9" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-9"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œéœ€è¦å¤„ç†ä¸€ç³»åˆ—æ¥è‡ªä¸åŒæºçš„æ•°æ®æµã€‚å…¶ä¸­ä¸€ä¸ªç‰¹å®šçš„æ•°æ®æµæ˜¯é€šè¿‡ä¸€ä¸ª UNIX ç³»ç»Ÿä¸Šçš„å‘½åç®¡é“ï¼ˆFIFO æ–‡ä»¶ï¼‰æä¾›çš„ã€‚ä¸ºäº†æ­£ç¡®åœ°è¯†åˆ«å’Œæ“ä½œè¿™ä¸ªæ•°æ®æµï¼Œä½ å¯ä»¥é€šè¿‡æ£€æŸ¥æ–‡ä»¶ç±»å‹æ¥ç¡®å®šå“ªä¸ªæ˜¯ FIFO æ–‡ä»¶ã€‚</p><p>ç¤ºä¾‹ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> directoryPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/your/directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨å¼‚æ­¥æ–¹æ³•è¯»å–ç›®å½•å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> withFileTypes</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dirents</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error reading directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // éå†ç›®å½•é¡¹</span></span>
<span class="line"><span style="color:#D8DEE9;">  dirents</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forEach</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFIFO</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">      // å¦‚æœç›®å½•é¡¹æ˜¯ FIFO æ–‡ä»¶ï¼Œåˆ™è¾“å‡ºå…¶åç§°</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> is a FIFO file.</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† <code>fs</code> å’Œ <code>path</code> æ¨¡å—ã€‚ç„¶åï¼Œå®šä¹‰äº†ä¸€ä¸ªç›®å½•è·¯å¾„ï¼Œå¹¶ä½¿ç”¨ <code>fs.readdir()</code> æ–¹æ³•å¼‚æ­¥è¯»å–è¯¥ç›®å½•çš„å†…å®¹ã€‚æˆ‘ä»¬ä¼ é€’ <code>{ withFileTypes: true }</code> é€‰é¡¹ç»™ <code>fs.readdir()</code> æ–¹æ³•ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥è·å– <code>dirent</code> å¯¹è±¡ã€‚é€šè¿‡éå†è¿™äº›å¯¹è±¡å¹¶è°ƒç”¨æ¯ä¸ªå¯¹è±¡çš„ <code>isFIFO()</code> æ–¹æ³•ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè¯†åˆ«å‡ºä»»ä½• FIFO ç±»å‹çš„æ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºå…¶åç§°ã€‚</p><p>è¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½†å®ƒå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>dirent.isFIFO()</code> åœ¨å®é™…ä¸­è¯†åˆ«ç‰¹æ®Šæ–‡ä»¶ç±»å‹ï¼Œä»è€Œå¯ä»¥æ ¹æ®æ–‡ä»¶ç±»å‹æ‰§è¡Œç‰¹å®šçš„é€»è¾‘æˆ–æ“ä½œã€‚</p><h4 id="dirent-isfile" tabindex="-1"><a class="header-anchor" href="#dirent-isfile"><span><a href="https://nodejs.org/docs/latest/api/fs.html#direntisfile" target="_blank" rel="noopener noreferrer">dirent.isFile()</a></span></a></h4><p>ç†è§£ <code>dirent.isFile()</code> æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆæ˜ç™½å‡ ä¸ªæ¦‚å¿µï¼š</p><ol><li><p><strong>Node.js</strong>: Node.js æ˜¯ä¸€ä¸ªå…è®¸ä½ ä½¿ç”¨ JavaScript æ¥ç¼–å†™åç«¯ä»£ç çš„è¿è¡Œæ—¶ç¯å¢ƒã€‚ç®€å•æ¥è¯´ï¼Œå¦‚æœä½ æƒ³ç”¨ JavaScript å¼€å‘æœåŠ¡å™¨ç«¯çš„åº”ç”¨ç¨‹åºï¼ŒNode.js æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚</p></li><li><p><strong>æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰</strong>: è®¡ç®—æœºä¸Šå­˜å‚¨å’Œç®¡ç†æ–‡ä»¶çš„ä¸€ç§ç³»ç»Ÿã€‚é€šè¿‡æ–‡ä»¶ç³»ç»Ÿï¼Œä½ å¯ä»¥åˆ›å»ºã€è¯»å–ã€æ›´æ–°å’Œåˆ é™¤æ–‡ä»¶ã€‚</p></li><li><p><strong><code>fs</code> æ¨¡å—</strong>: åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æ˜¯ç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„ã€‚å®ƒæä¾›äº†ä¸€å¥—ç”¨äºæ–‡ä»¶æ“ä½œçš„ APIï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶ã€å†™å…¥æ–‡ä»¶ã€æ›´æ”¹æ–‡ä»¶æƒé™ç­‰ã€‚</p></li><li><p><strong>Dirent</strong>: Dirent æ˜¯ Directory Entry çš„ç¼©å†™ï¼Œè¡¨ç¤ºç›®å½•ä¸­çš„ä¸€ä¸ªå®ä½“ï¼Œè¿™ä¸ªå®ä½“å¯ä»¥æ˜¯æ–‡ä»¶ã€å­ç›®å½•ã€ç¬¦å·é“¾æ¥ç­‰ã€‚</p></li></ol><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ·±å…¥äº†è§£ <code>dirent.isFile()</code>:</p><h3 id="dirent-isfile-1" tabindex="-1"><a class="header-anchor" href="#dirent-isfile-1"><span><code>dirent.isFile()</code></span></a></h3><p><code>dirent.isFile()</code> æ˜¯ <code>fs</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨æ¥æ£€æŸ¥ç”± <code>fs.readdir()</code> æˆ– <code>fs.readdirSync()</code> è¯»å–çš„ç›®å½•é¡¹æ˜¯å¦ä¸ºæ™®é€šæ–‡ä»¶ã€‚å®ƒè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ â€”â€” å¦‚æœç›®å½•é¡¹æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œåˆ™è¿”å› <code>true</code>ï¼›å¦åˆ™ï¼Œè¿”å› <code>false</code>ã€‚</p><h3 id="å®é™…è¿ç”¨-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨-3"><span>å®é™…è¿ç”¨</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–‡ä»¶å¤¹ <code>myFolder</code>ï¼Œé‡Œé¢åŒ…å«å„ç§ç±»å‹çš„æ–‡ä»¶å’Œç›®å½•ã€‚æˆ‘ä»¬æƒ³è¦åˆ—å‡ºè¯¥æ–‡ä»¶å¤¹ä¸­æ‰€æœ‰çš„æ–‡ä»¶ï¼ˆä¸åŒ…æ‹¬å­ç›®å½•ï¼‰ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨ <code>dirent.isFile()</code> æ¥å®ç°è¿™ä¸ªéœ€æ±‚çš„ç¤ºä¾‹ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// myFolder è·¯å¾„ï¼Œæ ¹æ®å®é™…æƒ…å†µè¿›è¡Œä¿®æ”¹</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> folderPath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">__dirname</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">myFolder</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fs.readdir ä»¥å¼‚æ­¥æ–¹å¼è¯»å–ç›®å½•å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">folderPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> withFileTypes</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dirents</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–ç›®å½•å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // è¿‡æ»¤æ‰éæ–‡ä»¶çš„ç›®å½•é¡¹ï¼Œåªç•™ä¸‹æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> files</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> dirents</span></span>
<span class="line"><span style="color:#ECEFF4;">    .</span><span style="color:#88C0D0;">filter</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFile</span><span style="color:#D8DEE9FF;">())</span></span>
<span class="line"><span style="color:#ECEFF4;">    .</span><span style="color:#88C0D0;">map</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶åˆ—è¡¨:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> files</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† <code>fs</code> å’Œ <code>path</code> æ¨¡å—ã€‚ç„¶åï¼Œå®šä¹‰äº†æ–‡ä»¶å¤¹çš„è·¯å¾„ï¼Œå¹¶ä½¿ç”¨ <code>fs.readdir</code> å¼‚æ­¥è¯»å–ç›®å½•å†…å®¹ã€‚æ³¨æ„åˆ°æˆ‘ä»¬åœ¨è°ƒç”¨ <code>fs.readdir</code> æ—¶ä¼ é€’äº†ä¸€ä¸ªé€‰é¡¹ <code>{ withFileTypes: true }</code>ï¼Œè¿™ä½¿å¾—å›è°ƒå‡½æ•°ä¸­çš„ <code>dirents</code> å‚æ•°ä¼šåŒ…å« <code>Dirent</code> å¯¹è±¡ï¼Œè€Œä¸ä»…ä»…æ˜¯æ–‡ä»¶åå­—ç¬¦ä¸²ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>.filter()</code> æ–¹æ³•å’Œ <code>dirent.isFile()</code> æ£€æŸ¥æ¯ä¸ªç›®å½•é¡¹æ˜¯å¦æ˜¯æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨ <code>.map()</code> æ–¹æ³•è·å–è¿™äº›æ–‡ä»¶çš„åç§°ï¼Œå¹¶æ‰“å°å‡ºæ¥ã€‚</p><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•æœ‰æ•ˆåœ°ç­›é€‰å‡ºç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼Œè€Œå¿½ç•¥å…¶ä»–ç±»å‹çš„ç›®å½•é¡¹ï¼Œå¦‚å­ç›®å½•æˆ–ç¬¦å·é“¾æ¥ã€‚è¿™åœ¨å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ—¶æ˜¯ä¸€ä¸ªå¸¸è§ä¸”å®ç”¨çš„æ“ä½œã€‚</p><h4 id="dirent-issocket" tabindex="-1"><a class="header-anchor" href="#dirent-issocket"><span><a href="https://nodejs.org/docs/latest/api/fs.html#direntissocket" target="_blank" rel="noopener noreferrer">dirent.isSocket()</a></span></a></h4><p>å¥½çš„ï¼Œé¦–å…ˆè®©æˆ‘ä»¬ç®€å•äº†è§£ä¸€ä¸‹ Node.js å’Œ <code>dirent.isSocket()</code> å‡½æ•°ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-node-js-1" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-node-js-1"><span>ä»€ä¹ˆæ˜¯ Node.jsï¼Ÿ</span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒå…è®¸åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥ä½¿ç”¨åŒä¸€ç§è¯­è¨€æ¥ç¼–å†™å‰ç«¯å’Œåç«¯ä»£ç ã€‚Node.js ç‰¹åˆ«æ“…é•¿å¤„ç† I/O å¯†é›†å‹ä»»åŠ¡ï¼ˆå¦‚ç½‘ç»œé€šä¿¡ã€æ–‡ä»¶æ“ä½œç­‰ï¼‰ï¼Œè¿™å¾—ç›Šäºå®ƒçš„éé˜»å¡ I/O æ¨¡å‹ã€‚</p><h3 id="æ–‡ä»¶ç³»ç»Ÿ-fs-æ¨¡å—-1" tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶ç³»ç»Ÿ-fs-æ¨¡å—-1"><span>æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æä¾›äº†ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„ APIã€‚ä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥è¯»å–ç›®å½•å†…å®¹ã€åˆ›å»ºã€è¯»å–ã€å†™å…¥å’Œåˆ é™¤æ–‡ä»¶ç­‰ã€‚</p><h3 id="dirent-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#dirent-å¯¹è±¡"><span>Dirent å¯¹è±¡</span></a></h3><p>å½“ä½ ä½¿ç”¨ <code>fs</code> æ¨¡å—çš„æŸäº›å‡½æ•°ï¼ˆå¦‚ <code>fs.readdir()</code> æˆ– <code>fs.readdirSync()</code>ï¼‰ä»¥åŠç›¸å…³çš„å¼‚æ­¥æ–¹æ³•è¯»å–ç›®å½•å†…å®¹æ—¶ï¼Œä½ å¯ä»¥å¾—åˆ°ä¸€ä¸ªåŒ…å« <code>Dirent</code> å¯¹è±¡çš„æ•°ç»„ã€‚æ¯ä¸ª <code>Dirent</code> å¯¹è±¡ä»£è¡¨ç›®å½•ä¸­çš„ä¸€ä¸ªé¡¹ï¼ˆå¯ä»¥æ˜¯æ–‡ä»¶ã€ç›®å½•ã€ç¬¦å·é“¾æ¥ç­‰ï¼‰ã€‚</p><h3 id="dirent-issocket-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#dirent-issocket-æ–¹æ³•"><span><code>dirent.isSocket()</code> æ–¹æ³•</span></a></h3><p><code>dirent.isSocket()</code> æ˜¯ <code>Dirent</code> ç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨äºæ£€æŸ¥ç›¸åº”çš„é¡¹æ˜¯å¦æ˜¯ä¸€ä¸ª<strong>å¥—æ¥å­—æ–‡ä»¶</strong>ã€‚å¦‚æœæ˜¯ï¼Œè¯¥æ–¹æ³•è¿”å› <code>true</code>ï¼›å¦åˆ™ï¼Œè¿”å› <code>false</code>ã€‚</p><h4 id="å¥—æ¥å­—-sockets" tabindex="-1"><a class="header-anchor" href="#å¥—æ¥å­—-sockets"><span>å¥—æ¥å­—ï¼ˆSocketsï¼‰</span></a></h4><p>åœ¨è®¡ç®—æœºç½‘ç»œä¸­ï¼Œå¥—æ¥å­—ç”¨äºåœ¨ä¸åŒè®¡ç®—æœºæˆ–åŒä¸€è®¡ç®—æœºçš„ä¸åŒè¿›ç¨‹é—´è¿›è¡Œé€šä¿¡ã€‚å®ƒä»¬æ˜¯å®ç°ç½‘ç»œé€šä¿¡çš„åŸºç¡€ã€‚</p><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-11" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-11"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œéœ€è¦æ‰«æä¸€ä¸ªç›®å½•ï¼Œæ‰¾å‡ºæ‰€æœ‰çš„å¥—æ¥å­—æ–‡ä»¶ï¼Œå¹¶å¯¹å®ƒä»¬è¿›è¡Œç‰¹å®šæ“ä½œã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨ <code>dirent.isSocket()</code> æ¥å®ç°è¿™ä¸€ç‚¹çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> directoryPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/some/directory/path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥è¯»å–ç›®å½•å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> withFileTypes</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dirents</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error reading directory:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // éå†ç›®å½•é¡¹</span></span>
<span class="line"><span style="color:#D8DEE9;">  dirents</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forEach</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isSocket</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">      // å¦‚æœæ˜¯å¥—æ¥å­—æ–‡ä»¶ï¼Œæ‰“å°å…¶åç§°</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Found a socket:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥å¿…éœ€çš„ <code>fs</code> å’Œ <code>path</code> æ¨¡å—ã€‚ç„¶åï¼Œä½¿ç”¨ <code>fs.readdir()</code> ä»¥å¼‚æ­¥æ–¹å¼è¯»å–æŒ‡å®šç›®å½•çš„å†…å®¹ã€‚é€šè¿‡è®¾ç½®é€‰é¡¹ <code>{ withFileTypes: true }</code>ï¼Œæˆ‘ä»¬èƒ½å¤Ÿç›´æ¥è·å– <code>Dirent</code> å¯¹è±¡è€Œä¸åªæ˜¯æ–‡ä»¶åå­—ç¬¦ä¸²ã€‚ä¹‹åï¼Œæˆ‘ä»¬éå†è¿™äº›å¯¹è±¡ï¼Œä½¿ç”¨ <code>isSocket()</code> æ–¹æ³•æ£€æŸ¥æ¯ä¸ªé¡¹æ˜¯å¦ä¸ºå¥—æ¥å­—æ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºå¥—æ¥å­—æ–‡ä»¶çš„åç§°ã€‚</p><p>è¿™ç§æ–¹æ³•éå¸¸é€‚ç”¨äºéœ€è¦è¯†åˆ«å’Œå¤„ç†ç‰¹å®šç±»å‹æ–‡ä»¶çš„åœºæ™¯ã€‚å¸Œæœ›è¿™ä¸ªè§£é‡Šå’Œç¤ºä¾‹æœ‰åŠ©äºä½ ç†è§£ <code>dirent.isSocket()</code> æ–¹æ³•çš„ä½œç”¨å’Œç”¨æ³•ã€‚</p><h4 id="dirent-issymboliclink" tabindex="-1"><a class="header-anchor" href="#dirent-issymboliclink"><span><a href="https://nodejs.org/docs/latest/api/fs.html#direntissymboliclink" target="_blank" rel="noopener noreferrer">dirent.isSymbolicLink()</a></span></a></h4><p>å¥½çš„ï¼Œä½ æƒ³äº†è§£çš„æ˜¯ Node.js ä¸­<code>dirent.isSymbolicLink()</code>æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒç”¨äºåˆ¤æ–­ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿç›®å½•é¡¹ï¼ˆDirentï¼‰æ˜¯å¦æ˜¯ç¬¦å·é“¾æ¥ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å¾—çŸ¥é“ä»€ä¹ˆæ˜¯ç¬¦å·é“¾æ¥ã€‚åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œç¬¦å·é“¾æ¥æ˜¯ä¸€ä¸ªç‰¹æ®Šç±»å‹çš„æ–‡ä»¶ï¼Œå®ƒåŒ…å«å¯¹å¦ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„å¼•ç”¨ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªæŒ‡å‘å¦ä¸€ä¸ªä½ç½®çš„å¿«æ·æ–¹å¼ã€‚ç¬¦å·é“¾æ¥åœ¨ Unixã€Linux å’Œç±» Unix ç³»ç»Ÿï¼ˆåŒ…æ‹¬ macOSï¼‰ï¼Œä»¥åŠ Windows ä¸­éƒ½å­˜åœ¨ã€‚</p><p>ç°åœ¨ï¼Œæ¥è¯´è¯´<code>dirent.isSymbolicLink()</code>æ–¹æ³•ã€‚å½“ä½ åœ¨ Node.js ä¸­ä½¿ç”¨ fs æ¨¡å—è¯»å–ä¸€ä¸ªç›®å½•å†…å®¹æ—¶ï¼Œä½ å¯ä»¥é€šè¿‡è°ƒç”¨<code>fs.readdir()</code>æˆ–<code>fs.readdirSync()</code>å‡½æ•°å¹¶ä¼ é€’ä¸€ä¸ªç‰¹åˆ«çš„é€‰é¡¹<code>{ withFileTypes: true }</code>æ¥è·å–ä¸€ä¸ªåŒ…å« Dirent å¯¹è±¡çš„æ•°ç»„ã€‚æ¯ä¸ª Dirent å¯¹è±¡ä»£è¡¨ç›®å½•ä¸­çš„ä¸€ä¸ªæ–‡ä»¶æˆ–å­ç›®å½•ã€‚è°ƒç”¨ Dirent å¯¹è±¡ä¸Šçš„<code>isSymbolicLink()</code>æ–¹æ³•ä¼šå‘Šè¯‰ä½ è¿™ä¸ªå¯¹è±¡æ˜¯å¦è¡¨ç¤ºä¸€ä¸ªç¬¦å·é“¾æ¥ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><p>å‡è®¾ä½ æœ‰å¦‚ä¸‹çš„æ–‡ä»¶ç»“æ„ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>/myfolder</span></span>
<span class="line"><span>  /file.txt</span></span>
<span class="line"><span>  /linktofile.txt (è¿™æ˜¯ä¸€ä¸ªæŒ‡å‘file.txtçš„ç¬¦å·é“¾æ¥)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ å¯ä»¥ç”¨ Node.js ç¼–å†™ä»¥ä¸‹ä»£ç æ¥æ£€æŸ¥å“ªäº›æ˜¯ç¬¦å·é“¾æ¥ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æŒ‡å®šç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> folderPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/myfolder</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è¯»å–ç›®å½•å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">folderPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> withFileTypes</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dirents</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–ç›®å½•æ—¶å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // éå†ç›®å½•é¡¹</span></span>
<span class="line"><span style="color:#81A1C1;">  for</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#81A1C1;"> of</span><span style="color:#D8DEE9;"> dirents</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // ä½¿ç”¨ isSymbolicLink æ–¹æ³•æ¥åˆ¤æ–­è¯¥ç›®å½•é¡¹æ˜¯å¦æ˜¯ç¬¦å·é“¾æ¥</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isSymbolicLink</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> ä¸æ˜¯ç¬¦å·é“¾æ¥</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ä½ è¿è¡Œè¿™æ®µä»£ç æ—¶ï¼Œå®ƒä¼šè¯»å–<code>/myfolder</code>ç›®å½•ï¼Œå¹¶æ‰“å°å‡ºå“ªäº›é¡¹æ˜¯ç¬¦å·é“¾æ¥ã€‚è¾“å‡ºå¯èƒ½ä¼šæ˜¯è¿™æ ·çš„ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>file.txt ä¸æ˜¯ç¬¦å·é“¾æ¥</span></span>
<span class="line"><span>linktofile.txt æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ï¼Œé€šè¿‡æ£€æŸ¥æ¯ä¸ª direntï¼Œä½ å°±èƒ½çŸ¥é“ç›®å½•ä¸­å“ªäº›æ–‡ä»¶æ˜¯ç”±ç¬¦å·é“¾æ¥æŒ‡å‘çš„ï¼Œè¿™åœ¨å¾ˆå¤šåº”ç”¨ç¨‹åºä¸­ï¼Œæ¯”å¦‚æ–‡ä»¶ç®¡ç†å™¨ã€å¤‡ä»½å·¥å…·æˆ–è€…åœ¨å¤„ç†æ–‡ä»¶é“¾æ¥æ—¶éƒ½éå¸¸å®ç”¨ã€‚</p><h4 id="dirent-name" tabindex="-1"><a class="header-anchor" href="#dirent-name"><span><a href="https://nodejs.org/docs/latest/api/fs.html#direntname" target="_blank" rel="noopener noreferrer">dirent.name</a></span></a></h4><p>åœ¨ Node.js ä¸­ï¼Œ<code>dirent.name</code>æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå®ƒå±äº<code>fs.Dirent</code>å¯¹è±¡ã€‚<code>fs.Dirent</code>å¯¹è±¡æ¥è‡ªäºä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>ï¼‰æ¨¡å—ä¸­çš„ä¸€äº›ç‰¹å®šæ–¹æ³•ï¼Œæ¯”å¦‚<code>fs.readdir</code>å’Œ<code>fs.readdirSync</code>æ—¶ï¼Œå½“ä½ å°†è¿™äº›æ–¹æ³•çš„<code>withFileTypes</code>é€‰é¡¹è®¾ç½®ä¸º<code>true</code>æ—¶ï¼Œè¿™äº›æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªåŒ…å«<code>fs.Dirent</code>å¯¹è±¡çš„æ•°ç»„ï¼Œè€Œä¸æ˜¯ä»…ä»…è¿”å›æ–‡ä»¶åçš„å­—ç¬¦ä¸²æ•°ç»„ã€‚</p><h3 id="dirent-nameçš„ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#dirent-nameçš„ä½œç”¨"><span><code>dirent.name</code>çš„ä½œç”¨</span></a></h3><p>ç®€å•æ¥è¯´ï¼Œ<code>dirent.name</code>æä¾›äº†å½“å‰ç›®å½•é¡¹ï¼ˆæ–‡ä»¶ã€å­ç›®å½•ç­‰ï¼‰çš„åç§°ã€‚è¿™æ„å‘³ç€ï¼Œé€šè¿‡<code>dirent.name</code>ï¼Œä½ å¯ä»¥è·å–åˆ°æ–‡ä»¶æˆ–å­ç›®å½•çš„åå­—ã€‚</p><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-12" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-12"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç›®å½•<code>exampleDir</code>ï¼Œé‡Œé¢åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼š<code>file1.txt</code>ã€<code>file2.txt</code>å’Œä¸€ä¸ªå­ç›®å½•<code>subDir</code>ã€‚</p><p>æˆ‘ä»¬æƒ³è¦åˆ—å‡ºè¿™ä¸ªç›®å½•ä¸­æ‰€æœ‰é¡¹ç›®çš„åç§°ï¼ˆåŒ…æ‹¬æ–‡ä»¶å’Œå­ç›®å½•ï¼‰ï¼Œä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨<code>dirent.name</code>æ¥å®ç°è¿™ä¸ªç›®çš„ï¼š</p><h4 id="ç¤ºä¾‹-1-ä½¿ç”¨fs-readdirå¼‚æ­¥ç‰ˆæœ¬" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ä½¿ç”¨fs-readdirå¼‚æ­¥ç‰ˆæœ¬"><span>ç¤ºä¾‹ 1: ä½¿ç”¨<code>fs.readdir</code>å¼‚æ­¥ç‰ˆæœ¬</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æŒ‡å®šç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dirPath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">__dirname</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">exampleDir</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è¯»å–ç›®å½•å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> withFileTypes</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dirents</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–ç›®å½•å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // æ‰“å°æ¯ä¸ªç›®å½•é¡¹çš„åç§°</span></span>
<span class="line"><span style="color:#D8DEE9;">  dirents</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forEach</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-ä½¿ç”¨fs-readdirsyncåŒæ­¥ç‰ˆæœ¬" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨fs-readdirsyncåŒæ­¥ç‰ˆæœ¬"><span>ç¤ºä¾‹ 2: ä½¿ç”¨<code>fs.readdirSync</code>åŒæ­¥ç‰ˆæœ¬</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æŒ‡å®šç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dirPath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">__dirname</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">exampleDir</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // åŒæ­¥è¯»å–ç›®å½•å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> dirents</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdirSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> withFileTypes</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // æ‰“å°æ¯ä¸ªç›®å½•é¡¹çš„åç§°</span></span>
<span class="line"><span style="color:#D8DEE9;">  dirents</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forEach</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–ç›®å½•å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä¸¤ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä½•ä½¿ç”¨<code>fs.readdir</code>ï¼ˆå¼‚æ­¥ï¼‰å’Œ<code>fs.readdirSync</code>ï¼ˆåŒæ­¥ï¼‰æ–¹æ³•ä»¥åŠ<code>withFileTypes</code>é€‰é¡¹æ¥è·å–ä¸€ä¸ªç›®å½•ä¸­æ‰€æœ‰é¡¹ç›®çš„è¯¦ç»†ä¿¡æ¯ï¼Œç„¶åé€šè¿‡éå†è¿™ä¸ªç»“æœï¼Œå¹¶ä½¿ç”¨<code>dirent.name</code>è·å–æ¯ä¸ªé¡¹ç›®çš„åç§°ã€‚è¿™åœ¨å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ—¶éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚åœ¨åˆ›å»ºæ–‡ä»¶æµè§ˆå™¨ã€è¿›è¡Œæ–‡ä»¶ç®¡ç†æ“ä½œã€ç”Ÿæˆç›®å½•æ ‘ç»“æ„ç­‰åœºæ™¯ã€‚</p><h4 id="dirent-parentpath" tabindex="-1"><a class="header-anchor" href="#dirent-parentpath"><span><a href="https://nodejs.org/docs/latest/api/fs.html#direntparentpath" target="_blank" rel="noopener noreferrer">dirent.parentPath</a></span></a></h4><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥è°ˆè°ˆ Node.js ä¸­çš„ <code>dirent.parentPath</code> å±æ€§ã€‚</p><p>é¦–å…ˆï¼Œ<code>dirent</code> æ˜¯ Node.js ä¸­ <code>fs</code> æ¨¡å—ï¼ˆæ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼‰çš„ä¸€ä¸ªå¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡ä»£è¡¨äº†æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€ä¸ªç›®å½•é¡¹ï¼ˆdirectory entryï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒå¯èƒ½æ˜¯ä¸€ä¸ªæ–‡ä»¶æˆ–è€…æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼ˆç›®å½•ï¼‰ã€‚å½“ä½ åœ¨ Node.js ä¸­ä½¿ç”¨ä¸€äº›ç‰¹å®šçš„å‡½æ•°å»è¯»å–ç›®å½•å†…å®¹æ—¶ï¼Œä¾‹å¦‚ <code>fs.readdir()</code> æˆ– <code>fs.readdirSync()</code> å¹¶ä¸”è®¾ç½®é€‰é¡¹ <code>{ withFileTypes: true }</code>ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ª <code>Dirent</code> å¯¹è±¡çš„æ•°ç»„ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½ä»£è¡¨äº†ç›®å½•ä¸­çš„ä¸€ä¸ªé¡¹ç›®ã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>Dirent</code> ç±»æ–°å¢äº†ä¸€ä¸ªå±æ€§å« <code>parentPath</code>ã€‚è¿™ä¸ªå±æ€§åŒ…å«äº†åˆ›å»º <code>Dirent</code> å¯¹è±¡çš„çˆ¶ç›®å½•çš„è·¯å¾„ã€‚ç®€å•æ¥è¯´ï¼Œå¦‚æœä½ æ­£åœ¨æŸ¥çœ‹æŸä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼Œ<code>parentPath</code> å°±å‘Šè¯‰ä½ å®ƒæ‰€åœ¨çš„ä¸Šä¸€çº§ç›®å½•çš„è·¯å¾„ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä»¥ä»£ç ç¤ºä¾‹çš„æ–¹å¼æ›´è¯¦ç»†åœ°äº†è§£å®ƒï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> listDirectoryContents</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // ä½¿ç”¨ { withFileTypes: true } é€‰é¡¹æ¥è·å– Dirent å¯¹è±¡ã€‚</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> dirents</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> withFileTypes</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    for</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#81A1C1;"> of</span><span style="color:#D8DEE9;"> dirents</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> - Parent Path: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">parentPath</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error reading directory:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç›®å½• &#39;/users/documents&#39;</span></span>
<span class="line"><span style="color:#88C0D0;">listDirectoryContents</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/users/documents</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>listDirectoryContents</code> çš„å¼‚æ­¥å‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªå‚æ•° <code>directoryPath</code>ã€‚è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯åˆ—å‡ºç»™å®šç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼Œå¹¶æ‰“å°å‡ºå®ƒä»¬çš„åç§°ä»¥åŠçˆ¶ç›®å½•çš„è·¯å¾„ã€‚</p><p>ä¾‹å¦‚ï¼Œå‡è®¾ <code>/users/documents</code> ç›®å½•æœ‰å¦‚ä¸‹ç»“æ„ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>/users/documents/</span></span>
<span class="line"><span>â”œâ”€â”€ report.txt</span></span>
<span class="line"><span>â”œâ”€â”€ photos/</span></span>
<span class="line"><span>â”‚   â””â”€â”€ vacation.jpg</span></span>
<span class="line"><span>â””â”€â”€ taxes/</span></span>
<span class="line"><span>    â””â”€â”€ w2.pdf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œ <code>listDirectoryContents(&#39;/users/documents&#39;)</code> ä¼šè¾“å‡ºï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>report.txt - Parent Path: /users/documents</span></span>
<span class="line"><span>photos - Parent Path: /users/documents</span></span>
<span class="line"><span>taxes - Parent Path: /users/documents</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¯ä¸€è¡Œæ˜¾ç¤ºäº†ç›®å½•ä¸­ä¸€ä¸ªæ¡ç›®çš„åç§°å’Œå®ƒçš„çˆ¶ç›®å½•è·¯å¾„ã€‚æ³¨æ„ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>parentPath</code> å±æ€§å¯¹äºæ¯ä¸ª <code>Dirent</code> å¯¹è±¡è€Œè¨€æ˜¯ç›¸åŒçš„ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ¥è‡ªäºåŒä¸€ä¸ªçˆ¶ç›®å½•ã€‚</p><p><code>parentPath</code> å±æ€§æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ä¿¡æ¯ï¼Œå› ä¸ºå®ƒèƒ½è®©ä½ è½»æ¾åœ°è·Ÿè¸ªä¸€ä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„ä½ç½®ï¼Œå°¤å…¶æ˜¯å½“ä½ åœ¨å¤„ç†å¤æ‚çš„æ–‡ä»¶ç³»ç»Ÿç»“æ„æ—¶ã€‚</p><h4 id="dirent-path" tabindex="-1"><a class="header-anchor" href="#dirent-path"><span><a href="https://nodejs.org/docs/latest/api/fs.html#direntpath" target="_blank" rel="noopener noreferrer">dirent.path</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>fs</code>ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰æ¨¡å—æ˜¯ç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ä¸€ä¸ªæ¨¡å—ã€‚è¿™ä¸ªæ¨¡å—æä¾›äº†å¾ˆå¤šåŒæ­¥å’Œå¼‚æ­¥çš„æ–¹æ³•ï¼Œç”¨äºæ‰§è¡Œå„ç§æ–‡ä»¶æ“ä½œã€‚</p><p><code>dirent.path</code> æ˜¯ <code>fs</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒå…³è”äº <code>fs.Dirent</code> ç±»çš„å®ä¾‹ã€‚<code>Dirent</code> ç±»çš„å¯¹è±¡è¡¨ç¤ºæ–‡ä»¶ç³»ç»Ÿä¸­çš„ç›®å½•é¡¹ï¼ˆå¯ä»¥æ˜¯æ–‡ä»¶ã€å­ç›®å½•ç­‰ï¼‰ã€‚<code>dirent.path</code> å±æ€§è¿”å›çš„æ˜¯ä¸ <code>Dirent</code> å®ä¾‹ç›¸å…³çš„æ–‡ä»¶æˆ–ç›®å½•çš„å®Œæ•´è·¯å¾„ã€‚</p><p>å½“ä½ ä½¿ç”¨ <code>fs.readdir()</code> æˆ– <code>fs.readdirSync()</code> æ–¹æ³•ä»¥åŠ <code>{ withFileTypes: true }</code> é€‰é¡¹è¯»å–ç›®å½•å†…å®¹æ—¶ï¼Œè¿™äº›æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªåŒ…å« <code>Dirent</code> å¯¹è±¡çš„æ•°ç»„ã€‚æ¯”å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æˆ‘ä»¬è¦è¯»å–å½“å‰ç›®å½•çš„å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> directoryPath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> __dirname</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥è¯»å–ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> withFileTypes</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> dirents</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–ç›®å½•å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  for</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dirent</span><span style="color:#81A1C1;"> of</span><span style="color:#D8DEE9;"> dirents</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFile</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">      // å¦‚æœæ˜¯æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">        `</span><span style="color:#A3BE8C;">æ–‡ä»¶å: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">, å®Œæ•´è·¯å¾„: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">resolve</span><span style="color:#ECEFF4;">(</span></span>
<span class="line"><span style="color:#D8DEE9;">          directoryPath</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9;">          dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span></span>
<span class="line"><span style="color:#ECEFF4;">        )</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      )</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#81A1C1;"> else</span><span style="color:#81A1C1;"> if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isDirectory</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">      // å¦‚æœæ˜¯ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">        `</span><span style="color:#A3BE8C;">ç›®å½•å: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">, å®Œæ•´è·¯å¾„: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">resolve</span><span style="color:#ECEFF4;">(</span></span>
<span class="line"><span style="color:#D8DEE9;">          directoryPath</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9;">          dirent</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span></span>
<span class="line"><span style="color:#ECEFF4;">        )</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      )</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>${dirent.name}</code> æ˜¯ç›®å½•é¡¹çš„åç§°ï¼Œè€Œ <code>${path.resolve(directoryPath, dirent.name)}</code> åˆ™ä¼šæ ¹æ®ç»™å®šçš„è·¯å¾„ç‰‡æ®µè§£æå‡ºç»å¯¹è·¯å¾„ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç›´åˆ° Node.js ç‰ˆæœ¬ 21.7.1 ä¸ºæ­¢ï¼Œå®˜æ–¹æ–‡æ¡£å¹¶æ²¡æœ‰åˆ—å‡º <code>dirent.path</code> å±æ€§ã€‚è¿™æ„å‘³ç€é€šå¸¸æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥è‡ªå·±æ‹¼æ¥å®Œæ•´çš„è·¯å¾„ï¼Œå°±åƒåœ¨ä¸Šè¿°ä¾‹å­ä¸­ä½¿ç”¨ <code>path.resolve()</code> é‚£æ ·ã€‚å¦‚æœå°†æ¥çš„æŸä¸ªç‰ˆæœ¬ä¸­å¼•å…¥äº† <code>dirent.path</code> å±æ€§ï¼Œå®ƒå¾ˆå¯èƒ½ä¼šæä¾›ç±»ä¼¼çš„åŠŸèƒ½ï¼Œå³ç›´æ¥è·å¾—æ–‡ä»¶æˆ–ç›®å½•çš„å®Œæ•´è·¯å¾„ã€‚</p><p>æœ€åï¼Œè®°ä½ä»»ä½• Node.js ç‰ˆæœ¬å‡çº§éƒ½åº”æŸ¥çœ‹å…¶å®˜æ–¹æ–‡æ¡£æ¥è·å–æœ€å‡†ç¡®çš„ä¿¡æ¯å’Œç‰¹æ€§æ›´æ–°ã€‚</p><h3 id="class-fs-fswatcher" tabindex="-1"><a class="header-anchor" href="#class-fs-fswatcher"><span><a href="https://nodejs.org/docs/latest/api/fs.html#class-fsfswatcher" target="_blank" rel="noopener noreferrer">Class: fs.FSWatcher</a></span></a></h3><p>Node.js ä¸­çš„ <code>fs.FSWatcher</code> ç±»æ˜¯ç”¨äºç›‘å¬æ–‡ä»¶ç³»ç»Ÿçš„æ›´æ”¹çš„å·¥å…·ã€‚åœ¨ Node.js çš„ç‰ˆæœ¬ 21.7.1 ä¸­ï¼Œè¿™ä¸ªç±»å±äº <code>fs</code> (æ–‡ä»¶ç³»ç»Ÿ) æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œæä¾›äº†ä¸€ç§éå¸¸æœ‰æ•ˆçš„æ–¹å¼æ¥ç›‘è§†æ–‡ä»¶æˆ–ç›®å½•çš„å˜åŒ–ï¼Œå¹¶ä¸”åœ¨å‘ç”Ÿä»»ä½•ä¿®æ”¹æ—¶åšå‡ºååº”ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-18" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-18"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><ul><li><strong>äº‹ä»¶é©±åŠ¨</strong>ï¼šNode.js æ˜¯åŸºäºäº‹ä»¶é©±åŠ¨çš„æ¶æ„ï¼Œåœ¨ <code>fs.FSWatcher</code> ä¸­ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥æ³¨å†Œäº‹ä»¶ç›‘å¬å‡½æ•°ï¼Œåœ¨æ–‡ä»¶ç³»ç»Ÿçš„ç‰¹å®šæ›´æ”¹ï¼ˆå¦‚æ–‡ä»¶è¢«ä¿®æ”¹ã€æ·»åŠ æˆ–åˆ é™¤ç­‰ï¼‰å‘ç”Ÿæ—¶è§¦å‘ç›¸åº”çš„å¤„ç†é€»è¾‘ã€‚</li><li><strong>éé˜»å¡</strong>ï¼š<code>fs.FSWatcher</code> ä½¿ç”¨å¼‚æ­¥æ–¹å¼ç›‘å¬æ–‡ä»¶ç³»ç»Ÿçš„å˜åŒ–ï¼Œè¿™æ ·å°±ä¸ä¼šé˜»å¡ç¨‹åºçš„å…¶ä»–æ“ä½œï¼Œè®©æ•´ä¸ªç¨‹åºè¿è¡Œæ›´åŠ é«˜æ•ˆã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-23" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-23"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-ç›‘æ§æ–‡ä»¶å˜åŒ–" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ç›‘æ§æ–‡ä»¶å˜åŒ–"><span>ç¤ºä¾‹ 1ï¼šç›‘æ§æ–‡ä»¶å˜åŒ–</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œéœ€è¦å®æ—¶åœ°å¯¹é…ç½®æ–‡ä»¶çš„æ›´æ”¹ä½œå‡ºå“åº”ï¼ˆæ¯”å¦‚é‡æ–°åŠ è½½é…ç½®ï¼‰ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>fs.FSWatcher</code> æ¥å®ç°è¿™ä¸€åŠŸèƒ½ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªç›‘è§†å™¨æ¥ç›‘è§†æŒ‡å®šæ–‡ä»¶çš„å˜åŒ–</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> watcher</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path/to/config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> filename</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#81A1C1;"> ===</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">change</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">é…ç½®æ–‡ä»¶ </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filename</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> å·²è¢«ä¿®æ”¹.</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // åœ¨è¿™é‡Œæ·»åŠ é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶çš„é€»è¾‘</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å½“ä¸å†éœ€è¦ç›‘è§†æ—¶ï¼Œå¯ä»¥å…³é—­ç›‘è§†å™¨</span></span>
<span class="line"><span style="color:#616E88;">// watcher.close();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-ç›‘æ§ç›®å½•å˜åŒ–" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ç›‘æ§ç›®å½•å˜åŒ–"><span>ç¤ºä¾‹ 2ï¼šç›‘æ§ç›®å½•å˜åŒ–</span></a></h4><p>å¦‚æœä½ çš„é¡¹ç›®ä¸­æœ‰ä¸€ä¸ªç›®å½•ï¼Œå¸Œæœ›çŸ¥é“é‡Œé¢ä½•æ—¶æ·»åŠ äº†æ–°æ–‡ä»¶æˆ–æœ‰æ–‡ä»¶è¢«åˆ é™¤ï¼ŒåŒæ ·å¯ä»¥åˆ©ç”¨ <code>fs.FSWatcher</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> watcher</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path/to/directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> filename</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#81A1C1;"> ===</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">rename</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">åœ¨ç›‘æ§çš„ç›®å½•ä¸­ï¼Œæ–‡ä»¶ </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filename</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> è¢«æ·»åŠ æˆ–åˆ é™¤.</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // æ·»åŠ æˆ–åˆ é™¤æ–‡ä»¶æ—¶çš„å¤„ç†é€»è¾‘</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#81A1C1;"> if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#81A1C1;"> ===</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">change</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">åœ¨ç›‘æ§çš„ç›®å½•ä¸­ï¼Œæ–‡ä»¶ </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filename</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> è¢«ä¿®æ”¹.</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // æ–‡ä»¶ä¿®æ”¹æ—¶çš„å¤„ç†é€»è¾‘</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// é€‚å½“æ—¶å€™å…³é—­ç›‘è§†å™¨</span></span>
<span class="line"><span style="color:#616E88;">// watcher.close();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ³¨æ„äº‹é¡¹-23" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-23"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li><strong>æ€§èƒ½ä¸èµ„æº</strong>ï¼šè™½ç„¶ <code>fs.FSWatcher</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œä½†æ˜¯è¿‡å¤šçš„ç›‘æ§ä»»åŠ¡å¯èƒ½ä¼šæ¶ˆè€—è¾ƒå¤šçš„ç³»ç»Ÿèµ„æºã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨æ—¶è¦è€ƒè™‘åˆ°åº”ç”¨çš„æ€§èƒ½å’Œèµ„æºæ¶ˆè€—ã€‚</li><li><strong>è·¨å¹³å°å·®å¼‚</strong>ï¼šç”±äºåº•å±‚æ“ä½œç³»ç»Ÿçš„å·®å¼‚ï¼Œ<code>fs.FSWatcher</code> çš„è¡Œä¸ºåœ¨ä¸åŒçš„å¹³å°ï¼ˆå¦‚ Windowsã€Linuxã€macOSï¼‰ä¸Šå¯èƒ½æœ‰æ‰€ä¸åŒã€‚å¼€å‘è·¨å¹³å°åº”ç”¨æ—¶éœ€è¦é¢å¤–æ³¨æ„è¿™ä¸€ç‚¹ã€‚</li></ul><p>é€šè¿‡ä¸Šè¿°ç¤ºä¾‹å’Œè§£é‡Šï¼Œä½ åº”è¯¥å¯¹ Node.js ä¸­ <code>fs.FSWatcher</code> ç±»æœ‰äº†åŸºæœ¬çš„äº†è§£ã€‚å®ƒæä¾›äº†ä¸€ç§é«˜æ•ˆã€ä¾¿æ·çš„æ–¹å¼æ¥å“åº”æ–‡ä»¶ç³»ç»Ÿçš„å˜åŒ–ï¼Œå¯¹äºéœ€è¦å®æ—¶å¤„ç†æ–‡ä»¶æ›´æ–°çš„åº”ç”¨æ¥è¯´ååˆ†æœ‰ç”¨ã€‚</p><h4 id="event-change" tabindex="-1"><a class="header-anchor" href="#event-change"><span><a href="https://nodejs.org/docs/latest/api/fs.html#event-change" target="_blank" rel="noopener noreferrer">Event: &#39;change&#39;</a></span></a></h4><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æ˜¯ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ã€‚å®ƒæä¾›äº†å„ç§å·¥å…·æ¥å¤„ç†æ–‡ä»¶å’Œç›®å½•ã€‚å…¶ä¸­ä¸€ä¸ªåŠŸèƒ½å°±æ˜¯èƒ½å¤Ÿç›‘å¬æ–‡ä»¶ç³»ç»Ÿçš„å˜åŒ–ï¼Œè¿™æ­£æ˜¯ <code>Event: &#39;change&#39;</code> æ‰€å…³è”çš„ã€‚</p><p><code>Event: &#39;change&#39;</code> æ˜¯ä¸€ä¸ªäº‹ä»¶ï¼Œå½“ä½¿ç”¨ <code>fs.watch()</code> æ–¹æ³•ç›‘è§†æ–‡ä»¶æˆ–ç›®å½•æ—¶è§¦å‘ã€‚å½“æ‰€ç›‘è§†çš„æ–‡ä»¶æˆ–ç›®å½•å‘ç”Ÿæ›´æ”¹æ—¶ï¼Œå°±ä¼šå‘å‡ºæ­¤äº‹ä»¶ã€‚</p><p>ä¸‹é¢ä¸¾å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­æ¥è¯´æ˜ï¼š</p><h3 id="å®ä¾‹-1-ç›‘å¬å•ä¸ªæ–‡ä»¶çš„å˜åŒ–" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-1-ç›‘å¬å•ä¸ªæ–‡ä»¶çš„å˜åŒ–"><span>å®ä¾‹ 1: ç›‘å¬å•ä¸ªæ–‡ä»¶çš„å˜åŒ–</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨åˆ¶ä½œä¸€ä¸ªè‡ªåŠ¨æ„å»ºå·¥å…·ï¼Œéœ€è¦åœ¨æºä»£ç å‘ç”Ÿå˜åŒ–æ—¶è‡ªåŠ¨é‡æ–°ç¼–è¯‘ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>fs.watch()</code> æ¥ç›‘å¬æºä»£ç æ–‡ä»¶çš„å˜åŠ¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘å¬æŸä¸ªæ–‡ä»¶çš„å˜åŒ–</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filename</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/your/file.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filename</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> changedFilename</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#81A1C1;"> ===</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">change</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶ </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">changedFilename</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> å‘ç”Ÿå˜åŒ–ï¼Œå¼€å§‹é‡æ–°ç¼–è¯‘...</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // åœ¨è¿™é‡Œæ‰§è¡Œç¼–è¯‘ä»£ç çš„é€»è¾‘</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨ <code>fs.watch()</code>ï¼Œå¹¶ç»™å®ƒä¼ é€’äº†è¦ç›‘å¬çš„æ–‡ä»¶åç§°å’Œä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚å½“æ–‡ä»¶å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè°ƒç”¨è¯¥å›è°ƒå‡½æ•°ï¼Œå¹¶ä¼ å…¥äº‹ä»¶ç±»å‹ï¼ˆä¾‹å¦‚ <code>&#39;change&#39;</code>ï¼‰å’Œå˜åŒ–çš„æ–‡ä»¶åã€‚</p><h3 id="å®ä¾‹-2-ç›‘å¬æ•´ä¸ªç›®å½•çš„å˜åŠ¨" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-2-ç›‘å¬æ•´ä¸ªç›®å½•çš„å˜åŠ¨"><span>å®ä¾‹ 2: ç›‘å¬æ•´ä¸ªç›®å½•çš„å˜åŠ¨</span></a></h3><p>å¦‚æœä½ æƒ³è¦ç›‘å¬æ•´ä¸ªç›®å½•åŠå…¶å­ç›®å½•å†…æ–‡ä»¶çš„å˜åŠ¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>fs.watch()</code> æ–¹æ³•ã€‚æ¯”å¦‚ï¼Œå½“ä½ æœ‰ä¸€ä¸ªé™æ€æ–‡ä»¶æœåŠ¡å™¨ï¼Œå¸Œæœ›åœ¨ä»»ä½•æ–‡ä»¶è¢«ä¿®æ”¹æ—¶éƒ½èƒ½å¾—åˆ°é€šçŸ¥ï¼Œä»è€Œåˆ·æ–°å†…å­˜ä¸­çš„ç¼“å­˜ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘å¬æŸä¸ªç›®å½•åŠå…¶å­ç›®å½•çš„å˜åŒ–</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> directory</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/your/directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directory</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> recursive</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> changedFilename</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#81A1C1;"> ===</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">change</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ£€æµ‹åˆ°æ–‡ä»¶æˆ–ç›®å½• </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">changedFilename</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> å‘ç”Ÿå˜åŒ–ã€‚</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // æ›´æ–°å†…å­˜ä¸­çš„ç¼“å­˜æˆ–å…¶ä»–å“åº”è¯¥å˜åŒ–çš„æ“ä½œ</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œé€šè¿‡è®¾ç½®é€‰é¡¹ <code>{ recursive: true }</code>ï¼Œå‘Šè¯‰ <code>fs.watch()</code> åŒæ—¶ç›‘å¬ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•çš„å˜åŒ–ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-24" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-24"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ol><li>æ–‡ä»¶ç³»ç»Ÿç›‘æ§å–å†³äºåº•å±‚æ“ä½œç³»ç»Ÿçš„æ”¯æŒï¼Œå› æ­¤è¡Œä¸ºå¯èƒ½ä¼šåœ¨ä¸åŒçš„å¹³å°ä¸Šæœ‰æ‰€å·®å¼‚ã€‚</li><li><code>fs.watch</code> å¯èƒ½ä¸ä¼šä¸ºæ‰€æœ‰çš„æ–‡ä»¶ç³»ç»Ÿæ›´æ”¹äº‹ä»¶æä¾› 100%çš„å‡†ç¡®æ€§ï¼Œç‰¹åˆ«æ˜¯åœ¨æŸäº›ç¼–è¾‘å™¨ä¸­ä¿å­˜æ–‡ä»¶æ—¶å¯èƒ½ä¸æ€»æ˜¯è§¦å‘å˜æ›´äº‹ä»¶ã€‚</li><li>åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šè§¦å‘å¤šæ¬¡äº‹ä»¶ï¼Œå³ä½¿æ–‡ä»¶æˆ–ç›®å½•åªæ›´æ”¹äº†ä¸€æ¬¡ã€‚</li></ol><p>ä½¿ç”¨ <code>fs.watch()</code> å‡½æ•°æ—¶è¦è€ƒè™‘åˆ°ä»¥ä¸Šæ³¨æ„äº‹é¡¹ï¼Œå¹¶åœ¨å¿…è¦æ—¶åŠ å…¥é¢å¤–çš„é€»è¾‘ä»¥å¤„ç†å¯èƒ½å‡ºç°çš„é—®é¢˜ã€‚</p><h4 id="event-close-1" tabindex="-1"><a class="header-anchor" href="#event-close-1"><span><a href="https://nodejs.org/docs/latest/api/fs.html#event-close_1" target="_blank" rel="noopener noreferrer">Event: &#39;close&#39;</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œè®©å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œäº‹ä»¶æ˜¯éå¸¸æ ¸å¿ƒçš„æ¦‚å¿µï¼Œå®ƒå…è®¸ä½ åœ¨æŸäº›åŠ¨ä½œå®Œæˆæ—¶åšå‡ºå“åº”ï¼Œè€Œä¸å¿…åœä¸‹æ¥ç­‰å¾…é‚£ä¸ªåŠ¨ä½œå®Œæˆã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-close-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-close-äº‹ä»¶"><span>ä»€ä¹ˆæ˜¯ &#39;close&#39; äº‹ä»¶ï¼Ÿ</span></a></h3><p>åœ¨ Node.js çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code> æ¨¡å—ï¼‰ä¸­ï¼Œ&#39;close&#39; äº‹ä»¶æ˜¯å½“ä¸€ä¸ª <code>fs.ReadStream</code> æˆ– <code>fs.WriteStream</code> æ–‡ä»¶è¢«å…³é—­æ—¶è§¦å‘çš„äº‹ä»¶ã€‚è¿™æ„å‘³ç€ï¼Œæ— è®ºæ˜¯å› ä¸ºæµè‡ªç„¶ç»“æŸè¿˜æ˜¯å› ä¸ºè°ƒç”¨äº† <code>.close()</code> æ–¹æ³•ï¼Œåªè¦æ–‡ä»¶æµå…³é—­ï¼Œ&#39;close&#39; äº‹ä»¶å°±ä¼šè¢«è§¦å‘ã€‚</p><h3 id="ä¸ºä»€ä¹ˆ-close-äº‹ä»¶é‡è¦" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆ-close-äº‹ä»¶é‡è¦"><span>ä¸ºä»€ä¹ˆ &#39;close&#39; äº‹ä»¶é‡è¦ï¼Ÿ</span></a></h3><p>ç›‘å¬ &#39;close&#39; äº‹ä»¶å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒå‘Šè¯‰ä½ æ–‡ä»¶æ“ä½œå·²ç»å®Œå…¨å®Œæˆï¼Œèµ„æºè¢«é‡Šæ”¾ï¼Œç°åœ¨å¯ä»¥å®‰å…¨åœ°è¿›è¡Œåç»­æ“ä½œï¼Œæ¯”å¦‚åˆ é™¤æ–‡ä»¶ã€æ‰“å¼€æ–°çš„æ–‡ä»¶æµç­‰ã€‚å¦‚æœä½ åœ¨æ–‡ä»¶è¿˜æ²¡å®Œå…¨å…³é—­æ—¶å°±è¿›è¡Œè¿™äº›æ“ä½œï¼Œå¯èƒ½ä¼šå¯¼è‡´é”™è¯¯æˆ–ä¸ä¸€è‡´çš„çŠ¶æ€ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-24" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-24"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-è¯»å–æ–‡ä»¶å¹¶å¤„ç†-close-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-è¯»å–æ–‡ä»¶å¹¶å¤„ç†-close-äº‹ä»¶"><span>ç¤ºä¾‹ 1ï¼šè¯»å–æ–‡ä»¶å¹¶å¤„ç† &#39;close&#39; äº‹ä»¶</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ <code>example.txt</code>ï¼Œæˆ‘ä»¬æƒ³ç”¨ Node.js è¯»å–å®ƒï¼Œå¹¶åœ¨å®Œæˆåè¾“å‡ºä¸€æ¡æ¶ˆæ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªå¯è¯»æµ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> readStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">data</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–æ•°æ®:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> chunk</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å½“æ–‡ä»¶è¯»å–å®Œæˆä¸”æ–‡ä»¶æµå…³é—­æ—¶ï¼Œè§¦å‘ &#39;close&#39; äº‹ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">close</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶è¯»å–å®Œæ¯•ï¼Œæµå·²å…³é—­ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-å†™å…¥æ–‡ä»¶å¹¶å¤„ç†-close-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å†™å…¥æ–‡ä»¶å¹¶å¤„ç†-close-äº‹ä»¶"><span>ç¤ºä¾‹ 2ï¼šå†™å…¥æ–‡ä»¶å¹¶å¤„ç† &#39;close&#39; äº‹ä»¶</span></a></h4><p>å‡è®¾æˆ‘ä»¬æƒ³è¦å†™å…¥ä¸€äº›å†…å®¹åˆ° <code>output.txt</code> æ–‡ä»¶ï¼Œå¹¶åœ¨å†™å…¥å®Œæˆåè·å–é€šçŸ¥ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªå¯å†™æµ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> writeStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">output.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello, world!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å†è§ï¼Œä¸–ç•Œï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å®Œæˆå†™å…¥æ“ä½œ</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘å¬ &#39;close&#39; äº‹ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">close</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å†™å…¥å®Œæ¯•ï¼Œæµå·²å…³é—­ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ€»ç»“-17" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-17"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡ç›‘å¬ &#39;close&#39; äº‹ä»¶ï¼Œä½ å¯ä»¥ç¡®ä¿æ–‡ä»¶æ“ä½œå®Œæˆå¹¶ä¸”æ–‡ä»¶èµ„æºè¢«æ­£ç¡®é‡Šæ”¾ã€‚è¿™å¯¹äºé¿å…èµ„æºæ³„éœ²å’Œç¡®ä¿æ•°æ®å®Œæ•´æ€§è‡³å…³é‡è¦ã€‚æ— è®ºæ˜¯è¯»å–å¤§é‡æ•°æ®ï¼Œè¿˜æ˜¯å†™å…¥é‡è¦ä¿¡æ¯ï¼Œ&#39;close&#39; äº‹ä»¶éƒ½æ˜¯ä½ æœ€å¯é çš„é€šçŸ¥æ–¹å¼ä¹‹ä¸€ã€‚</p><h4 id="event-error" tabindex="-1"><a class="header-anchor" href="#event-error"><span><a href="https://nodejs.org/docs/latest/api/fs.html#event-error" target="_blank" rel="noopener noreferrer">Event: &#39;error&#39;</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome çš„ V8 JavaScript å¼•æ“æ¥è¿è¡Œ JavaScript ä»£ç çš„ç¯å¢ƒã€‚å®ƒé€šå¸¸ç”¨äºåˆ›å»ºåç«¯æœåŠ¡ï¼ˆä¹Ÿç§°ä¸º APIï¼‰ï¼Œè¿™æ ·ä½ çš„å®¢æˆ·ç«¯åº”ç”¨å¦‚ç½‘é¡µæˆ–è€…æ‰‹æœºåº”ç”¨å°±èƒ½ä½¿ç”¨è¿™äº›æœåŠ¡ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ç§éå¸¸æ ¸å¿ƒçš„æ¦‚å¿µå«åšâ€œäº‹ä»¶â€ã€‚Node.js ä½¿ç”¨äº‹ä»¶é©±åŠ¨æ¶æ„ï¼Œè¿™æ„å‘³ç€å½“ç‰¹å®šçš„äº‹æƒ…å‘ç”Ÿæ—¶ï¼Œç›¸åº”çš„åŠ¨ä½œä¼šè¢«è§¦å‘æ‰§è¡Œã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªæ–‡ä»¶è¯»å–å®Œæˆæˆ–ä¸€ä¸ªç½‘ç»œè¯·æ±‚æ”¶åˆ°å“åº”æ—¶ã€‚</p><h3 id="event-error-1" tabindex="-1"><a class="header-anchor" href="#event-error-1"><span>[Event: &#39;error&#39;]</span></a></h3><p>åœ¨ Node.js çš„å„ä¸ªæ¨¡å—ä¸­ï¼Œ<code>&#39;error&#39;</code> äº‹ä»¶æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„äº‹ä»¶ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¼‚æ­¥æ“ä½œå’Œæµï¼ˆStreamsï¼‰æ—¶ã€‚å‡ ä¹æ‰€æœ‰çš„ Node.js çš„ API éƒ½éµå¾ªè¿™æ ·çš„çº¦å®šï¼šå¦‚æœä¸€ä¸ªå¼‚æ­¥æ“ä½œäº§ç”Ÿäº†é”™è¯¯ï¼Œé‚£ä¹ˆè¯¥é”™è¯¯å°†ä¼šä½œä¸º <code>&#39;error&#39;</code> äº‹ä»¶è¢«å‘é€ã€‚</p><h4 id="ä¸ºä»€ä¹ˆ-error-äº‹ä»¶é‡è¦" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆ-error-äº‹ä»¶é‡è¦"><span>ä¸ºä»€ä¹ˆ <code>error</code> äº‹ä»¶é‡è¦ï¼Ÿ</span></a></h4><ol><li><strong>é”™è¯¯å¤„ç†</strong>ï¼šå®ƒæä¾›ä¸€ç§æœºåˆ¶æ¥å¤„ç†å¼‚æ­¥æ“ä½œä¸­å‘ç”Ÿçš„é”™è¯¯ï¼Œé˜²æ­¢ç¨‹åºå´©æºƒã€‚</li><li><strong>ä»£ç æ¸…æ™°</strong>ï¼šé€šè¿‡ç›‘å¬ <code>&#39;error&#39;</code> äº‹ä»¶ï¼Œå¯ä»¥é›†ä¸­å¤„ç†é”™è¯¯ï¼Œä½¿å¾—ä»£ç æ›´åŠ æ¸…æ™°ã€æ˜“äºç»´æŠ¤ã€‚</li></ol><h4 id="å®é™…ç”¨ä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…ç”¨ä¾‹"><span>å®é™…ç”¨ä¾‹</span></a></h4><p>è®©æˆ‘ä»¬ä»¥ Node.js ä¸­çš„ <code>fs</code> æ¨¡å—ï¼ˆè´Ÿè´£æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼‰ä¸ºä¾‹ï¼Œçœ‹çœ‹å¦‚ä½•ä½¿ç”¨ <code>&#39;error&#39;</code> äº‹ä»¶ã€‚</p><h5 id="ä¾‹å­-1-è¯»å–æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-è¯»å–æ–‡ä»¶"><span>ä¾‹å­ 1ï¼šè¯»å–æ–‡ä»¶</span></a></h5><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> stream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./nonexistentfile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">stream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">data</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // æ­£å¸¸è¯»å–æ–‡ä»¶æ—¶å¤„ç†æ•°æ®</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">chunk</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">stream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">error</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // å½“è¯»å–å‘ç”Ÿé”™è¯¯æ—¶ï¼Œæ¯”å¦‚æ–‡ä»¶ä¸å­˜åœ¨</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">An error occurred:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°è¯•è¯»å–ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶ã€‚å› ä¸ºæ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ‰€ä»¥è¯»å–æ“ä½œä¼šå¤±è´¥å¹¶è§¦å‘ <code>&#39;error&#39;</code> äº‹ä»¶ã€‚é€šè¿‡ç›‘å¬è¿™ä¸ªäº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥æ•è·åˆ°è¿™ä¸ªé”™è¯¯ï¼Œå¹¶ä¸”å‹å¥½åœ°å¤„ç†å®ƒï¼Œè€Œä¸æ˜¯è®©æ•´ä¸ªç¨‹åºå´©æºƒã€‚</p><h5 id="ä¾‹å­-2-ç½‘ç»œè¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ç½‘ç»œè¯·æ±‚"><span>ä¾‹å­ 2ï¼šç½‘ç»œè¯·æ±‚</span></a></h5><p>è™½ç„¶ <code>&#39;error&#39;</code> äº‹ä»¶åœ¨ <code>fs</code> (æ–‡ä»¶ç³»ç»Ÿ) æ¨¡å—çš„æ–‡æ¡£ä¸­è¢«æåŠï¼Œä½†å®ƒåŒæ ·é€‚ç”¨äºå…¶ä»–æ¶‰åŠå¼‚æ­¥æ“ä½œçš„åœºæ™¯ï¼Œå¦‚ç½‘ç»œè¯·æ±‚ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> http</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">http</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> req</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> http</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">http://example.com/nonexistentpage</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // å¤„ç†å“åº”</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Status Code: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">res</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">statusCode</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">req</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">error</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // å¤„ç†è¯·æ±‚è¿‡ç¨‹ä¸­å‘ç”Ÿçš„é”™è¯¯</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error during the request:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯¹ä¸€ä¸ªå¯èƒ½ä¸å­˜åœ¨çš„é¡µé¢è¿›è¡Œäº† HTTP GET è¯·æ±‚ã€‚å¦‚æœå‡ºç°ç½‘ç»œé”™è¯¯ï¼ˆä¾‹å¦‚ï¼ŒåŸŸåè§£æå¤±è´¥ã€è¿æ¥è¶…æ—¶ç­‰ï¼‰ï¼Œåˆ™ä¼šè§¦å‘ <code>&#39;error&#39;</code> äº‹ä»¶ã€‚æˆ‘ä»¬é€šè¿‡ç›‘å¬ <code>&#39;error&#39;</code> äº‹ä»¶æ¥ä¼˜é›…åœ°å¤„ç†è¿™äº›é”™è¯¯æƒ…å†µã€‚</p><h3 id="æ€»ç»“-18" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-18"><span>æ€»ç»“</span></a></h3><p>äº†è§£å¹¶æ­£ç¡®å¤„ç† <code>&#39;error&#39;</code> äº‹ä»¶æ˜¯ç¼–å†™ç¨³å¥ Node.js åº”ç”¨çš„å…³é”®ã€‚å®ƒä¸ä»…å¸®åŠ©æˆ‘ä»¬ä¼˜é›…åœ°å¤„ç†é”™è¯¯ï¼Œè¿˜å¯ä»¥æå‡åº”ç”¨çš„å¥å£¯æ€§å’Œç”¨æˆ·ä½“éªŒã€‚</p><h4 id="watcher-close" tabindex="-1"><a class="header-anchor" href="#watcher-close"><span><a href="https://nodejs.org/docs/latest/api/fs.html#watcherclose" target="_blank" rel="noopener noreferrer">watcher.close()</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªè®© JavaScript è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¹³å°ï¼Œå®ƒéå¸¸é€‚åˆå¤„ç†ç½‘ç»œç›¸å…³çš„ä»»åŠ¡ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æ˜¯ç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ï¼Œå…¶æä¾›äº†ä¸€ç³»åˆ—çš„æ–¹æ³•æ¥æ“ä½œæ–‡ä»¶å’Œç›®å½•ã€‚å…¶ä¸­ï¼Œ<code>watcher.close()</code> æ–¹æ³•æ˜¯ä¸æ–‡ä»¶æˆ–ç›®å½•ç›‘æ§ç›¸å…³çš„åŠŸèƒ½ã€‚</p><p>å½“ä½ ä½¿ç”¨ <code>fs.watch()</code> æˆ–ç±»ä¼¼çš„æ–¹æ³•åˆ›å»ºä¸€ä¸ªç›‘è§†å™¨ï¼ˆwatcherï¼‰ç›‘å¬æŸä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„å˜åŒ–æ—¶ï¼ŒNode.js ä¼šè¿”å›ä¸€ä¸ª <code>FSWatcher</code> å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åŒ…å«äº†ä¸€ä¸ª <code>close()</code> æ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥åœæ­¢ç›‘å¬æ–‡ä»¶æˆ–ç›®å½•çš„å˜åŒ–ã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯-4" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯-4"><span>ä½¿ç”¨åœºæ™¯</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™ï¼Œå¹¶ä¸”æƒ³è¦å½“ç½‘ç«™çš„é…ç½®æ–‡ä»¶è¢«ä¿®æ”¹æ—¶è‡ªåŠ¨é‡æ–°åŠ è½½é…ç½®ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>fs.watch()</code> ç›‘å¬é…ç½®æ–‡ä»¶çš„å˜åŒ–ï¼Œå¹¶åœ¨å˜åŒ–å‘ç”Ÿæ—¶é‡æ–°è¯»å–é…ç½®æ–‡ä»¶ã€‚ä¸€æ—¦ä½ ä¸å†éœ€è¦ç›‘å¬ï¼ˆæ¯”å¦‚æœåŠ¡å™¨æ­£åœ¨å…³é—­ï¼‰ï¼Œå°±å¯ä»¥è°ƒç”¨ <code>watcher.close()</code> æ¥åœæ­¢ç›‘å¬ï¼Œé‡Šæ”¾èµ„æºã€‚</p><h3 id="å®é™…ä¾‹å­-11" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-11"><span>å®é™…ä¾‹å­</span></a></h3><h4 id="ç›‘å¬æ–‡ä»¶å˜åŒ–å¹¶åœ¨ä¸éœ€è¦æ—¶åœæ­¢ç›‘å¬" tabindex="-1"><a class="header-anchor" href="#ç›‘å¬æ–‡ä»¶å˜åŒ–å¹¶åœ¨ä¸éœ€è¦æ—¶åœæ­¢ç›‘å¬"><span>ç›‘å¬æ–‡ä»¶å˜åŒ–å¹¶åœ¨ä¸éœ€è¦æ—¶åœæ­¢ç›‘å¬</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªç›‘è§†å™¨ï¼Œç›‘è§† &#39;config.json&#39; æ–‡ä»¶çš„å˜åŒ–</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> watcher</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> filename</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#81A1C1;"> ===</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">change</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶ </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filename</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> å·²æ”¹å˜</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // è¿™é‡Œå¯ä»¥æ·»åŠ ä»£ç æ¥å¤„ç†æ–‡ä»¶å˜åŒ–ï¼Œä¾‹å¦‚é‡æ–°åŠ è½½é…ç½®</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾åœ¨æŸä¸ªæ—¶åˆ»æˆ‘ä»¬å†³å®šåœæ­¢ç›‘å¬ &#39;config.json&#39;</span></span>
<span class="line"><span style="color:#88C0D0;">setTimeout</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  watcher</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">åœæ­¢ç›‘è§† config.json æ–‡ä»¶</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 10000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // 10ç§’ååœæ­¢ç›‘å¬</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† <code>fs</code> æ¨¡å—ï¼Œå¹¶ä½¿ç”¨ <code>fs.watch()</code> æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªç›‘è§†å™¨æ¥ç›‘å¬åä¸º <code>config.json</code> çš„æ–‡ä»¶ã€‚æ¯å½“ <code>config.json</code> æ–‡ä»¶å‘ç”Ÿå˜åŒ–æ—¶ï¼Œéƒ½ä¼šæ‰§è¡Œå›è°ƒå‡½æ•°ã€‚åœ¨è¿™ä¸ªå›è°ƒå‡½æ•°é‡Œï¼Œæˆ‘ä»¬å¯ä»¥åŠ å…¥è‡ªå·±çš„é€»è¾‘æ¥å¤„ç†æ–‡ä»¶å˜åŒ–äº‹ä»¶ï¼Œå¦‚é‡è½½é…ç½®æ•°æ®ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡ <code>setTimeout</code> è®¾ç½®äº†ä¸€ä¸ªè®¡æ—¶å™¨ï¼Œåœ¨ 10 ç§’åè°ƒç”¨ <code>watcher.close()</code> æ–¹æ³•æ¥åœæ­¢å¯¹ <code>config.json</code> æ–‡ä»¶çš„ç›‘è§†ã€‚è¿™ä¸ªè¿‡ç¨‹æ¨¡æ‹Ÿäº†åœ¨å®é™…åº”ç”¨ä¸­å¯èƒ½éœ€è¦åœæ­¢ç›‘å¬æ–‡ä»¶å˜åŒ–çš„æƒ…å†µï¼Œé‡Šæ”¾ç›¸å…³èµ„æºã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œ<code>watcher.close()</code> æ–¹æ³•å¸®åŠ©æˆ‘ä»¬æœ‰æ•ˆåœ°ç®¡ç†èµ„æºï¼Œç¡®ä¿åœ¨ä¸å†éœ€è¦ç›‘å¬æ–‡ä»¶å˜åŒ–æ—¶èƒ½å¤ŸåŠæ—¶åœæ­¢ç›‘è§†ï¼Œé¿å…ä¸å¿…è¦çš„èµ„æºå ç”¨å’Œæ½œåœ¨çš„æ€§èƒ½é—®é¢˜ã€‚</p><h4 id="watcher-ref" tabindex="-1"><a class="header-anchor" href="#watcher-ref"><span><a href="https://nodejs.org/docs/latest/api/fs.html#watcherref" target="_blank" rel="noopener noreferrer">watcher.ref()</a></span></a></h4><p>å½“æˆ‘ä»¬è°ˆè®º Node.js ä¸­çš„<code>watcher.ref()</code>ï¼Œè¿™ä¸ªæ–¹æ³•å±äºæ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code> æ¨¡å—ï¼‰é‡Œçš„ä¸€ä¸ªåŠŸèƒ½ã€‚ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ Node.js ä¸­çš„â€œç›‘è§†å™¨ï¼ˆ<code>watcher</code>ï¼‰â€å’Œäº‹ä»¶å¾ªç¯çš„æ¦‚å¿µã€‚</p><h3 id="äº‹ä»¶å¾ªç¯å’Œç›‘è§†å™¨" tabindex="-1"><a class="header-anchor" href="#äº‹ä»¶å¾ªç¯å’Œç›‘è§†å™¨"><span>äº‹ä»¶å¾ªç¯å’Œç›‘è§†å™¨</span></a></h3><p>Node.js æ˜¯åŸºäºäº‹ä»¶é©±åŠ¨å’Œéé˜»å¡ I/O æ¨¡å‹çš„ï¼Œè¿™æ„å‘³ç€ Node.js å¯ä»¥åœ¨æ‰§è¡Œ IO æ“ä½œï¼ˆå¦‚è¯»å†™æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡ç­‰ï¼‰æ—¶ä¸ä¼šåœä¸‹æ¥ç­‰å¾…æ“ä½œå®Œæˆï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚è¿™ä¸€åˆ‡å¾—ç›Šäº Node.js çš„äº‹ä»¶å¾ªç¯æœºåˆ¶ã€‚</p><p>åœ¨è¿™ä¸ªæœºåˆ¶ä¸­ï¼Œæ‰€è°“çš„â€œç›‘è§†å™¨â€å°±æ˜¯è§‚å¯ŸæŸäº›èµ„æºï¼ˆå¦‚æ–‡ä»¶æˆ–ç›®å½•ï¼‰å˜åŒ–çš„ç›‘å¬å™¨ã€‚å½“è¢«ç›‘è§†çš„èµ„æºå‘ç”Ÿå˜åŒ–ï¼ˆä¾‹å¦‚ï¼Œæ–‡ä»¶è¢«ä¿®æ”¹ï¼‰æ—¶ï¼Œç›‘è§†å™¨ä¼šè‡ªåŠ¨è§¦å‘ç›¸åº”çš„å›è°ƒå‡½æ•°ã€‚</p><h3 id="watcher-ref-1" tabindex="-1"><a class="header-anchor" href="#watcher-ref-1"><span>watcher.ref()</span></a></h3><p><code>watcher.ref()</code> æ–¹æ³•æ˜¯ä¸ç›‘è§†å™¨ç›¸å…³è”çš„ä¸€ä¸ªé‡è¦æ–¹æ³•ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ä½ ä½¿ç”¨ Node.js çš„<code>fs.watch()</code> æˆ– <code>fs.watchFile()</code> æ–¹æ³•åˆ›å»ºä¸€ä¸ªç›‘è§†å™¨æ—¶ï¼Œè¿™ä¸ªç›‘è§†å™¨ä¼šè¢«åŠ å…¥åˆ° Node.js çš„äº‹ä»¶å¾ªç¯ä¸­ã€‚åªè¦äº‹ä»¶å¾ªç¯ä¸­è¿˜æœ‰ç›‘è§†å™¨åœ¨è¿è¡Œï¼ŒNode.js è¿›ç¨‹å°±ä¼šä¿æŒæ´»è·ƒçŠ¶æ€ï¼Œä¸ä¼šé€€å‡ºã€‚</p><p>ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½å¸Œæœ› Node.js è¿›ç¨‹åœ¨å®Œæˆæ‰€æœ‰å…¶ä»–ä»»åŠ¡åèƒ½å¤Ÿæ­£å¸¸é€€å‡ºï¼Œå³ä½¿è¿˜æœ‰ç›‘è§†å™¨åœ¨è¿è¡Œã€‚è¿™æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>watcher.unref()</code> æ–¹æ³•æ¥å®ç°ã€‚<code>watcher.unref()</code> æ–¹æ³•ä¼šå°†ç›‘è§†å™¨ä»äº‹ä»¶å¾ªç¯ä¸­ç§»é™¤ï¼Œè¿™æ ·å³ä½¿å®ƒè¿˜åœ¨è¿è¡Œï¼ŒNode.js è¿›ç¨‹ä¹Ÿå¯ä»¥åœ¨æ‰€æœ‰å…¶ä»–ä»»åŠ¡å®Œæˆåæ­£å¸¸é€€å‡ºã€‚</p><p>ç›¸å¯¹çš„ï¼Œå¦‚æœä½ ä¹‹å‰è°ƒç”¨è¿‡ <code>watcher.unref()</code>ï¼Œä½†åæ¥åˆæƒ³è®© Node.js è¿›ç¨‹ä¿æŒæ´»è·ƒç›´åˆ°è¯¥ç›‘è§†å™¨ç»“æŸï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ <code>watcher.ref()</code> æ–¹æ³•ã€‚<code>watcher.ref()</code> æ–¹æ³•ä¼šå†æ¬¡å°†ç›‘è§†å™¨æ·»åŠ åˆ°äº‹ä»¶å¾ªç¯ä¸­ï¼Œç¡®ä¿ Node.js è¿›ç¨‹ä¸ä¼šåœ¨ç›‘è§†å™¨ä»ç„¶è¿è¡Œæ—¶é€€å‡ºã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-28" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-28"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>æƒ³è±¡ä½ æ­£åœ¨æ„å»ºä¸€ä¸ªç®€å•çš„ç½‘ç«™ï¼Œéœ€è¦ç›‘è§†é…ç½®æ–‡ä»¶çš„å˜åŒ–ï¼Œä»¥ä¾¿åœ¨é…ç½®æ–‡ä»¶æ›´æ–°æ—¶è‡ªåŠ¨é‡æ–°åŠ è½½é…ç½®ã€‚ä½ å¯ä»¥ä½¿ç”¨<code>fs.watch()</code>åˆ›å»ºç›‘è§†å™¨æ¥å®ç°è¿™ä¸€åŠŸèƒ½ã€‚ä½†ä½ ä¹Ÿå¸Œæœ›åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå½“ä½ åœæ­¢æ›´æ”¹ä»£ç æ–‡ä»¶æ—¶ï¼ŒNode.js æœåŠ¡å™¨èƒ½å¤Ÿè‡ªåŠ¨ä¼˜é›…åœ°å…³é—­ï¼Œå³ä½¿ç›‘è§†å™¨è¿˜åœ¨è¿è¡Œã€‚è¿™æ—¶ï¼Œå°±å¯ä»¥åˆ©ç”¨<code>watcher.unref()</code>æ¥è®©è¿›ç¨‹ç»“æŸï¼Œè€Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä½¿ç”¨<code>watcher.ref()</code>ç¡®ä¿æœåŠ¡å™¨æŒç»­å“åº”æ–‡ä»¶å˜åŒ–ï¼Œä¸ä¼šå› ä¸ºæ— å…¶ä»–ä»»åŠ¡æ‰§è¡Œè€Œé€€å‡ºã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªç›‘è§†å™¨ç›‘è§†é…ç½®æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> configFileWatcher</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watch</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">path/to/config/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> filename</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#81A1C1;"> ===</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">change</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">é…ç½®æ–‡ä»¶å·²æ›´æ”¹ï¼Œé‡æ–°åŠ è½½é…ç½®...</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">      // è¿™é‡Œå¯ä»¥æ·»åŠ é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶çš„é€»è¾‘</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ ¹æ®ç¯å¢ƒé€‰æ‹©æ˜¯å¦è®©Node.jsè¿›ç¨‹å¯ä»¥ç»“æŸ</span></span>
<span class="line"><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">process</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">env</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">NODE_ENV</span><span style="color:#81A1C1;"> ===</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">development</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  configFileWatcher</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unref</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  configFileWatcher</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">ref</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥çµæ´»æ§åˆ¶ Node.js è¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼Œæ ¹æ®å®é™…éœ€æ±‚åœ¨å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒä¸­åšå‡ºåˆé€‚çš„è°ƒæ•´ã€‚</p><h4 id="watcher-unref" tabindex="-1"><a class="header-anchor" href="#watcher-unref"><span><a href="https://nodejs.org/docs/latest/api/fs.html#watcherunref" target="_blank" rel="noopener noreferrer">watcher.unref()</a></span></a></h4><p>Node.js ä¸­çš„ <code>watcher.unref()</code> æ–¹æ³•æ˜¯ä¸æ–‡ä»¶æˆ–ç›®å½•ç›‘æ§ç›¸å…³çš„åŠŸèƒ½ä¹‹ä¸€ã€‚è¦ç†è§£è¿™ä¸ªæ–¹æ³•ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦æ˜ç™½ Node.js ä¸­çš„å‡ ä¸ªæ¦‚å¿µï¼šäº‹ä»¶å¾ªç¯ã€å¼•ç”¨è®¡æ•°ä»¥åŠå¦‚ä½•ä½¿ç”¨ Node.js ç›‘å¬æ–‡ä»¶ç³»ç»Ÿçš„å˜åŒ–ã€‚</p><h3 id="_1-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#_1-ç®€ä»‹"><span>1. ç®€ä»‹</span></a></h3><ul><li><strong>äº‹ä»¶å¾ªç¯</strong>ï¼šNode.js ä½¿ç”¨äº‹ä»¶é©±åŠ¨æ¶æ„ï¼Œå…¶ä¸­å¤§å¤šæ•°æ“ä½œï¼ˆå¦‚è¯»å†™æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡ç­‰ï¼‰éƒ½æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ã€‚äº‹ä»¶å¾ªç¯å…è®¸ Node.js åœ¨æ²¡æœ‰é˜»å¡ä¸»çº¿ç¨‹çš„æƒ…å†µä¸‹æ‰§è¡Œè¿™äº›æ“ä½œï¼Œä½¿å¾—å®ƒèƒ½å¤Ÿå¤„ç†å¤šä¸ªæ“ä½œã€‚</li><li><strong>å¼•ç”¨è®¡æ•°</strong>ï¼šNode.js åœ¨å†…éƒ¨ä½¿ç”¨å¼•ç”¨è®¡æ•°æ¥è¿½è¸ªè¿˜æœ‰å¤šå°‘å¼‚æ­¥æ“ä½œæ­£åœ¨è¿›è¡Œä¸­ã€‚å¦‚æœå¼•ç”¨è®¡æ•°ä¸ä¸ºé›¶ï¼ŒNode.js è¿›ç¨‹å°†ä¿æŒæ´»è·ƒçŠ¶æ€ï¼Œä¸ä¼šé€€å‡ºã€‚</li><li><strong>æ–‡ä»¶ç³»ç»Ÿç›‘æ§</strong>ï¼š<code>fs</code> æ¨¡å—æä¾›äº†å·¥å…·æ¥ç›‘æ§æ–‡ä»¶æˆ–ç›®å½•çš„å˜åŒ–ã€‚å½“ä½ æƒ³çŸ¥é“æŸä¸ªæ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦è¢«ä¿®æ”¹ã€åˆ é™¤æˆ–é‡å‘½åæ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™äº›å·¥å…·ã€‚</li></ul><h3 id="_2-watcher-unref-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2-watcher-unref-æ–¹æ³•"><span>2. watcher.unref() æ–¹æ³•</span></a></h3><p>å½“ä½ ä½¿ç”¨ Node.js çš„ <code>fs.watch()</code> æˆ–è€… <code>fs.watchFile()</code> æ–¹æ³•åˆ›å»ºä¸€ä¸ªç›‘è§†å™¨ï¼ˆwatcherï¼‰æ¥ç›‘æ§æ–‡ä»¶æˆ–ç›®å½•çš„å˜åŒ–æ—¶ï¼ŒNode.js ä¼šå°†è¿™ä¸ªç›‘è§†å™¨ä½œä¸ºä¸€ä¸ªæ´»è·ƒçš„å¼•ç”¨åŠ å…¥åˆ°å†…éƒ¨çš„å¼•ç”¨è®¡æ•°ä¸­ã€‚è¿™æ„å‘³ç€åªè¦è¿™ä¸ªç›‘è§†å™¨å­˜åœ¨ï¼Œæ— è®ºå®ƒæ˜¯å¦æ­£åœ¨ç›‘æ§æ–‡ä»¶çš„å˜åŒ–ï¼ŒNode.js è¿›ç¨‹éƒ½ä¸ä¼šé€€å‡ºã€‚</p><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½å¸Œæœ›å³ä½¿è¿˜æœ‰æœªå®Œæˆçš„ç›‘è§†å™¨ï¼ŒNode.js è¿›ç¨‹ä¹Ÿèƒ½å¤Ÿæ­£å¸¸é€€å‡ºã€‚è¿™å°±æ˜¯ <code>watcher.unref()</code> æ–¹æ³•å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚è°ƒç”¨ <code>watcher.unref()</code> ä¼šå°†è¯¥ç›‘è§†å™¨ä» Node.js å†…éƒ¨å¼•ç”¨è®¡æ•°ä¸­ç§»é™¤ï¼Œè¿™æ ·å³ä½¿å®ƒä»ç„¶åœ¨è¿è¡Œï¼ŒNode.js è¿›ç¨‹ä¹Ÿå¯ä»¥åœ¨å…¶ä»–æ‰€æœ‰å¼‚æ­¥æ“ä½œå®Œæˆåæ­£å¸¸é€€å‡ºã€‚</p><h3 id="_3-å®é™…åº”ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#_3-å®é™…åº”ç”¨ç¤ºä¾‹"><span>3. å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œè¯¥åº”ç”¨éœ€è¦åœ¨å¯åŠ¨æ—¶æ£€æŸ¥æŸä¸ªé…ç½®æ–‡ä»¶çš„å˜åŒ–ï¼Œå¹¶ä¸”å¸Œæœ›åœ¨ä¸éœ€è¦ç›‘æ§è¯¥æ–‡ä»¶æ—¶è®©è¿›ç¨‹èƒ½å¤Ÿä¼˜é›…åœ°é€€å‡ºã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘æ§é…ç½®æ–‡ä»¶çš„å˜åŒ–</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> configFile</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> watcher</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">configFile</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> filename</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#81A1C1;"> ===</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">change</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filename</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> æ–‡ä»¶å·²æ”¹å˜ï¼Œé‡æ–°åŠ è½½é…ç½®...</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // è¿™é‡Œå¯ä»¥æ·»åŠ ä»£ç æ¥å¤„ç†é…ç½®æ–‡ä»¶çš„é‡æ–°åŠ è½½</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// é˜²æ­¢ watcher é˜»æ­¢è¿›ç¨‹é€€å‡º</span></span>
<span class="line"><span style="color:#D8DEE9;">watcher</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unref</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç›‘æ§äº†ä¸€ä¸ªåä¸º <code>config.json</code> çš„æ–‡ä»¶ã€‚ä¸€æ—¦è¯¥æ–‡ä»¶å‘ç”Ÿå˜åŒ–ï¼Œæˆ‘ä»¬å°±ä¼šæ”¶åˆ°é€šçŸ¥å¹¶å¯ä»¥åšå‡ºç›¸åº”çš„å¤„ç†ã€‚åŒæ—¶ï¼Œé€šè¿‡è°ƒç”¨ <code>watcher.unref()</code>ï¼Œæˆ‘ä»¬ç¡®ä¿äº†å³ä½¿ç›‘æ§ä»åœ¨è¿›è¡Œä¸­ï¼ŒNode.js è¿›ç¨‹ä¹Ÿå¯ä»¥åœ¨å®Œæˆå…¶å®ƒä»»åŠ¡åæ­£å¸¸é€€å‡ºï¼Œä»è€Œé¿å…äº†æ½œåœ¨çš„èµ„æºå ç”¨é—®é¢˜ã€‚</p><h3 id="ç»“è®º-5" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-5"><span>ç»“è®º</span></a></h3><p><code>watcher.unref()</code> æ˜¯ Node.js ä¸­ä¸€ä¸ªéå¸¸å®ç”¨çš„æ–¹æ³•ï¼Œç‰¹åˆ«é€‚ç”¨äºé‚£äº›éœ€è¦é•¿æ—¶é—´è¿è¡Œæˆ–ç›‘æ§æ–‡ä»¶å˜åŒ–ä½†åˆä¸å¸Œæœ›é˜»æ­¢è¿›ç¨‹é€€å‡ºçš„åœºæ™¯ã€‚é€šè¿‡åˆç†ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä½ å¯ä»¥æ›´çµæ´»åœ°æ§åˆ¶ä½ çš„åº”ç”¨è¡Œä¸ºå’Œèµ„æºç®¡ç†ã€‚</p><h3 id="class-fs-statwatcher" tabindex="-1"><a class="header-anchor" href="#class-fs-statwatcher"><span><a href="https://nodejs.org/docs/latest/api/fs.html#class-fsstatwatcher" target="_blank" rel="noopener noreferrer">Class: fs.StatWatcher</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ·±å…¥äº†è§£ Node.js ä¸­çš„ <code>fs.StatWatcher</code> ç±»ä»¥åŠå®ƒçš„ç”¨é€”ã€‚</p><p>é¦–å…ˆï¼Œ<code>fs</code> æ¨¡å—æ˜¯ Node.js çš„ä¸€ä¸ªå†…ç½®æ¨¡å—ï¼Œæä¾›äº†æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„åŠŸèƒ½ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥é€šè¿‡ä»£ç è¯»å–ã€å†™å…¥ã€ä¿®æ”¹æ–‡ä»¶æˆ–ç›®å½•ç­‰ã€‚åœ¨è¿™ä¸ªæ¨¡å—ä¸­ï¼Œ<code>StatWatcher</code> ç±»ä¸ºæˆ‘ä»¬æä¾›äº†ç›‘æ§æ–‡ä»¶æˆ–ç›®å½•å˜åŒ–çš„èƒ½åŠ›ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-fs-statwatcher" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-fs-statwatcher"><span>ä»€ä¹ˆæ˜¯ <code>fs.StatWatcher</code>?</span></a></h3><p><code>fs.StatWatcher</code> æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œèƒ½å¤Ÿç›‘è§†æ–‡ä»¶ç³»ç»Ÿä¸­æŸä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„çŠ¶æ€å˜åŒ–ã€‚ä¸€æ—¦è¢«ç›‘è§†çš„æ–‡ä»¶æˆ–ç›®å½•å‘ç”Ÿäº†å˜åŒ–ï¼ˆä¾‹å¦‚ï¼šæ–‡ä»¶å†…å®¹è¢«ä¿®æ”¹ã€æ–‡ä»¶è¢«åˆ é™¤ã€æ–‡ä»¶æƒé™æ›´æ”¹ç­‰ï¼‰ï¼Œ<code>fs.StatWatcher</code> å°±èƒ½ç«‹å³é€šçŸ¥ä½ ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-fs-statwatcher" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-fs-statwatcher"><span>å¦‚ä½•ä½¿ç”¨ <code>fs.StatWatcher</code>?</span></a></h3><p>è¦ä½¿ç”¨ <code>fs.StatWatcher</code>ï¼Œä½ éœ€è¦å…ˆé€šè¿‡ <code>fs.watchFile</code> æ–¹æ³•æ¥å¯åŠ¨å¯¹æ–‡ä»¶æˆ–ç›®å½•çš„ç›‘æ§ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®šä¹‰è¢«ç›‘æ§æ–‡ä»¶çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/my/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¯åŠ¨ç›‘æ§</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watchFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">curr</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> prev</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²æ›´æ–°</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">å½“å‰æ–‡ä»¶çŠ¶æ€: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">curr</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">ä¹‹å‰æ–‡ä»¶çŠ¶æ€: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">prev</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç›‘æ§äº† <code>file.txt</code> æ–‡ä»¶ã€‚ä¸€æ—¦æ–‡ä»¶çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼ˆæ¯”å¦‚å†…å®¹è¢«ä¿®æ”¹ï¼‰ï¼Œå›è°ƒå‡½æ•°å°±ä¼šè¢«æ‰§è¡Œï¼Œæ‰“å°å‡ºæœ‰å…³æ–‡ä»¶å½“å‰å’Œå…ˆå‰çŠ¶æ€çš„ä¿¡æ¯ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-10" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-10"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><ol><li><p><strong>è‡ªåŠ¨å¤‡ä»½</strong> - å‡è®¾ä½ æ­£åœ¨ç¼–è¾‘ä¸€äº›é‡è¦çš„æ–‡ä»¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>fs.StatWatcher</code> æ¥ç›‘æµ‹è¿™ä¸ªæ–‡ä»¶ï¼Œä¸€æ—¦æ–‡ä»¶å‘ç”Ÿæ”¹å˜ï¼Œè‡ªåŠ¨åˆ›å»ºæ–‡ä»¶çš„å¤‡ä»½ã€‚è¿™æ ·å¯ä»¥å¢åŠ æ•°æ®å®‰å…¨æ€§ã€‚</p></li><li><p><strong>å®æ—¶åŒæ­¥</strong> - å¦‚æœä½ åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦å¤šä¸ªä½ç½®åŒæ­¥æ–‡ä»¶çš„åº”ç”¨ï¼ˆå¦‚äº‘åŒæ­¥æœåŠ¡ï¼‰ï¼Œå½“æºæ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶è¢«ä¿®æ”¹æ—¶ï¼Œå¯ä»¥åˆ©ç”¨ <code>fs.StatWatcher</code> è§¦å‘åŒæ­¥æµç¨‹ï¼Œç¡®ä¿æ‰€æœ‰åœ°æ–¹çš„æ–‡ä»¶éƒ½æ˜¯æœ€æ–°çš„ã€‚</p></li><li><p><strong>è§¦å‘ç¼–è¯‘è¿‡ç¨‹</strong> - å¯¹äºå‰ç«¯å¼€å‘è€…ï¼Œå½“ä½ ä¿®æ”¹äº†é¡¹ç›®ä¸­çš„æºä»£ç æ–‡ä»¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>fs.StatWatcher</code> æ¥ç›‘æµ‹è¿™äº›å˜åŒ–ï¼Œå¹¶è‡ªåŠ¨è§¦å‘æ„å»ºæµç¨‹æˆ–æµ‹è¯•æµç¨‹ï¼Œå¤§å¤§æé«˜å¼€å‘æ•ˆç‡ã€‚</p></li></ol><p>è®°ä½ï¼Œè™½ç„¶ <code>fs.StatWatcher</code> éå¸¸å¼ºå¤§ï¼Œä½†é¢‘ç¹çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œä¹Ÿå¯èƒ½å¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚å› æ­¤ï¼Œè¯·æ ¹æ®å®é™…éœ€æ±‚åˆç†ä½¿ç”¨æ­¤åŠŸèƒ½ã€‚</p><p>å¸Œæœ›è¿™è§£é‡Šæ¸…æ¥šäº† <code>fs.StatWatcher</code> çš„æ¦‚å¿µå’Œå…¶åº”ç”¨æ–¹å¼ï¼</p><h4 id="watcher-ref-2" tabindex="-1"><a class="header-anchor" href="#watcher-ref-2"><span><a href="https://nodejs.org/docs/latest/api/fs.html#watcherref_1" target="_blank" rel="noopener noreferrer">watcher.ref()</a></span></a></h4><p>Node.js çš„ <code>watcher.ref()</code> æ–¹æ³•æ˜¯ä¸æ–‡ä»¶ç³»ç»Ÿç›‘è§†å™¨ç›¸å…³çš„åŠŸèƒ½ã€‚åœ¨ Node.js ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ç›‘å¬æŸä¸ªæ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹çš„å˜åŒ–ï¼Œæ¯”å¦‚æ–‡ä»¶è¢«ä¿®æ”¹ã€åˆ é™¤æˆ–æ–°å¢ç­‰ã€‚è¿™æ—¶å€™ï¼Œ<code>fs.watch</code> æˆ– <code>fs.watchFile</code> æ–¹æ³•å°±éå¸¸æœ‰ç”¨äº†ã€‚å®ƒä»¬å…è®¸æˆ‘ä»¬å¯¹æ–‡ä»¶ç³»ç»Ÿçš„å˜æ›´åšå‡ºååº”ã€‚</p><p>å½“ä½ ä½¿ç”¨è¿™äº›æ–¹æ³•ä¹‹ä¸€è®¾ç½®äº†ä¸€ä¸ªç›‘è§†å™¨ï¼ˆwatcherï¼‰ä¹‹åï¼ŒNode.js é»˜è®¤ä¼šä¿æŒè¿›ç¨‹è¿è¡Œï¼Œç›´åˆ°ä½ åœæ­¢ç›‘è§†æˆ–ç¨‹åºè‡ªèº«ç»“æŸã€‚è¿™æ˜¯å› ä¸ºç›‘è§†å™¨è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªæ´»åŠ¨çš„æ“ä½œï¼Œéœ€è¦æŒç»­å ç”¨èµ„æºã€‚</p><p>ç„¶è€Œï¼Œåœ¨æŸäº›åœºæ™¯ä¸­ï¼Œä½ å¯èƒ½å¸Œæœ›å³ä½¿è¿˜æœ‰æœªå®Œæˆçš„ç›‘è§†æ“ä½œï¼ŒNode.js è¿›ç¨‹ä¹Ÿèƒ½å¤Ÿæ­£å¸¸é€€å‡ºã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½åªæ˜¯æƒ³åœ¨ä¸€ä¸ªè„šæœ¬ä¸­ä¸´æ—¶ç›‘è§†æ–‡ä»¶å˜åŒ–ï¼Œè€Œä¸å¸Œæœ›è¿™ä¸ªç›‘è§†æ“ä½œé˜»æ­¢è„šæœ¬å®Œæˆã€‚</p><p>è¿™å°±æ˜¯ <code>watcher.ref()</code> å’Œ <code>watcher.unref()</code> å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚å®ƒä»¬å…è®¸ä½ æ§åˆ¶ç‰¹å®šçš„ç›‘è§†å™¨æ˜¯å¦åº”è¯¥é˜»æ­¢ Node.js è¿›ç¨‹é€€å‡ºã€‚</p><h3 id="watcher-ref-3" tabindex="-1"><a class="header-anchor" href="#watcher-ref-3"><span>watcher.ref()</span></a></h3><p>è°ƒç”¨ <code>watcher.ref()</code> ä¼šç¡®ä¿ Node.js è¿›ç¨‹åœ¨è¿™ä¸ªç›‘è§†å™¨æ´»è·ƒæ—¶ä¸ä¼šé€€å‡ºã€‚è¿™å®é™…ä¸Šæ˜¯é»˜è®¤è¡Œä¸ºã€‚å¦‚æœä½ ä¹‹å‰è°ƒç”¨äº† <code>watcher.unref()</code>ï¼Œä½¿å¾—ç›‘è§†å™¨ä¸å†é˜»æ­¢è¿›ç¨‹é€€å‡ºï¼Œé‚£ä¹ˆä½¿ç”¨ <code>watcher.ref()</code> å¯ä»¥æ¢å¤å…¶é»˜è®¤çš„è¡Œä¸ºã€‚</p><h4 id="å®é™…åº”ç”¨ç¤ºä¾‹-13" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-13"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªå¼€å‘å·¥å…·ï¼Œè¿™ä¸ªå·¥å…·éœ€è¦åœ¨åå°ç›‘æ§æŸä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶å˜æ›´ï¼Œä»¥è§¦å‘è‡ªåŠ¨æ„å»ºæˆ–æµ‹è¯•ä»»åŠ¡ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä½ ä¼šå¸Œæœ› Node.js è¿›ç¨‹ä¿æŒè¿è¡Œï¼Œç›´åˆ°ä½ æ˜ç¡®åœæ­¢ç›‘è§†æˆ–å…³é—­å·¥å…·ã€‚ä»£ç ç¤ºä¾‹å¯èƒ½å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘å¬å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶å˜åŒ–</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> watcher</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> filename</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶å˜åŒ–ç±»å‹: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">eventType</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">å˜åŒ–çš„æ–‡ä»¶: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filename</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç¡®ä¿è¿™ä¸ªç›‘è§†å™¨ä¼šé˜»æ­¢è¿›ç¨‹é€€å‡ºï¼ˆè¿™æ˜¯é»˜è®¤è¡Œä¸ºï¼Œæ­¤å¤„è°ƒç”¨ä»…ä½œæ¼”ç¤ºï¼‰</span></span>
<span class="line"><span style="color:#D8DEE9;">watcher</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">ref</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¯åŠ¨äº†ä¸€ä¸ªç›‘è§†å™¨æ¥ç›‘å¬å½“å‰ç›®å½•ä¸‹çš„ä»»ä½•å˜åŒ–ï¼Œå¹¶æ‰“å°å˜åŒ–ç±»å‹å’Œæ–‡ä»¶åã€‚é€šè¿‡è°ƒç”¨ <code>watcher.ref()</code>ï¼ˆè™½ç„¶é€šå¸¸ä¸å¿…è¦ï¼Œå› ä¸ºè¿™æ˜¯é»˜è®¤è¡Œä¸ºï¼‰ï¼Œæˆ‘ä»¬æ˜ç¡®è¡¨ç¤ºè¿™ä¸ªç›‘è§†å™¨å¯¹äºä¿æŒè¿›ç¨‹æ´»è·ƒæ˜¯å¿…è¦çš„ã€‚è¿™æ ·ï¼Œä½ çš„å¼€å‘å·¥å…·å°±å¯ä»¥åœ¨åå°æŒç»­è¿è¡Œï¼Œç›´è‡³ä½ å†³å®šåœæ­¢ç›‘è§†ã€‚</p><p>æ€»ç»“ï¼š<code>watcher.ref()</code> æ–¹æ³•ç”¨äºç¡®ä¿ Node.js è¿›ç¨‹åœ¨ç›‘è§†å™¨æ´»è·ƒæ—¶ç»§ç»­è¿è¡Œï¼Œå°¤å…¶é€‚ç”¨äºé‚£äº›éœ€è¦é•¿æ—¶é—´è¿è¡Œç›‘æ§ä»»åŠ¡çš„åº”ç”¨åœºæ™¯ã€‚</p><h4 id="watcher-unref-1" tabindex="-1"><a class="header-anchor" href="#watcher-unref-1"><span><a href="https://nodejs.org/docs/latest/api/fs.html#watcherunref_1" target="_blank" rel="noopener noreferrer">watcher.unref()</a></span></a></h4><p>Node.js ä¸­çš„<code>watcher.unref()</code>åŠŸèƒ½æ˜¯å’Œæ–‡ä»¶æˆ–ç›®å½•ç›‘è§†å™¨(watcher)ç›¸å…³çš„ã€‚åœ¨äº†è§£<code>watcher.unref()</code>ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆç®€å•æ¢è®¨ä¸€ä¸‹æ–‡ä»¶ç›‘è§†å™¨çš„ä½œç”¨ä»¥åŠä¸ºä»€ä¹ˆå®ƒä»¬å­˜åœ¨ã€‚</p><h3 id="æ–‡ä»¶ç›‘è§†å™¨-file-watchers" tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶ç›‘è§†å™¨-file-watchers"><span>æ–‡ä»¶ç›‘è§†å™¨(File Watchers)</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡æŸäº› API ç›‘å¬æ–‡ä»¶æˆ–ç›®å½•çš„å˜åŒ–ã€‚è¿™æ„å‘³ç€å½“ä½ å…³æ³¨çš„æ–‡ä»¶æˆ–ç›®å½•å‘ç”Ÿäº†ä¿®æ”¹ï¼ˆæ¯”å¦‚æ–‡ä»¶è¢«ç¼–è¾‘ã€åˆ é™¤æˆ–æ–°æ–‡ä»¶è¢«åˆ›å»ºç­‰ï¼‰ï¼ŒNode.js å¯ä»¥è‡ªåŠ¨é€šçŸ¥ä½ ã€‚è¿™å¯¹äºéœ€è¦å®æ—¶å“åº”æ–‡ä»¶ç³»ç»Ÿå˜åŒ–çš„åº”ç”¨ç¨‹åºæ¥è¯´éå¸¸æœ‰ç”¨ã€‚</p><p>ä¾‹å¦‚ï¼Œå¼€å‘ç¯å¢ƒä¸­çš„çƒ­é‡è½½ï¼ˆå½“ä½ ä¿å­˜ä»£ç æ–‡ä»¶åï¼Œè‡ªåŠ¨é‡æ–°åŠ è½½åº”ç”¨ï¼‰å°±æ˜¯ä¾èµ–äºè¿™æ ·çš„æ–‡ä»¶ç›‘è§†æœºåˆ¶ã€‚</p><h3 id="watcher-unref-2" tabindex="-1"><a class="header-anchor" href="#watcher-unref-2"><span><code>watcher.unref()</code></span></a></h3><p>å½“ä½ è®¾ç½®äº†ä¸€ä¸ªæ–‡ä»¶ç›‘è§†å™¨ï¼ŒNode.js è¿›ç¨‹ä¼šå› ä¸ºè¿™ä¸ªç›‘è§†å™¨ç»§ç»­è¿è¡Œï¼Œå³ä½¿æ²¡æœ‰å…¶ä»–æ“ä½œï¼ˆå¦‚ç½‘ç»œè¯·æ±‚ã€å®šæ—¶å™¨ç­‰ï¼‰ä¿æŒè¿›ç¨‹æ´»è·ƒã€‚è¿™æ˜¯å› ä¸ºæ–‡ä»¶ç›‘è§†å™¨è¢«è®¤ä¸ºæ˜¯<strong>æ´»è·ƒçš„ handle</strong>ï¼Œé˜»æ­¢äº† Node.js è¿›ç¨‹é€€å‡ºã€‚</p><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¸å¸Œæœ›æ–‡ä»¶ç›‘è§†å™¨é˜»æ­¢è¿›ç¨‹é€€å‡ºã€‚æ¯”å¦‚ï¼Œä½ åœ¨ä¸€ä¸ªå¤§å‹åº”ç”¨ä¸­åªæƒ³ä¸´æ—¶ç›‘è§†æ–‡ä»¶å˜åŒ–ï¼Œå¹¶ä¸”ä¸æƒ³è®©è¿™ä¸ªç›‘è§†å™¨å½±å“åˆ°æ•´ä¸ªåº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™æ—¶å€™ï¼Œ<code>watcher.unref()</code>å°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p><p>è°ƒç”¨<code>watcher.unref()</code>ä¼šä½¿å¾—å½“å‰çš„æ–‡ä»¶ç›‘è§†å™¨ä¸å†æ˜¯é˜»æ­¢ Node.js è¿›ç¨‹é€€å‡ºçš„æ´»è·ƒ handleã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœé™¤äº†è¿™äº›â€œå–æ¶ˆå¼•ç”¨â€çš„ç›‘è§†å™¨å¤–ï¼Œæ²¡æœ‰å…¶ä»–æ´»è·ƒçš„ handleï¼ŒNode.js è¿›ç¨‹å°†ä¼šæ­£å¸¸ç»“æŸã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-10" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-10"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªå·¥å…·ï¼Œè¯¥å·¥å…·çš„ä»»åŠ¡æ˜¯åœ¨æ–‡ä»¶å†…å®¹æ”¹å˜æ—¶æ‰§è¡ŒæŸäº›æ“ä½œï¼Œä½†ä½ åŒæ—¶å¸Œæœ›èƒ½å¤Ÿåœ¨æ‰§è¡Œå®Œå¿…è¦çš„ä»»åŠ¡åï¼Œå¦‚æœä¸å†éœ€è¦ç»§ç»­ç›‘è§†æ–‡ä»¶å˜åŒ–ï¼Œå…è®¸ç¨‹åºè‡ªç„¶é€€å‡ºï¼Œè€Œä¸æ˜¯å¼ºåˆ¶æŒ‚èµ·ç­‰å¾…ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªç›‘è§†å™¨æ¥ç›‘è§† &#39;example.txt&#39; æ–‡ä»¶çš„å˜åŒ–</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> watcher</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> filename</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶ </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filename</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> å‘ç”Ÿäº†å˜åŒ–ç±»å‹ï¼š</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">eventType</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // ä¸€æ—¦æˆ‘ä»¬å®Œæˆäº†éœ€è¦çš„æ“ä½œï¼Œæˆ‘ä»¬å¯èƒ½ä¸å¸Œæœ›è¿™ä¸ªç›‘è§†å™¨é˜»æ­¢ç¨‹åºé€€å‡º</span></span>
<span class="line"><span style="color:#D8DEE9;">  watcher</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åœæ­¢ç›‘è§†æ–‡ä»¶å˜åŒ–</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨ unref() è®©è¿™ä¸ªç›‘è§†å™¨ä¸ä¼šé˜»æ­¢Node.jsè¿›ç¨‹é€€å‡º</span></span>
<span class="line"><span style="color:#D8DEE9;">watcher</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unref</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå³ä¾¿æˆ‘ä»¬è®¾ç½®äº†æ–‡ä»¶ç›‘è§†å™¨ï¼Œç”±äºæˆ‘ä»¬è°ƒç”¨äº†<code>watcher.unref()</code>ï¼ŒNode.js è¿›ç¨‹å¯ä»¥åœ¨æ²¡æœ‰å…¶ä»–æ´»è·ƒ handles çš„æƒ…å†µä¸‹æ­£å¸¸ç»“æŸï¼Œè€Œä¸æ˜¯å› ä¸ºæ–‡ä»¶ç›‘è§†å™¨çš„å­˜åœ¨è€ŒæŒç»­è¿è¡Œã€‚</p><p>å¸Œæœ›è¿™å¸®åŠ©ä½ ç†è§£äº†<code>watcher.unref()</code>çš„ä½œç”¨ä»¥åŠå®ƒåœ¨å®é™…åº”ç”¨ä¸­çš„ç”¨é€”ã€‚</p><h3 id="class-fs-readstream" tabindex="-1"><a class="header-anchor" href="#class-fs-readstream"><span><a href="https://nodejs.org/docs/latest/api/fs.html#class-fsreadstream" target="_blank" rel="noopener noreferrer">Class: fs.ReadStream</a></span></a></h3><p>å½“æˆ‘ä»¬æåˆ° Node.js ä¸­çš„<code>fs.ReadStream</code>ï¼Œæˆ‘ä»¬å®é™…ä¸Šåœ¨è®¨è®ºçš„æ˜¯ä¸€ä¸ªç”¨äºä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®çš„å·¥å…·ã€‚<code>fs</code>ä»£è¡¨æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰ï¼Œè¿™æ˜¯ Node.js å†…ç½®çš„ä¸€ä¸ªåº“ï¼Œç”¨äºå¤„ç†æ–‡ä»¶å’Œç›®å½•ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯fs-readstream" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯fs-readstream"><span>ä»€ä¹ˆæ˜¯<code>fs.ReadStream</code>?</span></a></h3><p>ç®€å•æ¥è¯´ï¼Œ<code>fs.ReadStream</code>æ˜¯ä¸€ä¸ªè¡¨ç¤ºå¯¹æ–‡ä»¶è¿›è¡Œè¯»å–æ“ä½œçš„æµã€‚åœ¨ Node.js ä¸­ï¼Œæµï¼ˆStreamsï¼‰æ˜¯å¤„ç†æ•°æ®çš„ä¸€ç§æ–¹å¼ï¼Œå°¤å…¶æ˜¯å½“ä½ å¤„ç†å¤§é‡æ•°æ®æ—¶ï¼Œæ¯”å¦‚è¯»å–ä¸€ä¸ªå¤§æ–‡ä»¶ã€‚ä½¿ç”¨æµå¯ä»¥é€å—åœ°è¯»å–æ•°æ®ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§å°†æ•´ä¸ªæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ã€‚è¿™æ ·åšçš„å¥½å¤„åœ¨äºå®ƒæé«˜äº†ç¨‹åºçš„æ•ˆç‡å’Œæ€§èƒ½ã€‚</p><h3 id="å¦‚ä½•åˆ›å»ºä¸€ä¸ªfs-readstream" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•åˆ›å»ºä¸€ä¸ªfs-readstream"><span>å¦‚ä½•åˆ›å»ºä¸€ä¸ª<code>fs.ReadStream</code>?</span></a></h3><p>è¦åˆ›å»ºä¸€ä¸ª<code>fs.ReadStream</code>ï¼Œä½ é€šå¸¸ä¼šä½¿ç”¨<code>fs.createReadStream(path[, options])</code>æ–¹æ³•ï¼Œå…¶ä¸­<code>path</code>æ˜¯ä½ æƒ³è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ï¼Œè€Œ<code>options</code>æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°å¯¹è±¡ï¼Œç”¨äºå®šåˆ¶æµçš„è¡Œä¸ºï¼Œä¾‹å¦‚æŒ‡å®šæ–‡ä»¶çš„ç¼–ç ç±»å‹æˆ–è€…è¯»å–çš„èµ·æ­¢ä½ç½®ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-29" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-29"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="ä¾‹å­-1-è¯»å–æ–‡æœ¬æ–‡ä»¶-1" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-è¯»å–æ–‡æœ¬æ–‡ä»¶-1"><span>ä¾‹å­ 1ï¼šè¯»å–æ–‡æœ¬æ–‡ä»¶</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º<code>example.txt</code>çš„æ–‡ä»¶ï¼Œé‡Œé¢åŒ…å«äº†ä¸€äº›æ–‡æœ¬ä¿¡æ¯ï¼Œä½ æƒ³è¦åœ¨ Node.js åº”ç”¨ä¸­è¯»å–è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªå¯è¯»æµ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> readStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf-8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">data</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–æ•°æ®å—:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> chunk</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">end</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶è¯»å–å®Œæˆã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">error</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–æ–‡ä»¶å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº†<code>fs</code>æ¨¡å—ã€‚ç„¶åï¼Œæˆ‘ä»¬è°ƒç”¨<code>fs.createReadStream()</code>æ–¹æ³•å¹¶ä¼ å…¥æ–‡ä»¶è·¯å¾„å’Œå­—ç¬¦ç¼–ç ï¼ˆè¿™é‡Œæ˜¯ UTF-8ï¼‰æ¥åˆ›å»ºä¸€ä¸ª<code>ReadStream</code>å®ä¾‹ã€‚æ¥ç€ï¼Œæˆ‘ä»¬ç›‘å¬å‡ ä¸ªäº‹ä»¶ï¼š</p><ul><li><code>&#39;data&#39;</code>äº‹ä»¶ï¼Œæ¯å½“ä»æ–‡ä»¶ä¸­è¯»å–åˆ°æ•°æ®å—ï¼ˆchunkï¼‰æ—¶è§¦å‘ï¼Œæˆ‘ä»¬å°±æ‰“å°å‡ºè¿™äº›æ•°æ®ã€‚</li><li><code>&#39;end&#39;</code>äº‹ä»¶ï¼Œå½“æ–‡ä»¶ä¸­æ‰€æœ‰æ•°æ®éƒ½å·²è¯»å–å®Œæ¯•æ—¶è§¦å‘ï¼Œè¡¨ç¤ºæ•°æ®è¯»å–ç»“æŸã€‚</li><li><code>&#39;error&#39;</code>äº‹ä»¶ï¼Œå¦‚æœåœ¨è¯»å–æ–‡ä»¶è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œåˆ™è§¦å‘æ­¤äº‹ä»¶ã€‚</li></ul><h4 id="ä¾‹å­-2-å¤åˆ¶æ–‡ä»¶-1" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-å¤åˆ¶æ–‡ä»¶-1"><span>ä¾‹å­ 2ï¼šå¤åˆ¶æ–‡ä»¶</span></a></h4><p>å‡è®¾ä½ ç°åœ¨å¸Œæœ›å°†ä¸€ä¸ªå¤§å‹æ–‡ä»¶ä»ä¸€ä¸ªä½ç½®å¤åˆ¶åˆ°å¦ä¸€ä¸ªä½ç½®ã€‚ä½ å¯ä»¥é€šè¿‡è¯»å–æºæ–‡ä»¶å†…å®¹å¹¶å°†å…¶å†™å…¥ç›®æ ‡æ–‡ä»¶æ¥å®ç°ï¼Œè€Œä¸”å¯ä»¥è¾¹è¯»è¾¹å†™ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> readStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./source.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> writeStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./destination.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">pipe</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">writeStream</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">finish</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å¤åˆ¶å®Œæˆã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>.pipe()</code>æ–¹æ³•å°†è¯»å–æµï¼ˆ<code>readStream</code>ï¼‰å’Œå†™å…¥æµï¼ˆ<code>writeStream</code>ï¼‰è¿æ¥èµ·æ¥ã€‚è¿™æ„å‘³ç€ä»æºæ–‡ä»¶è¯»å–çš„ä»»ä½•æ•°æ®éƒ½ä¼šè‡ªåŠ¨å†™å…¥ç›®æ ‡æ–‡ä»¶ã€‚ä¸€æ—¦æ‰€æœ‰æ•°æ®éƒ½è¢«å¤åˆ¶ï¼Œ<code>&#39;finish&#39;</code>äº‹ä»¶å°†è¢«è§¦å‘ï¼Œæˆ‘ä»¬ä¾¿çŸ¥é“å¤åˆ¶ä»»åŠ¡å®Œæˆäº†ã€‚</p><h3 id="ç»“è®º-6" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-6"><span>ç»“è®º</span></a></h3><p>é€šè¿‡ä½¿ç”¨<code>fs.ReadStream</code>ï¼ŒNode.js è®©æ–‡ä»¶è¯»å–å˜å¾—é«˜æ•ˆè€Œç®€å•ã€‚æ— è®ºæ˜¯è¯»å–æ–‡ä»¶å†…å®¹è¿˜æ˜¯æ‰§è¡Œè¯¸å¦‚æ–‡ä»¶å¤åˆ¶ä¹‹ç±»çš„ä»»åŠ¡ï¼Œåˆ©ç”¨æµçš„æ¦‚å¿µéƒ½å¯ä»¥ä½¿å¾—å¤„ç†å¤§å‹æ–‡ä»¶æˆä¸ºå¯èƒ½ï¼ŒåŒæ—¶ä¸ä¼šå¯¹ç³»ç»Ÿèµ„æºé€ æˆå¤ªå¤§å‹åŠ›ã€‚</p><h4 id="event-close-2" tabindex="-1"><a class="header-anchor" href="#event-close-2"><span><a href="https://nodejs.org/docs/latest/api/fs.html#event-close_2" target="_blank" rel="noopener noreferrer">Event: &#39;close&#39;</a></span></a></h4><p>Node.js ä¸­çš„ &#39;close&#39; äº‹ä»¶æ˜¯ä¸æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>æ¨¡å—ï¼‰æ“ä½œç›¸å…³çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µã€‚è¿™ä¸ªäº‹ä»¶è¢«è§¦å‘æ—¶ï¼Œè¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶å·²ç»è¢«å…³é—­äº†ã€‚åœ¨ Node.js v21.7.1 æ–‡æ¡£ä¸­æåˆ°çš„ &#39;close&#39; äº‹ä»¶ï¼Œä¸»è¦ç”¨åœ¨ <code>fs.createReadStream()</code> æˆ– <code>fs.createWriteStream()</code> è¿™æ ·çš„æµï¼ˆstreamï¼‰æ“ä½œä¸­ã€‚</p><h3 id="æµ-streams-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#æµ-streams-ç®€ä»‹"><span>æµï¼ˆStreamsï¼‰ç®€ä»‹</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œæµæ˜¯å¤„ç†æ•°æ®çš„ä¸€ç§æ–¹å¼ï¼Œå°¤å…¶æ˜¯å½“æ•°æ®é‡å¾ˆå¤§æˆ–è€…æ•°æ®æ˜¯ä»å¤–éƒ¨æ¥æºé€æ­¥æ¥æ”¶æ—¶ã€‚æœ‰å››ç§åŸºæœ¬çš„æµç±»å‹ï¼š</p><ul><li><strong>å¯è¯»æµï¼ˆReadable streamsï¼‰</strong>ï¼šä¾‹å¦‚ä»æ–‡ä»¶è¯»å–æ•°æ®ã€‚</li><li><strong>å¯å†™æµï¼ˆWritable streamsï¼‰</strong>ï¼šä¾‹å¦‚å‘æ–‡ä»¶å†™å…¥æ•°æ®ã€‚</li><li><strong>åŒå‘æµï¼ˆDuplex streamsï¼‰</strong>ï¼šæ—¢å¯ä»¥è¯»ä¹Ÿå¯ä»¥å†™ï¼Œä¾‹å¦‚ç½‘ç»œå¥—æ¥å­—ï¼ˆsocketsï¼‰ã€‚</li><li><strong>è½¬æ¢æµï¼ˆTransform streamsï¼‰</strong>ï¼šå¯ä»¥ä¿®æ”¹æˆ–è½¬æ¢æ•°æ®ï¼ŒåŒæ—¶å®ƒæ—¢æ˜¯å¯è¯»çš„ä¹Ÿæ˜¯å¯å†™çš„ã€‚</li></ul><h3 id="event-close-3" tabindex="-1"><a class="header-anchor" href="#event-close-3"><span>Event: &#39;close&#39;</span></a></h3><p>å½“ä½ é€šè¿‡ <code>fs.createReadStream()</code> æˆ– <code>fs.createWriteStream()</code> åˆ›å»ºä¸€ä¸ªæµæ“ä½œæ–‡ä»¶æ—¶ï¼Œä¸€æ—¦æ–‡ä»¶æ“ä½œå®Œæˆå¹¶ä¸”æ–‡ä»¶è¢«å…³é—­ï¼Œå°±ä¼šè§¦å‘ &#39;close&#39; äº‹ä»¶ã€‚ç›‘å¬è¿™ä¸ªäº‹ä»¶å¯ä»¥è®©ä½ çŸ¥é“ä½•æ—¶æ–‡ä»¶å¤„ç†å®Œæˆï¼Œä»¥åŠä½•æ—¶èµ„æºå·²é‡Šæ”¾ï¼Œå¹¶å¯ä»¥è¿›è¡Œåç»­æ“ä½œã€‚</p><h3 id="å®é™…ä¾‹å­-12" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-12"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œä½ æƒ³è¦è¯»å–è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œå¤„ç†å®Œä¹‹åç¡®ä¿æ–‡ä»¶è¢«æ­£ç¡®å…³é—­ã€‚</p><h4 id="ç¤ºä¾‹-1-ä½¿ç”¨-fs-createreadstream" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ä½¿ç”¨-fs-createreadstream"><span>ç¤ºä¾‹ 1ï¼šä½¿ç”¨ <code>fs.createReadStream()</code></span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æŒ‡å®šè¦è¯»å–çš„æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">__dirname</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">example.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªå¯è¯»æµ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> readStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">data</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Received </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">length</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> bytes of data.</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å½“è¯»å–å®Œæˆï¼Œæ–‡ä»¶å…³é—­æ—¶è§¦å‘ &#39;close&#39; äº‹ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">close</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File has been closed.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå¯è¯»æµæ¥è¯»å– &#39;example.log&#39; æ–‡ä»¶ã€‚æ¯æ¬¡æ¥æ”¶åˆ°æ•°æ®ï¼ˆ&#39;data&#39; äº‹ä»¶ï¼‰æ—¶ï¼Œæˆ‘ä»¬æ‰“å°æ¥æ”¶åˆ°çš„æ•°æ®å¤§å°ã€‚å½“æ–‡ä»¶è¯»å–å®Œæˆå¹¶å…³é—­æ—¶ï¼Œ&#39;close&#39; äº‹ä»¶è¢«è§¦å‘ï¼Œæˆ‘ä»¬æ‰“å°ä¸€æ¡æ¶ˆæ¯æŒ‡å‡ºæ–‡ä»¶å·²è¢«å…³é—­ã€‚</p><h4 id="ç¤ºä¾‹-2-ä½¿ç”¨-fs-createwritestream" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨-fs-createwritestream"><span>ç¤ºä¾‹ 2ï¼šä½¿ç”¨ <code>fs.createWriteStream()</code></span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æŒ‡å®šè¦å†™å…¥çš„æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">__dirname</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">output.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªå¯å†™æµ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> writeStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello, World!</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">UTF8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Another line!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">UTF8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ ‡è®°æ–‡ä»¶æœ«å°¾</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ–‡ä»¶è¢«å…³é—­æ—¶è§¦å‘ &#39;close&#39; äº‹ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">close</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File has been written and closed.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå¯å†™æµå°†æ•°æ®å†™å…¥ &#39;output.log&#39; æ–‡ä»¶ã€‚é€šè¿‡è°ƒç”¨ <code>writeStream.write()</code> æ–¹æ³•å†™å…¥æ•°æ®ï¼Œç„¶åé€šè¿‡ <code>writeStream.end()</code> æ–¹æ³•æ¥ç»“æŸå†™å…¥è¿‡ç¨‹å¹¶å…³é—­æ–‡ä»¶ã€‚ä¸€æ—¦æ–‡ä»¶å…³é—­ï¼Œå°±ä¼šè§¦å‘ &#39;close&#39; äº‹ä»¶ï¼Œæˆ‘ä»¬æ‰“å°ä¸€æ¡æ¶ˆæ¯æŒ‡å‡ºæ–‡ä»¶å·²è¢«æˆåŠŸå†™å…¥å’Œå…³é—­ã€‚</p><p>é€šè¿‡ç›‘å¬ &#39;close&#39; äº‹ä»¶ï¼Œä½ å¯ä»¥åœ¨æ–‡ä»¶æ“ä½œå®Œæˆåæ‰§è¡Œæ¸…ç†å·¥ä½œæˆ–è¿›ä¸€æ­¥çš„é€»è¾‘å¤„ç†ã€‚è¿™æ˜¯ç®¡ç†èµ„æºå’Œä¿æŒåº”ç”¨ç¨³å®šæ€§çš„å¥½æ–¹æ³•ã€‚</p><h4 id="event-open" tabindex="-1"><a class="header-anchor" href="#event-open"><span><a href="https://nodejs.org/docs/latest/api/fs.html#event-open" target="_blank" rel="noopener noreferrer">Event: &#39;open&#39;</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªè®© JavaScript è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¹³å°ï¼Œè€Œä¸ä»…ä»…æ˜¯åœ¨æµè§ˆå™¨ä¸­è¿è¡Œã€‚è¿™æ„å‘³ç€å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™èƒ½å¤Ÿå¤„ç†æ–‡ä»¶ã€æ•°æ®åº“äº¤äº’ã€ç½‘ç»œé€šä¿¡ç­‰æœåŠ¡ç«¯åŠŸèƒ½çš„è„šæœ¬å’Œåº”ç”¨ç¨‹åºã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æ˜¯ä¸€ä¸ªæä¾›äº†ä¸€ç³»åˆ—ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ APIã€‚è¿™åŒ…æ‹¬è¯»å–æ–‡ä»¶ã€å†™å…¥æ–‡ä»¶ã€æ›´æ”¹æ–‡ä»¶å±æ€§ç­‰ç­‰ã€‚<code>fs</code> æ¨¡å—æ”¯æŒå¼‚æ­¥ APIï¼ˆéé˜»å¡ï¼‰å’ŒåŒæ­¥ APIï¼ˆé˜»å¡ï¼‰ã€‚</p><h3 id="äº‹ä»¶-open" tabindex="-1"><a class="header-anchor" href="#äº‹ä»¶-open"><span>äº‹ä»¶: &#39;open&#39;</span></a></h3><p>å½“æˆ‘ä»¬è°ˆåˆ° <code>fs</code> æ¨¡å—ä¸­çš„ <code>Event: &#39;open&#39;</code> æ—¶ï¼ŒæŒ‡çš„æ˜¯ä¸€ä¸ªç‰¹å®šçš„äº‹ä»¶ï¼Œè¿™ä¸ªäº‹ä»¶åœ¨æ–‡ä»¶è¢«æ‰“å¼€æ—¶è§¦å‘ã€‚åœ¨ Node.js çš„ <code>fs</code> æ¨¡å—çš„æ–‡æ¡£ä¸­ï¼Œå¾ˆå¤šæ“ä½œéƒ½æ˜¯åŸºäºäº‹ä»¶çš„ã€‚å¯¹ <code>&#39;open&#39;</code> äº‹ä»¶çš„ç›‘å¬å…è®¸ä½ åœ¨æ–‡ä»¶è¢«å®é™…æ‰“å¼€åæ‰§è¡ŒæŸäº›æ“ä½œã€‚</p><p>ä¾‹å¦‚ï¼Œå‡è®¾ä½ æ­£åœ¨ä½¿ç”¨ <code>fs</code> æ¨¡å—çš„ <code>fs.open</code> æ–¹æ³•æ¥æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ã€‚å½“æ–‡ä»¶æˆåŠŸæ‰“å¼€æ—¶ï¼Œä¼šè§¦å‘ <code>&#39;open&#39;</code> äº‹ä»¶ã€‚ç„¶åï¼Œä½ å¯ä»¥ä¸ºè¿™ä¸ªäº‹ä»¶è®¾ç½®ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œä»¥ä¾¿åœ¨æ–‡ä»¶æ‰“å¼€åæ‰§è¡Œä¸€äº›æ“ä½œã€‚</p><h4 id="å®é™…è¿ç”¨ä¾‹å­-30" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-30"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h4><p>è€ƒè™‘ä»¥ä¸‹åœºæ™¯ï¼š</p><ol><li><strong>è®°å½•æ—¥å¿—</strong>: å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦è®°å½•ä¿¡æ¯åˆ°ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­ã€‚ä½¿ç”¨<code>&#39;open&#39;</code>äº‹ä»¶å¯ä»¥ç¡®ä¿åœ¨å¼€å§‹å†™å…¥ä¹‹å‰ï¼Œæ–‡ä»¶å·²ç»è¢«æ­£ç¡®æ‰“å¼€ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥åœ°æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™ï¼Œè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">mylog.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²æ‰“å¼€ï¼Œæ–‡ä»¶æè¿°ç¬¦ä¸º: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">fd</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>å®‰å…¨åœ°å¤„ç†æ–‡ä»¶</strong>: åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œæ‰“å¼€æ–‡ä»¶åè¿›è¡Œè¯»å†™ä¹‹å‰ï¼Œä½ å¯èƒ½æƒ³ç¡®è®¤æ–‡ä»¶ç¡®å®æ˜¯å‡†å¤‡å¥½äº†ã€‚ç›‘å¬<code>&#39;open&#39;</code>äº‹ä»¶å¯ä»¥ä½œä¸ºä¸€ä¸ªä¿¡å·ï¼Œå‘Šè¯‰ä½ ç°åœ¨æ–‡ä»¶å·²ç»å¤„äºå¯æ“ä½œçŠ¶æ€ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> fd</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fileDescriptor</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  fd</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fileDescriptor</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶æ‰“å¼€æˆåŠŸï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // åœ¨è¿™é‡Œå¯ä»¥æ‰§è¡Œä¸€äº›æ–‡ä»¶æ“ä½œï¼Œæ¯”å¦‚ fs.read æˆ– fs.write</span></span>
<span class="line"><span style="color:#616E88;">  // è®°å¾—æœ€åå…³é—­æ–‡ä»¶: fs.close(fd, (err) =&gt; { ... });</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼Œåœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ç›´æ¥ä½¿ç”¨è¿”å›çš„æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> å»è¯»æˆ–å†™æ•°æ®ï¼Œä½†å®é™…å¼€å‘ä¸­ï¼Œè¿™ä¸ª <code>fd</code> å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒä»£è¡¨äº†è¢«æ‰“å¼€æ–‡ä»¶çš„å¼•ç”¨ï¼Œåç»­çš„è¯»å†™æ“ä½œå°†éœ€è¦ç”¨åˆ°å®ƒã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>Event: &#39;open&#39;</code> åœ¨ Node.js ä¸­çš„ <code>fs</code> æ¨¡å—ä¸­æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„äº‹ä»¶ï¼Œå®ƒåœ¨æ–‡ä»¶è¢«æ‰“å¼€å¹¶ä¸”å‡†å¤‡å¥½è¿›è¡Œè¿›ä¸€æ­¥æ“ä½œï¼ˆå¦‚è¯»å–æˆ–å†™å…¥ï¼‰æ—¶è§¦å‘ã€‚é€šè¿‡ç›‘å¬è¿™ä¸ªäº‹ä»¶ï¼Œå¼€å‘è€…å¯ä»¥æ›´ç²¾ç¡®åœ°æ§åˆ¶å¯¹æ–‡ä»¶çš„æ“ä½œã€‚</p><h4 id="event-ready" tabindex="-1"><a class="header-anchor" href="#event-ready"><span><a href="https://nodejs.org/docs/latest/api/fs.html#event-ready" target="_blank" rel="noopener noreferrer">Event: &#39;ready&#39;</a></span></a></h4><p>Node.js ä¸­çš„<code>Event: &#39;ready&#39;</code>æ˜¯ä¸€ä¸ªäº‹ä»¶ï¼Œå®ƒå±äº<code>fs.watch</code>æ–¹æ³•çš„ä¸€éƒ¨åˆ†ï¼Œè¿™ä¸ªæ–¹æ³•ç”¨äºåœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ç›‘æ§æ–‡ä»¶æˆ–ç›®å½•çš„å˜åŒ–ã€‚å½“ä½ ä½¿ç”¨<code>fs.watch</code>æ¥ç›‘å¬ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•æ—¶ï¼Œ<code>&#39;ready&#39;</code>äº‹ä»¶ä¼šåœ¨ç›‘æ§æˆåŠŸå¼€å§‹åç«‹å³è¢«è§¦å‘ã€‚</p><h3 id="ç®€å•ç†è§£" tabindex="-1"><a class="header-anchor" href="#ç®€å•ç†è§£"><span>ç®€å•ç†è§£</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ªæ–‡ä»¶å¤¹ç”¨æ¥ä¿å­˜ä¸‹è½½çš„ç”µå½±ã€‚æ¯å½“æœ‰æ–°ç”µå½±ä¸‹è½½åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹é‡Œï¼Œä½ éƒ½å¸Œæœ›è‡ªåŠ¨å¾—åˆ°é€šçŸ¥ã€‚åœ¨ Node.js ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>fs.watch</code>åŠŸèƒ½æ¥åšåˆ°è¿™ç‚¹ã€‚è€Œ<code>&#39;ready&#39;</code>äº‹ä»¶å°±åƒæ˜¯ä¸€ä¸ªèµ·è·‘ä¿¡å·ï¼Œå‘Šè¯‰ä½ ï¼šâ€œå¥½äº†ï¼Œæˆ‘å¼€å§‹ç›‘æ§è¿™ä¸ªæ–‡ä»¶å¤¹äº†ï¼Œä»»ä½•å˜åŒ–æˆ‘éƒ½ä¼šé€šçŸ¥ä½ ã€‚â€</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-31" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-31"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="ä¾‹å­-1-ç›‘æ§æ–‡ä»¶å¤¹" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-ç›‘æ§æ–‡ä»¶å¤¹"><span>ä¾‹å­ 1ï¼šç›‘æ§æ–‡ä»¶å¤¹</span></a></h4><p>å‡è®¾æˆ‘ä»¬è¦ç›‘æ§åä¸º<code>downloads</code>çš„æ–‡ä»¶å¤¹ï¼Œçœ‹æ˜¯å¦æœ‰æ–°æ–‡ä»¶åŠ å…¥ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘æ§&#39;downloads&#39;æ–‡ä»¶å¤¹</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> watcher</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">downloads</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> filename</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">å‘ç”Ÿäº†å˜åŒ–ç±»å‹: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">eventType</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">filename</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">å˜åŒ–çš„æ–‡ä»¶å: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filename</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶åæœªæä¾›</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">watcher</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ready</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å¼€å§‹ç›‘æ§æ–‡ä»¶å¤¹ã€‚ä»»ä½•æ–‡ä»¶å˜åŒ–éƒ½ä¼šè¢«è®°å½•ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ul><li>æˆ‘ä»¬é€šè¿‡<code>fs.watch</code>å‡½æ•°å¼€å§‹ç›‘æ§åä¸º<code>downloads</code>çš„æ–‡ä»¶å¤¹ã€‚</li><li>å½“<code>fs.watch</code>å¼€å§‹å…¶å·¥ä½œå¹¶å‡†å¤‡å¥½é€šçŸ¥æˆ‘ä»¬ä»»ä½•å˜åŒ–æ—¶ï¼Œ<code>&#39;ready&#39;</code>äº‹ä»¶è¢«è§¦å‘ï¼Œç„¶åæ‰§è¡Œæˆ‘ä»¬å®šä¹‰çš„å›è°ƒå‡½æ•°ï¼Œæ‰“å°å‡ºâ€œå¼€å§‹ç›‘æ§æ–‡ä»¶å¤¹ã€‚ä»»ä½•æ–‡ä»¶å˜åŒ–éƒ½ä¼šè¢«è®°å½•ã€‚â€ã€‚</li><li>å¦‚æœæ–‡ä»¶å¤¹å†…çš„æ–‡ä»¶å‘ç”Ÿäº†å˜åŒ–ï¼ˆæ¯”å¦‚æœ‰æ–‡ä»¶è¢«æ·»åŠ ã€ä¿®æ”¹æˆ–åˆ é™¤ï¼‰ï¼Œæˆ‘ä»¬åŒæ ·ä¼šæ”¶åˆ°é€šçŸ¥ï¼Œå¹¶æ‰“å°å‡ºå…·ä½“çš„å˜åŒ–ç±»å‹å’Œå˜åŒ–çš„æ–‡ä»¶åã€‚</li></ul><h4 id="ä¾‹å­-2-åé¦ˆç›‘æ§çŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-åé¦ˆç›‘æ§çŠ¶æ€"><span>ä¾‹å­ 2ï¼šåé¦ˆç›‘æ§çŠ¶æ€</span></a></h4><p>ä½ å¯èƒ½è¿˜æƒ³çŸ¥é“ç›‘æ§æ˜¯å¦æˆåŠŸå¯åŠ¨ï¼Œç‰¹åˆ«æ˜¯å¤„ç†å¤§é‡æ–‡ä»¶æˆ–ç½‘ç»œé©±åŠ¨å™¨æ—¶ã€‚<code>&#39;ready&#39;</code>äº‹ä»¶è®©ä½ æœ‰æœºä¼šåœ¨ç›‘æ§å®é™…å¼€å§‹ä¹‹å‰ç¡®è®¤ä¸€åˆ‡è®¾ç½®æ­£å¸¸ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å°è¯•ç›‘æ§å¯èƒ½ä¸å­˜åœ¨çš„ç›®å½•</span></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> watcher</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watch</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#A3BE8C;">some/nonexistent/directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> filename</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">      // å¤„ç†å˜åŒ–...</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  )</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  watcher</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ready</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›‘æ§æˆåŠŸå¯åŠ¨ï¼Œå¼€å§‹ç­‰å¾…æ–‡ä»¶å˜åŒ–...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  watcher</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">error</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç›‘æ§å¯åŠ¨å¤±è´¥:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å°è¯•ç›‘æ§æ—¶å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¢åŠ äº†é”™è¯¯å¤„ç†é€»è¾‘ã€‚é€šè¿‡ç›‘å¬<code>error</code>äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£åˆ°å¦‚æœå› ä¸ºæŸäº›åŸå› ï¼ˆä¾‹å¦‚è¢«ç›‘æ§çš„ç›®å½•ä¸å­˜åœ¨ï¼‰ç›‘æ§å¯åŠ¨å¤±è´¥ï¼Œä»è€Œé‡‡å–ç›¸åº”çš„æªæ–½ã€‚</p><h3 id="æ€»ç»“-19" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-19"><span>æ€»ç»“</span></a></h3><p><code>&#39;ready&#39;</code>äº‹ä»¶åœ¨ Node.js çš„æ–‡ä»¶ç³»ç»Ÿç›‘æ§ä¸­èµ·ç€é‡è¦çš„ä½œç”¨ï¼Œå®ƒè®©å¼€å‘è€…çŸ¥é“ç›‘æ§å·²ç»æˆåŠŸå¯åŠ¨å¹¶ä¸”å‡†å¤‡å¥½äº†ã€‚é€šè¿‡è¿™ä¸ªäº‹ä»¶ï¼Œä½ å¯ä»¥æ›´å®‰å…¨ã€æ›´æœ‰æ•ˆåœ°ç®¡ç†ä½ çš„æ–‡ä»¶ç³»ç»Ÿç›‘æ§ä»»åŠ¡ã€‚</p><h4 id="readstream-bytesread" tabindex="-1"><a class="header-anchor" href="#readstream-bytesread"><span><a href="https://nodejs.org/docs/latest/api/fs.html#readstreambytesread" target="_blank" rel="noopener noreferrer">readStream.bytesRead</a></span></a></h4><p>å½“æˆ‘ä»¬è°ˆè®º Node.js ä¸­çš„<code>readStream.bytesRead</code>å±æ€§æ—¶ï¼Œæˆ‘ä»¬æŒ‡çš„æ˜¯åœ¨ä½¿ç”¨æµï¼ˆstreamï¼‰è¯»å–æ•°æ®æ—¶ï¼Œå·²ç»æˆåŠŸä»æµä¸­è¯»å–çš„å­—èŠ‚æ•°ã€‚è¿™ä¸ªå±æ€§éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå¯ä»¥å¸®åŠ©ä½ äº†è§£åˆ°ç›®å‰ä¸ºæ­¢å·²ç»å¤„ç†äº†å¤šå°‘æ•°æ®ï¼Œè¿™å¯¹äºå¤„ç†å¤§é‡æ•°æ®æˆ–éœ€è¦ç›‘æ§æ•°æ®ä¼ è¾“è¿›åº¦çš„æƒ…å†µå°¤å…¶é‡è¦ã€‚</p><p>è®©æˆ‘é€šè¿‡å‡ ä¸ªå®ä¾‹æ¥å…·ä½“è¯´æ˜<code>readStream.bytesRead</code>çš„åº”ç”¨ï¼š</p><h3 id="å®ä¾‹-1-è¯»å–æ–‡ä»¶å†…å®¹" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-1-è¯»å–æ–‡ä»¶å†…å®¹"><span>å®ä¾‹ 1ï¼šè¯»å–æ–‡ä»¶å†…å®¹</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªæ–‡ä»¶<code>example.txt</code>ï¼Œé‡Œé¢åŒ…å«ä¸€äº›æ–‡æœ¬ä¿¡æ¯ï¼Œä½ æƒ³é€šè¿‡ Node.js ç¨‹åºè¯»å–è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚ä½¿ç”¨<code>fs.createReadStream</code>æ–¹æ³•åˆ›å»ºä¸€ä¸ªè¯»å–æµï¼ˆread streamï¼‰ï¼Œç„¶åä½¿ç”¨<code>.bytesRead</code>æ¥æ£€æŸ¥å·²ç»è¯»å–çš„æ•°æ®é‡ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªè¯»å–æµ</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> readStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ•°æ®å¼€å§‹è¢«è¯»å–æ—¶è§¦å‘</span></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">data</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Received </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">length</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> bytes of data.</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ–‡ä»¶è¢«å…¨éƒ¨è¯»å–å®Œæ¯•æ—¶è§¦å‘</span></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">end</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Total bytes read: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">bytesRead</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªç¤ºä¾‹é¦–å…ˆåˆ›å»ºä¸€ä¸ªæŒ‡å‘<code>example.txt</code>çš„è¯»å–æµã€‚æ¯æ¬¡ä»æ–‡ä»¶ä¸­è¯»å–ä¸€å—æ•°æ®ï¼ˆ<code>chunk</code>ï¼‰æ—¶ï¼Œéƒ½ä¼šè§¦å‘<code>data</code>äº‹ä»¶ï¼Œå¹¶æ‰“å°å‡ºè¯¥æ•°æ®å—çš„å¤§å°ã€‚å½“æ²¡æœ‰æ›´å¤šæ•°æ®å¯è¯»æ—¶ï¼Œè§¦å‘<code>end</code>äº‹ä»¶ï¼Œæ­¤æ—¶<code>.bytesRead</code>å±æ€§ä¼šå‘Šè¯‰æˆ‘ä»¬æ€»å…±è¯»å–äº†å¤šå°‘å­—èŠ‚çš„æ•°æ®ã€‚</p><h3 id="å®ä¾‹-2-ç›‘æ§ä¸‹è½½è¿›åº¦" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-2-ç›‘æ§ä¸‹è½½è¿›åº¦"><span>å®ä¾‹ 2ï¼šç›‘æ§ä¸‹è½½è¿›åº¦</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨ä½¿ç”¨ Node.js ç¼–å†™ä¸€ä¸ªä»äº’è”ç½‘ä¸Šä¸‹è½½å¤§æ–‡ä»¶çš„ç¨‹åºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œäº†è§£ä¸‹è½½è¿›åº¦éå¸¸é‡è¦ã€‚</p><p>è™½ç„¶åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½ä¼šç”¨åˆ°ä¸€äº›ä¸“é—¨é’ˆå¯¹ HTTP è¯·æ±‚çš„åº“ï¼ˆä¾‹å¦‚<code>axios</code>æˆ–<code>request</code>ï¼‰ï¼Œä½†ä¸ºäº†ç®€å•æ¼”ç¤ºå¦‚ä½•åˆ©ç”¨<code>.bytesRead</code>ï¼Œè¿™é‡Œæˆ‘ä»¬ä»æ—§ä»¥è¯»å–æœ¬åœ°æ–‡ä»¶ä¸ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾è¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> readStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">veryLargeFile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> previousBytesRead</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">setInterval</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">bytesRead</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">    `</span><span style="color:#81A1C1;">${</span></span>
<span class="line"><span style="color:#D8DEE9;">      bytesRead</span><span style="color:#81A1C1;"> -</span><span style="color:#D8DEE9;"> previousBytesRead</span></span>
<span class="line"><span style="color:#81A1C1;">    }</span><span style="color:#A3BE8C;"> bytes read in the last second. Total bytes read: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">bytesRead</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  )</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  previousBytesRead</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 1000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ¯éš”ä¸€ç§’é’Ÿæ£€æŸ¥ä¸€æ¬¡<code>readStream.bytesRead</code>çš„å€¼ï¼Œé€šè¿‡ä¸å‰ä¸€ç§’çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œè®¡ç®—å‡ºåœ¨è¿‡å»ä¸€ç§’å†…è¯»å–äº†å¤šå°‘å­—èŠ‚çš„æ•°æ®ã€‚è¿™å¯ä»¥ç»™ç”¨æˆ·æä¾›ç±»ä¼¼äºä¸‹è½½é€Ÿåº¦çš„ä¿¡æ¯ï¼Œå³ä½¿åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­æˆ‘ä»¬æ˜¯åœ¨è¯»å–æœ¬åœ°æ–‡ä»¶ã€‚</p><p>é€šè¿‡è¿™ä¸¤ä¸ªå®ä¾‹ï¼Œä½ åº”è¯¥èƒ½å¤Ÿç†è§£<code>readStream.bytesRead</code>åœ¨ Node.js åº”ç”¨ä¸­çš„ä½œç”¨å’Œé‡è¦æ€§äº†ã€‚æ— è®ºæ˜¯å¤„ç†æœ¬åœ°æ–‡ä»¶è¿˜æ˜¯å¤„ç†ç½‘ç»œèµ„æºï¼Œäº†è§£å·²å¤„ç†çš„æ•°æ®é‡éƒ½æ˜¯éå¸¸æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚</p><h4 id="readstream-path" tabindex="-1"><a class="header-anchor" href="#readstream-path"><span><a href="https://nodejs.org/docs/latest/api/fs.html#readstreampath" target="_blank" rel="noopener noreferrer">readStream.path</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªå¼€æºä¸è·¨å¹³å°çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚<code>readStream.path</code> æ˜¯ Node.js ä¸­æ–‡ä»¶ç³»ç»Ÿ (<code>fs</code>) æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œè¿™ä¸ªå±æ€§ç”¨äºè·å–åˆ›å»º <code>fs.ReadStream</code> å¯¹è±¡æ—¶æŒ‡å®šçš„æ–‡ä»¶è·¯å¾„ã€‚<code>fs.ReadStream</code> å¯¹è±¡é€šå¸¸ç”¨äºè¯»å–æ–‡ä»¶å†…å®¹ã€‚</p><h3 id="è§£é‡Š-readstream-path" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-readstream-path"><span>è§£é‡Š <code>readStream.path</code></span></a></h3><p>å½“ä½ ä½¿ç”¨ <code>fs.createReadStream()</code> æ–¹æ³•åˆ›å»ºä¸€ä¸ªè¯»å–æµï¼ˆ<code>ReadStream</code>ï¼‰æ¥è¯»å–æ–‡ä»¶æ—¶ï¼Œ<code>readStream.path</code> å±æ€§å°±ä¼šä¿å­˜ä½ æ‰€æŒ‡å®šè¦è¯»å–æ–‡ä»¶çš„è·¯å¾„ã€‚è¿™ä¸ªå±æ€§å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€… <code>Buffer</code>ï¼ˆå¦‚æœåœ¨åˆ›å»ºæµæ—¶ä½¿ç”¨äº† <code>Buffer</code> æ¥æŒ‡å®šè·¯å¾„ï¼‰ï¼Œè¡¨ç¤ºæ–‡ä»¶çš„è·¯å¾„ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-32" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-32"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨æ„å»ºä¸€ä¸ª Node.js åº”ç”¨ï¼Œéœ€è¦è¯»å–å¹¶å¤„ç†ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼ˆæ¯”å¦‚é…ç½®æ–‡ä»¶ã€æ—¥å¿—ç­‰ï¼‰ã€‚ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨ <code>fs.createReadStream()</code> å’Œ <code>readStream.path</code> çš„å…·ä½“æ­¥éª¤ï¼š</p><h4 id="ä¾‹å­-1-è¯»å–æ–‡æœ¬æ–‡ä»¶å¹¶è¾“å‡ºæ–‡ä»¶è·¯å¾„" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-è¯»å–æ–‡æœ¬æ–‡ä»¶å¹¶è¾“å‡ºæ–‡ä»¶è·¯å¾„"><span>ä¾‹å­ 1: è¯»å–æ–‡æœ¬æ–‡ä»¶å¹¶è¾“å‡ºæ–‡ä»¶è·¯å¾„</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªè¯»å–æµæ¥è¯»å– &#39;example.txt&#39; æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> readStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘å¬ &#39;open&#39; äº‹ä»¶ä»¥ç¡®ä¿æ–‡ä»¶å·²ç»æ‰“å¼€ï¼Œå¹¶è¾“å‡ºæ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">open</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> function</span><span style="color:#ECEFF4;"> ()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²æ‰“å¼€ï¼Œæ–‡ä»¶è·¯å¾„ä¸º:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç”¨äºæ•è·å’Œå¤„ç†æµä¸­å‘ç”Ÿçš„é”™è¯¯</span></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">error</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> function</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–æ–‡ä»¶è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡ <code>fs.createReadStream(&#39;example.txt&#39;)</code> åˆ›å»ºäº†ä¸€ä¸ªæŒ‡å‘ <code>&#39;example.txt&#39;</code> æ–‡ä»¶çš„è¯»å–æµã€‚ç„¶åï¼Œæˆ‘ä»¬ç›‘å¬äº† <code>&#39;open&#39;</code> äº‹ä»¶ï¼Œä¸€æ—¦æ–‡ä»¶æˆåŠŸæ‰“å¼€ï¼Œå°±ä¼šè§¦å‘è¯¥äº‹ä»¶ï¼Œå¹¶åœ¨æ§åˆ¶å°è¾“å‡ºæ–‡ä»¶è·¯å¾„ã€‚</p><h4 id="ä¾‹å­-2-ä½¿ç”¨å¼‚æ­¥å‡½æ•°è¯»å–å¹¶æ˜¾ç¤ºæ–‡ä»¶è·¯å¾„" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ä½¿ç”¨å¼‚æ­¥å‡½æ•°è¯»å–å¹¶æ˜¾ç¤ºæ–‡ä»¶è·¯å¾„"><span>ä¾‹å­ 2: ä½¿ç”¨å¼‚æ­¥å‡½æ•°è¯»å–å¹¶æ˜¾ç¤ºæ–‡ä»¶è·¯å¾„</span></a></h4><p>æœ‰æ—¶å€™ï¼Œä½ å¯èƒ½æ›´å€¾å‘äºä½¿ç”¨å¼‚æ­¥å‡½æ•°æ¥å¤„ç†æ–‡ä»¶è¯»å–ï¼Œä½¿ä»£ç æ›´ç®€æ´ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ³¨æ„è¿™é‡Œä½¿ç”¨çš„æ˜¯ .promises</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readFileAndLogPath</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> readStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">open</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²æ‰“å¼€ï¼Œæ–‡ä»¶è·¯å¾„ä¸º:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">error</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–æ–‡ä»¶è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨å‡½æ•°å¹¶ä¼ å…¥æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#88C0D0;">readFileAndLogPath</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° <code>readFileAndLogPath</code>ï¼Œå®ƒæ¥å—ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ä½œä¸ºå‚æ•°ï¼Œåˆ›å»ºä¸€ä¸ªè¯»å–æµï¼Œå¹¶ç›‘å¬ç›¸åº”çš„äº‹ä»¶ï¼ŒåŒ…æ‹¬æˆåŠŸæ‰“å¼€æ–‡ä»¶å’Œé‡åˆ°é”™è¯¯æ—¶çš„å¤„ç†ã€‚</p><h3 id="æ€»ç»“-20" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-20"><span>æ€»ç»“</span></a></h3><p><code>readStream.path</code> åœ¨ Node.js ä¸­æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„å±æ€§ï¼Œå®ƒèƒ½å¸®åŠ©ä½ ç¡®è®¤å½“å‰è¯»å–æµå¯¹åº”çš„æ–‡ä»¶è·¯å¾„ã€‚æ— è®ºæ˜¯è¿›è¡Œæ—¥å¿—è®°å½•ã€é”™è¯¯å¤„ç†ï¼Œè¿˜æ˜¯ä»…ä»…éœ€è¦ç¡®è®¤æ–‡ä»¶ä½ç½®ï¼Œäº†è§£å¦‚ä½•ä½¿ç”¨è¿™ä¸ªå±æ€§éƒ½æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚é€šè¿‡ä»¥ä¸Šçš„ä¾‹å­ï¼Œä½ åº”è¯¥èƒ½å¤Ÿå¼€å§‹åœ¨ä½ è‡ªå·±çš„é¡¹ç›®ä¸­åº”ç”¨è¿™ä¸ªåŠŸèƒ½äº†ã€‚</p><h4 id="readstream-pending" tabindex="-1"><a class="header-anchor" href="#readstream-pending"><span><a href="https://nodejs.org/docs/latest/api/fs.html#readstreampending" target="_blank" rel="noopener noreferrer">readStream.pending</a></span></a></h4><p>è¦ç†è§£ <code>readStream.pending</code> å±æ€§ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å¯¹ Node.js ä¸­çš„æµ(streams)æœ‰åŸºæœ¬çš„äº†è§£ã€‚åœ¨ Node.js ä¸­ï¼Œæµæ˜¯å¤„ç†è¯»å†™æ•°æ®çš„ä¸€ç§æ–¹å¼ï¼Œç‰¹åˆ«é€‚ç”¨äºå¤„ç†å¤§æ–‡ä»¶æˆ–è¿ç»­æ•°æ®ï¼Œæ¯”å¦‚ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®æˆ–å‘æ–‡ä»¶å†™å…¥æ•°æ®ã€‚æµå¯ä»¥å°†æ•°æ®åˆ†æˆå°å—è¿›è¡Œå¤„ç†ï¼Œè¿™æ ·å°±ä¸éœ€è¦ä¸€æ¬¡æ€§å°†æ•´ä¸ªæ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œä»è€Œæé«˜äº†ç¨‹åºçš„æ•ˆç‡å’Œæ€§èƒ½ã€‚</p><h3 id="readstream" tabindex="-1"><a class="header-anchor" href="#readstream"><span>readStream</span></a></h3><p><code>readStream</code> æ˜¯ Node.js æä¾›çš„ç”¨äºä»æ–‡ä»¶æˆ–å…¶ä»–èµ„æºè¯»å–æ•°æ®çš„æµã€‚åˆ›å»ºä¸€ä¸ª <code>readStream</code> åï¼Œå®ƒä¼šæŒ‰é¡ºåºè¯»å–æ•°æ®ï¼Œä½ å¯ä»¥é€å—å¤„ç†è¿™äº›æ•°æ®ï¼Œæˆ–è€…ç­‰å¾…æ‰€æœ‰æ•°æ®éƒ½è¯»å–å®Œæ¯•å†è¿›è¡Œå¤„ç†ã€‚</p><h3 id="readstream-pending-å±æ€§" tabindex="-1"><a class="header-anchor" href="#readstream-pending-å±æ€§"><span>readStream.pending å±æ€§</span></a></h3><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ <code>readStream.pending</code> è¿™ä¸ªå±æ€§ã€‚ç®€å•æ¥è¯´ï¼Œ<code>readStream.pending</code> æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼ˆBooleanï¼‰ï¼Œå®ƒè¡¨ç¤ºæµæ˜¯å¦å¤„äºç­‰å¾…çŠ¶æ€ã€‚å½“æµå°šæœªå®Œå…¨å°±ç»ªï¼Œä¾‹å¦‚è¿˜æ²¡æœ‰æˆåŠŸæ‰“å¼€æ–‡ä»¶æ—¶ï¼Œ<code>readStream.pending</code> çš„å€¼ä¸º <code>true</code>ã€‚ä¸€æ—¦æµå‡†å¤‡å°±ç»ªï¼Œå¼€å§‹è¯»å–æ•°æ®ï¼Œè¯¥å±æ€§å€¼å˜ä¸º <code>false</code>ã€‚</p><h4 id="å®é™…è¿ç”¨ä¾‹å­-33" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-33"><span>å®é™…è¿ç”¨ä¾‹å­ï¼š</span></a></h4><ol><li><strong>ç›‘æµ‹æµçš„å°±ç»ªçŠ¶æ€</strong>ï¼šå‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦ä»ä¸€ä¸ªå¤§æ–‡ä»¶ä¸­è¯»å–æ•°æ®ç„¶åå¤„ç†ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>readStream.pending</code> æ¥æ£€æŸ¥æµæ˜¯å¦å·²ç»å°±ç»ªï¼Œå¦‚æœè¿˜æ²¡å°±ç»ªï¼Œä½ å¯èƒ½éœ€è¦ç­‰å¾…æˆ–æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œç›´åˆ°è¯¥æµå‡†å¤‡å¥½è¯»å–æ•°æ®ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªè¯»å–æµ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> myReadStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./my-large-file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ£€æŸ¥æµæ˜¯å¦å°±ç»ª</span></span>
<span class="line"><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">myReadStream</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">pending</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Stream is still pending, waiting for it to be ready...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Stream is ready!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å½“æµå‡†å¤‡å°±ç»ªå¹¶å¼€å§‹è¯»å–æ•°æ®æ—¶</span></span>
<span class="line"><span style="color:#D8DEE9;">myReadStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">readable</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Stream is now ready and data can be read.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¤„ç†æ•°æ®</span></span>
<span class="line"><span style="color:#D8DEE9;">myReadStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">data</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Received </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">length</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> bytes of data.</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç»“æŸäº‹ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">myReadStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">end</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">No more data to read.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>ä¼˜åŒ–èµ„æºç®¡ç†</strong>ï¼šåœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œåˆç†ç®¡ç†èµ„æºéå¸¸é‡è¦ã€‚å¦‚æœä½ åˆ›å»ºäº†å¾ˆå¤šè¯»å–æµï¼Œä½†å…¶ä¸­ä¸€äº›å› ä¸ºæŸäº›åŸå› å»¶è¿Ÿæ‰“å¼€æ–‡ä»¶ï¼Œ<code>readStream.pending</code> å¯ä»¥å¸®åŠ©ä½ è¯†åˆ«è¿™äº›æµï¼Œè¿›è€Œå†³å®šæ˜¯å¦å…³é—­å®ƒä»¬æˆ–é‡‡å–å…¶ä»–æªæ–½ï¼Œé¿å…èµ„æºæµªè´¹ã€‚</li></ol><p>é€šè¿‡è¿™ä¸¤ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>readStream.pending</code> å±æ€§åœ¨å¤„ç†æµç›¸å…³ä»»åŠ¡æ—¶çš„å®é™…åº”ç”¨ä»·å€¼ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦ç²¾ç¡®æ§åˆ¶æµçŠ¶æ€å’Œç®¡ç†èµ„æºçš„åœºæ™¯ä¸‹ã€‚</p><h3 id="class-fs-stats" tabindex="-1"><a class="header-anchor" href="#class-fs-stats"><span><a href="https://nodejs.org/docs/latest/api/fs.html#class-fsstats" target="_blank" rel="noopener noreferrer">Class: fs.Stats</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥äº†è§£ä¸€ä¸‹ Node.js ä¸­çš„ <code>fs.Stats</code> ç±»ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æ˜¯ä¸€ä¸ªä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„æ¨¡å—ï¼Œå…è®¸ä½ åœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œæ–‡ä»¶çš„è¯»å†™æ“ä½œã€‚<code>fs.Stats</code> ç±»æ˜¯<code>fs</code>æ¨¡å—ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„éƒ¨åˆ†ï¼Œå®ƒæä¾›äº†å¦‚ä½•è·å–å’Œæ“ä½œæ–‡ä»¶ï¼ˆæˆ–ç›®å½•ï¼‰çš„ç»Ÿè®¡ä¿¡æ¯çš„æ–¹æ³•ã€‚</p><p>å½“ä½ ä½¿ç”¨ <code>fs.stat()</code>, <code>fs.lstat()</code> æˆ– <code>fs.fstat()</code> ç­‰å‡½æ•°æ—¶ï¼Œè¿™äº›å‡½æ•°ä¼šè¿”å› <code>fs.Stats</code> çš„ä¸€ä¸ªå®ä¾‹ã€‚è¿™ä¸ªå®ä¾‹å¯¹è±¡åŒ…å«äº†å¾ˆå¤šå±æ€§ï¼Œé€šè¿‡è¿™äº›å±æ€§ï¼Œä½ å¯ä»¥è·å–åˆ°å…³äºæ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ¯”å¦‚æ–‡ä»¶å¤§å°ã€åˆ›å»ºæ—¶é—´ã€ä¿®æ”¹æ—¶é—´ç­‰ã€‚</p><h3 id="ä¸»è¦å±æ€§" tabindex="-1"><a class="header-anchor" href="#ä¸»è¦å±æ€§"><span>ä¸»è¦å±æ€§</span></a></h3><p>ä»¥ä¸‹æ˜¯ä¸€äº› <code>fs.Stats</code> å¯¹è±¡ä¸­å¯ç”¨çš„ä¸»è¦å±æ€§ï¼š</p><ul><li><code>stats.isFile()</code>: åˆ¤æ–­è¢«æŸ¥çœ‹çš„æ˜¯å¦ä¸ºæ–‡ä»¶ã€‚</li><li><code>stats.isDirectory()</code>: åˆ¤æ–­è¢«æŸ¥çœ‹çš„æ˜¯å¦ä¸ºç›®å½•ã€‚</li><li><code>stats.isSymbolicLink()</code>: å¦‚æœä½ ä½¿ç”¨ <code>fs.lstat()</code> å¹¶ä¸”ç»“æœæ˜¯ç¬¦å·é“¾æ¥ï¼Œåˆ™æ­¤æ–¹æ³•è¿”å› trueã€‚</li><li><code>stats.size</code>: æ–‡ä»¶çš„å¤§å°ï¼ˆå•ä½ï¼šå­—èŠ‚ï¼‰ã€‚</li><li><code>stats.birthtime</code>: æ–‡ä»¶çš„åˆ›å»ºæ—¶é—´ã€‚</li><li><code>stats.mtime</code>: æ–‡ä»¶æœ€åä¸€æ¬¡è¢«ä¿®æ”¹çš„æ—¶é—´ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-25" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-25"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><ol><li><p><strong>æ£€æŸ¥æ–‡ä»¶è¿˜æ˜¯ç›®å½•</strong></p><p>å‡è®¾æˆ‘ä»¬æƒ³æ£€æŸ¥ä¸€ä¸ªç‰¹å®šè·¯å¾„æ˜¯æŒ‡å‘æ–‡ä»¶è¿˜æ˜¯ç›®å½•ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/something</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFile</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">It&#39;s a file.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#81A1C1;"> if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isDirectory</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">It&#39;s a directory.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>è·å–æ–‡ä»¶å¤§å°</strong></p><p>å¦‚æœæˆ‘ä»¬æƒ³è·å–æŸä¸ªæ–‡ä»¶çš„å¤§å°ï¼Œå¯ä»¥è¿™æ ·å®ç°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">File size: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">size</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> bytes</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>ç›‘æµ‹æ–‡ä»¶ä¿®æ”¹æ—¶é—´</strong></p><p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦çŸ¥é“æ–‡ä»¶æœ€åä¸€æ¬¡ä¿®æ”¹çš„æ—¶é—´ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Last modified time: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mtime</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>fs.Stats</code> ç±»åœ¨æ–‡ä»¶ç³»ç»Ÿæ“ä½œä¸­æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ï¼Œå®ƒä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§æ–¹ä¾¿çš„æ–¹å¼æ¥è·å–å’Œä½¿ç”¨æ–‡ä»¶åŠç›®å½•çš„è¯¦ç»†ä¿¡æ¯ã€‚æ— è®ºæ˜¯åœ¨æ„å»ºç®€å•çš„è„šæœ¬è¿˜æ˜¯å¤æ‚çš„åº”ç”¨ç¨‹åºæ—¶ï¼Œäº†è§£å¦‚ä½•æœ‰æ•ˆåœ°ä½¿ç”¨ <code>fs.Stats</code> éƒ½æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚</p><h4 id="stats-isblockdevice" tabindex="-1"><a class="header-anchor" href="#stats-isblockdevice"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsisblockdevice" target="_blank" rel="noopener noreferrer">stats.isBlockDevice()</a></span></a></h4><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥äº†è§£ä»€ä¹ˆæ˜¯ Node.js ä¸­çš„ <code>stats.isBlockDevice()</code> æ–¹æ³•ä»¥åŠå®ƒåœ¨å®é™…ä¸­çš„åº”ç”¨ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-stats-isblockdevice" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-stats-isblockdevice"><span>ä»€ä¹ˆæ˜¯ <code>stats.isBlockDevice()</code>?</span></a></h3><p>é¦–å…ˆï¼ŒNode.js æ˜¯ä¸€ä¸ªèƒ½å¤Ÿè®©ä½ ä½¿ç”¨ JavaScript ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç çš„å¹³å°ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ä¸ªå†…ç½®æ¨¡å—å«åš <code>fs</code>ï¼ˆä»£è¡¨æ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œå®ƒæä¾›äº†å¾ˆå¤šæ–¹æ³•æ¥ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’ã€‚<code>stats.isBlockDevice()</code> å°±æ˜¯ <code>fs</code> æ¨¡å—çš„ä¸€ä¸ªåŠŸèƒ½ã€‚</p><p>ç®€å•æ¥è¯´ï¼Œ<code>stats.isBlockDevice()</code> æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºæ£€æŸ¥ä¸€ä¸ªè·¯å¾„ï¼ˆå¯ä»¥æ˜¯æ–‡ä»¶æˆ–ç›®å½•ï¼‰æŒ‡å‘çš„è®¾å¤‡æ˜¯å¦æ˜¯ä¸€ä¸ªâ€œå—è®¾å¤‡â€ã€‚å—è®¾å¤‡ï¼ˆBlock Deviceï¼‰ï¼Œæ˜¯ä¸€ç§æ”¯æŒå­˜å–å›ºå®šå¤§å°æ•°æ®å—çš„ç¡¬ä»¶è®¾å¤‡ï¼Œä¾‹å¦‚ç¡¬ç›˜å’Œ USB é©±åŠ¨ç›˜ç­‰ã€‚</p><p>å½“ä½ è°ƒç”¨ <code>fs.stat()</code> æˆ–ç±»ä¼¼æ–¹æ³•æ—¶ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ª <code>stats</code> å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«äº†å…³äºæ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ã€‚é€šè¿‡è¿™ä¸ªå¯¹è±¡ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>isBlockDevice()</code> æ–¹æ³•æ¥åˆ¤æ–­ç›¸å…³è·¯å¾„æ˜¯å¦æŒ‡å‘ä¸€ä¸ªå—è®¾å¤‡ã€‚</p><h3 id="ç¤ºä¾‹è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹è§£é‡Š"><span>ç¤ºä¾‹è§£é‡Š</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js åº”ç”¨ï¼Œéœ€è¦åˆ¤æ–­æŸä¸ªè·¯å¾„æ˜¯å¦æŒ‡å‘ç¡¬ç›˜æˆ–å…¶ä»–ç±»å‹çš„å—è®¾å¤‡ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨ <code>stats.isBlockDevice()</code> æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fs.stat() è·å–è·¯å¾„çš„ stats å¯¹è±¡</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/device</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨ isBlockDevice() åˆ¤æ–­è¯¥è·¯å¾„æ˜¯å¦æŒ‡å‘å—è®¾å¤‡</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isBlockDevice</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯¥è·¯å¾„æŒ‡å‘ä¸€ä¸ªå—è®¾å¤‡ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯¥è·¯å¾„ä¸æŒ‡å‘ä¸€ä¸ªå—è®¾å¤‡ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…åº”ç”¨åœºæ™¯-4" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨åœºæ™¯-4"><span>å®é™…åº”ç”¨åœºæ™¯</span></a></h3><ol><li><p><strong>æ•°æ®æ¢å¤è½¯ä»¶</strong>ï¼šå¼€å‘æ­¤ç±»è½¯ä»¶æ—¶ï¼Œå¯èƒ½éœ€è¦ç›´æ¥ä»ç‰©ç†ç¡¬ç›˜è¯»å–æ•°æ®ã€‚ä½¿ç”¨ <code>isBlockDevice()</code> å¯ä»¥å¸®åŠ©è¯†åˆ«å‡ºå“ªäº›è®¾å¤‡æ˜¯ç¡¬ç›˜æˆ–å…¶ä»–ç±»å‹çš„å—å­˜å‚¨è®¾å¤‡ã€‚</p></li><li><p><strong>ç³»ç»Ÿç›‘æ§å·¥å…·</strong>ï¼šå¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç›‘æ§ç³»ç»Ÿæ€§èƒ½çš„å·¥å…·ï¼Œç‰¹åˆ«æ˜¯ç›‘æ§ç£ç›˜ä½¿ç”¨æƒ…å†µï¼Œé‚£ä¹ˆè¯†åˆ«å‡ºå—è®¾å¤‡å°†éå¸¸æœ‰ç”¨ã€‚</p></li><li><p><strong>è‡ªå®šä¹‰å¤‡ä»½è§£å†³æ–¹æ¡ˆ</strong>ï¼šåœ¨å¼€å‘ä¸€ä¸ªå¤‡ä»½è§£å†³æ–¹æ¡ˆæ—¶ï¼Œå¯èƒ½éœ€è¦åŒºåˆ†æ–‡ä»¶å’Œè®¾å¤‡ã€‚é€šè¿‡ <code>isBlockDevice()</code>ï¼Œä½ å¯ä»¥ç¡®å®šå“ªäº›æ˜¯å®é™…çš„è®¾å¤‡ï¼Œä»¥ä¾¿è¿›è¡Œç‰¹å®šçš„å¤‡ä»½æµç¨‹ã€‚</p></li></ol><p>æ€»ä¹‹ï¼Œ<code>stats.isBlockDevice()</code> åœ¨å¤„ç†æ¶‰åŠåº•å±‚ç¡¬ä»¶è®¾å¤‡çš„ Node.js åº”ç”¨ç¨‹åºä¸­éå¸¸æœ‰ç”¨ï¼Œå°¤å…¶æ˜¯å½“éœ€è¦åŒºåˆ†æ™®é€šæ–‡ä»¶å’Œç¡¬ä»¶è®¾å¤‡æ—¶ã€‚</p><h4 id="stats-ischaracterdevice" tabindex="-1"><a class="header-anchor" href="#stats-ischaracterdevice"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsischaracterdevice" target="_blank" rel="noopener noreferrer">stats.isCharacterDevice()</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript çš„ç¯å¢ƒï¼Œè€Œ <code>fs</code> æ¨¡å—æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº‘çš„æ¨¡å—ã€‚åœ¨è¿™ä¸ªæ¨¡å—ä¸­ï¼Œ<code>stats.isCharacterDevice()</code> å‡½æ•°ç”¨æ¥ç¡®å®šä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦æ˜¯å¦æŒ‡å‘äº†ä¸€ä¸ªå­—ç¬¦è®¾å¤‡ã€‚</p><p>è¦ç†è§£ <code>stats.isCharacterDevice()</code>ï¼Œé¦–å…ˆå¾—åˆ†æ¸…ä»€ä¹ˆæ˜¯å­—ç¬¦è®¾å¤‡ã€‚å­—ç¬¦è®¾å¤‡æ˜¯ä¸€ç§æ”¯æŒä»¥å­—ç¬¦ä¸ºå•ä½è¿›è¡Œæ•°æ®ä¼ è¾“çš„è®¾å¤‡ï¼Œæ¯”å¦‚é”®ç›˜ã€é¼ æ ‡ã€ä¸²å£è®¾å¤‡ç­‰ã€‚å®ƒä»¬ä¸å—è®¾å¤‡ï¼ˆæ¯”å¦‚ç¡¬ç›˜é©±åŠ¨å™¨å’Œ USB é—ªå­˜é©±åŠ¨å™¨ï¼‰ç›¸å¯¹ï¼Œåè€…æ˜¯ä»¥æ•°æ®å—ä¸ºå•ä½è¿›è¡Œæ•°æ®ä¼ è¾“çš„è®¾å¤‡ã€‚</p><h3 id="ä½¿ç”¨-stats-ischaracterdevice" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-stats-ischaracterdevice"><span>ä½¿ç”¨ <code>stats.isCharacterDevice()</code></span></a></h3><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½éœ€è¦ç¡®å®šæŸä¸ªæ–‡ä»¶æˆ–è®¾å¤‡çš„ç±»å‹ä»¥æ‰§è¡Œç‰¹å®šæ“ä½œã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„ç¨‹åºè®¾è®¡ä¸ºåªå¤„ç†å­—ç¬¦è®¾å¤‡è¾“å…¥ï¼Œå¯ä»¥ä½¿ç”¨ <code>stats.isCharacterDevice()</code> æ¥æ£€æŸ¥ç›®æ ‡è®¾å¤‡æ˜¯å¦ç¬¦åˆè¦æ±‚ã€‚</p><p>ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨ <code>stats.isCharacterDevice()</code> çš„ç®€å•ç¤ºä¾‹ï¼š</p><ol><li><strong>è½½å…¥ <code>fs</code> æ¨¡å—</strong>ï¼šé¦–å…ˆï¼Œéœ€è¦é€šè¿‡ <code>require</code> å‡½æ•°è½½å…¥ Node.js çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>ï¼‰æ¨¡å—ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li><strong>è·å–æ–‡ä»¶çŠ¶æ€</strong>ï¼šç„¶åï¼Œä½¿ç”¨ <code>fs.stat()</code> æˆ– <code>fs.statSync()</code> å‡½æ•°è·å–ç›®æ ‡æ–‡ä»¶æˆ–è®¾å¤‡çš„çŠ¶æ€ã€‚è¿™äº›å‡½æ•°ä¼šè¿”å›ä¸€ä¸ª <code>fs.Stats</code> å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº†æœ‰å…³æ–‡ä»¶æˆ–è®¾å¤‡çš„ä¿¡æ¯ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å¼‚æ­¥ç‰ˆæœ¬</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/dev/tty</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isCharacterDevice</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/dev/tty æ˜¯ä¸€ä¸ªå­—ç¬¦è®¾å¤‡</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/dev/tty ä¸æ˜¯ä¸€ä¸ªå­—ç¬¦è®¾å¤‡</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åŒæ­¥ç‰ˆæœ¬</span></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/dev/tty</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isCharacterDevice</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/dev/tty æ˜¯ä¸€ä¸ªå­—ç¬¦è®¾å¤‡</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/dev/tty ä¸æ˜¯ä¸€ä¸ªå­—ç¬¦è®¾å¤‡</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>/dev/tty</code> é€šå¸¸æ˜¯æŒ‡ä»£å½“å‰ç»ˆç«¯æˆ–æ§åˆ¶å°çš„å­—ç¬¦è®¾å¤‡ã€‚æˆ‘ä»¬è°ƒç”¨ <code>fs.stat()</code> æˆ– <code>fs.statSync()</code> å‡½æ•°æ¥è·å–å®ƒçš„çŠ¶æ€ï¼Œç„¶åè°ƒç”¨ <code>stats.isCharacterDevice()</code> æ–¹æ³•æ¥æ£€æŸ¥å®ƒæ˜¯å¦æ˜¯ä¸€ä¸ªå­—ç¬¦è®¾å¤‡ã€‚</p><h3 id="å®é™…åº”ç”¨åœºæ™¯-5" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨åœºæ™¯-5"><span>å®é™…åº”ç”¨åœºæ™¯</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œè¯¥å·¥å…·éœ€è¦ä»ç‰¹å®šçš„è®¾å¤‡æ–‡ä»¶è¯»å–æ•°æ®ã€‚ä½¿ç”¨ <code>stats.isCharacterDevice()</code> å¯ä»¥å¸®åŠ©ä½ ç¡®è®¤è¿™ä¸ªæ–‡ä»¶æ˜¯å¦ä¸ºæ­£ç¡®ç±»å‹çš„è®¾å¤‡ï¼Œé¿å…åœ¨é”™è¯¯çš„è®¾å¤‡æ–‡ä»¶ä¸Šæ“ä½œå¯¼è‡´çš„é—®é¢˜ã€‚</p><p>å¦ä¸€ä¸ªåœºæ™¯å¯èƒ½æ˜¯åœ¨ç¼–å†™éœ€è¦ä¸å¤šç§ç±»å‹çš„è®¾å¤‡äº¤äº’çš„ç³»ç»Ÿçº§è½¯ä»¶æ—¶ï¼Œæ ¹æ®è®¾å¤‡ç±»å‹é‡‡å–ä¸åŒçš„å¤„ç†ç­–ç•¥ï¼Œæ­¤æ—¶ï¼Œè¯†åˆ«è®¾å¤‡ç±»å‹å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚</p><p>é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œ<code>stats.isCharacterDevice()</code> æˆä¸ºäº† Node.js ç¨‹åºå‘˜å·¥å…·ç®±ä¸­ç”¨äºå¤„ç†ç‰¹å®šç±»å‹è®¾å¤‡æ–‡ä»¶çš„ä¸€ä¸ªæœ‰ç”¨çš„å·¥å…·ã€‚</p><h4 id="stats-isdirectory" tabindex="-1"><a class="header-anchor" href="#stats-isdirectory"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsisdirectory" target="_blank" rel="noopener noreferrer">stats.isDirectory()</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚<code>fs</code> æ¨¡å—æ˜¯ Node.js çš„å†…ç½®æ¨¡å—ä¹‹ä¸€ï¼Œæä¾›äº†æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„åŠŸèƒ½ï¼Œæ¯”å¦‚è¯»å–ã€å†™å…¥æ–‡ä»¶ï¼Œä»¥åŠä¸æ–‡ä»¶ç³»ç»Ÿçš„äº¤äº’ã€‚</p><p>åœ¨ <code>fs</code> æ¨¡å—ä¸­ï¼Œæœ‰ä¸€ä¸ªé‡è¦çš„å¯¹è±¡å«åš <code>Stats</code>ã€‚å½“ä½ ä½¿ç”¨ <code>fs.stat()</code>, <code>fs.lstat()</code> æˆ– <code>fs.fstat()</code> ç­‰æ–¹æ³•è·å–ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼ˆæ–‡ä»¶å¤¹ï¼‰çš„ä¿¡æ¯æ—¶ï¼Œè¿”å›çš„å°±æ˜¯ä¸€ä¸ª <code>Stats</code> å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åŒ…å«äº†å¾ˆå¤šå±æ€§å’Œæ–¹æ³•ï¼Œç”¨æ¥å‘Šè¯‰æˆ‘ä»¬å…³äºæ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ã€‚</p><h3 id="stats-isdirectory-1" tabindex="-1"><a class="header-anchor" href="#stats-isdirectory-1"><span>stats.isDirectory()</span></a></h3><p><code>stats.isDirectory()</code> æ˜¯ <code>Stats</code> å¯¹è±¡æä¾›çš„ä¸€ä¸ªæ–¹æ³•ã€‚å½“è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ˆBooleanï¼‰ï¼Œå³ <code>true</code> æˆ– <code>false</code>ã€‚å¦‚æœæ‰€æ£€æŸ¥çš„æ˜¯ä¸€ä¸ªç›®å½•ï¼Œåˆ™è¿”å› <code>true</code>ï¼›å¦‚æœä¸æ˜¯ç›®å½•ï¼Œåˆ™è¿”å› <code>false</code>ã€‚</p><h4 id="å®é™…è¿ç”¨ä¸¾ä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¸¾ä¾‹-1"><span>å®é™…è¿ç”¨ä¸¾ä¾‹</span></a></h4><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œéœ€è¦éå†ä¸€ä¸ªæ–‡ä»¶å¤¹å¹¶æ‰¾å‡ºå…¶ä¸­æ‰€æœ‰çš„å­ç›®å½•ã€‚è¿™æ—¶ï¼Œä½ å¯ä»¥åˆ©ç”¨ <code>fs</code> æ¨¡å—æ¥è·å–ç›®å½•ä¸­æ¯ä¸ªæ–‡ä»¶æˆ–å­ç›®å½•çš„ä¿¡æ¯ï¼Œå¹¶é€šè¿‡ <code>stats.isDirectory()</code> æ–¹æ³•åˆ¤æ–­å®ƒä»¬æ˜¯å¦ä¸ºç›®å½•ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®šä¹‰è¦éå†çš„ç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> directoryPath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">__dirname</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">your-directory-name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è¯»å–ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶/ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> function</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> files</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ— æ³•è¯»å–ç›®å½•: </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  files</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forEach</span><span style="color:#D8DEE9FF;">(</span><span style="color:#81A1C1;">function</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">file</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // è·å–æ–‡ä»¶/ç›®å½•å®Œæ•´è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">    let</span><span style="color:#D8DEE9;"> fullPath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> file</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // è·å–æ–‡ä»¶/ç›®å½•çš„ç»Ÿè®¡ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fullPath</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> function</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ— æ³•è·å–æ–‡ä»¶/ç›®å½•ç»Ÿè®¡ä¿¡æ¯: </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        return;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">      // å¦‚æœæ˜¯ç›®å½•ï¼Œåˆ™æ‰“å°ç›®å½•å</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isDirectory</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">file</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> æ˜¯ä¸€ä¸ªç›®å½•.</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">file</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> ä¸æ˜¯ç›®å½•.</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œé¦–å…ˆå¯¼å…¥äº† <code>fs</code> å’Œ <code>path</code> æ¨¡å—ã€‚ç„¶åå®šä¹‰äº†ä¸€ä¸ªç›®å½•è·¯å¾„ <code>directoryPath</code>ï¼Œä½¿ç”¨ <code>fs.readdir()</code> æ–¹æ³•è¯»å–è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•ã€‚å¯¹äºæ¯ä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œä½¿ç”¨ <code>fs.stat()</code> æ–¹æ³•è·å–å…¶ <code>Stats</code> å¯¹è±¡ï¼Œç„¶åè°ƒç”¨ <code>stats.isDirectory()</code> æ–¹æ³•åˆ¤æ–­å®ƒæ˜¯å¦ä¸ºç›®å½•ï¼Œå¹¶æ‰“å°ç›¸åº”çš„ä¿¡æ¯ã€‚</p><p>é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œä½ å¯ä»¥è½»æ¾åœ°åŒºåˆ†å‡ºå“ªäº›æ˜¯æ–‡ä»¶ï¼Œå“ªäº›æ˜¯ç›®å½•ï¼Œå¹¶æ‰§è¡Œç›¸åº”çš„é€»è¾‘å¤„ç†ã€‚è¿™åœ¨å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ—¶éå¸¸å®ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨è¿›è¡Œæ–‡ä»¶ç®¡ç†ã€å†…å®¹ç´¢å¼•æˆ–è€…æ„å»ºæ–‡ä»¶æµè§ˆå™¨ç­‰åº”ç”¨æ—¶ã€‚</p><h4 id="stats-isfifo" tabindex="-1"><a class="header-anchor" href="#stats-isfifo"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsisfifo" target="_blank" rel="noopener noreferrer">stats.isFIFO()</a></span></a></h4><p>ç†è§£ <code>stats.isFIFO()</code> ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸¤ä¸ªæ¦‚å¿µï¼šNode.js å’Œ FIFOã€‚</p><p><strong>Node.js ç®€ä»‹</strong></p><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒã€‚å®ƒè®©ä½ èƒ½å¤Ÿåœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptï¼Œä»è€Œå¼€å‘å‡ºèƒ½å¤„ç†é«˜å¹¶å‘ã€I/O å¯†é›†å‹çš„å®æ—¶åº”ç”¨ç¨‹åºã€‚</p><p><strong>FIFO ç®€ä»‹</strong></p><p>FIFO ä»£è¡¨â€œå…ˆè¿›å…ˆå‡ºâ€ï¼Œè¿™æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿå¯¹è±¡ï¼Œä¹Ÿç§°ä¸ºå‘½åç®¡é“ã€‚å®ƒå…è®¸ä¸¤ä¸ªæˆ–æ›´å¤šè¿›ç¨‹è¿›è¡Œé€šä¿¡ï¼Œæ•°æ®å†™å…¥åˆ° FIFO çš„ä¸€ç«¯ï¼Œå¹¶æŒ‰ç…§å†™å…¥é¡ºåºä»å¦ä¸€ç«¯è¯»å‡ºã€‚ä¸æ™®é€šæ–‡ä»¶ä¸åŒï¼ŒFIFO ä¸å­˜å‚¨ä»»ä½•æ•°æ®åœ¨ç£ç›˜ä¸Šï¼Œæ•°æ®é€šè¿‡å®ƒæµåŠ¨å°±åƒæ°´æµè¿‡ç®¡é“ä¸€æ ·ã€‚</p><h3 id="stats-isfifo-1" tabindex="-1"><a class="header-anchor" href="#stats-isfifo-1"><span>stats.isFIFO()</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æä¾›äº†ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„ APIã€‚å½“ä½ ä½¿ç”¨ <code>fs.stat()</code>, <code>fs.statSync()</code> æˆ– <code>fs.promises.stat()</code> æ–¹æ³•è·å–æ–‡ä»¶ï¼ˆæˆ–ç›®å½•ï¼‰çš„çŠ¶æ€ä¿¡æ¯æ—¶ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ª <code>fs.Stats</code> å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åŒ…å«äº†å¾ˆå¤šå…³äºæ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ¯”å¦‚æ–‡ä»¶å¤§å°ã€åˆ›å»ºæ—¶é—´ç­‰ã€‚</p><p><code>stats.isFIFO()</code> æ–¹æ³•å°±æ˜¯ <code>fs.Stats</code> å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨æ¥åˆ¤æ–­æŒ‡å®šçš„è·¯å¾„æ˜¯å¦æ˜¯ä¸€ä¸ª FIFO æ–‡ä»¶ã€‚å¦‚æœæ˜¯ï¼Œåˆ™è¿”å› <code>true</code>ï¼›å¦åˆ™ï¼Œè¿”å› <code>false</code>ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-26" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-26"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œéœ€è¦æ ¹æ®æ–‡ä»¶ç±»å‹æ‰§è¡Œä¸åŒçš„æ“ä½œã€‚å…¶ä¸­ä¸€ä¸ªä»»åŠ¡æ˜¯æ£€æŸ¥æŸä¸ªè·¯å¾„æ˜¯å¦æŒ‡å‘ä¸€ä¸ª FIFO æ–‡ä»¶ï¼Œç„¶åæ®æ­¤ä½œå‡ºç›¸åº”çš„å¤„ç†ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fs.stat è·å–æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‘ç”Ÿé”™è¯¯</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // åˆ¤æ–­è¯¥è·¯å¾„æ˜¯å¦ä¸ºFIFOæ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFIFO</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯ä¸€ä¸ªFIFOæ–‡ä»¶ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // åœ¨è¿™é‡Œç¼–å†™é’ˆå¯¹FIFOæ–‡ä»¶çš„å¤„ç†é€»è¾‘</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™ä¸æ˜¯ä¸€ä¸ªFIFOæ–‡ä»¶ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // åœ¨è¿™é‡Œç¼–å†™å…¶ä»–ç±»å‹æ–‡ä»¶çš„å¤„ç†é€»è¾‘</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šä»£ç é¦–å…ˆå¼•å…¥äº† <code>fs</code> æ¨¡å—ï¼Œç„¶åä½¿ç”¨ <code>fs.stat</code> æ–¹æ³•å¼‚æ­¥è·å–æŒ‡å®šè·¯å¾„æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯ã€‚å›è°ƒå‡½æ•°ä¸­ï¼Œé€šè¿‡ <code>stats.isFIFO()</code> æ–¹æ³•åˆ¤æ–­è¯¥æ–‡ä»¶æ˜¯å¦ä¸º FIFO æ–‡ä»¶ï¼Œå¹¶æ®æ­¤æ‰“å°å‡ºç›¸åº”çš„ä¿¡æ¯ã€‚</p><p>è¿™æ ·çš„åŠŸèƒ½ç‰¹åˆ«é€‚åˆéœ€è¦åœ¨ä¸åŒç±»å‹çš„æ–‡ä»¶é—´åŒºåˆ†å¤„ç†é€»è¾‘çš„åœºæ™¯ï¼Œä¾‹å¦‚åœ¨æ„å»ºå·¥å…·ã€æ–‡ä»¶ç®¡ç†å™¨æˆ–æ•°æ®æµå¤„ç†åº”ç”¨ä¸­ã€‚</p><h4 id="stats-isfile" tabindex="-1"><a class="header-anchor" href="#stats-isfile"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsisfile" target="_blank" rel="noopener noreferrer">stats.isFile()</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªè®© JavaScript è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¹³å°ã€‚å…¶ä¸­ï¼ŒNode.js æä¾›äº†å¾ˆå¤šæ¨¡å—ï¼Œç”¨äºå®Œæˆä¸åŒçš„ä»»åŠ¡ã€‚<code>fs</code>ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰æ¨¡å—å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ä¸Šæ“ä½œæ–‡ä»¶ï¼Œæ¯”å¦‚è¯»å–ã€å†™å…¥å’Œä¿®æ”¹æ–‡ä»¶ç­‰ã€‚</p><p>å½“ä½ ä½¿ç”¨<code>fs</code>æ¨¡å—è¿›è¡Œæ–‡ä»¶æ“ä½œæ—¶ï¼Œå¾ˆå¤šæ—¶å€™éœ€è¦åˆ¤æ–­æ­£åœ¨å¤„ç†çš„å¯¹è±¡æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•ï¼ˆæ–‡ä»¶å¤¹ï¼‰ã€‚è¿™æ—¶ï¼Œ<code>stats.isFile()</code>æ–¹æ³•å°±æ´¾ä¸Šäº†ç”¨åœºã€‚</p><h3 id="stats-isfile-1" tabindex="-1"><a class="header-anchor" href="#stats-isfile-1"><span>stats.isFile()</span></a></h3><p>è¿™ä¸ªæ–¹æ³•æ˜¯<code>fs.Stats</code>å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ã€‚é¦–å…ˆï¼Œå½“ä½ å¯¹æ–‡ä»¶æˆ–ç›®å½•ä½¿ç”¨<code>fs.stat()</code>ã€<code>fs.statSync()</code>ã€<code>fs.lstat()</code>ã€<code>fs.lstatSync()</code>è¿™ç±»æ–¹æ³•æ—¶ï¼Œä¼šå¾—åˆ°ä¸€ä¸ª<code>fs.Stats</code>å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åŒ…å«äº†å…³äºæ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ¯”å¦‚åˆ›å»ºæ—¶é—´ã€å¤§å°ã€æ˜¯å¦æ˜¯æ–‡ä»¶ç­‰ã€‚</p><p>å…¶ä¸­ï¼Œ<code>stats.isFile()</code>æ–¹æ³•ç”¨æ¥åˆ¤æ–­å½“å‰å¤„ç†çš„å¯¹è±¡æ˜¯å¦æ˜¯ä¸€ä¸ªæ–‡ä»¶ã€‚å¦‚æœæ˜¯æ–‡ä»¶ï¼Œæ­¤æ–¹æ³•è¿”å›<code>true</code>ï¼›å¦‚æœä¸æ˜¯æ–‡ä»¶ï¼ˆä¾‹å¦‚æ˜¯ç›®å½•æˆ–é“¾æ¥ç­‰ï¼‰ï¼Œåˆ™è¿”å›<code>false</code>ã€‚</p><h3 id="å®é™…åº”ç”¨ä¸¾ä¾‹-2" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¸¾ä¾‹-2"><span>å®é™…åº”ç”¨ä¸¾ä¾‹</span></a></h3><ol><li><strong>åˆ¤æ–­ç‰¹å®šè·¯å¾„æ˜¯å¦æ˜¯æ–‡ä»¶</strong></li></ol><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦æ£€æŸ¥æŸä¸ªè·¯å¾„ä¸‹çš„å†…å®¹æ˜¯å¦ä¸ºæ–‡ä»¶ï¼Œä»¥å†³å®šæ˜¯å¦è¿›è¡Œè¯»å–æ“ä½œï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨fs.statè·å–è·¯å¾„ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/your/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨isFileåˆ¤æ–­æ˜¯å¦ä¸ºæ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFile</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™ä¸æ˜¯æ–‡ä»¶</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>ç­›é€‰ç›®å½•ä¸­æ‰€æœ‰çš„æ–‡ä»¶</strong></li></ol><p>å¦‚æœä½ è¦åˆ—å‡ºä¸€ä¸ªç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶ï¼ˆæ’é™¤ç›®å½•ï¼‰ï¼Œå¯ä»¥è¿™ä¹ˆåšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> directoryPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å…ˆè¯»å–ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> files</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  files</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forEach</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">file</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    let</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> file</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // æ£€æŸ¥æ¯ä¸ªè·¯å¾„æ˜¯ä¸æ˜¯æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        return;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isFile</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">file</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> æ˜¯ä¸€ä¸ªæ–‡ä»¶</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™ä¸¤ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ°<code>stats.isFile()</code>åœ¨æ–‡ä»¶æ“ä½œä¸­çš„å®é™…åº”ç”¨ã€‚å®ƒå¸®åŠ©æˆ‘ä»¬åŒºåˆ†æ–‡ä»¶å’Œå…¶ä»–ç±»å‹çš„å¯¹è±¡ï¼Œä»è€Œæ‰§è¡Œæ­£ç¡®çš„æ“ä½œã€‚</p><h4 id="stats-issocket" tabindex="-1"><a class="header-anchor" href="#stats-issocket"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsissocket" target="_blank" rel="noopener noreferrer">stats.isSocket()</a></span></a></h4><p>å½“æˆ‘ä»¬è°ˆè®º Node.js ä¸­çš„<code>stats.isSocket()</code>æ–¹æ³•ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨è®¨è®ºæ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—æä¾›çš„ä¸€ä¸ªåŠŸèƒ½ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>fs</code>æ¨¡å—æ˜¯ç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ï¼Œå®ƒå…è®¸ä½ è¯»å†™æ–‡ä»¶ã€è·å–æ–‡ä»¶ä¿¡æ¯ç­‰ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯stats-issocket" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯stats-issocket"><span>ä»€ä¹ˆæ˜¯<code>stats.isSocket()</code>?</span></a></h3><p><code>stats.isSocket()</code>æ˜¯<code>fs.Stats</code>å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºåˆ¤æ–­æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶æ˜¯å¦æ˜¯ä¸€ä¸ª socket æ–‡ä»¶ã€‚Socket æ–‡ä»¶åœ¨ Unix å’Œ Linux ç³»ç»Ÿä¸­è¾ƒä¸ºå¸¸è§ï¼Œå®ƒä»¬æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ–‡ä»¶ï¼Œç”¨äºè¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰ï¼Œå³ä¸åŒç¨‹åºä¹‹é—´é€šè¿‡ç½‘ç»œæˆ–å…¶ä»–æ–¹å¼å‘é€å’Œæ¥æ”¶æ•°æ®ã€‚</p><p>åœ¨ä½¿ç”¨<code>fs.stat()</code>, <code>fs.fstat()</code>, <code>fs.lstat()</code>ç­‰æ–¹æ³•è·å–äº†æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯åï¼Œå¯ä»¥è°ƒç”¨<code>stats.isSocket()</code>æ–¹æ³•æ¥ç¡®å®šè¯¥æ–‡ä»¶æ˜¯å¦ä¸º socket æ–‡ä»¶ã€‚</p><h3 id="ä½¿ç”¨ç¤ºä¾‹-5" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹-5"><span>ä½¿ç”¨ç¤ºä¾‹</span></a></h3><p>å› ä¸ºè¿™æ˜¯æ¯”è¾ƒåº•å±‚çš„æ“ä½œï¼Œæ‰€ä»¥åœ¨å®é™…å¼€å‘ä¸­å¯èƒ½ä¸é‚£ä¹ˆå¸¸è§ï¼Œä½†äº†è§£å®ƒèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬æ›´æ·±å…¥ç†è§£ç³»ç»Ÿçº§ç¼–ç¨‹å’Œè¿›ç¨‹é—´é€šä¿¡ã€‚ä¸‹é¢æˆ‘ä¼šç»™å‡ºä¸¤ä¸ªç®€å•çš„ç¤ºä¾‹ã€‚</p><h4 id="ç¤ºä¾‹-1-æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸º-socket" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸º-socket"><span>ç¤ºä¾‹ 1: æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸º Socket</span></a></h4><p>é¦–å…ˆï¼Œç¡®ä¿ä½ æœ‰ä¸€ä¸ªç”¨äºæµ‹è¯•çš„ socket æ–‡ä»¶ã€‚åœ¨ Unix æˆ– Linux ç³»ç»Ÿä¸Šï¼Œé€šå¸¸åœ¨<code>/tmp</code>æˆ–è€…<code>/var/run</code>ç›®å½•ä¸‹å¯ä»¥æ‰¾åˆ°æ­¤ç±»æ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾&#39;/tmp/app.sock&#39;æ˜¯ä¸€ä¸ªå·²çŸ¥çš„socketæ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/tmp/app.sock</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨fs.stat()å¼‚æ­¥è·å–æ–‡ä»¶çŠ¶æ€</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‡ºé”™äº†</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨isSocket()æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸ºsocket</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isSocket</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">path</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> æ˜¯ä¸€ä¸ªsocketæ–‡ä»¶</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">path</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> ä¸æ˜¯socketæ–‡ä»¶</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-åŒæ­¥æ–¹å¼æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸º-socket" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-åŒæ­¥æ–¹å¼æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸º-socket"><span>ç¤ºä¾‹ 2: åŒæ­¥æ–¹å¼æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸º Socket</span></a></h4><p>å¦‚æœä½ æ›´å–œæ¬¢ä½¿ç”¨åŒæ­¥æ–¹å¼ï¼Œä¹Ÿå¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/tmp/app.sock</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨fs.statSync()åŒæ­¥è·å–æ–‡ä»¶çŠ¶æ€</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨isSocket()æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸ºsocket</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isSocket</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">path</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> æ˜¯ä¸€ä¸ªsocketæ–‡ä»¶</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">path</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> ä¸æ˜¯socketæ–‡ä»¶</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‡ºé”™äº†</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸¤ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•æ£€æŸ¥ä¸€ä¸ªæ–‡ä»¶æ˜¯å¦æ˜¯ socket æ–‡ä»¶ã€‚è¿™åœ¨è¿›è¡Œç½‘ç»œç¼–ç¨‹æˆ–éœ€è¦è¯†åˆ«å„ç§ç±»å‹æ–‡ä»¶æ—¶å¯èƒ½ä¼šå¾ˆæœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½åœ¨æ„å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œè¯¥ç¨‹åºéœ€è¦ç®¡ç†æˆ–ä¸å¤šç§ç±»å‹çš„æ–‡ä»¶äº¤äº’ï¼ˆåŒ…æ‹¬ socket æ–‡ä»¶ï¼‰ã€‚é€šè¿‡è¯†åˆ« socket æ–‡ä»¶ï¼Œä½ å¯ä»¥é’ˆå¯¹æ€§åœ°å¤„ç†å®ƒä»¬ï¼Œä¾‹å¦‚è®¾ç½®ç‰¹å®šçš„é€šä¿¡åè®®æˆ–å®‰å…¨æªæ–½ã€‚</p><h4 id="stats-issymboliclink" tabindex="-1"><a class="header-anchor" href="#stats-issymboliclink"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsissymboliclink" target="_blank" rel="noopener noreferrer">stats.isSymbolicLink()</a></span></a></h4><p>Node.js ä¸­çš„ <code>stats.isSymbolicLink()</code> æ–¹æ³•ç”¨äºåˆ¤æ–­æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ç¬¦å·é“¾æ¥ï¼ˆsymbolic linkï¼‰ã€‚åœ¨æ·±å…¥è§£é‡Šè¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ç¬¦å·é“¾æ¥ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯ç¬¦å·é“¾æ¥-1" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯ç¬¦å·é“¾æ¥-1"><span>ä»€ä¹ˆæ˜¯ç¬¦å·é“¾æ¥ï¼Ÿ</span></a></h3><p>ç¬¦å·é“¾æ¥ç›¸å½“äº Windows ç³»ç»Ÿé‡Œçš„å¿«æ·æ–¹å¼æˆ– Unix/Linux ç³»ç»Ÿä¸­çš„è½¯é“¾æ¥ã€‚å®ƒæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶ï¼ŒåŒ…å«äº†å¦ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„å¼•ç”¨ã€‚é€šè¿‡ç¬¦å·é“¾æ¥ï¼Œä½ å¯ä»¥åœ¨å¤šä¸ªä½ç½®è®¿é—®åŒä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œè€Œä¸éœ€è¦å®é™…å¤åˆ¶è¯¥æ–‡ä»¶æˆ–ç›®å½•ã€‚è¿™å¯¹äºèŠ‚çœç©ºé—´ã€ç»„ç»‡æ–‡ä»¶å’Œç®¡ç†é¡¹ç›®éå¸¸æœ‰ç”¨ã€‚</p><h3 id="stats-issymboliclink-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#stats-issymboliclink-æ–¹æ³•"><span><code>stats.isSymbolicLink()</code> æ–¹æ³•</span></a></h3><p>åœ¨ Node.js ä¸­æ“ä½œæ–‡ä»¶æ—¶ï¼Œä½ ä¼šé‡åˆ° <code>fs</code> æ¨¡å—ï¼Œå®ƒæä¾›äº†ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„ APIã€‚<code>fs.Stats</code> å¯¹è±¡æä¾›äº†å…³äºæ–‡ä»¶ç³»ç»Ÿå¯¹è±¡ï¼ˆå¦‚æ–‡ä»¶ã€ç›®å½•ï¼‰çš„ä¿¡æ¯ã€‚å½“ä½ ä½¿ç”¨æŸäº› <code>fs</code> æ¨¡å—çš„å‡½æ•°ï¼ˆä¾‹å¦‚ <code>fs.stat()</code>, <code>fs.lstat()</code>ï¼‰è·å–æ–‡ä»¶æˆ–ç›®å½•çš„çŠ¶æ€æ—¶ï¼Œä¼šè¿”å›ä¸€ä¸ª <code>fs.Stats</code> å®ä¾‹ã€‚<code>stats.isSymbolicLink()</code> æ˜¯ <code>fs.Stats</code> å®ä¾‹ä¸Šçš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºæ£€æŸ¥å½“å‰å¤„ç†çš„æ–‡ä»¶ç³»ç»Ÿå¯¹è±¡æ˜¯å¦æ˜¯ç¬¦å·é“¾æ¥ã€‚</p><h4 id="ä½¿ç”¨åœºæ™¯-5" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯-5"><span>ä½¿ç”¨åœºæ™¯</span></a></h4><ol><li><p><strong>é¡¹ç›®é…ç½®å…±äº«</strong>ï¼šå‡è®¾ä½ æœ‰å¤šä¸ªé¡¹ç›®ï¼Œå®ƒä»¬éƒ½ä¾èµ–äºåŒä¸€ä¸ªé…ç½®æ–‡ä»¶ã€‚ä½ å¯ä»¥é€šè¿‡åˆ›å»ºæŒ‡å‘è¯¥é…ç½®æ–‡ä»¶çš„ç¬¦å·é“¾æ¥ï¼Œåœ¨æ¯ä¸ªé¡¹ç›®ä¸­è®¿é—®è¿™ä¸ªå…±äº«çš„é…ç½®æ–‡ä»¶ï¼Œè€Œæ— éœ€å¤åˆ¶å®ƒã€‚</p></li><li><p><strong>å¿«é€Ÿåˆ‡æ¢ç‰ˆæœ¬</strong>ï¼šåœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œå¦‚æœä½ éœ€è¦åœ¨ä¸åŒç‰ˆæœ¬çš„åº“æˆ–å·¥å…·ä¹‹é—´å¿«é€Ÿåˆ‡æ¢ï¼Œå¯ä»¥ä¸ºæ¯ä¸ªç‰ˆæœ¬åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œå¹¶ä½¿ç”¨ç¬¦å·é“¾æ¥æ¥æŒ‡å‘å½“å‰æ­£åœ¨ä½¿ç”¨çš„ç‰ˆæœ¬ã€‚é€šè¿‡æ›´æ–°ç¬¦å·é“¾æ¥ï¼Œå¯ä»¥è½»æ¾æ›´æ”¹æ´»åŠ¨ç‰ˆæœ¬ï¼Œè€Œä¸å¿…é‡æ–°é…ç½®ç¯å¢ƒã€‚</p></li><li><p><strong>é“¾æ¥èŠ‚ç‚¹æ¨¡å—</strong>ï¼šåœ¨è¿›è¡Œæœ¬åœ° Node.js æ¨¡å—å¼€å‘æ—¶ï¼Œä½ å¯èƒ½å¸Œæœ›åœ¨å…¶ä»–é¡¹ç›®ä¸­æµ‹è¯•ä½ çš„æ¨¡å—ã€‚é€šè¿‡åœ¨ä¾èµ–é¡¹ç›®å†…åˆ›å»ºæŒ‡å‘ä½ çš„æ¨¡å—ç›®å½•çš„ç¬¦å·é“¾æ¥ï¼Œå¯ä»¥ç›´æ¥åœ¨è¿™äº›é¡¹ç›®ä¸­ä½¿ç”¨å’Œæµ‹è¯•æœ¬åœ°æ¨¡å—ï¼Œè€Œæ— éœ€å°†å…¶å‘å¸ƒåˆ° npm ä¸Šã€‚</p></li></ol><h3 id="ç¤ºä¾‹-6" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-6"><span>ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æƒ³æ£€æŸ¥ä¸€ä¸ªæ–‡ä»¶æ˜¯å¦æ˜¯ç¬¦å·é“¾æ¥ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fs.lstat() è·å–æ–‡ä»¶çš„çŠ¶æ€</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">lstat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/your/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨ stats.isSymbolicLink() åˆ¤æ–­æ˜¯å¦æ˜¯ç¬¦å·é“¾æ¥</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isSymbolicLink</span><span style="color:#D8DEE9FF;">()) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™ä¸æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ<code>fs.lstat()</code> ç”¨äºè·å–ç”±è·¯å¾„æŒ‡å®šçš„æ–‡ä»¶æˆ–ç›®å½•çš„çŠ¶æ€ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>stats.isSymbolicLink()</code> æ¥åˆ¤æ–­è¿™ä¸ªæ–‡ä»¶æ˜¯å¦æ˜¯ç¬¦å·é“¾æ¥ï¼Œå¹¶æ®æ­¤æ‰“å°å‡ºç›¸åº”çš„æ¶ˆæ¯ã€‚</p><p>æ€»ç»“èµ·æ¥ï¼Œ<code>stats.isSymbolicLink()</code> æ˜¯ä¸€ä¸ªåœ¨å¤„ç†æ–‡ä»¶ç³»ç»Ÿä¸­çš„å¯¹è±¡æ—¶éå¸¸æœ‰ç”¨çš„æ–¹æ³•ï¼Œç‰¹åˆ«æ˜¯å½“ä½ éœ€è¦ç¡®å®šä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸ºç¬¦å·é“¾æ¥ï¼Œä»¥ä¾¿ä½œå‡ºç›¸åº”çš„é€»è¾‘å¤„ç†ã€‚</p><h4 id="stats-dev" tabindex="-1"><a class="header-anchor" href="#stats-dev"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsdev" target="_blank" rel="noopener noreferrer">stats.dev</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript ç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚å®ƒçš„è®¾è®¡ç†å¿µæ˜¯ç”¨å°‘é‡çš„ç¡¬ä»¶èµ„æºå¤„ç†å¤§é‡çš„è¿æ¥ï¼Œå¹¶ä¸”ä»¥éé˜»å¡çš„æ–¹å¼å¤„ç†è¾“å…¥/è¾“å‡ºæ“ä½œã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†æ–‡ä»¶ç³»ç»Ÿç›¸å…³æ“ä½œçš„æ¨¡å—ï¼Œä¾‹å¦‚è¯»å–æ–‡ä»¶ã€å†™å…¥æ–‡ä»¶ã€ä¿®æ”¹æ–‡ä»¶å±æ€§ç­‰ã€‚è¿™ä¸ªæ¨¡å—æä¾›äº†ä¸€äº›ç±»ä¼¼äºæ ‡å‡† POSIX æ–‡ä»¶æ“ä½œå‡½æ•°çš„æ–¹æ³•ã€‚</p><p>å½“æˆ‘ä»¬ä½¿ç”¨ <code>fs</code> æ¨¡å—è°ƒç”¨æŸäº›å‡½æ•°æ¥è·å–æ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯æ—¶ï¼ˆæ¯”å¦‚ä½¿ç”¨ <code>fs.stat</code>, <code>fs.lstat</code> æˆ–è€… <code>fs.fstat</code>ï¼‰ï¼Œè¿”å›çš„å¯¹è±¡æ˜¯ä¸€ä¸ª <code>fs.Stats</code> å¯¹è±¡ã€‚<code>fs.Stats</code> å¯¹è±¡åŒ…å«äº†å…³äºæ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚å¤§å°ã€åˆ›å»ºæ—¶é—´ç­‰ã€‚</p><p><code>stats.dev</code> æ˜¯ <code>fs.Stats</code> å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œä»£è¡¨çš„æ˜¯è¯¥æ–‡ä»¶æˆ–ç›®å½•æ‰€åœ¨çš„è®¾å¤‡çš„è®¾å¤‡å·ã€‚åœ¨ Unix-like ç³»ç»Ÿä¸­ï¼ˆä¾‹å¦‚ Linux æˆ– macOSï¼‰ï¼Œæ¯ä¸ªå­˜å‚¨è®¾å¤‡éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ç§°ä¸ºè®¾å¤‡å·ã€‚ åœ¨ Windows ç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªæ¦‚å¿µçš„å®ç°å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œä½†åŸç†ç›¸ä¼¼ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-34" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-34"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>è®©æˆ‘ä»¬é€šè¿‡ä¸€äº›ç®€å•çš„ä»£ç ç¤ºä¾‹æ¥çœ‹çœ‹ <code>stats.dev</code> å¦‚ä½•åœ¨å®é™…ä¸­è¢«ä½¿ç”¨ã€‚</p><h4 id="ç¤ºä¾‹-1-è·å–æ–‡ä»¶çš„è®¾å¤‡å·" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-è·å–æ–‡ä»¶çš„è®¾å¤‡å·"><span>ç¤ºä¾‹ 1: è·å–æ–‡ä»¶çš„è®¾å¤‡å·</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥è·å–æ–‡ä»¶çŠ¶æ€</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/your/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#616E88;">  // è¾“å‡ºæ–‡ä»¶æ‰€åœ¨è®¾å¤‡çš„è®¾å¤‡å·</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">dev</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>fs.stat()</code> å‡½æ•°å¼‚æ­¥åœ°è·å–ä¸€ä¸ªæ–‡ä»¶çš„çŠ¶æ€ã€‚å¦‚æœæˆåŠŸï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»å›è°ƒå‡½æ•°çš„ <code>stats</code> å‚æ•°ä¸­è®¿é—®åˆ° <code>stats.dev</code>ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªæ–‡ä»¶æ‰€åœ¨è®¾å¤‡çš„è®¾å¤‡å·ã€‚</p><h4 id="ç¤ºä¾‹-2-åˆ¤æ–­ä¸¤ä¸ªæ–‡ä»¶æ˜¯å¦ä½äºåŒä¸€è®¾å¤‡" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-åˆ¤æ–­ä¸¤ä¸ªæ–‡ä»¶æ˜¯å¦ä½äºåŒä¸€è®¾å¤‡"><span>ç¤ºä¾‹ 2: åˆ¤æ–­ä¸¤ä¸ªæ–‡ä»¶æ˜¯å¦ä½äºåŒä¸€è®¾å¤‡</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥è·å–ç¬¬ä¸€ä¸ªæ–‡ä»¶çš„çŠ¶æ€</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/your/firstFile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats1</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#616E88;">  // å¼‚æ­¥è·å–ç¬¬äºŒä¸ªæ–‡ä»¶çš„çŠ¶æ€</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/your/secondFile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats2</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      return;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#616E88;">    // æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„è®¾å¤‡å·</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats1</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">dev</span><span style="color:#81A1C1;"> ===</span><span style="color:#D8DEE9;"> stats2</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">dev</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ä¸¤ä¸ªæ–‡ä»¶ä½äºåŒä¸€è®¾å¤‡ä¸Š</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ä¸¤ä¸ªæ–‡ä»¶ä¸ä½äºåŒä¸€è®¾å¤‡ä¸Š</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>stats.dev</code> æ¥åˆ¤æ–­ä¸¤ä¸ªæ–‡ä»¶æ˜¯å¦ä½äºåŒä¸€å­˜å‚¨è®¾å¤‡ä¸Šã€‚è¿™å¯¹äºç†è§£å’Œä¼˜åŒ–æ–‡ä»¶æ“ä½œçš„æ€§èƒ½å¯èƒ½å¾ˆæœ‰å¸®åŠ©ï¼Œå› ä¸ºä¸åŒè®¾å¤‡ä¹‹é—´çš„æ–‡ä»¶æ“ä½œå¯èƒ½ä¼šæœ‰æ€§èƒ½å·®å¼‚ã€‚</p><p>é€šè¿‡è¿™äº›ç¤ºä¾‹ï¼Œä½ åº”è¯¥èƒ½å¤Ÿçœ‹å‡º <code>stats.dev</code> å¦‚ä½•åœ¨å®é™…ä¸­è¢«ç”¨æ¥è·å–å’Œåˆ©ç”¨æ–‡ä»¶æ‰€åœ¨è®¾å¤‡çš„ä¿¡æ¯ã€‚è¿™åªæ˜¯ <code>fs.Stats</code> å¯¹è±¡ä¼—å¤šæœ‰ç”¨å±æ€§ä¸­çš„ä¸€ä¸ªï¼Œæ¯ä¸ªå±æ€§éƒ½æœ‰å„è‡ªç‰¹å®šçš„ç”¨é€”å’Œæ½œåœ¨çš„åº”ç”¨åœºæ™¯ã€‚</p><h4 id="stats-ino" tabindex="-1"><a class="header-anchor" href="#stats-ino"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsino" target="_blank" rel="noopener noreferrer">stats.ino</a></span></a></h4><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬ä¸€èµ·äº†è§£ä¸€ä¸‹ Node.js ä¸­ <code>stats.ino</code> çš„æ¦‚å¿µã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æ˜¯ç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ã€‚å½“ä½ ä½¿ç”¨ <code>fs</code> æ¨¡å—ä¸­çš„æŸäº›å‡½æ•°å»è·å–ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼ˆæˆ‘ä»¬é€šå¸¸æŠŠè¿™äº›å«åš&quot;æ–‡ä»¶ç³»ç»Ÿå¯¹è±¡&quot;ï¼‰çš„ä¿¡æ¯æ—¶ï¼Œå¦‚ <code>fs.stat()</code>, <code>fs.lstat()</code> æˆ– <code>fs.fstat()</code> ç­‰ï¼Œå®ƒä»¬å°†è¿”å›ä¸€ä¸ª <code>fs.Stats</code> å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åŒ…å«äº†å¾ˆå¤šå…³äºæ–‡ä»¶ç³»ç»Ÿå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼Œç»™ä½ æä¾›äº†æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ã€‚</p><p>å…¶ä¸­çš„ <code>stats.ino</code> å±æ€§å°±æ˜¯ <code>fs.Stats</code> å¯¹è±¡ä¸­çš„ä¸€ä¸ªå±æ€§ã€‚<code>ino</code> ä»£è¡¨çš„æ˜¯ç´¢å¼•èŠ‚ç‚¹å·ï¼ˆinode numberï¼‰ã€‚åœ¨ç±» Unix ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶ç³»ç»Ÿå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ç´¢å¼•èŠ‚ç‚¹å·ï¼Œå®ƒæ˜¯æ–‡ä»¶ç³»ç»Ÿå±‚é¢ä¸Šçš„ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼Œç”¨æ¥æ ‡è¯†æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚å› æ­¤ï¼Œ<code>stats.ino</code> å°±æ˜¯æ–‡ä»¶æˆ–ç›®å½•å¯¹åº”çš„ç´¢å¼•èŠ‚ç‚¹å·ã€‚</p><p>ç°åœ¨ä¸¾å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥è·å–æ–‡ä»¶ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/your/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#616E88;">  // è¾“å‡ºæ–‡ä»¶çš„ inode å·</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ino</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åŒæ­¥è·å–æ–‡ä»¶ä¿¡æ¯</span></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/your/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // è¾“å‡ºæ–‡ä»¶çš„ inode å·</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ino</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸¤ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éƒ½è¯•å›¾è·å– <code>file.txt</code> æ–‡ä»¶çš„ä¿¡æ¯ã€‚ç¬¬ä¸€ä¸ªä¾‹å­ä¸­ä½¿ç”¨å¼‚æ­¥æ–¹å¼ï¼Œç¬¬äºŒä¸ªä¾‹å­ä½¿ç”¨åŒæ­¥æ–¹å¼ã€‚ä¸€æ—¦æˆ‘ä»¬å¾—åˆ°äº†æ–‡ä»¶çš„ <code>fs.Stats</code> å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¿é—® <code>.ino</code> å±æ€§æ¥è·å–æ–‡ä»¶çš„ inode å·ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒWindows ç³»ç»Ÿæ²¡æœ‰ inode çš„æ¦‚å¿µï¼Œæ‰€ä»¥åœ¨ Windows ä¸Šä½¿ç”¨ Node.js æ—¶ï¼Œ<code>stats.ino</code> å°†ä¸ä¼šæä¾›æœ‰ç”¨çš„ä¿¡æ¯ã€‚</p><p>è¿™ä¸ª inode å·åœ¨ä¸€äº›ç‰¹å®šçš„åœºæ™¯ä¸‹å¾ˆæœ‰ç”¨ï¼Œæ¯”å¦‚ï¼š</p><ol><li><strong>ç¡®å®šæ–‡ä»¶æ˜¯å¦å·²ç»è¢«æ›´æ”¹æˆ–ç§»åŠ¨</strong>ï¼šé€šè¿‡æ£€æŸ¥ inode å·ï¼Œä½ å¯ä»¥ç¡®å®šæ–‡ä»¶æ˜¯å¦è¢«æ›¿æ¢æˆå¦ä¸€ä¸ªæ–‡ä»¶ï¼Œå³ä½¿æ–‡ä»¶åæ²¡æœ‰å˜ã€‚</li><li><strong>é«˜æ•ˆåœ°æ¯”è¾ƒå¤§é‡æ–‡ä»¶</strong>ï¼šå½“ä½ æœ‰æˆåƒä¸Šä¸‡çš„æ–‡ä»¶éœ€è¦å¤„ç†æ—¶ï¼Œæ¯”è¾ƒ inode å·ä¼šæ¯”é€ä¸€æ‰“å¼€å¹¶è¯»å–æ–‡ä»¶å†…å®¹è¦é«˜æ•ˆå¾—å¤šã€‚</li><li><strong>æ–‡ä»¶å»é‡</strong>ï¼šå¦‚æœä½ åœ¨ä¸åŒçš„ç›®å½•ä¸‹æ‹¥æœ‰é‡å¤çš„æ–‡ä»¶ï¼Œå¹¶æƒ³è¦æ‰¾å‡ºå®ƒä»¬ï¼Œå¯ä»¥é€šè¿‡æ¯”è¾ƒ inode å·æ¥è¯†åˆ«å‡ºå®é™…æŒ‡å‘ç›¸åŒå†…å®¹çš„æ–‡ä»¶ã€‚</li></ol><p>æ€»ä¹‹ï¼Œ<code>stats.ino</code> æ˜¯ Node.js ä¸­ç”¨æ¥è¡¨ç¤ºæ–‡ä»¶ç³»ç»Ÿå¯¹è±¡çš„ inode å·ï¼Œå®ƒåœ¨ç®¡ç†å’Œå¤„ç†æ–‡ä»¶æ—¶æä¾›äº†åº•å±‚çš„å”¯ä¸€æ€§æ ‡è¯†ã€‚</p><h4 id="stats-mode" tabindex="-1"><a class="header-anchor" href="#stats-mode"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsmode" target="_blank" rel="noopener noreferrer">stats.mode</a></span></a></h4><p><code>stats.mode</code> æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—ä¸­ <code>Stats</code> å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒè¡¨ç¤ºæ–‡ä»¶æˆ–ç›®å½•çš„æƒé™å’Œç±»å‹ä¿¡æ¯ã€‚åœ¨ Unix å’Œç±» Unix ç³»ç»Ÿä¸­ï¼Œè¿™ç§ä¿¡æ¯é€šå¸¸ä»¥å…«è¿›åˆ¶æ•°ï¼ˆæˆ–æœ‰æ—¶æ˜¯åè¿›åˆ¶æ•°ï¼‰æ¥è¡¨ç¤ºã€‚</p><p>æ¯ä¸ªæ–‡ä»¶æˆ–ç›®å½•éƒ½æœ‰ä¸ä¹‹å…³è”çš„æƒé™ï¼Œè¿™äº›æƒé™å†³å®šäº†ç”¨æˆ·å¯¹è¿™äº›æ–‡ä»¶æˆ–ç›®å½•å¯ä»¥è¿›è¡Œå“ªäº›æ“ä½œã€‚ä¾‹å¦‚ï¼Œä¸€äº›å¸¸è§çš„æƒé™åŒ…æ‹¬è¯»ï¼ˆreadï¼‰ã€å†™ï¼ˆwriteï¼‰å’Œæ‰§è¡Œï¼ˆexecuteï¼‰ã€‚æ­¤å¤–ï¼Œ<code>mode</code>ä¹ŸåŒ…å«æ–‡ä»¶æ˜¯æ™®é€šæ–‡ä»¶ã€ç›®å½•è¿˜æ˜¯é“¾æ¥ç­‰ç±»å‹ä¿¡æ¯ã€‚</p><p>åœ¨æ·±å…¥ç†è§£ <code>stats.mode</code> ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€äº›åŸºç¡€çŸ¥è¯†ï¼š</p><ul><li><strong>æƒé™ä½</strong>ï¼šåœ¨ Unix-like ç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶æƒé™ç”± 9 ä½ç»„æˆï¼Œåˆ†åˆ«ä»£è¡¨æ–‡ä»¶æ‰€æœ‰è€…ï¼ˆownerï¼‰ã€æ‰€å±ç»„ï¼ˆgroupï¼‰å’Œå…¶ä»–äººï¼ˆothersï¼‰çš„è¯»ï¼ˆrï¼‰ã€å†™ï¼ˆwï¼‰å’Œæ‰§è¡Œï¼ˆxï¼‰æƒé™ã€‚ä¾‹å¦‚ï¼Œæƒé™ <code>rwxr-xr-x</code> è¡¨ç¤ºæ‰€æœ‰è€…æœ‰å…¨éƒ¨æƒé™ï¼Œæ‰€å±ç»„å’Œå…¶ä»–äººåªæœ‰è¯»å’Œæ‰§è¡Œæƒé™ã€‚</li><li><strong>ç‰¹æ®Šæƒé™ä½</strong>ï¼šé™¤äº†åŸºæœ¬çš„ 9 ä½æƒé™ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸‰ä¸ªç‰¹æ®Šæƒé™ä½ï¼šsetuidã€setgid å’Œ sticky bitã€‚</li><li><strong>æ–‡ä»¶ç±»å‹</strong>ï¼šæ–‡ä»¶çš„ç¬¬ä¸€ä¸ªå­—ç¬¦è¡¨ç¤ºæ–‡ä»¶ç±»å‹ï¼Œä¾‹å¦‚ <code>-</code> è¡¨ç¤ºæ™®é€šæ–‡ä»¶ï¼Œ<code>d</code> è¡¨ç¤ºç›®å½•ï¼Œ<code>l</code> è¡¨ç¤ºç¬¦å·é“¾æ¥ç­‰ã€‚</li></ul><p>å…·ä½“åˆ° <code>stats.mode</code> çš„å€¼ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ•´æ•°ï¼ŒåŒ…å«ä¸Šè¿°çš„æƒé™å’Œç±»å‹ä¿¡æ¯ã€‚ä¸ºäº†ç†è§£è¿™ä¸ªæ•°å­—ï¼Œé€šå¸¸ä¼šå°†å…¶è½¬æ¢æˆå…«è¿›åˆ¶å½¢å¼ï¼Œå› ä¸ºå…«è¿›åˆ¶è¡¨ç¤ºæ³•æ›´æ¸…æ¥šåœ°åæ˜ äº†ä¸åŒæƒé™ä½çš„è®¾ç½®ã€‚</p><p>ä¸¾ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥æ–¹å¼è·å–æ–‡ä»¶ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">An error occurred:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mode</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡ºå¯èƒ½æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œæ¯”å¦‚ 33206</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">((</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mode</span><span style="color:#81A1C1;"> &amp;</span><span style="color:#88C0D0;"> parseInt</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">777</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 8</span><span style="color:#D8DEE9FF;">))</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">8</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡ºç±»ä¼¼ &#39;644&#39; çš„å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åŒæ­¥æ–¹å¼è·å–æ–‡ä»¶ä¿¡æ¯</span></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mode</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åŒæ ·è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œæ¯”å¦‚ 33206</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">((</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mode</span><span style="color:#81A1C1;"> &amp;</span><span style="color:#88C0D0;"> parseInt</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">777</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 8</span><span style="color:#D8DEE9FF;">))</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">8</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åŒæ ·è¾“å‡ºç±»ä¼¼ &#39;644&#39; çš„å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">An error occurred:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>fs.stat</code> å’Œ <code>fs.statSync</code> éƒ½ç”¨äºè·å–æ–‡ä»¶ <code>example.txt</code> çš„ä¿¡æ¯ã€‚<code>stats.mode</code> å±æ€§åŒ…å«äº†æ–‡ä»¶çš„æƒé™å’Œç±»å‹ä¿¡æ¯ã€‚æˆ‘ä»¬ä½¿ç”¨æŒ‰ä½ä¸æ“ä½œ (<code>&amp;</code>) å’Œ <code>parseInt(&#39;777&#39;, 8)</code> æ¥ä»…æå–æƒé™éƒ¨åˆ†ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºæ›´æ˜“è¯»çš„å…«è¿›åˆ¶å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç»“æœæ˜¯ <code>&#39;644&#39;</code>ï¼Œåˆ™è¡¨ç¤ºæ‰€æœ‰è€…å…·æœ‰è¯»å†™æƒé™ï¼ˆ6ï¼‰ï¼Œè€Œç»„æˆå‘˜å’Œå…¶ä»–äººåªæœ‰è¯»æƒé™ï¼ˆ4ï¼‰ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯ <code>stats.mode</code> åœ¨ Node.js ä¸­çš„ç®€è¦ä»‹ç»å’Œä½¿ç”¨ç¤ºä¾‹ã€‚é€šè¿‡å®ƒï¼Œä½ èƒ½å¤Ÿäº†è§£æ–‡ä»¶çš„æƒé™å’Œç±»å‹ï¼Œè¿™å¯¹äºæ‰§è¡Œæ–‡ä»¶æ“ä½œå’Œç¡®ä¿åº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§éå¸¸é‡è¦ã€‚</p><h4 id="stats-nlink" tabindex="-1"><a class="header-anchor" href="#stats-nlink"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsnlink" target="_blank" rel="noopener noreferrer">stats.nlink</a></span></a></h4><p>å¥½çš„ï¼Œæ¥è°ˆè°ˆ Node.js ä¸­çš„ <code>stats.nlink</code>ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬å¾—çŸ¥é“ï¼ŒNode.js æ˜¯ä¸€ä¸ªèƒ½è®©ä½ ç”¨ JavaScript è¯­è¨€ç¼–å†™æœåŠ¡å™¨ç«¯ç¨‹åºçš„å¹³å°ã€‚å®ƒæä¾›äº†å¾ˆå¤šæ¨¡å—ï¼ˆmoduleï¼‰ï¼Œå…¶ä¸­ä¸€ä¸ªå«åš <code>fs</code>ï¼ˆfilesystemï¼‰ï¼Œè¿™ä¸ªæ¨¡å—è®©æˆ‘ä»¬å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šè¯»å†™æ–‡ä»¶ã€‚</p><p>å½“ä½ ä½¿ç”¨ <code>fs</code> æ¨¡å—ä¸­çš„å‡½æ•°æ¥è·å–æ–‡ä»¶ä¿¡æ¯æ—¶ï¼Œæ¯”å¦‚ <code>fs.stat()</code>, <code>fs.lstat()</code> æˆ– <code>fs.fstat()</code> è¿™äº›å‡½æ•°ï¼Œå®ƒä»¬ä¼šè¿”å›ä¸€ä¸ªå¸¦æœ‰å¾ˆå¤šå±æ€§çš„å¯¹è±¡ï¼Œè¿™å°±æ˜¯ <code>Stats</code> å¯¹è±¡ã€‚<code>Stats</code> å¯¹è±¡æä¾›äº†å…³äºæ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ã€‚</p><p>å…¶ä¸­ä¸€ä¸ªå±æ€§å°±æ˜¯ <code>nlink</code>ã€‚åœ¨ Unix ç±»æ“ä½œç³»ç»Ÿä¸­ï¼ˆæ¯”å¦‚ Linux å’Œ macOSï¼‰ï¼Œæ¯ä¸ªæ–‡ä»¶æˆ–ç›®å½•éƒ½æœ‰ä¸€ä¸ªå«åšé“¾æ¥æ•°ï¼ˆlink countï¼‰çš„ä¸œè¥¿ã€‚é“¾æ¥æ•°è¡¨ç¤ºæœ‰å¤šå°‘ä¸ªä¸åŒçš„è·¯å¾„æŒ‡å‘åŒä¸€ä¸ªæ–‡ä»¶ã€‚å¦‚æœä½ å¯¹ä¸€ä¸ªæ–‡ä»¶åˆ›å»ºäº†ç¡¬é“¾æ¥ï¼ˆhard linkï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶çš„é“¾æ¥æ•°å°±ä¼šå¢åŠ ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ç»™ä½ ä¸¾ä¸ªä¾‹å­ã€‚</p><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ªæ–‡ä»¶å«åš <code>myFile.txt</code>ï¼Œè€Œåœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªæ–‡ä»¶åªåˆ›å»ºäº†ä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰é¢å¤–çš„é“¾æ¥æŒ‡å‘å®ƒï¼Œé‚£ä¹ˆå®ƒçš„ <code>nlink</code> å€¼å°±æ˜¯ 1ã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è·å–æ–‡ä»¶ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">myFile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#616E88;">  // è¾“å‡ºé“¾æ¥æ•°</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">nlink</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡ºå¯èƒ½æ˜¯ 1</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨ï¼Œå¦‚æœä½ åˆ›å»ºäº†ä¸€ä¸ªæŒ‡å‘ <code>myFile.txt</code> çš„ç¡¬é“¾æ¥ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">ln</span><span style="color:#A3BE8C;"> myFile.txt</span><span style="color:#A3BE8C;"> myHardLink.txt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>é‚£ä¹ˆï¼Œ<code>myFile.txt</code> çš„é“¾æ¥æ•°ä¼šå˜æˆ 2ï¼Œå› ä¸ºç°åœ¨æœ‰ä¸¤ä¸ªè·¯å¾„æŒ‡å‘åŒä¸€ä¸ªæ–‡ä»¶ï¼šåŸå§‹çš„ <code>myFile.txt</code> å’Œæ–°å»ºçš„ç¡¬é“¾æ¥ <code>myHardLink.txt</code>ã€‚</p><p>å†æ¬¡è¿è¡Œå‰é¢çš„ Node.js è„šæœ¬ï¼Œä½ ä¼šå‘ç°è¾“å‡ºçš„ <code>nlink</code> å€¼å˜æˆäº† 2ã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">myFile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#616E88;">  // è¾“å‡ºé“¾æ¥æ•°</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">nlink</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // ç°åœ¨è¾“å‡ºå¯èƒ½æ˜¯ 2</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç®€å•æ¥è¯´ï¼Œ<code>stats.nlink</code> å°±æ˜¯å‘Šè¯‰ä½ æœ‰å¤šå°‘ä¸ªç¡¬é“¾æ¥æŒ‡å‘äº†è¿™ä¸ªæ–‡ä»¶ã€‚è¿™ä¸ªä¿¡æ¯å¯¹äºç†è§£æ–‡ä»¶ç³»ç»Ÿå’Œç®¡ç†æ–‡ä»¶æœ‰é‡è¦æ„ä¹‰ï¼Œå°¤å…¶æ˜¯åœ¨åšæ–‡ä»¶ç³»ç»Ÿåº•å±‚æ“ä½œæˆ–æ•°æ®å¤‡ä»½æ—¶ã€‚å› ä¸ºå½“ <code>nlink</code> é™åˆ° 0ï¼Œæ–‡ä»¶å®é™…æ‰€å ç”¨çš„ç©ºé—´æ‰ä¼šè¢«æ“ä½œç³»ç»Ÿé‡Šæ”¾ã€‚</p><h4 id="stats-uid" tabindex="-1"><a class="header-anchor" href="#stats-uid"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsuid" target="_blank" rel="noopener noreferrer">stats.uid</a></span></a></h4><p><code>stats.uid</code> æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—ä¸­ <code>fs.Stats</code> å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ã€‚åœ¨è®²è§£ <code>stats.uid</code> ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹ Node.js å’Œå®ƒçš„æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ã€‚</p><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚Node.js æä¾›äº†ä¸€ä¸ªä¸°å¯Œçš„æ ‡å‡†åº“ï¼Œå…¶ä¸­å°±åŒ…æ‹¬äº†ç”¨äºæ–‡ä»¶æ“ä½œçš„æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼ˆfs moduleï¼‰ã€‚</p><p>å½“ä½ åœ¨ Node.js ä¸­è¦è·å–ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„ä¿¡æ¯æ—¶ï¼Œä½ ä¼šä½¿ç”¨åˆ° fs æ¨¡å—çš„å‡½æ•°ï¼Œæ¯”å¦‚ <code>fs.stat()</code>, <code>fs.lstat()</code> æˆ–è€… <code>fs.fstat()</code>ã€‚è¿™äº›å‡½æ•°ç”¨æ¥å¼‚æ­¥åœ°è·å–æ–‡ä»¶æˆ–ç›®å½•çš„çŠ¶æ€ä¿¡æ¯ï¼Œå¹¶è¿”å›ä¸€ä¸ª <code>fs.Stats</code> å®ä¾‹ã€‚</p><p><code>fs.Stats</code> å®ä¾‹åŒ…å«äº†å…³äºæ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚å¤§å°ã€åˆ›å»ºæ—¶é—´å’Œä¿®æ”¹æ—¶é—´ç­‰ã€‚ä¸æ­¤åŒæ—¶ï¼Œ<code>stats.uid</code> å°±æ˜¯è¿™ä¸ªå®ä¾‹å¯¹è±¡ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒä»£è¡¨äº†è¯¥æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰è€…ç”¨æˆ· IDï¼ˆUser Identifierï¼‰ã€‚</p><p>åœ¨ Unix-like ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ UIDï¼Œè¿™ä¸ª UID ç”¨æ¥æ ‡è¯†å’ŒåŒºåˆ†ç³»ç»Ÿä¸Šçš„ä¸åŒç”¨æˆ·ã€‚å› æ­¤ï¼Œ<code>stats.uid</code> å°±æ˜¯å‘Šè¯‰ä½ è¿™ä¸ªæ–‡ä»¶æˆ–ç›®å½•å±äºå“ªä¸ªç”¨æˆ·çš„æ•°å­—æ ‡è¯†ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥çœ‹çœ‹ <code>stats.uid</code> æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨fs.stat()æ–¹æ³•è·å–æ–‡ä»¶çŠ¶æ€ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/your/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // è¾“å‡ºæ–‡ä»¶çš„ uid</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶æ‰€æœ‰è€…çš„ UID: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">uid</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† <code>fs</code> æ¨¡å—ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>fs.stat()</code> æ–¹æ³•å»å¼‚æ­¥åœ°è¯»å– &#39;file.txt&#39; æ–‡ä»¶çš„çŠ¶æ€ã€‚è¿™ä¸ªæ–¹æ³•çš„å›è°ƒå‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š<code>err</code> å’Œ <code>stats</code>ã€‚å¦‚æœå‡ºç°é”™è¯¯ï¼Œ<code>err</code> ä¼šè¢«è®¾ç½®ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ§åˆ¶å°æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚å¦‚æœæ²¡æœ‰é”™è¯¯å‘ç”Ÿï¼Œ<code>stats</code> å¯¹è±¡å°±ä¼šåŒ…å«æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ <code>stats.uid</code> è·å–å¹¶æ‰“å°å‡ºæ–‡ä»¶æ‰€æœ‰è€…çš„ UIDã€‚</p><p>è¯·æ³¨æ„ï¼ŒUID å¯¹äº Windows ç³»ç»Ÿæ¥è¯´å¯èƒ½æ²¡æœ‰å®é™…æ„ä¹‰ï¼Œå› ä¸º Windows çš„æƒé™ç®¡ç†å’Œç”¨æˆ·è¯†åˆ«æœºåˆ¶ä¸ Unix-like ç³»ç»Ÿä¸åŒã€‚</p><p>ä»¥ä¸Šå°±æ˜¯å¯¹ <code>stats.uid</code> å±æ€§çš„ä»‹ç»å’Œä¸€ä¸ªåŸºæœ¬çš„ä½¿ç”¨ç¤ºä¾‹ã€‚åœ¨å®é™…çš„å¼€å‘ä¸­ï¼Œä½ å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸ªå±æ€§æ¥æ£€æŸ¥æ–‡ä»¶çš„æ‰€æœ‰æƒï¼Œä»¥ç¡®å®šæ˜¯å¦åº”è¯¥è¿›è¡ŒæŸç§æ“ä½œï¼Œæ¯”å¦‚æ›´æ–°ã€åˆ é™¤æˆ–æ›´æ”¹æ–‡ä»¶æƒé™ã€‚</p><h4 id="stats-gid" tabindex="-1"><a class="header-anchor" href="#stats-gid"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsgid" target="_blank" rel="noopener noreferrer">stats.gid</a></span></a></h4><p><code>stats.gid</code>æ˜¯ Node.js <code>fs</code>æ¨¡å—ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒå±äº<code>fs.Stats</code>å¯¹è±¡ã€‚åœ¨ Node.js ä¸­ï¼Œå½“ä½ ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿ(fs)æ¨¡å—å»è·å–ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„ä¿¡æ¯æ—¶ï¼Œä½ å¯ä»¥é€šè¿‡è¿™ä¸ªå±æ€§è·å–åˆ°è¯¥æ–‡ä»¶æˆ–ç›®å½•çš„ç¾¤ç»„ IDï¼ˆGroup IDï¼‰ã€‚</p><p>åœ¨ Unix-like ç³»ç»Ÿï¼ˆå¦‚ Linux å’Œ macOSï¼‰ä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½æœ‰å…³è”çš„æƒé™å’Œæ‰€æœ‰æƒè®¾ç½®ï¼ŒåŒ…æ‹¬ä¸‰ä¸ªä¸»è¦çš„éƒ¨åˆ†ï¼šæ–‡ä»¶æ‰€æœ‰è€…çš„ç”¨æˆ· IDï¼ˆUIDï¼‰ï¼Œæ–‡ä»¶æ‰€å±ç¾¤ç»„çš„ç¾¤ç»„ IDï¼ˆGIDï¼‰ï¼Œä»¥åŠå…¶ä»–äººå¯¹è¯¥æ–‡ä»¶çš„è®¿é—®æƒé™ã€‚</p><h4 id="ä½•ä¸º-gid" tabindex="-1"><a class="header-anchor" href="#ä½•ä¸º-gid"><span>ä½•ä¸º GID</span></a></h4><p>ç¾¤ç»„ IDï¼ˆGIDï¼‰æ˜¯æ“ä½œç³»ç»Ÿç”¨æ¥è¯†åˆ«ä¸åŒç¾¤ç»„çš„æ•°å­—ã€‚åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œå¤šä¸ªç”¨æˆ·å¯èƒ½ä¼šè¢«å½’çº³åˆ°åŒä¸€ä¸ªç¾¤ç»„ï¼Œé€šå¸¸æ˜¯ä¸ºäº†ç®¡ç†æƒé™ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªâ€œå¼€å‘äººå‘˜â€ç¾¤ç»„çš„æˆå‘˜å¯èƒ½èƒ½è®¿é—®æºä»£ç å­˜å‚¨åº“ï¼Œè€Œâ€œé”€å”®å›¢é˜Ÿâ€åˆ™ä¸èƒ½ã€‚</p><h4 id="åœ¨-node-js-ä¸­ä½¿ç”¨stats-gid" tabindex="-1"><a class="header-anchor" href="#åœ¨-node-js-ä¸­ä½¿ç”¨stats-gid"><span>åœ¨ Node.js ä¸­ä½¿ç”¨<code>stats.gid</code></span></a></h4><p>åœ¨ Node.js ä¸­ï¼Œå½“ä½ æƒ³è¦è·å¾—ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„å…ƒæ•°æ®æ—¶ï¼Œä½ ä¼šä½¿ç”¨ fs æ¨¡å—æä¾›çš„å‡½æ•°ï¼Œå¦‚<code>fs.stat()</code>ã€<code>fs.statSync()</code>æˆ–è€…å¼‚æ­¥ç‰ˆæœ¬<code>fs.promises.stat()</code>ã€‚å½“ä½ è°ƒç”¨è¿™äº›å‡½æ•°å¹¶ä¼ å…¥æ–‡ä»¶è·¯å¾„æ—¶ï¼Œè¿”å›çš„<code>fs.Stats</code>å¯¹è±¡ä¸­å°±åŒ…å«äº†<code>gid</code>å±æ€§ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæ¼”ç¤ºå¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨<code>fs.statSync()</code>æ¥è·å–æ–‡ä»¶çš„ç¾¤ç»„ IDï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // åŒæ­¥åœ°è·å–æ–‡ä»¶çŠ¶æ€</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path/to/your/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // è¾“å‡ºæ–‡ä»¶çš„ç¾¤ç»„ID</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Group ID: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">gid</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">  // å¦‚æœæœ‰é”™è¯¯ï¼Œä¾‹å¦‚æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ‰“å°å‡ºé”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error getting file stats:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä½ æ­£åœ¨å¤„ç†å¼‚æ­¥ä»£ç ï¼Œå¯èƒ½ä¼šæ›´å€¾å‘äºä½¿ç”¨<code>fs.promises.stat()</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> getFileGroupID</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // å¼‚æ­¥åœ°è·å–æ–‡ä»¶çŠ¶æ€</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // è¾“å‡ºæ–‡ä»¶çš„ç¾¤ç»„ID</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Group ID: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">gid</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // å¦‚æœæœ‰é”™è¯¯ï¼Œä¾‹å¦‚æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™æ‰“å°å‡ºé”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error getting file stats:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨ä¸Šè¿°å‡½æ•°ï¼Œå¹¶ä¼ å…¥æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#88C0D0;">getFileGroupID</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path/to/your/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å®é™…è¿ç”¨çš„ä¾‹å­-11" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-11"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h4><ul><li><strong>è®¿é—®æ§åˆ¶</strong>ï¼šåœ¨ç¼–å†™æ¶‰åŠæ–‡ä»¶æ“ä½œçš„åº”ç”¨ç¨‹åºæ—¶ï¼Œä½ å¯èƒ½éœ€è¦æ ¹æ®ç”¨æˆ·çš„ç¾¤ç»„æ¥å…è®¸æˆ–ç¦æ­¢å¯¹æŸäº›æ–‡ä»¶çš„æ“ä½œã€‚</li><li><strong>å®‰å…¨å®¡è®¡</strong>ï¼šå¦‚æœä½ æ­£åœ¨æ„å»ºä¸€æ¬¾å®‰å…¨æ€§ç›¸å…³çš„å·¥å…·ï¼Œä½ å¯èƒ½éœ€è¦æ£€æŸ¥æ–‡ä»¶çš„ GID æ¥ç¡®è®¤æ˜¯å¦ç¬¦åˆç‰¹å®šçš„å®‰å…¨ç­–ç•¥ã€‚</li><li><strong>æ–‡ä»¶ç®¡ç†å·¥å…·</strong>ï¼šåœ¨åˆ›å»ºæ–‡ä»¶æµè§ˆå™¨æˆ–ç±»ä¼¼å·¥å…·æ—¶ï¼Œä½ å¯èƒ½éœ€è¦æ˜¾ç¤ºæ–‡ä»¶çš„æ‰€æœ‰æƒä¿¡æ¯ï¼Œå…¶ä¸­å°±åŒ…æ‹¬ç¾¤ç»„ IDã€‚</li></ul><p>æ€»ä¹‹ï¼Œ<code>stats.gid</code>ä¸ºä½ æä¾›äº†ä¸€ä¸ªé‡è¦çš„æ–‡ä»¶æ‰€æœ‰æƒå±æ€§ï¼Œä½ å¯ä»¥åˆ©ç”¨å®ƒåœ¨ Node.js åº”ç”¨ä¸­å®ç°æ›´ç²¾ç»†çš„è®¿é—®æ§åˆ¶å’Œç®¡ç†åŠŸèƒ½ã€‚</p><h4 id="stats-rdev" tabindex="-1"><a class="header-anchor" href="#stats-rdev"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsrdev" target="_blank" rel="noopener noreferrer">stats.rdev</a></span></a></h4><p>åœ¨ Node.js ä¸­ï¼Œ<code>stats.rdev</code>æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå®ƒä¸æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—çš„æŸäº›åŠŸèƒ½ç´§å¯†ç›¸å…³ã€‚ä¸ºäº†ç†è§£<code>stats.rdev</code>ï¼Œè®©æˆ‘ä»¬å…ˆä»ä¸€äº›åŸºæœ¬æ¦‚å¿µå¼€å§‹ã€‚</p><h3 id="æ–‡ä»¶ç³»ç»Ÿ-file-system-1" tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶ç³»ç»Ÿ-file-system-1"><span>æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰</span></a></h3><p>æ–‡ä»¶ç³»ç»Ÿæ˜¯æ“ä½œç³»ç»Ÿç”¨æ¥ç®¡ç†å’Œå­˜å‚¨æ–‡ä»¶çš„ä¸€ç§æ–¹æ³•ã€‚å®ƒå…è®¸ä½ åˆ›å»ºã€åˆ é™¤ã€è¯»å–ã€å†™å…¥æ–‡ä»¶ç­‰ã€‚Node.js é€šè¿‡å…¶<code>fs</code>æ¨¡å—æä¾›äº†ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„èƒ½åŠ›ï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶çš„ä¿¡æ¯ã€‚</p><h3 id="fs-stats-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#fs-stats-å¯¹è±¡"><span><code>fs.Stats</code> å¯¹è±¡</span></a></h3><p>å½“ä½ åœ¨ Node.js ä¸­ä½¿ç”¨<code>fs</code>æ¨¡å—è·å–æ–‡ä»¶çš„ä¿¡æ¯æ—¶ï¼ˆä¾‹å¦‚ä½¿ç”¨<code>fs.stat()</code>ã€<code>fs.statSync()</code>ã€<code>fs.promises.stat()</code>ç­‰æ–¹æ³•ï¼‰ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ª<code>fs.Stats</code>å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åŒ…å«äº†å…³äºæ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ¯”å¦‚æ–‡ä»¶å¤§å°ï¼ˆ<code>size</code>ï¼‰ã€åˆ›å»ºæ—¶é—´ï¼ˆ<code>birthtime</code>ï¼‰ç­‰ç­‰ã€‚</p><h3 id="rdev-å±æ€§" tabindex="-1"><a class="header-anchor" href="#rdev-å±æ€§"><span>rdev å±æ€§</span></a></h3><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥èŠèŠ<code>stats.rdev</code>ã€‚<code>rdev</code>æ˜¯<code>fs.Stats</code>å¯¹è±¡ä¸Šçš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒç‰¹åˆ«ç”¨äºè¡¨ç¤ºè®¾å¤‡æ–‡ä»¶çš„è®¾å¤‡ç¼–å·ã€‚</p><p>é¦–å…ˆï¼Œäº†è§£ä»€ä¹ˆæ˜¯è®¾å¤‡æ–‡ä»¶å¾ˆé‡è¦ã€‚åœ¨ Unix å’Œç±» Unix ç³»ç»Ÿï¼ˆæ¯”å¦‚ Linux å’Œ macOSï¼‰ä¸­ï¼Œè®¾å¤‡æ–‡ä»¶æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ–‡ä»¶ï¼Œå®ƒè¡¨ç¤ºæˆ–æä¾›å¯¹ç¡¬ä»¶è®¾å¤‡çš„è®¿é—®ã€‚æ¯”å¦‚ï¼š</p><ul><li>å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼ˆå¦‚é”®ç›˜ã€é¼ æ ‡ï¼‰ï¼šå…è®¸é€å­—ç¬¦çš„æ•°æ®ä¼ è¾“ã€‚</li><li>å—è®¾å¤‡æ–‡ä»¶ï¼ˆå¦‚ç¡¬ç›˜ã€USB é©±åŠ¨å™¨ï¼‰ï¼šå…è®¸ä»¥æ•°æ®å—çš„å½¢å¼è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚</li></ul><p><code>rdev</code>å±æ€§å°±æ˜¯ç”¨æ¥å­˜å‚¨è¿™äº›è®¾å¤‡æ–‡ä»¶çš„â€œè®¾å¤‡ IDâ€ã€‚ä½†æ˜¯ï¼Œå¯¹äºæ™®é€šçš„éè®¾å¤‡æ–‡ä»¶ï¼ˆæ¯”å¦‚æ–‡æ¡£ã€å›¾ç‰‡ç­‰ï¼‰ï¼Œ<code>rdev</code>çš„å€¼é€šå¸¸æ˜¯<code>0</code>ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-27" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-27"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>è™½ç„¶ç›´æ¥ä½¿ç”¨<code>stats.rdev</code>çš„åœºæ™¯ç›¸å¯¹å°‘è§ï¼Œäº†è§£å®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å…¨é¢åœ°ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå±•ç¤ºå¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨<code>fs.stat()</code>æ–¹æ³•æ¥è·å–æ–‡ä»¶çš„<code>rdev</code>å€¼ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨å¼‚æ­¥æ–¹å¼è·å–æ–‡ä»¶çŠ¶æ€</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/your/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è·å–æ–‡ä»¶çŠ¶æ€å¤±è´¥</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // è¾“å‡ºrdevå€¼</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">rdev: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">rdev</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé™¤éä½ æ­£åœ¨å¼€å‘ä¸æ“ä½œç³»ç»Ÿåº•å±‚æˆ–ç¡¬ä»¶ç›´æ¥äº¤äº’çš„åº”ç”¨ï¼Œå¦åˆ™ä½ å¯èƒ½ä¸ä¼šç›´æ¥ä½¿ç”¨åˆ°<code>stats.rdev</code>ã€‚ç„¶è€Œï¼Œå¯¹äºç†è§£ Node.js æä¾›çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„æ·±åº¦å’Œå¹¿åº¦æ¥è¯´ï¼ŒçŸ¥é“å®ƒçš„å­˜åœ¨å’Œæ„ä¹‰æ˜¯æœ‰å¸®åŠ©çš„ã€‚</p><h4 id="stats-size" tabindex="-1"><a class="header-anchor" href="#stats-size"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statssize" target="_blank" rel="noopener noreferrer">stats.size</a></span></a></h4><p>ç¡®å®ï¼Œè®©æˆ‘ä»¬æ¥èŠèŠ Node.js ä¸­çš„ <code>stats.size</code>ã€‚é¦–å…ˆï¼ŒNode.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚<code>fs</code> ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰æ¨¡å—æ˜¯ Node.js ä¸­ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„å†…ç½®æ¨¡å—ä¹‹ä¸€ï¼Œæä¾›äº†å¾ˆå¤šéå¸¸æœ‰ç”¨çš„æ–¹æ³•æ¥è¯»å–ã€å†™å…¥å’Œå¤„ç†æ–‡ä»¶ã€‚</p><h3 id="stats-size-1" tabindex="-1"><a class="header-anchor" href="#stats-size-1"><span>stats.size</span></a></h3><p>åœ¨ <code>fs</code> æ¨¡å—ä¸­ï¼Œ<code>stats</code> å¯¹è±¡æä¾›äº†å…³äºæ–‡ä»¶æˆ–ç›®å½•çš„ä¿¡æ¯ã€‚å½“ä½ ä½¿ç”¨ <code>fs.stat()</code>, <code>fs.statSync()</code> æˆ–å®ƒä»¬çš„å˜ç§æ—¶ï¼Œå¯ä»¥è·å–åˆ°ä¸€ä¸ª <code>stats</code> å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åŒ…å«äº†å¾ˆå¤šå±æ€§ï¼Œå…¶ä¸­ <code>size</code> å±æ€§å°±æ˜¯ç”¨æ¥è¡¨ç¤ºæ–‡ä»¶çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰çš„ã€‚</p><p>ç®€å•æ¥è¯´ï¼Œå¦‚æœä½ æƒ³çŸ¥é“ä¸€ä¸ªæ–‡ä»¶æœ‰å¤šå¤§ï¼Œå°±å¯ä»¥é€šè¿‡æ£€æŸ¥ <code>stats.size</code> æ¥å¾—çŸ¥ã€‚</p><h4 id="ç¤ºä¾‹-7" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-7"><span>ç¤ºä¾‹</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º &quot;example.txt&quot; çš„æ–‡æœ¬æ–‡ä»¶ï¼Œæˆ‘ä»¬æƒ³è¦è·å–è¿™ä¸ªæ–‡ä»¶çš„å¤§å°ã€‚ä¸‹é¢æ˜¯å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹çš„æ­¥éª¤ï¼š</p><ol><li><strong>å¼•å…¥ FS æ¨¡å—</strong>ï¼šé¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ Node.js çš„ <code>fs</code> æ¨¡å—ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li><strong>ä½¿ç”¨ fs.stat æˆ– fs.statSync æ–¹æ³•</strong>ï¼šè¿™äº›æ–¹æ³•ç”¨æ¥å¼‚æ­¥æˆ–åŒæ­¥åœ°è·å–æ–‡ä»¶çš„ç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–‡ä»¶å¤§å°ã€‚</li></ol><ul><li>å¼‚æ­¥ç‰ˆæœ¬ï¼š</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">An error occurred:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">The file size is </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">size</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> bytes.</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>åŒæ­¥ç‰ˆæœ¬ï¼š</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">The file size is </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">size</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> bytes.</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">An error occurred:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸¤æ®µä»£ç éƒ½ä¼šè¾“å‡º &quot;example.txt&quot; æ–‡ä»¶çš„å¤§å°ï¼Œåªä¸è¿‡ä¸€ä¸ªæ˜¯å¼‚æ­¥å¤„ç†çš„ï¼Œå¦ä¸€ä¸ªæ˜¯åŒæ­¥å¤„ç†çš„ï¼ˆå³ç«‹å³å¾—åˆ°ç»“æœï¼‰ã€‚</p><h3 id="å®é™…è¿ç”¨-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨-4"><span>å®é™…è¿ç”¨</span></a></h3><p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œäº†è§£æ–‡ä»¶çš„å¤§å°éå¸¸é‡è¦ï¼š</p><ul><li><strong>é¢„ä¼°å­˜å‚¨éœ€æ±‚</strong>ï¼šå¦‚æœä½ çš„åº”ç”¨æ¶‰åŠåˆ°å¤§é‡æ–‡ä»¶å­˜å‚¨ï¼Œäº†è§£å„ä¸ªæ–‡ä»¶çš„å¤§å°å¯ä»¥å¸®åŠ©é¢„ä¼°æ€»ä½“å­˜å‚¨éœ€æ±‚ã€‚</li><li><strong>ç”¨æˆ·ä¸Šä¼ é™åˆ¶</strong>ï¼šåœ¨ç½‘ç«™ä¸­ï¼Œä½ å¯èƒ½éœ€è¦é™åˆ¶ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶çš„å¤§å°ï¼Œæ­¤æ—¶è·å–æ–‡ä»¶å¤§å°å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚</li><li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šæŸäº›æƒ…å†µä¸‹ï¼Œå¯¹äºç‰¹åˆ«å¤§æˆ–ç‰¹åˆ«å°çš„æ–‡ä»¶ï¼Œä½ å¯èƒ½ä¼šé€‰æ‹©ä¸åŒçš„å¤„ç†æ–¹å¼ä»¥ä¼˜åŒ–æ€§èƒ½ã€‚</li></ul><p>é€šè¿‡ä½¿ç”¨ Node.js çš„ <code>fs</code> æ¨¡å—å’Œ <code>stats.size</code> å±æ€§ï¼Œå¼€å‘è€…èƒ½å¤Ÿåœ¨å¿…è¦æ—¶è½»æ˜“åœ°è·å–å¹¶åˆ©ç”¨æ–‡ä»¶å¤§å°ä¿¡æ¯ã€‚</p><h4 id="stats-blksize" tabindex="-1"><a class="header-anchor" href="#stats-blksize"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsblksize" target="_blank" rel="noopener noreferrer">stats.blksize</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„ JavaScript ç¯å¢ƒï¼Œå¹¿æ³›ç”¨äºåˆ›å»ºé«˜æ€§èƒ½çš„ç½‘ç»œåº”ç”¨ã€‚<code>fs</code> æ¨¡å—å°±æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªå†…ç½®æ¨¡å—ï¼Œå®ƒç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚è¿™åŒ…æ‹¬è¯»å–æ–‡ä»¶ã€å†™å…¥æ–‡ä»¶ã€æ›´æ”¹æ–‡ä»¶å±æ€§ç­‰ã€‚</p><p>åœ¨ <code>fs</code> æ¨¡å—ä¸­ï¼Œæœ‰å¾ˆå¤šå‡½æ•°å¯ä»¥è·å–æ–‡ä»¶æˆ–ç›®å½•çš„ä¿¡æ¯ï¼Œå®ƒä»¬é€šå¸¸è¿”å›ä¸€ä¸ª <code>fs.Stats</code> å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åŒ…å«äº†æ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ¯”å¦‚å¤§å°ï¼ˆsizeï¼‰ã€åˆ›å»ºæ—¶é—´ï¼ˆctimeï¼‰ã€ä¿®æ”¹æ—¶é—´ï¼ˆmtimeï¼‰ç­‰ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥èŠèŠä½ æåˆ°çš„ <code>stats.blksize</code>ã€‚è¿™æ˜¯ <code>fs.Stats</code> å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œè¡¨ç¤ºæ–‡ä»¶ç³»ç»Ÿä¸­ä½¿ç”¨çš„â€œå—â€å¤§å°ï¼Œå•ä½æ˜¯å­—èŠ‚ã€‚åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œâ€œå—â€æ˜¯å­˜å‚¨æ•°æ®çš„åŸºæœ¬å•ä½ã€‚æ“ä½œç³»ç»Ÿåœ¨å¤„ç†æ–‡ä»¶æ—¶é€šå¸¸ä¼šä»¥å—ä¸ºå•ä½è¿›è¡Œè¯»å†™ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚åœ°æ“ä½œã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-12" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-12"><span>å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</span></a></h3><p>å‡è®¾ä½ æ­£ç¼–å†™ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œè¯¥ç¨‹åºéœ€è¦é«˜æ•ˆåœ°å¤„ç†å¤§é‡æ•°æ®ã€‚çŸ¥é“æ–‡ä»¶çš„å—å¤§å°å¯ä»¥å¸®åŠ©ä½ ä¼˜åŒ–è¯»å†™æ“ä½œã€‚</p><h4 id="å®ä¾‹-1-è¯»å–æ–‡ä»¶çš„å—å¤§å°" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-1-è¯»å–æ–‡ä»¶çš„å—å¤§å°"><span>å®ä¾‹ 1ï¼šè¯»å–æ–‡ä»¶çš„å—å¤§å°</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è·å–æŸä¸ªæ–‡ä»¶çš„çŠ¶æ€</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#616E88;">  // è¾“å‡ºå—å¤§å°</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Block Size: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">blksize</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯¼å…¥äº† <code>fs</code> æ¨¡å—ï¼Œå¹¶é€šè¿‡ <code>fs.stat</code> å‡½æ•°å¼‚æ­¥åœ°è·å–åä¸º <code>example.txt</code> æ–‡ä»¶çš„çŠ¶æ€ã€‚å›è°ƒå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯å‘ç”Ÿï¼Œå¦‚æœæ²¡æœ‰åˆ™æ‰“å°å‡ºè¯¥æ–‡ä»¶çš„å—å¤§å°ã€‚</p><h4 id="å®ä¾‹-2-ä½¿ç”¨å—å¤§å°æ¥ä¼˜åŒ–æ•°æ®è¯»å–" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-2-ä½¿ç”¨å—å¤§å°æ¥ä¼˜åŒ–æ•°æ®è¯»å–"><span>å®ä¾‹ 2ï¼šä½¿ç”¨å—å¤§å°æ¥ä¼˜åŒ–æ•°æ®è¯»å–</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">bigfile.dat</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> blockSize</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">blksize</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">blockSize</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // æ‰“å¼€æ–‡ä»¶å‡†å¤‡è¯»å–</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">bigfile.dat</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      return;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // è¯»å–ä¸€ä¸ªå—çš„æ•°æ®</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> blockSize</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> null</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        return;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">      // å¤„ç†è¯»å–åˆ°çš„æ•°æ®</span></span>
<span class="line"><span style="color:#88C0D0;">      processBuffer</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">      // å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">      fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">          console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> processBuffer</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Read </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">bytesRead</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> bytes of data.</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // è¿™é‡Œå¯ä»¥æ·»åŠ æ›´å¤šé€»è¾‘æ¥å¤„ç†ç¼“å†²åŒºé‡Œçš„æ•°æ®</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè·å–ä¸€ä¸ªå¤§æ–‡ä»¶ <code>bigfile.dat</code> çš„çŠ¶æ€ï¼Œç„¶åæ ¹æ®å…¶å—å¤§å°åˆ›å»ºäº†ä¸€ä¸ªç¼“å†²åŒºã€‚ä¹‹åï¼Œæˆ‘ä»¬æ‰“å¼€æ–‡ä»¶å¹¶è¯»å–ä¸€ä¸ªå—çš„å¤§å°ã€‚è¯»å–å®Œæˆåï¼Œæˆ‘ä»¬å°†æ•°æ®ä¼ é€’ç»™ä¸€ä¸ªå¤„ç†å‡½æ•°ï¼Œæœ€åå…³é—­æ–‡ä»¶ã€‚</p><p>è¿™æ ·ä½¿ç”¨å—å¤§å°å¯ä»¥ä½¿å¾—æ–‡ä»¶è¯»å–æ›´åŠ é«˜æ•ˆï¼Œå› ä¸ºå®ƒéµå¾ªäº†æ–‡ä»¶ç³»ç»Ÿçš„æœ€ä½³å®è·µï¼Œå‡å°‘äº†æ“ä½œç³»ç»Ÿçš„å¼€é”€ã€‚</p><p>è¦æ³¨æ„çš„æ˜¯ï¼Œä¸æ˜¯æ‰€æœ‰æƒ…å†µä¸‹éƒ½éœ€è¦å…³å¿ƒ <code>blksize</code>ã€‚å¯¹äºä¸åŒçš„åº”ç”¨åœºæ™¯å’Œæ“ä½œç³»ç»Ÿï¼Œé»˜è®¤çš„ I/O æ“ä½œå·²ç»éå¸¸é«˜æ•ˆã€‚è¿™ä¸ªå±æ€§æ›´å¤šåœ°æ˜¯ç”¨äºé‚£äº›éœ€è¦å¾®è°ƒæ€§èƒ½çš„ç‰¹å®šåœºå†µã€‚</p><h4 id="stats-blocks" tabindex="-1"><a class="header-anchor" href="#stats-blocks"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsblocks" target="_blank" rel="noopener noreferrer">stats.blocks</a></span></a></h4><p><code>stats.blocks</code> æ˜¯ Node.js ä¸­æ–‡ä»¶ç³»ç»Ÿæ¨¡å—<code>fs</code>çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒå±äº<code>fs.Stats</code>å¯¹è±¡ã€‚å½“ä½ ä½¿ç”¨ Node.js çš„<code>fs</code>æ¨¡å—è·å–æ–‡ä»¶æˆ–ç›®å½•çš„ç»Ÿè®¡ä¿¡æ¯æ—¶ï¼ˆæ¯”å¦‚ä½¿ç”¨<code>fs.stat()</code>, <code>fs.lstat()</code>æˆ–<code>fs.fstat()</code>æ–¹æ³•ï¼‰ï¼Œè¿”å›çš„å¯¹è±¡å°±æ˜¯ä¸€ä¸ª<code>fs.Stats</code>å®ä¾‹ã€‚è¿™ä¸ªå®ä¾‹ä¸­åŒ…å«äº†å¾ˆå¤šå…³äºæ–‡ä»¶æˆ–ç›®å½•çš„ä¿¡æ¯ï¼Œä¾‹å¦‚æ–‡ä»¶å¤§å°ã€åˆ›å»ºæ—¶é—´ç­‰ã€‚</p><p>å…¶ä¸­<code>stats.blocks</code>å±æ€§è¡¨ç¤ºåˆ†é…ç»™æ–‡ä»¶çš„ 512B å¤§å°çš„å—çš„æ•°é‡ã€‚&quot;å—&quot;æ˜¯æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨æ–‡ä»¶æ—¶ä½¿ç”¨çš„æ•°æ®å•ä½ï¼Œä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿå¯èƒ½æœ‰ä¸åŒçš„å—å¤§å°ï¼Œä½†åœ¨<code>fs.Stats</code>å¯¹è±¡ä¸­ï¼Œä¸€ä¸ªå—ç»Ÿä¸€è¢«è§†ä¸º 512 å­—èŠ‚ã€‚<code>stats.blocks</code>å±æ€§å‘Šè¯‰ä½ è¯¥æ–‡ä»¶å ç”¨äº†å¤šå°‘è¿™æ ·çš„å—ã€‚</p><p>è¿™ä¸ªå±æ€§é€šå¸¸ä¸ç£ç›˜ä½¿ç”¨æƒ…å†µç›¸å…³ï¼Œå› ä¸ºå³ä½¿æ–‡ä»¶å†…å®¹æ²¡æœ‰å¡«æ»¡æ•´ä¸ªå—ï¼Œæ–‡ä»¶ç³»ç»Ÿä¾ç„¶ä¼šåˆ†é…æ•´ä¸ªå—ç»™è¿™ä¸ªæ–‡ä»¶ã€‚è¿™æ„å‘³ç€ä¸€ä¸ªéå¸¸å°çš„æ–‡ä»¶ä¹Ÿå¯èƒ½æ˜¾ç¤ºä¸ºå ç”¨å¤šä¸ªå—ï¼Œä»è€Œå ç”¨äº†æ›´å¤šçš„ç£ç›˜ç©ºé—´ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-13" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-13"><span>å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œéœ€è¦æ£€æŸ¥æŸä¸ªæ–‡ä»¶å ç”¨äº†å¤šå°‘ç£ç›˜ç©ºé—´ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç æ®µæ¥å®ç°è¿™ä¸ªåŠŸèƒ½ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨fs.stat()æ–¹æ³•è·å–æ–‡ä»¶çš„ç»Ÿè®¡ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‡ºé”™äº†</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // è¾“å‡ºåˆ†é…ç»™æ–‡ä»¶çš„å—çš„æ•°é‡</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">åˆ†é…ç»™æ–‡ä»¶çš„å—çš„æ•°é‡ï¼š</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">blocks</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // è®¡ç®—å¹¶è¾“å‡ºå®é™…å ç”¨çš„ç£ç›˜ç©ºé—´ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰</span></span>
<span class="line"><span style="color:#81A1C1;">    let</span><span style="color:#D8DEE9;"> actualSize</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">blocks</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 512</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶å®é™…å ç”¨çš„ç£ç›˜ç©ºé—´ï¼ˆå­—èŠ‚ï¼‰ï¼š</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">actualSize</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº†<code>fs</code>æ¨¡å—ï¼Œç„¶åä½¿ç”¨<code>fs.stat()</code>å‡½æ•°æ¥å¼‚æ­¥è·å–åä¸º<code>example.txt</code>çš„æ–‡ä»¶çš„ç»Ÿè®¡ä¿¡æ¯ã€‚è¿™ä¸ªå‡½æ•°æ‰§è¡ŒæˆåŠŸæ—¶ä¼šè¿”å›ä¸€ä¸ª<code>fs.Stats</code>å¯¹è±¡ï¼Œåœ¨å›è°ƒå‡½æ•°é‡Œï¼Œæˆ‘ä»¬é€šè¿‡è®¿é—®<code>stats.blocks</code>å±æ€§æ¥çŸ¥é“æ–‡ä»¶å ç”¨äº†å¤šå°‘å—ï¼Œå¹¶å°†å…¶ä¹˜ä»¥ 512 å¾—åˆ°å®é™…å ç”¨çš„ç£ç›˜ç©ºé—´å¤§å°ï¼Œæœ€åå°†è¿™ä¸ªç»“æœæ‰“å°å‡ºæ¥ã€‚å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œæˆ‘ä»¬ä¼šåœ¨æ§åˆ¶å°ä¸­æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚</p><p>è¯·æ³¨æ„ï¼Œä¸Šé¢çš„ä»£ç ç¤ºä¾‹ä½¿ç”¨äº† Node.js çš„å¼‚æ­¥ API å’Œå›è°ƒå‡½æ•°ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§é‡æ–‡ä»¶æˆ–éœ€è¦æ›´å¥½çš„é”™è¯¯å¤„ç†æ—¶ï¼Œå¯èƒ½ä¼šä½¿ç”¨<code>Promise</code>æˆ–<code>async/await</code>è¯­æ³•æ¥æ”¹è¿›ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯è¯»æ€§ã€‚</p><h4 id="stats-atimems" tabindex="-1"><a class="header-anchor" href="#stats-atimems"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsatimems" target="_blank" rel="noopener noreferrer">stats.atimeMs</a></span></a></h4><p><code>stats.atimeMs</code> æ˜¯ Node.js æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒç»™å‡ºäº†æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æ—¶é—´ï¼ˆaccess timeï¼‰çš„æ¯«ç§’è¡¨ç¤ºã€‚åœ¨ Node.js ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡ <code>fs</code> æ¨¡å—è·å–æ–‡ä»¶æˆ–è€…ç›®å½•çš„å…ƒä¿¡æ¯ï¼Œè¿™é€šå¸¸æ˜¯é€šè¿‡ä¸€ä¸ªå«åš <code>fs.Stats</code> çš„å¯¹è±¡æ¥å®Œæˆçš„ã€‚</p><p>å½“ä½ è°ƒç”¨åƒ <code>fs.stat()</code>, <code>fs.lstat()</code> æˆ–è€… <code>fs.fstat()</code> è¿™æ ·çš„å‡½æ•°æ—¶ï¼ŒNode.js ä¼šè¿”å›ä¸€ä¸ª <code>fs.Stats</code> å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº†å…³äºæ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ã€‚è¿™ä¸ªå¯¹è±¡æœ‰å¾ˆå¤šå±æ€§ï¼Œ<code>atimeMs</code> å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯è®¿é—®æ—¶é—´-access-time" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯è®¿é—®æ—¶é—´-access-time"><span>ä»€ä¹ˆæ˜¯è®¿é—®æ—¶é—´ï¼ˆAccess Timeï¼‰ï¼Ÿ</span></a></h3><p>è®¿é—®æ—¶é—´æŒ‡çš„æ˜¯æ–‡ä»¶æˆ–ç›®å½•æœ€åè¢«è®¿é—®çš„æ—¶é—´ç‚¹ã€‚&quot;è®¿é—®&quot;é€šå¸¸æ„å‘³ç€æ–‡ä»¶æ•°æ®è¢«è¯»å–ï¼Œä½†ä¸åŒ…æ‹¬æ–‡ä»¶çš„å…ƒæ•°æ®ï¼ˆæ¯”å¦‚æƒé™ã€æ‰€æœ‰æƒç­‰ï¼‰çš„å˜æ›´ã€‚ä¾‹å¦‚ï¼Œå½“ä½ æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ¥é˜…è¯»å†…å®¹ï¼Œé‚£ä¹ˆè¯¥æ–‡ä»¶çš„è®¿é—®æ—¶é—´å°±ä¼šæ›´æ–°ã€‚</p><h3 id="stats-atimems-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#stats-atimems-ç®€ä»‹"><span><code>stats.atimeMs</code> ç®€ä»‹</span></a></h3><p><code>stats.atimeMs</code> å±æ€§æä¾›äº†ä¸€ä¸ª Unix æ—¶é—´æˆ³ï¼Œå•ä½æ˜¯æ¯«ç§’ã€‚Unix æ—¶é—´æˆ³æ˜¯è‡ª 1970 å¹´ 1 æœˆ 1 æ—¥ UTC ä»¥æ¥çš„æ¯«ç§’æ•°ï¼Œå› æ­¤ <code>stats.atimeMs</code> æä¾›çš„å€¼å¯ä»¥è½¬æ¢ä¸ºäººç±»å¯è¯»çš„æ—¥æœŸå’Œæ—¶é—´ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-stats-atimems" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-stats-atimems"><span>å¦‚ä½•ä½¿ç”¨ <code>stats.atimeMs</code></span></a></h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ <code>stats.atimeMs</code> æ¥è·å–æ–‡ä»¶è®¿é—®æ—¶é—´çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨å¼‚æ­¥æ–¹å¼è·å–æ–‡ä»¶çŠ¶æ€ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // è¾“å‡º atimeMs</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶è®¿é—®æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">atimeMs</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å°†æ¯«ç§’è½¬æ¢ä¸ºæ—¥æœŸæ ¼å¼è¾“å‡º</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> accessTime</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">atimeMs</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶è®¿é—®æ—¶é—´ï¼ˆæ—¥æœŸï¼‰: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">accessTime</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† Node.js çš„ <code>fs</code> æ¨¡å—ç„¶åä½¿ç”¨äº† <code>fs.stat()</code> å‡½æ•°æ¥è·å–åä¸º &#39;example.txt&#39; çš„æ–‡ä»¶çš„çŠ¶æ€ã€‚è¿™ä¸ªå‡½æ•°æ˜¯å¼‚æ­¥çš„ï¼Œè¿™æ„å‘³ç€å®ƒä¸ä¼šç«‹å³è¿”å›ç»“æœï¼Œè€Œæ˜¯åœ¨æ“ä½œå®Œæˆåè°ƒç”¨ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚æˆ‘ä»¬æä¾›çš„è¿™ä¸ªå›è°ƒå‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªé”™è¯¯å¯¹è±¡ <code>err</code> å’Œä¸€ä¸ª <code>fs.Stats</code> å¯¹è±¡ <code>stats</code>ã€‚</p><p>å¦‚æœæ“ä½œæˆåŠŸï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>stats.atimeMs</code> å¾—åˆ°æ–‡ä»¶çš„è®¿é—®æ—¶é—´çš„æ¯«ç§’è¡¨ç¤ºã€‚ä¸ºäº†ä¾¿äºç†è§£ï¼Œæˆ‘ä»¬è¿˜å°†è¿™ä¸ªæ¯«ç§’å€¼è½¬æ¢æˆäº†ä¸€ä¸ª <code>Date</code> å¯¹è±¡ï¼Œå¹¶ä¸”æ‰“å°å‡ºäº†å¯¹åº”çš„æ—¥æœŸå’Œæ—¶é—´ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-25" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-25"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>æ–‡ä»¶ç³»ç»Ÿå¯èƒ½ä¼šå‡ºäºå„ç§åŸå› ä¿®æ”¹è®¿é—®æ—¶é—´ï¼ŒåŒ…æ‹¬å¤‡ä»½è½¯ä»¶æˆ–ç³»ç»Ÿæ£€æŸ¥ã€‚</li><li>åœ¨æŸäº›ç³»ç»Ÿä¸Šï¼Œå‡ºäºæ€§èƒ½è€ƒè™‘ï¼Œé»˜è®¤é…ç½®å¯èƒ½ä¸ä¼šè®°å½•æ–‡ä»¶çš„æ¯æ¬¡è®¿é—®ã€‚</li><li>è®¿é—®æ—¶é—´çš„ç²¾ç¡®åº¦å¯èƒ½å—åˆ°æ–‡ä»¶ç³»ç»Ÿç±»å‹å’Œæ“ä½œç³»ç»Ÿé…ç½®çš„å½±å“ã€‚</li></ul><h4 id="stats-mtimems" tabindex="-1"><a class="header-anchor" href="#stats-mtimems"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsmtimems" target="_blank" rel="noopener noreferrer">stats.mtimeMs</a></span></a></h4><p>ç†è§£ <code>stats.mtimeMs</code> çš„æ¦‚å¿µä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£å‡ ä¸ªåŸºæœ¬çš„æ¦‚å¿µã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code>æ¨¡å—æ˜¯ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„æ¨¡å—ã€‚æ— è®ºæ˜¯è¯»å–æ–‡ä»¶å†…å®¹ã€åˆ›å»ºæ–°æ–‡ä»¶ã€è¿˜æ˜¯æŸ¥è¯¢æ–‡ä»¶ä¿¡æ¯ï¼Œ<code>fs</code>æ¨¡å—éƒ½æ‰®æ¼”ç€éå¸¸é‡è¦çš„è§’è‰²ã€‚</p><p>å½“ä½ ä½¿ç”¨<code>fs</code>æ¨¡å—æŸ¥è¯¢ä¸€ä¸ªæ–‡ä»¶ï¼ˆæˆ–ç›®å½•ï¼‰çš„ä¿¡æ¯æ—¶ï¼Œæ¯”å¦‚ä½¿ç”¨<code>fs.stat()</code>, <code>fs.lstat()</code>, æˆ–è€… <code>fs.fstat()</code>æ–¹æ³•ï¼ŒNode.js ä¼šè¿”å›ä¸€ä¸ªåŒ…å«è¯¥æ–‡ä»¶ï¼ˆæˆ–ç›®å½•ï¼‰ä¿¡æ¯çš„å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡å°±æ˜¯é€šå¸¸æ‰€è¯´çš„<code>Stats</code>å¯¹è±¡ã€‚</p><p>åœ¨<code>Stats</code>å¯¹è±¡ä¸­ï¼Œæœ‰å¾ˆå¤šå±æ€§å¯ä»¥å¸®åŠ©ä½ è·å–æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ã€‚å…¶ä¸­ï¼Œ<code>mtimeMs</code>æ˜¯è¿™äº›å±æ€§ä¹‹ä¸€ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-stats-mtimems" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-stats-mtimems"><span>ä»€ä¹ˆæ˜¯ <code>stats.mtimeMs</code>ï¼Ÿ</span></a></h3><ul><li><code>mtime</code>ä»£è¡¨â€œä¿®æ”¹æ—¶é—´â€ï¼ˆmodification timeï¼‰ï¼Œå®ƒæŒ‡çš„æ˜¯æ–‡ä»¶æœ€åä¸€æ¬¡è¢«ä¿®æ”¹çš„æ—¶é—´ã€‚</li><li><code>mtimeMs</code>åˆ™æ˜¯è¿™ä¸ªä¿®æ”¹æ—¶é—´çš„æ¯«ç§’è¡¨ç¤ºå½¢å¼ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä½ çœ‹åˆ°<code>mtimeMs</code>çš„å€¼æ˜¯ 1625079037000ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶é—´å®é™…ä¸Šæ˜¯æŒ‡è·ç¦» UNIX çºªå…ƒï¼ˆ1970 å¹´ 1 æœˆ 1 æ—¥ UTCï¼‰è¿‡å»äº† 1625079037000 æ¯«ç§’ã€‚</li></ul><h3 id="ä¸ºä»€ä¹ˆmtimemsé‡è¦" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆmtimemsé‡è¦"><span>ä¸ºä»€ä¹ˆ<code>mtimeMs</code>é‡è¦ï¼Ÿ</span></a></h3><p>åœ¨å¼€å‘ä¸­ï¼Œ<code>mtimeMs</code>å¯ä»¥ç”¨äºå¤šç§åœºæ™¯ï¼Œæ¯”å¦‚ï¼š</p><ol><li><p><strong>ç¼“å­˜ç®¡ç†</strong>ï¼šå¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™æˆ–åº”ç”¨ï¼Œå¹¶ä¸”æƒ³è¦åˆç†åœ°ç®¡ç†ç¼“å­˜ã€‚é€šè¿‡æ£€æŸ¥æ–‡ä»¶çš„<code>mtimeMs</code>ï¼Œä½ å¯ä»¥åˆ¤æ–­æ–‡ä»¶è‡ªä¸Šæ¬¡è®¿é—®ä»¥æ¥æ˜¯å¦è¢«ä¿®æ”¹è¿‡ã€‚å¦‚æœæ–‡ä»¶æ²¡æœ‰è¢«ä¿®æ”¹ï¼Œä½ å¯ä»¥å®‰å…¨åœ°ä½¿ç”¨ç¼“å­˜ç‰ˆæœ¬ï¼Œä»è€Œæé«˜åº”ç”¨æ€§èƒ½ã€‚</p></li><li><p><strong>æ–‡ä»¶åŒæ­¥</strong>ï¼šå‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªå°†æœ¬åœ°æ–‡ä»¶å¤¹ä¸äº‘ç«¯åŒæ­¥çš„å·¥å…·ã€‚é€šè¿‡æ¯”è¾ƒæœ¬åœ°æ–‡ä»¶å’Œäº‘ç«¯æ–‡ä»¶çš„<code>mtimeMs</code>å€¼ï¼Œå¯ä»¥è½»æ¾è¯†åˆ«å‡ºå“ªäº›æ–‡ä»¶æ˜¯æ–°çš„æˆ–å·²è¢«ä¿®æ”¹çš„ï¼Œè¿›è€ŒåªåŒæ­¥è¿™éƒ¨åˆ†æ–‡ä»¶ï¼ŒèŠ‚çœèµ„æºå’Œæ—¶é—´ã€‚</p></li><li><p><strong>é¡¹ç›®æ„å»º</strong>ï¼šåœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œæ„å»ºè¿‡ç¨‹å¯èƒ½éå¸¸è€—æ—¶ã€‚åˆ©ç”¨<code>mtimeMs</code>å¯ä»¥æ£€æµ‹å“ªäº›æ–‡ä»¶è‡ªä¸Šæ¬¡æ„å»ºä»¥æ¥å·²ç»è¢«ä¿®æ”¹ï¼Œåªå¯¹è¿™äº›æ–‡ä»¶æ‰§è¡Œæ„å»ºæµç¨‹ï¼Œä»è€Œå‡å°‘æ•´ä½“æ„å»ºæ—¶é—´ã€‚</p></li></ol><h3 id="å¦‚ä½•åœ¨-node-js-ä¸­ä½¿ç”¨mtimems" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•åœ¨-node-js-ä¸­ä½¿ç”¨mtimems"><span>å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨<code>mtimeMs</code>?</span></a></h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨<code>fs</code>æ¨¡å—è·å–å¹¶ä½¿ç”¨æ–‡ä»¶çš„<code>mtimeMs</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨fs.statè·å–æ–‡ä»¶çŠ¶æ€ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error fetching file stats:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // è¾“å‡ºæ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File last modified at (ms):</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mtimeMs</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä¹Ÿå¯ä»¥å°†æ¯«ç§’è½¬æ¢æˆå¯è¯»æ ¼å¼çš„æ—¥æœŸ</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> lastModified</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mtimeMs</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File last modified at:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> lastModified</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toLocaleString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè½½å…¥<code>fs</code>æ¨¡å—ã€‚ç„¶åï¼Œä½¿ç”¨<code>fs.stat()</code>å‡½æ•°è·å–åä¸º<code>example.txt</code>çš„æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯ã€‚å›è°ƒå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆæ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯å‘ç”Ÿï¼›å¦‚æœæ²¡æœ‰ï¼Œæˆ‘ä»¬å°±è¾“å‡ºè¯¥æ–‡ä»¶çš„<code>mtimeMs</code>å€¼ï¼Œå³æ–‡ä»¶æœ€åä¸€æ¬¡è¢«ä¿®æ”¹çš„æ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚æˆ‘ä»¬è¿˜ç¤ºèŒƒäº†å¦‚ä½•å°†è¿™ä¸ªæ—¶é—´æˆ³è½¬æ¢ä¸ºæ›´å®¹æ˜“ç†è§£çš„æ—¥æœŸæ ¼å¼ã€‚</p><h4 id="stats-ctimems" tabindex="-1"><a class="header-anchor" href="#stats-ctimems"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsctimems" target="_blank" rel="noopener noreferrer">stats.ctimeMs</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚<code>fs</code> æ¨¡å—æ˜¯ Node.js çš„æ ¸å¿ƒæ¨¡å—ä¹‹ä¸€ï¼Œæä¾›äº†æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„åŠŸèƒ½ï¼Œæ¯”å¦‚æ–‡ä»¶çš„è¯»å†™ã€ç›®å½•çš„åˆ›å»ºåˆ é™¤ç­‰ã€‚</p><h3 id="è§£é‡Š-stats-ctimems" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-stats-ctimems"><span>è§£é‡Š <code>stats.ctimeMs</code></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æä¾›çš„å¾ˆå¤šå‡½æ•°éƒ½èƒ½è¿”å›ä¸€ä¸ª <code>Stats</code> å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åŒ…å«äº†å…³äºæ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ã€‚<code>stats.ctimeMs</code> æ˜¯ <code>Stats</code> å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œè¡¨ç¤ºæ–‡ä»¶çŠ¶æ€æœ€åæ”¹å˜çš„æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’ã€‚</p><ul><li><strong>ctime</strong>ï¼šä»£è¡¨ &quot;change time&quot;ï¼Œå³æ–‡ä»¶çš„çŠ¶æ€ä¸Šæ¬¡æ›´æ”¹çš„æ—¶é—´ã€‚è¿™é‡Œçš„ â€œçŠ¶æ€æ”¹å˜â€ ä¸»è¦æŒ‡çš„æ˜¯æ–‡ä»¶çš„æƒé™ã€æ‰€æœ‰è€…ç­‰å…ƒæ•°æ®çš„å˜åŒ–ï¼Œè€Œä¸æ˜¯æ–‡ä»¶å†…å®¹çš„ä¿®æ”¹ã€‚</li><li><strong>Ms</strong>ï¼šè¡¨ç¤ºè¯¥æ—¶é—´å€¼ä»¥æ¯«ç§’ä¸ºå•ä½ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-14" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-14"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><ol><li><strong>æ£€æµ‹æ–‡ä»¶çš„æ›´æ–°æ—¶é—´</strong>ï¼šå‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦ç›‘æµ‹æŸä¸ªé…ç½®æ–‡ä»¶ä½•æ—¶è¢«ä¿®æ”¹è¿‡ï¼Œä»¥ä¾¿é‡æ–°åŠ è½½é…ç½®ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>fs.stat()</code> æˆ– <code>fs.statSync()</code> æ–¹æ³•è·å–æ–‡ä»¶çš„ <code>stats</code> å¯¹è±¡ï¼Œç„¶åé€šè¿‡ <code>stats.ctimeMs</code> æ¥åˆ¤æ–­æ–‡ä»¶æœ€åçŠ¶æ€å˜æ›´çš„æ—¶é—´ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è·å–æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // è¾“å‡ºæ–‡ä»¶çŠ¶æ€æœ€åæ”¹å˜çš„æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Config file last status change time: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ctimeMs</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>ç¼“å­˜æœºåˆ¶</strong>ï¼šåœ¨ç½‘ç«™å¼€å‘ä¸­ï¼Œå¯èƒ½ä¼šç”¨åˆ°ç¼“å­˜æœºåˆ¶æ¥æå‡æ€§èƒ½ã€‚ä½ å¯ä»¥åˆ©ç”¨ <code>stats.ctimeMs</code> æ¥æ£€æŸ¥æ–‡ä»¶æ˜¯å¦è‡ªç¼“å­˜ä»¥æ¥å‘ç”Ÿäº†æ›´æ”¹ã€‚å¦‚æœæ–‡ä»¶æœªæ›´æ”¹ï¼Œå¯ä»¥ç›´æ¥æœåŠ¡ç¼“å­˜çš„å†…å®¹ï¼›å¦‚æœæ–‡ä»¶å·²æ›´æ–°ï¼Œåˆ™é‡æ–°è¯»å–æ–‡ä»¶å†…å®¹å¹¶æ›´æ–°ç¼“å­˜ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> cache</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">  filePath</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#88C0D0;">  content</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#88C0D0;">  lastCtimeMs</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">cache</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æ›´æ–°</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ctimeMs</span><span style="color:#81A1C1;"> &gt;</span><span style="color:#D8DEE9;"> cache</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lastCtimeMs</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // æ–‡ä»¶å·²æ›´æ–°ï¼Œé‡æ–°è¯»å–æ–‡ä»¶å¹¶æ›´æ–°ç¼“å­˜çš„æ—¶é—´æˆ³å’Œå†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">cache</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        return;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">      cache</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">content</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">      cache</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lastCtimeMs</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ctimeMs</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Cache updated with new file content.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // æ–‡ä»¶æœªæ›´æ–°ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ç¼“å­˜çš„å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Serving content from cache.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>stats.ctimeMs</code> åœ¨å¼€å‘ä¸­çš„å®ç”¨æ€§ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦æ ¹æ®æ–‡ä»¶çŠ¶æ€å˜åŒ–è¿›è¡Œæ“ä½œçš„åœºæ™¯ä¸‹ã€‚</p><h4 id="stats-birthtimems" tabindex="-1"><a class="header-anchor" href="#stats-birthtimems"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsbirthtimems" target="_blank" rel="noopener noreferrer">stats.birthtimeMs</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªå…è®¸æ‚¨ä½¿ç”¨ JavaScript åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œè„šæœ¬çš„ç¯å¢ƒï¼Œè¿™æ„å‘³ç€æ‚¨å¯ä»¥ç”¨ JavaScript åšå¾ˆå¤šä»¥å‰åªèƒ½ç”¨å…¶ä»–ç¼–ç¨‹è¯­è¨€åšçš„åç«¯ä»»åŠ¡ï¼Œæ¯”å¦‚æ–‡ä»¶æ“ä½œã€‚åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æ˜¯ç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ï¼Œå®ƒæä¾›äº†å¾ˆå¤šç”¨äºæ–‡ä»¶è¯»å†™ã€ä¿¡æ¯æŸ¥è¯¢ç­‰åŠŸèƒ½çš„æ–¹æ³•ã€‚</p><p>å…¶ä¸­ï¼Œ<code>stats.birthtimeMs</code> æ˜¯ <code>fs</code> æ¨¡å—ä¸­ç”¨æ¥è·å–æ–‡ä»¶æˆ–ç›®å½•åˆ›å»ºæ—¶é—´çš„å±æ€§ä¹‹ä¸€ã€‚æ›´å…·ä½“åœ°è¯´ï¼Œå½“ä½ ä½¿ç”¨ <code>fs.stat()</code>, <code>fs.statSync()</code> æˆ–è€…è¿™äº›å‡½æ•°çš„å˜ä½“æ—¶ï¼Œè¿”å›çš„å¯¹è±¡ï¼ˆæˆ‘ä»¬é€šå¸¸ç§°å®ƒä¸º <code>stats</code> å¯¹è±¡ï¼‰åŒ…å«äº†å¾ˆå¤šæœ‰å…³æ–‡ä»¶æˆ–ç›®å½•çš„ä¿¡æ¯ï¼Œ<code>birthtimeMs</code> åˆ™æ˜¯è¿™äº›ä¿¡æ¯ä¹‹ä¸€ï¼Œè¡¨ç¤ºæ–‡ä»¶æˆ–ç›®å½•çš„åˆ›å»ºæ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-35" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-35"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>ç›‘æ§æ–°æ–‡ä»¶ï¼š</strong> å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦ç›‘æ§ä¸€ä¸ªç‰¹å®šç›®å½•ä¸‹æ˜¯å¦æœ‰æ–°æ–‡ä»¶è¢«æ·»åŠ è¿›æ¥ã€‚ä½ å¯ä»¥é€šè¿‡æ£€æŸ¥è¯¥ç›®å½•ä¸‹æ¯ä¸ªæ–‡ä»¶çš„ <code>birthtimeMs</code> æ¥è¯†åˆ«æœ€è¿‘æ·»åŠ çš„æ–‡ä»¶ã€‚</p></li><li><p><strong>æ•°æ®å¤‡ä»½ï¼š</strong> å¦‚æœä½ æ­£åœ¨åˆ¶ä½œä¸€ä¸ªè„šæœ¬æ¥å¤‡ä»½ä¸€äº›é‡è¦æ–‡ä»¶ï¼Œä½ å¯èƒ½æƒ³è·³è¿‡é‚£äº›æœ€è¿‘æ²¡æœ‰ä¿®æ”¹è¿‡çš„æ—§æ–‡ä»¶ã€‚å°½ç®¡è¿™é‡Œ <code>mtimeMs</code> æ›´é€‚åˆæ£€æŸ¥æœ€åä¿®æ”¹æ—¶é—´ï¼Œ<code>birthtimeMs</code> å¯ä»¥å¸®åŠ©ä½ äº†è§£æ–‡ä»¶æ˜¯ä¸æ˜¯æ–°åˆ›å»ºçš„ï¼Œä»è€Œå†³å®šæ˜¯å¦éœ€è¦å¤‡ä»½ã€‚</p></li><li><p><strong>æ–‡ä»¶ç®¡ç†ç³»ç»Ÿï¼š</strong> è®¾è®¡ä¸€ä¸ªç®€å•çš„æ–‡ä»¶ç®¡ç†ç³»ç»Ÿæ—¶ï¼Œå±•ç¤ºæ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ–‡ä»¶çš„åˆ›å»ºæ—¶é—´ã€‚é€šè¿‡è·å– <code>birthtimeMs</code> å¹¶å°†å…¶è½¬æ¢æˆå‹å¥½çš„æ—¥æœŸæ ¼å¼ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°å‘ç”¨æˆ·å±•ç¤ºæ¯ä¸ªæ–‡ä»¶ä½•æ—¶è¢«æ·»åŠ åˆ°ç³»ç»Ÿä¸­ã€‚</p></li></ol><h3 id="ç¤ºä¾‹ä»£ç -6" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç -6"><span>ç¤ºä¾‹ä»£ç ï¼š</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è·å–æ–‡ä»¶çŠ¶æ€</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">è·å–æ–‡ä»¶çŠ¶æ€å¤±è´¥: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å°† birthtimeMs è½¬æ¢ä¸ºå¯è¯»çš„æ—¥æœŸå­—ç¬¦ä¸²</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> birthtime</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">birthtimeMs</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toLocaleString</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶ </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filePath</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> çš„åˆ›å»ºæ—¶é—´æ˜¯: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">birthtime</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é¦–å…ˆå¼•å…¥äº† <code>fs</code> æ¨¡å—ï¼Œç„¶åå®šä¹‰äº†æƒ³è¦æ£€æŸ¥çš„æ–‡ä»¶è·¯å¾„ã€‚ä½¿ç”¨ <code>fs.stat()</code> å¼‚æ­¥è·å–æ–‡ä»¶çŠ¶æ€ï¼Œå¹¶åœ¨å›è°ƒå‡½æ•°ä¸­å¤„ç†ç»“æœ â€”â€” å¦‚æœæˆåŠŸï¼Œå°±å°† <code>birthtimeMs</code> è½¬æ¢æˆæ›´æ˜“è¯»çš„æ—¥æœŸå’Œæ—¶é—´æ ¼å¼å¹¶æ‰“å°å‡ºæ¥ã€‚è¿™æ ·ï¼Œä½ å¯ä»¥å¾ˆæ–¹ä¾¿åœ°çŸ¥é“ä»»ä½•æ–‡ä»¶çš„åˆ›å»ºæ—¶é—´ã€‚</p><h4 id="stats-atimens" tabindex="-1"><a class="header-anchor" href="#stats-atimens"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsatimens" target="_blank" rel="noopener noreferrer">stats.atimeNs</a></span></a></h4><p>Node.js ä¸­çš„ <code>fs</code> æ¨¡å—æä¾›äº†è®¸å¤šç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„åŠŸèƒ½ã€‚å½“ä½ ä½¿ç”¨è¿™ä¸ªæ¨¡å—ä¸­çš„å‡½æ•°æ¥è·å–ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„ä¿¡æ¯æ—¶ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ª <code>fs.Stats</code> å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åŒ…å«äº†å…³äºè¯¥æ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚å®ƒçš„å¤§å°ã€åˆ›å»ºæ—¶é—´ä»¥åŠæœ€åä¸€æ¬¡è¢«è®¿é—®çš„æ—¶é—´ç­‰ã€‚</p><p>åœ¨ <code>fs.Stats</code> å¯¹è±¡ä¸­ï¼Œ<code>stats.atimeNs</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå®ƒç»™å‡ºäº†æ–‡ä»¶æˆ–ç›®å½•ä¸Šæ¬¡è¢«è®¿é—®çš„æ—¶é—´ï¼Œå•ä½æ˜¯çº³ç§’ï¼ˆ1 ç§’ = 10^9 çº³ç§’ï¼‰ã€‚&quot;atime&quot; æ˜¯ &quot;access time&quot; çš„ç¼©å†™ï¼Œè€Œ &quot;Ns&quot; è¡¨ç¤ºæ—¶é—´æ˜¯ä»¥çº³ç§’ä¸ºå•ä½çš„ã€‚</p><p>è¿™ä¸ªå±æ€§å¾ˆæœ‰ç”¨ï¼Œæ¯”å¦‚è¯´ï¼Œå½“ä½ éœ€è¦ç²¾ç¡®åœ°è¿½è¸ªæ–‡ä»¶è¢«è®¿é—®çš„æ—¶é—´ï¼Œå¯èƒ½æ˜¯å‡ºäºç›‘æ§æˆ–è€…å®‰å…¨çš„è€ƒè™‘ã€‚ä¸åŒäº <code>stats.atime</code> å±æ€§ï¼Œå®ƒæä¾›çš„æ—¶é—´ä¿¡æ¯æ˜¯ä¸€ä¸ªæ—¥æœŸå¯¹è±¡ï¼Œè€Œ <code>stats.atimeNs</code> æä¾›çš„æ˜¯ä¸€ä¸ªæ›´é«˜ç²¾åº¦çš„æ•°å€¼ï¼Œè¿™å¯¹äºæŸäº›éœ€è¦é«˜ç²¾åº¦æ—¶é—´æµ‹é‡çš„åº”ç”¨åœºæ™¯å°¤å…¶é‡è¦ã€‚</p><h3 id="ä»£ç ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä»£ç ä¾‹å­"><span>ä»£ç ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æƒ³æ£€æŸ¥ä¸€ä¸ªåä¸º <code>example.txt</code> æ–‡ä»¶çš„æœ€åè®¿é—®æ—¶é—´ï¼Œä»¥ä¸‹æ˜¯ä½¿ç”¨ Node.js å®ç°è¿™ä¸ªåŠŸèƒ½çš„ä»£ç ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨å¼‚æ­¥æ–¹å¼è·å–æ–‡ä»¶çŠ¶æ€ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‡ºé”™äº†:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#616E88;">  // è¾“å‡ºæ–‡ä»¶æœ€åè®¿é—®æ—¶é—´çš„çº³ç§’è¡¨ç¤º</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶æœ€åè®¿é—®æ—¶é—´ï¼ˆçº³ç§’ï¼‰:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">atimeNs</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä½ å¸Œæœ›ä½¿ç”¨åŒæ­¥çš„æ–¹æ³•ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // åŒæ­¥è·å–æ–‡ä»¶çŠ¶æ€ä¿¡æ¯</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // è¾“å‡ºæ–‡ä»¶æœ€åè®¿é—®æ—¶é—´çš„çº³ç§’è¡¨ç¤º</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶æœ€åè®¿é—®æ—¶é—´ï¼ˆçº³ç§’ï¼‰:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">atimeNs</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‡ºé”™äº†:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼Œé¢‘ç¹åœ°è®¿é—® atime å€¼å¯èƒ½ä¼šå¯¹æ€§èƒ½æœ‰å½±å“ï¼Œå› ä¸ºå®ƒéœ€è¦ä»æ–‡ä»¶ç³»ç»Ÿä¸­è¯»å–é¢å¤–çš„å…ƒæ•°æ®ã€‚æ­¤å¤–ï¼Œå¹¶éæ‰€æœ‰çš„æ–‡ä»¶ç³»ç»Ÿéƒ½æ”¯æŒçº³ç§’çº§çš„æ—¶é—´æˆ³ï¼Œè¿™å–å†³äºä½ çš„æ“ä½œç³»ç»Ÿå’Œæ–‡ä»¶ç³»ç»Ÿã€‚</p><p>å½“ä½ å¤„ç†å¤§é‡æ–‡ä»¶ï¼Œä¸”éœ€è¦ç²¾ç¡®åœ°è®°å½•å®ƒä»¬çš„è®¿é—®æ—¶é—´æ—¶ï¼Œ<code>stats.atimeNs</code> å°±éå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œåœ¨å¤‡ä»½è½¯ä»¶ä¸­ï¼Œä½ å¯èƒ½æƒ³è¦çŸ¥é“æ–‡ä»¶ä½•æ—¶è¢«è¯»å–ï¼Œä»¥ç¡®å®šå®ƒæ˜¯å¦è‡ªä¸Šæ¬¡å¤‡ä»½ä»¥æ¥å‘ç”Ÿäº†å˜åŒ–ã€‚æˆ–è€…åœ¨å®‰å…¨å®¡è®¡ä¸­ï¼Œä½ å¯èƒ½éœ€è¦è·Ÿè¸ªç‰¹å®šæ–‡ä»¶çš„è®¿é—®æ¨¡å¼ï¼Œä»¥ä¾¿å¯Ÿè§‰åˆ°å¼‚å¸¸è¡Œä¸ºã€‚</p><h4 id="stats-mtimens" tabindex="-1"><a class="header-anchor" href="#stats-mtimens"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsmtimens" target="_blank" rel="noopener noreferrer">stats.mtimeNs</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„ JavaScript ç¯å¢ƒï¼Œå®ƒå…è®¸ä½ ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚Node.js æä¾›äº†å¾ˆå¤šå†…ç½®æ¨¡å—ï¼Œä½¿å¾—å¤„ç†æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œè¯·æ±‚ç­‰å˜å¾—æ›´åŠ å®¹æ˜“ã€‚<code>fs</code>ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰æ¨¡å—æ˜¯ Node.js ä¸­ç”¨äºæ–‡ä»¶æ“ä½œçš„ä¸€ä¸ªé‡è¦æ¨¡å—ï¼Œå…¶ä¸­åŒ…æ‹¬äº†ä¸€ç³»åˆ—å¤„ç†æ–‡ä»¶å±æ€§çš„åŠŸèƒ½ã€‚</p><p>åœ¨ Node.js çš„ <code>fs</code> æ¨¡å—ä¸­ï¼Œ<code>stats.mtimeNs</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œè¡¨ç¤ºæ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´ï¼Œå•ä½ä¸ºçº³ç§’ï¼ˆ1 ç§’ = 1,000,000,000 çº³ç§’ï¼‰ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥è·å–åˆ°éå¸¸ç²¾ç¡®çš„æ–‡ä»¶ä¿®æ”¹æ—¶é—´ï¼Œè¿™åœ¨æŸäº›åœºæ™¯ä¸‹éå¸¸æœ‰ç”¨ã€‚</p><h3 id="è§£é‡Š-stats-mtimens" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-stats-mtimens"><span>è§£é‡Š <code>stats.mtimeNs</code></span></a></h3><ul><li><code>stats</code> æ˜¯é€šè¿‡è°ƒç”¨ <code>fs.stat()</code>, <code>fs.lstat()</code> æˆ– <code>fs.fstat()</code> ç­‰æ–¹æ³•è·å¾—çš„å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ã€‚</li><li><code>.mtimeNs</code> å±æ€§å°±æ˜¯è¿™ä¸ªå¯¹è±¡ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œè¡¨ç¤ºæ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´ï¼Œä»¥çº³ç§’ä¸ºå•ä½ã€‚</li></ul><h3 id="ä½¿ç”¨åœºæ™¯-6" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯-6"><span>ä½¿ç”¨åœºæ™¯</span></a></h3><h4 id="_1-æ–‡ä»¶ç¼“å­˜æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#_1-æ–‡ä»¶ç¼“å­˜æœºåˆ¶"><span>1. æ–‡ä»¶ç¼“å­˜æœºåˆ¶</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™ï¼Œè¯¥ç½‘ç«™æœ‰ä¸€ä¸ªå›¾ç‰‡åº“ã€‚æ¯å½“ç”¨æˆ·ä¸Šä¼ æ–°å›¾ç‰‡æˆ–è€…æ›´æ–°ç°æœ‰å›¾ç‰‡æ—¶ï¼ŒæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ä¼šè¢«ä¿®æ”¹ã€‚ä½ å¯ä»¥åˆ©ç”¨ <code>stats.mtimeNs</code> æ¥æ£€æµ‹æ–‡ä»¶ä½•æ—¶è¢«ä¿®æ”¹ï¼Œä»è€Œå†³å®šæ˜¯å¦éœ€è¦æ›´æ–°ç”¨æˆ·æµè§ˆå™¨ä¸­çš„ç¼“å­˜ã€‚ä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾å›¾ç‰‡æ–‡ä»¶è·¯å¾„å·²çŸ¥</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> imagePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/image.jpg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">imagePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">å›¾ç‰‡æœ€åä¿®æ”¹æ—¶é—´ï¼ˆçº³ç§’ï¼‰: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mtimeNs</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // æ ¹æ®ä¿®æ”¹æ—¶é—´åˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°ç¼“å­˜</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-åŒæ­¥æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_2-åŒæ­¥æ•°æ®"><span>2. åŒæ­¥æ•°æ®</span></a></h4><p>å¦‚æœä½ åœ¨æ„å»ºä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦åŒæ­¥æœ¬åœ°æ–‡ä»¶ä¸è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>stats.mtimeNs</code> æ¥æ£€æŸ¥æ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´ï¼Œç¡®å®šå“ªä¸ªç‰ˆæœ¬æ˜¯æœ€æ–°çš„ã€‚å¦‚æœæœ¬åœ°æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´æ¯”æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶æ–°ï¼Œé‚£ä¹ˆå¯èƒ½éœ€è¦å°†è¿™ä¸ªæ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> localFilePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">path/to/local/file.txt</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> serverFileLastModifiedNs</span><span style="color:#81A1C1;"> =</span><span style="color:#616E88;"> /* å‡è®¾è¿™æ˜¯é€šè¿‡æŸç§æ–¹å¼è·å–åˆ°çš„æœåŠ¡å™¨ä¸Šæ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´ï¼ˆçº³ç§’ï¼‰ */</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">localFilePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mtimeNs</span><span style="color:#81A1C1;"> &gt;</span><span style="color:#D8DEE9;"> serverFileLastModifiedNs</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">æœ¬åœ°æ–‡ä»¶è¾ƒæ–°ï¼Œéœ€è¦ä¸Šä¼ åˆ°æœåŠ¡å™¨</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // æ‰§è¡Œæ–‡ä»¶ä¸Šä¼ é€»è¾‘...</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-ç›‘æ§æ–‡ä»¶æ›´æ”¹" tabindex="-1"><a class="header-anchor" href="#_3-ç›‘æ§æ–‡ä»¶æ›´æ”¹"><span>3. ç›‘æ§æ–‡ä»¶æ›´æ”¹</span></a></h4><p>å¯¹äºä¸€äº›éœ€è¦å®æ—¶å“åº”æ–‡ä»¶ä¿®æ”¹çš„åº”ç”¨ï¼Œå¦‚è‡ªåŠ¨ç¼–è¯‘å’Œéƒ¨ç½²å·¥å…·ï¼Œå¯ä»¥ç›‘æ§ç‰¹å®šæ–‡ä»¶æˆ–ç›®å½•çš„æœ€åä¿®æ”¹æ—¶é—´ï¼Œä¸€æ—¦æ£€æµ‹åˆ°å˜åŒ–ï¼Œç«‹å³æ‰§è¡Œç›¸åº”çš„æ“ä½œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> watchFilePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">path/to/watch/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watchFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">watchFilePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">curr</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> prev</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">curr</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mtimeNs</span><span style="color:#81A1C1;"> !==</span><span style="color:#D8DEE9;"> prev</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mtimeNs</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²æ›´æ”¹ï¼Œæ‰§è¡Œç›¸åº”æ“ä½œ...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // æ‰§è¡Œç›¸å…³é€»è¾‘ï¼Œæ¯”å¦‚è‡ªåŠ¨ç¼–è¯‘ã€é€šçŸ¥ç”¨æˆ·ç­‰</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç»“è¯­" tabindex="-1"><a class="header-anchor" href="#ç»“è¯­"><span>ç»“è¯­</span></a></h3><p>é€šè¿‡ä»¥ä¸Šä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>stats.mtimeNs</code> åœ¨æ–‡ä»¶å¤„ç†æ–¹é¢çš„å®é™…åº”ç”¨ã€‚Node.js æä¾›äº†ä¸°å¯Œçš„ API æ¥å¸®åŠ©å¼€å‘è€…é«˜æ•ˆåœ°å¤„ç†æ–‡ä»¶ï¼Œè€Œ <code>stats.mtimeNs</code> æ˜¯å…¶ä¸­ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å±æ€§ï¼Œå°¤å…¶åœ¨éœ€è¦å…³æ³¨æ–‡ä»¶ä¿®æ”¹ç²¾ç¡®æ—¶é—´çš„åœºæ™¯ä¸‹ã€‚</p><h4 id="stats-ctimens" tabindex="-1"><a class="header-anchor" href="#stats-ctimens"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsctimens" target="_blank" rel="noopener noreferrer">stats.ctimeNs</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªèƒ½å¤Ÿåœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç çš„å¹³å°ï¼Œå®ƒå…è®¸å¼€å‘è€…ä½¿ç”¨ JavaScript æ¥ç¼–å†™åç«¯ä»£ç ã€‚åœ¨ Node.js ä¸­å¤„ç†æ–‡ä»¶æ˜¯ä¸€é¡¹å¸¸è§çš„ä»»åŠ¡ï¼Œè€Œ<code>fs</code>æ¨¡å—ï¼ˆæ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼‰æä¾›äº†ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„ APIã€‚</p><p>åœ¨ Node.js çš„<code>fs</code>æ¨¡å—ä¸­ï¼Œå½“ä½ æŸ¥è¯¢æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯æ—¶ï¼Œæ¯”å¦‚ä½¿ç”¨<code>fs.stat()</code>, <code>fs.statSync()</code>æˆ–è€…å®ƒä»¬çš„å¼‚æ­¥å˜ä½“ï¼Œè¿”å›çš„å¯¹è±¡æ˜¯ä¸€ä¸ª<code>fs.Stats</code>å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åŒ…å«äº†å…³äºæ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚å¤§å°ã€åˆ›å»ºæ—¶é—´ã€ä¿®æ”¹æ—¶é—´ç­‰ã€‚</p><h3 id="stats-ctimens-1" tabindex="-1"><a class="header-anchor" href="#stats-ctimens-1"><span>stats.ctimeNs</span></a></h3><p>ç‰¹åˆ«æ¥è¯´ï¼Œ<code>stats.ctimeNs</code>æ˜¯<code>fs.Stats</code>å¯¹è±¡ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œè¡¨ç¤ºæ–‡ä»¶çŠ¶æ€æ”¹å˜çš„æ—¶é—´ï¼Œå•ä½æ˜¯çº³ç§’ï¼ˆ1 ç§’ = 1,000,000,000 çº³ç§’ï¼‰ã€‚&quot;çŠ¶æ€æ”¹å˜&quot;æŒ‡çš„æ˜¯æ–‡ä»¶çš„ inode ä¿¡æ¯å‘ç”Ÿå˜åŒ–çš„æ—¶é—´ï¼Œè¿™å¯èƒ½åŒ…æ‹¬æƒé™æ›´æ”¹ã€æ‰€æœ‰è€…æ›´æ”¹æˆ–æŸäº›ç‰¹å®šçš„å…ƒæ•°æ®æ›´æ–°ï¼ˆä¾‹å¦‚é“¾æ¥æ•°æ”¹å˜ï¼‰ï¼Œè€Œä¸ä»…ä»…æ˜¯æ–‡ä»¶å†…å®¹çš„æ›´æ”¹ã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯ç¤ºä¾‹"><span>ä½¿ç”¨åœºæ™¯ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-æŸ¥çœ‹æ–‡ä»¶çš„çŠ¶æ€æ”¹å˜æ—¶é—´" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æŸ¥çœ‹æ–‡ä»¶çš„çŠ¶æ€æ”¹å˜æ—¶é—´"><span>ç¤ºä¾‹ 1: æŸ¥çœ‹æ–‡ä»¶çš„çŠ¶æ€æ”¹å˜æ—¶é—´</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œéœ€è¦ç›‘è§†ç‰¹å®šæ–‡ä»¶ä½•æ—¶è¢«æ›´æ”¹è¿‡ã€‚ä½¿ç”¨<code>fs.stat()</code>å‡½æ•°å¹¶æ£€æŸ¥<code>ctimeNs</code>å±æ€§å¯ä»¥å®ç°è¿™ä¸€ç‚¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¼‚æ­¥è·å–æ–‡ä»¶çŠ¶æ€</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è·å–æ–‡ä»¶çŠ¶æ€å¤±è´¥</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶çŠ¶æ€æœ€åæ›´æ”¹æ—¶é—´ï¼ˆçº³ç§’ï¼‰: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ctimeNs</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬å°è¯•è·å–åä¸º<code>example.txt</code>æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯ã€‚å¦‚æœæˆåŠŸï¼Œå®ƒä¼šæ‰“å°å‡ºæ–‡ä»¶çŠ¶æ€æ›´æ”¹æ—¶é—´çš„çº³ç§’å€¼ã€‚</p><h4 id="ç¤ºä¾‹-2-å®ç°ç®€å•çš„æ–‡ä»¶ç›‘æ§" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å®ç°ç®€å•çš„æ–‡ä»¶ç›‘æ§"><span>ç¤ºä¾‹ 2: å®ç°ç®€å•çš„æ–‡ä»¶ç›‘æ§</span></a></h4><p>åˆ©ç”¨<code>ctimeNs</code>ï¼Œä½ å¯ä»¥æ„å»ºä¸€ä¸ªç®€å•çš„æ–‡ä»¶ç›‘æ§ç³»ç»Ÿï¼Œç›‘è§†æ–‡ä»¶ä½•æ—¶ç»å†çŠ¶æ€å˜æ›´ã€‚ä¸‹é¢çš„ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•æ¯”è¾ƒä¹‹å‰å’Œä¹‹åçš„<code>ctimeNs</code>å€¼æ¥æ£€æµ‹æ–‡ä»¶æ˜¯å¦å‘ç”Ÿäº†çŠ¶æ€å˜åŒ–ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> lastCtimeNs</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> monitorFile</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">fileName</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fileName</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è·å–æ–‡ä»¶çŠ¶æ€å¤±è´¥</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">lastCtimeNs</span><span style="color:#81A1C1;"> !==</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;"> &amp;&amp;</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ctimeNs</span><span style="color:#81A1C1;"> &gt;</span><span style="color:#D8DEE9;"> lastCtimeNs</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">fileName</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> çš„çŠ¶æ€å·²æ”¹å˜ã€‚</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#D8DEE9;">      lastCtimeNs</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ctimeNs</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ¯éš”5ç§’æ£€æŸ¥ä¸€æ¬¡&#39;example.txt&#39;æ–‡ä»¶çš„çŠ¶æ€</span></span>
<span class="line"><span style="color:#88C0D0;">setInterval</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">  monitorFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 5000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é¦–å…ˆå®šä¹‰äº†ä¸€ä¸ª<code>monitorFile</code>å‡½æ•°ï¼Œç”¨ä»¥è·å–æŒ‡å®šæ–‡ä»¶çš„çŠ¶æ€ï¼Œå¹¶é€šè¿‡æ¯”è¾ƒ<code>ctimeNs</code>å€¼æ¥å†³å®šæ–‡ä»¶æ˜¯å¦æœ‰è¿‡çŠ¶æ€å˜æ›´ã€‚æ¥ç€ï¼Œä½¿ç”¨<code>setInterval</code>æ¯ 5 ç§’è°ƒç”¨ä¸€æ¬¡è¿™ä¸ªå‡½æ•°ï¼Œä»¥ç›‘è§†<code>example.txt</code>æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶çš„çŠ¶æ€å‘ç”Ÿäº†å˜æ›´ï¼Œå®ƒä¼šæ‰“å°ä¸€æ¡æ¶ˆæ¯æç¤ºç”¨æˆ·ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œ<code>stats.ctimeNs</code>æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å±æ€§ï¼Œèƒ½å¤Ÿå¸®åŠ©ä½ åœ¨å¼€å‘ä¸­ç²¾ç¡®åœ°è¿½è¸ªæ–‡ä»¶çŠ¶æ€çš„å˜åŒ–ï¼Œä»è€Œåšå‡ºç›¸åº”çš„å“åº”æˆ–å¤„ç†ã€‚</p><h4 id="stats-birthtimens" tabindex="-1"><a class="header-anchor" href="#stats-birthtimens"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsbirthtimens" target="_blank" rel="noopener noreferrer">stats.birthtimeNs</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„æ¨¡å—å«åšæ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>ï¼‰ï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ APIã€‚</p><p>åœ¨æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ä¸­ï¼Œ<code>stats</code> å¯¹è±¡åŒ…å«äº†å…³äºæ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ã€‚<code>stats.birthtimeNs</code> æ˜¯è¿™äº›å±æ€§ä¹‹ä¸€ï¼Œç”¨äºè¡¨ç¤ºæ–‡ä»¶æˆ–ç›®å½•çš„åˆ›å»ºæ—¶é—´ï¼Œä»¥çº³ç§’ä¸ºå•ä½ã€‚è¿™ä¸ªå±æ€§ç»™ä½ æä¾›äº†ä¸€ä¸ªæ›´é«˜ç²¾åº¦çš„æ—¶é—´æˆ³ï¼Œç›¸æ¯”äºä¼ ç»Ÿçš„ç§’çº§æ—¶é—´æˆ³ï¼Œå®ƒèƒ½æä¾›æ›´ç»†è‡´çš„æ—¶é—´æµ‹é‡ã€‚</p><h3 id="è§£é‡Š-5" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-5"><span>è§£é‡Š</span></a></h3><ul><li><p><strong>ä½•è°“ <code>birthtimeNs</code>ï¼Ÿ</strong></p><p><code>birthtimeNs</code> å±äº <code>fs.Stats</code> å¯¹è±¡çš„å±æ€§ä¹‹ä¸€ï¼Œè¡¨ç¤ºæ–‡ä»¶æˆ–ç›®å½•åˆ›å»ºçš„æ—¶é—´æˆ³ï¼Œå•ä½æ˜¯çº³ç§’ï¼ˆ1 ç§’ = 1,000,000,000 çº³ç§’ï¼‰ã€‚å…¶æä¾›çš„é«˜ç²¾åº¦æ—¶é—´æˆ³ï¼Œè®©ä½ èƒ½å¤Ÿäº†è§£æ–‡ä»¶æˆ–ç›®å½•è¢«åˆ›å»ºçš„ç¡®åˆ‡æ—¶åˆ»ï¼Œè¿™åœ¨æŸäº›éœ€è¦é«˜æ—¶é—´ç²¾åº¦çš„åº”ç”¨ä¸­éå¸¸æœ‰ç”¨ã€‚</p></li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-36" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-36"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>æ–‡ä»¶ç‰ˆæœ¬æ§åˆ¶</strong></p><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç®€å•çš„æ–‡ä»¶ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œéœ€è¦è·Ÿè¸ªæ–‡ä»¶çš„åˆ›å»ºæ—¶é—´ã€‚é€šè¿‡ä½¿ç”¨ <code>birthtimeNs</code>ï¼Œä½ å¯ä»¥å‡†ç¡®åœ°è®°å½•æ¯ä¸ªæ–‡ä»¶çš„åˆ›å»ºæ—¶é—´ï¼Œç„¶åæ ¹æ®è¿™ä¸ªæ—¶é—´æˆ³å¯¹æ–‡ä»¶ç‰ˆæœ¬è¿›è¡Œæ’åºæˆ–ç®¡ç†ã€‚</p></li><li><p><strong>å¤‡ä»½è½¯ä»¶</strong></p><p>åœ¨ç¼–å†™å¤‡ä»½è½¯ä»¶æ—¶ï¼Œä½ å¯èƒ½éœ€è¦ç¡®å®šè‡ªä¸Šæ¬¡å¤‡ä»½ä»¥æ¥å“ªäº›æ–‡ä»¶æ˜¯æ–°åˆ›å»ºçš„ã€‚é€šè¿‡æ£€æŸ¥æ–‡ä»¶çš„ <code>birthtimeNs</code> å±æ€§ï¼Œä½ å¯ä»¥å‡†ç¡®æ‰¾å‡ºåœ¨ç‰¹å®šæ—¶é—´ç‚¹ä¹‹ååˆ›å»ºçš„æ‰€æœ‰æ–‡ä»¶ï¼Œå¹¶å°†å®ƒä»¬åŠ å…¥åˆ°å¤‡ä»½é˜Ÿåˆ—ä¸­ã€‚</p></li><li><p><strong>åŒæ­¥å·¥å…·</strong></p><p>å‡å¦‚ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåŒæ­¥å·¥å…·ï¼Œéœ€è¦åŒæ­¥ä¸åŒè®¾å¤‡é—´çš„æ–‡ä»¶ã€‚ä½ å¯ä»¥åˆ©ç”¨ <code>birthtimeNs</code> æ¥åˆ¤æ–­ä¸¤ä¸ªè®¾å¤‡ä¸Šçš„åŒåæ–‡ä»¶æ˜¯å¦ä¸ºåŒä¸€æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶çš„åˆ›å»ºæ—¶é—´ï¼ˆçº³ç§’çº§ç²¾åº¦ï¼‰å®Œå…¨ç›¸åŒï¼Œå¾ˆå¯èƒ½å®ƒä»¬æ˜¯åŒä¸€ä»½æ–‡ä»¶çš„ä¸åŒå‰¯æœ¬ã€‚</p></li></ol><h3 id="ç¤ºä¾‹ä»£ç -7" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç -7"><span>ç¤ºä¾‹ä»£ç </span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fs.stat æˆ– fs.statSync æ–¹æ³•è·å–æ–‡ä»¶æˆ–ç›®å½•çš„çŠ¶æ€</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // æ‰“å°æ–‡ä»¶çš„åˆ›å»ºæ—¶é—´ï¼ˆçº³ç§’çº§åˆ«ï¼‰</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶åˆ›å»ºæ—¶é—´ï¼ˆçº³ç§’ï¼‰: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">birthtimeNs</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šè¿°ä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Node.js çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>ï¼‰æ¨¡å—æ¥è·å–ç‰¹å®šæ–‡ä»¶ï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ <code>example.txt</code>ï¼‰çš„åˆ›å»ºæ—¶é—´ï¼Œç²¾ç¡®åˆ°çº³ç§’ã€‚è¿™ç§ç²¾ç¡®åº¦åœ¨å¤„ç†éœ€è¦é«˜æ—¶é—´ç²¾åº¦çš„åœºæ™¯æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚</p><h4 id="stats-atime" tabindex="-1"><a class="header-anchor" href="#stats-atime"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsatime" target="_blank" rel="noopener noreferrer">stats.atime</a></span></a></h4><p>åœ¨ Node.js ä¸­ï¼Œ<code>stats.atime</code>æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå®ƒä»£è¡¨äº†æ–‡ä»¶æˆ–è€…ç›®å½•çš„&quot;è®¿é—®æ—¶é—´&quot;ï¼ˆAccess Timeï¼‰ã€‚è¿™ä¸ªæ¦‚å¿µæ˜¯æ–‡ä»¶ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œå®ƒè®°å½•äº†æœ€åä¸€æ¬¡è®¿é—®ï¼ˆè¯»å–ï¼‰è¯¥æ–‡ä»¶æˆ–ç›®å½•çš„æ—¶é—´ç‚¹ã€‚åœ¨ Node.js çš„<code>fs</code>æ¨¡å—ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡å¯¹æ–‡ä»¶è¿›è¡Œ<code>stat</code>æ“ä½œæ¥è·å–è¿™ä¸ªä»¥åŠå…¶ä»–ç›¸å…³ä¿¡æ¯ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯stats-atime" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯stats-atime"><span>ä»€ä¹ˆæ˜¯<code>stats.atime</code></span></a></h3><p>å½“ä½ åœ¨ Node.js ä¸­ä½¿ç”¨<code>fs.stat()</code>, <code>fs.statSync()</code> æˆ–è€…ä¸å…¶ç›¸å…³çš„å¼‚æ­¥ç‰ˆæœ¬å¦‚<code>fs.promises.stat()</code>æŸ¥è¯¢æ–‡ä»¶æˆ–ç›®å½•çš„çŠ¶æ€æ—¶ï¼Œè¿”å›çš„å¯¹è±¡ï¼ˆæˆ‘ä»¬é€šå¸¸ç§°ä¹‹ä¸º<code>stats</code>å¯¹è±¡ï¼‰åŒ…å«å¤šä¸ªå±æ€§ï¼Œå…¶ä¸­<code>stats.atime</code>å°±æ˜¯ä¸€ä¸ªã€‚å®ƒè¡¨ç¤ºæ–‡ä»¶æˆ–ç›®å½•çš„æœ€åè®¿é—®æ—¶é—´ï¼Œè€Œä¸”æ˜¯ JavaScript çš„<code>Date</code>å¯¹è±¡å½¢å¼ï¼Œå› æ­¤ä½ å¯ä»¥ç›´æ¥ä½¿ç”¨ JavaScript çš„æ—¥æœŸå’Œæ—¶é—´åŠŸèƒ½æ¥å¤„ç†å®ƒã€‚</p><h3 id="å®é™…è¿ç”¨ä¸¾ä¾‹-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¸¾ä¾‹-2"><span>å®é™…è¿ç”¨ä¸¾ä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œéœ€è¦æ£€æŸ¥æŸä¸ªæ—¥å¿—æ–‡ä»¶æ˜¯å¦åœ¨ä»Šå¤©è¢«è¯»å–è¿‡ã€‚ä½ å¯ä»¥ä½¿ç”¨<code>fs.stat()</code>å‡½æ•°æ¥è·å–æ–‡ä»¶çš„çŠ¶æ€ï¼Œç„¶åæ£€æŸ¥<code>atime</code>å±æ€§ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/your/logfile.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‡ºé”™äº†</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä»Šå¤©è¢«è®¿é—®</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> lastAccessed</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">atime</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> today</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span></span>
<span class="line"><span style="color:#D8DEE9;">    lastAccessed</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getDate</span><span style="color:#D8DEE9FF;">() </span><span style="color:#81A1C1;">===</span><span style="color:#D8DEE9;"> today</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getDate</span><span style="color:#D8DEE9FF;">() </span><span style="color:#81A1C1;">&amp;&amp;</span></span>
<span class="line"><span style="color:#D8DEE9;">    lastAccessed</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getMonth</span><span style="color:#D8DEE9FF;">() </span><span style="color:#81A1C1;">===</span><span style="color:#D8DEE9;"> today</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getMonth</span><span style="color:#D8DEE9FF;">() </span><span style="color:#81A1C1;">&amp;&amp;</span></span>
<span class="line"><span style="color:#D8DEE9;">    lastAccessed</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getFullYear</span><span style="color:#D8DEE9FF;">() </span><span style="color:#81A1C1;">===</span><span style="color:#D8DEE9;"> today</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getFullYear</span><span style="color:#D8DEE9FF;">()</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  ) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™ä¸ªæ–‡ä»¶ä»Šå¤©è¢«è®¿é—®è¿‡</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™ä¸ªæ–‡ä»¶ä»Šå¤©æ²¡æœ‰è¢«è®¿é—®è¿‡</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº†<code>fs</code>æ¨¡å—ï¼Œç„¶åä½¿ç”¨<code>fs.stat()</code>æ–¹æ³•æ¥è·å–æŒ‡å®šæ–‡ä»¶çš„çŠ¶æ€ã€‚å›è°ƒå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æ£€æŸ¥é”™è¯¯å¯¹è±¡ç¡®ä¿æ²¡æœ‰å‘ç”Ÿé”™è¯¯ï¼Œç„¶åç»§ç»­å¤„ç†<code>stats</code>å¯¹è±¡ã€‚é€šè¿‡æ¯”è¾ƒ<code>stats.atime</code>ï¼ˆå³æ–‡ä»¶çš„æœ€åè®¿é—®æ—¶é—´ï¼‰å’Œå½“å‰æ—¥æœŸï¼Œæˆ‘ä»¬èƒ½å¤Ÿåˆ¤æ–­å‡ºè¯¥æ–‡ä»¶æ˜¯å¦åœ¨ä»Šå¤©è¢«è®¿é—®è¿‡ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-26" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-26"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>åœ¨æŸäº›ç³»ç»Ÿä¸Šï¼Œç”±äºæ€§èƒ½ä¼˜åŒ–ï¼Œæ–‡ä»¶çš„è®¿é—®æ—¶é—´å¯èƒ½ä¸ä¼šæ›´æ–°ï¼Œæˆ–è€…æ›´æ–°é¢‘ç‡ä½äºé¢„æœŸã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>atime</code>å¯èƒ½ä¸ä¼šå‡†ç¡®åæ˜ æœ€æ–°çš„è®¿é—®æ—¶é—´ã€‚</li><li>ä½¿ç”¨<code>fs.stat()</code>åŠå…¶å˜ç§æ—¶éœ€è¦è€ƒè™‘åˆ°å¼‚æ­¥æ€§ï¼Œå³ä»£ç çš„æ‰§è¡Œä¸ä¼šç«‹å³é˜»å¡ç­‰å¾…ç»“æœã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯å›è°ƒå‡½æ•°æ¥å¤„ç†ç»“æœï¼Œä½†ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨<code>async/await</code>ç»“åˆ<code>fs.promises.stat()</code>æ¥å®ç°æ›´ç°ä»£çš„å¼‚æ­¥å¤„ç†æ–¹å¼ã€‚</li></ul><p>é€šè¿‡ç†è§£å’Œè¿ç”¨<code>stats.atime</code>ï¼Œä½ å¯ä»¥åœ¨ Node.js åº”ç”¨ç¨‹åºä¸­çµæ´»åœ°ç®¡ç†å’Œå“åº”æ–‡ä»¶è®¿é—®äº‹ä»¶ï¼Œä»è€Œå¢åŠ ç¨‹åºçš„äº’åŠ¨æ€§å’Œç”¨æˆ·ä½“éªŒã€‚</p><h4 id="stats-mtime" tabindex="-1"><a class="header-anchor" href="#stats-mtime"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsmtime" target="_blank" rel="noopener noreferrer">stats.mtime</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªä½¿å¾— JavaScript èƒ½å¤Ÿè¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¹³å°ã€‚å®ƒå…·æœ‰ä¸€å¥—å†…ç½®çš„æ¨¡å—ï¼Œè¿™äº›æ¨¡å—æä¾›äº†è®¸å¤šå¸¸ç”¨åŠŸèƒ½ï¼Œä»¥å¸®åŠ©ä½ åˆ›å»ºé«˜æ•ˆã€å¯æ‰©å±•çš„ç½‘ç»œåº”ç”¨ç¨‹åºã€‚å…¶ä¸­ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ¨¡å—æ˜¯ <code>fs</code> (æ–‡ä»¶ç³»ç»Ÿ) æ¨¡å—ã€‚<code>fs</code> æ¨¡å—å…è®¸ä½ ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’ï¼Œå¦‚è¯»å–æ–‡ä»¶ã€å†™å…¥æ–‡ä»¶ã€æ›´æ”¹æ–‡ä»¶å±æ€§ç­‰ã€‚</p><p>åœ¨ <code>fs</code> æ¨¡å—ä¸­ï¼Œ<code>stats.mtime</code> æ˜¯ä¸€ä¸ªç‰¹åˆ«é‡è¦å’Œå®ç”¨çš„å±æ€§ã€‚è®©æˆ‘ä»¬è¯¦ç»†æ¢ç´¢å®ƒçš„å«ä¹‰ã€ç”¨æ³•å’Œä¸€äº›å®é™…åº”ç”¨åœºæ™¯ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-stats-mtime" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-stats-mtime"><span>ä»€ä¹ˆæ˜¯ <code>stats.mtime</code>ï¼Ÿ</span></a></h3><p><code>stats.mtime</code> ä»£è¡¨äº†æ–‡ä»¶çš„â€œä¿®æ”¹æ—¶é—´â€ï¼ˆmodification timeï¼‰ã€‚å½“ä½ ä½¿ç”¨ <code>fs.stat()</code>, <code>fs.statSync()</code> æˆ–è€…ç›¸å…³æ–¹æ³•æŸ¥è¯¢æ–‡ä»¶çŠ¶æ€æ—¶ï¼Œå¯ä»¥è·å¾—ä¸€ä¸ªåŒ…å«å¤šä¸ªå±æ€§çš„å¯¹è±¡ï¼Œå…¶ä¸­ <code>mtime</code> å°±æ˜¯è¿™äº›å±æ€§ä¹‹ä¸€ã€‚</p><h3 id="ä¸ºä»€ä¹ˆ-stats-mtime-é‡è¦" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆ-stats-mtime-é‡è¦"><span>ä¸ºä»€ä¹ˆ <code>stats.mtime</code> é‡è¦ï¼Ÿ</span></a></h3><p>çŸ¥é“ä¸€ä¸ªæ–‡ä»¶æœ€åä¿®æ”¹çš„æ—¶é—´å¯¹äºå¾ˆå¤šåº”ç”¨ç¨‹åºæ¥è¯´éå¸¸é‡è¦ã€‚æ¯”å¦‚ï¼š</p><ul><li><strong>ç¼“å­˜</strong>ï¼šå¦‚æœä½ åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™ï¼Œå¯èƒ½éœ€è¦ç›‘æµ‹æ–‡ä»¶æ˜¯å¦è¢«ä¿®æ”¹è¿‡ï¼Œä»¥å†³å®šæ˜¯å¦éœ€è¦æ›´æ–°å®¢æˆ·ç«¯çš„ç¼“å­˜ã€‚</li><li><strong>åŒæ­¥</strong>ï¼šåœ¨è¿›è¡Œæ–‡ä»¶åŒæ­¥æ“ä½œæ—¶ï¼ˆæ¯”å¦‚ï¼Œå¤‡ä»½æˆ–è€…å°†æ–‡ä»¶ä»ä¸€ä¸ªè®¾å¤‡åŒæ­¥åˆ°å¦ä¸€ä¸ªè®¾å¤‡ï¼‰ï¼Œé€šè¿‡æ¯”è¾ƒæ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´ï¼Œå¯ä»¥åˆ¤æ–­å“ªäº›æ–‡ä»¶æ˜¯æ–°çš„æˆ–å·²æ›´æ”¹çš„ï¼Œé¿å…ä¸å¿…è¦çš„ä¼ è¾“ã€‚</li><li><strong>ç›‘æ§</strong>ï¼šå¯¹äºç›‘æ§ç³»ç»Ÿæ¥è¯´ï¼Œè·Ÿè¸ªæ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´å¯ä»¥å¸®åŠ©è¯†åˆ«é…ç½®æ›´æ”¹ã€æ—¥å¿—æ›´æ–°ç­‰äº‹ä»¶ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-14" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-14"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç®€å•çš„ç½‘ç«™ï¼Œæƒ³è¦å®ç°ä¸€ä¸ªåŠŸèƒ½ï¼šå½“å›¾ç‰‡æ–‡ä»¶è¢«æ›´æ–°åï¼Œè‡ªåŠ¨é€šçŸ¥ç½‘ç«™çš„ç”¨æˆ·ã€‚</p><ol><li><p><strong>è¯»å–æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´</strong></p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ£€æŸ¥å›¾ç‰‡æ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path/to/image.png</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">An error occurred:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Last modification time: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mtime</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ¯”è¾ƒä¿®æ”¹æ—¶é—´</strong></p><p>æ¥ä¸‹æ¥ï¼Œä½ å¯ä»¥å°†è·å–åˆ°çš„ä¿®æ”¹æ—¶é—´ä¸æŸä¸ªå‚ç…§æ—¶é—´ï¼ˆå¯èƒ½æ˜¯ä¸Šä¸€æ¬¡ç”¨æˆ·è®¿é—®çš„æ—¶é—´ï¼‰è¿›è¡Œæ¯”è¾ƒï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> lastVisitTime</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">2023-04-01T12:00:00</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å‡è®¾çš„ä¸Šæ¬¡è®¿é—®æ—¶é—´</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mtime</span><span style="color:#81A1C1;"> &gt;</span><span style="color:#D8DEE9;"> lastVisitTime</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Image has been updated since your last visit!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // è¿™é‡Œå¯ä»¥å‘é€æ›´æ–°é€šçŸ¥ç»™ç”¨æˆ·</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥å®ç°ä¸€ä¸ªç®€å•çš„æœºåˆ¶ï¼Œç”¨äºé€šçŸ¥ç”¨æˆ·æ–‡ä»¶ä½•æ—¶è¢«ä¿®æ”¹ï¼Œè¿›è€Œåˆ·æ–°å†…å®¹æˆ–è¿›è¡Œå…¶ä»–ç›¸åº”æ“ä½œã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œ<code>stats.mtime</code> åœ¨ Node.js ä¸­æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å±æ€§ï¼Œå®ƒå¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜å®ç°æ–‡ä»¶ä¿®æ”¹æ—¶é—´çš„è·Ÿè¸ªï¼Œä¸ºå„ç§åº”ç”¨æ¡ˆä¾‹æä¾›æ”¯æŒï¼Œå¦‚ç¼“å­˜ç®¡ç†ã€æ–‡ä»¶åŒæ­¥å’Œç³»ç»Ÿç›‘æ§ç­‰ã€‚</p><h4 id="stats-ctime" tabindex="-1"><a class="header-anchor" href="#stats-ctime"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsctime" target="_blank" rel="noopener noreferrer">stats.ctime</a></span></a></h4><p>Node.js ä¸­çš„ <code>stats.ctime</code> æ˜¯æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒä»£è¡¨äº†ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„â€œåˆ›å»ºæ—¶é—´â€ï¼ˆcreation timeï¼‰ã€‚ä½†åœ¨å¾ˆå¤šæ“ä½œç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªæ—¶é—´å®é™…ä¸Šåæ˜ çš„æ˜¯â€œinode æ›´æ”¹æ—¶é—´â€ï¼Œå³æœ€åä¸€æ¬¡ä¿®æ”¹æ–‡ä»¶èŠ‚ç‚¹ä¿¡æ¯çš„æ—¶é—´ã€‚è¿™å¯èƒ½åŒ…æ‹¬æ›´æ”¹æ–‡ä»¶çš„æƒé™ã€æ‰€æœ‰è€…ä»¥åŠå…¶ä»–ä¸€äº›å…ƒæ•°æ®ï¼Œè€Œä¸ä»…ä»…æ˜¯æ–‡ä»¶å†…å®¹ã€‚</p><p>é¦–å…ˆä½ éœ€è¦çŸ¥é“çš„æ˜¯ï¼ŒNode.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œè®©æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚åœ¨ Node.js ä¸­å¤„ç†æ–‡ä»¶ç³»ç»Ÿç›¸å…³ä»»åŠ¡æ—¶ï¼Œé€šå¸¸ä¼šç”¨åˆ°å†…ç½®çš„ <code>fs</code> æ¨¡å—ã€‚</p><p>ä»¥ä¸‹æ˜¯å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨ <code>stats.ctime</code> çš„åŸºæœ¬æ­¥éª¤å’Œç¤ºä¾‹ï¼š</p><ol><li><p>å¯¼å…¥<code>fs</code>æ¨¡å—ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ä½¿ç”¨ <code>fs.stat()</code> æˆ– <code>fs.statSync()</code> æ–¹æ³•è·å–æ–‡ä»¶çš„çŠ¶æ€ï¼Œè¿™å°†è¿”å›ä¸€ä¸ª <code>fs.Stats</code> å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº†æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ã€‚</p><p>å¼‚æ­¥ç‰ˆæœ¬ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ctime</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŒæ­¥ç‰ˆæœ¬ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ctime</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>åœ¨ä»¥ä¸Šä»£ç ä¸­ï¼Œæˆ‘ä»¬å°è¯•è·å–åä¸º <code>example.txt</code> æ–‡ä»¶çš„çŠ¶æ€ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œæˆ‘ä»¬å°±èƒ½ä»è¿”å›çš„ <code>stats</code> å¯¹è±¡ä¸­è®¿é—® <code>.ctime</code> å±æ€§ï¼Œå¹¶æ‰“å°å‡ºæ¥ã€‚å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œå¦‚æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šæ•è·å¼‚å¸¸å¹¶æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚</p><p>è®°ä½ï¼Œå¼‚æ­¥ç‰ˆæœ¬çš„ <code>fs.stat()</code> æ¨èç”¨äºå¤§å¤šæ•°æƒ…å†µï¼Œå› ä¸ºå®ƒä¸ä¼šé˜»å¡ç¨‹åºçš„æ‰§è¡Œï¼ˆå³ä¸ä¼šç­‰å¾…æ–‡ä»¶ç³»ç»Ÿçš„æ“ä½œå®Œæˆï¼‰ï¼Œè€ŒåŒæ­¥ç‰ˆæœ¬ <code>fs.statSync()</code> ä¼šé˜»å¡ç¨‹åºçš„æ‰§è¡Œï¼Œç›´åˆ°æ–‡ä»¶ç³»ç»Ÿæ“ä½œå®Œæˆã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-28" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-28"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦æ£€æŸ¥æ—¥å¿—æ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´ï¼Œä»¥ç¡®å®šä½•æ—¶æ›´æ–°äº†æ—¥å¿—ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">app.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ— æ³•è·å–æ–‡ä»¶çŠ¶æ€</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ—¥å¿—æ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´æ˜¯: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ctime</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬è·å– <code>app.log</code> æ–‡ä»¶çš„çŠ¶æ€ï¼Œå¹¶æ‰“å°å‡ºå…¶ <code>.ctime</code> å±æ€§ï¼Œè¿™æ ·å°±èƒ½çŸ¥é“æ—¥å¿—æ–‡ä»¶æœ€åä¸€æ¬¡æ›´æ”¹çš„æ—¶é—´ã€‚</p><h4 id="stats-birthtime" tabindex="-1"><a class="header-anchor" href="#stats-birthtime"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statsbirthtime" target="_blank" rel="noopener noreferrer">stats.birthtime</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒå…è®¸åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptï¼Œä¸ºå¼€å‘è€…æä¾›äº†æ„å»ºå¿«é€Ÿã€å¯æ‰©å±•ç½‘ç»œåº”ç”¨çš„èƒ½åŠ›ã€‚ä¸€ä¸ªå¸¸è§çš„åŠŸèƒ½éœ€æ±‚æ˜¯èƒ½å¤Ÿæ“ä½œæ–‡ä»¶ç³»ç»Ÿï¼Œä¾‹å¦‚åˆ›å»ºã€è¯»å–ã€ä¿®æ”¹æ–‡ä»¶ç­‰ã€‚Node.js é€šè¿‡å…¶<code>fs</code>æ¨¡å—ï¼ˆæ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼‰æä¾›äº†è¿™æ ·çš„èƒ½åŠ›ã€‚</p><p>åœ¨<code>fs</code>æ¨¡å—ä¸­ï¼Œ<code>stats</code>å¯¹è±¡æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µã€‚å½“ä½ ä½¿ç”¨<code>fs.stat()</code>, <code>fs.lstat()</code>å’Œ<code>fs.fstat()</code>åŠå…¶åŒæ­¥ç‰ˆæœ¬æ—¶ï¼Œå°±ä¼šå¾—åˆ°ä¸€ä¸ª<code>stats</code>å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åŒ…å«äº†å…³äºç‰¹å®šæ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ã€‚</p><h3 id="stats-birthtime-1" tabindex="-1"><a class="header-anchor" href="#stats-birthtime-1"><span>stats.birthtime</span></a></h3><p>åœ¨<code>stats</code>å¯¹è±¡ä¸­ï¼Œ<code>birthtime</code>å­—æ®µä»£è¡¨äº†æ–‡ä»¶æˆ–ç›®å½•çš„&quot;å‡ºç”Ÿæ—¶é—´&quot;ï¼Œå³å®ƒä»¬è¢«åˆ›å»ºçš„æ—¶é—´ã€‚å®ƒæ˜¯ä¸€ä¸ª JavaScript <code>Date</code>å¯¹è±¡ï¼Œè¡¨ç¤ºæ–‡ä»¶æˆ–ç›®å½•æœ€åˆè¢«åˆ›å»ºçš„æ—¥æœŸå’Œæ—¶é—´ã€‚</p><h4 id="å®é™…è¿ç”¨ä¾‹å­-37" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-37"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h4><ol><li><p><strong>æ–‡ä»¶ç®¡ç†ç³»ç»Ÿ</strong></p><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªæ–‡ä»¶ç®¡ç†ç³»ç»Ÿï¼Œéœ€è¦å±•ç¤ºæ¯ä¸ªæ–‡ä»¶çš„åˆ›å»ºæ—¥æœŸã€‚é€šè¿‡ä½¿ç”¨<code>fs.stat()</code>æ–¹æ³•è·å–æ¯ä¸ªæ–‡ä»¶çš„<code>stats</code>å¯¹è±¡ï¼Œç„¶åè®¿é—®å…¶ä¸­çš„<code>birthtime</code>å±æ€§ï¼Œå¯ä»¥è½»æ¾åœ°è·å–åˆ°è¿™äº›ä¿¡æ¯ï¼Œå¹¶åœ¨ç”¨æˆ·ç•Œé¢ä¸Šå±•ç¤ºç»™ç”¨æˆ·ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/your/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">File was created on: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">birthtime</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ¸…ç†æ—§æ–‡ä»¶</strong></p><p>åœ¨ä¸€ä¸ªæ—¥å¿—ç³»ç»Ÿä¸­ï¼Œå¯èƒ½éœ€è¦å®šæœŸæ¸…ç†æ—§çš„æ—¥å¿—æ–‡ä»¶ä»¥é‡Šæ”¾ç©ºé—´ã€‚é€šè¿‡æ£€æŸ¥æ–‡ä»¶çš„<code>birthtime</code>ï¼Œå¯ä»¥ç¡®å®šæ–‡ä»¶çš„å¹´é¾„ï¼Œå¦‚æœæ–‡ä»¶è¶…è¿‡ä¸€å®šçš„æ—¶é—´ï¼ˆæ¯”å¦‚ä¸€ä¸ªæœˆï¼‰ï¼Œå°±å¯ä»¥å°†å…¶åˆ é™¤ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">/path/to/logs/</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> cutoffDate</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">Date</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">now</span><span style="color:#D8DEE9FF;">() </span><span style="color:#81A1C1;">-</span><span style="color:#B48EAD;"> 30</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 24</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 60</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 60</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // ä¸€ä¸ªæœˆå‰</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readdir</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> files</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  files</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forEach</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">file</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">path</span><span style="color:#81A1C1;">}${</span><span style="color:#D8DEE9;">file</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">        console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        return;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">birthtime</span><span style="color:#ECEFF4;"> `</span><span style="color:#A3BE8C;">&lt;</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9;"> cutoffDate</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">        fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unlink</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">path</span><span style="color:#81A1C1;">}${</span><span style="color:#D8DEE9;">file</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">          if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">            console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">            return;</span></span>
<span class="line"><span style="color:#ECEFF4;">          }</span></span>
<span class="line"><span style="color:#D8DEE9;">          console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">file</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> was deleted.</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>å¤‡ä»½æ–°æ–‡ä»¶</strong></p><p>å¦‚æœä½ åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œä¸€ä¸ªè‡ªåŠ¨å¤‡ä»½è„šæœ¬ï¼Œå¯èƒ½éœ€è¦è¯†åˆ«å“ªäº›æ–‡ä»¶æ˜¯æ–°åˆ›å»ºçš„ï¼Œä»¥ä¾¿åªå¤‡ä»½é‚£äº›è‡ªä¸Šæ¬¡å¤‡ä»½ä»¥æ¥æ–°å¢çš„æ–‡ä»¶ã€‚é€šè¿‡æ¯”è¾ƒæ–‡ä»¶çš„<code>birthtime</code>ä¸ä¸Šæ¬¡å¤‡ä»½æ—¶é—´ï¼Œå¯ä»¥è½»æ¾å®ç°è¿™ä¸€ç‚¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> lastBackupDate</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Date</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">2023-03-25</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fileToCheck</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/new/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fileToCheck</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">birthtime</span><span style="color:#81A1C1;"> &gt;</span><span style="color:#D8DEE9;"> lastBackupDate</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // æ‰§è¡Œå¤‡ä»½é€»è¾‘</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">fileToCheck</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> needs to be backed up.</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ°<code>stats.birthtime</code>åœ¨æ–‡ä»¶å¤„ç†æ–¹é¢çš„å¤šç§åº”ç”¨ã€‚æ— è®ºæ˜¯ç®¡ç†æ–‡ä»¶ã€æ¸…ç†ã€è¿˜æ˜¯å¤‡ä»½ï¼ŒçŸ¥é“æ–‡ä»¶çš„åˆ›å»ºæ—¶é—´éƒ½æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚</p><h4 id="stat-time-values" tabindex="-1"><a class="header-anchor" href="#stat-time-values"><span><a href="https://nodejs.org/docs/latest/api/fs.html#stat-time-values" target="_blank" rel="noopener noreferrer">Stat time values</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©æˆ‘ä»¬èƒ½å¤Ÿåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œ JavaScript ä»£ç ã€‚Node.js v21.7.1 ä¸­æåŠçš„ &quot;Stat time values&quot; å…³è”åˆ°æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—ä¸­ä¸æ–‡ä»¶æˆ–ç›®å½•ä¿¡æ¯ç›¸å…³çš„éƒ¨åˆ†ã€‚</p><p>å½“ä½ ä½¿ç”¨ Node.js çš„ <code>fs</code> æ¨¡å—æ¥è·å–æ–‡ä»¶æˆ–ç›®å½•çš„ç»Ÿè®¡ä¿¡æ¯æ—¶ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ <code>fs.stat()</code>, <code>fs.lstat()</code>, æˆ– <code>fs.fstat()</code> æ–¹æ³•ï¼‰ï¼Œè¿”å›çš„å¯¹è±¡åŒ…å«äº†å¤šç§æ—¶é—´æˆ³å±æ€§ï¼Œåæ˜ äº†æ–‡ä»¶æˆ–ç›®å½•çš„ä¸åŒçŠ¶æ€ã€‚è¿™äº›æ—¶é—´æˆ³å±æ€§é€šå¸¸åŒ…æ‹¬ï¼š</p><ul><li><strong>atime</strong>: è®¿é—®æ—¶é—´ï¼ˆAccess Timeï¼‰ - æ–‡ä»¶æˆ–ç›®å½•æ•°æ®æœ€åä¸€æ¬¡è¢«è®¿é—®çš„æ—¶é—´ã€‚æ¯”å¦‚ï¼Œå½“ä½ æ‰“å¼€æˆ–é˜…è¯»æ–‡ä»¶æ—¶ï¼Œè¿™ä¸ªæ—¶é—´ä¼šè¢«æ›´æ–°ã€‚</li><li><strong>mtime</strong>: ä¿®æ”¹æ—¶é—´ï¼ˆModify Timeï¼‰ - æ–‡ä»¶å†…å®¹æœ€åä¸€æ¬¡è¢«ä¿®æ”¹çš„æ—¶é—´ã€‚å¦‚æœä½ ç¼–è¾‘äº†ä¸€ä¸ªæ–‡ä»¶å¹¶ä¿å­˜ï¼Œè¿™ä¸ªæ—¶é—´å°±ä¼šè¢«æ›´æ–°ã€‚</li><li><strong>ctime</strong>: æ›´æ”¹æ—¶é—´ï¼ˆChange Timeï¼‰ - æ–‡ä»¶çŠ¶æ€æœ€åä¸€æ¬¡æ›´æ”¹çš„æ—¶é—´ï¼Œæ¯”å¦‚æƒé™æ›´æ”¹ã€‚æ³¨æ„ï¼Œå®ƒä¸ä»…ä»…æ˜¯å†…å®¹çš„æ›´æ”¹ï¼Œä¹ŸåŒ…æ‹¬å…ƒæ•°æ®ï¼ˆå¦‚æƒé™æˆ–é“¾æ¥æ•°ï¼‰çš„æ›´æ”¹ã€‚</li><li><strong>birthtime</strong>: åˆ›å»ºæ—¶é—´ï¼ˆBirth Timeï¼‰ - æ–‡ä»¶æˆ–ç›®å½•è¢«åˆ›å»ºçš„æ—¶é—´ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-29" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-29"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨æ„å»ºä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦ç›‘æ§ä¸€ä¸ªç‰¹å®šç›®å½•ä¸‹æ–‡ä»¶çš„å˜åŒ–ï¼Œå¯ä»¥é€šè¿‡æ£€æŸ¥è¿™äº›æ—¶é—´æˆ³æ¥å®ç°ã€‚</p><h4 id="ç¤ºä¾‹-1-ç›‘æµ‹æ–‡ä»¶æ˜¯å¦è¢«æ›´æ–°" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ç›‘æµ‹æ–‡ä»¶æ˜¯å¦è¢«æ›´æ–°"><span>ç¤ºä¾‹ 1: ç›‘æµ‹æ–‡ä»¶æ˜¯å¦è¢«æ›´æ–°</span></a></h4><p>å¦‚æœä½ æƒ³æ£€æµ‹ä¸€ä¸ªæ–‡ä»¶æ˜¯å¦è¢«ä¿®æ”¹è¿‡ï¼Œå¯ä»¥æ£€æŸ¥å…¶ <code>mtime</code> å±æ€§ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ç¼–å†™ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œå®šæœŸæ£€æŸ¥æ–‡ä»¶çš„ <code>mtime</code>ï¼Œä»¥ç¡®å®šæ–‡ä»¶è‡ªä¸Šæ¬¡æ£€æŸ¥ä»¥æ¥æ˜¯å¦è¢«ä¿®æ”¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/your/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è·å–æ–‡ä»¶åˆå§‹çš„ä¿®æ”¹æ—¶é—´</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> initialMTime</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mtime</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getTime</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å®šæœŸæ£€æŸ¥æ–‡ä»¶æ˜¯å¦è¢«ä¿®æ”¹</span></span>
<span class="line"><span style="color:#88C0D0;">setInterval</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      return;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> currentMTime</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mtime</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getTime</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">currentMTime</span><span style="color:#81A1C1;"> &gt;</span><span style="color:#D8DEE9;"> initialMTime</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²è¢«ä¿®æ”¹</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">      // æ›´æ–°åˆå§‹ä¿®æ”¹æ—¶é—´ä¸ºå½“å‰æ—¶é—´</span></span>
<span class="line"><span style="color:#D8DEE9;">      initialMTime</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> currentMTime</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">},</span><span style="color:#B48EAD;"> 5000</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ¯5ç§’æ£€æŸ¥ä¸€æ¬¡</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-è®°å½•æ–‡ä»¶ç¬¬ä¸€æ¬¡åˆ›å»ºçš„æ—¶é—´" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-è®°å½•æ–‡ä»¶ç¬¬ä¸€æ¬¡åˆ›å»ºçš„æ—¶é—´"><span>ç¤ºä¾‹ 2: è®°å½•æ–‡ä»¶ç¬¬ä¸€æ¬¡åˆ›å»ºçš„æ—¶é—´</span></a></h4><p>åœ¨å¤„ç†ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œè®°å½•æ–‡ä»¶è¢«é¦–æ¬¡åˆ›å»ºçš„æ—¶é—´å¯èƒ½å¾ˆæœ‰ç”¨ã€‚è¿™å¯ä»¥é€šè¿‡æ£€æŸ¥ <code>birthtime</code> å±æ€§æ¥å®Œæˆã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/your/uploaded/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶é¦–æ¬¡åˆ›å»ºæ—¶é—´: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">birthtime</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ€»ä¹‹ï¼Œ&quot;Stat time values&quot; æä¾›äº†æ–‡ä»¶å’Œç›®å½•çŠ¶æ€çš„é‡è¦ä¿¡æ¯ï¼Œå¯ä»¥å¸®åŠ©ä½ åœ¨æ„å»ºåº”ç”¨æ—¶è¿›è¡Œæœ‰æ•ˆçš„ç®¡ç†å’Œç›‘æ§ã€‚</p><h3 id="class-fs-statfs" tabindex="-1"><a class="header-anchor" href="#class-fs-statfs"><span><a href="https://nodejs.org/docs/latest/api/fs.html#class-fsstatfs" target="_blank" rel="noopener noreferrer">Class: fs.StatFs</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒä½¿å¾—å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ï¼Œå¦‚æ­¤ä¸€æ¥ï¼Œå°±å¯ä»¥ç”¨åŒä¸€ç§è¯­è¨€æ¥ç¼–å†™å‰ç«¯å’Œåç«¯ä»£ç äº†ã€‚å…¶ä¸­ï¼Œ<code>fs</code> æ¨¡å—æ˜¯ Node.js çš„æ ¸å¿ƒæ¨¡å—ä¹‹ä¸€ï¼Œæä¾›äº†æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„æ¥å£ã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>fs.StatFs</code> æ˜¯ä¸€ä¸ªæ–°å¢çš„ç±»ï¼Œå®ƒæä¾›äº†æ–¹æ³•å’Œå±æ€§æ¥è·å–æ–‡ä»¶ç³»ç»Ÿçš„ç»Ÿè®¡ä¿¡æ¯ã€‚è¿™ç±»ä¿¡æ¯é€šå¸¸åŒ…æ‹¬æ€»ç©ºé—´ã€å¯ç”¨ç©ºé—´ã€æ–‡ä»¶ç³»ç»Ÿç±»å‹ç­‰ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Šï¼Œå¯ç”¨çš„ç»Ÿè®¡ä¿¡æ¯å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚</p><h3 id="ä½¿ç”¨-fs-statfs" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-fs-statfs"><span>ä½¿ç”¨ <code>fs.StatFs</code>ï¼š</span></a></h3><p>ä¸ºäº†ä½¿ç”¨ <code>fs.StatFs</code> ç±»ï¼Œé¦–å…ˆä½ éœ€è¦å¯¼å…¥ <code>fs</code> æ¨¡å—ã€‚åœ¨ Node.js ä¸­ï¼Œå¯¼å…¥æ¨¡å—é€šå¸¸ä½¿ç”¨ <code>require()</code> å‡½æ•°ã€‚ç„¶è€Œï¼Œè¯·æ³¨æ„ï¼Œæˆªè‡³æˆ‘æœ€åçš„çŸ¥è¯†æ›´æ–°ï¼ŒNode.js å®˜æ–¹æ–‡æ¡£å¹¶æœªç›´æ¥å±•ç¤ºå¦‚ä½•å®ä¾‹åŒ– <code>fs.StatFs</code> æˆ–è·å–æ–‡ä»¶ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯çš„ç¤ºä¾‹ä»£ç ã€‚å› æ­¤ï¼Œæˆ‘å°†åŸºäºå¯¹ Node.js æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„é€šç”¨ç†è§£æä¾›ä¸€ä¸ªå‡è®¾æ€§çš„ç¤ºä¾‹ã€‚å¦‚æœ Node.js v21.7.1 æœ‰ç‰¹å®šçš„æ–°æ–¹æ³•å¼•å…¥ï¼Œå»ºè®®æŸ¥é˜…æœ€æ–°çš„å®˜æ–¹æ–‡æ¡£è·å–å‡†ç¡®ä¿¡æ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å¯¼å…¥ fs æ¨¡å—</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾ Node.js æä¾›äº†ä¸€ä¸ªæ–¹æ³•æ¥å¼‚æ­¥è·å–æ–‡ä»¶ç³»ç»Ÿçš„ç»Ÿè®¡ä¿¡æ¯</span></span>
<span class="line"><span style="color:#616E88;">// é€šå¸¸è¿™æ ·çš„æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª Promiseï¼Œæˆ–å…è®¸ä¼ é€’ä¸€ä¸ªå›è°ƒå‡½æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç¤ºä¾‹: ä½¿ç”¨ Promise è·å– &#39;/&#39; ç›®å½•çš„æ–‡ä»¶ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statFs</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">then</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">error</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error getting file system statistics:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æˆ–è€…ï¼Œå¦‚æœå­˜åœ¨åŒæ­¥ç‰ˆæœ¬ï¼ˆè¿™å–å†³äºå…·ä½“å®ç°ï¼‰</span></span>
<span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statFsSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error getting file system statistics:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨ä¾‹å­-38" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-38"><span>å®é™…è¿ç”¨ä¾‹å­ï¼š</span></a></h3><ol><li><p><strong>ç›‘æ§ç£ç›˜ç©ºé—´</strong>ï¼šä½¿ç”¨ <code>fs.StatFs</code> å¯ä»¥å¸®åŠ©å¼€å‘è€…ç¼–å†™è„šæœ¬æˆ–åº”ç”¨ç¨‹åºæ¥ç›‘æ§æœåŠ¡å™¨ä¸Šçš„ç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µã€‚ä¾‹å¦‚ï¼Œå¦‚æœå¯ç”¨ç©ºé—´ä½äºæŸä¸ªé˜ˆå€¼ï¼Œç¨‹åºå¯ä»¥è‡ªåŠ¨å‘é€è­¦æŠ¥ç»™ç®¡ç†å‘˜ã€‚</p></li><li><p><strong>ç®¡ç†æ–‡ä»¶å­˜å‚¨</strong>ï¼šå¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦å¤§é‡è¯»å†™æ–‡ä»¶çš„åº”ç”¨ï¼Œäº†è§£æ–‡ä»¶ç³»ç»Ÿçš„å½“å‰çŠ¶æ€å¯ä»¥å¸®åŠ©ä¼˜åŒ–å­˜å‚¨åˆ†é…å’Œæ–‡ä»¶ç®¡ç†ç­–ç•¥ã€‚</p></li><li><p><strong>å¥åº·æ£€æŸ¥å’Œè¯Šæ–­å·¥å…·</strong>ï¼šåœ¨æŸäº›å¤æ‚çš„ç³»ç»Ÿä¸­ï¼Œäº†è§£å„ä¸ªéƒ¨åˆ†çš„æ–‡ä»¶ç³»ç»ŸçŠ¶æ€å¯¹äºç»´æŠ¤ç³»ç»Ÿçš„å¥åº·è‡³å…³é‡è¦ã€‚ä½¿ç”¨ <code>fs.StatFs</code>ï¼Œå¯ä»¥æ„å»ºå‡ºä¸€å¥—å·¥å…·æ¥å®šæœŸæ£€æŸ¥å’ŒæŠ¥å‘Šç³»ç»Ÿçš„å¥åº·çŠ¶å†µã€‚</p></li></ol><p>è¯·æ³¨æ„ï¼Œä¸Šè¿°ä»£ç å’Œåº”ç”¨åœºæ™¯æ˜¯åŸºäºå¯¹ <code>fs</code> æ¨¡å—åŠå¸¸è§æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„ç†è§£æä¾›çš„å‡è®¾æ€§æè¿°ã€‚å…·ä½“åˆ° <code>fs.StatFs</code> ç±»çš„ä½¿ç”¨ï¼Œå¼ºçƒˆæ¨èæŸ¥é˜…æœ€æ–°çš„ Node.js å®˜æ–¹æ–‡æ¡£ï¼Œå› ä¸º Node.js çš„å¼€å‘éå¸¸æ´»è·ƒï¼Œæ–°ç‰ˆæœ¬å¯èƒ½ä¼šå¸¦æ¥å˜åŒ–å’Œæ”¹è¿›ã€‚</p><h4 id="statfs-bavail" tabindex="-1"><a class="header-anchor" href="#statfs-bavail"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statfsbavail" target="_blank" rel="noopener noreferrer">statfs.bavail</a></span></a></h4><p>ç†è§£<code>statfs.bavail</code>é¦–å…ˆéœ€è¦äº†è§£ Node.js ä¸­çš„<code>fs</code>æ¨¡å—ã€‚<code>fs</code>æ¨¡å—æ˜¯ Node.js çš„ä¸€ä¸ªå†…ç½®æ¨¡å—ï¼Œç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚è¿™å¯ä»¥åŒ…æ‹¬è¯»å†™æ–‡ä»¶ï¼Œæ“ä½œç›®å½•ï¼Œä»¥åŠè·å–æ–‡ä»¶ç³»ç»Ÿçš„ä¿¡æ¯ç­‰åŠŸèƒ½ã€‚åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>fs</code>æ¨¡å—æä¾›äº†ä¸€ä¸ªæ–¹æ³•<code>statfs</code>ï¼Œå®ƒç”¨äºè·å–æ–‡ä»¶ç³»ç»Ÿçš„ç»Ÿè®¡ä¿¡æ¯ã€‚</p><h3 id="statfs-bavailçš„å«ä¹‰" tabindex="-1"><a class="header-anchor" href="#statfs-bavailçš„å«ä¹‰"><span><code>statfs.bavail</code>çš„å«ä¹‰ï¼š</span></a></h3><p>åœ¨<code>fs.statfs</code>æ–¹æ³•å¾—åˆ°çš„å¯¹è±¡ä¸­ï¼Œ<code>bavail</code>æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„å±æ€§ã€‚<code>bavail</code>ä»£è¡¨â€œå¯ç”¨çš„å—æ•°â€ã€‚è¯´å¾—æ›´é€šä¿—ä¸€äº›ï¼Œæ–‡ä»¶ç³»ç»Ÿæ˜¯ç”±è®¸å¤šâ€œå—â€ç»„æˆçš„ï¼Œè€Œæ¯ä¸ªâ€œå—â€éƒ½æœ‰ä¸€ä¸ªå›ºå®šçš„å¤§å°ï¼ˆæ¯”å¦‚ 4KBï¼‰ã€‚<code>bavail</code>å°±æ˜¯è¡¨ç¤ºå¯¹æ™®é€šç”¨æˆ·å¯ç”¨çš„è¿™äº›å—çš„æ•°é‡ã€‚æ³¨æ„ï¼ŒæŸäº›æ–‡ä»¶ç³»ç»Ÿä¼šä¸ºç³»ç»Ÿç®¡ç†å‘˜ä¿ç•™ä¸€éƒ¨åˆ†å—ï¼Œè¿™éƒ¨åˆ†å—ä¸åŒ…æ‹¬åœ¨<code>bavail</code>è®¡æ•°ä¸­ã€‚</p><h3 id="ä¸ºä»€ä¹ˆbavailé‡è¦" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆbavailé‡è¦"><span>ä¸ºä»€ä¹ˆ<code>bavail</code>é‡è¦ï¼Ÿ</span></a></h3><p>äº†è§£<code>bavail</code>å¯ä»¥å¸®åŠ©ä½ äº†è§£ç£ç›˜ä¸Šè¿˜æœ‰å¤šå°‘ç©ºé—´å¯ä»¥è¢«æ™®é€šç¨‹åºä½¿ç”¨ã€‚è¿™å¯¹äºç®¡ç†ç£ç›˜ç©ºé—´ã€é¿å…ç£ç›˜æ»¡æº¢ã€ä»¥åŠç¡®ä¿ç¨‹åºèƒ½å¤Ÿæ­£å¸¸å·¥ä½œéå¸¸é‡è¦ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-39" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-39"><span>å®é™…è¿ç”¨ä¾‹å­ï¼š</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œè¿™ä¸ªåº”ç”¨ç¨‹åºéœ€è¦ä¸‹è½½å¤§é‡çš„æ•°æ®å¹¶å­˜å‚¨åœ¨ç”¨æˆ·çš„ç”µè„‘ä¸Šã€‚åœ¨å¼€å§‹ä¸‹è½½ä¹‹å‰ï¼Œä½ æƒ³ç¡®è®¤ç¡¬ç›˜ä¸Šæœ‰è¶³å¤Ÿçš„ç©ºé—´æ¥å­˜å‚¨è¿™äº›æ•°æ®ã€‚è¿™æ—¶å€™ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨<code>fs.statfs</code>æ–¹æ³•å¹¶æ£€æŸ¥<code>bavail</code>å€¼æ¥åˆ¤æ–­æ˜¯å¦æœ‰è¶³å¤çš„ç©ºé—´ã€‚</p><h4 id="ç¤ºä¾‹ä»£ç -8" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç -8"><span>ç¤ºä¾‹ä»£ç ï¼š</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> checkDiskSpace</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statfs</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> blockSize</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">bsize</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ¯ä¸ªå—çš„å¤§å°ï¼Œå•ä½å­—èŠ‚</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> availableBlocks</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">bavail</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å¯ç”¨å—æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // è®¡ç®—å¯ç”¨ç©ºé—´ï¼ˆå•ä½ï¼šå­—èŠ‚ï¼‰</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> availableSpace</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> blockSize</span><span style="color:#81A1C1;"> *</span><span style="color:#D8DEE9;"> availableBlocks</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Available space: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">availableSpace</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> bytes</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // å¦‚æœä½ æƒ³å°†å­—èŠ‚è½¬æ¢ä¸ºæ›´æ˜“è¯»çš„GBï¼Œå¯ä»¥è¿™æ ·åšï¼š</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">      `</span><span style="color:#A3BE8C;">Available space: </span><span style="color:#81A1C1;">${</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">availableSpace</span><span style="color:#81A1C1;"> /</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> **</span><span style="color:#B48EAD;"> 3</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">toFixed</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> GB</span><span style="color:#ECEFF4;">`</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    )</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    return</span><span style="color:#D8DEE9;"> availableSpace</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Failed to check disk space:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ç¤ºä¾‹ï¼Œæ£€æŸ¥å½“å‰ç›®å½•æ‰€åœ¨çš„ç£ç›˜ç©ºé—´</span></span>
<span class="line"><span style="color:#88C0D0;">checkDiskSpace</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥<code>fs</code>æ¨¡å—ä¸­çš„<code>promises</code>æ¥å£ï¼Œç„¶åå®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•°<code>checkDiskSpace</code>ï¼Œå®ƒæ¥å—ä¸€ä¸ªè·¯å¾„å‚æ•°ã€‚é€šè¿‡è°ƒç”¨<code>fs.statfs</code>ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè·å–æ–‡ä»¶ç³»ç»Ÿçš„ç»Ÿè®¡ä¿¡æ¯ï¼Œå¹¶è¿›ä¸€æ­¥è®¡ç®—å‡ºå¯ç”¨ç©ºé—´ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚æœ€åï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªå¯ç”¨ç©ºé—´ä»¥å­—èŠ‚å’Œ GB ä¸ºå•ä½æ‰“å°å‡ºæ¥ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥åœ¨å®é™…çš„åº”ç”¨ä¸­åŠ¨æ€åœ°ç›‘æµ‹ç£ç›˜ç©ºé—´ï¼Œç¡®ä¿ä½ çš„ç¨‹åºæœ‰è¶³å¤Ÿçš„ç©ºé—´æ‰§è¡Œå…¶æ“ä½œã€‚</p><h4 id="statfs-bfree" tabindex="-1"><a class="header-anchor" href="#statfs-bfree"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statfsbfree" target="_blank" rel="noopener noreferrer">statfs.bfree</a></span></a></h4><p>Node.js çš„ <code>statfs.bfree</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå®ƒæä¾›äº†å…³äºæ–‡ä»¶ç³»ç»Ÿçš„ä¿¡æ¯ã€‚å…·ä½“æ¥è¯´ï¼Œ<code>statfs.bfree</code> è¡¨ç¤ºåœ¨æ–‡ä»¶ç³»ç»Ÿä¸­æœ‰å¤šå°‘ä¸ªç©ºé—²çš„å—ï¼ˆblockï¼‰ã€‚è¿™é‡Œçš„â€œå—â€æ˜¯å­˜å‚¨æ•°æ®çš„åŸºæœ¬å•ä½ï¼Œåœ¨ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿä¸­å¤§å°å¯èƒ½ä¸åŒï¼Œé€šå¸¸ä¸ºå‡ åƒå­—èŠ‚ã€‚</p><p>è¦ç†è§£ <code>statfs.bfree</code>ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦æ˜ç¡®å‡ ä¸ªæ¦‚å¿µï¼š</p><ol><li><strong>æ–‡ä»¶ç³»ç»Ÿ</strong>ï¼šè®¡ç®—æœºç”¨æ¥æ§åˆ¶å¦‚ä½•å­˜å‚¨å’Œæ£€ç´¢æ•°æ®çš„ä¸€ç§æ–¹æ³•ã€‚ä¸åŒçš„æ“ä½œç³»ç»Ÿï¼ˆå¦‚ Windows, macOS, Linuxï¼‰å¯èƒ½ä½¿ç”¨ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿï¼ˆå¦‚ NTFS, APFS, ext4 ç­‰ï¼‰ã€‚</li><li><strong>å—ï¼ˆBlockï¼‰</strong>ï¼šæ–‡ä»¶ç³»ç»Ÿå­˜å‚¨ä¿¡æ¯çš„åŸºæœ¬å•ä½ã€‚å½“æ–‡ä»¶è¢«å†™å…¥ç£ç›˜æ—¶ï¼Œå®ƒä¼šè¢«åˆ†å‰²æˆä¸€å—ä¸€å—çš„æ•°æ®å­˜å‚¨èµ·æ¥ã€‚å—çš„å¤§å°å›ºå®šï¼Œä½†å¯ä»¥åœ¨ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿä¸­æœ‰æ‰€ä¸åŒã€‚</li></ol><h3 id="å®é™…è¿ç”¨ä¾‹å­-40" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-40"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>æƒ³è±¡ä½ æ­£åœ¨ç®¡ç†ä¸€ä¸ªæœåŠ¡å™¨ï¼Œä¸Šé¢è¿è¡Œç€ä¸€ä¸ªç½‘ç«™ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼ŒæœåŠ¡å™¨ä¸Šå­˜å‚¨çš„æ•°æ®è¶Šæ¥è¶Šå¤šï¼Œç©ºé—´ä¹Ÿè¶Šæ¥è¶Šç´§å¼ ã€‚åœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼ŒçŸ¥é“è¿˜å‰©å¤šå°‘ç©ºé—´æ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºå¦‚æœç©ºé—´æ»¡äº†ï¼Œé‚£ä¹ˆç”¨æˆ·å¯èƒ½æ— æ³•ä¸Šä¼ æ–‡ä»¶ï¼Œç½‘ç«™ä¹Ÿå¯èƒ½å› æ­¤å‡ºç°æ•…éšœã€‚</p><p>ä½¿ç”¨ Node.jsï¼Œä½ å¯ä»¥ç¼–å†™ä¸€ä¸ªè„šæœ¬æ¥ç›‘è§†æ–‡ä»¶ç³»ç»Ÿçš„ç©ºé—´ä½¿ç”¨æƒ…å†µï¼Œ<code>statfs.bfree</code> å°±åœ¨è¿™é‡Œå‘æŒ¥ä½œç”¨ã€‚é€šè¿‡è·å–ç©ºé—²å—çš„æ•°é‡ï¼Œä½ å¯ä»¥è®¡ç®—å‡ºè¿˜æœ‰å¤šå°‘ç©ºé—´å¯ç”¨ã€‚</p><h4 id="ç¤ºä¾‹ä»£ç -9" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç -9"><span>ç¤ºä¾‹ä»£ç </span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> checkFreeSpace</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statfs</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> freeBlocks</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">bfree</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">There are </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">freeBlocks</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> free blocks in the file system.</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å‡è®¾æ¯ä¸ªå—çš„å¤§å°ä¸º 4096 å­—èŠ‚ï¼ˆè¿™å–å†³äºä½ çš„æ–‡ä»¶ç³»ç»Ÿï¼‰</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> blockSize</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 4096</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¿™ä¸ªå€¼å¯èƒ½éœ€è¦æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> freeSpaceBytes</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> freeBlocks</span><span style="color:#81A1C1;"> *</span><span style="color:#D8DEE9;"> blockSize</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Approximate free space: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">freeSpaceBytes</span><span style="color:#81A1C1;"> /</span><span style="color:#ECEFF4;"> (</span><span style="color:#B48EAD;">1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> MB</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Failed to check free space:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ£€æŸ¥æ ¹ç›®å½•çš„ç©ºé—²ç©ºé—´</span></span>
<span class="line"><span style="color:#88C0D0;">checkFreeSpace</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡ <code>fs.promises.statfs</code> è·å–äº†æŒ‡å®šè·¯å¾„ï¼ˆè¿™é‡Œæ˜¯æ ¹ç›®å½• <code>&#39;/&#39;</code>ï¼‰çš„æ–‡ä»¶ç³»ç»ŸçŠ¶æ€ã€‚ç„¶åï¼Œæˆ‘ä»¬ä»è¿”å›çš„å¯¹è±¡ä¸­å–å‡º <code>bfree</code> å±æ€§ï¼Œå³ç©ºé—²å—çš„æ•°é‡ã€‚é€šè¿‡ä¹˜ä»¥å—çš„å¤§å°ï¼ˆè¿™é‡Œå‡è®¾æ˜¯ 4096 å­—èŠ‚ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¤§è‡´çš„ç©ºé—²ç©ºé—´å¤§å°ï¼Œå¹¶å°†å…¶è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚</p><p>æ³¨æ„ï¼š<code>fs.statfs</code> åœ¨ Node.js ä¸­æ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°çš„ APIï¼Œæ—§ç‰ˆæœ¬çš„ Node.js å¯èƒ½ä¸æ”¯æŒã€‚æ­¤å¤–ï¼Œå—çš„å¤§å°ï¼ˆåœ¨ä¸Šé¢çš„ä»£ç ä¸­å‡å®šä¸º 4096 å­—èŠ‚ï¼‰éœ€è¦æ ¹æ®å®é™…ä½¿ç”¨çš„æ–‡ä»¶ç³»ç»Ÿæ¥ç¡®å®šã€‚</p><h4 id="statfs-blocks" tabindex="-1"><a class="header-anchor" href="#statfs-blocks"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statfsblocks" target="_blank" rel="noopener noreferrer">statfs.blocks</a></span></a></h4><p>è¦ç†è§£ <code>statfs.blocks</code>ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£å‡ ä¸ªå…³é”®çš„æ¦‚å¿µã€‚</p><h3 id="åŸºç¡€æ¦‚å¿µ-4" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æ¦‚å¿µ-4"><span>åŸºç¡€æ¦‚å¿µ</span></a></h3><ol><li><strong>Node.js</strong>: ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œè®©ä½ å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚</li><li><strong>æ–‡ä»¶ç³»ç»Ÿ(fs)</strong>: è´Ÿè´£ç®¡ç†æ•°æ®å­˜å‚¨çš„ä¸€ç§ç³»ç»Ÿï¼Œå®ƒèƒ½è®©ä½ åˆ›å»ºã€è¯»å–ã€æ›´æ–°å’Œåˆ é™¤å­˜å‚¨åœ¨è®¡ç®—æœºä¸Šçš„æ–‡ä»¶ã€‚</li><li><strong>Statfs</strong>: åœ¨ Node.js çš„<code>fs</code>æ¨¡å—ä¸­, <code>statfs</code>æ˜¯ä¸€ä¸ªç”¨æ¥è·å–æ–‡ä»¶ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯çš„åŠŸèƒ½ã€‚</li></ol><h3 id="statfs-blocks-1" tabindex="-1"><a class="header-anchor" href="#statfs-blocks-1"><span>statfs.blocks</span></a></h3><p><code>statfs.blocks</code>æ˜¯ä»<code>statfs</code>å‡½æ•°è¿”å›çš„å¯¹è±¡ä¸­çš„ä¸€ä¸ªå±æ€§ã€‚è¿™ä¸ªå±æ€§è¡¨ç¤ºæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ€»å—æ•°ã€‚&quot;å—&quot;æ˜¯æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨ä¸­çš„åŸºæœ¬å•ä½ï¼Œé€šå¸¸å¤§å°ä¸º 4KB æˆ–è€…æ›´å¤§ã€‚æ¯ä¸ªæ–‡ä»¶éƒ½å æ®ä¸€ä¸ªæˆ–å¤šä¸ªè¿™æ ·çš„å—ã€‚</p><p>è¦ä½¿ç”¨<code>statfs</code>åŠŸèƒ½ï¼Œä½ é¦–å…ˆéœ€è¦ä½¿ç”¨ Node.js çš„<code>fs</code>æ¨¡å—ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> getFilesystemStats</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statfs</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Total blocks in filesystem: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">blocks</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error getting filesystem stats:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">getFilesystemStats</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è·å–æ ¹ç›®å½•çš„æ–‡ä»¶ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼š</p><ul><li>æˆ‘ä»¬å¯¼å…¥äº† Node.js çš„<code>fs</code>æ¨¡å—ï¼ˆä»¥ Promise å½¢å¼ï¼Œæ–¹ä¾¿å¼‚æ­¥å¤„ç†ï¼‰ã€‚</li><li>å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•°<code>getFilesystemStats</code>ï¼Œæ¥å—ä¸€ä¸ªè·¯å¾„ä½œä¸ºå‚æ•°ã€‚</li><li>åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>await</code>è°ƒç”¨<code>fs.statfs(path)</code>æ¥å¼‚æ­¥è·å–æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯ã€‚</li><li>æ‰“å°å‡ºæ–‡ä»¶ç³»ç»Ÿçš„æ€»å—æ•°ï¼Œé€šè¿‡è®¿é—®<code>stats.blocks</code>å±æ€§ã€‚</li><li>åœ¨æœ€åï¼Œæˆ‘ä»¬è°ƒç”¨<code>getFilesystemStats(&#39;/&#39;)</code>æ¥è·å–æ ¹ç›®å½•(<code>/</code>)çš„æ–‡ä»¶ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯ã€‚</li></ul><h3 id="å®é™…åº”ç”¨åœºæ™¯-6" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨åœºæ™¯-6"><span>å®é™…åº”ç”¨åœºæ™¯</span></a></h3><p>äº†è§£æ–‡ä»¶ç³»ç»Ÿçš„å—æ•°æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿè¿™é‡Œæä¾›ä¸¤ä¸ªåœºæ™¯ï¼š</p><ol><li><p><strong>ç£ç›˜ç©ºé—´ç›‘æ§</strong>ï¼šç³»ç»Ÿç®¡ç†å‘˜å¯èƒ½æƒ³ç›‘æ§ä¸€å°æœºå™¨æˆ–ç‰¹å®šåˆ†åŒºçš„ç£ç›˜ä½¿ç”¨æƒ…å†µï¼Œä»¥ç¡®ä¿ä¸ä¼šè€—å°½å­˜å‚¨ç©ºé—´ã€‚é€šè¿‡å®šæœŸæ£€æŸ¥<code>statfs.blocks</code>ä¸å…¶ä»–ç›¸å…³ä¿¡æ¯ï¼ˆå¦‚å¯ç”¨å—æ•°ï¼‰ï¼Œå¯ä»¥é¢„æµ‹ä½•æ—¶å¯èƒ½éœ€è¦æ‰©å±•å­˜å‚¨æˆ–æ¸…ç†æ— ç”¨æ–‡ä»¶ã€‚</p></li><li><p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šå¯¹äºå¤§å‹ã€é«˜æ€§èƒ½è¦æ±‚çš„åº”ç”¨ï¼Œäº†è§£æ–‡ä»¶ç³»ç»Ÿçš„ä½¿ç”¨æƒ…å†µå¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜åšå‡ºæ›´å¥½çš„æ¶æ„å†³ç­–ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå‘ç°æŸä¸ªæœåŠ¡é¢‘ç¹è¯»å†™æ“ä½œå¯¼è‡´çš„å—æ•°å¢é•¿å¼‚å¸¸ï¼Œå¯èƒ½éœ€è¦è€ƒè™‘è°ƒæ•´æ–‡ä»¶å­˜å‚¨ç»“æ„æˆ–é‡‡ç”¨ä¸åŒçš„æ•°æ®å­˜å‚¨æ–¹æ¡ˆã€‚</p></li></ol><p>é€šè¿‡<code>statfs</code>æä¾›çš„è¯¦ç»†æ–‡ä»¶ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯ï¼Œå¼€å‘äººå‘˜å’Œç³»ç»Ÿç®¡ç†å‘˜å¯ä»¥åšå‡ºæ›´æ˜æ™ºçš„å†³ç­–ï¼Œæå‡ç³»ç»Ÿæ€§èƒ½å¹¶é¿å…æ½œåœ¨çš„å­˜å‚¨é—®é¢˜ã€‚</p><h4 id="statfs-bsize" tabindex="-1"><a class="header-anchor" href="#statfs-bsize"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statfsbsize" target="_blank" rel="noopener noreferrer">statfs.bsize</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚åœ¨ Node.js çš„å„ç§åŠŸèƒ½ä¸­ï¼Œæ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>ï¼‰æ¨¡å—æ˜¯éå¸¸é‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œå› ä¸ºå®ƒå…è®¸ä½ ä¸æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚<code>fs</code>æ¨¡å—æä¾›äº†å¾ˆå¤šç”¨äºæ–‡ä»¶æ“ä½œçš„æ–¹æ³•ï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶å†…å®¹ã€å†™å…¥æ–‡ä»¶ã€åˆ é™¤æ–‡ä»¶ç­‰ã€‚åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>fs</code>æ¨¡å—æ–°å¢äº†ä¸€ä¸ªåŠŸèƒ½å«åš<code>statfs</code>ã€‚</p><h3 id="statfs-bsize-1" tabindex="-1"><a class="header-anchor" href="#statfs-bsize-1"><span><code>statfs.bsize</code></span></a></h3><p>åœ¨è§£é‡Š<code>statfs.bsize</code>ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“<code>statfs</code>æ˜¯ä»€ä¹ˆã€‚<code>statfs</code>æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒæä¾›äº†ä¸€ç§æ–¹å¼æ¥è·å–æ–‡ä»¶ç³»ç»Ÿçš„ç»Ÿè®¡ä¿¡æ¯ï¼Œæ¯”å¦‚å¯ç”¨ç©ºé—´å¤§å°ã€æ€»ç©ºé—´å¤§å°ã€æ–‡ä»¶ç³»ç»Ÿç±»å‹ç­‰ã€‚è¿™äº›ä¿¡æ¯å¯¹äºç†è§£å’Œç›‘æ§æ–‡ä»¶ç³»ç»ŸçŠ¶æ€éå¸¸æœ‰ç”¨ã€‚</p><p><code>statfs.bsize</code>æ˜¯åœ¨<code>statfs</code>æ–¹æ³•è¿”å›çš„å¯¹è±¡ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œè¡¨ç¤ºæ–‡ä»¶ç³»ç»Ÿå—çš„â€œä¼˜åŒ–â€å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚è¿™ä¸ªå€¼å¯¹äºç¡®å®šæœ€ä½³çš„ I/O æ“ä½œå¤§å°å¾ˆæœ‰å¸®åŠ©ï¼Œå› æ­¤å¯ä»¥ç”¨æ¥æé«˜æ–‡ä»¶è¯»å†™æ•ˆç‡ã€‚</p><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-15" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-15"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-æ£€æµ‹ç£ç›˜ç©ºé—´å¹¶å†³å®šæ˜¯å¦å¤‡ä»½" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æ£€æµ‹ç£ç›˜ç©ºé—´å¹¶å†³å®šæ˜¯å¦å¤‡ä»½"><span>ç¤ºä¾‹ 1ï¼šæ£€æµ‹ç£ç›˜ç©ºé—´å¹¶å†³å®šæ˜¯å¦å¤‡ä»½</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œéœ€è¦å®šæœŸå¤‡ä»½æ•°æ®åˆ°ç¡¬ç›˜ã€‚åœ¨å¤‡ä»½ä¹‹å‰ï¼Œä½ éœ€è¦ç¡®ä¿ç£ç›˜ä¸Šæœ‰è¶³å¤Ÿçš„ç©ºé—´ã€‚ä½¿ç”¨<code>statfs</code>ï¼Œä½ å¯ä»¥è·å–ç£ç›˜ç©ºé—´ä¿¡æ¯ï¼Œå¹¶å†³å®šæ˜¯å¦è¿›è¡Œå¤‡ä»½æ“ä½œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> checkDiskSpaceAndBackup</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statfs</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å‡è®¾æˆ‘ä»¬åœ¨æ ¹ç›®å½•ä¸‹æ“ä½œ</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> freeSpace</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">bavail</span><span style="color:#81A1C1;"> *</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">bsize</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å¯ç”¨ç©ºé—´ = å¯ç”¨å—æ•° * å—å¤§å°</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">freeSpace</span><span style="color:#81A1C1;"> &gt;</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">      // å‡è®¾æˆ‘ä»¬éœ€è¦è‡³å°‘1GBç©ºé—´æ¥è¿›è¡Œå¤‡ä»½</span></span>
<span class="line"><span style="color:#616E88;">      // æ‰§è¡Œå¤‡ä»½æ“ä½œ...</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æœ‰è¶³å¤Ÿç©ºé—´è¿›è¡Œå¤‡ä»½</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç©ºé—´ä¸è¶³ï¼Œæ— æ³•è¿›è¡Œå¤‡ä»½</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ£€æµ‹ç£ç›˜ç©ºé—´æ—¶å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">checkDiskSpaceAndBackup</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-ä¼˜åŒ–æ–‡ä»¶è¯»å†™æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä¼˜åŒ–æ–‡ä»¶è¯»å†™æ“ä½œ"><span>ç¤ºä¾‹ 2ï¼šä¼˜åŒ–æ–‡ä»¶è¯»å†™æ“ä½œ</span></a></h4><p>å¦‚æœä½ æ­£å¼€å‘ä¸€ä¸ªéœ€è¦é¢‘ç¹è¯»å†™å¤§é‡æ•°æ®çš„åº”ç”¨ï¼Œäº†è§£æ–‡ä»¶ç³»ç»Ÿçš„å—å¤§å°å¯ä»¥å¸®åŠ©ä½ ä¼˜åŒ–è¿™äº›æ“ä½œã€‚é€šè¿‡å°†è¯»å†™æ“ä½œçš„ç¼“å†²åŒºå¤§å°è®¾ç½®ä¸ºæ–‡ä»¶ç³»ç»Ÿçš„å—å¤§å°æˆ–å…¶å€æ•°ï¼Œå¯ä»¥æé«˜æ•ˆç‡ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> optimizedFileWrite</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statfs</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> optimalBlockSize</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">bsize</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // åˆ›å»ºä¸€ä¸ªåˆé€‚å¤§å°çš„Buffer</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">optimalBlockSize</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å‡è®¾dataæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬æŠŠå®ƒå¡«å……åˆ°bufferä¸­</span></span>
<span class="line"><span style="color:#D8DEE9;">    buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å°†bufferå†™å…¥æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">    await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å†™å…¥æˆåŠŸï¼Œä½¿ç”¨äº†ä¼˜åŒ–çš„å—å¤§å°</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å†™å…¥æ–‡ä»¶æ—¶å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ€»ç»“-21" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-21"><span>æ€»ç»“</span></a></h3><p><code>statfs.bsize</code>æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„å±æ€§ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ è·å–æ–‡ä»¶ç³»ç»Ÿå—çš„å¤§å°ï¼Œä»è€Œä¼˜åŒ–æ–‡ä»¶æ“ä½œï¼Œè¿™å¯¹äºéœ€è¦é«˜æ•ˆè¯»å†™æ–‡ä»¶çš„åº”ç”¨å°¤å…¶é‡è¦ã€‚é€šè¿‡ä¸Šè¿°ç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚ä½•åˆ©ç”¨è¿™ä¸€å±æ€§æ¥æ£€æŸ¥ç£ç›˜ç©ºé—´å’Œä¼˜åŒ–æ–‡ä»¶è¯»å†™æ“ä½œã€‚</p><h4 id="statfs-ffree" tabindex="-1"><a class="header-anchor" href="#statfs-ffree"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statfsffree" target="_blank" rel="noopener noreferrer">statfs.ffree</a></span></a></h4><p>åœ¨è§£é‡Š <code>statfs.ffree</code> ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£ Node.js ä¸­çš„ <code>statfs</code> åŠŸèƒ½ã€‚åœ¨ Node.js çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>ï¼‰æ¨¡å—ä¸­ï¼Œ<code>statfs</code> æ˜¯ä¸€ä¸ªç”¨äºè·å–æ–‡ä»¶ç³»ç»Ÿä¿¡æ¯çš„æ–¹æ³•ã€‚å®ƒæä¾›äº†è®¿é—®æ–‡ä»¶ç³»ç»ŸçŠ¶æ€ä¿¡æ¯çš„èƒ½åŠ›ï¼Œå¦‚å¯ç”¨ç©ºé—´ã€æ€»ç©ºé—´ã€inode ä¿¡æ¯ç­‰ã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>statfs.ffree</code> æŒ‡çš„æ˜¯é€šè¿‡è°ƒç”¨ <code>statfs</code> æ–¹æ³•è·å–åˆ°çš„æ–‡ä»¶ç³»ç»Ÿä¿¡æ¯ä¸­çš„â€œå¯ç”¨ inode æ•°é‡â€ã€‚inodeï¼ˆindex nodeï¼‰æ˜¯ Unix å’Œç±» Unix æ“ä½œç³»ç»Ÿä¸­çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œç”¨æ¥å­˜å‚¨æ–‡ä»¶æˆ–ç›®å½•çš„å…ƒæ•°æ®ï¼ˆä¸åŒ…æ‹¬å®é™…æ•°æ®æˆ–æ–‡ä»¶åï¼‰ã€‚æ¯ä¸ªæ–‡ä»¶æˆ–ç›®å½•éƒ½æœ‰å¯¹åº”çš„ inodeï¼Œå…¶ä¸­ä¿å­˜äº†è¯¥æ–‡ä»¶çš„æƒé™ã€æ‰€æœ‰è€…ã€å¤§å°ã€æ—¶é—´æˆ³ç­‰ä¿¡æ¯ã€‚</p><p><code>statfs.ffree</code> å› æ­¤åæ˜ äº†æ–‡ä»¶ç³»ç»Ÿä¸­å‰©ä½™å¤šå°‘ inode è¿˜å¯ä»¥ç”¨æ¥åˆ›å»ºæ–°çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚è¿™æ˜¯è¯„ä¼°æ–‡ä»¶ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µå’Œå®¹é‡è§„åˆ’çš„ä¸€ä¸ªé‡è¦æŒ‡æ ‡ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-41" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-41"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="_1-ç›‘æ§æ–‡ä»¶ç³»ç»Ÿå¥åº·çŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#_1-ç›‘æ§æ–‡ä»¶ç³»ç»Ÿå¥åº·çŠ¶æ€"><span>1. ç›‘æ§æ–‡ä»¶ç³»ç»Ÿå¥åº·çŠ¶æ€</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œéœ€è¦ç›‘æ§æœåŠ¡å™¨çš„å¥åº·çŠ¶æ€ï¼ŒåŒ…æ‹¬å…¶æ–‡ä»¶ç³»ç»Ÿçš„ä½¿ç”¨æƒ…å†µã€‚ä½¿ç”¨ <code>statfs</code> å¹¶æ£€æŸ¥ <code>ffree</code> å€¼ï¼Œä½ å¯ä»¥è·å¾—å½“å‰å¯ç”¨çš„ inode æ•°é‡ï¼Œå¦‚æœè¿™ä¸ªæ•°å€¼è¿‡ä½ï¼Œå¯èƒ½æ„å‘³ç€æ–‡ä»¶ç³»ç»Ÿå¾ˆå¿«å°±ä¼šæ— æ³•åˆ›å»ºæ–°æ–‡ä»¶æˆ–ç›®å½•ï¼Œè¿™æ—¶å€™ä½ çš„åº”ç”¨ç¨‹åºå¯ä»¥è‡ªåŠ¨é¢„è­¦ç®¡ç†å‘˜ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> checkInodeAvailability</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> stat</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statfs</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Free inodes:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stat</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ffree</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">checkInodeAvailability</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å±•ç¤ºäº†å¦‚ä½•è·å–æ ¹ç›®å½•(<code>/</code>)æ–‡ä»¶ç³»ç»Ÿçš„çŠ¶æ€ï¼Œå¹¶æ‰“å°å‡ºå¯ç”¨çš„ inode æ•°é‡ã€‚</p><h4 id="_2-å®¹é‡è§„åˆ’" tabindex="-1"><a class="header-anchor" href="#_2-å®¹é‡è§„åˆ’"><span>2. å®¹é‡è§„åˆ’</span></a></h4><p>åœ¨éƒ¨ç½²æ–°æœåŠ¡å‰ï¼Œç³»ç»Ÿç®¡ç†å‘˜å¯èƒ½éœ€è¦è¿›è¡Œå®¹é‡è§„åˆ’ï¼Œä»¥ç¡®ä¿æ–‡ä»¶ç³»ç»Ÿæœ‰è¶³å¤Ÿçš„ inode å®¹é‡æ»¡è¶³æœåŠ¡è¿è¡Œéœ€æ±‚ã€‚é€šè¿‡é¢„å…ˆæ”¶é›†å¹¶åˆ†æå„æŒ‚è½½ç‚¹çš„ <code>ffree</code> å€¼ï¼Œå¯ä»¥å¸®åŠ©åšå‡ºæ›´å¥½çš„å†³ç­–ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> evaluateFileSystemCapacity</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">mountPoint</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> stat</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statfs</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">mountPoint</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">stat</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ffree</span><span style="color:#ECEFF4;"> `</span><span style="color:#A3BE8C;">&lt;</span><span style="color:#ECEFF4;">`</span><span style="color:#B48EAD;"> 10000</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span><span style="color:#616E88;"> // å‡è®¾å°äº10000ä¸ªinodeå°±è®¤ä¸ºä¸è¶³</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">warn</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Warning: Low inode count on </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">mountPoint</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">The inode count on </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">mountPoint</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> is sufficient.</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">evaluateFileSystemCapacity</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">/data</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œçš„ä»£ç ä¼šæ£€æŸ¥ç‰¹å®šæŒ‚è½½ç‚¹ï¼ˆä¾‹å¦‚ <code>/data</code>ï¼‰çš„ inode å‰©ä½™æ•°é‡ï¼Œå¹¶ç»™å‡ºè¯„ä¼°ç»“æœã€‚</p><p>ä»¥ä¸Šä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨<code>statfs</code>åŠå…¶<code>ffree</code>å±æ€§æ¥è·å–å’Œåˆ©ç”¨æ–‡ä»¶ç³»ç»Ÿçš„å…³é”®ä¿¡æ¯ï¼Œå¸®åŠ©è¿›è¡Œç³»ç»Ÿç›‘æ§å’Œå®¹é‡è§„åˆ’ã€‚</p><h4 id="statfs-files" tabindex="-1"><a class="header-anchor" href="#statfs-files"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statfsfiles" target="_blank" rel="noopener noreferrer">statfs.files</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡ç«¯çš„ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ä¸ªæ¨¡å—å«åš <code>fs</code>ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œå®ƒæä¾›äº†å¾ˆå¤šç”¨æ¥æ“ä½œæ–‡ä»¶å’Œç›®å½•çš„å‡½æ•°ã€‚</p><p>åœ¨ Node.js çš„ç‰ˆæœ¬ v21.7.1 ä¸­ï¼Œ<code>statfs.files</code> æ˜¯ <code>fs</code> æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæ˜¯åœ¨è°ƒç”¨ <code>fs.statfs()</code> æ–¹æ³•åè¿”å›çš„å¯¹è±¡ä¸­çš„ä¸€ä¸ªå±æ€§ã€‚è¿™ä¸ªå±æ€§æä¾›äº†å…³äºæ–‡ä»¶ç³»ç»Ÿçš„ä¸€äº›ç»Ÿè®¡ä¿¡æ¯ã€‚</p><h3 id="è§£é‡Š-6" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-6"><span>è§£é‡Š</span></a></h3><ul><li><strong><code>statfs()</code> æ–¹æ³•</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªç”¨æ¥è·å–æ–‡ä»¶ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯çš„æ–¹æ³•ã€‚å½“ä½ è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªåŒ…å«å¤šä¸ªå±æ€§çš„å¯¹è±¡ï¼Œè¿™äº›å±æ€§æä¾›äº†å…³äºæ–‡ä»¶ç³»ç»Ÿçš„è¯¦ç»†ä¿¡æ¯ã€‚</li><li><strong><code>files</code> å±æ€§</strong>ï¼šå…·ä½“åˆ° <code>statfs.files</code>ï¼Œå®ƒè¡¨ç¤ºçš„æ˜¯æ–‡ä»¶ç³»ç»Ÿä¸­æ–‡ä»¶çš„æ•°é‡ã€‚è¿™æ˜¯ä¸€ä¸ªæ•°å­—å€¼ï¼Œå‘Šè¯‰ä½ æ–‡ä»¶ç³»ç»Ÿä¸­æ€»å…±æœ‰å¤šå°‘ä¸ªæ–‡ä»¶ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-15" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-15"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œè¿™ä¸ªåº”ç”¨éœ€è¦æ£€æŸ¥æœåŠ¡å™¨ä¸ŠæŸä¸ªç›®å½•çš„å¥åº·çŠ¶å†µã€‚å…¶ä¸­ä¸€ä¸ªæ£€æŸ¥é¡¹å¯èƒ½æ˜¯ç¡®å®šè¯¥ç›®å½•ä¸‹æœ‰å¤šå°‘ä¸ªæ–‡ä»¶ï¼Œå› ä¸ºè¿‡å¤šçš„æ–‡ä»¶å¯èƒ½ä¼šå½±å“ç›®å½•çš„è®¿é—®æ€§èƒ½ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ Node.js è„šæœ¬ç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ <code>fs.statfs()</code> æ–¹æ³•å’Œ <code>statfs.files</code> å±æ€§ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å¼•å…¥ fs æ¨¡å—</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> checkFileCount</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // ä½¿ç”¨ statfs() æ–¹æ³•è·å–æ–‡ä»¶ç³»ç»Ÿçš„ç»Ÿè®¡ä¿¡æ¯</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statfs</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // æ‰“å°å‡ºæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶æ€»æ•°</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶æ€»æ•°: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">files</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è·å–æ–‡ä»¶ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯å¤±è´¥:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æˆ‘ä»¬è¦æ£€æŸ¥æ ¹ç›®å½• &quot;/&quot;</span></span>
<span class="line"><span style="color:#88C0D0;">checkFileCount</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„è„šæœ¬é¦–å…ˆå¼•å…¥äº† <code>fs</code> æ¨¡å—ï¼Œç„¶åå®šä¹‰äº†ä¸€ä¸ª <code>checkFileCount</code> å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°æ¥æ”¶ä¸€ä¸ªè·¯å¾„ä½œä¸ºå‚æ•°ï¼Œç„¶åè°ƒç”¨ <code>fs.statfs()</code> æ–¹æ³•è·å–è¯¥è·¯å¾„æ‰€åœ¨æ–‡ä»¶ç³»ç»Ÿçš„ç»Ÿè®¡ä¿¡æ¯ã€‚æœ€åï¼Œæˆ‘ä»¬ä»è¿”å›çš„å¯¹è±¡ä¸­æå– <code>files</code> å±æ€§å¹¶æ‰“å°å‡ºæ¥ï¼Œè¿™æ ·å°±å¯ä»¥çœ‹åˆ°æ–‡ä»¶ç³»ç»Ÿä¸­æ–‡ä»¶çš„æ€»æ•°äº†ã€‚</p><p>è¯·æ³¨æ„ï¼Œç”±äºè¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>async/await</code> è¯­æ³•æ¥ç­‰å¾… <code>fs.statfs()</code> æ–¹æ³•çš„ç»“æœã€‚æ­¤å¤–ï¼Œç”±äº <code>fs.statfs()</code> æ˜¯ Node.js v21.7.1 æ–°å¢çš„ç‰¹æ€§ï¼Œç¡®ä¿ä½ çš„ Node.js ç¯å¢ƒå·²ç»æ›´æ–°åˆ°è¿™ä¸ªæˆ–æ›´é«˜çš„ç‰ˆæœ¬æ‰èƒ½è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ã€‚</p><h4 id="statfs-type" tabindex="-1"><a class="header-anchor" href="#statfs-type"><span><a href="https://nodejs.org/docs/latest/api/fs.html#statfstype" target="_blank" rel="noopener noreferrer">statfs.type</a></span></a></h4><p>Node.js v21.7.1 ä¸­çš„<code>statfs.type</code>æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå®ƒå±äºæ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>ï¼‰æ¨¡å—ä¸­çš„<code>statfs</code>åŠŸèƒ½ã€‚è¦ç†è§£<code>statfs.type</code>ï¼Œé¦–å…ˆè®©æˆ‘ä»¬åˆ†æ­¥éª¤æ¥äº†è§£ä¸€äº›åŸºç¡€æ¦‚å¿µã€‚</p><h3 id="åŸºç¡€æ¦‚å¿µ-5" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æ¦‚å¿µ-5"><span>åŸºç¡€æ¦‚å¿µ</span></a></h3><h4 id="node-js-å’Œ-fs-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#node-js-å’Œ-fs-æ¨¡å—"><span>Node.js å’Œ <code>fs</code> æ¨¡å—ï¼š</span></a></h4><ul><li><strong>Node.js</strong>æ˜¯ä¸€ä¸ªå¯ä»¥è®©ä½ ä½¿ç”¨ JavaScript åšåç«¯ç¼–ç¨‹çš„å¹³å°ã€‚å®ƒèƒ½è®©ä½ ç”¨ JavaScript æ¥æ“ä½œæœåŠ¡å™¨ï¼ŒåŒ…æ‹¬è¯»å†™æ–‡ä»¶ã€å¤„ç†ç½‘ç»œè¯·æ±‚ç­‰ã€‚</li><li><strong><code>fs</code>æ¨¡å—</strong>æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œç®€ç§°ä¸ºæ–‡ä»¶ç³»ç»Ÿæ¨¡å—ã€‚è¿™ä¸ªæ¨¡å—æä¾›äº†ä¸€å †å‡½æ•°ï¼Œè®©ä½ å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œæ–‡ä»¶æ“ä½œï¼Œæ¯”å¦‚åˆ›å»ºã€è¯»å–ã€å†™å…¥ã€åˆ é™¤æ–‡ä»¶ç­‰ã€‚</li></ul><h4 id="statfs-åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#statfs-åŠŸèƒ½"><span><code>statfs</code> åŠŸèƒ½ï¼š</span></a></h4><ul><li>**<code>statfs</code>**æ˜¯<code>fs</code>æ¨¡å—çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒæä¾›äº†ä¸€ç§æ–¹æ³•æ¥è·å–æ–‡ä»¶ç³»ç»Ÿçš„çŠ¶æ€ä¿¡æ¯ï¼Œæ¯”å¦‚å¯ç”¨ç©ºé—´ã€æ€»å®¹é‡ã€æ–‡ä»¶ç³»ç»Ÿç±»å‹ç­‰ã€‚è¿™å¯¹äºç®¡ç†å’Œç›‘è§†æ–‡ä»¶ç³»ç»Ÿå°¤å…¶é‡è¦ã€‚</li></ul><h3 id="statfs-type-è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#statfs-type-è¯¦è§£"><span><code>statfs.type</code> è¯¦è§£</span></a></h3><ul><li>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>statfs.type</code>æ˜¯æŒ‡å½“ä½ ä½¿ç”¨<code>statfs</code>æ–¹æ³•è·å–äº†æŸä¸ªæŒ‚è½½ç‚¹ï¼ˆå³æ–‡ä»¶ç³»ç»Ÿè¢«æ“ä½œç³»ç»Ÿè®¿é—®çš„åœ°æ–¹ï¼‰çš„çŠ¶æ€åï¼Œå…¶ä¸­çš„<code>type</code>å±æ€§ä¼šå‘Šè¯‰ä½ è¯¥æ–‡ä»¶ç³»ç»Ÿçš„ç±»å‹ã€‚ä¸åŒçš„æ“ä½œç³»ç»Ÿæ”¯æŒå¤šç§æ–‡ä»¶ç³»ç»Ÿï¼Œä¾‹å¦‚ NTFSã€FAT32 ç­‰æ˜¯ Windows å¸¸è§çš„æ–‡ä»¶ç³»ç»Ÿï¼Œè€Œ EXT4ã€XFS åˆ™æ˜¯ Linux ä¸­å¸¸è§çš„ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-30" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-30"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œè¿™ä¸ªç¨‹åºéœ€è¦æ£€æŸ¥å®ƒæ­£åœ¨æ“ä½œçš„å­˜å‚¨è®¾å¤‡çš„å¯ç”¨ç©ºé—´ä»¥ç¡®ä¿æœ‰è¶³å¤Ÿçš„ç©ºé—´æ¥å­˜å‚¨ç”¨æˆ·æ•°æ®ã€‚æ­¤å¤–ï¼Œæ ¹æ®ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼Œä½ å¯èƒ½éœ€è¦è°ƒæ•´ä½ çš„ç¨‹åºå¯¹æ–‡ä»¶çš„å¤„ç†æ–¹å¼ã€‚è¿™æ—¶ï¼Œ<code>statfs</code>å’Œ<code>statfs.type</code>å°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p><ol><li><p><strong>æ£€æŸ¥ç£ç›˜ç©ºé—´</strong>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> checkFileSystemType</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> stats</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">statfs</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">File System Type: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">type</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // æ ¹æ®æ–‡ä»¶ç³»ç»Ÿç±»å‹è¿›è¡Œä¸åŒçš„æ“ä½œ</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">type</span><span style="color:#81A1C1;"> ===</span><span style="color:#616E88;"> /* æŸä¸ªç‰¹å®šçš„æ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼Œæ¯”å¦‚EXT4 */</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">This is an EXT4 file system.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Error getting file system type: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">error</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æˆ‘ä»¬æƒ³æ£€æŸ¥æ ¹ç›®å½•çš„æ–‡ä»¶ç³»ç»Ÿç±»å‹</span></span>
<span class="line"><span style="color:#88C0D0;">checkFileSystemType</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">/</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>fs.statfs</code>æ¥è·å–å¹¶æ‰“å°å‡ºä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„ç±»å‹ã€‚è¿™å¯¹äºæ‰§è¡ŒåŸºäºç‰¹å®šæ–‡ä»¶ç³»ç»Ÿä¼˜åŒ–çš„æ“ä½œéå¸¸æœ‰å¸®åŠ©ã€‚</p><p>ç»“è®ºï¼š<code>statfs.type</code>è®©ä½ èƒ½å¤Ÿè¯†åˆ«æ­£åœ¨æ“ä½œçš„æ–‡ä»¶ç³»ç»Ÿçš„ç±»å‹ï¼Œè¿™åœ¨éœ€è¦æ ¹æ®æ–‡ä»¶ç³»ç»Ÿç±»å‹æ‰§è¡Œä¸åŒæ“ä½œçš„åœºæ™¯ä¸‹éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚ä¼˜åŒ–æ€§èƒ½ã€å¤„ç†å…¼å®¹æ€§é—®é¢˜ç­‰ã€‚</p><h3 id="class-fs-writestream" tabindex="-1"><a class="header-anchor" href="#class-fs-writestream"><span><a href="https://nodejs.org/docs/latest/api/fs.html#class-fswritestream" target="_blank" rel="noopener noreferrer">Class: fs.WriteStream</a></span></a></h3><p>å½“ç„¶ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥è§£é‡Š Node.js ä¸­çš„ <code>fs.WriteStream</code> ç±»ï¼Œå¹¶é€šè¿‡ä¾‹å­åŠ æ·±ç†è§£ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-fs-writestream" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-fs-writestream"><span>ä»€ä¹ˆæ˜¯ <code>fs.WriteStream</code>ï¼Ÿ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>fs</code> æ¨¡å—æä¾›äº†æ“ä½œæ–‡ä»¶ç³»ç»Ÿçš„åŠŸèƒ½ã€‚å…¶ä¸­ï¼Œ<code>WriteStream</code> æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç±»ï¼Œç”¨äºå‘æ–‡ä»¶ä¸­å†™å…¥æ•°æ®ã€‚ç®€å•æ¥è¯´ï¼Œå½“ä½ æƒ³è¦æŠŠæ•°æ®ï¼ˆå¦‚æ–‡æœ¬ã€å›¾ç‰‡ç­‰ï¼‰ä¿å­˜åˆ°æ–‡ä»¶ä¸­æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>WriteStream</code> æ¥å®ç°ã€‚</p><h3 id="fs-writestream-çš„å·¥ä½œåŸç†" tabindex="-1"><a class="header-anchor" href="#fs-writestream-çš„å·¥ä½œåŸç†"><span><code>fs.WriteStream</code> çš„å·¥ä½œåŸç†</span></a></h3><p><code>WriteStream</code> å·¥ä½œåŸç†ç±»ä¼¼äºæ°´æµï¼šå‡è®¾ä½ æœ‰ä¸€å£¶æ°´ï¼ˆæ•°æ®ï¼‰ï¼Œéœ€è¦å°†è¿™å£¶æ°´å€’è¿›ä¸€ä¸ªç“¶å­ï¼ˆæ–‡ä»¶ï¼‰é‡Œã€‚ä½¿ç”¨ <code>WriteStream</code> å°±å¥½æ¯”æ‰“å¼€äº†ç“¶ç›–ï¼Œå¹¶å¼€å§‹å€¾å€’æ°´ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä½ å¯ä»¥æ§åˆ¶æ°´æµçš„é€Ÿåº¦ï¼Œä¹Ÿå¯ä»¥éšæ—¶åœæ­¢å€’æ°´ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-fs-writestream" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-fs-writestream"><span>å¦‚ä½•ä½¿ç”¨ <code>fs.WriteStream</code></span></a></h3><p>åœ¨ Node.js ä¸­ä½¿ç”¨ <code>fs.WriteStream</code> çš„åŸºæœ¬æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><strong>å¼•å…¥ <code>fs</code> æ¨¡å—</strong>ï¼šé¦–å…ˆï¼Œä½ éœ€è¦åœ¨ä½ çš„é¡¹ç›®ä¸­å¼•å…¥ Node.js çš„ <code>fs</code> æ¨¡å—ã€‚</li><li><strong>åˆ›å»º <code>WriteStream</code> å®ä¾‹</strong>ï¼šæ¥ç€ï¼Œä½¿ç”¨ <code>fs.createWriteStream()</code> æ–¹æ³•å¹¶æŒ‡å®šè¦å†™å…¥çš„æ–‡ä»¶è·¯å¾„æ¥åˆ›å»ºä¸€ä¸ª <code>WriteStream</code> å®ä¾‹ã€‚</li><li><strong>å†™å…¥æ•°æ®</strong>ï¼šä½¿ç”¨ <code>.write()</code> æ–¹æ³•å‘æ–‡ä»¶å†™å…¥æ•°æ®ã€‚</li><li><strong>ç»“æŸå†™å…¥</strong>ï¼šå®Œæˆå†™å…¥åï¼Œä½¿ç”¨ <code>.end()</code> æ–¹æ³•å…³é—­æµã€‚</li></ol><h3 id="å®é™…ä¾‹å­-13" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-13"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æƒ³åˆ›å»ºä¸€ä¸ªåä¸º &quot;example.txt&quot; çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶å‘å…¶å†™å…¥ä¸€å¥è¯ &quot;Hello, World!&quot;ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨ <code>fs.WriteStream</code> å®ç°è¿™ä¸ªç›®æ ‡çš„ä»£ç ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å¼•å…¥ fs æ¨¡å—</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»º WriteStream å®ä¾‹ï¼ŒæŒ‡å®šæ–‡ä»¶åä¸º &#39;example.txt&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> writeStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‘æ–‡ä»¶å†™å…¥å†…å®¹ &quot;Hello, World!&quot;</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello, World!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç»“æŸå†™å…¥è¿‡ç¨‹</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘å¬ &#39;finish&#39; äº‹ä»¶ä»¥ç¡®è®¤æ–‡ä»¶å·²æˆåŠŸå†™å…¥</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">finish</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å†™å…¥å®Œæˆã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å¤„ç†å¯èƒ½å‘ç”Ÿçš„é”™è¯¯</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">error</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å‘ç”Ÿé”™è¯¯:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å®Œæˆäº†ä»å¼€å§‹åˆ°ç»“æŸçš„æ•´ä¸ªå†™å…¥è¿‡ç¨‹ï¼šé¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªæŒ‡å‘ &quot;example.txt&quot; çš„ <code>WriteStream</code>ï¼Œç„¶åå‘å…¶ä¸­å†™å…¥äº† &quot;Hello, World!&quot;ï¼Œæœ€åé€šè¿‡ç›‘å¬ <code>finish</code> äº‹ä»¶æ¥ç¡®è®¤å†™å…¥å®Œæˆã€‚</p><h3 id="å°ç»“-12" tabindex="-1"><a class="header-anchor" href="#å°ç»“-12"><span>å°ç»“</span></a></h3><p><code>fs.WriteStream</code> æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªå¼ºå¤§å·¥å…·ï¼Œå®ƒå…è®¸ä½ ä»¥æµçš„æ–¹å¼å‘æ–‡ä»¶ä¸­å†™å…¥æ•°æ®ã€‚è¿™ç§æ–¹æ³•éå¸¸é€‚åˆå¤„ç†å¤§æ–‡ä»¶æˆ–è€…å®æ—¶æ•°æ®å†™å…¥ç­‰åœºæ™¯ï¼Œå› ä¸ºå®ƒä¸ä¼šä¸€æ¬¡æ€§å ç”¨è¿‡å¤šå†…å­˜ã€‚å¸Œæœ›ä»¥ä¸Šè§£é‡Šå’Œç¤ºä¾‹èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ <code>fs.WriteStream</code> çš„æ¦‚å¿µå’Œç”¨æ³•ã€‚</p><h4 id="event-close-4" tabindex="-1"><a class="header-anchor" href="#event-close-4"><span><a href="https://nodejs.org/docs/latest/api/fs.html#event-close_3" target="_blank" rel="noopener noreferrer">Event: &#39;close&#39;</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªèƒ½å¤Ÿåœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç çš„å¹³å°ã€‚å®ƒè®© JavaScript ä¸ä»…ä»…èƒ½åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œè¿˜èƒ½åœ¨æœåŠ¡å™¨ä¸Šæˆ–è€…ä»»ä½•å®‰è£…äº† Node.js çš„è®¾å¤‡ä¸Šè¿è¡Œã€‚è¿™æ‰©å±•äº† JavaScript çš„ç”¨é€”èŒƒå›´ï¼Œå¹¶å¼€å¯äº†æ„å»ºå¿«é€Ÿã€å¯æ‰©å±•ç½‘ç»œåº”ç”¨çš„å¯èƒ½æ€§ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>Event: &#39;close&#39;</code>æ˜¯ä¸€ä¸ªå¹¿æ³›åº”ç”¨äºå„ç§æ¨¡å—çš„äº‹ä»¶ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>æ¨¡å—ï¼‰ã€æµæ“ä½œï¼ˆå¦‚è¯»å†™æ•°æ®æµï¼‰æ—¶éå¸¸é‡è¦ã€‚ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œå…·ä½“åˆ°ä½ æåˆ°çš„æ–‡æ¡£é“¾æ¥å’Œç‰ˆæœ¬ï¼ˆNode.js v21.7.1ï¼‰ï¼Œçœ‹èµ·æ¥æ˜¯é’ˆå¯¹æŸä¸ªç‰¹å®š API çš„æè¿°ï¼Œè€Œé€šå¸¸<code>&#39;close&#39;</code>äº‹ä»¶è¡¨ç¤ºçš„æ˜¯å½“ä¸€ä¸ªèµ„æºï¼ˆæ¯”å¦‚æ–‡ä»¶ã€ç½‘ç»œè¿æ¥ç­‰ï¼‰å®Œæˆæ“ä½œå¹¶è¢«å…³é—­æ—¶å‘å‡ºçš„ä¿¡å·ã€‚</p><h3 id="event-close-è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#event-close-è¯¦è§£"><span><code>Event: &#39;close&#39;</code> è¯¦è§£</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œå½“æ¶‰åŠåˆ° I/O æ“ä½œï¼Œå¦‚æ–‡ä»¶è¯»å†™ã€ç½‘ç»œé€šä¿¡ç­‰ï¼Œæ“ä½œå®Œæˆåé‡Šæ”¾èµ„æºæ˜¯å¾ˆé‡è¦çš„ä¸€æ­¥ï¼Œä»¥é¿å…å†…å­˜æ³„æ¼å’Œå…¶ä»–æ½œåœ¨çš„é—®é¢˜ã€‚<code>&#39;close&#39;</code>äº‹ä»¶å°±æ˜¯åœ¨è¿™æ ·çš„ä¸Šä¸‹æ–‡ä¸­å‘å‡ºçš„ï¼Œæ ‡ç¤ºç€èµ„æºå·²ç»è¢«å…³é—­ï¼Œä¸å†å¯ç”¨ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-11" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-11"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><h4 id="æ–‡ä»¶æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶æ“ä½œ"><span>æ–‡ä»¶æ“ä½œ</span></a></h4><p>å½“ä½¿ç”¨<code>fs.createReadStream</code>åˆ›å»ºä¸€ä¸ªç”¨äºè¯»å–æ–‡ä»¶çš„æµæ—¶ï¼Œä¸€æ—¦æ–‡ä»¶å†…å®¹è¢«è¯»å®Œä¸”æµè¢«å…³é—­ï¼Œ<code>&#39;close&#39;</code>äº‹ä»¶ä¼šè¢«è§¦å‘ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªå¯è¯»æµ</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> readableStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">readableStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">close</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File has been closed.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">readableStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">data</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Received </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">length</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> bytes of data.</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">readableStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">end</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">There is no more data to read.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œ<code>fs.createReadStream(&#39;example.txt&#39;)</code>æ˜¯åˆ›å»ºä¸€ä¸ªä»æŒ‡å®šæ–‡ä»¶ï¼ˆè¿™é‡Œæ˜¯<code>example.txt</code>ï¼‰è¯»å–æ•°æ®çš„æµã€‚æˆ‘ä»¬ç›‘å¬äº†<code>&#39;close&#39;</code>äº‹ä»¶ï¼Œæ‰€ä»¥å½“æ–‡ä»¶è¯»å–å®Œæˆå¹¶ä¸”æµè¢«å…³é—­åï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªé€šçŸ¥ã€‚</p><h4 id="ç½‘ç»œè¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#ç½‘ç»œè¯·æ±‚"><span>ç½‘ç»œè¯·æ±‚</span></a></h4><p>åœ¨ä½¿ç”¨ Node.js è¿›è¡Œç½‘ç»œç¼–ç¨‹æ—¶ï¼Œä¾‹å¦‚åˆ›å»ºä¸€ä¸ª HTTP æœåŠ¡å™¨ï¼Œ<code>&#39;close&#39;</code>äº‹ä»¶ä¹Ÿä¼šè¢«ç”¨åˆ°ï¼Œè¡¨ç¤ºå½“æœåŠ¡å™¨å…³é—­æ—¶è§¦å‘ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> http</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">http</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> server</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> http</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createServer</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">req</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> res</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  res</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello World!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">server</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">listen</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">3000</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Server is running on port 3000</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">server</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">close</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Server has been closed.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾åœ¨æŸä¸ªæ—¶åˆ»ï¼Œæˆ‘ä»¬å†³å®šåœæ­¢æœåŠ¡å™¨</span></span>
<span class="line"><span style="color:#D8DEE9;">server</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„ HTTP æœåŠ¡å™¨ã€‚é€šè¿‡ç›‘å¬<code>&#39;close&#39;</code>äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å¾—çŸ¥æœåŠ¡å™¨ä½•æ—¶åœæ­¢æœåŠ¡ï¼Œè¿™å¯¹äºèµ„æºæ¸…ç†å’Œç¡®ä¿åº”ç”¨å¹³ç¨³é€€å‡ºå¾ˆæœ‰å¸®åŠ©ã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼Œ<code>&#39;close&#39;</code>äº‹ä»¶åœ¨ Node.js ä¸­æ˜¯ä¸€ä¸ªå…³é”®çš„æœºåˆ¶ï¼Œç”¨äºç®¡ç†å’Œç›‘æ§èµ„æºçš„ç”Ÿå‘½å‘¨æœŸï¼Œæ— è®ºæ˜¯åœ¨å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼Œè¿˜æ˜¯åœ¨è¿›è¡Œç½‘ç»œé€šä¿¡æ—¶ã€‚é€šè¿‡åˆç†åˆ©ç”¨è¿™ä¸€äº‹ä»¶ï¼Œå¯ä»¥ç¼–å†™å‡ºæ›´åŠ å¥å£¯ã€å¯é çš„ Node.js åº”ç”¨ã€‚</p><h4 id="event-open-1" tabindex="-1"><a class="header-anchor" href="#event-open-1"><span><a href="https://nodejs.org/docs/latest/api/fs.html#event-open_1" target="_blank" rel="noopener noreferrer">Event: &#39;open&#39;</a></span></a></h4><p>Node.js ä¸­çš„<code>Event: &#39;open&#39;</code>æ˜¯ä¸æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>æ¨¡å—ï¼‰äº¤äº’æ—¶ä½¿ç”¨çš„ä¸€ä¸ªäº‹ä»¶ã€‚åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ï¼Œå½“ä½ ä½¿ç”¨æŸäº›åŸºäºæµï¼ˆstreamï¼‰çš„ API æ¥æ‰“å¼€æ–‡ä»¶æ—¶ï¼Œè¿™ä¸ªäº‹ä»¶ä¼šè¢«è§¦å‘ã€‚ç®€å•è€Œè¨€ï¼Œå½“æ–‡ä»¶æˆåŠŸæ‰“å¼€å‡†å¤‡è¯»å–æˆ–å†™å…¥æ—¶ï¼Œ<code>&#39;open&#39;</code>äº‹ä»¶ä¼šè¢«è§¦å‘ã€‚</p><h3 id="ä¸ºä»€ä¹ˆè¦ç”¨event-open" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆè¦ç”¨event-open"><span>ä¸ºä»€ä¹ˆè¦ç”¨<code>Event: &#39;open&#39;</code></span></a></h3><p>åœ¨å¤„ç†æ–‡ä»¶æˆ–æ•°æ®æµæ—¶ï¼Œé€šå¸¸æ¶‰åŠåˆ°å¼‚æ­¥æ“ä½œã€‚å¼‚æ­¥æ„å‘³ç€ç¨‹åºä¼šç»§ç»­æ‰§è¡Œä¸‹ä¸€è¡Œä»£ç è€Œä¸ç­‰å¾…æ–‡ä»¶å®Œå…¨æ‰“å¼€ã€‚è¿™æœ‰åŠ©äºæé«˜åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œå“åº”é€Ÿåº¦ï¼Œå› ä¸ºå®ƒä¸ä¼šè¢« IOï¼ˆè¾“å…¥/è¾“å‡ºï¼‰æ“ä½œé˜»å¡ã€‚é€šè¿‡ç›‘å¬<code>&#39;open&#39;</code>äº‹ä»¶ï¼Œä½ å¯ä»¥åœ¨æ–‡ä»¶ç¡®å®å‡†å¤‡å¥½ä¹‹åç«‹å³å¼€å§‹è¿›è¡Œè¯»å–æˆ–å†™å…¥æ“ä½œï¼Œä»è€Œç¡®ä¿æ“ä½œçš„æœ‰æ•ˆæ€§å’Œå®‰å…¨æ€§ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-42" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-42"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="ç¤ºä¾‹-1-è¯»å–æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-è¯»å–æ–‡ä»¶"><span>ç¤ºä¾‹ 1ï¼šè¯»å–æ–‡ä»¶</span></a></h4><p>å‡è®¾ä½ æƒ³æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å¹¶è¯»å–å…¶ä¸­çš„å†…å®¹ã€‚ä½¿ç”¨<code>fs.createReadStream</code>æ–¹æ³•åˆ›å»ºä¸€ä¸ªè¯»å–æµæ—¶ï¼Œä½ å¯ä»¥ç›‘å¬<code>&#39;open&#39;</code>äº‹ä»¶æ¥ç¡®å®šä½•æ—¶æ–‡ä»¶å·²ç»å‡†å¤‡å¥½è¯»å–ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªè¯»å–æµ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> readStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘å¬&#39;open&#39;äº‹ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">open</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">File has been opened, file descriptor: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">fd</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>example.txt</code>æ˜¯ä½ æƒ³è¦è¯»å–çš„æ–‡ä»¶ã€‚é€šè¿‡ç›‘å¬<code>&#39;open&#39;</code>äº‹ä»¶ï¼Œä½ å¯ä»¥çŸ¥é“æ–‡ä»¶ä½•æ—¶å‡†å¤‡å°±ç»ªï¼Œå¹¶ä¸”äº‹ä»¶å›è°ƒå‡½æ•°è¿˜ä¼šæ”¶åˆ°ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼ˆ<code>fd</code>ï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªæŒ‡å‘æ‰“å¼€çš„æ–‡ä»¶çš„å¼•ç”¨ã€‚</p><h4 id="ç¤ºä¾‹-2-å†™å…¥æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å†™å…¥æ–‡ä»¶"><span>ç¤ºä¾‹ 2ï¼šå†™å…¥æ–‡ä»¶</span></a></h4><p>å¦‚æœä½ çš„ç›®æ ‡æ˜¯å†™å…¥æ–‡ä»¶ï¼Œé‚£ä¹ˆåŒæ ·åœ°ï¼Œä½ ä¹Ÿå¯ä»¥ç›‘å¬<code>&#39;open&#39;</code>äº‹ä»¶æ¥ç¡®ä¿æ–‡ä»¶å·²ç»å‡†å¤‡å¥½å†™å…¥ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªå†™å…¥æµ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> writeStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">output.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘å¬&#39;open&#39;äº‹ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">open</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">File is ready for writing, file descriptor: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">fd</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡<code>fs.createWriteStream</code>åˆ›å»ºä¸€ä¸ªæŒ‡å‘<code>output.txt</code>çš„å†™å…¥æµã€‚ä¸€æ—¦æ–‡ä»¶æ‰“å¼€ï¼Œå°±ä¼šè§¦å‘<code>&#39;open&#39;</code>äº‹ä»¶ï¼Œå¹¶æ‰§è¡Œç›¸åº”çš„å›è°ƒå‡½æ•°ï¼Œæ­¤æ—¶ä½ å¯ä»¥å®‰å…¨åœ°å¼€å§‹å†™å…¥æ•°æ®ã€‚</p><h3 id="ç»“è®º-7" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-7"><span>ç»“è®º</span></a></h3><p><code>Event: &#39;open&#39;</code>åœ¨ Node.js ä¸­æ˜¯å¤„ç†æ–‡ä»¶å’Œæ•°æ®æµæ—¶éå¸¸æœ‰ç”¨çš„äº‹ä»¶ï¼Œå®ƒè®©ä½ çŸ¥é“ä½•æ—¶æ–‡ä»¶å·²ç»å‡†å¤‡å¥½è¿›è¡Œåç»­æ“ä½œã€‚æ— è®ºæ˜¯è¯»å–æ–‡ä»¶å†…å®¹è¿˜æ˜¯å‘æ–‡ä»¶ä¸­å†™å…¥æ•°æ®ï¼Œæ­£ç¡®åœ°ä½¿ç”¨è¿™ä¸ªäº‹ä»¶éƒ½å¯ä»¥å¸®åŠ©ä½ æ›´æœ‰æ•ˆã€æ›´å®‰å…¨åœ°å®Œæˆä»»åŠ¡ã€‚</p><h4 id="event-ready-1" tabindex="-1"><a class="header-anchor" href="#event-ready-1"><span><a href="https://nodejs.org/docs/latest/api/fs.html#event-ready_1" target="_blank" rel="noopener noreferrer">Event: &#39;ready&#39;</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚ä¸€ä¸ªé‡è¦çš„ç‰¹æ€§å°±æ˜¯å®ƒçš„éé˜»å¡ I/O (è¾“å…¥/è¾“å‡º) æ¨¡å‹ï¼Œè¿™ä½¿å¾— Node.js ç‰¹åˆ«é€‚åˆå¤„ç†æ–‡ä»¶ç³»ç»Ÿæ“ä½œã€ç½‘ç»œè¯·æ±‚ç­‰å¯èƒ½è€—æ—¶çš„ä»»åŠ¡ã€‚</p><p>åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­æåˆ°çš„ <code>Event: &#39;ready&#39;</code> é€šå¸¸ä¸æŸäº›å¯¹è±¡ç›¸å…³ï¼Œè¿™é‡Œä»¥æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—ä¸ºä¾‹ã€‚äº‹å®ä¸Šï¼Œåœ¨è¯¥ç‰ˆæœ¬çš„å®˜æ–¹æ–‡æ¡£ä¸­å¹¶æ²¡æœ‰ç›´æ¥æåŠ <code>Event: &#39;ready&#39;</code> ç›¸å…³äº <code>fs</code> æ¨¡å—çš„ä½¿ç”¨ï¼Œä½†æˆ‘å°†åŸºäº Node.js ä¸­äº‹ä»¶é©±åŠ¨çš„è®¾è®¡ç†å¿µç»™ä½ ä¸€ä¸ªå‡è®¾çš„åœºæ™¯æ¥å¸®åŠ©ä½ ç†è§£ã€‚</p><h3 id="åŸºç¡€æ¦‚å¿µ-6" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æ¦‚å¿µ-6"><span>åŸºç¡€æ¦‚å¿µ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œè®¸å¤šå¯¹è±¡ä¼šå‘å‡ºäº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç›‘å¬è¿™äº›äº‹ä»¶æ¥æ‰§è¡Œä¸€äº›æ“ä½œã€‚è¿™ç§æ¨¡å¼è¢«ç§°ä¸ºâ€œè§‚å¯Ÿè€…æ¨¡å¼â€ã€‚ç”¨äºç›‘å¬å’Œå‘å°„äº‹ä»¶çš„æ ¸å¿ƒæ¨¡å—æ˜¯ <code>events</code> æ¨¡å—ã€‚</p><h3 id="event-ready-çš„ç†è§£" tabindex="-1"><a class="header-anchor" href="#event-ready-çš„ç†è§£"><span><code>Event: &#39;ready&#39;</code> çš„ç†è§£</span></a></h3><p>è™½ç„¶ <code>Event: &#39;ready&#39;</code> åœ¨ <code>fs</code> æ¨¡å—çš„æ–‡æ¡£ä¸­æœªæ˜ç¡®åˆ—å‡ºï¼Œä½†æˆ‘ä»¬å¯ä»¥æƒ³è±¡è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šå½“ä½ ä½¿ç”¨ Node.js å¯¹æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œæ“ä½œï¼ˆæ¯”å¦‚è¯»å–ç›®å½•å†…å®¹ï¼‰ï¼Œ<code>&#39;ready&#39;</code> äº‹ä»¶å¯ä»¥è¢«è§¦å‘è¡¨ç¤ºæ“ä½œå·²ç»å‡†å¤‡å¥½è¿”å›ç»“æœäº†ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-31" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-31"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåœºæ™¯ï¼Œéœ€è¦è¯»å–ä¸€ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå½“è¿™ä¸ªæ“ä½œå‡†å¤‡å¥½è¢«å¤„ç†æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å¾—åˆ°é€šçŸ¥ã€‚ç”±äº <code>Event: &#39;ready&#39;</code> ä¸æ˜¯ <code>fs</code> æ¨¡å—æ˜ç¡®çš„äº‹ä»¶ï¼Œä»¥ä¸‹ä»£ç ä½¿ç”¨äº†ç±»ä¼¼æ¦‚å¿µçš„ <code>&#39;open&#39;</code> äº‹ä»¶ï¼Œä»…ä¾›ç†è§£æ¦‚å¿µä¹‹ç”¨ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªå¯è¯»æµ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> stream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/directory</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘å¬ &#39;open&#39; äº‹ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">stream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">open</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">The file is ready to be read.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// é”™è¯¯å¤„ç†</span></span>
<span class="line"><span style="color:#D8DEE9;">stream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">error</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Error:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ³¨æ„ç‚¹-1" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„ç‚¹-1"><span>æ³¨æ„ç‚¹</span></a></h3><ul><li>å®é™…ä¸Š <code>fs</code> æ¨¡å—å’Œå…¶ä»–ä¸€äº› Node.js æ ¸å¿ƒæ¨¡å—ä½¿ç”¨çš„äº‹ä»¶åç§°å¯èƒ½ä¸åŒ…æ‹¬ <code>&#39;ready&#39;</code>ã€‚åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œä½ åº”è¯¥æŸ¥é˜…æœ€æ–°çš„å®˜æ–¹æ–‡æ¡£æ¥ç¡®å®šåº”è¯¥ç›‘å¬å“ªäº›äº‹ä»¶ã€‚</li><li><code>Event: &#39;ready&#39;</code> æ›´åƒæ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µï¼Œå…·ä½“å®ç°æ—¶éœ€è¦æ ¹æ®å®é™…çš„ API å’Œå…¶æ–‡æ¡£æ¥å†³å®šã€‚</li></ul><p>æ€»ä¹‹ï¼Œç†è§£ Node.js ä¸­çš„äº‹ä»¶å’Œäº‹ä»¶ç›‘å¬å¯¹äºé«˜æ•ˆåœ°è¿›è¡Œå¼‚æ­¥ç¼–ç¨‹éå¸¸é‡è¦ã€‚å¸Œæœ›è¿™ä¸ªè§£é‡Šèƒ½å¤Ÿå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ Node.js ä¸­çš„äº‹ä»¶æœºåˆ¶ã€‚</p><h4 id="writestream-byteswritten" tabindex="-1"><a class="header-anchor" href="#writestream-byteswritten"><span><a href="https://nodejs.org/docs/latest/api/fs.html#writestreambyteswritten" target="_blank" rel="noopener noreferrer">writeStream.bytesWritten</a></span></a></h4><p>Node.js ä¸­çš„ <code>writeStream.bytesWritten</code> å±äºæ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠåˆ°å†™å…¥æµï¼ˆwrite streamï¼‰çš„éƒ¨åˆ†ã€‚è¿™ä¸ªå±æ€§æä¾›äº†ä¸€ä¸ªéå¸¸ç›´è§‚çš„åŠŸèƒ½ï¼šå®ƒå‘Šè¯‰ä½ é€šè¿‡è¯¥å†™å…¥æµå·²ç»æˆåŠŸå†™å…¥çš„å­—èŠ‚æ•°ã€‚ç†è§£è¿™ä¸€ç‚¹å¯¹äºå¤„ç†æ–‡ä»¶å†™å…¥æ“ä½œã€ç›‘æ§ä¸Šä¼ è¿›åº¦æˆ–è€…éªŒè¯æ•°æ®å®Œæ•´æ€§ç­‰åœºæ™¯éå¸¸æœ‰å¸®åŠ©ã€‚</p><h3 id="é€šä¿—è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#é€šä¿—è§£é‡Š"><span>é€šä¿—è§£é‡Š</span></a></h3><p>æƒ³è±¡ä½ æ­£åœ¨ç”¨æ°´ç®¡ç»™ä¸€ä¸ªå¤§æ°´æ¡¶åŠ æ°´ï¼Œè€Œä½ æƒ³çŸ¥é“å·²ç»å¾€æ¡¶é‡ŒåŠ äº†å¤šå°‘æ°´ã€‚åœ¨è¿™æ¯”å–»ä¸­ï¼Œæ°´ç®¡å°±åƒæ˜¯ Node.js çš„å†™å…¥æµï¼Œå¤§æ°´æ¡¶åˆ™ç±»ä¼¼äºæ–‡ä»¶æˆ–è€…æ•°æ®æ¥æ”¶æ–¹ï¼Œè€Œ <code>bytesWritten</code> å°±å¥½æ¯”ä¸€ä¸ªè®¡é‡å™¨ï¼Œå‘Šè¯‰ä½ é€šè¿‡è¿™ä¸ªâ€œæ°´ç®¡â€å·²ç»æµäº†å¤šå°‘â€œæ°´â€ï¼ˆåœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œæ˜¯æ•°æ®çš„å­—èŠ‚æ•°ï¼‰ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-43" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-43"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>ç›‘æ§æ–‡ä»¶ä¸Šä¼ è¿›åº¦</strong></p><p>å½“ç”¨æˆ·é€šè¿‡ç½‘ç«™ä¸Šä¼ å¤§æ–‡ä»¶æ—¶ï¼Œåç«¯å¯èƒ½éœ€è¦ä½¿ç”¨ Node.js æ¥å¤„ç†è¿™ä¸ªæ–‡ä»¶ã€‚ä½¿ç”¨ <code>writeStream.bytesWritten</code>ï¼Œä½ å¯ä»¥å‡†ç¡®åœ°çŸ¥é“å·²ç»å†™å…¥æ–‡ä»¶çš„å­—èŠ‚é‡ã€‚åŸºäºè¿™ä¸ªä¿¡æ¯ï¼Œä½ å¯ä»¥è®¡ç®—ä¸Šä¼ è¿›åº¦ï¼Œå¹¶åŠæ—¶åé¦ˆç»™ç”¨æˆ·ã€‚</p><p>ç¤ºä¾‹ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æœ‰ä¸€ä¸ªä¸Šä¼ çš„æ–‡ä»¶æµ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> readStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createReadStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./path/to/source/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> writeStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./path/to/destination/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">data</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">chunk</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">chunk</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">å·²å†™å…¥: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">bytesWritten</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> å­—èŠ‚</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">readStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">end</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ä¸Šä¼ å®Œæˆï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>éªŒè¯æ•°æ®å®Œæ•´æ€§</strong></p><p>å¦‚æœä½ çŸ¥é“é¢„æœŸè¦å†™å…¥çš„æ€»å­—èŠ‚æ•°ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>writeStream.bytesWritten</code> æ¥éªŒè¯æ•°æ®æ˜¯å¦å®Œæ•´ä¼ è¾“ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸‹è½½è¿‡ç¨‹ç»“æŸåï¼Œæ£€æŸ¥å·²å†™å…¥çš„å­—èŠ‚æ•°æ˜¯å¦ä¸é¢„æœŸåŒ¹é…ã€‚</p><p>ç¤ºä¾‹ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> expectedBytes</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å‡è®¾ä½ æœŸæœ›å†™å…¥ 1024 å­—èŠ‚</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> writeStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./path/to/destination/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">finish</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">bytesWritten</span><span style="color:#81A1C1;"> ===</span><span style="color:#D8DEE9;"> expectedBytes</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶æˆåŠŸå†™å…¥ä¸”æ•°æ®å®Œæ•´ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å†™å…¥çš„å­—èŠ‚å’Œé¢„æœŸä¸ç¬¦ï¼Œæ•°æ®å¯èƒ½ä¸å®Œæ•´ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æ­¤å¤„æœ‰å¯¹writeStreamè¿›è¡Œå†™å…¥çš„ä»£ç </span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>é™åˆ¶ä¸Šä¼ å¤§å°</strong></p><p>åœ¨å¤„ç†æ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œä½ å¯èƒ½æƒ³é™åˆ¶æœ€å¤§æ–‡ä»¶å¤§å°ã€‚ä½ å¯ä»¥åˆ©ç”¨ <code>writeStream.bytesWritten</code> æ¥åˆ¤æ–­æ˜¯å¦è¶…å‡ºäº†é™åˆ¶ï¼Œå¹¶æ®æ­¤åšå‡ºå“åº”ã€‚</p><p>ç¤ºä¾‹ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> maxSize</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 5</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // 5MB çš„ä¸Šé™</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> writeStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./path/to/destination/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">drain</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> ()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">bytesWritten</span><span style="color:#81A1C1;"> &gt;</span><span style="color:#D8DEE9;"> maxSize</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶è¶…å‡ºäº†å¤§å°é™åˆ¶ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // ç»“æŸå†™å…¥æµ</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æ­¤å¤„æœ‰æ–‡ä»¶æ•°æ®æµå‘writeStreamçš„ä»£ç </span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="å°ç»“-13" tabindex="-1"><a class="header-anchor" href="#å°ç»“-13"><span>å°ç»“</span></a></h3><p><code>writeStream.bytesWritten</code> æ˜¯ Node.js ä¸­ä¸€ä¸ªç®€å•ä½†æä¸ºå®ç”¨çš„å±æ€§ï¼Œå®ƒè®©å¼€å‘è€…èƒ½å¤Ÿå®æ—¶ç›‘æµ‹é€šè¿‡å†™å…¥æµä¼ è¾“çš„æ•°æ®é‡ã€‚æ— è®ºæ˜¯åœ¨å®ç°ä¸Šä¼ è¿›åº¦æ¡ã€éªŒè¯æ•°æ®å®Œæ•´æ€§è¿˜æ˜¯é™åˆ¶ä¸Šä¼ å¤§å°ç­‰åœºæ™¯ï¼Œå®ƒéƒ½èƒ½å‘æŒ¥é‡è¦ä½œç”¨ï¼Œå¸®åŠ©å¼€å‘è€…æ„å»ºæ›´åŠ å¯é å’Œç”¨æˆ·å‹å¥½çš„åº”ç”¨ã€‚</p><h4 id="writestream-close-callback" tabindex="-1"><a class="header-anchor" href="#writestream-close-callback"><span><a href="https://nodejs.org/docs/latest/api/fs.html#writestreamclosecallback" target="_blank" rel="noopener noreferrer">writeStream.close([callback])</a></span></a></h4><p>Node.js ä¸­çš„ <code>writeStream.close([callback])</code> æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å‡½æ•°ï¼Œå®ƒå±äº Node.js çš„æ–‡ä»¶ç³»ç»Ÿ (<code>fs</code>) æ¨¡å—ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†æ–‡ä»¶å†™å…¥æµï¼ˆ<code>WriteStream</code>ï¼‰æ—¶ã€‚ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸ªå‡½æ•°ï¼Œè®©æˆ‘ä»¬å…ˆä»åŸºæœ¬æ¦‚å¿µå¼€å§‹ï¼Œé€æ­¥æ·±å…¥ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-19" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-19"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><h4 id="node-js-å’Œæ–‡ä»¶ç³»ç»Ÿ-fs-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#node-js-å’Œæ–‡ä»¶ç³»ç»Ÿ-fs-æ¨¡å—"><span>Node.js å’Œæ–‡ä»¶ç³»ç»Ÿï¼ˆFSï¼‰æ¨¡å—</span></a></h4><ul><li><strong>Node.js</strong> æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚</li><li><strong>æ–‡ä»¶ç³»ç»Ÿï¼ˆFSï¼‰æ¨¡å—</strong> æ˜¯ Node.js çš„ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œæä¾›äº†ä¸€ç³»åˆ—ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„æ–¹æ³•ï¼Œæ¯”å¦‚è¯»å–ã€å†™å…¥æ–‡ä»¶ç­‰ã€‚</li></ul><h4 id="æµ-streams" tabindex="-1"><a class="header-anchor" href="#æµ-streams"><span>æµï¼ˆStreamsï¼‰</span></a></h4><ul><li><strong>æµï¼ˆStreamsï¼‰</strong> æ˜¯ Node.js ä¸­å¤„ç†æµå¼æ•°æ®çš„æŠ½è±¡æ¥å£ã€‚å®ƒä»¬å¯ä»¥æ˜¯å¯è¯»çš„ã€å¯å†™çš„ï¼Œæˆ–è€…ä¸¤è€…éƒ½æ˜¯ã€‚æµå¯ä»¥ç”¨æ¥è¯»å–å¤§æ–‡ä»¶ï¼Œè€Œä¸å¿…ä¸€æ¬¡æ€§å°†å®ƒä»¬å…¨éƒ¨è¯»å…¥å†…å­˜ä¸­ã€‚</li></ul><h4 id="å†™å…¥æµ-writestream" tabindex="-1"><a class="header-anchor" href="#å†™å…¥æµ-writestream"><span>å†™å…¥æµï¼ˆWriteStreamï¼‰</span></a></h4><ul><li><strong>å†™å…¥æµï¼ˆWriteStreamï¼‰</strong> æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æµï¼Œä¸“ç”¨äºå°†æ•°æ®å†™å…¥ç›®æ ‡ï¼ˆé€šå¸¸æ˜¯æ–‡ä»¶ï¼‰ã€‚</li></ul><h3 id="writestream-close-callback-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#writestream-close-callback-æ–¹æ³•"><span><code>writeStream.close([callback])</code> æ–¹æ³•</span></a></h3><p>è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨äºæ‰‹åŠ¨å…³é—­ä¸€ä¸ªå†™å…¥æµã€‚å½“ä½ å®Œæˆäº†æ•°æ®å†™å…¥ï¼Œå¹¶æƒ³ç¡®ä¿é‡Šæ”¾ä¸è¯¥æµå…³è”çš„èµ„æºæ—¶ï¼Œå°±éœ€è¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚å®ƒæ¥å—ä¸€ä¸ªå¯é€‰çš„å›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°ä¼šåœ¨æµæˆåŠŸå…³é—­åè¢«è°ƒç”¨ã€‚</p><h4 id="å‚æ•°-11" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-11"><span>å‚æ•°</span></a></h4><ul><li><strong>callback</strong> <code>(optional)</code>ï¼šå½“æµå…³é—­åæ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-32" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-32"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œéœ€è¦å°†ä¸€äº›æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚</p><ol><li><strong>åˆ›å»ºå’Œå†™å…¥æ–‡ä»¶</strong> - é¦–å…ˆï¼Œä½ ä¼šåˆ›å»ºä¸€ä¸ªå†™å…¥æµï¼Œç”¨äºå°†æ•°æ®å†™å…¥æ–‡ä»¶ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªå†™å…¥æµï¼ŒæŒ‡å‘ä¸€ä¸ªæ–°æ–‡ä»¶ &#39;example.txt&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> writeStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ write æ–¹æ³•å†™å…¥æ•°æ®</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Hello, World!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">UTF8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>å…³é—­å†™å…¥æµ</strong> - æ•°æ®å†™å…¥å®Œæˆåï¼Œä½¿ç”¨ <code>writeStream.close()</code> å…³é—­æµï¼Œé‡Šæ”¾èµ„æºã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// æ˜¾å¼å…³é—­æµ</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File has been written and stream closed.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>writeStream.close()</code> è¢«è°ƒç”¨ä»¥ç¡®ä¿æ–‡ä»¶æ­£ç¡®å…³é—­å¹¶ä¸”æ‰€æœ‰æ•°æ®éƒ½å·²ç»è¢«åˆ·æ–°åˆ°ç£ç›˜ã€‚é€šè¿‡ä¼ é€’ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œä½ å¯ä»¥åœ¨æµæˆåŠŸå…³é—­åè·å–é€šçŸ¥ï¼Œå¹¶æ‰§è¡Œä¾‹å¦‚æ—¥å¿—è®°å½•æˆ–é€šçŸ¥ç”¨æˆ·ç­‰æ“ä½œã€‚</p><h3 id="å°ç»“-14" tabindex="-1"><a class="header-anchor" href="#å°ç»“-14"><span>å°ç»“</span></a></h3><p><code>writeStream.close([callback])</code> æ–¹æ³•åœ¨ Node.js åº”ç”¨ç¨‹åºä¸­éå¸¸é‡è¦ï¼Œå°¤å…¶æ˜¯å½“æ¶‰åŠåˆ°æµå¼æ–‡ä»¶å†™å…¥æ—¶ã€‚æ­£ç¡®åœ°ä½¿ç”¨å®ƒå¯ä»¥å¸®åŠ©ç¡®ä¿æ•°æ®å®Œæ•´æ€§å¹¶ä¼˜åŒ–èµ„æºä½¿ç”¨ã€‚</p><h4 id="writestream-path" tabindex="-1"><a class="header-anchor" href="#writestream-path"><span><a href="https://nodejs.org/docs/latest/api/fs.html#writestreampath" target="_blank" rel="noopener noreferrer">writeStream.path</a></span></a></h4><p>åœ¨ Node.js ä¸­ï¼Œ<code>writeStream</code> å¯¹è±¡æ˜¯ç”¨æ¥å†™å…¥æ•°æ®åˆ°ä¸€ä¸ªæ–‡ä»¶çš„ã€‚<code>writeStream.path</code> æ˜¯ <code>writeStream</code> å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒåŒ…å«äº†ä½ åˆ›å»ºè¿™ä¸ªæµæ—¶æ‰€æŒ‡å®šçš„æ–‡ä»¶è·¯å¾„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå‘Šè¯‰ä½ è¿™ä¸ªæµæ­£åœ¨å‘å“ªä¸ªæ–‡ä»¶ä½ç½®å†™å…¥æ•°æ®ã€‚</p><p>å½“ä½ ä½¿ç”¨ <code>fs.createWriteStream(path)</code> æ–¹æ³•åˆ›å»ºä¸€ä¸ªå¯å†™æµæ—¶ï¼Œä¼ é€’ç»™è¿™ä¸ªæ–¹æ³•çš„ <code>path</code> å‚æ•°å°±è¢«èµ‹å€¼ç»™äº† <code>writeStream.path</code> å±æ€§ã€‚</p><p>è¿™é‡Œæœ‰ä¸€äº›å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><h3 id="ä¾‹å­-1-å‘æ–‡ä»¶å†™å…¥æ–‡æœ¬" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-å‘æ–‡ä»¶å†™å…¥æ–‡æœ¬"><span>ä¾‹å­ 1ï¼šå‘æ–‡ä»¶å†™å…¥æ–‡æœ¬</span></a></h3><p>å‡è®¾ä½ æƒ³è¦å‘æ–‡ä»¶ &quot;example.txt&quot; å†™å…¥ä¸€æ®µæ–‡æœ¬ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªå†™å…¥æµï¼ŒæŒ‡å®šæ–‡ä»¶ä¸º &#39;example.txt&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> writeStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// &#39;writeStream.path&#39; å°†ä¼šåŒ…å« &#39;example.txt&#39;</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">path</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: example.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨å†™å…¥æµå†™å…¥æ•°æ®</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯ç¬¬ä¸€è¡Œæ–‡æœ¬</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯ç¬¬äºŒè¡Œæ–‡æœ¬</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æœ€åè¦å…³é—­æµ</span></span>
<span class="line"><span style="color:#D8DEE9;">writeStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† Node.js çš„ <code>fs</code> æ¨¡å—ï¼Œç„¶åé€šè¿‡ <code>fs.createWriteStream()</code> æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªæŒ‡å‘ &#39;example.txt&#39; æ–‡ä»¶çš„å†™å…¥æµã€‚æ¥ç€ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>writeStream.path</code> æ¥æŸ¥çœ‹è¿™ä¸ªæµå¯¹åº”çš„æ–‡ä»¶è·¯å¾„ï¼Œç»“æœæ˜¯ &#39;example.txt&#39;ã€‚ä½¿ç”¨ <code>writeStream.write()</code> æ–¹æ³•å‘æ–‡ä»¶å†™å…¥å†…å®¹ï¼Œæœ€åè°ƒç”¨ <code>writeStream.end()</code> ç»“æŸå†™å…¥æ“ä½œã€‚</p><h3 id="ä¾‹å­-2-å°†æ—¥å¿—ä¿¡æ¯å†™å…¥æ—¥å¿—æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-å°†æ—¥å¿—ä¿¡æ¯å†™å…¥æ—¥å¿—æ–‡ä»¶"><span>ä¾‹å­ 2ï¼šå°†æ—¥å¿—ä¿¡æ¯å†™å…¥æ—¥å¿—æ–‡ä»¶</span></a></h3><p>å‡è®¾ä½ éœ€è¦è®°å½•åº”ç”¨ç¨‹åºè¿è¡Œæ—¶çš„æ—¥å¿—ï¼Œå¹¶ä¸”æƒ³è¦å°†è¿™äº›æ—¥å¿—ä¿¡æ¯å†™å…¥åˆ° &quot;app.log&quot; æ–‡ä»¶ä¸­ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªå†™å…¥æµï¼ŒæŒ‡å®šæ–‡ä»¶ä¸º &#39;app.log&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> logStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">app.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> flags</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è®°å½•æ—¥å¿—çš„å‡½æ•°</span></span>
<span class="line"><span style="color:#81A1C1;">function</span><span style="color:#88C0D0;"> log</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">message</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">  // å†™å…¥æ—¥æœŸå’Œæ—¥å¿—ä¿¡æ¯</span></span>
<span class="line"><span style="color:#D8DEE9;">  logStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">[</span><span style="color:#81A1C1;">${</span><span style="color:#81A1C1;">new</span><span style="color:#88C0D0;"> Date</span><span style="color:#ECEFF4;">().</span><span style="color:#88C0D0;">toISOString</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">] </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">}</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ &#39;logStream.path&#39; ç¡®è®¤æˆ‘ä»¬æ­£åœ¨å†™å…¥çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Logging to </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">logStream</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">path</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: Logging to app.log</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è®°å½•ä¸€äº›æ—¥å¿—ä¿¡æ¯</span></span>
<span class="line"><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">åº”ç”¨å¯åŠ¨</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ‰§è¡Œä¸€äº›æ“ä½œ...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">åº”ç”¨é€€å‡º</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å…³é—­æµ</span></span>
<span class="line"><span style="color:#D8DEE9;">logStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">end</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åŒæ ·ä½¿ç”¨ <code>fs.createWriteStream()</code> åˆ›å»ºäº†ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ &quot;app.log&quot; çš„å†™å…¥æµã€‚æ³¨æ„è¿™é‡Œæˆ‘ä»¬åŠ å…¥ <code>{ flags: &#39;a&#39; }</code> å‚æ•°ï¼Œè¿™æ„å‘³ç€å¦‚æœæ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œæ–°çš„å†…å®¹ä¼šè¢«è¿½åŠ åˆ°æ–‡ä»¶çš„æœ«å°¾è€Œä¸æ˜¯è¦†ç›–ä¹‹å‰çš„å†…å®¹ã€‚æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª <code>log()</code> è¾…åŠ©å‡½æ•°ï¼Œå®ƒå°†æ—¶é—´æˆ³å’Œæ—¥å¿—æ¶ˆæ¯æ ¼å¼åŒ–åå†™å…¥æ—¥å¿—æ–‡ä»¶ã€‚ä½¿ç”¨ <code>logStream.path</code> æˆ‘ä»¬å¯ä»¥ç¡®è®¤å†™å…¥çš„æ–‡ä»¶åã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>writeStream.path</code> æ˜¯ Node.js ä¸­å¯å†™æµå¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒå­˜å‚¨äº†æµå…³è”æ–‡ä»¶çš„è·¯å¾„ï¼Œå¯ä»¥å¸®åŠ©ä½ éšæ—¶äº†è§£æµæ­£åœ¨æ“ä½œçš„å…·ä½“æ–‡ä»¶ã€‚</p><h4 id="writestream-pending" tabindex="-1"><a class="header-anchor" href="#writestream-pending"><span><a href="https://nodejs.org/docs/latest/api/fs.html#writestreampending" target="_blank" rel="noopener noreferrer">writeStream.pending</a></span></a></h4><p>åœ¨ Node.js ä¸­ï¼Œ<code>writeStream.pending</code> å±äºæ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>ï¼‰æ¨¡å—ä¸­çš„ä¸€ä¸ªç‰¹æ€§ï¼Œç”¨äºå¤„ç†æµï¼ˆstreamï¼‰ç›¸å…³çš„æ“ä½œã€‚åœ¨è¿™ä¸ªä¸Šä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºçš„æ˜¯å†™å…¥æµï¼ˆ<code>WriteStream</code>ï¼‰ï¼Œå®ƒå…è®¸ä½ å°†æ•°æ®å†™å…¥åˆ°æ–‡ä»¶ä¸­ã€‚</p><h3 id="ç†è§£-writestream-pending" tabindex="-1"><a class="header-anchor" href="#ç†è§£-writestream-pending"><span>ç†è§£ <code>writeStream.pending</code></span></a></h3><p>å½“ä½ ä½¿ç”¨ Node.js çš„ <code>fs.createWriteStream()</code> æ–¹æ³•åˆ›å»ºä¸€ä¸ªå†™å…¥æµæ—¶ï¼Œä½ å¯ä»¥é€šè¿‡è¿™ä¸ªæµå‘ä¸€ä¸ªæŒ‡å®šçš„æ–‡ä»¶å†™å…¥æ•°æ®ã€‚è¿™é‡Œï¼Œ<code>writeStream.pending</code> æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼å±æ€§ï¼Œç”¨æ¥è¡¨æ˜æ˜¯å¦æœ‰å¾…å¤„ç†çš„æ‰“å¼€è¯·æ±‚ã€‚</p><ul><li>å¦‚æœ <code>writeStream.pending</code> ä¸º <code>true</code>ï¼Œè¿™æ„å‘³ç€æµå°šæœªæˆåŠŸåœ°ä¸æ–‡ä»¶å»ºç«‹è¿æ¥ï¼Œä¹Ÿå°±æ˜¯è¯´æ–‡ä»¶è¿˜æ²¡å‡†å¤‡å¥½å†™å…¥ã€‚è¿™ç§æƒ…å†µå¯èƒ½å‘ç”Ÿåœ¨æµæ­£åœ¨ç­‰å¾…æ–‡ä»¶è¢«åˆ›å»ºæˆ–å¯ç”¨äºå†™å…¥ä¹‹å‰ã€‚</li><li>å¦‚æœä¸º <code>false</code>ï¼Œåˆ™è¡¨ç¤ºæµå·²ç»å‡†å¤‡å¥½ï¼Œä¸æ–‡ä»¶çš„è¿æ¥å·²ç»å»ºç«‹ï¼Œå¯ä»¥å¼€å§‹å†™å…¥æ•°æ®äº†ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-33" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-33"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>è€ƒè™‘ä¸€ä¸‹å‡ ä¸ªå®é™…åº”ç”¨åœºæ™¯ï¼Œå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ <code>writeStream.pending</code> çš„ä½œç”¨ï¼š</p><h4 id="ç¤ºä¾‹-1-æ—¥å¿—è®°å½•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æ—¥å¿—è®°å½•"><span>ç¤ºä¾‹ 1ï¼šæ—¥å¿—è®°å½•</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™ï¼Œä½ æƒ³æŠŠæ¯ä¸ªç”¨æˆ·çš„æ´»åŠ¨è®°å½•ä¸‹æ¥ã€‚å¯ä»¥ä½¿ç”¨ <code>writeStream</code> æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œå°†ç”¨æˆ·çš„æ¯ä¸ªè¯·æ±‚è¿½åŠ åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ£€æŸ¥ <code>writeStream.pending</code> å¯ä»¥å¸®åŠ©ä½ ç¡®å®šä½•æ—¶å¯ä»¥å®‰å…¨åœ°å¼€å§‹å†™å…¥æ—¥å¿—ä¿¡æ¯ï¼Œç¡®ä¿ä¸ä¼šå› ä¸ºæ–‡ä»¶æœªå‡†å¤‡å¥½è€Œä¸¢å¤±ä»»ä½•æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> logStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">user_activity.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> flags</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ£€æŸ¥æµæ˜¯å¦å‡†å¤‡å¥½</span></span>
<span class="line"><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">!</span><span style="color:#D8DEE9;">logStream</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">pending</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">  // å®‰å…¨åœ°å†™å…¥æ—¥å¿—</span></span>
<span class="line"><span style="color:#D8DEE9;">  logStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç”¨æˆ·æ‰§è¡Œäº†ä¸€ä¸ªæ“ä½œ</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç­‰å¾…æµå‡†å¤‡å°±ç»ª...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-æ•°æ®å¯¼å‡º" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æ•°æ®å¯¼å‡º"><span>ç¤ºä¾‹ 2ï¼šæ•°æ®å¯¼å‡º</span></a></h4><p>è®¾æƒ³å¦ä¸€ä¸ªåœºæ™¯ï¼Œä½ éœ€è¦ä»æ•°æ®åº“å¯¼å‡ºæ•°æ®å¹¶å°†å…¶ä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ä¾›åç»­åˆ†æã€‚åœ¨å¼€å§‹å¯¼å‡ºè¿‡ç¨‹ä¹‹å‰ï¼Œç¡®è®¤ <code>writeStream</code> æ˜¯å¦å·²ç»å‡†å¤‡å¥½æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å®è·µï¼Œå¯ä»¥é¿å…åœ¨æ–‡ä»¶æœªå‡†å¤‡å°±ç»ªæ—¶å¼€å§‹å¯¼å‡ºæ“ä½œï¼Œä»è€Œé˜²æ­¢æ½œåœ¨çš„é”™è¯¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dataStream</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">createWriteStream</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">exported_data.csv</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾ fetchData() å‡½æ•°ä»æ•°æ®åº“è·å–æ•°æ®</span></span>
<span class="line"><span style="color:#88C0D0;">fetchData</span><span style="color:#D8DEE9FF;">()</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">then</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#81A1C1;">!</span><span style="color:#D8DEE9;">dataStream</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">pending</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">    // æ•°æ®æµå‡†å¤‡å°±ç»ªï¼Œå¼€å§‹å†™å…¥æ•°æ®</span></span>
<span class="line"><span style="color:#D8DEE9;">    data</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forEach</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">record</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">      dataStream</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">record</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">id</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">, </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">record</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">name</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">, </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">record</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">email</span><span style="color:#81A1C1;">}</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç­‰å¾…æ•°æ®æµå°±ç»ª...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ€»ç»“-22" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-22"><span>æ€»ç»“</span></a></h3><p><code>writeStream.pending</code> åœ¨ Node.js ä¸­æ˜¯ä¸€ä¸ªé‡è¦çš„å±æ€§ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†æ–‡ä»¶å†™å…¥æ“ä½œæ—¶ã€‚å®ƒæä¾›äº†ä¸€ä¸ªç®€å•çš„æœºåˆ¶æ¥ç¡®ä¿å†™æ“ä½œåœ¨æ­£ç¡®çš„æ—¶é—´è¿›è¡Œï¼Œä»è€Œå¢å¼ºåº”ç”¨ç¨‹åºçš„å¥å£®æ€§å’Œæ•°æ®å®Œæ•´æ€§ã€‚åœ¨å¼€å‘è¿‡ç¨‹ä¸­åˆç†åˆ©ç”¨è¿™ä¸€å±æ€§ï¼Œå¯ä»¥æœ‰æ•ˆé¢„é˜²å†™å…¥é”™è¯¯ï¼Œä¼˜åŒ–åº”ç”¨çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚</p><h3 id="fs-constants" tabindex="-1"><a class="header-anchor" href="#fs-constants"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fsconstants" target="_blank" rel="noopener noreferrer">fs.constants</a></span></a></h3><p>Node.js ä¸­çš„ <code>fs.constants</code> æ˜¯æ–‡ä»¶ç³»ç»Ÿæ“ä½œæ—¶ç”¨åˆ°çš„ä¸€äº›å¸¸é‡ã€‚è¿™äº›å¸¸é‡ä»£è¡¨äº†åœ¨æ–‡ä»¶ç³»ç»Ÿæ“ä½œä¸­å¯èƒ½ä¼šç”¨åˆ°çš„ä¸åŒçš„æƒé™å’Œè¡Œä¸ºæ ‡å¿—ï¼Œæ¯”å¦‚è¯»ã€å†™ã€æ‰§è¡Œæ–‡ä»¶ç­‰ã€‚</p><p>ä¸‹é¢ä»¥å‡ ä¸ªå®é™…çš„ä¾‹å­æ¥è§£é‡Š <code>fs.constants</code> çš„ä½¿ç”¨ï¼š</p><ol><li><p>æ‰“å¼€æ–‡ä»¶è¿›è¡Œè¯»å†™</p><p>å½“ä½ æƒ³ä½¿ç”¨ <code>fs.open</code> æ–¹æ³•æ‰“å¼€æ–‡ä»¶æ—¶ï¼Œå¯ä»¥é€šè¿‡ <code>fs.constants</code> æ¥æŒ‡å®šæ‰“å¼€æ–‡ä»¶çš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶ç”¨äºè¯»å–</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">O_RDONLY</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ— æ³•æ‰“å¼€æ–‡ä»¶</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶æˆåŠŸæ‰“å¼€</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // è¿›è¡Œè¯»å–æ“ä½œ...</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶ç”¨äºå†™å…¥</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">O_WRONLY</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ— æ³•æ‰“å¼€æ–‡ä»¶</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶æ‰“å¼€ç”¨äºå†™å…¥</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // è¿›è¡Œå†™å…¥æ“ä½œ...</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™é‡Œ <code>O_RDONLY</code> è¡¨ç¤ºåªè¯»æ¨¡å¼ï¼Œ<code>O_WRONLY</code> è¡¨ç¤ºåªå†™æ¨¡å¼ã€‚</p></li><li><p>æ£€æŸ¥æ–‡ä»¶è®¿é—®æƒé™</p><p>æœ‰æ—¶å€™ä½ å¯èƒ½éœ€è¦æ£€æŸ¥å½“å‰è¿›ç¨‹æ˜¯å¦æœ‰æƒé™å»å¯¹æŸä¸ªæ–‡ä»¶è¿›è¡Œè¯»ã€å†™æˆ–è€…æ‰§è¡Œæ“ä½œï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨ <code>fs.access</code> æ–¹æ³•ç»“åˆ <code>fs.constants</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯è¯»</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">access</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">R_OK</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ²¡æœ‰è¯»å–æƒé™</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å¯è¯»</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯å†™</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">access</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">W_OK</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ²¡æœ‰å†™å…¥æƒé™</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å¯å†™</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>R_OK</code> å’Œ <code>W_OK</code> åˆ†åˆ«è¡¨ç¤ºæ£€æŸ¥è¯»å’Œå†™çš„æƒé™ã€‚</p></li><li><p>ç›‘å¬æ–‡ä»¶å˜åŒ–</p><p>å½“ä½ æƒ³è¦ç›‘æµ‹æ–‡ä»¶ç³»ç»Ÿä¸­çš„å˜æ›´æ—¶ï¼ˆæ¯”å¦‚æ–‡ä»¶è¢«ä¿®æ”¹ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ <code>fs.watch</code> æ–¹æ³•ï¼Œå¹¶ä¸”åˆ©ç”¨ <code>fs.constants</code> ä¸­å®šä¹‰çš„æ ‡å¿—æ¥ç²¾ç¡®æ§åˆ¶è¡Œä¸ºï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ç›‘å¬ file.txt æ–‡ä»¶çš„å˜åŒ–</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watch</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  {</span><span style="color:#88C0D0;"> persistent</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;">,</span><span style="color:#88C0D0;"> recursive</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> false</span><span style="color:#ECEFF4;"> },</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> filename</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#81A1C1;"> ===</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">change</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ–‡ä»¶å‘ç”Ÿäº†å˜åŒ–: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filename</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œæ²¡æœ‰ç›´æ¥ä½¿ç”¨ <code>fs.constants</code>ï¼Œä½†æ˜¯ <code>fs.watch</code> æ–¹æ³•èƒŒåä¹Ÿæ˜¯ä¾é è¿™äº›å¸¸é‡å®ç°çš„ã€‚</p></li></ol><p>æ€»çš„æ¥è¯´ï¼Œ<code>fs.constants</code> æä¾›äº†ä¸€å¥—å®Œæ•´çš„å¸¸é‡é›†åˆï¼Œä¾›ä½ åœ¨ä½¿ç”¨ Node.js æ–‡ä»¶ç³»ç»Ÿæ¨¡å— (<code>fs</code>) è¿›è¡Œæ“ä½œæ—¶ä½¿ç”¨ï¼Œä»¥ä¾¿æä¾›æ˜ç¡®ã€å¯è¯»æ€§å¼ºçš„ä»£ç ã€‚è¿™äº›å¸¸é‡å¯ä»¥å¸®åŠ©ä½ ç¼–å†™å‡ºæ—¢å®‰å…¨åˆç¬¦åˆé¢„æœŸçš„æ–‡ä»¶ç³»ç»Ÿç›¸å…³ä»£ç ã€‚</p><h4 id="fs-constants-1" tabindex="-1"><a class="header-anchor" href="#fs-constants-1"><span><a href="https://nodejs.org/docs/latest/api/fs.html#fs-constants" target="_blank" rel="noopener noreferrer">FS constants</a></span></a></h4><p>Node.js ä¸­çš„â€œFS constantsâ€æ˜¯æŒ‡æ–‡ä»¶ç³»ç»Ÿä¸­ä½¿ç”¨çš„ä¸€ç³»åˆ—å¸¸é‡ã€‚åœ¨ç¼–å†™ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„ç¨‹åºæ—¶ï¼Œè¿™äº›å¸¸æ•°å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´ç²¾ç¡®åœ°æ§åˆ¶å’Œç†è§£è¿™äº›æ“ä½œã€‚äº†è§£è¿™äº›å¸¸é‡å°¤å…¶å¯¹äºéœ€è¦å¤„ç†æ–‡ä»¶è¯»å†™ã€æƒé™ç®¡ç†ç­‰ä»»åŠ¡çš„å¼€å‘äººå‘˜æ¥è¯´éå¸¸é‡è¦ã€‚</p><h3 id="å¸¸è§çš„-fs-å¸¸é‡" tabindex="-1"><a class="header-anchor" href="#å¸¸è§çš„-fs-å¸¸é‡"><span>å¸¸è§çš„ FS å¸¸é‡</span></a></h3><ol><li><p><strong>è®¿é—®æƒé™</strong></p><ul><li><code>fs.constants.R_OK</code>: æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯è¯»ã€‚</li><li><code>fs.constants.W_OK</code>: æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯å†™ã€‚</li><li><code>fs.constants.X_OK</code>: æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œã€‚</li></ul></li><li><p><strong>æ‰“å¼€æ¨¡å¼</strong></p><ul><li><code>fs.constants.O_RDONLY</code>: ä»¥åªè¯»æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚</li><li><code>fs.constants.O_WRONLY</code>: ä»¥åªå†™æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚</li><li><code>fs.constants.O_RDWR</code>: ä»¥è¯»å†™æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚</li><li><code>fs.constants.O_CREAT</code>: å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºè¯¥æ–‡ä»¶ã€‚</li><li><code>fs.constants.O_EXCL</code>: ä¸<code>O_CREAT</code>ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œå¦‚æœæ–‡ä»¶å·²å­˜åœ¨åˆ™ä¼šå¤±è´¥ã€‚</li></ul></li><li><p><strong>æ–‡ä»¶æ“ä½œ</strong></p><ul><li><code>fs.constants.F_OK</code>: æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚</li><li><code>fs.constants.COPYFILE_EXCL</code>: åœ¨ä½¿ç”¨<code>fs.copyFile()</code>æˆ–<code>fs.copyFileSync()</code>æ—¶ï¼Œå¦‚æœç›®æ ‡æ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™æ‹·è´æ“ä½œä¼šå¤±è´¥ã€‚</li></ul></li></ol><h3 id="å®é™…è¿ç”¨ä¾‹å­-44" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-44"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="æ£€æŸ¥æ–‡ä»¶æƒé™" tabindex="-1"><a class="header-anchor" href="#æ£€æŸ¥æ–‡ä»¶æƒé™"><span>æ£€æŸ¥æ–‡ä»¶æƒé™</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œéœ€è¦å…ˆæ£€æŸ¥ä¸€ä¸ªæ–‡ä»¶æ˜¯å¦å…·æœ‰è¯»æƒé™ï¼Œç„¶åå†å°è¯•è¯»å–å®ƒã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯è¯»</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">access</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">R_OK</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶ä¸å¯è¯»</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å¯è¯»</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // éšåå¯ä»¥å®‰å…¨åœ°è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="åˆ›å»ºæ–°æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºæ–°æ–‡ä»¶"><span>åˆ›å»ºæ–°æ–‡ä»¶</span></a></h4><p>å¦‚æœä½ æƒ³åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œä½†åˆä¸æƒ³è¦†ç›–å·²æœ‰æ–‡ä»¶ï¼Œå¯ä»¥ç»“åˆä½¿ç”¨<code>O_CREAT</code>å’Œ<code>O_EXCL</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> newFilePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./newfile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å°è¯•åˆ›å»ºæ–°æ–‡ä»¶ï¼Œä½†ä¸è¦†ç›–å·²å­˜åœ¨çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">newFilePath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">O_CREAT</span><span style="color:#81A1C1;"> |</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">O_EXCL</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²å­˜åœ¨æˆ–æ— æ³•åˆ›å»º</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶åˆ›å»ºæˆåŠŸ</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦ï¼ˆfdï¼‰è¿›è¡Œåç»­æ“ä½œï¼Œå¦‚å†™å…¥æ•°æ®</span></span>
<span class="line"><span style="color:#616E88;">  // å®Œæˆæ“ä½œåï¼Œåˆ«å¿˜äº†å…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å…³é—­æ–‡ä»¶æ—¶å‡ºé”™</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™äº›ç¤ºä¾‹ï¼Œä½ åº”è¯¥èƒ½å¤Ÿçœ‹åˆ° FS å¸¸é‡åœ¨å®é™…ç¼–ç¨‹ä¸­çš„åº”ç”¨ã€‚å®ƒä»¬æä¾›äº†ä¸€ç§ä¾¿æ·çš„æ–¹å¼æ¥å¼•ç”¨ç‰¹å®šçš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œä»£ç ï¼Œä½¿ä»£ç æ›´åŠ æ¸…æ™°å’Œæ˜“äºç»´æŠ¤ã€‚</p><h5 id="file-access-constants" tabindex="-1"><a class="header-anchor" href="#file-access-constants"><span><a href="https://nodejs.org/docs/latest/api/fs.html#file-access-constants" target="_blank" rel="noopener noreferrer">File access constants</a></span></a></h5><p>åœ¨ Node.js ä¸­ï¼Œæ–‡ä»¶ç³»ç»Ÿï¼ˆé€šå¸¸ç®€ç§°ä¸º<code>fs</code>æ¨¡å—ï¼‰æ˜¯ç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ä¸€ä¸ªæ¨¡å—ã€‚å®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œåƒè¯»å–æ–‡ä»¶ã€åˆ›å»ºæ–‡ä»¶ã€ä¿®æ”¹æ–‡ä»¶ä»¥åŠæ£€æŸ¥æ–‡ä»¶è¯¦æƒ…ç­‰æ“ä½œã€‚ä¸ºäº†æ›´ç»†è‡´åœ°æ§åˆ¶å¯¹æ–‡ä»¶çš„æ“ä½œï¼ŒNode.js æä¾›äº†ä¸€äº›è®¿é—®å¸¸é‡ï¼ˆAccess Constantsï¼‰ï¼Œè¿™äº›å¸¸é‡å¯ä»¥å¸®åŠ©ä½ è®¾ç½®å¯¹æ–‡ä»¶çš„ä¸åŒè®¿é—®çº§åˆ«ã€‚</p><h3 id="å¸¸è§çš„æ–‡ä»¶è®¿é—®å¸¸é‡" tabindex="-1"><a class="header-anchor" href="#å¸¸è§çš„æ–‡ä»¶è®¿é—®å¸¸é‡"><span>å¸¸è§çš„æ–‡ä»¶è®¿é—®å¸¸é‡</span></a></h3><ul><li><code>fs.constants.F_OK</code>: æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚</li><li><code>fs.constants.R_OK</code>: æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯è¯»ã€‚</li><li><code>fs.constants.W_OK</code>: æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯å†™ã€‚</li><li><code>fs.constants.X_OK</code>: æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œã€‚</li></ul><p>å½“ä½ ä½¿ç”¨<code>fs</code>æ¨¡å—çš„æ–¹æ³•ï¼Œæ¯”å¦‚<code>fs.access()</code>æ¥æ£€æŸ¥æ–‡ä»¶çš„æƒé™æ—¶ï¼Œè¿™äº›å¸¸é‡éå¸¸æœ‰ç”¨ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-16" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-16"><span>å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</span></a></h3><ol><li><p><strong>æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</strong>ï¼šå‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦ç¡®è®¤æŸä¸ªé‡è¦çš„é…ç½®æ–‡ä»¶æ˜¯å¦å·²ç»åœ¨æ­£ç¡®çš„ä½ç½®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">access</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">F_OK</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">é…ç½®æ–‡ä»¶ä¸å­˜åœ¨ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">é…ç½®æ–‡ä»¶å­˜åœ¨ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯è¯»å’Œå¯å†™</strong>ï¼šæ¯”å¦‚ä½ çš„åº”ç”¨éœ€è¦è¯»å–ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œå¹¶åœ¨å…¶æœ«å°¾æ·»åŠ æ–°çš„æ—¥å¿—é¡¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">access</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">app.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">R_OK</span><span style="color:#81A1C1;"> |</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">W_OK</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ—¥å¿—æ–‡ä»¶ä¸å¯è¯»å†™ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ—¥å¿—æ–‡ä»¶å¯è¯»å†™ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // è¿™é‡Œå¯ä»¥å®‰å…¨åœ°è¯»å–å’Œå†™å…¥æ—¥å¿—æ–‡ä»¶</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œ</strong>ï¼šå¦‚æœä½ çš„ Node.js è„šæœ¬éœ€è¦å¯åŠ¨ä¸€ä¸ªå¤–éƒ¨ç¨‹åºï¼Œä½ å¯èƒ½æƒ³è¦å…ˆæ£€æŸ¥è¯¥ç¨‹åºæ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">access</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">someprogram</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">X_OK</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç¨‹åºä¸å¯æ‰§è¡Œã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ç¨‹åºå¯æ‰§è¡Œã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // åœ¨è¿™é‡Œå¯ä»¥å®‰å…¨åœ°è°ƒç”¨æ­¤ç¨‹åº</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="å°ç»“-15" tabindex="-1"><a class="header-anchor" href="#å°ç»“-15"><span>å°ç»“</span></a></h3><p>é€šè¿‡ä¸Šè¿°ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ°æ–‡ä»¶è®¿é—®å¸¸é‡åœ¨å®é™…ç¼–ç¨‹ä¸­çš„åº”ç”¨ã€‚å®ƒä»¬æä¾›äº†ä¸€ç§çµæ´»çš„æ–¹å¼æ¥æ£€æŸ¥æ–‡ä»¶çš„ä¸åŒæƒé™ï¼Œç¡®ä¿ä½ çš„ Node.js åº”ç”¨èƒ½å¤Ÿæ ¹æ®æ–‡ä»¶çš„å¯è®¿é—®æ€§æ­£ç¡®åœ°æ‰§è¡Œæ“ä½œã€‚è¿™æ˜¯å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ—¶å¿…é¡»è€ƒè™‘çš„ä¸€éƒ¨åˆ†ï¼Œç‰¹åˆ«æ˜¯åœ¨æ¶‰åŠåˆ°æ–‡ä»¶æƒé™å’Œå®‰å…¨æ€§çš„åœºæ™¯ä¸­ã€‚</p><h5 id="file-copy-constants" tabindex="-1"><a class="header-anchor" href="#file-copy-constants"><span><a href="https://nodejs.org/docs/latest/api/fs.html#file-copy-constants" target="_blank" rel="noopener noreferrer">File copy constants</a></span></a></h5><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript ç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨å®ƒæ¥åˆ›å»ºç½‘ç«™åç«¯ã€API ç­‰ã€‚åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œå…¶ä¸­ä¸€ä¸ªç‰¹æ€§æ˜¯æ–‡ä»¶æ‹·è´å¸¸é‡ï¼ˆFile copy constantsï¼‰ï¼Œè¿™äº›å¸¸é‡ä¸»è¦ç”¨äº<code>fs</code>æ¨¡å—ä¸­çš„æ–‡ä»¶æ“ä½œåŠŸèƒ½ã€‚</p><p><code>fs</code>æ¨¡å—æ˜¯ Node.js çš„ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œæä¾›äº†ä¸€ç³»åˆ—ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’çš„æ–¹æ³•ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>fs</code>æ¨¡å—è¯»å–æ–‡ä»¶ã€å†™å…¥æ–‡ä»¶ã€ä¿®æ”¹æ–‡ä»¶æƒé™ç­‰ã€‚</p><h3 id="æ–‡ä»¶æ‹·è´å¸¸é‡" tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶æ‹·è´å¸¸é‡"><span>æ–‡ä»¶æ‹·è´å¸¸é‡</span></a></h3><p>å½“ä½ ä½¿ç”¨<code>fs</code>æ¨¡å—ä¸­çš„<code>copyFile</code>æˆ–<code>copyFileSync</code>æ–¹æ³•æ‹·è´æ–‡ä»¶æ—¶ï¼Œä½ å¯ä»¥é€šè¿‡æ–‡ä»¶æ‹·è´å¸¸é‡æ¥æŒ‡å®šæ‹·è´æ“ä½œçš„è¡Œä¸ºã€‚æˆªè‡³ Node.js v21.7.1 ç‰ˆæœ¬ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å¯ç”¨çš„æ–‡ä»¶æ‹·è´å¸¸é‡ï¼š</p><ul><li><code>fs.constants.COPYFILE_EXCL</code>: åœ¨æ‹·è´æ“ä½œä¸­ä½¿ç”¨æ­¤å¸¸é‡ï¼Œå¦‚æœç›®æ ‡æ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™æ‹·è´æ“ä½œä¼šå¤±è´¥ã€‚</li><li><code>fs.constants.COPYFILE_FICLONE</code>: ä½¿ç”¨æ­¤å¸¸é‡ï¼Œæ‹·è´æ“ä½œä¼šå°è¯•åˆ›å»ºä¸€ä¸ªâ€œå¿«é€Ÿæ‹·è´â€çš„å‰¯æœ¬ï¼Œè¿™é€šå¸¸æ„å‘³ç€åº•å±‚å­˜å‚¨ç³»ç»Ÿä¼šå°è¯•é‡ç”¨æ•°æ®å—è€Œä¸æ˜¯è¿›è¡Œç‰©ç†æ‹·è´ï¼Œä»è€Œæé«˜æ•ˆç‡ã€‚</li><li><code>fs.constants.COPYFILE_FICLONE_FORCE</code>: ä¸<code>COPYFILE_FICLONE</code>ç±»ä¼¼ï¼Œä½†å¦‚æœå¿«é€Ÿæ‹·è´ä¸å¯ç”¨ï¼Œåˆ™æ‹·è´æ“ä½œä¼šå›é€€åˆ°æ™®é€šçš„æ‹·è´æ–¹å¼ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-16" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-16"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œéœ€è¦å°†ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡ä»ä¸€ä¸ªä¸´æ—¶ç›®å½•ç§»åŠ¨åˆ°ä¸€ä¸ªæŒä¹…åŒ–å­˜å‚¨ç›®å½•ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¼šä½¿ç”¨<code>fs.copyFile</code>æ–¹æ³•æ¥å®ç°ï¼ŒåŒæ—¶ä½¿ç”¨æ–‡ä»¶æ‹·è´å¸¸é‡æ¥ç¡®ä¿æ“ä½œçš„æ­£ç¡®æ‰§è¡Œã€‚</p><h4 id="ç¤ºä¾‹-1-é˜²æ­¢è¦†ç›–ç°æœ‰æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-é˜²æ­¢è¦†ç›–ç°æœ‰æ–‡ä»¶"><span>ç¤ºä¾‹ 1ï¼šé˜²æ­¢è¦†ç›–ç°æœ‰æ–‡ä»¶</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‹·è´æ–‡ä»¶ï¼Œå¹¶ç¡®ä¿ä¸è¦†ç›–å·²å­˜åœ¨çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">copyFile</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">source.jpg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">destination.jpg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">COPYFILE_EXCL</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">source.jpg was copied to destination.jpg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°è¯•å°†<code>source.jpg</code>å¤åˆ¶åˆ°<code>destination.jpg</code>ï¼Œä½¿ç”¨<code>COPYFILE_EXCL</code>å¸¸é‡ç¡®ä¿å¦‚æœ<code>destination.jpg</code>å·²ç»å­˜åœ¨ï¼Œåˆ™æŠ›å‡ºé”™è¯¯å¹¶åœæ­¢æ‹·è´ã€‚</p><h4 id="ç¤ºä¾‹-2-ä½¿ç”¨å¿«é€Ÿæ‹·è´" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨å¿«é€Ÿæ‹·è´"><span>ç¤ºä¾‹ 2ï¼šä½¿ç”¨å¿«é€Ÿæ‹·è´</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å°è¯•ä½¿ç”¨å¿«é€Ÿæ‹·è´ï¼Œå¦‚æœä¸æ”¯æŒåˆ™æ­£å¸¸æ‹·è´</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">copyFile</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">source.jpg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">destination.jpg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">COPYFILE_FICLONE</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">source.jpg was copied to destination.jpg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­å°è¯•ä½¿ç”¨å¿«é€Ÿæ‹·è´æœºåˆ¶æ¥æé«˜æ‹·è´æ•ˆç‡ã€‚å¦‚æœåº•å±‚ç³»ç»Ÿæ”¯æŒï¼Œé‚£ä¹ˆå°†ä¼šåˆ©ç”¨ç°æœ‰çš„æ•°æ®å—æ¥åˆ›å»ºæ–°æ–‡ä»¶ï¼Œå¦åˆ™ä¼šæ‰§è¡Œæ­£å¸¸çš„æ‹·è´è¿‡ç¨‹ã€‚</p><p>é€šè¿‡è¿™æ ·çš„æœºåˆ¶ï¼ŒNode.js ä½¿å¾—æ–‡ä»¶æ“ä½œæ›´åŠ çµæ´»å’Œé«˜æ•ˆã€‚è¿™å¯¹äºéœ€è¦å¤„ç†å¤§é‡æ–‡ä»¶æˆ–è€…å¯¹æ–‡ä»¶æ“ä½œæ€§èƒ½æœ‰è¦æ±‚çš„åº”ç”¨å°¤ä¸ºé‡è¦ã€‚</p><h5 id="file-open-constants" tabindex="-1"><a class="header-anchor" href="#file-open-constants"><span><a href="https://nodejs.org/docs/latest/api/fs.html#file-open-constants" target="_blank" rel="noopener noreferrer">File open constants</a></span></a></h5><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒä½¿å¾—å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚Node.js æä¾›äº†å¾ˆå¤šå†…å»ºæ¨¡å—ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿæ–¹ä¾¿åœ°è¿›è¡Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œã€ç½‘ç»œè¯·æ±‚ç­‰ã€‚<code>fs</code> æ¨¡å—æ˜¯ Node.js ä¸­ç”¨äºæ“ä½œæ–‡ä»¶ç³»ç»Ÿçš„æ¨¡å—ä¹‹ä¸€ã€‚</p><p>åœ¨ <code>fs</code> æ¨¡å—ä¸­ï¼Œæœ‰å¾ˆå¤šç”¨äºæ§åˆ¶å¦‚ä½•æ‰“å¼€æ–‡ä»¶çš„å¸¸é‡ã€‚è¿™äº›å¸¸é‡å¯ä»¥åœ¨ä½¿ç”¨ <code>fs.open()</code>ã€<code>fs.openSync()</code>ã€<code>fsPromises.open()</code> ç­‰æ–¹æ³•æ‰“å¼€æ–‡ä»¶æ—¶ä½¿ç”¨ï¼Œå…è®¸ä½ ç²¾ç¡®åœ°å®šä¹‰æƒ³è¦å¦‚ä½•å¤„ç†æ–‡ä»¶ã€‚ä¸‹é¢æˆ‘ä¼šåˆ—ä¸¾ä¸€äº›å¸¸ç”¨çš„å¸¸é‡ï¼Œå¹¶é€šè¿‡å®ä¾‹è§£é‡Šå®ƒä»¬çš„ä½œç”¨ï¼š</p><h3 id="å¸¸ç”¨çš„æ–‡ä»¶æ‰“å¼€å¸¸é‡" tabindex="-1"><a class="header-anchor" href="#å¸¸ç”¨çš„æ–‡ä»¶æ‰“å¼€å¸¸é‡"><span>å¸¸ç”¨çš„æ–‡ä»¶æ‰“å¼€å¸¸é‡</span></a></h3><ul><li><code>fs.constants.O_RDONLY</code>: è¡¨ç¤ºä»¥åªè¯»æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚</li><li><code>fs.constants.O_WRONLY</code>: è¡¨ç¤ºä»¥åªå†™æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚</li><li><code>fs.constants.O_RDWR</code>: è¡¨ç¤ºä»¥è¯»å†™æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚</li><li><code>fs.constants.O_CREAT</code>: å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºè¯¥æ–‡ä»¶ã€‚</li><li><code>fs.constants.O_EXCL</code>: ä¸ <code>O_CREAT</code> ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œå¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™ä¼šå¯¼è‡´æ‰“å¼€æ–‡ä»¶å¤±è´¥ã€‚</li><li><code>fs.constants.O_TRUNC</code>: å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œä¸”ä»¥å†™æ–¹å¼æ‰“å¼€ï¼Œåˆ™å°†å…¶é•¿åº¦æˆªæ–­ä¸º 0ã€‚</li><li><code>fs.constants.O_APPEND</code>: ä»¥è¿½åŠ æ¨¡å¼æ‰“å¼€æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºæ–‡ä»¶ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-34" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-34"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ä¾‹å­-1-åªè¯»æ–¹å¼æ‰“å¼€æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-åªè¯»æ–¹å¼æ‰“å¼€æ–‡ä»¶"><span>ä¾‹å­ 1: åªè¯»æ–¹å¼æ‰“å¼€æ–‡ä»¶</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">O_RDONLY</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦(fd)è¿›è¡Œæ“ä½œï¼Œä¾‹å¦‚è¯»å–æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä»¥åªè¯»æ¨¡å¼æ‰“å¼€ä¸€ä¸ªåå« <code>example.txt</code> çš„æ–‡ä»¶ã€‚</p><h4 id="ä¾‹å­-2-åˆ›å»ºæ–°æ–‡ä»¶å¹¶å†™å…¥å†…å®¹" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-åˆ›å»ºæ–°æ–‡ä»¶å¹¶å†™å…¥å†…å®¹"><span>ä¾‹å­ 2: åˆ›å»ºæ–°æ–‡ä»¶å¹¶å†™å…¥å†…å®¹</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">newfile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">O_WRONLY</span><span style="color:#81A1C1;"> |</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">O_CREAT</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello World!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File has been saved!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬è¯•å›¾æ‰“å¼€ï¼ˆæˆ–åˆ›å»ºï¼‰æ–‡ä»¶ <code>newfile.txt</code> ä»¥å†™å…¥æ•°æ®ã€‚æˆ‘ä»¬ä½¿ç”¨äº† <code>O_WRONLY</code>ï¼ˆåªå†™ï¼‰å’Œ <code>O_CREAT</code>ï¼ˆä¸å­˜åœ¨åˆ™åˆ›å»ºï¼‰ã€‚ä¹‹åï¼Œæˆ‘ä»¬å°è¯•å‘æ–‡ä»¶å†™å…¥ &quot;Hello World!&quot;ã€‚</p><h4 id="ä¾‹å­-3-ä»¥è¿½åŠ æ¨¡å¼æ‰“å¼€æ–‡ä»¶å¹¶å†™å…¥" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-3-ä»¥è¿½åŠ æ¨¡å¼æ‰“å¼€æ–‡ä»¶å¹¶å†™å…¥"><span>ä¾‹å­ 3: ä»¥è¿½åŠ æ¨¡å¼æ‰“å¼€æ–‡ä»¶å¹¶å†™å…¥</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">log.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">O_APPEND</span><span style="color:#81A1C1;"> |</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">O_CREAT</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">New log entry</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Log has been updated!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°è¯•æ‰“å¼€åä¸º <code>log.txt</code> çš„æ–‡ä»¶ï¼Œä½¿ç”¨ <code>O_APPEND</code> æ¥ç¡®ä¿æˆ‘ä»¬å†™å…¥çš„å†…å®¹ä¼šè¢«è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾è€Œä¸æ˜¯è¦†ç›–ä¹‹å‰çš„å†…å®¹ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œ<code>O_CREAT</code> ä¿è¯æ–‡ä»¶ä¼šè¢«åˆ›å»ºã€‚</p><p>é€šè¿‡ä¸Šè¿°ä¾‹å­ï¼Œä½ åº”è¯¥å¯¹ Node.js ä¸­å¦‚ä½•ä½¿ç”¨æ–‡ä»¶æ‰“å¼€å¸¸é‡æœ‰äº†æ¯”è¾ƒç›´è§‚çš„ç†è§£ã€‚å®ƒä»¬åœ¨æ‰§è¡Œæ–‡ä»¶æ“ä½œæ—¶æä¾›äº†æ›´å¤šçš„æ§åˆ¶å’Œçµæ´»æ€§ã€‚</p><h5 id="file-type-constants" tabindex="-1"><a class="header-anchor" href="#file-type-constants"><span><a href="https://nodejs.org/docs/latest/api/fs.html#file-type-constants" target="_blank" rel="noopener noreferrer">File type constants</a></span></a></h5><p>åœ¨ Node.js ä¸­ï¼Œæ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼ˆé€šå¸¸ç§°ä¸º <code>fs</code>ï¼‰æä¾›äº†ä¸€ç³»åˆ—å·¥å…·ï¼Œå¯ä»¥è®©ä½ åœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œæ–‡ä»¶æ“ä½œï¼Œæ¯”å¦‚è¯»å†™æ–‡ä»¶ã€åˆ›å»ºç›®å½•ç­‰ã€‚åœ¨è¿™äº›æ“ä½œä¸­ï¼Œæœ‰æ—¶æˆ‘ä»¬éœ€è¦åŒºåˆ†æ–‡ä»¶çš„ç±»å‹ï¼Œä¾‹å¦‚æ˜¯æ™®é€šæ–‡ä»¶ã€ç›®å½•è¿˜æ˜¯ç¬¦å·é“¾æ¥ç­‰ã€‚</p><p>åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­æåˆ°çš„ &quot;File type constants&quot; æ˜¯ä¸€ç»„é¢„å®šä¹‰çš„å¸¸é‡ï¼Œç”¨äºè¡¨ç¤ºæ–‡ä»¶çš„ä¸åŒç±»å‹ã€‚å®ƒä»¬å¯ä»¥åœ¨ä½¿ç”¨ <code>fs.Stats</code> å¯¹è±¡æ—¶æ´¾ä¸Šç”¨åœºï¼Œå› ä¸º <code>fs.Stats</code> æä¾›äº†ä¸€ä¸ªæ–¹æ³•å«åš <code>stats.mode</code>ï¼Œè¿”å›åŒ…å«æ–‡ä»¶ç±»å‹ä¿¡æ¯çš„æ•°å€¼ã€‚</p><p>è¿™é‡Œæ˜¯ä¸€äº›ä¸»è¦çš„æ–‡ä»¶ç±»å‹å¸¸é‡åŠå…¶å«ä¹‰ï¼š</p><ul><li><code>fs.constants.S_IFMT</code>: ä½æ©ç ï¼Œç”¨äºæå–æ–‡ä»¶ç±»å‹ä»£ç ã€‚</li><li><code>fs.constants.S_IFREG</code>: æ™®é€šæ–‡ä»¶ã€‚</li><li><code>fs.constants.S_IFDIR</code>: ç›®å½•æ–‡ä»¶ã€‚</li><li><code>fs.constants.S_IFCHR</code>: å­—ç¬¦è®¾å¤‡ã€‚</li><li><code>fs.constants.S_IFBLK</code>: å—è®¾å¤‡ã€‚</li><li><code>fs.constants.S_IFIFO</code>: FIFO/ç®¡é“ã€‚</li><li><code>fs.constants.S_IFLNK</code>: ç¬¦å·é“¾æ¥ã€‚</li><li><code>fs.constants.S_IFSOCK</code>: å¥—æ¥å­—ã€‚</li></ul><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡ä¸€äº›ä¾‹å­æ¥ç†è§£è¿™äº›å¸¸é‡æ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚</p><h3 id="å®ä¾‹-1-æ£€æŸ¥æ–‡ä»¶ç±»å‹" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-1-æ£€æŸ¥æ–‡ä»¶ç±»å‹"><span>å®ä¾‹ 1: æ£€æŸ¥æ–‡ä»¶ç±»å‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æƒ³æ£€æŸ¥ä¸€ä¸ªè·¯å¾„æ˜¯æŒ‡å‘æ–‡ä»¶è¿˜æ˜¯ç›®å½•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stat</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/your/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> stats</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨ä½ä¸è¿ç®—ç¬¦(&amp;)å’Œå¸¸é‡æ¥æ£€æµ‹æ–‡ä»¶ç±»å‹</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> ((</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mode</span><span style="color:#81A1C1;"> &amp;</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">S_IFMT</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">===</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">S_IFDIR</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯ä¸€ä¸ªç›®å½•</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#81A1C1;"> if</span><span style="color:#D8DEE9FF;"> ((</span><span style="color:#D8DEE9;">stats</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">mode</span><span style="color:#81A1C1;"> &amp;</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">S_IFMT</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">===</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">S_IFREG</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¿™æ˜¯ä¸€ä¸ªæ™®é€šæ–‡ä»¶</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#616E88;">  // å¯ä»¥ç»§ç»­æ·»åŠ å…¶ä»–ç±»å‹çš„åˆ¤æ–­æ¡ä»¶...</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ä¾‹-2-åˆ›å»ºç‰¹å®šç±»å‹çš„æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-2-åˆ›å»ºç‰¹å®šç±»å‹çš„æ–‡ä»¶"><span>å®ä¾‹ 2: åˆ›å»ºç‰¹å®šç±»å‹çš„æ–‡ä»¶</span></a></h3><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦åˆ›å»ºä¸€ä¸ªç‰¹å®šç±»å‹çš„æ–‡ä»¶ï¼Œå¦‚ FIFOï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åœ¨ POSIX å…¼å®¹çš„ç³»ç»Ÿä¸Šåˆ›å»ºä¸€ä¸ª FIFO æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">mkdtemp</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/tmp/fifo-</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> directory</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> fifoPath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> `</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">directory</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;">/myfifo</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">mkfifo</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fifoPath</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">S_IFIFO</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">FIFO æ–‡ä»¶å·²åˆ›å»ºåœ¨ </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">fifoPath</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼š<code>fs.mkfifo</code> å’Œ FIFO ç±»å‹çš„æ–‡ä»¶é€šå¸¸åªåœ¨ç±» UNIX ç³»ç»Ÿï¼ˆå¦‚ Linux å’Œ macOSï¼‰ä¸Šæœ‰æ•ˆã€‚</p><h3 id="å®ä¾‹-3-æƒé™ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-3-æƒé™ç®¡ç†"><span>å®ä¾‹ 3: æƒé™ç®¡ç†</span></a></h3><p>å½“æˆ‘ä»¬å…³å¿ƒæ–‡ä»¶æƒé™æ—¶ï¼ˆæ¯”å¦‚å¯è¯»ã€å¯å†™ï¼‰ï¼Œæ–‡ä»¶ç±»å‹å¸¸é‡å°±ä¼šä¸æƒé™å¸¸é‡ç»“åˆä½¿ç”¨ï¼Œæ¥è®¾ç½®æˆ–è€…æ£€æŸ¥æ–‡ä»¶çš„è¯»å†™æ‰§è¡Œæƒé™ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è®¾ç½®æ–‡ä»¶çš„è¯»å†™æƒé™</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filename</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/your/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">chmod</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#D8DEE9;">  filename</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">S_IFREG</span><span style="color:#81A1C1;"> |</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">S_IRUSR</span><span style="color:#81A1C1;"> |</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">S_IWUSR</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">æ›´æ”¹æ–‡ä»¶æƒé™æ—¶å‡ºé”™: </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">message</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      return;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶è¯»å†™æƒé™å·²æ›´æ”¹ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>S_IRUSR</code> æ˜¯ç”¨æˆ·è¯»æƒé™çš„å¸¸é‡ï¼Œ<code>S_IWUSR</code> æ˜¯ç”¨æˆ·å†™æƒé™çš„å¸¸é‡ï¼Œæˆ‘ä»¬å°†å®ƒä»¬ä¸æ™®é€šæ–‡ä»¶æ ‡å¿— <code>S_IFREG</code> ç»“åˆèµ·æ¥ä¿®æ”¹æ–‡ä»¶æƒé™ã€‚</p><p>ä»¥ä¸Šä¾‹å­æ˜¾ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Node.js ä¸­çš„æ–‡ä»¶ç±»å‹å¸¸é‡æ¥ç®¡ç†å’Œæ“ä½œæ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸åŒç±»å‹çš„æ–‡ä»¶ã€‚è¿™äº›æ“ä½œå¯¹äºç¼–å†™å¤æ‚çš„æ–‡ä»¶å¤„ç†è„šæœ¬éå¸¸æœ‰å¸®åŠ©ã€‚äº†è§£å’Œä½¿ç”¨è¿™äº›å¸¸é‡ï¼Œå¯ä»¥è®©ä½ æ›´ç²¾ç¡®åœ°æ§åˆ¶ Node.js åº”ç”¨ç¨‹åºä¸­çš„æ–‡ä»¶ç³»ç»Ÿäº¤äº’ã€‚</p><h5 id="file-mode-constants" tabindex="-1"><a class="header-anchor" href="#file-mode-constants"><span><a href="https://nodejs.org/docs/latest/api/fs.html#file-mode-constants" target="_blank" rel="noopener noreferrer">File mode constants</a></span></a></h5><p>åœ¨ Node.js ä¸­ï¼Œæ–‡ä»¶ç³»ç»Ÿï¼ˆfs æ¨¡å—ï¼‰æ˜¯ä¸€ä¸ªç”¨æ¥å’Œæ–‡ä»¶è¿›è¡Œäº’åŠ¨çš„æ¨¡å—ã€‚è¿™ä¸ªæ¨¡å—å…è®¸ä½ åœ¨æœåŠ¡å™¨ä¸Šè¯»å–ã€åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤æ–‡ä»¶ã€‚å½“æˆ‘ä»¬è°ˆåˆ°â€œFile mode constantsâ€æ—¶ï¼Œæˆ‘ä»¬æŒ‡çš„æ˜¯ä¸€ç»„ç‰¹å®šçš„å¸¸é‡ï¼Œç”¨äºå®šä¹‰æ–‡ä»¶æ“ä½œè¿‡ç¨‹ä¸­çš„æƒé™æˆ–è¡Œä¸ºè§„åˆ™ã€‚</p><p>åœ¨ Unix å’Œç±» Unix ç³»ç»Ÿï¼ˆå¦‚ Linux å’Œ macOSï¼‰ä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶å’Œç›®å½•éƒ½æœ‰ä¸ä¹‹ç›¸å…³è”çš„æƒé™ï¼Œç”¨æ¥å†³å®šè°å¯ä»¥å¯¹å…¶è¿›è¡Œè¯»å–ã€å†™å…¥æˆ–æ‰§è¡Œçš„æ“ä½œã€‚æƒé™é€šå¸¸åˆ†ä¸ºä¸‰ç»„ï¼š</p><ol><li><strong>æ‰€æœ‰è€…ï¼ˆOwnerï¼‰æƒé™</strong>ï¼šæ–‡ä»¶æˆ–ç›®å½•çš„åˆ›å»ºè€…ã€‚</li><li><strong>ç»„ï¼ˆGroupï¼‰æƒé™</strong>ï¼šæ–‡ä»¶æˆ–ç›®å½•æ‰€å±çš„ç»„åˆ«ã€‚</li><li><strong>å…¶ä»–äººï¼ˆOthersï¼‰æƒé™</strong>ï¼šä¸æ˜¯æ–‡ä»¶æ‰€æœ‰è€…ï¼Œä¹Ÿä¸æ˜¯æ–‡ä»¶æ‰€å±ç»„çš„å…¶ä»–ç”¨æˆ·ã€‚</li></ol><p>æƒé™æœ¬èº«å¯ä»¥æ˜¯ï¼š</p><ul><li><strong>è¯»ï¼ˆReadï¼‰</strong>ï¼šæŸ¥çœ‹æ–‡ä»¶å†…å®¹æˆ–ç›®å½•åˆ—è¡¨ã€‚</li><li><strong>å†™ï¼ˆWriteï¼‰</strong>ï¼šä¿®æ”¹æ–‡ä»¶å†…å®¹æˆ–ç›®å½•å†…å®¹ï¼ˆæ·»åŠ ã€åˆ é™¤æ–‡ä»¶ç­‰ï¼‰ã€‚</li><li><strong>æ‰§è¡Œï¼ˆExecuteï¼‰</strong>ï¼šè¿è¡Œæ–‡ä»¶ä¸­çš„ç¨‹åºæˆ–è„šæœ¬ï¼Œæˆ–è¿›å…¥ç›®å½•ã€‚</li></ul><p>åœ¨ Node.js çš„<code>fs</code>æ¨¡å—ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ç‰¹å®šçš„å¸¸é‡æ¥è¡¨ç¤ºè¿™äº›æƒé™ï¼Œä»¥ä¾¿åœ¨åˆ›å»ºæˆ–æ›´æ”¹æ–‡ä»¶åŠç›®å½•æ—¶ä½¿ç”¨ã€‚ä¸‹é¢æ˜¯ä¸€äº›ä¾‹å­ï¼š</p><ul><li><code>fs.constants.S_IRUSR</code>ï¼šä»£è¡¨æ‰€æœ‰è€…å…·æœ‰è¯»æƒé™ã€‚</li><li><code>fs.constants.S_IWUSR</code>ï¼šä»£è¡¨æ‰€æœ‰è€…å…·æœ‰å†™æƒé™ã€‚</li><li><code>fs.constants.S_IXUSR</code>ï¼šä»£è¡¨æ‰€æœ‰è€…å…·æœ‰æ‰§è¡Œæƒé™ã€‚</li><li><code>fs.constants.S_IRGRP</code>ï¼šä»£è¡¨ç»„å…·æœ‰è¯»æƒé™ã€‚</li><li><code>fs.constants.S_IWGRP</code>ï¼šä»£è¡¨ç»„å…·æœ‰å†™æƒé™ã€‚</li><li><code>fs.constants.S_IXGRP</code>ï¼šä»£è¡¨ç»„å…·æœ‰æ‰§è¡Œæƒé™ã€‚</li><li><code>fs.constants.S_IROTH</code>ï¼šä»£è¡¨å…¶ä»–äººå…·æœ‰è¯»æƒé™ã€‚</li><li><code>fs.constants.S_IWOTH</code>ï¼šä»£è¡¨å…¶ä»–äººå…·æœ‰å†™æƒé™ã€‚</li><li><code>fs.constants.S_IXOTH</code>ï¼šä»£è¡¨å…¶ä»–äººå…·æœ‰æ‰§è¡Œæƒé™ã€‚</li></ul><p>å®é™…åº”ç”¨ä¸¾ä¾‹ï¼š</p><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œå¹¶å¸Œæœ›åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œåªå…è®¸æ–‡ä»¶çš„åˆ›å»ºè€…ï¼ˆæ‰€æœ‰è€…ï¼‰å¯¹å…¶è¿›è¡Œè¯»å†™æ“ä½œï¼Œè€Œå…¶ä»–äººæ²¡æœ‰ä»»ä½•æƒé™ã€‚ä½ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./somefile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span></span>
<span class="line"><span style="color:#D8DEE9;">  path</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">Hello World!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  {</span></span>
<span class="line"><span style="color:#88C0D0;">    mode</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">S_IRUSR</span><span style="color:#81A1C1;"> |</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">S_IWUSR</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²è¢«ä¿å­˜ï¼Œå¹¶ä¸”åªæœ‰æ‰€æœ‰è€…æœ‰è¯»å†™æƒé™ã€‚</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¸­ï¼Œ<code>fs.writeFile</code>å‡½æ•°ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¹¶å†™å…¥å†…å®¹&quot;Hello World!&quot;ã€‚é€šè¿‡è®¾ç½®<code>mode</code>é€‰é¡¹ä¸º<code>fs.constants.S_IRUSR | fs.constants.S_IWUSR</code>ï¼Œæˆ‘ä»¬ç¡®ä¿äº†æ–‡ä»¶çš„æ‰€æœ‰è€…ï¼ˆå³åˆ›å»ºè¯¥æ–‡ä»¶çš„ç”¨æˆ·ï¼‰å…·æœ‰è¯»å’Œå†™æƒé™ï¼Œä½†æ˜¯å…¶ä»–ç”¨æˆ·æ²¡æœ‰ä»»ä½•æƒé™ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œæ–‡ä»¶æ¨¡å¼å¸¸é‡åœ¨ Node.js ä¸­æ˜¯ç”¨æ¥ç²¾ç¡®æ§åˆ¶æ–‡ä»¶å’Œç›®å½•çš„æƒé™çš„å·¥å…·ï¼Œå®ƒä»¬å¸®åŠ©å¼€å‘è€…æ„å»ºå®‰å…¨çš„åº”ç”¨ï¼Œé˜²æ­¢æœªæˆæƒçš„è®¿é—®å’Œä¿®æ”¹ã€‚</p><h2 id="notes" tabindex="-1"><a class="header-anchor" href="#notes"><span><a href="https://nodejs.org/docs/latest/api/fs.html#notes" target="_blank" rel="noopener noreferrer">Notes</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„æ¨¡å—å«åšæ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>fs</code>æ¨¡å—ï¼‰ï¼Œå®ƒå…è®¸æˆ‘ä»¬å¯¹ç³»ç»Ÿå†…çš„æ–‡ä»¶å’Œç›®å½•è¿›è¡Œæ“ä½œï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶å†…å®¹ã€åˆ›å»ºæ–‡ä»¶ã€åˆ é™¤æ–‡ä»¶ç­‰ã€‚</p><p>æˆªè‡³æˆ‘çš„çŸ¥è¯†æ›´æ–°ç‚¹ï¼Œåœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œå…³äº <code>fs</code> æ¨¡å—çš„æ–‡æ¡£ä¸­çš„â€œNotesâ€éƒ¨åˆ†æä¾›äº†ä¸€äº›é‡è¦çš„æ³¨é‡Šå’Œè¯´æ˜ã€‚è™½ç„¶æˆ‘ä¸èƒ½ç›´æ¥æŸ¥çœ‹ v21.7.1 çš„ç‰ˆæœ¬è¯¦æƒ…ï¼Œä½†æ˜¯æˆ‘å¯ä»¥åŸºäº<code>fs</code>æ¨¡å—é€šå¸¸åŒ…å«çš„å†…å®¹æ¥ç»™ä½ è§£é‡Šå®ƒä»¬çš„ç”¨é€”å’Œä¸€äº›å®é™…çš„åº”ç”¨ä¾‹å­ã€‚</p><h3 id="å¸¸è§çš„fsæ¨¡å—åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#å¸¸è§çš„fsæ¨¡å—åŠŸèƒ½"><span>å¸¸è§çš„<code>fs</code>æ¨¡å—åŠŸèƒ½ï¼š</span></a></h3><ol><li><p><strong>è¯»å–æ–‡ä»¶</strong> (<code>fs.readFile</code>)ï¼šè¿™ä¸ªå‡½æ•°å…è®¸ä½ è¯»å–å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚è¿™åœ¨å½“ä½ éœ€è¦è¯»å–é…ç½®æ–‡ä»¶æˆ–è€…ç”¨æˆ·ä¸Šä¼ çš„æ•°æ®æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚</p><p><strong>ä¾‹å­</strong>ï¼šå‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™ï¼Œéœ€è¦åŠ è½½ä¸€ä¸ªé…ç½®æ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Failed to read file:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>å†™å…¥æ–‡ä»¶</strong> (<code>fs.writeFile</code>): è¿™ä¸ªæ–¹æ³•å…è®¸ä½ åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™ä¼šæ›¿æ¢è¯¥æ–‡ä»¶ã€‚è¿™å¯¹äºè®°å½•æ—¥å¿—æˆ–ä¿å­˜ç”¨æˆ·æäº¤çš„æ•°æ®éå¸¸æœ‰ç”¨ã€‚</p><p><strong>ä¾‹å­</strong>ï¼šå¦‚æœç”¨æˆ·æäº¤äº†ä¸€ä¸ªè¡¨å•ï¼Œä½ æƒ³å°†è¿™äº›ä¿¡æ¯ä¿å­˜ä¸‹æ¥ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> userData</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> name</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">John Doe</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#88C0D0;"> age</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 30</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/user-data.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> JSON</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">stringify</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">userData</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Failed to write file:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">User data saved.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>ç›‘å¬æ–‡ä»¶å˜åŒ–</strong> (<code>fs.watch</code>): è¿™ä¸ªæ–¹æ³•å¯ä»¥è®©ä½ ç›‘å¬æ–‡ä»¶æˆ–ç›®å½•çš„å˜åŒ–ã€‚è¿™å¯¹äºå¼€å‘éœ€è¦å³æ—¶åé¦ˆçš„åº”ç”¨æ¥è¯´éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚è‡ªåŠ¨é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶æˆ–å®æ—¶æ›´æ–°å†…å®¹ã€‚</p><p><strong>ä¾‹å­</strong>ï¼šå¦‚æœä½ æœ‰ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„æœåŠ¡ï¼Œéœ€è¦æ ¹æ®é…ç½®æ–‡ä»¶çš„æ›´æ”¹å³æ—¶æ›´æ–°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">watch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> filename</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">eventType</span><span style="color:#81A1C1;"> ===</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">change</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">Config file </span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">filename</span><span style="color:#81A1C1;">}</span><span style="color:#A3BE8C;"> has been changed, reloading...</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // åœ¨è¿™é‡Œæ·»åŠ é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶çš„ä»£ç </span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="æ³¨æ„äº‹é¡¹-27" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-27"><span>æ³¨æ„äº‹é¡¹ï¼š</span></a></h3><ul><li>å½“å¤„ç†å¤§é‡æ•°æ®æˆ–å¤§æ–‡ä»¶æ—¶ï¼Œå°½å¯èƒ½ä½¿ç”¨æµï¼ˆStreamsï¼‰ï¼ˆä¾‹å¦‚ <code>fs.createReadStream</code> æˆ– <code>fs.createWriteStream</code>ï¼‰ã€‚æµå¯ä»¥å¸®åŠ©ä½ å‡å°‘å†…å­˜çš„ä½¿ç”¨ï¼Œå› ä¸ºå®ƒä»¬å…è®¸æ•°æ®åˆ†æ‰¹å¤„ç†ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§åŠ è½½æ•´ä¸ªæ–‡ä»¶åˆ°å†…å­˜ä¸­ã€‚</li><li>é”™è¯¯å¤„ç†éå¸¸é‡è¦ï¼Œç¡®ä¿ä½ æ£€æŸ¥æ¯ä¸ªå›è°ƒå‡½æ•°ä¸­çš„é”™è¯¯å‚æ•°ï¼Œå¹¶é€‚å½“åœ°å“åº”é”™è¯¯ã€‚</li><li>è€ƒè™‘ä½¿ç”¨ <code>fs.promises</code> API æˆ–ä½¿ç”¨ <code>util.promisify</code> å°†åŸºäºå›è°ƒçš„ <code>fs</code> æ–¹æ³•è½¬æ¢ä¸ºè¿”å› Promise çš„æ–¹æ³•ï¼Œè¿™æ ·å¯ä»¥ä½¿ä½ çš„ä»£ç æ›´ç°ä»£åŒ–ï¼Œæ›´æ˜“äºç®¡ç†ã€‚</li></ul><p>ä»¥ä¸Šå°±æ˜¯å…³äº Node.js ä¸­ <code>fs</code> æ¨¡å—çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯å’Œå®è·µä¾‹å­ã€‚å¸Œæœ›è¿™äº›ä¿¡æ¯èƒ½å¤Ÿå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å¦‚ä½•åœ¨ Node.js é¡¹ç›®ä¸­åˆ©ç”¨æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œå¼€å‘ã€‚</p><h3 id="ordering-of-callback-and-promise-based-operations" tabindex="-1"><a class="header-anchor" href="#ordering-of-callback-and-promise-based-operations"><span><a href="https://nodejs.org/docs/latest/api/fs.html#ordering-of-callback-and-promise-based-operations" target="_blank" rel="noopener noreferrer">Ordering of callback and promise-based operations</a></span></a></h3><p>è¦ç†è§£ Node.js ä¸­å…³äºå›è°ƒ(callback)å’ŒåŸºäº Promise çš„æ“ä½œé¡ºåºï¼Œæˆ‘ä»¬å…ˆæ¥åˆ†åˆ«äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯å›è°ƒå’Œ Promiseã€‚</p><ol><li><p><strong>å›è°ƒï¼ˆCallbackï¼‰</strong>ï¼šæ˜¯ä¸€ç§å¼‚æ­¥ç¼–ç¨‹æŠ€æœ¯ï¼Œä½ å¯ä»¥å°†ä¸€ä¸ªå‡½æ•°ï¼ˆAï¼‰ï¼Œä½œä¸ºä¸€ä¸ªå‚æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼ˆBï¼‰ã€‚å½“ B å®Œæˆå…¶ä»»åŠ¡åï¼Œå®ƒä¼šè°ƒç”¨ Aã€‚è¿™åœ¨å¤„ç†ä¾‹å¦‚è¯»å–æ–‡ä»¶ã€ç½‘ç»œè¯·æ±‚ç­‰å¼‚æ­¥æ“ä½œæ—¶éå¸¸æœ‰ç”¨ã€‚</p></li><li><p><strong>Promise</strong>ï¼šæ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œæ¯”ä¼ ç»Ÿçš„å›è°ƒæ–¹æ³•æ›´åŠ å¼ºå¤§å’Œçµæ´»ã€‚Promise ä»£è¡¨ä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„æœ€ç»ˆå®Œæˆï¼ˆæˆ–å¤±è´¥ï¼‰ï¼ŒåŠå…¶ç»“æœå€¼ã€‚</p></li></ol><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œç‰¹åˆ«æåˆ°äº†å›è°ƒå’ŒåŸºäº Promise çš„æ“ä½œçš„æ‰§è¡Œé¡ºåºã€‚è¿™ä¸ªæ¦‚å¿µå¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒå½±å“ç€ä»£ç çš„æ‰§è¡Œæµç¨‹å’Œæ€§èƒ½ã€‚</p><h3 id="æ‰§è¡Œé¡ºåº" tabindex="-1"><a class="header-anchor" href="#æ‰§è¡Œé¡ºåº"><span>æ‰§è¡Œé¡ºåº</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œå½“åŒæ—¶ä½¿ç”¨å›è°ƒå’Œ Promise æ¥æ‰§è¡Œå¼‚æ­¥æ“ä½œæ—¶ï¼Œå®ƒä»¬çš„æ‰§è¡Œé¡ºåºæ˜¯ç¡®å®šçš„ï¼Œä½†å¯èƒ½å¹¶ä¸ç›´è§‚ã€‚Node.js å†…éƒ¨ä½¿ç”¨äº†äº‹ä»¶å¾ªç¯æœºåˆ¶æ¥ç®¡ç†å¼‚æ­¥æ“ä½œã€‚äº‹ä»¶å¾ªç¯ä¼šæŒ‰ç…§æ“ä½œè¢«æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­çš„é¡ºåºæ¥æ‰§è¡Œè¿™äº›æ“ä½œï¼Œä½†å›è°ƒå’Œ Promise æ˜¯è¢«æ”¾å…¥ä¸åŒçš„é˜Ÿåˆ—ä¸­çš„ï¼Œå¹¶ä¸”è¿™äº›é˜Ÿåˆ—çš„å¤„ç†ä¼˜å…ˆçº§ä¹Ÿä¸åŒã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-45" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-45"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å»ºç«‹ä¸€ä¸ªç®€å•çš„ web æœåŠ¡å™¨ï¼Œéœ€è¦ä»ç£ç›˜ä¸Šè¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”æ ¹æ®æ–‡ä»¶å†…å®¹è¿›è¡Œä¸€äº›å¤„ç†ã€‚</p><h4 id="ç¤ºä¾‹-1-ä½¿ç”¨å›è°ƒå‡½æ•°" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ä½¿ç”¨å›è°ƒå‡½æ•°"><span>ç¤ºä¾‹ 1: ä½¿ç”¨å›è°ƒå‡½æ•°</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è¯»å–æ–‡ä»¶ï¼Œä½¿ç”¨å›è°ƒæ–¹å¼</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/myfile</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-ä½¿ç”¨-promise" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨-promise"><span>ç¤ºä¾‹ 2: ä½¿ç”¨ Promise</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">promises</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è¯»å–æ–‡ä»¶ï¼Œä½¿ç”¨Promiseæ–¹å¼</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/myfile</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">then</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#D8DEE9;"> console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">))</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">catch</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#D8DEE9;"> console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä½ åœ¨åŒä¸€ä¸ªç¨‹åºä¸­æ··åˆä½¿ç”¨å›è°ƒå’Œ Promiseï¼ŒNode.js ä¼šä¼˜å…ˆå¤„ç†å·²ç»å‡†å¤‡å¥½çš„å›è°ƒå‡½æ•°ï¼Œç„¶åå†å¤„ç† Promiseã€‚è¿™æ„å‘³ç€å³ä½¿ä½ é¦–å…ˆå¯åŠ¨äº†ä¸€ä¸ª Promise æ“ä½œï¼Œå¦‚æœæ­¤æ—¶æœ‰ä¸€ä¸ªå›è°ƒå‡½æ•°å·²ç»å‡†å¤‡å¥½äº†ï¼Œå›è°ƒå‡½æ•°ä¼šå…ˆè¢«æ‰§è¡Œã€‚</p><h3 id="ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦"><span>ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦ï¼Ÿ</span></a></h3><p>ç†è§£è¿™ä¸€ç‚¹éå¸¸å…³é”®ï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šå½±å“åˆ°ä½ çš„ç¨‹åºæ€§èƒ½å’Œè¡Œä¸ºã€‚å¦‚æœä½ åœ¨ä¹ä½ çš„æ“ä½œæ‰§è¡Œçš„é¡ºåºï¼Œæˆ–è€…æŸäº›æ“ä½œå¿…é¡»åœ¨å…¶ä»–æ“ä½œå®Œæˆåæ‰èƒ½å¼€å§‹ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦è°¨æ…åœ°ç»„ç»‡ä½ çš„ä»£ç ï¼Œå¹¶å¯èƒ½éœ€è¦æ ¹æ®æƒ…å†µé€‰æ‹©åªä½¿ç”¨å›è°ƒæˆ–åªä½¿ç”¨ Promise æ¥é¿å…æ½œåœ¨çš„æ··ä¹±ã€‚</p><p>æ€»çš„æ¥è¯´ï¼ŒNode.js ä¸­å¯¹äºå›è°ƒå’Œ Promise æ“ä½œçš„æ’åºè§„åˆ™ï¼Œç¡®ä¿äº†äº‹ä»¶å¾ªç¯çš„é«˜æ•ˆå’Œå¯é¢„æµ‹æ€§ã€‚ä½†ä½œä¸ºå¼€å‘è€…ï¼Œç†è§£å¹¶åˆ©ç”¨è¿™äº›è§„åˆ™ï¼Œå¯ä»¥å¸®åŠ©ä½ æ›´å¥½åœ°æ§åˆ¶ä½ çš„å¼‚æ­¥æ“ä½œæµç¨‹ï¼Œå†™å‡ºæ›´ç¨³å®šã€æ›´é«˜æ•ˆçš„ä»£ç ã€‚</p><h3 id="file-paths" tabindex="-1"><a class="header-anchor" href="#file-paths"><span><a href="https://nodejs.org/docs/latest/api/fs.html#file-paths" target="_blank" rel="noopener noreferrer">File paths</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡ç«¯ä»£ç ã€‚Node.js æä¾›äº†å¾ˆå¤šæ¨¡å—ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼Œå…¶ä¸­ <code>fs</code>ï¼ˆFile Systemï¼‰æ¨¡å—å°±æ˜¯ç”¨æ¥æ“ä½œæ–‡ä»¶ç³»ç»Ÿçš„ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œå½“æˆ‘ä»¬è°ˆè®ºæ–‡ä»¶è·¯å¾„ï¼ˆFile pathsï¼‰ï¼Œæˆ‘ä»¬æŒ‡çš„æ˜¯æŒ‡å‘æ–‡ä»¶ç³»ç»Ÿä¸­ç‰¹å®šä½ç½®çš„å­—ç¬¦ä¸²ã€‚è¿™äº›è·¯å¾„å¯ä»¥æ˜¯ç»å¯¹çš„ä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹çš„ã€‚</p><h3 id="ç»å¯¹è·¯å¾„" tabindex="-1"><a class="header-anchor" href="#ç»å¯¹è·¯å¾„"><span>ç»å¯¹è·¯å¾„</span></a></h3><p>ç»å¯¹è·¯å¾„æ˜¯ä»æ ¹ç›®å½•ï¼ˆåœ¨ Unix ç³»ç»Ÿä¸­æ˜¯ <code>/</code>ï¼Œåœ¨ Windows ç³»ç»Ÿä¸­é€šå¸¸æ˜¯ <code>C:\</code> æˆ–å…¶ä»–ç›˜ç¬¦ï¼‰å¼€å§‹çš„å®Œæ•´è·¯å¾„ã€‚ä¾‹å¦‚ï¼š</p><ul><li>åœ¨ Linux/Unix ä¸Š: <code>/home/user/documents/example.txt</code></li><li>åœ¨ Windows ä¸Š: <code>C:\Users\user\documents\example.txt</code></li></ul><p>ç»å¯¹è·¯å¾„å‘Šè¯‰ä½ å¦‚ä½•ä»æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•åˆ°è¾¾æŒ‡å®šæ–‡ä»¶æˆ–ç›®å½•ã€‚</p><h3 id="ç›¸å¯¹è·¯å¾„" tabindex="-1"><a class="header-anchor" href="#ç›¸å¯¹è·¯å¾„"><span>ç›¸å¯¹è·¯å¾„</span></a></h3><p>ç›¸å¯¹è·¯å¾„ï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯ç›¸å¯¹äºå½“å‰å·¥ä½œç›®å½•çš„è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå½“å‰å·¥ä½œç›®å½•æ˜¯ <code>/home/user</code>, é‚£ä¹ˆç›¸å¯¹è·¯å¾„ <code>documents/example.txt</code> ä¼šæŒ‡å‘ <code>/home/user/documents/example.txt</code>ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-46" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-46"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬è¦è¯»å–å½“å‰ç›®å½•ä¸‹çš„ä¸€ä¸ªå« <code>config.json</code> çš„é…ç½®æ–‡ä»¶ã€‚</p><h4 id="ä½¿ç”¨ç»å¯¹è·¯å¾„" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç»å¯¹è·¯å¾„"><span>ä½¿ç”¨ç»å¯¹è·¯å¾„</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æˆ‘ä»¬çŸ¥é“ç»å¯¹è·¯å¾„æ˜¯ /home/user/config.json</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> absolutePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/home/user/config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">absolutePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–æ–‡ä»¶å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¿™é‡Œä¼šæ‰“å°æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä½¿ç”¨ç›¸å¯¹è·¯å¾„" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç›¸å¯¹è·¯å¾„"><span>ä½¿ç”¨ç›¸å¯¹è·¯å¾„</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å½“å‰å·¥ä½œç›®å½•æ˜¯/home/userï¼Œæˆ‘ä»¬æƒ³è¯»å–è¿™ä¸ªç›®å½•ä¸‹çš„ config.json æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> relativePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // &#39;./&#39; è¡¨ç¤ºå½“å‰ç›®å½•</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">relativePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–æ–‡ä»¶å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¿™é‡Œä¼šæ‰“å°æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ³¨æ„è·¯å¾„åˆ†éš”ç¬¦" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„è·¯å¾„åˆ†éš”ç¬¦"><span>æ³¨æ„è·¯å¾„åˆ†éš”ç¬¦</span></a></h4><p>åœ¨ä»£ç ä¸­ä½¿ç”¨æ–‡ä»¶è·¯å¾„æ—¶ï¼Œè¯·è®°ä½ä¸åŒæ“ä½œç³»ç»Ÿçš„è·¯å¾„åˆ†éš”ç¬¦å¯èƒ½ä¸åŒã€‚Unix/Linux ä½¿ç”¨æ­£æ–œæ  <code>/</code>ï¼Œè€Œ Windows ä½¿ç”¨åæ–œæ  <code>\</code>ã€‚ä¸ºäº†é¿å…è·¨å¹³å°é—®é¢˜ï¼ŒNode.js <code>path</code> æ¨¡å—æä¾›äº†å·¥å…·å‡½æ•°ï¼Œå¦‚ <code>path.join()</code> å’Œ <code>path.resolve()</code>ï¼Œå®ƒä»¬ä¼šè‡ªåŠ¨ä¸ºä½ å¤„ç†è¿™äº›é—®é¢˜ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ path.join() æ¥é¿å…ç›´æ¥åœ¨ä»£ç ä¸­ç¡¬ç¼–ç è·¯å¾„åˆ†éš”ç¬¦</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">home</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">user</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">config.json</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ­£ç¡®åœ°åˆ›å»ºè·¯å¾„ï¼Œæ— è®ºåœ¨å“ªä¸ªæ“ä½œç³»ç»Ÿä¸Š</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–æ–‡ä»¶å‡ºé”™:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¿™é‡Œä¼šæ‰“å°æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ€»ä¹‹ï¼Œåœ¨ Node.js ä¸­æ“ä½œæ–‡ä»¶æ—¶æ­£ç¡®åœ°ä½¿ç”¨è·¯å¾„éå¸¸é‡è¦ï¼Œè¿™æ ·æ‰èƒ½ç¡®ä¿ä½ çš„åº”ç”¨èƒ½å¤Ÿåœ¨ä¸åŒçš„ç¯å¢ƒå’Œæ“ä½œç³»ç»Ÿä¸­æ­£ç¡®åœ°æ‰¾åˆ°å’Œæ“ä½œæ–‡ä»¶ã€‚</p><h4 id="string-paths" tabindex="-1"><a class="header-anchor" href="#string-paths"><span><a href="https://nodejs.org/docs/latest/api/fs.html#string-paths" target="_blank" rel="noopener noreferrer">String paths</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„æ¨¡å—å«åš <code>fs</code>ï¼Œå³æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ã€‚è¿™ä¸ªæ¨¡å—æä¾›äº†å¾ˆå¤šç”¨æ¥ä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„æ–¹æ³•ï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶ã€å†™å…¥æ–‡ä»¶ã€ä¿®æ”¹æ–‡ä»¶åç­‰ã€‚</p><p>åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­è°ˆåˆ°çš„ &quot;String paths&quot; ä¸»è¦æ˜¯æŒ‡ï¼Œåœ¨ <code>fs</code> æ¨¡å—ä¸­ï¼Œä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’æ—¶ï¼Œå¤§éƒ¨åˆ†å‡½æ•°éƒ½éœ€è¦ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªè·¯å¾„å°±æ˜¯æ‰€è°“çš„ &quot;String path&quot;ã€‚æ¢å¥è¯è¯´ï¼Œå°±æ˜¯ä»¥å­—ç¬¦ä¸²å½¢å¼è¡¨ç¤ºçš„æ–‡ä»¶æˆ–ç›®å½•çš„ä½ç½®ã€‚</p><h3 id="ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-4"><span>ä¾‹å­</span></a></h3><p>è€ƒè™‘æˆ‘ä»¬æœ‰ä»¥ä¸‹å‡ ä¸ªå®é™…è¿ç”¨çš„åœºæ™¯ï¼š</p><h4 id="_1-è¯»å–æ–‡ä»¶å†…å®¹-3" tabindex="-1"><a class="header-anchor" href="#_1-è¯»å–æ–‡ä»¶å†…å®¹-3"><span>1. è¯»å–æ–‡ä»¶å†…å®¹</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå«åš <code>example.txt</code> çš„æ–‡æœ¬æ–‡ä»¶ï¼Œé‡Œé¢å­˜å‚¨äº†ä¸€äº›æ–‡æœ¬æ•°æ®ï¼Œç°åœ¨æˆ‘ä»¬æƒ³é€šè¿‡ Node.js æ¥è¯»å–å®ƒçš„å†…å®¹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fs.readFile æ–¹æ³•è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡ºæ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œ <code>&#39;example.txt&#39;</code> å°±æ˜¯ä¸€ä¸ª String pathï¼Œä»£è¡¨äº† <code>example.txt</code> æ–‡ä»¶åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä½ç½®ã€‚</p><h4 id="_2-å†™å…¥æ–‡ä»¶å†…å®¹" tabindex="-1"><a class="header-anchor" href="#_2-å†™å…¥æ–‡ä»¶å†…å®¹"><span>2. å†™å…¥æ–‡ä»¶å†…å®¹</span></a></h4><p>å¦‚æœæˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶æˆ–è€…å‘å·²æœ‰æ–‡ä»¶ä¸­å†™å…¥ä¸€äº›å†…å®¹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>fs</code> æ¨¡å—çš„ <code>writeFile</code> æ–¹æ³•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> content</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, Node.js!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fs.writeFile æ–¹æ³•å†™å…¥æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">hello.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> content</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File has been written</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŒæ ·åœ°ï¼Œè¿™é‡Œ <code>&#39;hello.txt&#39;</code> æ˜¯ä¸€ä¸ª String pathï¼Œè¡¨ç¤ºæˆ‘ä»¬æƒ³è¦å†™å…¥å†…å®¹çš„æ–‡ä»¶çš„ä½ç½®ã€‚</p><h4 id="_3-ä¿®æ”¹æ–‡ä»¶åç§°" tabindex="-1"><a class="header-anchor" href="#_3-ä¿®æ”¹æ–‡ä»¶åç§°"><span>3. ä¿®æ”¹æ–‡ä»¶åç§°</span></a></h4><p>æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦æ”¹å˜ä¸€ä¸ªæ–‡ä»¶çš„åç§°ï¼Œå¯ä»¥ä½¿ç”¨ <code>fs.rename</code> æ–¹æ³•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ fs.rename æ–¹æ³•ä¿®æ”¹æ–‡ä»¶å</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">rename</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">oldName.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">newName.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File name has been changed</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œ<code>&#39;oldName.txt&#39;</code> å’Œ <code>&#39;newName.txt&#39;</code> éƒ½æ˜¯ String pathsï¼Œåˆ†åˆ«ä»£è¡¨äº†åŸæ–‡ä»¶å’Œæ›´æ”¹åçš„æ–‡ä»¶åç§°åŠå…¶ä½ç½®ã€‚</p><h3 id="å°ç»“-16" tabindex="-1"><a class="header-anchor" href="#å°ç»“-16"><span>å°ç»“</span></a></h3><p>åœ¨ Node.js çš„ <code>fs</code> æ¨¡å—ä¸­ï¼Œå‡ ä¹æ‰€æœ‰ä¸æ–‡ä»¶æ“ä½œç›¸å…³çš„å‡½æ•°éƒ½ä¼šç”¨åˆ° String pathsã€‚ç®€å•æ¥è¯´ï¼Œå®ƒä»¬å°±æ˜¯ä»¥å­—ç¬¦ä¸²å½¢å¼å­˜åœ¨çš„ï¼Œç”¨æ¥æŒ‡å®šæ–‡ä»¶æˆ–ç›®å½•åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä½ç½®ã€‚é€šè¿‡å¯¹è¿™äº›è·¯å¾„çš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°è¯»å–ã€å†™å…¥ã€ä¿®æ”¹æ–‡ä»¶ç­‰ã€‚ç†è§£äº† String paths çš„æ¦‚å¿µï¼Œå°±èƒ½æ›´å¥½åœ°åˆ©ç”¨ Node.js æ¥è¿›è¡Œæ–‡ä»¶ç³»ç»Ÿç›¸å…³çš„ç¼–ç¨‹äº†ã€‚</p><h4 id="file-url-paths" tabindex="-1"><a class="header-anchor" href="#file-url-paths"><span><a href="https://nodejs.org/docs/latest/api/fs.html#file-url-paths" target="_blank" rel="noopener noreferrer">File URL paths</a></span></a></h4><p>Node.js ä¸­çš„ &quot;File URL paths&quot; æ˜¯æŒ‡ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿæ¨¡å— (<code>fs</code> æ¨¡å—) æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ URL æ ¼å¼æ¥æŒ‡å®šæ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚åœ¨ Node.js çš„ <code>fs</code> æ¨¡å—ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨æœ¬åœ°æ–‡ä»¶è·¯å¾„ï¼ˆå¦‚ <code>/home/user/file.txt</code> æˆ– <code>C:\Users\user\file.txt</code>ï¼‰æ¥æ“ä½œæ–‡ä»¶ç³»ç»Ÿï¼Œä½†æ˜¯ Node.js åŒæ ·æ”¯æŒä½¿ç”¨ <code>file://</code> åè®®çš„ URL å½¢å¼æ¥è¡¨ç¤ºè¿™äº›è·¯å¾„ã€‚</p><p><strong>ä¸ºä»€ä¹ˆä½¿ç”¨ File URLï¼Ÿ</strong></p><p>æœ‰æ—¶ï¼Œå°†æ–‡ä»¶è·¯å¾„è¡¨ç¤ºä¸º URL å¯ä»¥æ›´åŠ ç»Ÿä¸€å’Œæ ‡å‡†åŒ–ï¼Œå°¤å…¶æ˜¯å½“ä½ éœ€è¦å¤„ç†ç½‘ç»œèµ„æºå’Œæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿæ—¶ï¼ŒURL å½¢å¼å¯ä»¥ä½¿ä»£ç æ›´å…·å¯è¯»æ€§å’Œå…¼å®¹æ€§ã€‚</p><p><strong>å¦‚ä½•åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ URLï¼Ÿ</strong></p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå±•ç¤ºå¦‚ä½•ä»å¸¸è§„è·¯å¾„åˆ›å»ºä¸€ä¸ª File URLï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> URL</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">url</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> pathToFileURL</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">url</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æœ‰ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> filePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">/path/to/your/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å°†æœ¬åœ°æ–‡ä»¶è·¯å¾„è½¬æ¢ä¸º File URL</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fileUrl</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> pathToFileURL</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">filePath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fileUrl</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">href</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡º: &#39;file:///path/to/your/file.txt&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† Node.js çš„ <code>url</code> æ¨¡å—ä¸­çš„ <code>URL</code> ç±»å’Œ <code>pathToFileURL</code> å‡½æ•°ã€‚ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ï¼Œå¹¶ä½¿ç”¨ <code>pathToFileURL</code> å‡½æ•°å°†å®ƒè½¬æ¢ä¸ºäº†ä¸€ä¸ª File URL å¯¹è±¡ã€‚æœ€åï¼Œæˆ‘ä»¬æ‰“å°å‡ºäº†è¿™ä¸ª URL çš„ <code>href</code> å±æ€§ï¼Œå®ƒæ˜¯å®Œæ•´çš„ File URL å­—ç¬¦ä¸²ã€‚</p><p><strong>å¦‚ä½•ä½¿ç”¨ File URL æ¥æ“ä½œæ–‡ä»¶ï¼Ÿ</strong></p><p>ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨è¿™äº› File URL æ¥è¿›è¡Œå®é™…çš„æ–‡ä»¶æ“ä½œã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªè¯»å–æ–‡ä»¶å†…å®¹çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs/promises</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">async</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> readFileContent</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">fileUrl</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // ä½¿ç”¨ File URL è¯»å–æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#81A1C1;">    const</span><span style="color:#D8DEE9;"> content</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> await</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fileUrl</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">content</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#81A1C1;"> catch</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">error</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">An error occurred:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> error</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»º File URL</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fileUrl</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> URL</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">file:///path/to/your/file.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨å‡½æ•°è¯»å–æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#88C0D0;">readFileContent</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fileUrl</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† <code>fs/promises</code> æ¨¡å—ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨åŸºäº Promise çš„ <code>fs</code> APIã€‚æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° <code>readFileContent</code>ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ª File URLï¼Œç„¶åä½¿ç”¨ <code>fs.readFile</code> æ–¹æ³•æ¥è¯»å–è¯¥ URL æŒ‡å®šçš„æ–‡ä»¶å†…å®¹ã€‚æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª File URL å¯¹è±¡å¹¶ä¼ é€’ç»™ <code>readFileContent</code> å‡½æ•°æ¥æ‰§è¡Œè¯»å–æ“ä½œã€‚</p><p>æ³¨æ„ï¼Œå½“ä½¿ç”¨ File URL ä½œä¸ºè·¯å¾„æ—¶ï¼Œå¿…é¡»ç¡®ä¿å®ƒçš„æ ¼å¼æ­£ç¡®ï¼Œå¹¶ä¸” <code>fs</code> æ¨¡å—çš„ç›¸å…³æ–¹æ³•å¯ä»¥è¯†åˆ«è¿™ç§æ ¼å¼ã€‚é”™è¯¯çš„æ ¼å¼æˆ–ä¸æ”¯æŒ URL çš„æ–¹æ³•å°†ä¼šå¯¼è‡´å¼‚å¸¸ã€‚</p><p>é€šè¿‡ä»¥ä¸Šä¾‹å­ï¼Œä½ åº”è¯¥å¯¹ Node.js ä¸­çš„ &quot;File URL paths&quot; æœ‰äº†ä¸€ä¸ªåŸºæœ¬çš„ç†è§£ã€‚å®ƒä»¬æä¾›äº†ä¸€ç§ä½¿ç”¨æ ‡å‡† URL æ ¼å¼æ¥å¼•ç”¨æœ¬åœ°æ–‡ä»¶çš„æ–¹å¼ï¼Œä»è€Œå¯ä»¥åœ¨ Node.js åº”ç”¨ç¨‹åºä¸­çµæ´»åœ°å¤„ç†æ–‡ä»¶è·¯å¾„ã€‚</p><h5 id="platform-specific-considerations" tabindex="-1"><a class="header-anchor" href="#platform-specific-considerations"><span><a href="https://nodejs.org/docs/latest/api/fs.html#platform-specific-considerations" target="_blank" rel="noopener noreferrer">Platform-specific considerations</a></span></a></h5><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript ç¯å¢ƒï¼Œå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚å®ƒæœ‰ç€ä¸°å¯Œçš„æ¨¡å—åº“ï¼Œå…¶ä¸­ <code>fs</code> æ¨¡å—æ˜¯ç”¨æ¥å¤„ç†æ–‡ä»¶ç³»ç»Ÿç›¸å…³æ“ä½œçš„ï¼ˆä¾‹å¦‚ï¼šè¯»å†™æ–‡ä»¶ã€åˆ›å»ºç›®å½•ç­‰ï¼‰ã€‚ä¸è¿‡ï¼Œç”±äº Node.js å¯ä»¥è¿è¡Œåœ¨å¤šç§æ“ä½œç³»ç»Ÿä¸Šï¼Œåƒæ˜¯ Windowsã€macOSã€Linux ç­‰ï¼Œè¿™äº›ä¸åŒçš„å¹³å°é—´å­˜åœ¨ä¸€äº›å·®å¼‚ï¼Œç‰¹åˆ«æ˜¯åœ¨æ–‡ä»¶ç³»ç»Ÿçš„å¤„ç†ä¸Šï¼Œè¿™å°±è¦æ±‚ Node.js åœ¨è®¾è®¡æ—¶è€ƒè™‘åˆ°è¿™äº›å¹³å°ç‰¹å®šçš„è€ƒé‡ã€‚</p><h3 id="å¹³å°ç‰¹å®šè€ƒé‡-platform-specific-considerations" tabindex="-1"><a class="header-anchor" href="#å¹³å°ç‰¹å®šè€ƒé‡-platform-specific-considerations"><span>å¹³å°ç‰¹å®šè€ƒé‡ (Platform-specific considerations)</span></a></h3><ol><li><p><strong>è·¯å¾„åˆ†éš”ç¬¦å·®å¼‚</strong>ï¼š</p><ul><li>åœ¨ Windows ä¸Šï¼Œè·¯å¾„ä½¿ç”¨åæ–œæ  (<code>\</code>) ä½œä¸ºåˆ†éš”ç¬¦ï¼Œä¾‹å¦‚ <code>C:\Users\yourname</code>ã€‚</li><li>åœ¨ UNIX-like ç³»ç»Ÿï¼ˆåŒ…æ‹¬ Linux å’Œ macOSï¼‰ä¸Šï¼Œè·¯å¾„ä½¿ç”¨æ­£æ–œæ  (<code>/</code>) ä½œä¸ºåˆ†éš”ç¬¦ï¼Œä¾‹å¦‚ <code>/home/yourname</code>ã€‚</li></ul><p>ä½¿ç”¨ Node.js çš„ <code>path</code> æ¨¡å—å¯ä»¥å¾ˆå¥½åœ°å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œ<code>path.join()</code> æ–¹æ³•ä¼šæ ¹æ®è¿è¡Œçš„æ“ä½œç³»ç»Ÿè‡ªåŠ¨é€‰æ‹©æ­£ç¡®çš„åˆ†éš”ç¬¦ã€‚</p></li><li><p><strong>å¤§å°å†™æ•æ„Ÿæ€§</strong>:</p><ul><li>åœ¨ UNIX-like ç³»ç»Ÿä¸Šï¼Œæ–‡ä»¶åæ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼Œæ„å‘³ç€ <code>file.txt</code> å’Œ <code>File.txt</code> ä¼šè¢«è§†ä¸ºä¸¤ä¸ªä¸åŒçš„æ–‡ä»¶ã€‚</li><li>è€Œåœ¨ Windows ä¸Šï¼Œæ–‡ä»¶åä¸åŒºåˆ†å¤§å°å†™ã€‚</li></ul></li><li><p><strong>ç‰¹æ®Šæ–‡ä»¶ç³»ç»Ÿæƒé™</strong>:</p><ul><li>åœ¨ UNIX-like ç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶å’Œç›®å½•çš„è®¿é—®æƒé™æ›´åŠ çµæ´»å’Œå¤æ‚ï¼Œé€šè¿‡è®¾ç½®ä¸åŒçš„æƒé™ä½å¯ä»¥ç²¾ç»†æ§åˆ¶è°å¯ä»¥è¯»ã€å†™æˆ–æ‰§è¡Œæ–‡ä»¶ã€‚</li><li>Windows ä¹Ÿæœ‰æ–‡ä»¶æƒé™çš„æ¦‚å¿µï¼Œä½†å®ç°æ–¹å¼ä¸ UNIX-like ç³»ç»Ÿä¸åŒã€‚</li></ul></li><li><p><strong>éšè—æ–‡ä»¶å’Œç›®å½•</strong>:</p><ul><li>åœ¨ UNIX-like ç³»ç»Ÿä¸­ï¼Œä»»ä½•ä»¥ç‚¹ï¼ˆ<code>.</code>ï¼‰å¼€å¤´çš„æ–‡ä»¶æˆ–ç›®å½•éƒ½è¢«è§†ä¸ºéšè—çš„ã€‚</li><li>Windows ä½¿ç”¨æ–‡ä»¶å±æ€§æ¥æ§åˆ¶æ–‡ä»¶æ˜¯å¦éšè—ã€‚</li></ul></li><li><p><strong>é“¾æ¥æ–‡ä»¶</strong>:</p><ul><li>UNIX-like ç³»ç»Ÿæ”¯æŒç¬¦å·é“¾æ¥ï¼ˆsymbolic linksï¼‰å’Œç¡¬é“¾æ¥ï¼ˆhard linksï¼‰ï¼Œè¿™å¯¹äºåˆ›å»ºæ–‡ä»¶çš„å¿«æ·æ–¹å¼éå¸¸æœ‰ç”¨ã€‚</li><li>Windows ä¹Ÿæ”¯æŒé“¾æ¥ï¼Œä½†æ˜¯é€šè¿‡ä¸åŒçš„æœºåˆ¶ï¼Œä¾‹å¦‚å¿«æ·æ–¹å¼ï¼ˆ.lnk æ–‡ä»¶ï¼‰å’Œ NTFS çš„ç¬¦å·é“¾æ¥ã€‚</li></ul></li></ol><h3 id="å®é™…è¿ç”¨ä¾‹å­-47" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-47"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ul><li><p><strong>è·¨å¹³å°æ–‡ä»¶è·¯å¾„å¤„ç†</strong>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æˆ‘ä»¬éœ€è¦è¿æ¥ &#39;users&#39; å’Œ &#39;john&#39; ä¸¤ä¸ªè·¯å¾„æ®µ</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> directoryPath</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">users</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">john</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">directoryPath</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // åœ¨ UNIX-like ç³»ç»Ÿä¸­è¾“å‡º: users/johnï¼Œåœ¨ Windows ä¸­è¾“å‡º: users\john</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>è¯»å–æ–‡ä»¶ï¼Œè€ƒè™‘åˆ°å¤§å°å†™æ•æ„Ÿæ€§</strong>ï¼š<br> å¦‚æœä½ çš„åº”ç”¨ç¨‹åºå¯èƒ½ä¼šåœ¨ UNIX-like ç³»ç»Ÿå’Œ Windows ç³»ç»Ÿä¸Šè¿è¡Œï¼Œå°½é‡ä¿è¯æ–‡ä»¶ååœ¨ä½¿ç”¨æ—¶å¤§å°å†™ä¸€è‡´ï¼Œé¿å…å› ä¸ºå¤§å°å†™ä¸åŒ¹é…å¯¼è‡´çš„é—®é¢˜ã€‚</p></li><li><p><strong>è®¾ç½®æ–‡ä»¶æƒé™</strong>ï¼š<br> åœ¨ UNIX-like ç³»ç»Ÿä¸­ï¼Œä½ å¯èƒ½éœ€è¦è®¾ç½®æ–‡ä»¶çš„è¯»å†™æƒé™ï¼Œç¡®ä¿å®‰å…¨æ€§ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¹¶è®¾ç½®æƒé™ä¸º 644ï¼ˆå³ç”¨æˆ·å¯è¯»å†™ï¼Œç»„å’Œå…¶ä»–åªè¯»ï¼‰</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, world!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> mode</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 0o644</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>ç†è§£è¿™äº›å¹³å°ç‰¹å®šçš„è€ƒé‡æ˜¯è‡³å…³é‡è¦çš„ï¼Œç‰¹åˆ«æ˜¯å½“ä½ å¼€å‘çš„ Node.js åº”ç”¨éœ€è¦åœ¨å¤šä¸ªæ“ä½œç³»ç»Ÿä¸Šæ— ç¼è¿è¡Œæ—¶ã€‚é€šè¿‡é€‚å½“çš„ä»£ç ç¼–å†™å’Œä½¿ç”¨ Node.js æä¾›çš„ APIï¼Œå¯ä»¥æœ€å¤§é™åº¦åœ°å‡å°‘å› å¹³å°å·®å¼‚å¸¦æ¥çš„é—®é¢˜ã€‚</p><h4 id="buffer-paths" tabindex="-1"><a class="header-anchor" href="#buffer-paths"><span><a href="https://nodejs.org/docs/latest/api/fs.html#buffer-paths" target="_blank" rel="noopener noreferrer">Buffer paths</a></span></a></h4><p>åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶è·¯å¾„æ˜¯ç”¨æ¥å”¯ä¸€å®šä½æ–‡ä»¶æˆ–ç›®å½•çš„å­—ç¬¦ä¸²ã€‚å®ƒä»¬é€šå¸¸åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶å¤¹åå­—å’Œæœ€åçš„æ–‡ä»¶åï¼Œå½¼æ­¤ä¹‹é—´ç”¨ç‰¹å®šçš„å­—ç¬¦ï¼ˆä¾‹å¦‚ï¼Œåœ¨ Windows ç³»ç»Ÿä¸­ä½¿ç”¨<code>\</code>ï¼Œåœ¨ UNIX ç±»ç³»ç»Ÿä¸­ä½¿ç”¨<code>/</code>ï¼‰åˆ†éš”ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œæ ‡å‡†åº“æä¾›äº†ä¸€ä¸ªå«åš<code>fs</code>ï¼ˆFile Systemï¼‰çš„æ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—å¯ä»¥è®©ä½ åœ¨ JavaScript ä»£ç ä¸­æ‰§è¡Œæ–‡ä»¶æ“ä½œï¼Œæ¯”å¦‚è¯»å†™æ–‡ä»¶ã€åˆ›å»ºåˆ é™¤ç›®å½•ç­‰ã€‚Node.js é€šå¸¸å¤„ç†çš„æ˜¯ä»¥å­—ç¬¦ä¸²å½¢å¼è¡¨ç¤ºçš„æ–‡ä»¶è·¯å¾„ï¼Œä½†ä» Node 7.0.0 ç‰ˆæœ¬å¼€å§‹ï¼Œ<code>fs</code>æ¨¡å—ä¹Ÿå¼€å§‹æ”¯æŒ<code>Buffer</code>ç±»å‹çš„è·¯å¾„ã€‚</p><p><code>Buffer</code>æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œç”¨äºç›´æ¥æ“ä½œå†…å­˜ä¸­çš„æ•°æ®ã€‚å®ƒé€šå¸¸ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¯”å¦‚æ–‡ä»¶å†…å®¹ã€ç½‘ç»œé€šä¿¡ç­‰ã€‚å½“æ–‡ä»¶è·¯å¾„åŒ…å«ç‰¹æ®Šå­—ç¬¦æˆ–è€…ä¸åŒè¯­è¨€çš„æ–‡å­—æ—¶ï¼ˆä¾‹å¦‚ä¸­æ–‡ã€ä¿„è¯­ç­‰ï¼‰ï¼Œä½¿ç”¨<code>Buffer</code>ç±»å‹çš„è·¯å¾„å¯ä»¥é¿å…ç¼–ç é—®é¢˜ï¼Œå› ä¸º<code>Buffer</code>ä¸ä¼šå¯¹è¿™äº›å­—èŠ‚è¿›è¡Œä»»ä½•ç‰¹æ®Šå¤„ç†ã€‚</p><p>ä¸‹é¢æˆ‘ä¸¾å‡ ä¸ªä¾‹å­è¯´æ˜å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨<code>Buffer</code>ä½œä¸ºè·¯å¾„ï¼š</p><h3 id="ç¤ºä¾‹-1-è¯»å–æ–‡ä»¶-1" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-è¯»å–æ–‡ä»¶-1"><span>ç¤ºä¾‹ 1ï¼šè¯»å–æ–‡ä»¶</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ &#39;./ä½ å¥½.txt&#39;</span></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨Buffer.fromå°†å­—ç¬¦ä¸²è½¬æ¢æˆBufferå¯¹è±¡</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./ä½ å¥½.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">())</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // è¾“å‡ºæ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº†<code>fs</code>æ¨¡å—ã€‚ç„¶ååˆ›å»ºäº†ä¸€ä¸ª<code>Buffer</code>å¯¹è±¡ä»£è¡¨æ–‡ä»¶è·¯å¾„ï¼Œå¹¶ä½¿ç”¨<code>fs.readFile</code>æ–¹æ³•è¯»å–æ–‡ä»¶çš„å†…å®¹ã€‚å¦‚æœæ–‡ä»¶è¯»å–æˆåŠŸï¼Œæˆ‘ä»¬é€šè¿‡<code>toString</code>æ–¹æ³•å°†å¾—åˆ°çš„äºŒè¿›åˆ¶æ•°æ®è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶æ‰“å°å‡ºæ¥ã€‚</p><h3 id="ç¤ºä¾‹-2-å†™å…¥æ–‡ä»¶-1" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å†™å…¥æ–‡ä»¶-1"><span>ç¤ºä¾‹ 2ï¼šå†™å…¥æ–‡ä»¶</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// è¦å†™å…¥çš„æ•°æ®</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello Node.js!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å†™å…¥æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">The file has been saved!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å…ˆå®šä¹‰äº†ä¸€ä¸ª<code>Buffer</code>å¯¹è±¡æ¥ä½œä¸ºè¦å†™å…¥çš„æ–‡ä»¶è·¯å¾„ã€‚ç„¶åå®šä¹‰äº†ä¸€æ®µå­—ç¬¦ä¸²æ•°æ®ï¼Œå¹¶ç”¨<code>fs.writeFile</code>å‡½æ•°å°†å…¶å†™å…¥åˆ°æ–‡ä»¶ä¸­ã€‚å¦‚æœæ²¡æœ‰å‡ºé”™ï¼Œå°±ä¼šæ˜¾ç¤º&quot;The file has been saved!&quot;è¡¨ç¤ºæ–‡ä»¶å·²ç»è¢«ä¿å­˜ã€‚</p><h3 id="ç¤ºä¾‹-3-æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨"><span>ç¤ºä¾‹ 3ï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">from</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">./somefile.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">access</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">constants</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">F_OK</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#81A1C1;">${</span><span style="color:#D8DEE9;">path</span><span style="color:#81A1C1;">}</span><span style="color:#81A1C1;"> ${</span><span style="color:#D8DEE9;">err</span><span style="color:#81A1C1;"> ?</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">does not exist</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">exists</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">}</span><span style="color:#ECEFF4;">`</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>fs.access</code>æ–¹æ³•æ¥æ£€æŸ¥<code>Buffer</code>æŒ‡å®šçš„è·¯å¾„æ‰€ä»£è¡¨çš„æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚<code>fs.constants.F_OK</code>æ˜¯ç”¨æ¥æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯è§çš„æ ‡å¿—ã€‚</p><p>ä»¥ä¸Šç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•åœ¨ Node.js v21.7.1 ä¸­ä½¿ç”¨<code>Buffer</code>å¯¹è±¡ä½œä¸º<code>fs</code>æ¨¡å—çš„è·¯å¾„å‚æ•°ã€‚ä½¿ç”¨<code>Buffer</code>ä½œä¸ºè·¯å¾„å¯ä»¥å¸®åŠ©ä½ å¤„ç†ä¸€äº›éæ ‡å‡†å­—ç¬¦é›†çš„æ–‡ä»¶è·¯å¾„é—®é¢˜ï¼Œä»¥ç¡®ä¿åº”ç”¨ç¨‹åºçš„å¥å£®æ€§å’Œè·¨å¹³å°å…¼å®¹æ€§ã€‚</p><h4 id="per-drive-working-directories-on-windows" tabindex="-1"><a class="header-anchor" href="#per-drive-working-directories-on-windows"><span><a href="https://nodejs.org/docs/latest/api/fs.html#per-drive-working-directories-on-windows" target="_blank" rel="noopener noreferrer">Per-drive working directories on Windows</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåœ¨æœåŠ¡ç«¯è¿è¡Œ JavaScript çš„å¹³å°ï¼Œå®ƒå…è®¸å¼€å‘è€…ä½¿ç”¨ JavaScript æ¥ç¼–å†™åç«¯ä»£ç ã€‚å…¶ä¸­ï¼Œ<code>fs</code>æ¨¡å—æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„æ¨¡å—ï¼Œå…è®¸ä½ å¯¹ç³»ç»Ÿä¸­çš„æ–‡ä»¶è¿›è¡Œè¯»å†™æ“ä½œã€‚</p><p>ä» Node.js v21.7.1 å¼€å§‹ï¼Œå¼•å…¥äº†ä¸€ä¸ªæ–°ç‰¹æ€§ï¼š<strong>Per-drive working directories on Windows</strong>ã€‚è¿™ä¸ªç‰¹æ€§æ˜¯ä¸“é—¨é’ˆå¯¹ Windows æ“ä½œç³»ç»Ÿçš„ï¼Œå› ä¸º Windows æœ‰ä¸€ä¸ªç‹¬ç‰¹çš„æ–‡ä»¶ç³»ç»Ÿç»“æ„ï¼Œæ”¯æŒå¤šä¸ªç›˜ç¬¦ï¼ˆå¦‚ C:ã€D:ç­‰ï¼‰ï¼Œè€Œæ¯ä¸ªç›˜ç¬¦éƒ½å¯ä»¥æœ‰è‡ªå·±çš„å½“å‰å·¥ä½œç›®å½•ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-per-drive-working-directories" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-per-drive-working-directories"><span>ä»€ä¹ˆæ˜¯â€œPer-drive working directoriesâ€ï¼Ÿ</span></a></h3><p>åœ¨ Windows ä¸­ï¼Œâ€œPer-drive working directoriesâ€æŒ‡çš„æ˜¯æ¯ä¸ªé©±åŠ¨å™¨ï¼ˆå³ç›˜ç¬¦ï¼‰éƒ½å¯ä»¥æ‹¥æœ‰è‡ªå·±ç‹¬ç«‹çš„å½“å‰å·¥ä½œç›®å½•ï¼ˆCurrent Working Directory, CWDï¼‰ã€‚è¿™æ„å‘³ç€å¦‚æœä½ åœ¨ C:ç›˜çš„æŸä¸ªç›®å½•ä¸‹æ‰“å¼€ä¸€ä¸ªå‘½ä»¤è¡Œçª—å£ï¼Œå¹¶åˆ‡æ¢åˆ° D:ç›˜ï¼Œå½“ä½ è¿”å› C:ç›˜æ—¶ï¼Œä½ ä»ç„¶ä¼šå›åˆ°ä½ ä¹‹å‰åœ¨ C:ç›˜çš„ç›®å½•ä½ç½®ã€‚</p><h3 id="node-js-ä¸­è¿™ä¸ªç‰¹æ€§çš„å®é™…åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#node-js-ä¸­è¿™ä¸ªç‰¹æ€§çš„å®é™…åº”ç”¨"><span>Node.js ä¸­è¿™ä¸ªç‰¹æ€§çš„å®é™…åº”ç”¨</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œé€šè¿‡<code>fs</code>æ¨¡å—ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’æ—¶ï¼Œå¯èƒ½éœ€è¦è€ƒè™‘åˆ°è¿™ç§ Windows ç‰¹æœ‰çš„æ–‡ä»¶ç³»ç»Ÿè¡Œä¸ºã€‚æ¯”å¦‚ï¼Œä½ çš„ Node.js åº”ç”¨å¯èƒ½éœ€è¦è¯»å–æˆ–å†™å…¥ä¸åŒé©±åŠ¨å™¨ä¸Šçš„æ–‡ä»¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç†è§£æ¯ä¸ªé©±åŠ¨å™¨æœ‰è‡ªå·±çš„å·¥ä½œç›®å½•å°±å˜å¾—éå¸¸é‡è¦ã€‚</p><h4 id="å®ä¾‹è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹è¯´æ˜"><span>å®ä¾‹è¯´æ˜</span></a></h4><p>å‡è®¾ä½ æœ‰ä»¥ä¸‹éœ€æ±‚ï¼š</p><ol><li>ä½ éœ€è¦è¯»å–ä½äº C:ç›˜æŸä¸ªç›®å½•ï¼ˆæ¯”å¦‚<code>C:\Users\YourName\Documents</code>ï¼‰ä¸‹çš„æ–‡ä»¶ã€‚</li><li>æ¥ç€ï¼Œä½ éœ€è¦å¤„ç†ä½äº D:ç›˜çš„å¦ä¸€ä¸ªç›®å½•ï¼ˆæ¯”å¦‚<code>D:\Projects\NodeApp\data</code>ï¼‰ä¸‹çš„æ•°æ®ã€‚</li><li>æœ€åï¼Œå¯èƒ½éœ€è¦å°†å¤„ç†ç»“æœä¿å­˜å› C:ç›˜çš„åŸå§‹ç›®å½•ã€‚</li></ol><p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä½ çš„ Node.js åº”ç”¨éœ€è¦èƒ½å¤Ÿçµæ´»åœ°åœ¨ä¸åŒé©±åŠ¨å™¨çš„å·¥ä½œç›®å½•ä¹‹é—´åˆ‡æ¢ï¼Œç¡®ä¿æ–‡ä»¶çš„è¯»å†™æ“ä½œéƒ½åœ¨æ­£ç¡®çš„è·¯å¾„ä¸‹æ‰§è¡Œã€‚é€šè¿‡åˆ©ç”¨ Node.js v21.7.1 å¼•å…¥çš„â€œPer-drive working directoriesâ€ç‰¹æ€§ï¼Œå¯ä»¥æ›´åŠ æ–¹ä¾¿åœ°ç®¡ç†è¿™ç§è·¨é©±åŠ¨å™¨çš„æ–‡ä»¶æ“ä½œã€‚</p><h4 id="å…·ä½“ä»£ç ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å…·ä½“ä»£ç ç¤ºä¾‹"><span>å…·ä½“ä»£ç ç¤ºä¾‹</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">path</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾çš„Cç›˜ç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> cDrivePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">C:</span><span style="color:#EBCB8B;">\\</span><span style="color:#A3BE8C;">Users</span><span style="color:#EBCB8B;">\\</span><span style="color:#A3BE8C;">YourName</span><span style="color:#EBCB8B;">\\</span><span style="color:#A3BE8C;">Documents</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// å‡è®¾çš„Dç›˜ç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> dDrivePath</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">D:</span><span style="color:#EBCB8B;">\\</span><span style="color:#A3BE8C;">Projects</span><span style="color:#EBCB8B;">\\</span><span style="color:#A3BE8C;">NodeApp</span><span style="color:#EBCB8B;">\\</span><span style="color:#A3BE8C;">data</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åœ¨Cç›˜ç›®å½•ä¸‹è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">cDrivePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Cç›˜æ–‡ä»¶å†…å®¹ï¼š</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å¤„ç†æ•°æ®åï¼Œåœ¨Dç›˜ç›®å½•ä¸‹å¤„ç†æˆ–åˆ›å»ºæ–°æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> processedData</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toUpperCase</span><span style="color:#D8DEE9FF;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // ç¤ºä¾‹å¤„ç†ï¼šè½¬æ¢ä¸ºå¤§å†™</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">dDrivePath</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">output.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> processedData</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ•°æ®å·²å¤„ç†å¹¶ä¿å­˜åˆ°Dç›˜</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // è¿›ä¸€æ­¥æ“ä½œ...</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè¯»å– C ç›˜æŸä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå¤„ç†æ–‡ä»¶å†…å®¹ï¼Œç„¶åå°†å¤„ç†ç»“æœä¿å­˜åˆ° D ç›˜çš„ä¸åŒç›®å½•ä¸­ã€‚æ•´ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ°åœ¨ä¸åŒé©±åŠ¨å™¨é—´çš„æ–‡ä»¶æ“ä½œï¼Œå€ŸåŠ©äº Node.js v21.7.1 ä¸­å¼•å…¥çš„ç‰¹æ€§ï¼Œå¯ä»¥ç¡®ä¿è¿™äº›æ“ä½œæŒ‰é¢„æœŸè¿›è¡Œã€‚</p><h3 id="file-descriptors-1" tabindex="-1"><a class="header-anchor" href="#file-descriptors-1"><span><a href="https://nodejs.org/docs/latest/api/fs.html#file-descriptors_1" target="_blank" rel="noopener noreferrer">File descriptors</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œæ–‡ä»¶æè¿°ç¬¦æ˜¯ä¸€ä¸ªéå¸¸åŸºæœ¬ä½†é‡è¦çš„æ¦‚å¿µï¼Œå°¤å…¶æ˜¯å½“ä½ éœ€è¦ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’æ—¶ã€‚ä¸ºäº†ç†è§£æ–‡ä»¶æè¿°ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬æƒ³è±¡ä¸ºæ–‡ä»¶æˆ–å…¶ä»–èµ„æºï¼ˆå¦‚å¥—æ¥å­—ï¼‰çš„å¼•ç”¨æˆ–ç´¢å¼•ã€‚æ¯å½“ä½ æ‰“å¼€æˆ–åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šæä¾›ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œå³æ–‡ä»¶æè¿°ç¬¦ï¼Œæ¥ä»£è¡¨è¿™ä¸ªæ–‡ä»¶ã€‚</p><h3 id="åŸºç¡€æ¦‚å¿µ-7" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æ¦‚å¿µ-7"><span>åŸºç¡€æ¦‚å¿µ</span></a></h3><ul><li><strong>æ–‡ä»¶æè¿°ç¬¦</strong>ï¼šç®€å•æ¥è¯´ï¼Œå°±æ˜¯ä¸€ä¸ªæ•°å­— IDï¼Œç”¨äºä»£è¡¨æ‰“å¼€çš„æ–‡ä»¶ã€‚å®ƒæ˜¯æ“ä½œç³»ç»Ÿæä¾›çš„ï¼Œä»¥ä¾¿åº”ç”¨ç¨‹åºè¯†åˆ«å’Œæ“ä½œç‰¹å®šçš„æ–‡ä»¶ã€‚</li><li><strong>ä¸ºä»€ä¹ˆéœ€è¦æ–‡ä»¶æè¿°ç¬¦</strong>ï¼šæ“ä½œç³»ç»Ÿä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦æ¥è¿½è¸ªæ‰€æœ‰æ‰“å¼€çš„æ–‡ä»¶ã€‚è€Œåº”ç”¨ç¨‹åºï¼ˆä¾‹å¦‚ä½¿ç”¨ Node.js å¼€å‘çš„ç¨‹åºï¼‰åˆ™é€šè¿‡æ–‡ä»¶æè¿°ç¬¦è¿›è¡Œè¯»å†™æ“ä½œç­‰ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-35" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-35"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-è¯»å–æ–‡ä»¶-2" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-è¯»å–æ–‡ä»¶-2"><span>ç¤ºä¾‹ 1ï¼šè¯»å–æ–‡ä»¶</span></a></h4><p>å‡è®¾ä½ æƒ³è¯»å–ä¸€ä¸ªåä¸º<code>example.txt</code>çš„æ–‡ä»¶å†…å®¹ã€‚åœ¨ Node.js ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>fs.open</code>æ–¹æ³•æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œè¯¥æ–¹æ³•å°†è¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚ç„¶åï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦æ¥è¯»å–æ–‡ä»¶å†…å®¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦fdè¯»å–æ–‡ä»¶...</span></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">alloc</span><span style="color:#D8DEE9FF;">(</span><span style="color:#B48EAD;">1024</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">length</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> null</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      return;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> bytesRead</span><span style="color:#D8DEE9FF;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å®Œæˆåå…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆæ‰“å¼€<code>example.txt</code>æ–‡ä»¶ä»¥ä¾›è¯»å–ï¼ˆ&#39;r&#39;æ¨¡å¼ï¼‰ã€‚ç„¶åä½¿ç”¨<code>fs.read</code>æ–¹æ³•åˆ©ç”¨å¾—åˆ°çš„æ–‡ä»¶æè¿°ç¬¦<code>fd</code>è¯»å–æ–‡ä»¶å†…å®¹ã€‚æœ€åï¼Œé€šè¿‡è°ƒç”¨<code>fs.close</code>æ–¹æ³•å¹¶ä¼ å…¥æ–‡ä»¶æè¿°ç¬¦æ¥å…³é—­æ–‡ä»¶ã€‚</p><h4 id="ç¤ºä¾‹-2-å†™å…¥æ–‡ä»¶-2" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å†™å…¥æ–‡ä»¶-2"><span>ç¤ºä¾‹ 2ï¼šå†™å…¥æ–‡ä»¶</span></a></h4><p>å‡è®¾ç°åœ¨ä½ æƒ³å‘ä¸€ä¸ªæ–‡ä»¶å†™å…¥å†…å®¹ã€‚ç±»ä¼¼åœ°ï¼Œä½ ä¹Ÿä¼šå…ˆæ‰“å¼€ï¼ˆæˆ–åˆ›å»ºï¼‰è¿™ä¸ªæ–‡ä»¶ä»¥è·å–æ–‡ä»¶æè¿°ç¬¦ï¼Œç„¶åä½¿ç”¨è¿™ä¸ªæè¿°ç¬¦æ¥æ‰§è¡Œå†™å…¥æ“ä½œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ‰“å¼€ï¼ˆæˆ–åˆ›å»ºï¼‰æ–‡ä»¶ä»¥ä¾›å†™å…¥</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">open</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">new-example.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fd</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦fdå†™å…¥æ–‡ä»¶</span></span>
<span class="line"><span style="color:#81A1C1;">  let</span><span style="color:#D8DEE9;"> content</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello, Node.js!</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">write</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> content</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">      console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      return;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">File has been written successfully.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // å®Œæˆåå…³é—­æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">    fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">fd</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">      if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬æ‰“å¼€ï¼ˆæˆ–åˆ›å»ºï¼‰<code>new-example.txt</code>æ–‡ä»¶ï¼Œå¹¶å‡†å¤‡å†™å…¥æ•°æ®ã€‚ä½¿ç”¨<code>fs.write</code>æ–¹æ³•å¹¶æä¾›æ–‡ä»¶æè¿°ç¬¦<code>fd</code>ä»¥åŠè¦å†™å…¥çš„å†…å®¹ã€‚æ“ä½œå®Œæˆåï¼ŒåŒæ ·éœ€è¦é€šè¿‡<code>fs.close</code>å…³é—­æ–‡ä»¶ã€‚</p><h3 id="ç»“è®º-8" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-8"><span>ç»“è®º</span></a></h3><p>æ–‡ä»¶æè¿°ç¬¦åœ¨ Node.js ä¸­æ‰®æ¼”äº†ä¸æ–‡ä»¶æ“ä½œç›¸å…³çš„æ ¸å¿ƒè§’è‰²ã€‚é€šè¿‡å®ƒï¼Œæˆ‘ä»¬èƒ½å¤Ÿå¯¹æ–‡ä»¶è¿›è¡Œè¯»å†™ã€æŸ¥è¯¢ä¿¡æ¯ç­‰æ“ä½œã€‚ç†è§£å®ƒçš„å·¥ä½œåŸç†å¯¹äºè¿›è¡Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œéå¸¸é‡è¦ã€‚</p><h3 id="threadpool-usage" tabindex="-1"><a class="header-anchor" href="#threadpool-usage"><span><a href="https://nodejs.org/docs/latest/api/fs.html#threadpool-usage" target="_blank" rel="noopener noreferrer">Threadpool usage</a></span></a></h3><p>å¥½çš„ï¼ŒNode.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚Node.js çš„ä¸€ä¸ªç‰¹ç‚¹æ˜¯éé˜»å¡ I/Oï¼Œè¿™æ„å‘³ç€å®ƒé€šè¿‡äº‹ä»¶å’Œå›è°ƒæ¥å¤„ç†å¤šä¸ªæ“ä½œï¼Œè€Œä¸æ˜¯ç­‰å¾…æ¯ä¸ªæ“ä½œå®Œæˆåå†ç»§ç»­ä¸‹ä¸€ä¸ªæ“ä½œã€‚</p><p>Node.js ä½¿ç”¨äº†ä¸€ä¸ªå«åš &quot;libuv&quot; çš„åº“æ¥å¤„ç†å¼‚æ­¥äº‹ä»¶ã€‚Libuv åº“æä¾›äº†ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œç”¨äºæ‰§è¡Œè¯¸å¦‚æ–‡ä»¶ç³»ç»Ÿæ“ä½œã€DNS è§£æç­‰å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´æ‰èƒ½å®Œæˆçš„ä»»åŠ¡ã€‚çº¿ç¨‹æ± ç”±ä¸€ç»„åœ¨åå°è¿è¡Œçš„çº¿ç¨‹ç»„æˆï¼Œè¿™äº›çº¿ç¨‹å¯ä»¥å¹¶è¡Œå¤„ç†å¤šä¸ªä»»åŠ¡ï¼Œä»¥å…é˜»å¡ä¸»çº¿ç¨‹ï¼ˆé€šå¸¸ä¹Ÿå°±æ˜¯æ‰§è¡Œä½  JavaScript ä»£ç çš„é‚£ä¸ªçº¿ç¨‹ï¼‰ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­çš„æ–‡æ¡£é‡Œæåˆ°çš„ Threadpool Usageï¼ˆçº¿ç¨‹æ± ä½¿ç”¨ï¼‰ä¸»è¦æŒ‡çš„æ˜¯ Node.js å†…ç½®çš„ fs æ¨¡å—(æ–‡ä»¶ç³»ç»Ÿæ¨¡å—)åœ¨æ‰§è¡Œæ–‡ä»¶æ“ä½œæ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨çº¿ç¨‹æ± æ¥æé«˜æ€§èƒ½ã€‚</p><p>ä¸‹é¢ï¼Œæˆ‘å°†é€šè¿‡å‡ ä¸ªå®é™…çš„ä¾‹å­æ¥è§£é‡Šçº¿ç¨‹æ± çš„ä½¿ç”¨ï¼š</p><h3 id="ç¤ºä¾‹-1-è¯»å–æ–‡ä»¶-3" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-è¯»å–æ–‡ä»¶-3"><span>ç¤ºä¾‹ 1ï¼šè¯»å–æ–‡ä»¶</span></a></h3><p>å½“ä½ ä½¿ç”¨ <code>fs.readFile</code> æ–¹æ³•è¯»å–ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼ŒNode.js å®é™…ä¸Šä¼šå‘é€ä¸€ä¸ªä»»åŠ¡åˆ°çº¿ç¨‹æ± å»è¯»å–æ–‡ä»¶å†…å®¹ã€‚è¿™æ ·ä¸»çº¿ç¨‹å¯ä»¥ç»§ç»­æ‰§è¡Œå…¶ä»–ä»£ç ï¼Œè€Œä¸å¿…ç­‰å¾…æ–‡ä»¶è¯»å–å®Œæˆã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">è¯»å–æ–‡ä»¶æ“ä½œå·²å‘é€åˆ°çº¿ç¨‹æ± </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå³ä½¿æ–‡ä»¶å¾ˆå¤§æˆ–è€…ç£ç›˜å“åº”æ…¢ï¼Œ<code>console.log(&#39;è¯»å–æ–‡ä»¶æ“ä½œå·²å‘é€åˆ°çº¿ç¨‹æ± &#39;);</code> è¿™è¡Œä»£ç è¿˜æ˜¯ä¼šé©¬ä¸Šè¢«æ‰§è¡Œï¼Œå› ä¸ºæ–‡ä»¶è¯»å–åœ¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹ä¸­è¿›è¡Œã€‚</p><h3 id="ç¤ºä¾‹-2-å†™å…¥æ–‡ä»¶-3" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å†™å…¥æ–‡ä»¶-3"><span>ç¤ºä¾‹ 2ï¼šå†™å…¥æ–‡ä»¶</span></a></h3><p>åŒæ ·ï¼Œå½“ä½ å°è¯•å†™å…¥æ–‡ä»¶æ—¶ï¼Œæ“ä½œä¼šè¢«é€åˆ°çº¿ç¨‹æ± ä¸­ï¼Œä¸»çº¿ç¨‹ä¸ä¼šè¢«é˜»å¡ç­‰å¾…å†™å…¥å®Œæˆã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">/path/to/file</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hello Node.js</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ–‡ä»¶å·²ä¿å­˜ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å†™å…¥æ–‡ä»¶æ“ä½œå·²å‘é€åˆ°çº¿ç¨‹æ± </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å†™å…¥æ“ä½œå®Œæˆä¹‹å‰ï¼Œ<code>console.log(&#39;å†™å…¥æ–‡ä»¶æ“ä½œå·²å‘é€åˆ°çº¿ç¨‹æ± &#39;);</code> è¿™è¡Œä»£ç ä¼šè¢«æ‰§è¡Œã€‚</p><h3 id="ç¤ºä¾‹-3-è®¡ç®—å¯†é›†å‹ä»»åŠ¡" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-è®¡ç®—å¯†é›†å‹ä»»åŠ¡"><span>ç¤ºä¾‹ 3ï¼šè®¡ç®—å¯†é›†å‹ä»»åŠ¡</span></a></h3><p>å¯¹äºè®¡ç®—å¯†é›†å‹ä»»åŠ¡ï¼Œä¾‹å¦‚åŠ å¯†ã€å‹ç¼©ç­‰ï¼Œå¦‚æœä½ ä½¿ç”¨æ ‡å‡†çš„ Node.js APIï¼Œè¿™äº›æ“ä½œé»˜è®¤ä¸ä¼šä½¿ç”¨çº¿ç¨‹æ± ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ CPU ç»‘å®šçš„ï¼Œå¹¶ä¸” Node.js çš„çº¿ç¨‹æ± ä¸»è¦æ˜¯ç”¨æ¥å¤„ç† I/O æ“ä½œã€‚ä½†ä½ å¯ä»¥ä½¿ç”¨åƒ <code>worker_threads</code> æ¨¡å—è¿™æ ·çš„åŠŸèƒ½æ¥æ‰‹åŠ¨åˆ›å»ºæ–°çš„çº¿ç¨‹æ¥æ‰§è¡Œè¿™äº›ä»»åŠ¡ï¼Œä»è€Œä¸é˜»å¡ä¸»çº¿ç¨‹ã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> Worker</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> isMainThread</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> parentPort</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">worker_threads</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">isMainThread</span><span style="color:#D8DEE9FF;">) </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> worker</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Worker</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">__filename</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  worker</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">on</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">message</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">msg</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">msg</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ”¶åˆ°æ¥è‡ªå·¥ä½œçº¿ç¨‹çš„æ¶ˆæ¯</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ä¸»çº¿ç¨‹è¿è¡Œä¸­</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">  parentPort</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">postMessage</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å·¥ä½œçº¿ç¨‹å®Œæˆä»»åŠ¡å¹¶å‘é€æ­¤æ¶ˆæ¯</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœå½“å‰æ˜¯ä¸»çº¿ç¨‹ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œå½“å‰æ–‡ä»¶ã€‚ç”±äºå·¥ä½œçº¿ç¨‹æ˜¯åœ¨å¦ä¸€ä¸ªçº¿ç¨‹ä¸­è¿è¡Œçš„ï¼Œä¸»çº¿çº¿ç¨‹å¯ä»¥ç»§ç»­æ‰§è¡Œä»»åŠ¡ï¼Œè€Œä¸ä¼šè¢«é˜»å¡ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯ Node.js ä¸­çº¿ç¨‹æ± çš„ä¸€äº›åŸºæœ¬ç”¨æ³•å’Œä¾‹å­ã€‚å¸Œæœ›è¿™äº›ä¾‹å­èƒ½å¸®åŠ©ä½ ç†è§£åœ¨ Node.js ä¸­å¦‚ä½•åˆ©ç”¨çº¿ç¨‹æ± æ¥æé«˜æ€§èƒ½ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ“ä½œæ—¶ã€‚</p><h3 id="file-system-flags" tabindex="-1"><a class="header-anchor" href="#file-system-flags"><span><a href="https://nodejs.org/docs/latest/api/fs.html#file-system-flags" target="_blank" rel="noopener noreferrer">File system flags</a></span></a></h3><p>Node.js ä¸­çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰æ¨¡å—æä¾›äº†ä¸€ç»„ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ APIã€‚åœ¨è¿™ä¸ªæ¡†æ¶å†…ï¼Œ&quot;flags&quot;(æ ‡å¿—) æ˜¯ç”¨äºæ§åˆ¶æ–‡ä»¶æ‰“å¼€æˆ–åˆ›å»ºæ—¶çš„è¡Œä¸ºçš„ç‰¹æ®Šå­—ç¬¦ä¸²ã€‚ç†è§£è¿™äº›æ ‡å¿—æ˜¯é‡è¦çš„ï¼Œå› ä¸ºå®ƒä»¬èƒ½å¸®åŠ©ä½ æ›´ç²¾ç¡®åœ°æ§åˆ¶æ–‡ä»¶æ“ä½œå¦‚ä½•æ‰§è¡Œï¼Œæ¯”å¦‚æ˜¯è¦†ç›–ç°æœ‰æ–‡ä»¶ã€è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾è¿˜æ˜¯ä»…è¯»å–æ–‡ä»¶ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„æ–‡ä»¶ç³»ç»Ÿæ ‡å¿—åŠå…¶ç”¨é€”çš„è¯¦ç»†è§£é‡Šï¼š</p><ol><li><p><strong><code>&#39;r&#39;</code></strong>: æ‰“å¼€æ–‡ä»¶ç”¨äºè¯»å–ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚</p></li><li><p><strong><code>&#39;r+&#39;</code></strong>: æ‰“å¼€æ–‡ä»¶ç”¨äºè¯»å†™ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚</p></li><li><p><strong><code>&#39;w&#39;</code></strong>: æ‰“å¼€æ–‡ä»¶ç”¨äºå†™å…¥ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºè¯¥æ–‡ä»¶ï¼›å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œåˆ™æˆªæ–­ï¼ˆæ¸…ç©ºï¼‰è¯¥æ–‡ä»¶ã€‚</p></li><li><p><strong><code>&#39;w+&#39;</code></strong>: æ‰“å¼€æ–‡ä»¶ç”¨äºè¯»å†™ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºè¯¥æ–‡ä»¶ï¼›å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œåˆ™æˆªæ–­è¯¥æ–‡ä»¶ã€‚</p></li><li><p><strong><code>&#39;a&#39;</code></strong>: æ‰“å¼€æ–‡ä»¶ç”¨äºè¿½åŠ ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºè¯¥æ–‡ä»¶ã€‚</p></li><li><p><strong><code>&#39;a+&#39;</code></strong>: æ‰“å¼€æ–‡ä»¶ç”¨äºè¯»å–å’Œè¿½åŠ ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºè¯¥æ–‡ä»¶ã€‚</p></li></ol><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡ä¸€äº›å®é™…çš„ä¾‹å­æ¥çœ‹çœ‹è¿™äº›æ ‡å¿—æ˜¯å¦‚ä½•ä½¿ç”¨çš„ï¼š</p><h3 id="ç¤ºä¾‹-1-åˆ›å»ºæˆ–è¿½åŠ ä¸€æ¡æ—¥å¿—" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åˆ›å»ºæˆ–è¿½åŠ ä¸€æ¡æ—¥å¿—"><span>ç¤ºä¾‹ 1: åˆ›å»ºæˆ–è¿½åŠ ä¸€æ¡æ—¥å¿—</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œéœ€è¦åœ¨æ¯æ¬¡æ‰§è¡Œæ—¶å‘æ—¥å¿—æ–‡ä»¶è¿½åŠ æ¶ˆæ¯ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>&#39;a&#39;</code> æ ‡å¿—æ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./application.log</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// æ·»åŠ ä¸€æ¡æ–°æ—¥å¿—</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">appendFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">æ–°çš„æ—¥å¿—æ¡ç›®</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> flag</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">  console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ—¥å¿—å·²æ›´æ–°ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œå³ä½¿ <code>application.log</code> æ–‡ä»¶æœ€åˆä¸å­˜åœ¨ï¼Œ<code>&#39;a&#39;</code> æ ‡å¿—ä¹Ÿä¼šåˆ›å»ºå®ƒï¼Œå¹¶ä¸”æ¯æ¬¡è°ƒç”¨ <code>appendFile</code> éƒ½ä¼šåœ¨æ–‡ä»¶çš„æœ«å°¾æ·»åŠ ä¸€è¡Œæ–°å†…å®¹ã€‚</p><h3 id="ç¤ºä¾‹-2-è¯»å–ç„¶åæ›´æ–°æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-è¯»å–ç„¶åæ›´æ–°æ–‡ä»¶"><span>ç¤ºä¾‹ 2: è¯»å–ç„¶åæ›´æ–°æ–‡ä»¶</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ éœ€è¦è¯»å–ä¸€ä¸ªé…ç½®æ–‡ä»¶çš„å†…å®¹ï¼Œç„¶åæ›´æ–°å®ƒã€‚è¿™é‡Œ <code>&#39;r+&#39;</code> æˆ– <code>&#39;w+&#39;</code> æ ‡å¿—å¯èƒ½ä¼šæ´¾ä¸Šç”¨åœºï¼Œä½†æˆ‘ä»¬è¿™æ¬¡ä½¿ç”¨ <code>&#39;r+&#39;</code> æ¥é¿å…åœ¨æ–‡ä»¶ä¸å­˜åœ¨æ—¶åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> fs</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> require</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> path</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">./config.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// å…ˆè¯»å–æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> encoding</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#88C0D0;"> flag</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // ç°åœ¨åŸºäºåŸå†…å®¹æ·»åŠ æ›´å¤šé…ç½®</span></span>
<span class="line"><span style="color:#81A1C1;">  const</span><span style="color:#D8DEE9;"> updatedContent</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;"> +</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#EBCB8B;">\n</span><span style="color:#A3BE8C;">æ–°çš„é…ç½®é¡¹: å€¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">  // å°†æ›´æ–°åçš„å†…å®¹å†™å›æ–‡ä»¶</span></span>
<span class="line"><span style="color:#D8DEE9;">  fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">writeFile</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">path</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> updatedContent</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> {</span><span style="color:#88C0D0;"> flag</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">r+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#D8DEE9FF;"> (</span><span style="color:#D8DEE9;">err</span><span style="color:#D8DEE9FF;">) </span><span style="color:#81A1C1;">throw</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">log</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">é…ç½®å·²æ›´æ–°ï¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#D8DEE9FF;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè¯»å–äº†æ–‡ä»¶ï¼Œç„¶ååœ¨åŸæœ‰å†…å®¹çš„åŸºç¡€ä¸Šæ·»åŠ äº†æ–°çš„é…ç½®é¡¹ï¼Œå¹¶å°†æ›´æ–°åçš„å†…å®¹å†™å›åŒä¸€ä¸ªæ–‡ä»¶ã€‚</p><h3 id="æ€»ç»“-23" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-23"><span>æ€»ç»“ï¼š</span></a></h3><p>é€šè¿‡ä½¿ç”¨ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿæ ‡å¿—ï¼Œä½ å¯ä»¥éå¸¸çµæ´»åœ°æ§åˆ¶å¯¹æ–‡ä»¶çš„æ“ä½œï¼Œæ— è®ºæ˜¯è¯»å–æ•°æ®ã€åˆ›å»ºæ–°æ–‡ä»¶ã€è¿˜æ˜¯å‘ç°æœ‰æ–‡ä»¶è¿½åŠ å†…å®¹ã€‚ç†è§£å¹¶æ­£ç¡®ä½¿ç”¨è¿™äº›æ ‡å¿—ï¼Œå°†å¸®åŠ©ä½ æ›´æœ‰æ•ˆåœ°å¤„ç†æ–‡ä»¶ç›¸å…³çš„ä»»åŠ¡ã€‚</p></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: kamiacgxu@gmail.com">kamishima-kaede</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/document/node-doc/Events.html" aria-label="Events"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Events</div></a><a class="route-link auto-link next" href="/document/node-doc/Global%20objects.html" aria-label="Global objects"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">Global objects<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><!----><div class="vp-copyright">Copyright Â© 2018-present hanekawa-shiki</div></footer></div><!--]--><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.be370b10.js" defer></script><script src="/assets/js/4485.e6fe7c7b.js" defer></script><script src="/assets/js/app.bf6f64e3.js" defer></script>
  </body>
</html>
