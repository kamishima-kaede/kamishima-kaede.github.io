<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.50" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://hanekawa.top/document/node-doc/Crypto.html"><meta property="og:site_name" content="hanekawa-shiki"><meta property="og:title" content="Crypto"><meta property="og:description" content="Crypto Node.js ä¸­çš„ crypto æ¨¡å—æ˜¯ä¸€ä¸ªæä¾›åŠ å¯†åŠŸèƒ½çš„å†…ç½®åº“ï¼ŒåŒ…æ‹¬å„ç§åŠ å¯†ç®—æ³•ï¼Œå¦‚å“ˆå¸Œã€HMACã€åŠ å¯†ã€è§£å¯†ã€ç­¾åå’ŒéªŒè¯ç­‰åŠŸèƒ½ã€‚åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œè¯¥æ¨¡å—ç»§ç»­ä½œä¸ºæ ¸å¿ƒçš„ä¸€éƒ¨åˆ†å­˜åœ¨ã€‚ä½¿ç”¨ crypto æ¨¡å—å¯ä»¥å¸®åŠ©ä½ å®Œæˆæ•°æ®çš„å®‰å…¨ä¼ è¾“ã€æ–‡ä»¶æ ¡éªŒã€å¯†ç å­˜å‚¨ç­‰ä»»åŠ¡ã€‚ ä¸‹é¢æˆ‘ä¼šè¯¦ç»†è§£é‡Šå‡ ä¸ª crypto æ¨¡å—çš„å¸¸è§ç”¨..."><meta property="og:type" content="website"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-06-21T09:46:17.000Z"><meta property="article:author" content="hanekawa-shiki"><meta property="article:modified_time" content="2024-06-21T09:46:17.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"WebPage","name":"Crypto","description":"Crypto Node.js ä¸­çš„ crypto æ¨¡å—æ˜¯ä¸€ä¸ªæä¾›åŠ å¯†åŠŸèƒ½çš„å†…ç½®åº“ï¼ŒåŒ…æ‹¬å„ç§åŠ å¯†ç®—æ³•ï¼Œå¦‚å“ˆå¸Œã€HMACã€åŠ å¯†ã€è§£å¯†ã€ç­¾åå’ŒéªŒè¯ç­‰åŠŸèƒ½ã€‚åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œè¯¥æ¨¡å—ç»§ç»­ä½œä¸ºæ ¸å¿ƒçš„ä¸€éƒ¨åˆ†å­˜åœ¨ã€‚ä½¿ç”¨ crypto æ¨¡å—å¯ä»¥å¸®åŠ©ä½ å®Œæˆæ•°æ®çš„å®‰å…¨ä¼ è¾“ã€æ–‡ä»¶æ ¡éªŒã€å¯†ç å­˜å‚¨ç­‰ä»»åŠ¡ã€‚ ä¸‹é¢æˆ‘ä¼šè¯¦ç»†è§£é‡Šå‡ ä¸ª crypto æ¨¡å—çš„å¸¸è§ç”¨..."}</script><meta name="keywords" content="JavaScript,HTML,CSS"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/assets/icons/chrome-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icons/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icons/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icons/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#5c92d1"><link rel="apple-touch-icon" href="/assets/icons/apple-touch-icon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="white"><meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><title>Crypto | hanekawa-shiki</title><meta name="description" content="Crypto Node.js ä¸­çš„ crypto æ¨¡å—æ˜¯ä¸€ä¸ªæä¾›åŠ å¯†åŠŸèƒ½çš„å†…ç½®åº“ï¼ŒåŒ…æ‹¬å„ç§åŠ å¯†ç®—æ³•ï¼Œå¦‚å“ˆå¸Œã€HMACã€åŠ å¯†ã€è§£å¯†ã€ç­¾åå’ŒéªŒè¯ç­‰åŠŸèƒ½ã€‚åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œè¯¥æ¨¡å—ç»§ç»­ä½œä¸ºæ ¸å¿ƒçš„ä¸€éƒ¨åˆ†å­˜åœ¨ã€‚ä½¿ç”¨ crypto æ¨¡å—å¯ä»¥å¸®åŠ©ä½ å®Œæˆæ•°æ®çš„å®‰å…¨ä¼ è¾“ã€æ–‡ä»¶æ ¡éªŒã€å¯†ç å­˜å‚¨ç­‰ä»»åŠ¡ã€‚ ä¸‹é¢æˆ‘ä¼šè¯¦ç»†è§£é‡Šå‡ ä¸ª crypto æ¨¡å—çš„å¸¸è§ç”¨...">
    <link rel="stylesheet" href="/assets/css/styles.2fe8dfd0.css">
    <link rel="preload" href="/assets/js/runtime~app.e98858ae.js" as="script"><link rel="preload" href="/assets/css/styles.2fe8dfd0.css" as="style"><link rel="preload" href="/assets/js/9435.209d772b.js" as="script"><link rel="preload" href="/assets/js/app.604dc302.js" as="script">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo light" src="/assets/svg/logo.svg" alt><img class="vp-nav-logo dark" src="/assets/svg/logo.svg" alt><span class="vp-site-name hide-in-pad">hanekawa-shiki</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="åšå®¢ä¸»é¡µ"><!--[--><span class="font-icon icon home" style=""></span><!--]-->åšå®¢ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="å­¦ä¹ ç¬”è®°"><!--[--><span class="font-icon icon framework" style=""></span>å­¦ä¹ ç¬”è®°<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">å‰ç«¯æ¡†æ¶</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/framework_front/vue3/" aria-label="Vue3ç¬”è®°"><!--[--><span class="font-icon icon vue" style=""></span><!--]-->Vue3ç¬”è®°<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/framework_front/react/" aria-label="Reactç¬”è®°"><!--[--><span class="font-icon icon react" style=""></span><!--]-->Reactç¬”è®°<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="æ–‡æ¡£"><!--[--><span class="font-icon icon framework" style=""></span>æ–‡æ¡£<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">æ¬è¿</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link route-link-active auto-link" href="/document/node-doc/" aria-label="Node.jsæ–‡æ¡£"><!--[--><span class="font-icon icon circle-info" style=""></span><!--]-->Node.jsæ–‡æ¡£<!----></a></li></ul></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/hanekawa-shiki/hanekawa-shiki.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/" aria-label="Node.jsæ–‡æ¡£"><!--[--><span class="font-icon icon circle-info" style=""></span><!--]-->Node.jsæ–‡æ¡£<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Assert.html" aria-label="Assert"><!---->Assert<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Async%20hooks.html" aria-label="Async hooks"><!---->Async hooks<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Asynchronous%20context%20tracking.html" aria-label="Asynchronous context tracking"><!---->Asynchronous context tracking<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Buffer.html" aria-label="Buffer"><!---->Buffer<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/C__%20addons.html" aria-label="C++ addons"><!---->C++ addons<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/C__%20embedder%20API.html" aria-label="C++ embedder API"><!---->C++ embedder API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Child%20process.html" aria-label="Child process"><!---->Child process<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Cluster.html" aria-label="Cluster"><!---->Cluster<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Command-line%20API.html" aria-label="Command-line API"><!---->Command-line API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Console.html" aria-label="Console"><!---->Console<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Corepack.html" aria-label="Corepack"><!---->Corepack<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/document/node-doc/Crypto.html" aria-label="Crypto"><!---->Crypto<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Debugger.html" aria-label="Debugger"><!---->Debugger<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Deprecated%20APIs.html" aria-label="Deprecated APIs"><!---->Deprecated APIs<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Diagnostic%20report.html" aria-label="Diagnostic report"><!---->Diagnostic report<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Diagnostics%20Channel.html" aria-label="Diagnostics Channel"><!---->Diagnostics Channel<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/DNS.html" aria-label="DNS"><!---->DNS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Domain.html" aria-label="Domain"><!---->Domain<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Errors.html" aria-label="Errors"><!---->Errors<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Events.html" aria-label="Events"><!---->Events<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/File%20system.html" aria-label="File system"><!---->File system<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Global%20objects.html" aria-label="Global objects"><!---->Global objects<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/HTTP.html" aria-label="HTTP"><!---->HTTP<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/HTTPS.html" aria-label="HTTPS"><!---->HTTPS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Inspector.html" aria-label="Inspector"><!---->Inspector<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Internationalization%20support.html" aria-label="Internationalization support"><!---->Internationalization support<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-CommonJS%20modules.html" aria-label="Modules: CommonJS modules"><!---->Modules: CommonJS modules<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-ECMAScript%20modules.html" aria-label="Modules: ECMAScript modules"><!---->Modules: ECMAScript modules<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-node_module%20API.html" aria-label="Modules: node:module API"><!---->Modules: node:module API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-Packages.html" aria-label="Modules: Packages"><!---->Modules: Packages<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Net.html" aria-label="Net"><!---->Net<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Node-API.html" aria-label="Node-API"><!---->Node-API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/OS.html" aria-label="OS"><!---->OS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Path.html" aria-label="Path"><!---->Path<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Performance%20measurement%20APIs.html" aria-label="Performance measurement APIs"><!---->Performance measurement APIs<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Permissions.html" aria-label="Permissions"><!---->Permissions<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Process.html" aria-label="Process"><!---->Process<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Punycode.html" aria-label="Punycode"><!---->Punycode<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Query%20string.html" aria-label="Query string"><!---->Query string<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Readline.html" aria-label="Readline"><!---->Readline<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/REPL.html" aria-label="REPL"><!---->REPL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Stream.html" aria-label="Stream"><!---->Stream<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/String%20decoder.html" aria-label="String decoder"><!---->String decoder<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Test%20runner.html" aria-label="Test runner"><!---->Test runner<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Timers.html" aria-label="Timers"><!---->Timers<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/TLS%20(SSL).html" aria-label="TLS (SSL)"><!---->TLS (SSL)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Trace%20events.html" aria-label="Trace events"><!---->Trace events<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/TTY.html" aria-label="TTY"><!---->TTY<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/URL.html" aria-label="URL"><!---->URL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Util.html" aria-label="Util"><!---->Util<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/V8.html" aria-label="V8"><!---->V8<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/VM%20(executing%20JavaScript).html" aria-label="VM (executing JavaScript)"><!---->VM (executing JavaScript)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Web%20Crypto%20API.html" aria-label="Web Crypto API"><!---->Web Crypto API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Web%20Streams%20API.html" aria-label="Web Streams API"><!---->Web Streams API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/WebAssembly%20System%20Interface%20(WASI).html" aria-label="WebAssembly System Interface (WASI)"><!---->WebAssembly System Interface (WASI)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Worker%20threads.html" aria-label="Worker threads"><!---->Worker threads<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Zlib.html" aria-label="Zlib"><!---->Zlib<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Crypto</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://hanekawa.top" target="_blank" rel="noopener noreferrer">hanekawa-shiki</a></span><span property="author" content="hanekawa-shiki"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-06-21T09:46:17.000Z"></span><!----><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 342 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT342M"></span><span class="page-word-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon" name="word"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 102598 å­—</span><meta property="wordCount" content="102598"></span><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å“ˆå¸Œ-hashing">å“ˆå¸Œï¼ˆHashingï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#hmac-å“ˆå¸Œæ¶ˆæ¯è®¤è¯ç ">HMACï¼ˆå“ˆå¸Œæ¶ˆæ¯è®¤è¯ç ï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŠ å¯†ä¸è§£å¯†">åŠ å¯†ä¸è§£å¯†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ•°å­—ç­¾åä¸éªŒè¯">æ•°å­—ç­¾åä¸éªŒè¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#determining-if-crypto-support-is-unavailable">Determining if crypto support is unavailable</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-certificate">Class: Certificate</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-certificate-ç±»">ä½¿ç”¨ Certificate ç±»</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#static-method-certificate-exportchallenge-spkac-encoding">Static method: Certificate.exportChallenge(spkac[, encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#static-method-certificate-exportpublickey-spkac-encoding">Static method: Certificate.exportPublicKey(spkac[, encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#static-method-certificate-verifyspkac-spkac-encoding">Static method: Certificate.verifySpkac(spkac[, encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#legacy-api">Legacy API</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#legacy-api-1">Legacy API</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-cipher">Class: Cipher</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-ç®€å•çš„æ–‡æœ¬åŠ å¯†">ä¾‹å­ 1ï¼šç®€å•çš„æ–‡æœ¬åŠ å¯†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-ä½¿ç”¨æµåŠ å¯†å¤§æ–‡ä»¶">ä¾‹å­ 2ï¼šä½¿ç”¨æµåŠ å¯†å¤§æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cipher-final-outputencoding">cipher.final([outputEncoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cipher-getauthtag">cipher.getAuthTag()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cipher-setaad-buffer-options">cipher.setAAD(buffer[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cipher-setautopadding-autopadding">cipher.setAutoPadding([autoPadding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cipher-update-data-inputencoding-outputencoding">cipher.update(data[, inputEncoding][, outputEncoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯´æ˜">å‚æ•°è¯´æ˜ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼">è¿”å›å€¼ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­">ä½¿ç”¨ä¾‹å­ï¼š</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-decipher">Class: Decipher</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#decipher-final-outputencoding">decipher.final([outputEncoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#decipher-setaad-buffer-options">decipher.setAAD(buffer[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#decipher-setauthtag-buffer-encoding">decipher.setAuthTag(buffer[, encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#decipher-setautopadding-autopadding">decipher.setAutoPadding([autoPadding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#decipher-update-data-inputencoding-outputencoding">decipher.update(data[, inputEncoding][, outputEncoding])</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-diffiehellman">Class: DiffieHellman</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#diffie-hellman-å¯†é’¥äº¤æ¢åŸç†ç®€ä»‹">Diffie-Hellman å¯†é’¥äº¤æ¢åŸç†ç®€ä»‹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åœ¨-node-js-ä½¿ç”¨-diffiehellman-ç±»çš„ä¾‹å­">åœ¨ Node.js ä½¿ç”¨ DiffieHellman ç±»çš„ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#diffiehellman-computesecret-otherpublickey-inputencoding-outputencoding">diffieHellman.computeSecret(otherPublicKey[, inputEncoding][, outputEncoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-diffiehellman-computesecret-çš„æ­¥éª¤">ä½¿ç”¨ diffieHellman.computeSecret() çš„æ­¥éª¤</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹ä»£ç -1">ç¤ºä¾‹ä»£ç </a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#diffiehellman-generatekeys-encoding">diffieHellman.generateKeys([encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#diffiehellman-getgenerator-encoding">diffieHellman.getGenerator([encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#diffiehellman-getprime-encoding">diffieHellman.getPrime([encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#diffiehellman-getprivatekey-encoding">diffieHellman.getPrivateKey([encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#diffie-hellman-å¯†é’¥äº¤æ¢åè®®">Diffie-Hellman å¯†é’¥äº¤æ¢åè®®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#getprivatekey-æ–¹æ³•">getPrivateKey æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­">ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#diffiehellman-getpublickey-encoding">diffieHellman.getPublicKey([encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹">å®é™…è¿ç”¨ç¤ºä¾‹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#diffiehellman-setprivatekey-privatekey-encoding">diffieHellman.setPrivateKey(privateKey[, encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-diffie-hellman-å¯†é’¥äº¤æ¢">ä»€ä¹ˆæ˜¯ Diffie-Hellman å¯†é’¥äº¤æ¢ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#diffiehellman-setprivatekey-privatekey-encoding-æ–¹æ³•">diffieHellman.setPrivateKey(privateKey[, encoding]) æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹">ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#diffiehellman-setpublickey-publickey-encoding">diffieHellman.setPublicKey(publicKey[, encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#diffie-hellman-å¯†é’¥äº¤æ¢åè®®-1">Diffie-Hellman å¯†é’¥äº¤æ¢åè®®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#setpublickey-æ–¹æ³•">setPublicKey æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#diffiehellman-verifyerror">diffieHellman.verifyError</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-diffiehellmangroup">Class: DiffieHellmanGroup</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-ecdh">Class: ECDH</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ­¥éª¤-1-ç”Ÿæˆå¯†é’¥å¯¹">æ­¥éª¤ 1ï¼šç”Ÿæˆå¯†é’¥å¯¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ­¥éª¤-2-äº¤æ¢å…¬é’¥">æ­¥éª¤ 2ï¼šäº¤æ¢å…¬é’¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ­¥éª¤-3-è®¡ç®—å…±äº«å¯†é’¥">æ­¥éª¤ 3ï¼šè®¡ç®—å…±äº«å¯†é’¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#static-method-ecdh-convertkey-key-curve-inputencoding-outputencoding-format">Static method: ECDH.convertKey(key, curve[, inputEncoding[, outputEncoding[, format]]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-å°†-base64-ç¼–ç çš„å¯†é’¥è½¬æ¢ä¸º-buffer">ä¾‹å­ 1ï¼šå°† Base64 ç¼–ç çš„å¯†é’¥è½¬æ¢ä¸º Buffer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-å°†-pem-æ ¼å¼çš„å¯†é’¥è½¬æ¢ä¸º-hex-ç¼–ç å­—ç¬¦ä¸²">ä¾‹å­ 2ï¼šå°† PEM æ ¼å¼çš„å¯†é’¥è½¬æ¢ä¸º HEX ç¼–ç å­—ç¬¦ä¸²</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-3-å°†åå…­è¿›åˆ¶ç¼–ç çš„å¯†é’¥è½¬æ¢ä¸º-base64-ç¼–ç å­—ç¬¦ä¸²">ä¾‹å­ 3ï¼šå°†åå…­è¿›åˆ¶ç¼–ç çš„å¯†é’¥è½¬æ¢ä¸º Base64 ç¼–ç å­—ç¬¦ä¸²</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ecdh-computesecret-otherpublickey-inputencoding-outputencoding">ecdh.computeSecret(otherPublicKey[, inputEncoding][, outputEncoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ecdh-generatekeys-encoding-format">ecdh.generateKeys([encoding[, format]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ecdh-getprivatekey-encoding">ecdh.getPrivateKey([encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ecdh-getpublickey-encoding-format">ecdh.getPublicKey([encoding][, format])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-1">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ecdh-setprivatekey-privatekey-encoding">ecdh.setPrivateKey(privateKey[, encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ecdh-setpublickey-publickey-encoding">ecdh.setPublicKey(publicKey[, encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ¤­åœ†æ›²çº¿-diffie-hellman-ecdh-å¯†é’¥äº¤æ¢">æ¤­åœ†æ›²çº¿ Diffie-Hellman (ECDH) å¯†é’¥äº¤æ¢</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ecdh-setpublickey-publickey-encoding-1">ecdh.setPublicKey(publicKey[, encoding])</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-hash">Class: Hash</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-hash-ç±»">å¦‚ä½•ä½¿ç”¨ Hash ç±»</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-2">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#hash-copy-options">hash.copy([options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#hash-digest-encoding">hash.digest([encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-ç”Ÿæˆå­—ç¬¦ä¸²çš„-sha-256-æ•£åˆ—å€¼">ä¾‹å­ 1ï¼šç”Ÿæˆå­—ç¬¦ä¸²çš„ SHA-256 æ•£åˆ—å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-æ£€éªŒæ–‡ä»¶çš„å®Œæ•´æ€§">ä¾‹å­ 2ï¼šæ£€éªŒæ–‡ä»¶çš„å®Œæ•´æ€§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#hash-update-data-inputencoding">hash.update(data[, inputEncoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-ç®€å•çš„å“ˆå¸Œç”Ÿæˆ">ç¤ºä¾‹ 1ï¼šç®€å•çš„å“ˆå¸Œç”Ÿæˆ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-åˆ†æ‰¹æ›´æ–°å“ˆå¸Œå¯¹è±¡">ç¤ºä¾‹ 2ï¼šåˆ†æ‰¹æ›´æ–°å“ˆå¸Œå¯¹è±¡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-3-ä½¿ç”¨ä¸åŒç¼–ç çš„æ•°æ®">ç¤ºä¾‹ 3ï¼šä½¿ç”¨ä¸åŒç¼–ç çš„æ•°æ®</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-hmac">Class: Hmac</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åˆ›å»º-hmac-å®ä¾‹">åˆ›å»º Hmac å®ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ›´æ–°æ•°æ®">æ›´æ–°æ•°æ®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è®¡ç®—æ‘˜è¦">è®¡ç®—æ‘˜è¦</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ç”¨ä¾‹">å®é™…ç”¨ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#hmac-digest-encoding">hmac.digest([encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ­¥éª¤ä¸€-å¯¼å…¥-crypto-æ¨¡å—">æ­¥éª¤ä¸€ï¼šå¯¼å…¥ crypto æ¨¡å—</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ­¥éª¤äºŒ-åˆ›å»º-hmac-å®ä¾‹">æ­¥éª¤äºŒï¼šåˆ›å»º HMAC å®ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ­¥éª¤ä¸‰-æ›´æ–°æ•°æ®">æ­¥éª¤ä¸‰ï¼šæ›´æ–°æ•°æ®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ­¥éª¤å››-è·å–æ‘˜è¦">æ­¥éª¤å››ï¼šè·å–æ‘˜è¦</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸¾ä¸ªä¾‹å­">ä¸¾ä¸ªä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#hmac-update-data-inputencoding">hmac.update(data[, inputEncoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-ä½¿ç”¨-hmac-éªŒè¯æ•°æ®å®Œæ•´æ€§">ç¤ºä¾‹ 1ï¼šä½¿ç”¨ HMAC éªŒè¯æ•°æ®å®Œæ•´æ€§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-è¿ç»­ä½¿ç”¨-update-æ–¹æ³•">ç¤ºä¾‹ 2ï¼šè¿ç»­ä½¿ç”¨ update æ–¹æ³•</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-keyobject">Class: KeyObject</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-åˆ›å»ºå¹¶å¯¼å‡ºä¸€ä¸ªå¯¹ç§°å¯†é’¥">ä¾‹å­ 1: åˆ›å»ºå¹¶å¯¼å‡ºä¸€ä¸ªå¯¹ç§°å¯†é’¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-åˆ›å»ºå…¬é’¥å’Œç§é’¥å¯¹">ä¾‹å­ 2: åˆ›å»ºå…¬é’¥å’Œç§é’¥å¯¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#static-method-keyobject-from-key">Static method: KeyObject.from(key)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#keyobject-asymmetrickeydetails">keyObject.asymmetricKeyDetails</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#keyobject-asymmetrickeytype">keyObject.asymmetricKeyType</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç”Ÿæˆæ–°çš„å¯†é’¥å¯¹å¹¶æ£€æŸ¥å¯†é’¥ç±»å‹">ç”Ÿæˆæ–°çš„å¯†é’¥å¯¹å¹¶æ£€æŸ¥å¯†é’¥ç±»å‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¯¼å…¥å¯†é’¥å¹¶æ£€æŸ¥å…¶ç±»å‹">å¯¼å…¥å¯†é’¥å¹¶æ£€æŸ¥å…¶ç±»å‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#keyobject-export-options">keyObject.export([options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°-1">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼-1">è¿”å›å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1">ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#keyobject-equals-otherkeyobject">keyObject.equals(otherKeyObject)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åº”ç”¨åœºæ™¯-1-éªŒè¯ç­¾å">åº”ç”¨åœºæ™¯ 1ï¼šéªŒè¯ç­¾å</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åº”ç”¨åœºæ™¯-2-å®‰å…¨é€šä¿¡">åº”ç”¨åœºæ™¯ 2ï¼šå®‰å…¨é€šä¿¡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åº”ç”¨åœºæ™¯-3-å¯†é’¥ç®¡ç†">åº”ç”¨åœºæ™¯ 3ï¼šå¯†é’¥ç®¡ç†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-ç¤ºä¾‹ä»£ç ">Node.js ç¤ºä¾‹ä»£ç </a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#keyobject-symmetrickeysize">keyObject.symmetricKeySize</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1">ç¤ºä¾‹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#keyobject-type">keyObject.type</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-åˆ›å»ºä¸€ä¸ªå¯¹ç§°å¯†é’¥å¹¶æ£€æŸ¥å…¶ç±»å‹">ä¾‹å­ 1: åˆ›å»ºä¸€ä¸ªå¯¹ç§°å¯†é’¥å¹¶æ£€æŸ¥å…¶ç±»å‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-ç”Ÿæˆä¸€ä¸ªéå¯¹ç§°å¯†é’¥å¯¹å¹¶æ£€æŸ¥å…¶ç±»å‹">ä¾‹å­ 2: ç”Ÿæˆä¸€ä¸ªéå¯¹ç§°å¯†é’¥å¯¹å¹¶æ£€æŸ¥å…¶ç±»å‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-sign">Class: Sign</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ­¥éª¤-1-å¼•å…¥æ‰€éœ€æ¨¡å—">æ­¥éª¤ 1ï¼šå¼•å…¥æ‰€éœ€æ¨¡å—</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ­¥éª¤-2-åˆ›å»ºå¹¶åˆå§‹åŒ–-sign-å¯¹è±¡">æ­¥éª¤ 2ï¼šåˆ›å»ºå¹¶åˆå§‹åŒ– Sign å¯¹è±¡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ­¥éª¤-3-æ·»åŠ æ•°æ®åˆ°ç­¾åå¯¹è±¡">æ­¥éª¤ 3ï¼šæ·»åŠ æ•°æ®åˆ°ç­¾åå¯¹è±¡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ­¥éª¤-4-ç”Ÿæˆç­¾å">æ­¥éª¤ 4ï¼šç”Ÿæˆç­¾å</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ¥æ”¶æ–¹å¦‚ä½•éªŒè¯ç­¾å">æ¥æ”¶æ–¹å¦‚ä½•éªŒè¯ç­¾å</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#sign-sign-privatekey-outputencoding">sign.sign(privateKey[, outputEncoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#sign-update-data-inputencoding">sign.update(data[, inputEncoding])</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-verify">Class: Verify</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ­¥éª¤-1-alice-åˆ›å»ºç­¾å">æ­¥éª¤ 1: Alice åˆ›å»ºç­¾å</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ­¥éª¤-2-alice-å‘-bob-å‘é€æ¶ˆæ¯å’Œç­¾å">æ­¥éª¤ 2: Alice å‘ Bob å‘é€æ¶ˆæ¯å’Œç­¾å</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ­¥éª¤-3-bob-éªŒè¯ç­¾å">æ­¥éª¤ 3: Bob éªŒè¯ç­¾å</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#verify-update-data-inputencoding">verify.update(data[, inputEncoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#verify-update-data-inputencoding-1">verify.update(data[, inputEncoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#verify-verify-object-signature-signatureencoding">verify.verify(object, signature[, signatureEncoding])</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-x509certificate">Class: X509Certificate</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æŸ¥çœ‹è¯ä¹¦ä¿¡æ¯">æŸ¥çœ‹è¯ä¹¦ä¿¡æ¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#éªŒè¯è¯ä¹¦åˆæ³•æ€§">éªŒè¯è¯ä¹¦åˆæ³•æ€§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#new-x509certificate-buffer">new X509Certificate(buffer)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-ä»æ–‡ä»¶åŠ è½½-x-509-è¯ä¹¦">ç¤ºä¾‹ 1: ä»æ–‡ä»¶åŠ è½½ X.509 è¯ä¹¦</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-æ£€æŸ¥è¯ä¹¦æŒ‡çº¹">ç¤ºä¾‹ 2: æ£€æŸ¥è¯ä¹¦æŒ‡çº¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-3-éªŒè¯è¯ä¹¦æœ‰æ•ˆæ€§">ç¤ºä¾‹ 3: éªŒè¯è¯ä¹¦æœ‰æ•ˆæ€§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-ca">x509.ca</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-checkemail-email-options">x509.checkEmail(email[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-checkhost-name-options">x509.checkHost(name[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-checkip-ip">x509.checkIP(ip)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-x509-checkip-ip">å¦‚ä½•ä½¿ç”¨ x509.checkIP(ip)ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-1">å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-checkissued-othercert">x509.checkIssued(otherCert)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-1">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-checkprivatekey-privatekey">x509.checkPrivateKey(privateKey)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å…¬é’¥å’Œç§é’¥">å…¬é’¥å’Œç§é’¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ•°å­—è¯ä¹¦">æ•°å­—è¯ä¹¦</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-checkprivatekey-privatekey-æ–¹æ³•">x509.checkPrivateKey(privateKey) æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ç¤ºä¾‹">ä½¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-fingerprint">x509.fingerprint</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-fingerprint256">x509.fingerprint256</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-fingerprint512">x509.fingerprint512</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x-509-è¯ä¹¦">X.509 è¯ä¹¦</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æŒ‡çº¹-fingerprint">æŒ‡çº¹ï¼ˆFingerprintï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#sha-512">SHA-512</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-infoaccess">x509.infoAccess</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-issuer">x509.issuer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-issuercertificate">x509.issuerCertificate</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ•°å­—è¯ä¹¦å’Œ-x-509">æ•°å­—è¯ä¹¦å’Œ X.509</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¯ä¹¦é“¾">è¯ä¹¦é“¾</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-ä¸­çš„-x509-issuercertificate">Node.js ä¸­çš„ x509.issuerCertificate</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-extkeyusage">x509.extKeyUsage</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-x-509">ä»€ä¹ˆæ˜¯ X.509ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®‰å…¨é€šä¿¡">å®‰å…¨é€šä¿¡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#extended-key-usage-extkeyusage">Extended Key Usage (extKeyUsage)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-1">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-publickey">x509.publicKey</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-raw">x509.raw</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-serialnumber">x509.serialNumber</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-subject">x509.subject</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-1">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-subjectaltname">x509.subjectAltName</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-æ£€æŸ¥è¯ä¹¦çš„æœ‰æ•ˆåŸŸå">ä¾‹å­ 1ï¼šæ£€æŸ¥è¯ä¹¦çš„æœ‰æ•ˆåŸŸå</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-ä½œä¸ºå¥åº·æ£€æŸ¥çš„ä¸€éƒ¨åˆ†">ä¾‹å­ 2ï¼šä½œä¸ºå¥åº·æ£€æŸ¥çš„ä¸€éƒ¨åˆ†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-tojson">x509.toJSON()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-tolegacyobject">x509.toLegacyObject()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-tostring">x509.toString()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-2">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-validfrom">x509.validFrom</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-validto">x509.validTo</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#x509-verify-publickey">x509.verify(publicKey)</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#node-crypto-module-methods-and-properties">node:crypto module methods and properties</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ–¹æ³•">æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å±æ€§">å±æ€§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-constants">crypto.constants</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¸¸é‡çš„ä¾‹å­">å¸¸é‡çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-2">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-fips">crypto.fips</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-fips-çš„ä½œç”¨">crypto.fips çš„ä½œç”¨ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­-1">ä½¿ç”¨ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-checkprime-candidate-options-callback">crypto.checkPrime(candidate[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-checkprimesync-candidate-options">crypto.checkPrimeSync(candidate[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-createcipher-algorithm-password-options">crypto.createCipher(algorithm, password[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-1-åŠ å¯†æ–‡æœ¬">å®ä¾‹ 1ï¼šåŠ å¯†æ–‡æœ¬</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹-2-åŠ å¯†æ–‡ä»¶">å®ä¾‹ 2ï¼šåŠ å¯†æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-createcipheriv-algorithm-key-iv-options">crypto.createCipheriv(algorithm, key, iv[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-createdecipher-algorithm-password-options">crypto.createDecipher(algorithm, password[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-2">å®é™…è¿ç”¨ç¤ºä¾‹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-createdecipheriv-algorithm-key-iv-options">crypto.createDecipheriv(algorithm, key, iv[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-1">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-creatediffiehellman-prime-primeencoding-generator-generatorencoding">crypto.createDiffieHellman(prime[, primeEncoding][, generator][, generatorEncoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-creatediffiehellman-primelength-generator">crypto.createDiffieHellman(primeLength[, generator])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°-2">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨æ­¥éª¤">ä½¿ç”¨æ­¥éª¤</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹ä»£ç -2">ç¤ºä¾‹ä»£ç </a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-creatediffiehellmangroup-name">crypto.createDiffieHellmanGroup(name)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-createecdh-curvename">crypto.createECDH(curveName)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-createecdh-curvename-1">crypto.createECDH(curveName)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨æ­¥éª¤-1">ä½¿ç”¨æ­¥éª¤</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»£ç ç¤ºä¾‹">ä»£ç ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-createhash-algorithm-options">crypto.createHash(algorithm[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-createhmac-algorithm-key-options">crypto.createHmac(algorithm, key[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-createprivatekey-key">crypto.createPrivateKey(key)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-ä½¿ç”¨-pem-æ ¼å¼çš„å¯†é’¥å­—ç¬¦ä¸²">ä¾‹å­ 1: ä½¿ç”¨ PEM æ ¼å¼çš„å¯†é’¥å­—ç¬¦ä¸²</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-ä½¿ç”¨ä»æ–‡ä»¶è¯»å–çš„ç§é’¥">ä¾‹å­ 2: ä½¿ç”¨ä»æ–‡ä»¶è¯»å–çš„ç§é’¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-1">æ³¨æ„äº‹é¡¹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-createpublickey-key">crypto.createPublicKey(key)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-2">å‚æ•°è§£é‡Šï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼-2">è¿”å›å€¼ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-3">å®é™…è¿ç”¨ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-createsecretkey-key-encoding">crypto.createSecretKey(key[, encoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-3">å‚æ•°è§£é‡Šï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼-3">è¿”å›å€¼ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-3">å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-createsign-algorithm-options">crypto.createSign(algorithm[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-createsign-algorithm-options-ç®€ä»‹">crypto.createSign(algorithm[, options])ç®€ä»‹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç­¾åè¿‡ç¨‹çš„åŸºæœ¬æ­¥éª¤">ç­¾åè¿‡ç¨‹çš„åŸºæœ¬æ­¥éª¤ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2">ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-createverify-algorithm-options">crypto.createVerify(algorithm[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-diffiehellman-options">crypto.diffieHellman(options)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-hash-algorith-data-outputencoding">crypto.hash(algorith, data[, outputEncoding])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-4">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ç¤ºä¾‹-1">ä½¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„ç‚¹">æ³¨æ„ç‚¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-generatekey-type-options-callback">crypto.generateKey(type, options, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯´æ˜-1">å‚æ•°è¯´æ˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ç¤ºä¾‹-2">ä½¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-generatekeypair-type-options-callback">crypto.generateKeyPair(type, options, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-generatekeypairsync-type-options">crypto.generateKeyPairSync(type, options)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°-3">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¸¸è§ç”¨æ³•">å¸¸è§ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-generatekeysync-type-options">crypto.generateKeySync(type, options)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯¦è§£">å‚æ•°è¯¦è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼-4">è¿”å›å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­-2">ä½¿ç”¨ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨åœºæ™¯">å®é™…åº”ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-generateprime-size-options-callback">crypto.generatePrime(size[, options[, callback]])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‡½æ•°å‚æ•°è¯´æ˜">å‡½æ•°å‚æ•°è¯´æ˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‡½æ•°ä½¿ç”¨ä¾‹å­">å‡½æ•°ä½¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨">å®é™…åº”ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-generateprimesync-size-options">crypto.generatePrimeSync(size[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-ç”Ÿæˆä¸€ä¸ª-1024-ä½çš„è´¨æ•°">ç¤ºä¾‹ 1ï¼šç”Ÿæˆä¸€ä¸ª 1024 ä½çš„è´¨æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-ç”Ÿæˆä¸€ä¸ª-512-ä½çš„å®‰å…¨è´¨æ•°">ç¤ºä¾‹ 2ï¼šç”Ÿæˆä¸€ä¸ª 512 ä½çš„å®‰å…¨è´¨æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-3-ç”Ÿæˆä¸€ä¸ªæ»¡è¶³ç‰¹å®šæ¡ä»¶çš„è´¨æ•°">ç¤ºä¾‹ 3ï¼šç”Ÿæˆä¸€ä¸ªæ»¡è¶³ç‰¹å®šæ¡ä»¶çš„è´¨æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-getcipherinfo-nameornid-options">crypto.getCipherInfo(nameOrNid[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-getciphers">crypto.getCiphers()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-getcurves">crypto.getCurves()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-getdiffiehellman-groupname">crypto.getDiffieHellman(groupName)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-getfips">crypto.getFips()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-gethashes">crypto.getHashes()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨crypto-gethashes">å¦‚ä½•ä½¿ç”¨crypto.getHashes()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-2">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-getrandomvalues-typedarray">crypto.getRandomValues(typedArray)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-ç”Ÿæˆä¸€ä¸ªéšæœºçš„-token">ä¾‹å­ 1ï¼šç”Ÿæˆä¸€ä¸ªéšæœºçš„ token</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-æŠ•æ·éª°å­">ä¾‹å­ 2ï¼šæŠ•æ·éª°å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-3-åˆ›å»ºéšæœºå¯†ç ">ä¾‹å­ 3ï¼šåˆ›å»ºéšæœºå¯†ç </a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-hkdf-digest-ikm-salt-info-keylen-callback">crypto.hkdf(digest, ikm, salt, info, keylen, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-hkdfsync-digest-ikm-salt-info-keylen">crypto.hkdfSync(digest, ikm, salt, info, keylen)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-hkdf">ä»€ä¹ˆæ˜¯ HKDFï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-hkdfsync-å‡½æ•°çš„ä½œç”¨">crypto.hkdfSync å‡½æ•°çš„ä½œç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­-3">ä½¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-2">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-pbkdf2-password-salt-iterations-keylen-digest-callback">crypto.pbkdf2(password, salt, iterations, keylen, digest, callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-pbkdf2sync-password-salt-iterations-keylen-digest">crypto.pbkdf2Sync(password, salt, iterations, keylen, digest)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-5">å‚æ•°è§£é‡Šï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ç¤ºä¾‹-3">ä½¿ç”¨ç¤ºä¾‹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-privatedecrypt-privatekey-buffer">crypto.privateDecrypt(privateKey, buffer)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-privatedecrypt-privatekey-buffer-è§£é‡Š">crypto.privateDecrypt(privateKey, buffer) è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-4">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-privateencrypt-privatekey-buffer">crypto.privateEncrypt(privateKey, buffer)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç”Ÿæˆå¯†é’¥å¯¹çš„ç¤ºä¾‹ä»£ç ">ç”Ÿæˆå¯†é’¥å¯¹çš„ç¤ºä¾‹ä»£ç </a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŠ å¯†æ¶ˆæ¯çš„ä»£ç ç¤ºä¾‹">åŠ å¯†æ¶ˆæ¯çš„ä»£ç ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£å¯†æ¶ˆæ¯çš„ä»£ç ç¤ºä¾‹">è§£å¯†æ¶ˆæ¯çš„ä»£ç ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-publicdecrypt-key-buffer">crypto.publicDecrypt(key, buffer)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-6">å‚æ•°è§£é‡Šï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å·¥ä½œåŸç†">å·¥ä½œåŸç†ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-3">å®é™…åº”ç”¨ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-publicencrypt-key-buffer">crypto.publicEncrypt(key, buffer)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-7">å‚æ•°è§£é‡Šï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼-5">è¿”å›å€¼ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­-4">ä½¿ç”¨ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®‰å…¨è€ƒè™‘">å®‰å…¨è€ƒè™‘ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-randombytes-size-callback">crypto.randomBytes(size[, callback])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-8">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨æ–¹å¼">ä½¿ç”¨æ–¹å¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åº”ç”¨å®ä¾‹">åº”ç”¨å®ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-randomfillsync-buffer-offset-size">crypto.randomFillSync(buffer[, offset][, size])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-randomfillsync-buffer-offset-size-1">crypto.randomFillSync(buffer[, offset][, size])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-randomfill-buffer-offset-size-callback">crypto.randomFill(buffer[, offset][, size], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-randomint-min-max-callback">crypto.randomInt([min, ]max[, callback])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-9">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼-6">è¿”å›å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-3">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-randomuuid-options">crypto.randomUUID([options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬ç”¨æ³•">åŸºæœ¬ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#options-å‚æ•°">options å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-4">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-scrypt-password-salt-keylen-options-callback">crypto.scrypt(password, salt, keylen[, options], callback)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-scryptsync-password-salt-keylen-options">crypto.scryptSync(password, salt, keylen[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1-åŸºæœ¬å¯†ç æ´¾ç”Ÿ">ç¤ºä¾‹ 1ï¼šåŸºæœ¬å¯†ç æ´¾ç”Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2-ä½¿ç”¨-options-å‚æ•°">ç¤ºä¾‹ 2ï¼šä½¿ç”¨ options å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-secureheapused">crypto.secureHeapUsed()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-setengine-engine-flags">crypto.setEngine(engine[, flags])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-setfips-bool">crypto.setFips(bool)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-crypto-setfips-bool">ä½¿ç”¨ crypto.setFips(bool)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-3">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-5">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-sign-algorithm-data-key-callback">crypto.sign(algorithm, data, key[, callback])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-crypto-sign">è§£é‡Š crypto.sign()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-4">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-subtle">crypto.subtle</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-timingsafeequal-a-b">crypto.timingSafeEqual(a, b)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-1-æ¯”è¾ƒå¯†ç çš„å“ˆå¸Œå€¼">å®é™…ä¾‹å­ 1ï¼šæ¯”è¾ƒå¯†ç çš„å“ˆå¸Œå€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-2-æ¯”è¾ƒä»¤ç‰Œæˆ–è€…å¯†é’¥">å®é™…ä¾‹å­ 2ï¼šæ¯”è¾ƒä»¤ç‰Œæˆ–è€…å¯†é’¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-verify-algorithm-data-key-signature-callback">crypto.verify(algorithm, data, key, signature[, callback])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-6">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#crypto-webcrypto">crypto.webcrypto</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#notes">Notes</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-å¯†é’¥å’Œè¯ä¹¦ç¼–ç ">1. å¯†é’¥å’Œè¯ä¹¦ç¼–ç ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-çº¿ç¨‹å®‰å…¨æ€§">2. çº¿ç¨‹å®‰å…¨æ€§ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-åŠ å¯†ç®—æ³•çš„é€‰æ‹©">3. åŠ å¯†ç®—æ³•çš„é€‰æ‹©ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-3">å®é™…ä¾‹å­ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#using-strings-as-inputs-to-cryptographic-apis">Using strings as inputs to cryptographic APIs</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#legacy-streams-api-prior-to-node-js-0-10">Legacy streams API (prior to Node.js 0.10)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯æµ-streams">ä»€ä¹ˆæ˜¯æµï¼ˆStreamsï¼‰ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-ä¸­é—ç•™æµ-api-çš„é—®é¢˜">Node.js ä¸­é—ç•™æµ API çš„é—®é¢˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-æµçš„å®é™…è¿ç”¨ä¾‹å­">Node.js æµçš„å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#support-for-weak-or-compromised-algorithms">Support for weak or compromised algorithms</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹">å®ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ccm-mode">CCM mode</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-5">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#fips-mode">FIPS mode</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#crypto-constants-1">Crypto constants</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ•£åˆ—-hashing">æ•£åˆ—ï¼ˆHashingï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŠ å¯†-encryption">åŠ å¯†ï¼ˆEncryptionï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¯†é’¥å’Œè¯ä¹¦">å¯†é’¥å’Œè¯ä¹¦</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#openssl-options">OpenSSL options</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#openssl-engine-constants">OpenSSL engine constants</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#other-openssl-constants">Other OpenSSL constants</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-crypto-constants">Node.js crypto constants</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-1-ç”Ÿæˆæ•£åˆ—å€¼">ä¾‹å­ 1ï¼šç”Ÿæˆæ•£åˆ—å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-2-ä½¿ç”¨-rsa-å…¬é’¥åŠ å¯†æ•°æ®">ä¾‹å­ 2ï¼šä½¿ç”¨ RSA å…¬é’¥åŠ å¯†æ•°æ®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¾‹å­-3-è®¾ç½®-tls-ssl-æ–¹æ³•">ä¾‹å­ 3ï¼šè®¾ç½® TLS/SSL æ–¹æ³•</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="crypto" tabindex="-1"><a class="header-anchor" href="#crypto"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#crypto" target="_blank" rel="noopener noreferrer">Crypto</a></span></a></h1><p>Node.js ä¸­çš„ <code>crypto</code> æ¨¡å—æ˜¯ä¸€ä¸ªæä¾›åŠ å¯†åŠŸèƒ½çš„å†…ç½®åº“ï¼ŒåŒ…æ‹¬å„ç§åŠ å¯†ç®—æ³•ï¼Œå¦‚å“ˆå¸Œã€HMACã€åŠ å¯†ã€è§£å¯†ã€ç­¾åå’ŒéªŒè¯ç­‰åŠŸèƒ½ã€‚åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œè¯¥æ¨¡å—ç»§ç»­ä½œä¸ºæ ¸å¿ƒçš„ä¸€éƒ¨åˆ†å­˜åœ¨ã€‚ä½¿ç”¨ <code>crypto</code> æ¨¡å—å¯ä»¥å¸®åŠ©ä½ å®Œæˆæ•°æ®çš„å®‰å…¨ä¼ è¾“ã€æ–‡ä»¶æ ¡éªŒã€å¯†ç å­˜å‚¨ç­‰ä»»åŠ¡ã€‚</p><p>ä¸‹é¢æˆ‘ä¼šè¯¦ç»†è§£é‡Šå‡ ä¸ª <code>crypto</code> æ¨¡å—çš„å¸¸è§ç”¨é€”ï¼Œå¹¶ç»™å‡ºå®é™…çš„ç¤ºä¾‹ä»£ç ã€‚</p><h3 id="å“ˆå¸Œ-hashing" tabindex="-1"><a class="header-anchor" href="#å“ˆå¸Œ-hashing"><span>å“ˆå¸Œï¼ˆHashingï¼‰</span></a></h3><p>å“ˆå¸Œæ˜¯å°†ä»»æ„é•¿åº¦çš„è¾“å…¥ï¼ˆåˆç§°ä¸ºæ¶ˆæ¯ï¼‰é€šè¿‡å“ˆå¸Œç®—æ³•è½¬æ¢æˆå›ºå®šé•¿åº¦è¾“å‡ºçš„è¿‡ç¨‹ã€‚è¿™ä¸ªè¾“å‡ºç§°ä¸ºå“ˆå¸Œå€¼ï¼Œé€šå¸¸ç”¨äºå¿«é€Ÿæ•°æ®æ£€ç´¢ã€æ•°æ®æ ¡éªŒå’Œå¯†ç å­˜å‚¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¡ç®—å¹¶æ‰“å° &#39;hello world&#39; çš„ SHA-256 å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hello world&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="hmac-å“ˆå¸Œæ¶ˆæ¯è®¤è¯ç " tabindex="-1"><a class="header-anchor" href="#hmac-å“ˆå¸Œæ¶ˆæ¯è®¤è¯ç "><span>HMACï¼ˆå“ˆå¸Œæ¶ˆæ¯è®¤è¯ç ï¼‰</span></a></h3><p>HMAC æ˜¯ä¸€ç§åŸºäºå¯†é’¥çš„å“ˆå¸Œç®—æ³•è®¤è¯æŠ€æœ¯ï¼Œä¸ä»…ä¾èµ–äºåŸå§‹æ•°æ®ï¼Œè¿˜ä¾èµ–äºç§˜é’¥ï¼Œè¿™æ„å‘³ç€å³ä½¿ä¸¤ä¸ªä¸åŒçš„æ¶ˆæ¯å…·æœ‰ç›¸åŒçš„å“ˆå¸Œå€¼ï¼Œå¦‚æœå®ƒä»¬æœ‰ä¸åŒçš„ç§˜é’¥ï¼Œå®ƒä»¬çš„ HMAC ä¹Ÿä¼šä¸åŒã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»º HMAC å¹¶æ‰“å°ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;a secret key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;some data to hash&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åŠ å¯†ä¸è§£å¯†" tabindex="-1"><a class="header-anchor" href="#åŠ å¯†ä¸è§£å¯†"><span>åŠ å¯†ä¸è§£å¯†</span></a></h3><p><code>crypto</code> æ¨¡å—ä¹Ÿæ”¯æŒæ•°æ®çš„åŠ å¯†å’Œè§£å¯†ï¼Œå¯ä»¥ä¿æŠ¤ä¿¡æ¯ä¸è¢«æœªç»æˆæƒçš„è®¿é—®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®åŠ å¯†ç®—æ³•å’Œç§˜é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> algorithm</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;aes-192-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> password</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;a very strong password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">scryptSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;salt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">24</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ scrypt æ–¹æ³•ä»å¯†ç ç”Ÿæˆç§˜é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆå§‹åŒ–å‘é‡</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŠ å¯†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">algorithm</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;some clear text data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Encrypted: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è§£å¯†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDecipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">algorithm</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> decrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Decrypted: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decrypted</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ•°å­—ç­¾åä¸éªŒè¯" tabindex="-1"><a class="header-anchor" href="#æ•°å­—ç­¾åä¸éªŒè¯"><span>æ•°å­—ç­¾åä¸éªŒè¯</span></a></h3><p>æ•°å­—ç­¾åç”¨äºéªŒè¯æ¶ˆæ¯çš„å®Œæ•´æ€§å’Œæ¥æºï¼Œè€ŒéªŒè¯åˆ™ç›¸å¯¹åœ°ç¡®è®¤ç­¾åæ˜¯å¦æœ‰æ•ˆã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆå…¬ç§é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;data to sign&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç­¾å</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createSign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">signer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> signer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// éªŒè¯ç­¾å</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> verifier</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createVerify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">verifier</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> verified</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> verifier</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">verify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">signature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Signature Verified: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">verified</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šæ˜¯ <code>crypto</code> æ¨¡å—ä¸­ä¸€äº›å¸¸è§ç”¨é€”çš„ä¾‹å­ã€‚æ¯ä¸ªä¾‹å­éƒ½å±•ç¤ºäº†æ¨¡å—åŠŸèƒ½çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ï¼Œä½†è¯·æ³¨æ„åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½éœ€è¦æ›´å¤æ‚çš„é”™è¯¯å¤„ç†ã€å¯†é’¥ç®¡ç†å’Œå®‰å…¨è€ƒè™‘ã€‚</p><h2 id="determining-if-crypto-support-is-unavailable" tabindex="-1"><a class="header-anchor" href="#determining-if-crypto-support-is-unavailable"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#determining-if-crypto-support-is-unavailable" target="_blank" rel="noopener noreferrer">Determining if crypto support is unavailable</a></span></a></h2><p>å¥½çš„ï¼Œé¦–å…ˆè®©æˆ‘ä»¬æ˜ç¡®ä¸€ä¸‹ä»€ä¹ˆæ˜¯ Node.js å’Œ crypto æ¨¡å—ã€‚</p><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚è€Œ crypto æ¨¡å—æ˜¯ Node.js çš„ä¸€ä¸ªå†…ç½®æ¨¡å—ï¼Œæä¾›äº†åŒ…æ‹¬åŠ å¯†ã€è§£å¯†ã€ç­¾åå’ŒéªŒè¯ç­‰å¤šç§å®‰å…¨ç›¸å…³åŠŸèƒ½ã€‚</p><p>æœ‰æ—¶å€™ï¼Œç”±äºä¸åŒçš„åŸå› ï¼ˆæ¯”å¦‚æ”¿ç­–é™åˆ¶æˆ–è€…ç¼–è¯‘æ—¶æ²¡æœ‰åŒ…å« OpenSSLï¼‰ï¼ŒNode.js å¯èƒ½ä¼šè¢«æ„å»ºæˆä¸æ”¯æŒæŸäº›æˆ–å…¨éƒ¨åŠ å¯†åŠŸèƒ½çš„ç‰ˆæœ¬ã€‚è¿™æ—¶ï¼Œå¦‚æœä½ çš„åº”ç”¨ç¨‹åºä¾èµ–äºè¿™äº›åŠ å¯†åŠŸèƒ½ï¼Œå°±éœ€è¦æœ‰ä¸€ç§æ–¹æ³•æ¥æ£€æµ‹å½“å‰çš„ Node.js ç¯å¢ƒæ˜¯å¦æ”¯æŒ crypto æ¨¡å—ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œç¡®å®š crypto æ”¯æŒæ˜¯å¦ä¸å¯ç”¨å¯ä»¥é€šè¿‡ç®€å•åœ°å°è¯•å¼•å…¥ crypto æ¨¡å—å¹¶æ•è·å¯èƒ½å‡ºç°çš„é”™è¯¯æ¥å®ç°ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå¦‚ä½•åˆ¤æ–­ crypto æ¨¡å—æ˜¯å¦å¯ç”¨çš„ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å°è¯•å¼•å…¥ crypto æ¨¡å—</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¦‚æœå‡ºé”™ï¼Œåˆ™è¡¨ç¤º crypto æ¨¡å—ä¸å¯ç”¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Crypto support is unavailable:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç»ˆæ­¢ç¨‹åº</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœæ²¡å‡ºé”™ï¼Œä»¥ä¸‹ä»£ç å°†æ­£å¸¸æ‰§è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Crypto module is available&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½ å¯ä»¥ç»§ç»­ä½¿ç”¨ crypto æ¨¡å—çš„åŠŸèƒ½è¿›è¡ŒåŠ å¯†è§£å¯†æ“ä½œ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>require(&#39;crypto&#39;)</code> å°è¯•åŠ è½½ crypto æ¨¡å—ã€‚å¦‚æœæ¨¡å—åŠ è½½æˆåŠŸï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å®‰å…¨åœ°å‡è®¾åé¢çš„ä»£ç å¯ä»¥ä½¿ç”¨ crypto çš„åŠŸèƒ½ã€‚å¦‚æœåŠ è½½å¤±è´¥ï¼Œåˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå¹¶è¿›å…¥ <code>catch</code> ä»£ç å—ã€‚åœ¨æ­¤å—ä¸­ï¼Œæˆ‘ä»¬æ‰“å°å‡ºä¸€ä¸ªé”™è¯¯æ¶ˆæ¯ï¼Œå¹¶é€€å‡ºç¨‹åºã€‚</p><p>ä¸¾å‡ ä¸ªå®é™…çš„è¿ç”¨ä¾‹å­ï¼š</p><ol><li>åŠ å¯†ç”¨æˆ·å¯†ç ï¼šå¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦ç”¨æˆ·ç™»é™†çš„åº”ç”¨ï¼Œä½ å¯èƒ½éœ€è¦å¯¹ç”¨æˆ·çš„å¯†ç è¿›è¡Œå“ˆå¸Œå¤„ç†ä»¥å®‰å…¨åœ°å­˜å‚¨å®ƒä»¬ã€‚crypto æ¨¡å—å¯ä»¥ç”¨æ¥ç”Ÿæˆå¯†ç çš„å“ˆå¸Œå€¼ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;user-password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå¯†ç çš„å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>ç”Ÿæˆå®‰å…¨çš„éšæœºæ•°ï¼šå¦‚æœä½ éœ€è¦ç”Ÿæˆä¸€ä¸ªå®‰å…¨çš„ä¼šè¯æ ‡è¯†ç¬¦ï¼ˆsession IDï¼‰æˆ–è€…å…¶ä»–éšæœºå€¼ï¼Œå¯ä»¥ä½¿ç”¨ crypto æ¨¡å—çš„éšæœºå­—èŠ‚ç”Ÿæˆå™¨ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¤„ç†å¯èƒ½å‡ºç°çš„é”™è¯¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> token</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">token</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå®‰å…¨çš„éšæœºå€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>åŠ å¯†æ•°æ®ä¼ è¾“ï¼šå¦‚æœä½ çš„åº”ç”¨æ¶‰åŠæ•æ„Ÿæ•°æ®çš„ä¼ è¾“ï¼Œä½ å¯ä»¥ä½¿ç”¨ crypto æ¨¡å—æ¥åŠ å¯†å’Œè§£å¯†æ•°æ®ï¼Œç¡®ä¿ä¼ è¾“è¿‡ç¨‹ä¸­æ•°æ®çš„å®‰å…¨ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> algorithm</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;aes-256-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> encrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">algorithm</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">concat</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()]);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encryptedData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encryptedData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> encrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Confidential data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encryptedData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æ‰€æœ‰è¿™äº›ä¾‹å­ä¸­ï¼Œå¦‚æœ crypto æ¨¡å—ä¸å¯ç”¨ï¼Œç¨‹åºå°†è¾“å‡ºä¸€ä¸ªé”™è¯¯æ¶ˆæ¯å¹¶ç»ˆæ­¢ã€‚å¦‚æœå¯ç”¨ï¼Œç¨‹åºåˆ™ä¼šç»§ç»­æ‰§è¡Œå„ç§åŠ å¯†æ“ä½œã€‚</p><h2 id="class-certificate" tabindex="-1"><a class="header-anchor" href="#class-certificate"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#class-certificate" target="_blank" rel="noopener noreferrer">Class: Certificate</a></span></a></h2><p>Node.js ä¸­çš„ <code>Certificate</code> æ˜¯ä¸€ä¸ªå±äº <code>crypto</code> æ¨¡å—çš„ç±»ï¼Œå®ƒæä¾›äº†ä¸€äº›æ–¹æ³•æ¥å¤„ç† X.509 è¯ä¹¦ã€‚X.509 æ˜¯ä¸€ç§éå¸¸æ™®éçš„æ•°å­—è¯ä¹¦æ ‡å‡†ï¼Œç”¨äºåœ¨ç½‘ç»œä¸Šå»ºç«‹ä¸€ä¸ªå®ä½“ï¼ˆæ¯”å¦‚ä¸€ä¸ªäººã€æœåŠ¡å™¨æˆ–è€…ç»„ç»‡ï¼‰çš„èº«ä»½ã€‚</p><p>åœ¨è¿™é‡Œæˆ‘ä»¬ä¸ä¼šæ·±å…¥åˆ° X.509 è¯ä¹¦çš„å…·ä½“æŠ€æœ¯ç»†èŠ‚ä¸­ï¼Œè€Œæ˜¯ä¼šè§£é‡Šåœ¨ Node.js ä¸­å¦‚ä½•ä½¿ç”¨ <code>Certificate</code> ç±»ä»¥åŠæä¾›å‡ ä¸ªç®€å•çš„ä¾‹å­ã€‚</p><h3 id="ä½¿ç”¨-certificate-ç±»" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-certificate-ç±»"><span>ä½¿ç”¨ Certificate ç±»</span></a></h3><p>é¦–å…ˆï¼Œä½ éœ€è¦çŸ¥é“çš„æ˜¯ <code>crypto</code> æ¨¡å—æ˜¯ Node.js çš„å†…ç½®æ¨¡å—ï¼Œå› æ­¤æ— éœ€é¢å¤–å®‰è£…ã€‚è¦ä½¿ç”¨ <code>Certificate</code> ç±»ï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å¯¼å…¥å¹¶åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ <code>Certificate</code> ç±»ä¸­çš„ä¸€äº›æ–¹æ³•å’Œå¦‚ä½•ä½¿ç”¨å®ƒä»¬ã€‚</p><h4 id="_1-cert-exportchallenge-spkac" tabindex="-1"><a class="header-anchor" href="#_1-cert-exportchallenge-spkac"><span>1. <code>cert.exportChallenge(spkac)</code></span></a></h4><p>è¿™ä¸ªæ–¹æ³•å¯ä»¥ä»ä¸€ä¸ª <code>SPKAC</code> (Signed Public Key and Challenge) æ•°æ®ç»“æ„ä¸­æå–â€œchallengeâ€éƒ¨åˆ†ï¼Œé€šå¸¸åœ¨åˆ›å»ºç½‘é¡µè¯ä¹¦æ—¶ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œå½“ç”¨æˆ·æƒ³è¦ç”Ÿæˆä¸€ä¸ªæ–°çš„æµè§ˆå™¨è¯ä¹¦æ—¶ï¼Œä»–ä»¬ä¼šæäº¤ä¸€ä¸ª SPKAC è‡³æœåŠ¡å™¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æœ‰ä¸€ä¸ªä»å®¢æˆ·ç«¯æ¥æ”¶åˆ°çš„ SPKAC å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> spkacString</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getSPKACSomehow</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™ä¸ªå‡½æ•°å‡è®¾ä»æŸä¸ªåœ°æ–¹è·å¾—äº†SPKACæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> challenge</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exportChallenge</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">spkacString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">challenge</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡º challenge</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-cert-exportpublickey-spkac" tabindex="-1"><a class="header-anchor" href="#_2-cert-exportpublickey-spkac"><span>2. <code>cert.exportPublicKey(spkac)</code></span></a></h4><p>è¿™ä¸ªæ–¹æ³•å¯ä»¥ä» <code>SPKAC</code> æ•°æ®ç»“æ„ä¸­æå–å…¬é’¥ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exportPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">spkacString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºå…¬é’¥</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-cert-verifyspkac-spkac" tabindex="-1"><a class="header-anchor" href="#_3-cert-verifyspkac-spkac"><span>3. <code>cert.verifySpkac(spkac)</code></span></a></h4><p>è¿™ä¸ªæ–¹æ³•ç”¨äºéªŒè¯ <code>SPKAC</code> æ•°æ®çš„æœ‰æ•ˆæ€§ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> isVerified</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">verifySpkac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">spkacString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isVerified</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœ SPKAC æœ‰æ•ˆï¼Œå°†æ‰“å° trueï¼›å¦åˆ™æ‰“å° false</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å®é™…åº”ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h4><p>åœ¨çœŸå®çš„åº”ç”¨ç¯å¢ƒä¸­ï¼Œ<code>Certificate</code> ç±»çš„åº”ç”¨åœºæ™¯å¯èƒ½åŒ…æ‹¬ï¼š</p><ul><li><strong>SSL/TLS å®‰å…¨</strong>ï¼šNode.js æœåŠ¡å™¨ä½¿ç”¨ SSL/TLS åè®®ä¿è¯å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡å®‰å…¨æ—¶ï¼Œä¼šæ¶‰åŠåˆ°è¯ä¹¦çš„å¤„ç†ã€‚åˆ›å»º HTTPS æœåŠ¡å™¨æ—¶ï¼Œä½ éœ€è¦åŠ è½½å¹¶ä½¿ç”¨ SSL è¯ä¹¦ã€‚</li><li><strong>ç”¨æˆ·è®¤è¯</strong>ï¼šç³»ç»Ÿå¯èƒ½éœ€è¦éªŒè¯ç”¨æˆ·æä¾›çš„è¯ä¹¦æ¥å…è®¸å…¶è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚</li><li><strong>ç­¾åéªŒè¯</strong>ï¼šåœ¨æ–‡ä»¶ä¼ è¾“æˆ–æ¶ˆæ¯å‘é€è¿‡ç¨‹ä¸­ï¼Œè¯ä¹¦å¯ä»¥ç”¨æ¥å¯¹æ•°æ®è¿›è¡Œç­¾ååŠéªŒè¯ç­¾åï¼Œç¡®ä¿æ•°æ®ä¼ è¾“çš„å®‰å…¨æ€§å’Œå®Œæ•´æ€§ã€‚</li></ul><p>è¯·æ³¨æ„ï¼Œè™½ç„¶ <code>Certificate</code> ç±»åœ¨ Node.js ä¸­å¯ç”¨ï¼Œä½†åœ¨å®é™…çš„ç”Ÿäº§ç¯å¢ƒä¸­å¤„ç†è¯ä¹¦ç›¸å…³çš„åŠŸèƒ½æ—¶ï¼Œä½ å¾ˆå¯èƒ½ä¼šä½¿ç”¨æ›´é«˜çº§çš„åº“æˆ–è€…æ¡†æ¶ï¼Œå› ä¸ºå®ƒä»¬æä¾›äº†æ›´å®Œå–„çš„å·¥å…·å’Œå®‰å…¨æœºåˆ¶ã€‚</p><h3 id="static-method-certificate-exportchallenge-spkac-encoding" tabindex="-1"><a class="header-anchor" href="#static-method-certificate-exportchallenge-spkac-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#static-method-certificateexportchallengespkac-encoding" target="_blank" rel="noopener noreferrer">Static method: Certificate.exportChallenge(spkac[, encoding])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­ <code>Certificate.exportChallenge</code> è¿™ä¸ªé™æ€æ–¹æ³•çš„ä½œç”¨ä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒã€‚</p><p>é¦–å…ˆï¼Œ<code>Certificate</code> æ˜¯ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸­ä¸€ä¸ªä¸è¯ä¹¦ç›¸å…³çš„ç±»ã€‚è¿™ä¸ªç±»ä¸»è¦ç”¨äºå¤„ç†ä¸åŠ å¯†è¯ä¹¦ç›¸å…³çš„æ“ä½œï¼Œæ¯”å¦‚ç”Ÿæˆã€éªŒè¯ç­‰ã€‚</p><p><code>exportChallenge</code> è¿™ä¸ªæ–¹æ³•ä¸»è¦æ˜¯ç”¨æ¥ä»ä¸€ä¸ªæ‰€è°“çš„ SPKAC (Signed Public Key and Challenge) æ•°æ®ç»“æ„ä¸­æå– challenge å­—ç¬¦ä¸²ã€‚SPKAC æ˜¯åœ¨å®¢æˆ·ç«¯åˆ›å»ºæ–°çš„ç½‘ç»œè¯ä¹¦è¯·æ±‚æ—¶ç”Ÿæˆçš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œé€šå¸¸åŒ…å«äº†ç”¨æˆ·çš„å…¬é’¥ä»¥åŠä¸€ä¸ªå•æ¬¡çš„æŒ‘æˆ˜å­—ç¬¦ä¸²ï¼ˆchallengeï¼‰ï¼Œè¿™ä¸ªæŒ‘æˆ˜å­—ç¬¦ä¸²ä¼šåœ¨åˆ›å»ºè¯·æ±‚æ—¶ç”±æµè§ˆå™¨ç”Ÿæˆï¼Œå¹¶ä¸”éœ€è¦è¢«è®¤è¯æœºæ„ï¼ˆCAï¼‰åœ¨ç­¾å‘è¯ä¹¦å‰éªŒè¯ã€‚</p><p>è¿™é‡Œçš„ <code>encoding</code> å‚æ•°æ˜¯ä¸€ä¸ªå¯é€‰é¡¹ï¼Œç”¨äºæŒ‡å®šè¿”å›å€¼çš„ç¼–ç æ ¼å¼ã€‚å¦‚æœä½ ä¸æŒ‡å®š <code>encoding</code> å‚æ•°ï¼Œé‚£ä¹ˆé»˜è®¤ä¼šä»¥ä¸€ä¸ª <code>Buffer</code> å¯¹è±¡çš„å½¢å¼è¿”å› challenge å­—ç¬¦ä¸²çš„äºŒè¿›åˆ¶æ•°æ®ã€‚<code>Buffer</code> æ˜¯ Node.js ä¸­ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ç±»ã€‚å¦‚æœä½ ä¼ å…¥ <code>encoding</code>ï¼Œæ¯”å¦‚ <code>&#39;utf8&#39;</code> æˆ– <code>&#39;base64&#39;</code>ï¼Œé‚£ä¹ˆä¼šè¿”å›å¯¹åº”ç¼–ç çš„å­—ç¬¦ä¸²ã€‚</p><p>ç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼š</p><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªæ¥è‡ªå®¢æˆ·ç«¯çš„ SPKAC æ•°æ®ï¼Œä½ éœ€è¦åœ¨æœåŠ¡å™¨ç«¯éªŒè¯è¿™ä¸ª SPKAC å¹¶æå–å…¶ä¸­çš„ challenge å­—ç¬¦ä¸²ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ spkac æ˜¯ä¸€ä¸ªä»å®¢æˆ·ç«¯å‘é€åˆ°æœåŠ¡å™¨çš„ SPKAC æ•°æ®ã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> spkac</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getSpkacFromClient</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œçš„ getSpkacFromClient() åªæ˜¯ä¸€ä¸ªç¤ºä¾‹å‡½æ•°å</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ Certificate ç±»çš„ exportChallenge æ–¹æ³•æå– challenge</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> challenge</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exportChallenge</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">spkac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœä½ å¸Œæœ›å¾—åˆ° UTF-8 ç¼–ç çš„å­—ç¬¦ä¸²è€Œä¸æ˜¯ Bufferï¼Œå¯ä»¥è¿™æ ·åšï¼š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> utf8Challenge</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exportChallenge</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">spkac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">challenge</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º challenge çš„ Buffer å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">utf8Challenge</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º UTF-8 ç¼–ç çš„ challenge å­—ç¬¦ä¸²</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>getSpkacFromClient</code> åº”è¯¥æ˜¯ä½ å®šä¹‰çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒä»å®¢æˆ·ç«¯æ¥æ”¶ SPKAC æ•°æ®ã€‚ç„¶åï¼Œæˆ‘ä»¬è°ƒç”¨ <code>Certificate.exportChallenge</code> æ–¹æ³•ï¼Œæ— å‚æ•°è°ƒç”¨ä¼šå¾—åˆ°ä¸€ä¸ª <code>Buffer</code> å¯¹è±¡ï¼Œè€ŒæŒ‡å®š <code>&#39;utf8&#39;</code> ç¼–ç ä¼šå¾—åˆ°ä¸€ä¸ª UTF-8 æ ¼å¼çš„å­—ç¬¦ä¸²ã€‚</p><p>è¿™ä¸ªæ–¹æ³•åœ¨å®é™…åº”ç”¨ä¸­å¯èƒ½ç”¨äºç½‘ç«™æˆ–åº”ç”¨ä¸­çš„è¯ä¹¦ç­¾å‘æµç¨‹ï¼Œå°¤å…¶æ˜¯å½“ä½ éœ€è¦å¤„ç†ç”¨æˆ·é€šè¿‡æµè§ˆå™¨ç”Ÿæˆçš„è¯ä¹¦ç­¾åè¯·æ±‚æ—¶ã€‚å®ƒèƒ½å¤Ÿå¸®åŠ©ä½ éªŒè¯ç”¨æˆ·æ˜¯å¦æŒæœ‰ç›¸åº”çš„ç§é’¥ï¼Œå› ä¸ºåªæœ‰çŸ¥é“åŸå§‹æŒ‘æˆ˜å­—ç¬¦ä¸²å’Œç§é’¥çš„ç”¨æˆ·æ‰èƒ½ç”Ÿæˆæœ‰æ•ˆçš„ SPKAC æ•°æ®ã€‚</p><h3 id="static-method-certificate-exportpublickey-spkac-encoding" tabindex="-1"><a class="header-anchor" href="#static-method-certificate-exportpublickey-spkac-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#static-method-certificateexportpublickeyspkac-encoding" target="_blank" rel="noopener noreferrer">Static method: Certificate.exportPublicKey(spkac[, encoding])</a></span></a></h3><p>Node.js çš„<code>crypto</code>æ¨¡å—æä¾›äº†åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¤„ç†è¯ä¹¦ç›¸å…³çš„ä¸€ç³»åˆ—æ–¹æ³•ã€‚åœ¨è¿™ä¸ªæ¨¡å—ä¸­ï¼Œæœ‰ä¸€ä¸ªé™æ€æ–¹æ³•å«ä½œ<code>Certificate.exportPublicKey(spkac[, encoding])</code>ã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥ä» SPKAC æ•°æ®ç»“æ„ä¸­å¯¼å‡ºå…¬é’¥ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥è§£é‡Šä¸€ä¸‹å‡ ä¸ªå…³é”®è¯ï¼š</p><ol><li><p><strong>é™æ€æ–¹æ³•</strong>ï¼šé™æ€æ–¹æ³•æ˜¯å±äºç±»æœ¬èº«è€Œä¸æ˜¯ç±»çš„å®ä¾‹çš„æ–¹æ³•ã€‚åœ¨ Node.js ä¸­è°ƒç”¨<code>Certificate.exportPublicKey</code>æ—¶ï¼Œä½ ä¸éœ€è¦åˆ›å»ºä¸€ä¸ª<code>Certificate</code>ç±»çš„å®ä¾‹ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨<code>Certificate</code>ç±»è°ƒç”¨è¯¥æ–¹æ³•ã€‚</p></li><li><p><strong>Certificateï¼ˆè¯ä¹¦ï¼‰</strong>ï¼šåœ¨ç½‘ç»œå®‰å…¨ä¸­ï¼Œè¯ä¹¦æ˜¯æŒ‡ä¸€ä¸ªæ•°å­—æ–‡ä»¶ï¼Œå®ƒè¯æ˜äº†æŸä¸ªå…¬é’¥ç¡®å®å±äºå®ƒå£°ç§°çš„æ‹¥æœ‰è€…ã€‚è¯ä¹¦é€šå¸¸ç”±è®¤è¯æœºæ„ï¼ˆCAï¼‰ç­¾å‘å’ŒéªŒè¯ã€‚</p></li><li><p><strong>SPKACï¼ˆSigned Public Key and Challengeï¼‰</strong>ï¼šæ˜¯ç½‘æ™¯å…¬å¸ä¸º Netscape æµè§ˆå™¨è®¾è®¡çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œç”¨äºæäº¤æ–°çš„å…¬ç§é’¥å¯¹ï¼ˆå¯†é’¥å¯¹ï¼‰çš„è¯·æ±‚ã€‚SPKAC åŒ…å«ä¸€ä¸ªå…¬é’¥å’Œä¸€ä¸ªç­¾åï¼Œè¿™ä¸ªç­¾åæ˜¯ç”¨ç›¸åº”çš„ç§é’¥åˆ›å»ºçš„ã€‚</p></li><li><p><strong>encodingï¼ˆç¼–ç ï¼‰</strong>ï¼šç¼–ç æ˜¯æŒ‡å°†æ•°æ®è½¬æ¢ä¸ºç‰¹å®šæ ¼å¼çš„è¿‡ç¨‹ã€‚åœ¨ Node.js ä¸­ï¼Œå¸¸è§çš„ç¼–ç æ ¼å¼æœ‰<code>&#39;utf8&#39;</code>, <code>&#39;base64&#39;</code>, <code>&#39;hex&#39;</code>ç­‰ã€‚</p></li></ol><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åœ¨å®é™…ä¸­ä½¿ç”¨<code>Certificate.exportPublicKey</code>æ–¹æ³•ã€‚</p><p>å‡è®¾ä½ éœ€è¦ä»ä¸€ä¸ªå®¢æˆ·ç«¯è·å–ä¸€ä¸ªæ–°çš„å…¬é’¥ï¼Œä»¥ä¾¿åœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œèº«ä»½éªŒè¯æˆ–åŠ å¯†æ•°æ®ã€‚å®¢æˆ·ç«¯ä¼šç”Ÿæˆä¸€ä¸ª SPKAC æ•°æ®ç»“æ„ï¼Œå¹¶å°†å®ƒå‘é€ç»™æœåŠ¡å™¨ã€‚ç„¶åï¼Œä½ éœ€è¦åœ¨æœåŠ¡å™¨ç«¯ä½¿ç”¨<code>Certificate.exportPublicKey</code>æ–¹æ³•æ¥æå–å…¬é’¥ã€‚</p><p>ä»¥ä¸‹æ˜¯å…·ä½“çš„æ­¥éª¤ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥Node.jsçš„cryptoæ¨¡å—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾å®¢æˆ·ç«¯å·²ç»ç”Ÿæˆäº†SPKACæ•°æ®å¹¶å‘é€åˆ°æœåŠ¡å™¨ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨ä¸€ä¸ªç¤ºä¾‹å­—ç¬¦ä¸²è¡¨ç¤ºSPKACæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> spkac</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getSpkacFromClient</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™ä¸ªå‡½æ•°æ˜¯å‡æƒ³çš„ï¼Œè¡¨ç¤ºä»å®¢æˆ·ç«¯è·å–SPKACæ•°æ®</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨Certificate.exportPublicKeyé™æ€æ–¹æ³•ä»SPKACä¸­å¯¼å‡ºå…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½ å¯ä»¥é€‰æ‹©å¯¼å‡ºçš„ç¼–ç æ–¹å¼ï¼Œå¦‚æœä¸å¡«ï¼Œé»˜è®¤æ˜¯è¿”å›Bufferå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exportPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">spkac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å…¬é’¥ï¼Œçœ‹çœ‹è¾“å‡ºç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå…¬é’¥çš„å†…å®¹ï¼Œå¯èƒ½æ˜¯base64ç¼–ç çš„å­—ç¬¦ä¸²</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å…·ä½“çš„å®é™…æ“ä½œå¯èƒ½æ¶‰åŠåˆ°å°†å…¬é’¥å­˜å‚¨èµ·æ¥ï¼Œæˆ–è€…ç”¨å®ƒæ¥éªŒè¯ç­¾åç­‰ã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨çœŸå®çš„åœºæ™¯ä¸­ï¼Œä½ å¯èƒ½éœ€è¦å°†ä¸Šé¢çš„<code>publicKey</code>å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œæˆ–è€…ç”¨å®ƒæ¥éªŒè¯ä»å®¢æˆ·ç«¯ä¼ æ¥çš„æ•°æ®æ˜¯å¦è¢«ç¯¡æ”¹ã€‚å…¬é’¥ä¸»è¦ç”¨äºåŠ å¯†æ•°æ®æˆ–éªŒè¯ç­¾åï¼Œç¡®ä¿æ•°æ®ä¼ è¾“çš„å®‰å…¨æ€§ã€‚</p><p>è¯·è®°ä½ï¼Œä¸ºäº†ä½¿ç”¨ä¸Šè¿°ä»£ç ï¼Œä½ éœ€è¦æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„ SPKAC æ•°æ®ç»“æ„ã€‚è¿™ä¸ªç¤ºä¾‹æ²¡æœ‰å±•ç¤ºå¦‚ä½•ç”Ÿæˆ SPKACï¼Œå› ä¸ºé‚£é€šå¸¸æ˜¯åœ¨å®¢æˆ·ç«¯å®Œæˆçš„ã€‚å¦‚æœä½ éœ€è¦ç”Ÿæˆ SPKACï¼Œä½ å¯ä»¥ä½¿ç”¨<code>crypto.generateKeyPairSync</code>æ¥ç”Ÿæˆå¯†é’¥å¯¹ï¼Œç„¶åä½¿ç”¨<code>crypto.createSign</code>æ¥åˆ›å»º SPKACã€‚</p><h3 id="static-method-certificate-verifyspkac-spkac-encoding" tabindex="-1"><a class="header-anchor" href="#static-method-certificate-verifyspkac-spkac-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#static-method-certificateverifyspkacspkac-encoding" target="_blank" rel="noopener noreferrer">Static method: Certificate.verifySpkac(spkac[, encoding])</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘ä¼šå°½é‡é€šä¿—æ˜“æ‡‚åœ°è§£é‡Š Node.js v21.7.1 ä¸­çš„ <code>Certificate.verifySpkac(spkac[, encoding])</code> é™æ€æ–¹æ³•ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬äº†è§£ä¸€ä¸‹èƒŒæ™¯çŸ¥è¯†ã€‚</p><p>SPKAC æ˜¯ Signed Public Key and Challenge çš„ç¼©å†™ã€‚å®ƒæ˜¯ä¸€ä¸ªä»ç½‘é¡µè¡¨å•æäº¤è‡³æœåŠ¡å™¨çš„è¯ä¹¦ç­¾åè¯·æ±‚ï¼ˆCSRï¼‰ã€‚åœ¨ Web åº”ç”¨ä¸­ï¼Œå½“ç”¨æˆ·å¸Œæœ›ç”Ÿæˆä¸€ä¸ªæ–°çš„å…¬ç§é’¥å¯¹å¹¶å¸Œæœ›æœåŠ¡å™¨å¯¹å…¬é’¥è¿›è¡Œç­¾åæ—¶ï¼Œå°±ä¼šä½¿ç”¨åˆ° SPKACã€‚ç”Ÿæˆçš„å…¬é’¥å¯ä»¥ç”¨æ¥åˆ›å»ºä¸€ä¸ªæ•°å­—è¯ä¹¦ã€‚</p><p>åœ¨ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸­ï¼Œæä¾›äº†ä¸€ä¸ªå¤„ç† SPKAC æ•°æ®çš„åŠŸèƒ½ã€‚<code>Certificate.verifySpkac()</code> è¿™ä¸ªé™æ€æ–¹æ³•å°±æ˜¯ç”¨æ¥éªŒè¯ä¸€ä¸ª SPKAC è¯·æ±‚çš„æœ‰æ•ˆæ€§ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ ä»å®¢æˆ·ç«¯æ”¶åˆ°äº†ä¸€ä¸ªSPKACæ•°æ®å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> spkacString</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œåº”è¯¥æ˜¯å®é™…çš„ SPKAC å­—ç¬¦ä¸²</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœSPKACæ˜¯Base64ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œéœ€è¦å°†å…¶è½¬æ¢æˆBuffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> spkacBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">spkacString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨Certificate.verifySpkac()æ–¹æ³•æ¥éªŒè¯SPKAC</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> isValid</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">verifySpkac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">spkacBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isValid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœSPKACæœ‰æ•ˆï¼Œå°†æ‰“å° trueï¼›å¦‚æœæ— æ•ˆï¼Œåˆ™ä¸º falseã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½ä¼šåœ¨ä¸€ä¸ªæ³¨å†Œæµç¨‹ä¸­é‡åˆ° SPKACï¼Œä¾‹å¦‚ï¼š</p><ol><li>ç”¨æˆ·åœ¨ä½ çš„ç½‘ç«™ä¸Šç”³è¯·ä¸€ä¸ªè¯ä¹¦ã€‚</li><li>ç½‘ç«™çš„å‰ç«¯ä»£ç ä½¿ç”¨ Web Crypto API ç”Ÿæˆå…¬ç§é’¥å¯¹å’Œ SPKAC æ•°æ®ã€‚</li><li>ç”¨æˆ·å°† SPKAC æ•°æ®å‘é€ç»™ä½ çš„ Node.js æœåŠ¡å™¨ã€‚</li><li>ä½ çš„æœåŠ¡å™¨ä½¿ç”¨ <code>Certificate.verifySpkac(spkac)</code> æ¥éªŒè¯æ”¶åˆ°çš„ SPKAC æ•°æ®æ˜¯å¦åˆæ³•ã€‚</li><li>å¦‚æœ SPKAC æ•°æ®éªŒè¯é€šè¿‡ï¼ŒæœåŠ¡å™¨å¯ä»¥ç»§ç»­ä¸ºç”¨æˆ·æä¾›ç›¸åº”æœåŠ¡ï¼Œæ¯”å¦‚ç­¾ç½²è¿™ä¸ªå…¬é’¥æ¥ç”Ÿæˆè¯ä¹¦ã€‚</li></ol><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>Certificate.verifySpkac()</code> æ–¹æ³•åœ¨ Node.js ä¸­ç”¨äºéªŒè¯ä»å®¢æˆ·ç«¯æ”¶åˆ°çš„ SPKAC æ•°æ®çš„æœ‰æ•ˆæ€§ã€‚ç¡®ä¿åªæœ‰æœ‰æ•ˆçš„è¯·æ±‚æ‰ä¼šè¢«è¿›ä¸€æ­¥å¤„ç†ï¼Œä¾‹å¦‚åˆ›å»ºå’Œå‘è¡Œä¸€ä¸ªæ•°å­—è¯ä¹¦ã€‚</p><h3 id="legacy-api" tabindex="-1"><a class="header-anchor" href="#legacy-api"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#legacy-api" target="_blank" rel="noopener noreferrer">Legacy API</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºæœåŠ¡å™¨å’Œç½‘ç»œåº”ç”¨ç¨‹åºçš„å¹³å°ï¼Œå®ƒä½¿ç”¨ JavaScript ä½œä¸ºç¼–ç¨‹è¯­è¨€ã€‚åœ¨ Node.js ä¸­æœ‰ä¸€ä¸ªæ¨¡å—å«ä½œ <code>crypto</code>ï¼Œå®ƒæä¾›äº†åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯¹æ•°æ®è¿›è¡Œå“ˆå¸Œå¤„ç†ã€åˆ›å»ºæ•°å­—ç­¾åä»¥åŠåŠ å¯†å’Œè§£å¯†æ•°æ®ç­‰ã€‚</p><h3 id="legacy-api-1" tabindex="-1"><a class="header-anchor" href="#legacy-api-1"><span>Legacy API</span></a></h3><p>Legacy API æŒ‡çš„æ˜¯é‚£äº›å·²ç»å­˜åœ¨å¾ˆé•¿æ—¶é—´ï¼Œå¹¶å¯èƒ½åœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­è¢«åºŸå¼ƒï¼ˆdeprecatedï¼‰çš„ APIã€‚è¿™ç±» API ä»ç„¶å¯ä»¥ä½¿ç”¨ï¼Œä½†å®˜æ–¹ä¸æ¨èæ–°çš„é¡¹ç›®ä½¿ç”¨ï¼Œå› ä¸ºè¿™äº› API å¯èƒ½ä¼šæœ‰å®‰å…¨é—®é¢˜ï¼Œè€Œä¸”åç»­å¯èƒ½ä¸å†æä¾›æ”¯æŒæˆ–æ›´æ–°ã€‚</p><p>åœ¨ Node.js v21.7.1 çš„ <code>crypto</code> æ¨¡å—ä¸­ï¼ŒLegacy API æ¶‰åŠåˆ°ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p><ol><li><p><strong>åŠ å¯†å’Œè§£å¯†ï¼ˆCipher and Decipherï¼‰</strong>ï¼š</p><ul><li><p><code>crypto.createCipher()</code> å’Œ <code>crypto.createDecipher()</code> è¿™ä¸¤ä¸ªæ–¹æ³•ç”¨äºåˆ›å»ºåŠ å¯†å’Œè§£å¯†å¯¹è±¡ï¼Œä½†å®ƒä»¬ä½¿ç”¨çš„æ˜¯è€æ—§çš„åŠ å¯†æ–¹å¼å¹¶ä¸”å¯èƒ½ä¸å®‰å…¨ã€‚</p></li><li><p>å®é™…è¿ç”¨ä¾‹å­ï¼šè™½ç„¶ä¸è¢«æ¨èï¼Œä½†å¦‚æœä½ çš„è€é¡¹ç›®ä¸­ä½¿ç”¨äº†è¿™äº›æ–¹æ³•æ¥åŠ å¯†ç”¨æˆ·å¯†ç ï¼Œä½ å¯èƒ½ä¼šè¿™æ ·ä½¿ç”¨å®ƒä»¬ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes192&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;a password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;readable&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">read</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°åŠ å¯†çš„å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;some clear text data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p><strong>å“ˆå¸Œï¼ˆHashingï¼‰</strong>:</p><ul><li><p><code>crypto.createHash()</code> æ–¹æ³•å¯ä»¥åˆ›å»ºä¸€ä¸ªå“ˆå¸Œå¯¹è±¡ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªå¯¹è±¡æ¥ç”Ÿæˆæ•°æ®çš„å“ˆå¸Œå€¼ï¼ˆå¦‚æ–‡ä»¶çš„ MD5 æ‘˜è¦ç­‰ï¼‰ã€‚</p></li><li><p>å®é™…è¿ç”¨ä¾‹å­ï¼šæ¯”å¦‚ä½ éœ€è¦ä¸ºä¸Šä¼ çš„æ–‡ä»¶ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ï¼Œä½ å¯èƒ½ä¼šè¿™æ ·è®¡ç®—æ–‡ä»¶çš„ MD5 å€¼ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fileBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path/to/file&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hashSum</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;md5&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hashSum</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fileBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hex</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hashSum</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hex</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°æ–‡ä»¶çš„MD5å€¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p><strong>HMACï¼ˆKeyed-Hash Message Authentication Codeï¼‰</strong>:</p><ul><li><p><code>crypto.createHmac()</code> æ–¹æ³•å¯ä»¥åˆ›å»ºä¸€ä¸ª HMAC å¯¹è±¡ï¼Œè¿™æ˜¯ä¸€ç§ä½¿ç”¨åŠ å¯†å“ˆå¸Œå‡½æ•°ç»“åˆä¸€ä¸ªå¯†é’¥æ¥è¿›è¡Œæ¶ˆæ¯è®¤è¯çš„æŠ€æœ¯ã€‚</p></li><li><p>å®é™…è¿ç”¨ä¾‹å­ï¼šæ¯”å¦‚ä½ éœ€è¦éªŒè¯å‘é€è¿‡æ¥çš„æ¶ˆæ¯æ˜¯å¦æœªè¢«ç¯¡æ”¹ï¼Œä½ å¯ä»¥é€šè¿‡ HMAC è¿›è¡ŒéªŒè¯ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secret</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;abcdefg&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;some message to hash&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°æ¶ˆæ¯çš„HMACå€¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ol><p>æ€»çš„æ¥è¯´ï¼ŒLegacy API åœ¨ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸­æŒ‡çš„æ˜¯é‚£äº›å·²ç»ä¸å†æ¨èä½¿ç”¨çš„åŠ å¯†ç›¸å…³å‡½æ•°ã€‚å°½ç®¡å®ƒä»¬ç°åœ¨è¿˜èƒ½å·¥ä½œï¼Œä½ åº”è¯¥è€ƒè™‘ä½¿ç”¨æ›´ç°ä»£ã€æ›´å®‰å…¨çš„æ›¿ä»£æ–¹æ³•ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œå¦‚æœä½ æ­£åœ¨å¼€å§‹ä¸€ä¸ªæ–°é¡¹ç›®æˆ–è€…æ­£åœ¨ç»´æŠ¤ä¸€ä¸ªè€é¡¹ç›®ï¼Œéƒ½åº”è¯¥å°½å¯èƒ½æŸ¥æ‰¾å’Œè¿ç§»åˆ°æ¨èçš„æ–° API ä¸Šå»ã€‚</p><h4 id="new-crypto-certificate" tabindex="-1"><a class="header-anchor" href="#new-crypto-certificate"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#new-cryptocertificate" target="_blank" rel="noopener noreferrer">new crypto.Certificate()</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome çš„ V8 å¼•æ“çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå®ƒèƒ½è®©æˆ‘ä»¬åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚<code>crypto</code> æ¨¡å—æ˜¯ Node.js çš„ä¸€ä¸ªå†…ç½®æ¨¡å—ï¼Œç”¨æ¥æ‰§è¡Œå„ç§åŠ å¯†ç®—æ³•ï¼ŒåŒ…æ‹¬åˆ›å»ºæ•£åˆ—ã€HMACã€åŠ å¯†ã€è§£å¯†ã€ç­¾åå’ŒéªŒè¯ç­‰ã€‚</p><p><code>new crypto.Certificate()</code> æ˜¯ <code>crypto</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨æ¥åˆ›å»ºä¸€ä¸ª <code>Certificate</code> å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æä¾›äº†ä¸€äº›æ–¹æ³•æ¥å¤„ç† X.509 è¯ä¹¦ã€‚</p><p>X.509 è¯ä¹¦æ˜¯äº’è”ç½‘ä¸Šç”¨äºå®‰å…¨é€šä¿¡çš„æ•°å­—è¯ä¹¦çš„æ ‡å‡†æ ¼å¼ã€‚å½“ä½ é€šè¿‡ HTTPS è®¿é—®ä¸€ä¸ªç½‘ç«™æ—¶ï¼Œè¿™ä¸ªç½‘ç«™ä¼šå‘æµè§ˆå™¨æä¾›ä¸€ä¸ª X.509 è¯ä¹¦ä»¥è¯æ˜å®ƒçš„èº«ä»½ï¼Œå¹¶å»ºç«‹ä¸€ä¸ªåŠ å¯†è¿æ¥ã€‚</p><p>ä¸‹é¢æ˜¯ä½¿ç”¨ <code>new crypto.Certificate()</code> çš„ç¤ºä¾‹ï¼š</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ–°çš„Certificateå®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª PEM æ ¼å¼çš„è¯ä¹¦</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> pem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">-----BEGIN CERTIFICATE-----</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">MIIC2jCCAcKgAwIBAgIBATANBgkqhkiG9w0BAQUFADAvMQswCQYDVQQGEwJBVTET</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">...</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">-----END CERTIFICATE-----</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ Certificate å¯¹è±¡çš„æ–¹æ³•æ¥è·å–è¯ä¹¦çš„æŒ‡çº¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fingerprint</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fingerprint</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fingerprint</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™å°†æ‰“å°å‡ºè¯ä¹¦çš„æŒ‡çº¹</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¹Ÿå¯ä»¥è·å–è¯ä¹¦çš„åºåˆ—å·</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> serialNumber</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">serialNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">serialNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™å°†æ‰“å°å‡ºè¯ä¹¦çš„åºåˆ—å·</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† Node.js çš„ <code>crypto</code> æ¨¡å—ã€‚ç„¶åæˆ‘ä»¬åˆ›å»ºäº† <code>Certificate</code> ç±»çš„ä¸€ä¸ªæ–°å®ä¾‹ã€‚æ¥ç€ï¼Œæˆ‘ä»¬å‡è®¾æœ‰ä¸€ä¸ªå·²ç»ä»¥ PEM æ ¼å¼å­˜åœ¨çš„è¯ä¹¦å­—ç¬¦ä¸²ï¼ˆé€šå¸¸è¿™æ ·çš„å­—ç¬¦ä¸²ä¼šä»æ–‡ä»¶ä¸­è¯»å–æˆ–è€…é€šè¿‡ç½‘ç»œè·å–ï¼‰ã€‚ä½¿ç”¨è¿™ä¸ª <code>cert</code> å®ä¾‹æˆ‘ä»¬è°ƒç”¨äº† <code>fingerprint</code> æ–¹æ³•æ¥è·å–è¯ä¹¦çš„æŒ‡çº¹ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºå”¯ä¸€æ ‡è¯†è¯ä¹¦çš„å­—ç¬¦ä¸²ã€‚åŒæ ·åœ°ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>serialNumber</code> æ–¹æ³•è·å–äº†è¯ä¹¦çš„åºåˆ—å·ï¼Œé€šå¸¸ç”¨äºåŒºåˆ†ä¸åŒçš„è¯ä¹¦ã€‚</p><p>æ³¨æ„ï¼Œåœ¨çœŸå®çš„åº”ç”¨ä¸­ï¼Œè¯ä¹¦æ•°æ®åº”è¯¥æ˜¯ä»æ–‡ä»¶ç³»ç»Ÿæˆ–è€…å…¶ä»–æ¥æºå®‰å…¨åœ°è·å–çš„ï¼Œè€Œä¸æ˜¯ç¡¬ç¼–ç åœ¨ä»£ç ä¸­çš„ã€‚æ­¤å¤–ï¼Œå¤æ‚çš„åº”ç”¨å¯èƒ½éœ€è¦æ›´å¤šçš„é”™è¯¯å¤„ç†é€»è¾‘æ¥ç¡®ä¿è¯ä¹¦çš„æœ‰æ•ˆæ€§å’Œå®‰å…¨æ€§ã€‚</p><p><code>crypto.Certificate</code> ç±»çš„æ–¹æ³•é€šå¸¸ç”¨äºéœ€è¦å¯¹è¯ä¹¦è¿›è¡Œè§£æã€å®¡æŸ¥æˆ–éªŒè¯çš„åœºæ™¯ï¼Œæ¯”å¦‚æ„å»ºå®‰å…¨çš„é€šä¿¡æœåŠ¡ã€å®ç°è‡ªå®šä¹‰çš„è®¤è¯æœºåˆ¶ç­‰ã€‚</p><h4 id="certificate-exportchallenge-spkac-encoding" tabindex="-1"><a class="header-anchor" href="#certificate-exportchallenge-spkac-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#certificateexportchallengespkac-encoding" target="_blank" rel="noopener noreferrer">certificate.exportChallenge(spkac[, encoding])</a></span></a></h4><p><code>certificate.exportChallenge(spkac[, encoding])</code> æ˜¯ Node.js åŠ å¯†æ¨¡å—é‡Œçš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºä»æ‰€è°“çš„ &quot;SPKAC&quot; æ•°æ®ç»“æ„ä¸­æå–å‡º &quot;challenge&quot; å­—ç¬¦ä¸²ã€‚è¿™ä¸ªæ•°æ®ç»“æ„é€šå¸¸æ˜¯åœ¨ç½‘é¡µä¸­ç”Ÿæˆæ–°çš„å…¬é’¥å’Œç§é’¥å¯¹å¹¶ä¸”æ³¨å†Œæ•°å­—è¯ä¹¦æ—¶ä½¿ç”¨çš„ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘è§£é‡Šä¸€äº›åŸºæœ¬æ¦‚å¿µï¼š</p><ol><li><p><strong>SPKAC (Signed Public Key And Challenge)</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªç”± Netscape æå‡ºçš„æ•°æ®ç»“æ„ï¼ŒåŒ…å«äº†å…¬é’¥ã€ä¸€ä¸ªæŒ‘æˆ˜å­—ç¬¦ä¸²ï¼ˆchallengeï¼‰ï¼Œä»¥åŠä¸ä¹‹å…³è”çš„ç­¾åã€‚å®ƒä¸»è¦ç”¨äºè¯ä¹¦ç­¾å‘è¯·æ±‚ï¼Œç‰¹åˆ«æ˜¯åœ¨ HTML5 çš„ <code>&lt;`keygen`&gt;</code> å…ƒç´ ï¼ˆç°åœ¨å·²åºŸå¼ƒï¼‰ä¸­ç”Ÿæˆå®¢æˆ·ç«¯å¯†é’¥å¹¶è¯·æ±‚è¯ä¹¦æ—¶ã€‚</p></li><li><p><strong>Challenge å­—ç¬¦ä¸²</strong>ï¼šè¿™æ˜¯ä¸€æ®µæ–‡æœ¬ï¼Œå¯ä»¥åœ¨ç”Ÿæˆ SPKAC è¯·æ±‚æ—¶ç”±ç”¨æˆ·æŒ‡å®šã€‚å®ƒçš„ç›®çš„æ˜¯ä½œä¸ºä¸€ä¸ªéæœºå¯†çš„éšæœºé‡ï¼Œå¸®åŠ©ç¡®ä¿ç”Ÿæˆçš„å¯†é’¥å¯¹çš„çœŸå®æ€§ã€‚å½“è¯ä¹¦é¢å‘æœºæ„æ¥æ”¶åˆ° SPKAC è¯·æ±‚æ—¶ï¼Œä¼šæ£€æŸ¥å…¶ä¸­çš„ challenge å­—ç¬¦ä¸²ï¼Œå¹¶åœ¨ç”Ÿæˆè¯ä¹¦æ—¶å¯èƒ½ä¼šç”¨åˆ°å®ƒã€‚</p></li><li><p><strong>Encoding</strong>ï¼šè¿™æŒ‡çš„æ˜¯è¾“å‡ºæ ¼å¼ï¼Œä¾‹å¦‚ &#39;utf8&#39;, &#39;binary&#39; ç­‰ã€‚Node.js æ”¯æŒå¤šç§ç¼–ç æ ¼å¼æ¥è¡¨ç¤ºæ•°æ®ã€‚</p></li></ol><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹ <code>certificate.exportChallenge</code> è¿™ä¸ªæ–¹æ³•çš„å…·ä½“åº”ç”¨ï¼š</p><h4 id="ä½¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯"><span>ä½¿ç”¨åœºæ™¯ï¼š</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™ï¼Œéœ€è¦ç”¨æˆ·ç”Ÿæˆå¯†é’¥å¯¹å¹¶è¯·æ±‚ä¸€ä¸ªæ•°å­—è¯ä¹¦ã€‚ç”¨æˆ·æäº¤äº†ä¸€ä¸ª SPKAC æ•°æ®ç»“æ„ç»™ä½ çš„æœåŠ¡å™¨ã€‚ä½ çš„èŠ‚ç‚¹æœåŠ¡å™¨éœ€è¦ä»è¿™ä¸ª SPKAC ä¸­æå– challenge å­—ç¬¦ä¸²ï¼Œç„¶åå¯èƒ½å°†å…¶è®°å½•ä¸‹æ¥æˆ–ç”¨äºå…¶ä»–éªŒè¯æ­¥éª¤ã€‚</p><h4 id="ç¤ºä¾‹ä»£ç " tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç "><span>ç¤ºä¾‹ä»£ç ï¼š</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ å·²ç»æœ‰äº†ä¸€ä¸ª SPKAC æ•°æ®ç»“æ„ï¼Œé€šå¸¸æ˜¯ç”±æµè§ˆå™¨å‘é€åˆ°æœåŠ¡å™¨çš„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> spkac</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getSpkacFromClient</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œæ˜¯è·å– SPKAC æ•°æ®çš„å‡½æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ exportChallenge æ–¹æ³•æ¥æå– challenge å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> challenge</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">certifcate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exportChallenge</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">spkac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Challenge is:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">challenge</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡º challenge å­—ç¬¦ä¸²</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>getSpkacFromClient</code> åº”è¯¥æ˜¯ä¸€ä¸ªä»å‰ç«¯å‘é€åˆ°æœåŠ¡å™¨ç«¯çš„è¯·æ±‚å¤„ç†è¿‡ç¨‹ï¼Œç”¨äºè·å– SPKAC å­—ç¬¦ä¸²ã€‚æ‰§è¡Œ <code>exportChallenge</code> å‡½æ•°åï¼Œæˆ‘ä»¬å¾—åˆ°äº† challenge å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”å¯ä»¥è½¬æˆ UTF-8 æ ¼å¼æ‰“å°å‡ºæ¥ã€‚</p><p>æ³¨æ„ï¼Œç”±äº <code>exportChallenge</code> æ–¹æ³•ä»…åœ¨ Node.js çš„æŸäº›ç‰ˆæœ¬ä¸­å¯ç”¨ï¼Œä½ éœ€è¦ç¡®ä¿ä½ çš„ Node.js ç‰ˆæœ¬æ”¯æŒæ­¤åŠŸèƒ½ã€‚è€Œä¸”ï¼Œä½ å¾ˆå°‘éœ€è¦ç›´æ¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå› ä¸ºå¤„ç†æ•°å­—è¯ä¹¦é€šå¸¸æ˜¯é€šè¿‡æ›´é«˜çº§çš„åº“æˆ–è€…å¹³å°æ¥å®Œæˆçš„ã€‚ä½†å¦‚æœä½ æ­£å¥½å·¥ä½œåœ¨éœ€è¦å¤„ç†åŸå§‹ SPKAC æ•°æ®çš„ç¯å¢ƒä¸­ï¼Œäº†è§£è¿™ä¸ªå‡½æ•°å°±éå¸¸æœ‰ç”¨äº†ã€‚</p><h4 id="certificate-exportpublickey-spkac-encoding" tabindex="-1"><a class="header-anchor" href="#certificate-exportpublickey-spkac-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#certificateexportpublickeyspkac-encoding" target="_blank" rel="noopener noreferrer">certificate.exportPublicKey(spkac[, encoding])</a></span></a></h4><p><code>certificate.exportPublicKey(spkac[, encoding])</code> æ˜¯ Node.js ä¸­ä¸€ä¸ªå¤„ç†åŠ å¯†è¯ä¹¦çš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å±äº Node.js çš„<code>crypto</code>æ¨¡å—ï¼Œå®ƒä¸»è¦ç”¨äºä» SPKAC æ•°æ®ç»“æ„ä¸­æå–å…¬é’¥ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦äº†è§£å‡ ä¸ªæ¦‚å¿µï¼š</p><ul><li><strong>Crypto Module</strong>: Node.js çš„<code>crypto</code>æ¨¡å—æä¾›äº†åŒ…æ‹¬åŠ å¯†è§£å¯†ã€å“ˆå¸Œç®—æ³•ç­‰åœ¨å†…çš„åŠ å¯†åŠŸèƒ½ã€‚</li><li><strong>Certificate</strong>: åœ¨ä¿¡æ¯å®‰å…¨é¢†åŸŸï¼Œè¯ä¹¦é€šå¸¸æ˜¯æŒ‡æ•°å­—è¯ä¹¦ï¼Œå®ƒå¯ä»¥éªŒè¯æŸä¸ªå®ä½“çš„èº«ä»½ã€‚</li><li><strong>Public Key</strong>: å…¬é’¥æ˜¯éå¯¹ç§°åŠ å¯†ä¸­ä½¿ç”¨çš„ä¸€ä¸ªå¯†é’¥ï¼Œä¸ä¹‹é…å¯¹çš„å¦ä¸€ä¸ªå¯†é’¥æ˜¯ç§é’¥ã€‚åœ¨éå¯¹ç§°åŠ å¯†ä¸­ï¼Œå…¬é’¥æ˜¯å…¬å¼€çš„ï¼Œå¯ä»¥ç”¨æ¥åŠ å¯†ä¿¡æ¯æˆ–éªŒè¯ç­¾åï¼Œè€Œç§é’¥åˆ™æ˜¯ä¿å¯†çš„ï¼Œç”¨æ¥è§£å¯†æˆ–è€…åˆ›å»ºç­¾åã€‚</li><li><strong>SPKAC (Signed Public Key and Challenge)</strong>: è¿™æ˜¯ç”± Netscape æå‡ºçš„ä¸€ç§æ•°æ®ç»“æ„ï¼ŒåŒ…å«äº†ç”¨æˆ·çš„å…¬é’¥å’Œä¸€ä¸ªå•å‘çš„æŒ‘æˆ˜ç ï¼Œé€šå¸¸ç”¨äº Web æµè§ˆå™¨ç”Ÿæˆå¯†é’¥æ—¶æäº¤ç»™è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰è¿›è¡Œè¯ä¹¦ç”³è¯·ã€‚</li></ul><p>ç°åœ¨è®©æˆ‘ä»¬æ·±å…¥åˆ°<code>certificate.exportPublicKey(spkac[, encoding])</code> å‡½æ•°æœ¬èº«ï¼š</p><ul><li><code>spkac</code>: è¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª SPKAC æ ¼å¼çš„å­—ç¬¦ä¸²æˆ– Bufferï¼ŒåŒ…å«äº†ç”¨æˆ·çš„å…¬å¼€ä¿¡æ¯å’Œå…¬é’¥ã€‚</li><li><code>encoding</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå®ƒå†³å®šäº†è¿”å›å€¼çš„æ ¼å¼ã€‚å¯èƒ½çš„å€¼åŒ…æ‹¬<code>&#39;buffer&#39;</code>, <code>&#39;binary&#39;</code>, <code>&#39;base64&#39;</code> ç­‰ã€‚å¦‚æœä¸ä¼ é€’æ­¤å‚æ•°ï¼Œé»˜è®¤è¿”å› Buffer å¯¹è±¡ã€‚</li></ul><p>è¿™ä¸ªå‡½æ•°çš„ä½œç”¨å°±æ˜¯ä» SPKAC ç»“æ„ä¸­å¯¼å‡ºå…¬é’¥ï¼Œå¹¶æ ¹æ®æŒ‡å®šçš„ç¼–ç è¿”å›è¿™ä¸ªå…¬é’¥ã€‚</p><p>ä¸‹é¢é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨<code>certificate.exportPublicKey</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªSPKACå­—ç¬¦ä¸²ï¼Œé€šå¸¸è¿™æ˜¯ä»å®¢æˆ·ç«¯ç”Ÿæˆçš„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> spkacString</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getSpkacFromClient</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™ä¸ªå‡½æ•°å‡è®¾æ˜¯ä½ è·å–SPKACæ•°æ®çš„æ–¹å¼</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºBufferå¯¹è±¡ï¼Œå› ä¸ºexportPublicKeyéœ€è¦ä¸€ä¸ªBufferæˆ–è€…å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> spkacBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">spkacString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨exportPublicKeyå‡½æ•°æå–å…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exportPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">spkacBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºå¯¼å‡ºçš„å…¬é’¥ï¼Œä»¥ä¾¿æŸ¥çœ‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒæœåŠ¡å™¨ç«¯å¯èƒ½ä¼šä½¿ç”¨è¿™ä¸ªå…¬é’¥æ¥è®¾ç½®ä¸ç”¨æˆ·ä¹‹é—´çš„åŠ å¯†é€šä¿¡ï¼Œæˆ–è€…éªŒè¯ä»ç”¨æˆ·é‚£é‡Œæ¥æ”¶åˆ°çš„æ•°æ®ç­¾åã€‚ä¾‹å¦‚ï¼Œåœ¨ç”¨æˆ·æ³¨å†Œè¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·çš„æµè§ˆå™¨ä¼šç”Ÿæˆä¸€å¯¹å¯†é’¥ï¼ˆå…¬é’¥å’Œç§é’¥ï¼‰ï¼Œç„¶åå°† SPKAC æ•°æ®å‘é€åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ç”¨<code>exportPublicKey</code>æå–å…¬é’¥å¹¶ä¸ºç”¨æˆ·ç”Ÿæˆä¸€ä¸ªæ•°å­—è¯ä¹¦ï¼Œæœ€ç»ˆå®Œæˆç”¨æˆ·çš„ SSL/TLS åŠ å¯†é€šä¿¡è®¾ç½®ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œ<code>certificate.exportPublicKey</code>æ˜¯åœ¨ä½¿ç”¨ Node.js å¤„ç†åŸºäº SPKAC çš„æ•°å­—è¯ä¹¦æ“ä½œæ—¶ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„å·¥å…·å‡½æ•°ã€‚</p><h4 id="certificate-verifyspkac-spkac-encoding" tabindex="-1"><a class="header-anchor" href="#certificate-verifyspkac-spkac-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#certificateverifyspkacspkac-encoding" target="_blank" rel="noopener noreferrer">certificate.verifySpkac(spkac[, encoding])</a></span></a></h4><p>å½“ç„¶ï¼Œæˆ‘ä¼šå°½åŠ›è§£é‡Šå¾—é€šä¿—æ˜“æ‡‚ã€‚</p><p>é¦–å…ˆï¼Œ<code>certificate.verifySpkac(spkac[, encoding])</code> æ˜¯ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ã€‚åœ¨è§£é‡Šè¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£å‡ ä¸ªæ¦‚å¿µï¼š</p><ol><li><p><strong>SPKAC</strong>ï¼šSPKAC æ˜¯ &quot;Signed Public Key And Challenge&quot; çš„ç¼©å†™ã€‚å®ƒæ˜¯ä¸€ç§åŒ…å«å…¬é’¥å’Œä¸€ä¸ªç”±å¯¹åº”çš„ç§é’¥ç­¾åçš„æŒ‘æˆ˜å­—ç¬¦ä¸²ï¼ˆchallengeï¼‰çš„æ•°æ®ç»“æ„ã€‚SPKAC é€šå¸¸ç”¨äºè¯ä¹¦ç­¾åè¯·æ±‚ï¼ˆCertificate Signing Request, CSRï¼‰ï¼Œåœ¨ç½‘ç»œä¸Šè¿›è¡Œå®‰å…¨é€šä¿¡æ—¶ç”¨äºéªŒè¯èº«ä»½ã€‚</p></li><li><p><strong>è¯ä¹¦</strong>ï¼šåœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸï¼Œè¯ä¹¦æ˜¯ä¸€ä¸ªç”µå­æ–‡æ¡£ï¼Œç”¨ä»¥ç¡®è®¤ç½‘ç«™æˆ–ç”¨æˆ·çš„èº«ä»½ï¼Œå¹¶å…¬å¼€åŒ…å«äº†ä¸€ä¸ªå…¬é’¥ã€‚</p></li><li><p><strong><code>crypto</code> æ¨¡å—</strong>ï¼šNode.js çš„ <code>crypto</code> æ¨¡å—æä¾›äº†åŒ…æ‹¬åŠ å¯†ã€è§£å¯†ã€ç­¾åå’ŒéªŒè¯ç­‰åŠŸèƒ½çš„å¯†ç å­¦èƒ½åŠ›ã€‚</p></li></ol><p>ç°åœ¨æ¥è§£é‡Š <code>certificate.verifySpkac(spkac[, encoding])</code> æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯éªŒè¯ä¸€ä¸ª SPKAC æ•°æ®ç»“æ„æ˜¯å¦æœ‰æ•ˆã€‚å¦‚æœ SPKAC å†…çš„å…¬é’¥æ­£ç¡®ä¸”æŒ‘æˆ˜å­—ç¬¦ä¸²çš„ç­¾ååˆæ³•ï¼Œåˆ™è¿”å› <code>true</code>ï¼›å¦åˆ™è¿”å› <code>false</code>ã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>spkac</code>ï¼šè¿™æ˜¯å¿…é¡»çš„å‚æ•°ï¼Œè¡¨ç¤ºè¦éªŒè¯çš„ SPKAC æ•°æ®ã€‚</li><li><code>encoding</code>ï¼šè¿™æ˜¯å¯é€‰çš„å‚æ•°ï¼ŒæŒ‡å®š <code>spkac</code> å‚æ•°çš„ç¼–ç ç±»å‹ï¼Œæ¯”å¦‚ &#39;utf8&#39;, &#39;ascii&#39; ç­‰ã€‚</li></ul><p>ä¸‹é¢ä¸¾ä¸€ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ã€‚</p><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªç½‘ç«™ï¼Œç”¨æˆ·å¯ä»¥ç”Ÿæˆä¸€ä¸ªæ–°çš„å¯†é’¥å¯¹å¹¶å‘ä½ çš„æœåŠ¡å™¨å‘é€ä¸€ä¸ª SPKAC è¯·æ±‚ï¼Œä»¥è·å–è‡ªå·±çš„è¯ä¹¦ã€‚ä½ çš„æœåŠ¡å™¨éœ€è¦éªŒè¯è¿™ä¸ª SPKAC è¯·æ±‚ç¡®å®æ˜¯ç”±è¯¥ç”¨æˆ·å‘èµ·ï¼Œå¹¶ä¸”å…¬é’¥æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚</p><p>æœåŠ¡å™¨ç«¯çš„ä»£ç å¯èƒ½ä¼šè¿™æ ·å†™ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾å®¢æˆ·ç«¯é€šè¿‡ HTTPS å‘é€äº†ä¸€ä¸ª SPKAC ç»“æ„åˆ°æœåŠ¡å™¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> spkac</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getSpkacFromClient</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™ä¸ªå‡½æ•°æ˜¯å‡è®¾çš„ï¼Œç”¨äºè·å–å®¢æˆ·ç«¯å‘æ¥çš„ SPKAC</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ Node.js çš„ certify.verifySpkac æ–¹æ³•éªŒè¯ SPKAC æ˜¯å¦æœ‰æ•ˆ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> isValid</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">verifySpkac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">spkac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isValid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;SPKAC éªŒè¯æˆåŠŸã€‚&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¦‚æœéªŒè¯æˆåŠŸï¼Œå¯ä»¥ä¸ºè¯¥ç”¨æˆ·ç”Ÿæˆè¯ä¹¦</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;SPKAC éªŒè¯å¤±è´¥ï¼Œè¯·é‡æ–°æäº¤ã€‚&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¦‚æœéªŒè¯å¤±è´¥ï¼Œåˆ™æ‹’ç»è¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>getSpkacFromClient()</code> æ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿå‡½æ•°ï¼Œå®ƒä»£è¡¨ä»å®¢æˆ·ç«¯æ¥æ”¶åˆ°çš„ SPKAC æ•°æ®ã€‚æˆ‘ä»¬ä½¿ç”¨ <code>Buffer.from()</code> æ¥è½¬æ¢æ•°æ®ï¼Œç„¶åä½¿ç”¨ <code>crypto.verifySpkac()</code> æ–¹æ³•æ¥éªŒè¯å…¶æœ‰æ•ˆæ€§ã€‚</p><p>æ€»ç»“ï¼š<code>certificate.verifySpkac()</code> æ˜¯ Node.js ä¸­ä¸€ä¸ªç”¨äºéªŒè¯ SPKAC ç»“æ„å®Œæ•´æ€§å’Œæœ‰æ•ˆæ€§çš„æ–¹æ³•ã€‚è¿™åœ¨å»ºç«‹å®‰å…¨é€šä¿¡å’Œå¤„ç†ç”¨æˆ·è¯ä¹¦è¯·æ±‚æ—¶å¾ˆæœ‰ç”¨ã€‚</p><h2 id="class-cipher" tabindex="-1"><a class="header-anchor" href="#class-cipher"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#class-cipher" target="_blank" rel="noopener noreferrer">Class: Cipher</a></span></a></h2><p>Node.js ä¸­çš„ <code>Cipher</code> ç±»æ˜¯ä¸€ä¸ªç”¨äºè¿›è¡Œæ•°æ®åŠ å¯†çš„å·¥å…·ã€‚åœ¨ <code>crypto</code> æ¨¡å—ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥å°†ä¿¡æ¯è½¬æ¢æˆéš¾ä»¥é˜…è¯»çš„æ ¼å¼ï¼Œä»è€Œä¿æŠ¤æ•°æ®ä¸è¢«æœªæˆæƒçš„äººè®¿é—®ã€‚è¿™é€šå¸¸è¢«ç§°ä½œâ€œåŠ å¯†â€ã€‚</p><p>å½“ä½ åˆ›å»ºä¸€ä¸ª <code>Cipher</code> å®ä¾‹æ—¶ï¼Œä½ éœ€è¦æŒ‡å®šä¸€ä¸ªåŠ å¯†ç®—æ³•å’Œä¸€ä¸ªå¯†é’¥ï¼ˆsecret keyï¼‰ã€‚åŠ å¯†ç®—æ³•æ˜¯ä¸€ç³»åˆ—å¤æ‚çš„æ•°å­¦æ“ä½œï¼Œå®ƒä»¬ä¼šå°†ä½ çš„æ•°æ®å˜å¾—æ— æ³•è¯†åˆ«ï¼Œè€Œå¯†é’¥æ˜¯ä¸€ä¸²å­—ç¬¦ï¼Œå®ƒå†³å®šäº†å¦‚ä½•ç²¾ç¡®åœ°æ‰§è¡Œè¿™äº›æ“ä½œã€‚</p><p>ä¸‹é¢æ˜¯å‡ ä¸ªä½¿ç”¨ <code>Cipher</code> ç±»çš„å®é™…ä¾‹å­ï¼š</p><h3 id="ä¾‹å­-1-ç®€å•çš„æ–‡æœ¬åŠ å¯†" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-ç®€å•çš„æ–‡æœ¬åŠ å¯†"><span>ä¾‹å­ 1ï¼šç®€å•çš„æ–‡æœ¬åŠ å¯†</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¯†ç å™¨å®ä¾‹ï¼Œ&#39;aes-256-cbc&#39; æ˜¯åŠ å¯†ç®—æ³•, &#39;my-secret-key&#39; æ˜¯å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-256-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;my-secret-key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;readable&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">read</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŠ å¯†åçš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å†™å…¥å¾…åŠ å¯†çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>AES-256-CBC</code> åŠ å¯†ç®—æ³•å’Œä¸€ä¸ªç®€å•çš„å¯†é’¥ <code>&#39;my-secret-key&#39;</code> æ¥åˆ›å»ºä¸€ä¸ª <code>Cipher</code> å®ä¾‹ã€‚ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡ç›‘å¬ <code>readable</code> äº‹ä»¶æ¥è·å–åŠ å¯†åçš„æ•°æ®ï¼Œå¹¶åœ¨ <code>end</code> äº‹ä»¶å‘ç”Ÿæ—¶è¾“å‡ºæœ€ç»ˆçš„åŠ å¯†ç»“æœã€‚</p><h3 id="ä¾‹å­-2-ä½¿ç”¨æµåŠ å¯†å¤§æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ä½¿ç”¨æµåŠ å¯†å¤§æ–‡ä»¶"><span>ä¾‹å­ 2ï¼šä½¿ç”¨æµåŠ å¯†å¤§æ–‡ä»¶</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªè¯»å–æµå’Œå†™å…¥æµ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> input</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createReadStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¦åŠ å¯†çš„æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> output</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createWriteStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.enc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŠ å¯†åçš„æ–‡ä»¶</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºå¯†ç å™¨å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-256-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;my-secret-key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å…¥æµ -&gt; å¯†ç å™¨ -&gt; è¾“å‡ºæµ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">input</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">pipe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">pipe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">output</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">output</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;finish&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;File encrypted successfully.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ Node.js çš„æµï¼ˆStreamsï¼‰åŠŸèƒ½æ¥åŠ å¯†ä¸€ä¸ªåä¸º <code>example.txt</code> çš„å¤§æ–‡ä»¶ã€‚æµæä¾›äº†ä¸€ç§é«˜æ•ˆå¤„ç†å¤§é‡æ•°æ®çš„æ–¹å¼ã€‚æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªè¾“å…¥æµæ¥è¯»å–åŸå§‹æ–‡ä»¶ï¼Œå°†å…¶é€šè¿‡ <code>Cipher</code> å®ä¾‹è¿›è¡ŒåŠ å¯†ï¼Œç„¶åä½¿ç”¨è¾“å‡ºæµå°†åŠ å¯†åçš„æ•°æ®å†™å…¥åˆ°æ–°æ–‡ä»¶ <code>example.enc</code> ä¸­ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹"><span>æ³¨æ„äº‹é¡¹ï¼š</span></a></h3><ol><li>åœ¨ä½¿ç”¨ <code>Cipher</code> ç±»ä¹‹å‰ï¼Œè¯·ç¡®ä¿ç†Ÿæ‚‰åŸºæœ¬çš„åŠ å¯†çŸ¥è¯†å’Œæ‰€éœ€çš„å®‰å…¨æªæ–½ã€‚</li><li>å¯†é’¥ç®¡ç†éå¸¸é‡è¦ï¼Œä¸æ°å½“çš„å¯†é’¥ç®¡ç†å¯èƒ½å¯¼è‡´å®‰å…¨æ¼æ´ã€‚</li><li>ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–å…¶ä»–å®‰å…¨æ‰‹æ®µå­˜å‚¨å¯†é’¥ï¼Œé¿å…åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¯†é’¥ã€‚</li></ol><p>ä»¥ä¸Šå°±æ˜¯å…³äº Node.js ä¸­ <code>Cipher</code> ç±»çš„è¯¦ç»†ä»‹ç»å’Œä¸€äº›å®é™…åº”ç”¨çš„ä¾‹å­ã€‚å¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼</p><h3 id="cipher-final-outputencoding" tabindex="-1"><a class="header-anchor" href="#cipher-final-outputencoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cipherfinaloutputencoding" target="_blank" rel="noopener noreferrer">cipher.final([outputEncoding])</a></span></a></h3><h3 id="cipher-getauthtag" tabindex="-1"><a class="header-anchor" href="#cipher-getauthtag"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#ciphergetauthtag" target="_blank" rel="noopener noreferrer">cipher.getAuthTag()</a></span></a></h3><p>Node.js ä¸­çš„ <code>cipher.getAuthTag()</code> æ–¹æ³•æ˜¯åœ¨ä½¿ç”¨åŠ å¯†æ¨¡å—æ—¶ä¸€ä¸ªéå¸¸é‡è¦çš„åŠŸèƒ½ï¼Œç‰¹åˆ«æ˜¯å½“ä½ åœ¨ä½¿ç”¨å¸¦æœ‰è®¤è¯æ¨¡å¼çš„å¯¹ç§°åŠ å¯†ç®—æ³•æ—¶ã€‚å¯¹ç§°åŠ å¯†ç®—æ³•æ„å‘³ç€åŠ å¯†å’Œè§£å¯†ä½¿ç”¨çš„æ˜¯ç›¸åŒçš„å¯†é’¥ã€‚</p><p>åœ¨æŸäº›åŠ å¯†æ¨¡å¼ä¸‹ï¼Œæ¯”å¦‚ GCMï¼ˆGalois/Counter Modeï¼‰ï¼ŒåŠ å¯†æ“ä½œé™¤äº†è¾“å‡ºåŠ å¯†åçš„æ•°æ®ä¹‹å¤–ï¼Œè¿˜ä¼šç”Ÿæˆä¸€ä¸ªé¢å¤–çš„â€œè®¤è¯æ ‡ç­¾â€(auth tag)ã€‚è¿™ä¸ªæ ‡ç­¾ç”¨äºéªŒè¯åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ•°æ®æ²¡æœ‰è¢«ç¯¡æ”¹ï¼Œç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§å’ŒçœŸå®æ€§ã€‚</p><p><code>cipher.getAuthTag()</code> æ–¹æ³•å°±æ˜¯ç”¨æ¥è·å–è¿™ä¸ªè®¤è¯æ ‡ç­¾çš„ã€‚åœ¨å®ŒæˆåŠ å¯†æ“ä½œåï¼Œä½ å¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ¥å¾—åˆ°ä¸€ä¸ª Buffer å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«äº†è®¤è¯æ ‡ç­¾ã€‚åœ¨è§£å¯†çš„æ—¶å€™ï¼Œä½ éœ€è¦æä¾›è¿™ä¸ªè®¤è¯æ ‡ç­¾ä»¥éªŒè¯æ•°æ®æ˜¯å¦æ˜¯æœ‰æ•ˆä¸”æœªè¢«ç¯¡æ”¹çš„ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨ Node.js åŠ å¯†æ¨¡å—çš„ç¤ºä¾‹ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>cipher.getAuthTag()</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é€‰æ‹©ä¸€ä¸ªç®—æ³•å’Œæ“ä½œæ¨¡å¼ï¼Œè¿™é‡Œé€‰ç”¨aes-256-gcm</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> algorithm</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;aes-256-gcm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// éšæœºç”Ÿæˆä¸€ä¸ªå¯†é’¥ï¼Œå¯¹äºaes-256-gcmï¼Œé•¿åº¦åº”è¯¥æ˜¯32å­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// éšæœºç”Ÿæˆä¸€ä¸ªåˆå§‹åŒ–å‘é‡ï¼ˆivï¼‰ï¼Œå¯¹äºGCMæ¨¡å¼ï¼Œé€šå¸¸æ˜¯12å­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª cipher å®ä¾‹è¿›è¡ŒåŠ å¯†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">algorithm</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡†å¤‡ä¸€äº›æ˜æ–‡æ•°æ®è¿›è¡ŒåŠ å¯†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> plaintext</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Hello, this is a secret message!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">plaintext</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–è®¤è¯æ ‡ç­¾</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> authTag</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getAuthTag</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Encrypted Data: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Authentication Tag: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">authTag</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ...</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¨åï¼Œè§£å¯†çš„æ—¶å€™è¦ç”¨åˆ°åŒæ ·çš„key, iv å’Œ authTag</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä»¥ä¸Šä»£ç ä¸­ï¼š</p><ol><li>æˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† Node.js çš„<code>crypto</code>æ¨¡å—ã€‚</li><li>ä¸ºäº†è¿›è¡ŒåŠ å¯†ï¼Œæˆ‘ä»¬é€‰æ‹©äº† AES-256-GCM ç®—æ³•ï¼Œå¹¶ç”Ÿæˆäº†æ‰€éœ€çš„å¯†é’¥å’Œåˆå§‹åŒ–å‘é‡ï¼ˆIVï¼‰ã€‚</li><li>ä½¿ç”¨è¿™ä¸ªç®—æ³•ã€å¯†é’¥å’Œ IV åˆ›å»ºäº†ä¸€ä¸ª cipher å¯¹è±¡ã€‚</li><li>å°†æ˜æ–‡æ•°æ®ï¼ˆplaintextï¼‰æ›´æ–°åˆ° cipher ä¸­ï¼Œå¹¶ä»¥åå…­è¿›åˆ¶æ ¼å¼ç»“æŸåŠ å¯†æ“ä½œï¼Œå¾—åˆ°åŠ å¯†æ•°æ®ã€‚</li><li>è°ƒç”¨<code>cipher.getAuthTag()</code>æ¥è·å¾—è®¤è¯æ ‡ç­¾ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²æ ¼å¼ã€‚</li></ol><p>æœ€åæ‰“å°å‡ºåŠ å¯†åçš„æ•°æ®å’Œè®¤è¯æ ‡ç­¾ã€‚åœ¨å®é™…çš„ç½‘ç»œé€šä¿¡æˆ–æ•°æ®å­˜å‚¨ä¸­ï¼Œä½ ä¼šå°†åŠ å¯†åçš„æ•°æ®å’Œè¿™ä¸ªè®¤è¯æ ‡ç­¾ä¸€èµ·å‘é€ç»™æ¥æ”¶æ–¹ï¼Œä»¥ä¾¿ä»–ä»¬èƒ½å¤ŸéªŒè¯æ•°æ®çš„å®Œæ•´æ€§å¹¶è¿›è¡Œè§£å¯†ã€‚</p><h3 id="cipher-setaad-buffer-options" tabindex="-1"><a class="header-anchor" href="#cipher-setaad-buffer-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#ciphersetaadbuffer-options" target="_blank" rel="noopener noreferrer">cipher.setAAD(buffer[, options])</a></span></a></h3><p><code>cipher.setAAD(buffer[, options])</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºåœ¨ä½¿ç”¨å¯¹ç§°åŠ å¯†ç®—æ³•è¿›è¡ŒåŠ å¯†æ—¶è®¾ç½®ä¸€ä¸ªå«åšâ€œé™„åŠ è®¤è¯æ•°æ®â€ï¼ˆAdditional Authenticated Dataï¼Œç®€ç§° AADï¼‰çš„å‚æ•°ã€‚è¿™ä¸ªåŠŸèƒ½ä¸»è¦ç”¨äºæä¾›è®¤è¯åŠ å¯†æ¨¡å¼ï¼Œæ¯”å¦‚ GCMï¼ˆGalois/Counter Modeï¼‰æˆ– CCMï¼ˆCounter with CBC-MACï¼‰ã€‚</p><p>åœ¨å¯¹ç§°åŠ å¯†ä¸­ï¼Œå‘é€è€…å’Œæ¥æ”¶è€…å…±äº«ä¸€ä¸ªå¯†é’¥ã€‚å‘é€è€…ç”¨è¿™ä¸ªå¯†é’¥æ¥åŠ å¯†æ¶ˆæ¯ï¼Œè€Œæ¥æ”¶è€…ç”¨åŒæ ·çš„å¯†é’¥æ¥è§£å¯†æ¶ˆæ¯ã€‚ä½†æ˜¯ï¼Œå¦‚æœæœ‰äººåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¿®æ”¹äº†åŠ å¯†çš„æ¶ˆæ¯ï¼Œæ¥æ”¶è€…é€šå¸¸æ— æ³•æ£€æµ‹åˆ°è¿™ä¸€ç‚¹ã€‚ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨è®¤è¯åŠ å¯†æ¨¡å¼ï¼Œåœ¨åŠ å¯†çš„åŒæ—¶éªŒè¯æ¶ˆæ¯çš„å®Œæ•´æ€§å’ŒçœŸå®æ€§ã€‚</p><p>è®¤è¯åŠ å¯†æ¨¡å¼ä¸ä»…éœ€è¦ä¸€ä¸ªå¯†é’¥å’Œä¸€ä¸ªåˆå§‹åŒ–å‘é‡ï¼ˆIVï¼‰ï¼Œè¿˜å¯ä»¥æ¥å—ä¸€ä¸ªé¢å¤–çš„å‚æ•° AADã€‚AAD ç”¨æ¥æä¾›é¢å¤–çš„ä¿æŠ¤æªæ–½ï¼šå³ä½¿æ”»å‡»è€…èƒ½å¤Ÿä»¥æŸç§æ–¹å¼ç¯¡æ”¹å¯†æ–‡ï¼Œæ²¡æœ‰ AAD ä»–ä»¬ä¹Ÿä¸èƒ½é€šè¿‡è®¤è¯æ£€æŸ¥ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒAAD å¹¶ä¸æ˜¯å¯†æ–‡çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒåªæ˜¯åœ¨åŠ å¯†è¿‡ç¨‹ä¸­ä½¿ç”¨ï¼Œç„¶ååœ¨è§£å¯†æ—¶å¿…é¡»æä¾›ç›¸åŒçš„ AAD æ‰èƒ½ç¡®ä¿è®¤è¯æˆåŠŸã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€åŒ–çš„ä¾‹å­æ¥è¯´æ˜ <code>cipher.setAAD(buffer[, options])</code> çš„ä½¿ç”¨ï¼š</p><ol><li>åŠ å¯†è¿‡ç¨‹ä¸­è®¾ç½® AADï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŠ å¯†å¯¹è±¡ï¼Œå¹¶å£°æ˜ä½¿ç”¨ GCM æ¨¡å¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-256-gcm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªéšæœºçš„ buffer ä½œä¸º AAD</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aad</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¿™æ˜¯ä¸€æ®µé™„åŠ æ•°æ®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½® AADï¼Œå¿…é¡»åœ¨ cipher.update() è°ƒç”¨ä¹‹å‰å®Œæˆ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setAAD</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">aad</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ cipher æ¥åŠ å¯†ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¿™æ˜¯è¦åŠ å¯†çš„æ¶ˆæ¯&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> finalBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–è®¤è¯æ ‡ç­¾ç”¨äºåç»­éªŒè¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> authTag</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getAuthTag</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>è§£å¯†è¿‡ç¨‹ä¸­æä¾›ç›¸åŒçš„ AADï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDecipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-256-gcm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®ä¸åŠ å¯†æ—¶ç›¸åŒçš„ AAD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setAAD</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">aad</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æä¾›åŠ å¯†æ—¶ç”Ÿæˆçš„è®¤è¯æ ‡ç­¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setAuthTag</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">authTag</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ decipher æ¥è§£å¯†ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> decrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœ AAD æˆ–è€…è®¤è¯æ ‡ç­¾æœ‰è¯¯ï¼Œå°†ä¼šæŠ›å‡ºé”™è¯¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºè§£å¯†åçš„åŸå§‹æ¶ˆæ¯</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªä½¿ç”¨ AES-256-GCM åŠ å¯†çš„ <code>cipher</code> å¯¹è±¡ï¼Œç„¶ååˆ›å»ºäº†ä¸€ä¸ªåŒ…å« AAD çš„ <code>Buffer</code> å¯¹è±¡ã€‚æˆ‘ä»¬ä½¿ç”¨ <code>cipher.setAAD(aad)</code> æ–¹æ³•è®¾ç½® AADï¼Œç„¶åè¿›è¡Œæ­£å¸¸çš„åŠ å¯†æµç¨‹ã€‚åœ¨è§£å¯†ç«¯ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ <code>decipher.setAAD(aad)</code> å†æ¬¡æä¾›ç›¸åŒçš„ AADï¼Œå¹¶ä¸”ç”¨ <code>decipher.setAuthTag(authTag)</code> æä¾›ä¹‹å‰ä¿å­˜çš„è®¤è¯æ ‡ç­¾æ¥ç¡®ä¿æ²¡äººåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ›´æ”¹è¿‡æ¶ˆæ¯ã€‚</p><p>è¯·æ³¨æ„ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ éœ€è¦å®‰å…¨åœ°å­˜å‚¨å¯†é’¥ï¼ˆ<code>secretKey</code>ï¼‰å’Œåˆå§‹åŒ–å‘é‡ï¼ˆ<code>iv</code>ï¼‰ï¼Œå¹¶ç¡®ä¿å®ƒä»¬åœ¨åŠ å¯†å’Œè§£å¯†è¿‡ç¨‹ä¸­ä¿æŒç§å¯†å’Œä¸€è‡´ã€‚æ­¤å¤–ï¼Œæ¯æ¬¡åŠ å¯†æ–°çš„æ•°æ®æ—¶éƒ½åº”è¯¥ä½¿ç”¨ä¸€ä¸ªæ–°çš„ IVã€‚</p><h3 id="cipher-setautopadding-autopadding" tabindex="-1"><a class="header-anchor" href="#cipher-setautopadding-autopadding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#ciphersetautopaddingautopadding" target="_blank" rel="noopener noreferrer">cipher.setAutoPadding([autoPadding])</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­ <code>cipher.setAutoPadding([autoPadding])</code> è¿™ä¸ªå‡½æ•°ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å¾—çŸ¥é“ <code>cipher</code> æ˜¯ Node.js é‡Œé¢ä¸€ä¸ªä¸åŠ å¯†ç›¸å…³çš„æ¨¡å—ï¼Œå®ƒæä¾›äº†æ•°æ®åŠ å¯†çš„åŠŸèƒ½ã€‚åœ¨ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸­ï¼Œ<code>Cipher</code> å¯¹è±¡æ˜¯ç”¨æ¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†çš„ã€‚</p><p>åŠ å¯†æœ‰å¾ˆå¤šç§ç®—æ³•ï¼Œæœ‰äº›éœ€è¦è¾“å…¥æ•°æ®çš„é•¿åº¦å¿…é¡»æ˜¯ç‰¹å®šçš„æ•°å€¼ï¼Œæ¯”å¦‚ 16 çš„å€æ•°ã€‚è¿™å°±æ˜¯æ‰€è°“çš„â€œå—åŠ å¯†â€ï¼ˆblock cipherï¼‰ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬éœ€è¦åŠ å¯†çš„æ•°æ®ä¸æ˜¯é‚£ä¸ªé•¿åº¦æ€ä¹ˆåŠå‘¢ï¼Ÿè¿™æ—¶å€™å°±éœ€è¦å¡«å……ï¼ˆpaddingï¼‰ã€‚</p><p><code>setAutoPadding</code> è¿™ä¸ªæ–¹æ³•å°±æ˜¯ç”¨æ¥å¼€å¯æˆ–å…³é—­è‡ªåŠ¨å¡«å……çš„åŠŸèƒ½çš„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒNode.js çš„ Cipher åœ¨åŠ å¯†æ—¶ä¼šè‡ªåŠ¨å¡«å……æ•°æ®åˆ°åˆé€‚çš„é•¿åº¦ã€‚å½“ä½ è°ƒç”¨ <code>setAutoPadding</code> æ–¹æ³•å¹¶ä¼ å…¥ <code>false</code> å‚æ•°æ—¶ï¼Œå®ƒä¼šå…³é—­è‡ªåŠ¨å¡«å……ï¼Œè¿™æ„å‘³ç€ä½ å¿…é¡»è‡ªå·±ç¡®ä¿æ•°æ®é•¿åº¦ç¬¦åˆè¦æ±‚ï¼Œå¦åˆ™åŠ å¯†ä¼šå¤±è´¥ã€‚</p><p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸ªå…·ä½“çš„ä¾‹å­ï¼š</p><p>å‡è®¾ä½ ä½¿ç”¨ä¸€ä¸ªå—åŠ å¯†ç®—æ³• AES256ï¼Œå®ƒè¦æ±‚æ•°æ®é•¿åº¦å¿…é¡»æ˜¯ 16 å­—èŠ‚çš„å€æ•°ã€‚å¦‚æœä½ è¦åŠ å¯†çš„æ–‡æœ¬æ˜¯ &quot;Hello, World!&quot;ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²åªæœ‰ 13 å­—èŠ‚é•¿ã€‚è‡ªåŠ¨å¡«å……ä¼šæŠŠå®ƒå¡«å……åˆ° 16 å­—èŠ‚ï¼Œå¯èƒ½ä¼šåœ¨åé¢æ·»åŠ ä¸‰ä¸ªç‰¹å®šçš„å­—ç¬¦ä½¿å…¶è¾¾åˆ°è¦æ±‚çš„é•¿åº¦ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-256-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å¯†é’¥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setAutoPadding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼€å¯è‡ªåŠ¨å¡«å……ï¼Œé»˜è®¤å°±æ˜¯å¼€å¯çš„</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;readable&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">read</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¾“å‡ºåŠ å¯†åçš„16è¿›åˆ¶å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å…¥éœ€è¦åŠ å¯†çš„æ–‡æœ¬</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª <code>cipher</code> æ¥åŠ å¯†æ–‡æœ¬ &quot;Hello, World!&quot;ã€‚ç”±äºæˆ‘ä»¬è°ƒç”¨äº† <code>setAutoPadding(true)</code>ï¼Œå³ä¾¿æˆ‘ä»¬æ²¡æœ‰æ˜¾å¼åœ°è®¾ç½®ï¼ŒCipher ä¹Ÿå°†è‡ªåŠ¨ä¸ºæˆ‘ä»¬å¡«å……é¢å¤–çš„å­—ç¬¦æ¥æ»¡è¶³åŠ å¯†ç®—æ³•çš„è¦æ±‚ã€‚</p><p>ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬çš„æ•°æ®å·²ç»æ˜¯æ­£ç¡®çš„é•¿åº¦æˆ–è€…æˆ‘ä»¬å¸Œæœ›ä½¿ç”¨è‡ªå®šä¹‰çš„å¡«å……æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨ <code>setAutoPadding(false)</code> æ¥å‘Šè¯‰ Cipher ä¸è¦è‡ªåŠ¨å¡«å……ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ...å‰é¢çš„ä»£ç ç›¸åŒ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setAutoPadding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å…³é—­è‡ªåŠ¨å¡«å……</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç„¶åç¡®ä¿ä½ çš„æ•°æ®é•¿åº¦æ˜¯æ­£ç¡®çš„ï¼Œæˆ–è€…ä½ è‡ªå·±æ‰‹åŠ¨å¡«å……åˆ°æ­£ç¡®çš„é•¿åº¦</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ...å‰©ä½™çš„ä»£ç </span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼Œå½“ä½ å…³é—­è‡ªåŠ¨å¡«å……æ—¶ï¼Œå¦‚æœä½ çš„æ•°æ®é•¿åº¦ä¸æ­£ç¡®ï¼ŒCipher å°†æ— æ³•æ­£ç¡®åŠ å¯†æ•°æ®ï¼Œä¸”å¯èƒ½ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>cipher.setAutoPadding([autoPadding])</code> æ˜¯ä¸€ä¸ªç”¨äºæ§åˆ¶åŠ å¯†è¿‡ç¨‹ä¸­æ˜¯å¦è‡ªåŠ¨å¡«å……æ•°æ®åˆ°åˆé€‚é•¿åº¦çš„å‡½æ•°ï¼Œä»¥ç¬¦åˆç‰¹å®šåŠ å¯†ç®—æ³•çš„éœ€æ±‚ã€‚</p><h3 id="cipher-update-data-inputencoding-outputencoding" tabindex="-1"><a class="header-anchor" href="#cipher-update-data-inputencoding-outputencoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cipherupdatedata-inputencoding-outputencoding" target="_blank" rel="noopener noreferrer">cipher.update(data[, inputEncoding][, outputEncoding])</a></span></a></h3><p>Node.js ä¸­çš„ <code>cipher.update(data[, inputEncoding][, outputEncoding])</code> æ–¹æ³•æ˜¯åŠ å¯†æ¨¡å—ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºåœ¨åŠ å¯†è¿‡ç¨‹ä¸­æ·»åŠ æ•°æ®åˆ° cipher å¯¹è±¡ï¼ˆä¸€ç§è¡¨ç¤ºåŠ å¯†æ“ä½œçš„å¯¹è±¡ï¼‰ã€‚è¿™ä¸ªæ–¹æ³•é€šå¸¸å’Œ <code>cipher.final()</code> æ–¹æ³•ç»“åˆä½¿ç”¨æ¥äº§ç”Ÿæœ€ç»ˆçš„åŠ å¯†æ•°æ®ã€‚</p><p>ä¸‹é¢æˆ‘å°†é€šè¿‡è§£é‡Šå‚æ•°ã€è¿”å›å€¼ä»¥åŠå®é™…çš„ä¾‹å­æ¥å¸®åŠ©ä½ ç†è§£è¿™ä¸ªæ–¹æ³•ã€‚</p><h3 id="å‚æ•°è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯´æ˜"><span>å‚æ•°è¯´æ˜ï¼š</span></a></h3><ul><li><strong>data</strong>ï¼šè¿™æ˜¯è¦åŠ å¯†çš„æ•°æ®ã€‚å®ƒå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…ä¸€ä¸ª Buffer å¯¹è±¡ã€‚</li><li><strong>inputEncoding</strong>ï¼ˆå¯é€‰ï¼‰ï¼šå¦‚æœ <code>data</code> æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå‚æ•°å®šä¹‰äº†å­—ç¬¦ä¸²çš„ç¼–ç æ–¹å¼ã€‚é€šå¸¸å¯ä»¥æ˜¯ <code>&#39;utf8&#39;</code>, <code>&#39;ascii&#39;</code>, <code>&#39;binary&#39;</code> ç­‰ã€‚</li><li><strong>outputEncoding</strong>ï¼ˆå¯é€‰ï¼‰ï¼šè¿™ä¸ªå‚æ•°å®šä¹‰åŠ å¯†åè¾“å‡ºæ•°æ®çš„æ ¼å¼ã€‚åŒæ ·å¯ä»¥æ˜¯ <code>&#39;hex&#39;</code>, <code>&#39;base64&#39;</code>, <code>&#39;binary&#39;</code> ç­‰ã€‚å¦‚æœæä¾›äº†è¿™ä¸ªå‚æ•°ï¼Œ<code>update()</code> æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªç¼–ç åçš„å­—ç¬¦ä¸²ï¼›å¦‚æœæ²¡æœ‰æä¾›è¿™ä¸ªå‚æ•°ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ª Buffer å¯¹è±¡ã€‚</li></ul><h3 id="è¿”å›å€¼" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼"><span>è¿”å›å€¼ï¼š</span></a></h3><ul><li><strong>è¿”å›å€¼</strong>ï¼šæ ¹æ® <code>outputEncoding</code> å‚æ•°çš„è®¾ç½®ï¼Œ<code>update()</code> æ–¹æ³•å¯èƒ½è¿”å›ä¸€ä¸ªå«æœ‰éƒ¨åˆ†åŠ å¯†ç»“æœçš„å­—ç¬¦ä¸²æˆ–è€… Buffer å¯¹è±¡ã€‚</li></ul><h3 id="ä½¿ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­"><span>ä½¿ç”¨ä¾‹å­ï¼š</span></a></h3><p>å‡è®¾ä½ æƒ³è¦åŠ å¯†ä¸€æ®µæ–‡æœ¬ <code>&quot;hello world&quot;</code> ä½¿ç”¨ AES-256-CBC åŠ å¯†ç®—æ³•ï¼Œå¹¶è¾“å‡ºä¸º base64 ç¼–ç çš„å­—ç¬¦ä¸²ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨ <code>cipher.update()</code> æ–¹æ³•æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡çš„æ­¥éª¤ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„å¯†é’¥ï¼ˆkeyï¼‰å’Œåˆå§‹åŒ–å‘é‡ï¼ˆivï¼‰è¿›è¡ŒåŠ å¯†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª cipher å®ä¾‹ï¼ŒæŒ‡å®šåŠ å¯†ç®—æ³•å’Œä¸Šé¢ç”Ÿæˆçš„ key å’Œ iv</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-256-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¦åŠ å¯†çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> textToEncrypt</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;hello world&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ update æ–¹æ³•åŠ å¯†æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">textToEncrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// final æ–¹æ³•å®Œæˆå‰©ä½™åŠ å¯†æ“ä½œå¹¶è¿”å›æœ€ç»ˆç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Encrypted text:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåŒ…å« Node.js å†…ç½®çš„ <code>crypto</code> æ¨¡å—ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªéšæœºçš„å¯†é’¥ <code>key</code> å’Œåˆå§‹åŒ–å‘é‡ <code>iv</code>ï¼Œè¿™ä¸¤ä¸ªå…ƒç´ æ˜¯å¯¹ç§°åŠ å¯†ä¸­å¿…éœ€çš„ã€‚å†æ¥ç€ï¼Œæˆ‘ä»¬åˆ©ç”¨è¿™äº›ä¿¡æ¯åˆ›å»ºäº†ä¸€ä¸ªåŠ å¯†å™¨ <code>cipher</code> å¯¹è±¡ï¼Œå¹¶æŒ‡å®šäº†ä½¿ç”¨ <code>aes-256-cbc</code> ç®—æ³•ã€‚</p><p>æ¥ç€ï¼Œæˆ‘ä»¬è°ƒç”¨ <code>cipher.update()</code> æ¥åŠ å¯†æ–‡æœ¬ &quot;hello world&quot;ï¼ŒåŒæ—¶æŒ‡å®šè¾“å…¥æ•°æ®çš„ç¼–ç æ˜¯ <code>utf8</code>ï¼Œè¾“å‡ºæ•°æ®çš„ç¼–ç æ˜¯ <code>base64</code>ã€‚æœ€åï¼Œæˆ‘ä»¬è°ƒç”¨ <code>cipher.final()</code> æ¥å®ŒæˆåŠ å¯†è¿‡ç¨‹ï¼Œå¹¶å°†æœ€åçš„åŠ å¯†æ•°æ®ä¹Ÿè½¬æ¢æˆ <code>base64</code> ç¼–ç ã€‚</p><p>æ€»ç»“èµ·æ¥ï¼Œ<code>cipher.update()</code> æ–¹æ³•å°±æ˜¯ç”¨äºåœ¨åŠ å¯†è¿‡ç¨‹ä¸­å¢åŠ æ•°æ®çš„ï¼Œè€Œ <code>cipher.final()</code> ç”¨äºç»“æŸåŠ å¯†è¿‡ç¨‹å¹¶è·å–å‰©ä½™çš„åŠ å¯†æ•°æ®ã€‚ä¸¤è€…ç»“åˆä½¿ç”¨å¯ä»¥åŠ å¯†ä»»æ„é•¿åº¦çš„æ•°æ®ã€‚</p><h2 id="class-decipher" tabindex="-1"><a class="header-anchor" href="#class-decipher"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#class-decipher" target="_blank" rel="noopener noreferrer">Class: Decipher</a></span></a></h2><p><code>Decipher</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºå¯¹æ•°æ®è¿›è¡Œè§£å¯†ã€‚å½“ä½ æ¥æ”¶åˆ°ç»è¿‡åŠ å¯†çš„æ•°æ®ï¼Œå¹¶ä¸”å¸Œæœ›å°†å…¶è¿˜åŸæˆåŸå§‹å†…å®¹æ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨è§£å¯†æŠ€æœ¯ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä½ éœ€è¦ä¸€ä¸ªå¯†é’¥ï¼ˆkeyï¼‰å’Œå¯èƒ½çš„åˆå§‹å‘é‡ï¼ˆIVï¼‰ï¼Œå®ƒä»¬åœ¨åŠ å¯†æ—¶è¢«ç”¨æ¥æ··æ·†æ•°æ®ï¼Œç°åœ¨åˆ™ç”¨æ¥æ¢å¤æ•°æ®ã€‚</p><p>åœ¨ Node</p><h3 id="decipher-final-outputencoding" tabindex="-1"><a class="header-anchor" href="#decipher-final-outputencoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#decipherfinaloutputencoding" target="_blank" rel="noopener noreferrer">decipher.final([outputEncoding])</a></span></a></h3><p><code>decipher.final([outputEncoding])</code> æ˜¯ Node.js ä¸­å†…ç½® <code>crypto</code> æ¨¡å—çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå±äºè§£å¯†æ“ä½œçš„ä¸€éƒ¨åˆ†ã€‚åœ¨ Node.js ä¸­è¿›è¡ŒåŠ å¯†å’Œè§£å¯†æ—¶ï¼Œé€šå¸¸ä¼šç”¨åˆ° <code>cipher</code> å’Œ <code>decipher</code> è¿™ä¸¤ä¸ªç±»ï¼Œåˆ†åˆ«ç”¨äºåŠ å¯†å’Œè§£å¯†æ•°æ®ã€‚</p><p>å½“ä½ ä½¿ç”¨ <code>crypto.createDecipher</code> æˆ– <code>crypto.createDecipheriv</code> æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ª <code>Decipher</code> çš„å®ä¾‹ä¹‹åï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªå®ä¾‹å¯¹æ•°æ®è¿›è¡Œè§£å¯†ã€‚è§£å¯†æ“ä½œé€šå¸¸åˆ†ä¸ºå‡ æ­¥ï¼š</p><ol><li>ä½¿ç”¨ <code>decipher.update</code> æ–¹æ³•æ¥é€å—æ·»åŠ è¢«åŠ å¯†çš„æ•°æ®ã€‚</li><li>ä½¿ç”¨ <code>decipher.final</code> æ¥å¾—åˆ°æœ€åä¸€éƒ¨åˆ†è§£å¯†åçš„æ•°æ®ï¼Œå¹¶ä¸”æ ‡å¿—ç€è§£å¯†æ“ä½œçš„å®Œæˆã€‚</li></ol><p>å…·ä½“æ¥è¯´ï¼Œ<code>decipher.final([outputEncoding])</code> æ–¹æ³•æ˜¯ç”¨æ¥å¤„ç†è§£å¯†è¿‡ç¨‹ä¸­çš„æœ€åä¸€å—æ•°æ®çš„ã€‚å¦‚æœåœ¨è§£å¯†è¿‡ç¨‹ä¸­æ‰€æœ‰æ•°æ®å—éƒ½å·²ç»é€šè¿‡ <code>decipher.update()</code> å¤„ç†è¿‡äº†ï¼Œé‚£ä¹ˆ <code>decipher.final()</code> å°†å¤„ç†ä»»ä½•å‰©ä½™çš„åŠ å¯†æ•°æ®ï¼Œå¹¶è¿”å›æœ€ç»ˆçš„è§£å¯†ç»“æœã€‚å‚æ•° <code>outputEncoding</code> æ˜¯å¯é€‰çš„ï¼Œå®ƒæŒ‡å®šäº†è¾“å‡ºæ ¼å¼ï¼Œæ¯”å¦‚ <code>&#39;utf8&#39;</code>, <code>&#39;ascii&#39;</code>, <code>&#39;binary&#39;</code> ç­‰ã€‚</p><p>ä¸‹é¢é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜å…¶ç”¨æ³•ï¼š</p><p>å‡è®¾ä½ æœ‰ä¸€æ®µä½¿ç”¨ AES-256-CBC ç®—æ³•åŠ å¯†çš„æ–‡æœ¬ï¼Œå¹¶ä¸”ä½ çŸ¥é“åŠ å¯†æ—¶ä½¿ç”¨çš„å¯†é’¥å’Œ IVï¼ˆåˆå§‹åŒ–å‘é‡ï¼‰ã€‚ç°åœ¨ä½ æƒ³è¦è§£å¯†è¿™æ®µæ–‡æœ¬ã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦å¼•å…¥ <code>crypto</code> æ¨¡å—ï¼Œå¹¶ä¸”åˆ›å»ºè§£å¯†å™¨å®ä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œæ˜¯ä½ çš„åŠ å¯†å¯†é’¥å’Œ IVï¼Œé€šå¸¸æ˜¯ Buffer ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä½ çš„256ä½å¯†é’¥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä½ çš„16ä½IV&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªè§£å¯†å™¨å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDecipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-256-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä½ åŠ å¯†åçš„æ•°æ®ï¼Œç±»å‹ä¸ºBuffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encryptedText</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åœ¨è¿™é‡Œæ”¾å…¥ä½ çš„åŠ å¯†æ•°æ®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œä½ å¯ä»¥å¼€å§‹è§£å¯†ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> decrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ update æ–¹æ³•é€æ­¥æ·»åŠ åŠ å¯†æ•°æ®ï¼Œå¯ä»¥å¤šæ¬¡è°ƒç”¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encryptedText</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æœ€åä½¿ç”¨ final æ–¹æ³•å®Œæˆè§£å¯†ï¼Œå¹¶æ‹¼æ¥ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è§£å¯†åçš„æ•°æ®ï¼š&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>update</code> æ–¹æ³•å°†åŠ å¯†æ•°æ®ä¼ å…¥è§£å¯†å™¨ï¼Œå¹¶æŒ‡å®šäº†è¾“å…¥çš„æ ¼å¼ä¸º <code>&#39;hex&#39;</code>ï¼ˆå‡è®¾åŠ å¯†æ•°æ®ä»¥åå…­è¿›åˆ¶çš„å½¢å¼å­˜åœ¨ï¼‰ï¼Œè¾“å‡ºçš„æ ¼å¼ä¸º <code>&#39;utf8&#39;</code>ã€‚éšåï¼Œæˆ‘ä»¬è°ƒç”¨ <code>final</code> æ–¹æ³•è·å¾—å‰©ä½™çš„è§£å¯†æ•°æ®ï¼Œå¹¶å°†å…¶ä»¥ <code>&#39;utf8&#39;</code> æ ¼å¼è¾“å‡ºï¼Œä»è€Œå®Œæˆæ•´ä¸ªè§£å¯†è¿‡ç¨‹ã€‚</p><p>è¯·æ³¨æ„ï¼Œé”™è¯¯åœ°ä½¿ç”¨ <code>decipher.final()</code> å¯èƒ½å¯¼è‡´æŠ›å‡ºé”™è¯¯ï¼Œä¾‹å¦‚å¦‚æœåŠ å¯†æ•°æ®æŸåæˆ–è€…å¯†é’¥/IV ä¸æ­£ç¡®ï¼Œåˆ™è§£å¯†è¿‡ç¨‹å¯èƒ½å¤±è´¥ã€‚å› æ­¤ï¼Œåœ¨å®é™…åº”ç”¨ä¸­éœ€è¦å°å¿ƒå¤„ç†è¿™äº›å¯èƒ½å‡ºç°çš„å¼‚å¸¸æƒ…å†µã€‚</p><h3 id="decipher-setaad-buffer-options" tabindex="-1"><a class="header-anchor" href="#decipher-setaad-buffer-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#deciphersetaadbuffer-options" target="_blank" rel="noopener noreferrer">decipher.setAAD(buffer[, options])</a></span></a></h3><p>Node.js ä¸­çš„<code>decipher.setAAD(buffer[, options])</code>æ–¹æ³•æ˜¯ç”¨äºå¯†ç å­¦æ“ä½œçš„ä¸€éƒ¨åˆ†ï¼Œç‰¹åˆ«æ˜¯åœ¨ä½¿ç”¨å¯¹ç§°åŠ å¯†ç®—æ³•è¿›è¡ŒåŠ å¯†é€šä¿¡æ—¶çš„ä¸€ä¸ªæ­¥éª¤ã€‚è¿™ä¸ªæ–¹æ³•å±äº Node.js çš„<code>crypto</code>æ¨¡å—ï¼Œè¯¥æ¨¡å—æä¾›äº†å„ç§åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯¹æ•°æ®çš„åŠ å¯†å’Œè§£å¯†ã€‚</p><p>é¦–å…ˆï¼Œéœ€è¦äº†è§£å‡ ä¸ªæ¦‚å¿µï¼š</p><ol><li><p><strong>å¯¹ç§°åŠ å¯†</strong>ï¼šè¿™æ˜¯ä¸€ç§åŠ å¯†æ–¹æ³•ï¼ŒåŠ å¯†å’Œè§£å¯†æ•°æ®éƒ½ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ã€‚å¸¸è§çš„å¯¹ç§°åŠ å¯†ç®—æ³•æœ‰ AES å’Œ DESã€‚</p></li><li><p><strong>AAD (Additional Authenticated Data)</strong>ï¼šåœ¨è¿›è¡ŒåŠ å¯†æ“ä½œæ—¶ï¼ŒAAD æ˜¯ä¸å¯†æ–‡ä¸€èµ·ä¼ è¾“ä½†ä¸è¢«åŠ å¯†çš„é¢å¤–æ•°æ®ã€‚å®ƒç”¨äºå¢å¼ºå®‰å…¨æ€§ï¼Œå› ä¸ºå®ƒå…è®¸æ¥æ”¶æ–¹éªŒè¯è¿™äº›é™„åŠ æ•°æ®çš„å®Œæ•´æ€§å’ŒçœŸå®æ€§ï¼Œä»è€Œç¡®ä¿æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚</p></li><li><p><strong>buffer</strong>ï¼šåœ¨ Node.js ä¸­ï¼Œ<code>Buffer</code>ç±»æ˜¯ä¸€ä¸ªå…¨å±€ç±»å‹ï¼Œç”¨äºç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµã€‚</p></li></ol><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹<code>decipher.setAAD(buffer[, options])</code>æ–¹æ³•çš„ä½œç”¨ï¼š</p><p>å½“ä½ è¦è§£å¯†ä¸€æ¡æ¶ˆæ¯æ—¶ï¼Œå¦‚æœè¿™æ¡æ¶ˆæ¯åœ¨åŠ å¯†æ—¶é™„å¸¦äº† AADï¼Œåˆ™åœ¨è§£å¯†è¿‡ç¨‹ä¸­ï¼Œä½ å¿…é¡»æŒ‡å®šç›¸åŒçš„ AADã€‚é€šè¿‡è°ƒç”¨<code>decipher.setAAD()</code>æ–¹æ³•ï¼Œå¹¶å°†ä¹‹å‰åŠ å¯†æ—¶ä½¿ç”¨çš„ AAD ä¼ å…¥ï¼Œç¡®ä¿è§£å¯†å™¨çŸ¥é“è¿™ä¸ªé¢å¤–çš„è®¤è¯æ•°æ®ï¼Œä»¥ä¾¿æ­£ç¡®åœ°éªŒè¯å¹¶æœ€ç»ˆè§£å¯†è¿™ä¸ªæ¶ˆæ¯ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå±•ç¤ºå¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨<code>decipher.setAAD</code>æ–¹æ³•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯†é’¥å’Œåˆå§‹å‘é‡é€šå¸¸ç”±åŠ å¯†ç¨‹åºç”Ÿæˆï¼Œå¹¶åœ¨åŠ å¯†å’Œè§£å¯†æ—¶å‡éœ€è¦ä½¿ç”¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯¹äºAES-256ï¼Œå¯†é’¥åº”è¯¥æ˜¯32å­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// AESçš„åˆå§‹å‘é‡å¤§å°é€šå¸¸æ˜¯16å­—èŠ‚</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æœ‰ä¸€æ®µé¢å¤–çš„éªŒè¯æ•°æ®(AAD)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aad</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;é¢å¤–éªŒè¯æ•°æ®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŠ å¯†å™¨è®¾ç½®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-256-gcm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setAAD</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">aad</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æœ‰ä¸€æ®µéœ€è¦åŠ å¯†çš„æ˜æ–‡æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> plaintext</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;è¿™æ˜¯ä¸€æ®µéœ€è¦è¢«åŠ å¯†çš„ä¿¡æ¯&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">plaintext</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> authTag</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getAuthTag</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–è®¤è¯æ ‡ç­¾ä»¥ç”¨äºä¹‹åçš„éªŒè¯</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è§£å¯†å™¨è®¾ç½®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDecipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-256-gcm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setAAD</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">aad</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®AADï¼Œå®ƒå¿…é¡»ä¸åŠ å¯†æ—¶ä½¿ç”¨çš„AADåŒ¹é…</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setAuthTag</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">authTag</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®è®¤è¯æ ‡ç­¾</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è§£å¯†æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> decrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºåŸå§‹çš„æ˜æ–‡ä¿¡æ¯</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŠ å¯†å™¨<code>cipher</code>å’Œè§£å¯†å™¨<code>decipher</code>ï¼Œç»™å®ƒä»¬æä¾›äº†å¯†é’¥ã€åˆå§‹å‘é‡å’Œ AADã€‚åœ¨åŠ å¯†é˜¶æ®µï¼Œæˆ‘ä»¬ä½¿ç”¨<code>.setAAD(aad)</code>å°† AAD ä¿¡æ¯é™„åŠ åˆ°åŠ å¯†å™¨ä¸Šã€‚ç„¶åï¼Œæˆ‘ä»¬å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œå¹¶è·å–ä¸€ä¸ªè®¤è¯æ ‡ç­¾ï¼ˆ<code>authTag</code>ï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªé‡è¦çš„éƒ¨åˆ†ï¼Œç”¨äºåç»­éªŒè¯å¯†æ–‡çš„å®Œæ•´æ€§ã€‚</p><p>åœ¨è§£å¯†é˜¶æ®µï¼Œæˆ‘ä»¬å†æ¬¡ä½¿ç”¨<code>.setAAD(aad)</code>è®¾ç½® AADï¼Œç„¶åä½¿ç”¨ç›¸åŒçš„å¯†é’¥å’Œåˆå§‹å‘é‡ï¼Œä»¥åŠæˆ‘ä»¬ä¹‹å‰è·å–åˆ°çš„<code>authTag</code>æ¥è§£å¯†æ•°æ®ã€‚å¦‚æœ AAD æˆ–<code>authTag</code>ä¸æ­£ç¡®ï¼Œè§£å¯†è¿‡ç¨‹å°†ä¼šå¤±è´¥ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±çŸ¥é“æ•°æ®åœ¨ä¼ è¾“æˆ–å­˜å‚¨è¿‡ç¨‹ä¸­å¯èƒ½é­åˆ°äº†ç¯¡æ”¹ã€‚</p><h3 id="decipher-setauthtag-buffer-encoding" tabindex="-1"><a class="header-anchor" href="#decipher-setauthtag-buffer-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#deciphersetauthtagbuffer-encoding" target="_blank" rel="noopener noreferrer">decipher.setAuthTag(buffer[, encoding])</a></span></a></h3><p><code>decipher.setAuthTag(buffer[, encoding])</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨äºè§£å¯†æ•°æ®æ—¶è®¾ç½®è®¤è¯æ ‡ç­¾ï¼ˆauthentication tagï¼‰ã€‚è¿™ä¸ªæ–¹æ³•é€šå¸¸ä¸åŠ å¯†ç®—æ³•ç»“åˆä½¿ç”¨ï¼Œæ¯”å¦‚ AES-GCM æˆ–è€… ChaCha20-Poly1305 è¿™ç±»æ”¯æŒåŠ å¯†å’Œè®¤è¯åŠŸèƒ½çš„ç®—æ³•ã€‚</p><p>åœ¨å¯¹ç§°åŠ å¯†ä¸­ï¼Œå‘é€æ–¹ä¼šä½¿ç”¨ä¸€ä¸ªå¯†é’¥æ¥åŠ å¯†æ•°æ®ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªé¢å¤–çš„â€œè®¤è¯æ ‡ç­¾â€ï¼ˆAuth Tagï¼‰ç”¨äºéªŒè¯æ•°æ®çš„å®Œæ•´æ€§å’ŒçœŸå®æ€§ã€‚æ¥æ”¶æ–¹æ”¶åˆ°åŠ å¯†æ•°æ®åï¼Œéœ€è¦ç”¨åŒä¸€ä¸ªå¯†é’¥è§£å¯†æ•°æ®ï¼Œå¹¶ç”¨ç›¸åŒçš„æ–¹å¼è®¡ç®—è®¤è¯æ ‡ç­¾ä»¥éªŒè¯æ•°æ®æ²¡æœ‰è¢«ç¯¡æ”¹è¿‡ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œ<code>decipher.setAuthTag</code> æ–¹æ³•ç”¨äºå‘è§£å¯†å™¨æä¾›è¿™ä¸ªåœ¨åŠ å¯†é˜¶æ®µç”Ÿæˆçš„è®¤è¯æ ‡ç­¾ã€‚åœ¨è§£å¯†è¿‡ç¨‹çš„æœ€åï¼ŒNode.js ä¼šä½¿ç”¨è¿™ä¸ªæ ‡ç­¾æ¥éªŒè¯æ•°æ®æ˜¯å¦æœ‰æ•ˆã€‚</p><p>ä¸‹é¢æ˜¯ä½¿ç”¨ <code>decipher.setAuthTag</code> çš„ä¸€ä¸ªåŸºæœ¬ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿçš„åŠ å¯†æ•°æ®å’Œè®¤è¯æ ‡ç­¾ï¼ˆé€šå¸¸è¿™äº›å€¼ç”±åŠ å¯†ç«¯æä¾›ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encryptedData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åŠ å¯†æ•°æ®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> authTag</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è®¤è¯æ ‡ç­¾&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŠ å¯†ä½¿ç”¨çš„å¯†é’¥å’Œåˆå§‹åŒ–å‘é‡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯†é’¥é•¿åº¦åº”è¯¥åŒ¹é…æ‰€é€‰ç®—æ³•è¦æ±‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆå§‹åŒ–å‘é‡é•¿åº¦å–å†³äºç®—æ³•</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºè§£å¯†å™¨å®ä¾‹ï¼ŒæŒ‡å®šç®—æ³•å’Œå¯†é’¥ã€åˆå§‹åŒ–å‘é‡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDecipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-256-gcm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®è®¤è¯æ ‡ç­¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setAuthTag</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">authTag</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿›è¡Œè§£å¯†æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> decryptedData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encryptedData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decryptedData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// final è°ƒç”¨å°†å®Œæˆè§£å¯†å¹¶éªŒè¯è®¤è¯æ ‡ç­¾</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decryptedData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºè§£å¯†åçš„æ•°æ®</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•è®¾ç½®è®¤è¯æ ‡ç­¾ï¼Œå¹¶è¿›è¡Œè§£å¯†æ“ä½œã€‚å®é™…ä¸­ï¼ŒåŠ å¯†æ•°æ®å’Œè®¤è¯æ ‡ç­¾ä¼šä»åŠ å¯†æ–¹é‚£é‡Œå®‰å…¨åœ°ä¼ é€’åˆ°è§£å¯†æ–¹ã€‚å¦‚æœè§£å¯†è¿‡ç¨‹ä¸­å‘ç°è®¤è¯æ ‡ç­¾ä¸æ­£ç¡®ï¼Œ<code>decipher.final()</code> ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè¡¨æ˜æ•°æ®å¯èƒ½é­åˆ°ç¯¡æ”¹æˆ–è€…å¯†é’¥é”™è¯¯ï¼Œä»è€Œç¡®ä¿æ•°æ®çš„å®‰å…¨æ€§ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä»¥ä¸Šä»£ç ä¸­çš„ <code>&#39;åŠ å¯†æ•°æ®&#39;</code> å’Œ <code>&#39;è®¤è¯æ ‡ç­¾&#39;</code> åº”ä¸ºå®é™…åŠ å¯†è¿‡ç¨‹ä¸­å¾—åˆ°çš„å€¼ï¼Œè¿™é‡Œçš„å­—ç¬¦ä¸²ä»…ç”¨äºç¤ºä¾‹ã€‚åŒæ ·ï¼Œ<code>key</code> å’Œ <code>iv</code>ï¼ˆå³å¯†é’¥å’Œåˆå§‹åŒ–å‘é‡ï¼‰é€šå¸¸ä¹Ÿæ˜¯é¢„å…ˆçº¦å®šå¥½çš„æˆ–é€šè¿‡å®‰å…¨çš„å¯†é’¥äº¤æ¢æœºåˆ¶è·å¾—çš„ã€‚</p><h3 id="decipher-setautopadding-autopadding" tabindex="-1"><a class="header-anchor" href="#decipher-setautopadding-autopadding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#deciphersetautopaddingautopadding" target="_blank" rel="noopener noreferrer">decipher.setAutoPadding([autoPadding])</a></span></a></h3><p><code>decipher.setAutoPadding([autoPadding])</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå±äº <code>crypto</code> æ¨¡å—ã€‚è¿™ä¸ªæ¨¡å—æä¾›äº†åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å„ç§åŠ è§£å¯†ç®—æ³•çš„å®ç°ã€‚åœ¨åŠ å¯†å’Œè§£å¯†æ•°æ®çš„æ—¶å€™ï¼Œæœ‰æ—¶éœ€è¦å¯¹æ•°æ®è¿›è¡Œå¡«å…… (padding)ï¼Œä»¥ç¡®ä¿åŠ å¯†çš„æ•°æ®å—å¤§å°æ˜¯å›ºå®šçš„ã€‚</p><p>åœ¨å—åŠ å¯†ä¸­ï¼ˆæ¯”å¦‚ä½¿ç”¨ AES ç®—æ³•ï¼‰ï¼Œæ•°æ®å¿…é¡»åˆ†æˆç‰¹å®šå¤§å°çš„å—ã€‚å¦‚æœæœ€åä¸€ä¸ªæ•°æ®å—ä¸è¶³ä»¥å¡«æ»¡æ‰€éœ€çš„å—å¤§å°ï¼Œå°±ä¼šç”¨é¢å¤–çš„æ•°æ®æ¥å¡«å……å®ƒã€‚ç›¸åçš„ï¼Œåœ¨è§£å¯†æ—¶ï¼Œä½ éœ€è¦å°†è¿™äº›å¡«å……æ•°æ®ç§»é™¤ï¼Œä»¥è¿˜åŸå‡ºåŸå§‹çš„ä¿¡æ¯ã€‚</p><p><code>setAutoPadding</code> æ–¹æ³•å…è®¸ä½ æ§åˆ¶è§£å¯†æ“ä½œæ˜¯å¦åº”è‡ªåŠ¨å»é™¤è¿™äº›å¡«å……çš„æ•°æ®ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>autoPadding</code> æ˜¯å¼€å¯çš„ï¼Œè¿™æ„å‘³ç€åœ¨è§£å¯†æ—¶ä¼šè‡ªåŠ¨å»é™¤å¡«å……æ•°æ®ã€‚</p><p>å‚æ•° <code>autoPadding</code> æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼š</p><ul><li>å¦‚æœè®¾ç½®ä¸º <code>true</code> æˆ–ä¸æä¾›ä»»ä½•å‚æ•°ï¼Œè§£å¯†æ—¶å°†è‡ªåŠ¨å»é™¤å¡«å……ã€‚</li><li>å¦‚æœè®¾ç½®ä¸º <code>false</code>ï¼Œè§£å¯†æ—¶ä¸ä¼šå»é™¤å¡«å……ï¼Œè¿™é€šå¸¸ç”¨äºæŸäº›ç‰¹æ®Šåœºæ™¯ï¼Œä¾‹å¦‚å½“ä½ æ˜ç¡®çŸ¥é“æ•°æ®æ²¡æœ‰ä½¿ç”¨æ ‡å‡†çš„å¡«å……æ–¹å¼æ—¶ã€‚</li></ul><p>ä¸¾ä¾‹è¯´æ˜ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;crypto&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŠ å¯†è¿‡çš„æ•°æ®å—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encryptedData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> ...</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œæ˜¯ä¸€ä¸²åŠ å¯†åçš„æ•°æ®</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è§£å¯†æ—¶ä½¿ç”¨çš„å¯†é’¥å’Œåˆå§‹åŒ–å‘é‡(IV)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> ...</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> ...</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆå§‹åŒ–å‘é‡</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª decipher å®ä¾‹ï¼Œä½¿ç”¨ AES-256-CBC åŠ å¯†ç®—æ³•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDecipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;aes-256-cbc&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®è‡ªåŠ¨å¡«å……</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœä½ æƒ³è¦è‡ªåŠ¨å»é™¤å¡«å……ï¼Œå¯ä»¥è¿™æ ·è®¾ç½®ï¼š</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setAutoPadding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™å…¶å®æ˜¯å¤šä½™çš„ï¼Œå› ä¸ºè¿™æ˜¯é»˜è®¤è¡Œä¸º</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ–è€…ï¼Œå¦‚æœä½ ä¸å¸Œæœ›è‡ªåŠ¨å»é™¤å¡«å……ï¼Œå¯ä»¥è¿™æ ·è®¾ç½®ï¼š</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setAutoPadding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ decipher å¯¹æ•°æ®è¿›è¡Œè§£å¯†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> decrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encryptedData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;hex&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;utf8&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;utf8&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºè§£å¯†åçš„åŸæ–‡</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† <code>crypto</code> æ¨¡å—ï¼Œå¹¶åˆ›å»ºäº†ä¸€ä¸ªç”¨äºè§£å¯†çš„ <code>decipher</code> å¯¹è±¡ã€‚æˆ‘ä»¬ä½¿ç”¨äº† <code>createDecipheriv</code> æ–¹æ³•ï¼Œå¹¶ä¼ å…¥äº†åŠ å¯†ç®—æ³•ã€å¯†é’¥å’Œåˆå§‹åŒ–å‘é‡ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨ <code>setAutoPadding</code> æ–¹æ³•æ¥è®¾ç½®æ˜¯å¦åº”è‡ªåŠ¨å»é™¤å¡«å……æ•°æ®ã€‚æœ€åæˆ‘ä»¬è°ƒç”¨ <code>update</code> å’Œ <code>final</code> æ–¹æ³•å¯¹åŠ å¯†çš„æ•°æ®è¿›è¡Œè§£å¯†ï¼Œå¹¶å°†è§£å¯†ç»“æœè¾“å‡ºåˆ°æ§åˆ¶å°ã€‚</p><p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¸éœ€è¦æ‰‹åŠ¨è®¾ç½® <code>setAutoPadding</code>ï¼Œå› ä¸ºé»˜è®¤çš„è‡ªåŠ¨å¡«å……è¡Œä¸ºé€‚ç”¨äºå¤§å¤šæ•°æ ‡å‡†çš„åŠ å¯†æ–¹æ¡ˆã€‚åªæœ‰åœ¨éå¸¸ç‰¹æ®Šçš„æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½éœ€è¦å…³é—­å®ƒã€‚</p><h3 id="decipher-update-data-inputencoding-outputencoding" tabindex="-1"><a class="header-anchor" href="#decipher-update-data-inputencoding-outputencoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#decipherupdatedata-inputencoding-outputencoding" target="_blank" rel="noopener noreferrer">decipher.update(data[, inputEncoding][, outputEncoding])</a></span></a></h3><p>Node.js çš„ <code>crypto</code> æ¨¡å—æä¾›äº†åŠ å¯†ç›¸å…³çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ•°æ®çš„åŠ å¯†å’Œè§£å¯†ã€‚åœ¨è¿™ä¸ªæ¨¡å—ä¸­ï¼Œ<code>decipher.update()</code> æ–¹æ³•æ˜¯ç”¨æ¥å°†åŠ å¯†åçš„æ•°æ®ï¼ˆå¯†æ–‡ï¼‰è½¬æ¢å›åŸå§‹çš„å¯è¯»å½¢å¼ï¼ˆæ˜æ–‡ï¼‰ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒå°±æ˜¯è§£å¯†è¿‡ç¨‹ä¸­çš„ä¸€ä¸ªæ­¥éª¤ã€‚</p><p><code>decipher.update()</code> æ–¹æ³•æ¥æ”¶å‡ ä¸ªå‚æ•°ï¼š</p><ol><li><code>data</code>ï¼šè¿™æ˜¯ä½ æƒ³è¦è§£å¯†çš„æ•°æ®ï¼ˆå¯†æ–‡ï¼‰ã€‚</li><li><code>inputEncoding</code>ï¼šè¿™æ˜¯ä¼ å…¥æ•°æ®çš„ç¼–ç æ ¼å¼ï¼ˆå¯é€‰çš„ï¼‰ï¼Œä¾‹å¦‚ &#39;hex&#39;ã€&#39;base64&#39; ç­‰ã€‚å¦‚æœä½ çš„æ•°æ®æ˜¯å­—ç¬¦ä¸²å½¢å¼çš„å¯†æ–‡ï¼Œéœ€è¦æŒ‡å®šè¿™ä¸ªå‚æ•°ï¼›å¦‚æœä½ çš„æ•°æ®æ˜¯ä¸€ä¸ª Bufferï¼Œé‚£ä¹ˆå°±å¯ä»¥çœç•¥è¿™ä¸ªå‚æ•°ã€‚</li><li><code>outputEncoding</code>ï¼šè¿™æ˜¯è¾“å‡ºæ•°æ®çš„ç¼–ç æ ¼å¼ï¼ˆå¯é€‰çš„ï¼‰ï¼ŒåŒæ ·å¯ä»¥æ˜¯ &#39;utf8&#39;, &#39;ascii&#39;, &#39;latin1&#39; ç­‰ã€‚å¦‚æœä½ æƒ³è¦å¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²å½¢å¼çš„æ˜æ–‡ï¼Œéœ€è¦æŒ‡å®šè¿™ä¸ªå‚æ•°ï¼›å¦‚æœä½ æƒ³å¾—åˆ°ä¸€ä¸ª Bufferï¼Œé‚£ä¹ˆå¯ä»¥çœç•¥è¿™ä¸ªå‚æ•°ã€‚</li></ol><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥çœ‹å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ã€‚</p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸²ç”¨ AES-256-CBC åŠ å¯†ç®—æ³•åŠ å¯†çš„æ•°æ®ï¼Œå¹¶ä¸”æˆ‘ä»¬å·²ç»æœ‰äº†ç›¸åº”çš„å¯†é’¥å’Œåˆå§‹å‘é‡ï¼ˆIVï¼‰ã€‚æˆ‘ä»¬æƒ³è¦è§£å¯†å¾—åˆ°åŸå§‹çš„æ˜æ–‡ä¿¡æ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯†æ–‡ï¼ˆé€šå¸¸æ˜¯åœ¨åŠ å¯†è¿‡ç¨‹ä¸­ç”Ÿæˆçš„ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encryptedText</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;9b8b7...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä¸€ä¸ªåå…­è¿›åˆ¶çš„å­—ç¬¦ä¸²</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è§£å¯†æ‰€éœ€çš„å¯†é’¥å’Œåˆå§‹å‘é‡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;your-secret-key-here&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;your-initialization-vector&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»º decipher å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDecipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-256-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼€å§‹è§£å¯†è¿‡ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> decrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encryptedText</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è§£å¯†åçš„æ˜æ–‡: &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä¾‹å­é¦–å…ˆè½½å…¥ Node.js çš„ <code>crypto</code> æ¨¡å—ã€‚ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰äº†å¯†æ–‡ã€å¯†é’¥å’Œåˆå§‹å‘é‡ã€‚æˆ‘ä»¬ä½¿ç”¨ <code>createDecipheriv()</code> æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ª <code>decipher</code> å®ä¾‹ï¼Œå¹¶æŒ‡å®šäº†åŠ å¯†ç®—æ³•ï¼ˆAES-256-CBCï¼‰åŠç›¸å…³çš„å¯†é’¥å’Œåˆå§‹å‘é‡ã€‚</p><p>æˆ‘ä»¬è°ƒç”¨ <code>decipher.update()</code> æ–¹æ³•å¼€å§‹è§£å¯†è¿‡ç¨‹ï¼Œä¼ å…¥å¯†æ–‡ï¼ˆ<code>encryptedText</code>ï¼‰ã€å¯†æ–‡çš„æ ¼å¼ï¼ˆ&#39;hex&#39;ï¼‰å’ŒæœŸæœ›çš„è¾“å‡ºæ ¼å¼ï¼ˆ&#39;utf8&#39;ï¼‰ï¼Œè¡¨ç¤ºæˆ‘ä»¬å¸Œæœ›ç»“æœæ˜¯ä¸€ä¸ª utf8 ç¼–ç çš„å­—ç¬¦ä¸²ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>decipher.final()</code> æ–¹æ³•å®Œæˆè§£å¯†è¿‡ç¨‹ï¼Œå¹¶å°†ç»“æœæ·»åŠ åˆ°ä¹‹å‰çš„è§£å¯†ç»“æœä¸Šã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬æ‰“å°å‡ºè§£å¯†åçš„æ˜æ–‡ï¼Œå®Œæˆæ•´ä¸ªè§£å¯†æµç¨‹ã€‚</p><p>è¯·æ³¨æ„ï¼Œé”™è¯¯çš„å¯†é’¥ã€åˆå§‹å‘é‡æˆ–è€…ä¸åŒ¹é…çš„åŠ å¯†ç®—æ³•ä¼šå¯¼è‡´è§£å¯†å¤±è´¥ï¼Œç”šè‡³æŠ›å‡ºé”™è¯¯ã€‚å®‰å…¨æ€§æ˜¯éå¸¸é‡è¦çš„ï¼Œå› æ­¤å¯†é’¥å’Œåˆå§‹å‘é‡åº”è¯¥è¢«å¦¥å–„ä¿ç®¡ï¼Œä¸åº”è¯¥æ³„éœ²ç»™æœªæˆæƒçš„äººå‘˜ã€‚</p><h2 id="class-diffiehellman" tabindex="-1"><a class="header-anchor" href="#class-diffiehellman"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#class-diffiehellman" target="_blank" rel="noopener noreferrer">Class: DiffieHellman</a></span></a></h2><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ Node.js ä¸­çš„ <code>DiffieHellman</code> ç±»ã€‚</p><p>é¦–å…ˆï¼Œ<code>DiffieHellman</code> æ˜¯ä¸€ä¸ªç”¨äºæ‰§è¡Œå¯†é’¥äº¤æ¢çš„åŠ å¯†ç®—æ³•ã€‚è¿™ç§ç®—æ³•å…è®¸ä¸¤æ–¹åœ¨æ²¡æœ‰å…±äº«ç§˜å¯†çš„æƒ…å†µä¸‹é€šè¿‡ä¸å®‰å…¨çš„é€šé“ç”Ÿæˆä¸€ä¸ªå…±åŒçš„ç§˜å¯†å¯†é’¥ã€‚å¾—åˆ°è¿™ä¸ªå…±åŒçš„ç§˜å¯†å¯†é’¥åï¼ŒåŒæ–¹å°±å¯ä»¥ç”¨å®ƒæ¥åŠ å¯†é€šä¿¡å†…å®¹ï¼Œç¡®ä¿ä¿¡æ¯å®‰å…¨ã€‚</p><h3 id="diffie-hellman-å¯†é’¥äº¤æ¢åŸç†ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#diffie-hellman-å¯†é’¥äº¤æ¢åŸç†ç®€ä»‹"><span>Diffie-Hellman å¯†é’¥äº¤æ¢åŸç†ç®€ä»‹ï¼š</span></a></h3><p>å‡è®¾ Alice å’Œ Bob æƒ³è¦å®‰å…¨åœ°å…±äº«ä¿¡æ¯ï¼Œä½†ä»–ä»¬ä¹‹é—´çš„é€šä¿¡æ¸ é“æ˜¯ä¸å®‰å…¨çš„ã€‚å¦‚æœ Alice å’Œ Bob äº‹å…ˆæ²¡æœ‰çº¦å®šè¿‡å¯†é’¥ï¼Œä»–ä»¬æ€æ ·æ‰èƒ½ç¡®ä¿ä¿¡æ¯ä¸è¢«ç¬¬ä¸‰æ–¹ Eve æˆªè·å¹¶è¯»å–å‘¢ï¼Ÿ</p><p>è¿™æ—¶å€™ Diffie-Hellman ç®—æ³•å°±æ´¾ä¸Šç”¨åœºäº†ã€‚å…¶åŸºæœ¬æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>Alice å’Œ Bob åŒæ„å…¬å¼€ä½¿ç”¨ä¸€ç»„æ•°å€¼ï¼ˆé€šå¸¸åŒ…æ‹¬ä¸€ä¸ªå¤§ç´ æ•° <code>p</code> å’Œä¸€ä¸ªåº•æ•° <code>g</code>ï¼‰ã€‚</li><li>Alice é€‰æ‹©ä¸€ä¸ªç§æœ‰æ•°å€¼ <code>a</code>ï¼Œç„¶åè®¡ç®— <code>A = g^a mod p</code> å¹¶å°†ç»“æœ <code>A</code> å‘é€ç»™ Bobã€‚</li><li>Bob é€‰ä¸€ä¸ªç§æœ‰æ•°å€¼ <code>b</code>ï¼Œè®¡ç®— <code>B = g^b mod p</code> å¹¶å°†ç»“æœ <code>B</code> å‘é€ç»™ Aliceã€‚</li><li>Alice æ”¶åˆ° <code>B</code> åï¼Œè®¡ç®— <code>s = B^a mod p</code>ã€‚</li><li>Bob æ”¶åˆ° <code>A</code> åï¼Œè®¡ç®— <code>s = A^b mod p</code>ã€‚</li><li>ç»“æœæ˜¯ Alice å’Œ Bob åˆ†åˆ«è®¡ç®—å‡ºç›¸åŒçš„æ•°å€¼ <code>s</code>ï¼Œè¿™ä¸ªæ•°å€¼å°±æ˜¯ä»–ä»¬çš„å…±äº«å¯†é’¥ã€‚</li></ol><p>è¿™æ ·ï¼Œå³ä½¿ Eve çŸ¥é“å…¬å…±æ•°å€¼ <code>p</code>ã€<code>g</code> ä»¥åŠäº¤æ¢çš„ <code>A</code> å’Œ <code>B</code>ï¼Œç”±äºå¥¹ä¸çŸ¥é“ç§æœ‰æ•°å€¼ <code>a</code> æˆ– <code>b</code>ï¼Œå› æ­¤å¾ˆéš¾è®¡ç®—å‡ºå…±äº«å¯†é’¥ <code>s</code>ã€‚</p><h3 id="åœ¨-node-js-ä½¿ç”¨-diffiehellman-ç±»çš„ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#åœ¨-node-js-ä½¿ç”¨-diffiehellman-ç±»çš„ä¾‹å­"><span>åœ¨ Node.js ä½¿ç”¨ <code>DiffieHellman</code> ç±»çš„ä¾‹å­ï¼š</span></a></h3><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»º DiffieHellman å¯†é’¥äº¤æ¢å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œçš„æ•°å­—ä»£è¡¨å¯†é’¥çš„ä½æ•°ï¼Œè¶Šå¤§è¶Šå®‰å…¨</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆ Alice çš„å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceKeys</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–å…¬å…±åŸºæ•°å’Œç´ æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> prime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPrime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> generator</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getGenerator</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob ä½¿ç”¨ä¸ Alice ç›¸åŒçš„ç´ æ•°å’ŒåŸºæ•°åˆ›å»ºè‡ªå·±çš„ DiffieHellman å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">prime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">generator</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆ Bob çš„å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobKeys</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice å’Œ Bob äº¤æ¢å…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceSecret</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobSecret</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">aliceKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥åŒæ–¹è®¡ç®—å‡ºçš„ç§˜å¯†æ˜¯å¦ç›¸åŒ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliceSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equals</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœè¾“å‡º trueï¼Œåˆ™è¡¨ç¤ºå¯†é’¥äº¤æ¢æˆåŠŸ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼š</p><ul><li>é¦–å…ˆæˆ‘ä»¬å¼•å…¥äº† Node.js çš„ <code>crypto</code> æ¨¡å—ã€‚</li><li>åˆ›å»ºäº†ä¸¤ä¸ª <code>DiffieHellman</code> å®ä¾‹ï¼Œä¸€ä¸ªç”¨äº Aliceï¼Œä¸€ä¸ªç”¨äº Bobã€‚</li><li>Alice å’Œ Bob ç”Ÿæˆå„è‡ªçš„å…¬é’¥å’Œç§é’¥ã€‚</li><li>ä»–ä»¬äº¤æ¢å½¼æ­¤çš„å…¬é’¥ï¼Œå¹¶ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥å’Œè‡ªå·±çš„ç§é’¥è®¡ç®—å‡ºå…±äº«å¯†é’¥ã€‚</li><li>æœ€åæ£€æŸ¥åŒæ–¹è®¡ç®—å‡ºçš„å¯†é’¥æ˜¯å¦ç›¸ç­‰ã€‚</li></ul><p>å°±æ˜¯è¿™æ ·ï¼Œåˆ©ç”¨ <code>DiffieHellman</code> ç±»ï¼ŒAlice å’Œ Bob å³ä½¿åœ¨ä¸å®‰å…¨çš„é€šä¿¡é€šé“ä¸Šä¹Ÿèƒ½ç”Ÿæˆä¸€ä¸ªåªæœ‰ä»–ä»¬ä¿©çŸ¥é“çš„ç§˜å¯†å¯†é’¥ã€‚è¿™ä¸ªç§˜å¯†å¯†é’¥æ¥ä¸‹æ¥å¯ä»¥ç”¨äºåŠ å¯†ä»–ä»¬ä¹‹é—´çš„é€šä¿¡ï¼Œæ¯”å¦‚å‘é€åŠ å¯†çš„é‚®ä»¶æˆ–æ¶ˆæ¯ã€‚</p><h3 id="diffiehellman-computesecret-otherpublickey-inputencoding-outputencoding" tabindex="-1"><a class="header-anchor" href="#diffiehellman-computesecret-otherpublickey-inputencoding-outputencoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#diffiehellmancomputesecretotherpublickey-inputencoding-outputencoding" target="_blank" rel="noopener noreferrer">diffieHellman.computeSecret(otherPublicKey[, inputEncoding][, outputEncoding])</a></span></a></h3><p><code>diffieHellman.computeSecret()</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºåœ¨ä¸¤ä¸ªå‚ä¸è€…ä¹‹é—´å®‰å…¨åœ°å…±äº«å¯†é’¥ã€‚æ­¤æ–¹æ³•åŸºäº Diffie-Hellman å¯†é’¥äº¤æ¢ç®—æ³•ï¼Œä¸€ç§å¹¿æ³›ä½¿ç”¨çš„åè®®ï¼Œå…è®¸åŒæ–¹åœ¨ä¸å®‰å…¨çš„é€šé“ä¸Šå»ºç«‹å…±äº«çš„ç§˜å¯†å¯†é’¥ã€‚</p><p>Diffie-Hellman å¯†é’¥äº¤æ¢ä¸­çš„ä¸»è¦æ¦‚å¿µæ˜¯ä¸¤ä¸ªå‚ä¸è€…å¯ä»¥å„è‡ªç”Ÿæˆç§é’¥å’Œå…¬é’¥ï¼Œç„¶åäº¤æ¢ä»–ä»¬çš„å…¬é’¥ã€‚é€šè¿‡ç»“åˆè‡ªå·±çš„ç§é’¥å’Œå¯¹æ–¹çš„å…¬é’¥ï¼Œæ¯ä¸ªå‚ä¸è€…éƒ½å¯ä»¥ç‹¬ç«‹è®¡ç®—å‡ºç›¸åŒçš„å¯†é’¥ï¼Œè¿™ä¸ªå¯†é’¥å¯ä»¥ä½œä¸ºåç»­åŠ å¯†é€šä¿¡çš„ç§˜å¯†å¯†é’¥ä½¿ç”¨ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œå³ä¾¿æœ‰äººç›‘å¬äº†å…¬é’¥çš„äº¤æ¢è¿‡ç¨‹ï¼Œä¹Ÿæ— æ³•è®¡ç®—å‡ºè¿™ä¸ªå…±äº«å¯†é’¥ï¼Œå› ä¸ºç§é’¥åœ¨äº¤æ¢è¿‡ç¨‹ä¸­ä»æœªè¢«ä¼ è¾“ã€‚</p><h3 id="ä½¿ç”¨-diffiehellman-computesecret-çš„æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-diffiehellman-computesecret-çš„æ­¥éª¤"><span>ä½¿ç”¨ <code>diffieHellman.computeSecret()</code> çš„æ­¥éª¤</span></a></h3><ol><li>åˆ›å»ºä¸¤ä¸ª Diffie-Hellman å®ä¾‹ï¼ˆAlice å’Œ Bobï¼‰ï¼Œæ¯ä¸ªå®ä¾‹éƒ½æœ‰è‡ªå·±çš„ç§é’¥å’Œå…¬é’¥ã€‚</li><li>Alice å’Œ Bob äº¤æ¢ä»–ä»¬çš„å…¬é’¥ã€‚</li><li>ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥å’Œè‡ªå·±çš„ç§é’¥ï¼ŒAlice å’Œ Bob åˆ†åˆ«è°ƒç”¨ <code>computeSecret()</code> æ¥ç”Ÿæˆå…±äº«å¯†é’¥ã€‚</li><li>è¿™ä¸ªå…±äº«å¯†é’¥å°†åœ¨ä¹‹åçš„é€šä¿¡ä¸­è¢«ç”¨ä½œåŠ å¯†ä¿¡æ¯çš„å¯†é’¥ã€‚</li></ol><h3 id="ç¤ºä¾‹ä»£ç -1" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç -1"><span>ç¤ºä¾‹ä»£ç </span></a></h3><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€åŒ–çš„ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨ <code>diffieHellman.computeSecret()</code> æ¥ç”Ÿæˆå’Œå…±äº«å¯†é’¥ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»º Alice çš„ Diffie-Hellman å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceKeys</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»º Bob çš„ Diffie-Hellman å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPrime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getGenerator</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobKeys</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice ä½¿ç”¨ Bob çš„å…¬é’¥æ¥ç”Ÿæˆå…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob ä½¿ç”¨ Alice çš„å…¬é’¥æ¥ç”Ÿæˆå…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">aliceKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥åŒæ–¹è®¡ç®—å‡ºçš„å…±äº«å¯†é’¥æ˜¯å¦ç›¸åŒ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliceSharedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equals</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobSharedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åº”è¯¥è¾“å‡º true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† <code>crypto</code> æ¨¡å—ï¼Œå¹¶åˆ†åˆ«ä¸º Alice å’Œ Bob åˆ›å»ºäº† Diffie-Hellman å®ä¾‹ã€‚ç„¶åï¼Œæˆ‘ä»¬ç”Ÿæˆäº†å„è‡ªçš„å¯†é’¥å¯¹å¹¶ç›¸äº’äº¤æ¢äº†å…¬é’¥ã€‚ä½¿ç”¨ <code>computeSecret()</code> æ–¹æ³•ï¼ŒAlice å’Œ Bob éƒ½èƒ½å¤Ÿç‹¬ç«‹è®¡ç®—å‡ºä¸€ä¸ªå…±äº«å¯†é’¥ï¼Œè¯¥å¯†é’¥ç”± Alice çš„ç§é’¥å’Œ Bob çš„å…¬é’¥ï¼ˆæˆ–è€… Bob çš„ç§é’¥å’Œ Alice çš„å…¬é’¥ï¼‰ç»„åˆå¾—åˆ°ã€‚å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œ<code>aliceSharedKey</code> å’Œ <code>bobSharedKey</code> åº”è¯¥æ˜¯å®Œå…¨ç›¸åŒçš„ï¼Œä»è€Œå¯ä»¥ç”¨äºåŠ å¯†é€šä¿¡ã€‚</p><h3 id="å‚æ•°è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>otherPublicKey</code>ï¼šå¯¹æ–¹çš„å…¬é’¥ï¼Œåœ¨è¿™é‡Œæ˜¯ <code>bobKeys</code> æˆ– <code>aliceKeys</code>ã€‚</li><li><code>inputEncoding</code>ï¼ˆå¯é€‰ï¼‰ï¼šå½“ <code>otherPublicKey</code> æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ—¶ï¼ŒæŒ‡å®šå®ƒçš„ç¼–ç æ ¼å¼ï¼Œä¾‹å¦‚ &#39;base64&#39;ã€&#39;hex&#39; ç­‰ã€‚</li><li><code>outputEncoding</code>ï¼ˆå¯é€‰ï¼‰ï¼šæŒ‡å®šè¾“å‡ºçš„å…±äº«å¯†é’¥çš„ç¼–ç æ ¼å¼ã€‚å¦‚æœä¸æŒ‡å®šï¼Œç»“æœå°†ä»¥ Buffer çš„å½¢å¼è¿”å›ã€‚</li></ul><p>å¸Œæœ›è¿™ä¸ªè¯¦ç»†çš„è§£é‡Šå’Œç¤ºä¾‹æœ‰åŠ©äºæ‚¨ç†è§£å¦‚ä½•ä½¿ç”¨ Node.js ä¸­çš„ <code>diffieHellman.computeSecret()</code> æ–¹æ³•æ¥è¿›è¡Œå¯†é’¥äº¤æ¢ã€‚</p><h3 id="diffiehellman-generatekeys-encoding" tabindex="-1"><a class="header-anchor" href="#diffiehellman-generatekeys-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#diffiehellmangeneratekeysencoding" target="_blank" rel="noopener noreferrer">diffieHellman.generateKeys([encoding])</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘å°†å°½é‡ç”¨ç®€å•æ˜äº†çš„è¯­è¨€è§£é‡Š <code>diffieHellman.generateKeys([encoding])</code> è¿™ä¸ªæ–¹æ³•ã€‚</p><p>åœ¨ Node.js çš„<code>crypto</code>æ¨¡å—ä¸­ï¼ŒDiffie-Hellman æ˜¯ä¸€ä¸ªå®ç°å¯†é’¥äº¤æ¢åè®®çš„å·¥å…·ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒå…è®¸ä¸¤æ–¹åœ¨ä¸å®‰å…¨çš„é€šä¿¡æ¸ é“ä¸Šç”Ÿæˆä¸€ä¸ªå…±äº«çš„ç§˜å¯†å¯†é’¥ï¼Œè¿™ä¸ªå¯†é’¥å¯ä»¥ç”¨æ¥åŠ å¯†è¿›ä¸€æ­¥çš„é€šä¿¡ï¼Œè€Œä¸”å³ä½¿æœ‰ç¬¬ä¸‰æ–¹ç›‘å¬äº¤æ¢è¿‡ç¨‹ï¼Œä¹Ÿæ— æ³•å¾—çŸ¥è¿™ä¸ªå…±äº«çš„å¯†é’¥ã€‚</p><p><code>generateKeys</code>è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨åˆ›å»ºä¸€ä¸ª Diffie-Hellman å¯†é’¥äº¤æ¢å¯¹è±¡åï¼Œç”¨æ¥ç”Ÿæˆå…¬ç§é’¥å¯¹çš„ã€‚å…¬é’¥æ˜¯è¦å‘é€ç»™å¯¹æ–¹çš„ï¼Œè€Œç§é’¥åˆ™æ˜¯ä¿ç•™åœ¨æœ¬åœ°ç”¨æ¥ç”Ÿæˆæœ€ç»ˆçš„å…±äº«ç§˜å¯†ã€‚</p><p>å‚æ•°<code>encoding</code>æ˜¯æŒ‡å®šè¾“å‡ºæ ¼å¼çš„å¯é€‰å‚æ•°ã€‚å¦‚æœä½ æä¾›äº†è¿™ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆç”Ÿæˆçš„é”®ä¼šè¢«ç¼–ç æˆæŒ‡å®šçš„æ ¼å¼ï¼Œå¦‚<code>&#39;hex&#39;</code>è¡¨ç¤ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œ<code>&#39;base64&#39;</code>è¡¨ç¤º Base64 ç¼–ç ç­‰ã€‚</p><p>ä¸‹é¢ç”¨ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨<code>diffieHellman.generateKeys()</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»º Diffie-Hellman å¯†é’¥äº¤æ¢å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceDH</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 2048 æ˜¯æŒ‡å®šå¯†é’¥çš„ä½æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆ Alice çš„å¯†é’¥å¯¹ï¼ˆå…¬é’¥å’Œç§é’¥ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceKeys</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> aliceDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å° Alice çš„å…¬é’¥ï¼ˆä»¥åå…­è¿›åˆ¶çš„å½¢å¼ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Alice&#39;s Public Key:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliceKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ Bob ä¹Ÿå·²ç»åˆ›å»ºäº†ä»–çš„å¯†é’¥äº¤æ¢å¯¹è±¡å¹¶ç”Ÿæˆäº†å…¬é’¥</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨ Alice å’Œ Bob äº¤æ¢å…¬é’¥ï¼Œç„¶åä»–ä»¬å°±å¯ä»¥åˆ†åˆ«ç”Ÿæˆå…±äº«çš„ç§˜å¯†å¯†é’¥</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨æ¥æ”¶åˆ° Bob çš„å…¬é’¥åï¼ŒAlice å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•æ¥ç”Ÿæˆå…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// const bobPublicKey = ...; // å‡è®¾è¿™æ˜¯ Bob å‘ç»™ Alice çš„å…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// const sharedSecret = aliceDH.computeSecret(bobPublicKey);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™ä¸ª sharedSecret å°±å¯ä»¥ä½œä¸ºåŠ å¯†å…¶ä»–é€šä¿¡æ•°æ®çš„å¯†é’¥</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† Node.js çš„<code>crypto</code>æ¨¡å—ï¼Œç„¶ååˆ›å»ºäº†ä¸€ä¸ª Diffie-Hellman å¯†é’¥äº¤æ¢å¯¹è±¡ã€‚æ¥ç€ï¼Œæˆ‘ä»¬ä¸º Alice ç”Ÿæˆäº†å¯†é’¥å¯¹ï¼Œå¹¶æ‰“å°å‡ºå¥¹çš„å…¬é’¥ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒAlice ä¼šå°†å¥¹çš„å…¬é’¥å‘é€ç»™é€šä¿¡çš„å¦ä¸€æ–¹ï¼ˆæ¯”å¦‚ Bobï¼‰ï¼Œç„¶å Bob ä¹Ÿå°†ä»–çš„å…¬é’¥å‘é€ç»™ Aliceã€‚ä¸€æ—¦åŒæ–¹éƒ½æ‹¥æœ‰å¯¹æ–¹çš„å…¬é’¥ï¼Œä»–ä»¬å°±å¯ä»¥ç”Ÿæˆä¸€ä¸ªå…±äº«çš„ç§˜å¯†å¯†é’¥ï¼Œè¯¥å¯†é’¥å¯ä»¥ç”¨äºä¹‹åçš„åŠ å¯†é€šä¿¡ã€‚</p><p>è¿™ä¸ªå…±äº«å¯†é’¥æ˜¯é€šè¿‡å„è‡ªçš„ç§é’¥å’Œå¯¹æ–¹çš„å…¬é’¥è®¡ç®—å¾—å‡ºçš„ï¼Œç”±äº Diffie-Hellman ç®—æ³•çš„ç‰¹æ€§ï¼Œå³ä½¿æœ‰äººç›‘å¬äº†å…¬é’¥çš„äº¤æ¢è¿‡ç¨‹ï¼Œæ²¡æœ‰ç§é’¥çš„è¯ä¹Ÿæ— æ³•è®¡ç®—å‡ºè¿™ä¸ªå…±äº«å¯†é’¥ã€‚å› æ­¤ï¼Œè¿™ç§æ–¹å¼å¯ä»¥å®‰å…¨åœ°åœ¨ä¸å®‰å…¨çš„é€šé“ä¸Šå»ºç«‹å®‰å…¨çš„é€šä¿¡ã€‚</p><h3 id="diffiehellman-getgenerator-encoding" tabindex="-1"><a class="header-anchor" href="#diffiehellman-getgenerator-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#diffiehellmangetgeneratorencoding" target="_blank" rel="noopener noreferrer">diffieHellman.getGenerator([encoding])</a></span></a></h3><p><code>diffieHellman.getGenerator([encoding])</code> æ–¹æ³•æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—çš„ä¸€éƒ¨åˆ†ã€‚è¿™ä¸ªæ–¹æ³•ç”¨æ¥è·å–åœ¨åˆ›å»º Diffie-Hellman å¯†é’¥äº¤æ¢å®ä¾‹æ—¶ä½¿ç”¨çš„ç”Ÿæˆå…ƒï¼ˆgeneratorï¼‰ï¼Œä¹Ÿå°±æ˜¯åœ¨å…¬å…±å¯†é’¥åŠ å¯†ä¸­ï¼ŒåŒæ–¹åå•†ä¸€ä¸ªå…±åŒç§˜å¯†çš„è¿‡ç¨‹ä¸­ä¸€ä¸ªå…³é”®çš„æ•°å€¼ã€‚</p><p>åœ¨äº†è§£è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ˜ç™½ Diffie-Hellman å¯†é’¥äº¤æ¢ç®—æ³•æ˜¯ä»€ä¹ˆï¼š</p><p>Diffie-Hellman ç®—æ³•æ˜¯ä¸€ç§å®‰å…¨åœ°åœ¨ä¸¤ä¸ªé€šä¿¡æ–¹ä¹‹é—´å…±äº«ç§˜å¯†å¯†é’¥çš„æ–¹æ³•ï¼Œå³ä½¿æœ‰ç¬¬ä¸‰æ–¹ç›‘å¬ä»–ä»¬çš„é€šè®¯ï¼Œè¿™ç¬¬ä¸‰æ–¹ä¹Ÿä¸èƒ½è½»æ˜“å¾—åˆ°è¿™ä¸ªç§˜å¯†å¯†é’¥ã€‚è¿™ä¸ªç§˜å¯†å¯†é’¥åç»­å¯ä»¥è¢«ç”¨æ¥åŠ å¯†é€šä¿¡å†…å®¹ï¼Œç¡®ä¿ä¿¡æ¯çš„å®‰å…¨æ€§ã€‚</p><p>åœ¨ Diffie-Hellman ç®—æ³•ä¸­ï¼Œã€Œç”Ÿæˆå…ƒã€æ˜¯ä¸€ä¸ªæ•°å­¦ä¸Šçš„æœ¯è¯­ï¼ŒæŒ‡çš„æ˜¯ä¸€ä¸ªåœ¨ç‰¹å®šæ•°å­¦ç¾¤é‡Œé¢å¯ä»¥ç”Ÿæˆè¯¥ç¾¤æ‰€æœ‰å…ƒç´ çš„å…ƒç´ ã€‚åœ¨ç®€å•çš„è¯è¯´ï¼Œå®ƒå°±åƒæ˜¯ä¸€ä¸ªåŸå§‹é…æ–¹ï¼Œé€šè¿‡è¿™ä¸ªé…æ–¹ä½ å¯ä»¥åˆ›é€ å‡ºæ•´ä¸ªèœå•ä¸Šçš„æ‰€æœ‰ä¸åŒçš„èœè‚´ã€‚</p><p>ç°åœ¨ï¼Œæ¥çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­æ¥è¯´æ˜ <code>diffieHellman.getGenerator([encoding])</code> å¦‚ä½•å·¥ä½œï¼š</p><ol><li><p>é¦–å…ˆï¼Œå‡è®¾ Alice å’Œ Bob æƒ³è¦å®‰å…¨åœ°å…±äº«ä¸€ä¸ªå¯†é’¥ï¼Œä½†æ˜¯ä»–ä»¬åªèƒ½é€šè¿‡ä¸€ä¸ªå¯èƒ½è¢« Eve ç›‘å¬çš„ä¸å®‰å…¨æ¸ é“è¿›è¡Œé€šä¿¡ã€‚</p></li><li><p>Alice åˆ›å»ºä¸€ä¸ª Diffie-Hellman å®ä¾‹ï¼Œå¹¶é€‰æ‹©ä¸€ä¸ªç”Ÿæˆå…ƒï¼ˆæ¯”å¦‚ 2 æˆ–è€… 5 è¿™æ ·çš„æ•°å­—ï¼‰ï¼Œç„¶åå¥¹æŠŠé€‰æ‹©çš„ç”Ÿæˆå…ƒä»¥åŠåŸºäºæ­¤ç”Ÿæˆå…ƒè®¡ç®—å‡ºçš„å…¬å¼€å€¼å‘é€ç»™ Bobã€‚</p></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ Alice åˆ›å»ºäº†è¿™ä¸ª Diffie-Hellman å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceDH</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><p>Bob æ”¶åˆ° Alice å‘é€è¿‡æ¥çš„ç”Ÿæˆå…ƒå’Œå…¬å¼€å€¼åï¼Œä»–ä¹Ÿåˆ›å»ºä¸€ä¸ª Diffie-Hellman å®ä¾‹ï¼Œä½¿ç”¨ç›¸åŒçš„ç”Ÿæˆå…ƒï¼Œå¹¶ä¸”æ ¹æ® Alice çš„å…¬å¼€å€¼è®¡ç®—å‡ºä»–è‡ªå·±çš„å…¬å¼€å€¼ï¼Œå¹¶å°†å…¶è¿”å›ç»™ Aliceã€‚</p></li><li><p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒAlice å¯ä»¥ä½¿ç”¨ <code>diffieHellman.getGenerator()</code> æ–¹æ³•æ¥è·å–å¥¹æœ€åˆé€‰æ‹©çš„ç”Ÿæˆå…ƒï¼Œå¦‚æœå¥¹å¿˜è®°äº†æˆ–è€…éœ€è¦æ ¸å¯¹ã€‚åŒæ ·ï¼ŒBob åœ¨åˆ›å»ºä»–çš„å®ä¾‹æ—¶ä¹Ÿå¯èƒ½éœ€è¦çŸ¥é“è¿™ä¸ªç”Ÿæˆå…ƒã€‚</p></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice è·å–ç”Ÿæˆå…ƒï¼Œå¯èƒ½ç”¨äºéªŒè¯æˆ–å…¶ä»–ç›®çš„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> generator</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> aliceDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getGenerator</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">generator</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºç”Ÿæˆå…ƒçš„å€¼ï¼Œé»˜è®¤æ˜¯ Buffer ç±»å‹</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li>å¦‚æœ Alice æƒ³ä»¥ä¸åŒçš„ç¼–ç æ ¼å¼æŸ¥çœ‹ç”Ÿæˆå…ƒï¼ˆæ¯”å¦‚åå…­è¿›åˆ¶ï¼‰ï¼Œå¥¹å¯ä»¥ä¼ é€’ä¸€ä¸ªå¯é€‰çš„ç¼–ç å‚æ•°ç»™ <code>getGenerator</code> æ–¹æ³•ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> generatorHex</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> aliceDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getGenerator</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–ç”Ÿæˆå…ƒçš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²è¡¨ç¤º</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">generatorHex</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºç”Ÿæˆå…ƒçš„åå…­è¿›åˆ¶å€¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ï¼ŒAlice å’Œ Bob å°±å¯ä»¥ä½¿ç”¨ Diffie-Hellman ç®—æ³•ä»¥å®‰å…¨çš„æ–¹å¼äº¤æ¢å¯†é’¥ï¼Œè€Œ Eve å³ä½¿ç›‘å¬åˆ°ä»–ä»¬å‘é€çš„ç”Ÿæˆå…ƒå’Œå…¬å¼€å€¼ä¹Ÿæ— æ³•è½»æ˜“è®¡ç®—å‡ºä»–ä»¬çš„ç§å¯†å…±äº«å¯†é’¥ã€‚è¿™ä¸ªæ–¹æ³• <code>getGenerator</code> åªæ˜¯ç”¨æ¥è·å–ç”Ÿæˆå…ƒï¼Œè€Œç®—æ³•çš„æ ¸å¿ƒåœ¨äºä½¿ç”¨è¿™ä¸ªç”Ÿæˆå…ƒè¿›è¡Œä¸€ç³»åˆ—å¤æ‚çš„æ•°å­¦è¿ç®—æ¥ç¡®ä¿å¯†é’¥äº¤æ¢çš„å®‰å…¨æ€§ã€‚</p><h3 id="diffiehellman-getprime-encoding" tabindex="-1"><a class="header-anchor" href="#diffiehellman-getprime-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#diffiehellmangetprimeencoding" target="_blank" rel="noopener noreferrer">diffieHellman.getPrime([encoding])</a></span></a></h3><p><code>diffieHellman.getPrime([encoding])</code> æ˜¯ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ã€‚è¿™ä¸ªæ¨¡å—æä¾›äº†åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯¹å¯†ç å­¦çš„åº”ç”¨ï¼ˆå¦‚åˆ›å»ºæ•£åˆ—ã€åŠ å¯†æ•°æ®ç­‰ï¼‰ã€‚åœ¨å…·ä½“ä»‹ç»è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£ä¸€ä¸‹èƒŒåçš„æ¦‚å¿µå’Œå®ƒçš„ä½œç”¨ã€‚</p><h4 id="diffie-hellman-å¯†é’¥äº¤æ¢" tabindex="-1"><a class="header-anchor" href="#diffie-hellman-å¯†é’¥äº¤æ¢"><span>Diffie-Hellman å¯†é’¥äº¤æ¢</span></a></h4><p>Diffie-Hellman æ˜¯ä¸€ä¸ªå¯†é’¥äº¤æ¢ç®—æ³•ï¼Œå…è®¸ä¸¤ä¸ªæ— éœ€äº‹å…ˆå…±äº«ç§˜å¯†ä¿¡æ¯çš„é€šä¿¡æ–¹å»ºç«‹ä¸€ä¸ªå…±äº«çš„ç§˜å¯†å¯†é’¥ï¼Œå¯ä»¥ç”¨æ¥è¿›è¡ŒåŠ å¯†é€šä¿¡ã€‚è¿™ç§æ–¹å¼ç‰¹åˆ«é€‚åˆäºé‚£äº›ä¸èƒ½ç›´æ¥äº¤æ¢å¯†é’¥çš„åœºæ™¯ï¼Œæ¯”å¦‚é€šè¿‡ä¸å®‰å…¨çš„é€šé“ï¼ˆä¾‹å¦‚äº’è”ç½‘ï¼‰é€šä¿¡ã€‚</p><h4 id="å¦‚ä½•ä½¿ç”¨-getprime" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-getprime"><span>å¦‚ä½•ä½¿ç”¨ <code>getPrime</code></span></a></h4><p>å½“ä½ åˆå§‹åŒ–ä¸€ä¸ª Diffie-Hellman å¯†é’¥äº¤æ¢çš„æ—¶å€™ï¼Œä¼šç”Ÿæˆä¸€ä¸ªâ€œç´ æ•°â€å’Œä¸€ä¸ªâ€œåŸºæ•°â€ã€‚è¿™ä¸¤ä¸ªæ•°å­—æ˜¯æ‰€æœ‰å‚ä¸è€…éƒ½å¿…é¡»çŸ¥é“çš„å…¬å…±å€¼ã€‚<code>diffieHellman.getPrime()</code> æ–¹æ³•å°±æ˜¯ç”¨æ¥è·å–è¿™ä¸ªâ€œç´ æ•°â€çš„å€¼ã€‚</p><p>å‚æ•° <code>encoding</code> æ˜¯å¯é€‰çš„ï¼Œå®ƒæŒ‡å®šè¿”å›å€¼çš„æ ¼å¼ã€‚å¦‚æœä½ ä¸ä¼ é€’ä»»ä½•å‚æ•°æˆ–è€…ä¼ å…¥ <code>null</code>ï¼Œé‚£ä¹ˆè¯¥æ–¹æ³•å°†è¿”å›ä¸€ä¸ª <code>Buffer</code> å¯¹è±¡ã€‚å¦‚æœä½ ä¼ å…¥ <code>hex</code>ã€<code>base64</code> ç­‰ï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ªç›¸åº”ç¼–ç çš„å­—ç¬¦ä¸²ã€‚</p><h4 id="å®é™…ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­"><span>å®é™…ä¾‹å­</span></a></h4><p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥çœ‹çœ‹å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨ Diffie-Hellman ç®—æ³•å’Œ<code>getPrime</code>æ–¹æ³•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªDiffie-Hellmanå¯†é’¥äº¤æ¢å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 2048æ˜¯å¯†é’¥çš„ä½æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆå¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–ç´ æ•°å€¼ï¼Œä½¿ç”¨é»˜è®¤çš„Bufferæ ¼å¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> prime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPrime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Prime: &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">prime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨&#39;hex&#39;ç¼–ç æ‰“å°å‡ºåå…­è¿›åˆ¶è¡¨ç¤ºçš„ç´ æ•°å€¼</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœå¦ä¸€ä¸ªå‚ä¸è€…éœ€è¦è¿™ä¸ªç´ æ•°æ¥ç”ŸæˆåŒ¹é…çš„å¯†é’¥ï¼Œä»–ä»¬ä¼šéœ€è¦è¿™ä¸ªå€¼ã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒAlice å’Œ Bobï¼ˆå‡æƒ³ä¸­çš„ä¸¤ä¸ªé€šä¿¡æ–¹ï¼‰å„è‡ªç”Ÿæˆè‡ªå·±çš„ Diffie-Hellman å®ä¾‹ï¼Œç„¶åäº¤æ¢å…¬å…±çš„ç´ æ•°å’ŒåŸºæ•°ã€‚ä¹‹åï¼Œä»–ä»¬åˆ†åˆ«ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥æ¥ç”Ÿæˆå…±äº«çš„å¯†é’¥ã€‚è¿™ä¸ªå…±äº«çš„å¯†é’¥å¯ä»¥ç”¨æ¥åŠ å¯†é€šä¿¡å†…å®¹ï¼Œå³ä½¿æœ‰äººç›‘å¬åˆ°äº†ä»–ä»¬çš„é€šä¿¡ä¹Ÿæ²¡åŠæ³•è§£è¯»æ¶ˆæ¯å†…å®¹ï¼Œå› ä¸ºåªæœ‰ Alice å’Œ Bob æ‰æœ‰å…±äº«çš„å¯†é’¥ã€‚</p><p>å¸Œæœ›è¿™ä¸ªè§£é‡Šæ¸…æ™°åœ°è¯´æ˜äº†<code>diffieHellman.getPrime()</code>åœ¨ Node.js ä¸­çš„ä½œç”¨ä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒã€‚</p><h3 id="diffiehellman-getprivatekey-encoding" tabindex="-1"><a class="header-anchor" href="#diffiehellman-getprivatekey-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#diffiehellmangetprivatekeyencoding" target="_blank" rel="noopener noreferrer">diffieHellman.getPrivateKey([encoding])</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome çš„ V8 JavaScript å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ä¸ªæ¨¡å—å«åš <code>crypto</code>ï¼Œå®ƒæä¾›äº†åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬åˆ›å»ºå„ç§å¯†ç å­¦æœºåˆ¶ã€‚</p><p><code>diffieHellman.getPrivateKey([encoding])</code> æ˜¯ <code>crypto</code> æ¨¡å—ä¸­ç”¨æ¥è·å– Diffie-Hellman å¯†é’¥äº¤æ¢è¿‡ç¨‹ä¸­ç”Ÿæˆçš„ç§é’¥çš„æ–¹æ³•ã€‚Diffie-Hellman æ˜¯ä¸€ç§å®‰å…¨åè®®ï¼Œç»å¸¸ç”¨äºä¸¤ä¸ªé€šä¿¡æ–¹åœ¨ä¸å®‰å…¨çš„é€šé“ä¸Šå»ºç«‹ä¸€ä¸ªå…±äº«çš„ç§˜å¯†å¯†é’¥ã€‚</p><p>ç°åœ¨è®©æˆ‘é€šä¿—æ˜“æ‡‚åœ°è§£é‡Šè¿™ä¸ªæ–¹æ³•å’Œå¦‚ä½•ä½¿ç”¨å®ƒï¼š</p><h3 id="diffie-hellman-å¯†é’¥äº¤æ¢åè®®" tabindex="-1"><a class="header-anchor" href="#diffie-hellman-å¯†é’¥äº¤æ¢åè®®"><span>Diffie-Hellman å¯†é’¥äº¤æ¢åè®®</span></a></h3><p>é¦–å…ˆï¼Œç†è§£ Diffie-Hellmanï¼ˆDHï¼‰å¯†é’¥äº¤æ¢æ˜¯ä»€ä¹ˆå¾ˆé‡è¦ã€‚å‡è®¾ Alice å’Œ Bob æƒ³è¦è¿›è¡ŒåŠ å¯†é€šä¿¡ï¼Œä½†ä»–ä»¬éœ€è¦æœ‰ä¸€ä¸ªå…±äº«çš„ç§˜å¯†å¯†é’¥æ¥åŠ å¯†å’Œè§£å¯†æ¶ˆæ¯ã€‚ä¸ºäº†å®‰å…¨åœ°å…±äº«è¿™ä¸ªå¯†é’¥ï¼Œå³ä½¿æ˜¯é€šè¿‡å¯èƒ½è¢«çªƒå¬çš„å…¬å…±é€šé“ï¼Œä»–ä»¬å¯ä»¥ä½¿ç”¨ DH å¯†é’¥äº¤æ¢ç®—æ³•ã€‚è¯¥ç®—æ³•å…è®¸ä»–ä»¬å„è‡ªç”Ÿæˆä¸€å¯¹å¯†é’¥ï¼šä¸€ä¸ªç§é’¥ï¼ˆä¿å¯†ï¼‰å’Œä¸€ä¸ªå…¬é’¥ï¼ˆå…¬å¼€ï¼‰ã€‚ç„¶åç›¸äº’äº¤æ¢å…¬é’¥ï¼Œå¹¶åˆ©ç”¨è‡ªå·±çš„ç§é’¥å’Œå¯¹æ–¹çš„å…¬é’¥ç”Ÿæˆå…±äº«çš„ç§˜å¯†ã€‚</p><h3 id="getprivatekey-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#getprivatekey-æ–¹æ³•"><span>getPrivateKey æ–¹æ³•</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œå½“ä½ ä½¿ç”¨ <code>crypto</code> æ¨¡å—åˆ›å»ºä¸€ä¸ª DH å¯†é’¥äº¤æ¢å®ä¾‹åï¼Œä½ å¯ä»¥è°ƒç”¨ <code>getPrivateKey</code> æ–¹æ³•æ¥è·å–ä½ çš„ç§é’¥ã€‚è¿™ä¸ªç§é’¥æ˜¯åœ¨åˆå§‹åŒ– Diffie-Hellman å®ä¾‹æ—¶éšæœºç”Ÿæˆçš„ï¼Œä¸”åº”è¯¥è¢«ä¿å¯†ã€‚</p><h3 id="å‚æ•°" tabindex="-1"><a class="header-anchor" href="#å‚æ•°"><span>å‚æ•°</span></a></h3><ul><li><code>encoding</code>ï¼ˆå¯é€‰ï¼‰ï¼šå¦‚æœæŒ‡å®šäº†ç¼–ç ï¼ˆå¦‚ <code>&#39;hex&#39;</code>, <code>&#39;base64&#39;</code>ï¼‰ï¼Œè¿”å›å€¼å°†æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‰ç…§æŒ‡å®šçš„æ ¼å¼ç¼–ç ã€‚å¦‚æœä¸æŒ‡å®šç¼–ç ï¼Œåˆ™é»˜è®¤è¿”å›ä¸€ä¸ª <code>Buffer</code> å¯¹è±¡ã€‚</li></ul><h3 id="ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­"><span>ä¾‹å­</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»º Diffie-Hellman å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆ Alice çš„å¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å– Alice çš„ç§é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alicePrivateKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPrivateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// &#39;hex&#39; è¡¨ç¤ºä»¥åå…­è¿›åˆ¶å­—ç¬¦ä¸²æ ¼å¼è¿”å›ç§é’¥</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">alicePrivateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º Alice çš„ç§é’¥ï¼ˆåå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼‰</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ol><li>æˆ‘ä»¬å¯¼å…¥äº† Node.js çš„ <code>crypto</code> æ¨¡å—ã€‚</li><li>åˆ©ç”¨ <code>createDiffieHellman</code> æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ DH å®ä¾‹ï¼ŒæŒ‡å®šäº†ä¸€ä¸ª 2048 ä½çš„ç´ æ•°å¤§å°æ¥ç”Ÿæˆå¯†é’¥ã€‚è¿™æ˜¯ä¸ºäº†ç¡®ä¿è¶³å¤Ÿçš„å®‰å…¨æ€§ã€‚</li><li>ç„¶åï¼Œæˆ‘ä»¬ä¸º Alice è°ƒç”¨ <code>generateKeys</code> æ–¹æ³•æ¥ç”Ÿæˆå¥¹çš„å¯†é’¥å¯¹ï¼ˆå…¬é’¥å’Œç§é’¥ï¼‰ã€‚</li><li>ä½¿ç”¨ <code>getPrivateKey</code> æ–¹æ³•å¹¶ä¼ å…¥ <code>&#39;hex&#39;</code> ä½œä¸ºå‚æ•°ï¼Œå¾—åˆ° Alice çš„ç§é’¥ï¼Œå¹¶ä»¥åå…­è¿›åˆ¶å­—ç¬¦ä¸²çš„å½¢å¼æ‰“å°å‡ºæ¥ã€‚</li></ol><p>è¿™ä¸ªç§é’¥å¯ä»¥ä¸å…¶ä»–æ–¹è¿›è¡Œå¯†é’¥äº¤æ¢ï¼Œå¹¶ç”¨äºåç»­çš„åŠ å¯†é€šä¿¡ã€‚</p><p>è¯·è®°ä½ï¼Œåœ¨å®é™…çš„åº”ç”¨ç¨‹åºä¸­ï¼Œä½ åº”è¯¥å°å¿ƒå¤„ç†ç§é’¥ï¼Œç¡®ä¿å®ƒä¸ä¼šæš´éœ²ç»™æœªæˆæƒçš„äººã€‚</p><h3 id="diffiehellman-getpublickey-encoding" tabindex="-1"><a class="header-anchor" href="#diffiehellman-getpublickey-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#diffiehellmangetpublickeyencoding" target="_blank" rel="noopener noreferrer">diffieHellman.getPublicKey([encoding])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬èŠä¸€èŠ Node.js ä¸­çš„ <code>diffieHellman.getPublicKey([encoding])</code> æ–¹æ³•ã€‚</p><p>é¦–å…ˆï¼Œ<code>diffieHellman</code> æŒ‡çš„æ˜¯ä¸€ä¸ªä¸åŠ å¯†ç›¸å…³çš„ç±»ï¼Œå®ƒæ˜¯ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸­çš„ä¸€éƒ¨åˆ†ã€‚<code>Diffie-Hellman</code> ç®—æ³•æ˜¯ä¸€ç§å¯†é’¥äº¤æ¢ç®—æ³•ï¼Œå®ƒå…è®¸ä¸¤ä¸ªé€šä¿¡æ–¹åœ¨ä¸å®‰å…¨çš„é€šé“ä¸Šç”Ÿæˆä¸€ä¸ªå…±äº«çš„ç§˜å¯†å¯†é’¥ã€‚è¿™ä¸ªå¯†é’¥å¯ä»¥ç”¨äºåŠ å¯†åç»­çš„é€šä¿¡ã€‚</p><p>åœ¨ä½¿ç”¨ Diffie-Hellman ç®—æ³•æ—¶ï¼ŒåŒæ–¹éƒ½ä¼šç”Ÿæˆå„è‡ªçš„ç§é’¥å’Œå…¬é’¥ã€‚ç§é’¥æ˜¯ä¿å¯†çš„ï¼Œè€Œå…¬é’¥æ˜¯å¯ä»¥å…¬å¼€çš„ã€‚å½“ä¸¤æ–¹äº¤æ¢äº†å…¬é’¥åï¼Œä»–ä»¬èƒ½å¤Ÿç‹¬ç«‹åœ°è®¡ç®—å‡ºä¸€ä¸ªç›¸åŒçš„å¯†é’¥ï¼Œè¿™ä¸ªå¯†é’¥å¯ä»¥ç”¨æ¥åŠ å¯†é€šä¿¡ã€‚å³ä½¿æœ‰äººæˆªè·äº†åŒæ–¹çš„å…¬é’¥ï¼Œä¹Ÿæ— æ³•è®¡ç®—å‡ºè¿™ä¸ªå…±äº«çš„å¯†é’¥ï¼Œè¿™å°±æ˜¯ Diffie-Hellman ç®—æ³•çš„ç¥å¥‡ä¹‹å¤„ã€‚</p><p>ç°åœ¨ï¼Œ<code>diffieHellman.getPublicKey([encoding])</code> è¿™ä¸ªæ–¹æ³•å°±æ˜¯ç”¨æ¥è·å– Diffie-Hellman å¯¹è±¡çš„å…¬é’¥çš„ã€‚ä½ å¯ä»¥é€‰æ‹©æ˜¯å¦ä¼ é€’ä¸€ä¸ªç¼–ç å‚æ•°ï¼ˆæ¯”å¦‚ <code>&#39;base64&#39;</code>, <code>&#39;hex&#39;</code> ç­‰ï¼‰ï¼Œå¦‚æœä¼ é€’äº†è¿™ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆè¿”å›çš„å…¬é’¥å°†è¢«ç¼–ç æˆç›¸åº”çš„æ ¼å¼ï¼›å¦‚æœæ²¡æœ‰ä¼ é€’ï¼Œé‚£ä¹ˆå…¬é’¥å°†ä»¥ Node.js Buffer ç±»å‹è¿”å›ã€‚Buffer æ˜¯ Node.js ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„æ–¹å¼ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹"><span>å®é™…è¿ç”¨ç¤ºä¾‹ï¼š</span></a></h3><p>å‡è®¾ Alice å’Œ Bob æƒ³è¦é€šè¿‡ä¸å®‰å…¨çš„ç½‘ç»œæ¸ é“å®‰å…¨åœ°äº¤æ¢ä¿¡æ¯ã€‚ä»–ä»¬å¯ä»¥è¿™æ ·åšï¼š</p><ol><li><p><strong>åˆ›å»º Diffie-Hellman å¯†é’¥äº¤æ¢å¯¹è±¡ï¼š</strong></p><p>Alice å’Œ Bob å„è‡ªåœ¨è‡ªå·±çš„ç”µè„‘ä¸Šåˆ›å»ºä¸€ä¸ª Diffie-Hellman å¯†é’¥äº¤æ¢å¯¹è±¡ã€‚</p></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice åˆ›å»ºä¸€ä¸ª Diffie-Hellman å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceDH</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob åˆ›å»ºä¸€ä¸ª Diffie-Hellman å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobDH</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  aliceDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPrime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  aliceDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getGenerator</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><p><strong>ç”Ÿæˆå¹¶äº¤æ¢å…¬é’¥ï¼š</strong></p><p>Alice å’Œ Bob å„è‡ªç”Ÿæˆè‡ªå·±çš„å…¬é’¥å’Œç§é’¥ï¼Œå¹¶äº¤æ¢ä»–ä»¬çš„å…¬é’¥ã€‚</p></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice ç”Ÿæˆè‡ªå·±çš„å¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliceDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob ç”Ÿæˆè‡ªå·±çš„å¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">bobDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice è·å–è‡ªå·±çš„å…¬é’¥å¹¶ä»¥ base64 æ ¼å¼å‘é€ç»™ Bob</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alicePublicKeyBase64</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> aliceDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob è·å–è‡ªå·±çš„å…¬é’¥å¹¶ä»¥ base64 æ ¼å¼å‘é€ç»™ Alice</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobPublicKeyBase64</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><p><strong>è®¡ç®—å¹¶éªŒè¯å…±äº«çš„å¯†é’¥ï¼š</strong></p><p>å½“ Alice å’Œ Bob æ”¶åˆ°å¯¹æ–¹çš„å…¬é’¥åï¼Œä»–ä»¬å¯ä»¥ç‹¬ç«‹åœ°è®¡ç®—å‡ºä¸€ä¸ªç›¸åŒçš„å…±äº«å¯†é’¥ã€‚</p></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice ä½¿ç”¨ Bob çš„å…¬é’¥æ¥è®¡ç®—å…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> aliceDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobPublicKeyBase64</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob ä½¿ç”¨ Alice çš„å…¬é’¥æ¥è®¡ç®—å…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">alicePublicKeyBase64</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li><p><strong>éªŒè¯æ˜¯å¦æˆåŠŸï¼š</strong></p><p>å¦‚æœ Alice å’Œ Bob æ­£ç¡®æ‰§è¡Œäº†æ‰€æœ‰æ­¥éª¤ï¼Œä»–ä»¬è®¡ç®—å‡ºçš„å…±äº«å¯†é’¥åº”è¯¥ç›¸åŒã€‚ä»–ä»¬å¯ä»¥é€šè¿‡æ¯”è¾ƒè¿™ä¸¤ä¸ªå¯†é’¥æ¥éªŒè¯ã€‚</p></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¯”è¾ƒ Alice å’Œ Bob çš„å…±äº«å¯†é’¥æ˜¯å¦ç›¸åŒ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliceSharedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equals</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobSharedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º true è¡¨ç¤ºå¯†é’¥ç›¸åŒ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒAlice å’Œ Bob ç°åœ¨æ‹¥æœ‰äº†ä¸€ä¸ªåªæœ‰ä»–ä»¬çŸ¥é“çš„ç§˜å¯†å¯†é’¥ï¼Œä»–ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªå¯†é’¥æ¥è¿›è¡ŒåŠ å¯†é€šä¿¡ï¼Œè€Œå…¶ä»–çªƒå¬è€…å³ä½¿çŸ¥é“äº†ä»–ä»¬çš„å…¬é’¥ä¹Ÿæ— æ³•è§£å¯†é€šä¿¡å†…å®¹ã€‚è¿™å°±æ˜¯ Diffie-Hellman å¯†é’¥äº¤æ¢ç®—æ³•çš„å¼ºå¤§ä¹‹å¤„ã€‚</p><h3 id="diffiehellman-setprivatekey-privatekey-encoding" tabindex="-1"><a class="header-anchor" href="#diffiehellman-setprivatekey-privatekey-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#diffiehellmansetprivatekeyprivatekey-encoding" target="_blank" rel="noopener noreferrer">diffieHellman.setPrivateKey(privateKey[, encoding])</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>diffieHellman.setPrivateKey(privateKey[, encoding])</code> æ˜¯ä¸€ä¸ªç”¨äºè®¾ç½® Diffie-Hellman å¯†é’¥äº¤æ¢çš„ç§é’¥çš„æ–¹æ³•ã€‚è®©æˆ‘ä»¬åˆ†æ­¥éª¤è§£é‡Šè¿™ä¸ªæ¦‚å¿µï¼Œå¹¶ç»™å‡ºä¸€äº›ç®€å•çš„ä¾‹å­æ¥ç†è§£å®ƒã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-diffie-hellman-å¯†é’¥äº¤æ¢" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-diffie-hellman-å¯†é’¥äº¤æ¢"><span>ä»€ä¹ˆæ˜¯ Diffie-Hellman å¯†é’¥äº¤æ¢ï¼Ÿ</span></a></h3><p>Diffie-Hellman å¯†é’¥äº¤æ¢ï¼ˆç®€ç§° DHï¼‰æ˜¯ä¸€ç§å¯†ç å­¦åè®®ï¼Œå®ƒå…è®¸ä¸¤ä¸ªé€šä¿¡æ–¹åœ¨ä¸å®‰å…¨çš„é€šé“ä¸Šåˆ›å»ºä¸€ä¸ªå…±äº«çš„ç§˜å¯†å¯†é’¥ï¼Œç„¶åå¯ä»¥ç”¨è¿™ä¸ªå¯†é’¥åŠ å¯†åç»­çš„é€šä¿¡å†…å®¹ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸éœ€è¦åŒæ–¹äº‹å…ˆå…±äº«ç§˜å¯†ä¿¡æ¯ï¼Œå› æ­¤å¯¹äºå»ºç«‹å®‰å…¨é€šä¿¡éå¸¸æœ‰ç”¨ã€‚</p><h3 id="diffiehellman-setprivatekey-privatekey-encoding-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#diffiehellman-setprivatekey-privatekey-encoding-æ–¹æ³•"><span><code>diffieHellman.setPrivateKey(privateKey[, encoding])</code> æ–¹æ³•</span></a></h3><p>è¿™ä¸ªæ–¹æ³•æ˜¯ Node.js <code>crypto</code> æ¨¡å—ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºè®¾ç½® Diffie-Hellman å®ä¾‹çš„ç§é’¥ã€‚ç§é’¥æ˜¯å¯†é’¥äº¤æ¢è¿‡ç¨‹ä¸­åªä¿ç•™åœ¨ç”¨æˆ·ä¾§å¹¶ä¿å¯†çš„å¯†é’¥éƒ¨åˆ†ã€‚</p><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>privateKey</code>: è¿™æ˜¯ä½ æƒ³è¦è®¾ç½®çš„ç§é’¥ã€‚å®ƒå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€<code>Buffer</code>ã€<code>TypedArray</code> æˆ– <code>DataView</code>ã€‚</li><li><code>encoding</code> (å¯é€‰): å¦‚æœ <code>privateKey</code> æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå‚æ•°æŒ‡å®šäº†å­—ç¬¦ä¸²çš„ç¼–ç æ–¹å¼ï¼Œä¾‹å¦‚ &#39;utf8&#39;, &#39;hex&#39; ç­‰ã€‚</li></ul><h3 id="ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹"><span>ç¤ºä¾‹</span></a></h3><p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥çœ‹ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼š</p><ol><li>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ Diffie-Hellman å®ä¾‹ç”Ÿæˆå…¬ç§é’¥å¯¹ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª Diffie-Hellman å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> diffieHellman</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆç§é’¥å’Œå…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> privateKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> diffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>æ¥ä¸‹æ¥ï¼Œå‡è®¾å‡ºäºæŸç§åŸå› æˆ‘ä»¬éœ€è¦é‡æ–°è®¾ç½®å®ä¾‹çš„ç§é’¥ï¼ˆå¯èƒ½æ˜¯ä»æ•°æ®åº“ä¸­è¯»å–æˆ–è€…æ˜¯ç”±å…¶ä»–æ–¹æ³•å¾—åˆ°çš„ï¼‰ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–°çš„ç§é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> newPrivateKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getNewPrivateKeyFromSomewhere</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ setPrivateKey æ–¹æ³•è®¾ç½® Diffie-Hellman å®ä¾‹çš„æ–°ç§é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">diffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setPrivateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">newPrivateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼šè¿™é‡Œçš„ <code>getNewPrivateKeyFromSomewhere()</code> å‡½æ•°è¡¨ç¤ºè·å–æ–°ç§é’¥çš„é€”å¾„ï¼Œè¿™ä¸ªå‡½æ•°ä¸æ˜¯ Node.js çš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ˜¯ä¸ºäº†ç¤ºæ„å¯èƒ½éœ€è¦ä»å¤–éƒ¨æ¥æºè·å–ä¸€ä¸ªç§é’¥ã€‚</p><ol start="3"><li>è®¾ç½®å®Œç§é’¥åï¼Œä½ å¯ä»¥ç»§ç»­ä½¿ç”¨ Diffie-Hellman å®ä¾‹è¿›è¡Œå¯†é’¥äº¤æ¢ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–æœ€ç»ˆçš„å…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> sharedSecret</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> diffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">partnerPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>partnerPublicKey</code> ä»£è¡¨é€šä¿¡å¯¹æ–¹çš„å…¬é’¥ï¼Œé€šè¿‡è®¡ç®—ä½ å¯ä»¥å¾—åˆ°ä¸€ä¸ªå…±äº«å¯†é’¥ <code>sharedSecret</code>ï¼ŒåŒæ–¹éƒ½èƒ½ç”¨è¿™ä¸ªç§˜å¯†å¯†é’¥æ¥åŠ å¯†å’Œè§£å¯†æ¶ˆæ¯ã€‚</p><h3 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“"><span>æ€»ç»“</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>diffieHellman.setPrivateKey(privateKey[, encoding])</code> æ–¹æ³•ç”¨äºä¸º Diffie-Hellman å®ä¾‹è®¾ç½®ä¸€ä¸ªæ–°çš„ç§é’¥ã€‚è¿™å¯¹äºé‚£äº›éœ€è¦åŸºäºå½“å‰çŠ¶æ€æ›´æ–°å¯†é’¥çš„åœºåˆç‰¹åˆ«æœ‰ç”¨ã€‚ä½¿ç”¨æ—¶ï¼Œè®°å¾—å¤„ç†å¥½ç›¸å…³çš„å®‰å…¨æ€§å’Œéšç§æ€§é—®é¢˜ï¼Œå› ä¸ºç§é’¥çš„æ³„éœ²ä¼šå¯¼è‡´é€šä¿¡è¢«ç ´è§£ã€‚</p><h3 id="diffiehellman-setpublickey-publickey-encoding" tabindex="-1"><a class="header-anchor" href="#diffiehellman-setpublickey-publickey-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#diffiehellmansetpublickeypublickey-encoding" target="_blank" rel="noopener noreferrer">diffieHellman.setPublicKey(publicKey[, encoding])</a></span></a></h3><p>Node.js ä¸­çš„<code>diffieHellman.setPublicKey(publicKey[, encoding])</code>æ–¹æ³•æ˜¯ä¸€ä¸ªç”¨äºè®¾ç½® Diffie-Hellman å…¬é’¥çš„å‡½æ•°ï¼Œè¿™ä¸ªåŠŸèƒ½ä½äº Node.js çš„åŠ å¯†åº“<code>crypto</code>æ¨¡å—å†…ã€‚åœ¨è®²è§£è¿™ä¸ªå‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä¸€äº›èƒŒæ™¯çŸ¥è¯†ã€‚</p><h3 id="diffie-hellman-å¯†é’¥äº¤æ¢åè®®-1" tabindex="-1"><a class="header-anchor" href="#diffie-hellman-å¯†é’¥äº¤æ¢åè®®-1"><span>Diffie-Hellman å¯†é’¥äº¤æ¢åè®®</span></a></h3><p>Diffie-Hellman å¯†é’¥äº¤æ¢æ˜¯ä¸€ç§å®‰å…¨åè®®ï¼Œå®ƒå…è®¸ä¸¤ä¸ªé€šä¿¡æ–¹åœ¨å®Œå…¨ä¸å®‰å…¨çš„é€šé“ä¸Šå»ºç«‹ä¸€ä¸ªå…±äº«çš„ç§˜å¯†å¯†é’¥ã€‚è¿™ä¸ªå¯†é’¥å¯ä»¥ç”¨äºåç»­çš„åŠ å¯†é€šä¿¡ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯åŸºäºæ•°å­¦åŸç†ï¼Œå³ä½¿æœ‰äººç›‘å¬äº†åŒæ–¹çš„äº¤æµå†…å®¹ï¼Œæ²¡æœ‰ç‰¹å®šçš„ç§é’¥ä¿¡æ¯ï¼Œä»–ä»¬ä¹Ÿæ— æ³•å¾—çŸ¥æœ€ç»ˆåå•†å‡ºçš„å¯†é’¥ã€‚</p><h3 id="setpublickey-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#setpublickey-æ–¹æ³•"><span>setPublicKey æ–¹æ³•</span></a></h3><p>å½“ä½ åˆ›å»ºä¸€ä¸ª Diffie-Hellman å¯†é’¥äº¤æ¢å®ä¾‹ä¹‹åï¼Œä½ å¯èƒ½ä¼šå¾—åˆ°ä¸€ä¸ªå…¬é’¥å’Œä¸€ä¸ªç§é’¥ã€‚<code>setPublicKey</code>æ–¹æ³•å°±æ˜¯ç”¨æ¥å°†ä¹‹å‰ç”Ÿæˆæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å¾—çš„å…¬é’¥è®¾ç½®ç»™ Diffie-Hellman å®ä¾‹ã€‚è®¾ç½®å…¬é’¥æ˜¯ä¸ºäº†èƒ½å¤Ÿä¸å…¶ä»–æ–¹è¿›è¡Œå¯†é’¥äº¤æ¢ï¼Œå¹¶ç”Ÿæˆæœ€ç»ˆçš„å…±äº«å¯†é’¥ã€‚</p><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>publicKey</code>: è¿™æ˜¯ä¸€ä¸ª Bufferã€TypedArrayã€DataViewã€ArrayBuffer æˆ–è€…å­—ç¬¦ä¸²ï¼Œä»£è¡¨è¦è®¾ç½®çš„å…¬é’¥ã€‚</li><li><code>encoding</code>: å¦‚æœ publicKey æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆå¯ä»¥æŒ‡å®šå®ƒçš„ç¼–ç æ–¹å¼ï¼Œæ¯”å¦‚&#39;base64&#39;, &#39;hex&#39;,ç­‰ç­‰ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>å‡è®¾ Alice å’Œ Bob æƒ³è¦å®‰å…¨åœ°äº¤æ¢å¯†é’¥ï¼š</p><ol><li>é¦–å…ˆï¼ŒAlice å’Œ Bob åˆ†åˆ«åˆ›å»ºè‡ªå·±çš„ Diffie-Hellman å®ä¾‹ï¼Œå¹¶ç”Ÿæˆå„è‡ªçš„å…¬é’¥å’Œç§é’¥ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice åˆ›å»º Diffie-Hellman å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceKeys</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob åˆ›å»º Diffie-Hellman å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPrime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getGenerator</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobKeys</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><p>Alice å’Œ Bob äº’ç›¸äº¤æ¢å…¬é’¥ã€‚åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œè¿™ä¸ªäº¤æ¢å¯ä»¥é€šè¿‡ Internet å‘ç”Ÿï¼Œä¹Ÿå°±æ˜¯åœ¨ä¸€ä¸ªä¸å®‰å…¨çš„é€šé“ä¸Šã€‚</p></li><li><p>ä½¿ç”¨<code>setPublicKey</code>æ–¹æ³•è®¾ç½®å¯¹æ–¹çš„å…¬é’¥ã€‚</p></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice æ¥æ”¶ Bob çš„å…¬é’¥å¹¶è®¾ç½®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob æ¥æ”¶ Alice çš„å…¬é’¥å¹¶è®¾ç½®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">aliceKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>ç°åœ¨ Alice å’Œ Bob éƒ½å¯ä»¥ç”Ÿæˆå…±äº«çš„å¯†é’¥ï¼Œè¿™ä¸ªå¯†é’¥åœ¨ä¸¤è¾¹éƒ½ä¼šç›¸åŒï¼Œè€Œä¸”ä¸ä¼šè¢«ä¼ è¾“ï¼Œå› æ­¤æ˜¯å®‰å…¨çš„ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice ç”Ÿæˆå…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob ç”Ÿæˆå…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">aliceKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// aliceSharedKey å’Œ bobSharedKey åœ¨æ•°å€¼ä¸Šåº”è¯¥æ˜¯ç›¸ç­‰çš„</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šå°±æ˜¯ä½¿ç”¨<code>diffieHellman.setPublicKey</code>æ–¹æ³•è¿›è¡Œå¯†é’¥äº¤æ¢çš„ä¸€ä¸ªç®€åŒ–ç¤ºä¾‹ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯†é’¥äº¤æ¢è¿‡ç¨‹ä¼šæ¶‰åŠæ›´å¤šçš„å®‰å…¨è€ƒè™‘ï¼Œå¦‚éªŒè¯å…¬é’¥ç¡®å®æ¥è‡ªé¢„æœŸçš„é€šä¿¡æ–¹ç­‰ã€‚</p><h3 id="diffiehellman-verifyerror" tabindex="-1"><a class="header-anchor" href="#diffiehellman-verifyerror"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#diffiehellmanverifyerror" target="_blank" rel="noopener noreferrer">diffieHellman.verifyError</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>diffieHellman.verifyError</code>æ˜¯è·ŸåŠ å¯†æœ‰å…³çš„åŠŸèƒ½ã€‚è¦ç†è§£è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦çŸ¥é“ Diffie-Hellman ç§˜é’¥äº¤æ¢åè®®æ˜¯ä»€ä¹ˆã€‚</p><p>ç®€å•æ¥è¯´ï¼ŒDiffie-Hellmanï¼ˆD-Hï¼‰æ˜¯ä¸€ä¸ªå…è®¸ä¸¤ä¸ªé€šä¿¡æ–¹åœ¨ä¸€ä¸ªä¸å®‰å…¨çš„é€šé“ä¸Šåˆ›å»ºä¸€ä¸ªå…±äº«çš„ç§˜å¯†å¯†é’¥çš„æ–¹æ³•ã€‚è¿™ä¸ªå…±äº«çš„å¯†é’¥å¯ä»¥ç”¨äºåç»­çš„åŠ å¯†é€šä¿¡ã€‚å®ƒæ˜¯åŸºäºæ•°å­¦åŸç†çš„ï¼Œç‰¹åˆ«æ˜¯ç¦»æ•£å¯¹æ•°é—®é¢˜ã€‚</p><p>ç°åœ¨ï¼Œæ¥è°ˆè°ˆ<code>verifyError</code>å±æ€§ã€‚åœ¨ä½¿ç”¨ Diffie-Hellman åè®®è¿›è¡Œç§˜é’¥äº¤æ¢æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸€äº›é”™è¯¯ã€‚æ¯”å¦‚ï¼Œå½“å‚ä¸äº¤æ¢çš„ä¸€æ–¹å‘é€äº†ä¸€ä¸ªä¸ç¬¦åˆæ•°å­¦è¦æ±‚çš„å€¼ç»™å¦ä¸€æ–¹æ—¶ï¼Œè¿™å°±å¯èƒ½å¯¼è‡´é”™è¯¯å‘ç”Ÿã€‚<code>verifyError</code>å±æ€§å°±æ˜¯ç”¨æ¥æ£€æŸ¥æ˜¯å¦å‘ç”Ÿäº†è¿™ç§ç±»å‹çš„é”™è¯¯ã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œä½ å¯ä»¥è¿™æ ·ä½¿ç”¨<code>diffieHellman.verifyError</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»º Diffie-Hellman å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;modp1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// éªŒè¯å®ä¾‹çš„æœ‰æ•ˆæ€§</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> errorCode</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">verifyError</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">errorCode</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¦‚æœ errorCode ä¸æ˜¯ 0ï¼Œé‚£ä¹ˆå°±å‘ç”Ÿäº†é”™è¯¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`An error occurred: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">errorCode</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿™é‡Œå¯ä»¥å¤„ç†é”™è¯¯ï¼Œä¾‹å¦‚æŠ›å‡ºå¼‚å¸¸æˆ–è€…è®°å½•æ—¥å¿—</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ²¡æœ‰é”™è¯¯ï¼Œå¯ä»¥ç»§ç»­æ‰§è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä¾‹å¦‚ç”Ÿæˆç§˜å¯†å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;modp1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceSecret</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobSecret</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ­¤æ—¶ aliceSecret å’Œ bobSecret åº”è¯¥æ˜¯ç›¸åŒçš„ï¼Œè¡¨ç¤ºåŒæ–¹å…±äº«äº†ä¸€ä¸ªç§˜å¯†å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡<code>require(&#39;crypto&#39;)</code>å¼•å…¥äº† Node.js çš„åŠ å¯†åº“ã€‚ç„¶åæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª Diffie-Hellman å®ä¾‹ï¼Œå¹¶ä¸ºå…¶ç”Ÿæˆäº†å…¬ç§å¯†é’¥å¯¹ã€‚åœ¨ç”Ÿæˆå¯†é’¥ä¹‹åï¼Œæˆ‘ä»¬æ£€æŸ¥äº†<code>verifyError</code>å±æ€§æ¥ç¡®å®šæ˜¯å¦æœ‰ä»»ä½•é”™è¯¯å‘ç”Ÿã€‚</p><p>å¦‚æœ<code>verifyError</code>è¿”å› 0ï¼Œè¯´æ˜æ²¡æœ‰é”™è¯¯ï¼Œä½ å¯ä»¥ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç ã€‚å¦‚æœé 0ï¼Œåˆ™è¡¨ç¤ºå‘ç”Ÿäº†é”™è¯¯ï¼Œä½ åº”è¯¥æ ¹æ®é”™è¯¯ä»£ç ï¼ˆ<code>errorCode</code>ï¼‰æ¥é‡‡å–ç›¸åº”çš„æªæ–½ã€‚</p><p>è®°ä½ï¼Œä½¿ç”¨åŠ å¯†åè®®å’Œ API æ—¶ï¼Œæ­£ç¡®åœ°å¤„ç†é”™è¯¯æ˜¯éå¸¸é‡è¦çš„ã€‚é”™è¯¯çš„å¤„ç†ä¸ä»…èƒ½ä¿è¯ç¨‹åºçš„å¥å£®æ€§ï¼Œè¿˜èƒ½ç¡®ä¿é€šä¿¡çš„å®‰å…¨æ€§ã€‚</p><h2 id="class-diffiehellmangroup" tabindex="-1"><a class="header-anchor" href="#class-diffiehellmangroup"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#class-diffiehellmangroup" target="_blank" rel="noopener noreferrer">Class: DiffieHellmanGroup</a></span></a></h2><p>å½“ç„¶ï¼Œå¾ˆé«˜å…´ä¸ºæ‚¨è§£é‡Š Node.js ä¸­çš„ <code>DiffieHellmanGroup</code>ã€‚</p><p>åœ¨ Node.js çš„åŠ å¯†æ¨¡å—ä¸­ï¼Œ<code>DiffieHellmanGroup</code> æ˜¯ä¸€ä¸ªç”¨äºåˆ›å»º Diffie-Hellman å¯†é’¥äº¤æ¢çš„ç±»ã€‚Diffie-Hellman å¯†é’¥äº¤æ¢æ˜¯ä¸€ç§åŠ å¯†æŠ€æœ¯ï¼Œå®ƒå…è®¸ä¸¤æ–¹åœ¨ä¸å®‰å…¨çš„é€šä¿¡æ¸ é“ä¸Šå»ºç«‹ä¸€ä¸ªå…±äº«çš„ç§˜å¯†å¯†é’¥ï¼Œé€šå¸¸ç”¨äºå»ºç«‹å®‰å…¨è¿æ¥ï¼ˆæ¯”å¦‚ HTTPSï¼‰ã€‚</p><p>ä¸¾ä¸ªå®é™…çš„ä¾‹å­æ¥è¯´æ˜ï¼š</p><p>å‡è®¾ Alice å’Œ Bob æƒ³è¦é€šè¿‡äº’è”ç½‘å®‰å…¨åœ°é€šä¿¡ï¼Œä½†ä»–ä»¬ä»æœªè§é¢è¿‡ï¼Œæ— æ³•äº‹å…ˆäº¤æ¢å¯†é’¥ã€‚ä»–ä»¬å†³å®šä½¿ç”¨ Diffie-Hellman å¯†é’¥äº¤æ¢åè®®ã€‚</p><p>æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p><strong>é€‰æ‹©å…¬å…±åŸºç¡€å‚æ•°</strong>ï¼šAlice å’Œ Bob åŒæ„ä½¿ç”¨é¢„å®šä¹‰çš„ Diffie-Hellman å‚æ•°ç»„ï¼ˆä¾‹å¦‚ &#39;modp15&#39;ï¼‰ï¼Œè¿™äº›å‚æ•°å…¬å¼€å¯ç”¨ï¼Œå¯¹æ‰€æœ‰äººéƒ½ä¸€æ ·ã€‚</p></li><li><p><strong>ç”Ÿæˆå„è‡ªçš„å¯†é’¥å¯¹</strong>ï¼šAlice å’Œ Bob åˆ†åˆ«ä½¿ç”¨è¿™ä¸ªå‚æ•°ç»„åˆ›å»ºå„è‡ªçš„ Diffie-Hellman å®ä¾‹ï¼Œå¹¶ç”Ÿæˆå„è‡ªçš„ç§é’¥å’Œå…¬é’¥ã€‚</p></li><li><p><strong>äº¤æ¢å…¬é’¥</strong>ï¼šAlice å°†å¥¹çš„å…¬é’¥å‘é€ç»™ Bobï¼ŒBob å‘é€ä»–çš„å…¬é’¥ç»™ Aliceã€‚</p></li><li><p><strong>ç”Ÿæˆå…±äº«ç§˜å¯†</strong>ï¼šAlice ä½¿ç”¨ Bob çš„å…¬é’¥å’Œå¥¹è‡ªå·±çš„ç§é’¥ç”Ÿæˆä¸€ä¸ªç§˜å¯†å€¼ï¼ŒåŒç†ï¼ŒBob ä¹Ÿä½¿ç”¨ Alice çš„å…¬é’¥å’Œä»–è‡ªå·±çš„ç§é’¥ç”Ÿæˆç›¸åŒçš„ç§˜å¯†å€¼ã€‚è¿™ä¸ªç§˜å¯†å€¼å°†ä½œä¸ºä¹‹ååŠ è§£å¯†ä¿¡æ¯çš„å¯†é’¥ã€‚</p></li></ol><p>åœ¨ Node.js ä¸­ï¼Œä½ å¯ä»¥è¿™æ ·ä½¿ç”¨ <code>DiffieHellmanGroup</code> ç±»æ¥å®ç°ä¸Šè¿°æµç¨‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é€‰æ‹©ä¸€ä¸ªé¢„å®šä¹‰çš„ Diffie-Hellman å‚æ•°ç»„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> groupName</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;modp15&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice åˆ›å»º Diffie-Hellman å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellmanGroup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">groupName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceKeys</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob åˆ›å»º Diffie-Hellman å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellmanGroup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">groupName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobKeys</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice å’Œ Bob äº¤æ¢å…¬é’¥å¹¶ç”Ÿæˆå…±äº«ç§˜å¯†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceSecret</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobSecret</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">aliceKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨ Alice å’Œ Bob æ‹¥æœ‰ç›¸åŒçš„ç§˜å¯†å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliceSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åº”è¯¥è¾“å‡º true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€‰æ‹©äº†é¢„å®šä¹‰çš„ Diffie-Hellman å‚æ•°ç»„ <code>modp15</code>ã€‚Alice å’Œ Bob éƒ½ç”Ÿæˆå„è‡ªçš„å¯†é’¥å¯¹ï¼ˆç§é’¥ä¿ç•™ï¼Œå…¬é’¥äº¤æ¢ï¼‰ã€‚ç„¶åï¼Œä»–ä»¬ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥ç”Ÿæˆä¸€ä¸ªå…±äº«çš„ç§˜å¯†ã€‚å¦‚æœä¸€åˆ‡æ­£ç¡®ï¼Œè¿™ä¸ªå…±äº«çš„ç§˜å¯†åœ¨ Alice å’Œ Bob è¿™ä¸¤è¾¹åº”è¯¥æ˜¯ç›¸åŒçš„ï¼Œä»–ä»¬å°±å¯ä»¥ç”¨è¿™ä¸ªç§˜å¯†æ¥åŠ å¯†é€šä¿¡å†…å®¹ï¼Œç¡®ä¿ä¿¡æ¯å®‰å…¨ã€‚</p><h2 id="class-ecdh" tabindex="-1"><a class="header-anchor" href="#class-ecdh"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#class-ecdh" target="_blank" rel="noopener noreferrer">Class: ECDH</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome çš„ V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©ä½ å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚Node.js ä¸­å†…ç½®äº† <code>crypto</code> æ¨¡å—ï¼Œè¯¥æ¨¡å—åŒ…å«äº†ä¸€å¥—ç”¨äºåŠ å¯†çš„å·¥å…·ï¼Œè¿™åŒ…æ‹¬å„ç§ç®—æ³•å’ŒåŒ…æ‹¬ ECDHï¼ˆElliptic Curve Diffie-Hellmanï¼‰åœ¨å†…çš„å¯†é’¥äº¤æ¢åè®®ã€‚</p><p>ECDH æ˜¯ä¸€ä¸ªå¯†é’¥äº¤æ¢åè®®ï¼Œå…è®¸åŒæ–¹åœ¨ä¸å®‰å…¨çš„é€šé“ä¸Šå»ºç«‹ä¸€ä¸ªå…±äº«çš„å¯†é’¥ï¼ŒåŒæ—¶ä¸éœ€è¦å°†ç§é’¥æš´éœ²ç»™å¯¹æ–¹ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯åŸºäºæ¤­åœ†æ›²çº¿åŠ å¯†çš„åŸç†ã€‚æ¤­åœ†æ›²çº¿åŠ å¯†æ˜¯ä¸€ç§å…¬é’¥å¯†ç å­¦æ–¹æ³•ï¼Œç›¸æ¯”å…¶ä»–æ–¹æ³•ï¼Œå®ƒå¯ä»¥åœ¨è¾ƒå°çš„å¯†é’¥å¤§å°ä¸‹æä¾›ç›¸å½“å¼ºçš„å®‰å…¨æ€§ã€‚</p><p>åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œâ€œClass: ECDHâ€æŒ‡çš„æ˜¯å®ç°äº† ECDH å¯†é’¥äº¤æ¢åŠŸèƒ½çš„ç±»ã€‚ä»¥ä¸‹æ˜¯å…³äºå¦‚ä½•ä½¿ç”¨ ECDH ç±»è¿›è¡Œå¯†é’¥äº¤æ¢çš„æ­¥éª¤å’Œç¤ºä¾‹ï¼š</p><h3 id="æ­¥éª¤-1-ç”Ÿæˆå¯†é’¥å¯¹" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-1-ç”Ÿæˆå¯†é’¥å¯¹"><span>æ­¥éª¤ 1ï¼šç”Ÿæˆå¯†é’¥å¯¹</span></a></h3><p>é¦–å…ˆï¼Œä½ éœ€è¦åˆ›å»ºä¸¤ä¸ª ECDH å®ä¾‹åˆ†åˆ«ä»£è¡¨ä¸¤ä¸ªé€šä¿¡æ–¹ï¼Œæˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸º Alice å’Œ Bobã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice åˆ›å»º ECDH å®ä¾‹å¹¶ç”Ÿæˆå¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;prime256v1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// &#39;prime256v1&#39; æ˜¯æ¤­åœ†æ›²çº¿çš„åç§°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob åŒæ ·åˆ›å»º ECDH å®ä¾‹å¹¶ç”Ÿæˆå¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;prime256v1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­¥éª¤-2-äº¤æ¢å…¬é’¥" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-2-äº¤æ¢å…¬é’¥"><span>æ­¥éª¤ 2ï¼šäº¤æ¢å…¬é’¥</span></a></h3><p>Alice å’Œ Bob éœ€è¦äº¤æ¢ä»–ä»¬çš„å…¬é’¥ã€‚åœ¨çœŸå®çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šé€šè¿‡ç½‘ç»œæˆ–è€…å…¶ä»–æ–¹å¼æ¥å®Œæˆã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alicePublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobPublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ Alice å’Œ Bob æˆåŠŸäº¤æ¢äº†å…¬é’¥</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­¥éª¤-3-è®¡ç®—å…±äº«å¯†é’¥" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-3-è®¡ç®—å…±äº«å¯†é’¥"><span>æ­¥éª¤ 3ï¼šè®¡ç®—å…±äº«å¯†é’¥</span></a></h3><p>ç°åœ¨ï¼ŒAlice å’Œ Bob ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥æ¥ç”Ÿæˆç›¸åŒçš„å…±äº«å¯†é’¥ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">alicePublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼ŒaliceSharedKey å’Œ bobSharedKey åº”è¯¥æ˜¯ç›¸åŒçš„ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">aliceSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> bobSharedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="_1-å®‰å…¨é€šä¿¡" tabindex="-1"><a class="header-anchor" href="#_1-å®‰å…¨é€šä¿¡"><span>1. å®‰å…¨é€šä¿¡</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦åŠ å¯†é€šä¿¡çš„èŠå¤©åº”ç”¨ç¨‹åºã€‚ä¸ºäº†ç¡®ä¿æ¶ˆæ¯çš„å®‰å…¨ä¼ è¾“ï¼Œä½ å¯ä»¥ä½¿ç”¨ ECDH åè®®ï¼Œè®©æ¯ä¸ªç”¨æˆ·ç”Ÿæˆè‡ªå·±çš„å¯†é’¥å¯¹ï¼Œç„¶åäº¤æ¢å…¬é’¥æ¥äº§ç”Ÿä¸€ä¸ªå…±äº«çš„å¯†é’¥ã€‚ç„¶åï¼Œä½¿ç”¨è¿™ä¸ªå…±äº«å¯†é’¥æ¥åŠ å¯†é€šä¿¡å†…å®¹ã€‚</p><h4 id="_2-åŠ å¯†æ•°æ®å­˜å‚¨" tabindex="-1"><a class="header-anchor" href="#_2-åŠ å¯†æ•°æ®å­˜å‚¨"><span>2. åŠ å¯†æ•°æ®å­˜å‚¨</span></a></h4><p>å¦‚æœä½ çš„åº”ç”¨éœ€è¦å­˜å‚¨ç”¨æˆ·æ•æ„Ÿæ•°æ®ï¼Œä½ å¯ä»¥ä½¿ç”¨ ECDH æ¥ç”Ÿæˆä¸€ä¸ªå…±äº«å¯†é’¥ï¼Œç„¶ååˆ©ç”¨è¿™ä¸ªå¯†é’¥æ¥åŠ å¯†å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚ä»…å½“ç”¨æˆ·åœ¨å®¢æˆ·ç«¯æä¾›ä»–ä»¬çš„ç§é’¥æ—¶ï¼Œæ‰èƒ½è§£å¯†è¿™äº›æ•°æ®ã€‚</p><h4 id="_3-ç”¨æˆ·èº«ä»½éªŒè¯" tabindex="-1"><a class="header-anchor" href="#_3-ç”¨æˆ·èº«ä»½éªŒè¯"><span>3. ç”¨æˆ·èº«ä»½éªŒè¯</span></a></h4><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½æƒ³è¦ä½¿ç”¨ ECDH æ¥éªŒè¯ç”¨æˆ·èº«ä»½ã€‚ç”¨æˆ·å¯ä»¥ç”Ÿæˆä¸€å¯¹å¯†é’¥ï¼Œå¹¶å°†å…¬é’¥å‘é€ç»™ä½ çš„æœåŠ¡å™¨ã€‚ä¹‹åï¼Œæ¯æ¬¡ç”¨æˆ·å°è¯•ç™»å½•æ—¶ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ ECDH æ¥ç¡®è®¤ä»–ä»¬æŒæœ‰å¯¹åº”çš„ç§é’¥ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯å…³äº Node.js ä¸­ &quot;Class: ECDH&quot; çš„è¯¦ç»†ä»‹ç»å’Œä¸€äº›å®é™…è¿ç”¨çš„ä¾‹å­ã€‚é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° ECDH å¦‚ä½•åœ¨ä¿æŠ¤æ•°æ®å®‰å…¨ä¸ç”¨æˆ·èº«ä»½è®¤è¯ä¸­å‘æŒ¥ä½œç”¨ã€‚</p><h3 id="static-method-ecdh-convertkey-key-curve-inputencoding-outputencoding-format" tabindex="-1"><a class="header-anchor" href="#static-method-ecdh-convertkey-key-curve-inputencoding-outputencoding-format"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#static-method-ecdhconvertkeykey-curve-inputencoding-outputencoding-format" target="_blank" rel="noopener noreferrer">Static method: ECDH.convertKey(key, curve[, inputEncoding[, outputEncoding[, format]]])</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘å°†å°½åŠ›ä»¥é€šä¿—æ˜“æ‡‚çš„æ–¹å¼è§£é‡Š Node.js ä¸­ <code>ECDH.convertKey</code> è¿™ä¸ªé™æ€æ–¹æ³•ã€‚</p><p>é¦–å…ˆï¼Œäº†è§£ä¸€ä¸‹èƒŒæ™¯ï¼š<code>ECDH</code> æ˜¯æŒ‡æ¤­åœ†æ›²çº¿ Diffie-Hellman å¯†é’¥äº¤æ¢åè®®ã€‚è¿™æ˜¯ä¸€ç§åœ¨ä¸¤æ–¹ä¹‹é—´å®‰å…¨åœ°äº¤æ¢å¯†é’¥çš„æ–¹æ³•ï¼Œè¢«å¹¿æ³›ç”¨äºäº’è”ç½‘å®‰å…¨é€šä¿¡ã€‚åœ¨ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸­ï¼Œ<code>ECDH</code> ç›¸å…³çš„æ–¹æ³•å…è®¸æˆ‘ä»¬æ‰§è¡Œä¸æ­¤åè®®ç›¸å…³çš„æ“ä½œï¼Œå¦‚ç”Ÿæˆå¯†é’¥ã€è®¡ç®—å…±äº«å¯†é’¥ç­‰ã€‚</p><p>ç°åœ¨æ¥çœ‹ <code>ECDH.convertKey</code> è¿™ä¸ªæ–¹æ³•ã€‚é¡¾åæ€ä¹‰ï¼Œè¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯è½¬æ¢ä¸€ä¸ªç»™å®šçš„å¯†é’¥åˆ°ä¸åŒçš„æ ¼å¼æˆ–ç¼–ç ã€‚è¿™åœ¨ä½ éœ€è¦åœ¨ä¸åŒç³»ç»Ÿæˆ–è½¯ä»¶ä¹‹é—´ä¼ é€’å¯†é’¥æ—¶ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºä¸åŒçš„ç³»ç»Ÿå¯èƒ½éœ€è¦ä¸åŒæ ¼å¼çš„å¯†é’¥ã€‚</p><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>key</code>ï¼šè¦è½¬æ¢çš„å¯†é’¥ï¼ˆå¯ä»¥æ˜¯åŸå§‹çš„ Bufferã€Base64 ç¼–ç çš„å­—ç¬¦ä¸²ç­‰ï¼‰ã€‚</li><li><code>curve</code>ï¼šæŒ‡å®šæ¤­åœ†æ›²çº¿çš„åç§°ï¼Œä¾‹å¦‚ <code>&#39;secp256k1&#39;</code>ï¼Œè¿™ä¸ªå†³å®šäº†å¯†é’¥åº”è¯¥ç¬¦åˆå“ªä¸ªæ›²çº¿çš„æ ‡å‡†ã€‚</li><li><code>inputEncoding</code>ï¼ˆå¯é€‰ï¼‰ï¼šåŸå§‹å¯†é’¥çš„ç¼–ç æ ¼å¼ï¼ˆå¦‚æœå¯†é’¥å·²ç»æ˜¯ Buffer ç±»å‹ï¼Œåˆ™ä¸éœ€è¦è¿™ä¸ªå‚æ•°ï¼‰ã€‚</li><li><code>outputEncoding</code>ï¼ˆå¯é€‰ï¼‰ï¼šè¾“å‡ºå¯†é’¥çš„ç¼–ç æ ¼å¼ã€‚</li><li><code>format</code>ï¼ˆå¯é€‰ï¼‰ï¼šæŒ‡å®šè¾“å‡ºæ ¼å¼ï¼Œå¯ä»¥æ˜¯ &#39;compressed&#39;, &#39;uncompressed&#39;, æˆ– &#39;hybrid&#39;ã€‚</li></ul><p>ç°åœ¨ä¸¾å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><h3 id="ä¾‹å­-1-å°†-base64-ç¼–ç çš„å¯†é’¥è½¬æ¢ä¸º-buffer" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-å°†-base64-ç¼–ç çš„å¯†é’¥è½¬æ¢ä¸º-buffer"><span>ä¾‹å­ 1ï¼šå°† Base64 ç¼–ç çš„å¯†é’¥è½¬æ¢ä¸º Buffer</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ æœ‰ä¸€ä¸ªBase64ç¼–ç çš„å¯†é’¥å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> base64Key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;BCEz...base64 encoded key...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬æƒ³å°†è¿™ä¸ªBase64ç¼–ç çš„å¯†é’¥è½¬æ¢ä¸ºä¸€ä¸ªBufferå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> bufferKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">ECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">convertKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  base64Key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;secp256k1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;buffer&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// bufferKey ç°åœ¨æ˜¯ä¸€ä¸ªBufferå®ä¾‹ï¼Œå…¶ä¸­åŒ…å«äº†å¯†é’¥çš„å­—èŠ‚æ•°æ®</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä¾‹å­-2-å°†-pem-æ ¼å¼çš„å¯†é’¥è½¬æ¢ä¸º-hex-ç¼–ç å­—ç¬¦ä¸²" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-å°†-pem-æ ¼å¼çš„å¯†é’¥è½¬æ¢ä¸º-hex-ç¼–ç å­—ç¬¦ä¸²"><span>ä¾‹å­ 2ï¼šå°† PEM æ ¼å¼çš„å¯†é’¥è½¬æ¢ä¸º HEX ç¼–ç å­—ç¬¦ä¸²</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ æœ‰ä¸€ä¸ªPEMæ ¼å¼çš„ç§é’¥æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> pemKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;private-key.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬æƒ³è¦å°†è¿™ä¸ªPEMæ ¼å¼çš„å¯†é’¥è½¬æ¢ä¸ºä¸€ä¸ªåå…­è¿›åˆ¶ç¼–ç çš„å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> hexKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">ECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">convertKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  pemKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;secp256k1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;uncompressed&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// hexKey ç°åœ¨æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒåŒ…å«äº†å¯†é’¥çš„åå…­è¿›åˆ¶è¡¨ç¤ºå½¢å¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä¾‹å­-3-å°†åå…­è¿›åˆ¶ç¼–ç çš„å¯†é’¥è½¬æ¢ä¸º-base64-ç¼–ç å­—ç¬¦ä¸²" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-3-å°†åå…­è¿›åˆ¶ç¼–ç çš„å¯†é’¥è½¬æ¢ä¸º-base64-ç¼–ç å­—ç¬¦ä¸²"><span>ä¾‹å­ 3ï¼šå°†åå…­è¿›åˆ¶ç¼–ç çš„å¯†é’¥è½¬æ¢ä¸º Base64 ç¼–ç å­—ç¬¦ä¸²</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ æœ‰ä¸€ä¸ªåå…­è¿›åˆ¶ç¼–ç çš„å¯†é’¥å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> hexKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;04c1...hex encoded key...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬æƒ³è¦å°†è¿™ä¸ªåå…­è¿›åˆ¶ç¼–ç çš„å¯†é’¥è½¬æ¢æˆBase64ç¼–ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> base64Key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">ECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">convertKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  hexKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;secp256k1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;compressed&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// base64Key ç°åœ¨æ˜¯Base64ç¼–ç çš„å¯†é’¥</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æ‰€æœ‰è¿™äº›ä¾‹å­ä¸­ï¼Œä½ éœ€è¦ç¡®ä¿æŒ‡å®šæ­£ç¡®çš„æ¤­åœ†æ›²çº¿åç§°å’Œç›¸åº”çš„è¾“å…¥/è¾“å‡ºç¼–ç ã€‚é€šè¿‡è¿™æ ·çš„è½¬æ¢ï¼Œä½ å¯ä»¥æ–¹ä¾¿åœ°å¤„ç†å¯†é’¥ï¼Œä½¿å…¶å…¼å®¹äºå„ç§åº”ç”¨ç¨‹åºå’Œåè®®ã€‚</p><h3 id="ecdh-computesecret-otherpublickey-inputencoding-outputencoding" tabindex="-1"><a class="header-anchor" href="#ecdh-computesecret-otherpublickey-inputencoding-outputencoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#ecdhcomputesecretotherpublickey-inputencoding-outputencoding" target="_blank" rel="noopener noreferrer">ecdh.computeSecret(otherPublicKey[, inputEncoding][, outputEncoding])</a></span></a></h3><p>Node.js ä¸­çš„ <code>ecdh.computeSecret</code> æ–¹æ³•æ˜¯ä¸€ä¸ªç”¨äºåŠ å¯†çš„å‡½æ•°ï¼Œå®ƒå±äº Node.js çš„ <code>crypto</code> æ¨¡å—ã€‚ECDH æ˜¯ Elliptic Curve Diffie-Hellman çš„ç¼©å†™ï¼Œè¿™æ˜¯ä¸€ç§åœ¨åŒæ–¹ä¸å…±äº«ç§˜å¯†å¯†é’¥çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡å„è‡ªæ‹¥æœ‰çš„å…¬å¼€ä¿¡æ¯æ¥ç”Ÿæˆä¸€ä¸ªå…±äº«ç§˜å¯†çš„æ–¹æ³•ã€‚è¿™ä¸ªå…±äº«ç§˜å¯†é€šå¸¸ä¼šè¢«ç”¨ä½œä¹‹åæ•°æ®åŠ å¯†çš„å¯†é’¥ã€‚</p><p>æˆ‘ä»¬æ¥åˆ†è§£ä¸€ä¸‹ <code>ecdh.computeSecret(otherPublicKey[, inputEncoding][, outputEncoding])</code> è¿™ä¸ªæ–¹æ³•ï¼š</p><ul><li><strong>ecdh:</strong> è¿™æ˜¯åˆ›å»ºå¥½çš„æ¤­åœ†æ›²çº¿ Diffie-Hellman çš„å®ä¾‹ã€‚</li><li><strong>computeSecret:</strong> è¿™æ˜¯å®ä¾‹ä¸Šçš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºç”Ÿæˆå…±äº«å¯†é’¥ã€‚</li><li><strong>otherPublicKey:</strong> æ˜¯å¯¹æ–¹çš„å…¬é’¥ï¼Œä½ éœ€è¦å®ƒæ¥å’Œä½ è‡ªå·±çš„ç§é’¥ç»“åˆï¼Œè®¡ç®—å‡ºå…±äº«å¯†é’¥ã€‚</li><li><strong>inputEncoding (å¯é€‰):</strong> å¦‚æœ otherPublicKey æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°æŒ‡å®šäº†å­—ç¬¦ä¸²çš„ç¼–ç æ–¹å¼ï¼ˆå¦‚ &#39;hex&#39;, &#39;base64&#39;ï¼‰ã€‚</li><li><strong>outputEncoding (å¯é€‰):</strong> å†³å®šäº†è¾“å‡ºçš„æ ¼å¼ï¼Œå¦‚æœä½ å¸Œæœ›ç»“æœæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½ å¯ä»¥è®¾ç½®ä¸º &#39;hex&#39; æˆ–è€… &#39;base64&#39; ç­‰ã€‚</li></ul><p>è®©æˆ‘ä»¬çœ‹å‡ ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><p>å‡è®¾ Alice å’Œ Bob éœ€è¦é€šè¿‡ä¸å®‰å…¨çš„é€šé“ï¼ˆæ¯”å¦‚äº’è”ç½‘ï¼‰å®‰å…¨åœ°å…±äº«æ•°æ®ã€‚ä»–ä»¬å¯ä»¥ä½¿ç”¨ ECDH å¯†é’¥åå•†ç®—æ³•æ¥ç”Ÿæˆä¸€ä¸ªå…±äº«ç§˜å¯†å¯†é’¥ï¼Œç„¶åä½¿ç”¨è¿™ä¸ªå¯†é’¥æ¥åŠ å¯†é€šä¿¡å†…å®¹ã€‚</p><p><strong>æ­¥éª¤ 1ï¼šåˆ›å»ºåŒæ–¹çš„å¯†é’¥å¯¹</strong></p><p>é¦–å…ˆï¼ŒAlice å’Œ Bob å„è‡ªåˆ›å»ºè‡ªå·±çš„å¯†é’¥å¯¹ï¼ˆä¸€ä¸ªå…¬é’¥å’Œä¸€ä¸ªç§é’¥ï¼‰ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice åˆ›å»ºå¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;secp256k1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceKeys</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob åˆ›å»ºå¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;secp256k1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobKeys</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ­¥éª¤ 2ï¼šäº¤æ¢å…¬é’¥</strong></p><p>ç„¶åï¼ŒAlice å’Œ Bob äº¤æ¢å½¼æ­¤çš„å…¬é’¥ã€‚åœ¨ç°å®åº”ç”¨ä¸­ï¼Œè¿™ä¸ªæ­¥éª¤å¯èƒ½æ¶‰åŠåˆ°å‘é€å…¬é’¥åˆ°å¯¹æ–¹çš„æœåŠ¡å™¨æˆ–è€…é€šè¿‡ç”µå­é‚®ä»¶ç­‰æ‰‹æ®µã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alicePublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> aliceKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobPublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ç°åœ¨ Alice å’Œ Bob å·²ç»äº¤æ¢äº†å…¬é’¥</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ­¥éª¤ 3ï¼šè®¡ç®—å…±äº«å¯†é’¥</strong></p><p>æœ€åï¼ŒAlice å’Œ Bob åˆ†åˆ«ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥å’Œè‡ªå·±çš„ç§é’¥æ¥è®¡ç®—å…±äº«å¯†é’¥ã€‚è¿™ä¸ªå¯†é’¥åœ¨ä¸¤è¾¹éƒ½ä¼šç›¸åŒï¼Œå³ä½¿æ”»å‡»è€…çŸ¥é“äº†åŒæ–¹çš„å…¬é’¥ï¼Œä¹Ÿæ— æ³•è®¡ç®—å‡ºè¿™ä¸ªå…±äº«ç§˜å¯†ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice ä½¿ç”¨ Bob çš„å…¬é’¥è®¡ç®—å…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob ä½¿ç”¨ Alice çš„å…¬é’¥è®¡ç®—å…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">alicePublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨ aliceSharedKey å’Œ bobSharedKey åŒ…å«ç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œå®ƒä»¬å¯ä»¥è¢«ç”¨ä½œåŠ å¯†æ•°æ®çš„å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">aliceSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> bobSharedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šå°±æ˜¯ <code>ecdh.computeSecret</code> åœ¨å®è·µä¸­çš„ä¸€ä¸ªç®€å•åº”ç”¨ä¾‹å­ã€‚é€šè¿‡ ECDHï¼ŒAlice å’Œ Bob å¯ä»¥ç¡®ä¿å³ä¾¿ä»–ä»¬çš„é€šä¿¡è·¯å¾„ä¸å®‰å…¨ï¼Œæ”»å‡»è€…ä¹Ÿæ— æ³•è·å–ä»–ä»¬çš„å…±äº«å¯†é’¥ï¼Œä»è€Œä¿è¯äº†æ•°æ®çš„å®‰å…¨æ€§ã€‚è¿™ä¸ªæŠ€æœ¯å¹¿æ³›åº”ç”¨äºäº’è”ç½‘å®‰å…¨é€šä¿¡ï¼Œä¾‹å¦‚ HTTPSã€SSH ç­‰åè®®ã€‚</p><h3 id="ecdh-generatekeys-encoding-format" tabindex="-1"><a class="header-anchor" href="#ecdh-generatekeys-encoding-format"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#ecdhgeneratekeysencoding-format" target="_blank" rel="noopener noreferrer">ecdh.generateKeys([encoding[, format]])</a></span></a></h3><p><code>ecdh.generateKeys([encoding[, format]])</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå±äº<code>crypto</code>æ¨¡å—çš„<code>ECDH</code>ï¼ˆæ¤­åœ†æ›²çº¿ Diffie-Hellmanï¼‰ç±»ã€‚è¿™ä¸ªæ–¹æ³•ç”¨äºç”Ÿæˆå…¬é’¥å’Œç§é’¥å¯¹ï¼Œåœ¨æ¤­åœ†æ›²çº¿å¯†ç å­¦ä¸­ç”¨äºå®‰å…¨åœ°åœ¨ä¸¤æ–¹ä¹‹é—´äº¤æ¢å¯†é’¥ä¿¡æ¯ã€‚</p><p>é¦–å…ˆè§£é‡Šä¸€ä¸‹æ¤­åœ†æ›²çº¿ Diffie-Hellmanï¼ˆECDHï¼‰ï¼š</p><ul><li>ECDH æ˜¯ä¸€ç§å¯†é’¥äº¤æ¢åè®®ï¼Œå…è®¸ä¸¤ä¸ªé€šä¿¡æ–¹ä½¿ç”¨å„è‡ªçš„ç§é’¥å’Œå¯¹æ–¹çš„å…¬é’¥æ¥åˆ›å»ºä¸€ä¸ªå…±äº«çš„ç§˜å¯†ï¼Œè€Œä¸å¿…ç›´æ¥äº¤æ¢ç§é’¥æœ¬èº«ã€‚</li><li>è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯å³ä½¿é€šä¿¡è¿‡ç¨‹è¢«ç›‘å¬ï¼Œç›‘å¬è€…ä¹Ÿä¸èƒ½å¾—åˆ°è¶³å¤Ÿçš„ä¿¡æ¯æ¥è®¡ç®—å‡ºäº¤æ¢çš„ç§˜å¯†ã€‚</li></ul><p>ç°åœ¨å›åˆ°<code>ecdh.generateKeys()</code>æ–¹æ³•ï¼š</p><ul><li><code>generateKeys</code>æ–¹æ³•ç”¨äºä¸º ECDH å®ä¾‹ç”Ÿæˆä¸€å¯¹æ–°çš„å…¬é’¥å’Œç§é’¥ã€‚</li><li>å¦‚æœä½ ä¸ä¼ é€’ä»»ä½•å‚æ•°ï¼Œé‚£ä¹ˆå®ƒå°†ä»¥ Node.js å†…éƒ¨æ ¼å¼ç”Ÿæˆè¿™äº›å¯†é’¥ï¼Œå¹¶ä¸”ä½ å¯ä»¥ä½¿ç”¨å…¶ä»– ECDH å¯¹è±¡çš„æ–¹æ³•æ¥ä½¿ç”¨å®ƒä»¬ã€‚</li><li>å¦‚æœä½ é€‰æ‹©ä¼ å…¥å‚æ•°<code>encoding</code>å’Œ<code>format</code>ï¼Œé‚£ä¹ˆç”Ÿæˆçš„å¯†é’¥ä¼šè¢«è½¬æ¢ä¸ºæŒ‡å®šçš„æ ¼å¼å’Œç¼–ç ã€‚</li></ul><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>encoding</code>ï¼ˆå¯é€‰ï¼‰ï¼šæŒ‡å®šè¾“å‡ºçš„ç¼–ç ç±»å‹ã€‚å¸¸è§çš„ç¼–ç åŒ…æ‹¬<code>&#39;hex&#39;</code>ã€<code>&#39;base64&#39;</code>ç­‰ã€‚</li><li><code>format</code>ï¼ˆå¯é€‰ï¼‰ï¼šæŒ‡å®šè¾“å‡ºçš„å…¬é’¥æ ¼å¼ï¼Œå¯ä»¥æ˜¯<code>&#39;compressed&#39;</code>ã€<code>&#39;uncompressed&#39;</code>æˆ–<code>&#39;hybrid&#39;</code>ã€‚</li></ul><p>å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><ol><li>åˆ›å»º ECDH å®ä¾‹å¹¶ç”Ÿæˆä¸€å¯¹å¯†é’¥ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªç”¨äºECDHçš„æ¤­åœ†æ›²çº¿ (ä¾‹å¦‚ prime256v1)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> ecdh</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;prime256v1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆå…¬é’¥å’Œç§é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">ecdh</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–ç”Ÿæˆçš„ç§é’¥å’Œå…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> privateKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> ecdh</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPrivateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> ecdh</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Private Key: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Public Key: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç”Ÿæˆäº†ä¸€å¯¹ç§é’¥å’Œå…¬é’¥ï¼Œå¹¶ä»¥åå…­è¿›åˆ¶å­—ç¬¦ä¸²çš„å½¢å¼æ‰“å°å‡ºæ¥ã€‚</p><ol start="2"><li>ç”Ÿæˆå¯†é’¥å¹¶æŒ‡å®šç¼–ç å’Œæ ¼å¼ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ...å‡è®¾ecdhå·²ç»è¢«åˆ›å»ºå¹¶å‡†å¤‡å¥½</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆå…¬é’¥ï¼ŒæŒ‡å®šç¼–ç ä¸º&#39;base64&#39;ï¼Œæ ¼å¼ä¸º&#39;compressed&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> ecdh</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;compressed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Compressed Public Key in Base64: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ªæ ¼å¼ä¸ºå‹ç¼©å½¢å¼çš„å…¬é’¥ï¼Œå¹¶ä¸”ç»“æœç¼–ç ä¸º Base64ã€‚</p><p>ECDH å¯†é’¥äº¤æ¢çš„å®é™…åº”ç”¨åŒ…æ‹¬å®‰å…¨çš„ç½‘ç»œé€šä¿¡ï¼ˆå¦‚ HTTPSï¼‰ã€å®‰å…¨çš„é‚®ä»¶ï¼ˆPGPï¼‰ç­‰åœºæ™¯ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå³ä½¿æœ‰ç¬¬ä¸‰æ–¹çªƒå¬é€šä¿¡ï¼Œä»–ä»¬ä¹Ÿæ— æ³•å¾—çŸ¥äº¤æ¢çš„å¯†é’¥å†…å®¹ï¼Œä»è€Œç¡®ä¿é€šä¿¡çš„æœºå¯†æ€§ã€‚</p><h3 id="ecdh-getprivatekey-encoding" tabindex="-1"><a class="header-anchor" href="#ecdh-getprivatekey-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#ecdhgetprivatekeyencoding" target="_blank" rel="noopener noreferrer">ecdh.getPrivateKey([encoding])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥è°ˆä¸€è°ˆ Node.js ä¸­ <code>ecdh.getPrivateKey([encoding])</code> è¿™ä¸ªæ–¹æ³•ã€‚</p><p>é¦–å…ˆï¼Œä¸ºäº†ç†è§£è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“å‡ ä¸ªå…³äºåŠ å¯†çš„æ¦‚å¿µï¼š</p><ol><li><p><strong>ECDH</strong> - ECDH ä»£è¡¨ Elliptic Curve Diffie-Hellmanï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯†é’¥äº¤æ¢åè®®ã€‚è¿™ç§åè®®å…è®¸ä¸¤ä¸ªé€šä¿¡æ–¹åœ¨ä¸€ä¸ªä¸å®‰å…¨çš„é€šé“ä¸Šå»ºç«‹ä¸€ä¸ªå…±äº«çš„ç§˜å¯†å¯†é’¥ã€‚</p></li><li><p><strong>ç§é’¥</strong> - åœ¨åŠ å¯†ä¸­ï¼Œç§é’¥æ˜¯ä¸€ä¸ªä½ å¿…é¡»ä¿å¯†çš„æ•°å­—åºåˆ—ï¼Œåªæœ‰å¯†é’¥çš„æ‹¥æœ‰è€…æ‰èƒ½ä½¿ç”¨å®ƒè¿›è¡ŒåŠ è§£å¯†æ“ä½œæˆ–ç­¾åã€‚</p></li><li><p><strong>ç¼–ç </strong> - ç¼–ç æ˜¯æ•°æ®è½¬æ¢çš„è¿‡ç¨‹ï¼Œæ¯”å¦‚å°†äºŒè¿›åˆ¶æ•°æ®è½¬æ¢æˆåå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œä»¥ä¾¿äºæ˜¾ç¤ºæˆ–ä¼ è¾“ã€‚</p></li></ol><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ <code>ecdh.getPrivateKey([encoding])</code> æ–¹æ³•åšä»€ä¹ˆï¼š</p><p>è¿™ä¸ªæ–¹æ³•ç”¨äºè·å–å½“å‰ ECDH å¯†é’¥å¯¹è±¡çš„ç§é’¥ã€‚å½“ä½ åˆ›å»ºä¸€ä¸ª ECDH å¯†é’¥å¯¹ï¼ˆå…¬é’¥å’Œç§é’¥ï¼‰ï¼Œå¹¶ä¸”æƒ³è¦è·å–ç§é’¥æ¥è¿›è¡Œå­˜å‚¨æˆ–å…¶ä»–ç”¨é€”æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p><p>å¯é€‰å‚æ•° <code>encoding</code> å…è®¸ä½ æŒ‡å®šç§é’¥åº”è¯¥ä»¥ä½•ç§æ–¹å¼ç¼–ç ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½æƒ³è¦ä»¥ &#39;hex&#39;ï¼ˆåå…­è¿›åˆ¶ï¼‰æ ¼å¼è·å–ç§é’¥ï¼Œä»¥æ–¹ä¾¿é˜…è¯»æˆ–å­˜å‚¨ã€‚</p><p>ç°åœ¨è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª ECDH å¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> ecdh</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;secp256k1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆå¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">ecdh</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–ç§é’¥ï¼Œé»˜è®¤ä¸ä½¿ç”¨ä»»ä½•ç¼–ç ï¼ˆå³è¿”å› Buffer å¯¹è±¡ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> privateKeyBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> ecdh</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPrivateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç§é’¥çš„ Buffer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKeyBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–ç§é’¥ï¼Œå¹¶ä»¥ &#39;hex&#39; ç¼–ç æ ¼å¼è¾“å‡º</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> privateKeyHex</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> ecdh</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPrivateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç§é’¥çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²è¡¨ç¤º</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKeyHex</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ul><li>æˆ‘ä»¬é¦–å…ˆè½½å…¥ Node.js çš„ <code>crypto</code> æ¨¡å—ï¼Œå®ƒæä¾›äº†åŠ å¯†åŠŸèƒ½ã€‚</li><li>ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º <code>ecdh</code> çš„ ECDH å¯†é’¥å¯¹è±¡ã€‚</li><li>æˆ‘ä»¬ä½¿ç”¨ <code>generateKeys()</code> æ–¹æ³•ç”Ÿæˆå¯†é’¥å¯¹ã€‚</li><li>æ¥ç€ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>getPrivateKey()</code> æ–¹æ³•è·å–ç§é’¥ã€‚æ²¡æœ‰æŒ‡å®šç¼–ç ï¼Œæ‰€ä»¥å®ƒè¿”å›ä¸€ä¸ª Node.js Buffer å¯¹è±¡ã€‚</li><li>æˆ‘ä»¬å†æ¬¡è°ƒç”¨ <code>getPrivateKey()</code>ï¼Œä½†è¿™æ¬¡æˆ‘ä»¬ä¼ å…¥ <code>&#39;hex&#39;</code> ä½œä¸ºå‚æ•°ï¼Œè·å–åå…­è¿›åˆ¶ç¼–ç çš„ç§é’¥ï¼Œè¿™åœ¨æ‰“å°æˆ–å­˜å‚¨æ—¶æ›´åŠ æ–¹ä¾¿ã€‚</li></ul><p>è¿™å°±æ˜¯ <code>ecdh.getPrivateKey([encoding])</code> æ–¹æ³•çš„åŸºæœ¬ä½¿ç”¨åœºæ™¯ï¼Œå®ƒéå¸¸é‡è¦ï¼Œå› ä¸ºåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¤„ç†ç§é’¥æ•°æ®é€šå¸¸æ˜¯å¿…éœ€çš„ï¼Œæ— è®ºæ˜¯ä¸ºäº†æŒä¹…åŒ–å­˜å‚¨è¿˜æ˜¯ä¸å…¶ä»–ç³»ç»Ÿå…±äº«å¯†é’¥ææ–™ã€‚</p><h3 id="ecdh-getpublickey-encoding-format" tabindex="-1"><a class="header-anchor" href="#ecdh-getpublickey-encoding-format"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#ecdhgetpublickeyencoding-format" target="_blank" rel="noopener noreferrer">ecdh.getPublicKey([encoding][, format])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥èŠä¸€èŠ Node.js ä¸­çš„<code>ecdh.getPublicKey([encoding][, format])</code>è¿™ä¸ªæ–¹æ³•ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç†è§£ä¸€äº›åŸºæœ¬æ¦‚å¿µã€‚<code>ecdh</code>æ˜¯æ¤­åœ†æ›²çº¿ Diffie-Hellman (ECDH) çš„ç¼©å†™ï¼Œè¿™æ˜¯ä¸€ä¸ªå…³äºåŠ å¯†çš„è¯é¢˜ã€‚åœ¨åŠ å¯†é¢†åŸŸï¼ŒECDH æ˜¯ä¸€ç§å¯†é’¥äº¤æ¢åè®®ï¼Œå…è®¸ä¸¤æ–¹é€šè¿‡ä¸å®‰å…¨çš„é€šé“å®‰å…¨åœ°å…±äº«ä¸€ä¸ªå¯†é’¥ã€‚ç®€å•æ¥è¯´ï¼Œå°±ç®—æœ‰äººç›‘å¬äº†ä»–ä»¬çš„é€šä¿¡ï¼Œä¹Ÿæ— æ³•å¾—çŸ¥ä»–ä»¬æœ€ç»ˆåå•†å‡ºæ¥çš„é‚£ä¸ªç§˜å¯†å¯†é’¥ã€‚</p><p>åœ¨ Node.js çš„<code>crypto</code>æ¨¡å—ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ ECDH ç±»æ¥å®ç°è¿™æ ·çš„å¯†é’¥äº¤æ¢ã€‚å½“ä¸¤ä¸ªç”¨æˆ·æƒ³è¦å®‰å…¨åœ°å…±äº«ä¿¡æ¯æ—¶ï¼Œä»–ä»¬å„è‡ªä¼šç”Ÿæˆä¸€ä¸ª ECDH å¯†é’¥å¯¹â€”â€”ä¸€ä¸ªç§é’¥å’Œä¸€ä¸ªå…¬é’¥ã€‚ç§é’¥æ˜¯ä¿å¯†çš„ï¼Œè€Œå…¬é’¥åˆ™å¯ä»¥å…¬å¼€ã€‚ç”¨æˆ·å°†å„è‡ªçš„å…¬é’¥å‘é€ç»™å¯¹æ–¹ï¼Œç„¶åä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥å’Œè‡ªå·±çš„ç§é’¥ç”Ÿæˆä¸€ä¸ªç›¸åŒçš„å…±äº«å¯†é’¥ã€‚è¿™ä¸ªå…±äº«å¯†é’¥æ¥ä¸‹æ¥å¯ä»¥ç”¨æ¥åŠ å¯†é€šä¿¡è¿‡ç¨‹ä¸­çš„æ•°æ®ã€‚</p><p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹<code>ecdh.getPublicKey([encoding][, format])</code>è¿™ä¸ªæ–¹æ³•ï¼š</p><ul><li><code>getPublicKey</code>æ˜¯ ECDH ç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨æ¥è·å–å½“å‰ ECDH å¯†é’¥å¯¹è±¡çš„å…¬é’¥ã€‚</li><li><code>encoding</code>ï¼ˆå¯é€‰ï¼‰å‚æ•°æŒ‡å®šäº†è¿”å›å€¼çš„ç¼–ç æ ¼å¼ã€‚å¯èƒ½çš„å€¼åŒ…æ‹¬&#39;hex&#39;, &#39;latin1&#39;, &#39;base64&#39;, ç­‰ç­‰ã€‚å¦‚æœçœç•¥è¿™ä¸ªå‚æ•°ï¼Œå…¬é’¥å°†ä»¥ Node.js Buffer å¯¹è±¡çš„å½¢å¼è¿”å›ã€‚</li><li><code>format</code>ï¼ˆå¯é€‰ï¼‰å‚æ•°æä¾›äº†å…¬é’¥çš„è¾“å‡ºæ ¼å¼ã€‚å¯èƒ½çš„å€¼ä¸º&#39;compressed&#39;ï¼ˆå‹ç¼©æ ¼å¼ï¼‰ï¼Œ&#39;uncompressed&#39;ï¼ˆéå‹ç¼©æ ¼å¼ï¼‰æˆ–è€…&#39;hybrid&#39;ï¼ˆæ··åˆæ ¼å¼ï¼‰ã€‚å¦‚æœçœç•¥ï¼Œå°†é»˜è®¤è¾“å‡º&#39;uncompressed&#39;ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-1"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ Alice å’Œ Bob æƒ³è¦å®‰å…¨çš„äº¤æ¢ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯ä»–ä»¬æ€æ ·ç”¨ Node.js ä¸­çš„ ECDH è¿›è¡Œæ“ä½œçš„ä¾‹å­ã€‚</p><h4 id="æ­¥éª¤-1-å¯¼å…¥-crypto-æ¨¡å—-å¹¶åˆ›å»º-ecdh-å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-1-å¯¼å…¥-crypto-æ¨¡å—-å¹¶åˆ›å»º-ecdh-å®ä¾‹"><span>æ­¥éª¤ 1: å¯¼å…¥ crypto æ¨¡å—ï¼Œå¹¶åˆ›å»º ECDH å®ä¾‹</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice åˆ›å»ºä¸€ä¸ª ECDH å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceECDH</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;secp256k1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob ä¹Ÿåˆ›å»ºä¸€ä¸ª ECDH å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobECDH</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;secp256k1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬é€‰æ‹©äº†ä¸€ä¸ªæµè¡Œçš„æ¤­åœ†æ›²çº¿<code>secp256k1</code>ä½œä¸ºæˆ‘ä»¬çš„ç®—æ³•ã€‚</p><h4 id="æ­¥éª¤-2-ç”Ÿæˆå¯†é’¥å¯¹å¹¶åˆ†äº«å…¬é’¥" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-2-ç”Ÿæˆå¯†é’¥å¯¹å¹¶åˆ†äº«å…¬é’¥"><span>æ­¥éª¤ 2: ç”Ÿæˆå¯†é’¥å¯¹å¹¶åˆ†äº«å…¬é’¥</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Aliceç”Ÿæˆå¯†é’¥å¯¹ï¼Œå¹¶è·å–å…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliceECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alicePublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> aliceECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bobç”Ÿæˆå¯†é’¥å¯¹ï¼Œå¹¶è·å–å…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">bobECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobPublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice å’Œ Bob åˆ†åˆ«æŠŠå„è‡ªçš„å…¬é’¥å‘é€ç»™å¯¹æ–¹</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™é‡Œï¼ŒAlice å’Œ Bob ç”Ÿæˆäº†ä»–ä»¬çš„å¯†é’¥å¯¹ï¼Œå¹¶å°†å…¬é’¥è½¬æ¢æˆäº†åå…­è¿›åˆ¶æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå‡†å¤‡å‘é€ç»™å¯¹æ–¹ã€‚</p><h4 id="æ­¥éª¤-3-ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥ç”Ÿæˆå…±äº«å¯†é’¥" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-3-ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥ç”Ÿæˆå…±äº«å¯†é’¥"><span>æ­¥éª¤ 3: ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥ç”Ÿæˆå…±äº«å¯†é’¥</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Aliceåˆ©ç”¨Bobçš„å…¬é’¥ç”Ÿæˆå¥¹çš„å…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> aliceECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bobåˆ©ç”¨Aliceçš„å…¬é’¥ç”Ÿæˆä»–çš„å…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">alicePublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼ŒaliceSharedKey å’Œ bobSharedKey çš„å€¼åº”è¯¥æ˜¯ç›¸åŒçš„</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">aliceSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> bobSharedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™åº”è¯¥æ‰“å° &#39;true&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªæ­¥éª¤ä¸­ï¼ŒAlice å’Œ Bob ä½¿ç”¨å¯¹æ–¹æä¾›çš„å…¬é’¥å’Œè‡ªå·±çš„ç§é’¥äº§ç”Ÿäº†ä¸€ä¸ªå…±äº«å¯†é’¥ã€‚å¦‚æœä¸¤è¾¹çš„æ“ä½œéƒ½æ­£ç¡®ï¼Œä»–ä»¬ç”Ÿæˆçš„å…±äº«å¯†é’¥åº”è¯¥æ˜¯ä¸€æ ·çš„ã€‚ç°åœ¨ä»–ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªå…±äº«å¯†é’¥æ¥åŠ å¯†ä»–ä»¬ä¹‹é—´çš„é€šä¿¡äº†ã€‚</p><p>æ€»ç»“èµ·æ¥ï¼Œ<code>ecdh.getPublicKey</code>æ–¹æ³•åœ¨ Node.js ä¸­ä¸»è¦ç”¨äºä» ECDH å®ä¾‹ä¸­è·å–å…¬é’¥ï¼Œè¯¥å…¬é’¥å¯ä»¥è¢«å‘é€ç»™é€šä¿¡å¯¹æ–¹ä»¥ä¾¿è¿›è¡Œå®‰å…¨çš„å¯†é’¥äº¤æ¢ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯å»ºç«‹å®‰å…¨é€šä¿¡æ¸ é“çš„å…³é”®ä¸€æ­¥ã€‚</p><h3 id="ecdh-setprivatekey-privatekey-encoding" tabindex="-1"><a class="header-anchor" href="#ecdh-setprivatekey-privatekey-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#ecdhsetprivatekeyprivatekey-encoding" target="_blank" rel="noopener noreferrer">ecdh.setPrivateKey(privateKey[, encoding])</a></span></a></h3><p>Node.js ä¸­çš„ <code>ecdh.setPrivateKey(privateKey[, encoding])</code> æ˜¯ä¸€ä¸ªç”¨äºåŠ å¯†çš„å‡½æ•°ï¼Œå±äº Node.js çš„ <code>crypto</code> æ¨¡å—ã€‚<code>ECDH</code> æ˜¯æŒ‡æ¤­åœ†æ›²çº¿ Diffie-Hellman å¯†é’¥äº¤æ¢åè®®ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ è®¾ç½® ECDH çš„ç§é’¥ã€‚</p><p>åœ¨äº†è§£è¿™ä¸ªå‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç®€å•äº†è§£å‡ ä¸ªæ¦‚å¿µï¼š</p><ul><li><strong>åŠ å¯†</strong>ï¼šåŠ å¯†æ˜¯ä¿¡æ¯å®‰å…¨çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå®ƒå¯ä»¥ä¿æŠ¤æ•°æ®åœ¨å­˜å‚¨æˆ–ä¼ è¾“ä¸­ä¸è¢«æœªæˆæƒè®¿é—®ã€‚</li><li><strong>ECDHï¼ˆElliptic Curve Diffie-Hellmanï¼‰</strong>ï¼šè¿™æ˜¯ä¸€ç§å¯†é’¥äº¤æ¢ç®—æ³•ï¼Œå…è®¸ä¸¤ä¸ªå‚ä¸æ–¹åœ¨æ²¡æœ‰å…±äº«ç§˜å¯†çš„å‰æä¸‹å„è‡ªç”Ÿæˆä¸€ä¸ªå¯†é’¥å¯¹ï¼Œå¹¶æœ€ç»ˆå¾—åˆ°ä¸€ä¸ªå…±äº«çš„ç§˜å¯†å¯†é’¥ï¼Œç”¨äºåç»­çš„æ•°æ®åŠ å¯†ã€‚è¿™ç§æ–¹æ³•åŸºäºæ¤­åœ†æ›²çº¿å¯†ç å­¦ã€‚</li><li><strong>ç§é’¥å’Œå…¬é’¥</strong>ï¼šåœ¨å…¬é’¥/ç§é’¥å¯†ç ä½“ç³»ä¸­ï¼Œç§é’¥æ˜¯ä¿å¯†çš„ï¼Œç”¨äºè§£å¯†æˆ–ç­¾åï¼›å…¬é’¥åˆ™å¯ä»¥å…¬å¼€ï¼Œç”¨äºåŠ å¯†æˆ–éªŒè¯ç­¾åã€‚</li></ul><p>ç°åœ¨ï¼Œæ¥è°ˆè°ˆ <code>ecdh.setPrivateKey(privateKey[, encoding])</code> æ–¹æ³•ï¼š</p><ul><li>è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¥è®¾ç½® ECDH å®ä¾‹çš„ç§é’¥çš„ã€‚è®¾ç½®å®Œç§é’¥åï¼ŒECDH å®ä¾‹å°±å¯ä»¥ç”¨æ¥ç”Ÿæˆå…±äº«çš„ç§˜å¯†ã€‚</li><li><code>privateKey</code> å‚æ•°æ˜¯ä¸€ä¸ªåŒ…å«ç§é’¥çš„ Bufferã€TypedArrayã€DataViewã€æˆ–å­—ç¬¦ä¸²ã€‚</li><li>å¯é€‰çš„ <code>encoding</code> å‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå¦‚æœ <code>privateKey</code> æ˜¯å­—ç¬¦ä¸²æ—¶ä½¿ç”¨çš„ç¼–ç æ–¹å¼ï¼Œä¾‹å¦‚ &#39;hex&#39;, &#39;utf8&#39;, &#39;base64&#39; ç­‰ã€‚</li></ul><p>å®é™…ä½¿ç”¨çš„ä¾‹å­ï¼š</p><p>å‡è®¾ Alice å’Œ Bob è¦é€šè¿‡ ECDH æ¥å®‰å…¨åœ°å…±äº«ä¸€ä¸ªå¯†é’¥ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 1. Alice åˆ›å»º ECDH å®ä¾‹ï¼Œé€‰æ‹©ä¸€ä¸ªæ¤­åœ†æ›²çº¿ç®—æ³•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceECDH</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;secp256k1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 2. Alice ç”Ÿæˆå¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliceECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 3. Bob åˆ›å»º ECDH å®ä¾‹ï¼Œé€‰æ‹©ç›¸åŒçš„æ¤­åœ†æ›²çº¿ç®—æ³•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobECDH</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;secp256k1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 4. Bob ä¹Ÿç”Ÿæˆå¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">bobECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 5. Alice å’Œ Bob äº¤æ¢ä»–ä»¬çš„å…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alicePublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> aliceECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobPublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 6. Alice ä½¿ç”¨ Bob çš„å…¬é’¥æ¥ç”Ÿæˆå…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> aliceECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 7. Bob ä½¿ç”¨ Alice çš„å…¬é’¥æ¥ç”Ÿæˆå…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">alicePublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨ï¼ŒAlice å’Œ Bob æœ‰äº†ç›¸åŒçš„å…±äº«å¯†é’¥ï¼Œå¯ä»¥ç”¨äºåŠ å¯†é€šä¿¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliceSharedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobSharedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åº”è¯¥è¾“å‡º true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒAlice éœ€è¦å°†å¥¹çš„ç§é’¥è®¾ç½®ä¸ºç‰¹å®šçš„å€¼ï¼ˆå¯èƒ½æ˜¯ä»ä¸€ä¸ªå®‰å…¨çš„å­˜å‚¨å™¨è¯»å–çš„ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ Alice çš„ç§é’¥ï¼š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alicePrivateKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> aliceECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPrivateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœ Alice éœ€è¦åœ¨å¦ä¸€ä¸ª ECDH å®ä¾‹ä¸­ä½¿ç”¨è¿™ä¸ªç§é’¥ï¼Œå¥¹å¯ä»¥è¿™æ ·åšï¼š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> anotherAliceECDH</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;secp256k1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">anotherAliceECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setPrivateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">alicePrivateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ª ECDH å®ä¾‹ï¼Œå¹¶ä¸”åˆ†åˆ«ç”Ÿæˆäº†ä»–ä»¬çš„å¯†é’¥å¯¹ã€‚ç„¶åï¼ŒAlice å’Œ Bob äº¤æ¢å…¬é’¥ï¼Œå¹¶å„è‡ªç”Ÿæˆå…±äº«çš„å¯†é’¥ã€‚æœ€åï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>setPrivateKey</code> æ–¹æ³•æ¥è®¾ç½®ä¸€ä¸ª ECDH å®ä¾‹çš„ç§é’¥ã€‚</p><p>å¸Œæœ›è¿™ä¸ªä¾‹å­èƒ½å¤Ÿå¸®åŠ©ä½ ç†è§£ <code>ecdh.setPrivateKey(privateKey[, encoding])</code> æ–¹æ³•åœ¨ Node.js ä¸­çš„è¿ç”¨ã€‚</p><h3 id="ecdh-setpublickey-publickey-encoding" tabindex="-1"><a class="header-anchor" href="#ecdh-setpublickey-publickey-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#ecdhsetpublickeypublickey-encoding" target="_blank" rel="noopener noreferrer">ecdh.setPublicKey(publicKey[, encoding])</a></span></a></h3><p><code>ecdh.setPublicKey(publicKey[, encoding])</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒç”¨äºè®¾ç½®æ¤­åœ†æ›²çº¿ Diffie-Hellman (ECDH) å¯†é’¥äº¤æ¢çš„å…¬é’¥ã€‚åœ¨è§£é‡Šè¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆæ¥ç®€å•äº†è§£ä¸€ä¸‹ ECDH æ˜¯ä»€ä¹ˆå’Œå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><h3 id="æ¤­åœ†æ›²çº¿-diffie-hellman-ecdh-å¯†é’¥äº¤æ¢" tabindex="-1"><a class="header-anchor" href="#æ¤­åœ†æ›²çº¿-diffie-hellman-ecdh-å¯†é’¥äº¤æ¢"><span>æ¤­åœ†æ›²çº¿ Diffie-Hellman (ECDH) å¯†é’¥äº¤æ¢</span></a></h3><p>ECDH æ˜¯ä¸€ç§å¯†é’¥äº¤æ¢åè®®ï¼Œå…è®¸ä¸¤ä¸ªå‚ä¸è€…åœ¨ä¸å®‰å…¨çš„é€šé“ä¸Šå»ºç«‹å…±äº«çš„å¯†é’¥ã€‚è¿™ä¸ªå…±äº«çš„å¯†é’¥å¯ä»¥ç”¨äºåç»­çš„åŠ å¯†é€šä¿¡ã€‚ECDH ä½¿ç”¨æ‰€è°“çš„æ¤­åœ†æ›²çº¿å¯†ç å­¦ï¼Œé€šè¿‡æ•°å­¦ä¸Šçš„æ¤­åœ†æ›²çº¿æ¥æé«˜å®‰å…¨æ€§åŒæ—¶å‡å°‘æ‰€éœ€è®¡ç®—é‡ã€‚</p><p>ç®€å•æ¥è¯´ï¼ŒECDH çš„å·¥ä½œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ol><li>æ¯ä¸ªå‚ä¸è€…ç”Ÿæˆè‡ªå·±çš„ä¸€å¯¹å¯†é’¥ï¼šä¸€ä¸ªç§é’¥ï¼ˆä¿å¯†ï¼‰å’Œä¸€ä¸ªä¸ä¹‹ç›¸å¯¹åº”çš„å…¬é’¥ï¼ˆå¯ä»¥å…¬å¼€ï¼‰ã€‚</li><li>ä»–ä»¬å„è‡ªå°†è‡ªå·±çš„å…¬é’¥å‘é€ç»™å¯¹æ–¹ã€‚</li><li>ä½¿ç”¨è‡ªå·±çš„ç§é’¥å’Œå¯¹æ–¹çš„å…¬é’¥ï¼Œæ¯ä¸ªå‚ä¸è€…éƒ½å¯ä»¥ç‹¬ç«‹è®¡ç®—å‡ºä¸€ä¸ªç›¸åŒçš„å…±äº«å¯†é’¥ã€‚è¿™ä¸ªå…±äº«å¯†é’¥åœ¨æ•°æ®ä¼ è¾“ä¸­ä¸ä¼šè¢«å‘é€ã€‚</li></ol><h3 id="ecdh-setpublickey-publickey-encoding-1" tabindex="-1"><a class="header-anchor" href="#ecdh-setpublickey-publickey-encoding-1"><span>ecdh.setPublicKey(publicKey[, encoding])</span></a></h3><p>åœ¨ Node.js ä¸­ä½¿ç”¨ ECDH å¯†é’¥äº¤æ¢æ—¶ï¼Œ<code>ecdh.setPublicKey(publicKey[, encoding])</code> æ–¹æ³•ç”¨äºä¸º ECDH å®ä¾‹è®¾ç½®å…¬é’¥ã€‚<code>publicKey</code> å‚æ•°æ˜¯åŒ…å«å…¬é’¥ä¿¡æ¯çš„ç¼“å†²åŒºï¼ˆBufferï¼‰æˆ–å­—ç¬¦ä¸²ï¼Œè€Œå¯é€‰çš„ <code>encoding</code> å‚æ•°æŒ‡å®šäº†å…¬é’¥æ•°æ®çš„ç¼–ç æ–¹å¼ï¼ˆä¾‹å¦‚ &#39;base64&#39;, &#39;hex&#39; ç­‰ï¼‰ï¼Œå¦‚æœå…¬é’¥æ˜¯ä¸€ä¸ªç¼“å†²åŒºåˆ™ä¸éœ€è¦æŒ‡å®šç¼–ç ã€‚</p><p>è¿™é‡Œæœ‰ä¸€ä¸ªå®é™…åº”ç”¨çš„ä¾‹å­ï¼š</p><p>å‡è®¾ Alice å’Œ Bob æƒ³è¦å®‰å…¨åœ°äº¤æ¢å¯†é’¥ã€‚é¦–å…ˆï¼Œä»–ä»¬åˆ†åˆ«åˆ›å»ºè‡ªå·±çš„ ECDH å®ä¾‹ï¼Œå¹¶ç”Ÿæˆå¯†é’¥å¯¹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice åˆ›å»º ECDH å®ä¾‹å¹¶ç”Ÿæˆå¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceECDH</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;secp256k1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alicePublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> aliceECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob åˆ›å»º ECDH å®ä¾‹å¹¶ç”Ÿæˆå¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobECDH</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;secp256k1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobPublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ç€ï¼ŒAlice å’Œ Bob äº¤æ¢ä»–ä»¬çš„å…¬é’¥ã€‚ç°åœ¨ï¼Œä¸ºäº†ä½¿ç”¨ Bob çš„å…¬é’¥ï¼ŒAlice éœ€è¦åœ¨å¥¹çš„ ECDH å®ä¾‹ä¸Šè°ƒç”¨ <code>setPublicKey</code> æ–¹æ³•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice è®¾ç½® Bob çš„å…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliceECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>åŒæ ·ï¼ŒBob ä¹Ÿä¼šè®¾ç½® Alice çš„å…¬é’¥ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob è®¾ç½® Alice çš„å…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">bobECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">alicePublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>å®Œæˆè¿™äº›æ­¥éª¤ä¹‹åï¼ŒAlice å’Œ Bob éƒ½å¯ä»¥åˆ©ç”¨å¯¹æ–¹çš„å…¬é’¥å’Œè‡ªå·±çš„ç§é’¥æ¥ç”Ÿæˆä¸€ä¸ªå…±äº«çš„å¯†é’¥ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice å’Œ Bob åˆ†åˆ«è®¡ç®—å…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> aliceECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">alicePublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™ä¸¤ä¸ªå…±äº«çš„å¯†é’¥åº”è¯¥æ˜¯ç›¸åŒçš„</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliceSharedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equals</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobSharedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºåº”è¯¥æ˜¯ true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ€»ç»“èµ·æ¥ï¼Œ<code>ecdh.setPublicKey()</code> æ–¹æ³•æ˜¯åœ¨ ECDH å¯†é’¥äº¤æ¢ä¸­è®¾ç½®å¯¹æ–¹å…¬é’¥çš„é‡è¦æ­¥éª¤ï¼Œä»¥ä¾¿è®¡ç®—å‡ºå…±äº«å¯†é’¥ï¼Œä»è€Œè¿›è¡Œå®‰å…¨çš„é€šä¿¡ã€‚</p><h2 id="class-hash" tabindex="-1"><a class="header-anchor" href="#class-hash"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#class-hash" target="_blank" rel="noopener noreferrer">Class: Hash</a></span></a></h2><p>Node.js çš„ <code>crypto</code> æ¨¡å—æä¾›äº†åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬åˆ›å»ºå“ˆå¸Œï¼ˆHashï¼‰çš„èƒ½åŠ›ã€‚åœ¨ Node.js ä¸­ï¼Œå“ˆå¸Œæ˜¯ä¸€ä¸ªå°†ä»»æ„å¤§å°çš„æ•°æ®è½¬æ¢æˆå›ºå®šé•¿åº¦å­—ç¬¦ä¸²çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªç»“æœå­—ç¬¦ä¸²ä¹Ÿè¢«ç§°ä½œæ‘˜è¦ï¼ˆdigestï¼‰ã€‚å“ˆå¸Œç®—æ³•è®¾è®¡å¾—å°½å¯èƒ½å”¯ä¸€ï¼šå³ä½¿æ˜¯å¾®å°çš„è¾“å…¥å˜åŒ–éƒ½ä¼šäº§ç”Ÿå®Œå…¨ä¸åŒçš„è¾“å‡ºæ‘˜è¦ã€‚</p><p><code>Class: Hash</code> æ˜¯ <code>crypto</code> æ¨¡å—å†…ç”¨äºåˆ›å»ºæ•°æ®çš„å“ˆå¸Œæ‘˜è¦çš„ç±»ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-hash-ç±»" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-hash-ç±»"><span>å¦‚ä½•ä½¿ç”¨ Hash ç±»</span></a></h3><p>é¦–å…ˆï¼Œä½ éœ€è¦å¼•å…¥ <code>crypto</code> æ¨¡å—ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç„¶åï¼Œå¯ä»¥ä½¿ç”¨ <code>crypto.createHash</code> æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ Hash å¯¹è±¡ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// &#39;sha256&#39; æ˜¯ä¸€ç§æµè¡Œçš„å“ˆå¸Œç®—æ³•</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ä¹‹åï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>update</code> æ–¹æ³•å°†æ•°æ®æ·»åŠ åˆ° Hash å¯¹è±¡ä¸­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;some data to hash&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æœ€åï¼Œä½¿ç”¨ <code>digest</code> æ–¹æ³•æ¥ç”Ÿæˆæ‘˜è¦ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> digest</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºä¸º16è¿›åˆ¶æ ¼å¼çš„å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºå“ˆå¸Œå€¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-2"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>å¯†ç å­˜å‚¨</strong><br> åœ¨ç”¨æˆ·æ³¨å†Œè¿‡ç¨‹ä¸­ï¼Œå®‰å…¨åœ°å­˜å‚¨å¯†ç å¾ˆé‡è¦ã€‚é€šå¸¸ï¼Œå¯†ç ä¼šè¢«å“ˆå¸Œå¤„ç†åå­˜å‚¨ï¼Œä»¥é˜²æ•°æ®åº“æ³„éœ²æ—¶æš´éœ²åŸæ–‡ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> password</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;user-password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hashedPassword</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å­˜å‚¨ hashedPassword åˆ°æ•°æ®åº“ä¸­</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ–‡ä»¶å®Œæ•´æ€§æ ¡éªŒ</strong><br> å“ˆå¸Œç»å¸¸ç”¨äºæ ¡éªŒæ–‡ä»¶æ˜¯å¦åœ¨ä¼ è¾“æˆ–å­˜å‚¨è¿‡ç¨‹ä¸­è¢«ç¯¡æ”¹ã€‚é€šè¿‡æ¯”è¾ƒæ–‡ä»¶çš„åŸå§‹å“ˆå¸Œå’Œå½“å‰å“ˆå¸Œï¼Œå¯ä»¥éªŒè¯æ–‡ä»¶çš„å®Œæ•´æ€§ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fileBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path/to/file.zip&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fileBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fileDigest</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨ fileDigest åŒ…å«äº†æ–‡ä»¶çš„å“ˆå¸Œå€¼ï¼Œå¯ä»¥å’ŒåŸå§‹å“ˆå¸Œå€¼å¯¹æ¯”</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>API è¯·æ±‚ç­¾å</strong><br> API è¯·æ±‚ç­¾åæ˜¯ä¸€ç§å®‰å…¨æªæ–½ï¼Œç”¨äºç¡®ä¿è¯·æ±‚æœªè¢«ç¯¡æ”¹ã€‚å‘é€è¯·æ±‚æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šç”Ÿæˆè¯·æ±‚å†…å®¹çš„å“ˆå¸Œå€¼ï¼Œå¹¶å°†å…¶ä½œä¸ºç­¾åå‘é€ã€‚æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚åï¼Œä¼šé‡æ–°è®¡ç®—å“ˆå¸Œå€¼å¹¶ä¸ç­¾åè¿›è¡Œå¯¹æ¯”ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> requestData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;data-to-send&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secretKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;secret-api-key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">requestData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨å¯†é’¥å¢å¼ºå®‰å…¨æ€§</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> requestSignature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‘é€ requestData å’Œ requestSignature åˆ°æœåŠ¡å™¨</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>ä½¿ç”¨å“ˆå¸Œæ˜¯å¢å¼ºæ•°æ®å®‰å…¨æ€§çš„ä¸€ç§æ–¹å¼ï¼Œä½†å®ƒå¹¶ä¸é€‚åˆæ‰€æœ‰æƒ…å†µã€‚ä¾‹å¦‚ï¼Œç”±äºå“ˆå¸Œæ˜¯å•å‘è½¬æ¢ï¼Œå› æ­¤ä¸åº”è¯¥ç”¨å®ƒæ¥åŠ å¯†æ•æ„Ÿä¿¡æ¯â€”â€”ä¸€æ—¦æ•°æ®è¢«å“ˆå¸Œï¼Œä½ å°±æ— æ³•æ¢å¤åŸå§‹æ•°æ®ã€‚å–è€Œä»£ä¹‹ï¼Œä½ åº”è¯¥ä½¿ç”¨åŠ å¯†ç®—æ³•ï¼Œè¿™æ˜¯å¦å¤–ä¸€ä¸ªä¸»é¢˜äº†ã€‚</p><h3 id="hash-copy-options" tabindex="-1"><a class="header-anchor" href="#hash-copy-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#hashcopyoptions" target="_blank" rel="noopener noreferrer">hash.copy([options])</a></span></a></h3><p><code>hash.copy([options])</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—çš„ä¸€ä¸ªæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨äºå¤åˆ¶å½“å‰å“ˆå¸Œå¯¹è±¡çš„çŠ¶æ€ï¼Œä½¿ä½ å¯ä»¥ä»ç›¸åŒçš„æ•°æ®çŠ¶æ€ç»§ç»­ç”Ÿæˆå¤šä¸ªå“ˆå¸Œå€¼ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯å“ˆå¸Œï¼ˆHashï¼‰ã€‚åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œå“ˆå¸Œæ˜¯å°†è¾“å…¥ï¼ˆæˆ–è€…ç§°ä¹‹ä¸ºæ¶ˆæ¯ï¼‰è½¬æ¢æˆå›ºå®šå¤§å°çš„å­—ç¬¦ä¸²ï¼ˆé€šå¸¸æ˜¯åå…­è¿›åˆ¶å½¢å¼ï¼‰ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯é€šè¿‡å“ˆå¸Œå‡½æ•°æ¥å®Œæˆçš„ã€‚è¿™ä¸ªå­—ç¬¦ä¸²è¢«ç§°ä¸ºæ¶ˆæ¯æ‘˜è¦æˆ–å“ˆå¸Œå€¼ã€‚å“ˆå¸Œå€¼é€šå¸¸ç”¨äºéªŒè¯æ•°æ®å®Œæ•´æ€§ï¼Œæ¯”å¦‚æ–‡ä»¶æ ¡éªŒã€å¯†ç å­˜å‚¨ç­‰ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>crypto</code>æ¨¡å—æä¾›äº†åŠ å¯†åŠŸèƒ½ï¼Œå…¶ä¸­åŒ…æ‹¬åˆ›å»ºå“ˆå¸Œå€¼ã€‚ä½¿ç”¨<code>crypto.createHash()</code>å¯ä»¥åˆ›å»ºä¸€ä¸ªå“ˆå¸Œå¯¹è±¡ï¼Œç„¶åä½ å¯ä»¥å‘å…¶æ·»åŠ æ•°æ®ï¼Œæœ€ç»ˆè°ƒç”¨<code>hash.digest()</code>æ¥å¾—åˆ°å“ˆå¸Œå€¼ã€‚</p><p>ç°åœ¨ï¼Œå½“ä½ æƒ³è¦ä»ç›¸åŒçš„æ•°æ®çŠ¶æ€å‡ºå‘ç»§ç»­ç”Ÿæˆå“ˆå¸Œå€¼æ—¶ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨<code>hash.copy()</code>ã€‚è¿™ä¸ªæ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å“ˆå¸Œå¯¹è±¡ï¼Œå®ƒçš„å†…éƒ¨çŠ¶æ€æ˜¯å½“å‰å“ˆå¸Œå¯¹è±¡çš„ç²¾ç¡®å‰¯æœ¬ã€‚è¿™æ ·ï¼Œä½ å¯ä»¥åœ¨ä¸å½±å“åŸå§‹å“ˆå¸Œå¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œå¯¹è¿™ä¸ªå‰¯æœ¬æ·»åŠ æ–°çš„æ•°æ®å¹¶ç”Ÿæˆä¸åŒçš„å“ˆå¸Œå€¼ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæ–°çš„å“ˆå¸Œå¯¹è±¡ï¼Œå¹¶æ·»åŠ ä¸€äº›æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦å¾—åˆ°ä¸Šé¢æ•°æ®çš„å“ˆå¸Œå€¼ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½†åŒæ—¶åˆæƒ³è¦åŸºäºåŸæ¥çš„æ•°æ®â€œHello, World!â€æ·»åŠ æ›´å¤šæ•°æ®æ¥åˆ›å»ºå¦ä¸€ä¸ªå“ˆå¸Œå€¼ã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬å¯ä»¥ä½¿ç”¨hash.copy()æ¥å¤åˆ¶å½“å‰çš„å“ˆå¸Œå¯¹è±¡çŠ¶æ€ã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hash1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">copy</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯¹åŸå§‹å“ˆå¸Œå¯¹è±¡è¿›è¡Œæ‘˜è¦(å³è®¡ç®—æœ€ç»ˆçš„å“ˆå¸Œå€¼)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> digest1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hash1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Hash1: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">digest1</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç„¶åï¼Œå¯ä»¥åœ¨å‰¯æœ¬ä¸Šæ·»åŠ æ–°çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot; Let us add this extra data.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¡ç®—æ–°å“ˆå¸Œå¯¹è±¡çš„æ‘˜è¦</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> digest2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hash2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Hash2: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">digest2</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>hash1</code> æ˜¯æˆ‘ä»¬ç¬¬ä¸€æ¬¡åˆ›å»ºçš„å“ˆå¸Œå¯¹è±¡ï¼Œæˆ‘ä»¬æ·»åŠ äº†å­—ç¬¦ä¸² &quot;Hello, World!&quot; å¹¶è®¡ç®—äº†å®ƒçš„å“ˆå¸Œå€¼ã€‚ç„¶åæˆ‘ä»¬è°ƒç”¨ <code>hash1.copy()</code> æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„å“ˆå¸Œå¯¹è±¡ <code>hash2</code>ï¼Œå®ƒä¸ <code>hash1</code> æœ‰ç›¸åŒçš„åˆå§‹çŠ¶æ€ã€‚æ¥ç€æˆ‘ä»¬æ·»åŠ äº†é¢å¤–çš„æ•°æ®åˆ° <code>hash2</code>ï¼Œå¹¶è®¡ç®—äº†æ–°çš„å“ˆå¸Œå€¼ã€‚æ³¨æ„ï¼Œå°½ç®¡æˆ‘ä»¬åœ¨ä¸¤ä¸ªå“ˆå¸Œå¯¹è±¡ä¸Šä½¿ç”¨äº†ç›¸åŒçš„åŸå§‹æ•°æ®ï¼Œä½†ç”±äº <code>hash2</code> å¢åŠ äº†é¢å¤–çš„æ•°æ®ï¼Œæ‰€ä»¥æœ€ç»ˆç”Ÿæˆçš„å“ˆå¸Œå€¼æ˜¯ä¸åŒçš„ã€‚</p><p>æ€»ç»“èµ·æ¥ï¼Œ<code>hash.copy([options])</code> å¯ä»¥åœ¨ä½ éœ€è¦ä¿ç•™å½“å‰å“ˆå¸Œè¿›åº¦çš„åŒæ—¶ï¼Œç»§ç»­ä»æŸä¸ªç‰¹å®šç‚¹å˜æ›´æˆ–æ·»åŠ æ•°æ®æ¥ç”Ÿæˆæ–°çš„å“ˆå¸Œå€¼æ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="hash-digest-encoding" tabindex="-1"><a class="header-anchor" href="#hash-digest-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#hashdigestencoding" target="_blank" rel="noopener noreferrer">hash.digest([encoding])</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘ä¼šå°½é‡è¯¦ç»†ä¸”é€šä¿—åœ°è§£é‡Šç»™ä½ ã€‚</p><p>Node.js æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„ JavaScript ç¯å¢ƒã€‚å®ƒæä¾›äº†å¾ˆå¤šå†…å»ºæ¨¡å—ï¼Œå…¶ä¸­ <code>crypto</code> æ¨¡å—å°±æ˜¯ç”¨æ¥å¤„ç†åŠ å¯†ç›¸å…³çš„æ“ä½œã€‚åœ¨ <code>crypto</code> æ¨¡å—ä¸­ï¼Œ<code>hash</code> æ˜¯ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œå®ƒèƒ½å¤Ÿå°†ä»»æ„å¤§å°çš„æ•°æ®è½¬æ¢æˆå›ºå®šé•¿åº¦çš„ä¸²ï¼ˆé€šå¸¸ç§°ä¸ºæ‘˜è¦æˆ–è€…æ•£åˆ—å€¼ï¼‰ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å•å‘çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ ä¸èƒ½ä»æ•£åˆ—å€¼é€†æ¨å›åŸå§‹æ•°æ®ã€‚</p><p><code>hash.digest([encoding])</code> æ–¹æ³•æ˜¯ <code>hash</code> å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå½“ä½ é€šè¿‡ <code>crypto</code> åˆ›å»ºäº†ä¸€ä¸ªå“ˆå¸Œå®ä¾‹å¹¶è¾“å…¥äº†æ•°æ® (<code>hash.update(data)</code>) åï¼Œä½ å¯ä»¥è°ƒç”¨ <code>hash.digest([encoding])</code> æ¥äº§ç”Ÿæ‘˜è¦ã€‚å¯é€‰å‚æ•° <code>encoding</code> è¡¨ç¤ºè¾“å‡ºæ ¼å¼ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤è¿”å›ä¸€ä¸ª Buffer å¯¹è±¡ï¼›å¦‚æœæŒ‡å®šäº†ç¼–ç ï¼ˆå¦‚ &#39;hex&#39;ã€&#39;base64&#39;ç­‰ï¼‰ï¼Œåˆ™è¿”å›ç›¸åº”ç¼–ç çš„å­—ç¬¦ä¸²ã€‚</p><p>ä¸‹é¢æˆ‘ä¼šç»™ä½ ä¸¾ä¸¤ä¸ªä¾‹å­æ¥è¯´æ˜ <code>hash.digest([encoding])</code> çš„ä½¿ç”¨ï¼š</p><h3 id="ä¾‹å­-1-ç”Ÿæˆå­—ç¬¦ä¸²çš„-sha-256-æ•£åˆ—å€¼" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-ç”Ÿæˆå­—ç¬¦ä¸²çš„-sha-256-æ•£åˆ—å€¼"><span>ä¾‹å­ 1ï¼šç”Ÿæˆå­—ç¬¦ä¸²çš„ SHA-256 æ•£åˆ—å€¼</span></a></h3><p>è®©æˆ‘ä»¬ç”¨ Node.js ç”Ÿæˆä¸€ä¸ªå­—ç¬¦ä¸²çš„ SHA-256 æ•£åˆ—å€¼ï¼Œå¹¶ä»¥åå…­è¿›åˆ¶å­—ç¬¦ä¸²çš„å½¢å¼è¾“å‡ºã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå“ˆå¸Œå®ä¾‹ï¼Œè¿™é‡Œä½¿ç”¨ SHA-256 ç®—æ³•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å…¥è¦ç”Ÿæˆå“ˆå¸Œå€¼çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆæ•£åˆ—å€¼çš„åå…­è¿›åˆ¶è¡¨ç¤º</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> digest</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºæ•£åˆ—å€¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ä½ è¿è¡Œè¿™æ®µä»£ç æ—¶ï¼Œä¼šçœ‹åˆ°æ§åˆ¶å°æ‰“å°å‡º &quot;Hello, World!&quot; å­—ç¬¦ä¸²çš„ SHA-256 æ•£åˆ—å€¼çš„åå…­è¿›åˆ¶è¡¨ç¤ºã€‚</p><h3 id="ä¾‹å­-2-æ£€éªŒæ–‡ä»¶çš„å®Œæ•´æ€§" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-æ£€éªŒæ–‡ä»¶çš„å®Œæ•´æ€§"><span>ä¾‹å­ 2ï¼šæ£€éªŒæ–‡ä»¶çš„å®Œæ•´æ€§</span></a></h3><p>å¦å¤–ä¸€ä¸ªå®é™…åº”ç”¨çš„ä¾‹å­æ˜¯ç”¨å“ˆå¸Œå€¼æ¥æ£€éªŒæ–‡ä»¶çš„å®Œæ•´æ€§ã€‚å‡è®¾ä½ ä¸‹è½½äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶å¾—åˆ°äº†è¿™ä¸ªæ–‡ä»¶çš„é¢„æœŸ MD5 æ•£åˆ—å€¼ï¼Œä½ å¯ä»¥ç”¨ Node.js æ¥è®¡ç®—ä¸‹è½½æ–‡ä»¶çš„ MD5 å€¼ï¼Œç„¶åæ¯”è¾ƒæ˜¯å¦ä¸€è‡´ï¼Œç¡®ä¿æ–‡ä»¶åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«ä¿®æ”¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> file</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;path/to/your/downloaded/file&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªæµæ¥è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> stream</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createReadStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">file</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª MD5 å“ˆå¸Œå®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;md5&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fileDigest</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fileDigest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œä¼šæ‰“å°å‡ºæ–‡ä»¶çš„ MD5 æ•£åˆ—å€¼</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> expectedDigest</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;é¢„æœŸçš„MD5æ•£åˆ—å€¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ›¿æ¢ä¸ºç»™å®šçš„æ•£åˆ—å€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fileDigest</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> expectedDigest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ–‡ä»¶å®Œæ•´æ€§éªŒè¯æˆåŠŸï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ–‡ä»¶å·²è¢«ç¯¡æ”¹ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>fs</code> æ¨¡å—åˆ›å»ºäº†ä¸€ä¸ªè¯»å–æ–‡ä»¶çš„æµï¼Œå¹¶ä¸”åœ¨æ•°æ®æµåŠ¨æ—¶é€æ­¥æ›´æ–°å“ˆå¸Œå¯¹è±¡ã€‚å½“æ–‡ä»¶å…¨éƒ¨è¯»å–å®Œæ¯•åï¼Œæˆ‘ä»¬è·å–æ‘˜è¦å¹¶ä¸é¢„æœŸçš„æ•£åˆ—å€¼è¿›è¡Œæ¯”è¾ƒï¼Œä»¥æ­¤æ¥æ£€éªŒæ–‡ä»¶çš„å®Œæ•´æ€§ã€‚</p><p>è¯·è®°ä½ï¼Œè¿™äº›åªæ˜¯ <code>hash.digest([encoding])</code> æ–¹æ³•çš„ä¸€äº›åŸºæœ¬ç”¨é€”ï¼Œåœ¨å®é™…å¼€å‘ä¸­è¿˜æœ‰æ›´å¤šå¤æ‚çš„æƒ…å†µå’Œç”¨é€”ï¼Œä½†è¿™åº”è¯¥è¶³ä»¥è®©ä½ ç†è§£å…¶å·¥ä½œåŸç†å’ŒåŸºæœ¬åº”ç”¨äº†ã€‚</p><h3 id="hash-update-data-inputencoding" tabindex="-1"><a class="header-anchor" href="#hash-update-data-inputencoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#hashupdatedata-inputencoding" target="_blank" rel="noopener noreferrer">hash.update(data[, inputEncoding])</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘ä¼šè¯¦ç»†è§£é‡Š Node.js ä¸­ <code>hash.update(data[, inputEncoding])</code> è¿™ä¸ªå‡½æ•°çš„ç”¨é€”å’Œè¿ç”¨ã€‚</p><p>åœ¨ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸­ï¼Œæä¾›äº†ä¸€ç³»åˆ—åŠ å¯†ç›¸å…³çš„åŠŸèƒ½ã€‚å…¶ä¸­ï¼Œåˆ›å»ºå“ˆå¸Œï¼ˆHashï¼‰æ˜¯ä¸€ä¸ªå¸¸è§çš„æ“ä½œï¼Œå®ƒå¯ä»¥æŠŠä»»æ„é•¿åº¦çš„æ•°æ®è½¬æ¢æˆä¸€ä¸ªå›ºå®šé•¿åº¦çš„å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²è¢«ç§°ä¸ºâ€œå“ˆå¸Œå€¼â€ã€‚</p><p>å“ˆå¸Œå€¼æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ol><li>å¯¹äºåŒæ ·çš„è¾“å…¥ï¼Œæ€»æ˜¯äº§ç”Ÿç›¸åŒçš„å“ˆå¸Œå€¼ã€‚</li><li>å³ä½¿åªæœ‰å¾ˆå°çš„è¾“å…¥å·®å¼‚ï¼Œä¹Ÿä¼šäº§ç”Ÿæˆªç„¶ä¸åŒçš„å“ˆå¸Œå€¼ã€‚</li><li>ä»å“ˆå¸Œå€¼ä¸èƒ½åæ¨å‡ºåŸå§‹æ•°æ®ï¼ˆå•å‘æ€§ï¼‰ã€‚</li></ol><p><code>hash.update(data[, inputEncoding])</code> å‡½æ•°å°±æ˜¯ç”¨æ¥æ›´æ–° hash å¯¹è±¡çš„å†…å®¹çš„ã€‚å½“ä½ æƒ³å¯¹ä¸€äº›æ•°æ®ç”Ÿæˆå“ˆå¸Œå€¼æ—¶ï¼Œé¦–å…ˆä½ ä¼šåˆ›å»ºä¸€ä¸ªå“ˆå¸Œå¯¹è±¡ï¼Œç„¶åé€šè¿‡ <code>update</code> æ–¹æ³•å°†æ•°æ®è¾“å…¥åˆ°è¿™ä¸ªå¯¹è±¡ä¸­ã€‚å¦‚æœä½ çš„æ•°æ®é‡å¾ˆå¤§æˆ–è€…æ˜¯åˆ†æ‰¹åˆ°è¾¾çš„ï¼Œä½ å¯ä»¥å¤šæ¬¡è°ƒç”¨ <code>update</code> æ–¹æ³•ï¼Œæœ€åä½¿ç”¨ <code>hash.digest()</code> æ–¹æ³•è¾“å‡ºæœ€ç»ˆçš„å“ˆå¸Œå€¼ã€‚</p><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>data</code>ï¼šä½ æƒ³è¦åŠ å…¥å“ˆå¸Œè®¡ç®—çš„æ•°æ®ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ç±»å‹æˆ–è€… Buffer ç±»å‹ã€‚</li><li><code>inputEncoding</code>ï¼šå½“ <code>data</code> å‚æ•°æ˜¯å­—ç¬¦ä¸²ç±»å‹æ—¶ï¼Œè¿™ä¸ªå¯é€‰å‚æ•°ç”¨æ¥æŒ‡å®š <code>data</code> å­—ç¬¦ä¸²çš„ç¼–ç æ–¹å¼ï¼Œæ¯”å¦‚ <code>&#39;utf8&#39;</code>, <code>&#39;ascii&#39;</code>, <code>&#39;latin1&#39;</code> ç­‰ã€‚</li></ul><p>ç°åœ¨æ¥ä¸¾å‡ ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><h3 id="ç¤ºä¾‹-1-ç®€å•çš„å“ˆå¸Œç”Ÿæˆ" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ç®€å•çš„å“ˆå¸Œç”Ÿæˆ"><span>ç¤ºä¾‹ 1ï¼šç®€å•çš„å“ˆå¸Œç”Ÿæˆ</span></a></h3><p>å‡è®¾ä½ æƒ³å¯¹å­—ç¬¦ä¸² &quot;hello world&quot; ç”Ÿæˆä¸€ä¸ª MD5 å“ˆå¸Œå€¼ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå“ˆå¸Œå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;md5&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ›´æ–°æ•°æ®åˆ°å“ˆå¸Œå¯¹è±¡ä¸­ï¼Œæˆ‘ä»¬è¿™é‡Œç›´æ¥ä½¿ç”¨é»˜è®¤çš„ &#39;utf8&#39; ç¼–ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hello world&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¡ç®—å¹¶è·å–æœ€ç»ˆçš„å“ˆå¸Œå€¼ï¼Œä»¥åå…­è¿›åˆ¶å½¢å¼è¾“å‡º</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> digest</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå¯èƒ½ä¼šæ˜¯ï¼š5eb63bbbe01eeed093cb22bb8f5acdc3</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç¤ºä¾‹-2-åˆ†æ‰¹æ›´æ–°å“ˆå¸Œå¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-åˆ†æ‰¹æ›´æ–°å“ˆå¸Œå¯¹è±¡"><span>ç¤ºä¾‹ 2ï¼šåˆ†æ‰¹æ›´æ–°å“ˆå¸Œå¯¹è±¡</span></a></h3><p>å½“ä½ å¤„ç†çš„æ•°æ®éå¸¸å¤§ï¼Œæˆ–è€…æ˜¯æµå¼ä¼ è¾“æ—¶ï¼Œä½ å¯ä»¥åˆ†æ‰¹æ¬¡å¯¹æ•°æ®è¿›è¡Œå“ˆå¸Œå¤„ç†ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå“ˆå¸Œå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æœ‰ä¸¤æ‰¹æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç¬¬ä¸€æ‰¹æ•°æ®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç¬¬äºŒæ‰¹æ•°æ®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æœ€ç»ˆè·å–å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> digest</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºä¸ºè¿™ä¸¤æ‰¹æ•°æ®åˆèµ·æ¥çš„å“ˆå¸Œå€¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç¤ºä¾‹-3-ä½¿ç”¨ä¸åŒç¼–ç çš„æ•°æ®" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-ä½¿ç”¨ä¸åŒç¼–ç çš„æ•°æ®"><span>ç¤ºä¾‹ 3ï¼šä½¿ç”¨ä¸åŒç¼–ç çš„æ•°æ®</span></a></h3><p>å¦‚æœä½ çš„æ•°æ®ä¸æ˜¯ UTF-8 ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œä½ éœ€è¦æŒ‡å®šæ­£ç¡®çš„ç¼–ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬çš„æ•°æ®æ˜¯ base64 ç¼–ç çš„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;aGVsbG8gd29ybGQ=&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// &#39;hello world&#39; çš„ base64 ç¼–ç </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ &#39;base64&#39; ä½œä¸ºè¾“å…¥ç¼–ç æ›´æ–°å“ˆå¸Œå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> digest</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æ‰€æœ‰çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬éƒ½ä½¿ç”¨äº† <code>digest</code> æ–¹æ³•æ¥è·å–æœ€ç»ˆçš„å“ˆå¸Œå€¼ã€‚è¿™ä¸ªæ–¹æ³•ç”¨æ¥æ ‡è®°å“ˆå¸Œå¯¹è±¡çš„ç»“æŸï¼Œå¹¶è¿”å›è®¡ç®—å¾—åˆ°çš„å“ˆå¸Œå€¼ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯å¯¹ <code>hash.update(data[, inputEncoding])</code> æ–¹æ³•çš„é€šä¿—æ˜“æ‡‚ä¸”è¯¦ç»†çš„è§£é‡Šã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå“ˆå¸Œè¢«å¹¿æ³›ç”¨äºæ•°æ®å®Œæ•´æ€§æ ¡éªŒã€å®‰å…¨å­˜å‚¨å¯†ç ç­‰åœºæ™¯ã€‚</p><h2 id="class-hmac" tabindex="-1"><a class="header-anchor" href="#class-hmac"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#class-hmac" target="_blank" rel="noopener noreferrer">Class: Hmac</a></span></a></h2><p>å¥½çš„ï¼Œæˆ‘æ¥å¸®ä½ ç†è§£ Node.js ä¸­çš„ Hmac ç±»ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ Hmac æ˜¯ä»€ä¹ˆã€‚Hmac ä»£è¡¨â€œHash-based Message Authentication Codeâ€ï¼Œå³åŸºäºæ•£åˆ—çš„æ¶ˆæ¯è®¤è¯ç ã€‚è¿™æ˜¯ä¸€ç§ç”¨äºæ¶ˆæ¯è®¤è¯çš„æŠ€æœ¯ï¼Œå®ƒç»“åˆäº†åŠ å¯†å“ˆå¸Œå‡½æ•°å’Œä¸€ä¸ªå¯†é’¥ã€‚åœ¨ç½‘ç»œä¼ è¾“æˆ–æ•°æ®å­˜å‚¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Hmac æ¥ç¡®ä¿æ¶ˆæ¯çš„å®Œæ•´æ€§å’ŒçœŸå®æ€§ã€‚</p><p>åœ¨ Node.js çš„<code>crypto</code>æ¨¡å—ä¸­ï¼Œ<code>Hmac</code>ç±»å°±æ˜¯ç”¨æ¥åˆ›å»ºè¿™æ ·çš„è®¤è¯ç çš„ã€‚ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨ Node.js ä¸­çš„<code>Hmac</code>ç±»çš„æ­¥éª¤ï¼š</p><h3 id="åˆ›å»º-hmac-å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#åˆ›å»º-hmac-å®ä¾‹"><span>åˆ›å»º Hmac å®ä¾‹</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œè¦åˆ›å»ºä¸€ä¸ª<code>Hmac</code>å®ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>crypto.createHmac()</code>æ–¹æ³•ã€‚è¯¥æ–¹æ³•éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªæ˜¯å“ˆå¸Œç®—æ³•ï¼Œä¾‹å¦‚<code>&#39;sha256&#39;</code>ï¼›ç¬¬äºŒä¸ªæ˜¯ç”¨äºç”Ÿæˆ HMAC çš„å¯†é’¥ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªHmacå®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä¸€ä¸ªç§˜å¯†çš„å¯†é’¥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ›´æ–°æ•°æ®" tabindex="-1"><a class="header-anchor" href="#æ›´æ–°æ•°æ®"><span>æ›´æ–°æ•°æ®</span></a></h3><p>åˆ›å»ºäº†<code>Hmac</code>å®ä¾‹åï¼Œä½ å¯ä»¥é€šè¿‡<code>update()</code>æ–¹æ³•å‘å…¶ä¼ é€’æ•°æ®ã€‚è¿™é€šå¸¸æ˜¯ä½ æƒ³è¦éªŒè¯çš„æ¶ˆæ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;éœ€è¦è¢«éªŒè¯çš„æ¶ˆæ¯&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="è®¡ç®—æ‘˜è¦" tabindex="-1"><a class="header-anchor" href="#è®¡ç®—æ‘˜è¦"><span>è®¡ç®—æ‘˜è¦</span></a></h3><p>å½“ä½ æ·»åŠ å®Œæ‰€æœ‰æ•°æ®åï¼Œå¯ä»¥ä½¿ç”¨<code>digest()</code>æ–¹æ³•æ¥ç”Ÿæˆæ¶ˆæ¯çš„è®¤è¯ç ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸èƒ½åè½¬ï¼Œæ„å‘³ç€ä»è¾“å‡ºçš„è®¤è¯ç ä¸èƒ½å†å¾—åˆ°åŸå§‹æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">signature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™å°†è¾“å‡ºä¸€ä¸ªåå…­è¿›åˆ¶çš„å­—ç¬¦ä¸²</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…ç”¨ä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…ç”¨ä¾‹"><span>å®é™…ç”¨ä¾‹</span></a></h3><p>ç°åœ¨è®©æˆ‘ä»¬çœ‹å‡ ä¸ªå®é™…åº”ç”¨çš„ä¾‹å­ã€‚</p><h4 id="ä¾‹å­-1-ç­¾åå’ŒéªŒè¯æ•°æ®" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-ç­¾åå’ŒéªŒè¯æ•°æ®"><span>ä¾‹å­ 1: ç­¾åå’ŒéªŒè¯æ•°æ®</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web æœåŠ¡ï¼Œå®¢æˆ·ç«¯å‘é€è¯·æ±‚æ—¶éœ€è¦éªŒè¯èº«ä»½ã€‚ä½ å¯ä»¥ä¸ºæ¯ä¸ªç”¨æˆ·ç”Ÿæˆä¸€ä¸ªå¯†é’¥ï¼Œå¹¶ä½¿ç”¨è¿™ä¸ªå¯†é’¥å¯¹è¯·æ±‚è¿›è¡Œ Hmac ç­¾åã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®¢æˆ·ç«¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> message</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;ç”¨æˆ·çš„æŸäº›æ•°æ®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secretKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;ç”¨æˆ·ç‹¬æœ‰çš„å¯†é’¥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†signatureéšè¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æœåŠ¡å™¨</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚å’Œç­¾ååï¼Œä½¿ç”¨ç›¸åŒçš„å¯†é’¥å’Œå“ˆå¸Œç®—æ³•éªŒè¯ç­¾åæ˜¯å¦åŒ¹é…</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> receivedMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;ç”¨æˆ·çš„æŸäº›æ•°æ®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»è¯·æ±‚ä¸­è·å¾—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> receivedSignature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;æ¥è‡ªå®¢æˆ·ç«¯çš„ç­¾å&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»è¯·æ±‚ä¸­è·å¾—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hmacForVerification</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hmacForVerification</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">receivedMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> verificationSignature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hmacForVerification</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">verificationSignature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> receivedSignature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;éªŒè¯æˆåŠŸï¼Œæ¶ˆæ¯æ˜¯çœŸå®çš„ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;éªŒè¯å¤±è´¥ï¼Œæ¶ˆæ¯å¯èƒ½è¢«ç¯¡æ”¹ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä¾‹å­-2-æ–‡ä»¶æ ¡éªŒ" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-æ–‡ä»¶æ ¡éªŒ"><span>ä¾‹å­ 2: æ–‡ä»¶æ ¡éªŒ</span></a></h4><p>å¦‚æœä½ æœ‰ä¸€ä¸ªæ–‡ä»¶ä¸‹è½½æœåŠ¡ï¼Œä½ å¯ä»¥ä¸ºæ¯ä¸ªæ–‡ä»¶åˆ›å»ºä¸€ä¸ª Hmacï¼Œå¹¶å°†è¿™ä¸ª Hmac ä¸æ–‡ä»¶ä¸€èµ·æä¾›ç»™ç”¨æˆ·ã€‚ç”¨æˆ·åœ¨ä¸‹è½½æ–‡ä»¶åï¼Œå¯ä»¥ä½¿ç”¨ç›¸åŒçš„å¯†é’¥å’Œæ–¹æ³•æ¥éªŒè¯æ–‡ä»¶æ˜¯å¦å®Œæ•´æœªç»ç¯¡æ”¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å½“æ–‡ä»¶è¢«åˆ›å»ºæˆ–æ›´æ–°æ—¶è®¡ç®—Hmac</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fileBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path-to-file&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secretKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;æ–‡ä»¶çš„å¯†é’¥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fileBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fileSignature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å­˜å‚¨fileSignatureä¾›ä»¥åéªŒè¯ä½¿ç”¨</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”¨æˆ·ä¸‹è½½æ–‡ä»¶ä¹‹åè¿›è¡ŒéªŒè¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> downloadedFileBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path-to-downloaded-file&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hmacForVerification</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hmacForVerification</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">downloadedFileBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> downloadedFileSignature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hmacForVerification</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">downloadedFileSignature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> fileSignature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ–‡ä»¶éªŒè¯æˆåŠŸï¼Œæ–‡ä»¶æ˜¯å®Œæ•´çš„ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ–‡ä»¶éªŒè¯å¤±è´¥ï¼Œæ–‡ä»¶å¯èƒ½è¢«ç¯¡æ”¹ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹å‡ºä½¿ç”¨ Node.js çš„<code>Hmac</code>ç±»å¯ä»¥å¾ˆå®¹æ˜“åœ°ç”Ÿæˆå’ŒéªŒè¯æ¶ˆæ¯çš„è®¤è¯ç ï¼Œæ¥ç¡®ä¿æ•°æ®çš„å®‰å…¨æ€§ã€‚</p><h3 id="hmac-digest-encoding" tabindex="-1"><a class="header-anchor" href="#hmac-digest-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#hmacdigestencoding" target="_blank" rel="noopener noreferrer">hmac.digest([encoding])</a></span></a></h3><p><code>hmac.digest([encoding])</code> æ˜¯ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨äºç”Ÿæˆæ¶ˆæ¯è®¤è¯ç ï¼ˆHMACï¼‰ã€‚HMAC é€šå¸¸ç”¨äºç¡®ä¿ä¸€æ®µæ•°æ®çš„å®Œæ•´æ€§å’ŒçœŸå®æ€§ã€‚åœ¨ Node.js ä¸­ï¼Œä½¿ç”¨ <code>hmac.digest()</code> æ–¹æ³•å¯ä»¥åœ¨åˆ›å»º HMAC åè·å–å…¶å€¼ã€‚</p><p>ä¸ºäº†æ›´æ˜“äºç†è§£ï¼Œæˆ‘ä»¬å°†åˆ†æ­¥éª¤ä»‹ç»å¦‚ä½•ä½¿ç”¨ <code>hmac.digest()</code> æ–¹æ³•ï¼Œå¹¶ç”¨å®é™…ä¾‹å­æ¥è¯´æ˜ã€‚</p><h3 id="æ­¥éª¤ä¸€-å¯¼å…¥-crypto-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤ä¸€-å¯¼å…¥-crypto-æ¨¡å—"><span>æ­¥éª¤ä¸€ï¼šå¯¼å…¥ crypto æ¨¡å—</span></a></h3><p>æˆ‘ä»¬é¦–å…ˆéœ€è¦å¯¼å…¥ Node.js å†…ç½®çš„ <code>crypto</code> æ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—æä¾›åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬åˆ›å»º HMACã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="æ­¥éª¤äºŒ-åˆ›å»º-hmac-å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤äºŒ-åˆ›å»º-hmac-å®ä¾‹"><span>æ­¥éª¤äºŒï¼šåˆ›å»º HMAC å®ä¾‹</span></a></h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª HMAC å®ä¾‹ã€‚åœ¨åˆ›å»ºè¿‡ç¨‹ä¸­ï¼Œä½ éœ€è¦æŒ‡å®šä¸¤æ ·ä¸œè¥¿ï¼š</p><ol><li>ç”¨äº HMAC çš„ç®—æ³•ï¼Œä¾‹å¦‚ <code>&#39;sha256&#39;</code>ã€‚</li><li>ä¸€ä¸ªå¯†é’¥ï¼ˆsecret keyï¼‰ï¼Œç”¨äºå’Œä½ çš„æ•°æ®ä¸€èµ·è¿›è¡ŒåŠ å¯†ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secret</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;mySecretKey&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­¥éª¤ä¸‰-æ›´æ–°æ•°æ®" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤ä¸‰-æ›´æ–°æ•°æ®"><span>æ­¥éª¤ä¸‰ï¼šæ›´æ–°æ•°æ®</span></a></h3><p>ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ª HMAC å®ä¾‹ï¼Œå¯ä»¥ç”¨å¾…éªŒè¯çš„æ•°æ®æ¥æ›´æ–°å®ƒã€‚å‡è®¾æˆ‘ä»¬è¦éªŒè¯çš„æ•°æ®æ˜¯å­—ç¬¦ä¸² <code>&#39;some data to hash&#39;</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;some data to hash&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="æ­¥éª¤å››-è·å–æ‘˜è¦" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤å››-è·å–æ‘˜è¦"><span>æ­¥éª¤å››ï¼šè·å–æ‘˜è¦</span></a></h3><p>æœ€åï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨ <code>hmac.digest()</code> æ–¹æ³•æ¥å¾—åˆ°æ•°æ®çš„ HMAC å€¼ã€‚è¿™é‡Œå¯ä»¥é€‰æ‹©ä¼ å…¥ä¸€ä¸ªç¼–ç æ ¼å¼å‚æ•°æ¥æŒ‡å®šè¾“å‡ºæ ¼å¼ï¼Œå¦‚ <code>&#39;hex&#39;</code>ã€<code>&#39;base64&#39;</code> ç­‰ï¼Œå¦‚æœä¸ä¼ ï¼Œåˆ™è¿”å›ä¸€ä¸ª Buffer å¯¹è±¡ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–åå…­è¿›åˆ¶æ ¼å¼çš„æ‘˜è¦</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º HMAC å€¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä¸¾ä¸ªä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä¸¾ä¸ªä¾‹å­"><span>ä¸¾ä¸ªä¾‹å­ï¼š</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨æ„å»ºä¸€ä¸ªç½‘ç«™ï¼Œç”¨æˆ·æäº¤äº†è¡¨å•ï¼Œå¹¶ä¸”ä½ éœ€è¦ç¡®ä¿è¿™äº›æ•°æ®åœ¨å‘é€åˆ°æœåŠ¡å™¨æ—¶æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚ä¸ºæ­¤ï¼Œä½ å¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸Šä½¿ç”¨ä½ çš„ç§˜é’¥å¯¹è¿™äº›æ•°æ®ç”Ÿæˆä¸€ä¸ª HMAC å€¼ï¼Œå¹¶éšè¡¨å•ä¸€èµ·å‘é€ã€‚å½“æœåŠ¡å™¨æ”¶åˆ°è¡¨å•æ•°æ®æ—¶ï¼Œå®ƒä¼šä½¿ç”¨ç›¸åŒçš„ç§˜é’¥å†æ¬¡ç”Ÿæˆ HMAC å€¼ï¼Œå¹¶ä¸”ä¸ä»ç”¨æˆ·é‚£é‡Œæ”¶åˆ°çš„ HMAC å€¼è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼Œåˆ™æ„å‘³ç€æ•°æ®æ˜¯å®Œæ•´ä¸”æœªè¢«ç¯¡æ”¹çš„ã€‚</p><p>ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨ Node.js æ¥åšè¿™ä¸ª HMAC çš„ç¤ºä¾‹ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾å®šå¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secret</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;mySecretKey&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// éœ€è¦åŠ å¯†çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> message</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;some data to hash&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºHMACå®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ›´æ–°HMACå®ä¾‹æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–åå…­è¿›åˆ¶æ ¼å¼çš„æ‘˜è¦</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`HMAC value: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hash</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ä½ è¿è¡Œè¿™æ®µä»£ç æ—¶ï¼Œå®ƒä¼šè¾“å‡ºä¸€ä¸ªç”±æŒ‡å®šæ•°æ®å’Œå¯†é’¥ç”Ÿæˆçš„ HMAC å€¼ã€‚æ¯æ¬¡ç”¨ç›¸åŒçš„å¯†é’¥å’Œæ•°æ®è¿è¡Œè¿™æ®µä»£ç ï¼Œéƒ½åº”è¯¥å¾—åˆ°ç›¸åŒçš„ HMAC å€¼ã€‚</p><h3 id="hmac-update-data-inputencoding" tabindex="-1"><a class="header-anchor" href="#hmac-update-data-inputencoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#hmacupdatedata-inputencoding" target="_blank" rel="noopener noreferrer">hmac.update(data[, inputEncoding])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­ <code>hmac.update(data[, inputEncoding])</code> è¿™ä¸ªæ–¹æ³•ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä»€ä¹ˆæ˜¯ HMACã€‚HMAC æ„ä¸ºâ€œå¯†é’¥ç›¸å…³çš„å“ˆå¸Œè¿ç®—æ¶ˆæ¯è®¤è¯ç â€(Hash-based Message Authentication Code)ï¼Œå®ƒæ˜¯ä¸€ç§åˆ©ç”¨åŠ å¯†å“ˆå¸Œå‡½æ•°ï¼ˆå¦‚ SHA256, MD5 ç­‰ï¼‰ï¼Œç»“åˆä¸€ä¸ªå¯†é’¥è¿›è¡Œæ•°æ®è®¤è¯çš„æŠ€æœ¯ã€‚åœ¨ç½‘ç»œé€šä¿¡ä¸­ï¼ŒHMAC å¯ä»¥æ£€æŸ¥æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ˜¯å¦è¢«ç¯¡æ”¹ã€‚</p><p>ç°åœ¨ï¼Œè¯´åˆ° <code>hmac.update()</code> æ–¹æ³•ï¼Œåœ¨ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸­ï¼Œè¿™ä¸ªæ–¹æ³•ä¸»è¦ç”¨äºæ›´æ–°æ–°çš„æ•°æ®åˆ°å·²ç»åˆ›å»ºçš„ HMAC å¯¹è±¡ã€‚ç®€å•æ¥è¯´ï¼Œå½“ä½ æƒ³è¦è®¡ç®—ä¸€æ®µæ•°æ®çš„ HMAC æ—¶ï¼Œä½ ä¼šå…ˆåˆ›å»ºä¸€ä¸ª HMAC å¯¹è±¡ï¼Œç„¶åé€šè¿‡ <code>update</code> æ–¹æ³•é€æ­¥æ·»åŠ æ•°æ®ï¼Œæœ€åå†è°ƒç”¨ <code>digest</code> æ–¹æ³•è¾“å‡ºæœ€ç»ˆçš„ HMAC å€¼ã€‚</p><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>data</code>: è¿™æ˜¯ä½ æ‰“ç®—æ·»åŠ åˆ° HMAC è®¡ç®—ä¸­çš„æ•°æ®ã€‚</li><li><code>inputEncoding</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå¯ä»¥æŒ‡å®š <code>data</code> çš„ç¼–ç ç±»å‹ï¼Œä¾‹å¦‚ &#39;utf8&#39;, &#39;ascii&#39;, &#39;latin1&#39; ç­‰ã€‚å¦‚æœ <code>data</code> æ˜¯ä¸€ä¸ª Bufferï¼ŒTypedArray æˆ–è€… DataViewï¼Œåˆ™å¯ä»¥çœç•¥è¿™ä¸ªå‚æ•°ã€‚</li></ul><p>æ¥ä¸‹æ¥ä¸¾å‡ ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><h3 id="ç¤ºä¾‹-1-ä½¿ç”¨-hmac-éªŒè¯æ•°æ®å®Œæ•´æ€§" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ä½¿ç”¨-hmac-éªŒè¯æ•°æ®å®Œæ•´æ€§"><span>ç¤ºä¾‹ 1ï¼šä½¿ç”¨ HMAC éªŒè¯æ•°æ®å®Œæ•´æ€§</span></a></h3><p>å‡è®¾ä½ åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œéœ€è¦ç¡®ä¿å‘é€ç»™ç”¨æˆ·çš„æŸäº›æ•°æ®æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚ä½ å¯ä»¥ç”¨ HMAC æ¥éªŒè¯æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª secret å¯†é’¥ï¼Œç”¨äºåŠ å¯† HMAC</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secret</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;your-secret-key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª HMAC å®ä¾‹ï¼Œä½¿ç”¨ sha256 å“ˆå¸Œç®—æ³•å’Œå¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ·»åŠ æ•°æ®åˆ° HMAC å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, world!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º HMAC å€¼ï¼ˆæ³¨æ„ï¼Œdigest è°ƒç”¨åHmacå¯¹è±¡ä¸èƒ½å†ç”¨updateæ·»åŠ æ•°æ®ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">signature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™å°†è¾“å‡ºä¸€ä¸ªå“ˆå¸Œå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ &quot;c1a5298f939e87e8f962a5edfc206918&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç¤ºä¾‹-2-è¿ç»­ä½¿ç”¨-update-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-è¿ç»­ä½¿ç”¨-update-æ–¹æ³•"><span>ç¤ºä¾‹ 2ï¼šè¿ç»­ä½¿ç”¨ update æ–¹æ³•</span></a></h3><p>å¦‚æœä½ æœ‰å¤šä¸ªæ•°æ®ç‰‡æ®µéœ€è¦æ·»åŠ åˆ° HMAC ä¸­ï¼Œå¯ä»¥è¿ç»­è°ƒç”¨ <code>update</code> æ–¹æ³•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆå§‹åŒ– HMAC å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;another-secret-key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ†åˆ«æ›´æ–°æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Part one of the message &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Part two of the message &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Part three of the message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–æœ€ç»ˆçš„ HMAC ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">signature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºæœ€ç»ˆçš„ HMAC å“ˆå¸Œå€¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸¤ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ª HMACï¼Œæ·»åŠ æ•°æ®ï¼Œæœ€åè¾“å‡ºè®¤è¯ç ã€‚è¿™åœ¨ç½‘ç»œåè®®ã€å®‰å…¨ä¼ è¾“å’Œæ•°æ®æ ¡éªŒç­‰æ–¹é¢éƒ½éå¸¸æœ‰ç”¨ã€‚è®°ä½ï¼Œåˆ›å»ºçš„ HMAC å¯¹è±¡åœ¨è°ƒç”¨ <code>digest</code> æ–¹æ³•åå°±ä¸èƒ½å†ç”¨ <code>update</code> æ–¹æ³•æ·»åŠ æ•°æ®äº†ï¼Œå› ä¸ºé‚£æ—¶å€™ HMAC è®¡ç®—å·²ç»å®Œæˆã€‚</p><h2 id="class-keyobject" tabindex="-1"><a class="header-anchor" href="#class-keyobject"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#class-keyobject" target="_blank" rel="noopener noreferrer">Class: KeyObject</a></span></a></h2><p>Node.js ä¸­çš„<code>KeyObject</code>ç±»æ˜¯ä¸€ä¸ªå°è£…äº†å¯†é’¥ææ–™çš„æŠ½è±¡ï¼Œå®ƒæ˜¯<code>crypto</code>æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºåŠ å¯†æ“ä½œã€‚è¿™ä¸ªç±»ä¸æ˜¯ç”¨æˆ·ç›´æ¥ä½¿ç”¨çš„ï¼Œè€Œæ˜¯é€šè¿‡<code>crypto</code>æ¨¡å—çš„ç‰¹å®šå‡½æ•°æ¥åˆ›å»ºå’Œç®¡ç†ã€‚ç®€å•åœ°è¯´ï¼Œ<code>KeyObject</code>æä¾›äº†ä¸€ä¸ªé€šç”¨çš„æ–¹å¼æ¥å¤„ç†ä¸åŒç±»å‹çš„å¯†é’¥ï¼ˆä¾‹å¦‚å…¬é’¥ã€ç§é’¥æˆ–å¯¹ç§°å¯†é’¥ï¼‰ã€‚</p><p>åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œ<code>KeyObject</code>ç±»æœ‰å¦‚ä¸‹å‡ ä¸ªé‡è¦æ–¹é¢ï¼š</p><ol><li><p><strong>å®ä¾‹åŒ–</strong>ï¼šä½ ä¸èƒ½ç›´æ¥ä½¿ç”¨<code>new KeyObject()</code>æ¥åˆ›å»ºä¸€ä¸ªå¯¹è±¡ã€‚ç›¸åï¼Œä½ ä¼šä½¿ç”¨<code>crypto.createSecretKey</code>ã€<code>crypto.createPublicKey</code>æˆ–è€…<code>crypto.createPrivateKey</code>å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ª<code>KeyObject</code>ã€‚</p></li><li><p><strong>ç±»å‹</strong>ï¼šæ¯ä¸ª<code>KeyObject</code>éƒ½æœ‰ä¸€ä¸ªç±»å‹ï¼Œå¯ä»¥æ˜¯<code>&#39;secret&#39;</code>ï¼ˆå¯¹ç§°å¯†é’¥ï¼‰ï¼Œ<code>&#39;public&#39;</code>ï¼ˆå…¬é’¥ï¼‰æˆ–<code>&#39;private&#39;</code>ï¼ˆç§é’¥ï¼‰ã€‚</p></li><li><p><strong>å¯¼å‡ºå¯†é’¥</strong>ï¼šä¸€ä¸ª<code>KeyObject</code>å¯ä»¥è¢«å¯¼å‡ºæˆä¸åŒæ ¼å¼ï¼Œè¿™æ ·å°±å¯ä»¥å°†å…¶å­˜å‚¨èµ·æ¥æˆ–åœ¨ä¸åŒçš„åº”ç”¨é—´ä¼ è¾“ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å°†ä¸€ä¸ªå¯†é’¥å¯¼å‡ºä¸º PEM æˆ– DER æ ¼å¼ã€‚</p></li></ol><p>ä¸¾å‡ ä¸ªå®é™…è¿ç”¨<code>KeyObject</code>çš„ä¾‹å­ï¼š</p><h3 id="ä¾‹å­-1-åˆ›å»ºå¹¶å¯¼å‡ºä¸€ä¸ªå¯¹ç§°å¯†é’¥" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-åˆ›å»ºå¹¶å¯¼å‡ºä¸€ä¸ªå¯¹ç§°å¯†é’¥"><span>ä¾‹å­ 1: åˆ›å»ºå¹¶å¯¼å‡ºä¸€ä¸ªå¯¹ç§°å¯†é’¥</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªéšæœºçš„å¯†é’¥ï¼ˆå¯¹ç§°å¯†é’¥ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secretKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> keyObject</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createSecretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯¼å‡ºè¿™ä¸ªå¯†é’¥ä¸ºBuffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> exportedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> keyObject</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exportedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// `&lt;`Buffer ...&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ª 32 å­—èŠ‚é•¿çš„éšæœºå¯†é’¥ï¼Œç„¶åç”¨è¿™ä¸ªå¯†é’¥åˆ›å»ºäº†ä¸€ä¸ª<code>KeyObject</code>ã€‚ä¹‹åæˆ‘ä»¬å¯¼å‡ºäº†è¿™ä¸ª<code>KeyObject</code>ï¼Œå¾—åˆ°äº†ä¸€ä¸ªå¯ä»¥ç”¨äºå­˜å‚¨æˆ–ä¼ è¾“çš„<code>Buffer</code>ã€‚</p><h3 id="ä¾‹å­-2-åˆ›å»ºå…¬é’¥å’Œç§é’¥å¯¹" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-åˆ›å»ºå…¬é’¥å’Œç§é’¥å¯¹"><span>ä¾‹å­ 2: åˆ›å»ºå…¬é’¥å’Œç§é’¥å¯¹</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªRSAå¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// RSAå¯†é’¥çš„ä½æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// publicKeyå’ŒprivateKeyç°åœ¨éƒ½æ˜¯KeyObjectå®ä¾‹</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†å…¬é’¥å¯¼å‡ºä¸ºPEMæ ¼å¼å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> pemPublic</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pkcs1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pemPublic</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†ç§é’¥å¯¼å‡ºä¸ºPEMæ ¼å¼å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> pemPrivate</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pkcs1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pemPrivate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ª RSA å¯†é’¥å¯¹ï¼Œå¹¶ä¸”åˆ†åˆ«å¾—åˆ°äº†å…¬é’¥å’Œç§é’¥çš„<code>KeyObject</code>ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†è¿™äº›å¯†é’¥å¯¼å‡ºä¸º PEM æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œè¿™ç§æ ¼å¼å¸¸ç”¨äºå­˜å‚¨å’Œäº¤æ¢å¯†é’¥ã€‚</p><p>è¿™äº›ä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Node.js çš„<code>crypto</code>æ¨¡å—åˆ›å»ºå’Œç®¡ç†å¯†é’¥ï¼Œä»¥åŠå¦‚ä½•å°†å¯†é’¥è½¬æ¢ä¸ºå¯å­˜å‚¨å’Œä¼ è¾“çš„æ ¼å¼ã€‚ç†è§£<code>KeyObject</code>çš„å·¥ä½œæ–¹å¼æ˜¯è¿›è¡ŒåŠ å¯†ç¼–ç¨‹æ—¶éå¸¸é‡è¦çš„ï¼Œå› ä¸ºå®ƒæ¶‰åŠåˆ°å¯†é’¥çš„å®‰å…¨ç®¡ç†ã€‚</p><h3 id="static-method-keyobject-from-key" tabindex="-1"><a class="header-anchor" href="#static-method-keyobject-from-key"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#static-method-keyobjectfromkey" target="_blank" rel="noopener noreferrer">Static method: KeyObject.from(key)</a></span></a></h3><p><code>KeyObject.from(key)</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—çš„ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå®ƒç”¨äºåˆ›å»ºä¸€ä¸ª <code>KeyObject</code> å®ä¾‹ã€‚<code>KeyObject</code> æ˜¯è¡¨ç¤ºå¯†é’¥çš„å¯¹è±¡ï¼Œä¾‹å¦‚å¯ä»¥æ˜¯å…¬é’¥ã€ç§é’¥æˆ–å¯¹ç§°å¯†é’¥ã€‚è¿™ä¸ªæ–¹æ³•è®©ä½ èƒ½å¤Ÿä»ä¸åŒç±»å‹çš„å¯†é’¥è¡¨ç¤ºï¼ˆå¦‚å­—ç¬¦ä¸²ã€Bufferã€ç°æœ‰çš„ <code>KeyObject</code> ç­‰ï¼‰åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>KeyObject</code> å®ä¾‹ã€‚</p><p>ä½¿ç”¨ <code>KeyObject.from(key)</code> æ–¹æ³•çš„åœºæ™¯é€šå¸¸åŒ…æ‹¬åŠ å¯†ã€è§£å¯†ã€ç­¾åå’ŒéªŒè¯æ•°æ®ç­‰æ“ä½œï¼Œåœ¨è¿™äº›æ“ä½œä¸­ä½ éœ€è¦ç”¨åˆ°å¯†é’¥ã€‚</p><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><code>key</code>ï¼šå¯ä»¥æ˜¯å¤šç§ç±»å‹ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²ã€Bufferã€TypedArrayã€DataViewã€<code>KeyObject</code> æˆ–è€… JSON å¯¹è±¡ï¼Œä»£è¡¨äº†è¦è½¬æ¢æˆ <code>KeyObject</code> çš„å¯†é’¥ã€‚</li></ul><p><strong>å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</strong></p><p>å‡è®¾ä½ æƒ³ä½¿ç”¨ Node.js åˆ›å»ºä¸€ä¸ªç®€å•çš„åŠ å¯†å’Œè§£å¯†ç¨‹åºï¼š</p><ol><li>é¦–å…ˆï¼Œä½ ä¼šç”Ÿæˆä¸€å¯¹å…¬é’¥å’Œç§é’¥ã€‚</li><li>ä½¿ç”¨å…¬é’¥åŠ å¯†ä¸€æ®µä¿¡æ¯ã€‚</li><li>ä½¿ç”¨ç§é’¥æ¥è§£å¯†ä¿¡æ¯ã€‚</li></ol><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä»£ç ç‰‡æ®µæ¼”ç¤ºï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬å·²ç»æœ‰ä¸€ä¸ªå…¬é’¥å’Œç§é’¥çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKeyString</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å…¬é’¥çš„å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> privateKeyString</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç§é’¥çš„å­—ç¬¦ä¸²</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ KeyObject.from() å°†å­—ç¬¦ä¸²è½¬æ¢ä¸º KeyObject</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">KeyObject</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKeyString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> privateKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">KeyObject</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKeyString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æƒ³è¦åŠ å¯†çš„æ•°æ®æ˜¯ä»¥ä¸‹è¿™æ®µæ–‡æœ¬</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dataToEncrypt</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Hello, this is a secret message!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨å…¬é’¥è¿›è¡ŒåŠ å¯†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encryptedData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">publicEncrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    padding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">RSA_PKCS1_OAEP_PADDING</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    oaepHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ•°æ®å¿…é¡»æ˜¯ Buffer ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">dataToEncrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Encrypted data:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">encryptedData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ç§é’¥è¿›è¡Œè§£å¯†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> decryptedData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">privateDecrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    padding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">RSA_PKCS1_OAEP_PADDING</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    oaepHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  encryptedData</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Decrypted data:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">decryptedData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>publicKeyString</code> å’Œ <code>privateKeyString</code> åº”è¯¥åŒ…å«æœ‰æ•ˆçš„å¯†é’¥å­—ç¬¦ä¸²ã€‚æˆ‘ä»¬é€šè¿‡ <code>crypto.KeyObject.from()</code> æ–¹æ³•å°†è¿™äº›å­—ç¬¦ä¸²è½¬æ¢ä¸º <code>KeyObject</code>ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨å…¬é’¥åŠ å¯†äº†ä¸€æ¡æ¶ˆæ¯ï¼Œå¹¶å­˜å‚¨äº†åŠ å¯†åçš„æ•°æ®ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨ç§é’¥æ¥è§£å¯†è¿™ä¸ªæ¶ˆæ¯ï¼Œæ¢å¤å‡ºåŸå§‹æ–‡æœ¬ã€‚</p><p>ä¸Šé¢çš„ä¾‹å­æ˜¯ä¸€ä¸ªéå¸¸ç®€åŒ–çš„è¯´æ˜ï¼Œå®é™…åº”ç”¨ä¸­å¯†é’¥çš„ç®¡ç†å’Œä½¿ç”¨ä¼šæ›´åŠ å¤æ‚å’Œä¸¥æ ¼ï¼Œæ¶‰åŠåˆ°é”™è¯¯å¤„ç†ã€å¯†é’¥çš„æŒä¹…åŒ–å­˜å‚¨ã€å®‰å…¨ä¼ è¾“ç­‰é—®é¢˜ã€‚</p><h3 id="keyobject-asymmetrickeydetails" tabindex="-1"><a class="header-anchor" href="#keyobject-asymmetrickeydetails"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#keyobjectasymmetrickeydetails" target="_blank" rel="noopener noreferrer">keyObject.asymmetricKeyDetails</a></span></a></h3><p><code>keyObject.asymmetricKeyDetails</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—çš„ä¸€ä¸ªå±æ€§ï¼Œç”¨äºè·å–éå¯¹ç§°å¯†é’¥ï¼ˆasymmetric keyï¼‰çš„è¯¦ç»†ä¿¡æ¯ã€‚éå¯¹ç§°å¯†é’¥æ˜¯ä¸€ç§å®‰å…¨æ€§è¾ƒé«˜çš„å¯†é’¥ï¼Œé€šå¸¸åŒ…å«å…¬é’¥å’Œç§é’¥ä¸¤éƒ¨åˆ†ã€‚åœ¨éå¯¹ç§°åŠ å¯†ä¸­ï¼Œä½¿ç”¨å…¬é’¥åŠ å¯†æ•°æ®ï¼Œè€Œä½¿ç”¨ç§é’¥è§£å¯†æ•°æ®ã€‚</p><p>åœ¨ Node.js v21.7.1 çš„ç‰ˆæœ¬ä¸­ï¼Œå½“ä½ åˆ›å»ºæˆ–å¯¼å…¥ä¸€ä¸ªéå¯¹ç§°å¯†é’¥æ—¶ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ª <code>KeyObject</code> å®ä¾‹ã€‚é€šè¿‡è°ƒç”¨è¿™ä¸ªå®ä¾‹ä¸Šçš„ <code>.asymmetricKeyDetails</code> å±æ€§ï¼Œä½ å¯ä»¥è·å¾—å…³äºè¯¥éå¯¹ç§°å¯†é’¥çš„ä¸€äº›å…·ä½“ä¿¡æ¯ï¼Œæ¯”å¦‚å®ƒçš„ç±»å‹ã€å¤§å°ï¼Œä»¥åŠå…¶ä»–ä¾èµ–äºå¯†é’¥ç±»å‹çš„å‚æ•°ã€‚</p><p>ä¸‹é¢ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨ <code>keyObject.asymmetricKeyDetails</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆä¸€ä¸ªéå¯¹ç§°å¯†é’¥å¯¹ï¼ˆRSAï¼‰ï¼ŒåŒ…æ‹¬å…¬é’¥å’Œç§é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeyPair</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯†é’¥å¤§å°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å¯†é’¥ç”Ÿæˆå¤±è´¥:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // ä½¿ç”¨ publicKey.asymmetricKeyDetails æ¥è·å–å…¬é’¥çš„è¯¦æƒ…</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å…¬é’¥è¯¦æƒ…:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">asymmetricKeyDetails</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // ä½¿ç”¨ privateKey.asymmetricKeyDetails æ¥è·å–ç§é’¥çš„è¯¦æƒ…</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç§é’¥è¯¦æƒ…:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">asymmetricKeyDetails</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† Node.js çš„ <code>crypto</code> æ¨¡å—ï¼Œç„¶åä½¿ç”¨ <code>generateKeyPair</code> å‡½æ•°æ¥ç”Ÿæˆä¸€ä¸ª RSA ç±»å‹çš„å¯†é’¥å¯¹ã€‚æˆ‘ä»¬æŒ‡å®šäº†æ¨¡æ•°é•¿åº¦ä¸º 2048 ä½ï¼Œè¿™æ˜¯å…¬é’¥å’Œç§é’¥çš„å¤§å°ã€‚ä¹‹åæˆ‘ä»¬åœ¨å›è°ƒå‡½æ•°ä¸­è®¿é—®å…¬é’¥å’Œç§é’¥çš„ <code>.asymmetricKeyDetails</code> å±æ€§æ¥æ‰“å°å®ƒä»¬çš„è¯¦ç»†ä¿¡æ¯ã€‚</p><p>è¾“å‡ºå¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>å…¬é’¥è¯¦æƒ…: { modulusLength: 2048, publicExponent: 65537 }</span></span>
<span class="line"><span>ç§é’¥è¯¦æƒ…: { modulusLength: 2048, publicExponent: 65537, primes: [Array], ... }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼Œç§é’¥å¯¹è±¡çš„ <code>asymmetricKeyDetails</code> ä¼šåŒ…å«æ›´å¤šçš„ä¿¡æ¯ï¼Œå› ä¸ºå®ƒéœ€è¦æ›´å¤šçš„å‚æ•°æ¥è¿›è¡Œè§£å¯†æ“ä½œã€‚åœ¨ä¸Šé¢çš„è¾“å‡ºä¸­ï¼Œ<code>primes</code> æ•°ç»„åŒ…å«äº† RSA å¯†é’¥çš„ç´ æ•°æˆåˆ†ï¼Œä½†ç”±äºé•¿åº¦è¿‡é•¿é€šå¸¸ä¼šè¢«çœç•¥æ˜¾ç¤ºã€‚</p><p>è¿™é¡¹åŠŸèƒ½é€šå¸¸ç”¨äºå¼€å‘è€…éœ€è¦æ£€æŸ¥ä»–ä»¬æ­£åœ¨ä½¿ç”¨çš„å¯†é’¥çš„å‚æ•°ï¼Œæˆ–è€…å½“ä»–ä»¬éœ€è¦æ ¹æ®å¯†é’¥çš„å¤§å°æˆ–å…¶ä»–å±æ€§æ¥è°ƒæ•´ä»–ä»¬çš„åŠ å¯†ç®—æ³•ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªéœ€è¦é«˜å®‰å…¨æ€§çš„åº”ç”¨ç¨‹åºä¸­ï¼Œå¼€å‘è€…å¯èƒ½æƒ³è¦ç¡®ä¿æ‰€æœ‰çš„å¯†é’¥éƒ½è‡³å°‘æ˜¯ 2048 ä½çš„ã€‚é€šè¿‡æ£€æŸ¥ <code>asymmetricKeyDetails</code> çš„ <code>modulusLength</code>ï¼Œä»–ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°éªŒè¯è¿™ä¸€ç‚¹ã€‚</p><h3 id="keyobject-asymmetrickeytype" tabindex="-1"><a class="header-anchor" href="#keyobject-asymmetrickeytype"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#keyobjectasymmetrickeytype" target="_blank" rel="noopener noreferrer">keyObject.asymmetricKeyType</a></span></a></h3><p><code>keyObject.asymmetricKeyType</code>æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒå±äº crypto æ¨¡å—ä¸‹çš„ KeyObject ç±»ã€‚åœ¨ Node.js ä¸­ï¼ŒKeyObject æ˜¯è¡¨ç¤ºå¯†é’¥çš„æŠ½è±¡ï¼Œç”¨äºå„ç§åŠ å¯†æ“ä½œï¼Œå¦‚ç­¾åã€éªŒè¯ç­¾åã€åŠ å¯†å’Œè§£å¯†ã€‚</p><p>å½“ä½ ä½¿ç”¨ Node.js ä¸­çš„ crypto æ¨¡å—åˆ›å»ºæˆ–å¯¼å…¥ä¸€ä¸ªéå¯¹ç§°å¯†é’¥æ—¶ï¼ˆéå¯¹ç§°å¯†é’¥æ˜¯ä¸€å¯¹å¯†é’¥ï¼Œé€šå¸¸åŒ…æ‹¬ä¸€ä¸ªå…¬é’¥å’Œä¸€ä¸ªç§é’¥ï¼‰ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ª KeyObject å®ä¾‹ã€‚è¿™ä¸ªå®ä¾‹çš„<code>asymmetricKeyType</code>å±æ€§å°±å‘Šè¯‰ä½ è¿™ä¸ªå¯†é’¥æ˜¯ä»€ä¹ˆç±»å‹çš„éå¯¹ç§°å¯†é’¥ã€‚</p><p>ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªå…³äº<code>asymmetricKeyType</code>å±æ€§çš„å®ç”¨ä¾‹å­ï¼š</p><h3 id="ç”Ÿæˆæ–°çš„å¯†é’¥å¯¹å¹¶æ£€æŸ¥å¯†é’¥ç±»å‹" tabindex="-1"><a class="header-anchor" href="#ç”Ÿæˆæ–°çš„å¯†é’¥å¯¹å¹¶æ£€æŸ¥å¯†é’¥ç±»å‹"><span>ç”Ÿæˆæ–°çš„å¯†é’¥å¯¹å¹¶æ£€æŸ¥å¯†é’¥ç±»å‹</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥cryptoæ¨¡å—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆä¸€ä¸ªRSAå¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeyPair</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯†é’¥é•¿åº¦</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ‰“å°å‡ºå…¬é’¥å’Œç§é’¥çš„ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">asymmetricKeyType</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åº”è¯¥è¾“å‡º&#39;rsa&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">asymmetricKeyType</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åº”è¯¥è¾“å‡º&#39;rsa&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>crypto.generateKeyPair</code>æ–¹æ³•ç”Ÿæˆäº†ä¸€ä¸ª RSA å¯†é’¥å¯¹ï¼Œå¹¶é€šè¿‡å›è°ƒå‡½æ•°è¿”å›äº†ç›¸åº”çš„å…¬é’¥å’Œç§é’¥ KeyObjectã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>publicKey.asymmetricKeyType</code>å’Œ<code>privateKey.asymmetricKeyType</code>æŸ¥çœ‹è¿™ä¸¤ä¸ªå¯†é’¥å¯¹è±¡çš„éå¯¹ç§°å¯†é’¥ç±»å‹ã€‚</p><h3 id="å¯¼å…¥å¯†é’¥å¹¶æ£€æŸ¥å…¶ç±»å‹" tabindex="-1"><a class="header-anchor" href="#å¯¼å…¥å¯†é’¥å¹¶æ£€æŸ¥å…¶ç±»å‹"><span>å¯¼å…¥å¯†é’¥å¹¶æ£€æŸ¥å…¶ç±»å‹</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥cryptoå’Œfsæ¨¡å—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå­˜æœ‰å…¬é’¥å†…å®¹çš„æ–‡ä»¶pubkey.pem</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKeyString</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pubkey.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»å­—ç¬¦ä¸²ä¸­å¯¼å…¥å…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKeyString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºå¯¼å…¥çš„å…¬é’¥çš„ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">asymmetricKeyType</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå¯èƒ½æ˜¯&#39;rsa&#39;, &#39;ec&#39;ç­‰ï¼Œå–å†³äºå…¬é’¥æœ¬èº«çš„ç±»å‹</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨ Node.js çš„æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼ˆfsï¼‰è¯»å–äº†ä¸€ä¸ªåŒ…å«å…¬é’¥çš„ PEM æ ¼å¼æ–‡ä»¶ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨<code>crypto.createPublicKey</code>æ–¹æ³•å°†è¿™ä¸ªå…¬é’¥å­—ç¬¦ä¸²è½¬æ¢ä¸º KeyObjectã€‚æœ€åï¼Œæˆ‘ä»¬é€šè¿‡<code>publicKey.asymmetricKeyType</code>æ£€æŸ¥äº†å¯¼å…¥çš„å…¬é’¥ç±»å‹ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>keyObject.asymmetricKeyType</code>æ˜¯ä¸€ä¸ªå¾ˆæ–¹ä¾¿çš„å±æ€§ï¼Œå®ƒèƒ½å¤Ÿè®©ä½ çŸ¥é“ä½ æ­£åœ¨å¤„ç†çš„éå¯¹ç§°å¯†é’¥æ˜¯ä»€ä¹ˆç±»å‹ï¼Œå¦‚ RSAã€ECï¼ˆæ¤­åœ†æ›²çº¿ï¼‰ã€ED25519 ç­‰ã€‚è¿™å¯¹äºç¼–å†™åŠ è§£å¯†ã€ç­¾åéªŒè¯ç­‰å®‰å…¨ç›¸å…³ä»£ç éå¸¸é‡è¦ï¼Œå› ä¸ºä¸åŒç±»å‹çš„å¯†é’¥éœ€è¦ä¸åŒçš„ç®—æ³•å’Œå‚æ•°ã€‚</p><h3 id="keyobject-export-options" tabindex="-1"><a class="header-anchor" href="#keyobject-export-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#keyobjectexportoptions" target="_blank" rel="noopener noreferrer">keyObject.export([options])</a></span></a></h3><p><code>keyObject.export([options])</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå…è®¸ä½ å°†å­˜å‚¨åœ¨ <code>KeyObject</code> å¯¹è±¡ä¸­çš„å¯†é’¥ï¼ˆæ— è®ºæ˜¯å…¬é’¥ã€ç§é’¥è¿˜æ˜¯å¯¹ç§°å¯†é’¥ï¼‰å¯¼å‡ºä¸ºå¯ç”¨çš„æ ¼å¼ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²æˆ–è€…äºŒè¿›åˆ¶æ•°æ®ã€‚è¿™ä¸ªæ–¹æ³•é€šå¸¸ç”¨äºéœ€è¦åœ¨ä¸åŒç³»ç»Ÿæˆ–åº”ç”¨ä¹‹é—´å…±äº«å¯†é’¥ã€ä¿å­˜å¯†é’¥åˆ°æ–‡ä»¶ç³»ç»Ÿæˆ–ä»å†…å­˜ä¸­ç§»é™¤å¯†é’¥æ—¶ã€‚</p><p>é¦–å…ˆ, æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ <code>KeyObject</code>ï¼š<br><code>KeyObject</code> æ˜¯ Node.js <code>crypto</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªå°è£…å¥½çš„å¯†é’¥å®¹å™¨ï¼Œç”¨äºä»£è¡¨åŠ å¯†å¯†é’¥ã€‚ä½ å¯ä»¥é€šè¿‡è¯¸å¦‚ <code>crypto.createSecretKey</code>ã€<code>crypto.createPublicKey</code> æˆ– <code>crypto.createPrivateKey</code> ç­‰æ–¹æ³•åˆ›å»ºä¸€ä¸ª <code>KeyObject</code>ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹ <code>keyObject.export([options])</code> æ–¹æ³•çš„ä½¿ç”¨ï¼š</p><h3 id="å‚æ•°-1" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-1"><span>å‚æ•°</span></a></h3><ul><li><code>options</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œç”¨äºæŒ‡å®šå¯¼å‡ºå¯†é’¥æ—¶çš„ä¸€äº›é€‰é¡¹ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥æŒ‡å®šè¾“å‡ºçš„æ ¼å¼ï¼ˆå¦‚ <code>pem</code> æˆ– <code>der</code>ï¼‰ï¼Œä»¥åŠåœ¨å¯¼å‡ºç§é’¥æ—¶æ˜¯å¦åŒ…å«å¯†é’¥çš„å…¬å¼€éƒ¨åˆ†ã€‚</li></ul><h3 id="è¿”å›å€¼-1" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-1"><span>è¿”å›å€¼</span></a></h3><ul><li><code>keyObject.export()</code> ä¼šè¿”å›å¯†é’¥çš„å†…å®¹ï¼Œç±»å‹å–å†³äºæŒ‡å®šçš„é€‰é¡¹ï¼Œé€šå¸¸æ˜¯å­—ç¬¦ä¸²æˆ–è€… Bufferï¼ˆäºŒè¿›åˆ¶æ•°æ®ï¼‰ã€‚</li></ul><h3 id="ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1"><span>ä¾‹å­</span></a></h3><h4 id="_1-å¯¼å‡ºå¯¹ç§°å¯†é’¥" tabindex="-1"><a class="header-anchor" href="#_1-å¯¼å‡ºå¯¹ç§°å¯†é’¥"><span>1. å¯¼å‡ºå¯¹ç§°å¯†é’¥</span></a></h4><p>å¦‚æœä½ åˆ›å»ºäº†ä¸€ä¸ªå¯¹ç§°å¯†é’¥ï¼Œæ¯”å¦‚ AES å¯†é’¥ï¼Œä½ å¯èƒ½æƒ³è¦å°†å®ƒä¿å­˜ä¸‹æ¥ä»¥ä¾¿ä¹‹åå†æ¬¡ä½¿ç”¨ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¯¹ç§°å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secretKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createSecretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;your-secret-key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯¼å‡ºå¯†é’¥ä¸º Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> exportedKeyBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exportedKeyBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå¯†é’¥çš„ Buffer è¡¨ç¤º</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœéœ€è¦ï¼Œä¹Ÿå¯ä»¥è½¬æ¢ä¸º base64 ç¼–ç å­—ç¬¦ä¸²ä¿å­˜</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> exportedKeyBase64</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> exportedKeyBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exportedKeyBase64</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º base64 æ ¼å¼çš„å¯†é’¥</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-å¯¼å‡ºå…¬é’¥" tabindex="-1"><a class="header-anchor" href="#_2-å¯¼å‡ºå…¬é’¥"><span>2. å¯¼å‡ºå…¬é’¥</span></a></h4><p>å¦‚æœä½ æœ‰ä¸€ä¸ªéå¯¹ç§°åŠ å¯†ç®—æ³•çš„å¯†é’¥å¯¹ï¼ˆæ¯”å¦‚ RSA æˆ– ECDSAï¼‰ï¼Œä½ å¯èƒ½æƒ³è¦å°†å…¬é’¥å¯¼å‡ºä»¥ä¾¿åˆ†äº«ç»™åˆ«äººè¿›è¡ŒåŠ å¯†ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŒæ­¥ç”Ÿæˆ RSA å¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯¼å‡ºå…¬é’¥ä¸º PEM æ ¼å¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> exportedPublicKeyPem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pkcs1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exportedPublicKeyPem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º PEM æ ¼å¼çš„å…¬é’¥</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-å¯¼å‡ºç§é’¥" tabindex="-1"><a class="header-anchor" href="#_3-å¯¼å‡ºç§é’¥"><span>3. å¯¼å‡ºç§é’¥</span></a></h4><p>ä½ å¯èƒ½éœ€è¦å°†ç§é’¥å¯¼å‡ºä¿å­˜åˆ°å®‰å…¨çš„åœ°æ–¹ï¼Œä»¥ä¾¿éœ€è¦æ—¶å¯ä»¥ä½¿ç”¨å®ƒæ¥è§£å¯†æ•°æ®æˆ–è€…ç­¾åä¿¡æ¯ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŒæ­¥ç”Ÿæˆ RSA å¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯¼å‡ºç§é’¥ä¸º PEM æ ¼å¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> exportedPrivateKeyPem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pkcs8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exportedPrivateKeyPem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º PEM æ ¼å¼çš„ç§é’¥</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ€»ä¹‹ï¼Œ<code>keyObject.export([options])</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä½ ç®¡ç†å’Œä¼ è¾“å¯†é’¥ã€‚è®°å¾—å¤„ç†å¯†é’¥æ—¶ä¸€å®šè¦æ³¨æ„ä¿æŠ¤å¥½å¯†é’¥çš„å®‰å…¨ï¼Œé¿å…æ³„éœ²ç»™æœªç»æˆæƒçš„äººå‘˜ã€‚</p><h3 id="keyobject-equals-otherkeyobject" tabindex="-1"><a class="header-anchor" href="#keyobject-equals-otherkeyobject"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#keyobjectequalsotherkeyobject" target="_blank" rel="noopener noreferrer">keyObject.equals(otherKeyObject)</a></span></a></h3><p><code>keyObject.equals(otherKeyObject)</code> æ˜¯ Node.js çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒç”¨äºæ£€æŸ¥ä¸¤ä¸ªå¯†é’¥å¯¹è±¡ï¼ˆ<code>keyObject</code>ï¼‰æ˜¯å¦åŒ…å«ç›¸åŒçš„å¯†é’¥ã€‚è¿™ä¸ªæ–¹æ³•å±äº Node.js ä¸­çš„ <code>crypto</code> æ¨¡å—ï¼Œè¯¥æ¨¡å—å¸¸è¢«ç”¨æ¥æ‰§è¡ŒåŠ å¯†æ“ä½œã€‚åœ¨è¿™ä¸ªä¸Šä¸‹æ–‡ä¸­çš„ &quot;Key&quot; é€šå¸¸æŒ‡çš„æ˜¯ç”¨äºåŠ å¯†æ•°æ®çš„å…¬é’¥æˆ–ç§é’¥ã€‚</p><p>ç®€å•åœ°è¯´ï¼Œå½“ä½ æœ‰ä¸¤ä¸ªå¯†é’¥å¯¹è±¡ï¼Œå¹¶ä¸”ä½ æƒ³ç¡®è®¤å®ƒä»¬æ˜¯å¦ä»£è¡¨åŒä¸€ä¸ªå¯†é’¥æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>equals</code> æ–¹æ³•ã€‚</p><p>ä¸‹é¢æ˜¯ <code>keyObject.equals(otherKeyObject)</code> çš„ä¸€äº›å…·ä½“çš„åº”ç”¨åœºæ™¯ï¼š</p><h3 id="åº”ç”¨åœºæ™¯-1-éªŒè¯ç­¾å" tabindex="-1"><a class="header-anchor" href="#åº”ç”¨åœºæ™¯-1-éªŒè¯ç­¾å"><span>åº”ç”¨åœºæ™¯ 1ï¼šéªŒè¯ç­¾å</span></a></h3><p>å‡è®¾ä½ åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦æ•°å­—ç­¾åè®¤è¯çš„åº”ç”¨ç¨‹åºã€‚ç”¨æˆ· A å‘é€äº†ä¸€ä¸ªç»è¿‡ç­¾åçš„æ¶ˆæ¯ä»¥ä¾¿éªŒè¯å…¶èº«ä»½ã€‚ç”¨æˆ· B æ¥æ”¶åˆ°æ¶ˆæ¯å’Œç­¾åï¼Œå¹¶ä¸”ä»–ä»¬æ‹¥æœ‰ç”¨æˆ· A çš„å…¬é’¥ã€‚ä¸ºäº†éªŒè¯ç­¾åç¡®å®æ¥è‡ªç”¨æˆ· Aï¼Œç”¨æˆ· B ä¼šç”¨åˆ°ç”¨æˆ· A çš„å…¬é’¥ã€‚å¦‚æœç”¨æˆ· B å­˜å‚¨äº†å¤šä¸ªå…¬é’¥å¯¹è±¡ï¼Œä»–ä»¬å¯èƒ½ä¼šç”¨ <code>equals</code> æ–¹æ³•æ¥æ‰¾åˆ°æ­£ç¡®çš„å…¬é’¥è¿›è¡ŒéªŒè¯ã€‚</p><h3 id="åº”ç”¨åœºæ™¯-2-å®‰å…¨é€šä¿¡" tabindex="-1"><a class="header-anchor" href="#åº”ç”¨åœºæ™¯-2-å®‰å…¨é€šä¿¡"><span>åº”ç”¨åœºæ™¯ 2ï¼šå®‰å…¨é€šä¿¡</span></a></h3><p>åœ¨å»ºç«‹å®‰å…¨é€šä¿¡æ—¶ï¼ˆæ¯”å¦‚ä½¿ç”¨ TLS/SSL åè®®ï¼‰ï¼ŒæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¼šäº¤æ¢å…¬é’¥æ¥å»ºç«‹åŠ å¯†è¿æ¥ã€‚æœåŠ¡å™¨å¯èƒ½ä¼šä¿å­˜å®¢æˆ·ç«¯ä¹‹å‰ä½¿ç”¨çš„å…¬é’¥ã€‚å½“å®¢æˆ·ç«¯å†æ¬¡å°è¯•è¿æ¥æ—¶ï¼ŒæœåŠ¡å™¨å¯ä»¥ä½¿ç”¨ <code>equals</code> æ–¹æ³•æ¥æ£€æŸ¥å½“å‰æä¾›çš„å…¬é’¥æ˜¯å¦ä¸ä¹‹å‰çš„å…¬é’¥ç›¸åŒï¼Œä½œä¸ºèº«ä»½ç¡®è®¤çš„ä¸€ç¯ã€‚</p><h3 id="åº”ç”¨åœºæ™¯-3-å¯†é’¥ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#åº”ç”¨åœºæ™¯-3-å¯†é’¥ç®¡ç†"><span>åº”ç”¨åœºæ™¯ 3ï¼šå¯†é’¥ç®¡ç†</span></a></h3><p>åœ¨ä¸€ä¸ªç³»ç»Ÿä¸­å¯èƒ½ä¼šå­˜å‚¨å¾ˆå¤šä¸åŒçš„å¯†é’¥ï¼Œç”¨äºä¸åŒçš„åŠ å¯†ä»»åŠ¡æˆ–å¯¹ä¸åŒç”¨æˆ·åŠ å¯†ã€‚è¿™æ—¶å€™ï¼Œç³»ç»Ÿç®¡ç†å‘˜å¯èƒ½éœ€è¦æ ¡éªŒæŸä¸ªæ–°çš„å¯†é’¥å¯¹è±¡æ˜¯å¦å·²ç»å­˜åœ¨äºå¯†é’¥åº“ä¸­ã€‚ä½¿ç”¨<code>equals</code> æ–¹æ³•ï¼Œç®¡ç†å‘˜èƒ½å¤Ÿç¡®å®šæ˜¯å¦æœ‰é‡å¤çš„å¯†é’¥ï¼Œä»è€Œé¿å…å†—ä½™å­˜å‚¨ã€‚</p><h3 id="node-js-ç¤ºä¾‹ä»£ç " tabindex="-1"><a class="header-anchor" href="#node-js-ç¤ºä¾‹ä»£ç "><span>Node.js ç¤ºä¾‹ä»£ç </span></a></h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å¯¼å…¥ Node.js çš„ <code>crypto</code> æ¨¡å—ï¼Œå¹¶ä¸”ç”Ÿæˆä¸¤ä¸ªå¯†é’¥å¯¹è±¡ã€‚ç„¶åæˆ‘ä»¬ä¼šç”¨ <code>equals</code> æ¥æ¯”è¾ƒå®ƒä»¬ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªåŸºæœ¬ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆä¸€ä¸ªå¯†é’¥å¯¹ï¼ˆå…¬é’¥å’Œç§é’¥ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆå¯†é’¥çš„ä½æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»º public key çš„å¦å¤–ä¸€ä¸ª KeyObject å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKeyObject</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ equals æ–¹æ³•æ¥æ£€æŸ¥ä¸¤ä¸ªå…¬é’¥æ˜¯å¦ç›¸åŒ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">publicKeyObject</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equals</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä¸¤ä¸ªå…¬é’¥å¯¹è±¡ç›¸åŒ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä¸¤ä¸ªå…¬é’¥å¯¹è±¡ä¸åŒ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šè¾“å‡º <code>ä¸¤ä¸ªå…¬é’¥å¯¹è±¡ç›¸åŒ</code>ï¼Œå› ä¸º <code>publicKeyObject</code> æ˜¯ä»åŒä¸€ä¸ªåŸå§‹å…¬é’¥åˆ›å»ºçš„ã€‚</p><p>è¯·æ³¨æ„ï¼Œ<code>generateKeyPairSync</code> æ–¹æ³•åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¸å»ºè®®åŒæ­¥ä½¿ç”¨ï¼Œå› ä¸ºå®ƒä¼šé˜»å¡äº‹ä»¶å¾ªç¯ï¼Œå½±å“æ€§èƒ½ã€‚åœ¨å®é™…åº”ç”¨ä¸­åº”è¯¥ä½¿ç”¨å…¶å¼‚æ­¥ç‰ˆæœ¬<code>generateKeyPair</code>ã€‚æˆ‘åœ¨è¿™é‡Œä½¿ç”¨åŒæ­¥ç‰ˆæœ¬æ˜¯ä¸ºäº†è®©ç¤ºä¾‹ä¿æŒç®€å•ç›´è§‚ã€‚</p><h3 id="keyobject-symmetrickeysize" tabindex="-1"><a class="header-anchor" href="#keyobject-symmetrickeysize"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#keyobjectsymmetrickeysize" target="_blank" rel="noopener noreferrer">keyObject.symmetricKeySize</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘ä»¬æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹ Node.js ä¸­çš„ <code>keyObject.symmetricKeySize</code>ã€‚</p><p>åœ¨ Node.js çš„åŠ å¯†æ¨¡å—ï¼ˆcryptoï¼‰ä¸­ï¼Œ<code>KeyObject</code> æ˜¯ä¸€ä¸ªä»£è¡¨å¯†é’¥çš„ç±»ã€‚è¿™ä¸ªç±»åŒ…æ‹¬äº†ä¸åŒç±»å‹çš„å¯†é’¥ï¼Œæ¯”å¦‚å¯¹ç§°å¯†é’¥ã€éå¯¹ç§°å¯†é’¥çš„å…¬é’¥å’Œç§é’¥ã€‚</p><p>å¯¹ç§°å¯†é’¥åŠ å¯†æ˜¯æŒ‡åŠ å¯†å’Œè§£å¯†éƒ½ä½¿ç”¨ç›¸åŒçš„å¯†é’¥çš„åŠ å¯†æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•ç®€å•ã€å¿«é€Ÿï¼Œå¹¶ä¸”é€‚ç”¨äºå¤§é‡æ•°æ®çš„åŠ å¯†ï¼Œå¸¸è§çš„å¯¹ç§°åŠ å¯†ç®—æ³•æœ‰ AESã€DESã€3DES ç­‰ã€‚</p><p><code>keyObject.symmetricKeySize</code> è¿™ä¸ªå±æ€§å°±æ˜¯ç”¨æ¥å¾—çŸ¥ä¸€ä¸ªå¯¹ç§°å¯†é’¥çš„å¤§å°ï¼Œä¹Ÿå°±æ˜¯å®ƒçš„é•¿åº¦ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™ä¸ªé•¿åº¦æ˜¯ä»¥å­—èŠ‚ï¼ˆbyteï¼‰ä¸ºå•ä½çš„ã€‚å¯†é’¥è¶Šé•¿ï¼Œç†è®ºä¸ŠåŠ å¯†å°±è¶Šå®‰å…¨ï¼Œä½†åŒæ—¶è®¡ç®—å¤æ‚åº¦ä¹Ÿä¼šéšä¹‹å¢åŠ ã€‚</p><h3 id="ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1"><span>ç¤ºä¾‹ï¼š</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ä½¿ç”¨ Node.js çš„ crypto æ¨¡å—åˆ›å»ºä¸€ä¸ª AES å¯†é’¥ç”¨äºåŠ å¯†æ•°æ®ï¼Œä½ å¯èƒ½ä¼šè¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªéšæœºçš„256ä½(32å­—èŠ‚)çš„AESå¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secretKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»è¯¥å¯†é’¥åˆ›å»ºä¸€ä¸ªå¯¹ç§° KeyObject</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> keyObject</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createSecretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ symmetricKeySize å±æ€§æ¥è·å–å¯†é’¥çš„å¤§å°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">keyObject</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">symmetricKeySize</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºåº”è¯¥ä¸º 32ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯256ä½çš„å¯†é’¥</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† Node.js çš„ <code>crypto</code> æ¨¡å—ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>crypto.randomBytes(32)</code> æ–¹æ³•ç”Ÿæˆäº†ä¸€ä¸ªéšæœºçš„ 256 ä½ï¼ˆ32 å­—èŠ‚ï¼‰çš„å¯†é’¥ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>crypto.createSecretKey(secretKey)</code> æ–¹æ³•å°†è¿™ä¸ªå¯†é’¥è½¬æ¢æˆä¸€ä¸ª <code>KeyObject</code>ã€‚æœ€åï¼Œæˆ‘ä»¬é€šè¿‡ <code>keyObject.symmetricKeySize</code> å¾—åˆ°äº†è¿™ä¸ªå¯¹ç§°å¯†é’¥çš„å¤§å°ï¼ˆé•¿åº¦ï¼‰ï¼Œåœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œè¾“å‡ºçš„å€¼åº”è¯¥æ˜¯ <code>32</code>ï¼Œå› ä¸º AES-256 åŠ å¯†ç®—æ³•ä½¿ç”¨çš„æ˜¯ 256 ä½ï¼ˆå³ 32 å­—èŠ‚ï¼‰çš„å¯†é’¥ã€‚</p><p>è¿™ä¸ªå±æ€§åœ¨ç¼–ç¨‹ä¸­ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºä½ å¯èƒ½éœ€è¦æ ¹æ®å¯†é’¥çš„é•¿åº¦æ¥åˆ¤æ–­æ˜¯å¦ç¬¦åˆä½ çš„å®‰å…¨è¦æ±‚æˆ–è€…æ˜¯å…¼å®¹æ€§è¦æ±‚ã€‚å¦‚æœä½ è¦ä¸å…¶ä»–ç³»ç»Ÿäº¤äº’ï¼ŒçŸ¥é“å¯†é’¥çš„å®é™…å¤§å°ä¹Ÿæ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºä¸åŒçš„ç³»ç»Ÿå¯èƒ½æœ‰ä¸åŒçš„å¯†é’¥é•¿åº¦é™åˆ¶ã€‚</p><h3 id="keyobject-type" tabindex="-1"><a class="header-anchor" href="#keyobject-type"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#keyobjecttype" target="_blank" rel="noopener noreferrer">keyObject.type</a></span></a></h3><p><code>keyObject.type</code> æ˜¯ Node.js å†…ç½®çš„ <code>crypto</code> æ¨¡å—ä¸­çš„å±æ€§ï¼Œå®ƒç”¨äºè¡¨ç¤ºä¸€ä¸ªå¯†é’¥å¯¹è±¡ï¼ˆ<code>KeyObject</code>ï¼‰çš„ç±»å‹ã€‚åœ¨ Node.js çš„åŠ å¯†æ¨¡å—ä¸­ï¼Œå¯†é’¥æ˜¯æ‰§è¡ŒåŠ è§£å¯†æ“ä½œçš„åŸºç¡€ã€‚ä¸€ä¸ªå¯†é’¥å¯¹è±¡é€šå¸¸ä»£è¡¨äº†ä¸€ä¸ªå…¬é’¥ã€ä¸€ä¸ªç§é’¥æˆ–è€…ä¸€ä¸ªå¯¹ç§°å¯†é’¥ã€‚<code>keyObject.type</code> å°±æ˜¯ç”¨æ¥åŒºåˆ†è¿™äº›ä¸åŒç§ç±»çš„å¯†é’¥ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>keyObject.type</code> å¯èƒ½æœ‰ä»¥ä¸‹å‡ ä¸ªå€¼ï¼š</p><ol><li><code>&#39;secret&#39;</code>: è¡¨ç¤ºè¯¥å¯†é’¥æ˜¯ä¸€ä¸ªå¯¹ç§°å¯†é’¥ï¼Œä¹Ÿå°±æ˜¯è¯´åŠ å¯†å’Œè§£å¯†ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªå¯†é’¥ã€‚</li><li><code>&#39;private&#39;</code>: è¡¨ç¤ºè¯¥å¯†é’¥æ˜¯ä¸€ä¸ªéå¯¹ç§°ç§é’¥ï¼Œç”¨äºéå¯¹ç§°åŠ å¯†ç®—æ³•ä¸­çš„è§£å¯†æ“ä½œæˆ–æ•°å­—ç­¾åçš„ç”Ÿæˆã€‚</li><li><code>&#39;public&#39;</code>: è¡¨ç¤ºå¯†é’¥æ˜¯ä¸€ä¸ªéå¯¹ç§°å…¬é’¥ï¼Œç”¨äºéå¯¹ç§°åŠ å¯†ç®—æ³•ä¸­çš„åŠ å¯†æ“ä½œæˆ–æ•°å­—ç­¾åçš„éªŒè¯ã€‚</li></ol><p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€äº›å®ä¾‹æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨ <code>keyObject.type</code>ã€‚</p><h3 id="ä¾‹å­-1-åˆ›å»ºä¸€ä¸ªå¯¹ç§°å¯†é’¥å¹¶æ£€æŸ¥å…¶ç±»å‹" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-åˆ›å»ºä¸€ä¸ªå¯¹ç§°å¯†é’¥å¹¶æ£€æŸ¥å…¶ç±»å‹"><span>ä¾‹å­ 1: åˆ›å»ºä¸€ä¸ªå¯¹ç§°å¯†é’¥å¹¶æ£€æŸ¥å…¶ç±»å‹</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¯¹ç§°å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secretKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createSecretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: &#39;secret&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† Node.js çš„ <code>crypto</code> æ¨¡å—ï¼Œç„¶åä½¿ç”¨ <code>createSecretKey</code> æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªå¯¹ç§°å¯†é’¥ï¼Œå¹¶ä½¿ç”¨éšæœºå­—èŠ‚åˆå§‹åŒ–ã€‚ä¹‹åï¼Œæˆ‘ä»¬è¾“å‡ºè¿™ä¸ªå¯†é’¥å¯¹è±¡çš„ <code>type</code> å±æ€§ï¼Œç»“æœä¸º <code>&#39;secret&#39;</code>ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªå¯¹ç§°å¯†é’¥ã€‚</p><h3 id="ä¾‹å­-2-ç”Ÿæˆä¸€ä¸ªéå¯¹ç§°å¯†é’¥å¯¹å¹¶æ£€æŸ¥å…¶ç±»å‹" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ç”Ÿæˆä¸€ä¸ªéå¯¹ç§°å¯†é’¥å¯¹å¹¶æ£€æŸ¥å…¶ç±»å‹"><span>ä¾‹å­ 2: ç”Ÿæˆä¸€ä¸ªéå¯¹ç§°å¯†é’¥å¯¹å¹¶æ£€æŸ¥å…¶ç±»å‹</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆéå¯¹ç§°å¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeyPair</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// RSA å¯†é’¥å¤§å°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: &#39;public&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: &#39;private&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç”¨ <code>generateKeyPair</code> æ–¹æ³•å¼‚æ­¥åœ°ç”Ÿæˆäº†ä¸€ä¸ª RSA éå¯¹ç§°å¯†é’¥å¯¹ï¼ŒåŒ…æ‹¬ä¸€ä¸ªå…¬é’¥å’Œä¸€ä¸ªç§é’¥ã€‚å½“å¯†é’¥å¯¹ç”Ÿæˆå®Œæˆåï¼Œæˆ‘ä»¬æ‰“å°å‡ºæ¯ä¸ªå¯†é’¥çš„ <code>type</code> å±æ€§ã€‚å…¬é’¥çš„ç±»å‹æ˜¯ <code>&#39;public&#39;</code>ï¼Œè€Œç§é’¥çš„ç±»å‹æ˜¯ <code>&#39;private&#39;</code>ã€‚</p><p>è¿™ä¸ªå±æ€§ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºåœ¨æ¶‰åŠåˆ°å¯†é’¥å¤„ç†æ—¶ï¼Œä½ å¯èƒ½éœ€è¦åˆ¤æ–­ä½ æ­£åœ¨æ“ä½œçš„æ˜¯å“ªç§ç±»å‹çš„å¯†é’¥ï¼Œä»¥ä¾¿æ­£ç¡®åœ°å®æ–½åŠ å¯†ã€è§£å¯†ã€ç­¾åæˆ–éªŒè¯ç­‰æ“ä½œã€‚åˆ©ç”¨ <code>keyObject.type</code> å¯ä»¥è½»æ¾åœ°åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><h2 id="class-sign" tabindex="-1"><a class="header-anchor" href="#class-sign"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#class-sign" target="_blank" rel="noopener noreferrer">Class: Sign</a></span></a></h2><p><code>Class: Sign</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—æä¾›çš„ä¸€ä¸ªç±»ï¼Œç”¨äºç”Ÿæˆæ•°å­—ç­¾åã€‚æ•°å­—ç­¾åæ˜¯ä¸€ç§å®‰å…¨çš„éªŒè¯ä¿¡æ¯çœŸå®æ€§å’Œå®Œæ•´æ€§çš„æ–¹å¼ï¼Œå®ƒå¯ä»¥ä¿è¯æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«ç¯¡æ”¹ï¼Œå¹¶ä¸”ç¡®è®¤æ•°æ®æ˜¯ç”±ç‰¹å®šçš„å‘é€è€…å‘é€çš„ã€‚</p><p>åœ¨ä½¿ç”¨ <code>Sign</code> ç±»æ—¶ï¼Œä½ ä¼šé€šè¿‡ä¸€ä¸ªåŠ å¯†ç®—æ³•ï¼ˆå¦‚ RSA, ECDSA ç­‰ï¼‰å¯¹æ•°æ®è¿›è¡Œç­¾åã€‚é¦–å…ˆï¼Œä½ éœ€è¦æœ‰ä¸€ä¸ªç§é’¥ï¼Œè¿™ä¸ªç§é’¥åªæœ‰æ•°æ®çš„å‘é€è€…çŸ¥é“ã€‚ä½¿ç”¨ç§é’¥ï¼Œå‘é€è€…å¯ä»¥åˆ›å»ºä¸€ä¸ªç‹¬ç‰¹çš„ç­¾åï¼Œè¿™ä¸ªç­¾åæ˜¯åŸºäºä»–ä»¬æƒ³è¦å‘é€çš„ç‰¹å®šæ•°æ®è®¡ç®—å¾—å‡ºçš„ã€‚</p><p>ä¸‹é¢æ˜¯å‡ ä¸ªå®é™…æ­¥éª¤å’Œä¾‹å­ï¼Œå±•ç¤ºå¦‚ä½•åœ¨ Node.js v21.7.1 ä¸­ä½¿ç”¨ <code>Sign</code> ç±»æ¥åˆ›å»ºæ•°å­—ç­¾åï¼š</p><h3 id="æ­¥éª¤-1-å¼•å…¥æ‰€éœ€æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-1-å¼•å…¥æ‰€éœ€æ¨¡å—"><span>æ­¥éª¤ 1ï¼šå¼•å…¥æ‰€éœ€æ¨¡å—</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">createSign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æˆ‘ä»¬å¼•å…¥äº† <code>crypto</code> æ¨¡å—çš„ <code>createSign</code> å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ç”¨æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Sign</code> å¯¹è±¡ã€‚</p><h3 id="æ­¥éª¤-2-åˆ›å»ºå¹¶åˆå§‹åŒ–-sign-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-2-åˆ›å»ºå¹¶åˆå§‹åŒ–-sign-å¯¹è±¡"><span>æ­¥éª¤ 2ï¼šåˆ›å»ºå¹¶åˆå§‹åŒ– Sign å¯¹è±¡</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> sign</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> createSign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;RSA-SHA256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™é‡Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª <code>Sign</code> å¯¹è±¡ï¼ŒæŒ‡å®šä½¿ç”¨ &#39;RSA-SHA256&#39; ç®—æ³•ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å°†ä½¿ç”¨ RSA åŠ å¯†æ–¹æ³•å’Œ SHA-256 å“ˆå¸Œå‡½æ•°æ¥ç”Ÿæˆç­¾åã€‚</p><h3 id="æ­¥éª¤-3-æ·»åŠ æ•°æ®åˆ°ç­¾åå¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-3-æ·»åŠ æ•°æ®åˆ°ç­¾åå¯¹è±¡"><span>æ­¥éª¤ 3ï¼šæ·»åŠ æ•°æ®åˆ°ç­¾åå¯¹è±¡</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¿™æ˜¯æˆ‘è¦ç­¾åçš„æ•°æ®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ä½¿ç”¨ <code>update</code> æ–¹æ³•ï¼Œæˆ‘ä»¬å°†è¦ç­¾åçš„æ•°æ®ï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯å­—ç¬¦ä¸² <code>&#39;è¿™æ˜¯æˆ‘è¦ç­¾åçš„æ•°æ®&#39;</code>ï¼‰æ·»åŠ åˆ° <code>Sign</code> å¯¹è±¡ä¸­ã€‚</p><h3 id="æ­¥éª¤-4-ç”Ÿæˆç­¾å" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-4-ç”Ÿæˆç­¾å"><span>æ­¥éª¤ 4ï¼šç”Ÿæˆç­¾å</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> privateKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œæ˜¯ä½ çš„ç§é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨ <code>sign</code> æ–¹æ³•ï¼Œå¹¶ä¼ å…¥ç§é’¥å’Œè¾“å‡ºæ ¼å¼ï¼ˆä¾‹å¦‚ &#39;hex&#39; è¡¨ç¤ºåå…­è¿›åˆ¶ç¼–ç ï¼‰ï¼Œæˆ‘ä»¬ç”Ÿæˆæœ€ç»ˆçš„ç­¾åã€‚ç§é’¥åº”å½“æ˜¯æˆ‘ä»¬ä¹‹å‰è¯´çš„ï¼Œåªæœ‰å‘é€è€…çŸ¥é“çš„å¯†é’¥ã€‚</p><p>ç°åœ¨ <code>signature</code> å˜é‡åŒ…å«äº†æ•°æ®çš„æ•°å­—ç­¾åï¼Œä½ å¯ä»¥å°†è¿™ä¸ªç­¾åè¿åŒåŸå§‹æ•°æ®ä¸€èµ·å‘é€ç»™æ¥æ”¶è€…ã€‚</p><h3 id="æ¥æ”¶æ–¹å¦‚ä½•éªŒè¯ç­¾å" tabindex="-1"><a class="header-anchor" href="#æ¥æ”¶æ–¹å¦‚ä½•éªŒè¯ç­¾å"><span>æ¥æ”¶æ–¹å¦‚ä½•éªŒè¯ç­¾å</span></a></h3><p>å‡è®¾æ¥æ”¶æ–¹å·²ç»æ”¶åˆ°äº†æ•°æ®å’Œç­¾åï¼Œä¸ºäº†éªŒè¯ç­¾åæ˜¯å¦æœ‰æ•ˆï¼Œæ¥æ”¶æ–¹éœ€è¦ï¼š</p><ol><li>ä½¿ç”¨ç›¸åŒçš„å“ˆå¸Œç®—æ³•å’Œå…¬é’¥ï¼ˆä¸ç§é’¥é…å¯¹çš„å…¬é’¥ï¼Œåº”è¯¥æ˜¯å…¬å¼€çš„ï¼‰ã€‚</li><li>ä½¿ç”¨ <code>crypto</code> æ¨¡å—ä¸­çš„ <code>createVerify</code> æ–¹æ³•æ¥æ ¡éªŒç­¾åã€‚</li></ol><p>å¦‚æœç­¾åéªŒè¯æˆåŠŸï¼Œæ¥æ”¶æ–¹å¯ä»¥ç¡®ä¿¡æ•°æ®ç¡®å®æ¥è‡ªé¢„æœŸçš„å‘é€è€…ï¼Œä¸”æ•°æ®è‡ªç­¾åä»¥æ¥æœªè¢«ç¯¡æ”¹è¿‡ã€‚</p><p>è¿™å°±æ˜¯ <code>Sign</code> ç±»åœ¨ Node.js ä¸­çš„åŸºæœ¬ç”¨é€”å’Œæ“ä½œæ–¹å¼ã€‚ä½¿ç”¨æ•°å­—ç­¾åæ˜¯ç½‘ç»œé€šä¿¡å’Œæ•°æ®äº¤æ¢ä¸­å¸¸è§çš„å®‰å…¨æªæ–½ï¼Œå¹¿æ³›ç”¨äºæ–‡ä»¶ä¼ è¾“ã€è½¯ä»¶åˆ†å‘ã€API äº¤äº’ç­‰åœºæ™¯ã€‚</p><h3 id="sign-sign-privatekey-outputencoding" tabindex="-1"><a class="header-anchor" href="#sign-sign-privatekey-outputencoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#signsignprivatekey-outputencoding" target="_blank" rel="noopener noreferrer">sign.sign(privateKey[, outputEncoding])</a></span></a></h3><p>å½“ç„¶ï¼Œå¾ˆé«˜å…´å¸®åŠ©ä½ ç†è§£ Node.js ä¸­<code>crypto</code>æ¨¡å—çš„<code>sign.sign()</code>æ–¹æ³•ã€‚</p><p>é¦–å…ˆï¼Œ<code>crypto</code>æ˜¯ä¸€ä¸ª Node.js çš„æ ¸å¿ƒæ¨¡å—ï¼Œå®ƒæä¾›äº†åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯¹æ•°æ®è¿›è¡Œç­¾åå’ŒéªŒè¯ç­¾åã€‚è€Œ<code>sign.sign()</code>æ–¹æ³•å°±æ˜¯ç”¨äºç”Ÿæˆä¸€ä¸ªæ•°å­—ç­¾åçš„ã€‚</p><p>æ•°å­—ç­¾åæ˜¯ä¸€ç§ç”µå­ç­¾åï¼Œå®ƒä½¿ç”¨åŠ å¯†æŠ€æœ¯æ¥è¯æ˜æ¶ˆæ¯æˆ–æ–‡ä»¶çš„å®Œæ•´æ€§ä»¥åŠå‘é€è€…çš„èº«ä»½ã€‚è¿™ä¸ªè¿‡ç¨‹éœ€è¦ä½¿ç”¨ä¸€ä¸ªç§é’¥æ¥ç”Ÿæˆç­¾åï¼Œç„¶åæ¥æ”¶è€…å¯ä»¥ç”¨ç›¸åº”çš„å…¬é’¥æ¥éªŒè¯ç­¾åç¡®å®æ˜¯ç”±æŒæœ‰ç§é’¥çš„äººæ‰€åˆ›å»ºã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ·±å…¥åˆ°<code>sign.sign(privateKey[, outputEncoding])</code>æ–¹æ³•ï¼š</p><ul><li><code>privateKey</code>ï¼šè¿™æ˜¯ç”¨äºç­¾åçš„ç§é’¥ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€Bufferã€TypedArrayã€DataViewã€KeyObject æˆ–è€…æ˜¯é€šè¿‡ PEM æˆ– DER ç¼–ç çš„æ ¼å¼ã€‚</li><li><code>outputEncoding</code>ï¼ˆå¯é€‰ï¼‰ï¼šè¿™ä¸ªå‚æ•°æ˜¯ç”¨æ¥æŒ‡å®šè¾“å‡ºæ ¼å¼çš„ç¼–ç ç±»å‹ã€‚å¦‚æœä½ æƒ³ç›´æ¥å¾—åˆ°ç­¾åç»“æœçš„å­—ç¬¦ä¸²å½¢å¼ï¼Œå¯ä»¥è®¾ç½®ä¸º<code>&#39;hex&#39;</code>ã€<code>&#39;latin1&#39;</code>æˆ–<code>&#39;base64&#39;</code>ç­‰ã€‚å¦‚æœçœç•¥æ­¤å‚æ•°ï¼Œåˆ™é»˜è®¤è¿”å›ä¸€ä¸ª Buffer å¯¹è±¡ã€‚</li></ul><p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨<code>sign.sign()</code>æ–¹æ³•ï¼š</p><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªè½¯ä»¶ï¼Œéœ€è¦ç”¨æˆ·åœ¨æäº¤æŸä¸ªæ–‡æ¡£å‰å¯¹å…¶è¿›è¡Œæ•°å­—ç­¾åï¼Œä»¥ç¡®ä¿æ–‡æ¡£ä¸è¢«ç¯¡æ”¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¬¬ä¸€æ­¥ï¼Œåˆ›å»ºä¸€ä¸ªç­¾åå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> sign</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createSign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;SHA256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬è¦ç­¾åçš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;è¿™æ˜¯éœ€è¦ç­¾åçš„æ•°æ®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¬¬äºŒæ­¥ï¼Œæ·»åŠ æ•°æ®åˆ°ç­¾åå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¬¬ä¸‰æ­¥ï¼Œå‡†å¤‡ç§é’¥</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œåªæ˜¯ç¤ºä¾‹ï¼Œå®é™…æ“ä½œæ—¶è¯·å®‰å…¨åœ°å­˜å‚¨å’Œè¯»å–ä½ çš„ç§é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> privateKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `-----BEGIN PRIVATE KEY-----</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC...ä½ çš„ç§é’¥å†…å®¹...</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">-----END PRIVATE KEY-----`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¬¬å››æ­¥ï¼Œä½¿ç”¨ç§é’¥ç”Ÿæˆç­¾å</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æŒ‡å®šè¾“å‡ºæ ¼å¼ä¸ºbase64</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç­¾åå€¼:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">signature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼š</p><ol><li>æˆ‘ä»¬ä½¿ç”¨<code>createSign</code>æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªç­¾åå¯¹è±¡ï¼Œå¹¶ä¸”æŒ‡å®šäº†ç­¾åç®—æ³•ï¼ˆè¿™é‡Œä½¿ç”¨çš„æ˜¯&#39;SHA256&#39;ï¼‰ã€‚</li><li>ç„¶åï¼Œæˆ‘ä»¬è°ƒç”¨<code>update</code>æ–¹æ³•æ¥æ·»åŠ éœ€è¦ç­¾åçš„æ•°æ®ï¼ˆåœ¨çœŸå®åœºæ™¯ä¸­ï¼Œæ•°æ®å¯èƒ½æ˜¯éå¸¸å¤§çš„æ–‡æ¡£æˆ–è€…é‡è¦ä¿¡æ¯ï¼‰ã€‚</li><li>æ¥ç€ï¼Œæˆ‘ä»¬å‡†å¤‡å¥½ç§é’¥ã€‚æ³¨æ„ï¼Œåœ¨å®é™…ç¯å¢ƒä¸­ï¼Œç§é’¥éœ€è¦è¢«å®‰å…¨åœ°å­˜å‚¨ï¼Œå› ä¸ºä»»ä½•è·å–ç§é’¥çš„äººéƒ½å¯ä»¥ä¼ªé€ ç­¾åã€‚</li><li>æœ€åï¼Œæˆ‘ä»¬è°ƒç”¨<code>sign</code>æ–¹æ³•å¹¶ä¼ å…¥ç§é’¥å’ŒæœŸæœ›çš„è¾“å‡ºç¼–ç æ ¼å¼ï¼ˆè¿™é‡Œæ˜¯ base64ï¼‰ï¼Œæ¥è·å–ç­¾åã€‚</li></ol><p>å¾—åˆ°çš„ç­¾å<code>signature</code>å¯ä»¥ä¸åŸå§‹æ•°æ®ä¸€èµ·è¢«å‘é€åˆ°æœåŠ¡å™¨æˆ–ç¬¬ä¸‰æ–¹ï¼Œä»–ä»¬å¯ä»¥ä½¿ç”¨ç›¸å¯¹åº”çš„å…¬é’¥æ¥éªŒè¯ç­¾åçš„çœŸå®æ€§ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ¥æ”¶æ–¹å°±èƒ½ç¡®ä¿¡æ•°æ®ç¡®å®æ¥è‡ªäºå‘é€æ–¹ï¼Œå¹¶ä¸”åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚</p><h3 id="sign-update-data-inputencoding" tabindex="-1"><a class="header-anchor" href="#sign-update-data-inputencoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#signupdatedata-inputencoding" target="_blank" rel="noopener noreferrer">sign.update(data[, inputEncoding])</a></span></a></h3><p><code>sign.update(data[, inputEncoding])</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨äºå‘åˆ›å»ºçš„ç­¾åå¯¹è±¡ä¸­æ·»åŠ æ•°æ®ã€‚è¿™æ˜¯æ•°å­—ç­¾åè¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œé€šå¸¸ç”¨äºéªŒè¯æ•°æ®çš„å®Œæ•´æ€§å’Œæ¥æºã€‚</p><p>åœ¨æ•°å­—ç­¾åè¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆè¦æœ‰ä¸€æ®µæ•°æ®ï¼ˆæ¯”å¦‚æ–‡ä»¶ã€æ¶ˆæ¯ç­‰ï¼‰ï¼Œè¿™æ®µæ•°æ®ä¼šé€šè¿‡ä¸€ä¸ªæ•£åˆ—ï¼ˆå“ˆå¸Œï¼‰å‡½æ•°è½¬æ¢æˆå›ºå®šé•¿åº¦çš„æ•£åˆ—å€¼ã€‚ç„¶åï¼Œä½¿ç”¨ç­¾åè€…çš„ç§é’¥å¯¹è¿™ä¸ªæ•£åˆ—å€¼è¿›è¡ŒåŠ å¯†ï¼Œç”Ÿæˆæ•°å­—ç­¾åã€‚æ¥æ”¶æ–¹ä¸ºäº†éªŒè¯æ•°æ®æ²¡æœ‰è¢«ç¯¡æ”¹ï¼Œå¹¶ç¡®å®æ¥è‡ªç­¾åè€…ï¼Œå¯ä»¥ä½¿ç”¨ç­¾åè€…çš„å…¬é’¥å¯¹ç­¾åè¿›è¡Œè§£å¯†ï¼Œå¹¶å°†è§£å¯†å‡ºæ¥çš„æ•£åˆ—å€¼ä¸åŸå§‹æ•°æ®é€šè¿‡ç›¸åŒçš„æ•£åˆ—å‡½æ•°è®¡ç®—å‡ºçš„æ•£åˆ—å€¼è¿›è¡Œå¯¹æ¯”ã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼Œåˆ™éªŒè¯æˆåŠŸã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€æ­¥äº†è§£ <code>sign.update(data[, inputEncoding])</code> æ–¹æ³•ï¼š</p><ol><li><p><code>sign</code>ï¼šè¿™è¡¨ç¤ºä¸€ä¸ªç­¾åå¯¹è±¡ï¼Œå®ƒéœ€è¦å…ˆé€šè¿‡ <code>crypto.createSign(algorithm)</code> æ–¹æ³•åˆ›å»ºï¼Œå…¶ä¸­ <code>algorithm</code> è¡¨ç¤ºé€‰æ‹©çš„ç­¾åç®—æ³•ï¼Œæ¯”å¦‚ <code>&#39;RSA-SHA256&#39;</code>ã€‚</p></li><li><p><code>.update(data[, inputEncoding])</code>ï¼šè¿™ä¸ªæ–¹æ³•ä¼šå°†æ•°æ®ï¼ˆ<code>data</code>ï¼‰æ·»åŠ åˆ°ç­¾åä¸­ã€‚ä½ å¯ä»¥å¤šæ¬¡è°ƒç”¨ <code>update()</code> æ–¹æ³•å‘ç­¾åæ·»åŠ æ›´å¤šçš„æ•°æ®ã€‚</p></li><li><p><code>data</code>ï¼šè¿™æ˜¯ä½ æƒ³è¦åŠ å…¥ç­¾åçš„æ•°æ®ï¼Œå®ƒå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–è€… Bufferï¼ˆäºŒè¿›åˆ¶æ•°æ®ï¼‰ã€‚</p></li><li><p><code>inputEncoding</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå½“ä½ ä¼ å…¥çš„ <code>data</code> æ˜¯å­—ç¬¦ä¸²æ—¶ï¼Œä½ å¯ä»¥ç”¨è¿™ä¸ªå‚æ•°æŒ‡å®šç¼–ç æ–¹å¼ï¼ˆå¦‚ <code>&#39;utf8&#39;</code>, <code>&#39;ascii&#39;</code>, <code>&#39;binary&#39;</code> ç­‰ï¼‰ã€‚å¦‚æœ <code>data</code> æ˜¯ Bufferï¼Œåˆ™ä¸éœ€è¦æ­¤å‚æ•°ã€‚</p></li></ol><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®é™…çš„ä¾‹å­ï¼Œè¿™å°†å±•ç¤ºå¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨ <code>sign.update(data[, inputEncoding])</code> åˆ›å»ºä¸€ä¸ªæ•°å­—ç­¾åï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸²éœ€è¦ç­¾åçš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> message</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;è¿™æ˜¯ä¸€ä¸ªéœ€è¦ç­¾åçš„é‡è¦ä¿¡æ¯&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªç­¾åå¯¹è±¡ï¼Œä½¿ç”¨RSA-SHA256ç®—æ³•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> sign</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createSign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;RSA-SHA256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†æ•°æ®æ·»åŠ åˆ°ç­¾åå¯¹è±¡ä¸­ï¼Œè¿™é‡Œå› ä¸ºæ˜¯å­—ç¬¦ä¸²ï¼Œé»˜è®¤ç¼–ç æ˜¯&#39;utf8&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–ç§é’¥ï¼Œé€šå¸¸ç§é’¥æ˜¯ä¿å¯†çš„ï¼Œè¿™é‡Œå‡è®¾å®ƒå­˜å‚¨åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> privateKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path/to/privateKey.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ç§é’¥ç”Ÿæˆç­¾åï¼ˆè¾“å‡ºæ ¼å¼ä¸º&#39;base64&#39;ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`ç”Ÿæˆçš„æ•°å­—ç­¾åæ˜¯: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">signature</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨signatureå°±æ˜¯ä½ çš„æ•°å­—ç­¾åï¼Œå¯ä»¥å‘é€ç»™åˆ«äººéªŒè¯</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥å¿…è¦çš„æ¨¡å—å¹¶å®šä¹‰äº†ä¸€æ¡æ¶ˆæ¯ã€‚ç„¶ååˆ›å»ºä¸€ä¸ªç­¾åå¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ <code>update</code> æ–¹æ³•å°†æ¶ˆæ¯æ·»åŠ åˆ°ç­¾åä¸­ï¼Œæœ€åä½¿ç”¨ç§é’¥æ¥ç”Ÿæˆç­¾åã€‚ç»“æœæ˜¯ä¸€ä¸ª base64 ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªç­¾åå¯ä»¥è·Ÿæ¶ˆæ¯ä¸€èµ·å‘é€ç»™å…¶ä»–äººä»¥ä¾›éªŒè¯ã€‚</p><h2 id="class-verify" tabindex="-1"><a class="header-anchor" href="#class-verify"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#class-verify" target="_blank" rel="noopener noreferrer">Class: Verify</a></span></a></h2><p>åœ¨ Node.js ä¸­ï¼Œ<code>crypto</code>æ¨¡å—åŒ…å«äº†ä¸€ç³»åˆ—ç”¨äºæ‰§è¡ŒåŠ å¯†æ“ä½œçš„åŠŸèƒ½ï¼Œå…¶ä¸­çš„<code>Verify</code>ç±»æ˜¯ç”¨æ¥å¤„ç†æ•°å­—ç­¾åéªŒè¯çš„ã€‚æ•°å­—ç­¾åæ˜¯ä¸€ç§ç¡®ä¿æ¶ˆæ¯ã€æ–‡æ¡£æˆ–å…¶ä»–æ•°æ®æœªè¢«ç¯¡æ”¹çš„æœºåˆ¶ã€‚å®ƒå…è®¸å‘é€æ–¹åˆ›å»ºæ•°æ®çš„ç­¾åï¼Œå¹¶è®©æ¥æ”¶æ–¹éªŒè¯è¯¥ç­¾åä»¥ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§å’Œæ¥æºçš„çœŸå®æ€§ã€‚</p><p>ä»¥ä¸‹æ­¥éª¤æ¦‚è¿°äº†ä½¿ç”¨<code>Verify</code>ç±»çš„ä¸€èˆ¬è¿‡ç¨‹ï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ªç­¾åè€…ä½¿ç”¨ä»–ä»¬çš„ç§é’¥å¯¹æ•°æ®è¿›è¡Œç­¾åã€‚</li><li>å‘é€è€…å°†åŸå§‹æ•°æ®å’Œç­¾åå‘é€ç»™æ¥æ”¶è€…ã€‚</li><li>æ¥æ”¶è€…ä½¿ç”¨ç›¸åº”çš„å…¬é’¥åˆ›å»ºä¸€ä¸ª<code>Verify</code>å¯¹è±¡å¹¶ç”¨å®ƒæ¥éªŒè¯ç­¾åã€‚</li></ol><p>ä¸‹é¢é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜<code>Verify</code>ç±»çš„ä½¿ç”¨ï¼š</p><p>å‡è®¾ Alice æƒ³è¦å‘ Bob å‘é€ä¸€ä¸ªç»è¿‡ç­¾åçš„æ¶ˆæ¯ï¼Œç¡®ä¿å½“ Bob æ”¶åˆ°è¿™ä¸ªæ¶ˆæ¯æ—¶ï¼Œä»–èƒ½å¤ŸéªŒè¯ Alice ç¡®å®æ˜¯æ¶ˆæ¯çš„å‘é€è€…ï¼Œè€Œæ¶ˆæ¯è‡ªå‘é€ä»¥åä¹Ÿæ²¡æœ‰è¢«ä¿®æ”¹è¿‡ã€‚</p><h3 id="æ­¥éª¤-1-alice-åˆ›å»ºç­¾å" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-1-alice-åˆ›å»ºç­¾å"><span>æ­¥éª¤ 1: Alice åˆ›å»ºç­¾å</span></a></h3><p>é¦–å…ˆï¼ŒAlice ä¼šæœ‰ä¸€å¯¹å¯†é’¥ï¼šä¸€ä¸ªç§é’¥å’Œä¸€ä¸ªå…¬é’¥ã€‚å¥¹ä¿ç•™ç§é’¥å¹¶å°†å…¬é’¥æä¾›ç»™ Bobã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">createSign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾Aliceçš„ç§é’¥åœ¨è¿™é‡Œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> privateKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºç­¾åå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> sign</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> createSign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Aliceçš„åŸå§‹æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> message</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Hello, Bob!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†æ¶ˆæ¯æ·»åŠ åˆ°ç­¾åå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ç§é’¥ç”Ÿæˆç­¾å</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼ŒAlice ä½¿ç”¨ SHA-256 æ•£åˆ—ç®—æ³•åˆ›å»ºäº†ä¸€ä¸ªç­¾åï¼Œç„¶åä½¿ç”¨å¥¹çš„ç§é’¥å¯¹æ¶ˆæ¯è¿›è¡Œç­¾åï¼Œå¹¶å°†ç»“æœä»¥åå…­è¿›åˆ¶çš„å½¢å¼å­˜å‚¨åœ¨<code>signature</code>å˜é‡ä¸­ã€‚</p><h3 id="æ­¥éª¤-2-alice-å‘-bob-å‘é€æ¶ˆæ¯å’Œç­¾å" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-2-alice-å‘-bob-å‘é€æ¶ˆæ¯å’Œç­¾å"><span>æ­¥éª¤ 2: Alice å‘ Bob å‘é€æ¶ˆæ¯å’Œç­¾å</span></a></h3><p>Alice ç°åœ¨å°†åŸå§‹æ¶ˆæ¯å’Œç­¾åå‘é€ç»™ Bobã€‚ä¸ºäº†ç®€åŒ–ï¼Œæˆ‘ä»¬å‡è®¾è¿™é€šä¿¡æ˜¯å®‰å…¨çš„ã€‚</p><h3 id="æ­¥éª¤-3-bob-éªŒè¯ç­¾å" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤-3-bob-éªŒè¯ç­¾å"><span>æ­¥éª¤ 3: Bob éªŒè¯ç­¾å</span></a></h3><p>Bob æ”¶åˆ°äº† Alice çš„æ¶ˆæ¯å’Œç­¾ååï¼Œä½¿ç”¨ Alice çš„å…¬é’¥æ¥éªŒè¯ç­¾åæ˜¯å¦æœ‰æ•ˆã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">createVerify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯Aliceçš„å…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºéªŒè¯å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> verify</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> createVerify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bobå¾—åˆ°çš„Aliceçš„åŸå§‹æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">verify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨å…¬é’¥éªŒè¯ç­¾å</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> isValid</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> verify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">verify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">signature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isValid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœè¾“å‡ºtrueï¼Œåˆ™ç­¾åæœ‰æ•ˆ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼ŒBob åˆ›å»ºäº†ä¸€ä¸ª<code>Verify</code>å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨åŒæ ·çš„ SHA-256 ç®—æ³•å°† Alice çš„åŸå§‹æ¶ˆæ¯æ·»åŠ åˆ°éªŒè¯å¯¹è±¡ä¸­ã€‚ä»–ä½¿ç”¨<code>verify</code>æ–¹æ³•å’Œ Alice çš„å…¬é’¥æ¥æ£€æŸ¥ç­¾åæ˜¯å¦ä¸æ¶ˆæ¯åŒ¹é…ã€‚å¦‚æœ<code>isValid</code>æ˜¯<code>true</code>ï¼Œåˆ™è¡¨ç¤ºç­¾åæœ‰æ•ˆï¼Œè¿™æ„å‘³ç€æ¶ˆæ¯ç¡®å®æ˜¯ç”± Alice å‘é€çš„ï¼Œå¹¶ä¸”è‡ªç­¾åä»¥æ¥æœªè¢«ä¿®æ”¹ã€‚</p><p>è¿™å°±æ˜¯ Node.js ä¸­<code>Verify</code>ç±»çš„åŸºæœ¬ç”¨é€”åŠå…¶å·¥ä½œåŸç†ã€‚ä½¿ç”¨æ­¤ç±»å¯ä»¥å¢å¼ºåº”ç”¨ç¨‹åºä¸­çš„å®‰å…¨æ€§ï¼Œç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§å’Œèº«ä»½éªŒè¯è¿‡ç¨‹çš„å¯é æ€§ã€‚</p><h3 id="verify-update-data-inputencoding" tabindex="-1"><a class="header-anchor" href="#verify-update-data-inputencoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#verifyupdatedata-inputencoding" target="_blank" rel="noopener noreferrer">verify.update(data[, inputEncoding])</a></span></a></h3><p>åœ¨è§£é‡Š <code>verify.update(data[, inputEncoding])</code> è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£ä¸€ç‚¹ï¼šåœ¨ç½‘ç»œä¼ è¾“å’Œæ•°æ®å­˜å‚¨ä¸­ï¼Œç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§å’ŒéªŒè¯æ•°æ®çš„æ¥æºæ˜¯éå¸¸é‡è¦çš„ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œé€šå¸¸ä¼šä½¿ç”¨æ‰€è°“çš„æ•°å­—ç­¾åã€‚æ•°å­—ç­¾åæ¶‰åŠåˆ°åŠ å¯†æŠ€æœ¯ï¼Œè€Œåœ¨ Node.js ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å†…ç½®çš„ <code>crypto</code> æ¨¡å—ï¼ˆå¤„ç†åŠ å¯†çš„æ¨¡å—ï¼‰æ¥è¿›è¡Œè¿™äº›æ“ä½œã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¯¦ç»†åœ°çœ‹çœ‹ <code>verify.update(data[, inputEncoding])</code>ï¼š</p><h3 id="verify-update-data-inputencoding-1" tabindex="-1"><a class="header-anchor" href="#verify-update-data-inputencoding-1"><span>verify.update(data[, inputEncoding])</span></a></h3><p><code>verify.update</code> æ–¹æ³•æ˜¯ Node.js ä¸­ crypto æ¨¡å—ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºæŠŠæ•°æ®æ·»åŠ åˆ°éªŒè¯å™¨å¯¹è±¡ä¸­ï¼Œä¸ºæ¥ä¸‹æ¥çš„éªŒè¯å‡†å¤‡ã€‚è¿™é‡Œçš„ â€œéªŒè¯â€ æ˜¯æŒ‡ä½¿ç”¨å…¬é’¥æ£€æŸ¥å’Œç¡®è®¤ä¸€æ®µæ•°æ®æ˜¯å¦æ˜¯ç”±æ‹¥æœ‰ç›¸åº”ç§é’¥çš„å®ä½“æ‰€ç­¾åçš„ã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>data</code>ï¼šè¿™æ˜¯ä½ æƒ³è¦éªŒè¯ç­¾åçš„æ•°æ®ã€‚è¿™å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–è€… Bufferã€‚</li><li><code>inputEncoding</code>ï¼šå½“ data æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ—¶ï¼Œè¿™ä¸ªå¯é€‰å‚æ•°å®šä¹‰äº†å­—ç¬¦çš„ç¼–ç æ ¼å¼ï¼Œæ¯”å¦‚ &#39;utf8&#39;ã€&#39;ascii&#39; æˆ–è€… &#39;binary&#39;ã€‚å¦‚æœ data æ˜¯ Bufferï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦è¿™ä¸ªå‚æ•°ã€‚</li></ul><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­æ¥è¯´æ˜ <code>verify.update(data[, inputEncoding])</code> çš„ä½¿ç”¨ï¼š</p><h4 id="ç¤ºä¾‹-éªŒè¯æ•°å­—ç­¾å" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-éªŒè¯æ•°å­—ç­¾å"><span>ç¤ºä¾‹ï¼šéªŒè¯æ•°å­—ç­¾å</span></a></h4><p>å‡è®¾ Alice å‘ Bob å‘é€äº†ä¸€æ¡æ¶ˆæ¯ï¼Œå¹¶å¯¹è¿™æ¡æ¶ˆæ¯åˆ›å»ºäº†ä¸€ä¸ªæ•°å­—ç­¾åã€‚Bob æ”¶åˆ°æ¶ˆæ¯åï¼Œå¸Œæœ›éªŒè¯è¿™ä¸ªç­¾åç¡®å®æ˜¯ Alice æ‰€åˆ›å»ºçš„ï¼Œä»¥æ­¤æ¥è¯æ˜è¿™æ¡æ¶ˆæ¯ç¡®å®æ˜¯ Alice å‘é€çš„ï¼Œæ²¡æœ‰è¢«ç¯¡æ”¹ã€‚</p><p>é¦–å…ˆï¼ŒAlice ä¼šç”¨å¥¹çš„ç§é’¥å¯¹æ¶ˆæ¯è¿›è¡Œç­¾åã€‚è¿™ä¸ªè¿‡ç¨‹å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> message</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;è¿™æ˜¯ Alice å‘ç»™ Bob çš„æ¶ˆæ¯&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  padding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">RSA_PKCS1_PSS_PADDING</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼ŒAlice å°†ç­¾åå‘é€ç»™ Bobã€‚</p><p>Bob åœ¨æ”¶åˆ°æ¶ˆæ¯å’Œç­¾ååï¼Œå°±ä¼šä½¿ç”¨ Alice çš„å…¬é’¥æ¥éªŒè¯è¿™ä¸ªç­¾åã€‚Bob çš„éªŒè¯è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> verifier</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createVerify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">verifier</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> isVerified</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> verifier</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">verify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    padding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">RSA_PKCS1_PSS_PADDING</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  signature</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isVerified</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœè¾“å‡º trueï¼Œåˆ™è¡¨ç¤ºéªŒè¯æˆåŠŸï¼›å¦‚æœæ˜¯ falseï¼Œåˆ™è¡¨ç¤ºéªŒè¯å¤±è´¥ã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>verifier.update(message)</code> æ­£æ˜¯æŠŠéœ€è¦éªŒè¯ç­¾åçš„æ•°æ®æ·»åŠ åˆ°éªŒè¯å™¨å¯¹è±¡ä¸­ã€‚æ³¨æ„ï¼Œåœ¨çœŸå®çš„åº”ç”¨åœºæ™¯ä¸­ï¼ŒAlice çš„å…¬é’¥éœ€è¦é€šè¿‡æŸç§å®‰å…¨çš„æ–¹å¼æå‰å…±äº«ç»™ Bobï¼Œä»¥ä¾¿ Bob å¯ä»¥ç”¨æ¥éªŒè¯ç­¾åã€‚</p><p>æ€»ç»“ï¼š<code>verify.update(data[, inputEncoding])</code> æ˜¯ç”¨äºå°†å¾…éªŒè¯çš„æ•°æ®åŠ è½½åˆ°éªŒè¯å¯¹è±¡ä¸­ï¼Œä¸ºäº†ä¹‹åä½¿ç”¨å…¬é’¥éªŒè¯å·²æœ‰çš„æ•°å­—ç­¾ååšå‡†å¤‡ã€‚è¿™ä¸ªæ–¹æ³•åœ¨ä¿¡æ¯å®‰å…¨é¢†åŸŸéå¸¸é‡è¦ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦éªŒè¯èº«ä»½æˆ–æ•°æ®æœªè¢«ç¯¡æ”¹çš„æƒ…å†µä¸‹ã€‚</p><h3 id="verify-verify-object-signature-signatureencoding" tabindex="-1"><a class="header-anchor" href="#verify-verify-object-signature-signatureencoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#verifyverifyobject-signature-signatureencoding" target="_blank" rel="noopener noreferrer">verify.verify(object, signature[, signatureEncoding])</a></span></a></h3><p><code>verify.verify(object, signature[, signatureEncoding])</code> æ˜¯ Node.js æ ‡å‡†åº“ä¸­ <code>crypto</code> æ¨¡å—æä¾›çš„ä¸€ä¸ªæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ç”¨äºéªŒè¯é€šè¿‡æ•°å­—ç­¾åä¿æŠ¤çš„æ•°æ®çš„å®Œæ•´æ€§å’Œæ¥æºï¼Œå¸¸ç”¨åœ¨éœ€è¦ç¡®ä¿æ•°æ®æœªè¢«ç¯¡æ”¹ï¼Œå¹¶ç¡®è®¤å®ƒæ˜¯ç”±æŒæœ‰ç§é’¥çš„å®ä½“å‘å‡ºçš„æƒ…å†µä¸‹ã€‚</p><p>é¦–å…ˆï¼Œäº†è§£ä¸€ä¸‹èƒŒæ™¯çŸ¥è¯†ã€‚åœ¨å…¬é’¥åŠ å¯†ç³»ç»Ÿä¸­ï¼Œé€šå¸¸æœ‰ä¸€å¯¹å¯†é’¥ï¼šå…¬é’¥å’Œç§é’¥ã€‚å‘é€è€…ä½¿ç”¨ç§é’¥æ¥å¯¹ä¿¡æ¯ç”Ÿæˆæ•°å­—ç­¾åï¼Œè€Œæ¥æ”¶è€…åˆ™ä½¿ç”¨å¯¹åº”çš„å…¬é’¥æ¥éªŒè¯è¯¥ç­¾åæ˜¯å¦æœ‰æ•ˆã€‚</p><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>object</code>ï¼šè¿™é€šå¸¸æ˜¯ä¸€ä¸ª <code>Verify</code> å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡ <code>crypto.createVerify()</code> æ–¹æ³•åˆ›å»ºã€‚å®ƒåŒ…å«äº†åŸå§‹æ•°æ®åŠå…¶å“ˆå¸Œç®—æ³•ä¿¡æ¯ã€‚</li><li><code>signature</code>ï¼šè¿™æ˜¯ç”±å‘é€è€…ä½¿ç”¨ä»–ä»¬çš„ç§é’¥ç”Ÿæˆçš„æ•°å­—ç­¾åï¼Œæ¥æ”¶è€…éœ€è¦éªŒè¯è¿™ä¸ªç­¾åæ¥ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§å’Œæ¥æºã€‚</li><li><code>signatureEncoding</code>ï¼ˆå¯é€‰ï¼‰ï¼šæŒ‡å®šç­¾åå­—ç¬¦ä¸²çš„ç¼–ç ç±»å‹ï¼Œå¦‚ <code>&#39;hex&#39;</code>, <code>&#39;base64&#39;</code> ç­‰ã€‚å¦‚æœçœç•¥æ­¤å‚æ•°ï¼Œåˆ™é»˜è®¤ç­¾åæ˜¯ Buffer æˆ– Uint8Arrayã€‚</li></ul><p>æ­¥éª¤ç®€è¿°ï¼š</p><ol><li>å‘é€è€…æ‹¥æœ‰ä¸€å¯¹å¯†é’¥ï¼šå…¬é’¥å’Œç§é’¥ã€‚</li><li>å‘é€è€…ä½¿ç”¨ç§é’¥å¯¹æ•°æ®ç”Ÿæˆç­¾åã€‚</li><li>å‘é€è€…å°†åŸå§‹æ•°æ®å’Œç­¾åä¸€èµ·å‘é€åˆ°æ¥æ”¶è€…ã€‚</li><li>æ¥æ”¶è€…åˆ©ç”¨å‘é€è€…çš„å…¬é’¥æ¥éªŒè¯ç­¾åã€‚</li></ol><p>ç°åœ¨æ¥ä¸¾ä¸€ä¸ªå®é™…ä¾‹å­ï¼š</p><p>å‡è®¾ Alice æƒ³è¦å‘ Bob å‘é€ä¸€æ¡åŠ å¯†æ¶ˆæ¯ï¼Œå¹¶è®© Bob èƒ½å¤ŸéªŒè¯è¿™æ¡æ¶ˆæ¯ç¡®å®æ¥è‡ªå¥¹ã€‚</p><ol><li>Alice ç”Ÿæˆä¸€å¯¹å¯†é’¥ï¼ˆå…¬é’¥å’Œç§é’¥ï¼‰ã€‚å¥¹ä¿ç®¡ç§é’¥å¹¶å°†å…¬é’¥å‘é€ç»™ Bobã€‚</li><li>Alice åˆ›å»ºä¸€ä¸ªæ¶ˆæ¯ï¼Œæ¯”å¦‚ &quot;Hello, Bob!&quot;ã€‚</li><li>Alice ä½¿ç”¨å¥¹çš„ç§é’¥ç”Ÿæˆæ¶ˆæ¯ &quot;Hello, Bob!&quot; çš„æ•°å­—ç­¾åã€‚</li><li>Alice å°†åŸå§‹æ¶ˆæ¯å’Œç­¾åä¸€èµ·å‘é€ç»™ Bobã€‚</li><li>Bob æ”¶åˆ°æ¶ˆæ¯å’Œç­¾ååï¼Œå°†ä½¿ç”¨ Alice æä¾›çš„å…¬é’¥è¿›è¡ŒéªŒè¯æ“ä½œã€‚</li></ol><p>ç¤ºä¾‹ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹ŸAliceç”Ÿæˆå¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹ŸAliceçš„æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> message</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Hello, Bob!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºç­¾å</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createSign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;SHA256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">signer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> signer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨BobéªŒè¯ç­¾å</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> verifier</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createVerify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;SHA256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">verifier</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> isVerified</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> verifier</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">verify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">signature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Signature verified:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isVerified</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™åº”å½“è¾“å‡º trueï¼Œè¡¨ç¤ºéªŒè¯æˆåŠŸ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿäº† Alice å’Œ Bob çš„äº¤äº’è¿‡ç¨‹ã€‚Alice é¦–å…ˆåˆ›å»ºäº†å¯†é’¥å¯¹ï¼Œå¹¶ç”¨ç§é’¥å¯¹å¥¹çš„æ¶ˆæ¯ç”Ÿæˆäº†ä¸€ä¸ªç­¾åã€‚ç„¶å Bob ä½¿ç”¨ Alice çš„å…¬é’¥æ¥éªŒè¯è¿™ä¸ªç­¾åæ˜¯å¦æœ‰æ•ˆã€‚å¦‚æœæ•°æ®æˆ–ç­¾ååœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¢«ç¯¡æ”¹ï¼ŒéªŒè¯ä¼šå¤±è´¥ï¼Œå› ä¸ºæ•°å­—ç­¾ååªæœ‰åœ¨æ•°æ®æœªè¢«æ›´æ”¹æ—¶æ‰ä¼šåŒ¹é…ã€‚</p><h2 id="class-x509certificate" tabindex="-1"><a class="header-anchor" href="#class-x509certificate"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#class-x509certificate" target="_blank" rel="noopener noreferrer">Class: X509Certificate</a></span></a></h2><p>Node.js ä¸­çš„ <code>X509Certificate</code> ç±»æ˜¯ä¸€ä¸ªå±äº <code>crypto</code> æ¨¡å—çš„å·¥å…·ï¼Œç”¨æ¥å¤„ç†å’Œå¯¹ X.509 è¯ä¹¦è¿›è¡Œæ“ä½œã€‚X.509 è¯ä¹¦æ˜¯ä¸€ç§æ ‡å‡†æ ¼å¼çš„æ•°å­—è¯ä¹¦ï¼Œå®ƒç”¨æ¥éªŒè¯ä¸€ä¸ªå®ä½“ï¼ˆæ¯”å¦‚ä¸€ä¸ªäººã€æœåŠ¡å™¨æˆ–è®¾å¤‡ï¼‰çš„èº«ä»½ã€‚è¿™äº›è¯ä¹¦å¹¿æ³›åº”ç”¨äºäº’è”ç½‘å®‰å…¨ä¸­ï¼Œå°¤å…¶æ˜¯åœ¨ HTTPS åè®®ä¸­ç”¨äºå»ºç«‹å®‰å…¨çš„ TLS/SSL è¿æ¥ã€‚</p><p>è¦ç†è§£ <code>X509Certificate</code> ç±»ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼š</p><ul><li><strong>æ•°å­—è¯ä¹¦</strong>ï¼šè¿™æ˜¯ç”¨æ¥è¯æ˜å…¬é’¥æ‹¥æœ‰è€…èº«ä»½çš„ä¸€ç§æ–¹å¼ã€‚ç®€å•åœ°è¯´ï¼Œå°±åƒä½ æŠ¤ç…§ä¸Šçš„ç­¾è¯å¯ä»¥è¯æ˜ä½ çš„èº«ä»½ä¸€æ ·ï¼Œæ•°å­—è¯ä¹¦å¯ä»¥è¯æ˜ä¸€ä¸ªå…¬é’¥æ‰€å±çš„äººæˆ–ç»„ç»‡çš„èº«ä»½ã€‚</li><li><strong>CA (Certificate Authority)</strong>ï¼šè¿™æ˜¯é¢å‘å’Œç®¡ç†å®‰å…¨è¯ä¹¦çš„æƒå¨æœºæ„ã€‚å®ƒä»¬å……å½“å¯ä¿¡ä»»çš„ç¬¬ä¸‰æ–¹ï¼Œç¡®ä¿è¯ä¹¦ä¸­çš„ä¿¡æ¯æ˜¯æ­£ç¡®çš„ã€‚</li><li><strong>TLS/SSL</strong>ï¼šå®‰å…¨åè®®ï¼Œç”¨äºåœ¨äº’è”ç½‘ä¸Šä¼ è¾“åŠ å¯†æ•°æ®ã€‚</li></ul><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹å‡ ä¸ªå…³äº <code>X509Certificate</code> ç±»çš„å®é™…åº”ç”¨ä¾‹å­ï¼š</p><h3 id="æŸ¥çœ‹è¯ä¹¦ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#æŸ¥çœ‹è¯ä¹¦ä¿¡æ¯"><span>æŸ¥çœ‹è¯ä¹¦ä¿¡æ¯</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦ä¸å®‰å…¨æœåŠ¡å™¨è¿›è¡Œé€šä¿¡çš„åº”ç”¨ç¨‹åºï¼Œä½ å¯èƒ½ä¼šæƒ³è¦é¦–å…ˆéªŒè¯æœåŠ¡å™¨è¯ä¹¦çš„æœ‰æ•ˆæ€§ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªå¦‚ä½•ä½¿ç”¨ <code>X509Certificate</code> æ¥è·å–å’Œæ˜¾ç¤ºè¯ä¹¦è¯¦ç»†ä¿¡æ¯çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> https</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ HTTPS æ¨¡å—å‘èµ·è¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">https</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">socket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPeerCertificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å°†æœåŠ¡å™¨è¿”å›çš„è¯ä¹¦è½¬æ¢ä¸º X509Certificate å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> x509</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">raw</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¯ä¹¦ä¸»é¢˜:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">x509</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">subject</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¯ä¹¦é¢å‘è€…:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">x509</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">issuer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¯ä¹¦æœ‰æ•ˆæœŸ:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">x509</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">validFrom</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;-&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">x509</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">validTo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ <code>https.get</code> æ–¹æ³•ä¸ç½‘ç«™è¿›è¡Œäº†ä¸€ä¸ª HTTPS è¯·æ±‚ï¼Œå¹¶ä½¿ç”¨å›è°ƒå‡½æ•°ä¸­çš„ <code>res.socket.getPeerCertificate()</code> æ–¹æ³•å¾—åˆ°äº†ç½‘ç«™è¯ä¹¦çš„ä¿¡æ¯ã€‚ç„¶åï¼Œæˆ‘ä»¬ç”¨è¿™äº›åŸå§‹è¯ä¹¦æ•°æ®åˆ›å»ºäº†ä¸€ä¸ª <code>X509Certificate</code> å¯¹è±¡ï¼Œå¹¶æ‰“å°å‡ºäº†ä¸€äº›é‡è¦çš„ä¿¡æ¯ï¼Œä¾‹å¦‚è¯ä¹¦çš„ä¸»é¢˜ï¼ˆè¯ä¹¦æŒæœ‰äººçš„ä¿¡æ¯ï¼‰ã€è¯ä¹¦çš„é¢å‘è€…ï¼ˆè°é¢å‘äº†è¿™ä¸ªè¯ä¹¦ï¼‰ï¼Œä»¥åŠè¯ä¹¦çš„æœ‰æ•ˆæœŸã€‚</p><h3 id="éªŒè¯è¯ä¹¦åˆæ³•æ€§" tabindex="-1"><a class="header-anchor" href="#éªŒè¯è¯ä¹¦åˆæ³•æ€§"><span>éªŒè¯è¯ä¹¦åˆæ³•æ€§</span></a></h3><p>ä½ è¿˜å¯ä»¥ä½¿ç”¨ <code>X509Certificate</code> ç±»æ¥æ‰§è¡Œæ›´å¤æ‚çš„ä»»åŠ¡ï¼Œæ¯”å¦‚éªŒè¯è¯ä¹¦çš„åˆæ³•æ€§ã€‚è¯ä¹¦å¯èƒ½ä¼šè¢«æ’¤é”€ï¼Œæˆ–è€…å› ä¸ºæŸäº›åŸå› ä¸å†å—ä¿¡ä»»ã€‚è¿™ç§æ£€æŸ¥é€šå¸¸æ˜¯è‡ªåŠ¨å®Œæˆçš„ï¼Œä½†äº†è§£å¦‚ä½•æ‰‹åŠ¨è¿›è¡Œè¿™ç§æ“ä½œå¾ˆé‡è¦ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ å·²ç»æœ‰äº†ä¸€ä¸ª X509Certificate å¯¹è±¡ x509</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // éªŒè¯è¯ä¹¦æ˜¯å¦è¢«åŠé”€æˆ–è¿‡æœŸ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> isCertValid</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> x509</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">checkValidity</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isCertValid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¯ä¹¦æœ‰æ•ˆ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¯ä¹¦æ— æ•ˆæˆ–å·²è¿‡æœŸ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;éªŒè¯è¿‡ç¨‹ä¸­å‡ºé”™&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç®€åŒ–çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>x509.checkValidity()</code> æ–¹æ³•æ¥æ£€æŸ¥è¯ä¹¦æ˜¯å¦åœ¨æŒ‡å®šæ—¥æœŸæœ‰æ•ˆï¼Œè¿™é‡Œæˆ‘ä»¬ä¼ é€’äº†å½“å‰æ—¥æœŸã€‚å¦‚æœè¯ä¹¦æ˜¯æœ‰æ•ˆçš„ï¼Œ<code>checkValidity</code> æ–¹æ³•ä¼šè¿”å› <code>true</code>ï¼Œå¦åˆ™ä¼šè¿”å› <code>false</code>ã€‚</p><p>è¿™äº›ä»…ä»…æ˜¯ <code>X509Certificate</code> ç±»çš„ä¸€äº›ç®€å•ç¤ºä¾‹ã€‚åœ¨å®é™…çš„ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¯ä¹¦ç®¡ç†å’ŒéªŒè¯æ˜¯éå¸¸å¤æ‚çš„ä¸»é¢˜ï¼Œæ¶‰åŠåˆ°è®¸å¤šé¢å¤–çš„å®‰å…¨è€ƒè™‘ã€‚ä½†å¸Œæœ›è¿™äº›ä¾‹å­èƒ½ä¸ºä½ æä¾›ä¸€ä¸ªèµ·ç‚¹ï¼Œäº†è§£ Node.js å¦‚ä½•å¤„ç† X.509 è¯ä¹¦ã€‚</p><h3 id="new-x509certificate-buffer" tabindex="-1"><a class="header-anchor" href="#new-x509certificate-buffer"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#new-x509certificatebuffer" target="_blank" rel="noopener noreferrer">new X509Certificate(buffer)</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome çš„ V8 JavaScript å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptï¼Œæ‹¥æœ‰ä¸°å¯Œçš„åº“æ¥å¤„ç†å„ç§åç«¯ä»»åŠ¡ã€‚<code>crypto</code> æ¨¡å—æ˜¯ Node.js æ ‡å‡†åº“çš„ä¸€éƒ¨åˆ†ï¼Œæä¾›äº†åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯¹è¯ä¹¦çš„æ“ä½œã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>new X509Certificate(buffer)</code> æ˜¯ <code>crypto</code> æ¨¡å—ä¸­ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„ <code>X509Certificate</code> å¯¹è±¡çš„æ„é€ å‡½æ•°ã€‚X.509 è¯ä¹¦æ˜¯ä¸€ç§æ ‡å‡†æ ¼å¼çš„æ•°å­—è¯ä¹¦ï¼Œå®ƒä½¿ç”¨å…¬é’¥åŠ å¯†å’Œæ•°å­—ç­¾åæ¥å®ç°å®‰å…¨é€šä¿¡ï¼Œä¾‹å¦‚åœ¨ HTTPS åè®®ä¸­ä½¿ç”¨ã€‚</p><p>è¿™ä¸ªæ„é€ å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•° <code>buffer</code>ï¼Œå®ƒåº”è¯¥æ˜¯ä¸€ä¸ªåŒ…å« X.509 è¯ä¹¦æ•°æ®çš„ <code>Buffer</code> å¯¹è±¡æˆ–è€…æ˜¯ä¸€ä¸ª <code>TypedArray</code> æˆ– <code>DataView</code>ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€äº›å…³äºå¦‚ä½•ä½¿ç”¨ <code>new X509Certificate(buffer)</code> çš„ä¾‹å­ï¼š</p><h3 id="ç¤ºä¾‹-1-ä»æ–‡ä»¶åŠ è½½-x-509-è¯ä¹¦" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ä»æ–‡ä»¶åŠ è½½-x-509-è¯ä¹¦"><span>ç¤ºä¾‹ 1: ä»æ–‡ä»¶åŠ è½½ X.509 è¯ä¹¦</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º <code>mycert.pem</code> çš„æ–‡ä»¶ï¼Œé‡Œé¢å­˜å‚¨ç€ä¸€ä¸ª X.509 è¯ä¹¦ã€‚æˆ‘ä»¬æƒ³è¦åœ¨ Node.js ä¸­è¯»å–è¿™ä¸ªè¯ä¹¦å¹¶åˆ›å»ºä¸€ä¸ª <code>X509Certificate</code> å¯¹è±¡ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŒæ­¥è¯»å–è¯ä¹¦æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certPem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;mycert.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»º X509Certificate å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certPem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°è¯ä¹¦çš„ä¸»é¢˜å­—æ®µ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">subject</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç¤ºä¾‹-2-æ£€æŸ¥è¯ä¹¦æŒ‡çº¹" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æ£€æŸ¥è¯ä¹¦æŒ‡çº¹"><span>ç¤ºä¾‹ 2: æ£€æŸ¥è¯ä¹¦æŒ‡çº¹</span></a></h3><p>è¯ä¹¦æŒ‡çº¹æ˜¯è¯ä¹¦çš„å“ˆå¸Œå€¼ï¼Œå¯ä»¥ç”¨æ¥å”¯ä¸€æ ‡è¯†ä¸€ä¸ªè¯ä¹¦ã€‚ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•è·å–è¯ä¹¦çš„æŒ‡çº¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯»å–è¯ä¹¦æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certPem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;mycert.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»º X509Certificate å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certPem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–å¹¶æ‰“å°è¯ä¹¦çš„ SHA-256 æŒ‡çº¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fingerprint256</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç¤ºä¾‹-3-éªŒè¯è¯ä¹¦æœ‰æ•ˆæ€§" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-éªŒè¯è¯ä¹¦æœ‰æ•ˆæ€§"><span>ç¤ºä¾‹ 3: éªŒè¯è¯ä¹¦æœ‰æ•ˆæ€§</span></a></h3><p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>X509Certificate</code> ç±»çš„æ–¹æ³•æ¥æ£€æŸ¥è¯ä¹¦çš„æœ‰æ•ˆæœŸç­‰ä¿¡æ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;fs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;crypto&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯»å–è¯ä¹¦æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certPem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;mycert.pem&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»º X509Certificate å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certPem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥è¯ä¹¦æ˜¯å¦åœ¨å½“å‰æ—¶é—´æœ‰æ•ˆ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> isValidNow</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">validFrom</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`&lt;`</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">validTo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Is the certificate valid now? </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isValidNow</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šå°±æ˜¯ <code>new X509Certificate(buffer)</code> åœ¨ Node.js ä¸­çš„ä¸€äº›åŸºæœ¬ä½¿ç”¨ä¾‹å­ï¼Œå¸®åŠ©ä½ äº†è§£å¦‚ä½•åœ¨ä»£ç ä¸­æ“ä½œå’Œåˆ†æ X.509 è¯ä¹¦ã€‚</p><h3 id="x509-ca" tabindex="-1"><a class="header-anchor" href="#x509-ca"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509ca" target="_blank" rel="noopener noreferrer">x509.ca</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œæ—¶ï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚Node.js ä¸­çš„ <code>crypto</code> æ¨¡å—æ˜¯ç”¨äºåŠ å¯†åŠŸèƒ½çš„å†…ç½®æ¨¡å—ï¼Œå®ƒæä¾›äº†åŒ…æ‹¬ä½†ä¸é™äºå“ˆå¸Œã€HMACã€å¯†ç å­¦ç­¾åå’ŒéªŒè¯ç­‰åŠŸèƒ½ã€‚</p><p>åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œ<code>x509.ca</code> æ˜¯å…³äºå¤„ç† X.509 è¯ä¹¦çš„éƒ¨åˆ†ã€‚X.509 è¯ä¹¦æ˜¯ä¸€ç§æ•°å­—è¯ä¹¦ï¼Œå®ƒéµå¾ª X.509 å…¬é’¥åŸºç¡€è®¾æ–½ï¼ˆPKIï¼‰æ ‡å‡†æ¥ç®¡ç†å…¬é’¥åŠ å¯†ã€‚è¿™äº›è¯ä¹¦ä¸»è¦ç”¨äºå®‰å…¨é€šä¿¡ï¼Œæ¯”å¦‚ HTTPSï¼Œä¸ºç½‘ç«™èº«ä»½æä¾›è®¤è¯ã€‚</p><p>X.509 è¯ä¹¦é€šå¸¸åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š</p><ul><li>è¯ä¹¦æŒæœ‰è€…çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚åŸŸåï¼‰</li><li>è¯ä¹¦æŒæœ‰è€…çš„å…¬é’¥</li><li>è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰çš„ä¿¡æ¯</li><li>æ•°å­—ç­¾åç­‰</li></ul><p>åœ¨ Node.js ä¸­ï¼Œ<code>crypto.x509</code> å¯¹è±¡å¯ä»¥ç”¨æ¥è¡¨ç¤º X.509 è¯ä¹¦ä»¥åŠä¸ä¹‹ç›¸å…³çš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯èƒ½æƒ³è¦éªŒè¯æŸä¸ªè¯ä¹¦æ˜¯å¦ç”±å¯ä¿¡çš„è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰ç­¾åï¼Œæˆ–è€…æ£€æŸ¥è¯ä¹¦çš„æœ‰æ•ˆæ€§æœŸé™ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ æ­£åœ¨åˆ›å»ºä¸€ä¸ªå®‰å…¨çš„ Web æœåŠ¡å™¨ï¼Œå¹¶ä¸”ä½ éœ€è¦åŠ è½½æœåŠ¡å™¨çš„ SSL/TLS è¯ä¹¦ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> https</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯»å–è¯ä¹¦æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certificate</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path/to/certificate.crt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> privateKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path/to/private.key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> ca</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path/to/ca.crt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// CAè¯ä¹¦</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºHTTPSæœåŠ¡å™¨é€‰é¡¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> options</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  ca</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ca</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†CAè¯ä¹¦è®¾ç½®åˆ°caå­—æ®µ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºå¹¶å¯åŠ¨HTTPSæœåŠ¡å™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">https</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeHead</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">443</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä»¥ä¸Šä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† Node.js çš„ <code>fs</code> æ¨¡å—æ¥è¯»å–ç§é’¥ã€è¯ä¹¦å’Œ CA è¯ä¹¦æ–‡ä»¶ã€‚è¿™äº›éƒ½æ˜¯åˆ›å»ºå®‰å…¨è¿æ¥æ‰€å¿…éœ€çš„ã€‚ç„¶åæˆ‘ä»¬åˆ›å»ºäº† HTTPS æœåŠ¡å™¨çš„é…ç½®é€‰é¡¹ï¼Œå…¶ä¸­åŒ…æ‹¬ç§é’¥ã€è¯ä¹¦å’Œ CA è¯ä¹¦ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™äº›é€‰é¡¹åˆ›å»ºäº† HTTPS æœåŠ¡å™¨ã€‚</p><p>å½“å®¢æˆ·ç«¯å°è¯•è¿æ¥åˆ°æ­¤æœåŠ¡å™¨æ—¶ï¼ŒæœåŠ¡å™¨å°†å‘å…¶å‘é€åŒ…å«å…¬é’¥çš„è¯ä¹¦ã€‚å¦‚æœè¯¥è¯ä¹¦è¢« CA ç­¾åï¼Œè€Œä¸”å®¢æˆ·ç«¯ä¿¡ä»»è¯¥ CAï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å°†ç¡®è®¤è¿™ä¸ªå…¬é’¥æ˜¯çœŸå®ã€å¯ä¿¡çš„ï¼Œä»è€Œå»ºç«‹èµ·ä¸€ä¸ªå®‰å…¨çš„é€šä¿¡ç®¡é“ã€‚</p><p>åœ¨æ›´é«˜çº§çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œä½ å¯èƒ½ä¼šä½¿ç”¨ <code>crypto.x509</code> ç›¸å…³çš„æ–¹æ³•æ¥ç¼–ç¨‹å¼åœ°è¯»å–è¯ä¹¦å†…å®¹ï¼Œæ¯”å¦‚è·å–è¯ä¹¦çš„æŒ‡çº¹ã€æ£€æŸ¥è¯ä¹¦æ˜¯å¦å·²ç»è¿‡æœŸï¼Œæˆ–è€…éªŒè¯è¯ä¹¦é“¾ç­‰ã€‚</p><p>è¯·æ³¨æ„ï¼Œå…·ä½“çš„ API ä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒä»¬å¯èƒ½ä¼šéšç€ Node.js ç‰ˆæœ¬çš„æ›´æ–°è€Œæœ‰æ‰€å˜åŒ–ã€‚å› æ­¤ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå»ºè®®æŸ¥çœ‹ä½ æ‰€ä½¿ç”¨ç‰ˆæœ¬çš„ Node.js å®˜æ–¹æ–‡æ¡£ä¸­çš„ <code>crypto</code> æ¨¡å—éƒ¨åˆ†ï¼Œä»¥è·å–æœ€æ–°ã€æœ€å‡†ç¡®çš„ä¿¡æ¯ã€‚</p><h3 id="x509-checkemail-email-options" tabindex="-1"><a class="header-anchor" href="#x509-checkemail-email-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509checkemailemail-options" target="_blank" rel="noopener noreferrer">x509.checkEmail(email[, options])</a></span></a></h3><p><code>x509.checkEmail(email[, options])</code> æ˜¯ Node.js ç‰ˆæœ¬ 21.7.1 ä¸­çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå±äº <code>crypto</code> æ¨¡å—ã€‚è¿™ä¸ªå‡½æ•°ä¸»è¦ç”¨äºæ£€æŸ¥ç»™å®šçš„ç”µå­é‚®ä»¶åœ°å€æ˜¯å¦åŒ¹é… X.509 è¯ä¹¦ä¸­çš„æŸäº›å­—æ®µã€‚X.509 è¯ä¹¦æ˜¯ä¸€ç§æ ‡å‡†æ ¼å¼çš„è¯ä¹¦ï¼Œç”¨æ¥éªŒè¯å®ä½“çš„èº«ä»½ï¼Œè­¬å¦‚ç½‘ç«™æœåŠ¡å™¨ã€å®¢æˆ·ç«¯æˆ–è€…å…¶ä»–ç½‘ç»œå®ä½“ã€‚</p><p>åœ¨ä½ æä¾›çš„é“¾æ¥ä¸­ï¼Œ<code>x509.checkEmail</code> å‡½æ•°çš„æè¿°æŒ‡æ˜äº†å®ƒçš„ç”¨é€”ï¼šæ£€æŸ¥æŒ‡å®šçš„ç”µå­é‚®ä»¶åœ°å€æ˜¯å¦ç¬¦åˆè¯ä¹¦ä¸­å®šä¹‰çš„ç”µå­é‚®ä»¶åœ°å€ã€‚è¯ä¹¦ä¸­å¯èƒ½ä¼šåŒ…å«è‹¥å¹²ä¸ªç”µå­é‚®ä»¶åœ°å€å­—æ®µï¼Œè¿™äº›å­—æ®µå¯ä»¥å‡ºç°åœ¨è¯ä¹¦çš„ä¸»é¢˜å­—æ®µï¼ˆSubjectï¼‰æˆ–è€…ä¸»é¢˜å¤‡ç”¨åç§°ï¼ˆSubject Alternative Nameï¼Œç®€ç§° SANï¼‰æ‰©å±•ä¸­ã€‚</p><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>email</code>: éœ€è¦è¢«æ£€æŸ¥çš„ç”µå­é‚®ä»¶åœ°å€ã€‚</li><li><code>options</code>: å¯é€‰å‚æ•°å¯¹è±¡ï¼Œé‡Œé¢å¯ä»¥åŒ…å«é¢å¤–çš„é…ç½®é¡¹ã€‚</li></ul><p>ä¸¾å‡ ä¸ªå®é™…è¿ç”¨ç¤ºä¾‹ï¼š</p><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªæœåŠ¡å™¨å¹¶ä¸”ç”¨ SSL/TLS åè®®ä¸ºç”¨æˆ·æä¾›å®‰å…¨è¿æ¥ã€‚SSL/TLS åè®®éœ€è¦ä½¿ç”¨ X.509 è¯ä¹¦ã€‚å½“ç”¨æˆ·å°è¯•è¿æ¥åˆ°ä½ çš„æœåŠ¡å™¨æ—¶ï¼Œä½ å¯èƒ½å¸Œæœ›ç¡®è®¤ä»–ä»¬çš„ç”µå­é‚®ä»¶åœ°å€æ˜¯å¦è¢«æˆæƒå¯ä»¥è®¿é—®ç‰¹å®šçš„æœåŠ¡ã€‚è¿™æ—¶ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨ <code>x509.checkEmail</code> æ¥éªŒè¯ç”¨æˆ·æä¾›çš„ç”µå­é‚®ä»¶åœ°å€æ˜¯å¦ä¸è¯ä¹¦ä¸­åˆ—å‡ºçš„åœ°å€åŒ¹é…ã€‚</p><p>ä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ å·²ç»æœ‰äº†ä¸€ä¸ªX.509è¯ä¹¦æ–‡ä»¶ &#39;mycert.pem&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certPem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;mycert.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fromPEM</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certPem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¾…éªŒè¯çš„é‚®ç®±åœ°å€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> emailToCheck</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;user@example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨checkEmailæ–¹æ³•æ£€æŸ¥é‚®ç®±åœ°å€æ˜¯å¦æœ‰æ•ˆ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> isEmailValid</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">checkEmail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">emailToCheck</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`é‚®ç®±åœ°å€éªŒè¯ç»“æœï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isEmailValid</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> ?</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;æœ‰æ•ˆ&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;æ— æ•ˆ&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`å‘ç”Ÿé”™è¯¯ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">err</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† <code>crypto</code> å’Œ <code>fs</code> æ¨¡å—ã€‚ç„¶åè¯»å–äº†ä¸€ä¸ªåä¸º <code>mycert.pem</code> çš„æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«äº†ä½ çš„ X.509 è¯ä¹¦ã€‚æ¥ç€ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª <code>X509Certificate</code> å¯¹è±¡ï¼Œå¹¶ç”¨å®ƒæ¥æ£€æŸ¥ä¸€ä¸ªå« <code>user@example.com</code> çš„ç”µå­é‚®ä»¶åœ°å€æ˜¯å¦æœ‰æ•ˆã€‚</p><p>å¦‚æœç”µå­é‚®ä»¶åœ°å€ä¸è¯ä¹¦ä¸­çš„ä¿¡æ¯åŒ¹é…ï¼Œ<code>checkEmail</code> å°†è¿”å› <code>true</code>ï¼Œå¦åˆ™è¿”å› <code>false</code>ã€‚å¦‚æœè¯ä¹¦è§£æè¿‡ç¨‹å‡ºé”™æˆ–ç”µå­é‚®ä»¶æ£€æŸ¥åŠŸèƒ½ä¸å¯ç”¨ï¼Œå°†æŠ›å‡ºå¼‚å¸¸ã€‚</p><p>è¯·æ³¨æ„ï¼Œç”±äºè¯ä¹¦å’ŒåŠ å¯†æŠ€æœ¯æ¶‰åŠå¤æ‚ç»†èŠ‚ï¼Œè¿™åªæ˜¯ä¸€ä¸ªåŸºç¡€ç¤ºä¾‹ï¼ŒçœŸå®åº”ç”¨ä¸­å¯èƒ½éœ€è¦æ›´å¤šçš„é”™è¯¯å¤„ç†å’Œå®‰å…¨è€ƒè™‘ã€‚</p><h3 id="x509-checkhost-name-options" tabindex="-1"><a class="header-anchor" href="#x509-checkhost-name-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509checkhostname-options" target="_blank" rel="noopener noreferrer">x509.checkHost(name[, options])</a></span></a></h3><p><code>x509.checkHost(name[, options])</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºéªŒè¯æä¾›çš„ä¸»æœºåæ˜¯å¦ç¬¦åˆ X.509 è¯ä¹¦ä¸­å®šä¹‰çš„æ¡ä»¶ã€‚X.509 è¯ä¹¦é€šå¸¸ç”¨äº TLS/SSL åŠ å¯†ï¼Œè¿™ç§åŠ å¯†åœ¨äº’è”ç½‘ä¸Šéå¸¸æ™®éï¼Œç‰¹åˆ«æ˜¯ç”¨äº HTTPS åè®®æ¥ä¿æŠ¤ç½‘é¡µçš„å®‰å…¨ã€‚</p><p>æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥è§£æ <code>x509.checkHost(name[, options])</code> æ–¹æ³•ï¼š</p><ol><li><p><strong>x509</strong>: è¿™ä»£è¡¨ Node.js çš„ crypto æ¨¡å—ä¸­å’Œ X.509 è¯ä¹¦æœ‰å…³çš„åŠŸèƒ½ã€‚X.509 è¯ä¹¦åŒ…å«äº†è®¸å¤šä¿¡æ¯ï¼Œå¦‚å…¬é’¥ã€è¯ä¹¦æŒæœ‰è€…çš„ä¿¡æ¯ä»¥åŠæ•°å­—ç­¾åç­‰ã€‚</p></li><li><p><strong>checkHost</strong>: è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯æ£€æŸ¥ä¸€ä¸ªæŒ‡å®šçš„ä¸»æœºåæ˜¯å¦ä¸è¯ä¹¦ä¸­å®šä¹‰çš„ä¸»æœºååŒ¹é…ã€‚å®ƒé€šå¸¸ç”¨äºç¡®ä¿æ­£åœ¨å»ºç«‹è¿æ¥çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„è¯ä¹¦æ˜¯ä¸ºè¯¥ç‰¹å®šåŸŸåæˆ–ä¸»æœºåé¢å‘çš„ã€‚</p></li><li><p><strong>name</strong>: è¿™æ˜¯ä½ æƒ³è¦éªŒè¯çš„ä¸»æœºåå­—ç¬¦ä¸²ã€‚æ¯”å¦‚è¯´ï¼Œå¦‚æœä½ è®¿é—® <code>https://www.example.com</code>ï¼Œé‚£ä¹ˆ <code>name</code> åº”è¯¥æ˜¯ <code>&quot;www.example.com&quot;</code>ã€‚</p></li><li><p><strong>options</strong>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå®ƒå…è®¸ä½ æä¾›é¢å¤–çš„é…ç½®é€‰é¡¹ã€‚å…¶ä¸­å¯ä»¥åŒ…æ‹¬è¯ä¹¦æœ¬èº«ï¼Œä¹Ÿå¯ä»¥åŒ…å«åƒ <code>subject</code> æˆ– <code>issuer</code> è¿™æ ·çš„å­—æ®µç”¨ä»¥æ›´è¯¦ç»†åœ°æ§åˆ¶åŒ¹é…è¿‡ç¨‹ã€‚</p></li></ol><p>ç°åœ¨æ¥çœ‹å‡ ä¸ªå®é™…åº”ç”¨çš„ä¾‹å­ï¼š</p><p><strong>ä¾‹å­ 1ï¼šæ£€æŸ¥è¯ä¹¦æ˜¯å¦é€‚ç”¨äºç‰¹å®šçš„ä¸»æœºå</strong></p><p>å‡è®¾ä½ æœ‰ä¸€ä¸ª X.509 è¯ä¹¦ï¼Œå¹¶ä¸”ä½ æƒ³æ£€æŸ¥è¿™ä¸ªè¯ä¹¦æ˜¯å¦é€‚ç”¨äºä¸»æœºå <code>&quot;www.example.com&quot;</code>ã€‚ä»£ç å¯èƒ½åƒè¿™æ ·ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;crypto&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> ...</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ­¤å¤„çœç•¥äº†è·å–è¯ä¹¦çš„ä»£ç </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">x509</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">checkHost</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;www.example.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;è¯ä¹¦æœ‰æ•ˆï¼Œé€‚ç”¨äºè¯¥ä¸»æœºå&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;è¯ä¹¦æ— æ•ˆæˆ–ä¸é€‚ç”¨äºè¯¥ä¸»æœºå&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœè¯ä¹¦é€‚ç”¨äº <code>&quot;www.example.com&quot;</code>ï¼Œé‚£ä¹ˆ <code>checkHost</code> å°†ä¼šæˆåŠŸè¿”å›ï¼Œå¦åˆ™å®ƒä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p><p><strong>ä¾‹å­ 2ï¼šå¤„ç†å¤šä¸ªå€™é€‰ä¸»æœºå</strong></p><p>è€ƒè™‘åˆ°ä¸€ä¸ªè¯ä¹¦å¯èƒ½é€‚ç”¨äºå¤šä¸ªä¸åŒçš„ä¸»æœºåï¼ˆä¾‹å¦‚é€šè¿‡ä½¿ç”¨é€šé…ç¬¦æˆ–è€… SANs - Subject Alternative Namesï¼‰ï¼Œä½ å¯èƒ½æƒ³æ£€æŸ¥è¯ä¹¦æ˜¯å¦é€‚ç”¨äºä¸€ç³»åˆ—çš„ä¸»æœºåã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;crypto&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> ...</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ­¤å¤„çœç•¥äº†è·å–è¯ä¹¦çš„ä»£ç </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hostnames</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;www.example.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;api.example.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;example.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hostnames</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">hostname</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">x509</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">checkHost</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è¯ä¹¦é€‚ç”¨äº </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è¯ä¹¦ä¸é€‚ç”¨äº </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hostname</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¾ªç¯éå†ä¸€ä¸ªä¸»æœºåæ•°ç»„ï¼Œåˆ†åˆ«æ£€æŸ¥æ¯ä¸€ä¸ªæ˜¯å¦ä¸è¯ä¹¦å…¼å®¹ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯ <code>x509.checkHost</code> çš„ç”¨æ³•å’Œä¸€äº›ç®€å•çš„ä¾‹å­ã€‚å¯¹äºç¼–ç¨‹æ–°æ‰‹æ¥è¯´ï¼Œç†è§£è¯ä¹¦å’ŒåŠ å¯†å¯èƒ½éœ€è¦ä¸€ç‚¹æ—¶é—´ï¼Œä½†æ˜¯åŸºç¡€æ¦‚å¿µç›¸å¯¹ç›´æ¥ï¼šç¡®ä¿é€šä¿¡åŒæ–¹èƒ½å¤Ÿæ­£ç¡®éªŒè¯å½¼æ­¤çš„èº«ä»½ï¼Œè¿™æ­£æ˜¯ <code>x509.checkHost</code> æ‰€å‚ä¸çš„å·¥ä½œã€‚</p><h3 id="x509-checkip-ip" tabindex="-1"><a class="header-anchor" href="#x509-checkip-ip"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509checkipip" target="_blank" rel="noopener noreferrer">x509.checkIP(ip)</a></span></a></h3><p><code>x509.checkIP(ip)</code> æ˜¯ Node.js æ¨¡å— <code>crypto</code> ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºæ£€æŸ¥æŒ‡å®šçš„ IP åœ°å€æ˜¯å¦ä¸è¯ä¹¦ä¸­çš„è®°å½•ç›¸åŒ¹é…ã€‚SSL/TLS ä½¿ç”¨ X.509 è¯ä¹¦æ¥éªŒè¯æœåŠ¡çš„èº«ä»½ã€‚è¿™äº›è¯ä¹¦å¯ä»¥åŒ…å«ä¸€ç³»åˆ—çš„åŸŸåæˆ– IP åœ°å€ï¼Œè¿™äº›æ˜¯è¯ä¹¦é¢å‘ç»™çš„å®ä½“çš„åˆæ³•æ ‡è¯†ç¬¦ã€‚</p><p>å½“å®¢æˆ·ç«¯ï¼ˆæ¯”å¦‚ Web æµè§ˆå™¨ï¼‰è¿æ¥åˆ°ä¸€ä¸ªæœåŠ¡å™¨æ—¶ï¼Œå®ƒä¼šæ¥æ”¶æœåŠ¡å™¨çš„ X.509 è¯ä¹¦å¹¶æ£€æŸ¥æœåŠ¡å™¨çš„åŸŸåæˆ– IP æ˜¯å¦ä¸è¯ä¹¦ä¸­åˆ—å‡ºçš„åŒ¹é…ã€‚å¦‚æœä¸åŒ¹é…ï¼Œå®¢æˆ·ç«¯å¯èƒ½ä¼šè­¦å‘Šç”¨æˆ·å¯èƒ½é‡åˆ°äº†ä¸€ä¸ªâ€œä¸­é—´äººæ”»å‡»â€ï¼Œåœ¨æ­¤æƒ…å†µä¸‹ï¼Œå¦ä¸€ä¸ªæœåŠ¡å™¨å¯èƒ½åœ¨ä¼ªè£…æˆé¢„æœŸçš„æœåŠ¡å™¨ã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>x509.checkIP(ip)</code> è¿™ä¸ªæ–¹æ³•æ¥éªŒè¯è¯ä¹¦æ˜¯å¦è¢«æˆæƒç”¨äºç‰¹å®šçš„ IP åœ°å€ã€‚è¿™é‡Œçš„ <code>x509</code> æ˜¯ä¸€ä¸ªè¡¨ç¤ºè¯ä¹¦çš„å¯¹è±¡ï¼Œè€Œ <code>ip</code> å‚æ•°åº”è¯¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»£è¡¨ä½ è¦æ£€æŸ¥çš„ IP åœ°å€ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-x509-checkip-ip" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-x509-checkip-ip"><span>å¦‚ä½•ä½¿ç”¨ <code>x509.checkIP(ip)</code>ï¼š</span></a></h3><p>é¦–å…ˆï¼Œä½ éœ€è¦ä¸€ä¸ª X.509 è¯ä¹¦ã€‚å‡è®¾æˆ‘ä»¬å·²ç»æœ‰äº†è¯ä¹¦ï¼Œä¸”å°†å…¶è½½å…¥ä¸º x509 å¯¹è±¡ã€‚ç°åœ¨æˆ‘ä»¬è¦æ£€æŸ¥ç‰¹å®šçš„ IP åœ°å€æ˜¯å¦è¢«è¯ä¹¦å…è®¸ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ æœ‰è¯ä¹¦æ–‡ä»¶certificate.pem</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certPem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;certificate.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certPem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥ IP åœ°å€ &#39;192.168.1.1&#39; æ˜¯å¦æœ‰æ•ˆ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> isValid</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">checkIP</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;192.168.1.1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Is the IP address authorized for the given certificate?&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isValid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-1"><span>å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</span></a></h3><ol><li><p><strong>Web æœåŠ¡å™¨èº«ä»½éªŒè¯</strong><br> å¦‚æœä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªéœ€è¦éªŒè¯è¿æ¥åˆ°ä½ çš„æœåŠ¡å™¨çš„å…¶ä»–æœåŠ¡çš„èº«ä»½çš„ç¨‹åºï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>x509.checkIP()</code> æ¥ç¡®ä¿è¿™äº›æœåŠ¡æ˜¯é€šè¿‡æœ‰æ•ˆçš„è¯ä¹¦æˆæƒçš„ï¼Œå¹¶ä¸”ä»–ä»¬çš„ IP åœ°å€ä¸è¯ä¹¦æ‰€è¯´çš„ç›¸ç¬¦ã€‚</p></li><li><p><strong>å¾®æœåŠ¡æ¶æ„ä¸‹çš„æœåŠ¡é€šä¿¡</strong><br> åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œå¤šä¸ªæœåŠ¡ä¹‹é—´ä¼šé€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ã€‚åœ¨è¿™ç§åœºæ™¯ä¸­ï¼ŒæœåŠ¡å¯ä»¥ä½¿ç”¨è¯ä¹¦ç¡®ä¿ä»–ä»¬åªä¸åˆæ³•æœåŠ¡é€šä¿¡ã€‚åœ¨å»ºç«‹è¿æ¥å‰ï¼ŒæœåŠ¡å¯ä»¥ç”¨ <code>x509.checkIP()</code> æ–¹æ³•æ£€æŸ¥å¯¹æ–¹æœåŠ¡çš„ IP æ˜¯å¦åœ¨ SSL/TLS è¯ä¹¦ä¸­ã€‚</p></li><li><p><strong>IoT è®¾å¤‡è®¤è¯</strong><br> ç‰©è”ç½‘ (IoT) è®¾å¤‡å¸¸å¸¸éœ€è¦ä¸æœåŠ¡å™¨æˆ–å…¶ä»–è®¾å¤‡å®‰å…¨åœ°é€šä¿¡ã€‚è®¾å¤‡å¯ä»¥å¸¦æœ‰è¯ä¹¦ï¼Œä»¥æ­¤æ¥é‰´å®šè‡ªå·±ï¼Œå¹¶ä¸”æœåŠ¡å™¨å¯ä»¥ä½¿ç”¨ <code>x509.checkIP()</code> æ–¹æ³•æ¥ç¡®è®¤è®¾å¤‡çš„ IP åœ°å€æ˜¯å¦ä¸å®ƒçš„è¯ä¹¦ç›¸ç¬¦ï¼Œä»è€Œç¡®ä¿é€šä¿¡çš„å®‰å…¨æ€§ã€‚</p></li></ol><h3 id="x509-checkissued-othercert" tabindex="-1"><a class="header-anchor" href="#x509-checkissued-othercert"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509checkissuedothercert" target="_blank" rel="noopener noreferrer">x509.checkIssued(otherCert)</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒè®©ä½ å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ï¼Œæ‰§è¡Œå„ç§åå°ä»»åŠ¡æ¯”å¦‚æ–‡ä»¶æ“ä½œã€ç½‘ç»œé€šä¿¡ç­‰ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œå†…ç½®äº† <code>crypto</code> æ¨¡å—ï¼Œæä¾›äº†ä¸€ç³»åˆ—åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯¹ x509 è¯ä¹¦çš„æ“ä½œã€‚x509 è¯ä¹¦æ˜¯ä¸€ç§ç”¨æ¥éªŒè¯ç½‘ç»œä¸­æŸä¸ªå®ä½“ï¼ˆæ¯”å¦‚ä¸€ä¸ª web æœåŠ¡å™¨ï¼‰èº«ä»½çš„æ•°å­—è¯ä¹¦ï¼Œå®ƒéµå¾ªä¸€ç§æ ‡å‡†æ ¼å¼ï¼Œå¹¶ä¸”å¯ä»¥ç”±æƒå¨æœºæ„ç­¾å‘ã€‚</p><p>åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œ<code>x509.checkIssued(otherCert)</code> æ˜¯ <code>crypto</code> æ¨¡å—ä¸‹çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨ä»¥æ£€æŸ¥å½“å‰çš„ x509 è¯ä¹¦æ˜¯å¦ç”±å¦ä¸€ä¸ªæŒ‡å®šçš„è¯ä¹¦ï¼ˆotherCert ä½œä¸ºå‚æ•°ä¼ é€’ï¼‰ç­¾å‘ã€‚å¦‚æœä¸€ä¸ªè¯ä¹¦æ˜¯ç”±å¦ä¸€ä¸ªè¯ä¹¦ç­¾å‘çš„ï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªè¯ä¹¦è¢«ç§°ä½œ &quot;å‘è¡Œè€…&quot;ï¼ˆissuerï¼‰ï¼Œè€Œç¬¬ä¸€ä¸ªåˆ™æ˜¯ &quot;è¢«ç­¾å‘è€…&quot;ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-1"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦å¤„ç† SSL/TLS å®‰å…¨é€šä¿¡çš„åº”ç”¨ã€‚ä½ æ‹¥æœ‰ä¸¤ä¸ªè¯ä¹¦ï¼šä¸€ä¸ªæ˜¯ä½ çš„æœåŠ¡å™¨è¯ä¹¦ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸º <code>serverCert</code>ï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯ç”¨æ¥ç­¾å‘ä½ æœåŠ¡å™¨è¯ä¹¦çš„ CAï¼ˆè¯ä¹¦æˆæƒä¸­å¿ƒï¼‰çš„è¯ä¹¦ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸º <code>caCert</code>ï¼‰ã€‚ä½ æƒ³è¦éªŒè¯ <code>serverCert</code> æ˜¯å¦çœŸçš„æ˜¯ç”± <code>caCert</code> ç­¾å‘çš„ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œä½ å¯èƒ½ä¼šè¿™æ ·ä½¿ç”¨ <code>x509.checkIssued</code>:</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ å·²ç»æœ‰äº†ä¸¤ä¸ªè¯ä¹¦æ–‡ä»¶ï¼šserver.crtå’Œca.crt</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> serverCert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">x509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fromPEM</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;server.crt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> caCert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">x509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fromPEM</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ca.crt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨checkIssuedæ–¹æ³•æ¥æ£€æŸ¥serverCertæ˜¯å¦æ˜¯ç”±caCertç­¾å‘</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">serverCert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">checkIssued</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">caCert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;serverCert æ˜¯ç”± caCert ç­¾å‘çš„ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;serverCert ä¸æ˜¯ç”± caCert ç­¾å‘çš„ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>é¦–å…ˆï¼Œæˆ‘ä»¬å¼•å…¥äº† <code>crypto</code> å’Œ <code>fs</code> æ¨¡å—ã€‚</li><li>ç„¶åï¼Œæˆ‘ä»¬ä»æ–‡ä»¶ç³»ç»Ÿè¯»å–ä¸¤ä¸ªè¯ä¹¦æ–‡ä»¶ï¼Œå¹¶å°†å®ƒä»¬è½¬æ¢æˆ x509 è¯ä¹¦å¯¹è±¡ã€‚</li><li>æ¥ç€ï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨ <code>serverCert.checkIssued(caCert)</code> æ¥æ£€æŸ¥ <code>serverCert</code> æ˜¯å¦è¢« <code>caCert</code> ç­¾å‘ã€‚</li><li>æœ€åï¼Œæˆ‘ä»¬æ‰“å°å‡ºéªŒè¯ç»“æœã€‚</li></ol><p>æ³¨æ„ï¼š</p><ul><li>åœ¨ä½ çš„å®é™…åº”ç”¨ä¸­ï¼Œè¯ä¹¦æ–‡ä»¶è·¯å¾„åº”è¯¥æ ¹æ®ä½ çš„æ–‡ä»¶ç³»ç»Ÿå®é™…æƒ…å†µæ¥è®¾ç½®ã€‚</li><li>å½“å¤„ç†è¯ä¹¦æ—¶ï¼Œé”™è¯¯å¤„ç†éå¸¸é‡è¦ã€‚åœ¨å®é™…ç”Ÿäº§ä»£ç ä¸­ï¼Œä½ åº”è¯¥æ·»åŠ é€‚å½“çš„é”™è¯¯å¤„ç†é€»è¾‘æ¥ç¡®ä¿ç¨‹åºçš„é²æ£’æ€§ã€‚</li></ul><p>è¿™ä¸ªæ–¹æ³•çš„ä¸»è¦ç”¨é€”å°±æ˜¯åœ¨æ¶‰åŠåˆ°è¯ä¹¦é“¾çš„éªŒè¯è¿‡ç¨‹ä¸­ï¼Œç¡®å®šè¯ä¹¦é—´çš„ç­¾å‘å…³ç³»ã€‚è¿™åœ¨å»ºç«‹ SSL/TLS è¿æ¥ä»¥åŠå…¶ä»–éœ€è¦è¯ä¹¦è®¤è¯çš„å®‰å…¨é€šè®¯ä¸­æ˜¯éå¸¸å¸¸è§çš„æ­¥éª¤ã€‚</p><h3 id="x509-checkprivatekey-privatekey" tabindex="-1"><a class="header-anchor" href="#x509-checkprivatekey-privatekey"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509checkprivatekeyprivatekey" target="_blank" rel="noopener noreferrer">x509.checkPrivateKey(privateKey)</a></span></a></h3><p><code>x509.checkPrivateKey(privateKey)</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—çš„ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ç”¨æ¥æ£€æŸ¥æä¾›çš„ç§é’¥æ˜¯å¦è·Ÿ X.509 è¯ä¹¦ä¸­çš„å…¬é’¥åŒ¹é…ã€‚X.509 æ˜¯ä¸€ç§éå¸¸æ™®éçš„æ•°å­—è¯ä¹¦æ ‡å‡†ï¼Œå®ƒç”¨äºåœ¨ç½‘ç»œä¸­å»ºç«‹èº«ä»½è®¤è¯ã€‚</p><p>ç°åœ¨æˆ‘å°†ç®€è¦ä»‹ç»ç§é’¥ã€å…¬é’¥å’Œæ•°å­—è¯ä¹¦ä¹‹é—´çš„å…³ç³»ï¼Œç„¶åè§£é‡Š <code>x509.checkPrivateKey(privateKey)</code> çš„å·¥ä½œåŸç†åŠå…¶ä½¿ç”¨åœºæ™¯ã€‚</p><h3 id="å…¬é’¥å’Œç§é’¥" tabindex="-1"><a class="header-anchor" href="#å…¬é’¥å’Œç§é’¥"><span>å…¬é’¥å’Œç§é’¥</span></a></h3><p>åœ¨éå¯¹ç§°åŠ å¯†ä¸­ï¼Œæœ‰ä¸¤ç§å¯†é’¥ï¼šå…¬é’¥å’Œç§é’¥ã€‚å®ƒä»¬æ˜¯æˆå¯¹å‡ºç°çš„ï¼Œå…¬é’¥å¯ä»¥ä¸ä»»ä½•äººåˆ†äº«ï¼Œè€Œç§é’¥å¿…é¡»ä¿å¯†ã€‚</p><ul><li>å…¬é’¥ï¼šç”¨äºåŠ å¯†æ•°æ®æˆ–éªŒè¯ç­¾åï¼Œå¯ä»¥å…¬å¼€ã€‚</li><li>ç§é’¥ï¼šç”¨äºè§£å¯†æ•°æ®æˆ–ç”Ÿæˆç­¾åï¼Œå¿…é¡»ä¿å¯†ã€‚</li></ul><h3 id="æ•°å­—è¯ä¹¦" tabindex="-1"><a class="header-anchor" href="#æ•°å­—è¯ä¹¦"><span>æ•°å­—è¯ä¹¦</span></a></h3><p>æ•°å­—è¯ä¹¦é€šå¸¸åŒ…å«äº†è¯ä¹¦æ‰€æœ‰è€…çš„å…¬é’¥å’Œä¸€äº›å…¶ä»–ä¿¡æ¯ï¼ˆå¦‚èº«ä»½ä¿¡æ¯ï¼‰ï¼Œè¿™äº›ä¿¡æ¯ç»è¿‡ä¸€ä¸ªå«åšè¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰çš„å¯ä¿¡ç¬¬ä¸‰æ–¹çš„æ•°å­—ç­¾åç¡®è®¤ã€‚</p><h3 id="x509-checkprivatekey-privatekey-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#x509-checkprivatekey-privatekey-æ–¹æ³•"><span>x509.checkPrivateKey(privateKey) æ–¹æ³•</span></a></h3><p>æ­¤æ–¹æ³•ç”¨äºéªŒè¯ä¸€ä¸ªç§é’¥æ˜¯å¦ä¸ç‰¹å®šçš„ X.509 è¯ä¹¦ç›¸å¯¹åº”ã€‚å½“ä½ æ‹¥æœ‰ä¸€ä¸ª X.509 è¯ä¹¦æ—¶ï¼Œä½ å¯èƒ½éœ€è¦ç¡®ä¿æ‹¥æœ‰æ­£ç¡®çš„ç§é’¥æ¥é…å¯¹è¯¥è¯ä¹¦ï¼Œå› ä¸ºåªæœ‰æ­£ç¡®çš„ç§é’¥æ‰èƒ½æœ‰æ•ˆåœ°è¿›è¡ŒåŠ å¯†å’Œè§£å¯†æ“ä½œã€‚å¦‚æœç§é’¥ä¸åŒ¹é…ï¼Œä»»ä½•åŸºäºè¯ä¹¦çš„åŠ å¯†é€šè®¯éƒ½ä¼šå¤±è´¥ã€‚</p><h3 id="ä½¿ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹"><span>ä½¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ ä»ä¸€ä¸ªè¯ä¹¦é¢å‘æœºæ„å¾—åˆ°äº†ä¸€ä¸ª X.509 è¯ä¹¦ï¼Œå¹¶ä¸”ä½ ä¹Ÿæœ‰ä¸€ä¸ªç§é’¥ã€‚ä½ æƒ³ç¡®è®¤è¿™ä¸ªç§é’¥æ˜¯å¦çœŸçš„åŒ¹é…ä½ çš„è¯ä¹¦ã€‚åœ¨ Node.js çš„ä»£ç ä¸­ï¼Œä½ å¯èƒ½ä¼šè¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯»å–è¯ä¹¦å’Œç§é’¥æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certContent</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path/to/certificate.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> privateKeyContent</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path/to/privateKey.key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»è¯ä¹¦å†…å®¹åˆ›å»ºX509å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certContent</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ£€æŸ¥ç§é’¥æ˜¯å¦åŒ¹é…</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> isMatch</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">checkPrivateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKeyContent</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isMatch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç§é’¥åŒ¹é…ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç§é’¥ä¸åŒ¹é…ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ£€æŸ¥è¿‡ç¨‹ä¸­å‡ºé”™ï¼š&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨ <code>fs.readFileSync</code> æ–¹æ³•è¯»å–äº†è¯ä¹¦æ–‡ä»¶å’Œç§é’¥æ–‡ä»¶çš„å†…å®¹ã€‚ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨ <code>crypto.X509Certificate</code> æ„é€ å‡½æ•°å¹¶ä¼ å…¥è¯ä¹¦å†…å®¹æ¥åˆ›å»ºä¸€ä¸ª <code>X509Certificate</code> å¯¹è±¡ã€‚æœ€åï¼Œæˆ‘ä»¬è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„ <code>checkPrivateKey</code> æ–¹æ³•ï¼Œä¼ å…¥ç§é’¥å†…å®¹æ¥æ£€æŸ¥ç§é’¥æ˜¯å¦åŒ¹é…ã€‚</p><p>å¦‚æœç§é’¥åŒ¹é…ï¼Œ<code>checkPrivateKey</code> æ–¹æ³•è¿”å› <code>true</code>ï¼›å¦‚æœä¸åŒ¹é…ï¼Œè¿”å› <code>false</code>ã€‚å¦‚æœåœ¨æ£€æŸ¥è¿‡ç¨‹ä¸­é‡åˆ°ä»»ä½•é”™è¯¯ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœè¯ä¹¦æ ¼å¼ä¸æ­£ç¡®æˆ–æ— æ³•è¯»å–ç§é’¥ï¼‰ï¼Œåˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<code>x509.checkPrivateKey(privateKey)</code> æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ–¹æ³•ï¼Œå½“ä½ éœ€è¦éªŒè¯ç§é’¥æ˜¯å¦å¯¹åº”ç»™å®šçš„ X.509 è¯ä¹¦æ—¶å¯ä»¥ä½¿ç”¨å®ƒï¼Œè¿™å¯¹äºç»´æŠ¤å®‰å…¨çš„é€šä¿¡å’Œèº«ä»½éªŒè¯æµç¨‹è‡³å…³é‡è¦ã€‚</p><h3 id="x509-fingerprint" tabindex="-1"><a class="header-anchor" href="#x509-fingerprint"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509fingerprint" target="_blank" rel="noopener noreferrer">x509.fingerprint</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>x509.fingerprint</code>æ˜¯ä¸€ä¸ªä¸å®‰å…¨ç›¸å…³çš„åŠŸèƒ½ï¼Œå®ƒå±äº Node.js çš„<code>crypto</code>æ¨¡å—ã€‚è¿™ä¸ªåŠŸèƒ½ç”¨äºè·å– X.509 è¯ä¹¦çš„æŒ‡çº¹ã€‚X.509 è¯ä¹¦æ˜¯ä¸€ç§å¹¿æ³›åº”ç”¨äºäº’è”ç½‘å®‰å…¨çš„æ•°å­—è¯ä¹¦ï¼Œä¾‹å¦‚ç”¨äº HTTPS çš„ SSL/TLS è¯ä¹¦å°±æ˜¯ X.509 è¯ä¹¦ã€‚</p><p>è¯ä¹¦çš„æŒ‡çº¹æ˜¯ä¸€ä¸ªå“ˆå¸Œå€¼ï¼Œé€šå¸¸æ˜¯å¯¹è¯ä¹¦çš„å†…å®¹ä½¿ç”¨ç‰¹å®šçš„å“ˆå¸Œå‡½æ•°ï¼ˆå¦‚ SHA-1, SHA-256 ç­‰ï¼‰è®¡ç®—å‡ºæ¥çš„æ‘˜è¦ä¿¡æ¯ã€‚è¿™ä¸ªæŒ‡çº¹å¯ä»¥ç”¨æ¥å”¯ä¸€æ ‡è¯†ä¸€ä¸ªè¯ä¹¦ï¼Œå½“ä½ éœ€è¦éªŒè¯è¯ä¹¦çš„çœŸå®æ€§æ—¶ï¼Œæ¯”å¯¹æŒ‡çº¹æ˜¯ä¸€ç§å¿«é€Ÿè€Œæœ‰æ•ˆçš„æ–¹æ³•ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹<code>x509.fingerprint</code>åœ¨ Node.js v21.7.1 ä¸­æ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦äº†è§£çš„æ˜¯ï¼Œä¸ºäº†ä½¿ç”¨<code>crypto</code>æ¨¡å—çš„ä»»ä½•åŠŸèƒ½ï¼Œä½ å¿…é¡»å…ˆå¯¼å…¥å®ƒï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç„¶åï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ª X.509 è¯ä¹¦ï¼Œå¹¶ä¸”éœ€è¦è·å–å®ƒçš„æŒ‡çº¹ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p><ol><li>è¯»å–è¯ä¹¦æ–‡ä»¶ã€‚</li><li>ä½¿ç”¨<code>x509.fingerprint</code>åŠŸèƒ½è·å–æŒ‡çº¹ã€‚</li></ol><p>å®é™…çš„ä»£ç å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥æ‰€éœ€æ¨¡å—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯»å–è¯ä¹¦æ–‡ä»¶ï¼Œå‡è®¾è¯ä¹¦æ–‡ä»¶åä¸º&#39;mycert.pem&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certPem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;mycert.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªX509Certificateå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certPem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–è¯ä¹¦æŒ‡çº¹ï¼Œé»˜è®¤ä¼šä½¿ç”¨SHA-1ç®—æ³•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fingerprint</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fingerprint</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è¯ä¹¦æŒ‡çº¹æ˜¯: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fingerprint</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡<code>readFileSync</code>è¯»å–äº†è¯ä¹¦æ–‡ä»¶<code>mycert.pem</code>çš„å†…å®¹ã€‚ç„¶ååˆ›å»ºäº†ä¸€ä¸ª<code>X509Certificate</code>å¯¹è±¡ï¼Œæœ€åé€šè¿‡è¯¥å¯¹è±¡çš„<code>fingerprint</code>å±æ€§ï¼Œå¾—åˆ°äº†è¯ä¹¦çš„æŒ‡çº¹å¹¶æ‰“å°å‡ºæ¥ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæŒ‡çº¹çš„å“ˆå¸Œç®—æ³•å¯ä»¥æ›´æ”¹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³è¦ä½¿ç”¨ SHA-256 ç®—æ³•ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fingerprint256</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fingerprint</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¯ä¹¦æŒ‡çº¹å¯ä»¥ç”¨äºå¤šç§åœºæ™¯ï¼Œæ¯”å¦‚ï¼š</p><ul><li>éªŒè¯ä¸‹è½½çš„è½¯ä»¶åŒ…çš„è¯ä¹¦æ˜¯å¦æ­£ç¡®ï¼Œä»¥ç¡®ä¿è½¯ä»¶åŒ…æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚</li><li>åœ¨å»ºç«‹ TLS è¿æ¥æ—¶ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡æ¯”å¯¹æœåŠ¡å™¨æä¾›çš„è¯ä¹¦æŒ‡çº¹æ¥éªŒè¯æœåŠ¡å™¨çš„èº«ä»½ã€‚</li><li>åœ¨è‡ªåŠ¨åŒ–çš„è„šæœ¬ä¸­ï¼Œå¯ä»¥ä½¿ç”¨è¯ä¹¦æŒ‡çº¹æ¥å¿«é€Ÿç¡®è®¤è¿œç¨‹æœåŠ¡çš„è¯ä¹¦æ˜¯å¦ä¸ºé¢„æœŸçš„è¯ä¹¦ã€‚</li></ul><p>æ€»è€Œè¨€ä¹‹ï¼Œ<code>x509.fingerprint</code>æ˜¯å¤„ç†å’Œæ ¡éªŒ X.509 è¯ä¹¦å®‰å…¨æ€§çš„é‡è¦å·¥å…·ï¼Œåœ¨ Node.js ä¸­ï¼Œé€šè¿‡å‡ è¡Œç®€å•çš„ä»£ç å°±èƒ½å¤Ÿå®ç°è¯ä¹¦æŒ‡çº¹çš„è·å–å’Œä½¿ç”¨ã€‚</p><h3 id="x509-fingerprint256" tabindex="-1"><a class="header-anchor" href="#x509-fingerprint256"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509fingerprint256" target="_blank" rel="noopener noreferrer">x509.fingerprint256</a></span></a></h3><p><code>x509.fingerprint256</code>æ˜¯ Node.js ä¸­<code>crypto</code>æ¨¡å—çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œç”¨äºè·å– X.509 è¯ä¹¦çš„ SHA-256 æŒ‡çº¹ã€‚X.509 è¯ä¹¦æ˜¯ä¸€ç§å¸¸è§çš„ç”µå­æ–‡ä»¶ï¼Œå®ƒä½¿ç”¨å…¬é’¥åŸºç¡€è®¾æ–½ï¼ˆPKIï¼‰æ¥æ ‡è¯†ç½‘ç»œä¸­çš„å®ä½“ï¼ˆä¾‹å¦‚ï¼ŒæœåŠ¡å™¨ã€å®¢æˆ·ç«¯æˆ–ä¸ªäººï¼‰ã€‚è¯ä¹¦åŒ…å«æŒæœ‰è€…çš„ä¿¡æ¯å’Œä¸€ä¸ªå…¬é’¥ï¼Œä»¥åŠç”±è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰ç­¾åçš„æ•°å­—ç­¾åï¼Œä»¥ç¡®ä¿å…¶çœŸå®æ€§ã€‚</p><p>æŒ‡çº¹æ˜¯å¯¹è¯ä¹¦å†…å®¹ï¼ˆä¸åŒ…æ‹¬ç­¾åæœ¬èº«ï¼‰è¿›è¡Œå“ˆå¸Œè®¡ç®—åå¾—åˆ°çš„ä¸€ä¸²å›ºå®šé•¿åº¦çš„æ•°å­—æ‘˜è¦ã€‚é€šå¸¸ä½¿ç”¨ SHA-256 å“ˆå¸Œç®—æ³•ç”Ÿæˆè¿™ä¸ªæŒ‡çº¹ã€‚å› ä¸ºå“ˆå¸Œå‡½æ•°çš„ç‰¹æ€§æ˜¯å³ä¾¿è¾“å…¥æ•°æ®åªæœ‰å¾®å°å˜åŠ¨ï¼Œè¾“å‡ºçš„å“ˆå¸Œå€¼ä¹Ÿä¼šå®Œå…¨ä¸åŒï¼Œæ‰€ä»¥æŒ‡çº¹å¯ä»¥ç”¨ä½œæ ¡éªŒè¯ä¹¦å†…å®¹æ˜¯å¦è¢«ç¯¡æ”¹çš„å¿«é€Ÿæ–¹å¼ï¼Œä»¥åŠåœ¨ä¸éœ€è¦æŸ¥çœ‹è¯ä¹¦å…¨éƒ¨å†…å®¹çš„æƒ…å†µä¸‹åŒºåˆ†å’Œè¯†åˆ«è¯ä¹¦ã€‚</p><p>ç°åœ¨æˆ‘å°†é€šè¿‡ä¸€ä¸ªä¾‹å­è®©ä½ ç†è§£å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨<code>x509.fingerprint256</code>ï¼š</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å‡è®¾ä½ å·²ç»æœ‰äº†ä¸€ä¸ª X.509 è¯ä¹¦æ–‡ä»¶ï¼Œæˆ‘ä»¬å°†å…¶ä¿å­˜ä¸º<code>certificate.pem</code>ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ª Node.js è„šæœ¬çš„ç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•è¯»å–è¿™ä¸ªè¯ä¹¦æ–‡ä»¶å¹¶è·å–å…¶ SHA-256 æŒ‡çº¹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¯»å–è¯ä¹¦æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certPem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;certificate.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºX509Certificateå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certPem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–è¯ä¹¦çš„SHA-256æŒ‡çº¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fingerprint</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fingerprint256</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`SHA-256 Fingerprint of the certificate: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fingerprint</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç åšäº†ä»¥ä¸‹å‡ ä»¶äº‹æƒ…ï¼š</p><ol><li>å¯¼å…¥äº† Node.js å†…ç½®çš„<code>crypto</code>å’Œ<code>fs</code>æ¨¡å—ã€‚</li><li>ä½¿ç”¨<code>fs.readFileSync</code>æ–¹æ³•åŒæ­¥åœ°ä»æ–‡ä»¶ç³»ç»Ÿè¯»å–äº†è¯ä¹¦æ–‡ä»¶<code>certificate.pem</code>ï¼Œå¹¶å°†å…¶å†…å®¹å­˜å‚¨åœ¨å˜é‡<code>certPem</code>ä¸­ã€‚</li><li>åˆ©ç”¨<code>crypto.X509Certificate</code>ç±»åˆ›å»ºäº†ä¸€ä¸ªè¡¨ç¤ºè¯¥è¯ä¹¦çš„å¯¹è±¡ã€‚</li><li>è¿™ä¸ªå¯¹è±¡æœ‰ä¸€ä¸ªå±æ€§<code>fingerprint256</code>ï¼Œå®ƒå°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„ SHA-256 æŒ‡çº¹ã€‚</li><li>æœ€åï¼Œæˆ‘ä»¬å°†æŒ‡çº¹æ‰“å°åˆ°æ§åˆ¶å°ä¸Šã€‚</li></ol><p>å®é™…åº”ç”¨ä¸­ï¼Œè¿™æ ·çš„æŒ‡çº¹å¯ç”¨äºå¤šç§åœºæ™¯ï¼Œæ¯”å¦‚ï¼š</p><ul><li>ç³»ç»Ÿç®¡ç†å‘˜å¯èƒ½ä¼šåœ¨éƒ¨ç½²æ–°è¯ä¹¦å‰éªŒè¯å…¶æŒ‡çº¹ï¼Œä»¥ç¡®ä¿å®ƒä»¬æ˜¯ä»åˆæ³•æ¥æºè·å¾—çš„ã€‚</li><li>åœ¨è‡ªåŠ¨åŒ–è„šæœ¬ä¸­ï¼Œå¯èƒ½ä¼šç”¨æŒ‡çº¹æ¥æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦ä½¿ç”¨äº†ç‰¹å®šçš„è¯ä¹¦ã€‚</li><li>å®¢æˆ·ç«¯è½¯ä»¶å¯èƒ½ä¼šä½¿ç”¨é¢„ç¼–ç çš„æŒ‡çº¹æ¥éªŒè¯æœåŠ¡å™¨çš„èº«ä»½ï¼Œç¡®ä¿è¿æ¥å®‰å…¨ã€‚</li></ul><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ°<code>x509.fingerprint256</code>åœ¨å®é™…å¼€å‘å’Œç»´æŠ¤å®‰å…¨é€šä¿¡ä¸­æ˜¯éå¸¸æœ‰ç”¨çš„å·¥å…·ã€‚</p><h3 id="x509-fingerprint512" tabindex="-1"><a class="header-anchor" href="#x509-fingerprint512"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509fingerprint512" target="_blank" rel="noopener noreferrer">x509.fingerprint512</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>x509.fingerprint512</code>æ˜¯æŒ‡ X.509 è¯ä¹¦çš„ SHA-512 æŒ‡çº¹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹å‡ ä¸ªå…³é”®çš„æ¦‚å¿µã€‚</p><h3 id="x-509-è¯ä¹¦" tabindex="-1"><a class="header-anchor" href="#x-509-è¯ä¹¦"><span>X.509 è¯ä¹¦</span></a></h3><p>X.509 æ˜¯ä¸€ç§éå¸¸æ™®éçš„æ•°å­—è¯ä¹¦æ ‡å‡†ï¼Œå®ƒè¢«ç”¨äºäº’è”ç½‘ä¸Šä¸ºç½‘ç«™å’ŒæœåŠ¡å™¨èº«ä»½æä¾›è®¤è¯ã€‚å½“ä½ è®¿é—®ä¸€ä¸ª HTTPS ç½‘ç«™æ—¶ï¼Œè¯¥ç½‘ç«™ä¼šå‘ä½ çš„æµè§ˆå™¨æä¾›ä¸€ä¸ª X.509 è¯ä¹¦ï¼Œä»¥è¯æ˜å®ƒæ˜¯åˆæ³•çš„ã€‚</p><h3 id="æŒ‡çº¹-fingerprint" tabindex="-1"><a class="header-anchor" href="#æŒ‡çº¹-fingerprint"><span>æŒ‡çº¹ï¼ˆFingerprintï¼‰</span></a></h3><p>æŒ‡çº¹æ˜¯ä¸€ç§é€šè¿‡å°†æ•´ä¸ªè¯ä¹¦å†…å®¹è¿è¡Œé€šè¿‡å“ˆå¸Œå‡½æ•°ç”Ÿæˆçš„çŸ­å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç”¨äºå¿«é€Ÿæ¯”è¾ƒè¯ä¹¦æ˜¯å¦ç›¸åŒæˆ–éªŒè¯è¯ä¹¦çš„çœŸä¼ªã€‚å› ä¸ºå³ä½¿æ˜¯å¾ˆå°çš„æ”¹å˜ä¹Ÿä¼šå¯¼è‡´å®Œå…¨ä¸åŒçš„å“ˆå¸Œå€¼ï¼Œæ‰€ä»¥æŒ‡çº¹èƒ½æœ‰æ•ˆåœ°è¡¨ç¤ºè¯ä¹¦çš„å”¯ä¸€æ€§ã€‚</p><h3 id="sha-512" tabindex="-1"><a class="header-anchor" href="#sha-512"><span>SHA-512</span></a></h3><h3 id="x509-infoaccess" tabindex="-1"><a class="header-anchor" href="#x509-infoaccess"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509infoaccess" target="_blank" rel="noopener noreferrer">x509.infoAccess</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>x509.infoAccess</code> æ˜¯ä¸€ä¸ªå…³äºè¯ä¹¦é€æ˜åº¦å’Œè·¯å¾„çš„éƒ¨åˆ†ï¼Œå®ƒæä¾›äº†å¯¹ X.509 è¯ä¹¦æ‰©å±•ä¿¡æ¯çš„è®¿é—®ã€‚X.509 æ˜¯ä¸€ç§éå¸¸æ™®éçš„æ•°å­—è¯ä¹¦æ ¼å¼ï¼Œç”¨æ¥æ ‡å‡†åŒ–äº’è”ç½‘ä¸Šå®ä½“ï¼ˆæ¯”å¦‚ä¸ªäººã€æœåŠ¡å™¨æˆ–ç»„ç»‡ï¼‰çš„èº«ä»½éªŒè¯ã€‚</p><p>åœ¨ X.509 è¯ä¹¦ä¸­ï¼Œæœ‰å¾ˆå¤šä¸åŒçš„æ‰©å±•å­—æ®µå¯ä»¥æä¾›é¢å¤–çš„ä¿¡æ¯å…³äºè¯ä¹¦çš„ä½¿ç”¨å’Œå±æ€§ã€‚<code>infoAccess</code> æ˜¯è¿™äº›æ‰©å±•ä¹‹ä¸€ï¼Œä¸»è¦ç”¨æ¥æè¿°å¦‚ä½•è·å–è¯ä¹¦ç›¸å…³çš„ä¿¡æ¯ï¼Œè¿™åŒ…æ‹¬åœ¨çº¿è¯ä¹¦çŠ¶æ€åè®® (OCSP) çš„æœåŠ¡ç«¯ç‚¹åœ°å€ä»¥åŠè¯ä¹¦é¢å‘è€…çš„ URLã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœä½ æ­£åœ¨ä¸ä¸€ä¸ªç½‘ç«™é€šä¿¡ï¼Œå¹¶ä¸”æƒ³è¦ç¡®è®¤å®ƒçš„ SSL/TLS è¯ä¹¦æ˜¯æœ‰æ•ˆçš„ï¼Œä½ çš„æµè§ˆå™¨å¯èƒ½ä¼šä½¿ç”¨å­˜å‚¨åœ¨ <code>infoAccess</code> æ‰©å±•ä¸­çš„ OCSP åœ°å€æ¥æ£€æŸ¥è¯ä¹¦çš„åŠé”€çŠ¶æ€ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œå¦‚æœä½ ä½¿ç”¨çš„ Node.js åŒ…å« crypto æ¨¡å—ï¼Œé‚£ä½ å¯ä»¥é€šè¿‡è¿™ä¸ªæ¨¡å—ä¸­çš„å‡½æ•°æ¥è¯»å–å’Œè§£æ X.509 è¯ä¹¦ä¸­çš„ä¿¡æ¯ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨ <code>x509.infoAccess</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">x509</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º &#39;mycert.pem&#39; çš„è¯ä¹¦æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certPem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;mycert.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ x509 ç±»åˆ›å»ºä¸€ä¸ªè¯ä¹¦å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> x509</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certPem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å– infoAccess ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> infoAccess</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">infoAccess</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// infoAccess æ˜¯ä¸€ä¸ªé”®/å€¼å¯¹çš„é›†åˆ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">accessMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">accessLocation</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">of</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Object</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">infoAccess</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è®¿é—®æ–¹æ³•: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">accessMethod</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è®¿é—®ä½ç½®: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">accessLocation</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä»æ–‡ä»¶ç³»ç»Ÿä¸­è¯»å–äº†ä¸€ä¸ªåä¸º &#39;mycert.pem&#39; çš„è¯ä¹¦æ–‡ä»¶ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ©ç”¨ Node.js çš„ <code>crypto</code> æ¨¡å—åˆ›å»ºäº†ä¸€ä¸ª X509Certificate å¯¹è±¡ã€‚åœ¨è¿™ä¸ªå¯¹è±¡ä¸Šè°ƒç”¨ <code>.infoAccess</code> å±æ€§ï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªåŒ…å«äº†æ‰€æœ‰ä¿¡æ¯è®¿é—®æ–¹æ³•å’Œä½ç½®çš„å¯¹è±¡ã€‚æœ€åï¼Œæˆ‘ä»¬éå†å¹¶æ‰“å°å‡ºæ¯ä¸€ç§è®¿é—®æ–¹æ³•å’Œç›¸åº”çš„ä½ç½®ã€‚</p><p>å¯èƒ½è¾“å‡ºçš„ä¾‹å­ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>è®¿é—®æ–¹æ³•: ocsp</span></span>
<span class="line"><span>è®¿é—®ä½ç½®: http://ocsp.example.com</span></span>
<span class="line"><span></span></span>
<span class="line"><span>è®¿é—®æ–¹æ³•: caIssuers</span></span>
<span class="line"><span>è®¿é—®ä½ç½®: http://example.com/cacert.pem</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¯ä¹¦æŒ‡å®šäº†ä¸¤ç§ä¿¡æ¯è®¿é—®æ–¹å¼ï¼šOCSP å’Œ CA å‘è¡Œè€…ã€‚OCSP ç”¨äºåœ¨çº¿è¯ä¹¦çŠ¶æ€åè®®ï¼Œè€Œ CA å‘è¡Œè€…æä¾›äº†è¯ä¹¦é¢å‘æœºæ„ç­¾å‘çš„è¯ä¹¦çš„ä¸‹è½½åœ°å€ã€‚</p><h3 id="x509-issuer" tabindex="-1"><a class="header-anchor" href="#x509-issuer"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509issuer" target="_blank" rel="noopener noreferrer">x509.issuer</a></span></a></h3><p>Node.js ä¸­çš„ <code>x509.issuer</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå®ƒå±äº X509Certificate ç±»ã€‚åœ¨ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸‹ï¼ŒX509Certificate ç±»ç”¨æ¥è¡¨ç¤ºä¸€ä¸ª X.509 è¯ä¹¦ã€‚X.509 æ˜¯ä¸€ç§éå¸¸æ™®éçš„æ•°å­—è¯ä¹¦æ ‡å‡†ï¼Œç”¨äºå»ºç«‹ç½‘ç»œå®ä½“ï¼ˆå¦‚ä¸ªäººã€å…¬å¸æˆ–è®¾å¤‡ï¼‰çš„èº«ä»½ã€‚</p><p>å½“ä½ æ‹¿åˆ°ä¸€ä¸ª X509Certificate å®ä¾‹æ—¶ï¼Œé€šè¿‡è®¿é—®å…¶ <code>issuer</code> å±æ€§ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº†è¯ä¹¦é¢å‘è€…ï¼ˆIssuerï¼‰çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ¯”å¦‚å›½å®¶ã€ç»„ç»‡å’Œå¸¸è§åç§°ç­‰ã€‚è¯ä¹¦é¢å‘è€…æ˜¯æŒ‡é‚£ä¸ªç­¾å‘å¹¶éªŒè¯è¯ä¹¦æŒæœ‰è€…èº«ä»½çš„æƒå¨æœºæ„ã€‚</p><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™ä¸ªåŠŸèƒ½é€šå¸¸ç”¨äºä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p><ol><li><p><strong>å®‰å…¨é€šä¿¡</strong>ï¼šåœ¨ HTTPS å’Œ TLS é€šä¿¡ä¸­ï¼ŒæœåŠ¡å™¨ä¼šæä¾›ä¸€ä¸ª X.509 è¯ä¹¦æ¥è¯æ˜è‡ªå·±çš„èº«ä»½ã€‚å®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚æµè§ˆå™¨ï¼‰ä¼šæ£€æŸ¥è¿™ä¸ªè¯ä¹¦ï¼ŒåŒ…æ‹¬è°æ˜¯è¯ä¹¦çš„é¢å‘æœºæ„ï¼Œä»¥ç¡®ä¿å®ƒæ˜¯ç”±ä¸€ä¸ªå¯ä¿¡ä»»çš„è®¤è¯ä¸­å¿ƒé¢å‘çš„ã€‚</p></li><li><p><strong>èº«ä»½éªŒè¯</strong>ï¼šåœ¨å„ç§ç½‘ç»œåº”ç”¨ä¸­ï¼Œå¦‚ VPN æˆ–ç”µå­é‚®ä»¶æœåŠ¡ï¼Œéƒ½éœ€è¦ X.509 è¯ä¹¦æ¥éªŒè¯å‚ä¸é€šä¿¡åŒæ–¹çš„èº«ä»½ã€‚</p></li><li><p><strong>ä»£ç ç­¾å</strong>ï¼šå¼€å‘è€…ä¼šä½¿ç”¨ X.509 è¯ä¹¦å¯¹ä»–ä»¬çš„è½¯ä»¶è¿›è¡Œç­¾åï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡è¯ä¹¦é¢å‘è€…çš„ä¿¡æ¯æ¥éªŒè¯è¯¥è½¯ä»¶æ˜¯å¦æ¥è‡ªå¯é æ¥æºã€‚</p></li></ol><p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥ç†è§£<code>x509.issuer</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ you have a file &#39;example-cert.pem&#39;ï¼Œé‡Œé¢å­˜ç€ä¸€ä¸ªX.509è¯ä¹¦</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certPem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example-cert.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certPem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Now we can access the issuer of the certificate.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> issuer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">issuer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">issuer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™å¯èƒ½è¾“å‡ºç±»ä¼¼è¿™æ ·çš„å¯¹è±¡ï¼š</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">//   C: &#39;US&#39;,                  // Country</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">//   ST: &#39;California&#39;,         // State</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">//   L: &#39;Mountain View&#39;,       // Locality</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">//   O: &#39;Example Inc.&#39;,        // Organization</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">//   OU: &#39;Example Trust Network&#39;,// Organizational Unit</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">//   CN: &#39;example.com&#39;         // Common Name</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† Node.js çš„ <code>crypto</code> å’Œ <code>fs</code> (æ–‡ä»¶ç³»ç»Ÿ)æ¨¡å—ã€‚ç„¶åæˆ‘ä»¬è¯»å–äº†ä¸€ä¸ªåŒ…å« X.509 è¯ä¹¦çš„æ–‡ä»¶ã€‚ä¹‹åæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª <code>X509Certificate</code> å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨å®ƒçš„ <code>issuer</code> å±æ€§æ¥è·å–è¯ä¹¦é¢å‘è€…çš„ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯ä»¥å¯¹è±¡çš„å½¢å¼å±•ç°ï¼Œå¹¶ä¸”åŒ…å«é¢å‘è€…çš„å›½å®¶ã€å·ã€åœ°åŒºã€ç»„ç»‡åç­‰ã€‚</p><h3 id="x509-issuercertificate" tabindex="-1"><a class="header-anchor" href="#x509-issuercertificate"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509issuercertificate" target="_blank" rel="noopener noreferrer">x509.issuerCertificate</a></span></a></h3><p>Node.js ä¸­çš„ <code>x509.issuerCertificate</code> å±æ€§æ˜¯å…³äºå¤„ç† X.509 æ•°å­—è¯ä¹¦çš„ä¸€ä¸ªåŠŸèƒ½ã€‚è®©æˆ‘ä»¬å…ˆç†è§£ä¸€äº›åŸºç¡€çŸ¥è¯†ï¼Œç„¶åå†æ·±å…¥è¿™ä¸ªå±æ€§ã€‚</p><h3 id="æ•°å­—è¯ä¹¦å’Œ-x-509" tabindex="-1"><a class="header-anchor" href="#æ•°å­—è¯ä¹¦å’Œ-x-509"><span>æ•°å­—è¯ä¹¦å’Œ X.509</span></a></h3><p>æ•°å­—è¯ä¹¦ç”¨æ¥éªŒè¯ä¸ªäººã€æœåŠ¡å™¨æˆ–è®¾å¤‡çš„èº«ä»½ï¼Œä»¥ç¡®ä¿äº¤æµåŒæ–¹æ˜¯å¯ä¿¡ä»»çš„ã€‚X.509 æ˜¯ä¸€ç§éå¸¸æµè¡Œçš„æ•°å­—è¯ä¹¦æ ‡å‡†ï¼Œå®ƒå®šä¹‰äº†è¯ä¹¦çš„æ ¼å¼ã€‚è¿™äº›è¯ä¹¦é€šå¸¸ç”¨äº HTTPS è¿æ¥ï¼ˆç½‘é¡µæµè§ˆå™¨ä¸æœåŠ¡å™¨ä¹‹é—´çš„å®‰å…¨è¿æ¥ï¼‰ã€‚</p><p>ä¸€ä¸ª X.509 è¯ä¹¦åŒ…å«äº†å¾ˆå¤šä¿¡æ¯ï¼Œæ¯”å¦‚ï¼š</p><ul><li>å…¬é’¥ï¼šç”¨äºåŠ å¯†æ•°æ®çš„å…¬å¼€ä¿¡æ¯ã€‚</li><li>ä¸»ä½“ï¼ˆSubjectï¼‰ï¼šè¯ä¹¦æ‰€æŒ‡çš„ä¸ªä½“ï¼Œæ¯”å¦‚ä¸€ä¸ªæœåŠ¡å™¨çš„åŸŸåã€‚</li><li>é¢å‘è€…ï¼ˆIssuerï¼‰ï¼šè¯ä¹¦çš„ç­¾å‘æœºæ„ï¼Œè´Ÿè´£éªŒè¯ä¸»ä½“çš„ä¿¡æ¯ã€‚</li></ul><h3 id="è¯ä¹¦é“¾" tabindex="-1"><a class="header-anchor" href="#è¯ä¹¦é“¾"><span>è¯ä¹¦é“¾</span></a></h3><p>å½“ä½ è®¿é—®ä¸€ä¸ªä½¿ç”¨ HTTPS çš„ç½‘ç«™æ—¶ï¼Œä½ çš„æµè§ˆå™¨ä¸ä»…éœ€è¦æ£€æŸ¥ç½‘ç«™çš„è¯ä¹¦ï¼Œè€Œä¸”è¿˜è¦æ£€æŸ¥ç­¾å‘è¯¥è¯ä¹¦çš„é¢å‘è€…çš„è¯ä¹¦ï¼Œä»¥åŠé¢å‘è€…è¯ä¹¦çš„é¢å‘è€…çš„è¯ä¹¦ï¼Œä¾æ­¤ç±»æ¨ã€‚è¿™å°±æ„æˆäº†ä¸€ä¸ªè¯ä¹¦é“¾ï¼Œç›´åˆ°è¾¾åˆ°ä¸€ä¸ªè¢«å¹¿æ³›ä¿¡ä»»çš„æ ¹è¯ä¹¦é¢å‘æœºæ„ï¼ˆRoot CAï¼‰ã€‚</p><h3 id="node-js-ä¸­çš„-x509-issuercertificate" tabindex="-1"><a class="header-anchor" href="#node-js-ä¸­çš„-x509-issuercertificate"><span>Node.js ä¸­çš„ x509.issuerCertificate</span></a></h3><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>crypto</code>æ¨¡å—æä¾›å¯¹ X.509 è¯ä¹¦æ“ä½œçš„åŠŸèƒ½ã€‚<code>x509</code>å¯¹è±¡è¡¨ç¤ºä¸€ä¸ªåŠ è½½åˆ° Node.js ä¸­çš„è¯ä¹¦ï¼Œè€Œ<code>.issuerCertificate</code>å±æ€§åˆ™æ˜¯æŒ‡è¯¥è¯ä¹¦çš„ç›´æ¥é¢å‘è€…ï¼ˆIssuerï¼‰çš„è¯ä¹¦ã€‚</p><p>å®é™…ä¸Šï¼Œå½“ä½ åœ¨ Node.js ä¸­åŠ è½½ä¸€ä¸ªè¯ä¹¦ï¼Œå¹¶æƒ³è¦åˆ†æå…¶é¢å‘è€…è¯ä¹¦æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå±æ€§ã€‚ä¸¾ä¸ªä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º&#39;my-cert.pem&#39;çš„æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªX.509è¯ä¹¦</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certPem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;my-cert.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨cryptoæ¨¡å—åˆ›å»ºä¸€ä¸ªX.509è¯ä¹¦å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certPem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–è¯¥è¯ä¹¦çš„é¢å‘è€…è¯ä¹¦</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> issuerCert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">issuerCertificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">issuerCert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¦‚æœå­˜åœ¨é¢å‘è€…è¯ä¹¦ï¼Œæ‰“å°å‡ºä¸€äº›ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Issuer Certificate Subject:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">issuerCert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">subject</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Issuer Certificate Issuer:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">issuerCert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">issuer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¦‚æœä¸å­˜åœ¨é¢å‘è€…è¯ä¹¦ï¼Œå¯èƒ½æ˜¯è‡ªç­¾åè¯ä¹¦</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;This certificate is self-signed or issuer certificate is not available.&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè¯»å–äº†ä¸€ä¸ªåä¸º<code>my-cert.pem</code>çš„è¯ä¹¦æ–‡ä»¶ï¼Œå¹¶åˆ›å»ºäº†ä¸€ä¸ª X.509 è¯ä¹¦å¯¹è±¡ã€‚é€šè¿‡<code>cert.issuerCertificate</code>å±æ€§ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè·å–å¹¶è¿›ä¸€æ­¥å¤„ç†è¯¥è¯ä¹¦çš„é¢å‘è€…è¯ä¹¦ã€‚</p><p>æ³¨æ„ï¼Œæœ‰äº›è¯ä¹¦å¯èƒ½æ˜¯è‡ªç­¾åçš„ï¼Œå³å®ƒä»¬æ²¡æœ‰é¢å‘è€…è¯ä¹¦ã€‚å¯¹äºè¿™æ ·çš„è¯ä¹¦ï¼Œ<code>.issuerCertificate</code>å±æ€§å¯èƒ½æ˜¯<code>undefined</code>æˆ–<code>null</code>ã€‚</p><p>è¿™ä¸ªå±æ€§åœ¨éœ€è¦éªŒè¯è¯ä¹¦é“¾çš„åœºæ™¯ä¸­éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚æ­å»º HTTPS æœåŠ¡å™¨ã€ç¼–å†™éœ€è¦éªŒè¯å®¢æˆ·ç«¯è¯ä¹¦çš„ä»£ç ç­‰åœºåˆã€‚é€šè¿‡é€’å½’æ£€æŸ¥<code>.issuerCertificate</code>ï¼Œä½ å¯ä»¥éå†æ•´ä¸ªè¯ä¹¦é“¾ï¼Œæœ€ç»ˆè¾¾åˆ°æ ¹ CA è¯ä¹¦ï¼Œä»è€ŒéªŒè¯æ•´ä¸ªé“¾æ¡çš„å®Œæ•´æ€§å’Œå¯ä¿¡åº¦ã€‚</p><h3 id="x509-extkeyusage" tabindex="-1"><a class="header-anchor" href="#x509-extkeyusage"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509extkeyusage" target="_blank" rel="noopener noreferrer">x509.extKeyUsage</a></span></a></h3><p>Node.js ä¸­çš„ <code>x509.extKeyUsage</code> æ˜¯ä¸€ä¸ªä¸å®‰å…¨ç›¸å…³çš„åŠŸèƒ½ï¼Œå®ƒæ¶‰åŠåˆ°äº†åŠ å¯†è¯ä¹¦ã€‚åœ¨è§£é‡Šè¿™ä¸ªæ¦‚å¿µä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆç†è§£ä¸‹å‡ ä¸ªåŸºç¡€çŸ¥è¯†ç‚¹ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-x-509" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-x-509"><span>ä»€ä¹ˆæ˜¯ X.509ï¼Ÿ</span></a></h3><p>X.509 æ˜¯ä¸€ç§éå¸¸æµè¡Œçš„è¯ä¹¦æ ‡å‡†ï¼Œç”¨æ¥æ ‡è¯†ç½‘ç»œä¸­çš„å®ä½“ï¼ˆæ¯”å¦‚æœåŠ¡å™¨ã€å®¢æˆ·ç«¯ç­‰ï¼‰ã€‚è¯ä¹¦å°±åƒæ˜¯ç”µå­ä¸–ç•Œä¸­çš„èº«ä»½è¯ï¼Œå¯ä»¥å¸®åŠ©ç¡®è®¤æŸä¸ªç½‘ç»œå®ä½“çš„èº«ä»½ã€‚X.509 è¯ä¹¦åŒ…å«äº†å…¬é’¥å’ŒæŒæœ‰è€…ï¼ˆå®ä½“ï¼‰çš„ä¿¡æ¯ï¼Œå¹¶ç”±å¯ä¿¡ä»»çš„ç¬¬ä¸‰æ–¹â€”â€”è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰è¿›è¡Œç­¾åã€‚</p><h3 id="å®‰å…¨é€šä¿¡" tabindex="-1"><a class="header-anchor" href="#å®‰å…¨é€šä¿¡"><span>å®‰å…¨é€šä¿¡</span></a></h3><p>äº’è”ç½‘ä¸Šçš„å®‰å…¨é€šä¿¡ç»å¸¸ä¾èµ– SSL/TLS åè®®ï¼Œè¿™äº›åè®®ä½¿ç”¨ X.509 è¯ä¹¦æ¥å»ºç«‹å®‰å…¨è¿æ¥ã€‚ä¾‹å¦‚ï¼Œå½“ä½ é€šè¿‡ HTTPS è®¿é—®ä¸€ä¸ªç½‘ç«™æ—¶ï¼Œè¯¥ç½‘ç«™ä¼šå‘ä½ çš„æµè§ˆå™¨æä¾›ä¸€ä¸ª X.509 è¯ä¹¦ï¼Œä»¥è¯æ˜å®ƒæ˜¯åˆæ³•çš„ï¼Œå¹¶ä¸”å¼€å§‹ä¸€ä¸ªåŠ å¯†çš„ä¼šè¯ã€‚</p><h3 id="extended-key-usage-extkeyusage" tabindex="-1"><a class="header-anchor" href="#extended-key-usage-extkeyusage"><span>Extended Key Usage (extKeyUsage)</span></a></h3><p>ç°åœ¨æ¥çœ‹ <code>extKeyUsage</code>ã€‚è¿™ä¸ªæœ¯è¯­å‡ºç°åœ¨ X.509 è¯ä¹¦çš„æ‰©å±•éƒ¨åˆ†ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªç‰¹å®šçš„è¯ä¹¦åº”è¯¥å¦‚ä½•è¢«ä½¿ç”¨ã€‚å®é™…ä¸Šï¼Œå®ƒå‘Šè¯‰ä½ è¿™ä¸ªè¯ä¹¦èƒ½ä¸èƒ½ç”¨äºæŸäº›ç‰¹å®šçš„ç›®çš„ï¼Œæ¯”å¦‚åªèƒ½ç”¨äºæœåŠ¡å™¨è®¤è¯ã€å®¢æˆ·ç«¯è®¤è¯æˆ–è€…ä»£ç ç­¾åç­‰ã€‚</p><p>åœ¨ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸­ï¼Œ<code>x509.extKeyUsage</code> å°±æ˜¯ç”¨æ¥è·å– X.509 è¯ä¹¦ä¸­ &quot;Extended Key Usage&quot; å­—æ®µçš„å€¼ã€‚è¿™å¯ä»¥å¸®åŠ©ä½ ç¼–ç¨‹æ—¶ç¡®å®šè¯ä¹¦æ˜¯å¦é€‚ç”¨äºä½ æ‰“ç®—ç”¨å®ƒåšçš„äº‹æƒ…ã€‚</p><h3 id="å®é™…ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-1"><span>å®é™…ä¾‹å­</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º &#39;mycert.pem&#39; çš„è¯ä¹¦æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certPem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;mycert.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fromPEM</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certPem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–è¯ä¹¦çš„æ‰©å±•å¯†é’¥ç”¨é€”</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> extKeyUsage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">extKeyUsage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">extKeyUsage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šä»£ç é¦–å…ˆä» Node.js å†…ç½®çš„<code>crypto</code>æ¨¡å—ä¸­å¼•å…¥å¿…è¦çš„å‡½æ•°ï¼Œç„¶åè¯»å–äº†ä¸€ä¸ªåä¸º<code>mycert.pem</code>çš„è¯ä¹¦æ–‡ä»¶ã€‚æ¥ç€ï¼Œå®ƒä½¿ç”¨<code>fromPEM</code>æ–¹æ³•å°†è¿™ä¸ªè¯ä¹¦æ–‡ä»¶è½¬æ¢ä¸º X509 è¯ä¹¦å¯¹è±¡ã€‚æœ€åï¼Œ<code>extKeyUsage()</code>æ–¹æ³•è¢«è°ƒç”¨æ¥è·å–è¯ä¹¦çš„æ‰©å±•å¯†é’¥ç”¨é€”ï¼Œå¹¶å°†å…¶æ‰“å°åˆ°æ§åˆ¶å°ã€‚</p><p>æ ¹æ®ä¸åŒçš„è¯ä¹¦ï¼Œ<code>extKeyUsage</code> å¯èƒ½è¿”å›ç±»ä¼¼ä»¥ä¸‹å†…å®¹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;1.3.6.1.5.5.7.3.1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;1.3.6.1.5.5.7.3.2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">];</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™äº›æ•°å­—æ˜¯å¯¹è±¡æ ‡è¯†ç¬¦ï¼ˆOIDï¼‰ï¼Œä»£è¡¨äº†è¯ä¹¦å¯ç”¨äºçš„ä¸åŒç”¨é€”ã€‚ä¾‹å¦‚ï¼š</p><ul><li><code>&#39;1.3.6.1.5.5.7.3.1&#39;</code> å¯èƒ½è¡¨ç¤ºè¿™ä¸ªè¯ä¹¦å¯ä»¥ç”¨äºæœåŠ¡å™¨èº«ä»½éªŒè¯ã€‚</li><li><code>&#39;1.3.6.1.5.5.7.3.2&#39;</code> å¯èƒ½è¡¨ç¤ºè¿™ä¸ªè¯ä¹¦å¯ä»¥ç”¨äºå®¢æˆ·ç«¯èº«ä»½éªŒè¯ã€‚</li></ul><p>æ€»ä¹‹ï¼Œ<code>x509.extKeyUsage</code> åœ¨ Node.js ä¸­å°±æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œç”¨æ¥æŸ¥çœ‹å¹¶ç¡®ä¿ä½ çš„åŠ å¯†è¯ä¹¦æ˜¯å¦æ”¯æŒä½ éœ€è¦å®ƒæ‰§è¡Œçš„æ“ä½œã€‚</p><h3 id="x509-publickey" tabindex="-1"><a class="header-anchor" href="#x509-publickey"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509publickey" target="_blank" rel="noopener noreferrer">x509.publicKey</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>x509.publicKey</code> æ˜¯æŒ‡ä¸€ä¸ªä» X.509 è¯ä¹¦ä¸­æå–çš„å…¬é’¥çš„åŠŸèƒ½ã€‚åœ¨æˆ‘ä»¬æ·±å…¥ç»†èŠ‚ä¹‹å‰ï¼Œè®©æˆ‘å…ˆè§£é‡Šä¸€ä¸‹ä¸€äº›åŸºç¡€æ¦‚å¿µã€‚</p><p><strong>X.509 è¯ä¹¦</strong>ï¼šè¿™æ˜¯ä¸€ç§æ•°å­—è¯ä¹¦ï¼Œå®ƒä½¿ç”¨ X.509 å…¬é’¥åŸºç¡€è®¾æ–½æ ‡å‡†ã€‚ä¸»è¦ç”¨äºåœ¨ç½‘ç»œä¸Šå¯¹å®ä½“(æ¯”å¦‚ç½‘ç«™ã€ç”¨æˆ·ç­‰)è¿›è¡Œèº«ä»½éªŒè¯ã€‚å½“æ‚¨è®¿é—®ä¸€ä¸ª HTTPS ç½‘ç«™æ—¶ï¼Œè¯¥ç½‘ç«™ä¼šæä¾›å®ƒçš„ X.509 è¯ä¹¦ï¼Œæ‚¨çš„æµè§ˆå™¨ä¼šæ£€æŸ¥å®ƒæ˜¯å¦æœ‰æ•ˆï¼Œä»¥ç¡®ä¿æ‚¨æ­£åœ¨ä¸çœŸæ­£çš„æœåŠ¡é€šä¿¡ã€‚</p><p><strong>å…¬é’¥å’Œç§é’¥</strong>ï¼šè¿™æ˜¯éå¯¹ç§°åŠ å¯†çš„ä¸€éƒ¨åˆ†ï¼Œåœ¨è¿™ç§æœºåˆ¶ä¸­ï¼Œæœ‰ä¸¤ä¸ªå¯†é’¥â€”ä¸€ä¸ªå…¬é’¥å¯ä»¥å…±äº«ç»™ä»»ä½•äººï¼Œè€Œä¸€ä¸ªç§é’¥åº”è¯¥ä¿å¯†ã€‚å…¬é’¥ç”¨äºåŠ å¯†æ•°æ®æˆ–éªŒè¯ç­¾åï¼Œè€Œç§é’¥ç”¨äºè§£å¯†æ•°æ®æˆ–åˆ›å»ºç­¾åã€‚</p><p>ç°åœ¨è¯´åˆ° <code>x509.publicKey</code>ï¼š</p><p>åœ¨ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸­ï¼Œ<code>x509.publicKey</code> æ–¹æ³•ç”¨äºè·å– X.509 è¯ä¹¦ä¸­åŒ…å«çš„å…¬é’¥ã€‚è¿™ä¸ªå…¬é’¥å¯ç”¨äºå¤šç§å®‰å…¨ç›¸å…³çš„æ“ä½œï¼Œæ¯”å¦‚éªŒè¯ç­¾åã€åŠ å¯†ä¿¡æ¯ç­‰ã€‚</p><p>è¯·çœ‹ä»¥ä¸‹ä¾‹å­æ¥ç†è§£è¿™ä¸ªæ–¹æ³•çš„å®é™…åº”ç”¨ï¼š</p><p><strong>ä¾‹å­ 1ï¼šéªŒè¯ç­¾å</strong><br> å‡è®¾ä½ æ”¶åˆ°äº†ä¸€æ¡æ¶ˆæ¯å’Œä¸€ä»½ç­¾åï¼Œä½ éœ€è¦éªŒè¯è¿™ä¸ªç­¾åæ˜¯ä¸æ˜¯ç”±å‘é€æ¶ˆæ¯çš„äººåˆ›å»ºçš„ã€‚å¦‚æœä½ æœ‰ä»–ä»¬çš„ X.509 è¯ä¹¦ï¼Œä½ å¯ä»¥ç”¨ <code>x509.publicKey</code> æ–¹æ³•æå–å…¬é’¥ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥éªŒè¯ç­¾åã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `-----BEGIN CERTIFICATE-----</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">// ... è¯ä¹¦å†…å®¹ ...</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">-----END CERTIFICATE-----`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æå–è¯ä¹¦ä¸­çš„å…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">x509</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ `signature` æ˜¯æˆ‘ä»¬è¦éªŒè¯çš„ç­¾åï¼Œ`data` æ˜¯åŸå§‹æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> isVerified</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">verify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    padding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">RSA_PKCS1_PSS_PADDING</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  signature</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isVerified</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> ?</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;ç­¾åéªŒè¯æˆåŠŸ&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;ç­¾åéªŒè¯å¤±è´¥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä¾‹å­ 2ï¼šåŠ å¯†æ•°æ®</strong><br> å¦‚æœä½ æƒ³è¦å®‰å…¨åœ°å‘é€ä¸€ä¸ªæ•æ„Ÿä¿¡æ¯ç»™æŒæœ‰ç‰¹å®š X.509 è¯ä¹¦çš„å®ä½“ï¼Œä½ å¯ä»¥ç”¨ä»–ä»¬è¯ä¹¦ä¸­çš„å…¬é’¥æ¥åŠ å¯†ä¿¡æ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `-----BEGIN CERTIFICATE-----</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">// ... è¯ä¹¦å†…å®¹ ...</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">-----END CERTIFICATE-----`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æå–è¯ä¹¦ä¸­çš„å…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">x509</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¦åŠ å¯†çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> message</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;è¿™æ˜¯ä¸€ä¸ªæœºå¯†æ¶ˆæ¯&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨å…¬é’¥åŠ å¯†æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encryptedData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">publicEncrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    padding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">RSA_PKCS1_OAEP_PADDING</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    oaepHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŠ å¯†åçš„æ•°æ®å¯ä»¥å®‰å…¨å‘é€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åŠ å¯†çš„æ•°æ®:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">encryptedData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼Œè¿™äº›åªæ˜¯ <code>x509.publicKey</code> æ–¹æ³•çš„ä¸€äº›ç®€å•ç¤ºä¾‹ã€‚åœ¨å®é™…åº”ç”¨ç¨‹åºä¸­ï¼Œå¤„ç†åŠ å¯†å’Œè¯ä¹¦é€šå¸¸ä¼šæ›´å¤æ‚ï¼Œå¹¶æ¶‰åŠæ›´å¤šçš„å®‰å…¨è€ƒè™‘ã€‚ä½†å¸Œæœ›è¿™äº›ç¤ºä¾‹èƒ½å¸®åŠ©ä½ ç†è§£ Node.js ä¸­ <code>x509.publicKey</code> çš„åŸºæœ¬ç”¨æ³•ã€‚</p><h3 id="x509-raw" tabindex="-1"><a class="header-anchor" href="#x509-raw"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509raw" target="_blank" rel="noopener noreferrer">x509.raw</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js v21.7.1 ä¸­çš„ <code>x509.raw</code> ç‰¹æ€§ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ä»åŸºç¡€æ¦‚å¿µå¼€å§‹ã€‚X.509 æ˜¯ä¸€ç§éå¸¸é‡è¦çš„æ ‡å‡†ï¼Œç”¨äºå®šä¹‰å…¬é’¥è¯ä¹¦çš„æ ¼å¼ã€‚è¿™äº›è¯ä¹¦åœ¨ç½‘ç»œå®‰å…¨å’ŒåŠ å¯†é€šä¿¡ä¸­å‘æŒ¥ç€å…³é”®ä½œç”¨ï¼Œæ¯”å¦‚åœ¨ HTTPS åè®®ä¸­ã€‚ä¸€ä¸ª X.509 è¯ä¹¦åŒ…å«äº†å…¬é’¥ä¿¡æ¯å’Œè¯ä¹¦æ‰€æœ‰è€…çš„èº«ä»½ä¿¡æ¯ï¼Œå¹¶ä¸”ç”±ä¸€ä¸ªæƒå¨çš„è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰ç­¾åè®¤è¯ã€‚</p><p>åœ¨ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸­ï¼Œ<code>x509.raw</code> å±æ€§æ˜¯å±äº <code>X509Certificate</code> å¯¹è±¡çš„ã€‚å½“ä½ ä½¿ç”¨ Node.js çš„ <code>crypto</code> API å¤„ç† X.509 è¯ä¹¦æ—¶ï¼Œ<code>X509Certificate</code> å®ä¾‹ä¼šè¡¨ç¤ºä¸€ä¸ªè¯ä¹¦ã€‚<code>x509.raw</code> åˆ™æ˜¯è¿™ä¸ªè¯ä¹¦çš„åŸå§‹äºŒè¿›åˆ¶è¡¨ç¤ºå½¢å¼ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ˜¯ä¸€ä¸ªåŒ…å«è¯ä¹¦å®Œæ•´å†…å®¹çš„ Buffer å¯¹è±¡ã€‚</p><p>ä¸ºä»€ä¹ˆéœ€è¦ <code>x509.raw</code> å‘¢? å› ä¸ºæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹è¯ä¹¦çš„äºŒè¿›åˆ¶å½¢å¼ç›´æ¥è¿›è¡Œæ“ä½œï¼Œæ¯”å¦‚éªŒè¯è¯ä¹¦çš„ç­¾åã€æå–è¯ä¹¦é“¾ä¸­çš„ç‰¹å®šè¯ä¹¦ç­‰ã€‚æ‹¥æœ‰åŸå§‹äºŒè¿›åˆ¶æ•°æ®å¯ä»¥è®©æˆ‘ä»¬æ‰§è¡Œè¿™äº›ä½çº§ä½†çµæ´»çš„æ“ä½œã€‚</p><p>ä¸¾ä¸€ä¸ªå®é™…åº”ç”¨çš„ä¾‹å­æ¥è¯´æ˜ï¼š</p><p>å‡è®¾æˆ‘ä»¬æƒ³éªŒè¯ä¸€ä¸ªä»ç½‘ç«™è·å¾—çš„ SSL è¯ä¹¦æ˜¯å¦çœŸå®æœ‰æ•ˆï¼Œæˆ‘ä»¬å¯èƒ½ä¼šè¿™æ ·åšï¼š</p><ol><li>è·å–å¹¶åˆ›å»º X.509 è¯ä¹¦çš„å®ä¾‹ã€‚</li><li>ä½¿ç”¨ <code>x509.raw</code> è·å–è¯ä¹¦çš„åŸå§‹äºŒè¿›åˆ¶ã€‚</li><li>å°†è¿™ä¸ªåŸå§‹äºŒè¿›åˆ¶ä¼ é€’ç»™ä¸€ä¸ªéªŒè¯å‡½æ•°ï¼Œæ£€æŸ¥å…¶ç­¾åæ˜¯å¦æ­£ç¡®ã€‚</li></ol><p>è¿™é‡Œæ˜¯ä¸€ä¸ªç®€åŒ–çš„ä»£ç ç¤ºä¾‹:</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> https</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‘æŸä¸ª HTTPS æœåŠ¡å™¨å‘èµ·è¯·æ±‚ä»¥è·å–è¯ä¹¦ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">https</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">socket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPeerCertificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åˆ›å»º X509Certificate å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> x509cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">raw</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¾“å‡ºåŸå§‹è¯ä¹¦æ•°æ®çš„é•¿åº¦</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">x509cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">raw</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º Buffer é•¿åº¦</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ x509.raw æ‰§è¡Œæ›´å¤šçš„æ“ä½œï¼Œä¾‹å¦‚éªŒè¯è¯ä¹¦ç­‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡ <code>https.get()</code> æ–¹æ³•å‘ &quot;<a href="https://example.com" target="_blank" rel="noopener noreferrer">https://example.com</a>&quot; å‘èµ·ä¸€ä¸ª HTTPS è¯·æ±‚ã€‚å½“è¿æ¥å»ºç«‹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å“åº”å¯¹è±¡ (<code>res</code>) çš„ <code>socket</code> å±æ€§æ¥è·å–æœåŠ¡ç«¯çš„è¯ä¹¦ä¿¡æ¯ã€‚æˆ‘ä»¬ç”¨è¿™ä¸ªä¿¡æ¯æ¥åˆ›å»º <code>X509Certificate</code> å®ä¾‹ï¼Œå¹¶é€šè¿‡ <code>x509.raw</code> è®¿é—®è¯ä¹¦çš„åŸå§‹äºŒè¿›åˆ¶æ•°æ®ã€‚</p><p>è¯·æ³¨æ„ï¼Œå®é™…ä¸ŠéªŒè¯è¯ä¹¦çš„è¯¦ç»†è¿‡ç¨‹ä¼šå¤æ‚å¾ˆå¤šã€‚è¿™åªæ˜¯ä¸€ä¸ªå±•ç¤ºå¦‚ä½•ä½¿ç”¨ <code>x509.raw</code> å±æ€§çš„ç®€åŒ–ä¾‹å­ã€‚åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œä½ å¯èƒ½éœ€è¦ä½¿ç”¨æ›´é«˜çº§çš„å·¥å…·æˆ–æ–¹æ³•æ¥å¤„ç†è¯ä¹¦é“¾ã€CRLs (è¯ä¹¦åŠé”€åˆ—è¡¨) å’Œ OCSP (åœ¨çº¿è¯ä¹¦çŠ¶æ€åè®®) ç­‰é—®é¢˜ã€‚</p><h3 id="x509-serialnumber" tabindex="-1"><a class="header-anchor" href="#x509-serialnumber"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509serialnumber" target="_blank" rel="noopener noreferrer">x509.serialNumber</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>x509.serialNumber</code> æŒ‡çš„æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨äºè·å– X.509 è¯ä¹¦çš„åºåˆ—å·ã€‚X.509 è¯ä¹¦é€šå¸¸ç”¨äº TLS/SSL åŠ å¯†ï¼Œå³å½“ä½ é€šè¿‡ HTTPS è®¿é—®ç½‘ç«™æ—¶ä½¿ç”¨çš„å®‰å…¨åè®®ã€‚è¯ä¹¦ä½œä¸ºè®¤è¯æœºæ„ï¼ˆCAï¼‰é¢å‘ç»™æŸä¸ªå®ä½“ï¼ˆå¦‚ç½‘ç«™æœåŠ¡å™¨ï¼‰çš„ä¸€ç§èº«ä»½è¯æ˜ï¼ŒåŒ…å«äº†å¤šé¡¹ä¿¡æ¯ï¼Œå…¶ä¸­å°±åŒ…æ‹¬äº†ä¸€ä¸ªå”¯ä¸€çš„åºåˆ—å·ã€‚</p><p>æ¯ä¸ª X.509 è¯ä¹¦éƒ½ä¼šæœ‰ä¸€ä¸ªåºåˆ—å·ï¼Œè¿™æ˜¯ç”±è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰åœ¨åˆ›å»ºè¯ä¹¦æ—¶åˆ†é…çš„ï¼Œç”¨ä»¥å”¯ä¸€æ ‡è¯†è¯¥è¯ä¹¦ã€‚è¯ä¹¦çš„åºåˆ—å·åœ¨æ‰€æœ‰é¢å‘çš„è¯ä¹¦ä¸­æ˜¯å”¯ä¸€çš„ï¼Œå› æ­¤å¯ä»¥ç”¨äºæœ‰æ•ˆåŒºåˆ†å’Œè¿½è¸ªæ¯ä¸ªè¯ä¹¦ã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œä½ å¯ä»¥åˆ©ç”¨å†…ç½®çš„<code>crypto</code>æ¨¡å—æ¥æ“ä½œå’Œè·å–è¯ä¹¦ä¿¡æ¯ã€‚<code>x509.serialNumber</code>å±æ€§å°±æ˜¯ç”¨æ¥è·å–å·²åŠ è½½çš„ X.509 è¯ä¹¦çš„åºåˆ—å·çš„ã€‚</p><p>ä¸‹é¢ä¸¾ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨<code>x509.serialNumber</code>ï¼š</p><p>é¦–å…ˆï¼Œä½ éœ€è¦æœ‰ä¸€ä¸ª X.509 è¯ä¹¦æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸€èˆ¬æ˜¯ä»¥<code>.pem</code>æˆ–<code>.crt</code>ç»“å°¾ã€‚æˆ‘ä»¬å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º<code>mycert.pem</code>çš„è¯ä¹¦æ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é¦–å…ˆéœ€è¦å¯¼å…¥cryptoæ¨¡å—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»æ–‡ä»¶ç³»ç»Ÿä¸­è¯»å–è¯ä¹¦å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certPem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;mycert.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨cryptoæ¨¡å—åˆ›å»ºX509Certificateå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certPem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–è¯ä¹¦çš„åºåˆ—å·</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> serialNumber</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">serialNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°åºåˆ—å·</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Serial Number:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">serialNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† Node.js çš„<code>crypto</code>æ¨¡å—å’Œæ–‡ä»¶ç³»ç»Ÿæ¨¡å—<code>fs</code>ã€‚ç„¶åï¼Œæˆ‘ä»¬è¯»å–äº†åä¸º<code>mycert.pem</code>çš„è¯ä¹¦æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨<code>crypto.X509Certificate</code>ç±»åˆ›å»ºäº†ä¸€ä¸ªè¡¨ç¤ºè¯¥è¯ä¹¦çš„å¯¹è±¡ã€‚æœ€åï¼Œæˆ‘ä»¬è®¿é—®è¿™ä¸ªå¯¹è±¡çš„<code>serialNumber</code>å±æ€§æ¥è·å–è¯ä¹¦çš„åºåˆ—å·ï¼Œå¹¶å°†å…¶æ‰“å°å‡ºæ¥ã€‚</p><p>è¿™ä¸ªåºåˆ—å·å¯ä»¥ç”¨äºå¤šç§åœºæ™¯ï¼Œæ¯”å¦‚ï¼š</p><ol><li><p><strong>éªŒè¯è¯ä¹¦æ˜¯å¦è¢«æ’¤é”€</strong>ï¼šå¦‚æœä¸€ä¸ªè¯ä¹¦å› ä¸ºæŸäº›åŸå› ä¸å†å®‰å…¨ï¼Œæˆ–è€…ç§é’¥æ³„éœ²ï¼Œè¯ä¹¦é¢å‘æœºæ„å¯èƒ½ä¼šæ’¤é”€å®ƒï¼Œä½ å¯ä»¥é€šè¿‡æ£€æŸ¥è¯¥è¯ä¹¦çš„åºåˆ—å·æ˜¯å¦å‡ºç°åœ¨è¯ä¹¦é¢å‘æœºæ„æä¾›çš„æ’¤é”€åˆ—è¡¨ï¼ˆCRLï¼‰ä¸Šæ¥è¿›è¡ŒéªŒè¯ã€‚</p></li><li><p><strong>æ—¥å¿—å®¡è®¡</strong>ï¼šåœ¨ä¸€äº›éœ€è¦é«˜åº¦å®‰å…¨çš„ç¯å¢ƒä¸­ï¼Œè®°å½•è¯ä¹¦çš„ä½¿ç”¨æƒ…å†µéå¸¸é‡è¦ï¼Œé€šè¿‡è®°å½•è¯ä¹¦çš„åºåˆ—å·ï¼Œå¯ä»¥å¸®åŠ©ç®¡ç†å‘˜è¿½è¸ªè¯ä¹¦çš„ä½¿ç”¨æƒ…å†µå’Œæ¥æºã€‚</p></li><li><p><strong>ç¨‹åºä¸­çš„è¯ä¹¦ç®¡ç†</strong>ï¼šå¦‚æœä½ çš„åº”ç”¨ç¨‹åºéœ€è¦ç®¡ç†å¾ˆå¤šè¯ä¹¦ï¼Œé€šè¿‡åºåˆ—å·å¯ä»¥æ–¹ä¾¿åœ°å­˜å‚¨ã€ç´¢å¼•å’ŒæŸ¥è¯¢ç‰¹å®šçš„è¯ä¹¦ã€‚</p></li></ol><p>è®°ä½ï¼Œä½¿ç”¨<code>crypto</code>æ¨¡å—æ—¶ï¼Œéœ€è¦ç¡®ä¿ä½ çš„ Node.js ç‰ˆæœ¬æ”¯æŒä½ è¦ä½¿ç”¨çš„åŠŸèƒ½ã€‚ä¸åŒç‰ˆæœ¬çš„ Node.js å¯èƒ½ä¼šæœ‰ä¸åŒçš„ API å’Œç‰¹æ€§ã€‚</p><h3 id="x509-subject" tabindex="-1"><a class="header-anchor" href="#x509-subject"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509subject" target="_blank" rel="noopener noreferrer">x509.subject</a></span></a></h3><p><code>x509.subject</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—ä¸‹çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒæ˜¯ç”¨æ¥è·å–è¯ä¹¦çš„ä¸»é¢˜ï¼ˆSubjectï¼‰ä¿¡æ¯çš„ã€‚åœ¨ X.509 è¯ä¹¦ä¸­ï¼Œä¸»é¢˜å°±æ˜¯æŒ‡è¯ä¹¦æ‰€ä»£è¡¨çš„å®ä½“ï¼Œé€šå¸¸åŒ…å«äº†ä¸€ç³»åˆ—å…³äºè¯¥å®ä½“çš„æè¿°ä¿¡æ¯ï¼Œæ¯”å¦‚åå­—ã€ä½ç½®ç­‰ã€‚</p><p>åœ¨ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>x509</code> ç±»æ¥è¡¨ç¤ºä¸€ä¸ª X.509 è¯ä¹¦ï¼Œå¹¶é€šè¿‡è¿™ä¸ªç±»çš„ä¸€äº›å±æ€§å’Œæ–¹æ³•æ¥è·å–æˆ–è€…æ“ä½œè¯ä¹¦çš„å„ç§ä¿¡æ¯ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-1"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨åšä¸€ä¸ªéœ€è¦éªŒè¯å®¢æˆ·ç«¯æä¾›çš„ SSL/TLS è¯ä¹¦çš„ç½‘ç»œæœåŠ¡å™¨ã€‚å½“ä¸€ä¸ªå®¢æˆ·ç«¯å°è¯•å»ºç«‹è¿æ¥æ—¶ï¼Œä»–ä»¬ä¼šæä¾›ä¸€ä¸ªè¯ä¹¦ã€‚ä½ éœ€è¦æ£€æŸ¥è¿™ä¸ªè¯ä¹¦çš„ä¸»é¢˜ä¿¡æ¯ï¼Œä»¥éªŒè¯è¿æ¥çš„å®¢æˆ·ç«¯æ˜¯é¢„æœŸçš„å®¢æˆ·ç«¯ï¼Œè€Œä¸æ˜¯æŸä¸ªå†’å……è€…ã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦æœ‰ Node.js å®‰è£…åœ¨ä½ çš„è®¡ç®—æœºä¸Šï¼Œå¹¶ç¡®ä¿ç‰ˆæœ¬è‡³å°‘æ˜¯ v21.7.1ï¼Œå› ä¸ºæˆ‘ä»¬å°†ä½¿ç”¨è¿™ä¸ªç‰ˆæœ¬çš„ APIã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªè¯ä¹¦æ–‡ä»¶client-cert.pemï¼Œæˆ‘ä»¬éœ€è¦è¯»å–å¹¶è§£æå®ƒ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> certPem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;client-cert.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ crypto.X509Certificate ç±»ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºè¯ä¹¦å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certPem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¸€æ—¦æˆ‘ä»¬æœ‰äº†è¯ä¹¦å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®å®ƒçš„ subject å±æ€§æ¥è·å–ä¸»é¢˜ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> subject</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">subject</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºä¸»é¢˜ä¿¡æ¯ï¼ŒæŸ¥çœ‹å®ƒåŒ…å«ä»€ä¹ˆ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">subject</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// subject é€šå¸¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…æ‹¬äº†å¤šä¸ªå­—æ®µï¼Œä¾‹å¦‚ï¼š</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">//   CN: &#39;client.example.com&#39;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">//   O: &#39;Example Company&#39;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">//   L: &#39;City Name&#39;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">//   ST: &#39;State or Province&#39;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">//   C: &#39;Country Code&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† <code>crypto</code> å’Œ <code>fs</code> è¿™ä¸¤ä¸ª Node.js å†…ç½®æ¨¡å—ã€‚ç„¶åæˆ‘ä»¬è¯»å–äº†ä¸€ä¸ªåä¸º <code>client-cert.pem</code> çš„è¯ä¹¦æ–‡ä»¶ï¼Œå¹¶åˆ›å»ºäº†ä¸€ä¸ª <code>X509Certificate</code> å¯¹è±¡ã€‚<code>cert.subject</code> å°±èƒ½å¤Ÿè®©æˆ‘ä»¬è®¿é—®åˆ°è¯ä¹¦çš„ä¸»é¢˜ä¿¡æ¯ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº†è¯¸å¦‚ CNï¼ˆé€šç”¨åç§°ï¼‰ã€Oï¼ˆç»„ç»‡ï¼‰ã€Lï¼ˆä½ç½®ï¼‰ã€STï¼ˆå·/çœä»½ï¼‰ã€Cï¼ˆå›½å®¶ä»£ç ï¼‰ç­‰å­—æ®µã€‚</p><p>é€šè¿‡è¿™ä¸ªä¸»é¢˜ä¿¡æ¯ï¼Œä½ å¯ä»¥è¿›è¡Œé€‚å½“çš„éªŒè¯ï¼Œç¡®ä¿é“¾æ¥çš„æ˜¯æ­£ç¡®çš„å®¢æˆ·ç«¯ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æœŸå¾…è¿æ¥çš„å®¢æˆ·ç«¯åº”è¯¥å±äº &quot;Example Company&quot;ï¼Œé‚£ä¹ˆä½ å¯ä»¥æ£€æŸ¥ <code>subject.O</code> å­—æ®µæ˜¯å¦åŒ¹é…ã€‚</p><p>è¯·æ³¨æ„ï¼Œå®é™…éƒ¨ç½²æ—¶ï¼Œä½ éœ€è¦ç¡®ä¿è¯ä¹¦æ–‡ä»¶çš„å®‰å…¨å’Œè¯ä¹¦çš„æœ‰æ•ˆæ€§æ£€éªŒï¼Œé˜²æ­¢æœªæˆæƒçš„è®¿é—®ã€‚</p><h3 id="x509-subjectaltname" tabindex="-1"><a class="header-anchor" href="#x509-subjectaltname"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509subjectaltname" target="_blank" rel="noopener noreferrer">x509.subjectAltName</a></span></a></h3><p>å½“ä½ åœ¨æµè§ˆç½‘é¡µæˆ–ä½¿ç”¨ç½‘ç»œæœåŠ¡æ—¶ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œä½ çš„æµè§ˆå™¨ä¼šä¸æœåŠ¡å™¨è¿›è¡ŒåŠ å¯†è¿æ¥ä»¥ä¿æŠ¤ä¿¡æ¯å®‰å…¨ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ç”¨åˆ°äº†ä¸€ä¸ªå«åš SSL/TLS çš„åè®®ï¼Œè€Œè¿™ä¸ªåè®®ä¾èµ–äºä¸€ç§å«åš X.509 çš„æ•°å­—è¯ä¹¦æ¥éªŒè¯æœåŠ¡å™¨çš„èº«ä»½ã€‚</p><p>åœ¨ X.509 è¯ä¹¦ä¸­æœ‰å¾ˆå¤šä¸åŒçš„éƒ¨åˆ†ï¼Œå…¶ä¸­<code>subjectAltName</code>ï¼ˆä¸»é¢˜å¤‡ç”¨åç§°ï¼‰æ˜¯ä¸€ä¸ªå¯é€‰ä½†éå¸¸é‡è¦çš„å­—æ®µã€‚ç®€å•æ¥è¯´ï¼Œ<code>subjectAltName</code>åˆ—å‡ºäº†å¯ä»¥ç”¨è¿™ä¸ªè¯ä¹¦è¯†åˆ«çš„æ‰€æœ‰çš„åŸŸåå’Œ IP åœ°å€ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªæœåŠ¡å™¨æ‹¥æœ‰å¤šä¸ªåŸŸåï¼Œå®ƒä»¬éƒ½å¯ä»¥è¢«åŒ…æ‹¬åœ¨<code>subjectAltName</code>ä¸­ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>x509.subjectAltName</code>æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå®ƒå…è®¸ä½ ä»ä¸€ä¸ª X.509 è¯ä¹¦ä¸­æå–å‡º<code>subjectAltName</code>å­—æ®µçš„ä¿¡æ¯ã€‚</p><p>ä»¥ä¸‹æ˜¯å‡ ä¸ªå®é™…åº”ç”¨çš„ä¾‹å­ï¼š</p><h3 id="ä¾‹å­-1-æ£€æŸ¥è¯ä¹¦çš„æœ‰æ•ˆåŸŸå" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-æ£€æŸ¥è¯ä¹¦çš„æœ‰æ•ˆåŸŸå"><span>ä¾‹å­ 1ï¼šæ£€æŸ¥è¯ä¹¦çš„æœ‰æ•ˆåŸŸå</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªéœ€è¦è¿æ¥åˆ°å¤–éƒ¨æœåŠ¡å™¨çš„ Node.js ç¨‹åºï¼Œå¹¶ä¸”ä½ æƒ³è¦ç¡®ä¿ä½ è¿æ¥çš„æ˜¯æ­£ç¡®çš„æœåŠ¡å™¨ã€‚ä½ å¯ä»¥ä½¿ç”¨<code>x509.subjectAltName</code>æ¥æŸ¥çœ‹æœåŠ¡å™¨æä¾›çš„è¯ä¹¦ä¸­åŒ…å«å“ªäº›åŸŸåï¼Œç„¶åç¡®è®¤è¿™äº›åŸŸåæ˜¯å¦å’Œä½ æœŸæœ›çš„åŒ¹é…ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> tls</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;tls&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> options</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿™é‡Œæ˜¯è¿æ¥æœåŠ¡å™¨çš„é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  host</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  port</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">443</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å»ºç«‹TLSè¿æ¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> socket</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> tls</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">connect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certificate</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> socket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPeerCertificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // åˆ›å»ºX509Certificateå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> x509</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">raw</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // è·å–å¹¶æ‰“å°subjectAltName</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">x509</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">subjectAltName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ— æ³•è§£æè¯ä¹¦&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  socket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å…³é—­è¿æ¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä¾‹å­-2-ä½œä¸ºå¥åº·æ£€æŸ¥çš„ä¸€éƒ¨åˆ†" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ä½œä¸ºå¥åº·æ£€æŸ¥çš„ä¸€éƒ¨åˆ†"><span>ä¾‹å­ 2ï¼šä½œä¸ºå¥åº·æ£€æŸ¥çš„ä¸€éƒ¨åˆ†</span></a></h3><p>å¦‚æœä½ è´Ÿè´£ç»´æŠ¤ä¸€ä¸ªå¤§å‹ç³»ç»Ÿï¼Œå¯èƒ½éœ€è¦å¯¹ç³»ç»Ÿå†…çš„è¯ä¹¦çŠ¶æ€è¿›è¡Œå®šæœŸæ£€æŸ¥ï¼Œä»¥ç¡®ä¿å®ƒä»¬æ²¡æœ‰è¿‡æœŸï¼Œå¹¶ä¸”è¿˜æ˜¯é’ˆå¯¹æ­£ç¡®çš„åŸŸåã€‚é€šè¿‡ç¼–å†™ä¸€ä¸ª Node.js è„šæœ¬ï¼Œä½ å¯ä»¥è‡ªåŠ¨åŒ–è¿™ä¸ªè¿‡ç¨‹ï¼Œæ£€æŸ¥æ¯ä¸ªè¯ä¹¦çš„<code>subjectAltName</code>å­—æ®µï¼Œç¡®ä¿å®ƒåŒ…å«é¢„æœŸçš„åŸŸåã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾cert.pemæ˜¯ä½ è¦æ£€æŸ¥çš„è¯ä¹¦æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/path/to/cert.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¯»å–è¯ä¹¦æ–‡ä»¶å¤±è´¥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // ç”ŸæˆX509Certificateå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> x509</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ£€æŸ¥subjectAltName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> altNames</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> x509</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">subjectAltName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // ç¡®ä¿altNamesåŒ…å«ä½ æœŸå¾…çš„åŸŸå</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">altNames</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">includes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;yourdomain.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¯ä¹¦æœ‰æ•ˆï¼šåŒ…å«é¢„æœŸçš„åŸŸå&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">warn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è­¦å‘Šï¼šè¯ä¹¦ä¸åŒ…å«é¢„æœŸçš„åŸŸå&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è§£æè¯ä¹¦å¤±è´¥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™äº›ä¾‹å­ä¸­æˆ‘ä»¬ä½¿ç”¨äº† Node.js çš„<code>crypto</code>æ¨¡å—ï¼Œç‰¹åˆ«æ˜¯å®ƒçš„<code>X509Certificate</code>ç±»æ¥å¤„ç†å’Œè·å–è¯ä¹¦ç›¸å…³çš„ä¿¡æ¯ã€‚åœ¨çœŸå®çš„ç¯å¢ƒä¸­ï¼Œè¿™æ ·çš„æ£€æŸ¥å¯ä»¥å¸®åŠ©ä½ è‡ªåŠ¨åŒ–ç®¡ç† SSL/TLS è¯ä¹¦ï¼Œç¡®ä¿åŠ å¯†é€šä¿¡çš„å®‰å…¨æ€§ã€‚</p><h3 id="x509-tojson" tabindex="-1"><a class="header-anchor" href="#x509-tojson"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509tojson" target="_blank" rel="noopener noreferrer">x509.toJSON()</a></span></a></h3><p>Node.js ä¸­çš„<code>x509.toJSON()</code>å‡½æ•°æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨æ¥å°† X.509 è¯ä¹¦ï¼ˆè¿™æ˜¯ä¸€ç§å¸¸è§çš„æ•°å­—è¯ä¹¦æ ‡å‡†ï¼Œç”¨äºå»ºç«‹ç½‘ç»œå®ä½“çš„èº«ä»½ï¼‰è½¬æ¢æˆ JSON æ ¼å¼çš„å¯¹è±¡ã€‚è¿™ä¸ªæ–¹æ³•å±äº Node.js çš„<code>crypto</code>æ¨¡å—ï¼Œè¯¥æ¨¡å—æä¾›äº†åŒ…æ‹¬åŠ å¯†è§£å¯†ã€å“ˆå¸Œã€è¯ä¹¦å¤„ç†ç­‰åœ¨å†…çš„å„ç§å®‰å…¨ç›¸å…³çš„åŠŸèƒ½ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œå‡è®¾æ‚¨å·²ç»æœ‰äº†ä¸€ä¸ª X.509 è¯ä¹¦ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•å°†å…¶è½¬æ¢ä¸ºä¸€ä¸ªä¾¿äºæ“ä½œå’Œå­˜å‚¨çš„ JSON å¯¹è±¡ã€‚è¿™ä¸ª JSON å¯¹è±¡ä¼šåŒ…å«è¯ä¹¦ä¸­çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚ä¸»é¢˜åã€å‘è¡Œè€…åã€æœ‰æ•ˆæ—¥æœŸç­‰ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ª<code>x509.toJSON()</code>æ–¹æ³•çš„å®é™…ä¾‹å­ï¼š</p><p>é¦–å…ˆï¼Œä½ éœ€è¦å¯¼å…¥ Node.js ä¸­çš„<code>crypto</code>æ¨¡å—ï¼Œå¹¶è¯»å–ä¸€ä¸ª X.509 è¯ä¹¦æ–‡ä»¶ã€‚è¿™é‡Œä»¥ PEM æ ¼å¼çš„è¯ä¹¦æ–‡ä»¶ä¸ºä¾‹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º &#39;certificate.pem&#39; çš„X.509è¯ä¹¦æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> pem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;certificate.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨cryptoæ¨¡å—åˆ›å»ºä¸€ä¸ªX509Certificateå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨å¯ä»¥è°ƒç”¨x509.toJSON()æ¥è·å–è¯ä¹¦çš„JSONè¡¨ç¤ºå½¢å¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certJson</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toJSON</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certJson</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡<code>fs.readFileSync</code>æ–¹æ³•è¯»å–äº†ä¸€ä»½è¯ä¹¦æ–‡ä»¶ï¼Œç„¶ååˆ›å»ºäº†ä¸€ä¸ª<code>X509Certificate</code>å¯¹è±¡ã€‚æœ€åï¼Œæˆ‘ä»¬è°ƒç”¨<code>cert.toJSON()</code>æ–¹æ³•å¾—åˆ°äº†è¿™ä»½è¯ä¹¦çš„ JSON è¡¨ç¤ºå½¢å¼ï¼Œå¹¶å°†å…¶æ‰“å°å‡ºæ¥ã€‚</p><p>å¾—åˆ°çš„è¾“å‡ºå¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">  &quot;subject&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">    &quot;C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;US&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">    &quot;ST&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;California&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">    &quot;L&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;San Francisco&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">    &quot;O&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Example, Inc.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">    &quot;CN&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;www.example.com&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">  &quot;issuer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">    &quot;C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;US&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">    &quot;O&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Example, Inc.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">    &quot;CN&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Example Root CA&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ... æ›´å¤šå­—æ®µ ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ª JSON å¯¹è±¡ä¸­ï¼Œ<code>subject</code>å­—æ®µè¡¨ç¤ºè¯ä¹¦çš„ä¸»é¢˜ï¼Œå³è¯ä¹¦æŒ‡ä»£çš„å®ä½“ï¼›è€Œ<code>issuer</code>å­—æ®µåˆ™è¡¨ç¤ºé¢å‘è¯¥è¯ä¹¦çš„æœºæ„ã€‚æ­¤å¤–ï¼Œè¿˜ä¼šæœ‰å¾ˆå¤šå…¶å®ƒçš„ä¿¡æ¯ï¼Œæ¯”å¦‚åºåˆ—å·ã€æœ‰æ•ˆæœŸé™ã€ç­¾åç®—æ³•ç­‰ç­‰ã€‚</p><p>è¿™ä¸ªæ–¹æ³•å¯ä»¥éå¸¸æ–¹ä¾¿åœ°è®©ç¨‹åºå‘˜åœ¨ä¸ç”¨ç›´æ¥è§£æ PEM æˆ– DER è¯ä¹¦æ–‡ä»¶çš„å‰æä¸‹ï¼Œè·å–å¹¶åˆ©ç”¨è¯ä¹¦å†…çš„ä¿¡æ¯ï¼Œå¦‚åœ¨ Web æœåŠ¡è®¾ç½® HTTPS è¿æ¥ï¼Œåœ¨éªŒè¯ SSL/TLS è¿æ¥æ—¶æ ¡éªŒå¯¹æ–¹è¯ä¹¦çš„åˆæ³•æ€§ç­‰åœºæ™¯ã€‚</p><h3 id="x509-tolegacyobject" tabindex="-1"><a class="header-anchor" href="#x509-tolegacyobject"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509tolegacyobject" target="_blank" rel="noopener noreferrer">x509.toLegacyObject()</a></span></a></h3><p>Node.js çš„ <code>x509.toLegacyObject()</code> æ–¹æ³•æ˜¯ Node.js ä¸­çš„ <code>crypto</code> æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒä¸»è¦ç”¨äºå°† X.509 è¯ä¹¦è½¬æ¢æˆä¸€ä¸ª JavaScript å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åŒ…å«äº†è¯ä¹¦ä¸­çš„å„ç§ä¿¡æ¯ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä»€ä¹ˆæ˜¯ X.509 è¯ä¹¦ã€‚X.509 è¯ä¹¦æ˜¯ä¸€ç§æ•°å­—è¯ä¹¦ï¼Œè¢«å¹¿æ³›ç”¨äºäº’è”ç½‘ä¸Šæ¥éªŒè¯æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯èº«ä»½ï¼Œç¡®ä¿æ•°æ®äº¤æ¢è¿‡ç¨‹çš„å®‰å…¨æ€§ã€‚å®ƒæ˜¯åŸºäºå…¬é’¥åŠ å¯†çš„ä¸€ç§æ ‡å‡†ï¼Œå¹¶åŒ…æ‹¬äº†è¯ä¹¦æŒæœ‰è€…çš„ä¿¡æ¯ã€å…¬é’¥ä»¥åŠç”±è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰ç­¾åç­‰ä¿¡æ¯ã€‚</p><p><code>toLegacyObject()</code> è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯å°†ç°ä»£çš„ X.509 è¯ä¹¦çš„è¡¨ç¤ºæ–¹å¼è½¬æ¢ä¸º Node.js æ—§ç‰ˆæœ¬ä¸­çš„æ ¼å¼ã€‚åœ¨ Node.js è¾ƒæ–°çš„ç‰ˆæœ¬ä¸­ï¼Œå¼•å…¥äº†æ›´ç°ä»£çš„ API æ¥è¡¨è¾¾å’Œæ“ä½œ X.509 è¯ä¹¦ï¼Œä½†å¦‚æœä½ éœ€è¦ä¸ä½¿ç”¨è€ç‰ˆæœ¬ Node.js ç¼–å†™çš„ä»£ç å…¼å®¹ï¼Œæˆ–è€…ä½ ä¹ æƒ¯äº†è€çš„ APIï¼Œé‚£ä¹ˆ <code>toLegacyObject()</code> å°±å¾ˆæœ‰ç”¨ã€‚</p><p>ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><p>å‡è®¾ä½ æœ‰ä¸€ä¸ª PEM æ ¼å¼çš„ X.509 è¯ä¹¦ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ–‡æœ¬æ ¼å¼çš„è¯ä¹¦ï¼Œçœ‹èµ·æ¥å¯èƒ½åƒè¿™æ ·ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-----BEGIN CERTIFICATE-----</span></span>
<span class="line"><span>MIIDBzCCAe+gAwIBAgIJANuequzRFQ...</span></span>
<span class="line"><span>-----END CERTIFICATE-----</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ å¯ä»¥ä½¿ç”¨ Node.js çš„ <code>fs</code> æ¨¡å—è¯»å–æ–‡ä»¶å†…å®¹ï¼Œå¹¶åˆ©ç”¨ <code>crypto</code> æ¨¡å—ä¸­çš„æ–¹æ³•æ¥è½¬æ¢è¿™ä¸ªè¯ä¹¦ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ çš„è¯ä¹¦æ–‡ä»¶å«åš mycert.pem</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> pem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;mycert.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ crypto æ¨¡å—åˆ›å»º X509Certificate å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç„¶åä½¿ç”¨ toLegacyObject() æ–¹æ³•æ¥è·å–æ—§ç‰ˆæ ¼å¼çš„å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> legacyObj</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toLegacyObject</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">legacyObj</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šä»£ç è¯»å–äº†ä¸€ä¸ªåä¸º <code>mycert.pem</code> çš„è¯ä¹¦æ–‡ä»¶ï¼Œç„¶ååˆ›å»ºäº†ä¸€ä¸ª <code>X509Certificate</code> å¯¹è±¡ã€‚ä¹‹åä½¿ç”¨ <code>toLegacyObject()</code> æ–¹æ³•ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªåŒ…å«äº†è¯ä¹¦è¯¦æƒ…çš„ JavaScript å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡å¯èƒ½åŒ…å«è¯¸å¦‚è¯ä¹¦çš„åºåˆ—å·ã€ç­¾åç®—æ³•ã€é¢å‘è€…åç§°ã€æœ‰æ•ˆæœŸç­‰ä¿¡æ¯ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®é™…å¼€å‘ä¸­ç›´æ¥æ“ä½œ X.509 è¯ä¹¦å¹¶ä¸å¸¸è§ï¼Œå› ä¸ºè¿™é€šå¸¸æ˜¯ç”±ç½‘ç»œå®‰å…¨åº“è‡ªåŠ¨å®Œæˆçš„ã€‚ä¸è¿‡ï¼Œå¦‚æœä½ åœ¨å¤„ç†ä¸€äº›ç‰¹æ®Šçš„å®‰å…¨éœ€æ±‚ï¼Œæˆ–è€…ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªéœ€è¦å¤„ç†è¯ä¹¦çš„ä½çº§åˆ«ç½‘ç»œåè®®ï¼Œäº†è§£è¿™äº›å†…å®¹å°±éå¸¸é‡è¦ã€‚</p><h3 id="x509-tostring" tabindex="-1"><a class="header-anchor" href="#x509-tostring"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509tostring" target="_blank" rel="noopener noreferrer">x509.toString()</a></span></a></h3><p>Node.js ä¸­çš„ <code>x509.toString()</code> æ–¹æ³•æ˜¯ä¸€ä¸ªç”¨äºè½¬æ¢è¯ä¹¦å¯¹è±¡ä¸ºå­—ç¬¦ä¸²å½¢å¼çš„å‡½æ•°ã€‚è¿™ä¸ªåŠŸèƒ½å±äº Node.js çš„ <code>crypto</code> æ¨¡å—ï¼Œä¸»è¦ç”¨äºå¤„ç†åŠ å¯†æ“ä½œï¼ŒåŒ…æ‹¬ä¸ x509 è¯ä¹¦æœ‰å…³çš„å„ç§åŠŸèƒ½ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œx509 è¯ä¹¦é€šå¸¸ç”¨æ¥å®ç° TLS/SSL åŠ å¯†ï¼Œè¿™æ˜¯ç½‘ç»œå®‰å…¨ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œæ¯”å¦‚åœ¨ HTTPS åè®®ä¸­ç”¨æ¥ä¿æŠ¤ç½‘ç«™å’Œç”¨æˆ·ä¹‹é—´ä¼ è¾“çš„æ•°æ®ã€‚</p><p>ä¸‹é¢æˆ‘ä¼šè¯¦ç»†è§£é‡Š <code>x509.toString()</code> æ–¹æ³•ï¼Œå¹¶ä¸”ç»™å‡ºä¸€äº›å®é™…çš„ä¾‹å­ã€‚</p><h3 id="è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š"><span>è§£é‡Š</span></a></h3><p>é¦–å…ˆï¼Œä¸€ä¸ª x509 è¯ä¹¦æ˜¯ä¸€ç§éµå¾ª X.509 æ ‡å‡†çš„æ•°å­—è¯ä¹¦ï¼Œå®ƒé€šè¿‡åŠ å¯†æ‰‹æ®µè¯æ˜äº†æŸä¸ªå…¬é’¥çš„æ‰€æœ‰æƒã€‚è¿™äº›è¯ä¹¦é€šå¸¸ç”±è®¤è¯ä¸­å¿ƒï¼ˆCAï¼‰ç­¾å‘ï¼Œç”¨æ¥å»ºç«‹èº«ä»½éªŒè¯å’ŒåŠ å¯†è¿æ¥ã€‚</p><p>å½“ä½ åœ¨ Node.js ä¸­ä½¿ç”¨ <code>crypto</code> æ¨¡å—å¤„ç†è¯ä¹¦æ—¶ï¼Œå¯èƒ½ä¼šå¾—åˆ°ä¸€ä¸ª x509 è¯ä¹¦å¯¹è±¡ã€‚ä¸ºäº†æŸ¥çœ‹æˆ–è€…è®°å½•è¿™ä¸ªå¯¹è±¡ä¸­çš„ä¿¡æ¯ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>x509.toString()</code> æ–¹æ³•å°†å…¶è½¬æ¢æˆäººç±»å¯è¯»çš„å­—ç¬¦ä¸²æ ¼å¼ã€‚</p><h3 id="å®é™…ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-2"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾ä½ å·²ç»æœ‰äº†ä¸€ä¸ª x509 è¯ä¹¦å¯¹è±¡ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•æŠŠå®ƒè½¬æ¢æˆå­—ç¬¦ä¸²ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º &#39;mycert.crt&#39; çš„è¯ä¹¦æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certPem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;mycert.crt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ crypto æ¨¡å—åˆ›å»ºä¸€ä¸ªX509è¯ä¹¦å¯¹è±¡ã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certPem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ toString() æ–¹æ³•å°†è¯ä¹¦è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certStr</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºè¯ä¹¦å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certStr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œåšäº†å‡ æ­¥æ“ä½œï¼š</p><ol><li>å¼•å…¥ <code>crypto</code> å’Œ <code>fs</code> æ¨¡å—ã€‚</li><li>ä½¿ç”¨ <code>fs.readFileSync</code> æ–¹æ³•è¯»å–å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„è¯ä¹¦æ–‡ä»¶ <code>mycert.crt</code>ã€‚</li><li>åˆ©ç”¨è¯»å–åˆ°çš„ PEM ç¼–ç çš„è¯ä¹¦å†…å®¹åˆ›å»ºäº†ä¸€ä¸ª <code>X509Certificate</code> å¯¹è±¡ã€‚</li><li>ç„¶åä½¿ç”¨è¯¥å¯¹è±¡çš„ <code>toString()</code> æ–¹æ³•å°†è¯ä¹¦å†…å®¹è½¬æ¢æˆæ˜“äºé˜…è¯»çš„å­—ç¬¦ä¸²æ ¼å¼ã€‚</li><li>æœ€åå°†è½¬æ¢å¥½çš„å­—ç¬¦ä¸²æ‰“å°åˆ°æ§åˆ¶å°ã€‚</li></ol><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥å¸®åŠ©å¼€å‘è€…å®¡æŸ¥å’Œè°ƒè¯•è¯ä¹¦çš„å†…å®¹ï¼Œç¡®ä¿è¯ä¹¦æœ‰æ•ˆå¹¶ä¸”åŒ…å«æ­£ç¡®çš„ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œåœ¨é…ç½® SSL/TLS æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯æ—¶ï¼Œå¼€å‘è€…å¯èƒ½éœ€è¦æ£€æŸ¥è¯ä¹¦çš„æœ‰æ•ˆæ€§ã€è¿‡æœŸæ—¶é—´ã€é¢å‘è€…ä¿¡æ¯ç­‰ã€‚é€šè¿‡å°†è¯ä¹¦å†…å®¹è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œå¯ä»¥æ›´å®¹æ˜“åœ°è¿›è¡Œè¿™äº›æ£€æŸ¥ã€‚</p><h3 id="x509-validfrom" tabindex="-1"><a class="header-anchor" href="#x509-validfrom"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509validfrom" target="_blank" rel="noopener noreferrer">x509.validFrom</a></span></a></h3><p><code>x509.validFrom</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒå±äº <code>crypto</code> æ¨¡å—ä¸­çš„ <code>X509Certificate</code> ç±»ã€‚è¿™ä¸ªç±»ç”¨æ¥è¡¨ç¤º X.509 è¯ä¹¦ï¼Œè€Œ <code>validFrom</code> å±æ€§åˆ™ç”¨æ¥è·å–è¯¥è¯ä¹¦çš„æœ‰æ•ˆèµ·å§‹æ—¥æœŸã€‚</p><p>åœ¨æ•°å­—è¯ä¹¦é¢†åŸŸï¼ŒX.509 æ ‡å‡†å®šä¹‰äº†è¯ä¹¦çš„æ ¼å¼ï¼ŒåŒ…æ‹¬å…¬é’¥ã€èº«ä»½ä¿¡æ¯ä»¥åŠè¯ä¹¦ç­¾å‘æœºæ„ï¼ˆCAï¼‰çš„ç­¾åç­‰å†…å®¹ã€‚æ¯ä¸ªè¯ä¹¦éƒ½æœ‰å…¶æœ‰æ•ˆæœŸé™ï¼Œå³æœ‰ä¸€ä¸ªå¼€å§‹æ—¥æœŸå’Œä¸€ä¸ªç»“æŸæ—¥æœŸï¼Œåœ¨è¿™æ®µæ—¶é—´å†…è¯ä¹¦æ˜¯è¢«ä¿¡ä»»çš„ã€‚</p><p><code>validFrom</code> å±æ€§è¿”å›çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºçš„æ˜¯è¯ä¹¦çš„æœ‰æ•ˆèµ·å§‹æ—¶é—´ã€‚è¿™ä¸ªæ—¥æœŸé€šå¸¸ä¼šæŒ‰ç…§ç‰¹å®šçš„æ ¼å¼å±•ç¤ºï¼Œæ¯”å¦‚ <code>&quot;Feb 18 10:00:00 2021 GMT&quot;</code> è¿™æ ·çš„æ ¼å¼ã€‚</p><p>ä¸ºäº†æ›´å¥½åœ°ç†è§£ <code>x509.validFrom</code>ï¼Œè®©æˆ‘ä»¬ä¸¾ä¸ªå®é™…ä¾‹å­ï¼š</p><p>å‡è®¾ä½ åˆ›å»ºäº†ä¸€ä¸ª HTTPS æœåŠ¡å™¨æˆ–è€…å®¢æˆ·ç«¯ï¼Œå¹¶ä¸”åœ¨ä¸å…¶ä»–è®¡ç®—æœºè¿›è¡Œå®‰å…¨é€šä¿¡æ—¶ï¼Œä½ éœ€è¦ä½¿ç”¨ SSL/TLS è¯ä¹¦ã€‚å½“å»ºç«‹è¿æ¥æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå‘å®¢æˆ·ç«¯å‘é€å®ƒçš„è¯ä¹¦ã€‚å®¢æˆ·ç«¯æ”¶åˆ°è¯ä¹¦åï¼Œä¼šæ£€æŸ¥è¯ä¹¦çš„æœ‰æ•ˆæ€§ï¼Œå…¶ä¸­å°±åŒ…æ‹¬æ£€æŸ¥å½“å‰æ—¥æœŸæ˜¯å¦åœ¨è¯ä¹¦çš„æœ‰æ•ˆæœŸå†…ã€‚è¿™æ—¶å€™å®¢æˆ·ç«¯å°±å¯ä»¥ä½¿ç”¨ <code>x509.validFrom</code> æ¥è·å–è¯ä¹¦çš„ç”Ÿæ•ˆæ—¥æœŸï¼Œå¹¶ä¸å½“å‰æ—¥æœŸå¯¹æ¯”æ¥åˆ¤æ–­è¯ä¹¦æ˜¯å¦æœ‰æ•ˆã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä»£ç ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨ <code>crypto</code> æ¨¡å—æ¥è·å–è¯ä¹¦çš„ç”Ÿæ•ˆæ—¥æœŸï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º &#39;certificate.pem&#39; çš„è¯ä¹¦æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certPem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;certificate.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certPem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ validFrom å±æ€§è·å–è¯ä¹¦çš„æœ‰æ•ˆèµ·å§‹æ—¥æœŸ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> validFromDate</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">validFrom</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è¯ä¹¦æœ‰æ•ˆèµ·å§‹æ—¥æœŸä¸º: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">validFromDate</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥ <code>crypto</code> å’Œ <code>fs</code> æ¨¡å—ã€‚æˆ‘ä»¬ä½¿ç”¨ <code>fs.readFileSync</code> æ–¹æ³•è¯»å–è¯ä¹¦æ–‡ä»¶ï¼ˆè¿™é‡Œå‡è®¾æ–‡ä»¶åä¸º &#39;certificate.pem&#39;ï¼‰ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>new crypto.X509Certificate()</code> æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ª <code>X509Certificate</code> å¯¹è±¡ï¼Œå¹¶ä¼ å…¥è¯ä¹¦å†…å®¹ã€‚æœ€åï¼Œæˆ‘ä»¬è®¿é—®è¯¥å¯¹è±¡çš„ <code>validFrom</code> å±æ€§ä»¥è·å–è¯ä¹¦çš„æœ‰æ•ˆèµ·å§‹æ—¥æœŸï¼Œå¹¶æ‰“å°å‡ºæ¥ã€‚</p><p>è¿™é¡¹åŠŸèƒ½å¯¹äºé‚£äº›éœ€è¦å¤„ç† SSL/TLS å®‰å…¨é€šä¿¡ã€éªŒè¯è¯ä¹¦æœ‰æ•ˆæ€§çš„åº”ç”¨ç¨‹åºå°¤å…¶é‡è¦ï¼Œä¾‹å¦‚ web æœåŠ¡å™¨ã€é‚®ä»¶æœåŠ¡å™¨ã€API æ¥å£ç­‰åœºåˆã€‚</p><h3 id="x509-validto" tabindex="-1"><a class="header-anchor" href="#x509-validto"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509validto" target="_blank" rel="noopener noreferrer">x509.validTo</a></span></a></h3><p><code>x509.validTo</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒå±äº <code>x509</code> è¯ä¹¦å¯¹è±¡ã€‚åœ¨è¿™é‡Œï¼Œ<code>x509</code> æŒ‡çš„æ˜¯ä¸€ç§ç”¨æ¥å¯¹äº’è”ç½‘ä¸Šçš„æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯è¿›è¡Œèº«ä»½è®¤è¯çš„æ•°å­—è¯ä¹¦æ ‡å‡†ã€‚ç®€å•æ¥è¯´ï¼Œå°±åƒæˆ‘ä»¬çš„èº«ä»½è¯æ˜æˆ‘ä»¬çš„èº«ä»½ä¸€æ ·ï¼Œæ•°å­—è¯ä¹¦å¸®åŠ©è¯æ˜ç½‘ç»œä¸ŠæŸä¸ªæœåŠ¡å™¨æˆ–ç”¨æˆ·çš„èº«ä»½ã€‚</p><p>å½“æˆ‘ä»¬è°ˆè®º <code>x509.validTo</code> æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šåœ¨è®¨è®ºè¿™ä¸ªæ•°å­—è¯ä¹¦çš„æœ‰æ•ˆæœŸé™ã€‚æ¯ä¸ª x509 è¯ä¹¦éƒ½æœ‰ä¸€ä¸ªå¼€å§‹æ—¥æœŸå’Œä¸€ä¸ªç»“æŸæ—¥æœŸï¼Œè¿™æ®µæ—¶é—´å†…è¯ä¹¦è¢«è®¤ä¸ºæ˜¯æœ‰æ•ˆçš„ã€‚<code>validTo</code> å±æ€§å‘Šè¯‰ä½ è¿™ä¸ªè¯ä¹¦çš„ç»“æŸæ—¥æœŸï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªè¯ä¹¦ä½•æ—¶è¿‡æœŸã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œä½¿ç”¨ <code>crypto</code> æ¨¡å—å¯ä»¥è·å–å¹¶è§£æ x509 è¯ä¹¦çš„ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨ <code>x509.validTo</code> çš„æ­¥éª¤ï¼š</p><ol><li>é¦–å…ˆï¼Œä½ éœ€è¦å¯¼å…¥ Node.js çš„ <code>crypto</code> æ¨¡å—ã€‚</li><li>ç„¶åï¼Œä½ åŠ è½½ä¸€ä¸ªç»™å®šçš„ x509 è¯ä¹¦å†…å®¹ã€‚</li><li>æ¥ä¸‹æ¥ï¼Œä½ åˆ›å»ºä¸€ä¸ª x509 è¯ä¹¦å®ä¾‹ã€‚</li><li>æœ€åï¼Œä½ å¯ä»¥é€šè¿‡è®¿é—®è¯¥å®ä¾‹ä¸Šçš„ <code>validTo</code> å±æ€§æ¥è·å–è¯ä¹¦çš„è¿‡æœŸæ—¥æœŸã€‚</li></ol><p>ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ æœ‰ä¸€ä¸ªx509è¯ä¹¦å­—ç¬¦ä¸²ï¼Œå¯èƒ½æ¥è‡ªæ–‡ä»¶æˆ–ç½‘ç»œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> certPem</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">-----BEGIN CERTIFICATE-----</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">...è¯ä¹¦å†…å®¹...</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">-----END CERTIFICATE-----</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨cryptoæ¨¡å—åˆ›å»ºä¸€ä¸ªX509Certificateå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">certPem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–è¯ä¹¦è¿‡æœŸæ—¥æœŸ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> validToDate</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">validTo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºè¿‡æœŸæ—¥æœŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è¯ä¹¦æœ‰æ•ˆè‡³: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">validToDate</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåŠ è½½äº† Node.js çš„ <code>crypto</code> æ¨¡å—ã€‚ç„¶åï¼Œæˆ‘ä»¬å‡è®¾å·²ç»æœ‰äº†ä¸€ä¸ªå­—ç¬¦ä¸²å½¢å¼çš„è¯ä¹¦ï¼ˆé€šå¸¸æ˜¯ä»¥ &#39;-----BEGIN CERTIFICATE-----&#39; å¼€å§‹ï¼Œä»¥ &#39;-----END CERTIFICATE-----&#39; ç»“æŸçš„ PEM æ ¼å¼è¯ä¹¦ï¼‰ã€‚æ¥ç€ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>crypto</code> æ¨¡å—çš„ <code>X509Certificate</code> ç±»æ¥åˆ›å»ºä¸€ä¸ªè¡¨ç¤ºè¿™ä¸ªè¯ä¹¦çš„å¯¹è±¡ã€‚æœ€åï¼Œæˆ‘ä»¬é€šè¿‡è®¿é—®è¿™ä¸ªå¯¹è±¡çš„ <code>validTo</code> å±æ€§æ¥æŸ¥çœ‹è¯ä¹¦çš„è¿‡æœŸæ—¥æœŸï¼Œå¹¶å°†å…¶æ‰“å°åˆ°æ§åˆ¶å°ã€‚</p><p>è¿™ä¸ªå±æ€§åœ¨å®é™…åº”ç”¨ä¸­å¾ˆæœ‰ç”¨ï¼Œæ¯”å¦‚ï¼š</p><ul><li>å½“ä½ å¼€å‘ä¸€ä¸ªéœ€è¦ä¸ HTTPS æœåŠ¡å™¨äº¤äº’çš„åº”ç”¨ç¨‹åºæ—¶ï¼Œä½ å¯èƒ½éœ€è¦æ£€æŸ¥æœåŠ¡å™¨çš„ SSL/TLS è¯ä¹¦æ˜¯å¦ä»ç„¶æœ‰æ•ˆã€‚</li><li>å¦‚æœä½ å»ºç«‹ä¸€ä¸ªå®‰å…¨ç³»ç»Ÿï¼Œéœ€è¦å®šæœŸæ£€æŸ¥è¯ä¹¦åº“ä¸­å„ä¸ªè¯ä¹¦çš„æœ‰æ•ˆæ€§ï¼Œä»¥ç¡®ä¿æ‰€æœ‰çš„é€šä¿¡éƒ½æ˜¯å®‰å…¨çš„ã€‚</li><li>åœ¨è‡ªåŠ¨åŒ–è„šæœ¬ä¸­ç›‘è§†è¯ä¹¦è¿‡æœŸçš„æƒ…å†µï¼ŒåŠæ—¶æé†’ç»´æŠ¤äººå‘˜æ›´æ–°è¯ä¹¦ã€‚</li></ul><h3 id="x509-verify-publickey" tabindex="-1"><a class="header-anchor" href="#x509-verify-publickey"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#x509verifypublickey" target="_blank" rel="noopener noreferrer">x509.verify(publicKey)</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>x509.verify(publicKey)</code> æ˜¯ä¸€ä¸ªç”¨äºéªŒè¯ä¸ X.509 è¯ä¹¦ç›¸å…³è”çš„å…¬é’¥çš„åŠŸèƒ½ã€‚X.509 æ˜¯ä¸€ç§éå¸¸æ™®éçš„æ•°å­—è¯ä¹¦æ ‡å‡†ï¼Œç”¨äºåœ¨ç½‘ç»œä¸–ç•Œä¸­å»ºç«‹èº«ä»½è®¤è¯ã€‚è¿™äº›è¯ä¹¦å¹¿æ³›åº”ç”¨äº HTTPS ç½‘ç«™ã€ç”µå­é‚®ä»¶åŠ å¯†å’Œç­¾åï¼Œä»¥åŠå…¶ä»–éœ€è¦å®‰å…¨é€šä¿¡çš„åœºåˆã€‚</p><p>è¦ç†è§£<code>x509.verify(publicKey)</code>ï¼Œä½ é¦–å…ˆéœ€è¦äº†è§£å‡ ä¸ªå…³é”®æ¦‚å¿µï¼š</p><ul><li><p><strong>å…¬é’¥åŠ å¯†</strong>: è¿™æ˜¯ä¸€ç§éå¯¹ç§°åŠ å¯†å½¢å¼ï¼Œåœ¨è¿™ç§åŠ å¯†æ–¹å¼ä¸­ï¼Œæœ‰ä¸¤ä¸ªå¯†é’¥ï¼šå…¬é’¥å’Œç§é’¥ã€‚å…¬é’¥å¯ä»¥ä¸ä»»ä½•äººå…±äº«ï¼Œè€Œç§é’¥å¿…é¡»ä¿å¯†ã€‚å…¬é’¥ç”¨äºåŠ å¯†æ•°æ®ï¼Œåªæœ‰å¯¹åº”çš„ç§é’¥æ‰èƒ½è§£å¯†è¿™äº›æ•°æ®ã€‚</p></li><li><p><strong>æ•°å­—è¯ä¹¦</strong>: è¿™æ˜¯ä¸€ä¸ªç»è¿‡æ•°å­—ç­¾åçš„æ–‡ä»¶ï¼Œè¯æ˜äº†æŸä¸ªå…¬é’¥ç¡®å®å±äºå®ƒå£°ç§°çš„æ‰€æœ‰è€…ï¼Œä¾‹å¦‚ä¸€ä¸ªç½‘ç«™æˆ–ä¸ªä½“ã€‚æ•°å­—è¯ä¹¦ç”±è¯ä¹¦é¢å‘æœºæ„(CA)é¢å‘ï¼Œå¹¶åŒ…å«äº†è¯ä¹¦æ‰€æœ‰è€…çš„ä¿¡æ¯ã€å…¬é’¥ä»¥åŠ CA çš„ç­¾åã€‚</p></li><li><p><strong>è¯ä¹¦éªŒè¯</strong>: ä¸ºäº†ç¡®ä¿è¯ä¹¦çš„çœŸå®æ€§å’Œæœ‰æ•ˆæ€§ï¼Œæ¥æ”¶æ–¹ä¼šå¯¹å…¶è¿›è¡ŒéªŒè¯ã€‚è¿™åŒ…æ‹¬æ£€æŸ¥è¯ä¹¦æ˜¯å¦å·²è¢«é¢å‘æœºæ„ç­¾åã€è¯ä¹¦æ˜¯å¦åœ¨æœ‰æ•ˆæœŸå†…ä»¥åŠæ˜¯å¦è¢«æ’¤é”€ç­‰ã€‚</p></li></ul><p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹ Node.js ä¸­<code>x509.verify(publicKey)</code>å‡½æ•°çš„ä½œç”¨ï¼š</p><p>è¿™ä¸ªå‡½æ•°ç”¨äºéªŒè¯ä¸€ä¸ª X.509 è¯ä¹¦æ˜¯å¦æ˜¯ç”±æŒæœ‰æä¾›çš„å…¬é’¥çš„å®ä½“æ‰€ç­¾åã€‚å¦‚æœè¯ä¹¦æ²¡æœ‰è¢«ç›¸åº”çš„ç§é’¥ç­¾åï¼Œåˆ™éªŒè¯ä¼šå¤±è´¥ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œè®©æˆ‘ä»¬å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œè¯¥ç¨‹åºéœ€è¦è¿æ¥åˆ°ä¸€ä¸ªæä¾› REST API çš„æœåŠ¡å™¨ã€‚è¿™ä¸ªæœåŠ¡å™¨ä½¿ç”¨ HTTPS åè®®ï¼Œå› æ­¤å®ƒæœ‰ä¸€ä¸ª SSL/TLS è¯ä¹¦æ¥åŠ å¯†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ã€‚</p><p>åœ¨ä½ çš„ Node.js åº”ç”¨ç¨‹åºä¸­ï¼Œå½“ä½ ä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥æ—¶ï¼Œä½ å¯ä»¥è·å–æœåŠ¡å™¨æä¾›çš„è¯ä¹¦ï¼Œå¹¶ä½¿ç”¨<code>x509.verify(publicKey)</code>å‡½æ•°æ¥éªŒè¯è¿™ä¸ªè¯ä¹¦ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> https</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿æ¥åˆ°ä¸€ä¸ªHTTPSæœåŠ¡å™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">https</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è·å–æœåŠ¡å™¨çš„è¯ä¹¦</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cert</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">socket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPeerCertificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åˆ›å»ºä¸€ä¸ªæ–°çš„X509Certificateå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> x509</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> X509Certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">raw</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // éªŒè¯è¯ä¹¦</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    x509</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">verify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pubkey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¯ä¹¦éªŒè¯æˆåŠŸ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¯ä¹¦éªŒè¯å¤±è´¥:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡<code>https.get</code>æ–¹æ³•ä¸ HTTPS æœåŠ¡å™¨å»ºç«‹è¿æ¥ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨<code>getPeerCertificate()</code>æ–¹æ³•è·å–æœåŠ¡å™¨çš„è¯ä¹¦ï¼Œå¹¶æ ¹æ®è¯ä¹¦åŸå§‹æ•°æ®åˆ›å»ºä¸€ä¸ª<code>X509Certificate</code>å¯¹è±¡ã€‚æœ€åï¼Œæˆ‘ä»¬è°ƒç”¨<code>verify</code>æ–¹æ³•å¹¶ä¼ å…¥è¯ä¹¦ä¸­çš„å…¬é’¥æ¥éªŒè¯è¯ä¹¦çš„æœ‰æ•ˆæ€§ã€‚</p><p>å¦‚æœéªŒè¯æˆåŠŸï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç¡®ä¿¡ä¸æˆ‘ä»¬é€šä¿¡çš„æœåŠ¡å™¨æ˜¯å¯ä¿¡çš„ï¼Œå¦åˆ™å¯èƒ½å­˜åœ¨å®‰å…¨é—®é¢˜ï¼Œä¾‹å¦‚ä¸­é—´äººæ”»å‡»ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œè¯ä¹¦éªŒè¯æ˜¯ç¡®ä¿ç½‘ç»œé€šä¿¡å®‰å…¨çš„é‡è¦æ­¥éª¤ã€‚</p><h2 id="node-crypto-module-methods-and-properties" tabindex="-1"><a class="header-anchor" href="#node-crypto-module-methods-and-properties"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#nodecrypto-module-methods-and-properties" target="_blank" rel="noopener noreferrer">node:crypto module methods and properties</a></span></a></h2><p>Node.js çš„ <code>crypto</code> æ¨¡å—åŒ…å«äº†ä¸€ç»„ç”¨äºå¤„ç†åŠ å¯†çš„å·¥å…·ï¼Œå®ƒå…è®¸ä½ æ‰§è¡Œå„ç§å®‰å…¨æ€§ç›¸å…³çš„æ“ä½œï¼Œå¦‚åˆ›å»ºæ•£åˆ—ï¼ˆhashesï¼‰ï¼ŒåŠ å¯†å’Œè§£å¯†æ•°æ®ï¼Œåˆ›å»ºæ•°å­—ç­¾åç­‰ã€‚åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>crypto</code> æ¨¡å—ç»§ç»­æä¾›è¿™äº›åŠŸèƒ½ã€‚</p><p>ä»¥ä¸‹æ˜¯ <code>crypto</code> æ¨¡å—ä¸­ä¸€äº›å¸¸ç”¨æ–¹æ³•å’Œå±æ€§çš„ç®€å•ä»‹ç»å’Œä¸¾ä¾‹ï¼š</p><h3 id="æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•"><span>æ–¹æ³•</span></a></h3><ol><li><p><strong>createHash(algorithm)</strong><br> è¯¥æ–¹æ³•ç”¨äºåˆ›å»ºä¸€ä¸ªå“ˆå¸Œå¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨è¯¥å¯¹è±¡ç”Ÿæˆæ•°æ®çš„å“ˆå¸Œå€¼ã€‚<code>algorithm</code> å‚æ•°æŒ‡å®šæ‰€ä½¿ç”¨çš„å“ˆå¸Œç®—æ³•ï¼ˆä¾‹å¦‚ï¼š&#39;sha256&#39;ã€&#39;md5&#39;ï¼‰ã€‚</p><p><strong>å®é™…ä¾‹å­</strong>ï¼š<br> å‡è®¾ä½ éœ€è¦ä¸ºå¯†ç ç”Ÿæˆä¸€ä¸ª SHA-256 å“ˆå¸Œï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;mySuperSecretPassword&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™å°†è¾“å‡ºå¯†ç çš„ SHA-256 å“ˆå¸Œå€¼ã€‚</p></li><li><p><strong>createCipheriv(algorithm, key, iv)</strong><br> ä½¿ç”¨æŒ‡å®šçš„ç®—æ³•ã€å¯†é’¥å’Œåˆå§‹åŒ–å‘é‡ï¼ˆIVï¼‰åˆ›å»ºä¸€ä¸ªæ–°çš„ Cipher å¯¹è±¡ç”¨äºåŠ å¯†æ•°æ®ã€‚</p><p><strong>å®é™…ä¾‹å­</strong>ï¼š<br> å‡è®¾ä½ éœ€è¦åŠ å¯†ä¸€äº›æ•æ„Ÿæ•°æ®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯†é’¥å’Œåˆå§‹åŒ–å‘é‡é€šå¸¸ç”±éšæœºæˆ–ä¼ªéšæœºæ•°ç”Ÿæˆå™¨äº§ç”Ÿ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// AES-256çš„å¯†é’¥é•¿åº¦ä¸º32å­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// AESçš„åˆå§‹å‘é‡é•¿åº¦é€šå¸¸æ˜¯16å­—èŠ‚</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-256-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Sensitive data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡ºå°†æ˜¾ç¤ºåŠ å¯†åçš„æ•°æ®ã€‚</p></li><li><p><strong>createDecipheriv(algorithm, key, iv)</strong><br> ä¸ <code>createCipheriv</code> ç›¸åï¼Œè¯¥æ–¹æ³•ç”¨äºåˆ›å»ºä¸€ä¸ªç”¨äºè§£å¯†æ•°æ®çš„ Decipher å¯¹è±¡ã€‚</p><p><strong>å®é™…ä¾‹å­</strong>ï¼š<br> ç”¨æ¥è§£å¯†ä¸Šé¢åŠ å¯†çš„æ•°æ®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;crypto&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ç›¸åŒçš„å¯†é’¥å’ŒIVè§£å¯†æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> ...</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»åŠ å¯†è¿‡ç¨‹ä¸­ä¿å­˜çš„key</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> ...</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»åŠ å¯†è¿‡ç¨‹ä¸­ä¿å­˜çš„iv</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encryptedData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> ...</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¸Šé¢ä¾‹å­ä¸­ç”Ÿæˆçš„åŠ å¯†æ•°æ®</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDecipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;aes-256-cbc&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> decrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encryptedData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;hex&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;utf8&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;utf8&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡ºå°†æ˜¾ç¤ºåŸå§‹æœªåŠ å¯†çš„æ•°æ®ã€‚</p></li></ol><h3 id="å±æ€§" tabindex="-1"><a class="header-anchor" href="#å±æ€§"><span>å±æ€§</span></a></h3><ol><li><p><strong>constants</strong><br><code>crypto.constants</code> æä¾›äº†ä¸€ç³»åˆ—åŠ å¯†æ“ä½œä¸­å¸¸ç”¨çš„å¸¸é‡ï¼Œå¯ç”¨äºé…ç½® TLS/SSL ä½¿ç”¨çš„æ–¹æ³•æˆ–å…¶ä»–åŠ å¯†æ“ä½œã€‚</p><p><strong>å®é™…ä¾‹å­</strong>ï¼š<br> ä½¿ç”¨ <code>crypto.constants</code> æ¥è®¾ç½® TLS å¥—æ¥å­—çš„é€‰é¡¹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> tls</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;tls&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> options</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  secureProtocol</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;TLSv1_2_method&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  secureOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">SSL_OP_NO_SSLv3</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> |</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">SSL_OP_NO_TLSv1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> server</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> tls</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">socket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¤„ç†TLSè¿æ¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª TLS æœåŠ¡å™¨ï¼Œæ˜ç¡®æ’é™¤äº† SSLv3 å’Œ TLSv1 åè®®ä»¥å¢å¼ºå®‰å…¨æ€§ã€‚</p></li></ol><p>è¿™å°±æ˜¯ Node.js <code>crypto</code> æ¨¡å—ä¸­å¸¸è§çš„å‡ ä¸ªæ–¹æ³•å’Œå±æ€§çš„ç®€ä»‹å’Œåº”ç”¨ç¤ºä¾‹ã€‚é€šè¿‡ä½¿ç”¨è¿™äº›å·¥å…·ï¼Œå¼€å‘è€…å¯ä»¥æ‰§è¡ŒåŠ å¯†å’Œå®‰å…¨æ€§ä»»åŠ¡ï¼Œä»è€Œä¿æŠ¤æ•°æ®çš„å®Œæ•´æ€§å’Œä¿å¯†æ€§ã€‚</p><h3 id="crypto-constants" tabindex="-1"><a class="header-anchor" href="#crypto-constants"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptoconstants" target="_blank" rel="noopener noreferrer">crypto.constants</a></span></a></h3><p>Node.js ä¸­çš„ <code>crypto</code> æ¨¡å—æ˜¯ç”¨äºåŠ å¯†åŠŸèƒ½ï¼Œæ¯”å¦‚åˆ›å»ºå“ˆå¸Œã€åŠ è§£å¯†ç­‰å®‰å…¨ç›¸å…³çš„æ“ä½œã€‚åœ¨è¿™ä¸ªæ¨¡å—é‡Œï¼Œ<code>crypto.constants</code> æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†ç”¨äºè¿™äº›æ“ä½œçš„ä¸€ç³»åˆ—é¢„å®šä¹‰çš„å¸¸é‡å€¼ã€‚</p><p>è¿™äº›å¸¸é‡é€šå¸¸ç”¨äºè®¾ç½®å‡½æ•°çš„é€‰é¡¹æˆ–è€…å‚æ•°ï¼Œå®ƒä»¬å¯ä»¥å¸®åŠ©ä½ æŒ‡å®šåŠ å¯†ç®—æ³•çš„æŸäº›ç‰¹å®šè¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½ä¼šåœ¨ä½¿ç”¨ <code>crypto.createCipheriv</code> æˆ– <code>crypto.createDecipheriv</code> å‡½æ•°æ—¶é‡åˆ°è¿™äº›å¸¸é‡ï¼Œå®ƒä»¬ç”¨æ¥åˆ›å»ºåŠ å¯†å’Œè§£å¯†çš„ Cipher å®ä¾‹ã€‚</p><h3 id="å¸¸é‡çš„ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å¸¸é‡çš„ä¾‹å­"><span>å¸¸é‡çš„ä¾‹å­</span></a></h3><p>ç°åœ¨ä»¥ Node.js v21.7.1 ä¸ºä¾‹ï¼Œ<code>crypto.constants</code> å¯èƒ½åŒ…æ‹¬ä»¥ä¸‹å¸¸é‡ï¼ˆè¿™é‡Œåªåˆ—ä¸¾å‡ ä¸ªï¼Œå®é™…ä¸Šæœ‰å¾ˆå¤šï¼‰ï¼š</p><ul><li><code>crypto.constants.RSA_PKCS1_OAEP_PADDING</code>: è¿™ä¸ªå¸¸é‡ç”¨äº RSA åŠ å¯†ä¸­ï¼Œå®ƒå®šä¹‰äº† OAEPï¼ˆOptimal Asymmetric Encryption Paddingï¼‰ä½œä¸ºå¡«å……æœºåˆ¶ã€‚</li><li><code>crypto.constants.SSL_OP_NO_TLSv1_1</code>: è¿™ä¸ªå¸¸é‡ç”¨äºç¦ç”¨ TLS v1.1 åè®®çš„ä½¿ç”¨ï¼Œå¢å¼ºå®‰å…¨æ€§ã€‚</li><li><code>crypto.constants.OPENSSL_VERSION_NUMBER</code>: è¿™ä¸æ˜¯ä¸€ä¸ªç”¨äºé…ç½®çš„å¸¸é‡ï¼Œç›¸åï¼Œå®ƒæä¾›äº† OpenSSL åº“ç‰ˆæœ¬çš„ä¿¡æ¯ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-2"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>è®©æˆ‘ä»¬çœ‹å‡ ä¸ªå…·ä½“çš„ä¾‹å­æ¥å±•ç¤ºå¦‚ä½•ä½¿ç”¨è¿™äº›å¸¸é‡ã€‚</p><h4 id="ç¤ºä¾‹-1-ä½¿ç”¨-rsa-åŠ å¯†æ•°æ®" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ä½¿ç”¨-rsa-åŠ å¯†æ•°æ®"><span>ç¤ºä¾‹ 1ï¼šä½¿ç”¨ RSA åŠ å¯†æ•°æ®</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¦åŠ å¯†çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;secret message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// RSA å…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `-----BEGIN PUBLIC KEY-----</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">...</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">-----END PUBLIC KEY-----`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨å…¬é’¥å’Œ OAEP å¡«å……åŠ å¯†æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encryptedData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">publicEncrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    padding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">RSA_PKCS1_OAEP_PADDING</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Encrypted Data:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">encryptedData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>RSA_PKCS1_OAEP_PADDING</code> å¸¸é‡æ¥æŒ‡å®š RSA åŠ å¯†çš„å¡«å……æ–¹å¼ã€‚</p><h4 id="ç¤ºä¾‹-2-åˆ›å»ºä¸€ä¸ªç¦ç”¨äº†æ—§ç‰ˆ-tls-åè®®çš„-https-æœåŠ¡å™¨" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-åˆ›å»ºä¸€ä¸ªç¦ç”¨äº†æ—§ç‰ˆ-tls-åè®®çš„-https-æœåŠ¡å™¨"><span>ç¤ºä¾‹ 2ï¼šåˆ›å»ºä¸€ä¸ªç¦ç”¨äº†æ—§ç‰ˆ TLS åè®®çš„ HTTPS æœåŠ¡å™¨</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> https</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> options</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;private-key.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;certificate.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  secureOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">SSL_OP_NO_TLSv1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> |</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">SSL_OP_NO_TLSv1_1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¦ç”¨ TLSv1 å’Œ TLSv1.1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">https</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeHead</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hello world</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬åˆ©ç”¨ <code>SSL_OP_NO_TLSv1</code> å’Œ <code>SSL_OP_NO_TLSv1_1</code> å¸¸é‡æ¥ç¡®ä¿æˆ‘ä»¬çš„ HTTPS æœåŠ¡å™¨ä¸ä¼šæ¥å—åŸºäº TLSv1 æˆ– TLSv1.1 åè®®çš„è¿æ¥ï¼Œä»è€Œæé«˜äº†æœåŠ¡å™¨çš„å®‰å…¨çº§åˆ«ã€‚</p><p>é€šè¿‡ä¸Šè¿°ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>crypto.constants</code> ä¸­çš„å¸¸é‡å¦‚ä½•è¢«åº”ç”¨åˆ°å®é™…çš„åŠ å¯†åœºæ™¯ä¸­ï¼Œä»¥æ­¤æ¥è°ƒæ•´å’Œæ§åˆ¶åŠ å¯†è¿‡ç¨‹ä¸­çš„å„ç§å‚æ•°å’Œè¡Œä¸ºã€‚åœ¨ç¼–å†™æ¶‰åŠå¯†ç å­¦çš„ä»£ç æ—¶ï¼Œæ­£ç¡®ç†è§£å’Œä½¿ç”¨è¿™äº›å¸¸é‡è‡³å…³é‡è¦ã€‚</p><h3 id="crypto-fips" tabindex="-1"><a class="header-anchor" href="#crypto-fips"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptofips" target="_blank" rel="noopener noreferrer">crypto.fips</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡ç«¯ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>crypto</code> æ¨¡å—æ˜¯ç”¨æ¥æ‰§è¡Œå„ç§åŠ å¯†æ“ä½œçš„æ ‡å‡†æ¨¡å—ï¼Œæ¯”å¦‚åˆ›å»ºæ•£åˆ—ï¼ˆhashesï¼‰ã€HMACã€åŠ è§£å¯†ç­‰ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬è¦è®¨è®ºçš„æ˜¯ <code>crypto.fips</code> å±æ€§ã€‚FIPS æ˜¯ç¾å›½è”é‚¦ä¿¡æ¯å¤„ç†æ ‡å‡†ï¼ˆFederal Information Processing Standardsï¼‰çš„ç¼©å†™ã€‚å…¶ä¸­æœ‰ä¸€éƒ¨åˆ†æ ‡å‡†ä¸“é—¨æ¶‰åŠåŠ å¯†æ–¹æ³•å’Œç®—æ³•ï¼Œè¿™å°±æ˜¯ FIPS 140-2ã€‚</p><p>å½“ä½ å¯ç”¨ FIPS 140-2 æ¨¡å¼æ—¶, Node.js å°†ä¼šåªä½¿ç”¨é‚£äº›é€šè¿‡ FIPS éªŒè¯çš„åŠ å¯†ç®—æ³•ï¼Œè¿™é€šå¸¸æ˜¯å‡ºäºéµå®ˆæŸäº›å®‰å…¨åˆè§„æ€§è¦æ±‚ï¼Œæ¯”å¦‚æ”¿åºœæœºå…³æˆ–é‡‘èæœºæ„ç­‰å¯¹æ•°æ®åŠ å¯†æœ‰ä¸¥æ ¼è§„å®šçš„åœºæ‰€ã€‚</p><h3 id="crypto-fips-çš„ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#crypto-fips-çš„ä½œç”¨"><span><code>crypto.fips</code> çš„ä½œç”¨ï¼š</span></a></h3><p><code>crypto.fips</code> æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼å±æ€§ï¼Œç”¨äºæŸ¥è¯¢æˆ–è®¾ç½® Node.js æ˜¯å¦è¿è¡Œåœ¨ FIPS æ¨¡å¼ä¸‹ã€‚</p><ul><li>å½“ <code>crypto.fips</code> è®¾ä¸º <code>true</code>ï¼ŒNode.js å°†è¿›å…¥ FIPS æ¨¡å¼ã€‚</li><li>å½“ <code>crypto.fips</code> è®¾ä¸º <code>false</code>ï¼ŒNode.js å°†é€€å‡º FIPS æ¨¡å¼ã€‚</li><li>æŸ¥è¯¢ <code>crypto.fips</code> çš„å€¼å¯ä»¥çŸ¥é“å½“å‰ Node.js æ˜¯å¦å¤„åœ¨ FIPS æ¨¡å¼ã€‚</li></ul><p>æ³¨æ„ï¼šä¸æ˜¯æ‰€æœ‰ Node.js æ„å»ºç‰ˆæœ¬éƒ½æ”¯æŒ FIPS æ¨¡å¼ã€‚è¦æƒ³åœ¨ Node.js ä¸­ä½¿ç”¨ FIPSï¼Œä½ éœ€è¦ç‰¹åˆ«æ„å»ºæ”¯æŒ FIPS çš„ Node.js ç‰ˆæœ¬æˆ–è€…ä½¿ç”¨å·²ç»æä¾›äº† FIPS æ”¯æŒçš„ Node.js å‘è¡Œç‰ˆã€‚</p><h3 id="ä½¿ç”¨ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­-1"><span>ä½¿ç”¨ä¾‹å­ï¼š</span></a></h3><p>å‡è®¾ä½ åœ¨ä¸€ä¸ªéœ€è¦éµå®ˆ FIPS æ ‡å‡†çš„é¡¹ç›®ä¸­å·¥ä½œï¼Œä½ å¯èƒ½éœ€è¦åœ¨ä½ çš„ Node.js åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶å¯ç”¨ FIPS æ¨¡å¼ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æŸ¥è¯¢å½“å‰ FIPS æ¨¡å¼çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;FIPS mode is currently&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fips</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> ?</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;enabled&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;disabled&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯ç”¨ FIPS æ¨¡å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fips</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨å†æ¬¡æŸ¥è¯¢ FIPS æ¨¡å¼çŠ¶æ€ï¼Œåº”è¯¥ä¼šæ˜¾ç¤ºå¯ç”¨äº†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;FIPS mode is now&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fips</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> ?</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;enabled&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;disabled&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰§è¡Œä¸€äº›åŠ å¯†æ“ä½œï¼Œè¿™é‡Œä»¥ç”Ÿæˆ SHA-256 æ•£åˆ—ä¸ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, world!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ç»“æŸä¹‹å‰ç¦ç”¨ FIPS æ¨¡å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fips</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä»¥ä¸Šä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† <code>crypto</code> æ¨¡å—ï¼Œå¹¶æŸ¥è¯¢äº† FIPS æ¨¡å¼æ˜¯å¦å¯ç”¨ã€‚æ¥ç€ï¼Œæˆ‘ä»¬é€šè¿‡å°† <code>crypto.fips</code> è®¾ç½®ä¸º <code>true</code> æ¥å¯ç”¨ FIPS æ¨¡å¼ã€‚ç„¶åæˆ‘ä»¬è¿›è¡Œäº†ä¸€ä¸ªç®€å•çš„ SHA-256 æ•£åˆ—ç”Ÿæˆæ“ä½œã€‚æœ€åï¼Œæˆ‘ä»¬é€šè¿‡å°† <code>crypto.fips</code> è®¾ç½®ä¸º <code>false</code> æ¥ç¦ç”¨ FIPS æ¨¡å¼ã€‚</p><p>è¯·è®°ä½ï¼Œå¦‚æœä½ çš„ Node.js ç‰ˆæœ¬æˆ–æ„å»ºä¸æ”¯æŒ FIPSï¼Œå°è¯•è®¾ç½® <code>crypto.fips</code> å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯ã€‚</p><p>å¸Œæœ›è¿™èƒ½å¸®åˆ°ä½ æ›´å¥½åœ°ç†è§£ <code>crypto.fips</code> åœ¨ Node.js ä¸­çš„ä½œç”¨å’Œä½¿ç”¨æ–¹æ³•ã€‚</p><h3 id="crypto-checkprime-candidate-options-callback" tabindex="-1"><a class="header-anchor" href="#crypto-checkprime-candidate-options-callback"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptocheckprimecandidate-options-callback" target="_blank" rel="noopener noreferrer">crypto.checkPrime(candidate[, options], callback)</a></span></a></h3><p><code>crypto.checkPrime(candidate[, options], callback)</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—æä¾›çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæ£€æŸ¥ä¸€ä¸ªæ•°å­—æ˜¯å¦æ˜¯è´¨æ•°ã€‚å®ƒåœ¨ Node.js çš„æŸäº›ç‰ˆæœ¬ä¸­å‡ºç°å¹¶ä¸”å¯èƒ½ä¼šéšç€æ—¶é—´æœ‰æ‰€æ”¹å˜æˆ–æ›´æ–°ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯è´¨æ•°ã€‚è´¨æ•°æ˜¯æŒ‡åªèƒ½è¢« 1 å’Œå®ƒè‡ªèº«æ•´é™¤çš„å¤§äº 1 çš„æ•´æ•°ã€‚ä¾‹å¦‚ï¼Œ2ã€3ã€5ã€7 ç­‰éƒ½æ˜¯è´¨æ•°ï¼Œå› ä¸ºä½ ä¸èƒ½æ‰¾åˆ°å…¶ä»–çš„ä¹˜æ•°å¯ä»¥å°†å…¶æ•´é™¤ã€‚</p><p>åœ¨ <code>crypto</code> æ¨¡å—çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œæ£€æŸ¥è´¨æ•°é€šå¸¸ä¸åŠ å¯†ç®—æ³•ç›¸å…³ï¼Œå› ä¸ºè´¨æ•°åœ¨åˆ›å»ºå®‰å…¨å¯†é’¥æ—¶å¾ˆé‡è¦ï¼Œå°¤å…¶æ˜¯åœ¨å¦‚ RSA è¿™æ ·çš„å…¬é’¥/ç§é’¥åŠ å¯†ç®—æ³•ä¸­ã€‚</p><p>ä¸‹é¢æ˜¯ <code>crypto.checkPrime</code> å‡½æ•°å‚æ•°çš„è§£é‡Šï¼š</p><ul><li><code>candidate</code>: è¿™æ˜¯ä½ æƒ³è¦æ£€æŸ¥çš„æ•°å­—ï¼Œå®ƒåº”è¯¥æ˜¯ä¸€ä¸ªå¯èƒ½çš„è´¨æ•°ã€‚</li><li><code>options</code> (å¯é€‰): è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå…è®¸ä½ é…ç½®æ£€æŸ¥è´¨æ•°çš„ä¸€äº›ç»†èŠ‚ï¼Œæ¯”å¦‚ä½¿ç”¨çš„ç®—æ³•å’Œæ£€æŸ¥çš„å¼ºåº¦ç­‰ã€‚</li><li><code>callback</code>: å½“è´¨æ•°æ£€æŸ¥å®Œæˆæ—¶ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚å®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªé”™è¯¯å¯¹è±¡ï¼ˆå¦‚æœæœ‰é”™è¯¯å‘ç”Ÿçš„è¯ï¼‰å’Œä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤º <code>candidate</code> æ˜¯å¦æ˜¯è´¨æ•°ã€‚</li></ul><p>ä¸‹é¢æ˜¯å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®šä¹‰ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥å¤„ç†æ£€æŸ¥ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> checkPrimeCallback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">isPrime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ£€æŸ¥è¿‡ç¨‹ä¸­å‡ºé”™:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isPrime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ•°å­—æ˜¯è´¨æ•°!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ•°å­—ä¸æ˜¯è´¨æ•°.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥ä¸€ä¸ªæ•°å­—æ˜¯å¦æ˜¯è´¨æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">checkPrime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">19</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">checkPrimeCallback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åº”è¯¥è¾“å‡º &quot;æ•°å­—æ˜¯è´¨æ•°!&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ options å‚æ•°æŒ‡å®š Miller-Rabin è´¨æ•°æµ‹è¯•çš„æ¬¡æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> options</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">checks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">checkPrime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">21</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">checkPrimeCallback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åº”è¯¥è¾“å‡º &quot;æ•°å­—ä¸æ˜¯è´¨æ•°.&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ç¬¬ä¸€ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ£€æŸ¥æ•°å­— 19 æ˜¯å¦æ˜¯è´¨æ•°ï¼Œå¹¶å®šä¹‰äº†ä¸€ä¸ªç®€å•çš„å›è°ƒå‡½æ•°æ¥å¤„ç†ç»“æœã€‚åœ¨ç¬¬äºŒä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>options</code> å¯¹è±¡æ¥æŒ‡å®šåœ¨æ‰§è¡Œ Miller-Rabin è´¨æ•°æ€§æ£€æŸ¥æ—¶åº”è¯¥è¿›è¡Œå¤šå°‘æ¬¡æµ‹è¯•ã€‚</p><p>è¯·æ³¨æ„ï¼Œæ£€æŸ¥ä¸€ä¸ªæ•°å­—æ˜¯å¦æ˜¯è´¨æ•°åœ¨è®¡ç®—ä¸Šå¯èƒ½æ˜¯éå¸¸å¯†é›†ä¸”è€—æ—¶çš„æ“ä½œï¼Œç‰¹åˆ«æ˜¯å½“æ•°å­—éå¸¸å¤§æ—¶ã€‚ç”±äº Node.js æ˜¯å•çº¿ç¨‹çš„ï¼Œé•¿æ—¶é—´è¿è¡Œçš„å¯†é›†æ“ä½œå¯èƒ½ä¼šé˜»å¡äº‹ä»¶å¾ªç¯ï¼Œä»è€Œå½±å“ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ã€‚å› æ­¤ï¼Œ<code>crypto.checkPrime</code> æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œä½¿ç”¨å›è°ƒå‡½æ•°æ¥å¤„ç†ç»“æœï¼Œä»¥é¿å…é˜»å¡äº‹ä»¶å¾ªç¯ã€‚</p><h3 id="crypto-checkprimesync-candidate-options" tabindex="-1"><a class="header-anchor" href="#crypto-checkprimesync-candidate-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptocheckprimesynccandidate-options" target="_blank" rel="noopener noreferrer">crypto.checkPrimeSync(candidate[, options])</a></span></a></h3><p><code>crypto.checkPrimeSync(candidate[, options])</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œå®ƒç”¨æ¥æ£€æµ‹ä¸€ä¸ªæ•°æ˜¯å¦æ˜¯è´¨æ•°ã€‚åœ¨å¯†ç å­¦ä¸­ï¼Œè´¨æ•°æœ‰å¾ˆé‡è¦çš„åœ°ä½ï¼Œå› ä¸ºå®ƒä»¬æ˜¯æ„å»ºå®‰å…¨åŠ å¯†ç®—æ³•çš„åŸºç¡€ï¼Œä¾‹å¦‚ RSA ç®—æ³•ã€‚</p><p>åœ¨ Node.js çš„<code>crypto</code>æ¨¡å—ä¸­ï¼Œè¿™ä¸ªæ–¹æ³•æä¾›äº†ä¸€ä¸ªç®€å•çš„æ–¹å¼æ¥éªŒè¯ä¸€ä¸ªæ•°å­—æ˜¯å¦ä¸ºè´¨æ•°ã€‚è¿™æ˜¯ä¸€ä¸ªåŒæ­¥æ“ä½œï¼Œæ„å‘³ç€å½“ä½ è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œå®ƒä¼šé˜»å¡ä½ çš„ç¨‹åºç›´åˆ°æ“ä½œå®Œæˆã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>candidate</code>ï¼šè¿™æ˜¯ä½ æƒ³è¦æ£€æŸ¥æ˜¯å¦ä¸ºè´¨æ•°çš„æ•°å­—ã€‚</li><li><code>options</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå…¶ä¸­å¯ä»¥è®¾ç½®å¦‚ä½•è¿›è¡Œè´¨æ•°æ£€æµ‹çš„é…ç½®é€‰é¡¹ã€‚ä¾‹å¦‚ï¼Œå®ƒå…è®¸ä½ æŒ‡å®šéšæœºæ€§æ£€æŸ¥çš„æ¬¡æ•°ï¼Œä»¥æä¾›è´¨æ•°æ£€æµ‹çš„å‡†ç¡®åº¦ä¸æ€§èƒ½ä¹‹é—´çš„æŠ˜è¡·ã€‚</li></ul><p>ä¸‹é¢ä¸¾ä¸¤ä¸ªä¾‹å­æ¥å±•ç¤ºå¦‚ä½•ä½¿ç”¨<code>crypto.checkPrimeSync()</code>ï¼š</p><p><strong>ä¾‹å­ 1ï¼šæ£€æŸ¥ä¸€ä¸ªå°æ•°å­—æ˜¯å¦ä¸ºè´¨æ•°</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥æ•°å­— 11 æ˜¯å¦ä¸ºè´¨æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> isPrime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">checkPrimeSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">11</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Is 11 a prime number?&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isPrime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åº”è¯¥è¾“å‡ºï¼šIs 11 a prime number? true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ£€æŸ¥æ•°å­— 11 æ˜¯å¦ä¸ºè´¨æ•°ã€‚ç”±äº 11 åªèƒ½è¢« 1 å’Œå®ƒæœ¬èº«æ•´é™¤ï¼Œæ‰€ä»¥<code>checkPrimeSync()</code>ä¼šè¿”å›<code>true</code>ï¼Œè¡¨ç¤ºå®ƒæ˜¯ä¸€ä¸ªè´¨æ•°ã€‚</p><p><strong>ä¾‹å­ 2ï¼šä½¿ç”¨é€‰é¡¹æ£€æŸ¥ä¸€ä¸ªè¾ƒå¤§æ•°å­—æ˜¯å¦ä¸ºè´¨æ•°</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥æ•°å­—æ˜¯å¦ä¸ºè´¨æ•°ï¼Œå¹¶ä¼ å…¥optionsé…ç½®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> options</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  checks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿›è¡Œ10è½®éšæœºæ€§æ£€æŸ¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bigNumber</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;14348907&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¸€ä¸ªå¤§æ•°å­—ï¼ˆæ­¤å¤„ä»…ä½œä¸ºç¤ºä¾‹ï¼‰</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> isPrime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">checkPrimeSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bigNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Is </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bigNumber</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> a prime number?`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isPrime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ç¬¬äºŒä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°è¯•æ£€æŸ¥ä¸€ä¸ªæ›´å¤§çš„æ•°å­—æ˜¯å¦ä¸ºè´¨æ•°ï¼ŒåŒæ—¶ä¼ é€’äº†ä¸€ä¸ª<code>options</code>å¯¹è±¡ï¼Œå…¶ä¸­æŒ‡å®šäº†<code>checks</code>å±æ€§ä¸º 10ï¼Œè¿™å‘Šè¯‰ Node.js è¿›è¡Œ 10 æ¬¡éšæœºæ€§æ£€æŸ¥ä»¥ç¡®å®šè¿™ä¸ªæ•°å­—æ˜¯å¦ä¸ºè´¨æ•°ã€‚è¿™ç§æ–¹æ³•æé«˜äº†æ£€æµ‹ç»“æœçš„å¯ä¿¡åº¦ï¼Œä½†åŒæ—¶ä¹Ÿéœ€è¦æ›´å¤šçš„è®¡ç®—èµ„æºå’Œæ—¶é—´ã€‚</p><p>è¯·æ³¨æ„ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯¹äºéå¸¸å¤§çš„æ•°å­—ï¼Œä½¿ç”¨åŒæ­¥æ–¹æ³•æ£€æŸ¥è´¨æ•°å¯èƒ½å¹¶ä¸ç†æƒ³ï¼Œå› ä¸ºå®ƒå°†ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œä»è€Œå½±å“ç¨‹åºçš„å“åº”æ€§ã€‚åœ¨é‚£ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨å¼‚æ­¥ç‰ˆæœ¬<code>crypto.checkPrime()</code>ä¼šæ›´åˆé€‚ã€‚</p><h3 id="crypto-createcipher-algorithm-password-options" tabindex="-1"><a class="header-anchor" href="#crypto-createcipher-algorithm-password-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptocreatecipheralgorithm-password-options" target="_blank" rel="noopener noreferrer">crypto.createCipher(algorithm, password[, options])</a></span></a></h3><p><code>crypto.createCipher(algorithm, password[, options])</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥åˆ›å»ºä¸€ä¸ªåŠ å¯†å™¨å¯¹è±¡ã€‚è¿™ä¸ªåŠ å¯†å™¨å¯ä»¥å°†æ•°æ®åŠ å¯†æˆæ— æ³•ç›´æ¥é˜…è¯»çš„æ ¼å¼ï¼Œå¢åŠ æ•°æ®çš„å®‰å…¨æ€§ã€‚</p><p>è®©æˆ‘ä»¬ä¸€æ­¥æ­¥åˆ†è§£ï¼š</p><ol><li><p><strong>crypto æ¨¡å—</strong>ï¼šè¿™æ˜¯ Node.js çš„ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œæä¾›äº†åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯¹ç§°åŠ å¯†ã€å“ˆå¸Œç®—æ³•ã€å„ç§ç¼–ç è§£ç ç­‰ã€‚</p></li><li><p><strong>algorithm</strong>ï¼šæŒ‡å®šåŠ å¯†ä½¿ç”¨çš„ç®—æ³•ã€‚ä¾‹å¦‚ï¼ŒAESï¼ˆAdvanced Encryption Standardï¼‰æ˜¯ä¸€ç§å¸¸ç”¨çš„åŠ å¯†ç®—æ³•ã€‚ä½ éœ€è¦æ ¹æ®ä½ çš„å®‰å…¨éœ€æ±‚é€‰æ‹©åˆé€‚çš„ç®—æ³•ã€‚</p></li><li><p><strong>password</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªç§˜é’¥ï¼Œç”¨äºç”ŸæˆåŠ å¯†æ—¶æ‰€éœ€çš„å¯†é’¥ã€‚ä½ å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯ä¸€ç§å¯†ç ï¼Œå¿…é¡»ä¿æŒæœºå¯†ï¼Œå› ä¸ºæœ‰äº†è¿™ä¸ªå¯†ç å°±å¯ä»¥è§£å¯†æ•°æ®ã€‚</p></li><li><p><strong>options</strong>ï¼šå¯é€‰å‚æ•°ï¼Œå…è®¸ä½ æ›´ç²¾ç»†åœ°æ§åˆ¶åŠ å¯†è¿‡ç¨‹ï¼Œæ¯”å¦‚è¾“å‡ºçš„ç¼–ç æ–¹å¼ç­‰ã€‚</p></li></ol><p>ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><h3 id="å®ä¾‹-1-åŠ å¯†æ–‡æœ¬" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-1-åŠ å¯†æ–‡æœ¬"><span>å®ä¾‹ 1ï¼šåŠ å¯†æ–‡æœ¬</span></a></h3><p>å‡è®¾ä½ æƒ³è¦åŠ å¯†ä¸€æ®µé‡è¦çš„ä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·çš„å¯†ç æˆ–è€…ä¸ªäººä¿¡æ¯ã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŠ å¯†çš„ç®—æ³•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> algorithm</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;aes-192-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”¨äºåŠ å¯†çš„å¯†ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> password</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;my-secret-password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ ¹æ®ç®—æ³•å’Œå¯†ç åˆ›å»ºä¸€ä¸ªå¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">scryptSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;salt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">24</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºéšæœºåˆå§‹åŒ–å‘é‡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆå§‹åŒ–å‘é‡åº”è¯¥æ˜¯éšæœºçš„ï¼Œè¿™é‡Œä¸ºäº†ç¤ºä¾‹ç®€å•ä½¿ç”¨äº†ç©ºç¼“å†²åŒº</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºåŠ å¯†å™¨å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">algorithm</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç›‘å¬&#39;data&#39;äº‹ä»¶è·å–åŠ å¯†åçš„æ•°æ®ç‰‡æ®µ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç›‘å¬&#39;end&#39;äº‹ä»¶è·å–æœ€åçš„åŠ å¯†æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å†™å…¥éœ€è¦åŠ å¯†çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¦åŠ å¯†çš„æ•æ„Ÿä¿¡æ¯&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¡¨ç¤ºå·²ç»å®Œæˆäº†åŠ å¯†æ•°æ®çš„å†™å…¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç åˆ›å»ºäº†ä¸€ä¸ªåŸºäº AES ç®—æ³•çš„åŠ å¯†å™¨ï¼Œå®ƒä¼šè¾“å‡ºåŠ å¯†ä¹‹åçš„æ•°æ®ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬æ²¡æœ‰ç›´æ¥ä½¿ç”¨ <code>createCipher</code> æ–¹æ³•ï¼Œè€Œæ˜¯ä½¿ç”¨äº† <code>createCipheriv</code>ã€‚è¿™æ˜¯å› ä¸º <code>createCipher</code> æ–¹æ³•å·²è¢«å¼ƒç”¨ï¼Œä¸å†å»ºè®®ä½¿ç”¨ï¼Œå› å…¶ä½¿ç”¨å¯†ç ç›´æ¥ä½œä¸ºå¯†é’¥å¯èƒ½å¯¼è‡´å®‰å…¨æ¼æ´ã€‚</p><h3 id="å®ä¾‹-2-åŠ å¯†æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-2-åŠ å¯†æ–‡ä»¶"><span>å®ä¾‹ 2ï¼šåŠ å¯†æ–‡ä»¶</span></a></h3><p>å‡å¦‚ä½ æƒ³è¦åŠ å¯†ä¸€ä¸ªå­˜å‚¨åœ¨ç¡¬ç›˜ä¸Šçš„æ–‡ä»¶å†…å®¹ã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> algorithm</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;aes-192-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> password</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;my-secret-password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">scryptSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;salt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">24</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">algorithm</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> input</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createReadStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;secret-file.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¾…åŠ å¯†çš„æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> output</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createWriteStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;secret-file.enc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŠ å¯†åçš„æ–‡ä»¶</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†æ–‡ä»¶æµé€šè¿‡åŠ å¯†å™¨è½¬æ¢ï¼Œç„¶åè¾“å‡ºåˆ°å¦ä¸€ä¸ªæ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">input</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">pipe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">pipe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">output</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">output</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;finish&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ–‡ä»¶åŠ å¯†å®Œæˆã€‚&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>fs</code> æ¨¡å—æ¥è¯»å–å’Œå†™å…¥æ–‡ä»¶ï¼Œå¹¶åˆ©ç”¨ç®¡é“ (<code>pipe</code>) æŠŠè¯»å–çš„æµé€šè¿‡åŠ å¯†å™¨è½¬æ¢ï¼Œç„¶åè¾“å‡ºåˆ°æ–°çš„åŠ å¯†æ–‡ä»¶ä¸­ã€‚å½“åŠ å¯†æµå®Œæˆæ—¶ï¼Œä¼šè§¦å‘ <code>finish</code> äº‹ä»¶ï¼Œæˆ‘ä»¬ä¾¿çŸ¥é“åŠ å¯†å·¥ä½œå·²ç»ç»“æŸã€‚</p><p>è®°ä½ï¼Œè™½ç„¶ Node.js ä½¿å¾—åŠ å¯†å˜å¾—ç›¸å¯¹ç®€å•ï¼Œä½†æ˜¯åŠ å¯†æ˜¯ä¸€ä¸ªå¤æ‚ä¸”é‡è¦çš„è¯é¢˜ã€‚å®é™…éƒ¨ç½²åŠ å¯†æ–¹æ¡ˆæ—¶ï¼Œä½ éœ€è¦ç¡®ä¿éµå¾ªæœ€ä½³å®è·µï¼Œè€ƒè™‘æ¯”å¦‚å¯†é’¥ç®¡ç†ã€åŠ å¯†ç®—æ³•çš„é€‰æ‹©å’Œé…ç½®ç­‰å› ç´ ã€‚</p><h3 id="crypto-createcipheriv-algorithm-key-iv-options" tabindex="-1"><a class="header-anchor" href="#crypto-createcipheriv-algorithm-key-iv-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptocreatecipherivalgorithm-key-iv-options" target="_blank" rel="noopener noreferrer">crypto.createCipheriv(algorithm, key, iv[, options])</a></span></a></h3><p>å¥½çš„ï¼ŒNode.js ä¸­çš„ <code>crypto.createCipheriv()</code> æ–¹æ³•æ˜¯ç”¨æ¥åˆ›å»ºä¸€ä¸ªåŠ å¯†å™¨å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥ç”¨æ¥åŠ å¯†æ•°æ®ã€‚è¿™é‡Œçš„ &quot;iv&quot; æ˜¯æŒ‡åˆå§‹åŒ–å‘é‡(Initialization Vector)ï¼Œå®ƒæ˜¯ä¸€ç§åœ¨åŠ å¯†è¿‡ç¨‹ä¸­ä½¿ç”¨çš„æ•°æ®å—ï¼Œä¸å¯†é’¥(key)ä¸€èµ·ç”¨æ¥ç¡®ä¿å³ä½¿ç›¸åŒçš„æ•°æ®è¢«åŠ å¯†å¤šæ¬¡ï¼Œæ¯æ¬¡ç”Ÿæˆçš„åŠ å¯†æ–‡æœ¬éƒ½ä¸ç›¸åŒï¼Œå¢å¼ºäº†åŠ å¯†çš„å®‰å…¨æ€§ã€‚</p><p>åœ¨è¯¦ç»†è§£é‡Šä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£ä»¥ä¸‹å‡ ä¸ªæ¦‚å¿µï¼š</p><ol><li><p><strong>ç®—æ³•(algorithm)</strong>: è¿™æŒ‡çš„æ˜¯åŠ å¯†ç®—æ³•ï¼Œä¾‹å¦‚ AESã€DES ç­‰ï¼Œå®ƒå®šä¹‰äº†å¦‚ä½•å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚</p></li><li><p><strong>å¯†é’¥(key)</strong>: åŠ å¯†å’Œè§£å¯†æ•°æ®æ—¶ä½¿ç”¨çš„ç§˜å¯†å­—èŠ‚åºåˆ—ï¼Œé€šå¸¸ç”±å¯†ç æˆ–å…¶ä»–æœºåˆ¶ç”Ÿæˆã€‚</p></li><li><p><strong>åˆå§‹åŒ–å‘é‡(iv)</strong>: ä¸€ä¸ªéšæœºçš„å­—èŠ‚åºåˆ—ï¼Œç”¨äºé…åˆå¯†é’¥æä¾›åŠ å¯†ç®—æ³•çš„åˆå§‹çŠ¶æ€ã€‚</p></li><li><p><strong>é€‰é¡¹(options)</strong>: å¯ä»¥æä¾›é¢å¤–çš„é…ç½®é€‰é¡¹ï¼Œä¾‹å¦‚è¾“å‡ºç¼–ç æ ¼å¼ç­‰ã€‚</p></li></ol><p>ç°åœ¨è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®é™…ä¾‹å­æ¥çœ‹çœ‹ <code>crypto.createCipheriv()</code> å¦‚ä½•å·¥ä½œï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®šä¹‰åŠ å¯†ç®—æ³•å’Œæ¨¡å¼ï¼Œä¾‹å¦‚ AES-256-CBC</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> algorithm</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;aes-256-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªéšæœºçš„å¯†é’¥ï¼ˆ32 å­—èŠ‚ï¼Œå› ä¸ºæ˜¯ AES-256ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªéšæœºçš„åˆå§‹åŒ–å‘é‡ï¼ˆ16 å­—èŠ‚ï¼Œå› ä¸ºæ˜¯ AES çš„ block sizeï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºåŠ å¯†å™¨å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">algorithm</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¢é˜…æ•°æ®æ¥æ”¶äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;readable&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  while</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">null</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> !==</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">chunk</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">read</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">())) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¢é˜…ç»“æŸäº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`åŠ å¯†çš„å†…å®¹ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŠ å¯†ä¸€äº›æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secretMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;è¿™æ˜¯ä¸€ä¸ªç§˜å¯†æ¶ˆæ¯&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secretMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ­¤æ—¶ `encrypted` å˜é‡åŒ…å«äº† `secretMessage` åŠ å¯†åçš„æ•°æ®ã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥ Node.js çš„ <code>crypto</code> æ¨¡å—ï¼Œç„¶åå®šä¹‰æˆ‘ä»¬è¦ä½¿ç”¨çš„åŠ å¯†ç®—æ³• AES-256-CBCã€‚ç„¶åï¼Œæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ªå¯†é’¥å’Œä¸€ä¸ªåˆå§‹åŒ–å‘é‡ã€‚æ¥ç€ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>crypto.createCipheriv()</code> æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„åŠ å¯†å™¨å®ä¾‹ã€‚</p><p>é€šè¿‡ç›‘å¬ <code>readable</code> äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥è¯»å–åˆ°åŠ å¯†å™¨ç”Ÿæˆçš„åŠ å¯†æ•°æ®ï¼Œç„¶åæŠŠå®ƒæ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶ä¸”åœ¨ç»“æŸæ—¶æ‰“å°å‡ºæ¥ã€‚æœ€åï¼Œæˆ‘ä»¬å‘åŠ å¯†å™¨å†™å…¥äº†è¦åŠ å¯†çš„ä¿¡æ¯ï¼Œå¹¶è°ƒç”¨ <code>.end()</code> æ–¹æ³•æ¥è¡¨ç¤ºæˆ‘ä»¬å·²ç»å®Œæˆäº†æ•°æ®çš„è¾“å…¥ã€‚</p><p>è¯·æ³¨æ„ï¼Œä¸Šé¢çš„ä»£ç åªæ¼”ç¤ºäº†åŠ å¯†çš„è¿‡ç¨‹ã€‚è¦è·å¾—å¯é€†çš„ç»“æœï¼Œä½ è¿˜éœ€è¦ç”¨ç›¸åº”çš„è§£å¯†è¿‡ç¨‹æ¥å°†åŠ å¯†çš„æ•°æ®è½¬æ¢å›åŸå§‹å½¢å¼ã€‚è§£å¯†å°†ä¼šä½¿ç”¨ <code>crypto.createDecipheriv()</code> æ–¹æ³•ï¼ŒåŒæ—¶ä½¿ç”¨ç›¸åŒçš„ç®—æ³•ã€å¯†é’¥å’Œåˆå§‹åŒ–å‘é‡ã€‚</p><h3 id="crypto-createdecipher-algorithm-password-options" tabindex="-1"><a class="header-anchor" href="#crypto-createdecipher-algorithm-password-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptocreatedecipheralgorithm-password-options" target="_blank" rel="noopener noreferrer">crypto.createDecipher(algorithm, password[, options])</a></span></a></h3><p>Node.js ä¸­çš„ <code>crypto.createDecipher</code> æ–¹æ³•ç”¨äºåˆ›å»ºä¸€ä¸ªè§£å¯†å™¨ï¼Œè¿™ä¸ªè§£å¯†å™¨å¯ä»¥å°†åŠ å¯†è¿‡çš„æ•°æ®æ¢å¤æˆåŸå§‹å½¢å¼ã€‚åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œ<code>crypto.createDecipher</code> å·²è¢«åºŸå¼ƒï¼Œæ„å‘³ç€ä¸å»ºè®®ä½¿ç”¨è¿™ä¸ªæ–¹æ³•è¿›è¡Œç¼–ç¨‹ï¼Œå› ä¸ºå®ƒå¯èƒ½åœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­ä¼šè¢«ç§»é™¤æˆ–è€…ä¿®æ”¹ã€‚</p><p>ä¸è¿‡ï¼Œä¸ºäº†å¸®åŠ©ä½ ç†è§£å…¶å·¥ä½œåŸç†ï¼Œæˆ‘è¿˜æ˜¯ä¼šä»¥é€šä¿—æ˜“æ‡‚çš„æ–¹å¼è§£é‡Šä¸€ä¸‹è¿™ä¸ªå‡½æ•°ï¼Œå¹¶ç»™å‡ºå‡ ä¸ªä¾‹å­ã€‚</p><p>é¦–å…ˆï¼Œå½“ä½ æƒ³è¦è§£å¯†ä¸€ä¸ªåŠ å¯†è¿‡çš„æ•°æ®æ—¶ï¼Œä½ éœ€è¦ä¸¤ä»¶äº‹ï¼š</p><ol><li>åŠ å¯†æ—¶ä½¿ç”¨çš„ç®—æ³•ï¼ˆalgorithmï¼‰ï¼šæ¯”å¦‚ AES-256-CBCã€‚</li><li>ç”¨æ¥åŠ å¯†æ•°æ®çš„å¯†ç ï¼ˆpasswordï¼‰ï¼šè¿™ä¸ªå¯†ç åœ¨åŠ å¯†å’Œè§£å¯†æ—¶å¿…é¡»ä¸€è‡´ã€‚</li></ol><p><code>crypto.createDecipher</code> æ­£æ˜¯æ¥æ”¶è¿™ä¸¤ä¸ªå‚æ•°æ¥åˆ›å»ºä¸€ä¸ªè§£å¯†å™¨çš„å‡½æ•°ã€‚å¦å¤–ï¼Œä½ è¿˜å¯ä»¥ä¼ é€’ä¸€ä¸ªå¯é€‰çš„ <code>options</code> å¯¹è±¡æ¥æŒ‡å®šæ›´å¤šçš„é…ç½®ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-2"><span>å®é™…è¿ç”¨ç¤ºä¾‹ï¼š</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹çš„åŠ å¯†æ•°æ®ï¼Œä»¥åŠç”¨äºåŠ å¯†è¿™äº›æ•°æ®çš„ç®—æ³•å’Œå¯†ç ã€‚</p><p>åŠ å¯†æ•°æ®ï¼ˆå‡è®¾æ˜¯ç”¨ base64 ç¼–ç çš„å­—ç¬¦ä¸²ï¼‰ï¼š<code>&#39;encryptedData&#39;</code><br> ä½¿ç”¨çš„åŠ å¯†ç®—æ³•ï¼š<code>&#39;aes-192-cbc&#39;</code><br> åŠ å¯†æ—¶ä½¿ç”¨çš„å¯†ç ï¼š<code>&#39;mySecretPassword&#39;</code></p><p>**æ³¨æ„ï¼š**å¦‚ä¸‹ä¾‹æ‰€å±•ç¤ºçš„æ–¹å¼å¹¶ä¸å®‰å…¨ï¼Œå› ä¸ºå®ƒæ²¡æœ‰æŒ‡å®šåˆå§‹åŒ–å‘é‡ï¼ˆIVï¼‰ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ä½ åº”è¯¥æ€»æ˜¯ä½¿ç”¨ IV æ¥è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ Node.js è„šæœ¬ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>crypto.createDecipher</code> æ–¹æ³•è§£å¯†ä¸Šé¢æåˆ°çš„æ•°æ®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å£°æ˜åŠ å¯†æ—¶ä½¿ç”¨çš„ç®—æ³•å’Œå¯†ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> algorithm</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;aes-192-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> password</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;mySecretPassword&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯æˆ‘ä»¬æƒ³è¦è§£å¯†çš„æ•°æ®ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ª Buffer æˆ–è€…ä¸€ä¸ª base64 ç¼–ç çš„å­—ç¬¦ä¸²ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encryptedData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;encryptedData&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»º decipher è§£å¯†å™¨å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDecipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">algorithm</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> decrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;readable&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  while</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">null</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> !==</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">chunk</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">read</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">())) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    decrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ‰“å°è§£å¯†åçš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å†™å…¥åŠ å¯†çš„æ•°æ®ï¼Œå¹¶è¡¨ç¤ºç»“æŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encryptedData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">decipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ä½ è¿è¡Œè¿™æ®µä»£ç æ—¶ï¼Œå®ƒä¼šå°è¯•è§£å¯† <code>encryptedData</code>ï¼Œç„¶åè¾“å‡ºè§£å¯†åçš„å†…å®¹ã€‚</p><p>è¯·è®°ä½ï¼Œç”±äº <code>crypto.createDecipher</code> æ˜¯å·²åºŸå¼ƒçš„ï¼Œå®˜æ–¹æ¨èä½¿ç”¨ <code>crypto.createDecipheriv</code> å‡½æ•°ï¼Œå¹¶æ˜¾å¼åœ°ä¼ å…¥åˆå§‹åŒ–å‘é‡ï¼ˆIVï¼‰ã€‚è¿™æ˜¯å› ä¸ºéšæœºåŒ–çš„ IV ä¼šä½¿å¾—åŠ å¯†æ›´åŠ å®‰å…¨ï¼Œè€Œæ—§çš„ <code>createDecipher</code> æ–¹æ³•å¹¶ä¸å¼ºåˆ¶è¦æ±‚ IVã€‚</p><p>åœ¨ç¼–å†™å®‰å…¨æ•æ„Ÿçš„ç¨‹åºæ—¶ï¼Œå»ºè®®å‚è€ƒ Node.js çš„æœ€æ–°æ–‡æ¡£ï¼Œä½¿ç”¨å½“å‰æ¨èçš„ API å’Œå®è·µï¼Œç¡®ä¿ä»£ç çš„å®‰å…¨æ€§å’Œæœªæ¥å…¼å®¹æ€§ã€‚</p><h3 id="crypto-createdecipheriv-algorithm-key-iv-options" tabindex="-1"><a class="header-anchor" href="#crypto-createdecipheriv-algorithm-key-iv-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptocreatedecipherivalgorithm-key-iv-options" target="_blank" rel="noopener noreferrer">crypto.createDecipheriv(algorithm, key, iv[, options])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­ <code>crypto.createDecipheriv</code> è¿™ä¸ªå‡½æ•°ã€‚</p><p>é¦–å…ˆï¼Œ<code>crypto</code> æ˜¯ Node.js å†…ç½®çš„ä¸€ä¸ªæ¨¡å—ï¼Œå®ƒæä¾›äº†åŒ…æ‹¬åŠ å¯†è§£å¯†åœ¨å†…çš„è®¸å¤šå¯†ç å­¦åŠŸèƒ½ã€‚<code>createDecipheriv</code> æ˜¯è¿™ä¸ªæ¨¡å—ä¸­ç”¨äºåˆ›å»ºä¸€ä¸ªè§£å¯†å™¨å¯¹è±¡çš„å‡½æ•°ï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥ç”¨æ¥è§£å¯†æ•°æ®ã€‚</p><h3 id="å‚æ•°è§£é‡Š-1" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-1"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>algorithm</code>ï¼šè¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºä½ è¦ä½¿ç”¨çš„åŠ å¯†ç®—æ³•ï¼Œä¾‹å¦‚ <code>&#39;aes-256-cbc&#39;</code>ã€‚</li><li><code>key</code>ï¼šè¿™æ˜¯ç”¨äºè§£å¯†çš„å¯†é’¥ï¼Œé€šå¸¸å®ƒæ˜¯ä¸€ä¸ª Buffer å¯¹è±¡æˆ–è€…ä¸€ä¸ªäºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚</li><li><code>iv</code>ï¼šå…¨ç§°æ˜¯ &quot;Initialization Vector</li></ul><h3 id="crypto-creatediffiehellman-prime-primeencoding-generator-generatorencoding" tabindex="-1"><a class="header-anchor" href="#crypto-creatediffiehellman-prime-primeencoding-generator-generatorencoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptocreatediffiehellmanprime-primeencoding-generator-generatorencoding" target="_blank" rel="noopener noreferrer">crypto.createDiffieHellman(prime[, primeEncoding][, generator][, generatorEncoding])</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘æ¥ä¸ºä½ è¯¦ç»†è§£é‡Š Node.js ä¸­ <code>crypto.createDiffieHellman</code> çš„ç”¨æ³•ã€‚</p><p>é¦–å…ˆï¼Œ<code>crypto.createDiffieHellman</code> æ˜¯ Node.js ä¸­ä¸€ä¸ªç”¨äºåˆ›å»º Diffie-Hellman å¯†é’¥äº¤æ¢çš„æ–¹æ³•ã€‚è¿™æ˜¯ä¸€ä¸ªåœ¨æ²¡æœ‰äº‹å…ˆå…±äº«ç§˜å¯†çš„æƒ…å†µä¸‹ï¼Œåœ¨é€šä¿¡åŒæ–¹ä¹‹é—´å®‰å…¨åœ°äº¤æ¢åŠ å¯†å¯†é’¥çš„æ–¹å¼ã€‚</p><p>è¯¥æ–¹æ³•éœ€è¦ä¸€äº›å‚æ•°ï¼š</p><ol><li><code>prime</code> - ä¸€ä¸ªè´¨æ•°ï¼ˆPrimeï¼‰ï¼Œå®ƒæ˜¯æ•´ä¸ªåŠ å¯†è¿‡ç¨‹çš„åŸºç¡€ã€‚å®ƒå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€Bufferã€TypedArrayã€DataView æˆ–è€… BigIntã€‚</li><li><code>primeEncoding</code> (å¯é€‰) - æŒ‡å®š <code>prime</code> å‚æ•°çš„ç¼–ç ï¼Œä¾‹å¦‚ &#39;utf8&#39;, &#39;ascii&#39;, &#39;binary&#39;, &#39;base64&#39; ç­‰ã€‚</li><li><code>generator</code> (å¯é€‰) - åœ¨ Diffie-Hellman åè®®ä¸­ç”¨äºç”Ÿæˆå¯†é’¥çš„å€¼ï¼Œé»˜è®¤ä¸º 2ã€‚</li><li><code>generatorEncoding</code> (å¯é€‰) - æŒ‡å®š <code>generator</code> å‚æ•°çš„ç¼–ç ã€‚</li></ol><p>ç°åœ¨ï¼Œæˆ‘å°†é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥å±•ç¤ºå¦‚ä½•ä½¿ç”¨ <code>crypto.createDiffieHellman</code>ã€‚</p><p>å‡è®¾ Alice å’Œ Bob æƒ³è¦é€šè¿‡ä¸å®‰å…¨çš„æ¸ é“ï¼ˆæ¯”å¦‚äº’è”ç½‘ï¼‰å®‰å…¨åœ°å…±äº«ä¸€ä¸ªå¯†é’¥ã€‚ä»–ä»¬å¯ä»¥ä½¿ç”¨ Diffie-Hellman å¯†é’¥äº¤æ¢ç®—æ³•æ¥å®ç°ã€‚</p><p>æ­¥éª¤å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice åˆ›å»ºä¸€ä¸ª Diffie-Hellman å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨é»˜è®¤çš„ 2048 ä½è´¨æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice ç”Ÿæˆå¥¹çš„ç§é’¥å’Œå…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob åˆ›å»ºè‡ªå·±çš„ Diffie-Hellman å¯¹è±¡ï¼Œä½¿ç”¨ä¸ Alice ç›¸åŒçš„è´¨æ•°å’Œç”Ÿæˆå™¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPrime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(),</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;binary&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getGenerator</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(),</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;binary&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob åŒæ ·ç”Ÿæˆä»–çš„ç§é’¥å’Œå…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice å’Œ Bob äº¤æ¢å…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alicePublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobPublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice ä½¿ç”¨ Bob çš„å…¬é’¥ç”Ÿæˆå¥¹çš„å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceSecret</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob ä½¿ç”¨ Alice çš„å…¬é’¥ç”Ÿæˆä»–çš„å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobSecret</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">alicePublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨ Alice å’Œ Bob éƒ½æœ‰äº†ç›¸åŒçš„å¯†é’¥ï¼Œå¯ä»¥ç”¨æ¥åŠ å¯†é€šä¿¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliceSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åº”è¯¥è¾“å‡º true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­ä¸­ï¼ŒAlice å’Œ Bob éƒ½åˆ›å»ºäº†ä»–ä»¬å„è‡ªçš„ Diffie-Hellman å®ä¾‹ã€‚ç„¶åï¼Œä»–ä»¬å„è‡ªç”Ÿæˆå…¬é’¥å’Œç§é’¥ï¼Œå¹¶äº¤æ¢å…¬é’¥ã€‚ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥ï¼Œä»–ä»¬èƒ½å¤Ÿç‹¬ç«‹åœ°è®¡ç®—å‡ºä¸€ä¸ªç›¸åŒçš„å¯†é’¥ï¼Œè¯¥å¯†é’¥å¯ä»¥åç»­è¢«ç”¨æ¥åŠ å¯†é€šä¿¡å†…å®¹ã€‚</p><p>é‡è¦çš„æ˜¯ï¼Œå³ä½¿æœ‰äººæˆªè·äº†ä»–ä»¬äº¤æ¢çš„å…¬é’¥ï¼Œç”±äºè®¡ç®—ç§é’¥æ‰€éœ€çš„éš¾åº¦éå¸¸å¤§ï¼Œç¬¬ä¸‰æ–¹ä¹Ÿæ— æ³•è½»æ˜“åœ°æ¨å¯¼å‡ºäº¤æ¢äº§ç”Ÿçš„å¯†é’¥ï¼Œè¿™å°±ç¡®ä¿äº†å¯†é’¥äº¤æ¢çš„å®‰å…¨æ€§ã€‚</p><p>ä¸Šè¿°ä»£ç ç‰‡æ®µæä¾›äº†ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨ <code>crypto.createDiffieHellman</code> æ¥åˆ›å»ºå¹¶ä½¿ç”¨ Diffie-Hellman å¯†é’¥äº¤æ¢åè®®ã€‚åœ¨çœŸå®çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œä½ å¯èƒ½è¿˜éœ€è¦è€ƒè™‘æ›´å¤šçš„å®‰å…¨æœºåˆ¶æ¥ç¡®ä¿æ•´ä¸ªé€šä¿¡è¿‡ç¨‹çš„å®‰å…¨æ€§ã€‚</p><h3 id="crypto-creatediffiehellman-primelength-generator" tabindex="-1"><a class="header-anchor" href="#crypto-creatediffiehellman-primelength-generator"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptocreatediffiehellmanprimelength-generator" target="_blank" rel="noopener noreferrer">crypto.createDiffieHellman(primeLength[, generator])</a></span></a></h3><p>Node.js çš„ <code>crypto.createDiffieHellman</code> æ–¹æ³•ç”¨äºåˆ›å»ºä¸€ä¸ª Diffie-Hellman å¯†é’¥äº¤æ¢çš„å®ä¾‹ã€‚Diffie-Hellman æ˜¯ä¸€ç§å®‰å…¨åè®®ï¼Œç”¨äºå…è®¸ä¸¤ä¸ªé€šä¿¡æ–¹åœ¨ä¸å®‰å…¨çš„é€šé“ä¸Šå»ºç«‹å…±äº«çš„ç§˜å¯†å¯†é’¥ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„å¯†é’¥åå•†ã€‚å®ƒæ˜¯ä¸€ç§ç¡®ä¿é€šä¿¡åŠ å¯†çš„æ–¹æ³•ï¼Œå³ä½¿æœ‰äººèƒ½å¤Ÿç›‘å¬é€šä¿¡åŒæ–¹çš„æ¶ˆæ¯ï¼Œä¹Ÿæ— æ³•è½»æ˜“å¾—çŸ¥ä»–ä»¬æ‰€åå•†å‡ºçš„ç§˜å¯†ã€‚</p><p>ä»¥ä¸‹æ˜¯å…³äºå¦‚ä½•ä½¿ç”¨ <code>crypto.createDiffieHellman</code> æ–¹æ³•çš„è¯¦ç»†è§£é‡Šå’Œç¤ºä¾‹ï¼š</p><h3 id="å‚æ•°-2" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-2"><span>å‚æ•°</span></a></h3><ul><li><code>primeLength</code>: è¿™ä¸ªå‚æ•°æŒ‡å®šäº†è´¨æ•°ï¼ˆprimeï¼‰çš„é•¿åº¦ï¼Œå•ä½æ˜¯ä½ï¼ˆbitï¼‰ã€‚åœ¨åŠ å¯†ä¸­ï¼Œè´¨æ•°æ˜¯ç”¨æ¥ç”Ÿæˆå¯†é’¥çš„åŸºç¡€ï¼Œé•¿åº¦è¶Šé•¿ï¼Œå®‰å…¨æ€§è¶Šé«˜ï¼Œä½†è®¡ç®—æ—¶é—´ä¹Ÿè¶Šé•¿ã€‚</li><li><code>generator</code> (å¯é€‰): è¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œç”¨ä½œç”Ÿæˆå¯†é’¥çš„åŸºæ•°ï¼Œé»˜è®¤æ˜¯ <code>2</code>ã€‚ç”Ÿæˆå™¨å¿…é¡»æ˜¯è´¨æ•°æˆ–è´¨æ•°çš„å¹‚ã€‚</li></ul><h3 id="ä½¿ç”¨æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æ­¥éª¤"><span>ä½¿ç”¨æ­¥éª¤</span></a></h3><ol><li><p><strong>åˆ›å»º Diffie-Hellman å®ä¾‹</strong>ï¼šé¦–å…ˆä½ éœ€è¦åˆ›å»ºä¸€ä¸ª Diffie-Hellman çš„å®ä¾‹ï¼Œä¼ å…¥ä½ æƒ³è¦çš„è´¨æ•°é•¿åº¦ï¼ˆæ›´é•¿çš„è´¨æ•°æ„å‘³ç€æ›´é«˜çš„å®‰å…¨æ€§ä½†åŒæ—¶è®¡ç®—æˆæœ¬ä¹Ÿæ›´é«˜ï¼‰ã€‚</p></li><li><p><strong>ç”Ÿæˆå¯†é’¥</strong>ï¼šé€šè¿‡è°ƒç”¨å®ä¾‹ä¸Šçš„ <code>generateKeys</code> æ–¹æ³•æ¥ç”Ÿæˆå…¬ç§é’¥å¯¹ã€‚</p></li><li><p><strong>äº¤æ¢å…¬é’¥</strong>ï¼šä¸¤ä¸ªé€šä¿¡æ–¹å„è‡ªç”Ÿæˆè‡ªå·±çš„å¯†é’¥å¯¹ï¼Œå¹¶ä¸”äº¤æ¢å…¬é’¥ã€‚</p></li><li><p><strong>ç”Ÿæˆå…±äº«ç§˜å¯†</strong>ï¼šæ¯ä¸ªé€šä¿¡æ–¹ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥å’Œè‡ªå·±çš„ç§é’¥é€šè¿‡ <code>computeSecret</code> æ–¹æ³•è®¡ç®—å‡ºåŒä¸€ä¸ªâ€œå…±äº«ç§˜å¯†â€ã€‚</p></li></ol><h3 id="ç¤ºä¾‹ä»£ç -2" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç -2"><span>ç¤ºä¾‹ä»£ç </span></a></h3><p>å‡è®¾ Alice å’Œ Bob æƒ³è¦å®‰å…¨åœ°é€šä¿¡ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice åˆ›å»ºä¸€ä¸ª Diffie-Hellman å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceKeys</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆ Alice çš„å¯†é’¥å¯¹</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob ä¹Ÿåˆ›å»ºä¸€ä¸ª Diffie-Hellman å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPrime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getGenerator</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobKeys</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆ Bob çš„å¯†é’¥å¯¹</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice å’Œ Bob äº¤æ¢å…¬é’¥ï¼ˆåœ¨ç°å®æƒ…å†µä¸‹ï¼Œè¿™ä¼šé€šè¿‡ä¸€ä¸ªä¸å®‰å…¨çš„æ¸ é“è¿›è¡Œï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alicePublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> aliceKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobPublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> bobKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice ç”¨ Bob çš„å…¬é’¥ç”Ÿæˆå¥¹çš„å…±äº«ç§˜å¯†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceSecret</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob åŒæ ·ç”¨ Alice çš„å…¬é’¥ç”Ÿæˆä»–çš„å…±äº«ç§˜å¯†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobSecret</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">alicePublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼ŒAlice å’Œ Bob çš„å…±äº«ç§˜å¯†åº”è¯¥ç›¸åŒ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliceSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åº”è¯¥è¾“å‡º true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>aliceSecret</code> å’Œ <code>bobSecret</code> æ˜¯ä¸¤ä¸ªå®Œå…¨ç›¸åŒçš„å€¼ï¼Œå°½ç®¡å®ƒä»¬æ˜¯åœ¨ä¸¤ä¸ªä¸åŒçš„åœ°ç‚¹ç‹¬ç«‹è®¡ç®—çš„ã€‚ç°åœ¨ï¼ŒAlice å’Œ Bob å¯ä»¥ä½¿ç”¨è¿™ä¸ªå…±äº«ç§˜å¯†å¯¹æ¥ä¸‹æ¥çš„é€šä¿¡è¿›è¡ŒåŠ å¯†ï¼Œä»è€Œä¿è¯ä¿¡æ¯çš„å®‰å…¨ã€‚</p><h3 id="crypto-creatediffiehellmangroup-name" tabindex="-1"><a class="header-anchor" href="#crypto-creatediffiehellmangroup-name"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptocreatediffiehellmangroupname" target="_blank" rel="noopener noreferrer">crypto.createDiffieHellmanGroup(name)</a></span></a></h3><p><code>crypto.createDiffieHellmanGroup(name)</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå±äº <code>crypto</code> æ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—æä¾›äº†å„ç§åŠ å¯†åŠŸèƒ½ã€‚åœ¨ä»‹ç»è¿™ä¸ªå‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç†è§£ Diffie-Hellman å¯†é’¥äº¤æ¢åè®®æ˜¯ä»€ä¹ˆã€‚</p><p><strong>Diffie-Hellman å¯†é’¥äº¤æ¢åè®®</strong>ï¼š</p><p>Diffie-Hellmanï¼ˆç®€ç§° DHï¼‰æ˜¯ä¸€ç§å®‰å…¨åœ°åœ¨ä¸¤ä¸ªé€šä¿¡æ–¹ä¹‹é—´å…±äº«å¯†é’¥çš„æ–¹æ³•ï¼Œå®ƒå¯ä»¥è®©åŒæ–¹åœ¨å®Œå…¨æ²¡æœ‰ç›´æ¥å°†å¯†é’¥å‘é€ç»™å¯¹æ–¹çš„æƒ…å†µä¸‹ï¼Œç”Ÿæˆä¸€ä¸ªåªæœ‰ä»–ä»¬ä¿©çŸ¥é“çš„å…±äº«å¯†é’¥ã€‚è¿™ä¸ªå…±äº«å¯†é’¥é€šå¸¸ç”¨äºä¹‹åçš„é€šä¿¡è¿‡ç¨‹ä¸­åŠ å¯†æ¶ˆæ¯ã€‚</p><p>è¿™ä¸ªè¿‡ç¨‹çš„ç²¾å¦™ä¹‹å¤„åœ¨äºå³ä½¿æœ‰ç¬¬ä¸‰æ–¹ç›‘å¬äº†ä¸¤ä¸ªé€šä¿¡æ–¹ä¹‹é—´çš„äº¤æ¢ï¼Œä¹Ÿæ— æ³•è½»æ˜“è®¡ç®—å‡ºå…±äº«å¯†é’¥ï¼Œå› ä¸ºå®ƒåŸºäºä¸€äº›æ•°å­¦é—®é¢˜ï¼Œè¿™äº›é—®é¢˜åœ¨å½“å‰æŠ€æœ¯æ¡ä»¶ä¸‹æ˜¯å¾ˆéš¾è§£å†³çš„ã€‚</p><p><strong>ä½¿ç”¨ <code>crypto.createDiffieHellmanGroup(name)</code> å‡½æ•°</strong>ï¼š</p><p><code>crypto.createDiffieHellmanGroup(name)</code> è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ª Diffie-Hellman å¯†é’¥äº¤æ¢çš„å®ä¾‹ã€‚å‚æ•° <code>name</code> æ˜¯ä¸€ä¸ªæŒ‡å®šçš„é¢„å®šä¹‰çš„ Diffie-Hellman ç´ æ•°ç»„çš„åç§°ï¼Œä¾‹å¦‚ <code>&#39;modp1&#39;</code>ã€<code>&#39;modp2&#39;</code> ç­‰ã€‚Node.js å·²ç»å®šä¹‰äº†ä¸€äº›è¿™æ ·çš„ç»„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ é€’å®ƒä»¬çš„åç§°æ¥å¿«é€Ÿåˆ›å»ºç›¸å…³çš„ DH å®ä¾‹ã€‚</p><p>è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ª <code>DiffieHellmanGroup</code> å¯¹è±¡ï¼Œç„¶åå¯ä»¥ç”¨è¿™ä¸ªå¯¹è±¡è¿›è¡Œå¯†é’¥äº¤æ¢çš„æ“ä½œã€‚</p><p><strong>å…·ä½“å®ä¾‹</strong>ï¼š</p><p>å‡è®¾ Alice å’Œ Bob æƒ³è¦å®‰å…¨åœ°äº¤æ¢å¯†é’¥ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨ <code>crypto.createDiffieHellmanGroup(name)</code> æ¥å®Œæˆè¿™ä¸ªç›®æ ‡çš„æ­¥éª¤ï¼š</p><ol><li>é¦–å…ˆï¼Œéœ€è¦å¼•å…¥ <code>crypto</code> æ¨¡å—ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li>ä½¿ç”¨ <code>crypto.createDiffieHellmanGroup(name)</code> åˆ›å»º DH å®ä¾‹ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice åˆ›å»ºè‡ªå·±çš„ DH å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceDH</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellmanGroup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;modp14&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob ä¹Ÿåˆ›å»ºè‡ªå·±çš„ DH å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobDH</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createDiffieHellmanGroup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;modp14&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>æ¥ä¸‹æ¥ï¼ŒAlice å’Œ Bob éƒ½ç”Ÿæˆå„è‡ªçš„å¯†é’¥å¯¹ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice ç”Ÿæˆè‡ªå·±çš„å¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceKeys</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> aliceDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob ç”Ÿæˆè‡ªå·±çš„å¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobKeys</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>Alice å’Œ Bob äº¤æ¢ä»–ä»¬çš„å…¬é’¥ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ Alice å’Œ Bob é€šè¿‡æŸç§æ–¹å¼äº¤æ¢äº†å…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice æŠŠå¥¹çš„å…¬é’¥å‘é€ç»™ Bobï¼ŒBob æŠŠä»–çš„å…¬é’¥å‘é€ç»™ Alice</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li>é€šè¿‡å¯¹æ–¹çš„å…¬é’¥å’Œè‡ªå·±çš„ç§é’¥ï¼ŒAlice å’Œ Bob å„è‡ªè®¡ç®—å‡ºå…±äº«å¯†é’¥ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice ä½¿ç”¨ Bob çš„å…¬é’¥è®¡ç®—å…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> aliceDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob ä½¿ç”¨ Alice çš„å…¬é’¥è®¡ç®—å…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">aliceKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œ<code>aliceSharedKey</code> å’Œ <code>bobSharedKey</code> åº”è¯¥æ˜¯ç›¸åŒçš„ï¼Œè¿™å°±æ˜¯ä»–ä»¬ä¹‹é—´çš„å…±äº«å¯†é’¥ï¼Œå¯ä»¥ç”¨äºåŠ å¯†åç»­çš„é€šä¿¡å†…å®¹ã€‚è€Œä¸”ï¼Œå³ä½¿æœ‰äººç›‘å¬åˆ°äº†ä»–ä»¬äº¤æ¢å…¬é’¥çš„è¿‡ç¨‹ï¼Œç”±äº Diffie-Hellman é—®é¢˜çš„éš¾åº¦ï¼Œç›‘å¬è€…ä¹Ÿæ— æ³•ç®—å‡ºè¿™ä¸ªå…±äº«çš„å¯†é’¥ã€‚</p><h3 id="crypto-createecdh-curvename" tabindex="-1"><a class="header-anchor" href="#crypto-createecdh-curvename"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptocreateecdhcurvename" target="_blank" rel="noopener noreferrer">crypto.createECDH(curveName)</a></span></a></h3><p>Node.js ä¸­çš„<code>crypto.createECDH(curveName)</code>æ˜¯ä¸€ä¸ªç”¨äºåˆ›å»ºæ¤­åœ†æ›²çº¿ Diffie-Hellman (ECDH) å¯†é’¥äº¤æ¢å¯¹è±¡çš„å‡½æ•°ã€‚ECDH æ˜¯ä¸€ç§åŠ å¯†åè®®ï¼Œå…è®¸ä¸¤æ–¹åœ¨ä¸å®‰å…¨çš„é€šé“ä¸Šå»ºç«‹ä¸€ä¸ªå…±äº«çš„ç§˜å¯†ï¼ˆé€šå¸¸ç”¨äºä¹‹åçš„æ•°æ®åŠ å¯†ï¼‰ï¼Œè€Œæ— éœ€äº‹å…ˆå…±äº«ç§˜å¯†ä¿¡æ¯ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹è¿™ä¸ªå‡½æ•°ä»¥åŠå®ƒå¦‚ä½•å·¥ä½œï¼š</p><h3 id="crypto-createecdh-curvename-1" tabindex="-1"><a class="header-anchor" href="#crypto-createecdh-curvename-1"><span><code>crypto.createECDH(curveName)</code></span></a></h3><ul><li><strong>crypto</strong>: è¿™æ˜¯ Node.js çš„å†…ç½®æ¨¡å—ï¼Œæä¾›åŒ…æ‹¬åŠ å¯†åŠŸèƒ½åœ¨å†…çš„å„ç§å®‰å…¨æ€§ç›¸å…³çš„åŠŸèƒ½ã€‚</li><li><strong>createECDH</strong>: è¿™æ˜¯<code>crypto</code>æ¨¡å—ä¸­ç”¨äºåˆ›å»º ECDH å¯†é’¥äº¤æ¢å¯¹è±¡çš„æ–¹æ³•ã€‚</li><li><strong>curveName</strong>: è¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡æ˜äº†è¦ä½¿ç”¨çš„æ¤­åœ†æ›²çº¿çš„åç§°ã€‚æ¤­åœ†æ›²çº¿å†³å®šäº†å®‰å…¨æ€§çš„ç­‰çº§å’Œæ€§èƒ½ï¼Œå¸¸è§çš„æ›²çº¿æœ‰<code>&#39;secp256k1&#39;</code>ã€<code>&#39;prime256v1&#39;</code>ç­‰ã€‚</li></ul><h3 id="ä½¿ç”¨æ­¥éª¤-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æ­¥éª¤-1"><span>ä½¿ç”¨æ­¥éª¤</span></a></h3><ol><li>åˆ›å»ºä¸¤ä¸ª ECDH å®ä¾‹ï¼Œåˆ†åˆ«å¯¹åº”é€šä¿¡åŒæ–¹ã€‚</li><li>æ¯ä¸ªå®ä¾‹ç”Ÿæˆè‡ªå·±çš„å¯†é’¥å¯¹ï¼ˆå…¬é’¥å’Œç§é’¥ï¼‰ã€‚</li><li>åŒæ–¹äº¤æ¢å…¬é’¥ã€‚</li><li>æ¯ä¸ªå®ä¾‹ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥å’Œè‡ªå·±çš„ç§é’¥è®¡ç®—å…±äº«å¯†é’¥ã€‚</li></ol><h3 id="ä»£ç ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä»£ç ç¤ºä¾‹"><span>ä»£ç ç¤ºä¾‹</span></a></h3><p>å‡è®¾ Alice å’Œ Bob æƒ³è¦å®‰å…¨åœ°äº¤æ¢ä¿¡æ¯ï¼Œä»–ä»¬å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice åˆ›å»º ECDH å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceECDH</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;prime256v1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice ç”Ÿæˆå…¬ç§é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alicePublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> aliceECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob åˆ›å»º ECDH å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobECDH</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;prime256v1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob ç”Ÿæˆå…¬ç§é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobPublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice å’Œ Bob äº¤æ¢å…¬é’¥ï¼ˆåœ¨çœŸå®æƒ…å†µä¸‹ï¼Œè¿™å°†é€šè¿‡æŸç§å½¢å¼çš„é€šä¿¡å‘ç”Ÿï¼Œä¾‹å¦‚é€šè¿‡äº’è”ç½‘ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice ä½¿ç”¨ Bob çš„å…¬é’¥æ¥ç”Ÿæˆå…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> aliceECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob ä½¿ç”¨ Alice çš„å…¬é’¥æ¥ç”Ÿæˆå…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobECDH</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">alicePublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨ï¼ŒAlice å’Œ Bob éƒ½æœ‰äº†ç›¸åŒçš„å…±äº«å¯†é’¥ï¼Œå¹¶ä¸”å¯ä»¥ç”¨å®ƒæ¥åŠ å¯†é€šä¿¡å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliceSharedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobSharedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åº”è¯¥è¾“å‡º true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œé€šè¿‡ ECDH åè®®ä½¿å¾— Alice å’Œ Bob åˆ†åˆ«æ‹¥æœ‰ç‹¬ç«‹ç”Ÿæˆçš„å…±äº«å¯†é’¥ï¼Œå³ä½¿ä»–ä»¬åªæ˜¯äº¤æ¢äº†å…¬é’¥ã€‚è¿™ä¸ªå…±äº«çš„å¯†é’¥åœ¨ä¸¤è¾¹éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥ç”¨æ¥åŠ è§£å¯†ä¿¡æ¯ï¼Œç¡®ä¿ä¿¡æ¯ä¼ è¾“çš„å®‰å…¨æ€§ã€‚</p><p>é‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œåœ¨çœŸå®çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œæ‰€æœ‰çš„å¯†é’¥äº¤æ¢è¿‡ç¨‹éƒ½éœ€è¦åœ¨å®‰å…¨çš„é€šé“ä¸­è¿›è¡Œï¼Œä»¥é¿å…ä¸­é—´äººæ”»å‡»ï¼ˆMan-in-the-Middle Attackï¼‰ï¼Œç¡®ä¿å…¬é’¥çš„çœŸå®æ€§ã€‚å› æ­¤ï¼Œé€šå¸¸ä¼šç»“åˆä½¿ç”¨æ•°å­—ç­¾åæˆ–è¯ä¹¦æ¥éªŒè¯å…¬é’¥çš„åˆæ³•æ€§ã€‚</p><h3 id="crypto-createhash-algorithm-options" tabindex="-1"><a class="header-anchor" href="#crypto-createhash-algorithm-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptocreatehashalgorithm-options" target="_blank" rel="noopener noreferrer">crypto.createHash(algorithm[, options])</a></span></a></h3><p><code>crypto.createHash(algorithm[, options])</code> æ˜¯ä¸€ä¸ªåœ¨ Node.js ä¸­ç”¨äºåˆ›å»ºå“ˆå¸Œæ‘˜è¦çš„å‡½æ•°ã€‚è®©æˆ‘æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹å®ƒæ˜¯ä»€ä¹ˆä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒã€‚</p><p>é¦–å…ˆï¼Œ<code>crypto</code> æ¨¡å—æ˜¯ Node.js ä¸­ç”¨äºåŠ å¯†çš„å†…ç½®æ¨¡å—ï¼Œå®ƒæä¾›äº†å¾ˆå¤šå…³äºå¯†ç å­¦çš„åŠŸèƒ½ï¼Œæ¯”å¦‚åˆ›å»ºå“ˆå¸Œã€åŠ å¯†å’Œè§£å¯†æ•°æ®ç­‰ç­‰ã€‚</p><p>å“ˆå¸Œï¼ˆHashï¼‰æ˜¯å¯†ç å­¦ä¸­çš„ä¸€ä¸ªæ¦‚å¿µï¼ŒæŒ‡çš„æ˜¯å°†ä»»æ„å¤§å°çš„æ•°æ®è½¬æ¢æˆå›ºå®šå¤§å°çš„ä¸²ï¼ˆé€šå¸¸æ˜¯åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼‰ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯å•å‘çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½ å¯ä»¥éå¸¸å®¹æ˜“åœ°ä»åŸå§‹æ•°æ®ç”Ÿæˆå“ˆå¸Œå€¼ï¼Œä½†æ˜¯å‡ ä¹ä¸å¯èƒ½ä»å“ˆå¸Œå€¼æ¨å¯¼å‡ºåŸå§‹æ•°æ®ã€‚å› æ­¤ï¼Œå“ˆå¸Œå¹¿æ³›ç”¨äºæ•°æ®å®Œæ•´æ€§æ ¡éªŒã€å­˜å‚¨å¯†ç ç­‰åœºæ™¯ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ›´æ·±å…¥åœ°æ¢è®¨ <code>crypto.createHash</code> å‡½æ•°çš„ç”¨æ³•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª Hash å®ä¾‹ï¼Œ&#39;sha256&#39; æ˜¯ä¸€ç§å“ˆå¸Œç®—æ³•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¦å¯¹æ•°æ®è¿›è¡Œå“ˆå¸Œå¤„ç†ï¼Œä½ éœ€è¦ä½¿ç”¨ update æ–¹æ³•</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// &#39;some data to hash&#39; æ˜¯ä½ æƒ³è¦å“ˆå¸Œçš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;some data to hash&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ digest æ–¹æ³•å°†å“ˆå¸Œå€¼è¾“å‡ºä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> digest</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™å°†è¾“å‡ºæ•°æ®çš„å“ˆå¸Œå€¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸¾å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><ol><li><strong>å¯†ç å­˜å‚¨</strong>ï¼šå½“ç”¨æˆ·åˆ›å»ºè´¦å·å¹¶è®¾ç½®å¯†ç æ—¶ï¼Œä¸ºäº†å®‰å…¨èµ·è§ï¼ŒæœåŠ¡å™¨ä¸åº”è¯¥ç›´æ¥å­˜å‚¨ç”¨æˆ·çš„æ˜æ–‡å¯†ç ã€‚ç›¸åï¼ŒæœåŠ¡å™¨ä¼šå­˜å‚¨å¯†ç çš„å“ˆå¸Œå€¼ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> storeUserPassword</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hashedPassword</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å°† hashedPassword å­˜å‚¨åˆ°æ•°æ®åº“ä¸­</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>æ–‡ä»¶æ ¡éªŒ</strong>ï¼šè½¯ä»¶ä¸‹è½½ç½‘ç«™é€šå¸¸ä¼šæä¾›æ–‡ä»¶å“ˆå¸Œå€¼ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡è®¡ç®—ä¸‹è½½æ–‡ä»¶çš„å“ˆå¸Œå€¼ï¼Œå¹¶ä¸ç½‘ç«™æä¾›çš„å“ˆå¸Œå€¼å¯¹æ¯”ï¼Œç¡®ä¿ä¸‹è½½çš„æ–‡ä»¶æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getFileHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">filename</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fileBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">filename</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fileBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> digest</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fileDigest</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getFileHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path/to/myfile.zip&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fileDigest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºæ–‡ä»¶çš„å“ˆå¸Œå€¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>API éªŒè¯</strong>ï¼šæœ‰äº› API è¦æ±‚è¯·æ±‚æ–¹æä¾›å‚æ•°çš„å“ˆå¸Œå€¼ä½œä¸ºç­¾åï¼Œä»¥éªŒè¯è¯·æ±‚çš„åˆæ³•æ€§ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> generateApiSignature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">params</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‚æ•°å’Œå¯†é’¥ç»„åˆåç”Ÿæˆç­¾å</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> signature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> apiSignature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> generateApiSignature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;param1=value1&amp;param2=value2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;mySecretKey&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">apiSignature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º API ç­¾å</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šå°±æ˜¯ <code>crypto.createHash</code> çš„åŸºæœ¬ç”¨æ³•å’Œä¸€äº›å®é™…åº”ç”¨ç¤ºä¾‹ã€‚è®°ä½ï¼Œè™½ç„¶å“ˆå¸Œåœ¨æ•°æ®å®‰å…¨ä¸­éå¸¸é‡è¦ï¼Œä½†è¯·æ³¨æ„ï¼ŒæŸäº›ç”¨é€”ï¼ˆå¦‚å¯†ç å­˜å‚¨ï¼‰å¯èƒ½éœ€è¦é¢å¤–çš„æªæ–½ï¼Œä¾‹å¦‚ç›ï¼ˆsaltï¼‰å’Œå“ˆå¸Œè¿­ä»£ï¼Œæ¥æé«˜å®‰å…¨æ€§ã€‚</p><h3 id="crypto-createhmac-algorithm-key-options" tabindex="-1"><a class="header-anchor" href="#crypto-createhmac-algorithm-key-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptocreatehmacalgorithm-key-options" target="_blank" rel="noopener noreferrer">crypto.createHmac(algorithm, key[, options])</a></span></a></h3><p>Node.js çš„<code>crypto</code>æ¨¡å—æä¾›äº†ä¸€ç³»åˆ—åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬åˆ›å»º HMACï¼ˆHash-based Message Authentication Codeï¼ŒåŸºäºæ•£åˆ—çš„æ¶ˆæ¯è®¤è¯ç ï¼‰ã€‚ä¸€ä¸ª HMAC ç»“åˆäº†ä¸€ä¸ªåŠ å¯†å“ˆå¸Œå‡½æ•°å’Œä¸€ä¸ªå¯†é’¥ï¼Œå¯ä»¥ç”¨æ¥éªŒè¯ä¿¡æ¯çš„å®Œæ•´æ€§å’ŒçœŸå®æ€§ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>crypto.createHmac()</code>å‡½æ•°è¢«ç”¨æ¥åˆ›å»ºä¸€ä¸ª HMAC ç”Ÿæˆå™¨ã€‚ä½ éœ€è¦æŒ‡å®šä½¿ç”¨çš„åŠ å¯†ç®—æ³•ï¼ˆå¦‚<code>&#39;sha256&#39;</code>ã€<code>&#39;sha512&#39;</code>ç­‰ï¼‰å’Œä¸€ä¸ªå¯†é’¥ï¼Œå¯é€‰çš„å‚æ•°<code>options</code>å…è®¸ä½ è¿›è¡Œé¢å¤–çš„é…ç½®ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘å°†é€šè¿‡å‡ ä¸ªæ­¥éª¤è¯¦ç»†è§£é‡Šå¹¶å±•ç¤ºå¦‚ä½•ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼š</p><p><strong>1. å¯¼å…¥ crypto æ¨¡å—ï¼š</strong><br> åœ¨ Node.js æ–‡ä»¶ä¸­ï¼Œé¦–å…ˆå¯¼å…¥å†…ç½®çš„<code>crypto</code>æ¨¡å—ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>2. é€‰æ‹©ç®—æ³•å’Œè®¾ç½®å¯†é’¥ï¼š</strong><br> ç¡®å®šè¦ä½¿ç”¨å“ªç§åŠ å¯†ç®—æ³•ï¼Œæ¯”å¦‚<code>&#39;sha256&#39;</code>ï¼Œå¹¶ä¸”å®šä¹‰ä¸€ä¸ªå¯†é’¥ï¼Œè¯¥å¯†é’¥ä¼šä¸æ•°æ®ä¸€èµ·è¢« HASH è¿ç®—æ¥ç”Ÿæˆ HMACã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> algorithm</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secretKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;your-secret-key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>3. åˆ›å»º HMAC ç”Ÿæˆå™¨ï¼š</strong><br> ä½¿ç”¨<code>crypto.createHmac()</code>æ–¹æ³•åˆ›å»º HMAC ç”Ÿæˆå™¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">algorithm</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>4. è¾“å…¥æ•°æ®ï¼š</strong><br> å‡è®¾æˆ‘ä»¬è¦å‘é€ä¸€äº›æ•°æ®ï¼Œå¹¶éœ€è¦ç¡®ä¿æ•°æ®åœ¨ä¼ è¾“æ—¶æ²¡æœ‰è¢«ç¯¡æ”¹ï¼Œä½ å¯ä»¥ä½¿ç”¨ HMAC ç”Ÿæˆå™¨å¤„ç†è¿™äº›æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Important message to be protected&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>5. ç”Ÿæˆå’Œè¾“å‡º HMACï¼š</strong><br> æœ€åï¼Œæˆ‘ä»¬å°†ä»¥æƒ³è¦çš„æ ¼å¼è¾“å‡º HMAC æ‘˜è¦ï¼ˆé€šå¸¸æ˜¯ hex æˆ–è€… base64ï¼‰ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> digest</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºç”Ÿæˆçš„HMACæ‘˜è¦</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å®é™…åº”ç”¨æ¡ˆä¾‹</strong>ï¼š</p><ul><li><p><strong>API è®¤è¯</strong>ï¼šæœåŠ¡å™¨å¯èƒ½è¦æ±‚æ‰€æœ‰è¯·æ±‚éƒ½å¿…é¡»åŒ…å« HMAC ç­¾åï¼Œåœ¨æœåŠ¡å™¨ç«¯ä¹Ÿä½¿ç”¨ç›¸åŒçš„å¯†é’¥å’Œç®—æ³•è®¡ç®— HMACï¼Œå¹¶æ¯”è¾ƒå®¢æˆ·ç«¯ä¼ é€çš„ HMAC å€¼ï¼Œå¦‚æœåŒ¹é…åˆ™è®¤ä¸ºè¯·æ±‚æ˜¯æœ‰æ•ˆçš„ï¼Œå¦åˆ™ä¸ºéæ³•è¯·æ±‚ã€‚</p></li><li><p><strong>æ•°æ®å®Œæ•´æ€§éªŒè¯</strong>ï¼šå½“æ‚¨å­˜å‚¨æˆ–ä¼ è¾“æ•°æ®æ—¶ï¼Œå¯ä»¥é™„åŠ ä¸€ä¸ª HMACã€‚æ¥æ”¶æ–¹å¯ä»¥é‡æ–°è®¡ç®— HMAC æ¥éªŒè¯æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ˜¯å¦æœªç»ä¿®æ”¹ã€‚</p></li><li><p><strong>å®‰å…¨ Cookie</strong>ï¼šWeb åº”ç”¨ç¨‹åºå¯ä»¥åœ¨ç”¨æˆ·çš„ cookie ä¸­å­˜å‚¨ä¸€ä¸ª HMACï¼Œä»¥ç¡®ä¿ cookie å†…å®¹æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚</p></li></ul><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä»£ç ç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨<code>crypto.createHmac()</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®ç®—æ³•å’Œå¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> algorithm</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;very-secret-key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºHMACå®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">algorithm</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¦ä¿æŠ¤çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> message</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Hello, world!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ›´æ–°HMACå®ä¾‹çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºHMACçš„hexè¡¨ç¤ºå½¢å¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hmac</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`The HMAC signature is: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">signature</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œè¿™æ®µä»£ç ï¼Œä¼šæ‰“å°å‡ºç”±ç»™å®šæ¶ˆæ¯å’Œå¯†é’¥ç”Ÿæˆçš„ HMAC ç­¾åã€‚</p><h3 id="crypto-createprivatekey-key" tabindex="-1"><a class="header-anchor" href="#crypto-createprivatekey-key"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptocreateprivatekeykey" target="_blank" rel="noopener noreferrer">crypto.createPrivateKey(key)</a></span></a></h3><p>Node.js çš„<code>crypto.createPrivateKey(key)</code>è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¥æ ¹æ®ç»™å®šçš„å‚æ•°å»åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªæ–°çš„<code>KeyObject</code>å®ä¾‹ï¼Œå®ƒä»£è¡¨äº†ä¸€ä¸ªç§é’¥ã€‚åœ¨åŠ å¯†æ“ä½œä¸­ï¼Œç§é’¥é€šå¸¸è¢«ç”¨äºè§£å¯†æ•°æ®æˆ–è€…ç­¾åä¿¡æ¯ï¼ˆæ¯”å¦‚è¯ä¹¦ç­¾åæˆ–æ•°å­—ç­¾åï¼‰ï¼Œä»¥è¯æ˜ä¿¡æ¯çš„æ¥æºåŠå®Œæ•´æ€§ã€‚</p><p>åœ¨<code>crypto.createPrivateKey(key)</code>æ–¹æ³•ä¸­ï¼Œ<code>key</code>å¯ä»¥æ˜¯å¤šç§ç±»å‹ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²ã€Buffer å¯¹è±¡ã€TypedArrayã€DataView æˆ–è€…åŒ…å« PEM æˆ– DER ç¼–ç ç§é’¥çš„å¯¹è±¡ã€‚</p><p>è®©æˆ‘ä»¬ä¸¾ä¸€äº›å®é™…çš„ä¾‹å­æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨å®ƒï¼š</p><h3 id="ä¾‹å­-1-ä½¿ç”¨-pem-æ ¼å¼çš„å¯†é’¥å­—ç¬¦ä¸²" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-ä½¿ç”¨-pem-æ ¼å¼çš„å¯†é’¥å­—ç¬¦ä¸²"><span>ä¾‹å­ 1: ä½¿ç”¨ PEM æ ¼å¼çš„å¯†é’¥å­—ç¬¦ä¸²</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">////æ¥æºï¼šdoc.cherrychat.org è¯·å‹¿å•†ç”¨</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ æœ‰ä¸€ä¸ªPEMæ ¼å¼çš„ç§é’¥å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> pemKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `-----BEGIN PRIVATE KEY-----</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">...æ‚¨çš„ç§é’¥å†…å®¹...</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">-----END PRIVATE KEY-----`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªç§é’¥å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> privateKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createPrivateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pemKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨ä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªprivateKeyè¿›è¡ŒåŠ å¯†æ“ä½œï¼Œä¾‹å¦‚ç­¾å</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;è¦ç­¾åçš„æ•°æ®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  padding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">RSA_PKCS1_PSS_PADDING</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">signature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç­¾åç»“æœçš„Base64ç¼–ç </span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•å°†ä¸€ä¸ª PEM æ ¼å¼çš„ç§é’¥å­—ç¬¦ä¸²è½¬æ¢æˆä¸€ä¸ª Node.js èƒ½å¤Ÿä½¿ç”¨çš„ç§é’¥å¯¹è±¡ï¼Œå¹¶åˆ©ç”¨å®ƒå¯¹æ•°æ®è¿›è¡Œç­¾åã€‚</p><h3 id="ä¾‹å­-2-ä½¿ç”¨ä»æ–‡ä»¶è¯»å–çš„ç§é’¥" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ä½¿ç”¨ä»æ–‡ä»¶è¯»å–çš„ç§é’¥"><span>ä¾‹å­ 2: ä½¿ç”¨ä»æ–‡ä»¶è¯»å–çš„ç§é’¥</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æŠŠç§é’¥æ–‡ä»¶çš„è·¯å¾„è®¾ä¸ºä¸€ä¸ªå˜é‡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> privateKeyPath</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/path/to/your/private/key.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŒæ­¥åœ°è¯»å–æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> pemKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKeyPath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªç§é’¥å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> privateKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createPrivateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pemKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨è¿™ä¸ªç§é’¥å¯¹è±¡è¿›è¡ŒåŠ å¯†æ“ä½œ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä»æ–‡ä»¶ç³»ç»Ÿä¸­è¯»å–äº† PEM æ ¼å¼çš„ç§é’¥æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨è¿™ä¸ªå¯†é’¥åˆ›å»ºäº†ä¸€ä¸ªç§é’¥å¯¹è±¡ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-1" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-1"><span>æ³¨æ„äº‹é¡¹ï¼š</span></a></h3><ul><li>åœ¨å¤„ç†ç§é’¥æ—¶ä¿æŒå®‰å…¨æ€§æ˜¯éå¸¸é‡è¦çš„ã€‚é¿å…æŠŠç§é’¥æš´éœ²åœ¨ä¸å®‰å…¨çš„ç¯å¢ƒä¸­ï¼Œä¾‹å¦‚ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿæˆ–æ—¥å¿—æ–‡ä»¶ã€‚</li><li>ç§é’¥é€šå¸¸æ˜¯éœ€è¦ä¿å¯†çš„ï¼Œä¸åº”è¯¥éšæ„ä¼ é€’æˆ–åœ¨ç½‘ç»œä¸ŠæœªåŠ å¯†ä¼ è¾“ã€‚</li><li>ä½¿ç”¨<code>createPrivateKey</code>æ—¶ï¼Œå¦‚æœæä¾›çš„å¯†é’¥ä¿¡æ¯æœ‰è¯¯ï¼Œå¯èƒ½ä¼šæŠ›å‡ºé”™è¯¯ã€‚ä½ éœ€è¦ç”¨ try-catch è¯­å¥æ¥æ•è·è¿™äº›æ½œåœ¨çš„é”™è¯¯ã€‚</li></ul><p>å¸Œæœ›è¿™äº›è§£é‡Šå’Œä¾‹å­èƒ½å¸®åŠ©ä½ ç†è§£å¦‚ä½•ä½¿ç”¨ Node.js çš„<code>crypto.createPrivateKey</code>æ–¹æ³•ã€‚å¦‚æœä½ æ‰“ç®—åœ¨å®é™…åº”ç”¨ä¸­ä½¿ç”¨åŠ å¯†åŠŸèƒ½ï¼Œè¯·ç¡®ä¿è¿›ä¸€æ­¥å­¦ä¹ ç›¸å…³çš„å®‰å…¨æœ€ä½³å®è·µã€‚</p><h3 id="crypto-createpublickey-key" tabindex="-1"><a class="header-anchor" href="#crypto-createpublickey-key"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptocreatepublickeykey" target="_blank" rel="noopener noreferrer">crypto.createPublicKey(key)</a></span></a></h3><p>Node.js çš„ <code>crypto</code> æ¨¡å—æä¾›äº†å„ç§åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç”¨äºå¤„ç†å…¬é’¥çš„èƒ½åŠ›ã€‚å‡½æ•° <code>crypto.createPublicKey(key)</code> æ˜¯è¿™ä¸ªæ¨¡å—ä¸­ç”¨æ¥æ ¹æ®ç»™å®šçš„æ•°æ®åˆ›å»ºä¸€ä¸ªå…¬é’¥å¯¹è±¡çš„æ–¹æ³•ã€‚</p><p>åœ¨éå¯¹ç§°åŠ å¯†ä¸­ï¼Œå…¬é’¥å’Œç§é’¥æ˜¯ä¸€å¯¹å¯†é’¥ã€‚å…¬é’¥å¯ä»¥å…¬å¼€åˆ†äº«ï¼Œè€Œç§é’¥å¿…é¡»ä¿å¯†ã€‚ä»»ä½•äººéƒ½å¯ä»¥ä½¿ç”¨å…¬é’¥æ¥åŠ å¯†ä¿¡æ¯ï¼Œä½†åªæœ‰æŒæœ‰åŒ¹é…ç§é’¥çš„äººæ‰èƒ½è§£å¯†è¿™äº›ä¿¡æ¯ï¼Œè¿™å°±æ„æˆäº†å®‰å…¨é€šä¿¡çš„åŸºç¡€ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬è¯¦ç»†è§£é‡Šä¸€ä¸‹ <code>crypto.createPublicKey(key)</code> æ–¹æ³•ä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒï¼š</p><h3 id="å‚æ•°è§£é‡Š-2" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-2"><span>å‚æ•°è§£é‡Šï¼š</span></a></h3><p><code>key</code> å¯ä»¥æ˜¯å¤šç§ç±»å‹ï¼Œæ¯”å¦‚ä¸€ä¸ªå­—ç¬¦ä¸²ã€Bufferã€TypedArray æˆ–è€…ä¸€ä¸ª KeyObjectã€‚è¿™ä¸ªå‚æ•°æä¾›äº†åˆ›å»ºå…¬é’¥å¯¹è±¡æ‰€éœ€è¦çš„åŸå§‹ææ–™ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ª PEM æ ¼å¼ï¼ˆæ–‡æœ¬æ ¼å¼ï¼‰çš„å…¬é’¥ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ª DER æ ¼å¼ï¼ˆäºŒè¿›åˆ¶æ ¼å¼ï¼‰çš„å…¬é’¥ç­‰ã€‚</p><h3 id="è¿”å›å€¼-2" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-2"><span>è¿”å›å€¼ï¼š</span></a></h3><p>æ–¹æ³•è¿”å›ä¸€ä¸ª <code>KeyObject</code> å¯¹è±¡ï¼Œä»£è¡¨äº†å…¬é’¥ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-3"><span>å®é™…è¿ç”¨ä¾‹å­ï¼š</span></a></h3><h4 id="_1-ä½¿ç”¨-pem-æ ¼å¼çš„å­—ç¬¦ä¸²åˆ›å»ºå…¬é’¥" tabindex="-1"><a class="header-anchor" href="#_1-ä½¿ç”¨-pem-æ ¼å¼çš„å­—ç¬¦ä¸²åˆ›å»ºå…¬é’¥"><span>1. ä½¿ç”¨ PEM æ ¼å¼çš„å­—ç¬¦ä¸²åˆ›å»ºå…¬é’¥</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ª PEM æ ¼å¼çš„å…¬é’¥å­—ç¬¦ä¸²ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-pem line-numbers-mode" data-highlighter="shiki" data-ext="pem" data-title="pem" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-----BEGIN PUBLIC KEY-----</span></span>
<span class="line"><span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtVETRJNyQYjkQm2+ESer</span></span>
<span class="line"><span>...</span></span>
<span class="line"><span>-----END PUBLIC KEY-----</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ å¯ä»¥åƒè¿™æ ·ä½¿ç”¨ <code>crypto.createPublicKey</code> æ¥åˆ›å»ºä¸€ä¸ªå…¬é’¥å¯¹è±¡ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// PEMæ ¼å¼çš„å…¬é’¥å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> pemKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `-----BEGIN PUBLIC KEY-----</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtVETRJNyQYjkQm2+ESer</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">...</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">-----END PUBLIC KEY-----`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºå…¬é’¥å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pemKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-ä½¿ç”¨-der-æ ¼å¼çš„-buffer-åˆ›å»ºå…¬é’¥" tabindex="-1"><a class="header-anchor" href="#_2-ä½¿ç”¨-der-æ ¼å¼çš„-buffer-åˆ›å»ºå…¬é’¥"><span>2. ä½¿ç”¨ DER æ ¼å¼çš„ Buffer åˆ›å»ºå…¬é’¥</span></a></h4><p>æœ‰æ—¶å€™ï¼Œä½ å¯èƒ½è·å¾—åˆ°çš„å…¬é’¥æ˜¯ä¸€ä¸ª DER æ ¼å¼çš„äºŒè¿›åˆ¶æ•°æ®ã€‚è¿™æ—¶ï¼Œä½ éœ€è¦é¦–å…ˆæŠŠå®ƒæ”¾å…¥ä¸€ä¸ª Node.js çš„ Buffer å¯¹è±¡ï¼Œç„¶åä½¿ç”¨<code>crypto.createPublicKey</code>æ¥åˆ›å»ºå…¬é’¥å¯¹è±¡ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ &#39;publickey.der&#39; æ–‡ä»¶åŒ…å«äº†DERæ ¼å¼çš„å…¬é’¥æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> derKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;publickey.der&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºå…¬é’¥å¯¹è±¡ï¼Œä¼ å…¥Bufferå¯¹è±¡ï¼Œå¹¶æŒ‡æ˜å®ƒæ˜¯&#39;der&#39;æ ¼å¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">derKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;der&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;spki&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼Œå½“ä¼ é€’ Buffer æ—¶ï¼Œä½ éœ€è¦é¢å¤–æä¾›<code>format</code>ï¼ˆæ ¼å¼ï¼‰å’Œ<code>type</code>ï¼ˆç±»å‹ï¼‰å±æ€§æ¥æŒ‡æ˜å…¬é’¥çš„å…·ä½“æ ¼å¼å’Œç±»å‹ã€‚</p><p>é€šè¿‡ä¸Šè¿°æ–¹æ³•åˆ›å»ºçš„å…¬é’¥å¯¹è±¡å¯ä»¥ç”¨äºå¾ˆå¤šä¸åŒçš„æ“ä½œï¼Œä¾‹å¦‚éªŒè¯æ•°å­—ç­¾åæˆ–è€…åŠ å¯†æ•°æ®ã€‚è¿™äº›åŠŸèƒ½åœ¨ç½‘ç«™å®‰å…¨ã€æ•°æ®åŠ å¯†ä¼ è¾“ç­‰æ–¹é¢éƒ½æå…¶é‡è¦ï¼Œç‰¹åˆ«æ˜¯åœ¨æ¶‰åŠæ•æ„Ÿä¿¡æ¯å¤„ç†æ—¶ï¼Œæ¯”å¦‚ç”¨æˆ·è®¤è¯ã€å®‰å…¨é€šä¿¡ç­‰ã€‚</p><h3 id="crypto-createsecretkey-key-encoding" tabindex="-1"><a class="header-anchor" href="#crypto-createsecretkey-key-encoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptocreatesecretkeykey-encoding" target="_blank" rel="noopener noreferrer">crypto.createSecretKey(key[, encoding])</a></span></a></h3><p>Node.js ä¸­çš„ <code>crypto</code> æ¨¡å—æä¾›äº†ä¸€ç³»åˆ—åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å„ç§å½¢å¼çš„åŠ å¯†å’Œå“ˆå¸Œç®—æ³•ã€‚å‡½æ•° <code>crypto.createSecretKey(key[, encoding])</code> æ˜¯è¿™ä¸ªæ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒç”¨äºåˆ›å»ºä¸€ä¸ªç§°ä¸º&quot;ç§˜å¯†å¯†é’¥&quot;(secret key)çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å¸¸è¢«ç”¨åœ¨å¯¹ç§°åŠ å¯†ä¸­ã€‚</p><p>åœ¨å¯¹ç§°åŠ å¯†ç³»ç»Ÿé‡Œé¢ï¼ŒåŠ å¯†å’Œè§£å¯†æ•°æ®ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªå¯†é’¥ï¼ˆå³ç§˜å¯†å¯†é’¥ï¼‰ã€‚ä¸ä¹‹ç›¸å¯¹çš„æ˜¯éå¯¹ç§°åŠ å¯†ï¼Œå…¶ä¸­åŠ å¯†å’Œè§£å¯†ä½¿ç”¨ä¸åŒçš„å¯†é’¥ï¼ˆå…¬é’¥å’Œç§é’¥ï¼‰ã€‚</p><h3 id="å‚æ•°è§£é‡Š-3" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-3"><span>å‚æ•°è§£é‡Šï¼š</span></a></h3><ul><li><code>key</code>: è¿™ä¸ªå‚æ•°æ˜¯ä½ æƒ³è¦è½¬æ¢æˆç§˜å¯†å¯†é’¥çš„åŸå§‹æ•°æ®ã€‚å®ƒå¯ä»¥æ˜¯ä¸€ä¸ª <code>Buffer</code>ã€<code>TypedArray</code>ã€<code>DataView</code>ã€æˆ–è€…ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</li><li><code>encoding</code>: å½“ <code>key</code> å‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ—¶ï¼Œè¿™ä¸ªå¯é€‰å‚æ•°æŒ‡å®šäº†å­—ç¬¦ä¸²çš„ç¼–ç æ–¹å¼ï¼ˆå¦‚ &#39;utf8&#39;, &#39;ascii&#39;, &#39;base64&#39; ç­‰ï¼‰ã€‚å¦‚æœ <code>key</code> æ˜¯å…¶ä»–ç±»å‹çš„æ•°æ®ï¼Œåˆ™å¿½ç•¥è¯¥å‚æ•°ã€‚</li></ul><h3 id="è¿”å›å€¼-3" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-3"><span>è¿”å›å€¼ï¼š</span></a></h3><p>è°ƒç”¨æ­¤æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª <code>KeyObject</code> å®ä¾‹ï¼Œå®ƒä»£è¡¨äº†ä¸€ä¸ªç§˜å¯†å¯†é’¥ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-3"><span>å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</span></a></h3><p><strong>ä¾‹å­ 1ï¼šåˆ›å»ºä¸€ä¸ªç®€å•çš„ç§˜å¯†å¯†é’¥</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºåˆå§‹ç§˜å¯†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secret</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;my-secret&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª Buffer å®ä¾‹æ¥å­˜å‚¨è¿™ä¸ªç§˜å¯†ï¼ˆä¹Ÿå¯ä»¥ç›´æ¥ä¼ å…¥åŸå§‹å­—ç¬¦ä¸²ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secretKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createSecretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† <code>crypto</code> æ¨¡å—ã€‚ç„¶åå®šä¹‰äº†ä¸€ä¸ªç§˜å¯†å­—ç¬¦ä¸² <code>secret</code>ã€‚éšåï¼Œæˆ‘ä»¬é€šè¿‡ <code>Buffer.from</code> æ–¹æ³•å°†è¿™ä¸ªå­—ç¬¦ä¸²è½¬åŒ–ä¸º <code>Buffer</code> å®ä¾‹ï¼Œå¹¶ä¸”å°†å®ƒä¼ é€’ç»™ <code>crypto.createSecretKey</code> æ–¹æ³•æ¥åˆ›å»ºç§˜å¯†å¯†é’¥ã€‚</p><p><strong>ä¾‹å­ 2ï¼šä½¿ç”¨ç§˜å¯†å¯†é’¥è¿›è¡Œ AES åŠ å¯†</strong></p><p>AES (é«˜çº§åŠ å¯†æ ‡å‡†) æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„å¯¹ç§°åŠ å¯†ç®—æ³•ã€‚ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨ç”± <code>createSecretKey</code> ç”Ÿæˆçš„ç§˜å¯†å¯†é’¥è¿›è¡Œ AES åŠ å¯†çš„ä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®šä¹‰ä¸€ä¸ªç§˜å¯†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secret</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;this-is-a-secret-key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºç§˜å¯†å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secretKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createSecretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®šä¹‰è¦åŠ å¯†çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Hello, World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŠ å¯†å™¨å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;aes-256-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Encrypted data: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç§˜å¯†å¯†é’¥ï¼Œç„¶åä½¿ç”¨è¿™ä¸ªç§˜å¯†å¯†é’¥å’Œä¸€ä¸ªéšæœºç”Ÿæˆçš„åˆå§‹åŒ–å‘é‡ (IV) æ¥åˆ›å»ºä¸€ä¸ª AES åŠ å¯†å™¨ (<code>cipher</code>) å®ä¾‹ã€‚æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªåŠ å¯†å™¨æ¥åŠ å¯†ä¸€ä¸²æ–‡æœ¬æ•°æ®ã€‚<code>cipher.update</code> æ–¹æ³•ç”¨äºåŠ å¯†æ•°æ®çš„æŸä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”å¯ä»¥è¿ç»­è°ƒç”¨å¤šæ¬¡ã€‚æœ€åï¼Œ<code>cipher.final</code> è°ƒç”¨è¡¨ç¤ºåŠ å¯†ç»“æŸï¼Œå®ƒå°†è¿”å›æœ€åçš„åŠ å¯†æ•°æ®ã€‚</p><p>æ³¨æ„ï¼šåœ¨å®é™…åº”ç”¨ä¸­ï¼Œç§˜å¯†å¯†é’¥å’Œ IV åº”å½“ä½¿ç”¨å®‰å…¨çš„éšæœºæ•°ç”Ÿæˆæ–¹å¼ç”Ÿæˆï¼Œå¹¶ä¸”ä¿ç®¡ç§˜å¯†å¯†é’¥çš„å®‰å…¨æ€§è‡³å…³é‡è¦ã€‚åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œç§˜å¯†å¯†é’¥æ˜¯ç¡¬ç¼–ç çš„ï¼Œä»…ä½œæ•™å­¦ç›®çš„ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå¯†é’¥ç®¡ç†éœ€è¦éµå¾ªæœ€ä½³å®è·µï¼Œä»¥ç¡®ä¿åŠ å¯†ä½“ç³»çš„å®‰å…¨æ€§ã€‚</p><h3 id="crypto-createsign-algorithm-options" tabindex="-1"><a class="header-anchor" href="#crypto-createsign-algorithm-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptocreatesignalgorithm-options" target="_blank" rel="noopener noreferrer">crypto.createSign(algorithm[, options])</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>crypto</code>æ¨¡å—æä¾›äº†åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯¹æ•°æ®è¿›è¡Œç­¾åå’ŒéªŒè¯ã€‚ç­¾åæ˜¯æŒ‡ä½¿ç”¨ç§é’¥ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸²éå…¬å¼€çš„å¯†é’¥ï¼‰å¯¹ä¿¡æ¯ï¼ˆæ¯”å¦‚æ–‡ä»¶ã€æ¶ˆæ¯ç­‰ï¼‰è¿›è¡ŒåŠ å¯†ï¼Œç„¶åä»»ä½•äººéƒ½å¯ä»¥ä½¿ç”¨ç›¸åº”çš„å…¬é’¥æ¥éªŒè¯ç­¾åæ˜¯å¦æœ‰æ•ˆã€‚è¿™æ ·åšå¯ä»¥ä¿è¯ä¿¡æ¯çš„å®Œæ•´æ€§å’Œå‘é€è€…çš„èº«ä»½ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘å°†è§£é‡Š<code>crypto.createSign(algorithm[, options])</code>å‡½æ•°åŠå…¶ä½œç”¨ï¼Œå¹¶ç»™å‡ºä¸€äº›å®é™…çš„ä¾‹å­ã€‚</p><h3 id="crypto-createsign-algorithm-options-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#crypto-createsign-algorithm-options-ç®€ä»‹"><span><code>crypto.createSign(algorithm[, options])</code>ç®€ä»‹ï¼š</span></a></h3><ul><li><code>algorithm</code> å‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºæŒ‡å®šç”Ÿæˆç­¾åæ‰€ä½¿ç”¨çš„ç®—æ³•ï¼Œä¾‹å¦‚ <code>&#39;RSA-SHA256&#39;</code> æˆ– <code>&#39;ECDSA-SHA512&#39;</code>ã€‚</li><li><code>options</code> å¯é€‰å‚æ•°ï¼Œç”¨äºæä¾›é¢å¤–çš„é…ç½®é¡¹ï¼Œæ¯”å¦‚è®¾ç½®ç¼–ç ç±»å‹ç­‰ã€‚</li></ul><p>å½“ä½ è°ƒç”¨<code>crypto.createSign()</code>æ—¶ï¼Œå®ƒä¼šåˆ›å»ºå¹¶è¿”å›ä¸€ä¸ª<code>Sign</code>å¯¹è±¡ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªå¯¹è±¡å¯¹æ•°æ®è¿›è¡Œç­¾åã€‚</p><h3 id="ç­¾åè¿‡ç¨‹çš„åŸºæœ¬æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#ç­¾åè¿‡ç¨‹çš„åŸºæœ¬æ­¥éª¤"><span>ç­¾åè¿‡ç¨‹çš„åŸºæœ¬æ­¥éª¤ï¼š</span></a></h3><ol><li>åˆ›å»º<code>Sign</code>å¯¹è±¡ã€‚</li><li>æ·»åŠ ï¼ˆæ›´æ–°ï¼‰è¦ç­¾åçš„æ•°æ®ã€‚</li><li>ä½¿ç”¨ç§é’¥å®Œæˆç­¾åã€‚</li></ol><h3 id="ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2"><span>ä¾‹å­ï¼š</span></a></h3><p>å‡è®¾ä½ æƒ³å¯¹ä¸€æ®µé‡è¦ä¿¡æ¯è¿›è¡Œç­¾åï¼Œä»¥ç¡®ä¿æ”¶ä»¶äººèƒ½éªŒè¯è¿™æ¡ä¿¡æ¯ç¡®å®æ˜¯ç”±ä½ å‘é€çš„ä¸”æœªè¢«ç¯¡æ”¹ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨<code>crypto.createSign()</code>å®ç°è¿™ä¸€ç›®æ ‡çš„ä»£ç ç¤ºä¾‹ã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦å¼•å…¥ Node.js çš„<code>crypto</code>æ¨¡å—å’Œ<code>fs</code>æ¨¡å—ï¼Œå› ä¸ºæˆ‘ä»¬ä¹Ÿä¼šæ¶‰åŠåˆ°è¯»å–æ–‡ä»¶ï¼ˆå‡è®¾ä½ çš„ç§é’¥å­˜å‚¨åœ¨æ–‡ä»¶ä¸­ï¼‰ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥ï¼Œä½ è¦åˆ›å»ºä¸€ä¸ª<code>Sign</code>å¯¹è±¡ï¼Œå¹¶æŒ‡å®šä½ è¦ä½¿ç”¨çš„ç­¾åç®—æ³•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> sign</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createSign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;SHA256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç°åœ¨ï¼Œä½ æ·»åŠ ï¼ˆupdateï¼‰ä½ æƒ³è¦ç­¾åçš„æ•°æ®ã€‚æ•°æ®å¯ä»¥ä¸€æ¬¡æ€§æ·»åŠ ï¼Œä¹Ÿå¯ä»¥åˆ†å¤šæ¬¡æ·»åŠ ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¿™æ˜¯æˆ‘è¦ç­¾åçš„é‡è¦ä¿¡æ¯.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æœ€åï¼Œä½ éœ€è¦åŠ è½½ä½ çš„ç§é’¥ï¼Œå¹¶ç”¨å®ƒæ¥å®Œæˆç­¾åè¿‡ç¨‹ã€‚ç§é’¥é€šå¸¸å­˜å‚¨åœ¨ç‹¬ç«‹çš„æ–‡ä»¶ä¸­ï¼Œå› æ­¤ä½ éœ€è¦å…ˆè¯»å–å®ƒï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> privateKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path/to/private/key.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ç§é’¥ç”Ÿæˆç­¾å (&#39;base64&#39; æ˜¯è¾“å‡ºç­¾åçš„ç¼–ç æ–¹å¼ä¹‹ä¸€)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`ç”Ÿæˆçš„ç­¾å: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">signature</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨ï¼Œ<code>signature</code>å˜é‡ä¸­å°±ä¿å­˜äº†å¯¹åº”æ•°æ®çš„ç­¾åã€‚ä½ å¯ä»¥å°†è¿™ä¸ªç­¾åä¸åŸå§‹æ•°æ®ä¸€èµ·å‘é€ç»™å…¶ä»–äººã€‚æ”¶ä»¶äººå¯ä»¥ä½¿ç”¨ä½ çš„å…¬é’¥æ¥éªŒè¯è¿™ä¸ªç­¾åï¼Œä»¥ç¡®ä¿æ•°æ®ç¡®å®æ˜¯ç”±ä½ å‘é€çš„ï¼Œä¸”è‡ªç­¾åä»¥åæœªè¢«ä¿®æ”¹è¿‡ã€‚</p><h3 id="crypto-createverify-algorithm-options" tabindex="-1"><a class="header-anchor" href="#crypto-createverify-algorithm-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptocreateverifyalgorithm-options" target="_blank" rel="noopener noreferrer">crypto.createVerify(algorithm[, options])</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>crypto</code>æ¨¡å—æ˜¯ä¸€ä¸ªåŒ…å«ç”¨äºå¤„ç†åŠ å¯†çš„ç±»å’Œå‡½æ•°çš„æ ¸å¿ƒæ¨¡å—ã€‚<code>createVerify</code>æ–¹æ³•æ˜¯å…¶ä¸­çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒç”¨äºåˆ›å»ºä¸€ä¸ªéªŒè¯å¯¹è±¡ï¼ˆ<code>Verify</code>ï¼‰ï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ•°æ®æ˜¯å¦ç»è¿‡äº†ç‰¹å®šçš„ç­¾åã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç†è§£å‡ ä¸ªåŸºæœ¬çš„æ¦‚å¿µï¼š</p><ol><li><strong>åŠ å¯†ç®—æ³•</strong>ï¼šè¿™äº›ç®—æ³•ç”¨äºå¯¹æ•°æ®è¿›è¡Œå˜æ¢ï¼Œä»¥ç¡®ä¿åªæœ‰æ‹¥æœ‰æ­£ç¡®å¯†é’¥æˆ–ç®—æ³•çš„äººæ‰èƒ½è®¿é—®åŸå§‹æ•°æ®ã€‚</li><li><strong>ç­¾å</strong>ï¼šæ•°å­—ç­¾åæ˜¯ä½¿ç”¨å‘é€è€…çš„ç§é’¥ç”Ÿæˆçš„ï¼Œå®ƒä¸è¦å‘é€çš„æ•°æ®ä¸€èµ·ä¼ è¾“ã€‚æ¥æ”¶è€…å¯ä»¥ä½¿ç”¨å‘é€è€…çš„å…¬é’¥æ¥éªŒè¯ç­¾åï¼Œä»è€Œç¡®è®¤æ•°æ®ç¡®å®æ¥è‡ªå‘é€è€…ï¼Œå¹¶ä¸”åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æœªè¢«ç¯¡æ”¹ã€‚</li><li><strong>éªŒè¯</strong>ï¼šéªŒè¯è¿‡ç¨‹æ¶‰åŠåˆ°æ£€æŸ¥æ•°æ®å’Œç­¾åæ˜¯å¦åŒ¹é…ã€‚å¦‚æœåŒ¹é…ï¼Œåˆ™æ•°æ®è¢«è®¤ä¸ºæ˜¯çœŸå®å’Œå®Œæ•´çš„ã€‚</li></ol><p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹ <code>crypto.createVerify(algorithm[, options])</code> æ–¹æ³•ï¼š</p><ul><li><code>algorithm</code> å‚æ•°æŒ‡å®šäº†ç”¨äºåˆ›å»ºç­¾åçš„åŠ å¯†ç®—æ³•ï¼Œæ¯”å¦‚ <code>&#39;RSA-SHA256&#39;</code> æˆ– <code>&#39;SHA256&#39;</code>ã€‚</li><li><code>options</code> å‚æ•°æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—é¢å¤–çš„é…ç½®é€‰é¡¹ã€‚</li></ul><p>å½“ä½ è°ƒç”¨ <code>crypto.createVerify()</code> æ–¹æ³•ï¼Œå®ƒè¿”å›ä¸€ä¸ª <code>Verify</code> å¯¹è±¡ã€‚ä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªå¯¹è±¡å¯¹æ•°æ®è¿›è¡ŒéªŒè¯ï¼Œæµç¨‹é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li><strong>update(data[, inputEncoding])</strong>: ä½¿ç”¨è¦éªŒè¯çš„æ•°æ®æ›´æ–°éªŒè¯å¯¹è±¡ã€‚å¯ä»¥å¤šæ¬¡è°ƒç”¨æ­¤æ–¹æ³•æ¥å¤„ç†å¤§é‡æ•°æ®ã€‚</li><li><strong>verify(object, signature[, signatureFormat])</strong>: å®ŒæˆéªŒè¯è¿‡ç¨‹ï¼Œæ£€æŸ¥é€šè¿‡ <code>update()</code> æä¾›çš„æ•°æ®ä¸æä¾›çš„ç­¾åæ˜¯å¦åŒ¹é…ã€‚</li></ol><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå…¸å‹çš„ä½¿ç”¨ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€æ®µæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;è¿™æ˜¯éœ€è¦éªŒè¯çš„æ•°æ®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™ä¸ªæ˜¯ä¹‹å‰ç”Ÿæˆçš„ç­¾åï¼Œé€šå¸¸ç”±æ•°æ®çš„å‘é€æ–¹æä¾›</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;è¿™é‡Œæ˜¯ç­¾åå­—ç¬¦ä¸²&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªéªŒè¯å¯¹è±¡ï¼ŒæŒ‡å®šä½¿ç”¨çš„ç®—æ³•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> verify</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createVerify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;SHA256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨updateæ–¹æ³•æ·»åŠ æ•°æ®ï¼Œå¯ä»¥æ˜¯Bufferæˆ–è€…å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">verify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æŒ‡å®šå…¬é’¥ â€”â€” åœ¨çœŸå®åº”ç”¨åœºæ™¯ä¸­ï¼Œè¿™ä¼šæ˜¯å‘é€æ–¹çš„å…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;è¿™é‡Œæ˜¯å…¬é’¥å­—ç¬¦ä¸²&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨verifyæ–¹æ³•æ¥éªŒè¯ç­¾åï¼Œå¦‚æœç­¾åæœ‰æ•ˆåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> isValid</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> verify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">verify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">signature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;éªŒè¯ç»“æœï¼š&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isValid</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> ?</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;æœ‰æ•ˆ&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;æ— æ•ˆ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æ­¤ä»£ç ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† Node.js å†…ç½®çš„<code>crypto</code>æ¨¡å—ã€‚ç„¶åæˆ‘ä»¬å®šä¹‰äº†è¦éªŒè¯çš„æ•°æ®å’Œä¸Šæ¸¸ç³»ç»Ÿæä¾›çš„ç­¾åã€‚æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª<code>Verify</code>å®ä¾‹å¹¶ä½¿ç”¨<code>SHA256</code>ç®—æ³•ã€‚ä¹‹åï¼Œæˆ‘ä»¬ç”¨<code>update()</code>æ–¹æ³•æ·»åŠ äº†æ•°æ®ï¼Œæœ€åæˆ‘ä»¬ç”¨<code>verify()</code>æ–¹æ³•æ¥éªŒè¯ç­¾åæ˜¯å¦æœ‰æ•ˆï¼Œä½¿ç”¨ä¹‹å‰è·å¾—çš„å…¬é’¥ã€‚</p><p>è¯·æ³¨æ„ï¼Œè¿™ä¸ªä¾‹å­æ˜¯ç®€åŒ–äº†çš„ã€‚åœ¨å®é™…æ“ä½œä¸­ï¼Œç­¾åæ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²ï¼Œå…¬é’¥ä¹Ÿæ˜¯å…·æœ‰ç‰¹å®šæ ¼å¼çš„ï¼ˆé€šå¸¸æ˜¯ PEM æˆ– DER æ ¼å¼ï¼‰ã€‚ä½ éœ€è¦æ ¹æ®å®é™…ä½¿ç”¨çš„å¯†é’¥å’Œç­¾åæ ¼å¼æ¥ä¿®æ”¹ä»£ç ä»¥é€‚åº”ä½ çš„å…·ä½“æƒ…å†µã€‚</p><h3 id="crypto-diffiehellman-options" tabindex="-1"><a class="header-anchor" href="#crypto-diffiehellman-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptodiffiehellmanoptions" target="_blank" rel="noopener noreferrer">crypto.diffieHellman(options)</a></span></a></h3><p><code>crypto.diffieHellman(options)</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå±äº <code>crypto</code> æ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—æä¾›äº†åŒ…æ‹¬åŠ å¯†æŠ€æœ¯åœ¨å†…çš„å„ç§å®‰å…¨ç›¸å…³åŠŸèƒ½ã€‚Diffie-Hellman æ˜¯ä¸€ç§å¯†é’¥äº¤æ¢ç®—æ³•ï¼Œå…è®¸ä¸¤æ–¹ï¼ˆæˆ‘ä»¬å¯ä»¥ç§°ä»–ä»¬ä¸º Alice å’Œ Bobï¼‰åœ¨ä¸å®‰å…¨çš„é€šä¿¡æ¸ é“ä¸­å…±åŒåˆ›å»ºä¸€ä¸ªå®‰å…¨çš„å¯†é’¥ã€‚è¿™ä¸ªå¯†é’¥å¯ä»¥ç”¨äºä¹‹åçš„åŠ å¯†é€šä¿¡ã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ä½¿ç”¨ <code>crypto.diffieHellman(options)</code> å‡½æ•°æ—¶ï¼Œä½ éœ€è¦ä¼ å…¥ä¸€ä¸ª <code>options</code> å¯¹è±¡ï¼Œé‡Œé¢åŒ…å«äº†è¿›è¡Œ Diffie-Hellman å¯†é’¥äº¤æ¢æ‰€éœ€çš„å‚æ•°ã€‚ä¸‹é¢æ˜¯è¿™ä¸ªå‡½æ•°çš„åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»º Alice çš„å¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceKeys</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dh&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  primeLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  generator</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»º Bob çš„å¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobKeys</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;dh&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  primeLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  generator</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†å„è‡ªçš„å…¬é’¥äº¤æ¢ç»™å¯¹æ–¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alicePublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> aliceKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobPublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥å’Œè‡ªå·±çš„ç§é’¥ç”Ÿæˆå…±äº«çš„å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">diffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliceKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bobPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">diffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">bobKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">alicePublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨ï¼ŒAlice å’Œ Bob æ‹¥æœ‰äº†ç›¸åŒçš„å…±äº«å¯†é’¥ï¼Œå¯ä»¥ç”¨äºåŠ å¯†é€šä¿¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">aliceSharedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bobSharedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åº”è¯¥è¾“å‡º true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®é™…è¿ç”¨åœºæ™¯ä¸¾ä¾‹ï¼š</p><ol><li><p><strong>å®‰å…¨é€šä¿¡</strong>ï¼šä¸¤ä¸ªæœåŠ¡å™¨éœ€è¦å®‰å…¨åœ°äº¤æ¢æ•°æ®ã€‚å®ƒä»¬å¯ä»¥ä½¿ç”¨ Diffie-Hellman å¯†é’¥äº¤æ¢ç®—æ³•æ¥ç¡®ä¿å³ä½¿äº¤æ¢æ•°æ®çš„è¿‡ç¨‹è¢«ç›‘å¬ï¼Œç¬¬ä¸‰æ–¹ä¹Ÿæ— æ³•è§£å¯†é€šä¿¡å†…å®¹ã€‚</p></li><li><p><strong>VPN è¿æ¥</strong>ï¼šå½“ä½ ä½¿ç”¨ VPN è¿æ¥åˆ°å…¬å¸ç½‘ç»œæ—¶ï¼Œå®¢æˆ·ç«¯å’Œ VPN æœåŠ¡å™¨ä¼šä½¿ç”¨ç±»ä¼¼ Diffie-Hellman çš„æ–¹æ³•æ¥å»ºç«‹ä¸€ä¸ªå®‰å…¨çš„åŠ å¯†é€šé“ï¼Œä¿è¯ä¼ è¾“è¿‡ç¨‹ä¸­çš„æ•°æ®å®‰å…¨ã€‚</p></li><li><p><strong>HTTPS</strong>ï¼šè™½ç„¶ HTTPS ä¸»è¦ä½¿ç”¨å…¬é’¥åŠ å¯†æ¥äº¤æ¢å¯¹ç§°å¯†é’¥ï¼Œä½† Diffie-Hellman ç®—æ³•ä¹Ÿç»å¸¸ä½œä¸º TLS æ¡æ‰‹è¿‡ç¨‹ä¸­æ”¯æŒâ€œå®Œç¾å‰å‘ä¿å¯†â€çš„ä¸€ç§æ–¹å¼æ¥ä½¿ç”¨ã€‚</p></li></ol><p>æ€»ç»“ï¼š<code>crypto.diffieHellman(options)</code> å…è®¸ä¸¤ä¸ªå‚ä¸æ–¹åœ¨ä¸å®‰å…¨çš„ç¯å¢ƒä¸­äº§ç”Ÿä¸€ä¸ªå…±äº«çš„å¯†é’¥ï¼Œè¿™ä¸ªå¯†é’¥åç»­å¯ä»¥ç”¨äºå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œä¿éšœæ•°æ®çš„å®‰å…¨æ€§ã€‚</p><h3 id="crypto-hash-algorith-data-outputencoding" tabindex="-1"><a class="header-anchor" href="#crypto-hash-algorith-data-outputencoding"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptohashalgorith-data-outputencoding" target="_blank" rel="noopener noreferrer">crypto.hash(algorith, data[, outputEncoding])</a></span></a></h3><p>Node.js çš„ <code>crypto</code> æ¨¡å—æä¾›äº†åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å„ç§ç®—æ³•çš„å“ˆå¸Œï¼ˆæ•£åˆ—ï¼‰è¿ç®—ã€‚å“ˆå¸Œæ˜¯ä¸€ç§å°†æ•°æ®è½¬æ¢æˆå›ºå®šé•¿åº¦å­—ç¬¦ä¸²çš„æ–¹æ³•ã€‚è¿™ä¸ªå­—ç¬¦ä¸²å‡ ä¹ç‹¬ä¸€æ— äºŒï¼Œå³ä½¿æ˜¯å¾®å°çš„æ•°æ®å˜åŒ–ï¼Œéƒ½ä¼šäº§ç”Ÿå®Œå…¨ä¸åŒçš„å“ˆå¸Œå€¼ã€‚</p><p><code>crypto.hash()</code> æ˜¯ Node.js v21.7.1 ä¸­çš„ä¸€ä¸ªåŒæ­¥å‡½æ•°ï¼Œå®ƒå¯ä»¥å¿«é€Ÿåœ°ä¸ºç»™å®šçš„æ•°æ®ç”Ÿæˆå“ˆå¸Œå€¼ã€‚</p><h3 id="å‚æ•°è§£é‡Š-4" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-4"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>algorithm</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œç”¨äºæŒ‡å®šè¦ä½¿ç”¨çš„å“ˆå¸Œç®—æ³•ï¼Œå¦‚ <code>&#39;sha256&#39;</code>ã€<code>&#39;md5&#39;</code>ç­‰ã€‚</li><li><code>data</code>ï¼šè¿™æ˜¯éœ€è¦è¢«å“ˆå¸Œå¤„ç†çš„æ•°æ®ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–è€…æ˜¯ Buffer å¯¹è±¡ã€‚</li><li><code>outputEncoding</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œç”¨æ¥æŒ‡å®šè¾“å‡ºæ ¼å¼ã€‚å¦‚æœä½ è®¾ç½®äº†è¿™ä¸ªå‚æ•°ï¼Œè¾“å‡ºå°†æ˜¯ä¸€ä¸ªç¼–ç åçš„å­—ç¬¦ä¸²ï¼ˆå¦‚ <code>&#39;hex&#39;</code>ã€<code>&#39;base64&#39;</code>ï¼‰ï¼Œå¦åˆ™å°†è¿”å›ä¸€ä¸ª Buffer å¯¹è±¡ã€‚</li></ul><h3 id="ä½¿ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹-1"><span>ä½¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-å“ˆå¸Œå­—ç¬¦ä¸²å¹¶ä»¥åå…­è¿›åˆ¶å½¢å¼è¾“å‡º" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-å“ˆå¸Œå­—ç¬¦ä¸²å¹¶ä»¥åå…­è¿›åˆ¶å½¢å¼è¾“å‡º"><span>ç¤ºä¾‹ 1: å“ˆå¸Œå­—ç¬¦ä¸²å¹¶ä»¥åå…­è¿›åˆ¶å½¢å¼è¾“å‡º</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªç®€å•çš„ SHA-256 å“ˆå¸Œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç±»ä¼¼äº &quot;a591a6d40bf420404a011733cfb7b190d62c65bf0bcda32b57b277d9ad9f146e&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯¹å­—ç¬¦ä¸² <code>&#39;Hello, World!&#39;</code> åº”ç”¨äº† SHA-256 ç®—æ³•ï¼Œå¹¶æŠŠç»“æœä»¥åå…­è¿›åˆ¶å­—ç¬¦ä¸²æ ¼å¼è¾“å‡ºã€‚</p><h4 id="ç¤ºä¾‹-2-å“ˆå¸Œ-buffer-æ•°æ®å¹¶è¿”å›-buffer-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å“ˆå¸Œ-buffer-æ•°æ®å¹¶è¿”å›-buffer-å¯¹è±¡"><span>ç¤ºä¾‹ 2: å“ˆå¸Œ Buffer æ•°æ®å¹¶è¿”å› Buffer å¯¹è±¡</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªBufferå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨SHA-256ç®—æ³•åˆ›å»ºå“ˆå¸Œï¼Œä½†ä¸æŒ‡å®šè¾“å‡ºç¼–ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hashBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hashBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤å¤„æˆ‘ä»¬å¤„ç†äº†ä¸€ä¸ª Buffer å¯¹è±¡ï¼Œå¹¶ä¸”æ²¡æœ‰æŒ‡å®šè¾“å‡ºç¼–ç ï¼Œå› æ­¤å‡½æ•°è¿”å›äº†ä¸€ä¸ªå“ˆå¸Œå€¼çš„ Buffer å¯¹è±¡ã€‚</p><h3 id="æ³¨æ„ç‚¹" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„ç‚¹"><span>æ³¨æ„ç‚¹</span></a></h3><ul><li>åœ¨é€‰æ‹©å“ˆå¸Œç®—æ³•æ—¶ï¼Œåº”è¯¥é€‰æ‹©é€‚åˆçš„ç®—æ³•ï¼Œä¾‹å¦‚ <code>sha256</code> æˆ– <code>sha512</code>ï¼Œè€Œåƒ <code>md5</code> è¿™æ ·çš„æ—§ç®—æ³•ä¸å†è¢«è®¤ä¸ºæ˜¯å®‰å…¨çš„ã€‚</li><li>å“ˆå¸Œæ˜¯å•å‘çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä»å“ˆå¸Œå€¼æ˜¯æ— æ³•æ¢å¤åŸå§‹æ•°æ®çš„ã€‚</li><li>ç›¸åŒçš„è¾“å…¥æ•°æ®å°†æ€»æ˜¯äº§ç”Ÿç›¸åŒçš„å“ˆå¸Œå€¼ï¼Œä½†æ˜¯å“ªæ€•åªæœ‰ä¸€ä¸ªå­—èŠ‚çš„ä¸åŒï¼Œäº§ç”Ÿçš„å“ˆå¸Œå€¼ä¹Ÿä¼šæˆªç„¶ä¸åŒã€‚</li></ul><p>é€šè¿‡ä¸Šé¢çš„è¯´æ˜å’Œç¤ºä¾‹ï¼Œä½ åº”è¯¥å¯¹ <code>crypto.hash()</code> å‡½æ•°æœ‰äº†ä¸€ä¸ªåŸºæœ¬çš„äº†è§£ï¼Œå®ƒåœ¨æ•°æ®å®Œæ•´æ€§æ ¡éªŒã€å¯†ç å­˜å‚¨å’Œå…¶ä»–éœ€è¦æ•°æ®æŒ‡çº¹çš„åœºæ™¯ä¸­éå¸¸æœ‰ç”¨ã€‚</p><h3 id="crypto-generatekey-type-options-callback" tabindex="-1"><a class="header-anchor" href="#crypto-generatekey-type-options-callback"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptogeneratekeytype-options-callback" target="_blank" rel="noopener noreferrer">crypto.generateKey(type, options, callback)</a></span></a></h3><p>Node.js ä¸­çš„ <code>crypto.generateKey</code> å‡½æ•°æ˜¯ä¸€ä¸ªç”¨æ¥ç”Ÿæˆå¯†é’¥çš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å±äº Node.js çš„ <code>crypto</code> æ¨¡å—ã€‚å¯†é’¥æ˜¯åœ¨è¿›è¡ŒåŠ å¯†å’Œè§£å¯†æ“ä½œæ—¶éœ€è¦ç”¨åˆ°çš„ä¸€ä¸²å­—ç¬¦ã€‚åœ¨ä¸åŒçš„åŠ å¯†ç®—æ³•ä¸­ï¼Œå®ƒå¯ä»¥ç”¨æ¥ä¿æŠ¤æ•°æ®ä¸è¢«æœªæˆæƒè®¿é—®æˆ–è€…ç¯¡æ”¹ã€‚</p><p>ä»¥ä¸‹æ˜¯å¯¹ <code>crypto.generateKey</code> å‡½æ•°çš„è¯¦ç»†è§£é‡Šä»¥åŠä¸€äº›å®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><h3 id="å‚æ•°è¯´æ˜-1" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯´æ˜-1"><span>å‚æ•°è¯´æ˜</span></a></h3><ul><li><code>type</code>: è¿™ä¸ªå‚æ•°å‘Šè¯‰ <code>generateKey</code> å‡½æ•°è¦ç”Ÿæˆå“ªç§ç±»å‹çš„å¯†é’¥ã€‚å¸¸è§çš„ç±»å‹æœ‰ <code>&#39;rsa&#39;</code>ã€<code>&#39;dsa&#39;</code>ã€<code>&#39;ec&#39;</code> ç­‰ï¼Œåˆ†åˆ«ä»£è¡¨ä¸åŒçš„åŠ å¯†ç®—æ³•ã€‚</li><li><code>options</code>: è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†ç”Ÿæˆå¯†é’¥æ—¶çš„å„ç§é…ç½®é€‰é¡¹ã€‚ä¾‹å¦‚ï¼Œåœ¨ç”Ÿæˆ RSA å¯†é’¥æ—¶ï¼Œä½ å¯èƒ½éœ€è¦æŒ‡å®šå¯†é’¥çš„ä½æ•°ï¼ˆå¦‚ 2048 æˆ– 4096ï¼‰ã€‚</li><li><code>callback</code>: è¿™æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œä¸€æ—¦å¯†é’¥ç”Ÿæˆå®Œæˆï¼Œè¿™ä¸ªå‡½æ•°å°±ä¼šè¢«è°ƒç”¨ã€‚å®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼š<code>err</code> å’Œ <code>key</code>ã€‚å¦‚æœåœ¨ç”Ÿæˆå¯†é’¥è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ï¼Œ<code>err</code> å‚æ•°å°†åŒ…å«é”™è¯¯ä¿¡æ¯ï¼›å¦åˆ™ï¼Œ<code>key</code> å‚æ•°å°†åŒ…å«ç”Ÿæˆçš„å¯†é’¥ã€‚</li></ul><h3 id="ä½¿ç”¨ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹-2"><span>ä½¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æƒ³ä½¿ç”¨ <code>crypto.generateKey</code> æ¥ç”Ÿæˆä¸€ä¸ª RSA å¯†é’¥å¯¹ï¼Œå¹¶åœ¨ç”Ÿæˆå®Œæ¯•åå°†å…¶æ‰“å°å‡ºæ¥ã€‚ä¸‹é¢æ˜¯ä¸€æ®µç®€å•çš„ Node.js ä»£ç ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®šä¹‰ç”Ÿæˆå¯†é’¥çš„é€‰é¡¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> options</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// RSA å¯†é’¥ä½æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  publicKeyEncoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;spki&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å…¬é’¥çš„æ ¼å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¼–ç ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  privateKeyEncoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pkcs8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç§é’¥çš„æ ¼å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¼–ç ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-256-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŠ å¯†ç®—æ³•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    passphrase</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;top secret&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŠ å¯†å¯†ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è°ƒç”¨ generateKey å‡½æ•°æ¥ç”Ÿæˆå¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œæ‰“å°é”™è¯¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ‰“å°ç”Ÿæˆçš„å¯†é’¥ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°ç§é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¯·æ±‚ç”Ÿæˆä¸€ä¸ª RSA ç±»å‹çš„å¯†é’¥å¯¹ï¼Œå¹¶ä¸”æŒ‡å®šäº†ä¸€äº› RSA ç‰¹æœ‰çš„é€‰é¡¹ï¼Œæ¯”å¦‚å¯†é’¥ä½æ•° (<code>modulusLength</code>)ã€‚æˆ‘ä»¬è¿˜å®šä¹‰äº†å…¬é’¥å’Œç§é’¥çš„ç¼–ç æ ¼å¼å’Œç±»å‹ï¼Œå¦å¤–è¿˜ä¸ºç§é’¥è®¾ç½®äº†ä¸€ä¸ªå¯†ç å’ŒåŠ å¯†ç®—æ³•ï¼Œä»¥è¿›ä¸€æ­¥ä¿æŠ¤ç§é’¥çš„å®‰å…¨ã€‚</p><p>å½“ <code>crypto.generateKey</code> å®Œæˆå¯†é’¥ç”Ÿæˆåï¼Œå®ƒä¼šè°ƒç”¨æä¾›çš„å›è°ƒå‡½æ•°ï¼Œå¹¶å°†ç”Ÿæˆçš„å¯†é’¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™è¿™ä¸ªå‡½æ•°ã€‚åœ¨å›è°ƒå‡½æ•°å†…éƒ¨ï¼Œæˆ‘ä»¬æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯å‘ç”Ÿï¼Œå¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°å¹¶ä½¿ç”¨ç”Ÿæˆçš„å…¬é’¥å’Œç§é’¥äº†ã€‚</p><p>æ³¨æ„ï¼šåœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ é€šå¸¸ä¸ä¼šç›´æ¥å°†è¿™äº›å¯†é’¥æ‰“å°å‡ºæ¥æˆ–ä»¥æ˜æ–‡å½¢å¼å­˜å‚¨ï¼Œè€Œæ˜¯ä¼šå®‰å…¨åœ°ä¿å­˜å®ƒä»¬ï¼Œä»¥é˜²æ­¢å¯†é’¥æ³„éœ²å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚</p><h3 id="crypto-generatekeypair-type-options-callback" tabindex="-1"><a class="header-anchor" href="#crypto-generatekeypair-type-options-callback"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptogeneratekeypairtype-options-callback" target="_blank" rel="noopener noreferrer">crypto.generateKeyPair(type, options, callback)</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>crypto.generateKeyPair</code>æ˜¯ä¸€ä¸ªç”¨æ¥ç”Ÿæˆå¯†é’¥å¯¹çš„å‡½æ•°ï¼Œè¿™é‡Œçš„å¯†é’¥å¯¹é€šå¸¸æŒ‡çš„æ˜¯å…¬é’¥å’Œç§é’¥ã€‚è¿™ä¸ªåŠŸèƒ½åœ¨å®‰å…¨æ€§è¦æ±‚é«˜çš„ç¨‹åºä¸­éå¸¸é‡è¦ï¼Œæ¯”å¦‚éœ€è¦åŠ å¯†æ•°æ®æˆ–è€…éªŒè¯èº«ä»½çš„åœºæ™¯ã€‚</p><p>è®©æˆ‘ä»¬é€æ­¥ç†è§£<code>crypto.generateKeyPair</code>çš„ç”¨æ³•ï¼š</p><ol><li><p><strong>type</strong>ï¼šæŒ‡å®šç”Ÿæˆå¯†é’¥å¯¹çš„ç±»å‹ï¼Œå¸¸è§çš„ç±»å‹æœ‰<code>&#39;rsa&#39;</code>ã€<code>&#39;dsa&#39;</code>ã€<code>&#39;ec&#39;</code>ç­‰ï¼Œæ¯ç§ç±»å‹éƒ½ç”¨äºä¸åŒçš„åŠ å¯†ç®—æ³•ã€‚</p></li><li><p><strong>options</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†ä¸€äº›ç”Ÿæˆå¯†é’¥å¯¹æ—¶å¯ä»¥è®¾å®šçš„å‚æ•°ï¼Œæ¯”å¦‚å¯†é’¥çš„å¤§å°ã€ç®—æ³•ç±»å‹ã€åŠ å¯†é€‰é¡¹ç­‰ã€‚</p></li><li><p><strong>callback</strong>ï¼šå½“å¯†é’¥å¯¹ç”Ÿæˆå®Œæˆåä¼šè°ƒç”¨çš„å‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šé”™è¯¯ä¿¡æ¯(error)å’Œç”Ÿæˆçš„å¯†é’¥å¯¹ï¼ˆåŒ…æ‹¬å…¬é’¥å’Œç§é’¥ï¼‰ã€‚</p></li></ol><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡å‡ ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨<code>crypto.generateKeyPair</code>ã€‚</p><p><strong>ä¾‹å­ 1 - ç”Ÿæˆ RSA å¯†é’¥å¯¹</strong></p><p>RSA æ˜¯ä¸€ç§å¸¸ç”¨çš„éå¯¹ç§°å¯†ç ç®—æ³•ï¼Œå¹¿æ³›åº”ç”¨äºæ•°æ®åŠ å¯†å’Œæ•°å­—ç­¾åã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// optionså¯¹è±¡å®šä¹‰äº†å¯†é’¥å¯¹çš„ä¸€äº›å‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> options</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// RSAå¯†é’¥çš„å¤§å°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  publicKeyEncoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pkcs1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å…¬é’¥ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¼–ç æ ¼å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  privateKeyEncoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pkcs1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç§é’¥ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¼–ç æ ¼å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è°ƒç”¨generateKeyPairç”Ÿæˆå¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeyPair</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¦‚æœå‡ºé”™ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å¯†é’¥å¯¹ç”Ÿæˆå¤±è´¥:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ‰“å°ç”Ÿæˆçš„å…¬é’¥å’Œç§é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å…¬é’¥:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç§é’¥:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä¾‹å­ 2 - ç”Ÿæˆ ECï¼ˆæ¤­åœ†æ›²çº¿ï¼‰å¯†é’¥å¯¹</strong></p><p>æ¤­åœ†æ›²çº¿å¯†ç å­¦ï¼ˆECCï¼‰æ˜¯åŸºäºæ¤­åœ†æ›²çº¿æ•°å­¦çš„åŠ å¯†ç®—æ³•ï¼Œå®ƒå¯ä»¥åœ¨ç›¸å¯¹è¾ƒçŸ­çš„å¯†é’¥é•¿åº¦ä¸‹æä¾›å¼ºå¤§çš„å®‰å…¨æ€§ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨optionsä¸­æŒ‡å®šä½¿ç”¨çš„æ¤­åœ†æ›²çº¿</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> options</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  namedCurve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;secp256k1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æŒ‡å®šæ¤­åœ†æ›²çº¿çš„åç§°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  publicKeyEncoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;spki&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  privateKeyEncoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pkcs8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”ŸæˆECå¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeyPair</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ec&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å¯†é’¥å¯¹ç”Ÿæˆå¤±è´¥:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å…¬é’¥:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç§é’¥:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®é™…è¿ç”¨ä¸­ï¼Œä½ å¯èƒ½ä¼šç”¨å…¬é’¥æ¥åŠ å¯†æ•°æ®ç„¶åå‘é€ç»™å¦ä¸€ä¸ªäººï¼Œè€Œåªæœ‰æŒæœ‰ç§é’¥çš„é‚£ä¸ªäººèƒ½å¤Ÿè§£å¯†è¿™äº›æ•°æ®ã€‚æˆ–è€…ï¼Œä½ å¯ä»¥ç”¨ç§é’¥ç”Ÿæˆæ•°å­—ç­¾åä»¥è¯æ˜æ•°æ®ç¡®å®æ˜¯ç”±ä½ å‘é€çš„ï¼Œå¹¶ä¸”åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«ç¯¡æ”¹ï¼Œè€Œå…¶ä»–äººå¯ä»¥ä½¿ç”¨ä½ çš„å…¬é’¥æ¥éªŒè¯è¿™ä¸ªç­¾åçš„æœ‰æ•ˆæ€§ã€‚è¿™äº›å°±æ˜¯å¯†é’¥å¯¹åœ¨ç°ä»£äº’è”ç½‘é€šä¿¡ä¸­çš„ä¸€äº›å…³é”®ä½œç”¨ã€‚</p><h3 id="crypto-generatekeypairsync-type-options" tabindex="-1"><a class="header-anchor" href="#crypto-generatekeypairsync-type-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptogeneratekeypairsynctype-options" target="_blank" rel="noopener noreferrer">crypto.generateKeyPairSync(type, options)</a></span></a></h3><p>Node.js ä¸­çš„ <code>crypto.generateKeyPairSync</code> æ–¹æ³•æ˜¯ç”¨æ¥åŒæ­¥åœ°ç”Ÿæˆå¯†é’¥å¯¹çš„ä¸€ä¸ªå‡½æ•°ã€‚åœ¨å¯†ç å­¦ä¸­ï¼Œå¯†é’¥å¯¹é€šå¸¸åŒ…æ‹¬ä¸€ä¸ªå…¬é’¥å’Œä¸€ä¸ªç§é’¥ï¼Œå®ƒä»¬é€šå¸¸ç”¨äºéå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚å…¬é’¥å¯ä»¥åˆ†äº«ç»™ä»»ä½•äººç”¨æ¥åŠ å¯†æ•°æ®æˆ–éªŒè¯ç­¾åï¼Œè€Œç§é’¥åˆ™éœ€è¦ä¿å¯†ï¼Œç”¨æ¥è§£å¯†æ•°æ®æˆ–åˆ›å»ºæ•°å­—ç­¾åã€‚</p><p>åœ¨ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸­ï¼Œ<code>generateKeyPairSync</code> å‡½æ•°å…è®¸ä½ é€‰æ‹©ä¸åŒç±»å‹çš„å¯†é’¥å¯¹ç”Ÿæˆç®—æ³•ï¼Œå¹¶é€šè¿‡é€‰é¡¹æ¥é…ç½®ç”Ÿæˆçš„å¯†é’¥çš„ç‰¹å®šå±æ€§ã€‚</p><p>è®©æˆ‘ä»¬é€æ­¥åˆ†è§£è¿™ä¸ªå‡½æ•°çš„ä½¿ç”¨æ–¹æ³•ï¼š</p><h3 id="å‚æ•°-3" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-3"><span>å‚æ•°</span></a></h3><ol><li><code>type</code>: è¿™æ˜¯æŒ‡æ˜ç”Ÿæˆå“ªç§ç±»å‹å¯†é’¥å¯¹çš„å­—ç¬¦ä¸²å‚æ•°ã€‚å¸¸è§çš„ç±»å‹æœ‰ <code>&#39;rsa&#39;</code>, <code>&#39;ec&#39;</code>, <code>&#39;dsa&#39;</code>, <code>&#39;ed25519&#39;</code>, <code>&#39;ed448&#39;</code>, <code>&#39;x25519&#39;</code>, <code>&#39;x448&#39;</code> ç­‰ã€‚</li><li><code>options</code>: è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†å¤šç§å¯èƒ½å½±å“ç”Ÿæˆå¯†é’¥å¯¹çš„è¯¦ç»†é€‰é¡¹ã€‚</li></ol><h3 id="å¸¸è§ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#å¸¸è§ç”¨æ³•"><span>å¸¸è§ç”¨æ³•</span></a></h3><p>ä»¥ RSA å¯†é’¥å¯¹ä¸ºä¾‹ï¼Œå¦‚æœä½ æƒ³ç”Ÿæˆä¸€ä¸ª RSA å¯†é’¥å¯¹ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŒæ­¥ç”Ÿæˆ RSA å¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯†é’¥é•¿åº¦</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  publicKeyEncoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;spki&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨èçš„å…¬é’¥ç¼–ç æ ¼å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¼–ç ä¸º PEM æ ¼å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  privateKeyEncoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pkcs8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨èçš„ç§é’¥ç¼–ç æ ¼å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¼–ç ä¸º PEM æ ¼å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-256-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç§é’¥åŠ å¯†ç®—æ³•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    passphrase</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;top secret&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŠ å¯†ç§é’¥çš„å£ä»¤</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºç”Ÿæˆçš„å…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºç”Ÿæˆçš„å¹¶åŠ å¯†çš„ç§é’¥</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ª 2048 ä½é•¿çš„ RSA å¯†é’¥å¯¹ï¼Œå¹¶æŒ‡å®šäº†å…¬ç§é’¥çš„ç¼–ç æ–¹å¼å’Œæ ¼å¼ã€‚æ­¤å¤–ï¼Œç§é’¥è¿˜ä½¿ç”¨äº†ä¸€ä¸ªå«åš <code>aes-256-cbc</code> çš„ç®—æ³•è¿›è¡ŒåŠ å¯†ä¿æŠ¤ï¼Œè¿™æ„å‘³ç€åªæœ‰æ‹¥æœ‰æ­£ç¡®å£ä»¤çš„äººæ‰èƒ½å¤Ÿä½¿ç”¨è¿™ä¸ªç§é’¥ã€‚</p><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><ul><li><p><strong>HTTPS æœåŠ¡å™¨</strong>: åœ¨æ­å»ºä¸€ä¸ª HTTPS æœåŠ¡å™¨æ—¶ï¼Œä½ éœ€è¦ä¸€ä¸ª TLS/SSL è¯ä¹¦å’Œç›¸åº”çš„ç§é’¥ã€‚Node.js çš„ <code>generateKeyPairSync</code> æ–¹æ³•å¯ä»¥ç”¨æ¥ç”Ÿæˆè¿™ä¸ªç§é’¥ï¼Œç„¶åä½ å¯ä»¥å°†å®ƒå’Œè¯ä¹¦ä¸€èµ·ç”¨äºæœåŠ¡å™¨çš„å®‰å…¨é€šä¿¡ã€‚</p></li><li><p><strong>ç­¾åéªŒè¯</strong>: å¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦éªŒè¯æ–‡ä»¶æˆ–æ¶ˆæ¯å®Œæ•´æ€§çš„ç³»ç»Ÿï¼Œä½ å¯ä»¥ä½¿ç”¨ç”Ÿæˆçš„å¯†é’¥å¯¹æ¥å®ç°ã€‚å‘é€æ–¹ä½¿ç”¨ç§é’¥æ¥ç­¾ç½²æ¶ˆæ¯ï¼Œæ¥æ”¶æ–¹åˆ™ä½¿ç”¨å…¬é’¥æ¥éªŒè¯ç­¾åæ˜¯å¦æœ‰æ•ˆã€‚</p></li><li><p><strong>åŠ å¯†æ•°æ®</strong>: å½“ä½ éœ€è¦ç¡®ä¿åªæœ‰ç‰¹å®šçš„äººèƒ½è¯»å–æŸäº›æ•°æ®æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨å…¬é’¥æ¥åŠ å¯†è¿™äº›æ•°æ®ã€‚åªæœ‰æ‹¥æœ‰åŒ¹é…çš„ç§é’¥çš„äººæ‰èƒ½è§£å¯†è¿™äº›æ•°æ®ã€‚</p></li></ul><p>è®°ä½ï¼Œä½¿ç”¨ <code>generateKeyPairSync</code> ä¼šé˜»å¡äº‹ä»¶å¾ªç¯ï¼Œç›´åˆ°å¯†é’¥å¯¹ç”Ÿæˆå®Œæˆã€‚å¯¹äºéœ€è¦é«˜æ€§èƒ½çš„åº”ç”¨ï¼Œæˆ–è€…åœ¨ç”Ÿæˆå¤§å‹å¯†é’¥å¯¹æ—¶ï¼Œè€ƒè™‘ä½¿ç”¨å¼‚æ­¥ç‰ˆæœ¬ <code>crypto.generateKeyPair</code> å¯ä»¥é¿å…é˜»å¡ï¼Œæé«˜åº”ç”¨çš„å“åº”é€Ÿåº¦ã€‚</p><h3 id="crypto-generatekeysync-type-options" tabindex="-1"><a class="header-anchor" href="#crypto-generatekeysync-type-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptogeneratekeysynctype-options" target="_blank" rel="noopener noreferrer">crypto.generateKeySync(type, options)</a></span></a></h3><p>Node.js çš„ <code>crypto.generateKeySync</code> å‡½æ•°æ˜¯ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œç”¨æ¥ç”Ÿæˆå¯†é’¥ã€‚åœ¨å¯†ç å­¦ä¸­ï¼Œå¯†é’¥æ˜¯ä¸€ä¸²ç”¨äºåŠ å¯†å’Œè§£å¯†æ•°æ®çš„ä¿¡æ¯ï¼›å®ƒä»¬æ˜¯ä¿æŠ¤æ•°å­—ä¿¡æ¯ä¸è¢«æœªæˆæƒè®¿é—®çš„åŸºç¡€ã€‚</p><h3 id="å‚æ•°è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯¦è§£"><span>å‚æ•°è¯¦è§£</span></a></h3><ul><li><p><code>type</code>ï¼šè¿™ä¸ªå‚æ•°ç”¨äºæŒ‡å®šè¦ç”Ÿæˆçš„å¯†é’¥ç±»å‹ã€‚é€šå¸¸å¯ä»¥æ˜¯ <code>&#39;rsa&#39;</code>, <code>&#39;dsa&#39;</code>, <code>&#39;ec&#39;</code>, <code>&#39;ed25519&#39;</code>, <code>&#39;ed448&#39;</code>, <code>&#39;x25519&#39;</code>, <code>&#39;x448&#39;</code>, æˆ–è€… <code>&#39;dh&#39;</code> ä¸­çš„ä¸€ä¸ªã€‚æ¯ç§ç±»å‹ä»£è¡¨äº†ä¸åŒçš„åŠ å¯†ç®—æ³•å’Œå¯†é’¥å½¢å¼ã€‚</p></li><li><p><code>options</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†è¯¦ç»†çš„é…ç½®é€‰é¡¹ï¼Œè¿™äº›é€‰é¡¹ä¼šæ ¹æ®ä½ é€‰æ‹©çš„ <code>type</code> è€Œæœ‰æ‰€ä¸åŒã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ é€‰æ‹© <code>&#39;rsa&#39;</code> ç±»å‹ï¼Œä½ å¯ä»¥è®¾ç½®å¯†é’¥çš„å¤§å°ï¼ˆ<code>modulusLength</code>ï¼‰ï¼Œå…¬å¼€æŒ‡æ•°ï¼ˆ<code>publicExponent</code>ï¼‰ç­‰ã€‚</p></li></ul><h3 id="è¿”å›å€¼-4" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-4"><span>è¿”å›å€¼</span></a></h3><p>è¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªåŒ…å«å¯†é’¥å¯¹çš„å¯¹è±¡ã€‚å¯¹äºéå¯¹ç§°åŠ å¯†ç®—æ³•ï¼ˆåƒ <code>RSA</code> æˆ– <code>ECDSA</code>ï¼‰ï¼Œè¿™ä¸ªå¯¹è±¡å°†ä¼šæœ‰ <code>publicKey</code> å’Œ <code>privateKey</code> ä¸¤ä¸ªå±æ€§ï¼Œåˆ†åˆ«ç”¨äºåŠ å¯†å’Œè§£å¯†æ“ä½œã€‚</p><h3 id="ä½¿ç”¨ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­-2"><span>ä½¿ç”¨ä¾‹å­ï¼š</span></a></h3><p>å‡è®¾ä½ éœ€è¦ç”Ÿæˆä¸€ä¸ª RSA å¯†é’¥å¯¹æ¥åŠ å¯†ä¼ è¾“æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®ç”Ÿæˆå¯†é’¥çš„é€‰é¡¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> options</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯†é’¥é•¿åº¦</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  publicExponent</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0x10101</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å…¬å¼€æŒ‡æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  publicKeyEncoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;spki&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨èçš„å…¬é’¥ç¼–ç æ ¼å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¼–ç ä¸ºæ–‡æœ¬æ ¼å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  privateKeyEncoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pkcs8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç§é’¥ä½¿ç”¨çš„ç¼–ç æ ¼å¼è§„èŒƒ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¼–ç ä¸ºæ–‡æœ¬æ ¼å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-256-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŠ å¯†ç§é’¥çš„ç®—æ³•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    passphrase</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;top secret&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŠ å¯†ç§é’¥çš„å¯†ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆå¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeySync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ˜¾ç¤ºå…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ˜¾ç¤ºç§é’¥</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† Node.js çš„ <code>crypto</code> æ¨¡å—ã€‚ç„¶åå®šä¹‰äº†ä¸€ä¸ª <code>options</code> å¯¹è±¡æ¥æŒ‡å®šç”Ÿæˆå¯†é’¥æ—¶çš„å„ç§å‚æ•°ã€‚æ¥ç€ï¼Œæˆ‘ä»¬è°ƒç”¨äº† <code>crypto.generateKeySync</code> æ–¹æ³•å¹¶ä¼ å…¥ <code>&#39;rsa&#39;</code> ä½œä¸ºå¯†é’¥ç±»å‹ä»¥åŠä¹‹å‰å®šä¹‰å¥½çš„ <code>options</code>ã€‚æœ€åï¼Œæˆ‘ä»¬è¾“å‡ºäº†ç”Ÿæˆçš„å…¬é’¥å’Œç§é’¥ã€‚</p><h3 id="å®é™…åº”ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨åœºæ™¯"><span>å®é™…åº”ç”¨åœºæ™¯</span></a></h3><ul><li><strong>HTTPS / SSL/TLS</strong>ï¼šç½‘ç«™éƒ¨ç½² HTTPS åè®®æ—¶ï¼Œéœ€è¦ä½¿ç”¨ RSAã€ECDSA ç­‰ç®—æ³•ç”Ÿæˆçš„å¯†é’¥å¯¹åˆ›å»º SSL/TLS è¯ä¹¦ã€‚</li><li><strong>åŠ å¯†é€šä¿¡</strong>ï¼šåœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨é—´å®‰å…¨é€šä¿¡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç”Ÿæˆçš„å¯†é’¥å¯¹è¿›è¡Œæ•°æ®åŠ å¯†ï¼Œç¡®ä¿åªæœ‰æ‹¥æœ‰å¯¹åº”ç§é’¥çš„æ¥æ”¶æ–¹èƒ½å¤Ÿè§£å¯†æ¶ˆæ¯ã€‚</li><li><strong>ç­¾åéªŒè¯</strong>ï¼šè½¯ä»¶å‘å¸ƒæ—¶ï¼Œå¼€å‘è€…å¯ä»¥ä½¿ç”¨ç§é’¥å¯¹è½¯ä»¶è¿›è¡Œç­¾åï¼Œç”¨æˆ·é€šè¿‡å…¬é’¥å¯ä»¥éªŒè¯è½¯ä»¶åŒ…çš„å®Œæ•´æ€§å’Œæ¥æºã€‚</li></ul><p>ä»¥ä¸Šä»‹ç»äº† <code>crypto.generateKeySync</code> å‡½æ•°çš„åŸºæœ¬ç”¨æ³•å’Œä¸€äº›å®é™…çš„åº”ç”¨åœºæ™¯ã€‚ç”±äºæ¶‰åŠåˆ°åŠ å¯†çŸ¥è¯†ï¼Œå»ºè®®åœ¨å®é™…åº”ç”¨ä¸­è¿˜éœ€æ·±å…¥å­¦ä¹ ç›¸å…³çš„å¯†ç å­¦åŸç†ä»¥ç¡®ä¿æ­£ç¡®å’Œå®‰å…¨åœ°ä½¿ç”¨å¯†é’¥ã€‚</p><h3 id="crypto-generateprime-size-options-callback" tabindex="-1"><a class="header-anchor" href="#crypto-generateprime-size-options-callback"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptogenerateprimesize-options-callback" target="_blank" rel="noopener noreferrer">crypto.generatePrime(size[, options[, callback]])</a></span></a></h3><p>Node.js ä¸­çš„ <code>crypto.generatePrime(size[, options[, callback]])</code> æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºç”ŸæˆæŒ‡å®šä½æ•°çš„è´¨æ•°ã€‚è¿™ä¸ªå‡½æ•°æ˜¯ Node.js å†…ç½®çš„ <code>crypto</code> æ¨¡å—é‡Œé¢çš„ä¸€ä¸ªæ–¹æ³•ï¼Œä¸»è¦ç”¨äºå¯†ç å­¦å’Œå®‰å…¨ç›¸å…³çš„åœºæ™¯ã€‚</p><p>ä¸‹é¢æˆ‘ä¼šåˆ†å‡ ä¸ªéƒ¨åˆ†è§£é‡Šè¿™ä¸ªå‡½æ•°ï¼š</p><h3 id="å‡½æ•°å‚æ•°è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#å‡½æ•°å‚æ•°è¯´æ˜"><span>å‡½æ•°å‚æ•°è¯´æ˜</span></a></h3><ol><li><p><strong>size</strong>: æŒ‡å®šç”Ÿæˆè´¨æ•°çš„ä½æ•°ï¼ˆbitï¼‰ï¼Œä¾‹å¦‚å¦‚æœä½ å¸Œæœ›ç”Ÿæˆä¸€ä¸ª 1024 ä½çš„è´¨æ•°ï¼Œä½ å°±å°†è¿™ä¸ªå€¼è®¾ç½®ä¸º 1024ã€‚</p></li><li><p><strong>options</strong>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥åŒ…å«ä¸€äº›é¢å¤–çš„é…ç½®é€‰é¡¹ï¼Œæ¯”å¦‚ï¼š</p><ul><li><strong>safe</strong>: å¦‚æœè®¾ç½®ä¸º <code>true</code>ï¼Œé‚£ä¹ˆå°†ç”Ÿæˆä¸€ä¸ªå®‰å…¨è´¨æ•°ï¼Œå³ <code>(p-1)/2</code> ä¹Ÿæ˜¯ä¸€ä¸ªè´¨æ•°ã€‚å®‰å…¨è´¨æ•°åœ¨æŸäº›åŠ å¯†ç®—æ³•ä¸­æ›´å®‰å…¨ã€‚</li><li><strong>add</strong>: æŒ‡å®šä¸€ä¸ªæ•°ï¼Œç”Ÿæˆçš„è´¨æ•°ä¼šæ˜¯è¿™ä¸ªæ•°çš„å€æ•°åŠ ä¸Š <code>rem</code> çš„å€¼ã€‚</li><li><strong>rem</strong>: ä¸ <code>add</code> ä¸€èµ·ä½¿ç”¨ï¼Œè¯¦è§ä¸Šé¢çš„æè¿°ã€‚</li><li><strong>bigint</strong>: å¦‚æœè®¾ç½®ä¸º <code>true</code>ï¼Œé‚£ä¹ˆç”Ÿæˆçš„è´¨æ•°ä¼šä»¥ BigInt ç±»å‹è¿”å›ï¼Œé€‚ç”¨äºè¶…è¿‡ JavaScript æœ€å¤§æ•°å­—é™åˆ¶çš„æƒ…å†µã€‚</li></ul></li><li><p><strong>callback</strong>: è¿™æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå½“è´¨æ•°ç”Ÿæˆå®Œæˆåä¼šè¢«è°ƒç”¨ã€‚å›è°ƒå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼š</p><ul><li><strong>err</strong>: é”™è¯¯å¯¹è±¡ï¼Œå¦‚æœåœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œåˆ™æ­¤å‚æ•°ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼Œå¦åˆ™ä¸º nullã€‚</li><li><strong>prime</strong>: ç”Ÿæˆçš„è´¨æ•°ï¼Œå¦‚æœ <code>options</code> ä¸­è®¾ç½®äº† <code>bigint</code> ä¸º <code>true</code>ï¼Œåˆ™ä¸º BigInt ç±»å‹ï¼Œå¦åˆ™ä¸º Buffer ç±»å‹ã€‚</li></ul></li></ol><h3 id="å‡½æ•°ä½¿ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å‡½æ•°ä½¿ç”¨ä¾‹å­"><span>å‡½æ•°ä½¿ç”¨ä¾‹å­</span></a></h3><p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦ç”Ÿæˆä¸€ä¸ª 256 ä½çš„å®‰å…¨è´¨æ•°ï¼Œå¹¶ä¸”æƒ³è¦ä»¥å¼‚æ­¥çš„æ–¹å¼è·å–ç»“æœï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®šä¹‰ç”Ÿæˆè´¨æ•°çš„ä½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> primeLength</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 256</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®šä¹‰é€‰é¡¹ï¼Œè¦æ±‚ç”Ÿæˆå®‰å…¨è´¨æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> options</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  safe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  bigint</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è°ƒç”¨ generatePrime å‡½æ•°ç”Ÿæˆè´¨æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generatePrime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">primeLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">prime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å‘ç”Ÿé”™è¯¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç”Ÿæˆçš„å®‰å…¨è´¨æ•°æ˜¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">prime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¯·æ±‚ç”Ÿæˆä¸€ä¸ª 256 ä½çš„å®‰å…¨è´¨æ•°ã€‚æˆ‘ä»¬é€šè¿‡ <code>options</code> å¯¹è±¡æŒ‡å®šäº†æˆ‘ä»¬å¸Œæœ›ç»“æœæ˜¯ä¸€ä¸ª BigInt ç±»å‹çš„æ•°ï¼Œå¹¶ä¸”å®ƒåº”è¯¥æ˜¯ä¸€ä¸ªå®‰å…¨è´¨æ•°ã€‚ç„¶åï¼Œæˆ‘ä»¬ä¼ é€’äº†ä¸€ä¸ªå›è°ƒå‡½æ•°ç»™ <code>generatePrime</code> æ–¹æ³•ï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°åœ¨è´¨æ•°ç”Ÿæˆä¹‹åè°ƒç”¨ï¼Œæ‰“å°å‡ºç”Ÿæˆçš„è´¨æ•°æˆ–è€…å¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚</p><h3 id="å®é™…åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨"><span>å®é™…åº”ç”¨</span></a></h3><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œç”Ÿæˆè´¨æ•°é€šå¸¸ç”¨äºåˆ›å»ºåŠ å¯†å¯†é’¥æˆ–è€…è¿›è¡Œæ•°å­—ç­¾åã€‚ä¾‹å¦‚ï¼Œåœ¨ RSA åŠ å¯†ç®—æ³•ä¸­ï¼Œéœ€è¦ä¸¤ä¸ªå¤§çš„è´¨æ•°æ¥ç”Ÿæˆå…¬é’¥å’Œç§é’¥ã€‚ä½¿ç”¨ <code>crypto.generatePrime</code> å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨è¿™ç±»åœºæ™¯ä¸‹å¾—åˆ°æ‰€éœ€çš„è´¨æ•°ã€‚</p><h3 id="crypto-generateprimesync-size-options" tabindex="-1"><a class="header-anchor" href="#crypto-generateprimesync-size-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptogenerateprimesyncsize-options" target="_blank" rel="noopener noreferrer">crypto.generatePrimeSync(size[, options])</a></span></a></h3><p><code>crypto.generatePrimeSync(size[, options])</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—æä¾›çš„ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œç”¨äºç”ŸæˆæŒ‡å®šä½æ•°çš„è´¨æ•°ï¼ˆPrimeï¼‰ã€‚è¿™ä¸ªæ–¹æ³•ä¸»è¦åœ¨éœ€è¦é«˜å®‰å…¨æ€§çš„åœºåˆä½¿ç”¨ï¼Œæ¯”å¦‚åˆ›å»ºåŠ å¯†å¯†é’¥æˆ–å…¶ä»–åŠ å¯†æ“ä½œæ—¶ã€‚</p><p>ä¸‹é¢æ˜¯è¿™ä¸ªæ–¹æ³•çš„åŸºæœ¬ç»„æˆï¼š</p><ul><li><strong>size</strong>ï¼šä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºéœ€è¦ç”Ÿæˆçš„è´¨æ•°çš„ä½æ•°ï¼ˆä»¥æ¯”ç‰¹ä¸ºå•ä½ï¼‰ã€‚è¿™å†³å®šäº†ç”Ÿæˆçš„è´¨æ•°çš„å¤§å°ï¼Œæ›´å¤šçš„ä½æ•°æ„å‘³ç€æ›´å¤§ã€æ›´å®‰å…¨çš„è´¨æ•°ï¼Œä½†ä¹Ÿæ„å‘³ç€éœ€è¦æ›´é•¿çš„è®¡ç®—æ—¶é—´ã€‚</li><li><strong>options</strong>ï¼šä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥è®¾ç½®ç”Ÿæˆè´¨æ•°æ—¶çš„ä¸€äº›é¢å¤–é€‰é¡¹ã€‚ä¾‹å¦‚ï¼š <ul><li><strong>add</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰çš„å€¼ï¼Œå¦‚æœè®¾ç½®äº†ï¼Œç”Ÿæˆçš„è´¨æ•°ä¼šæ»¡è¶³æ¡ä»¶ p % add === remainderï¼ˆå…¶ä¸­ p æ˜¯ç”Ÿæˆçš„è´¨æ•°ï¼‰ã€‚</li><li><strong>rem</strong>ï¼šå½“è®¾ç½®äº† <code>add</code> é€‰é¡¹æ—¶ï¼Œè¿™ä¸ªå€¼ç”¨æ¥ç¡®å®šå…·ä½“çš„ä½™æ•°ã€‚</li><li><strong>safe</strong>ï¼šå¦‚æœè®¾ç½®ä¸º <code>true</code>ï¼Œåˆ™ç”Ÿæˆçš„è´¨æ•°å°†æ˜¯ä¸€ä¸ªå®‰å…¨è´¨æ•°ï¼Œå³ (p-1)/2 ä¹Ÿæ˜¯ä¸€ä¸ªè´¨æ•°ã€‚</li></ul></li></ul><p>å‡½æ•°è°ƒç”¨åä¼šè¿”å›ä¸€ä¸ª <code>Buffer</code> å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«äº†ç”Ÿæˆçš„è´¨æ•°ã€‚</p><p>è®©æˆ‘ç»™æ‚¨ä¸¾å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><h3 id="ç¤ºä¾‹-1-ç”Ÿæˆä¸€ä¸ª-1024-ä½çš„è´¨æ•°" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ç”Ÿæˆä¸€ä¸ª-1024-ä½çš„è´¨æ•°"><span>ç¤ºä¾‹ 1ï¼šç”Ÿæˆä¸€ä¸ª 1024 ä½çš„è´¨æ•°</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆä¸€ä¸ª 1024 ä½çš„è´¨æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> prime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generatePrimeSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1024</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">prime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºè´¨æ•°çš„åå…­è¿›åˆ¶è¡¨ç¤º</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ªé•¿è¾¾ 1024 ä½çš„è´¨æ•°ï¼Œå¹¶å°†å…¶è½¬æ¢æˆåå…­è¿›åˆ¶å­—ç¬¦ä¸²è¾“å‡ºã€‚è¿™ç§è´¨æ•°å¯èƒ½ç”¨äºåˆ›å»ºå¯†é’¥å¯¹ã€‚</p><h3 id="ç¤ºä¾‹-2-ç”Ÿæˆä¸€ä¸ª-512-ä½çš„å®‰å…¨è´¨æ•°" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ç”Ÿæˆä¸€ä¸ª-512-ä½çš„å®‰å…¨è´¨æ•°"><span>ç¤ºä¾‹ 2ï¼šç”Ÿæˆä¸€ä¸ª 512 ä½çš„å®‰å…¨è´¨æ•°</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆä¸€ä¸ª 512 ä½çš„å®‰å…¨è´¨æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> prime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generatePrimeSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">512</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">safe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">prime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºè´¨æ•°çš„åå…­è¿›åˆ¶è¡¨ç¤º</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®‰å…¨è´¨æ•°æ„å‘³ç€ <code>(p-1)/2</code> ä¹Ÿæ˜¯è´¨æ•°ï¼Œå®ƒä»¬åœ¨æŸäº›åŠ å¯†ç®—æ³•ä¸­æ›´åŠ åå¥½ï¼Œå› ä¸ºå®ƒä»¬æä¾›äº†é¢å¤–çš„å®‰å…¨æ€§ã€‚</p><h3 id="ç¤ºä¾‹-3-ç”Ÿæˆä¸€ä¸ªæ»¡è¶³ç‰¹å®šæ¡ä»¶çš„è´¨æ•°" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-ç”Ÿæˆä¸€ä¸ªæ»¡è¶³ç‰¹å®šæ¡ä»¶çš„è´¨æ•°"><span>ç¤ºä¾‹ 3ï¼šç”Ÿæˆä¸€ä¸ªæ»¡è¶³ç‰¹å®šæ¡ä»¶çš„è´¨æ•°</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆä¸€ä¸ª 256 ä½çš„è´¨æ•°ï¼Œå®ƒåœ¨é™¤ä»¥ 3 çš„æƒ…å†µä¸‹ä½™æ•°ä¸º 2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> prime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generatePrimeSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">rem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">prime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;16&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ªæ»¡è¶³ç‰¹å®šæ•°å­¦æ¡ä»¶çš„è´¨æ•°ï¼šå½“è¿™ä¸ªè´¨æ•°è¢« 3 é™¤æ—¶ï¼Œå…¶ä½™æ•°å¿…é¡»æ˜¯ 2ã€‚è¿™ç§ç±»å‹çš„è´¨æ•°å¯èƒ½åœ¨éœ€è¦æ»¡è¶³ç‰¹å®šæ¡ä»¶çš„æ•°å­¦è¿ç®—æˆ–ç®—æ³•ä¸­æœ‰ç‰¹æ®Šç”¨é€”ã€‚</p><p>æ€»ä¹‹ï¼Œ<code>crypto.generatePrimeSync</code> æ–¹æ³•åœ¨ Node.js ä¸­æä¾›äº†ä¸€ç§ç”Ÿæˆé«˜å®‰å…¨æ€§è´¨æ•°çš„æ–¹å¼ï¼Œè¿™åœ¨åŠ å¯†å’Œå®‰å…¨é¢†åŸŸéå¸¸é‡è¦ï¼Œå°¤å…¶æ˜¯åœ¨æ¶‰åŠå¯†é’¥ç”Ÿæˆå’Œå¯†é’¥äº¤æ¢åè®®ç­‰æ–¹é¢ã€‚</p><h3 id="crypto-getcipherinfo-nameornid-options" tabindex="-1"><a class="header-anchor" href="#crypto-getcipherinfo-nameornid-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptogetcipherinfonameornid-options" target="_blank" rel="noopener noreferrer">crypto.getCipherInfo(nameOrNid[, options])</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘ä¼šå°½é‡ç”¨ç®€å•çš„è¯­è¨€æ¥è§£é‡Šè¿™ä¸ªå‡½æ•°ã€‚</p><p><code>crypto.getCipherInfo(nameOrNid[, options])</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå±äº <code>crypto</code> è¿™ä¸ªæ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—æä¾›äº†åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯¹æ•°æ®è¿›è¡Œç¼–ç å’Œè§£ç ç­‰ã€‚åœ¨è¿™é‡Œï¼Œ<code>getCipherInfo</code> è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯è·å–å…³äºä¸€ä¸ªç‰¹å®šåŠ å¯†ç®—æ³•ï¼ˆcipherï¼‰çš„ä¿¡æ¯ã€‚</p><p><strong>å‚æ•°è§£é‡Šï¼š</strong></p><ul><li><code>nameOrNid</code>: è¿™ä¸ªå‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»£è¡¨åŠ å¯†ç®—æ³•çš„åç§°ï¼Œæ¯”å¦‚ <code>&#39;aes-128-cbc&#39;</code>ï¼›æˆ–è€…æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œä»£è¡¨åŠ å¯†ç®—æ³•çš„ NID (Numerical Identifier)ï¼Œä¸è¿‡é€šå¸¸æˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨ç®—æ³•åç§°ã€‚</li><li><code>options</code>: å¯é€‰å‚æ•°ï¼Œå¯ä»¥æä¾›é¢å¤–çš„é…ç½®é¡¹ã€‚</li></ul><p><strong>è¿”å›å€¼ï¼š</strong></p><p>è°ƒç”¨è¿™ä¸ªå‡½æ•°åï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡ä¸­åŒ…å«äº†å¯¹åº”åŠ å¯†ç®—æ³•çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ¯”å¦‚ç®—æ³•çš„åå­—ã€å¯†é’¥é•¿åº¦ã€èƒ½å¦ç”¨äºåŠ å¯†ã€æ˜¯å¦ä¸ºæµå¼ç®—æ³•ç­‰ç­‰ã€‚</p><p><strong>å®é™…ä¾‹å­ï¼š</strong></p><ol><li>å‡è®¾ä½ éœ€è¦åŠ å¯†ä¸€äº›æ•æ„Ÿæ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·å¯†ç ï¼Œä½ å¯èƒ½ä¼šæƒ³çŸ¥é“å“ªç§åŠ å¯†ç®—æ³•é€‚åˆä½ ã€‚åœ¨é€‰æ‹©ä¹‹å‰ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>getCipherInfo</code> æ¥è·å–æœ‰å…³ä¸åŒåŠ å¯†ç®—æ³•çš„è¯¦ç»†ä¿¡æ¯ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å– AES-128-CBC åŠ å¯†ç®—æ³•çš„ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipherInfo</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getCipherInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-128-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">cipherInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ä½ è¿è¡Œä¸Šé¢çš„ä»£ç æ—¶ï¼Œä½ å°†å¾—åˆ°ç±»ä¼¼ä»¥ä¸‹çš„è¾“å‡ºï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">  &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-128-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">  &quot;nid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">419</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">  &quot;blockSize&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">  &quot;ivLength&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">  &quot;keyLength&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">  &quot;mode&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">  &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;block&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™è¡¨ç¤º <code>aes-128-cbc</code> æ˜¯ä¸€ä¸ªå—åŠ å¯†ç®—æ³•ï¼Œå®ƒæœ‰ 16 å­—èŠ‚çš„å—å¤§å°ã€16 å­—èŠ‚çš„ IVï¼ˆåˆå§‹åŒ–å‘é‡ï¼‰é•¿åº¦ä»¥åŠ 16 å­—èŠ‚çš„å¯†é’¥é•¿åº¦ã€‚</p><ol start="2"><li>å¦‚æœä½ æ­£åœ¨ç¼–å†™ä¸€æ¬¾éœ€è¦é«˜å®‰å…¨çº§åˆ«çš„åº”ç”¨ç¨‹åºï¼Œä½ å¯èƒ½æƒ³è¦ç¡®ä¿ä½¿ç”¨çš„æ˜¯æ¨èçš„ã€å®‰å…¨çš„åŠ å¯†ç®—æ³•ã€‚ä½ å¯ä»¥å…ˆé€šè¿‡ <code>crypto.getCipherInfo</code> å‡½æ•°æŸ¥è¯¢ç®—æ³•çš„è¯¦ç»†ä¿¡æ¯ï¼Œç¡®ä¿å…¶æ»¡è¶³ä½ çš„å®‰å…¨éœ€æ±‚ï¼Œç„¶åå†å®æ–½åŠ å¯†ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æŸ¥è¯¢å¹¶åˆ¤æ–­æŸä¸ªåŠ å¯†ç®—æ³•æ˜¯å¦è¢«è®¤ä¸ºæ˜¯å®‰å…¨çš„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipherName</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;aes-256-gcm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¸€ç§å¹¿æ³›è®¤ä¸ºå¾ˆå®‰å…¨çš„åŠ å¯†ç®—æ³•</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipherInfo</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getCipherInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">cipherName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">cipherInfo</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipherInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;block&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipherInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">keyLength</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 32</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">cipherName</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> is considered secure.`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">cipherName</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> might not be secure enough.`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç æ£€æŸ¥äº† <code>aes-256-gcm</code> ç®—æ³•çš„ç±»å‹å’Œå¯†é’¥é•¿åº¦æ¥å†³å®šå®ƒæ˜¯å¦è¶³å¤Ÿå®‰å…¨ã€‚</p><p>ç®€è€Œè¨€ä¹‹ï¼Œ<code>crypto.getCipherInfo</code> æ˜¯ä¸€é¡¹éå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œå®ƒå¯ä»¥å¸®åŠ©å¼€å‘è€…äº†è§£å’Œé€‰æ‹©æœ€é€‚åˆè‡ªå·±é¡¹ç›®çš„åŠ å¯†ç®—æ³•ã€‚é€šè¿‡äº†è§£æ¯ä¸ªåŠ å¯†ç®—æ³•çš„å…·ä½“ä¿¡æ¯ï¼Œå¼€å‘è€…èƒ½å¤Ÿåšå‡ºæ›´æ˜æ™ºçš„å†³ç­–ï¼Œå¹¶ç¡®ä¿ä»–ä»¬çš„åº”ç”¨ç¨‹åºæˆ–æœåŠ¡å…·å¤‡è‰¯å¥½çš„åŠ å¯†å®‰å…¨æ€§ã€‚</p><h3 id="crypto-getciphers" tabindex="-1"><a class="header-anchor" href="#crypto-getciphers"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptogetciphers" target="_blank" rel="noopener noreferrer">crypto.getCiphers()</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘å¾ˆä¹æ„å¸®åŠ©ä½ ç†è§£ Node.js ä¸­çš„ <code>crypto.getCiphers()</code> æ–¹æ³•ã€‚</p><p>é¦–å…ˆï¼Œ<code>crypto</code> æ˜¯ Node.js çš„ä¸€ä¸ªå†…ç½®æ¨¡å—ï¼Œå®ƒæä¾›äº†åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ã€‚åœ¨ç½‘ç»œé€šä¿¡å’Œå­˜å‚¨æ•æ„Ÿä¿¡æ¯æ—¶ï¼ŒåŠ å¯†æ˜¯ä¿éšœæ•°æ®å®‰å…¨ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚</p><p>è€Œ <code>crypto.getCiphers()</code> æ˜¯ <code>crypto</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒçš„ä½œç”¨æ˜¯åˆ—å‡ºå½“å‰ç‰ˆæœ¬çš„ Node.js æ‰€æ”¯æŒçš„æ‰€æœ‰åŠ å¯†ç®—æ³•çš„åç§°ã€‚æ‰€è°“åŠ å¯†ç®—æ³•å°±æ˜¯ä¸€ç³»åˆ—ç”¨äºåŠ å¯†å’Œè§£å¯†æ•°æ®çš„æ•°å­¦æŒ‡ä»¤é›†åˆã€‚ä¸åŒçš„ç®—æ³•æœ‰ç€ä¸åŒçš„ç‰¹ç‚¹ï¼Œæ¯”å¦‚å®‰å…¨æ€§ã€é€Ÿåº¦ç­‰ã€‚</p><p>ç°åœ¨è®©æˆ‘ä»¬ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥çœ‹çœ‹ <code>crypto.getCiphers()</code> åœ¨å®é™…åº”ç”¨ä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªéœ€è¦å¯¹ç”¨æˆ·å¯†ç è¿›è¡ŒåŠ å¯†çš„ç¨‹åºï¼Œä½†ä½ ä¸ç¡®å®šåº”è¯¥ä½¿ç”¨å“ªç§åŠ å¯†ç®—æ³•ã€‚è¿™æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>crypto.getCiphers()</code> æ¥è·å–æ‰€æœ‰å¯ç”¨çš„åŠ å¯†ç®—æ³•åˆ—è¡¨ï¼Œç„¶åé€‰æ‹©ä¸€ä¸ªé€‚åˆä½ éœ€æ±‚çš„ç®—æ³•ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ Node.js è„šæœ¬ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥ crypto æ¨¡å—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ crypto.getCiphers() æ–¹æ³•è·å–æ”¯æŒçš„åŠ å¯†ç®—æ³•åˆ—è¡¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> availableCiphers</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getCiphers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºæ¥çœ‹çœ‹éƒ½æœ‰å“ªäº›ç®—æ³•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">availableCiphers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ä½ è¿è¡Œè¿™ä¸ªè„šæœ¬æ—¶ï¼Œå®ƒä¼šæ˜¾ç¤ºç±»ä¼¼äºä»¥ä¸‹çš„è¾“å‡ºï¼ˆå…·ä½“çš„è¾“å‡ºå–å†³äºä½ ä½¿ç”¨çš„ Node.js ç‰ˆæœ¬ï¼‰ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>[</span></span>
<span class="line"><span>  &#39;aes-128-cbc&#39;, &#39;aes-128-ccm&#39;, &#39;aes-128-cfb&#39;, &#39;aes-128-cfb1&#39;, ...,</span></span>
<span class="line"><span>]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªåˆ—è¡¨å°±åŒ…å«äº†æ‰€æœ‰ä½ çš„ Node.js ç¯å¢ƒæ‰€æ”¯æŒçš„åŠ å¯†ç®—æ³•ã€‚ä½ å¯ä»¥æ ¹æ®ä½ çš„éœ€æ±‚é€‰æ‹©å…¶ä¸­ä¸€ä¸ªæ¥ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ éœ€è¦ä¸€ä¸ªå¸¸ç”¨ä¸”ç›¸å¯¹å®‰å…¨çš„åŠ å¯†ç®—æ³•ï¼Œä½ å¯èƒ½ä¼šé€‰æ‹© <code>&#39;aes-256-cbc&#39;</code>ã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼Œ<code>crypto.getCiphers()</code> æä¾›äº†ä¸€ä¸ªç®€å•çš„æ–¹å¼æ¥æŸ¥çœ‹å¯ç”¨çš„åŠ å¯†ç®—æ³•ï¼Œä»è€Œå¸®åŠ©å¼€å‘è€…åœ¨å¤„ç†åŠ å¯†ä»»åŠ¡æ—¶åšå‡ºæ›´å¥½çš„å†³ç­–ã€‚</p><h3 id="crypto-getcurves" tabindex="-1"><a class="header-anchor" href="#crypto-getcurves"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptogetcurves" target="_blank" rel="noopener noreferrer">crypto.getCurves()</a></span></a></h3><p><code>crypto.getCurves()</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒå±äº <code>crypto</code> è¿™ä¸ªæ¨¡å—ã€‚<code>crypto</code> æ¨¡å—ä¸»è¦ç”¨äºåŠ å¯†è§£å¯†ç›¸å…³çš„æ“ä½œï¼ŒåŒ…æ‹¬åˆ›å»ºå“ˆå¸Œã€HMACã€å¯†ç å­¦ç­¾åå’ŒéªŒè¯ç­‰å¤šç§åŠŸèƒ½ã€‚</p><p>é‚£ä¹ˆï¼Œ<code>crypto.getCurves()</code> å…·ä½“æ˜¯åšä»€ä¹ˆçš„å‘¢ï¼Ÿ</p><p>åœ¨å¯†ç å­¦ä¸­ï¼Œæœ‰ä¸€ç±»å«åšæ¤­åœ†æ›²çº¿åŠ å¯†ï¼ˆElliptic Curve Cryptography, ECCï¼‰çš„ç®—æ³•ã€‚è¿™ç±»ç®—æ³•åŸºäºæ¤­åœ†æ›²çº¿æ•°å­¦ï¼Œæä¾›äº†ç›¸æ¯”äºä¼ ç»ŸåŠ å¯†æ–¹æ³•ï¼ˆå¦‚ RSAï¼‰æ›´é«˜å®‰å…¨çº§åˆ«çš„åŒæ—¶èƒ½ä½¿ç”¨è¾ƒçŸ­çš„å¯†é’¥é•¿åº¦ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™æ„å‘³ç€å¯ä»¥é€šè¿‡è¾ƒå°çš„è®¡ç®—é‡è¾¾åˆ°è¾ƒé«˜çš„å®‰å…¨æ€§ï¼Œè¿™åœ¨ç§»åŠ¨è®¾å¤‡å’Œç‰©è”ç½‘è®¾å¤‡ä¸­éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬çš„è®¡ç®—èµ„æºå¯èƒ½æ¯”è¾ƒæœ‰é™ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ <code>crypto.getCurves()</code> æ–¹æ³•ï¼š</p><p>å½“ä½ åœ¨ Node.js ä¸­è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„åŒ…å«äº†å½“å‰ Node.js ç‰ˆæœ¬æ‰€æ”¯æŒçš„æ‰€æœ‰æ¤­åœ†æ›²çº¿åç§°ã€‚çŸ¥é“è¿™äº›åç§°å¯¹äºä½¿ç”¨æ¤­åœ†æ›²çº¿ç®—æ³•è¿›è¡ŒåŠ å¯†/è§£å¯†ã€ç”Ÿæˆå¯†é’¥å¯¹æˆ–è€…å…¶ä»–ç›¸å…³æ“ä½œæ˜¯å¿…è¦çš„ã€‚</p><p>è®©æˆ‘ä»¬ä¸¾å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><p><strong>ä¾‹ 1ï¼šæŸ¥çœ‹æ”¯æŒçš„æ¤­åœ†æ›²çº¿åˆ—è¡¨</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–å¹¶æ‰“å°æ‰€æœ‰æ”¯æŒçš„æ¤­åœ†æ›²çº¿åç§°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> curves</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getCurves</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">curves</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä½ è¿è¡Œä¸Šé¢è¿™æ®µä»£ç ï¼Œä½ å°†ä¼šçœ‹åˆ°ä¸€ä¸ªé•¿é•¿çš„æ›²çº¿åç§°åˆ—è¡¨ï¼Œåƒ <code>&#39;secp256k1&#39;</code>, <code>&#39;prime256v1&#39;</code> ç­‰éƒ½æ˜¯æ¤­åœ†æ›²çº¿çš„æ ‡å‡†åç§°ã€‚</p><p><strong>ä¾‹ 2ï¼šç”Ÿæˆ ECC å¯†é’¥å¯¹</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ec&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  namedCurve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;secp256k1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ secp256k1 è¿™ä¸ªæ¤­åœ†æ›²çº¿</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;spki&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pkcs8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† <code>crypto</code> æ¨¡å—ï¼Œç„¶åä½¿ç”¨ <code>generateKeyPairSync</code> æ–¹æ³•ç”Ÿæˆäº†ä¸€å¯¹ ECC å¯†é’¥ï¼Œå…¶ä¸­æŒ‡å®šäº†æ¤­åœ†æ›²çº¿ <code>&#39;secp256k1&#39;</code>ã€‚æœ€åï¼Œæˆ‘ä»¬å°†ç”Ÿæˆçš„å…¬é’¥å’Œç§é’¥å¯¼å‡ºä¸º PEM æ ¼å¼çš„å­—ç¬¦ä¸²å¹¶æ‰“å°å‡ºæ¥ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯ <code>crypto.getCurves()</code> çš„ä»‹ç»å’Œä¸€äº›åŸºæœ¬ç”¨æ³•ã€‚ä½œä¸ºä¸€ä¸ªç¼–ç¨‹æ–°æ‰‹ï¼Œäº†è§£åŸºç¡€çš„åŠ å¯†æ“ä½œå’Œæ¦‚å¿µæ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºæ— è®ºæ˜¯åœ¨ Web å¼€å‘è¿˜æ˜¯åœ¨å…¶ä»–ç±»å‹çš„åº”ç”¨ç¨‹åºä¸­ï¼Œå®‰å…¨æ€§å§‹ç»ˆæ˜¯ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜ã€‚é€šè¿‡ <code>crypto</code> æ¨¡å—ï¼ŒNode.js æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·é›†ä»¥å¸®åŠ©å¼€å‘è€…æ„å»ºå®‰å…¨çš„ç³»ç»Ÿã€‚</p><h3 id="crypto-getdiffiehellman-groupname" tabindex="-1"><a class="header-anchor" href="#crypto-getdiffiehellman-groupname"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptogetdiffiehellmangroupname" target="_blank" rel="noopener noreferrer">crypto.getDiffieHellman(groupName)</a></span></a></h3><p>Node.js ä¸­çš„<code>crypto.getDiffieHellman(groupName)</code>æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºåˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªåŸºäºæŒ‡å®šåç§°çš„é¢„å®šä¹‰ Diffie-Hellman å¯†é’¥äº¤æ¢ç»„çš„ Diffie-Hellman å¯†é’¥äº¤æ¢å¯¹è±¡ã€‚Diffie-Hellman å¯†é’¥äº¤æ¢å…è®¸ä¸¤æ–¹åœ¨ä¸å®‰å…¨çš„é€šé“ä¸Šå»ºç«‹ä¸€ä¸ªå…±äº«çš„ç§˜å¯†å¯†é’¥ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä¸€äº›å…³äº Diffie-Hellman å¯†é’¥äº¤æ¢çš„èƒŒæ™¯çŸ¥è¯†ï¼šDiffie-Hellman ç®—æ³•æ˜¯ä¸€ç§å®‰å…¨çš„æ–¹æ³•ï¼Œå¯ä»¥è®©ä¸¤ä¸ªé€šä¿¡æ–¹åœ¨å®Œå…¨æ²¡æœ‰æ¥è§¦è¿‡å¯¹æ–¹çš„æƒ…å†µä¸‹ç”Ÿæˆä¸€ä¸ªå…±äº«çš„å¯†é’¥ã€‚è¿™ä¸ªå…±äº«çš„å¯†é’¥å¯ä»¥ç”¨äºåç»­çš„é€šä¿¡åŠ å¯†ï¼Œç¡®ä¿ä¿¡æ¯ä¼ è¾“çš„å®‰å…¨ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä¸ºä½ é€æ­¥è§£é‡Š<code>crypto.getDiffieHellman(groupName)</code>æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå¹¶ç»™å‡ºä¸€äº›å®é™…åº”ç”¨çš„ä¾‹å­ï¼š</p><ol><li><p><strong>åˆ›å»º Diffie-Hellman å¯¹è±¡</strong>:<br> å½“ä½ è°ƒç”¨<code>crypto.getDiffieHellman(groupName)</code>æ—¶ï¼Œä½ éœ€è¦æŒ‡å®šä¸€ä¸ª<code>groupName</code>ã€‚è¿™ä¸ªåå­—ä»£è¡¨äº†ä¸€ç»„é¢„å®šä¹‰çš„å‚æ•°ï¼ŒåŒ…æ‹¬è´¨æ•°(p)å’ŒåŸºæ•°(g)ï¼Œè¿™ä¸¤ä¸ªå€¼æ˜¯ Diffie-Hellman å¯†é’¥äº¤æ¢çš„æ ¸å¿ƒã€‚</p></li><li><p><strong>é¢„å®šä¹‰çš„ç»„åˆ«</strong>:<br> Node.js å†…ç½®äº†ä¸€äº›å¸¸ç”¨çš„ç»„åˆ«ï¼Œä¾‹å¦‚<code>&#39;modp1&#39;</code>, <code>&#39;modp5&#39;</code>, <code>&#39;modp15&#39;</code>ç­‰ã€‚è¿™äº›éƒ½æ˜¯å·²ç»å®šä¹‰å¥½çš„ï¼Œå®‰å…¨æ€§è¾ƒé«˜çš„è´¨æ•°å’ŒåŸºæ•°çš„ç»„åˆã€‚</p></li><li><p><strong>ç”Ÿæˆå¯†é’¥</strong>:<br> è¿”å›çš„å¯¹è±¡åŒ…å«äº†ç”Ÿæˆç§é’¥å’Œè®¡ç®—å…¬é’¥çš„æ–¹æ³•ã€‚å‚ä¸è€…å¯ä»¥åˆ†åˆ«ç”Ÿæˆè‡ªå·±çš„ç§é’¥å’Œå…¬é’¥ã€‚</p></li><li><p><strong>å¯†é’¥äº¤æ¢</strong>:<br> ä¸¤ä¸ªé€šä¿¡æ–¹å„è‡ªå°†è‡ªå·±çš„å…¬é’¥å‘é€ç»™å¯¹æ–¹ï¼Œåœ¨æ¥æ”¶åˆ°å¯¹æ–¹çš„å…¬é’¥åï¼Œä»–ä»¬å¯ä»¥ä½¿ç”¨è‡ªå·±çš„ç§é’¥æ¥ç”Ÿæˆä¸€ä¸ªå…±åŒçš„å¯†é’¥ã€‚</p></li><li><p><strong>ç”Ÿæˆæœ€ç»ˆçš„å…±äº«å¯†é’¥</strong>:<br> å³ä½¿æ”»å‡»è€…æˆªè·äº†ä¸¤ä¸ªå…¬é’¥ï¼Œç”±äºä»–ä»¬æ²¡æœ‰ç§é’¥ï¼Œå› æ­¤æ— æ³•è®¡ç®—å‡ºè¿™ä¸ªå…±äº«çš„å¯†é’¥ã€‚</p></li></ol><p>ä¸¾ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ï¼š</p><p>å‡è®¾ Alice å’Œ Bob æƒ³è¦åœ¨ç½‘ç»œä¸Šå®‰å…¨åœ°äº¤æ¢ä¿¡æ¯ï¼Œä½†æ˜¯ä»–ä»¬ä¹‹é—´æ²¡æœ‰ä¸€ä¸ªå…±äº«çš„å¯†é’¥ã€‚ä»–ä»¬å¯ä»¥è¿™æ ·æ“ä½œï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice åˆ›å»ºä¸€ä¸ª Diffie-Hellman å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;modp15&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob ä¹Ÿåˆ›å»ºä¸€ä¸ª Diffie-Hellman å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getDiffieHellman</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;modp15&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Alice æŠŠå¥¹çš„å…¬é’¥ (alice.getPublicKey()) å‘é€ç»™ Bobï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bob æŠŠä»–çš„å…¬é’¥ (bob.getPublicKey()) å‘é€ç»™ Aliceã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ Bob å‘ç»™å¥¹çš„å…¬é’¥ï¼ŒAlice è®¡ç®—å…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> aliceSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bobä¹Ÿä½¿ç”¨ Alice å‘ç»™ä»–çš„å…¬é’¥ï¼Œè®¡ç®—å‡ºç›¸åŒçš„å…±äº«å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bobSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> bob</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">computeSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">alice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨ï¼ŒAlice å’Œ Bob éƒ½æœ‰äº†ç›¸åŒçš„å…±äº«å¯†é’¥ï¼Œè€Œä¸”è¿™ä¸ªå¯†é’¥æ²¡æœ‰é€šè¿‡ç½‘ç»œä¼ è¾“ã€‚</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»–ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªå¯†é’¥æ¥åŠ å¯†ä»–ä»¬çš„é€šä¿¡å†…å®¹ï¼Œç¡®ä¿å®‰å…¨ã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">aliceSharedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> bobSharedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// trueï¼Œè¡¨ç¤ºä»–ä»¬çš„å…±äº«å¯†é’¥æ˜¯ç›¸åŒçš„</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå³ä½¿æœ‰äººç›‘å¬äº† Alice å’Œ Bob çš„é€šä¿¡å¹¶è·å–äº†ä»–ä»¬çš„å…¬é’¥ï¼Œä¹Ÿæ— æ³•è®¡ç®—å‡ºä»–ä»¬çš„å…±äº«å¯†é’¥ï¼Œå› ä¸ºä»–ä»¬æ²¡æœ‰ç§é’¥ã€‚è¿™æ˜¯ Diffie-Hellman å¯†é’¥äº¤æ¢çš„é­…åŠ›æ‰€åœ¨â€”â€”å³ä½¿åœ¨ä¸å®‰å…¨çš„é€šé“ä¸Šï¼Œä¹Ÿèƒ½å®‰å…¨åœ°ç”Ÿæˆä¸€ä¸ªå…±äº«å¯†é’¥ã€‚</p><h3 id="crypto-getfips" tabindex="-1"><a class="header-anchor" href="#crypto-getfips"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptogetfips" target="_blank" rel="noopener noreferrer">crypto.getFips()</a></span></a></h3><p><code>crypto.getFips()</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå±äº <code>crypto</code> æ¨¡å—ã€‚è¿™ä¸ªæ¨¡å—æä¾›äº†åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯¹æ•°æ®è¿›è¡ŒåŠ è§£å¯†ã€åˆ›å»ºå“ˆå¸Œç­‰ã€‚è€Œ <code>crypto.getFips()</code> è¿™ä¸ªå‡½æ•°ç”¨æ¥æ£€æŸ¥ FIPSï¼ˆFederal Information Processing Standardsï¼‰æ¨¡å¼æ˜¯å¦è¢«æ¿€æ´»ã€‚</p><p>FIPS æ˜¯ä¸€ç³»åˆ—ç”±ç¾å›½è”é‚¦æ”¿åºœåˆ¶å®šçš„æ ‡å‡†ï¼Œæ—¨åœ¨ç”¨äºè®¡ç®—æœºç³»ç»Ÿä¸­çš„ç®—æ³•å’Œå®‰å…¨åè®®ï¼ŒåŒ…æ‹¬åŠ å¯†å’Œæ•£åˆ—ç®—æ³•ã€‚å½“åœ¨ç¬¦åˆ FIPS è¦æ±‚çš„ç¯å¢ƒä¸­å·¥ä½œæ—¶ï¼Œè½¯ä»¶å¯èƒ½éœ€è¦è¿è¡Œåœ¨ä¸€ä¸ªâ€œFIPS æ¨¡å¼â€ä¸‹ï¼Œè¿™æ˜¯ä¸ºäº†ç¡®ä¿ä½¿ç”¨çš„åŠ å¯†ç®—æ³•æ»¡è¶³ç‰¹å®šçš„å®‰å…¨æ ‡å‡†ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><p>å‡è®¾ä½ æ­£åœ¨ä¸ºä¸€ä¸ªéœ€è¦éµå®ˆä¸¥æ ¼å®‰å…¨è§„å®šçš„æ”¿åºœæœºæ„å¼€å‘è½¯ä»¶ã€‚è¿™ä¸ªæœºæ„è¦æ±‚æ‰€æœ‰åŠ å¯†æ“ä½œå¿…é¡»æ˜¯ FIPS è®¤è¯çš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥é€šè¿‡ <code>crypto.getFips()</code> æ¥æ£€æŸ¥ Node.js æ˜¯å¦å·²ç»åœ¨ FIPS æ¨¡å¼ä¸‹è¿è¡Œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥æ˜¯å¦å¤„äº FIPS æ¨¡å¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getFips</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å½“å‰å¤„äº FIPS æ¨¡å¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å½“å‰ä¸å¤„äº FIPS æ¨¡å¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä½ çš„åº”ç”¨ç¨‹åºå¿…é¡»å§‹ç»ˆè¿è¡Œåœ¨ FIPS æ¨¡å¼ä¸‹ï¼Œè€Œä¸Šè¿°ä»£ç è¡¨æ˜ä½ ç°åœ¨ä¸æ˜¯ï¼Œåœ¨æŸäº› Node.js ç‰ˆæœ¬ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡ <code>crypto.setFips(1)</code> å»å¯åŠ¨ FIPS æ¨¡å¼ï¼ˆåªæœ‰å½“ Node.js ç¼–è¯‘æ—¶å¯ç”¨äº† FIPS æ”¯æŒæ—¶ï¼Œæ‰èƒ½è¿™æ ·åšï¼‰ã€‚ç„¶åï¼Œä½ å¯ä»¥å†æ¬¡ä½¿ç”¨ <code>getFips()</code> æ¥ç¡®è®¤æ¨¡å¼æ˜¯å¦å·²ç»å˜æ›´ã€‚</p><p>è¯·æ³¨æ„ï¼Œä» Node.js çš„ç‰ˆæœ¬æ›´æ–°å†å²æ¥çœ‹ï¼ŒFIPS æ”¯æŒå¯èƒ½ä¼šéšç€æ—¶é—´å’Œç‰ˆæœ¬çš„å˜åŒ–è€Œå˜åŒ–ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ Node.js ç‰ˆæœ¬éƒ½é»˜è®¤æ”¯æŒ FIPSã€‚æ­¤å¤–ï¼Œä½¿ç”¨ FIPS æ¨¡å¼å¯èƒ½ä¼šé™åˆ¶å¯ç”¨çš„åŠ å¯†ç®—æ³•ï¼Œå› ä¸ºä¸æ˜¯æ‰€æœ‰çš„ç®—æ³•éƒ½è·å¾—äº† FIPS è®¤è¯ã€‚</p><p>åœ¨å®é™…ç¼–ç æ—¶ï¼Œç¡®ä¿ä½ çš„ç¯å¢ƒå’Œæ‰€ä½¿ç”¨çš„ Node.js ç‰ˆæœ¬å…¼å®¹ FIPSï¼Œå¹¶æ ¹æ®é¡¹ç›®éœ€æ±‚ç¡®å®šæ˜¯å¦éœ€è¦å¯ç”¨ FIPS æ¨¡å¼ã€‚å¦‚æœä¸æ¸…æ¥šï¼Œå’¨è¯¢åˆè§„æ€§ä¸“å®¶æˆ–ç›¸å…³éƒ¨é—¨ä»¥ç¡®ä¿ä½ çš„è½¯ä»¶ç¬¦åˆå¿…è¦çš„å®‰å…¨æ ‡å‡†ã€‚</p><h3 id="crypto-gethashes" tabindex="-1"><a class="header-anchor" href="#crypto-gethashes"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptogethashes" target="_blank" rel="noopener noreferrer">crypto.getHashes()</a></span></a></h3><p>Node.js çš„<code>crypto.getHashes()</code>å‡½æ•°ç”¨æ¥è·å–å½“å‰ Node.js ç‰ˆæœ¬æ”¯æŒçš„æ‰€æœ‰å“ˆå¸Œç®—æ³•ï¼ˆhash algorithmï¼‰åˆ—è¡¨ã€‚å“ˆå¸Œç®—æ³•æ˜¯åœ¨åŠ å¯†å­¦ä¸­å°†æ•°æ®è½¬æ¢ä¸ºå›ºå®šå¤§å°è¾“å‡ºå­—ç¬¦ä¸²çš„è¿‡ç¨‹ã€‚è¿™ä¸ªè¾“å‡ºé€šå¸¸ç§°ä¸ºå“ˆå¸Œå€¼æˆ–è€…æ‘˜è¦ã€‚</p><p>å½“ä½ è°ƒç”¨<code>crypto.getHashes()</code>æ—¶ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²éƒ½æ˜¯ä¸€ä¸ªå—æ”¯æŒçš„å“ˆå¸Œç®—æ³•çš„åç§°ã€‚</p><p>ä¸‹é¢æˆ‘ä¼šä¸¾å‡ ä¸ªä¾‹å­æ¥å±•ç¤ºå¦‚ä½•ä½¿ç”¨<code>crypto.getHashes()</code>ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨è¿™äº›å“ˆå¸Œç®—æ³•ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨crypto-gethashes" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨crypto-gethashes"><span>å¦‚ä½•ä½¿ç”¨<code>crypto.getHashes()</code></span></a></h3><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•è°ƒç”¨<code>crypto.getHashes()</code>å¹¶æ‰“å°å‡ºæ”¯æŒçš„å“ˆå¸Œç®—æ³•åˆ—è¡¨ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–å¹¶æ‰“å°æ”¯æŒçš„å“ˆå¸Œç®—æ³•åˆ—è¡¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hashes</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getHashes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hashes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œä¸Šè¿°ä»£ç åï¼Œæ‚¨å¯èƒ½ä¼šçœ‹åˆ°åƒ<code>[&#39;md5&#39;, &#39;sha1&#39;, &#39;sha256&#39;, &#39;sha512&#39;, ...]</code>è¿™æ ·çš„è¾“å‡ºï¼Œè¡¨æ˜ Node.js æ”¯æŒè¿™äº›å“ˆå¸Œç®—æ³•ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-2"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><h4 id="ä¾‹å­-1-ç”Ÿæˆå­—ç¬¦ä¸²çš„-sha-256-å“ˆå¸Œå€¼" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-ç”Ÿæˆå­—ç¬¦ä¸²çš„-sha-256-å“ˆå¸Œå€¼"><span>ä¾‹å­ 1ï¼šç”Ÿæˆå­—ç¬¦ä¸²çš„ SHA-256 å“ˆå¸Œå€¼</span></a></h4><p>å‡è®¾ä½ æƒ³è®¡ç®—æŸä¸ªå­—ç¬¦ä¸²çš„ SHA-256 å“ˆå¸Œå€¼ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ–¹å¼è¿›è¡Œï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¦å“ˆå¸Œçš„è¾“å…¥å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> input</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;hello world&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªSHA-256çš„å“ˆå¸Œå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ›´æ–°å“ˆå¸Œå¯¹è±¡å†…å®¹ï¼Œå¹¶è®¡ç®—å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">input</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†è®¡ç®—å¥½çš„å“ˆå¸Œå€¼ä»¥åå…­è¿›åˆ¶å½¢å¼è¾“å‡º</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç»“æœæ˜¯ä¸€ä¸ª64ä½é•¿çš„16è¿›åˆ¶å­—ç¬¦ä¸²</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä¾‹å­-2-éªŒè¯æ–‡ä»¶å®Œæ•´æ€§" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-éªŒè¯æ–‡ä»¶å®Œæ•´æ€§"><span>ä¾‹å­ 2ï¼šéªŒè¯æ–‡ä»¶å®Œæ•´æ€§</span></a></h4><p>å“ˆå¸Œå‡½æ•°é€šå¸¸å¯ä»¥ç”¨æ¥éªŒè¯æ–‡ä»¶æ˜¯å¦åœ¨ä¼ è¾“æˆ–å­˜å‚¨è¿‡ç¨‹ä¸­è¢«ç¯¡æ”¹ã€‚ä»¥ä¸‹æ˜¯ä¸€æ®µä¼ªä»£ç æ¥è¯´æ˜æ€ä¹ˆç”¨å“ˆå¸Œå‡½æ•°æ£€æŸ¥æ–‡ä»¶å®Œæ•´æ€§ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ æœ‰ä¸€ä¸ªæ–‡ä»¶çš„æ­£ç¡®çš„å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> correctHash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ˜¯ä¹‹å‰è®¡ç®—å¥½çš„ï¼Œå®‰å…¨å­˜å‚¨çš„å“ˆå¸Œå€¼</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨fsæ¨¡å—è¯»å–ä½ è¦æ£€æŸ¥çš„æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fileBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path/to/your/file&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªSHA-256çš„å“ˆå¸Œå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ›´æ–°å“ˆå¸Œå¯¹è±¡å†…å®¹ï¼Œå¹¶è®¡ç®—æ–‡ä»¶çš„å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fileBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†è®¡ç®—å¥½çš„å“ˆå¸Œå€¼ä»¥åå…­è¿›åˆ¶å½¢å¼è¾“å‡º</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fileHash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯¹æ¯”æ–‡ä»¶çš„å“ˆå¸Œå€¼å’Œæ­£ç¡®çš„å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fileHash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> correctHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ–‡ä»¶å®Œæ•´æ€§æœªè¢«ç ´å&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ–‡ä»¶å·²ç»è¢«ä¿®æ”¹æˆ–æŸå&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸¤ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†<code>createHash</code>æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªå“ˆå¸Œå¯¹è±¡ï¼Œå¹¶é€šè¿‡â€œupdateâ€æ–¹æ³•æ·»åŠ æ•°æ®åˆ°è¿™ä¸ªå¯¹è±¡ã€‚æœ€åæˆ‘ä»¬é€šè¿‡â€œdigestâ€æ–¹æ³•è¾“å‡ºäº†å“ˆå¸Œå€¼ã€‚å…¶ä¸­ï¼Œâ€œdigestâ€æ–¹æ³•è°ƒç”¨ä¹‹åï¼Œå“ˆå¸Œå¯¹è±¡å°±ä¸èƒ½å†è¢«ä½¿ç”¨äº†ã€‚</p><p>æ€»ç»“èµ·æ¥ï¼Œ<code>crypto.getHashes()</code>æ˜¯ä¸€ä¸ªæ–¹ä¾¿çš„å·¥å…·å‡½æ•°ï¼Œå®ƒå‘Šè¯‰ä½ å½“å‰ Node.js ç¯å¢ƒæ”¯æŒå“ªäº›å“ˆå¸Œç®—æ³•ï¼Œç„¶åä½ å¯ä»¥æ ¹æ®éœ€æ±‚é€‰æ‹©åˆé€‚çš„ç®—æ³•æ¥å¯¹æ•°æ®è¿›è¡Œå“ˆå¸Œå¤„ç†ã€‚</p><h3 id="crypto-getrandomvalues-typedarray" tabindex="-1"><a class="header-anchor" href="#crypto-getrandomvalues-typedarray"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptogetrandomvaluestypedarray" target="_blank" rel="noopener noreferrer">crypto.getRandomValues(typedArray)</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬èŠèŠ Node.js ä¸­ <code>crypto.getRandomValues(typedArray)</code> è¿™ä¸ªåŠŸèƒ½ã€‚</p><p>é¦–å…ˆæ¥çœ‹ä¸€çœ‹è¿™æ˜¯ä»€ä¹ˆã€‚åœ¨ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸­ï¼Œ<code>getRandomValues()</code> æ–¹æ³•ç”¨æ¥ç”Ÿæˆå®‰å…¨çš„éšæœºæ•°ã€‚è¿™äº›éšæœºæ•°æ˜¯ä¸å¯é¢„æµ‹çš„ï¼Œå¹¶ä¸”é€‚åˆç”¨äºåŠ å¯†åœºæ™¯ã€‚æ¢å¥è¯è¯´ï¼Œå½“ä½ éœ€è¦ä¸€ä¸ªéšæœºæ•°ï¼Œè€Œä¸”è¿™ä¸ªéšæœºæ•°å¿…é¡»éå¸¸å®‰å…¨æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨å®ƒã€‚</p><p>å‚æ•° <code>typedArray</code> æ˜¯ä¸€ä¸ªç±»å‹åŒ–æ•°ç»„ï¼ˆTypedArrayï¼‰ï¼Œè¿™å°±æ„å‘³ç€å®ƒå¯ä»¥æ˜¯ä¸€ä¸ª <code>Uint8Array</code>, <code>Uint16Array</code>, <code>Uint32Array</code>, <code>Int8Array</code>, <code>Int16Array</code> æˆ–è€… <code>Int32Array</code>ã€‚è¿™ä¸ªæ•°ç»„ä¼šè¢«å¡«å……æ»¡å®‰å…¨çš„éšæœºå€¼ã€‚</p><p>ç°åœ¨ï¼Œä¸ºäº†æ›´å¥½åœ°ç†è§£ï¼Œè®©æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><h3 id="ä¾‹å­-1-ç”Ÿæˆä¸€ä¸ªéšæœºçš„-token" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-ç”Ÿæˆä¸€ä¸ªéšæœºçš„-token"><span>ä¾‹å­ 1ï¼šç”Ÿæˆä¸€ä¸ªéšæœºçš„ token</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªéœ€è¦ç”Ÿæˆå”¯ä¸€ session token çš„ web åº”ç”¨ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>crypto.getRandomValues()</code> æ¥ç”Ÿæˆè¿™æ ·ä¸€ä¸ª tokenï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">getRandomValues</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 16 çš„ Uint8Array</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> array</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Uint8Array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¡«å……éšæœºå€¼</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getRandomValues</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†è¯¥éšæœºæ•°ç»„è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²ä½œä¸º token</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> token</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">byte</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  byte</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">padStart</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">join</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">token</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºä¾‹å¦‚ï¼š&#39;4f3c1a...ï¼ˆå…± 32 ä½åå…­è¿›åˆ¶å­—ç¬¦ï¼‰&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬åˆ©ç”¨ <code>getRandomValues()</code> å¡«å……äº†ä¸€ä¸ª 16 å­—èŠ‚çš„ <code>Uint8Array</code>ã€‚ç„¶åæˆ‘ä»¬æŠŠæ¯ä¸ªå­—èŠ‚è½¬æ¢æˆäº†ä¸€ä¸ªä¸¤ä½çš„åå…­è¿›åˆ¶æ•°ï¼Œå¹¶æ‹¼æ¥æˆä¸€ä¸ªé•¿å­—ç¬¦ä¸²ä½œä¸º tokenã€‚</p><h3 id="ä¾‹å­-2-æŠ•æ·éª°å­" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-æŠ•æ·éª°å­"><span>ä¾‹å­ 2ï¼šæŠ•æ·éª°å­</span></a></h3><p>å¦‚æœä½ æƒ³æ¨¡æ‹ŸæŠ•æ·å…­é¢éª°å­ï¼Œä½ å¯ä»¥ç”Ÿæˆä¸€ä¸ªä»‹äº 1 åˆ° 6 ä¹‹é—´çš„éšæœºæ•°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">getRandomValues</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 1 çš„ Uint32Array</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> array</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Uint32Array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¡«å……éšæœºå€¼</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getRandomValues</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–ä¸€ä¸ªå®‰å…¨çš„ã€éšæœºçš„éª°å­ç‚¹æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> diceRoll</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">diceRoll</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º 1 åˆ° 6 ä¹‹é—´çš„ä¸€ä¸ªæ•´æ•°</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º 1 çš„ <code>Uint32Array</code>ï¼Œç„¶åä½¿ç”¨ <code>getRandomValues()</code> è·å¾—äº†ä¸€ä¸ªéšæœºæ•°ã€‚é€šè¿‡å¯¹è¿™ä¸ªéšæœºæ•°å–æ¨¡ï¼ˆ%6ï¼‰å¹¶åŠ  1ï¼Œæˆ‘ä»¬ä¿è¯ç»“æœæ˜¯ä¸€ä¸ª 1 åˆ° 6 ä¹‹é—´çš„æ•´æ•°ï¼Œå°±åƒæŠ•æ·ä¸€æšå®ä½“éª°å­ä¸€æ ·ã€‚</p><h3 id="ä¾‹å­-3-åˆ›å»ºéšæœºå¯†ç " tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-3-åˆ›å»ºéšæœºå¯†ç "><span>ä¾‹å­ 3ï¼šåˆ›å»ºéšæœºå¯†ç </span></a></h3><p>å¦‚æœä½ éœ€è¦ä¸ºç”¨æˆ·è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªéšæœºå¯†ç ï¼Œä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">getRandomValues</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯ä»¥ç”¨ä»»ä½•ä½ å–œæ¬¢çš„å­—ç¬¦é›†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> characters</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> passwordLength</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 12</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬è¦ç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º 12 çš„å¯†ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> array</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Uint8Array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">passwordLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¡«å……éšæœºå€¼</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getRandomValues</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆå¯†ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> password</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">byte</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> characters</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">byte</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> %</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> characters</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">join</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºä¾‹å¦‚ï¼š&quot;Jk7g1Qs9vHbP&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ªéšæœºæ•°ç»„ï¼Œç„¶åå°†æ•°ç»„ä¸­çš„æ¯ä¸ªæ•°å€¼ç”¨æ¥é€‰å–å­—ç¬¦é›†ä¸­çš„å­—ç¬¦ã€‚è¿™æ ·å°±èƒ½å¤Ÿç”Ÿæˆä¸€ä¸ªç”±å¤§å°å†™å­—æ¯å’Œæ•°å­—ç»„æˆçš„éšæœºå¯†ç ã€‚</p><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹å‡º <code>getRandomValues()</code> åœ¨ç”Ÿæˆå®‰å…¨éšæœºæ•°æ–¹é¢éå¸¸æœ‰ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦åŠ å¯†æˆ–å®‰å…¨æ€§è¾ƒé«˜çš„åœºæ™¯ä¸­ã€‚</p><h3 id="crypto-hkdf-digest-ikm-salt-info-keylen-callback" tabindex="-1"><a class="header-anchor" href="#crypto-hkdf-digest-ikm-salt-info-keylen-callback"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptohkdfdigest-ikm-salt-info-keylen-callback" target="_blank" rel="noopener noreferrer">crypto.hkdf(digest, ikm, salt, info, keylen, callback)</a></span></a></h3><p><code>crypto.hkdf()</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªåŠ å¯†æ–¹æ³•ï¼Œå®ƒæ˜¯ç”¨æ¥ä»æŸä¸ªåˆå§‹å¯†é’¥ææ–™ï¼ˆInitial Keying Material, IKMï¼‰æ´¾ç”Ÿå‡ºå®‰å…¨çš„å¯†é’¥ã€‚è¿™ä¸ªæŠ€æœ¯åœ¨å¾ˆå¤šå®‰å…¨åè®®å’Œåº”ç”¨ä¸­è¢«ä½¿ç”¨ã€‚åœ¨è§£é‡Š <code>crypto.hkdf()</code> æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç†è§£ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼š</p><ol><li><p><strong>HKDF</strong>: HMAC-based Extract-and-Expand Key Derivation Functionï¼Œå³åŸºäº HMAC çš„æå–å’Œæ‰©å±•å¯†é’¥æ´¾ç”Ÿå‡½æ•°ã€‚è¿™æ˜¯ä¸€ç§æ ¹æ®ä¸€ä¸ªç§˜å¯†å€¼ç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ªå¼ºéšæœºå¯†é’¥çš„æ–¹å¼ã€‚</p></li><li><p><strong>Digest</strong>: æ‘˜è¦ç®—æ³•ï¼Œå¦‚ SHA-256ï¼Œç”¨äºé€šè¿‡æ•£åˆ—å‡½æ•°å¤„ç†æ•°æ®ï¼Œä»¥äº§ç”Ÿå›ºå®šå¤§å°çš„è¾“å‡ºï¼ˆå³æ•£åˆ—å€¼ï¼‰ã€‚</p></li><li><p><strong>IKM (Initial Keying Material)</strong>: åˆå§‹å¯†é’¥ææ–™ï¼Œæ˜¯æ´¾ç”Ÿè¿‡ç¨‹å¼€å§‹çš„åŸå§‹å¯†é’¥æ•°æ®ã€‚</p></li><li><p><strong>Salt</strong>: ç›å€¼ï¼Œæ˜¯ä¸€ä¸ªéšæœºæˆ–ä¼ªéšæœºçš„è¾“å…¥å€¼ï¼Œä¸ IKM ä¸€èµ·ç”¨äºå¢åŠ æ´¾ç”Ÿå¯†é’¥çš„å”¯ä¸€æ€§å’Œå®‰å…¨æ€§ã€‚</p></li><li><p><strong>Info</strong>: é™„åŠ ä¿¡æ¯ï¼Œå¯ä»¥ä¸ºç©ºï¼Œç”¨äºç¡®ä¿æ´¾ç”Ÿçš„å¯†é’¥æœ‰ç‰¹å®šçš„å±æ€§æˆ–ç”¨é€”ã€‚</p></li><li><p><strong>Keylen</strong>: æ´¾ç”Ÿå‡ºçš„å¯†é’¥çš„æœŸæœ›é•¿åº¦ã€‚</p></li><li><p><strong>Callback</strong>: å›è°ƒå‡½æ•°ï¼Œåœ¨å¯†é’¥æ´¾ç”Ÿå®Œæˆåè¢«è°ƒç”¨ã€‚</p></li></ol><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ <code>crypto.hkdf()</code> å‡½æ•°çš„å‚æ•°ï¼š</p><ul><li><code>digest</code>: ä½¿ç”¨çš„æ•£åˆ—å‡½æ•°çš„åç§°ï¼Œä¾‹å¦‚ &#39;sha256&#39;ã€‚</li><li><code>ikm</code>: åˆå§‹å¯†é’¥ææ–™ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ª Buffer æˆ– Uint8Arrayã€‚</li><li><code>salt</code>: ç›å€¼ï¼ŒåŒæ ·æ˜¯ä¸€ä¸ª Buffer æˆ– Uint8Arrayã€‚å¦‚æœæ²¡æœ‰ç›å€¼ï¼Œå°±ä½¿ç”¨ç©ºç¼“å†²åŒºä½œä¸ºé»˜è®¤å€¼ã€‚</li><li><code>info</code>: é™„åŠ ä¿¡æ¯ï¼Œä¸€ä¸ª Buffer æˆ– Uint8Arrayã€‚</li><li><code>keylen</code>: è¾“å‡ºå¯†é’¥çš„é•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚</li><li><code>callback</code>: ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ ¼å¼ä¸º <code>function(err, derivedKey)</code>ï¼Œå½“å¯†é’¥æ´¾ç”Ÿå®Œæˆæ—¶ä¼šè¢«è°ƒç”¨ï¼Œå¦‚æœå‘ç”Ÿé”™è¯¯ <code>err</code> å‚æ•°ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ï¼Œå¦åˆ™ <code>derivedKey</code> å‚æ•°ä¼šåŒ…å«æ´¾ç”Ÿå‡ºçš„å¯†é’¥ã€‚</li></ul><p>ä¸¾ä¸ªå®ä¾‹ï¼š</p><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦åŠ å¯†é€šä¿¡çš„åº”ç”¨ç¨‹åºï¼Œä½ æœ‰ä¸€ä¸²å¯†ç ï¼Œä½†ä½ éœ€è¦ä¸€ä¸ªå®‰å…¨çš„å¯†é’¥æ¥è¿›è¡ŒåŠ å¯†æ“ä½œã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>crypto.hkdf()</code> æ–¹æ³•æ¥ç”Ÿæˆè¿™ä¸ªå¯†é’¥ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä½ çš„åˆå§‹å¯†é’¥ææ–™ï¼ˆå®é™…åº”ç”¨ä¸­åº”è¯¥æ›´å¤æ‚ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> ikm</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;secret key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> salt</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªéšæœºçš„ç›å€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> info</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;my-app-data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»»ä½•ç›¸å…³çš„ä¸Šä¸‹æ–‡ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> keylen</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 32</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æƒ³è¦ä¸€ä¸ª256ä½çš„å¯†é’¥</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hkdf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ikm</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">salt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">keylen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">derivedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">derivedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°æ´¾ç”Ÿå‡ºçš„å¯†é’¥çš„åå…­è¿›åˆ¶è¡¨ç¤º</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼š</p><ul><li>æˆ‘ä»¬é€‰æ‹©äº† &#39;sha256&#39; ä½œä¸ºæ•£åˆ—å‡½æ•°ã€‚</li><li><code>ikm</code> æ˜¯æˆ‘ä»¬çš„åˆå§‹å¯†é’¥ææ–™ã€‚</li><li>æˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ªéšæœºçš„ <code>salt</code>ã€‚</li><li>æˆ‘ä»¬å®šä¹‰äº†ä¸€äº› <code>info</code> æ¥æ ‡æ³¨è¿™ä¸ªå¯†é’¥å°†ç”¨äºä»€ä¹ˆç›®çš„ã€‚</li><li>æˆ‘ä»¬é€‰æ‹©äº†æ´¾ç”Ÿå‡ºçš„å¯†é’¥é•¿åº¦ä¸º 32 å­—èŠ‚ï¼ˆ256 ä½ï¼‰ã€‚</li><li>ç„¶åæˆ‘ä»¬è°ƒç”¨ <code>crypto.hkdf()</code> å¹¶æä¾›äº†ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥å¤„ç†ç»“æœã€‚å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªæ´¾ç”Ÿå‡ºçš„å¯†é’¥ï¼ˆ<code>derivedKey</code>ï¼‰ï¼Œç„¶åæˆ‘ä»¬å°†å…¶æ‰“å°å‡ºæ¥ã€‚</li></ul><p>ä½¿ç”¨ HKDF å¯ä»¥å¸®åŠ©ä½ ç¡®ä¿å³ä½¿åˆå§‹å¯†é’¥ææ–™ä¸å¤Ÿå¼ºå¤§ï¼Œæ´¾ç”Ÿå‡ºçš„å¯†é’¥ä¹Ÿæ˜¯å®‰å…¨çš„ã€‚è¿™åœ¨éœ€è¦å°†å•ä¸ªå¯†é’¥è½¬æ¢ä¸ºå¤šä¸ªç”¨é€”æˆ–å¤šä¸ªä¼šè¯å¯†é’¥æ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="crypto-hkdfsync-digest-ikm-salt-info-keylen" tabindex="-1"><a class="header-anchor" href="#crypto-hkdfsync-digest-ikm-salt-info-keylen"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptohkdfsyncdigest-ikm-salt-info-keylen" target="_blank" rel="noopener noreferrer">crypto.hkdfSync(digest, ikm, salt, info, keylen)</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘æ¥ä¸ºä½ è¯¦ç»†è§£é‡Š Node.js ä¸­ <code>crypto.hkdfSync</code> è¿™ä¸ªå‡½æ•°ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä¸€ä¸‹å®ƒæ‰€å±çš„æ¨¡å—â€”â€”<code>crypto</code>ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>crypto</code> æ˜¯ä¸€ä¸ªå†…ç½®çš„æ¨¡å—ï¼Œæä¾›äº†åŒ…æ‹¬åŠ å¯†ã€è§£å¯†ã€ç­¾åå’Œå“ˆå¸ŒåŠŸèƒ½åœ¨å†…çš„åŠ å¯†æ“ä½œã€‚<code>hkdfSync</code> å‡½æ•°æ˜¯è¿™ä¸ªæ¨¡å—ä¸­ç”¨äºç”Ÿæˆå¯†é’¥ææ–™ï¼ˆKey Materialï¼‰çš„æ–¹æ³•ä¹‹ä¸€ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-hkdf" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-hkdf"><span>ä»€ä¹ˆæ˜¯ HKDFï¼Ÿ</span></a></h3><p>HKDF è¡¨ç¤º HMAC (Hash-based Message Authentication Code) Key Derivation Functionï¼Œå®ƒæ˜¯ä¸€ç§åŸºäºå“ˆå¸Œçš„å¯†é’¥å¯¼å‡ºå‡½æ•°ã€‚å…¶ç›®çš„æ˜¯ä»ä¸å¤ªè§„åˆ™çš„ç§˜å¯†ä¿¡æ¯ä¸­å®‰å…¨åœ°äº§ç”Ÿå¯†é’¥ã€‚è¿™ä¸ªè¿‡ç¨‹é€šå¸¸æ¶‰åŠä¸¤ä¸ªé˜¶æ®µï¼šextractï¼ˆæå–ï¼‰å’Œ expandï¼ˆæ‰©å±•ï¼‰ã€‚</p><h3 id="crypto-hkdfsync-å‡½æ•°çš„ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#crypto-hkdfsync-å‡½æ•°çš„ä½œç”¨"><span><code>crypto.hkdfSync</code> å‡½æ•°çš„ä½œç”¨</span></a></h3><p><code>crypto.hkdfSync</code> å‡½æ•°çš„ä½œç”¨æ˜¯åŒæ­¥æ‰§è¡Œ HKDF å¯†é’¥å¯¼å‡ºæ“ä½œã€‚å®ƒä¼šç»“åˆè¾“å…¥çš„ç§˜å¯†ä¿¡æ¯ï¼ˆInitial Keying Materialï¼ŒIKMï¼‰ã€ç›ï¼ˆsaltï¼‰ã€åº”ç”¨ä¿¡æ¯ï¼ˆinfoï¼‰ï¼Œä»¥åŠæŒ‡å®šçš„æ•£åˆ—ç®—æ³•ï¼ˆdigestï¼‰ï¼Œæ¥ç”Ÿæˆä¸€å®šé•¿åº¦çš„å¯†é’¥ææ–™ã€‚</p><p>ç°åœ¨æ¥åˆ†è§£è¿™ä¸ªå‡½æ•°çš„å‚æ•°ï¼š</p><ul><li><code>digest</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»£è¡¨æ‰€è¦ä½¿ç”¨çš„å“ˆå¸Œå‡½æ•°ï¼Œæ¯”å¦‚ <code>&#39;sha256&#39;</code>ã€‚</li><li><code>ikm</code>ï¼šInitial Keying Material çš„ç¼©å†™ï¼Œè¡¨ç¤ºåˆå§‹å¯†é’¥ææ–™ã€‚å¯ä»¥æ˜¯ä¸€ä¸ª Bufferã€TypedArray æˆ– DataView åŒ…å«ä½ çš„ç§˜å¯†ä¿¡æ¯ã€‚</li><li><code>salt</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰çš„å‚æ•°ï¼Œå®ƒç”¨äºéšæœºåŒ– HKDF è¿‡ç¨‹ï¼Œå¢å¼ºå¯†é’¥çš„å”¯ä¸€æ€§å’Œå®‰å…¨æ€§ã€‚å®ƒä¹Ÿå¯ä»¥æ˜¯ Bufferã€TypedArray æˆ– DataViewã€‚</li><li><code>info</code>ï¼šä¸€æ®µæœ‰å…³ç”Ÿæˆå¯†é’¥çš„é™„åŠ ä¿¡æ¯ï¼Œå®ƒå¯ä»¥ç¡®ä¿å¯¼å‡ºçš„å¯†é’¥å…·æœ‰ä¸ç‰¹å®šåº”ç”¨ç¨‹åºç›¸å…³è”çš„ä¸Šä¸‹æ–‡ã€‚åŒæ ·ï¼Œå®ƒå¯ä»¥æ˜¯ Bufferã€TypedArray æˆ– DataViewã€‚</li><li><code>keylen</code>ï¼šç”Ÿæˆçš„å¯†é’¥ææ–™çš„é•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚</li></ul><h3 id="ä½¿ç”¨ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­-3"><span>ä½¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦å®‰å…¨ä¼ è¾“æ•°æ®çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”ä½ æƒ³ç”Ÿæˆä¸€ä¸ªå¯†é’¥ç”¨äºåç»­çš„åŠ å¯†æ“ä½œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®šä¹‰ IKMï¼Œå³ä½ çš„åˆå§‹å¯†é’¥ææ–™ï¼Œè¿™é‡Œç”¨ &#39;secret&#39; å­—ç¬¦ä¸²çš„äºŒè¿›åˆ¶è¡¨ç¤ºä½œä¸ºä¾‹å­</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> ikm</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;secret&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®šä¹‰ç›å€¼ï¼Œå¢åŠ å¯†é’¥çš„éšæœºæ€§å’Œå®‰å…¨æ€§ï¼Œè¿™é‡Œç®€å•ç”¨ &#39;salt&#39; å­—ç¬¦ä¸²çš„äºŒè¿›åˆ¶è¡¨ç¤ºä½œä¸ºä¾‹å­</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> salt</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;salt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®šä¹‰åº”ç”¨ç¨‹åºç›¸å…³çš„ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> info</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;my-app-data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æŒ‡å®šç”Ÿæˆå¯†é’¥çš„é•¿åº¦ï¼Œè¿™é‡Œæˆ‘ä»¬æƒ³è¦ä¸€ä¸ª 256 ä½ï¼ˆå³ 32 å­—èŠ‚ï¼‰çš„å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> keylen</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 32</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æŒ‡å®šä½¿ç”¨çš„å“ˆå¸Œç®—æ³•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> digest</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ crypto.hkdfSync åŒæ­¥ç”Ÿæˆå¯†é’¥ææ–™</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hkdfSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ikm</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">salt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">keylen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// `&lt;`Buffer ...&gt; è¾“å‡ºçš„å°†æ˜¯ä¸€ä¸ª 32 å­—èŠ‚çš„ Buffer å¯¹è±¡ï¼Œå³æˆ‘ä»¬ç”Ÿæˆçš„å¯†é’¥ææ–™</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº† <code>ikm</code>, <code>salt</code>, <code>info</code>, <code>keylen</code>, å’Œ <code>digest</code> å‚æ•°ï¼Œç„¶åè°ƒç”¨ <code>crypto.hkdfSync</code> å‡½æ•°ç”Ÿæˆäº†ä¸€ä¸ª 256 ä½çš„å¯†é’¥ï¼Œè¿™ä¸ªå¯†é’¥å¯ä»¥ç”¨äºä¾‹å¦‚ AES åŠ å¯†ç®—æ³•ä¸­ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-2" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-2"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li><code>crypto.hkdfSync</code> æ˜¯ä¸€ä¸ªåŒæ­¥å‡½æ•°ï¼Œè¿™æ„å‘³ç€åœ¨å®ƒæ‰§è¡Œæ—¶ï¼Œå…¶ä»–ä»£ç å¿…é¡»ç­‰å¾…å®ƒå®Œæˆã€‚è¿™æ²¡é—®é¢˜å½“ä½ åœ¨åˆå§‹åŒ–é˜¶æ®µæˆ–è€…å¯¹æ€§èƒ½è¦æ±‚ä¸é«˜çš„æƒ…å†µä¸‹ã€‚ä½†åœ¨å¤„ç†å¤§é‡æ“ä½œæˆ–è€…éœ€è¦é«˜æ€§èƒ½çš„æœåŠ¡å™¨ç«¯åº”ç”¨æ—¶åº”è¯¥è€ƒè™‘ä½¿ç”¨å¼‚æ­¥ç‰ˆæœ¬ <code>crypto.hkdf</code>ï¼Œé¿å…é˜»å¡äº‹ä»¶å¾ªç¯ã€‚</li><li>å¯†ç å­¦ä¸­çš„ç›ï¼ˆsaltï¼‰æ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºå³ä½¿ç›¸åŒçš„åˆå§‹ç§˜å¯†ä¿¡æ¯è¢«ç”¨äºå¤šæ¬¡æ“ä½œï¼Œåªè¦ç›ä¸åŒï¼Œç”Ÿæˆçš„å¯†é’¥ä¹Ÿä¼šå®Œå…¨ä¸åŒï¼Œè¿™å¤§å¤§å¢åŠ äº†å®‰å…¨æ€§ã€‚</li></ul><h3 id="crypto-pbkdf2-password-salt-iterations-keylen-digest-callback" tabindex="-1"><a class="header-anchor" href="#crypto-pbkdf2-password-salt-iterations-keylen-digest-callback"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptopbkdf2password-salt-iterations-keylen-digest-callback" target="_blank" rel="noopener noreferrer">crypto.pbkdf2(password, salt, iterations, keylen, digest, callback)</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­çš„ <code>crypto.pbkdf2</code> å‡½æ•°ã€‚</p><p>é¦–å…ˆï¼Œ<code>crypto.pbkdf2</code> æ˜¯ä¸€ä¸ªåœ¨ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸­æä¾›çš„å‡½æ•°ï¼Œå®ƒç”¨äºå®ç°å¯†ç åŸºåŠ å¯†å¯†é’¥å¯¼å‡ºåŠŸèƒ½ï¼ˆPassword-Based Key Derivation Function 2ï¼Œç®€ç§° PBKDF2ï¼‰ã€‚è¿™ä¸ªå‡½æ•°å¯ä»¥ä»ä¸€ä¸ªå¯†ç å’Œä¸€ä¸ªç›å€¼ï¼ˆsaltï¼‰ç”Ÿæˆä¸€ä¸ªå›ºå®šé•¿åº¦çš„å‡ ä¹ä¸å¯èƒ½é¢„æµ‹çš„å¯†é’¥ã€‚è¿™ä¸ªæ–¹æ³•å¸¸ç”¨äºåŠ å¯†åº”ç”¨ä¸­ï¼Œä»¥ç¡®ä¿å­˜å‚¨å¯†ç çš„å®‰å…¨æ€§ã€‚</p><p>å‡½æ•°å‚æ•°è¯¦è§£ï¼š</p><ol><li><code>password</code>: è¿™æ˜¯ç”¨æˆ·çš„å¯†ç åŸæ–‡ï¼Œæˆ–è€…æ˜¯å…¶ä»–å½¢å¼çš„ç§˜å¯†åŸæ–‡ã€‚</li><li><code>salt</code>: ç›å€¼æ˜¯ä¸€æ®µéšæœºæ•°æ®ï¼Œç”¨æ¥ä¸å¯†ç ç»„åˆèµ·æ¥è¾“å…¥åˆ°å“ˆå¸Œå‡½æ•°ä¸­ï¼Œå¢åŠ çŒœæµ‹åŸå§‹å¯†ç çš„éš¾åº¦ã€‚</li><li><code>iterations</code>: è¿­ä»£æ¬¡æ•°æŒ‡çš„æ˜¯å“ˆå¸Œå‡½æ•°è¿è¡Œçš„æ¬¡æ•°ï¼Œè¿™ä¸ªæ•°å­—è¶Šå¤§ï¼Œç”Ÿæˆå¯†é’¥æ‰€éœ€æ—¶é—´è¶Šé•¿ï¼Œç ´è§£ä¹Ÿå°±è¶Šéš¾ã€‚</li><li><code>keylen</code>: éœ€è¦å¯¼å‡ºçš„å¯†é’¥çš„é•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚</li><li><code>digest</code>: å“ˆå¸Œå‡½æ•°åç§°ï¼Œä¾‹å¦‚ &#39;sha256&#39;ã€&#39;sha512&#39; ç­‰ã€‚</li><li><code>callback</code>: å½“å¯†é’¥å¯¼å‡ºå®Œæˆæ—¶è¢«è°ƒç”¨çš„å›è°ƒå‡½æ•°ï¼Œè¯¥å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼šé”™è¯¯å’Œå¯¼å‡ºçš„å¯†é’¥ã€‚</li></ol><p>å®é™…ä¾‹å­ï¼š</p><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨åˆ›å»ºä¸€ä¸ªç½‘ç«™ï¼Œå¹¶éœ€è¦å­˜å‚¨ç”¨æˆ·çš„å¯†ç ã€‚ä¸ºäº†å®‰å…¨åœ°å­˜å‚¨è¿™äº›å¯†ç ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥å°†ç”¨æˆ·çš„åŸå§‹å¯†ç ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œè€Œæ˜¯åº”è¯¥ä¿å­˜å®ƒçš„æ•£åˆ—å€¼ã€‚ä½¿ç”¨ <code>crypto.pbkdf2</code> å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®‰å…¨åœ°å°†å¯†ç è½¬åŒ–ä¸ºå¯†é’¥ï¼Œè¿›è€Œå‚¨å­˜è¿™ä¸ªå¯†é’¥ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”¨æˆ·æä¾›çš„å¯†ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> password</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;user-password123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// éšæœºç”Ÿæˆçš„ç›å€¼ï¼ˆå®é™…åº”ç”¨ä¸­æ¯ä¸ªç”¨æˆ·çš„ç›å€¼éƒ½åº”è¯¥æ˜¯å”¯ä¸€çš„ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> salt</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾å®šè¿­ä»£æ¬¡æ•°ï¼ˆé€šå¸¸è‡³å°‘10000æ¬¡ä»¥ä¸Šï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iterations</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾å®šå¯¼å‡ºå¯†é’¥çš„é•¿åº¦</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> keylen</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 64</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é€‰æ‹©å“ˆå¸Œå‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> digest</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ pbkdf2 å‡½æ•°æ¥å¯¼å‡ºå¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">pbkdf2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">salt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iterations</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">keylen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">derivedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å°†å¯¼å‡ºçš„å¯†é’¥è½¬æ¢ä¸ºåå…­è¿›åˆ¶æ ¼å¼çš„å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hashedPassword</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> derivedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ç°åœ¨å¯ä»¥æŠŠ hashedPassword å’Œ salt å­˜å‚¨åœ¨æ•°æ®åº“ä¸­äº†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Hashed Password: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hashedPassword</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Salt: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">salt</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä»ç”¨æˆ·çš„å¯†ç ç”Ÿæˆäº†ä¸€ä¸ªæ•£åˆ—å€¼ï¼ˆæˆ–ç§°ä¸ºå¯†é’¥ï¼‰ï¼Œç„¶åå¯ä»¥å°†è¿™ä¸ªæ•£åˆ—å€¼å’Œç›å€¼ä¸€èµ·å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚å½“ç”¨æˆ·ä¸‹æ¬¡ç™»å½•æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦å†æ¬¡ä½¿ç”¨åŒæ ·çš„å¯†ç ã€ç›å€¼ã€è¿­ä»£æ¬¡æ•°ç­‰å‚æ•°é€šè¿‡ <code>crypto.pbkdf2</code> å‡½æ•°ç”Ÿæˆæ•£åˆ—å€¼ï¼Œç„¶åæ¯”è¾ƒå®ƒä¸æ•°æ®åº“ä¸­å­˜å‚¨çš„æ•£åˆ—å€¼æ˜¯å¦ç›¸åŒï¼Œæ¥éªŒè¯ç”¨æˆ·çš„å¯†ç æ˜¯å¦æ­£ç¡®ã€‚</p><h3 id="crypto-pbkdf2sync-password-salt-iterations-keylen-digest" tabindex="-1"><a class="header-anchor" href="#crypto-pbkdf2sync-password-salt-iterations-keylen-digest"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptopbkdf2syncpassword-salt-iterations-keylen-digest" target="_blank" rel="noopener noreferrer">crypto.pbkdf2Sync(password, salt, iterations, keylen, digest)</a></span></a></h3><p><code>crypto.pbkdf2Sync</code> æ˜¯ Node.js å†…ç½®çš„ <code>crypto</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºå®ç°å¯†ç åŸºç¡€å¯†é’¥å¯¼å‡ºå‡½æ•°ï¼ˆPassword-Based Key Derivation Function 2ï¼Œç®€ç§° PBKDF2ï¼‰ã€‚è¿™ä¸ªå‡½æ•°çš„ç›®çš„æ˜¯å°†è¾“å…¥çš„å¯†ç å’Œç›å€¼(salt)ç»“åˆèµ·æ¥ï¼Œç»è¿‡å¤šæ¬¡è¿­ä»£å¤„ç†åç”Ÿæˆä¸€ä¸ªå®‰å…¨çš„å¯†é’¥ã€‚ä¸‹é¢æˆ‘ä¼šè¯¦ç»†è§£é‡Šå®ƒçš„å„ä¸ªå‚æ•°ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒã€‚</p><h3 id="å‚æ•°è§£é‡Š-5" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-5"><span>å‚æ•°è§£é‡Šï¼š</span></a></h3><ol><li><p><code>password</code>: è¿™æ˜¯ä½ æƒ³è¦è½¬æ¢æˆå¯†é’¥çš„åŸå§‹å¯†ç ï¼Œå®ƒå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…ä¸€ä¸ª Bufferã€‚</p></li><li><p><code>salt</code>: ç›å€¼æ˜¯ä¸€æ®µéšæœºæ•°æ®ï¼Œå®ƒè¢«ç”¨æ¥å’Œå¯†ç æ··åˆï¼Œå¢åŠ ç ´è§£å¯†ç çš„éš¾åº¦ã€‚ç›å€¼åŒæ ·å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…ä¸€ä¸ª Bufferã€‚</p></li><li><p><code>iterations</code>: è¿™æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºç®—æ³•åº”é‡å¤å“ˆå¸Œè¿‡ç¨‹çš„æ¬¡æ•°ã€‚è¿­ä»£æ¬¡æ•°è¶Šé«˜ï¼Œç”Ÿæˆå¯†é’¥çš„è¿‡ç¨‹å°±è¶Šæ…¢ï¼Œä¹Ÿå°±è¶Šéš¾ä»¥æš´åŠ›ç ´è§£ã€‚</p></li><li><p><code>keylen</code>: è¿™æ˜¯ä¸€ä¸ªæ•°å­—ï¼ŒæŒ‡å®šäº†ç”Ÿæˆçš„å¯†é’¥çš„é•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚</p></li><li><p><code>digest</code>: è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒæŒ‡å®šäº†ç”¨äºæ´¾ç”Ÿå¯†é’¥çš„å“ˆå¸Œå‡½æ•°ï¼Œä¾‹å¦‚ <code>&#39;sha256&#39;</code>ã€<code>&#39;sha512&#39;</code> ç­‰ã€‚</p></li></ol><h3 id="ä½¿ç”¨ç¤ºä¾‹-3" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹-3"><span>ä½¿ç”¨ç¤ºä¾‹ï¼š</span></a></h3><p>è®©æˆ‘ä»¬å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦å­˜å‚¨ç”¨æˆ·å¯†ç çš„åº”ç”¨ç¨‹åºã€‚å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œä½ ä¸èƒ½ç›´æ¥å­˜å‚¨ç”¨æˆ·çš„æ˜æ–‡å¯†ç ï¼Œæ‰€ä»¥ä½ å†³å®šä½¿ç”¨ <code>crypto.pbkdf2Sync</code> æ¥ç”Ÿæˆä¸€ä¸ªå®‰å…¨çš„å¯†é’¥å¹¶å­˜å‚¨è¯¥å¯†é’¥ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”¨æˆ·æä¾›çš„åŸå§‹å¯†ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> password</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;userPassword123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆä¸€ä¸ªå®‰å…¨çš„ç›å€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> salt</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®šä¹‰è¿­ä»£æ¬¡æ•°ã€å¯†é’¥é•¿åº¦å’Œå“ˆå¸Œå‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iterations</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> keylen</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 64</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> digest</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;sha512&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ crypto.pbkdf2Sync æ¥ç”Ÿæˆå¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> derivedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">pbkdf2Sync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  salt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  iterations</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  keylen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  digest</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†ç”Ÿæˆçš„å¯†é’¥è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> derivedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨ä½ å¯ä»¥å­˜å‚¨ hash å’Œ salt åˆ°æ•°æ®åº“ä¸­</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å­˜å‚¨åˆ°æ•°æ®åº“çš„ç›å€¼ï¼š&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">salt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å­˜å‚¨åˆ°æ•°æ®åº“çš„å“ˆå¸Œå€¼ï¼š&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ç”¨æˆ·å°è¯•ç™»å½•æ—¶ï¼Œä½ éœ€è¦è¯»å–æ•°æ®åº“ä¸­çš„ç›å€¼å’Œå“ˆå¸Œå€¼ï¼Œç„¶åä½¿ç”¨ç›¸åŒçš„ <code>password</code>ã€<code>salt</code>ã€<code>iterations</code>ã€<code>keylen</code> å’Œ <code>digest</code> æ´¾ç”Ÿå‡ºå¯†é’¥ï¼Œå¹¶æ¯”è¾ƒæ´¾ç”Ÿå‡ºæ¥çš„å¯†é’¥æ˜¯å¦ä¸æ•°æ®åº“ä¸­å­˜å‚¨çš„å“ˆå¸Œå€¼åŒ¹é…ã€‚å¦‚æœåŒ¹é…ï¼Œè¡¨ç¤ºç”¨æˆ·è¾“å…¥äº†æ­£ç¡®çš„å¯†ç ã€‚</p><p>æ³¨æ„ï¼š<code>crypto.pbkdf2Sync</code> æ˜¯ä¸€ä¸ªåŒæ­¥å‡½æ•°ï¼Œå®ƒä¼šé˜»å¡äº‹ä»¶å¾ªç¯ç›´åˆ°æ“ä½œå®Œæˆã€‚è¿™æ„å‘³ç€å¦‚æœæ“ä½œè€—æ—¶å¾ˆé•¿ï¼Œå®ƒå¯èƒ½ä¼šå½±å“æ€§èƒ½ã€‚å¯¹äºæœåŠ¡å™¨ç¯å¢ƒï¼Œé€šå¸¸å»ºè®®ä½¿ç”¨å¼‚æ­¥ç‰ˆæœ¬ <code>crypto.pbkdf2</code>ï¼Œä»¥é¿å…é˜»å¡äº‹ä»¶å¾ªç¯ã€‚</p><h3 id="crypto-privatedecrypt-privatekey-buffer" tabindex="-1"><a class="header-anchor" href="#crypto-privatedecrypt-privatekey-buffer"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptoprivatedecryptprivatekey-buffer" target="_blank" rel="noopener noreferrer">crypto.privateDecrypt(privateKey, buffer)</a></span></a></h3><p>Node.js ä¸­çš„ <code>crypto.privateDecrypt</code> æ–¹æ³•æ˜¯ç”¨æ¥è¿›è¡Œéå¯¹ç§°åŠ å¯†æ•°æ®çš„è§£å¯†æ“ä½œçš„ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å…³å¿ƒçš„ä¸¤ä¸ªä¸»è¦éƒ¨åˆ†æ˜¯ï¼šä¸€ä¸ªç§é’¥ï¼ˆprivateKeyï¼‰å’Œä¸€æ®µè¢«åŠ å¯†çš„æ•°æ®ï¼ˆbufferï¼‰ã€‚åœ¨éå¯¹ç§°åŠ å¯†ä¸­ï¼Œæœ‰ä¸¤ç§å¯†é’¥ï¼šå…¬é’¥å’Œç§é’¥ã€‚å…¬é’¥ç”¨äºåŠ å¯†æ•°æ®ï¼Œè€Œç§é’¥ç”¨äºè§£å¯†ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¯¦ç»†è§£é‡Šä¸‹ <code>crypto.privateDecrypt</code> çš„ä½œç”¨åŠå¦‚ä½•ä½¿ç”¨å®ƒï¼ŒåŒæ—¶æä¾›ä¸€äº›ä¾‹å­ã€‚</p><h3 id="crypto-privatedecrypt-privatekey-buffer-è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#crypto-privatedecrypt-privatekey-buffer-è§£é‡Š"><span><code>crypto.privateDecrypt(privateKey, buffer)</code> è§£é‡Š</span></a></h3><ul><li><p><strong>privateKey</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªåŒ…å«ä½ çš„ç§é’¥ä¿¡æ¯çš„å¯¹è±¡æˆ–è€…å­—ç¬¦ä¸²ã€‚ç§é’¥å¿…é¡»ä¸ç”¨æ¥åŠ å¯†æ•°æ®çš„å…¬é’¥æˆå¯¹å‡ºç°ã€‚ç§é’¥é€šå¸¸æ˜¯ä¿å¯†çš„ï¼Œå¹¶ä¸”åªæœ‰éœ€è¦è§£å¯†æ•°æ®çš„ä¸€æ–¹æ‰ä¼šæŒæœ‰ã€‚</p></li><li><p><strong>buffer</strong>ï¼šè¿™æ˜¯ä¸€ä¸ª <code>Buffer</code> å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº†ç”¨ç›¸åº”çš„å…¬é’¥åŠ å¯†è¿‡çš„æ•°æ®ã€‚è¿™é‡Œçš„æ•°æ®æ˜¯ç»è¿‡åŠ å¯†å¤„ç†çš„ï¼Œé€šå¸¸çœ‹èµ·æ¥åƒæ˜¯ä¸€å †ä¹±ç ã€‚</p></li></ul><p>å½“ä½ è¿è¡Œ <code>crypto.privateDecrypt</code> æ—¶ï¼Œå®ƒä¼šä½¿ç”¨æä¾›çš„ç§é’¥è§£å¯† buffer ä¸­çš„æ•°æ®ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„ <code>Buffer</code> å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº†åŸå§‹çš„æœªåŠ å¯†æ•°æ®ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-4"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾æœ‰ A å’Œ B ä¸¤ä¸ªäººã€‚A æƒ³è¦å®‰å…¨åœ°å‘ B å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œä»–ä»¬å†³å®šä½¿ç”¨éå¯¹ç§°åŠ å¯†ã€‚A ä½¿ç”¨ B çš„å…¬é’¥åŠ å¯†æ¶ˆæ¯ï¼Œç„¶åå°†å…¶å‘é€ç»™ Bã€‚å› ä¸ºåŠ å¯†åçš„æ¶ˆæ¯åªèƒ½ç”¨ B çš„ç§é’¥è§£å¯†ï¼Œæ‰€ä»¥å³ä½¿åˆ«äººæ‹¦æˆªåˆ°äº†è¿™æ¡æ¶ˆæ¯ï¼Œæ²¡æœ‰ç§é’¥ä¹Ÿæ— æ³•è¯»å–åŸæ–‡ã€‚</p><p>ç°åœ¨ B æ”¶åˆ°äº†æ¶ˆæ¯ï¼Œä»–å°†ä½¿ç”¨è‡ªå·±çš„ç§é’¥æ¥è§£å¯†ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;crypto&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;fs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾Bå·²ç»é€šè¿‡æŸç§æ–¹å¼è·å¾—äº†åŠ å¯†åçš„æ¶ˆæ¯ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨encryptedBufferè¡¨ç¤º</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encryptedBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> /* åŠ å¯†åçš„Bufferæ•°æ® */</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Bä»æ–‡ä»¶ä¸­è¯»å–ç§é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> privateKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;path/to/private/key.pem&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;utf8&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ç§é’¥è§£å¯†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> decryptedBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">privateDecrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encryptedBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å°†Bufferè½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼ˆå¦‚æœåŠ å¯†çš„æ˜¯æ–‡æœ¬æ•°æ®ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> decryptedMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> decryptedBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;utf8&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;è§£å¯†åçš„æ¶ˆæ¯:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decryptedMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;è§£å¯†è¿‡ç¨‹å‡ºé”™:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œé¦–å…ˆæˆ‘ä»¬å¼•å…¥äº† <code>crypto</code> å’Œ <code>fs</code> æ¨¡å—ã€‚<code>crypto</code> è´Ÿè´£åŠ å¯†å’Œè§£å¯†åŠŸèƒ½ï¼Œ<code>fs</code> ç”¨äºæ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼Œä»è€Œå¯ä»¥è¯»å–ç§é’¥æ–‡ä»¶ã€‚</p><p><code>encryptedBuffer</code> æ˜¯ä¸€ä¸ªå‡è®¾å­˜åœ¨çš„ Buffer å®ä¾‹ï¼Œå®ƒåŒ…å«äº†ç”¨å…¬é’¥åŠ å¯†çš„æ•°æ®ã€‚</p><p>ä¹‹åï¼Œä»£ç è¯»å–äº†å­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„ç§é’¥æ–‡ä»¶ã€‚ç”¨è¿™ä¸ªç§é’¥å’Œ <code>crypto.privateDecrypt</code> æ–¹æ³•æ¥è§£å¯† <code>encryptedBuffer</code> ä¸­çš„æ•°æ®ã€‚æˆåŠŸè§£å¯†åï¼Œæˆ‘ä»¬å¯ä»¥å°†ç»“æœè½¬æ¢ä¸ºå­—ç¬¦ä¸²å½¢å¼å¹¶è¾“å‡ºã€‚</p><p>æ³¨æ„ï¼šåœ¨å®é™…åº”ç”¨ä¸­ï¼ŒåŠ å¯†å’Œè§£å¯†åº”è¯¥ä½¿ç”¨é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œå› ä¸ºè¿™ä¸ªè¿‡ç¨‹å¯èƒ½å› ä¸ºå¤šç§åŸå› ï¼ˆæ¯”å¦‚ç§é’¥ä¸åŒ¹é…ï¼‰å¤±è´¥ã€‚åœ¨ä¸Šé¢çš„ä»£ç ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä½¿ç”¨äº† <code>try...catch</code> ç»“æ„æ¥æ•æ‰æ½œåœ¨çš„é”™è¯¯ã€‚</p><p>ç¡®ä¿ä½ å·²ç»ç†è§£äº†ä½¿ç”¨æ­£ç¡®çš„ç§é’¥è§£å¯†ä¿¡æ¯çš„é‡è¦æ€§ï¼Œä»¥åŠä¸ºä»€ä¹ˆè¿™ä¸ªæ–¹æ³•æ˜¯éå¯¹ç§°åŠ å¯†çš„åŸºç¡€ã€‚éå¯¹ç§°åŠ å¯†å¹¿æ³›åº”ç”¨äºæ•°å­—ç­¾åã€SSL/TLS åè®®ï¼ˆç½‘ç«™å®‰å…¨ï¼‰ã€åŠ å¯†é‚®ä»¶ç­‰åœºæ™¯ã€‚</p><h3 id="crypto-privateencrypt-privatekey-buffer" tabindex="-1"><a class="header-anchor" href="#crypto-privateencrypt-privatekey-buffer"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptoprivateencryptprivatekey-buffer" target="_blank" rel="noopener noreferrer">crypto.privateEncrypt(privateKey, buffer)</a></span></a></h3><p>Node.js çš„<code>crypto.privateEncrypt()</code>æ–¹æ³•æ˜¯ç”¨æ¥é€šè¿‡ç§é’¥åŠ å¯†æ•°æ®çš„ã€‚è¿™é€šå¸¸ç”¨äºå®‰å…¨åœ°ä¼ è¾“ä¿¡æ¯ï¼Œæ¯”å¦‚åœ¨å…¬å¼€ç½‘ç»œä¸­å‘é€æ•æ„Ÿæ•°æ®ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä½ ä½¿ç”¨ä¸€ä¸ªç§°ä¸ºç§é’¥çš„ç§˜å¯†å¯†é’¥æ¥åŠ å¯†æ•°æ®ï¼Œç„¶ååªæœ‰å¯¹åº”çš„å…¬é’¥æ‰èƒ½å¤Ÿè§£å¯†è¿™äº›ä¿¡æ¯ã€‚</p><p>åœ¨ Node.js v21.7.1 æ–‡æ¡£ä¸­ï¼Œ<code>crypto.privateEncrypt</code>çš„å®šä¹‰å¤§è‡´å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encryptedData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">privateEncrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>privateKey</code> æ˜¯ç”¨äºåŠ å¯†æ•°æ®çš„ç§é’¥ï¼Œå®ƒå¯ä»¥æ˜¯ä¸€ä¸ªåŒ…å« PEM ç¼–ç å¯†é’¥çš„å­—ç¬¦ä¸²æˆ–è€…æ˜¯ä¸€ä¸ªåŒ…å«å¯†é’¥å±æ€§çš„å¯¹è±¡ã€‚</li><li><code>buffer</code> æ˜¯ä¸€ä¸ª<code>Buffer</code>å®ä¾‹ï¼Œå³è¦åŠ å¯†çš„æ•°æ®ã€‚</li></ul><p>ç°åœ¨è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥çœ‹çœ‹<code>crypto.privateEncrypt()</code>æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><p>å‡è®¾ä½ è¦å‘é€ä¸€æ¡ç§å¯†æ¶ˆæ¯ç»™ä½ çš„æœ‹å‹ï¼Œä½ ä¸å¸Œæœ›é™¤äº†ä½ çš„æœ‹å‹ä¹‹å¤–çš„ä»»ä½•äººçœ‹åˆ°è¿™æ¡æ¶ˆæ¯ã€‚ä½ å†³å®šä½¿ç”¨ RSA åŠ å¯†ç®—æ³•ï¼ˆè¿™æ˜¯ä¸€ç§éå¸¸å¸¸è§çš„å…¬é’¥/ç§é’¥åŠ å¯†ç®—æ³•ï¼‰æ¥ä¿æŠ¤è¿™æ¡æ¶ˆæ¯ã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦ç”Ÿæˆä¸€å¯¹ RSA å¯†é’¥ï¼šä¸€ä¸ªç§é’¥å’Œä¸€ä¸ªå…¬é’¥ã€‚ç§é’¥ä¿ç•™ç»™è‡ªå·±ä½¿ç”¨ï¼Œè€Œå…¬é’¥å¯ä»¥å®‰å…¨åœ°åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚</p><h3 id="ç”Ÿæˆå¯†é’¥å¯¹çš„ç¤ºä¾‹ä»£ç " tabindex="-1"><a class="header-anchor" href="#ç”Ÿæˆå¯†é’¥å¯¹çš„ç¤ºä¾‹ä»£ç "><span>ç”Ÿæˆå¯†é’¥å¯¹çš„ç¤ºä¾‹ä»£ç </span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆå¯†é’¥å¯¹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// RSAå¯†é’¥å¯¹çš„ç”Ÿæˆ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯†é’¥é•¿åº¦</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°ç§é’¥å’Œå…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pkcs1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;spki&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åŠ å¯†æ¶ˆæ¯çš„ä»£ç ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#åŠ å¯†æ¶ˆæ¯çš„ä»£ç ç¤ºä¾‹"><span>åŠ å¯†æ¶ˆæ¯çš„ä»£ç ç¤ºä¾‹</span></a></h3><p>æ¥ç€ï¼Œä½ å°†ä½¿ç”¨ä½ çš„ç§é’¥åŠ å¯†æ¶ˆæ¯ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªä½¿ç”¨<code>crypto.privateEncrypt</code>æ–¹æ³•åŠ å¯†æ•°æ®çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™æ˜¯ä½ æƒ³è¦åŠ å¯†çš„æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> message</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;è¿™æ˜¯ä¸€ä¸ªéå¸¸ç§å¯†çš„æ¶ˆæ¯&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†æ¶ˆæ¯è½¬æ¢æˆBuffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufferMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ç§é’¥åŠ å¯†æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encryptedMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">privateEncrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bufferMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°åŠ å¯†åçš„æ¶ˆæ¯ï¼ˆæ³¨æ„ï¼Œè¿™æ˜¯ä¸€ä¸ªBufferï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encryptedMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// `&lt;`Buffer ...&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªåŒ…å«å®é™…æ¶ˆæ¯å†…å®¹çš„<code>Buffer</code>ã€‚ç„¶åæˆ‘ä»¬è°ƒç”¨<code>crypto.privateEncrypt</code>ï¼Œå°†ç§é’¥å’Œè¦åŠ å¯†çš„ Buffer ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œè¿™æ ·å°±å¾—åˆ°äº†ä¸€ä¸ªæ–°çš„ Bufferï¼Œå…¶ä¸­åŒ…å«äº†åŠ å¯†åçš„æ¶ˆæ¯ã€‚</p><h3 id="è§£å¯†æ¶ˆæ¯çš„ä»£ç ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#è§£å¯†æ¶ˆæ¯çš„ä»£ç ç¤ºä¾‹"><span>è§£å¯†æ¶ˆæ¯çš„ä»£ç ç¤ºä¾‹</span></a></h3><p>æœ€åï¼Œä½ çš„æœ‹å‹å°†ä½¿ç”¨ä»–ä»¬çš„å…¬é’¥æ¥è§£å¯†æ¶ˆæ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> decryptedMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">publicDecrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encryptedMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°è§£å¯†åçš„æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">decryptedMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™æ˜¯ä¸€ä¸ªéå¸¸ç§å¯†çš„æ¶ˆæ¯</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªè§£å¯†çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>crypto.publicDecrypt</code>æ–¹æ³•ï¼Œä¼ å…¥å…¬é’¥å’ŒåŠ å¯†åçš„æ•°æ®ï¼Œå¾—åˆ°åŸå§‹çš„æ¶ˆæ¯å†…å®¹ã€‚</p><p>æ€»ç»“èµ·æ¥ï¼Œ<code>crypto.privateEncrypt</code>æ–¹æ³•æ˜¯ç”¨äºä½¿ç”¨ç§é’¥è¿›è¡Œæ•°æ®åŠ å¯†çš„å‡½æ•°ï¼Œåœ¨éœ€è¦ç¡®ä¿æ•°æ®å®‰å…¨æ€§æ—¶éå¸¸æœ‰ç”¨ï¼Œå¦‚åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä¼ é€æ•æ„Ÿä¿¡æ¯æ—¶ã€‚è®°ä½ï¼Œåªæœ‰æ‹¥æœ‰æ­£ç¡®å…¬é’¥çš„æ¥æ”¶æ–¹æ‰èƒ½è§£å¯†é€šè¿‡ç§é’¥åŠ å¯†çš„ä¿¡æ¯ã€‚</p><h3 id="crypto-publicdecrypt-key-buffer" tabindex="-1"><a class="header-anchor" href="#crypto-publicdecrypt-key-buffer"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptopublicdecryptkey-buffer" target="_blank" rel="noopener noreferrer">crypto.publicDecrypt(key, buffer)</a></span></a></h3><p><code>crypto.publicDecrypt(key, buffer)</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºè§£å¯†ä½¿ç”¨å…¬é’¥åŠ å¯†è¿‡çš„æ•°æ®ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯éå¯¹ç§°åŠ å¯†çš„ä¸€éƒ¨åˆ†ï¼Œæ„å‘³ç€å®ƒä½¿ç”¨äº†ä¸¤ä¸ªä¸åŒçš„å¯†é’¥â€”â€”ä¸€ä¸ªå…¬é’¥å’Œä¸€ä¸ªç§é’¥ã€‚åœ¨éå¯¹ç§°åŠ å¯†ä¸­ï¼Œå…¬é’¥å¯ç”¨äºåŠ å¯†æ•°æ®ï¼Œè€Œç§é’¥åˆ™ç”¨äºè§£å¯†ã€‚ä¸ä¹‹ç›¸åçš„æ˜¯å¯¹ç§°åŠ å¯†ï¼Œå®ƒä½¿ç”¨ç›¸åŒçš„å¯†é’¥æ¥è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ã€‚</p><h3 id="å‚æ•°è§£é‡Š-6" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-6"><span>å‚æ•°è§£é‡Šï¼š</span></a></h3><ul><li><code>key</code>ï¼š ä¸€ä¸ªåŒ…å«ç§é’¥ä¿¡æ¯çš„å¯¹è±¡æˆ–å­—ç¬¦ä¸²ã€‚è¿™ä¸ªç§é’¥ç”¨äºè§£å¯†é‚£äº›ç”¨ä¸ä¹‹é…å¯¹çš„å…¬é’¥åŠ å¯†çš„æ•°æ®ã€‚</li><li><code>buffer</code>ï¼š åŒ…å«è¦è¢«è§£å¯†æ•°æ®çš„ <code>Buffer</code> å¯¹è±¡ã€‚</li></ul><h3 id="å·¥ä½œåŸç†" tabindex="-1"><a class="header-anchor" href="#å·¥ä½œåŸç†"><span>å·¥ä½œåŸç†ï¼š</span></a></h3><p>å½“ä½ æƒ³å‘æŸäººå‘é€åŠ å¯†æ¶ˆæ¯æ—¶ï¼Œä½ ä¼šä½¿ç”¨ä»–ä»¬çš„å…¬é’¥æ¥åŠ å¯†ä½ çš„æ¶ˆæ¯ã€‚åªæœ‰æ‹¥æœ‰é…å¯¹çš„ç§é’¥çš„äººæ‰èƒ½è§£å¯†å¹¶é˜…è¯»è¿™ä¸ªæ¶ˆæ¯ã€‚å› æ­¤ï¼Œå³ä½¿åˆ«äººæˆªè·äº†åŠ å¯†åçš„æ¶ˆæ¯ï¼Œæ²¡æœ‰ç§é’¥ä»–ä»¬ä¹Ÿæ— æ³•è§£å¯†ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-3"><span>å®é™…åº”ç”¨ä¾‹å­ï¼š</span></a></h3><p>å‡è®¾ Alice å¸Œæœ›å‘ Bob å®‰å…¨åœ°å‘é€æ¶ˆæ¯ã€‚Bob åˆ›å»ºäº†ä¸€å¯¹å¯†é’¥ï¼ˆå…¬é’¥å’Œç§é’¥ï¼‰ï¼Œç„¶åå°†å…¬é’¥å‘é€ç»™ Aliceã€‚Alice ä½¿ç”¨ Bob çš„å…¬é’¥åŠ å¯†å¥¹çš„æ¶ˆæ¯ï¼Œå¹¶å°†åŠ å¯†åçš„æ¶ˆæ¯å‘é€ç»™ Bobã€‚Bob æ”¶åˆ°æ¶ˆæ¯åï¼Œä½¿ç”¨ä»–çš„ç§é’¥é€šè¿‡ <code>crypto.publicDecrypt</code> å‡½æ•°è§£å¯†è¯¥æ¶ˆæ¯ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œè¯´æ˜å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨ <code>crypto.publicDecrypt</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬å·²ç»æœ‰äº†Bobçš„å…¬é’¥å’Œç§é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Aliceæƒ³ç»™Bobå‘é€åŠ å¯†æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> message</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Hello, Bob!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨å…¬é’¥åŠ å¯†æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encryptedMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">publicEncrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨Bobä½¿ç”¨è‡ªå·±çš„ç§é’¥æ¥è§£å¯†æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> decryptedMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">publicDecrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encryptedMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†è§£å¯†åçš„Bufferè½¬æ¢å›å­—ç¬¦ä¸²ï¼Œä»¥å¾—åˆ°åŸå§‹æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">decryptedMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: &#39;Hello, Bob!&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† Node.js çš„<code>crypto</code>æ¨¡å—ã€‚ç„¶åï¼Œæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ª RSA å¯†é’¥å¯¹ï¼ŒåŒ…å«å…¬é’¥å’Œç§é’¥ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå¾…å‘é€çš„æ¶ˆæ¯ï¼Œå¹¶ä½¿ç”¨å…¬é’¥å°†å…¶åŠ å¯†ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨<code>crypto.publicDecrypt</code>å‡½æ•°å’Œç§é’¥æ¥è§£å¯†è¿™ä¸ªæ¶ˆæ¯ï¼Œå¹¶å°†è§£å¯†åçš„å†…å®¹æ‰“å°å‡ºæ¥ã€‚</p><p>è¯·æ³¨æ„ï¼Œå®é™…åº”ç”¨ä¸­ï¼Œå…¬é’¥å’Œç§é’¥é€šå¸¸ä¿å­˜åœ¨æ–‡ä»¶ä¸­ï¼Œæˆ–è€…é€šè¿‡å®‰å…¨çš„æ–¹å¼ä¼ è¾“æˆ–å­˜å‚¨ã€‚ä»¥ä¸Šç¤ºä¾‹ä»…ç”¨äºè¯´æ˜<code>crypto.publicDecrypt</code>å‡½æ•°çš„ç”¨æ³•ã€‚</p><h3 id="crypto-publicencrypt-key-buffer" tabindex="-1"><a class="header-anchor" href="#crypto-publicencrypt-key-buffer"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptopublicencryptkey-buffer" target="_blank" rel="noopener noreferrer">crypto.publicEncrypt(key, buffer)</a></span></a></h3><p><code>crypto.publicEncrypt(key, buffer)</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºä½¿ç”¨å…¬é’¥åŠ å¯†æ•°æ®ã€‚è¿™åœ¨éœ€è¦ä¿æŠ¤æ•°æ®å®‰å…¨ä¼ è¾“æ—¶éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å‘é€æ•æ„Ÿä¿¡æ¯ã€‚ä¸‹é¢æˆ‘ä¼šè¯¦ç»†è§£é‡Šè¿™ä¸ªå‡½æ•°ä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒã€‚</p><h3 id="å‚æ•°è§£é‡Š-7" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-7"><span>å‚æ•°è§£é‡Šï¼š</span></a></h3><ul><li><code>key</code>ï¼šè¿™æ˜¯ç”¨äºåŠ å¯†æ•°æ®çš„å…¬é’¥ã€‚åœ¨å…¬é’¥/ç§é’¥åŠ å¯†ä½“ç³»ä¸­ï¼Œå…¬é’¥å¯ä»¥å®‰å…¨åœ°åˆ†äº«ç»™ä»»ä½•äººï¼Œè€Œç§é’¥éœ€è¦ä¿å¯†ã€‚ä»»ä½•ä½¿ç”¨å…¬é’¥åŠ å¯†çš„æ•°æ®éƒ½åªèƒ½ç”¨ç›¸åº”çš„ç§é’¥æ¥è§£å¯†ã€‚</li><li><code>buffer</code>ï¼šè¿™æ˜¯ä½ æƒ³è¦åŠ å¯†çš„æ•°æ®ï¼Œå®ƒåº”è¯¥æ˜¯ä¸€ä¸ª <code>Buffer</code> å¯¹è±¡æˆ–è€…æ˜¯ä¸€ä¸ªèƒ½å¤Ÿè¢«è½¬æ¢ä¸º <code>Buffer</code> çš„ç±»å‹ã€‚</li></ul><h3 id="è¿”å›å€¼-5" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-5"><span>è¿”å›å€¼ï¼š</span></a></h3><p>è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªæ–°çš„ <code>Buffer</code> å¯¹è±¡ï¼ŒåŒ…å«äº†åŠ å¯†åçš„æ•°æ®ã€‚</p><h3 id="ä½¿ç”¨ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­-4"><span>ä½¿ç”¨ä¾‹å­ï¼š</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦å°†ç”¨æˆ·çš„å¯†ç åŠ å¯†ç„¶åå‘é€åˆ°æœåŠ¡å™¨çš„åº”ç”¨ç¨‹åºã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨ <code>crypto.publicEncrypt</code> å‡½æ•°æ¥æ‰§è¡Œè¿™é¡¹æ“ä½œçš„æ­¥éª¤ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬å·²ç»æœ‰äº†æœåŠ¡å™¨çš„å…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é€šå¸¸ï¼Œå…¬é’¥ä¼šä»¥æ–‡ä»¶çš„å½¢å¼æä¾›ï¼Œå¹¶ä¸”å¯ä»¥åƒè¿™æ ·å¯¼å…¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path/to/public/key.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”¨æˆ·çš„å¯†ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> password</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;user-secret-password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æŠŠå¯†ç å­—ç¬¦ä¸²è½¬æ¢æˆä¸€ä¸ª Buffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨å…¬é’¥åŠ å¯†å¯†ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">publicEncrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨encryptedå˜é‡åŒ…å«äº†åŠ å¯†åçš„å¯†ç ï¼Œå¯ä»¥å®‰å…¨åœ°å‘é€åˆ°æœåŠ¡å™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°åŠ å¯†åçš„å¯†ç çš„base64ç¼–ç </span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œé¦–å…ˆè½½å…¥äº† <code>crypto</code> å’Œ <code>fs</code>ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰æ¨¡å—ã€‚ç„¶åè¯»å–äº†å­˜å‚¨åœ¨æŸä¸ªè·¯å¾„ä¸‹çš„å…¬é’¥æ–‡ä»¶ã€‚æ¥ä¸‹æ¥åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«ç”¨æˆ·å¯†ç çš„ <code>Buffer</code>ï¼Œå¹¶ä¸”è°ƒç”¨äº† <code>publicEncrypt</code> å‡½æ•°æ¥å¯¹è¿™ä¸ªå¯†ç è¿›è¡ŒåŠ å¯†ã€‚æœ€åï¼Œè¾“å‡ºäº†åŠ å¯†åçš„æ•°æ®çš„ base64 ç¼–ç å­—ç¬¦ä¸²ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡ç½‘ç»œå®‰å…¨åœ°å‘é€è¿™ä¸ªåŠ å¯†åçš„å­—ç¬¦ä¸²ã€‚</p><p>æ³¨æ„ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¸ä¸€å®šç›´æ¥å¯¹å¯†ç è¿›è¡ŒåŠ å¯†ã€‚æ›´å¸¸è§çš„åšæ³•æ˜¯å…ˆå¯¹å¯†ç è¿›è¡Œå“ˆå¸Œå¤„ç†ï¼Œç„¶åæ‰å¯¹ç»“æœè¿›è¡ŒåŠ å¯†æˆ–è€…å…¶ä»–å®‰å…¨æªæ–½ã€‚</p><h3 id="å®‰å…¨è€ƒè™‘" tabindex="-1"><a class="header-anchor" href="#å®‰å…¨è€ƒè™‘"><span>å®‰å…¨è€ƒè™‘ï¼š</span></a></h3><p>è™½ç„¶ <code>publicEncrypt</code> å¯ä»¥ä¿è¯æ•°æ®åŠ å¯†å®‰å…¨ï¼Œä½†åœ¨å®é™…åœºæ™¯ä¸­è¿˜éœ€è¦è€ƒè™‘å…¶ä»–å®‰å…¨æ€§å› ç´ ï¼Œæ¯”å¦‚å…¬é’¥çš„ç®¡ç†å’Œä¼ è¾“ã€æ˜¯å¦å¯ç”¨ SSL/TLS æ¥åŠ å¯†æ•´ä¸ªé€šä¿¡è¿‡ç¨‹ç­‰ã€‚</p><p>æ­¤å¤–ï¼Œåœ¨è·¨ç½‘ç»œå‘é€ä»»ä½•åŠ å¯†æ•°æ®ä¹‹å‰ï¼Œè¯·ç¡®ä¿äº†è§£å¯èƒ½çš„å®‰å…¨é£é™©ï¼Œå¹¶éµå¾ªæœ€ä½³å®è·µï¼Œä»¥é˜²æ­¢æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚</p><h3 id="crypto-randombytes-size-callback" tabindex="-1"><a class="header-anchor" href="#crypto-randombytes-size-callback"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptorandombytessize-callback" target="_blank" rel="noopener noreferrer">crypto.randomBytes(size[, callback])</a></span></a></h3><p>Node.js ä¸­çš„ <code>crypto.randomBytes</code> æ–¹æ³•ç”¨äºç”Ÿæˆä¸€ä¸²ç»™å®šé•¿åº¦çš„éšæœºå­—èŠ‚ã€‚è¿™äº›éšæœºå­—èŠ‚é€šå¸¸ç”¨äºå®‰å…¨ç›¸å…³çš„åŠŸèƒ½ï¼Œå¦‚ç”Ÿæˆå¯†é’¥ã€ä»¤ç‰Œæˆ–å…¶ä»–éœ€è¦å¼ºéšæœºæ€§çš„åœºæ™¯ã€‚</p><h3 id="å‚æ•°è§£é‡Š-8" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-8"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>size</code>: è¿™æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œç”¨äºæŒ‡å®šä½ æƒ³è¦ç”Ÿæˆçš„éšæœºå­—èŠ‚æ•°ã€‚</li><li><code>callback</code>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰çš„å›è°ƒå‡½æ•°ï¼Œå½“éšæœºå­—èŠ‚ç”Ÿæˆå®Œæ¯•åä¼šè¢«è°ƒç”¨ã€‚å¦‚æœè¿™ä¸ªå‚æ•°è¢«çœç•¥äº†ï¼Œ<code>randomBytes</code> æ–¹æ³•å°†ä¼šè¿”å›ä¸€ä¸ªåŒ…å«éšæœºå­—èŠ‚çš„ <code>Buffer</code> å¯¹è±¡ã€‚</li></ul><h3 id="ä½¿ç”¨æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æ–¹å¼"><span>ä½¿ç”¨æ–¹å¼</span></a></h3><h4 id="åŒæ­¥ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#åŒæ­¥ä½¿ç”¨"><span>åŒæ­¥ä½¿ç”¨</span></a></h4><p>å¦‚æœä½ ä¸ä¼ é€’ <code>callback</code> å‡½æ•°ï¼Œ<code>randomBytes</code> ä¼šåŒæ­¥åœ°æ‰§è¡Œå¹¶è¿”å›ç»“æœï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬éœ€è¦16å­—èŠ‚çš„éšæœºæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> size</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> randomBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">randomBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åœ¨ç”Ÿæˆéšæœºå­—èŠ‚æ—¶å¯èƒ½ä¼šäº§ç”Ÿé”™è¯¯ï¼Œæ¯”å¦‚è¯·æ±‚çš„å­—èŠ‚å¤ªå¤š</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>randomBuffer</code> å°†æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º <code>size</code> å­—èŠ‚çš„ <code>Buffer</code> å®ä¾‹ï¼Œé‡Œé¢å……æ»¡äº†éšæœºæ•°æ®ã€‚</p><h4 id="å¼‚æ­¥ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#å¼‚æ­¥ä½¿ç”¨"><span>å¼‚æ­¥ä½¿ç”¨</span></a></h4><p>å¦‚æœä½ ä¼ é€’äº†ä¸€ä¸ª <code>callback</code> å‡½æ•°ï¼Œ<code>randomBytes</code> å°†å¼‚æ­¥æ‰§è¡Œï¼Œå¹¶åœ¨å®Œæˆåè°ƒç”¨è¯¥å‡½æ•°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬éœ€è¦16å­—èŠ‚çš„éšæœºæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> size</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å‘ç”Ÿé”™è¯¯æ—¶ï¼Œæ¯”å¦‚æ²¡æœ‰è¶³å¤Ÿçš„ç†µæ¥ç”Ÿæˆéšæœºæ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Error generating random bytes:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Random bytes:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„å¼‚æ­¥ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåŒ¿åçš„å›è°ƒå‡½æ•°ï¼Œå®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªé”™è¯¯å¯¹è±¡ï¼ˆåœ¨æ²¡æœ‰é”™è¯¯å‘ç”Ÿæ—¶ä¸º nullï¼‰å’Œä¸€ä¸ªåŒ…å«éšæœºå­—èŠ‚çš„ <code>Buffer</code> å¯¹è±¡ã€‚</p><h3 id="åº”ç”¨å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#åº”ç”¨å®ä¾‹"><span>åº”ç”¨å®ä¾‹</span></a></h3><h4 id="ç”Ÿæˆéšæœºä»¤ç‰Œ" tabindex="-1"><a class="header-anchor" href="#ç”Ÿæˆéšæœºä»¤ç‰Œ"><span>ç”Ÿæˆéšæœºä»¤ç‰Œ</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨åˆ›å»ºä¸€ä¸ªç½‘ç«™ï¼Œå¹¶éœ€è¦ä¸ºç”¨æˆ·ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„é‡ç½®å¯†ç é“¾æ¥ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>crypto.randomBytes</code> æ¥ç”Ÿæˆä¸€ä¸ªå®‰å…¨çš„éšæœºä»¤ç‰Œä½œä¸ºé“¾æ¥çš„ä¸€éƒ¨åˆ†ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">48</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  var</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> token</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ç°åœ¨ä½ æœ‰äº†ä¸€ä¸ªå®‰å…¨çš„éšæœºä»¤ç‰Œï¼Œå¯ä»¥é™„åŠ åˆ°é‡ç½®é“¾æ¥ä¸Š</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    `Password reset link: https://example.com/reset-password?token=</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">token</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="åŠ å¯†å¯†é’¥ç”Ÿæˆ" tabindex="-1"><a class="header-anchor" href="#åŠ å¯†å¯†é’¥ç”Ÿæˆ"><span>åŠ å¯†å¯†é’¥ç”Ÿæˆ</span></a></h4><p>å¦‚æœä½ éœ€è¦ä¸ºæŸç§åŠ å¯†ç®—æ³•ç”Ÿæˆä¸€ä¸ªå¯†é’¥ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> keySize</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 32</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¾‹å¦‚ï¼ŒAES-256 éœ€è¦32å­—èŠ‚çš„å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">keySize</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">keyBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> keyBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Encryption key: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸¤ä¸ªåº”ç”¨å®ä¾‹ä¸­ï¼Œéšæœºæ€§éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒä¿è¯äº†ç”Ÿæˆçš„ä»¤ç‰Œæˆ–å¯†é’¥çš„ä¸å¯é¢„æµ‹æ€§ï¼Œè¿™å¯¹äºå®‰å…¨æ€§è‡³å…³é‡è¦ã€‚</p><h3 id="crypto-randomfillsync-buffer-offset-size" tabindex="-1"><a class="header-anchor" href="#crypto-randomfillsync-buffer-offset-size"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptorandomfillsyncbuffer-offset-size" target="_blank" rel="noopener noreferrer">crypto.randomFillSync(buffer[, offset][, size])</a></span></a></h3><p>å½“ç„¶ï¼Œæˆ‘å¾ˆä¹æ„å¸®åŠ©ä½ ç†è§£<code>crypto.randomFillSync</code>å‡½æ•°ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ¥æ¦‚è¿°ä¸€ä¸‹ Node.js ä¸­çš„<code>crypto</code>æ¨¡å—ã€‚è¿™ä¸ªæ¨¡å—æä¾›äº†åŒ…æ‹¬å¯†ç å­¦åŠŸèƒ½åœ¨å†…çš„å„ç§å®‰å…¨ç›¸å…³çš„åŠŸèƒ½ï¼Œä¾‹å¦‚åŠ å¯†ã€è§£å¯†å’Œæ•£åˆ—ç­‰ã€‚<code>crypto.randomFillSync</code>æ˜¯è¯¥æ¨¡å—æä¾›çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºç”ŸæˆåŠ å¯†å®‰å…¨çš„éšæœºæ•°æ®ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¯¦ç»†è§£é‡Š<code>crypto.randomFillSync</code>å‡½æ•°ï¼š</p><h3 id="crypto-randomfillsync-buffer-offset-size-1" tabindex="-1"><a class="header-anchor" href="#crypto-randomfillsync-buffer-offset-size-1"><span><code>crypto.randomFillSync(buffer[, offset][, size])</code></span></a></h3><ul><li><code>buffer</code>: è¿™æ˜¯ä¸€ä¸ª<code>Buffer</code>ã€<code>TypedArray</code>æˆ–<code>DataView</code>å¯¹è±¡ï¼Œå®ƒå°†è¢«å¡«å……éšæœºæ•°ã€‚</li><li><code>offset</code>(å¯é€‰): è¿™æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºå¼€å§‹å¡«å……éšæœºæ•°çš„èµ·å§‹ä½ç½®ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œé»˜è®¤ä¸º 0ã€‚</li><li><code>size</code>(å¯é€‰): è¿™æ˜¯è¦å¡«å……çš„éšæœºæ•°çš„å­—èŠ‚æ•°ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œé»˜è®¤å¡«å……æ•´ä¸ª<code>buffer</code>ã€‚</li></ul><p>è¿™ä¸ªå‡½æ•°åŒæ­¥åœ°å¡«å……ä¼ å…¥çš„<code>buffer</code>å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“å‡½æ•°è°ƒç”¨å®Œæˆæ—¶ï¼Œ<code>buffer</code>å·²ç»è¢«éšæœºæ•°å¡«æ»¡ã€‚åŒæ­¥å‡½æ•°ä¼šé˜»å¡ä»£ç æ‰§è¡Œç›´åˆ°æ“ä½œå®Œæˆï¼Œæ‰€ä»¥åœ¨æ‰§è¡Œè¾ƒé•¿æ—¶é—´æ“ä½œæ—¶éœ€è°¨æ…ä½¿ç”¨ï¼Œé¿å…å½±å“ä»£ç æ€§èƒ½ã€‚</p><p>ä¸¾å‡ ä¸ªå®é™…çš„ä¾‹å­æ¥è¯´æ˜å…¶ç”¨æ³•ï¼š</p><h4 id="ç¤ºä¾‹-1-å¡«å……ä¸€ä¸ª-buffer" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-å¡«å……ä¸€ä¸ª-buffer"><span>ç¤ºä¾‹ 1ï¼šå¡«å……ä¸€ä¸ª Buffer</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º16å­—èŠ‚çš„ç©ºBuffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”¨åŠ å¯†å®‰å…¨çš„éšæœºæ•°å¡«å……æ•´ä¸ªBuffer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomFillSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç±»ä¼¼ï¼š`&lt;`Buffer 5c f2 ab 82 ...&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª 16 å­—èŠ‚çš„ç©º<code>Buffer</code>ã€‚ç„¶åæˆ‘ä»¬è°ƒç”¨<code>crypto.randomFillSync</code>å‡½æ•°æ¥å¡«æ»¡æ•´ä¸ª<code>Buffer</code>ã€‚</p><h4 id="ç¤ºä¾‹-2-åªå¡«å……-buffer-çš„ä¸€éƒ¨åˆ†" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-åªå¡«å……-buffer-çš„ä¸€éƒ¨åˆ†"><span>ç¤ºä¾‹ 2ï¼šåªå¡«å…… Buffer çš„ä¸€éƒ¨åˆ†</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º16å­—èŠ‚çš„ç©ºBuffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä»ç¬¬4ä¸ªå­—èŠ‚å¼€å§‹ï¼Œå¡«å……8ä¸ªå­—èŠ‚çš„éšæœºæ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomFillSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå¯èƒ½ç±»ä¼¼ï¼š`&lt;`Buffer 00 00 00 00 fc e8 c4 5e 6a 79 4d 3f 00 00 00 00&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ¬¡æˆ‘ä»¬ä»ç„¶åˆ›å»ºäº†ä¸€ä¸ª 16 å­—èŠ‚çš„ç©º<code>Buffer</code>ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬å‘Šè¯‰<code>randomFillSync</code>ä»ç¬¬ 4 ä¸ªå­—èŠ‚å¼€å§‹ï¼ˆ<code>offset</code>è®¾ç½®ä¸º 4ï¼‰ï¼Œåªå¡«å…… 8 ä¸ªå­—èŠ‚çš„éšæœºæ•°ï¼ˆ<code>size</code>è®¾ç½®ä¸º 8ï¼‰ã€‚è¿™æ ·ï¼Œåªæœ‰éƒ¨åˆ†<code>Buffer</code>è¢«éšæœºæ•°å¡«å……ã€‚</p><h4 id="ç¤ºä¾‹-3-ä½¿ç”¨-typedarray" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-ä½¿ç”¨-typedarray"><span>ç¤ºä¾‹ 3ï¼šä½¿ç”¨ TypedArray</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª8ä¸ªå…ƒç´ çš„Uint8Array</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> typedArray</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Uint8Array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¡«å……æ•´ä¸ªTypedArray</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomFillSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">typedArray</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">typedArray</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç±»ä¼¼ï¼šUint8Array [ 47, 123, 93, 77, 12, 29, 85, 134 ]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª<code>Uint8Array</code>ç±»å‹æ•°ç»„ï¼Œè€Œä¸æ˜¯<code>Buffer</code>ã€‚<code>Uint8Array</code>æ˜¯ä¸€ç§ç±»å‹åŒ–æ•°ç»„ï¼Œç”¨äºè¡¨ç¤º 8 ä½æ— ç¬¦å·æ•´å‹æ•°ç»„ã€‚æˆ‘ä»¬å†æ¬¡ä½¿ç”¨<code>randomFillSync</code>æ¥å¡«å……æ•´ä¸ªæ•°ç»„ã€‚</p><p>é€šè¿‡ä»¥ä¸Šä¾‹å­ï¼Œä½ åº”è¯¥èƒ½å¤Ÿçœ‹å‡º<code>crypto.randomFillSync</code>å‡½æ•°å¦‚ä½•å·¥ä½œï¼Œä»¥åŠå¦‚ä½•åœ¨ Node.js ç¨‹åºä¸­ä½¿ç”¨å®ƒæ¥ç”Ÿæˆéšæœºæ•°ã€‚è¿™äº›éšæœºæ•°é€šå¸¸ç”¨äºéœ€è¦é«˜åº¦å®‰å…¨æ€§çš„åœºæ™¯ï¼Œæ¯”å¦‚ç”Ÿæˆç§˜é’¥ã€éšæœºä»¤ç‰Œã€ä¼šè¯ ID ç­‰ã€‚</p><h3 id="crypto-randomfill-buffer-offset-size-callback" tabindex="-1"><a class="header-anchor" href="#crypto-randomfill-buffer-offset-size-callback"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptorandomfillbuffer-offset-size-callback" target="_blank" rel="noopener noreferrer">crypto.randomFill(buffer[, offset][, size], callback)</a></span></a></h3><p>Node.js ä¸­çš„ <code>crypto.randomFill()</code> å‡½æ•°æ˜¯ç”¨æ¥ç”Ÿæˆå®‰å…¨çš„éšæœºæ•°çš„ã€‚è¿™ä¸ªå‡½æ•°æ˜¯ Node.js å†…ç½®çš„ <code>crypto</code> æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œè¯¥æ¨¡å—æä¾›äº†åŒ…æ‹¬åŠ å¯†ã€è§£å¯†ã€ç­¾åå’ŒéªŒè¯ç­‰åœ¨å†…çš„å„ç§åŠ å¯†åŠŸèƒ½ã€‚</p><p>è®©æˆ‘ä»¬è¯¦ç»†è§£é‡Šä¸€ä¸‹è¿™ä¸ªå‡½æ•°çš„å‚æ•°ä»¥åŠå®ƒå¦‚ä½•å·¥ä½œï¼š</p><ul><li><code>buffer</code>ï¼šè¿™æ˜¯ä¸€ä¸ª Bufferï¼ˆæˆ–è€… TypedArray æˆ– DataViewï¼‰ï¼Œç”¨äºå­˜æ”¾ç”Ÿæˆçš„éšæœºæ•°ã€‚</li><li><code>offset</code>ï¼ˆå¯é€‰ï¼‰ï¼šè¿™æ˜¯ buffer é‡Œå¼€å§‹å¡«å……éšæœºæ•°çš„èµ·å§‹ä½ç½®ï¼Œé»˜è®¤å€¼ä¸º 0ã€‚</li><li><code>size</code>ï¼ˆå¯é€‰ï¼‰ï¼šè¿™æ˜¯è¦å¡«å……çš„éšæœºæ•°çš„å­—èŠ‚æ•°ã€‚å¦‚æœæ²¡æŒ‡å®šï¼Œæ•´ä¸ª buffer å°†è¢«å¡«æ»¡ã€‚</li><li><code>callback</code>ï¼šè¿™æ˜¯ä¸€ä¸ªåœ¨éšæœºæ•°ç”Ÿæˆå®Œæˆåè°ƒç”¨çš„å‡½æ•°ã€‚å®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼š <ul><li><code>err</code>ï¼šå¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œå®ƒå°†æ˜¯ä¸€ä¸ª Error å¯¹è±¡ï¼›å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œå®ƒå°†ä¸º nullã€‚</li><li><code>buf</code>ï¼šè¿™æ˜¯å¡«å……å®Œéšæœºæ•°çš„ bufferã€‚</li></ul></li></ul><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªå®é™…çš„ä¾‹å­æ¥ç†è§£è¿™ä¸ªå‡½æ•°æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><p><strong>ä¾‹å­ 1ï¼šå¡«å……æ•´ä¸ª Buffer</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º16å­—èŠ‚çš„ç©ºBuffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomFill</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`éšæœºå­—èŠ‚ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º 16 å­—èŠ‚çš„ <code>buffer</code>ã€‚ç„¶åï¼Œæˆ‘ä»¬è°ƒç”¨ <code>randomFill()</code> æ–¹æ³•æ¥å¡«å……æ•´ä¸ª <code>buffer</code>ã€‚å½“æ“ä½œå®Œæˆæ—¶ï¼Œ<code>callback</code> å‡½æ•°è¢«è°ƒç”¨ï¼Œå¹¶ä¸”æ‰“å°å‡ºå¡«å……äº†éšæœºå­—èŠ‚çš„ <code>buffer</code> çš„å†…å®¹ï¼Œä»¥åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºã€‚</p><p><strong>ä¾‹å­ 2ï¼šæŒ‡å®š offset å’Œ size</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º16å­—èŠ‚çš„ç©ºBuffer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æŒ‡å®šä»bufferçš„ç¬¬3ä¸ªå­—èŠ‚å¼€å§‹å¡«å……ï¼Œæ€»å…±å¡«å……4ä¸ªå­—èŠ‚çš„éšæœºæ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomFill</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`éšæœºå­—èŠ‚ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buf</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¸ä»…åˆ›å»ºäº†ä¸€ä¸ªç©º <code>buffer</code>ï¼Œè€Œä¸”è¿˜æŒ‡å®šäº†å¡«å……çš„èµ·å§‹ä½ç½®å’Œå¤§å°ã€‚æ„å‘³ç€éšæœºæ•°å°†ä» <code>buffer</code> çš„ç¬¬ 3 ä¸ªå­—èŠ‚ä½ç½®å¼€å§‹å¡«å……ï¼Œå¹¶ä¸”åªä¼šå¡«å…… 4 ä¸ªå­—èŠ‚çš„éšæœºæ•°ã€‚</p><p><strong>ä¾‹å­ 3ï¼šä½¿ç”¨ TypedArray</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå…·æœ‰8ä¸ª32ä½æ•´æ•°çš„TypedArray</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> typedArray</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Uint32Array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomFill</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">typedArray</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">arr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`éšæœºæ•°ï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">arr</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">join</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;, &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ª <code>Uint32Array</code> è€Œä¸æ˜¯ <code>Buffer</code>ã€‚<code>Uint32Array</code> æ˜¯ä¸€ç§ç±»å‹åŒ–æ•°ç»„ï¼Œç”¨æ¥è¡¨ç¤ºä¸€ä¸ªåŒ…å« 32 ä½æ— ç¬¦å·æ•´æ•°çš„æ•°ç»„ã€‚åŒæ ·åœ°ï¼Œ<code>randomFill()</code> æ–¹æ³•å¡«å……äº†æ•´ä¸ªæ•°ç»„ï¼Œå¹¶åœ¨å›è°ƒä¸­æ‰“å°å‡ºæ¥ã€‚</p><p>åœ¨æ‰€æœ‰è¿™äº›ä¾‹å­ä¸­ï¼Œç”Ÿæˆçš„éšæœºæ•°éƒ½æ˜¯é€šè¿‡å¯†ç å­¦ä¸Šå®‰å…¨çš„éšæœºæ•°ç”Ÿæˆå™¨å¾—åˆ°çš„ï¼Œå› æ­¤å¯ä»¥ç”¨äºéœ€è¦é«˜å¼ºåº¦å®‰å…¨æ€§çš„åœºæ™¯ï¼Œæ¯”å¦‚ç”Ÿæˆä»¤ç‰Œã€å¯†é’¥æˆ–å…¶ä»–æ•æ„Ÿæ•°æ®ã€‚</p><h3 id="crypto-randomint-min-max-callback" tabindex="-1"><a class="header-anchor" href="#crypto-randomint-min-max-callback"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptorandomintmin-max-callback" target="_blank" rel="noopener noreferrer">crypto.randomInt([min, ]max[, callback])</a></span></a></h3><p>Node.js ä¸­çš„ <code>crypto.randomInt</code> å‡½æ•°ç”¨äºç”Ÿæˆä¸€ä¸ªä»‹äºä¸¤ä¸ªæ•°ä¹‹é—´ï¼ˆåŒ…æ‹¬è¿™ä¸¤ä¸ªæ•°ï¼‰çš„éšæœºæ•´æ•°ã€‚è¿™ä¸ªå‡½æ•°æ˜¯ Node.js å†…ç½®çš„ <code>crypto</code> æ¨¡å—æä¾›çš„ï¼Œå®ƒæ¯”æ™®é€šçš„ <code>Math.random()</code> ç”Ÿæˆçš„éšæœºæ•°æ›´å®‰å…¨ï¼Œå› ä¸ºå®ƒä½¿ç”¨äº†å¯†ç å­¦ä¸Šçš„éšæœºæ€§ï¼Œé€‚åˆéœ€è¦è¾ƒé«˜éšæœºæ€§çš„åœºæ™¯ï¼Œå¦‚åŠ å¯†ã€å®‰å…¨ä»¤ç‰Œç”Ÿæˆç­‰ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¯¦ç»†åœ°è§£é‡Šä¸€ä¸‹ <code>crypto.randomInt</code> å‡½æ•°çš„ä½¿ç”¨æ–¹æ³•å’Œä¸€äº›å®é™…çš„ä¾‹å­ã€‚</p><p>å‡½æ•°æœ‰ä»¥ä¸‹å‡ ç§ä½¿ç”¨æ–¹å¼ï¼š</p><ol><li><code>crypto.randomInt(max)</code></li><li><code>crypto.randomInt(min, max)</code></li><li><code>crypto.randomInt(min, max, callback)</code></li></ol><h3 id="å‚æ•°è§£é‡Š-9" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-9"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>min</code> (å¯é€‰): è¦ç”Ÿæˆçš„éšæœºæ•°çš„æœ€å°å€¼ï¼Œé»˜è®¤ä¸º 0ã€‚</li><li><code>max</code>: è¦ç”Ÿæˆçš„éšæœºæ•°çš„æœ€å¤§å€¼ï¼ˆä¸åŒ…æ‹¬è¿™ä¸ªå€¼ï¼‰ã€‚</li><li><code>callback</code> (å¯é€‰): å½“æŒ‡å®šäº†è¿™ä¸ªå›è°ƒå‡½æ•°æ—¶ï¼Œ<code>randomInt</code> å°†å¼‚æ­¥åœ°ç”Ÿæˆéšæœºæ•°ï¼Œå¹¶ä¸”å°†ç»“æœé€šè¿‡å›è°ƒå‡½æ•°è¿”å›ã€‚</li></ul><h3 id="è¿”å›å€¼-6" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-6"><span>è¿”å›å€¼</span></a></h3><ul><li>å¦‚æœæ²¡æœ‰æä¾› <code>callback</code>ï¼Œé‚£ä¹ˆ <code>randomInt</code> å°±ä¼šåŒæ­¥åœ°è¿”å›ä¸€ä¸ªéšæœºæ•°ã€‚</li><li>å¦‚æœæä¾›äº† <code>callback</code>ï¼Œåˆ™ <code>randomInt</code> ä¸ä¼šè¿”å›å€¼ï¼Œè€Œæ˜¯å½“éšæœºæ•°ç”Ÿæˆåï¼Œé€šè¿‡å›è°ƒå‡½æ•°å‚æ•°è¿”å›ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-3"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-åŒæ­¥ç”Ÿæˆä¸€ä¸ª-0-åˆ°-10-ä¹‹é—´çš„éšæœºæ•´æ•°-ä¸åŒ…æ‹¬-10" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åŒæ­¥ç”Ÿæˆä¸€ä¸ª-0-åˆ°-10-ä¹‹é—´çš„éšæœºæ•´æ•°-ä¸åŒ…æ‹¬-10"><span>ç¤ºä¾‹ 1ï¼šåŒæ­¥ç”Ÿæˆä¸€ä¸ª 0 åˆ° 10 ä¹‹é—´çš„éšæœºæ•´æ•°ï¼ˆä¸åŒ…æ‹¬ 10ï¼‰</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŒæ­¥è°ƒç”¨ï¼Œæ²¡æœ‰ä½¿ç”¨å›è°ƒå‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> randomNumber</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomInt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">randomNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºä¸€ä¸ª 0 åˆ° 9 ä¹‹é—´çš„éšæœºæ•´æ•°</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-åŒæ­¥ç”Ÿæˆä¸€ä¸ª-5-åˆ°-15-ä¹‹é—´çš„éšæœºæ•´æ•°-ä¸åŒ…æ‹¬-15" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-åŒæ­¥ç”Ÿæˆä¸€ä¸ª-5-åˆ°-15-ä¹‹é—´çš„éšæœºæ•´æ•°-ä¸åŒ…æ‹¬-15"><span>ç¤ºä¾‹ 2ï¼šåŒæ­¥ç”Ÿæˆä¸€ä¸ª 5 åˆ° 15 ä¹‹é—´çš„éšæœºæ•´æ•°ï¼ˆä¸åŒ…æ‹¬ 15ï¼‰</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> randomNumber</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomInt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">randomNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºä¸€ä¸ª 5 åˆ° 14 ä¹‹é—´çš„éšæœºæ•´æ•°</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-3-å¼‚æ­¥ç”Ÿæˆä¸€ä¸ªéšæœºæ•´æ•°å¹¶ä½¿ç”¨å›è°ƒå‡½æ•°" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-å¼‚æ­¥ç”Ÿæˆä¸€ä¸ªéšæœºæ•´æ•°å¹¶ä½¿ç”¨å›è°ƒå‡½æ•°"><span>ç¤ºä¾‹ 3ï¼šå¼‚æ­¥ç”Ÿæˆä¸€ä¸ªéšæœºæ•´æ•°å¹¶ä½¿ç”¨å›è°ƒå‡½æ•°</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomInt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">randomNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">randomNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºä¸€ä¸ª 5 åˆ° 14 ä¹‹é—´çš„éšæœºæ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ç¬¬ä¸‰ä¸ªç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨äº†å¼‚æ­¥ç‰ˆæœ¬çš„ <code>randomInt</code>ã€‚è¿™æ„å‘³ç€ç¨‹åºä¸ä¼šé˜»å¡ç­‰å¾…éšæœºæ•°ç”Ÿæˆï¼Œç›¸åï¼Œå®ƒä¼šç«‹å³ç»§ç»­æ‰§è¡Œåç»­ä»£ç ï¼Œç„¶ååœ¨éšæœºæ•°å‡†å¤‡å¥½æ—¶ï¼Œæ‰§è¡Œå›è°ƒå‡½æ•°æ¥å¤„ç†ç»“æœã€‚</p><p>è¿™ä¸ª <code>randomInt</code> å‡½æ•°åœ¨éœ€è¦éšæœºæ•´æ•°çš„ä»»ä½•åº”ç”¨ä¸­éƒ½éå¸¸æœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨å®‰å…¨æ€§è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ä¸­ï¼Œæ¯”å¦‚ï¼š</p><ul><li>åˆ›å»ºéšæœºå¯†ç æˆ–å¯†ç ç›ï¼›</li><li>åœ¨æ¸¸æˆä¸­äº§ç”Ÿéšæœºäº‹ä»¶æˆ–ç‰©å“ï¼›</li><li>è¿›è¡ŒéšæœºæŠ½å¥–æˆ–å†³ç­–ï¼›</li><li>ç”Ÿæˆå”¯ä¸€æ ‡è¯†ç¬¦æˆ–ä¼šè¯ ID ç­‰ã€‚</li></ul><p>ç”±äºå®ƒæ˜¯åŸºäº Node.js çš„ <code>crypto</code> æ¨¡å—å®ç°çš„ï¼Œä½ å¯ä»¥æ”¾å¿ƒä½¿ç”¨å®ƒåœ¨ä½ çš„é¡¹ç›®ä¸­åˆ›å»ºå®‰å…¨çš„éšæœºæ•°ã€‚</p><h3 id="crypto-randomuuid-options" tabindex="-1"><a class="header-anchor" href="#crypto-randomuuid-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptorandomuuidoptions" target="_blank" rel="noopener noreferrer">crypto.randomUUID([options])</a></span></a></h3><p><code>crypto.randomUUID([options])</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒç”¨äºç”Ÿæˆä¸€ä¸ªç¬¦åˆ RFC 4122 æ ‡å‡†çš„éšæœºç‰ˆæœ¬ 4ï¼ˆå³&quot;v4&quot;ï¼‰çš„ UUIDï¼ˆé€šç”¨å”¯ä¸€æ ‡è¯†ç¬¦ï¼‰ã€‚UUID å¯ä»¥ä¿è¯åœ¨æ—¶é—´å’Œç©ºé—´ä¸Šçš„å”¯ä¸€æ€§ï¼Œå³ä½¿åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä¹Ÿä¸ä¼šå‡ºç°é‡å¤ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥éå¸¸ç®€å•åœ°è°ƒç”¨ï¼Œä¸”æ— éœ€é¢å¤–çš„ä¾èµ–ã€‚ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨å®ƒä»¥åŠä¸€äº›å®é™…çš„ä¾‹å­ï¼š</p><h3 id="åŸºæœ¬ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç”¨æ³•"><span>åŸºæœ¬ç”¨æ³•</span></a></h3><p>è¦ç”Ÿæˆä¸€ä¸ªæ–°çš„éšæœº UUIDï¼Œä½ å¯ä»¥ç›´æ¥è°ƒç”¨ <code>crypto.randomUUID()</code> å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆä¸€ä¸ªéšæœºçš„ UUID</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> uuid</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomUUID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">uuid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç±»ä¼¼ï¼š&#39;f47ac10b-58cc-4372-a567-0e02b2c3d479&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¯æ¬¡è°ƒç”¨ <code>crypto.randomUUID()</code> éƒ½ä¼šç”Ÿæˆä¸€ä¸ªå…¨æ–°çš„ã€å‡ ä¹ä¸å¯èƒ½é‡å¤çš„å­—ç¬¦ä¸²ã€‚</p><h3 id="options-å‚æ•°" tabindex="-1"><a class="header-anchor" href="#options-å‚æ•°"><span><code>options</code> å‚æ•°</span></a></h3><p><code>crypto.randomUUID()</code> å‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªå¯é€‰çš„ <code>options</code> å¯¹è±¡å‚æ•°ï¼Œå®ƒå…è®¸ä½ æŒ‡å®šç”Ÿæˆ UUID çš„æŸäº›ç‰¹å®šè¡Œä¸ºã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼ˆNode.js v21.7.1ï¼‰ï¼Œè¯¥å‡½æ•°æ”¯æŒä¸€ä¸ªå±æ€§ <code>disableEntropyCache</code>ï¼š</p><ul><li><code>disableEntropyCache</code>: ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œé»˜è®¤ä¸º <code>false</code>ã€‚å¦‚æœè®¾ä¸º <code>true</code>ï¼Œåˆ™æ¯æ¬¡è°ƒç”¨ <code>randomUUID</code> æ—¶éƒ½ä¼šä»åº•å±‚æ“ä½œç³»ç»Ÿé‡æ–°è·å–éšæœºå­—èŠ‚ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´è°ƒç”¨é€Ÿåº¦å˜æ…¢ï¼Œä½†å¯ä»¥åœ¨é•¿æ—¶é—´è¿è¡Œçš„ç¨‹åºä¸­æä¾›æ›´é«˜çš„ç†µè´¨é‡ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-4"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><ol><li><strong>Web åº”ç”¨ä¸­çš„ Session ID</strong>: åœ¨ web åº”ç”¨ç¨‹åºä¸­ï¼Œå½“ç”¨æˆ·ç™»å½•åï¼ŒæœåŠ¡å™¨å¯ä»¥ä¸ºç”¨æˆ·ä¼šè¯ä½¿ç”¨ UUID ä½œä¸ºå”¯ä¸€çš„ session id æ¥è¿½è¸ªç”¨æˆ·çŠ¶æ€ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> sessionMap</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Map</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> createNewSession</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">user</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> sessionId</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomUUID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  sessionMap</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">sessionId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">user</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> sessionId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å½“ç”¨æˆ·ç™»å½•å</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> userSessionId</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> createNewSession</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">userId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;user123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Alice&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">userSessionId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ–°çš„ session id</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>æ•°æ®åº“ä¸­çš„å”¯ä¸€é”®</strong>: åœ¨åˆ›å»ºæ•°æ®åº“è®°å½•æ—¶ï¼ŒUUID å¯ä»¥ä½œä¸ºä¸»é”®æˆ–å…¶ä»–å”¯ä¸€é”®æ¥ä½¿ç”¨ï¼Œç¡®ä¿æ¯æ¡è®°å½•éƒ½æœ‰å”¯ä¸€çš„æ ‡è¯†ç¬¦ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> createUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">username</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">email</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomUUID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾è¿™é‡Œæˆ‘ä»¬æ’å…¥æ•°æ®åº“çš„å‘½ä»¤</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // INSERT INTO users (id, username, email) VALUES (?, ?, ?)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`User created with ID: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">id</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;bob&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;bob@example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>æ–‡ä»¶ä¸Šä¼ ä¸­çš„å”¯ä¸€æ–‡ä»¶å</strong>: å½“ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨æ—¶ï¼Œå¯ä»¥ä¸ºæ¯ä¸ªæ–‡ä»¶ç”Ÿæˆ UUID ä½œä¸ºæ–‡ä»¶åï¼Œé˜²æ­¢æ–‡ä»¶åå†²çªã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> saveUploadedFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">fileBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">originalFilename</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> newFilename</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomUUID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getExtension</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">originalFilename</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`./uploads/</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">newFilename</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fileBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> newFilename</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getExtension</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">filename</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> filename</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">substring</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">filename</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lastIndexOf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æŸä¸ªç”¨æˆ·ä¸Šä¼ äº†ä¸€ä¸ªåä¸º &quot;photo.png&quot; çš„æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> uploadedFile</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> savedFilename</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> saveUploadedFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">uploadedFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;photo.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`File saved as: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">savedFilename</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šä»…ä»…æ˜¯ <code>crypto.randomUUID()</code> åœ¨å®é™…ç¼–ç¨‹ä¸­çš„ä¸€å°éƒ¨åˆ†åº”ç”¨ç¤ºä¾‹ï¼Œå…¶å®å®ƒçš„ä½¿ç”¨åœºæ™¯éå¸¸å¹¿æ³›ï¼Œåªè¦éœ€è¦ä¸€ä¸ªä¸å®¹æ˜“å‘ç”Ÿå†²çªçš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨ UUIDã€‚</p><h3 id="crypto-scrypt-password-salt-keylen-options-callback" tabindex="-1"><a class="header-anchor" href="#crypto-scrypt-password-salt-keylen-options-callback"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptoscryptpassword-salt-keylen-options-callback" target="_blank" rel="noopener noreferrer">crypto.scrypt(password, salt, keylen[, options], callback)</a></span></a></h3><p>Node.js çš„ <code>crypto.scrypt</code> å‡½æ•°æ˜¯ä¸€ä¸ªç”¨äºå¯†ç æ´¾ç”Ÿçš„åŠŸèƒ½ã€‚ç®€å•æ¥è¯´ï¼Œå¯†ç æ´¾ç”Ÿå°±æ˜¯å°†åŸå§‹å¯†ç è½¬åŒ–ä¸ºä¸€ä¸ªæ›´éš¾ä»¥ç ´è§£çš„å½¢å¼ï¼Œé€šå¸¸ç”¨äºå®‰å…¨å­˜å‚¨å¯†ç ã€‚</p><p>åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œç›´æ¥å­˜å‚¨ç”¨æˆ·çš„æ˜æ–‡å¯†ç æ˜¯éå¸¸å±é™©çš„ï¼Œå¦‚æœæ•°æ®åº“è¢«é»‘å®¢æ”»å‡»ï¼Œé‚£ä¹ˆæ‰€æœ‰ç”¨æˆ·çš„å¯†ç éƒ½ä¼šæš´éœ²ã€‚ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šå¯¹å¯†ç è¿›è¡Œæ•£åˆ—ï¼ˆhashingï¼‰å¤„ç†ï¼Œå¹¶ç»“åˆâ€œç›å€¼â€ï¼ˆsaltï¼‰å¢åŠ å¤æ‚åº¦ï¼Œä½¿å¾—å³ä¾¿æ˜¯ç›¸åŒçš„å¯†ç ï¼Œåœ¨æœ‰äº†ä¸åŒçš„ç›å€¼åäº§ç”Ÿçš„æ•£åˆ—å€¼ä¹Ÿä¼šä¸åŒã€‚</p><p><code>crypto.scrypt</code> å°±æ˜¯å…¶ä¸­ä¸€ç§ç”¨æ¥åšè¿™ä»¶äº‹çš„å‡½æ•°ã€‚å®ƒä¼šæ¥æ”¶å‡ ä¸ªå‚æ•°ï¼š</p><ol><li><code>password</code>ï¼šç”¨æˆ·çš„æ˜æ–‡å¯†ç ã€‚</li><li><code>salt</code>ï¼šä¸€ä¸²ç”¨æ¥å’Œå¯†ç æ··åˆï¼Œæé«˜å®‰å…¨æ€§çš„éšæœºæ•°æ®ã€‚</li><li><code>keylen</code>ï¼šå¸Œæœ›å¾—åˆ°çš„å¯†é’¥ï¼ˆä¹Ÿå°±æ˜¯æ•£åˆ—åçš„å¯†ç ï¼‰çš„é•¿åº¦ã€‚</li><li><code>options</code>ï¼š(å¯é€‰) ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥å®šä¹‰é¢å¤–çš„é…ç½®æ¯”å¦‚ CPU å’Œå†…å­˜ä½¿ç”¨é‡ã€‚</li><li><code>callback</code>ï¼šå½“æ“ä½œå®Œæˆæ—¶è°ƒç”¨çš„å‡½æ•°ï¼Œè¿”å›å¯èƒ½çš„é”™è¯¯æˆ–è€…æ´¾ç”Ÿå‡ºçš„å¯†é’¥ã€‚</li></ol><p>ä¸‹é¢é€šè¿‡ä¸€ä¸ªå®é™…ä¾‹å­æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨æ­¤å‡½æ•°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”¨æˆ·çš„åŸå§‹å¯†ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> password</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;mySecretPassword&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªç›å€¼ï¼ˆé€šå¸¸ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> salt</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯†é’¥é•¿åº¦å®šä¹‰ä¸º64å­—èŠ‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> keylen</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 64</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">scrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">salt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">keylen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">derivedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¾—åˆ°çš„derivedKeyæ˜¯ä¸€ä¸ªBufferï¼Œé€šå¸¸æˆ‘ä»¬æŠŠå®ƒè½¬åŒ–æˆhexå­—ç¬¦ä¸²å­˜å‚¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">derivedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™å°±æ˜¯æœ€ç»ˆå­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„å¯†ç æ•£åˆ—å€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåŒ…å«äº† Node.js æ ¸å¿ƒæ¨¡å— <code>crypto</code>ã€‚ç„¶åå®šä¹‰äº†ç”¨æˆ·çš„åŸå§‹å¯†ç å’Œè‡ªåŠ¨ç”Ÿæˆçš„ç›å€¼ã€‚ä¹‹åæŒ‡å®šäº†æˆ‘ä»¬æƒ³è¦ç”Ÿæˆçš„å¯†é’¥ï¼ˆæ•£åˆ—å€¼ï¼‰é•¿åº¦ï¼Œå¹¶è°ƒç”¨ <code>crypto.scrypt</code> å‡½æ•°æ¥è¿›è¡Œå¯†ç æ´¾ç”Ÿã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ç»“æŸåï¼Œæˆ‘ä»¬å°†å¾—åˆ°çš„ Buffer è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å°±æ˜¯æˆ‘ä»¬å°†è¦å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„å€¼ï¼Œè€Œä¸æ˜¯ç”¨æˆ·çš„åŸå§‹å¯†ç ã€‚</p><p>æ¯æ¬¡ç”¨æˆ·ç™»å½•ç³»ç»Ÿæ—¶ï¼Œä½ éƒ½å¯ä»¥ä½¿ç”¨ç›¸åŒçš„ç›å€¼ï¼Œå°†è¾“å…¥çš„å¯†ç ç»è¿‡ç›¸åŒçš„å¤„ç†ï¼Œå¾—åˆ°æ•£åˆ—å€¼ï¼Œå¹¶ä¸æ•°æ®åº“ä¸­å­˜å‚¨çš„æ•£åˆ—å€¼è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœä»–ä»¬åŒ¹é…ï¼Œè¯´æ˜ç”¨æˆ·è¾“å…¥çš„å¯†ç æ˜¯æ­£ç¡®çš„ã€‚</p><p>è¿™ç§æ–¹æ³•çš„å…³é”®ç‚¹åœ¨äºç›å€¼æ˜¯å”¯ä¸€ä¸”éšæœºçš„ï¼Œå³ä½¿ä¸¤ä¸ªç”¨æˆ·çš„åŸå§‹å¯†ç ç›¸åŒï¼Œç”±äºç›å€¼çš„ä¸åŒï¼Œä»–ä»¬å­˜å‚¨çš„æ•£åˆ—å€¼ä¹Ÿå°†ä¼šä¸åŒï¼Œå¤§å¤§å¢å¼ºäº†ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚</p><p>æ­¤å¤–ï¼Œ<code>crypto.scrypt</code> æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œå®ƒä¸ä¼šé˜»å¡ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ï¼Œå› ä¸ºå…¶åœ¨è®¡ç®—æ—¶å¯èƒ½ä¼šå ç”¨è¾ƒé•¿æ—¶é—´ï¼Œç‰¹åˆ«æ˜¯å¦‚æœä½ é€‰æ‹©äº†ä¸€ä¸ªå¾ˆå¤§çš„å·¥ä½œé‡å‚æ•°ï¼ˆé€šè¿‡ <code>options</code>ï¼‰ã€‚è¿™æ˜¯ Node.js éé˜»å¡ I/O æ¨¡å‹çš„ä¸€ä¸ªä¼˜åŠ¿ï¼Œè®©æœåŠ¡å™¨å¯ä»¥åŒæ—¶å¤„ç†æ›´å¤šçš„äº‹æƒ…ã€‚</p><h3 id="crypto-scryptsync-password-salt-keylen-options" tabindex="-1"><a class="header-anchor" href="#crypto-scryptsync-password-salt-keylen-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptoscryptsyncpassword-salt-keylen-options" target="_blank" rel="noopener noreferrer">crypto.scryptSync(password, salt, keylen[, options])</a></span></a></h3><p><code>crypto.scryptSync</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªåŒæ­¥å‡½æ•°ï¼Œç”¨äºæ‰§è¡Œå¯†ç æ´¾ç”Ÿæ“ä½œã€‚è¿™æ˜¯ä¸€ç§åŠ å¯†æŠ€æœ¯ï¼Œå®ƒå¯ä»¥å°†åŸå§‹å¯†ç è½¬æ¢æˆå›ºå®šé•¿åº¦çš„å­—ç¬¦ä¸²ï¼ˆé€šå¸¸ç§°ä¸ºâ€œå¯†é’¥â€ï¼‰ï¼Œè¿™ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ° CPU å’Œå†…å­˜èµ„æºçš„é«˜å¼ºåº¦ä½¿ç”¨ï¼Œä»¥é˜²æ­¢æš´åŠ›æ”»å‡»ã€‚</p><p>åœ¨ <code>crypto.scryptSync</code> å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä¼ é€’ä¸‰ä¸ªå¿…é¡»çš„å‚æ•°å’Œä¸€ä¸ªå¯é€‰çš„å‚æ•°ï¼š</p><ol><li><code>password</code>: è¿™æ˜¯ä½ æƒ³è¦åŠ å¯†çš„åŸå§‹å¯†ç ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–è€…æ˜¯ Buffer ç±»å‹ã€‚</li><li><code>salt</code>: ç”¨äºæ·»åŠ åˆ°å¯†ç ä¸Šä»¥æä¾›å”¯ä¸€æ€§çš„éšæœºæ•°æ®ã€‚æ¯æ¬¡åŠ å¯†ç›¸åŒçš„å¯†ç æ—¶ï¼Œéƒ½åº”è¯¥ä½¿ç”¨ä¸€ä¸ªæ–°çš„ç›å€¼ï¼Œè¿™æ ·å³ä½¿ä¸¤æ¬¡åŠ å¯†çš„åŸå§‹å¯†ç ç›¸åŒï¼Œæœ€ç»ˆç”Ÿæˆçš„å¯†é’¥ä¹Ÿä¼šä¸åŒã€‚</li><li><code>keylen</code>: è¡¨ç¤ºè¾“å‡ºå¯†é’¥çš„æœŸæœ›é•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚</li><li><code>options</code>: å¯é€‰å‚æ•°ï¼Œæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥åŒ…å«å¦‚ä¸‹å±æ€§ï¼š <ul><li><code>N</code>: å·¥ä½œå› å­ï¼Œè¡¨ç¤º CPU å’Œå†…å­˜çš„ä½¿ç”¨é‡ï¼Œé»˜è®¤å€¼æ˜¯ 16384ã€‚</li><li><code>r</code>: å—å¤§å°å‚æ•°ã€‚</li><li><code>p</code>: å¹¶è¡ŒåŒ–å‚æ•°ã€‚</li><li><code>maxmem</code>: æŒ‡å®š scrypt ç®—æ³•æœ€å¤§å¯ä½¿ç”¨çš„å†…å­˜æ•°é‡ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ã€‚</li></ul></li></ol><p>è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯†é’¥ï¼Œå®ƒæ˜¯ä¸€ä¸ª Buffer å¯¹è±¡ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä¸¾ä¸€äº›å®é™…ä¾‹å­ã€‚</p><h3 id="ç¤ºä¾‹-1-åŸºæœ¬å¯†ç æ´¾ç”Ÿ" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-åŸºæœ¬å¯†ç æ´¾ç”Ÿ"><span>ç¤ºä¾‹ 1ï¼šåŸºæœ¬å¯†ç æ´¾ç”Ÿ</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”¨æˆ·çš„åŸå§‹å¯†ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> password</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;mySecretPassword&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆä¸€ä¸ªéšæœºç›å€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> salt</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆ‘ä»¬å¸Œæœ›å¾—åˆ°çš„å¯†é’¥çš„é•¿åº¦ï¼ˆä¾‹å¦‚64ä¸ªå­—èŠ‚ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> keylen</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 64</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ scrypt åŒæ­¥æ´¾ç”Ÿå¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> derivedKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">scryptSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">salt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">keylen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">derivedKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç»“æœæ˜¯å¯†é’¥çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²å½¢å¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ªå¯†é’¥ï¼Œå¯ä»¥ç”¨æ¥å®‰å…¨åœ°å­˜å‚¨ç”¨æˆ·çš„å¯†ç æˆ–ç”¨ä½œåŠ å¯†ç®—æ³•çš„å¯†é’¥ã€‚</p><h3 id="ç¤ºä¾‹-2-ä½¿ç”¨-options-å‚æ•°" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨-options-å‚æ•°"><span>ç¤ºä¾‹ 2ï¼šä½¿ç”¨ options å‚æ•°</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> password</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;mySecretPassword&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> salt</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> keylen</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 64</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> options</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  N</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1024</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  r</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  p</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ scrypt åŒæ­¥æ´¾ç”Ÿå¯†é’¥ï¼Œå¹¶ä¼ å…¥ options å‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> derivedKeyWithOptions</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">scryptSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  salt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  keylen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  options</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">derivedKeyWithOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ç¬¬äºŒä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä¸ª <code>options</code> å¯¹è±¡æ¥æŒ‡å®š <code>N</code>, <code>r</code>, <code>p</code> å‚æ•°ã€‚è¿™å…è®¸æˆ‘ä»¬è°ƒæ•´èµ„æºæ¶ˆè€—å’Œæ€§èƒ½ä¹‹é—´çš„å¹³è¡¡ï¼Œä»¥æ»¡è¶³ä¸åŒçš„å®‰å…¨éœ€æ±‚ã€‚</p><p>è¯·æ³¨æ„ï¼Œè¿™äº›æ“ä½œæ˜¯åŒæ­¥çš„ï¼Œè¿™æ„å‘³ç€å®ƒä»¬ä¼šé˜»å¡äº‹ä»¶å¾ªç¯ç›´åˆ°å®Œæˆã€‚å¯¹äºéœ€è¦å¤„ç†å¤§é‡å¹¶å‘è¯·æ±‚çš„æœåŠ¡å™¨è€Œè¨€ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚åœ¨å®é™…çš„ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œé€šå¸¸æ›´æ¨èä½¿ç”¨å¼‚æ­¥ç‰ˆæœ¬ <code>crypto.scrypt</code> æ¥é¿å…é˜»å¡ã€‚</p><h3 id="crypto-secureheapused" tabindex="-1"><a class="header-anchor" href="#crypto-secureheapused"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptosecureheapused" target="_blank" rel="noopener noreferrer">crypto.secureHeapUsed()</a></span></a></h3><p>Node.js çš„ <code>crypto</code> æ¨¡å—æä¾›äº†ä¸€ç³»åˆ—åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯¹æ•°æ®çš„åŠ å¯†å’Œè§£å¯†ã€æ•£åˆ—è®¡ç®—ã€å¯†ç å­¦ç­¾åç­‰ã€‚åœ¨ Node.js ç‰ˆæœ¬ 21.7.1 ä¸­ï¼Œå¼•å…¥äº†ä¸€ä¸ªæ–°åŠŸèƒ½ <code>crypto.secureHeapUsed()</code>ã€‚</p><p>è¿™ä¸ªå‡½æ•°çš„ç›®çš„æ˜¯ç”¨äºæä¾›å…³äº Node.js åŠ å¯†æ“ä½œä½¿ç”¨çš„å®‰å…¨å †å†…å­˜ï¼ˆSecure Heapï¼‰çš„ä¿¡æ¯ã€‚å®‰å…¨å †æ˜¯ä¸“é—¨ä¸ºäº†å­˜å‚¨å’Œå¤„ç†æ•æ„Ÿæ•°æ®ï¼ˆå¦‚å¯†é’¥æˆ–å¯†ç ï¼‰è€Œè®¾è®¡çš„å†…å­˜åŒºåŸŸã€‚è¿™å—å†…å­˜åŒºåŸŸä¼šå°½é‡å‡å°‘æ•°æ®è¢«äº¤æ¢åˆ°ç¡¬ç›˜ä¸Šï¼Œæˆ–è€…è¢«å…¶ä»–è¿›ç¨‹è¯»å–çš„å¯èƒ½ï¼Œä»¥æ­¤æ¥ä¿æŠ¤æ•æ„Ÿæ•°æ®ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œ<code>crypto.secureHeapUsed()</code> å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«æœ‰å…³å½“å‰ä½¿ç”¨çš„å®‰å…¨å †å†…å­˜å¤§å°çš„ä¿¡æ¯ã€‚è¿™å¯¹äºç›‘è§†å’Œè°ƒè¯•åŠ å¯†æ“ä½œä¸­å†…å­˜çš„ä½¿ç”¨éå¸¸æœ‰å¸®åŠ©ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨ Node.js ç¨‹åºä¸­ä½¿ç”¨ <code>crypto.secureHeapUsed()</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æ­£åœ¨è¿›è¡ŒæŸç§æ¶‰åŠæ•æ„Ÿæ•°æ®çš„åŠ å¯†æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> encryptSensitiveData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-192-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ•æ„Ÿæ•°æ®å’Œå¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secretData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;è¿™æ˜¯ä¸€äº›éå¸¸æ•æ„Ÿçš„æ•°æ®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secretKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;ç§˜å¯†å¯†é’¥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰§è¡ŒåŠ å¯†æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encryptedData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> encryptSensitiveData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secretData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰“å°å‡ºåŠ å¯†åçš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åŠ å¯†åçš„æ•°æ®:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encryptedData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ crypto.secureHeapUsed() æ¥æ£€æŸ¥å®‰å…¨å †çš„ä½¿ç”¨æƒ…å†µ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secureHeapUsage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">secureHeapUsed</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å®‰å…¨å †ä½¿ç”¨æƒ…å†µ:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secureHeapUsage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† <code>crypto</code> æ¨¡å—ã€‚ç„¶åå®šä¹‰äº†ä¸€ä¸ªåŠ å¯†å‡½æ•° <code>encryptSensitiveData</code>ï¼Œè¯¥å‡½æ•°æ¥å—å¾…åŠ å¯†çš„æ•°æ®å’Œå¯†é’¥ä½œä¸ºå‚æ•°ï¼Œè¿›è¡ŒåŠ å¯†æ“ä½œå¹¶è¿”å›åŠ å¯†åçš„æ•°æ®ã€‚æ¥ç€ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€äº›å‡æƒ³çš„æ•æ„Ÿæ•°æ®å’Œä¸€ä¸ªå¯†é’¥ï¼Œå¹¶è°ƒç”¨ <code>encryptSensitiveData</code> å‡½æ•°æ¥åŠ å¯†è¿™äº›æ•°æ®ã€‚æœ€åï¼Œæˆ‘ä»¬è°ƒç”¨ <code>crypto.secureHeapUsed()</code> æ¥è·å–å½“å‰å®‰å…¨å †çš„ä½¿ç”¨æƒ…å†µï¼Œå¹¶å°†å…¶æ‰“å°å‡ºæ¥ã€‚</p><p>è¯·æ³¨æ„ï¼Œåœ¨è°ƒç”¨ <code>crypto.secureHeapUsed()</code> ä¹‹å‰ï¼Œä½ éœ€è¦ç¡®ä¿å·²ç»å¯ç”¨äº†å®‰å…¨å †åŠŸèƒ½ï¼Œå› ä¸ºå¹¶ä¸æ˜¯æ‰€æœ‰çš„ Node.js æ„å»ºéƒ½æ”¯æŒå®ƒã€‚å¦‚æœä½ çš„ç¯å¢ƒæ²¡æœ‰å¯ç”¨å®‰å…¨å †ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°è°ƒç”¨å¯èƒ½ä¼šè¿”å›ç©ºå€¼æˆ–è€…æç¤ºé”™è¯¯ã€‚</p><h3 id="crypto-setengine-engine-flags" tabindex="-1"><a class="header-anchor" href="#crypto-setengine-engine-flags"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptosetengineengine-flags" target="_blank" rel="noopener noreferrer">crypto.setEngine(engine[, flags])</a></span></a></h3><p>Node.js çš„ <code>crypto</code> æ¨¡å—æ˜¯ç”¨æ¥æä¾›åŠ å¯†åŠŸèƒ½çš„ï¼ŒåŒ…æ‹¬å„ç§åŠ å¯†ç®—æ³•çš„å®ç°ã€‚<code>crypto.setEngine(engine[, flags])</code> è¿™ä¸ªæ–¹æ³•æ˜¯ Node.js ä¸­ç”¨äºæŒ‡å®šä¸€ä¸ªä¸åŒçš„åŠ å¯†å¼•æ“ï¼Œè¿™é‡Œçš„&quot;å¼•æ“&quot;å¯ä»¥ç†è§£ä¸ºä¸€å¥—å¤„ç†åŠ å¯†å’Œè§£å¯†æ“ä½œçš„åº•å±‚åº“ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒNode.js ä½¿ç”¨çš„æ˜¯ OpenSSL ä½œä¸ºå…¶åŠ å¯†åº“ã€‚ä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½æƒ³ä½¿ç”¨ä¸åŒçš„åŠ å¯†åº“ï¼Œæ¯”å¦‚ç¡¬ä»¶åŠ é€Ÿçš„åŠ å¯†è®¾å¤‡æˆ–å…¶ä»–åŠ å¯†å®ç°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>crypto.setEngine()</code> æ–¹æ³•å°±éå¸¸æœ‰ç”¨äº†ã€‚</p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><code>engine</code>: å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¦åŠ è½½çš„åŠ å¯†å¼•æ“çš„åç§°ã€‚</li><li><code>flags</code>: å¯é€‰å‚æ•°ï¼Œæ˜¯ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šå¼•æ“çš„è¡Œä¸ºï¼Œä¾‹å¦‚æ˜¯å¦åªç”¨ä½œåŠ å¯†ç­‰ã€‚</li></ul><p>ä¾‹å­è¯´æ˜ï¼š</p><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªç‰¹å®šçš„ç¡¬ä»¶å®‰å…¨æ¨¡å—ï¼ˆHSMï¼‰ï¼Œå®ƒæ”¯æŒåŠ å¯†å’Œè§£å¯†æ“ä½œï¼Œå¹¶ä¸”å·²ç»æœ‰ä¸€ä¸ªå¯¹åº”çš„ Node.js æ’ä»¶æˆ–è€…åŠ¨æ€é“¾æ¥åº“ï¼ˆdynamic link library, DLLï¼‰ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>crypto.setEngine()</code> æ¥æŒ‡å®šè¿™ä¸ªåŠ å¯†å¼•æ“ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡å®š &quot;newEngine&quot; æ˜¯ä½ çš„ç¡¬ä»¶åŠ å¯†æ¨¡å—æä¾›çš„æ’ä»¶åç§°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ENGINE_METHOD_ALL è¡¨ç¤ºæˆ‘ä»¬è¦ç”¨è¿™ä¸ªæ–°å¼•æ“è¿›è¡Œæ‰€æœ‰çš„åŠ å¯†æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿™é‡Œçš„ &#39;ENGINE_METHOD_ALL&#39; å®é™…ä¸Šåº”è¯¥æ˜¯ä¸€ä¸ªä¸ä½ çš„åŠ å¯†åº“ç›¸å¯¹åº”çš„æ ‡å¿—å€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setEngine</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;newEngine&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">ENGINE_METHOD_ALL</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è®¾ç½®åŠ å¯†å¼•æ“å¤±è´¥ï¼š&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨åœ¨è°ƒç”¨ crypto æ¨¡å—çš„æ–¹æ³•æ—¶ï¼ŒNode.js å°†å°è¯•ä½¿ç”¨ä½ æŒ‡å®šçš„ &#39;newEngine&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œç›´æ¥è®¾ç½®åŠ å¯†å¼•æ“çš„æƒ…å†µå¹¶ä¸å¤šè§ï¼Œå› ä¸ºå¤§å¤šæ•°å¼€å‘è€…ä¼šç›´æ¥ä½¿ç”¨ OpenSSL æˆ–è€…å…¶ä»–é»˜è®¤é›†æˆåœ¨ Node.js ä¸­çš„åŠ å¯†åº“ã€‚è€Œä¸”ï¼Œç”±äºæ¶‰åŠåˆ°åº•å±‚ç»†èŠ‚ï¼Œé”™è¯¯åœ°é…ç½®åŠ å¯†å¼•æ“å¯èƒ½ä¼šå¯¼è‡´ä¸å¯é¢„è§çš„é—®é¢˜ã€‚</p><p>åœ¨ä½¿ç”¨ <code>crypto.setEngine()</code> æ—¶è¿˜éœ€è¦è€ƒè™‘ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ol><li>ç¡®ä¿ä½ ç†è§£äº†è‡ªå®šä¹‰åŠ å¯†å¼•æ“çš„å·¥ä½œåŸç†ï¼Œå› ä¸ºé”™è¯¯çš„ä½¿ç”¨å¯èƒ½ä¼šé™ä½ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚</li><li>ä½¿ç”¨éæ ‡å‡†çš„åŠ å¯†å¼•æ“å¯èƒ½ä¼šä½¿å¾—ä½ çš„ç¨‹åºæ›´éš¾ä»¥ç§»æ¤ã€‚</li><li>è¿™ä¸ªå‡½æ•°é€šå¸¸ç”¨äºé«˜çº§ç”¨é€”ï¼Œæ¯”å¦‚è¯´é›†æˆäº†ç‰¹å®šç¡¬ä»¶æˆ–è€…éœ€è¦ç¬¦åˆç‰¹åˆ«çš„åŠ å¯†æ ‡å‡†çš„åœºæ™¯ã€‚</li></ol><p>æœ€åï¼Œç”±äº Node.js å’Œç›¸å…³åŠ å¯†æŠ€æœ¯éƒ½åœ¨ä¸æ–­å‘å±•ï¼Œå»ºè®®æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ä»¥è·å–æœ€æ–°å’Œæœ€è¯¦å°½çš„ä¿¡æ¯ã€‚</p><h3 id="crypto-setfips-bool" tabindex="-1"><a class="header-anchor" href="#crypto-setfips-bool"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptosetfipsbool" target="_blank" rel="noopener noreferrer">crypto.setFips(bool)</a></span></a></h3><p><code>crypto.setFips(bool)</code> æ˜¯ Node.js ä¸­ <code>crypto</code> æ¨¡å—çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥å¼€å¯æˆ–å…³é—­ FIPS (Federal Information Processing Standard) æ¨¡å¼ã€‚FIPS æ˜¯ç¾å›½æ”¿åºœä¸ºè®¡ç®—æœºç³»ç»Ÿåˆ¶å®šçš„ä¸€ç³»åˆ—æ ‡å‡†ï¼Œå…¶ä¸­åŒ…æ‹¬åŠ å¯†ç®—æ³•å’Œå®‰å…¨è¦æ±‚ï¼Œæ—¨åœ¨ä¿è¯æ•°æ®çš„å®‰å…¨æ€§å’Œå®Œæ•´æ€§ã€‚</p><p>åœ¨ç¼–ç¨‹ä¸­ï¼Œç‰¹åˆ«æ˜¯å¤„ç†æ•æ„Ÿæ•°æ®ï¼ˆå¦‚ç”¨æˆ·å¯†ç ã€ä¸ªäººä¿¡æ¯ã€é‡‘èäº¤æ˜“ç­‰ï¼‰æ—¶ï¼Œå®‰å…¨æ€§éå¸¸é‡è¦ã€‚ä½¿ç”¨ç¬¦åˆ FIPS æ ‡å‡†çš„åŠ å¯†æ–¹æ³•å¯ä»¥å¸®åŠ©ç¡®ä¿ä½ çš„åº”ç”¨ç¨‹åºæ»¡è¶³è¿™äº›å®‰å…¨è¦æ±‚ã€‚</p><h3 id="ä½¿ç”¨-crypto-setfips-bool" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-crypto-setfips-bool"><span>ä½¿ç”¨ <code>crypto.setFips(bool)</code></span></a></h3><p>å½“ä½ è°ƒç”¨ <code>crypto.setFips(true)</code> æ—¶ï¼Œå°±ä¼šå¯ç”¨ FIPS æ¨¡å¼ï¼›å¦‚æœä½ è°ƒç”¨ <code>crypto.setFips(false)</code>ï¼Œåˆ™ä¼šç¦ç”¨ FIPS æ¨¡å¼ã€‚è¿™æ„å‘³ç€æ‰€æœ‰ <code>crypto</code> æ¨¡å—æä¾›çš„åŠ å¯†æ“ä½œéƒ½å°†éµå¾ª FIPS çš„è§„èŒƒï¼Œåªè¦å®ƒä»¬è¢«è®¾ç½®ä¸º trueã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-3" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-3"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>åœ¨ FIPS æ¨¡å¼ä¸‹ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„åŠ å¯†ç®—æ³•éƒ½å¯ç”¨ã€‚ä»…æ”¯æŒé‚£äº›ç¬¦åˆ FIPS æ ‡å‡†çš„ç®—æ³•ã€‚</li><li>ä½ çš„ Node.js å¿…é¡»æ„å»ºåœ¨æ”¯æŒ FIPS çš„ OpenSSL ä¸Šæ‰èƒ½ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ã€‚</li><li>é€šå¸¸ï¼Œå¼€å¯ FIPS æ¨¡å¼çš„è¡Œä¸ºæ›´é€‚åˆä¼ä¸šçº§æˆ–éœ€è¦ä¸¥æ ¼å®‰å…¨åˆè§„çš„ç¯å¢ƒã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-5"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><strong>é‡‘èæœåŠ¡åº”ç”¨</strong>ï¼šå‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªé‡‘èæœåŠ¡åº”ç”¨ï¼Œéœ€è¦å¯¹ç”¨æˆ·çš„äº¤æ˜“æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚ä¸ºäº†æ»¡è¶³ç›‘ç®¡è¦æ±‚ï¼Œä½ å¯èƒ½éœ€è¦ç¡®ä¿æ‰€æœ‰çš„åŠ å¯†éƒ½ç¬¦åˆ FIPS æ ‡å‡†ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯ç”¨ FIPS æ¨¡å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setFips</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªåŠ å¯†å¯¹è±¡ï¼Œä½¿ç”¨ä¸€ä¸ªç¬¦åˆ FIPS æ ‡å‡†çš„ç®—æ³•ï¼Œä¾‹å¦‚ AES</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-256-gcm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;some sensitive financial data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç»è¿‡ FIPS æ¨¡å¼åŠ å¯†çš„æ•°æ®</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>åŒ»ç–—ä¿¡æ¯ç³»ç»Ÿ</strong>ï¼šåŒ»ç–—ä¿¡æ¯ç³»ç»Ÿéœ€è¦éµå®ˆ HIPAA (Health Insurance Portability and Accountability Act) å®‰å…¨æ ‡å‡†ï¼Œè€Œè¿™äº›æ ‡å‡†å¯èƒ½è¦æ±‚ä½¿ç”¨ FIPS éªŒè¯è¿‡çš„åŠ å¯†ç®—æ³•æ¥ä¿æŠ¤ä¸ªäººå¥åº·ä¿¡æ¯ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯ç”¨ FIPS æ¨¡å¼ï¼Œä»¥æ»¡è¶³ HIPAA å®‰å…¨è¦æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setFips</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯¹ç—…äººçš„ä¸ªäººå¥åº·ä¿¡æ¯è¿›è¡ŒåŠ å¯†å­˜å‚¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">patientInformation</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> digest</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç¬¦åˆ FIPS æ ‡å‡†çš„æ•£åˆ—å€¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>æ”¿åºœæœºæ„ç½‘ç«™</strong>ï¼šä¸€ä¸ªæ”¿åºœæœºæ„çš„ç½‘ç«™éœ€è¦ç¡®ä¿å…¶åŠ å¯†æªæ–½ç¬¦åˆè”é‚¦å®‰å…¨è§„å®šï¼Œå¯èƒ½ä¼šé€‰æ‹©å¯ç”¨ FIPS æ¨¡å¼ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”±äºæ”¿åºœå®‰å…¨è§„å®šï¼Œå¿…é¡»åœ¨ FIPS æ¨¡å¼ä¸‹è¿è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setFips</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŠ å¯†å­˜å‚¨ç”¨æˆ·æäº¤çš„è¡¨å•æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> secretMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;classified information&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-192-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secretKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secretMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºç¬¦åˆæ”¿åºœè§„å®šçš„åŠ å¯†åçš„ä¿¡æ¯</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ€»ä¹‹ï¼Œ<code>crypto.setFips(bool)</code> æ˜¯ä¸€ä¸ªé‡è¦çš„å‡½æ•°ï¼Œå®ƒå…è®¸ä½ æ ¹æ®éœ€è¦å¯åŠ¨æˆ–å…³é—­ FIPS æ¨¡å¼ï¼Œä»è€Œç¡®ä¿ä½ çš„ Node.js åº”ç”¨ç¨‹åºå¯ä»¥æŒ‰ç…§æŸäº›å®‰å…¨æ ‡å‡†è¿›è¡Œæ“ä½œã€‚è®°ä½ï¼Œå¦‚æœä½ çš„åº”ç”¨ä¸éœ€è¦éµå®ˆ FIPS æ ‡å‡†ï¼Œä½ ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨è¿™ä¸ªå‡½æ•°ã€‚</p><h3 id="crypto-sign-algorithm-data-key-callback" tabindex="-1"><a class="header-anchor" href="#crypto-sign-algorithm-data-key-callback"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptosignalgorithm-data-key-callback" target="_blank" rel="noopener noreferrer">crypto.sign(algorithm, data, key[, callback])</a></span></a></h3><p>Node.js ä¸­çš„<code>crypto.sign()</code>æ–¹æ³•æ˜¯ä¸€ä¸ªç”¨äºç”Ÿæˆæ•°å­—ç­¾åçš„å‡½æ•°ã€‚æ•°å­—ç­¾åæ˜¯ä¸€ç§å®‰å…¨æŠ€æœ¯ï¼Œç”¨äºéªŒè¯æ•°æ®çš„å®Œæ•´æ€§ä»¥åŠæ•°æ®å‘é€è€…çš„èº«ä»½ã€‚ç°åœ¨ï¼Œæˆ‘å°†è¯¦ç»†è§£é‡Šè¿™ä¸ªå‡½æ•°çš„å·¥ä½œåŸç†ï¼Œå¹¶ç»™å‡ºå‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­ã€‚</p><h3 id="è§£é‡Š-crypto-sign" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-crypto-sign"><span>è§£é‡Š <code>crypto.sign()</code></span></a></h3><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ†è§£<code>crypto.sign()</code>å‡½æ•°çš„å‚æ•°ï¼š</p><ol><li><code>algorithm</code>ï¼šè¿™æ˜¯ä½ ç”¨æ¥ç”Ÿæˆç­¾åçš„åŠ å¯†ç®—æ³•ï¼Œæ¯”å¦‚ <code>&#39;RSA-SHA256&#39;</code>ã€<code>&#39;DSA-SHA256&#39;</code> æˆ– <code>&#39;ECDSA-SHA256&#39;</code>ã€‚</li><li><code>data</code>ï¼šè¿™æ˜¯ä½ æƒ³è¦ç­¾åçš„æ•°æ®ã€‚å®ƒå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–è€… Bufferï¼ˆäºŒè¿›åˆ¶æ•°æ®ï¼‰ã€‚</li><li><code>key</code>ï¼šè¿™æ˜¯ä¸€ä¸ªåŒ…å«ç§é’¥ä¿¡æ¯çš„å¯¹è±¡ï¼Œä½ éœ€è¦å®ƒæ¥ç”Ÿæˆç­¾åã€‚é€šå¸¸ï¼Œè¿™æ˜¯ä¸€ä¸ª PEM æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–ç±»å‹çš„å¯†é’¥å¯¹è±¡ã€‚</li><li><code>callback</code>ï¼ˆå¯é€‰ï¼‰ï¼šå¦‚æœæä¾›äº†å›è°ƒå‡½æ•°ï¼Œ<code>crypto.sign()</code>å°†å¼‚æ­¥åœ°æ‰§è¡Œï¼Œå¹¶åœ¨å®Œæˆæ—¶è°ƒç”¨è¯¥å›è°ƒå‡½æ•°ï¼Œä¼ é€’é”™è¯¯æˆ–ç­¾åä½œä¸ºå‚æ•°ã€‚å¦‚æœä¸æä¾›å›è°ƒï¼Œè¯¥å‡½æ•°å°†åŒæ­¥æ‰§è¡Œå¹¶ç›´æ¥è¿”å›ç­¾åã€‚</li></ol><p>å½“ä½ è°ƒç”¨<code>crypto.sign()</code>æ—¶ï¼ŒNode.js ä¼šä½¿ç”¨æŒ‡å®šçš„ç®—æ³•å’Œç§é’¥æ¥å¯¹æ•°æ®ç”Ÿæˆå”¯ä¸€çš„ç­¾åã€‚è¿™ä¸ªç­¾åéšåå¯ä»¥è¢«å‘é€åˆ°æ¥æ”¶æ–¹ï¼Œæ¥æ”¶æ–¹å¯ä»¥ä½¿ç”¨ç›¸åº”çš„å…¬é’¥éªŒè¯ç­¾åæ˜¯å¦æœ‰æ•ˆï¼Œä»è€Œç¡®ä¿æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æœªè¢«ç¯¡æ”¹ï¼Œå¹¶éªŒè¯æ•°æ®æ˜¯ç”±æŒæœ‰ç§é’¥çš„å‘é€æ–¹å‘é€çš„ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-4"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><h4 id="ä¾‹å­-1-åŒæ­¥ç­¾å" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-åŒæ­¥ç­¾å"><span>ä¾‹å­ 1: åŒæ­¥ç­¾å</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨æ„å»ºä¸€ä¸ªéœ€è¦ç”¨æˆ·èº«ä»½éªŒè¯çš„ç½‘ç«™ï¼Œå¹¶å¸Œæœ›ç¡®ä¿å‘é€ç»™ç”¨æˆ·çš„æ•°æ®æœªè¢«ç¯¡æ”¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¾…ç­¾åçš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„æ¶ˆæ¯&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ç§é’¥ç”Ÿæˆç­¾å</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;RSA-SHA256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  padding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">RSA_PKCS1_PSS_PADDING</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">signature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç­¾åå¯ä»¥å‘é€ç»™æ¥æ”¶æ–¹ï¼Œä»–ä»¬å¯ä»¥ä½¿ç”¨å…¬é’¥æ¥éªŒè¯å®ƒ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä¾‹å­-2-å¼‚æ­¥ç­¾å" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-å¼‚æ­¥ç­¾å"><span>ä¾‹å­ 2: å¼‚æ­¥ç­¾å</span></a></h4><p>å¦‚æœä½ åœ¨å¤„ç†å¤§é‡æ•°æ®æˆ–è€…ä¸å¸Œæœ›é˜»å¡äº‹ä»¶å¾ªç¯ï¼Œå¯èƒ½å¸Œæœ›å¼‚æ­¥åœ°ç”Ÿæˆç­¾åã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeyPair</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¾…ç­¾åçš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„æ¶ˆæ¯&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¼‚æ­¥ç”Ÿæˆç­¾å</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      &quot;RSA-SHA256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">        key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">        padding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">RSA_PKCS1_PSS_PADDING</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">signature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">signature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        // ç­¾åå¯ä»¥å‘é€ç»™æ¥æ”¶æ–¹ï¼Œä»–ä»¬å¯ä»¥ä½¿ç”¨å…¬é’¥æ¥éªŒè¯å®ƒ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸¤ä¸ªä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>crypto.sign()</code>æ¥ç”Ÿæˆæ•°æ®çš„æ•°å­—ç­¾åã€‚åœ¨çœŸå®åœºæ™¯ä¸‹ï¼Œä½ éœ€è¦ç¡®ä¿ç§é’¥çš„å®‰å…¨ï¼Œåªæœ‰æˆæƒçš„å‘é€æ–¹æ‰èƒ½è®¿é—®å®ƒï¼Œè€Œå…¬é’¥åˆ™å¯ä»¥å®‰å…¨åœ°åˆ†äº«ç»™ä»»ä½•éœ€è¦éªŒè¯ç­¾åçš„äººã€‚</p><h3 id="crypto-subtle" tabindex="-1"><a class="header-anchor" href="#crypto-subtle"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptosubtle" target="_blank" rel="noopener noreferrer">crypto.subtle</a></span></a></h3><p>Node.js ä¸­çš„ <code>crypto.subtle</code> æ˜¯ä¸€ä¸ªç”¨äºæ‰§è¡Œå„ç§å¯†ç å­¦æ“ä½œçš„ API æ¥å£ï¼Œå®ƒæ¥è‡ª Web æ ‡å‡†ä¸­çš„ Web Cryptography APIã€‚è¿™ä¸ª API æä¾›äº†ä¸€å¥—ç”¨äºå¤„ç†åŠ å¯†å’Œè§£å¯†ã€æ•£åˆ—ã€ç­¾åå’ŒéªŒè¯ç­‰ä½çº§å¯†ç å­¦æ“ä½œçš„æ–¹æ³•é›†åˆã€‚<code>crypto.subtle</code> ä»…åœ¨ Node.js çš„ä¸Šä¸‹æ–‡ä¸­å¯ç”¨ï¼Œå¹¶ä¸”é€šå¸¸ç”¨äºå®‰å…¨æ€§è¾ƒé«˜çš„åœºæ™¯ã€‚</p><p>ä»¥ä¸‹æ˜¯ <code>crypto.subtle</code> ä¸­ä¸€äº›åŸºç¡€æ–¹æ³•çš„ç®€è¦è¯´æ˜ä»¥åŠå®ƒä»¬åº”ç”¨çš„å®ä¾‹ï¼š</p><ol><li><p>åŠ å¯†å’Œè§£å¯† (<code>encrypt</code> å’Œ <code>decrypt</code>)ï¼šç”¨äºåŠ å¯†æ•°æ®ä»¥ä¿æŠ¤å…¶å…é­æœªç»æˆæƒè®¿é—®ï¼Œå¹¶è§£å¯†é‚£äº›å·²è¢«åŠ å¯†çš„æ•°æ®ä»¥æ¢å¤åŸå§‹ä¿¡æ¯ã€‚</p><p><strong>å®ä¾‹</strong>ï¼š<br> å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦å­˜å‚¨ç”¨æˆ·æ•æ„Ÿä¿¡æ¯çš„åº”ç”¨ç¨‹åºï¼Œæ¯”å¦‚ä¿å­˜åˆ°æ•°æ®åº“ä¸­çš„å¯†ç ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>crypto.subtle.encrypt</code> æ–¹æ³•æ¥åŠ å¯†å¯†ç ï¼Œç„¶åå†å­˜å…¥æ•°æ®åº“ã€‚å½“ç”¨æˆ·å°è¯•ç™»å½•æ—¶ï¼Œä½ å¯ä»¥é€šè¿‡ <code>crypto.subtle.decrypt</code> æ–¹æ³•æ¥è§£å¯†å¯†ç å¹¶éªŒè¯ç”¨æˆ·çš„èº«ä»½ã€‚</p></li><li><p>æ•£åˆ— (<code>digest</code>)ï¼šç”Ÿæˆæ•°æ®ï¼ˆå¦‚æ–‡ä»¶æˆ–æ¶ˆæ¯ï¼‰çš„å›ºå®šå¤§å°çš„æ•£åˆ—å€¼ï¼Œå¸¸ç”¨äºéªŒè¯æ•°æ®å®Œæ•´æ€§ã€‚</p><p><strong>å®ä¾‹</strong>ï¼š<br> åœ¨ç”¨æˆ·åˆ›å»ºè´¦å·çš„æ—¶å€™ï¼Œä¸ºäº†ä¸ç›´æ¥å­˜å‚¨ç”¨æˆ·çš„å¯†ç ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>crypto.subtle.digest</code> æ¥åˆ›å»ºå¯†ç çš„æ•£åˆ—å€¼ï¼Œå¹¶å°†è¯¥æ•£åˆ—å€¼å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚æ¯æ¬¡ç”¨æˆ·ç™»å½•æ—¶ï¼Œä½ ä¹Ÿå¯¹è¾“å…¥çš„å¯†ç è¿›è¡Œç›¸åŒçš„æ•£åˆ—å¤„ç†ï¼Œå¹¶ä¸æ•°æ®åº“ä¸­çš„æ•£åˆ—å€¼è¿›è¡Œæ¯”è¾ƒã€‚</p></li><li><p>ç­¾åå’ŒéªŒè¯ (<code>sign</code> å’Œ <code>verify</code>)ï¼šæ•°å­—ç­¾åç”¨äºç¡®è®¤ä¿¡æ¯æ¥æºçš„çœŸå®æ€§ï¼ŒéªŒè¯åˆ™ç”¨äºæ£€éªŒç­¾åæ˜¯å¦æœ‰æ•ˆã€‚</p><p><strong>å®ä¾‹</strong>ï¼š<br> å¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç”µå­å•†åŠ¡å¹³å°ï¼Œç”¨æˆ·å¯èƒ½éœ€è¦å¯¹äº¤æ˜“è¿›è¡Œç­¾åä»¥è¯æ˜ä»–ä»¬çš„æˆæƒã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>crypto.subtle.sign</code> æ¥ç”Ÿæˆäº¤æ˜“çš„æ•°å­—ç­¾åã€‚éšåï¼Œåœ¨äº¤æ˜“è¿‡ç¨‹æˆ–å®¡æ ¸ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>crypto.subtle.verify</code> æ¥éªŒè¯ç­¾åçš„çœŸå®æ€§ã€‚</p></li><li><p>å¯†é’¥ç”Ÿæˆå’Œå¯¼å‡º (<code>generateKey</code>ã€<code>exportKey</code> å’Œ <code>importKey</code>)ï¼šç”Ÿæˆå¯†é’¥å¯¹ï¼ˆå…¬é’¥å’Œç§é’¥ï¼‰ï¼Œå¹¶å…è®¸å¯†é’¥çš„å¯¼å‡ºå’Œå¯¼å…¥ã€‚</p><p><strong>å®ä¾‹</strong>ï¼š<br> åœ¨ä¸€ä¸ªéœ€è¦ç«¯åˆ°ç«¯åŠ å¯†é€šä¿¡çš„å³æ—¶æ¶ˆæ¯åº”ç”¨ä¸­ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½éœ€è¦ç”Ÿæˆä¸€å¯¹å¯†é’¥ã€‚ç”¨ <code>crypto.subtle.generateKey</code> åˆ›å»ºå¯†é’¥å¯¹ï¼Œå¹¶å°†å…¬é’¥å‘é€ç»™å…¶ä»–ç”¨æˆ·ï¼Œè€Œä¿ç•™ç§é’¥ã€‚å½“æ”¶åˆ°åŠ å¯†çš„æ¶ˆæ¯æ—¶ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨è‡ªå·±çš„ç§é’¥è¿›è¡Œè§£å¯†ã€‚</p></li></ol><p>ä½¿ç”¨ <code>crypto.subtle</code> åº”è¯¥æ³¨æ„çš„å…³é”®ç‚¹æ˜¯ï¼Œå®ƒä»…å¤„ç†äºŒè¿›åˆ¶æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚ ArrayBuffer æˆ– TypedArrayï¼Œå› æ­¤åœ¨å¤„ç†å­—ç¬¦ä¸²æˆ–å…¶ä»–æ•°æ®ç±»å‹ä¹‹å‰ï¼Œä½ å¯èƒ½éœ€è¦å…ˆè¿›è¡Œè½¬æ¢ã€‚</p><p>è¯·è®°ä½ï¼Œå¯†ç å­¦æ“ä½œé€šå¸¸æ¶‰åŠå¤æ‚çš„æ¦‚å¿µå’Œç»†èŠ‚ï¼Œå› æ­¤åœ¨å®é™…åº”ç”¨ä¸­éœ€è¦è°¨æ…ä½¿ç”¨ï¼Œå¹¶ç¡®ä¿ç†è§£ç›¸å…³çš„å®‰å…¨å®è·µã€‚ä»¥ä¸Šç¤ºä¾‹ä»…ä¸ºæ¦‚å¿µè¯´æ˜ï¼Œå®é™…åº”ç”¨æ—¶éœ€è¦æ·±å…¥äº†è§£å„ç§å¯†ç å­¦åŸç†å’Œæœ€ä½³å®è·µã€‚</p><h3 id="crypto-timingsafeequal-a-b" tabindex="-1"><a class="header-anchor" href="#crypto-timingsafeequal-a-b"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptotimingsafeequala-b" target="_blank" rel="noopener noreferrer">crypto.timingSafeEqual(a, b)</a></span></a></h3><p><code>crypto.timingSafeEqual(a, b)</code> æ˜¯ Node.js çš„ä¸€ä¸ªå®‰å…¨åŠŸèƒ½ï¼Œç”¨äºæ¯”è¾ƒä¸¤ä¸ªç¼“å†²åŒºï¼ˆBufferï¼‰æˆ–è€…ç±»å‹åŒ–æ•°ç»„ï¼ˆTypedArrayï¼‰ï¼Œå­—ç¬¦ä¸²ç­‰çš„å†…å®¹æ˜¯å¦å®Œå…¨ç›¸ç­‰ï¼Œå¹¶ä¸”åœ¨æ—¶é—´ä¸Šæ˜¯å®‰å…¨çš„ï¼Œè¿™æ„å‘³ç€å¤–éƒ¨è§‚å¯Ÿè€…æ— æ³•é€šè¿‡æµ‹é‡æ¯”è¾ƒæ‰€èŠ±è´¹çš„æ—¶é—´æ¥æ¨æ–­å‡ºå…¶ä¸­ä»»ä½•ä¿¡æ¯ã€‚è¿™ç§æ–¹å¼ç‰¹åˆ«é€‚åˆäºé˜²æ­¢åœ¨çº¿æ”»å‡»ï¼Œå¦‚æ—¶åºæ”»å‡»(Timing Attack)ï¼Œè¿™ç§æ”»å‡»åˆ©ç”¨ä¸åŒè¾“å…¥å¯¼è‡´ç®—æ³•è¿è¡Œæ—¶é—´çš„å¾®å°å·®å¼‚æ¥è·å–ç§å¯†ä¿¡æ¯ã€‚</p><p>ä¸‹é¢é€šè¿‡ä¾‹å­æ¥è§£é‡Š<code>crypto.timingSafeEqual(a, b)</code>çš„ä½¿ç”¨ï¼š</p><h3 id="å®é™…ä¾‹å­-1-æ¯”è¾ƒå¯†ç çš„å“ˆå¸Œå€¼" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-1-æ¯”è¾ƒå¯†ç çš„å“ˆå¸Œå€¼"><span>å®é™…ä¾‹å­ 1ï¼šæ¯”è¾ƒå¯†ç çš„å“ˆå¸Œå€¼</span></a></h3><p>å½“ç”¨æˆ·ç™»å½•ç³»ç»Ÿæ—¶ï¼Œé€šå¸¸ä¼šæœ‰ä¸€ä¸ªå¯†ç éªŒè¯è¿‡ç¨‹ã€‚åœ¨å®‰å…¨çš„ç³»ç»Ÿä¸­ï¼Œå­˜å‚¨çš„å¯†ç æ˜¯å…¶å“ˆå¸Œå€¼ï¼Œè€Œä¸æ˜¯æ˜æ–‡ã€‚åœ¨ç”¨æˆ·è¾“å…¥å¯†ç åï¼Œç³»ç»Ÿä¼šå¯¹å…¶è¿›è¡Œç›¸åŒçš„å“ˆå¸Œå¤„ç†ï¼Œå¹¶éœ€è¦æ¯”è¾ƒè¿™ä¸¤ä¸ªå“ˆå¸Œå€¼æ˜¯å¦ä¸€è‡´ã€‚</p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ª Buffer å¯¹è±¡ï¼Œä¸€ä¸ªåŒ…å«ç”¨æˆ·è¾“å…¥å¯†ç çš„å“ˆå¸Œå€¼ï¼Œä¸€ä¸ªåŒ…å«æ•°æ®åº“ä¸­å­˜å‚¨çš„æ­£ç¡®å¯†ç çš„å“ˆå¸Œå€¼ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä»æ•°æ®åº“ä¸­å–å‡ºçš„æ­£ç¡®å¯†ç çš„å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> correctPasswordHash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ­£ç¡®å¯†ç çš„å“ˆå¸Œå€¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™æ˜¯ç”¨æˆ·å°è¯•ç™»å½•æ—¶è¾“å…¥çš„å¯†ç å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> inputPasswordHash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç”¨æˆ·è¾“å…¥å¯†ç çš„å“ˆå¸Œå€¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">timingSafeEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">correctPasswordHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">inputPasswordHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å¯†ç æ­£ç¡®ï¼Œç™»å½•æˆåŠŸï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å¯†ç é”™è¯¯ï¼Œç™»å½•å¤±è´¥ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨<code>timingSafeEqual</code>ä¿è¯äº†å³ä¾¿æ˜¯å¯†ç é”™è¯¯ï¼Œæ”»å‡»è€…ä¹Ÿæ— æ³•é€šè¿‡æµ‹é‡æ—¶é—´å·®å¼‚æ¥çŒœæµ‹å¯†ç çš„æ­£ç¡®æ€§ã€‚</p><h3 id="å®é™…ä¾‹å­-2-æ¯”è¾ƒä»¤ç‰Œæˆ–è€…å¯†é’¥" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-2-æ¯”è¾ƒä»¤ç‰Œæˆ–è€…å¯†é’¥"><span>å®é™…ä¾‹å­ 2ï¼šæ¯”è¾ƒä»¤ç‰Œæˆ–è€…å¯†é’¥</span></a></h3><p>åœ¨ Web å¼€å‘ä¸­ï¼Œç»å¸¸éœ€è¦æ¯”è¾ƒå®¢æˆ·ç«¯æä¾›çš„ä»¤ç‰Œï¼ˆtokenï¼‰æˆ–è€…å¯†é’¥æ˜¯å¦ä¸æœåŠ¡å™¨ä¿å­˜çš„åŒ¹é…ä»¥éªŒè¯èº«ä»½ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æœåŠ¡å™¨å­˜å‚¨çš„ä»¤ç‰Œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> serverToken</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æœåŠ¡å™¨çš„ä»¤ç‰Œ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®¢æˆ·ç«¯å‘é€çš„ä»¤ç‰Œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> clientToken</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å®¢æˆ·ç«¯çš„ä»¤ç‰Œ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">timingSafeEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">serverToken</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">clientToken</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä»¤ç‰ŒåŒ¹é…ï¼Œèº«ä»½éªŒè¯æˆåŠŸï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä»¤ç‰Œä¸åŒ¹é…ï¼Œèº«ä»½éªŒè¯å¤±è´¥ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŒæ ·åœ°ï¼Œä½¿ç”¨<code>timingSafeEqual</code>å¯ä»¥æé«˜å®‰å…¨æ€§ï¼Œé¿å…æ”»å‡»è€…é€šè¿‡åˆ†ææ¯”è¾ƒæ—¶é—´æ¥è·å–æœ‰æ•ˆçš„ä»¤ç‰Œã€‚</p><p>åœ¨ä½¿ç”¨<code>crypto.timingSafeEqual</code>æ—¶ï¼Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š</p><ul><li>éœ€è¦æ¯”è¾ƒçš„ä¸¤ä¸ªå‚æ•°<code>a</code>å’Œ<code>b</code>å¿…é¡»æ‹¥æœ‰ç›¸åŒçš„é•¿åº¦ã€‚å¦‚æœå®ƒä»¬é•¿åº¦ä¸åŒï¼Œå‡½æ•°ä¼šæŠ›å‡ºé”™è¯¯ã€‚</li><li><code>a</code>å’Œ<code>b</code>å¯ä»¥æ˜¯ Bufferã€TypedArray æˆ– DataViewã€‚</li><li>è¿™ä¸ªå‡½æ•°è®¾è®¡ç”¨äºå¤„ç†æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚å¯†ç æˆ–è€…å¯†é’¥ï¼Œä¸å»ºè®®ç”¨äºæ™®é€šæ•°æ®çš„æ¯”è¾ƒï¼Œå› ä¸ºå¯èƒ½ä¼šå¼•èµ·æ€§èƒ½ä¸Šçš„å¾®å°å½±å“ã€‚</li></ul><p>æ€»ä¹‹ï¼Œ<code>crypto.timingSafeEqual</code>æä¾›äº†ä¸€ç§å®‰å…¨çš„æ–¹æ³•æ¥æ¯”è¾ƒä¸¤ä¸ªæ•°æ®åºåˆ—çš„å†…å®¹ï¼Œä»è€Œé˜²æ­¢äº†æ—¶åºæ”»å‡»çš„é£é™©ï¼Œå¯¹äºå¤„ç†æ•æ„Ÿæ•°æ®éå¸¸å…³é”®ã€‚</p><h3 id="crypto-verify-algorithm-data-key-signature-callback" tabindex="-1"><a class="header-anchor" href="#crypto-verify-algorithm-data-key-signature-callback"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptoverifyalgorithm-data-key-signature-callback" target="_blank" rel="noopener noreferrer">crypto.verify(algorithm, data, key, signature[, callback])</a></span></a></h3><p>å½“ç„¶ï¼Œè®©æˆ‘æ¥è§£é‡Šä¸€ä¸‹ Node.js ä¸­<code>crypto.verify</code>å‡½æ•°çš„åŸºæœ¬ç”¨æ³•ã€‚</p><p>é¦–å…ˆè¦æ˜ç™½<code>crypto</code>æ¨¡å—æ˜¯ Node.js å†…ç½®çš„ä¸€ä¸ªæ¨¡å—ï¼Œå®ƒæä¾›äº†åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯¹æ•°æ®è¿›è¡Œç­¾åå’ŒéªŒè¯ç­¾åç­‰ã€‚åœ¨å®‰å…¨é€šä¿¡æˆ–æ•°æ®ä¿æŠ¤ä¸­ï¼Œç­¾åå’ŒéªŒè¯éå¸¸é‡è¦ï¼Œå®ƒä»¬å¸®åŠ©æˆ‘ä»¬ç¡®è®¤æ•°æ®æ²¡æœ‰è¢«ç¯¡æ”¹ï¼Œå¹¶ä¸”ç¡®å®æ¥è‡ªæ‰€å£°ç§°çš„å‘é€æ–¹ã€‚</p><p>ç°åœ¨æ¥çœ‹å…·ä½“çš„<code>crypto.verify()</code>å‡½æ•°ï¼š</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">verify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">algorithm</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">signature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>algorithm</code> æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»£è¡¨ä½¿ç”¨çš„ç­¾åç®—æ³•ï¼Œæ¯”å¦‚ <code>&#39;RSA-SHA256&#39;</code> æˆ– <code>&#39;ECDSA-SHA512&#39;</code> ç­‰ã€‚</li><li><code>data</code> æ˜¯è¦éªŒè¯çš„æ•°æ®ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€Bufferã€TypedArray æˆ– DataViewã€‚</li><li><code>key</code> æ˜¯å…¬é’¥ï¼Œç”¨äºéªŒè¯ç­¾åã€‚å®ƒå¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€Bufferã€TypedArray æˆ–è€…ä¸€ä¸ªåŒ…å«äº†å¯†é’¥è¯¦æƒ…çš„å¯¹è±¡ã€‚</li><li><code>signature</code> æ˜¯ä¹‹å‰ç”Ÿæˆçš„ç­¾åï¼Œæˆ‘ä»¬éœ€è¦éªŒè¯å®ƒæ˜¯å¦ä¸æ•°æ®åŒ¹é…ã€‚å®ƒé€šå¸¸æ˜¯ Buffer æˆ–å­—ç¬¦ä¸²å½¢å¼ã€‚</li><li><code>callback</code> æ˜¯å¯é€‰çš„å›è°ƒå‡½æ•°ï¼Œå¦‚æœæä¾›ï¼Œå°†ä¼šé‡‡ç”¨å¼‚æ­¥æ–¹å¼è¿›è¡ŒéªŒè¯ï¼›å¦åˆ™å°±æ˜¯åŒæ­¥éªŒè¯ï¼Œå¹¶è¿”å›å¸ƒå°”å€¼ç»“æœã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-6" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-6"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æœ‰ä¸€æ®µé‡è¦ä¿¡æ¯ï¼Œä½ æƒ³é€šè¿‡ç½‘ç»œå‘é€ç»™æŸäººï¼Œå¹¶ä¸”ä½ å¸Œæœ›æ¥æ”¶è€…èƒ½å¤ŸéªŒè¯è¿™äº›æ•°æ®ç¡®å®æ¥è‡ªäºä½ ä¸”æœªè¢«ç¯¡æ”¹ã€‚</p><h4 id="ç”Ÿæˆç­¾å-å‘é€è€…ç«¯" tabindex="-1"><a class="header-anchor" href="#ç”Ÿæˆç­¾å-å‘é€è€…ç«¯"><span>ç”Ÿæˆç­¾åï¼ˆå‘é€è€…ç«¯ï¼‰:</span></a></h4><p>é¦–å…ˆï¼Œå‘é€è€…éœ€è¦ä½¿ç”¨ä»–ä»¬çš„ç§é’¥æ¥åˆ›å»ºæ•°æ®çš„æ•°å­—ç­¾åã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç§é’¥ï¼ˆé€šå¸¸ä¼šå®‰å…¨åœ°å­˜å‚¨ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> privateKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `-----BEGIN PRIVATE KEY-----</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">...</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">-----END PRIVATE KEY-----`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºç­¾å</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createSign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;RSA-SHA256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">signer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;é‡è¦çš„æ¶ˆæ¯&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">signer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆç­¾åï¼ˆä½¿ç”¨ç§é’¥ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> signer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‘é€è€…å°†&quot;é‡è¦çš„æ¶ˆæ¯&quot;å’Œç”Ÿæˆçš„<code>signature</code>ä¸€èµ·å‘é€ç»™æ¥æ”¶è€…ã€‚</p><h4 id="éªŒè¯ç­¾å-æ¥æ”¶è€…ç«¯" tabindex="-1"><a class="header-anchor" href="#éªŒè¯ç­¾å-æ¥æ”¶è€…ç«¯"><span>éªŒè¯ç­¾åï¼ˆæ¥æ”¶è€…ç«¯ï¼‰:</span></a></h4><p>æ¥ä¸‹æ¥ï¼Œæ¥æ”¶è€…ä½¿ç”¨å‘é€è€…çš„å…¬é’¥æ¥éªŒè¯ç­¾åã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;crypto&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å…¬é’¥ï¼ˆå‘é€è€…æä¾›ç»™æ¥æ”¶è€…ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `-----BEGIN PUBLIC KEY-----</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">...</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">-----END PUBLIC KEY-----`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ”¶åˆ°çš„æ•°æ®å’Œç­¾å</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> message</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;é‡è¦çš„æ¶ˆæ¯&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> receivedSignature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> ...</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œåº”è¯¥æ˜¯æ¥æ”¶åˆ°çš„ç­¾åæ•°æ®</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// éªŒè¯ç­¾å</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> verifier</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createVerify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;RSA-SHA256&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">verifier</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">verifier</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨å…¬é’¥éªŒè¯ç­¾åæ˜¯å¦æ­£ç¡®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> isValid</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> verifier</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">verify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">receivedSignature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isValid</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> ?</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;ç­¾åæœ‰æ•ˆï¼Œæ•°æ®æœªè¢«ç¯¡æ”¹&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;ç­¾åæ— æ•ˆæˆ–æ•°æ®è¢«ç¯¡æ”¹&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœ<code>isValid</code>ä¸º<code>true</code>ï¼Œé‚£ä¹ˆæ¥æ”¶è€…å°±å¯ä»¥ç›¸ä¿¡è¿™æ¡æ¶ˆæ¯ç¡®å®æ˜¯å‘é€è€…å‘å‡ºçš„ï¼Œå¹¶ä¸”åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«æ›´æ”¹ã€‚å¦‚æœä¸º<code>false</code>ï¼Œåˆ™æ¶ˆæ¯å¯èƒ½è¢«ç¯¡æ”¹æˆ–ä¸æ˜¯ç”±å£°æ˜çš„å‘é€è€…å‘é€ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯<code>crypto.verify()</code>å‡½æ•°åœ¨ Node.js ä¸­çš„ä¸€ä¸ªç®€å•åº”ç”¨ä¾‹å­ã€‚å½“ä½ åœ¨å®é™…å¼€å‘ä¸­ä½¿ç”¨æ—¶ï¼Œè®°å¾—å§‹ç»ˆä¿æŠ¤å¥½ä½ çš„ç§é’¥ï¼Œå¹¶ä¸”åªå°†å…¬é’¥æä¾›ç»™éœ€è¦éªŒè¯ç­¾åçš„æ–¹ã€‚</p><h3 id="crypto-webcrypto" tabindex="-1"><a class="header-anchor" href="#crypto-webcrypto"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#cryptowebcrypto" target="_blank" rel="noopener noreferrer">crypto.webcrypto</a></span></a></h3><p>å¥½çš„ï¼Œæ¥è°ˆè°ˆ Node.js ä¸­çš„ <code>crypto.webcrypto</code>ã€‚</p><p>Node.js çš„ <code>crypto.webcrypto</code> æ¨¡å—æ˜¯ç”¨æ¥å®ç° Web Cryptography APIï¼ˆWeb åŠ å¯† APIï¼‰çš„ä¸€éƒ¨åˆ†ã€‚è¿™ä¸ª API é€šå¸¸åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ç”¨äºæ‰§è¡Œå„ç§å¯†ç å­¦æ“ä½œï¼Œæ¯”å¦‚åŠ å¯†ã€è§£å¯†ã€ç­¾åå’ŒéªŒè¯æ•°å­—ç­¾åç­‰ã€‚Node.js å®ç°äº†è¿™ä¸ª APIï¼Œä½¿å¾—åœ¨æœåŠ¡å™¨ç«¯ä¹Ÿå¯ä»¥è¿›è¡Œç±»ä¼¼çš„å¯†ç å­¦æ“ä½œã€‚</p><p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ <code>crypto.webcrypto</code> å‘¢ï¼Ÿå› ä¸ºå®ƒæä¾›äº†ä¸€ä¸ªè·Ÿç°ä»£æµè§ˆå™¨ç›¸åŒçš„æ¥å£ï¼Œæ‰€ä»¥å¦‚æœä½ æœ‰ä¸€ä¸ªåŒæ—¶è·‘åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„åº”ç”¨ç¨‹åºï¼Œä½ å¯ä»¥å…±äº«åŒæ ·çš„åŠ å¯†ä»£ç ï¼Œä»è€Œä¿æŒä»£ç çš„ä¸€è‡´æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡å‡ ä¸ªä¾‹å­æ¥è¯´æ˜ <code>crypto.webcrypto</code> æ˜¯æ€æ ·å·¥ä½œçš„ï¼š</p><ol><li><p><strong>ç”Ÿæˆå¯†é’¥</strong>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">subtle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">webcrypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> generateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> subtle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;AES-GCM&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;encrypt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;decrypt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä½¿ç”¨ <code>subtle.generateKey()</code> æ–¹æ³•ç”Ÿæˆäº†ä¸€ä¸ª AES-GCM åŠ å¯†ç®—æ³•æ‰€éœ€çš„å¯†é’¥ã€‚ç”Ÿæˆçš„å¯†é’¥å¯ä»¥ç”¨äºåŠ å¯†å’Œè§£å¯†æ“ä½œã€‚</p></li><li><p><strong>åŠ å¯†æ•°æ®</strong>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> encryptData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">plainText</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encoded</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> TextEncoder</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">encode</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">plainText</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> subtle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">encrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;AES-GCM&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">window</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getRandomValues</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Uint8Array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)), </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// éšæœºåˆå§‹å‘é‡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    encoded</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå°†è¦åŠ å¯†çš„æ–‡æœ¬è½¬æ¢æˆäº†ç¼–ç åçš„å­—èŠ‚æµï¼Œç„¶åè°ƒç”¨äº† <code>subtle.encrypt()</code> æ–¹æ³•è¿›è¡ŒåŠ å¯†ã€‚æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªéšæœºç”Ÿæˆçš„åˆå§‹å‘é‡ (IV)ï¼Œè¿™åœ¨æŸäº›åŠ å¯†æ¨¡å¼ä¸­æ˜¯å¿…éœ€çš„ã€‚</p></li><li><p><strong>è§£å¯†æ•°æ®</strong>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> decryptData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> decrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> subtle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">decrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;AES-GCM&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    encrypted</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> decoded</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> TextDecoder</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">decode</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">decrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> decoded</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è§£å¯†è¿‡ç¨‹ä¸åŠ å¯†ç±»ä¼¼ï¼Œä½†æ˜¯è°ƒç”¨çš„æ˜¯ <code>subtle.decrypt()</code> æ–¹æ³•ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè§£å¯†æ—¶å¿…é¡»ä½¿ç”¨å’ŒåŠ å¯†æ—¶ç›¸åŒçš„å¯†é’¥å’Œåˆå§‹å‘é‡ã€‚</p></li></ol><p>ä»¥ä¸Šä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>crypto.webcrypto</code> æ¥è¿›è¡ŒåŸºæœ¬çš„åŠ å¯†å’Œè§£å¯†æ“ä½œã€‚é‡è¦çš„æ˜¯ï¼Œå½“ä½ åœ¨ç¼–å†™åŠ å¯†ç›¸å…³çš„ä»£ç æ—¶ï¼ŒåŠ¡å¿…è¦éå¸¸å°å¿ƒï¼Œå› ä¸ºé”™è¯¯çš„å®ç°å¯èƒ½ä¼šå¯¼è‡´å®‰å…¨æ¼æ´ã€‚å¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œå»ºè®®åœ¨å®è·µä¹‹å‰æ·±å…¥äº†è§£å¯†ç å­¦çš„åŸºç¡€çŸ¥è¯†ï¼Œç¡®ä¿å®‰å…¨åœ°ä½¿ç”¨è¿™äº›åŠŸèƒ½ã€‚</p><h2 id="notes" tabindex="-1"><a class="header-anchor" href="#notes"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#notes" target="_blank" rel="noopener noreferrer">Notes</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚Node.js åŒ…å«äº†ä¸€å¥—å†…ç½®æ¨¡å—ï¼Œè€Œ <code>crypto</code> æ¨¡å—å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œç”¨äºå¤„ç†åŠ å¯†åŠŸèƒ½ï¼Œå¦‚åˆ›å»ºå“ˆå¸Œã€HMACã€åŠ è§£å¯†æ•°æ®ã€å¤„ç†è¯ä¹¦ç­‰ã€‚</p><p>åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œå…³äº <code>crypto</code> æ¨¡å—çš„ &quot;Notes&quot; éƒ¨åˆ†é€šå¸¸åŒ…å«äº†ä¸€äº›ä½¿ç”¨è¯¥æ¨¡å—æ—¶éœ€è¦æ³¨æ„çš„äº‹é¡¹ã€‚è¿™äº›æ³¨æ„äº‹é¡¹æœ‰å¯èƒ½ä¼šéšç€ç‰ˆæœ¬æ›´æ–°è€Œå˜åŒ–ï¼Œå› æ­¤ä»¥ä¸‹å†…å®¹ä»¥ Node.js v21.7.1 ç‰ˆæœ¬ä¸ºå‚è€ƒï¼š</p><h3 id="_1-å¯†é’¥å’Œè¯ä¹¦ç¼–ç " tabindex="-1"><a class="header-anchor" href="#_1-å¯†é’¥å’Œè¯ä¹¦ç¼–ç "><span>1. å¯†é’¥å’Œè¯ä¹¦ç¼–ç ï¼š</span></a></h3><p>åœ¨ <code>crypto</code> æ¨¡å—ä¸­ï¼Œå¯†é’¥å’Œè¯ä¹¦é€šå¸¸å¯ä»¥ä»¥å¤šç§æ ¼å¼è¿›è¡Œç¼–ç å’Œè¡¨ç¤ºï¼Œä¾‹å¦‚ PEMï¼ˆPrivacy-Enhanced Mailï¼‰æˆ– DERï¼ˆDistinguished Encoding Rulesï¼‰ã€‚PEM æ ¼å¼çš„æ–‡ä»¶é€šå¸¸ä»¥ <code>-----BEGIN CERTIFICATE-----</code> å’Œ <code>-----END CERTIFICATE-----</code> å¼€å§‹å’Œç»“æŸï¼Œè€Œ DER æ ¼å¼åˆ™æ˜¯äºŒè¿›åˆ¶å½¢å¼ã€‚äº†è§£æ‚¨æ­£åœ¨ä½¿ç”¨çš„å¯†é’¥æˆ–è¯ä¹¦çš„ç¼–ç æ ¼å¼éå¸¸é‡è¦ï¼Œå› ä¸ºæ‚¨éœ€è¦ç¡®ä¿åœ¨ä½¿ç”¨ <code>crypto</code> API æ—¶æ­£ç¡®æŒ‡å®šã€‚</p><h3 id="_2-çº¿ç¨‹å®‰å…¨æ€§" tabindex="-1"><a class="header-anchor" href="#_2-çº¿ç¨‹å®‰å…¨æ€§"><span>2. çº¿ç¨‹å®‰å…¨æ€§ï¼š</span></a></h3><p>Node.js ä¸­çš„ <code>crypto</code> æ¨¡å—è®¾è®¡å¾—å°½å¯èƒ½çº¿ç¨‹å®‰å…¨ã€‚ç„¶è€Œï¼Œåœ¨ä¸€äº›ç‰¹å®šæƒ…å†µä¸‹ï¼Œæ¯”å¦‚ä½¿ç”¨ OpenSSL çš„å¼•æ“æ¥å£æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚åœ¨ä½¿ç”¨è¿™äº›å…·ä½“åŠŸèƒ½æ—¶ï¼Œç”¨æˆ·éœ€è¦ç•™æ„æ–‡æ¡£ä¸­çš„çº¿ç¨‹å®‰å…¨è­¦å‘Šã€‚</p><h3 id="_3-åŠ å¯†ç®—æ³•çš„é€‰æ‹©" tabindex="-1"><a class="header-anchor" href="#_3-åŠ å¯†ç®—æ³•çš„é€‰æ‹©"><span>3. åŠ å¯†ç®—æ³•çš„é€‰æ‹©ï¼š</span></a></h3><p>ä¸åŒçš„åŠ å¯†ç®—æ³•å’Œå“ˆå¸Œå‡½æ•°æœ‰ä¸åŒçš„å®‰å…¨æ€§å’Œæ€§èƒ½ç‰¹ç‚¹ã€‚ä¾‹å¦‚ï¼ŒSHA-1 å“ˆå¸Œå‡½æ•°ç”±äºå·²çŸ¥çš„å¼±ç‚¹ï¼Œä¸å†å»ºè®®ç”¨äºå®‰å…¨æ•æ„Ÿçš„åº”ç”¨ã€‚å¯¹äºåŠ å¯†ï¼ŒAES-256 æ¯” AES-128 æä¾›äº†æ›´é«˜çº§åˆ«çš„å®‰å…¨æ€§ï¼Œä½†åŒæ—¶ä¹Ÿå¯èƒ½ä¼šæœ‰ç¨å¾®é™ä½çš„æ€§èƒ½ã€‚åœ¨é€‰æ‹©ä½¿ç”¨å“ªä¸ªåŠ å¯†ç®—æ³•æ—¶ï¼Œåº”è¯¥æ ¹æ®åº”ç”¨åœºæ™¯å’Œå®‰å…¨éœ€æ±‚åšå‡ºåˆç†é€‰æ‹©ã€‚</p><h3 id="å®é™…ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-3"><span>å®é™…ä¾‹å­ï¼š</span></a></h3><h4 id="ç”Ÿæˆå“ˆå¸Œ" tabindex="-1"><a class="header-anchor" href="#ç”Ÿæˆå“ˆå¸Œ"><span>ç”Ÿæˆå“ˆå¸Œï¼š</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ª SHA-256 çš„å“ˆå¸Œå®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ›´æ–°æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;some data to hash&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºåå…­è¿›åˆ¶æ ¼å¼çš„å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä½¿ç”¨-aes-å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-aes-å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†"><span>ä½¿ç”¨ AES å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼š</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯†é’¥åº”è¯¥æ˜¯éšæœºçš„, åœ¨å®é™…ä½¿ç”¨ä¸­éœ€è¦è¿›è¡Œå®‰å…¨å­˜å‚¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»º cipher å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-256-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;some data to encrypt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä½¿ç”¨-rsa-è¿›è¡Œéå¯¹ç§°åŠ å¯†" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-rsa-è¿›è¡Œéå¯¹ç§°åŠ å¯†"><span>ä½¿ç”¨ RSA è¿›è¡Œéå¯¹ç§°åŠ å¯†ï¼š</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">  generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">  publicEncrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">  privateDecrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆ RSA å¯†é’¥å¯¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;secret data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨å…¬é’¥åŠ å¯†æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encryptedData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> publicEncrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ç§é’¥è§£å¯†æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> decryptedData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> privateDecrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encryptedData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">decryptedData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·è®°ä½ï¼Œä»¥ä¸Šä»£ç ä»…ä½œä¸ºæ¼”ç¤ºç”¨é€”ï¼Œå®é™…åº”ç”¨ä¸­çš„åŠ å¯†æ“ä½œéœ€è¦æ›´å¤æ‚çš„å®‰å…¨æªæ–½ï¼Œæ¯”å¦‚å¯†é’¥ç®¡ç†ã€é”™è¯¯å¤„ç†ã€åè®®è®¾è®¡ç­‰ã€‚è€Œä¸”ï¼Œæœ€å¥½çš„åšæ³•æ˜¯å§‹ç»ˆè·Ÿè¸ªæœ€æ–°çš„ Node.js æ–‡æ¡£å’Œå®‰å…¨å»ºè®®ï¼Œå› ä¸ºåŠ å¯†æŠ€æœ¯å’Œå®‰å…¨æ ‡å‡†ä¼šä¸æ–­è¿›åŒ–ã€‚</p><h3 id="using-strings-as-inputs-to-cryptographic-apis" tabindex="-1"><a class="header-anchor" href="#using-strings-as-inputs-to-cryptographic-apis"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#using-strings-as-inputs-to-cryptographic-apis" target="_blank" rel="noopener noreferrer">Using strings as inputs to cryptographic APIs</a></span></a></h3><p>Node.js çš„ <code>crypto</code> æ¨¡å—æä¾›äº†ä¸€ç³»åˆ—çš„åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ•£åˆ—ã€HMACã€å¯†ç å­¦ç­¾åå’ŒåŠ è§£å¯†ç­‰ã€‚åœ¨ä¼ ç»Ÿä¸Šï¼Œè¿™äº› APIs é€šå¸¸æ¥å—å­—ç¬¦ä¸²ä½œä¸ºè¾“å…¥ï¼Œä½†æ˜¯è¿™ç§åšæ³•å¯èƒ½ä¼šå¸¦æ¥ä¸€äº›é—®é¢˜ï¼Œå°¤å…¶æ˜¯æ¶‰åŠåˆ°ç¼–ç é—®é¢˜ã€‚</p><p>å½“ä½ ä½¿ç”¨å­—ç¬¦ä¸²ä½œä¸ºè¾“å…¥ç»™åŠ å¯† API æ—¶ï¼ŒNode.js éœ€è¦çŸ¥é“å¦‚ä½•å°†è¿™ä¸ªå­—ç¬¦ä¸²è½¬æ¢æˆå­—èŠ‚åºåˆ—ï¼ˆå› ä¸ºåŠ å¯†æ“ä½œæ˜¯åœ¨å­—èŠ‚çº§åˆ«è¿›è¡Œçš„ï¼‰ã€‚ä¸åŒçš„å­—ç¬¦é›†å’Œç¼–ç å¯èƒ½ä¼šå¯¼è‡´ä¸åŒçš„å­—èŠ‚è¡¨ç¤ºï¼Œè¿™å°±æ„å‘³ç€å¦‚æœæ²¡æœ‰æ­£ç¡®å¤„ç†ç¼–ç ï¼Œç›¸åŒçš„æ–‡æœ¬åœ¨ä¸åŒç¯å¢ƒä¸‹å¯èƒ½äº§ç”Ÿä¸åŒçš„åŠ å¯†ç»“æœã€‚</p><p>ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªç®€å•çš„æ•£åˆ—æ“ä½œï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æƒ³å¯¹å­—ç¬¦ä¸² &#39;Hello&#39; è¿›è¡Œæ•£åˆ—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå­—ç¬¦ä¸² <code>&#39;Hello&#39;</code> è¢«ç”¨ä½œè¾“å…¥è¿›è¡Œæ•£åˆ—ï¼ŒNode.js é»˜è®¤å°†å­—ç¬¦ä¸²è§†ä¸º UTF-8 ç¼–ç ã€‚ç„¶è€Œï¼Œå¦‚æœæ“ä½œçš„å­—ç¬¦ä¸²åŒ…å«ç‰¹æ®Šå­—ç¬¦æˆ–è€…é ASCII å­—ç¬¦ï¼Œåˆ™å¿…é¡»æ˜ç¡®æŒ‡å®šç¼–ç æ–¹å¼ï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°é¢„æ–™ä¹‹å¤–çš„ç»“æœã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨ Node.js v21.7.1 å¼€å§‹ï¼Œæ–‡æ¡£æ›´åŠ å¼ºè°ƒäº†åœ¨ä½¿ç”¨åŠ å¯† API æ—¶åº”è¯¥ä¼˜å…ˆä½¿ç”¨ <code>Buffer</code> æˆ– <code>TypedArray</code> å¯¹è±¡ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ”¹è¿›çš„ä¾‹å­ï¼Œä½¿ç”¨ <code>Buffer</code> æ¥ç¡®ä¿æ•°æ®è¢«æ­£ç¡®åœ°å¤„ç†ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªBufferå®ä¾‹æ¥å­˜å‚¨å­—ç¬¦ä¸² &#39;Hello&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf-8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ˜ç¡®æŒ‡å®šç¼–ç ä¸ºUTF-8</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨Bufferä½œä¸ºè¾“å…¥è¿›è¡Œæ•£åˆ—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä½¿ç”¨ <code>Buffer.from()</code> æ–¹æ³•ï¼Œå¹¶æ˜¾å¼æŒ‡å®š <code>&#39;utf-8&#39;</code> ç¼–ç ï¼Œæˆ‘ä»¬ç¡®ä¿äº†æ— è®ºç¯å¢ƒå¦‚ä½•ï¼Œå­—ç¬¦ä¸²éƒ½ä¼šä»¥é¢„æœŸçš„æ–¹å¼è¢«è½¬æ¢æˆå­—èŠ‚åºåˆ—ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œä» Node.js v21.7.1 å¼€å§‹ï¼Œå®˜æ–¹æ–‡æ¡£å»ºè®®ï¼š</p><ul><li>å°½é‡é¿å…ç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²ä½œä¸ºåŠ å¯† API çš„è¾“å…¥ã€‚</li><li>ä½¿ç”¨ <code>Buffer</code> æˆ– <code>TypedArray</code> ç±»å‹æ¥ä»£æ›¿å­—ç¬¦ä¸²ï¼Œè¿™æ ·å¯ä»¥æ›´ç²¾ç¡®åœ°æ§åˆ¶æ•°æ®çš„ç¼–ç å’Œè¡¨ç¤ºã€‚</li><li>å¦‚æœéè¦ä½¿ç”¨å­—ç¬¦ä¸²ï¼Œç¡®ä¿ä½ çŸ¥é“å®ƒçš„ç¼–ç ï¼Œå¹¶ä¸”åœ¨ API è°ƒç”¨ä¸­æ˜ç¡®æŒ‡å®šã€‚</li></ul><p>è¿™æ ·å¯ä»¥é™ä½ç¼–ç é—®é¢˜å¸¦æ¥çš„å®‰å…¨é£é™©ï¼Œå¹¶ä¿è¯ä»£ç çš„å¯ç§»æ¤æ€§å’Œç¨³å¥æ€§ã€‚</p><h3 id="legacy-streams-api-prior-to-node-js-0-10" tabindex="-1"><a class="header-anchor" href="#legacy-streams-api-prior-to-node-js-0-10"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#legacy-streams-api-prior-to-nodejs-010" target="_blank" rel="noopener noreferrer">Legacy streams API (prior to Node.js 0.10)</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“è¿è¡Œçš„ JavaScript ç¯å¢ƒï¼Œå®ƒä½¿å¾—å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œæµï¼ˆStreamsï¼‰æ˜¯å¤„ç†å¤§é‡æ•°æ®çš„ä¸€ç§æœºåˆ¶ï¼Œæ¯”å¦‚æ–‡ä»¶è¯»å†™ã€ç½‘ç»œé€šä¿¡ç­‰ï¼Œè€Œä¸å¿…ä¸€æ¬¡æ€§æŠŠæ•°æ®å…¨éƒ¨åŠ è½½åˆ°å†…å­˜ä¸­ã€‚</p><p>åœ¨ Node.js v0.10 ä¹‹å‰çš„ç‰ˆæœ¬ï¼ˆå³æ‰€è°“çš„ &quot;Legacy&quot; æˆ– &quot;é—ç•™&quot; ç‰ˆæœ¬ï¼‰ï¼Œæµ API å’Œç°åœ¨çš„æµ API æœ‰å¾ˆå¤§çš„ä¸åŒã€‚è¿™ä¸ªé—ç•™çš„æµ API åŒ…æ‹¬äº†æ—©æœŸçš„å®ç°æ–¹å¼ï¼Œå¯èƒ½ä¸å¤ªé«˜æ•ˆï¼Œä¹Ÿä¸æ˜“äºç†è§£å’Œä½¿ç”¨ã€‚è‡ª Node.js v0.10 èµ·ï¼Œæµ API ç»è¿‡äº†é‡å¤§æ”¹è¿›ï¼Œå¼•å…¥äº†æ›´ä¸ºå¼ºå¤§å’Œçµæ´»çš„æ¥å£ï¼Œæ¯”å¦‚æµç°åœ¨åˆ†ä¸ºå››ç§ç±»å‹ï¼šå¯è¯»æµï¼ˆReadableï¼‰ã€å¯å†™æµï¼ˆWritableï¼‰ã€è½¬æ¢æµï¼ˆTransformï¼‰å’ŒåŒå·¥æµï¼ˆDuplexï¼‰ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯æµ-streams" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯æµ-streams"><span>ä»€ä¹ˆæ˜¯æµï¼ˆStreamsï¼‰ï¼Ÿ</span></a></h3><p>æµæ˜¯ä¸€ç³»åˆ—æ•°æ®çš„é›†åˆï¼Œå°±åƒæ°´æµä¸€æ ·ï¼Œæ•°æ®åƒæ°´ä¸€æ ·ä»ä¸€ä¸ªåœ°æ–¹â€œæµåŠ¨â€åˆ°å¦ä¸€ä¸ªåœ°æ–¹ã€‚å®ƒä»¬å¯ä»¥å¸®åŠ©ä½ æœ‰æ•ˆåœ°å¤„ç†å¤§é‡æ•°æ®ï¼Œå› ä¸ºä½ ä¸éœ€è¦ä¸€æ¬¡å°†æ‰€æœ‰æ•°æ®éƒ½åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè€Œæ˜¯å¯ä»¥é€å—å¤„ç†ã€‚</p><h3 id="node-js-ä¸­é—ç•™æµ-api-çš„é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#node-js-ä¸­é—ç•™æµ-api-çš„é—®é¢˜"><span>Node.js ä¸­é—ç•™æµ API çš„é—®é¢˜</span></a></h3><ul><li><strong>ä¸åŒæµä¹‹é—´æ¥å£ä¸ä¸€è‡´</strong>ï¼šæ—©æœŸ Node.js ç‰ˆæœ¬ä¸­çš„æµ API ç¼ºä¹ç»Ÿä¸€çš„æ¥å£æ ‡å‡†ï¼Œä½¿å¾—ä¸åŒç±»å‹çš„æµä¹‹é—´è¡Œä¸ºå·®å¼‚è¾ƒå¤§ã€‚</li><li><strong>éš¾ä»¥ç®¡ç†çš„é”™è¯¯å¤„ç†</strong>ï¼šé”™è¯¯å¤„ç†å˜å¾—å¤æ‚ï¼Œå› ä¸ºä½ éœ€è¦ä¸ºæµçš„æ¯ä¸ªéƒ¨åˆ†æ­£ç¡®åœ°æ·»åŠ é”™è¯¯å¤„ç†ä»£ç ã€‚</li><li><strong>ç¼ºå°‘æµæ§åˆ¶ç‰¹æ€§</strong>ï¼šä¾‹å¦‚ï¼Œæ²¡æœ‰ç®€å•çš„æ–¹æ³•æ¥æš‚åœå’Œæ¢å¤æµçš„å¤„ç†ï¼Œè¿™åœ¨å¤„ç†é€Ÿåº¦ä¸åŒ¹é…çš„æµæ—¶éå¸¸æœ‰ç”¨ï¼ˆæ¯”å¦‚ä¸€ä¸ªå¿«é€Ÿçš„ç”Ÿäº§è€…å’Œä¸€ä¸ªæ…¢é€Ÿçš„æ¶ˆè´¹è€…ï¼‰ã€‚</li></ul><h3 id="node-js-æµçš„å®é™…è¿ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#node-js-æµçš„å®é™…è¿ç”¨ä¾‹å­"><span>Node.js æµçš„å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><strong>æ–‡ä»¶è¯»å–</strong>ï¼šå½“ä½ éœ€è¦è¯»å–ä¸€ä¸ªå¤§æ–‡ä»¶æ—¶ï¼Œä½¿ç”¨æµå¯ä»¥é€å—è¯»å–æ–‡ä»¶å†…å®¹ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§å°†æ•´ä¸ªæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ã€‚è¿™å¯ä»¥å‡å°‘åº”ç”¨ç¨‹åºçš„å†…å­˜å ç”¨ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºå¯è¯»æµ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> readerStream</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createReadStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;input.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®ç¼–ç ä¸º utf8ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">readerStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setEncoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;UTF8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¤„ç†æµäº‹ä»¶ --&gt; data, end, and error</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">readerStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">readerStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">readerStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">stack</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç¨‹åºæ‰§è¡Œå®Œæ¯•&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>ç½‘ç»œè¯·æ±‚</strong>ï¼šå½“ä½ å‘æœåŠ¡å™¨å‘é€è¯·æ±‚å¹¶æ¥æ”¶å“åº”æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æµé€æ­¥å¤„ç†æ¯ä¸ªæ•°æ®åŒ…ï¼Œè€Œæ— éœ€ç­‰å¾…æ•´ä¸ªå“åº”è½½å…¥ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‘èµ· GET è¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">http</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">resp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ¥æ”¶æ•°æ®ç‰‡æ®µå¹¶å°†å…¶ä¸²è”åˆ°å­—ç¬¦ä¸²ä¸­</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    resp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ•´ä¸ªå“åº”ä½“å·²è¢«æ¥æ”¶ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    resp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Error: &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>æ•°æ®è½¬æ¢</strong>ï¼šå¦‚æœä½ æƒ³è¦åœ¨æ•°æ®è¢«æœ€ç»ˆå†™å…¥æˆ–è¯»å‡ºå‰ä¿®æ”¹å®ƒï¼Œå¯ä»¥ä½¿ç”¨è½¬æ¢æµã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªå‹ç¼©æµæ¥å‹ç¼©æ•°æ®ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> zlib</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;zlib&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‹ç¼© input.txt æ–‡ä»¶ä¸º input.txt.gz</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createReadStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;input.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">pipe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">zlib</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createGzip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">pipe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createWriteStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;input.txt.gz&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ–‡ä»¶å‹ç¼©å®Œæˆã€‚&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ€»çš„æ¥è¯´ï¼Œå³ä½¿ Node.js çš„æ—©æœŸç‰ˆæœ¬æä¾›äº†ä¸€äº›æµçš„åŸºç¡€åŠŸèƒ½ï¼Œä½†è¿™äº›é—ç•™çš„ API åœ¨è®¾è®¡ä¸Šä¸ç°ä»£çš„æµ API ç›¸æ¯”å­˜åœ¨è®¸å¤šé™åˆ¶ã€‚ä» Node.js v0.10 å¼€å§‹ï¼Œæµ API å˜å¾—æ›´åŠ ä¸€è‡´å’Œå¼ºå¤§ï¼Œæå¤§åœ°æå‡äº†æ•°æ®å¤„ç†çš„æ•ˆç‡å’Œä¾¿åˆ©æ€§ã€‚</p><h3 id="support-for-weak-or-compromised-algorithms" tabindex="-1"><a class="header-anchor" href="#support-for-weak-or-compromised-algorithms"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#support-for-weak-or-compromised-algorithms" target="_blank" rel="noopener noreferrer">Support for weak or compromised algorithms</a></span></a></h3><p>åœ¨è§£é‡Š Node.js v21.7.1 ä¸­å…³äºå¼±æˆ–å—æŸç®—æ³•çš„æ”¯æŒä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯åŠ å¯†ç®—æ³•ä»¥åŠä¸ºä»€ä¹ˆç®—æ³•çš„å¼ºåº¦å¾ˆé‡è¦ã€‚</p><p>åŠ å¯†ç®—æ³•æ˜¯ç”¨äºä¿æŠ¤ä¿¡æ¯å®‰å…¨çš„æ•°å­¦ç¨‹åºå’ŒæŠ€æœ¯ã€‚å®ƒä»¬å¯ä»¥ä¿æŠ¤æˆ‘ä»¬çš„æ•°æ®å…å—æœªç»æˆæƒçš„è®¿é—®å’Œç¯¡æ”¹ã€‚è¿™äº›ç®—æ³•æœ‰ä¸åŒçš„ç±»å‹ï¼ŒåŒ…æ‹¬å¯¹ç§°åŠ å¯†ï¼ˆå¦‚ AESï¼‰ï¼Œéå¯¹ç§°åŠ å¯†ï¼ˆå¦‚ RSAï¼‰ï¼Œå“ˆå¸Œå‡½æ•°ï¼ˆå¦‚ SHA-256ï¼‰ç­‰ã€‚</p><p>éšç€æ—¶é—´çš„æ¨ç§»å’Œè®¡ç®—èƒ½åŠ›çš„æé«˜ï¼ŒæŸäº›æ›¾ç»è¢«è®¤ä¸ºæ˜¯å®‰å…¨çš„åŠ å¯†ç®—æ³•ç°åœ¨å¯èƒ½è¢«è®¤ä¸ºæ˜¯è„†å¼±æˆ–å·²ç»å—åˆ°æŸå®³ã€‚ä¾‹å¦‚ï¼Œè¾ƒæ—§çš„åŠ å¯†æ ‡å‡†å¦‚ DES å’Œ RC4 ç”±äºå„ç§åŸå› ç°åœ¨è¢«è®¤ä¸ºæ˜¯ä¸å®‰å…¨çš„ï¼š</p><ol><li>å¯†é’¥é•¿åº¦çŸ­ï¼šåƒ DES è¿™æ ·çš„è€å¼ç®—æ³•ä½¿ç”¨çš„å¯†é’¥é•¿åº¦è¾ƒçŸ­ï¼Œç°ä»£è®¡ç®—æœºå¯ä»¥åœ¨å¯æ¥å—çš„æ—¶é—´å†…ç ´è§£å®ƒä»¬ã€‚</li><li>å·²çŸ¥æ¼æ´ï¼šç®—æ³•è®¾è®¡ä¸Šçš„ç¼ºé™·å¯èƒ½è¢«å‘ç°ï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥æ¯”é¢„æœŸçš„æ›´å¿«åœ°ç ´è§£åŠ å¯†ã€‚</li></ol><p>å› æ­¤ï¼Œä¸€ä¸ªé‡è¦çš„å®‰å…¨å®è·µæ˜¯é¿å…ä½¿ç”¨è¿™äº›è¢«è®¤ä¸ºæ˜¯å¼±æˆ–å·²å—æŸçš„åŠ å¯†ç®—æ³•ï¼Œå¹¶ä¸”è¦ç¡®ä¿ä½ çš„åº”ç”¨ç¨‹åºä½¿ç”¨æœ€æ–°ã€æœ€å®‰å…¨çš„ç®—æ³•ã€‚</p><p>åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œ&quot;Support for weak or compromised algorithms&quot; æŒ‡çš„æ˜¯ Node.js çš„ <code>crypto</code> æ¨¡å—ä¸­å¯¹é‚£äº›è¢«è®¤ä¸ºå¼±æˆ–å·²è¢«ç ´è§£çš„åŠ å¯†ç®—æ³•çš„å¤„ç†ã€‚å…·ä½“æ¥è¯´ï¼ŒNode.js å°†ä¸æ¨èä½¿ç”¨è¿™äº›ç®—æ³•ï¼Œå¹¶å¯èƒ½åœ¨å°†æ¥çš„ç‰ˆæœ¬ä¸­å®Œå…¨ç§»é™¤å®ƒä»¬ã€‚è¿™æ„å‘³ç€å¼€å‘äººå‘˜åœ¨ä½¿ç”¨ Node.js çš„ <code>crypto</code> æ¨¡å—è¿›è¡ŒåŠ å¯†æ“ä½œæ—¶ï¼Œåº”è¯¥é€‰æ‹©é‚£äº›è¢«å¹¿æ³›è®¤ä¸ºæ˜¯å®‰å…¨çš„ç®—æ³•ã€‚</p><h3 id="å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹"><span>å®ä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œéœ€è¦å­˜å‚¨ç”¨æˆ·å¯†ç ã€‚åœ¨è¿‡å»ï¼Œä½ å¯èƒ½ä¼šè€ƒè™‘ä½¿ç”¨ MD5 å“ˆå¸Œç®—æ³•æ¥å­˜å‚¨å¯†ç çš„å“ˆå¸Œå€¼ã€‚ä½†æ˜¯ï¼Œç”±äº MD5 å·²çŸ¥å­˜åœ¨å¤šä¸ªæ¼æ´ï¼Œå¹¶ä¸”å®¹æ˜“å—åˆ°å½©è™¹è¡¨æ”»å‡»ï¼Œæ‰€ä»¥å®ƒè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå¼±ç®—æ³•ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œè¯´æ˜äº†å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨ç°ä»£ç®—æ³•ï¼ˆå¦‚ SHA-256ï¼‰æ›¿æ¢ MD5ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¸å®‰å…¨çš„æ–¹å¼ï¼šä½¿ç”¨ MD5</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> hashPasswordMD5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;md5&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å®‰å…¨çš„æ–¹å¼ï¼šä½¿ç”¨ SHA-256</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> hashPasswordSHA256</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> userPassword</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;mySecurePassword123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> insecureHashedPassword</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> hashPasswordMD5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">userPassword</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> secureHashedPassword</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> hashPasswordSHA256</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">userPassword</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Insecure MD5 Hash:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">insecureHashedPassword</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Secure SHA-256 Hash:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">secureHashedPassword</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Node.js çš„ <code>crypto</code> æ¨¡å—åˆ›å»ºä¸€ä¸ªå¯†ç çš„å“ˆå¸Œã€‚ç¬¬ä¸€ä¸ªå‡½æ•° <code>hashPasswordMD5</code> ä½¿ç”¨äº†ä¸å®‰å…¨çš„ MD5 ç®—æ³•ï¼Œè€Œç¬¬äºŒä¸ªå‡½æ•° <code>hashPasswordSHA256</code> ä½¿ç”¨äº†æ›´å®‰å…¨çš„ SHA-256 ç®—æ³•ã€‚</p><p>æ€»ä¹‹ï¼Œåœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­æåˆ°çš„æ”¯æŒå¼±æˆ–å—æŸç®—æ³•ä¸»è¦æ˜¯æŒ‡åœ¨ <code>crypto</code> æ¨¡å—ä¸­å¼ƒç”¨è¿™äº›ç®—æ³•ï¼Œå¹¶é¼“åŠ±å¼€å‘äººå‘˜ä½¿ç”¨å½“å‰è®¤ä¸ºæ›´å®‰å…¨çš„ç®—æ³•æ¥ç»´æŠ¤ä»–ä»¬åº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§ã€‚</p><h3 id="ccm-mode" tabindex="-1"><a class="header-anchor" href="#ccm-mode"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#ccm-mode" target="_blank" rel="noopener noreferrer">CCM mode</a></span></a></h3><p>Node.js ä¸­çš„ CCMï¼ˆCounter with CBC-MACï¼‰æ¨¡å¼æ˜¯ä¸€ç§åŠ å¯†æŠ€æœ¯ï¼Œå®ƒç»“åˆäº†è®¡æ•°å™¨æ¨¡å¼ï¼ˆCTRï¼‰å’Œ CBC-MACã€‚åœ¨è§£é‡Šè¿™ä¸ªæ¦‚å¿µä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£å‡ ä¸ªå…³é”®ç‚¹ï¼š</p><ol><li><p><strong>å¯¹ç§°åŠ å¯†</strong>ï¼šè¿™æ˜¯ä¸€ç§åŠ å¯†æŠ€æœ¯ï¼Œåœ¨è¿™ç§æŠ€æœ¯ä¸­ï¼ŒåŠ å¯†å’Œè§£å¯†ä¿¡æ¯ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ã€‚è¿™æ„å‘³ç€å‘é€è€…å’Œæ¥æ”¶è€…éƒ½å¿…é¡»ä»¥å®‰å…¨çš„æ–¹å¼å…±äº«è¿™ä¸ªå¯†é’¥ã€‚</p></li><li><p><strong>è®¡æ•°å™¨æ¨¡å¼ï¼ˆCTRï¼‰</strong>ï¼šè¿™æ˜¯å¯¹ç§°åŠ å¯†çš„ä¸€ç§æ¨¡å¼ï¼Œå…¶ä¸­æ¯ä¸ªæ•°æ®å—éƒ½ä¸ä¸€ä¸ªé€’å¢çš„è®¡æ•°å™¨è¿›è¡Œç»„åˆï¼Œå¹¶ä¸”è¿™ä¸ªç»„åˆç»“æœç”¨æ¥ä¸æ•°æ®å—è¿›è¡ŒåŠ å¯†ã€‚</p></li><li><p><strong>CBC-MACï¼ˆCipher Block Chaining Message Authentication Codeï¼‰</strong>ï¼šè¿™æ˜¯ä¸€ç§éªŒè¯æ•°æ®å®Œæ•´æ€§çš„æŠ€æœ¯ï¼Œç¡®ä¿æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚</p></li></ol><p>ç»“åˆ CTR å’Œ CBC-MACï¼ŒCCM æ¨¡å¼èƒ½å¤ŸåŒæ—¶æä¾›æ•°æ®çš„éšç§æ€§ï¼ˆé€šè¿‡åŠ å¯†ï¼‰å’Œå®Œæ•´æ€§ï¼ˆé€šè¿‡ MAC æ ¡éªŒï¼‰ã€‚åœ¨ Node.js ä¸­ï¼ŒCCM æ¨¡å¼ä¸»è¦åº”ç”¨äº<code>crypto</code>æ¨¡å—ï¼Œå¯ä»¥ç”¨äºç½‘ç»œé€šè®¯ã€æ–‡ä»¶åŠ å¯†ç­‰åœºåˆï¼Œæ¥ç¡®ä¿æ•°æ®çš„å®‰å…¨ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-5"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªèŠå¤©åº”ç”¨ï¼Œä½ éœ€è¦ç¡®ä¿å‘é€çš„æ¶ˆæ¯æ—¢æ˜¯æœºå¯†çš„ï¼Œä¹Ÿæœªè¢«ç¯¡æ”¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç”Ÿæˆéšæœºçš„å¯†é’¥å’Œåˆå§‹åŒ–å‘é‡(IV)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯¹äºAESï¼Œå¯†é’¥å¯èƒ½æ˜¯16, 24æˆ–32å­—èŠ‚ã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> nonce</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// CCMæ¨¡å¼ä¸‹çš„IVé€šå¸¸å«ä½œnonceï¼Œé•¿åº¦ä¸º12å­—èŠ‚ã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-128-ccm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">nonce</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  authTagLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®è®¤è¯æ ‡ç­¾çš„é•¿åº¦ï¼Œå†³å®šäº†MACçš„å¤§å°ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setAAD</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  plaintextLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">byteLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;world&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;readable&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  while</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">null</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> !==</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">chunk</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">read</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">())) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ‰“å°å‡ºè®¤è¯æ ‡ç­¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getAuthTag</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŠ å¯†æ¶ˆæ¯â€œworldâ€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;world&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è§£å¯†è¿‡ç¨‹...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥äº† Node.js çš„<code>crypto</code>æ¨¡å—ï¼Œç„¶ååˆ›å»ºäº†ä¸€ä¸ªå¯†é’¥å’Œä¸€ä¸ª nonceï¼ˆåˆå§‹åŒ–å‘é‡ï¼‰ã€‚æ¥ç€ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªä½¿ç”¨ AES-128-CCM ç®—æ³•çš„ cipher å¯¹è±¡ã€‚è®¾ç½®äº†é¢å¤–çš„è®¤è¯æ•°æ®(AAD)ä¸º&#39;hello&#39;ï¼Œå…¶ç›®çš„æ˜¯å°†ä¸€äº›ä¸éœ€è¦åŠ å¯†ä½†éœ€è¦è¿›è¡Œå®Œæ•´æ€§æ£€æŸ¥çš„æ•°æ®åŒ…å«åœ¨å†…ã€‚ç„¶åæˆ‘ä»¬ç›‘å¬<code>readable</code>äº‹ä»¶æ¥è¯»å–åŠ å¯†æ•°æ®ï¼Œå¹¶åœ¨æœ€ç»ˆé€šè¿‡<code>end</code>äº‹ä»¶è¾“å‡ºåŠ å¯†å­—ç¬¦ä¸²å’Œè®¤è¯æ ‡ç­¾ã€‚</p><p>æ³¨æ„ï¼Œå®é™…åº”ç”¨ä¸­å¯†é’¥å’Œ nonce åº”è¯¥æ˜¯ä¿å¯†çš„ï¼Œåªæœ‰é€šä¿¡çš„åŒæ–¹çŸ¥é“ï¼Œè€Œä¸”æ¯æ¬¡é€šä¿¡ nonce éƒ½åº”è¯¥æ˜¯å”¯ä¸€çš„ï¼Œä»¥é˜²æ­¢é‡æ”¾æ”»å‡»ã€‚</p><p>æ€»ç»“èµ·æ¥ï¼ŒNode.js ä¸­çš„ CCM æ¨¡å¼ä¸ºå¼€å‘äººå‘˜æä¾›äº†ä¸€ç§å·¥å…·ï¼Œå¯ä»¥åŠ å¯†æ•°æ®å¹¶ç¡®ä¿å®ƒä»¬çš„å®Œæ•´æ€§ï¼Œéå¸¸é€‚åˆéœ€è¦è¾ƒé«˜å®‰å…¨çº§åˆ«çš„åº”ç”¨ç¨‹åºã€‚</p><h3 id="fips-mode" tabindex="-1"><a class="header-anchor" href="#fips-mode"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#fips-mode" target="_blank" rel="noopener noreferrer">FIPS mode</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡ç«¯ä»£ç ã€‚å…¶ä¸­ï¼ŒNode.js æä¾›äº†ä¸€ä¸ªåä¸º<code>crypto</code>çš„æ¨¡å—ï¼Œä¸“é—¨ç”¨äºå¤„ç†åŠ å¯†ç›¸å…³çš„ç®—æ³•å’Œæ“ä½œã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œâ€œFIPS modeâ€æŒ‡çš„æ˜¯ç¬¦åˆè”é‚¦ä¿¡æ¯å¤„ç†æ ‡å‡†ï¼ˆFederal Information Processing Standardsï¼Œç®€ç§° FIPSï¼‰çš„ä¸€ç§å®‰å…¨æ¨¡å¼ã€‚FIPS æ˜¯ç¾å›½å›½å®¶æ ‡å‡†ä¸æŠ€æœ¯ç ”ç©¶é™¢ï¼ˆNISTï¼‰å‘å¸ƒçš„ä¸€ç³»åˆ—å…³äºè®¡ç®—æœºç³»ç»Ÿå¤„ç†ä¿¡æ¯çš„æ ‡å‡†ã€‚è¿™äº›æ ‡å‡†ä¸­å®šä¹‰äº†è®¸å¤šå…³äºåŠ å¯†ç®—æ³•åŠå…¶å®ç°çš„ç»†èŠ‚ï¼Œä»¥ä¿è¯è½¯ä»¶åœ¨å¤„ç†æ•æ„Ÿæ•°æ®æ—¶çš„å®‰å…¨æ€§ã€‚</p><p>å½“ä½ åœ¨ Node.js ä¸­å¯ç”¨ FIPS æ¨¡å¼æ—¶ï¼Œ<code>crypto</code>æ¨¡å—ä¼šå—åˆ°ä»¥ä¸‹é™åˆ¶å½±å“ï¼š</p><ol><li>åªæœ‰è¢« FIPS è®¤å¯çš„åŠ å¯†ç®—æ³•æ‰èƒ½è¢«ä½¿ç”¨ã€‚æŸäº›ä¸å— FIPS æ ‡å‡†è®¤å¯çš„åŠ å¯†ç®—æ³•å°†æ— æ³•ä½¿ç”¨ã€‚</li><li>åŠ å¯†ç®—æ³•çš„å®ç°å¿…é¡»éµå¾ª FIPS çš„è§„èŒƒï¼Œç¡®ä¿å…¶å®‰å…¨æ€§ã€‚</li></ol><p>å¯ç”¨ FIPS æ¨¡å¼é€šå¸¸æ˜¯å‡ºäºå¯¹å®‰å…¨æ€§çš„é«˜è¦æ±‚ï¼Œåœ¨éœ€è¦éµå®ˆç‰¹å®šå®‰å…¨åŠæ³•çš„æ”¿åºœæœºæ„æˆ–ä¼ä¸šä¸­è¾ƒä¸ºå¸¸è§ã€‚æ¯”å¦‚ï¼Œå¯èƒ½æœ‰æ³•å¾‹æˆ–è€…ç›‘ç®¡è¦æ±‚å­˜å‚¨ç”¨æˆ·æ•°æ®çš„å…¬å¸åº”è¯¥ä½¿ç”¨ FIPS è®¤è¯çš„åŠ å¯†æ–¹å¼æ¥ä¿æŠ¤æ•°æ®ã€‚</p><h4 id="å¦‚ä½•å¯ç”¨-fips-æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•å¯ç”¨-fips-æ¨¡å¼"><span>å¦‚ä½•å¯ç”¨ FIPS æ¨¡å¼</span></a></h4><p>å¯ç”¨ FIPS æ¨¡å¼é€šå¸¸éœ€è¦è¿›è¡Œç³»ç»Ÿçº§åˆ«çš„é…ç½®ï¼Œå¹¶éœ€è¦ä¸€ä¸ªç‰¹å®šç‰ˆæœ¬çš„ OpenSSL åº“æ”¯æŒ FIPS æ¨¡å¼ã€‚åœ¨ Node.js ç¨‹åºä¸­å¯ç”¨ FIPS æ¨¡å¼ï¼Œå¯ä»¥åœ¨å¯åŠ¨ Node.js ç¨‹åºæ—¶ä½¿ç”¨<code>--enable-fips</code>å‘½ä»¤è¡Œå‚æ•°ï¼Œæˆ–è€…åœ¨ç¨‹åºè¿è¡Œä¸­é€šè¿‡ç¼–ç¨‹æ–¹å¼è®¾ç½®ã€‚</p><h4 id="å®é™…ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-4"><span>å®é™…ä¾‹å­ï¼š</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js æœåŠ¡æ¥å¤„ç†ç”¨æˆ·çš„ä¸ªäººè´¢åŠ¡æ•°æ®ã€‚å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œä½ å†³å®šä½¿ç”¨ FIPS æ¨¡å¼æ¥åŠ å¼ºæ•°æ®å®‰å…¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡å®šä½ å·²ç»æœ‰äº†ä¸€ä¸ªæ”¯æŒFIPSçš„Node.jsç¯å¢ƒ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯åŠ¨Node.jsæ—¶ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ç”¨FIPSæ¨¡å¼ï¼š</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// node --enable-fips your-script.js</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ç¨‹åºä¸­æ£€æŸ¥FIPSæ¨¡å¼æ˜¯å¦å·²å¯ç”¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getFips</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // FIPSæ¨¡å¼å·²å¯ç”¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;FIPS mode is enabled&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // FIPSæ¨¡å¼æœªå¯ç”¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;FIPS mode is not enabled, enable it for enhanced security&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ä¸€ä¸ªFIPSå…¼å®¹çš„ç®—æ³•ï¼Œä¾‹å¦‚AES</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> algorithm</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;aes-256-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// FIPSå…¼å®¹çš„ç®—æ³•</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªéšæœºçš„å¯†é’¥å’Œåˆå§‹åŒ–å‘é‡(IV) - éƒ½æ˜¯ç”¨äºåŠ å¯†çš„é‡è¦éƒ¨åˆ†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºåŠ å¯†å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> encrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">algorithm</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">concat</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()]);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encryptedData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æµ‹è¯•ä¸€æ®µæ–‡æœ¬çš„åŠ å¯†è¿‡ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> message</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Confidential message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encryptedMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> encrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Encrypted message: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">encryptedMessage</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encryptedData</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä»¥ä¸Šä»£ç ç¤ºä¾‹ä¸­ï¼Œå¦‚æœ Node.js ç¯å¢ƒå·²ç»è¢«æ­£ç¡®é…ç½®å¹¶å¯ç”¨äº† FIPS æ¨¡å¼ï¼Œ<code>crypto</code>æ¨¡å—å°†ä»…å…è®¸ä½¿ç”¨ FIPS è®¤è¯çš„åŠ å¯†ç®—æ³•ã€‚è¿™æ ·ï¼Œä½ å°±å¯ä»¥ç¡®ä¿ä½ çš„åŠ å¯†ç¨‹åºæ»¡è¶³ä¸¥æ ¼çš„å®‰å…¨æ ‡å‡†ã€‚</p><h2 id="crypto-constants-1" tabindex="-1"><a class="header-anchor" href="#crypto-constants-1"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#crypto-constants" target="_blank" rel="noopener noreferrer">Crypto constants</a></span></a></h2><p>åœ¨ Node.js ä¸­ï¼Œ<code>crypto</code>æ¨¡å—æ˜¯ä¸€ä¸ªå†…ç½®æ¨¡å—ï¼Œå®ƒæä¾›äº†åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†è§£å¯†ã€åˆ›å»ºæ•£åˆ—æ‘˜è¦ä»¥åŠç”Ÿæˆå’Œç®¡ç†å¯†é’¥ç­‰ã€‚è¿™ä¸ªæ¨¡å—æ¶‰åŠå¾ˆå¤šä¸å®‰å…¨ç›¸å…³çš„æ“ä½œï¼Œæ¯”å¦‚ä½ å¯ä»¥ç”¨å®ƒæ¥ç¡®ä¿æ•°æ®çš„éšç§æ€§æˆ–è€…éªŒè¯æ•°æ®çš„å®Œæ•´æ€§ã€‚</p><p><code>crypto</code>æ¨¡å—ä¸­æœ‰ä¸€ç³»åˆ—çš„å¸¸é‡ï¼ˆConstantsï¼‰ï¼Œè¿™äº›å¸¸é‡é€šå¸¸ç”¨äºé…ç½®å‡½æ•°è°ƒç”¨æ—¶çš„é€‰é¡¹ï¼Œæˆ–è€…ç”¨æ¥è¡¨ç¤ºå‡½æ•°æ‰§è¡Œåçš„æŸç§çŠ¶æ€ã€‚åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>Crypto constants</code>æŒ‡çš„å°±æ˜¯è¿™äº›ç”¨äºåŠ å¯†æ“ä½œçš„é¢„å®šä¹‰å€¼ã€‚</p><p>è¿™äº›å¸¸é‡åˆ†å‡ å¤§ç±»ï¼Œæ¯”å¦‚ï¼š</p><ol><li><strong>é”™è¯¯ç ï¼ˆError codesï¼‰:</strong> è¡¨ç¤ºç‰¹å®šé”™è¯¯æƒ…å†µçš„å¸¸é‡ã€‚</li><li><strong>è¯ä¹¦ç±»å‹ï¼ˆCertificate typesï¼‰ï¼š</strong> æŒ‡ç¤ºè¯ä¹¦ç±»å‹çš„å¸¸é‡ã€‚</li><li><strong>å¯†ç å­¦ç›¸å…³å¸¸é‡ï¼ˆCryptography-related constantsï¼‰ï¼š</strong> åŒ…æ‹¬åŠ å¯†ç®—æ³•æ ‡è¯†ã€æ•£åˆ—å‡½æ•°ã€å¯†é’¥å’Œè¯ä¹¦æ ¼å¼ç­‰ã€‚</li></ol><p>ä¸¾ä¸€äº›å®é™…çš„ä¾‹å­ï¼š</p><h3 id="æ•£åˆ—-hashing" tabindex="-1"><a class="header-anchor" href="#æ•£åˆ—-hashing"><span>æ•£åˆ—ï¼ˆHashingï¼‰</span></a></h3><p>å½“ä½ æƒ³è¦ä¸ºä¸€æ®µæ•°æ®åˆ›å»ºä¸€ä¸ªæ•£åˆ—ï¼ˆä¹Ÿå°±æ˜¯å“ˆå¸Œï¼‰ï¼Œå¯èƒ½ä¼šä½¿ç”¨åˆ°ä»¥ä¸‹çš„å¸¸é‡ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªSHA-256æ•£åˆ—ç®—æ³•çš„hashå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ›´æ–°hashå¯¹è±¡ï¼Œå³è¾“å…¥ä½ æƒ³è¦åˆ›å»ºæ•£åˆ—çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;some data to hash&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¡ç®—æ•£åˆ—æ‘˜è¦ï¼Œ&#39;hex&#39;è¡¨ç¤ºè¾“å‡ºä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²å½¢å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè™½ç„¶æ²¡æœ‰ç›´æ¥ä½¿ç”¨åˆ°<code>crypto</code>æ¨¡å—çš„å¸¸é‡ï¼Œä½†æ˜¯<code>&#39;sha256&#39;</code>å®é™…ä¸Šæ˜¯å¯¹åº”è¯¥æ¨¡å—å†…éƒ¨å®šä¹‰çš„æ•£åˆ—ç®—æ³•å¸¸é‡ä¹‹ä¸€ã€‚</p><h3 id="åŠ å¯†-encryption" tabindex="-1"><a class="header-anchor" href="#åŠ å¯†-encryption"><span>åŠ å¯†ï¼ˆEncryptionï¼‰</span></a></h3><p>å¦‚æœä½ æƒ³è¦ç”¨ä¸€ä¸ªå¯†é’¥è¿›è¡Œæ•°æ®çš„å¯¹ç§°åŠ å¯†ï¼Œåˆ™å¯èƒ½éœ€è¦ç”¨åˆ°ä¸€äº›å¸¸é‡æ¥ç¡®å®šç®—æ³•å’Œæ“ä½œæ¨¡å¼ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> algorithm</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;aes-192-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> password</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;mypassword&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">scryptSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;salt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">24</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆå§‹åŒ–å‘é‡</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">algorithm</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;readable&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  while</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">null</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> !==</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">chunk</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">read</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">())) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    encrypted</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encrypted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å…¥æ•°æ®è¿›è¡ŒåŠ å¯†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;some data to encrypt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cipher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>algorithm</code>å˜é‡ <code>&#39;aes-192-cbc&#39;</code> å¯¹åº”ç€åŠ å¯†ç®—æ³•å’Œæ“ä½œæ¨¡å¼ï¼Œè¿™ä¹Ÿå¯ä»¥è¢«çœ‹ä½œæ˜¯ä»<code>crypto</code>æ¨¡å—ä¸­å¾—åˆ°çš„ä¸€ä¸ªå¸¸é‡ã€‚</p><h3 id="å¯†é’¥å’Œè¯ä¹¦" tabindex="-1"><a class="header-anchor" href="#å¯†é’¥å’Œè¯ä¹¦"><span>å¯†é’¥å’Œè¯ä¹¦</span></a></h3><p>åœ¨å¤„ç† SSL/TLS è¿æ¥æˆ–å…¶ä»–éœ€è¦è¯ä¹¦çš„åœºæ™¯ä¸­ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°è¯¸å¦‚<code>crypto.constants.RSA_PKCS1_OAEP_PADDING</code>è¿™æ ·çš„å¸¸é‡ï¼Œè¿™æ˜¯æŒ‡å®šéå¯¹ç§°åŠ å¯†å¡«å……æ–¹å¼çš„ä¸€ä¸ªå¸¸é‡ã€‚</p><p>è¿™é‡Œæ˜¯ä¸€ä¸ªç®€åŒ–çš„ä¾‹å­ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨ Node.js çš„<code>crypto</code>æ¨¡å—å’Œå…¶å¸¸é‡æ¥ç”Ÿæˆä¸€ä¸ª RSA å¯†é’¥å¯¹ï¼Œå¹¶å¯¼å‡ºå…¬é’¥ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;rsa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  modulusLength</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯¼å‡ºå…¬é’¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> pubKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;spki&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pubKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>&#39;rsa&#39;</code> å’Œ <code>modulusLength</code> é€‰é¡¹ç”¨äºæŒ‡å®šç”Ÿæˆå¯†é’¥çš„ç±»å‹å’Œå¤§å°ï¼Œè€Œ<code>&#39;spki&#39;</code> å’Œ <code>&#39;pem&#39;</code>ç”¨äºæŒ‡æ˜å…¬é’¥çš„å¯¼å‡ºæ ¼å¼ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œè¿™äº›<code>crypto</code>æ¨¡å—ä¸­çš„å¸¸é‡éƒ½æ˜¯é¢„å…ˆå®šä¹‰å¥½çš„å›ºå®šå€¼ï¼Œå®ƒä»¬ä½¿å¾—ç¼–ç¨‹äººå‘˜èƒ½å¤Ÿæ›´å®¹æ˜“åœ°é…ç½®å’Œä½¿ç”¨åŠ å¯†ç®—æ³•å’ŒåŠŸèƒ½ï¼Œè€Œä¸å¿…è®°ä½è¿™äº›å¤æ‚çš„å€¼ã€‚åœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œåˆç†ä½¿ç”¨è¿™äº›å¸¸é‡èƒ½å¤Ÿå¸®åŠ©ä½ å†™å‡ºæ—¢å®‰å…¨åˆå¯é çš„ä»£ç ã€‚</p><h3 id="openssl-options" tabindex="-1"><a class="header-anchor" href="#openssl-options"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#openssl-options" target="_blank" rel="noopener noreferrer">OpenSSL options</a></span></a></h3><p>OpenSSL æ˜¯ä¸€ä¸ªå¼€æºçš„è½¯ä»¶åº“ï¼Œç”¨äºæä¾›å®‰å…¨é€šä¿¡è¿‡ç¨‹ä¸­çš„åŠ å¯†åŠŸèƒ½ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>crypto</code>æ¨¡å—å…è®¸ä½ è®¿é—® OpenSSL çš„ç‰¹æ€§ï¼Œä»¥å®ç°å„ç§åŠ å¯†æ“ä½œï¼Œå¦‚åˆ›å»ºæ•£åˆ—ã€å¯†ç å­¦ç­¾åå’ŒåŠ è§£å¯†æ•°æ®ã€‚</p><p>Node.js v21.7.1 æ–‡æ¡£ä¸­æåˆ°çš„â€œOpenSSL é€‰é¡¹â€æŒ‡çš„æ˜¯å¯ä»¥ç”¨æ¥è‡ªå®šä¹‰å’Œé…ç½® Node.js</p><h3 id="openssl-engine-constants" tabindex="-1"><a class="header-anchor" href="#openssl-engine-constants"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#openssl-engine-constants" target="_blank" rel="noopener noreferrer">OpenSSL engine constants</a></span></a></h3><p>OpenSSL æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„åŠ å¯†åº“ï¼Œå®ƒä¸ºå„ç§åŠ å¯†ç®—æ³•æä¾›äº†å®ç°ï¼Œä¾‹å¦‚å¯¹ç§°åŠ å¯†ã€éå¯¹ç§°åŠ å¯†ã€æ•£åˆ—å‡½æ•°ç­‰ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>crypto</code>æ¨¡å—å…è®¸å¼€å‘è€…ä½¿ç”¨è¿™äº›åŠ å¯†åŠŸèƒ½ï¼Œè€Œ OpenSSL å¼•æ“æ˜¯ä¸€ä¸ªå¯ä»¥æ‰©å±• OpenSSL åŠŸèƒ½çš„ç»„ä»¶ã€‚</p><p>åœ¨ Node.js çš„<code>crypto</code>æ¨¡å—ä¸­ï¼Œæœ‰ä¸€ç³»åˆ—çš„å¸¸é‡ç”¨äºä¸ OpenSSL å¼•æ“äº¤äº’ã€‚è¿™äº›å¸¸é‡ä»£è¡¨äº†ä¸åŒçš„å‘½ä»¤æˆ–é€‰é¡¹ï¼Œä½ å¯ä»¥åœ¨è°ƒç”¨æŸäº›<code>crypto</code>æ¨¡å—å‡½æ•°æ—¶ä½¿ç”¨å®ƒä»¬ã€‚ç„¶è€Œï¼Œåœ¨æ™®é€šçš„ Node.js åº”ç”¨ç¨‹åºå¼€å‘ä¸­ï¼Œç›´æ¥ä¸ OpenSSL å¼•æ“äº¤äº’çš„æƒ…å†µç›¸å¯¹è¾ƒå°‘ã€‚</p><p>ä¸¾å‡ ä¸ªä¾‹å­ï¼š</p><ol><li><p><strong>åŠ¨æ€åŠ è½½å¼•æ“</strong>ï¼š<br> å¦‚æœä½ æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç¡¬ä»¶è®¾å¤‡ï¼Œæ¯”å¦‚ä¸€ä¸ªå®‰å…¨ç¡¬ä»¶æ¨¡å—ï¼ˆHSMï¼‰ï¼Œå®ƒèƒ½å¤ŸåŠ é€ŸåŠ å¯†è¿ç®—æˆ–è€…æä¾›æ›´å®‰å…¨çš„å¯†é’¥å­˜å‚¨ï¼Œä½ å¯èƒ½ä¼šæƒ³è¦ä½¿ç”¨è¿™ä¸ªè®¾å¤‡æ¥å¤„ç†ä½ çš„åŠ å¯†ä»»åŠ¡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½éœ€è¦åŠ è½½ä¸€ä¸ªå¯¹åº”çš„ OpenSSL å¼•æ“æ¥è®© Node.js èƒ½å¤Ÿåˆ©ç”¨è¿™ä¸ªè®¾å¤‡ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡å®šä½ å·²ç»å®‰è£…äº†ä¸€ä¸ªåä¸ºâ€œmy_custom_engineâ€çš„OpenSSLå¼•æ“</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> engine</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;my_custom_engine&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ENGINE_METHOD_ALLè¡¨ç¤ºä½¿ç”¨æ‰€æœ‰æ–¹æ³•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> flags</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">ENGINE_METHOD_ALL</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®å¼•æ“</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setEngine</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">engine</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">flags</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æŒ‡å®šç®—æ³•</strong>ï¼š<br> æœ‰äº›æ—¶å€™ï¼Œä½ å¯èƒ½å¸Œæœ›ä½¿ç”¨ç‰¹å®šçš„ç®—æ³•å®ç°ï¼Œè¿™å¯èƒ½ç”±ä¸€ä¸ª OpenSSL å¼•æ“æä¾›ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çŸ¥é“æŸä¸ªå¼•æ“æä¾›äº†ä¸€ä¸ªé«˜æ€§èƒ½çš„ RSA ç®—æ³•å®ç°ï¼Œä½ å¯èƒ½ä¼šæƒ³è¦ä½¿ç”¨å®ƒè€Œä¸æ˜¯é»˜è®¤çš„å®ç°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå…·ä½“ç®—æ³•çš„ç­¾åå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> sign</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createSign</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;RSA-SHA256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œä½ å¯èƒ½ä¼šé€šè¿‡æŸç§æ–¹å¼æŒ‡å®šä½¿ç”¨ç‰¹å®šçš„å¼•æ“</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ³¨æ„ï¼šè¿™åªæ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œå¹¶ä¸æ˜¯çœŸæ­£çš„APIè°ƒç”¨</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// sign.useEngine(&#39;some_engine_for_rsa&#39;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>ç¦ç”¨æŸäº›ç®—æ³•</strong>ï¼š<br> å‡ºäºå®‰å…¨æ€§è€ƒè™‘ï¼Œä½ å¯èƒ½å¸Œæœ›åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­ç¦ç”¨æŸäº›ç®—æ³•ã€‚ä½¿ç”¨ OpenSSL å¼•æ“ç›¸å…³çš„å¸¸é‡å’Œé…ç½®ï¼Œä½ å¯ä»¥å®ç°è¿™ä¸ªç›®çš„ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¯”å¦‚ä½ æƒ³ç¦ç”¨ä¸å®‰å…¨çš„MD5æˆ–è€…RC4ç®—æ³•</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½ å¯ä»¥ä½¿ç”¨ç›¸åº”çš„æ ‡å¿—æ¥ç¦ç”¨å®ƒä»¬</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ³¨æ„ï¼šä»¥ä¸‹ä»£ç ä¸ºç¤ºæ„æ€§è´¨ï¼Œå¹¶éå®é™…APIè°ƒç”¨</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// const flags = crypto.constants.ENGINE_METHOD_CIPHERS;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// crypto.disableMethod(&#39;MD5&#39;, flags);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// crypto.disableMethod(&#39;RC4&#39;, flags);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™äº›æ“ä½œé€šå¸¸ç”±æœ‰ç»éªŒçš„å¼€å‘è€…æˆ–è€…ç³»ç»Ÿç®¡ç†å‘˜æ‰§è¡Œï¼Œå› ä¸ºå®ƒéœ€è¦æ·±å…¥ç†è§£ OpenSSL å’Œå®‰å…¨æ€§çš„çŸ¥è¯†ã€‚å¤§å¤šæ•° Node.js å¼€å‘è€…å¯èƒ½æ°¸è¿œä¸éœ€è¦ç›´æ¥ä¸ OpenSSL å¼•æ“æ‰“äº¤é“ï¼Œä»–ä»¬åªéœ€ä½¿ç”¨<code>crypto</code>æ¨¡å—æä¾›çš„é«˜çº§æ¥å£å°±è¶³å¤Ÿäº†ã€‚</p><p>åœ¨æŸ¥çœ‹ Node.js æ–‡æ¡£æ—¶ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°ä»¥<code>ENGINE_</code>å¼€å¤´çš„å¸¸é‡ã€‚è¿™äº›éƒ½æ˜¯ä¸ OpenSSL å¼•æ“ç›¸å…³çš„å¸¸é‡ï¼Œç”¨äºåœ¨ä½¿ç”¨<code>crypto</code>æ¨¡å—çš„æŸäº›å‡½æ•°æ—¶è®¾ç½®ä¸åŒçš„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œ<code>ENGINE_METHOD_RSA</code>è¡¨ç¤ºåªä½¿ç”¨å¼•æ“çš„ RSA ç®—æ³•å®ç°ã€‚å¦‚æœä½ æƒ³äº†è§£æ¯ä¸ªå¸¸é‡çš„å…·ä½“å«ä¹‰ï¼Œåº”è¯¥å‚è€ƒå®˜æ–¹çš„ Node.js æ–‡æ¡£ã€‚</p><h3 id="other-openssl-constants" tabindex="-1"><a class="header-anchor" href="#other-openssl-constants"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#other-openssl-constants" target="_blank" rel="noopener noreferrer">Other OpenSSL constants</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>crypto</code> æ¨¡å—æä¾›äº†åŒ…æ‹¬ OpenSSL çš„åŠ å¯†åŠŸèƒ½ï¼Œç”¨äºå¤„ç†å„ç§å®‰å…¨ç›¸å…³çš„æ“ä½œï¼Œä¾‹å¦‚åˆ›å»ºæ•£åˆ—ã€åŠ å¯†æ•°æ®ã€ç”Ÿæˆæ‘˜è¦ç­‰ã€‚</p><p>åœ¨ <code>crypto</code> æ¨¡å—ä¸­ï¼Œâ€œOther OpenSSL constantsâ€æŒ‡çš„æ˜¯é™¤äº†ä¸»è¦å‡½æ•°å’Œæ–¹æ³•ä¹‹å¤–ï¼ŒOpenSSL è¿˜æä¾›äº†ä¸€ç³»åˆ—çš„å¸¸æ•°ï¼ˆconstantsï¼‰ï¼Œå®ƒä»¬é€šå¸¸ç”¨äºæ§åˆ¶åŠ å¯†ç®—æ³•çš„è¡Œä¸ºæˆ–è¡¨ç¤ºç‰¹å®šçš„åŠ å¯†å±æ€§ã€‚è¿™äº›å¸¸æ•°å¾€å¾€å¯¹äºå®ç°åº•å±‚å®‰å…¨åŠŸèƒ½æˆ–è€…å¤„ç†ç‰¹å®šçš„å®‰å…¨éœ€æ±‚è‡³å…³é‡è¦ã€‚</p><p>ä¸¾å‡ ä¸ªå®é™…è¿ç”¨çš„ä¾‹å­æ¥è¯´æ˜ï¼š</p><ol><li>åŠ å¯†æ¨¡å¼ï¼šå½“ä½ æƒ³è¦åŠ å¯†æ•°æ®æ—¶ï¼Œå¯èƒ½éœ€è¦é€‰æ‹©ä¸€ä¸ªç‰¹å®šçš„åŠ å¯†æ¨¡å¼ï¼ˆä¾‹å¦‚ CBC, GCM ç­‰ï¼‰ã€‚OpenSSL å¸¸æ•°é‡Œå°±å®šä¹‰äº†ä¸åŒçš„åŠ å¯†æ¨¡å¼ï¼Œä½ å¯ä»¥åœ¨åŠ å¯†æ•°æ®æ—¶ä½œä¸ºå‚æ•°ä¼ å…¥ä»¥æŒ‡å®šæ‰€ä½¿ç”¨çš„æ¨¡å¼ã€‚ä¾‹å¦‚ï¼Œ<code>crypto.constants.O_SSL_OP_NO_TLSv1_1</code> å°±æ˜¯ä¸€ä¸ªæŒ‡ç¤ºå…·ä½“åè®®ç‰ˆæœ¬é€‰é¡¹çš„å¸¸é‡ï¼Œç”¨äºç¦ç”¨ TLS 1.1ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cipher</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createCipheriv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;aes-256-cbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­ï¼Œ&#39;aes-256-cbc&#39; æŒ‡å®šäº†åŠ å¯†ç®—æ³•å’Œæ¨¡å¼ã€‚å¦‚æœæœ‰å¯¹åº”çš„ OpenSSL å¸¸æ•°ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡å®ƒæ¥è®¾ç½®è¿™ä¸ªå€¼ã€‚</p><ol start="2"><li>æ•£åˆ—å’Œæ‘˜è¦ï¼šåœ¨ç”Ÿæˆæ•°å­—ç­¾åæˆ–éªŒè¯æ•°æ®å®Œæ•´æ€§æ—¶ï¼Œä½ ä¼šç”¨åˆ°æ•£åˆ—ç®—æ³•ï¼ˆå¦‚ SHA256ï¼‰ã€‚OpenSSL å¸¸æ•°ä¸­ä¹Ÿå®šä¹‰äº†ä¸æ•£åˆ—ç®—æ³•ç›¸å…³çš„å¸¸é‡ï¼Œä½ å¯ä»¥åœ¨æ•£åˆ—æ•°æ®æ—¶ä½¿ç”¨è¿™äº›å¸¸é‡æ¥æŒ‡å®šæ‰€é‡‡ç”¨çš„ç®—æ³•ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;some data to hash&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ç›´æ¥ä½¿ç”¨ OpenSSL å¸¸æ•°ï¼Œä½†æ˜¯å¦‚æœæœ‰å¿…è¦æŒ‡å®šæˆ–é…ç½®æ•£åˆ—ç®—æ³•çš„æŸäº›å±æ€§ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šæ¶‰åŠåˆ°è¿™äº›å¸¸æ•°ã€‚</p><ol start="3"><li>SSL/TLS é…ç½®ï¼šOpenSSL å¸¸æ•°å¯ä»¥ç”¨æ¥é…ç½® SSL æˆ– TLS è¿æ¥çš„ç»†èŠ‚ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½éœ€è¦é…ç½®æœåŠ¡å™¨æ¥ä»…æ¥å—ç‰¹å®šç‰ˆæœ¬çš„ SSL/TLS åè®®ï¼Œæˆ–è€…å¼€å¯æŸäº›ç‰¹æ®Šçš„å®‰å…¨é€‰é¡¹ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> https</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> options</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;private-key.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;certificate.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  secureOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">SSL_OP_NO_SSLv3</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> |</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">SSL_OP_NO_TLSv1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">https</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeHead</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hello world</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>secureOptions</code> å±æ€§ä½¿ç”¨äº† OpenSSL å¸¸æ•°æ¥ç¦æ­¢ SSLv3 å’Œ TLSv1 åè®®ï¼Œå¢å¼ºäº†æœåŠ¡å™¨çš„å®‰å…¨æ€§ã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œ&quot;Other OpenSSL constants&quot; æä¾›äº†ä¸€ç»„åº•å±‚çš„é…ç½®é€‰é¡¹ï¼Œå…è®¸ä½ åœ¨ä½¿ç”¨ Node.js çš„ <code>crypto</code> æ¨¡å—æ—¶è¿›è¡Œç²¾ç»†çš„æ§åˆ¶ã€‚é€šè¿‡å®ƒä»¬ï¼Œä½ å¯ä»¥æŒ‡å®šåŠ å¯†ç®—æ³•çš„ç»†èŠ‚ï¼Œé…ç½®æ•£åˆ—è¡Œä¸ºï¼Œæˆ–è€…è®¾ç½® SSL/TLS åè®®çš„é«˜çº§é€‰é¡¹ã€‚</p><h3 id="node-js-crypto-constants" tabindex="-1"><a class="header-anchor" href="#node-js-crypto-constants"><span><a href="https://nodejs.org/docs/latest/api/crypto.html#nodejs-crypto-constants" target="_blank" rel="noopener noreferrer">Node.js crypto constants</a></span></a></h3><p>Node.js çš„ <code>crypto</code> æ¨¡å—æä¾›äº†åŠ å¯†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ã€åˆ›å»ºæ•£åˆ—ç­‰ã€‚åœ¨ <code>crypto</code> æ¨¡å—ä¸­ï¼Œæœ‰å¾ˆå¤šå¸¸é‡ï¼ˆconstantsï¼‰è¢«å®šä¹‰ï¼Œå®ƒä»¬ç”¨æ¥æŒ‡å®šåœ¨åŠ å¯†æ“ä½œä¸­ä½¿ç”¨çš„ç‰¹å®šè¡Œä¸ºæˆ–ç®—æ³•ã€‚è¿™äº›å¸¸é‡é€šå¸¸æ˜¯ä¸€äº›é¢„å®šä¹‰çš„å€¼ï¼Œå¼€å‘è€…å¯ä»¥åœ¨è°ƒç”¨å„ç§ <code>crypto</code> æ–¹æ³•æ—¶ä½¿ç”¨è¿™äº›å¸¸é‡ï¼Œä»è€Œé¿å…é”™å†™å­—ç¬¦ä¸²æˆ–æ•°å€¼ï¼Œå¢åŠ ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><p>ä»¥ä¸‹æ˜¯å‡ ä¸ªå®é™…åº”ç”¨çš„ä¾‹å­æ¥è¯´æ˜å¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨ <code>crypto</code> å¸¸é‡ï¼š</p><h3 id="ä¾‹å­-1-ç”Ÿæˆæ•£åˆ—å€¼" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-ç”Ÿæˆæ•£åˆ—å€¼"><span>ä¾‹å­ 1ï¼šç”Ÿæˆæ•£åˆ—å€¼</span></a></h3><p>å‡è®¾ä½ æƒ³è¦ä¸ºä¸€ä¸ªå¯†ç ç”Ÿæˆä¸€ä¸ª SHA-256 æ•£åˆ—å€¼ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>crypto</code> æ¨¡å—çš„ <code>createHash()</code> æ–¹æ³•å¹¶ä¼ å…¥ç›¸åº”çš„å¸¸é‡è¡¨ç¤ºæ•£åˆ—ç®—æ³•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ crypto å¸¸é‡ &#39;crypto.constants&#39; æ¥æŒ‡å®š SHA-256 æ•£åˆ—ç®—æ³•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;my-secret-password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ç›´æ¥ä½¿ç”¨ <code>crypto.constants</code>ï¼Œå› ä¸º <code>createHash()</code> æ–¹æ³•æ¥å—ä¸€ä¸ªä»£è¡¨ç®—æ³•åç§°çš„å­—ç¬¦ä¸²ã€‚ä¸è¿‡ï¼Œåœ¨å…¶å®ƒæƒ…å†µä¸‹ï¼Œä½ å¯èƒ½éœ€è¦å¼•ç”¨å…·ä½“çš„å¸¸é‡ã€‚</p><h3 id="ä¾‹å­-2-ä½¿ç”¨-rsa-å…¬é’¥åŠ å¯†æ•°æ®" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-ä½¿ç”¨-rsa-å…¬é’¥åŠ å¯†æ•°æ®"><span>ä¾‹å­ 2ï¼šä½¿ç”¨ RSA å…¬é’¥åŠ å¯†æ•°æ®</span></a></h3><p>å¦‚æœä½ éœ€è¦ä½¿ç”¨ RSA çš„å…¬é’¥åŠ å¯†ä¸€æ®µæ•°æ®ï¼Œä½ å¯èƒ½ä¼šä½¿ç”¨ <code>crypto.publicEncrypt()</code> æ–¹æ³•ï¼Œå¹¶ä¸”éœ€è¦æŒ‡å®šå¡«å……æ¨¡å¼ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> publicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> getPublicKeySomehow</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œå‡è®¾ä½ å·²ç»æœ‰äº†ä¸€ä¸ªRSAå…¬é’¥</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> bufferToEncrypt</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;secret data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> encryptedData</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">publicEncrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    padding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">RSA_PKCS1_OAEP_PADDING</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨å¸¸é‡æŒ‡å®šå¡«å……æ¨¡å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  bufferToEncrypt</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">encryptedData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>crypto.constants.RSA_PKCS1_OAEP_PADDING</code> å¸¸é‡æ¥æ˜ç¡®æŒ‡å®š RSA åŠ å¯†æ—¶ä½¿ç”¨çš„å¡«å……æ¨¡å¼ã€‚</p><h3 id="ä¾‹å­-3-è®¾ç½®-tls-ssl-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-3-è®¾ç½®-tls-ssl-æ–¹æ³•"><span>ä¾‹å­ 3ï¼šè®¾ç½® TLS/SSL æ–¹æ³•</span></a></h3><p>å½“ä½ åˆ›å»º HTTPS æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯æ—¶ï¼Œå¯èƒ½éœ€è¦æŒ‡å®šæ”¯æŒçš„ TLS/SSL æ–¹æ³•ã€‚<code>crypto.constants</code> æä¾›äº†ç›¸å…³çš„å¸¸é‡æ¥å¸®åŠ©ä½ è®¾ç½®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> https</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> options</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;private-key.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  cert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;certificate.pem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  secureOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">SSL_OP_NO_TLSv1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> |</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">SSL_OP_NO_TLSv1_1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">https</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeHead</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hello world</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>crypto.constants.SSL_OP_NO_TLSv1</code> å’Œ <code>crypto.constants.SSL_OP_NO_TLSv1_1</code> å¸¸é‡æ¥ç¦æ­¢ TLS 1.0 å’Œ TLS 1.1 åè®®ï¼Œä¿ƒä½¿æœåŠ¡å™¨ä»…ä½¿ç”¨æ›´å®‰å…¨çš„ TLS ç‰ˆæœ¬ï¼Œæé«˜å®‰å…¨æ€§ã€‚</p></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: kamiacgxu@gmail.com">kamishima-kaede</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/document/node-doc/Corepack.html" aria-label="Corepack"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Corepack</div></a><a class="route-link auto-link next" href="/document/node-doc/Debugger.html" aria-label="Debugger"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">Debugger<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><!----><div class="vp-copyright">Copyright Â© 2018-present hanekawa-shiki</div></footer></div><!--]--><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.e98858ae.js" defer></script><script src="/assets/js/9435.209d772b.js" defer></script><script src="/assets/js/app.604dc302.js" defer></script>
  </body>
</html>
